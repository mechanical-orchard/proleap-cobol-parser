000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.             DPKUT080.                                00040000
000500 AUTHOR.                 DAN DREW.                                00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            DECEMBER 22, 1992.                       00070001
000800 DATE-COMPILED.                                                   00080000
000900*                                                                 00090000
001000***************************************************************** 00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200***************************************************************** 00120000
001300*                                                                 00130000
001400 CONFIGURATION SECTION.                                           00140000
001500*                                                                 00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800*                                                                 00180000
001900 INPUT-OUTPUT SECTION.                                            00190000
002000 FILE-CONTROL.                                                    00200000
002100*                                                                 00210000
002310     SELECT SAS-HOLIDAYS-FILE ASSIGN TO OUT01.                    00231017
002400     SELECT SAS-WEEKDATE-FILE ASSIGN TO OUT02.                    00240017
002410     SELECT SAS-FISCAL-FILE ASSIGN TO OUT03.                      00241017
002420     SELECT SAS-YRWK-FILE ASSIGN TO OUT04.                        00242017
002500*                                                                 00250000
002600 DATA DIVISION.                                                   00260000
002700*                                                                 00270000
002800 FILE SECTION.                                                    00280000
002900*                                                                 00290000
003700 FD  SAS-HOLIDAYS-FILE                                            00370017
003800     RECORDING MODE IS F                                          00380000
003900     LABEL RECORDS ARE STANDARD                                   00390000
004000     RECORD CONTAINS 80 CHARACTERS                                00400000
004100     BLOCK CONTAINS 0  RECORDS.                                   00410000
004200 01  SH-SAS-HOLIDAYS-RECORD      PIC X(80).                       00420017
004300*                                                                 00430000
004400 FD  SAS-WEEKDATE-FILE                                            00440017
004500     RECORDING MODE IS F                                          00450000
004600     LABEL RECORDS ARE STANDARD                                   00460000
004700     RECORD CONTAINS 80 CHARACTERS                                00470000
004800     BLOCK CONTAINS 0  RECORDS.                                   00480000
004900 01  SW-SAS-WEEKDATE-RECORD      PIC X(80).                       00490017
004910*                                                                 00491008
004920 FD  SAS-FISCAL-FILE                                              00492017
004930     RECORDING MODE IS F                                          00493008
004940     LABEL RECORDS ARE STANDARD                                   00494008
004950     RECORD CONTAINS 80 CHARACTERS                                00495008
004960     BLOCK CONTAINS 0  RECORDS.                                   00496008
004970 01  SF-SAS-FISCAL-RECORD        PIC X(80).                       00497017
004980*                                                                 00498008
004990 FD  SAS-YRWK-FILE                                                00499017
004991     RECORDING MODE IS F                                          00499108
004992     LABEL RECORDS ARE STANDARD                                   00499208
004993     RECORD CONTAINS 80 CHARACTERS                                00499308
004994     BLOCK CONTAINS 0  RECORDS.                                   00499408
004995 01  SY-SAS-YRWK-RECORD          PIC X(80).                       00499517
005000*                                                                 00500000
005100*-----------------------------------------------------------------00510000
005200 WORKING-STORAGE SECTION.                                         00520000
005300*-----------------------------------------------------------------00530000
005400                                                                  00540000
005401*                                                                 00540101
005402*  PARAMETER LIST FOR THE KOHL'S CALENDAR ROUTINE                 00540201
005403*                                                                 00540301
005410     COPY DPWS500.                                                00541001
005420                                                                  00542001
005500 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          00550001
005600                                              COMP SYNC.          00560001
005610     88  AC-CONTROL-CARD-ERROR-4003           VALUE +4003.        00561001
005620     88  AC-CALENDAR-ROUTINE-ERROR-4019       VALUE +4019.        00562001
018600                                                                  01860000
018700 01  PC-PROGRAM-CONSTANTS.                                        01870001
019100     05  PC-CURRENT-PROGRAM-NAME PIC X(08)    VALUE 'DPKUT080'.   01910013
019101     05  PC-CURRENT-JOB-NAME     PIC X(08)    VALUE 'DPK530  '.   01910113
019102     05  PC-CURRENT-FISCAL-YEAR  PIC 9(01)    VALUE 1.            01910213
019103     05  PC-SAS-BASELINE-DATE    PIC X(10)    VALUE '1960-01-01'. 01910308
019104     05  PC-TRAILER-DAYS-SINCE-SAS-BASE                           01910412
019105                                 PIC 9(05)    VALUE 99999.        01910512
019108     05  PC-TRAILER-FISCAL-YEAR-NBR                               01910813
019109                                 PIC 9(02)    VALUE 99.           01910914
019110     05  PC-TRAILER-FISCAL-QTR-NBR                                01911013
019111                                 PIC 9(02)    VALUE 99.           01911114
019112     05  PC-TRAILER-FISCAL-PERIOD-NBR                             01911213
019113                                 PIC 9(02)    VALUE 99.           01911314
019114     05  PC-TRAILER-FISCAL-WEEK-NBR                               01911413
019115                                 PIC 9(02)    VALUE 99.           01911514
019116                                                                  01911603
019117 01  PV-PROGRAM-VARIABLES.                                        01911703
019118     05  PV-END-FISCAL-YEAR      PIC 9(04)    VALUE ZERO.         01911813
019119     05  PV-LAST-FISCAL-YEAR     PIC 9(04)    VALUE ZERO.         01911913
019120     05  PV-DAYS-SINCE-SAS-BASELINE                               01912008
019121                                 PIC 9(05)    VALUE ZERO.         01912113
019122                                                                  01912201
019130 01  CC-CONTROL-CARD.                                             01913001
019131     05  CC-CONTROL-CARD-DISPLAY.                                 01913102
019132         10  FILLER              PIC X(43)    VALUE SPACES.       01913209
019133             88  CC-PRIOR-FISCAL-YEARS-ID     VALUE               01913309
019134             'REQUESTED NUMBER OF:  PRIOR FISCAL YEARS = '.       01913406
019140         10  CC-PRIOR-FISCAL-YEARS                                01914002
019141                                 PIC 9(01)    VALUE ZEROS.        01914113
019142         10  FILLER              PIC X(24)    VALUE SPACES.       01914209
019143             88  CC-FUTURE-FISCAL-YEARS-ID    VALUE               01914309
019144             '; FUTURE FISCAL YEARS = '.                          01914401
019160         10  CC-FUTURE-FISCAL-YEARS                               01916002
019161                                 PIC 9(01)    VALUE ZEROS.        01916113
019170     05  FILLER                  PIC X(11)    VALUE SPACES.       01917009
019171                                                                  01917104
019172 01  CD-CURRENT-DATE.                                             01917204
019173     05  CD-CURRENT-YEAR         PIC 9(02)    VALUE ZERO.         01917313
019174     05  CD-CURRENT-MONTH        PIC 9(02)    VALUE ZERO.         01917413
019180     05  CD-CURRENT-DAY          PIC 9(02)    VALUE ZERO.         01918013
019195                                                                  01919508
019200 01  WF-WEEKDATE-FILE-COMMENT.                                    01920009
019300     05  FILLER                  PIC X(31)    VALUE               01930009
019400         '/* WEEKDATE BUILT FROM PROGRAM '.                       01940008
019500     05  WF-PROGRAM-NAME         PIC X(08)    VALUE SPACES.       01950013
019700     05  FILLER                  PIC X(05)    VALUE ' JOB '.      01970013
019800     05  WF-JOB-NAME             PIC X(08)    VALUE SPACES.       01980013
019900     05  FILLER                  PIC X(03)    VALUE ' */'.        01990013
020010                                                                  02001009
020100 01  WF-WEEKDATE-FILE-SELECT     PIC X(80)    VALUE 'SELECT;'.    02010011
020200                                                                  02020009
020300 01  WF-WEEKDATE-FILE-WHEN.                                       02030009
020400     05  FILLER                  PIC X(16)    VALUE               02040009
020500         '    WHEN (FYEAR='.                                      02050012
020600     05  FILLER                  PIC X(01)    VALUE QUOTE.        02060009
020610     05  WF-WHEN-FISCAL-YEAR-NBR PIC 9(02)    VALUE ZEROS.        02061009
020620     05  FILLER                  PIC X(01)    VALUE QUOTE.        02062009
020630     05  FILLER                  PIC X(13)    VALUE               02063009
020640         ') SEED = MDY('.                                         02064012
020650     05  WF-WHEN-MONTH           PIC 9(02)    VALUE ZEROS.        02065009
020660     05  FILLER                  PIC X(01)    VALUE ','.          02066009
020670     05  WF-WHEN-DAY             PIC 9(02)    VALUE ZEROS.        02067009
020680     05  FILLER                  PIC X(01)    VALUE ','.          02068009
020690     05  WF-WHEN-YEAR            PIC 9(02)    VALUE ZEROS.        02069009
020691     05  FILLER                  PIC X(39)    VALUE ');'.         02069109
020692                                                                  02069209
020693 01  WF-WEEKDATE-FILE-OTHERWISE  PIC X(80)    VALUE               02069309
020694     '    OTHERWISE SEED = MDY(01,01,60);'.                       02069412
020695                                                                  02069509
020696 01  WF-WEEKDATE-FILE-END        PIC X(80)    VALUE 'END;'.       02069609
020698                                                                  02069809
020699 01  WF-WEEKDATE-FILE-PERIOD.                                     02069909
020700     05  FILLER                  PIC X(15)    VALUE               02070009
020701         'PERIOD = INTNX('.                                       02070112
020702     05  FILLER                  PIC X(01)    VALUE QUOTE.        02070209
020703     05  FILLER                  PIC X(04)    VALUE 'WEEK'.       02070309
020704     05  FILLER                  PIC X(01)    VALUE QUOTE.        02070409
020705     05  FILLER                  PIC X(13)    VALUE               02070509
020706         ',SEED,FWEEK);'.                                         02070612
020707     05  FILLER                  PIC X(46)    VALUE SPACE.        02070709
020708                                                                  02070809
020709 01  WF-WEEKDATE-FILE-DROP-SEED  PIC X(80)    VALUE 'DROP SEED;'. 02070909
020711                                                                  02071108
020712 01  HF-HOLIDAYS-FILE-COMMENT-1.                                  02071209
020713     05  FILLER                  PIC X(31)    VALUE               02071309
020714         '/* HOLIDAYS BUILT FROM PROGRAM '.                       02071408
020715     05  HF-PROGRAM-NAME         PIC X(08)    VALUE SPACES.       02071513
020716     05  FILLER                  PIC X(05)    VALUE ' JOB '.      02071613
020717     05  HF-JOB-NAME             PIC X(08)    VALUE SPACES.       02071713
020718     05  FILLER                  PIC X(03)    VALUE ' */'.        02071813
020720                                                                  02072009
020721 01  HF-HOLIDAYS-FILE-COMMENT-2  PIC X(80)    VALUE               02072111
020722     '/* THIS MODULE INCLUDED IN MXG MODULE  IMACSHFT     */'.    02072208
020723                                                                  02072309
020724 01  HF-HOLIDAYS-FILE-DATEPART.                                   02072410
020725     05  HF-IF-OR-STATEMENT      PIC X(02)    VALUE SPACES.       02072510
020726         88  HF-IF-STATEMENT                  VALUE 'IF'.         02072610
020727         88  HF-OR-STATEMENT                  VALUE 'OR'.         02072710
020728     05  FILLER                  PIC X(22)    VALUE               02072810
020729         ' DATEPART(DATETIME) = '.                                02072912
020730     05  FILLER                  PIC X(01)    VALUE QUOTE.        02073010
020731     05  HF-CALENDAR-DAY         PIC X(02)    VALUE SPACE.        02073110
020732     05  HF-CALENDAR-MONTH-ABBR3 PIC X(03)    VALUE SPACE.        02073210
020733     05  HF-CALENDAR-YEAR        PIC X(02)    VALUE SPACE.        02073310
020734     05  FILLER                  PIC X(01)    VALUE QUOTE.        02073410
020735     05  FILLER                  PIC X(01)    VALUE 'D'.          02073510
020736     05  FILLER                  PIC X(46)    VALUE SPACE.        02073610
020737                                                                  02073710
020738 01  HF-HOLIDAYS-FILE-ZONE.                                       02073810
020739     05  FILLER                  PIC X(12)    VALUE 'THEN ZONE ='.02073910
020741     05  FILLER                  PIC X(01)    VALUE QUOTE.        02074110
020742     05  FILLER                  PIC X(01)    VALUE '4'.          02074210
020743     05  FILLER                  PIC X(01)    VALUE QUOTE.        02074310
020744     05  FILLER                  PIC X(01)    VALUE ';'.          02074410
020750     05  FILLER                  PIC X(63)    VALUE SPACES.       02075009
020751                                                                  02075117
020752 01  FF-FISCAL-FILE-COMMENT.                                      02075217
020753     05  FILLER                  PIC X(30)    VALUE               02075317
020754         '/* $FISCAL BUILT FROM PROGRAM '.                        02075417
020755     05  FF-PROGRAM-NAME         PIC X(08)    VALUE SPACES.       02075517
020756     05  FILLER                  PIC X(05)    VALUE ' JOB '.      02075617
020757     05  FF-JOB-NAME             PIC X(08)    VALUE SPACES.       02075717
020758     05  FILLER                  PIC X(03)    VALUE ' */'.        02075817
020760                                                                  02076012
020761 01  FF-FISCAL-FILE-VALUE        PIC X(80)    VALUE               02076112
020762     'VALUE FISCAL'.                                              02076212
020766                                                                  02076612
020767 01  FF-FISCAL-FILE-RECORD.                                       02076712
020768     05  FILLER                  PIC X(04)    VALUE SPACES.       02076812
020769     05  FF-DAYS-SINCE-SAS-BASELINE                               02076912
020770                                 PIC 9(05)    VALUE ZEROS.        02077012
020771     05  FILLER                  PIC X(04)    VALUE '  = '.       02077112
020772     05  FILLER                  PIC X(01)    VALUE QUOTE.        02077212
020773     05  FF-FISCAL-YEAR-NBR      PIC 9(02)    VALUE ZEROS.        02077312
020774     05  FILLER                  PIC X(01)    VALUE SPACES.       02077412
020775     05  FF-FISCAL-QTR-NBR       PIC 9(02)    VALUE ZEROS.        02077512
020776     05  FILLER                  PIC X(01)    VALUE SPACES.       02077612
020777     05  FF-FISCAL-PERIOD-NBR    PIC 9(02)    VALUE ZEROS.        02077712
020778     05  FILLER                  PIC X(01)    VALUE SPACES.       02077812
020779     05  FF-FISCAL-WEEK-NBR      PIC 9(02)    VALUE ZEROS.        02077912
020780     05  FILLER                  PIC X(01)    VALUE SPACES.       02078012
020781     05  FILLER                  PIC X(01)    VALUE QUOTE.        02078112
020782     05  FILLER                  PIC X(53)    VALUE SPACES.       02078212
020783                                                                  02078312
020784 01  FF-FISCAL-FILE-END          PIC X(80)    VALUE ';'.          02078412
020809                                                                  02080912
020811 01  YF-YRWK-FILE-COMMENT.                                        02081117
020812     05  FILLER                  PIC X(28)    VALUE               02081217
020813         '/* $YRWK BUILT FROM PROGRAM '.                          02081317
020814     05  YF-PROGRAM-NAME         PIC X(08)    VALUE SPACES.       02081417
020815     05  FILLER                  PIC X(05)    VALUE ' JOB '.      02081517
020816     05  YF-JOB-NAME             PIC X(08)    VALUE SPACES.       02081617
020817     05  FILLER                  PIC X(03)    VALUE ' */'.        02081717
020818                                                                  02081817
020819 01  YF-YRWK-FILE-VALUE          PIC X(80)    VALUE 'VALUE $YRWK'.02081912
020820                                                                  02082012
020821 01  YF-YRWK-FILE-RECORD.                                         02082112
020822     05  FILLER                  PIC X(04)    VALUE SPACES.       02082212
020823     05  YF-FISCAL-YEAR-NBR      PIC 9(02)    VALUE ZEROS.        02082312
020824     05  YF-FISCAL-WEEK-NBR      PIC 9(02)    VALUE ZEROS.        02082412
020825     05  FILLER                  PIC X(04)    VALUE '  = '.       02082512
020826     05  FILLER                  PIC X(01)    VALUE QUOTE.        02082612
020827     05  YF-MONDAY-GREG-DATE-FMT PIC X(08)    VALUE SPACES.       02082712
020828     05  FILLER                  PIC X(01)    VALUE SPACES.       02082812
020829     05  FILLER                  PIC X(01)    VALUE QUOTE.        02082912
020830     05  FILLER                  PIC X(57)    VALUE SPACES.       02083012
020831                                                                  02083112
020832 01  YF-YRWK-FILE-END            PIC X(80)    VALUE ';'.          02083213
020833                                                                  02083312
020840******************************************************************02084012
020900 PROCEDURE DIVISION.                                              02090000
021000******************************************************************02100000
021100                                                                  02110000
021200 0000-MAINLINE.                                                   02120001
021300                                                                  02130000
021310     PERFORM 1000-INITIALIZE.                                     02131001
021311                                                                  02131102
021340     OPEN OUTPUT SAS-HOLIDAYS-FILE.                               02134018
021341     MOVE PC-CURRENT-PROGRAM-NAME TO HF-PROGRAM-NAME.             02134110
021345     MOVE PC-CURRENT-JOB-NAME TO HF-JOB-NAME.                     02134510
021350     WRITE SH-SAS-HOLIDAYS-RECORD                                 02135017
021351         FROM HF-HOLIDAYS-FILE-COMMENT-1.                         02135110
021360     WRITE SH-SAS-HOLIDAYS-RECORD                                 02136017
021361         FROM HF-HOLIDAYS-FILE-COMMENT-2.                         02136110
021362     SET HF-IF-STATEMENT TO TRUE.                                 02136210
021370                                                                  02137002
021380     OPEN OUTPUT SAS-WEEKDATE-FILE.                               02138017
021381     MOVE PC-CURRENT-PROGRAM-NAME TO WF-PROGRAM-NAME.             02138109
021382     MOVE PC-CURRENT-JOB-NAME TO WF-JOB-NAME.                     02138209
021390     WRITE SW-SAS-WEEKDATE-RECORD                                 02139017
021391         FROM WF-WEEKDATE-FILE-COMMENT.                           02139110
021400     WRITE SW-SAS-WEEKDATE-RECORD                                 02140017
021500         FROM WF-WEEKDATE-FILE-SELECT.                            02150010
023200                                                                  02320000
023300     OPEN OUTPUT SAS-FISCAL-FILE.                                 02330017
023310     MOVE PC-CURRENT-PROGRAM-NAME TO FF-PROGRAM-NAME.             02331017
023320     MOVE PC-CURRENT-JOB-NAME TO FF-JOB-NAME.                     02332017
023321     WRITE SF-SAS-FISCAL-RECORD                                   02332117
023322         FROM FF-FISCAL-FILE-COMMENT.                             02332217
023330     WRITE SF-SAS-FISCAL-RECORD                                   02333017
023340         FROM FF-FISCAL-FILE-VALUE.                               02334012
023350                                                                  02335012
023360     OPEN OUTPUT SAS-YRWK-FILE.                                   02336017
023361     MOVE PC-CURRENT-PROGRAM-NAME TO YF-PROGRAM-NAME.             02336117
023362     MOVE PC-CURRENT-JOB-NAME TO YF-JOB-NAME.                     02336217
023363     WRITE SY-SAS-YRWK-RECORD                                     02336317
023364         FROM YF-YRWK-FILE-COMMENT.                               02336417
023365     WRITE SY-SAS-YRWK-RECORD                                     02336517
023366         FROM YF-YRWK-FILE-VALUE.                                 02336612
023370                                                                  02337012
023400     PERFORM 2000-PROCESS-CALENDAR-DAY                            02340002
023500         UNTIL DPG56-FISCAL-YEAR-CCYY NOT < PV-END-FISCAL-YEAR    02350002
023600                                                                  02360000
023900     WRITE SH-SAS-HOLIDAYS-RECORD                                 02390017
023910         FROM HF-HOLIDAYS-FILE-ZONE.                              02391010
024000     CLOSE SAS-HOLIDAYS-FILE.                                     02400017
024100                                                                  02410000
024200     WRITE SW-SAS-WEEKDATE-RECORD                                 02420017
024210         FROM WF-WEEKDATE-FILE-OTHERWISE.                         02421010
024300     WRITE SW-SAS-WEEKDATE-RECORD                                 02430017
024310         FROM WF-WEEKDATE-FILE-END.                               02431010
024400     WRITE SW-SAS-WEEKDATE-RECORD                                 02440017
024410         FROM WF-WEEKDATE-FILE-PERIOD.                            02441010
024500     WRITE SW-SAS-WEEKDATE-RECORD                                 02450017
024510         FROM WF-WEEKDATE-FILE-DROP-SEED.                         02451010
024600     CLOSE SAS-WEEKDATE-FILE.                                     02460017
024610                                                                  02461012
024611     MOVE PC-TRAILER-DAYS-SINCE-SAS-BASE TO                       02461112
024612               FF-DAYS-SINCE-SAS-BASELINE.                        02461212
024613     MOVE PC-TRAILER-FISCAL-YEAR-NBR TO FF-FISCAL-YEAR-NBR.       02461312
024614     MOVE PC-TRAILER-FISCAL-QTR-NBR TO FF-FISCAL-QTR-NBR.         02461412
024615     MOVE PC-TRAILER-FISCAL-PERIOD-NBR TO FF-FISCAL-PERIOD-NBR.   02461512
024616     MOVE PC-TRAILER-FISCAL-WEEK-NBR TO FF-FISCAL-WEEK-NBR.       02461612
024617     WRITE SF-SAS-FISCAL-RECORD                                   02461717
024618         FROM FF-FISCAL-FILE-RECORD.                              02461812
024620     WRITE SF-SAS-FISCAL-RECORD                                   02462017
024630         FROM FF-FISCAL-FILE-END.                                 02463012
024640     CLOSE SAS-FISCAL-FILE.                                       02464018
024650                                                                  02465012
024660     WRITE SY-SAS-YRWK-RECORD                                     02466017
024670         FROM YF-YRWK-FILE-END.                                   02467012
024680     CLOSE SAS-YRWK-FILE.                                         02468017
024700                                                                  02470000
024800     GOBACK.                                                      02480000
024810                                                                  02481002
024811******************************************************************02481115
024812*  INITIALIZE FOR PROGRAM PROCESSING.  ACCEPT AND EDIT CONTROL   *02481215
024813*  CARD, AND DETERMINE THE APPROPRIATE START DATE FOR SAS DATE   *02481315
024814*  REQUESTS BASED ON THE YEAR RANGE PROVIDED IN THE CONTROL CARD.*02481415
024815*  FROM THE RESULTS, SEED THE ENDING FISCAL YEAR, AND THE        *02481515
024816*  STARTING DAYS SINCE THE SAS BASELINE DATE.                    *02481615
024817******************************************************************02481715
024818                                                                  02481815
024820 1000-INITIALIZE.                                                 02482002
024830     ACCEPT CC-CONTROL-CARD                                       02483002
024840     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CONTROL CARD = ('       02484002
024850               CC-CONTROL-CARD-DISPLAY  ')'.                      02485002
024860                                                                  02486002
024870     IF ((NOT CC-PRIOR-FISCAL-YEARS-ID)                           02487002
024880             OR (CC-PRIOR-FISCAL-YEARS NOT NUMERIC)               02488002
024890             OR (NOT CC-FUTURE-FISCAL-YEARS-ID)                   02489002
024891             OR (CC-FUTURE-FISCAL-YEARS NOT NUMERIC))             02489102
024892         DISPLAY '** ABEND **'                                    02489204
024893         DISPLAY PC-CURRENT-PROGRAM-NAME ' - CONTROL CARD ERROR'  02489304
024894         DISPLAY PC-CURRENT-PROGRAM-NAME ' - VERIFY THAT THE '    02489404
024895                   'PROPER ID TAGS ARE PRESENT, AND THAT THE '    02489504
024896                   'NUMBER OF PRIOR AND FUTURE FISCAL YEARS '     02489604
024897                   'REQUESTED ARE NUMERIC'                        02489704
024898         SET AC-CONTROL-CARD-ERROR-4003 TO TRUE                   02489804
024899         CALL 'ILBOABN0' USING ABEND-CODE                         02489904
024900     END-IF.                                                      02490004
024901                                                                  02490104
024902     PERFORM 1100-COMPUTE-START-DATE.                             02490204
024903                                                                  02490304
024904     COMPUTE PV-END-FISCAL-YEAR =                                 02490404
024905               (DPG56-FISCAL-YEAR-CCYY + CC-PRIOR-FISCAL-YEARS +  02490504
024906               PC-CURRENT-FISCAL-YEAR + CC-FUTURE-FISCAL-YEARS)   02490604
024907                                                                  02490704
024908*                                                                 02490815
024909*  SEED THE "DAYS SINCE SAS BASELINE DATE" USING THE RESULT       02490915
024910*  OF THE COMPARISON BETWEEN THE START DATE OF THE REQUEST        02491015
024911*  PERIOD AND THE SAS BASELINE DATE.                              02491115
024912*                                                                 02491215
024913                                                                  02491315
024914     MOVE DPG55-DAYS-DIFFERENCE TO PV-DAYS-SINCE-SAS-BASELINE.    02491415
024915                                                                  02491515
024916     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - STARTING FISCAL YEAR = '02491615
024917               DPG56-FISCAL-YEAR-CCYY.                            02491715
024918     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ENDING FISCAL YEAR = '  02491815
024919               PV-END-FISCAL-YEAR.                                02491915
024920     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - START DATE = '          02492015
024921               DPG55-DB2-ISO-DATE-FMT.                            02492115
024922     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - START DATE DAYS SINCE ' 02492215
024923               'SAS BASELINE DATE = '  PV-DAYS-SINCE-SAS-BASELINE.02492315
024924*1000-EXIT.                                                       02492415
024925                                                                  02492515
024926******************************************************************02492615
024927*  COMPUTE THE START DATE FOR PROCESSING SAS DATE REQUESTS USING *02492715
024928*  THE NUMBER OF PREVIOUS AND FUTURE FISCAL PERIODS REQUESTED IN *02492815
024929*  THE CONTROL CARD.                                             *02492915
024930******************************************************************02493015
024940                                                                  02494015
025000 1100-COMPUTE-START-DATE.                                         02500002
025001                                                                  02500103
025010*                                                                 02501003
025011*  RETURN THE DETAILS FOR THE CURRENT SYSTEM DATE.                02501103
025013*                                                                 02501303
025014                                                                  02501403
025020     INITIALIZE DPG51                                             02502003
025030                DPG52                                             02503003
025040                DPG53                                             02504003
025050                DPG54                                             02505003
025060                DPG55                                             02506003
025070                DPG56.                                            02507003
025100     SET DPG51-FISCAL-JAN-DEC-F2 TO TRUE.                         02510003
025200*    SET DPG52-LK-DTE-ISO TO TRUE.                                02520004
025300*    MOVE FUNCTION CURRENT-DATE (1:8) TO DPG52-DB2-ISO-DATE.      02530004
025400     SET DPG52-LK-DTE-GREG TO TRUE.                               02540004
025401     ACCEPT CD-CURRENT-DATE FROM DATE                             02540104
025410     MOVE CD-CURRENT-YEAR TO DPG52-GREG-DATE-YR.                  02541005
025411     MOVE CD-CURRENT-MONTH TO DPG52-GREG-DATE-MO.                 02541105
025412     MOVE CD-CURRENT-DAY TO DPG52-GREG-DATE-DY.                   02541205
025420                                                                  02542003
025430     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                02543003
025440                                             DPG52                02544003
025450                                             DPG53                02545003
025460                                             DPG54                02546003
025470                                             DPG55                02547003
025480                                             DPG56.               02548003
025490                                                                  02549003
025491     IF ((DPG54-SEVERE-ERROR)                                     02549107
025492             OR (DPG54-WARNING-ERROR))                            02549207
025493         DISPLAY '** ABEND **'                                    02549307
025494         DISPLAY PC-CURRENT-PROGRAM-NAME ' - CALENDAR ROUTINE '   02549407
025495                   'ERROR ON EVALUATING CURRENT SYSTEM DATE'      02549507
025496         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ERROR MESSAGE = '    02549607
025497                   DPG54-ERROR-MESSAGE                            02549707
025498         SET AC-CALENDAR-ROUTINE-ERROR-4019 TO TRUE               02549807
025499         CALL 'ILBOABN0' USING ABEND-CODE                         02549907
025500     END-IF.                                                      02550007
025501                                                                  02550107
025502*                                                                 02550207
025503*  RETURN A DATE WITHIN THE REQUESTED STARTING FISCAL YEAR,       02550307
025504*  BY COUNTING BACK THE REQUESTED NUMBER OF FISCAL YEARS.         02550407
025505*                                                                 02550507
025506                                                                  02550607
025507     PERFORM 1110-DECREMENT-FISCAL-YEAR                           02550707
025508         CC-PRIOR-FISCAL-YEARS TIMES.                             02550807
025509                                                                  02550907
025510*                                                                 02551007
025511*  RETURN THE DETAILS FOR THE FIRST DAY WITHIN THE STARTING       02551107
025512*  FISCAL YEAR AND COMPARE AGAINST THE SAS BASELINE DATE.         02551212
025514*                                                                 02551412
025515                                                                  02551512
025516     INITIALIZE DPG51                                             02551612
025517                DPG52                                             02551712
025518                DPG53.                                            02551812
025519     SET DPG51-FISCAL-JAN-DEC-F2 TO TRUE.                         02551912
025520     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            02552012
025521     MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO DPG52-DB2-ISO-DATE-FMT.   02552112
025522     SET DPG53-LK-CMPR-DTE-ISO-FMT TO TRUE.                       02552212
025523     MOVE PC-SAS-BASELINE-DATE TO DPG53-DB2-ISO-DATE-FMT.         02552312
025524     INITIALIZE DPG54                                             02552412
025525                DPG55                                             02552512
025526                DPG56.                                            02552612
025527                                                                  02552712
025528     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                02552812
025529                                             DPG52                02552912
025530                                             DPG53                02553012
025531                                             DPG54                02553112
025532                                             DPG55                02553212
025533                                             DPG56.               02553312
025534                                                                  02553412
025535     IF ((DPG54-SEVERE-ERROR)                                     02553512
025536             OR (DPG54-WARNING-ERROR))                            02553612
025537         DISPLAY '** ABEND **'                                    02553712
025538         DISPLAY PC-CURRENT-PROGRAM-NAME ' - CALENDAR ROUTINE '   02553812
025539                   'ERROR ON ESTABLISHING THE STARTING DATE'      02553912
025540         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ERROR MESSAGE = '    02554012
025541                   DPG54-ERROR-MESSAGE                            02554112
025542         SET AC-CALENDAR-ROUTINE-ERROR-4019 TO TRUE               02554212
025543         CALL 'ILBOABN0' USING ABEND-CODE                         02554312
025544     END-IF.                                                      02554412
025545*1100-EXIT.                                                       02554512
025546                                                                  02554612
025547******************************************************************02554712
025548*  DECREMENT TO A DATE WITHIN THE PREVIOUS FISCAL YEAR.  SINCE   *02554812
025549*  WHAT DATE IS RETURNED IS NOT IMPORTANT, THIS IS BEING         *02554912
025550*  ACCOMPLISHED BY TAKING THE FIRST DAY OF THE CURRENT FISCAL    *02555012
025551*  YEAR AND DECREMENTING BY 1 DAY TO REACH THE LAST DAY OF THE   *02555112
025552*  PREVIOUS FISCAL YEAR.                                         *02555212
025553******************************************************************02555312
025560                                                                  02556003
025600 1110-DECREMENT-FISCAL-YEAR.                                      02560003
025601     INITIALIZE DPG51                                             02560103
025602                DPG52                                             02560203
025603                DPG53.                                            02560303
025604     SET DPG51-FISCAL-JAN-DEC-F2 TO TRUE.                         02560403
025605     SET DPG51-DECREMENT-DATE TO TRUE.                            02560503
025606     MOVE 1 TO DPG51-INCR-DECR-DAYS-9.                            02560603
025607     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            02560703
025608     MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO DPG52-DB2-ISO-DATE-FMT.   02560803
025609     INITIALIZE DPG54                                             02560903
025610                DPG55                                             02561003
025611                DPG56.                                            02561103
025612                                                                  02561203
025613     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                02561303
025614                                             DPG52                02561403
025615                                             DPG53                02561503
025616                                             DPG54                02561603
025617                                             DPG55                02561703
025618                                             DPG56.               02561803
025619                                                                  02561903
025620     IF ((DPG54-SEVERE-ERROR)                                     02562007
025621             OR (DPG54-WARNING-ERROR))                            02562107
025623         DISPLAY '** ABEND **'                                    02562304
025624         DISPLAY PC-CURRENT-PROGRAM-NAME ' - CALENDAR ROUTINE '   02562403
025625                   'ERROR ON DECREMENT OF A FISCAL YEAR'          02562503
025626         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ERROR MESSAGE = '    02562603
025627                   DPG54-ERROR-MESSAGE                            02562703
025628         SET AC-CALENDAR-ROUTINE-ERROR-4019 TO TRUE               02562803
025629         CALL 'ILBOABN0' USING ABEND-CODE                         02562904
025630     END-IF.                                                      02563003
025631*1110-EXIT.                                                       02563103
025632                                                                  02563203
025633******************************************************************02563315
025634*  PROCESS A GIVEN CALENDAR DAY WITHIN THE SAS DATE REQUEST      *02563415
025635*  PERIOD.  DETERMINE IF THE DAY QUALIFIES FOR ANY OF THE DATE   *02563515
025636*  EXTRACT FILES, AND IF SO, FORMAT THE APPROPRIATE SAS SOURCE   *02563615
025637*  CODE.  INCREMENT BY ONE DAY TO SET UP FOR THE PROCESSING OF   *02563715
025638*  THE NEXT CALENDAR DAY.                                        *02563815
025639******************************************************************02563915
025640                                                                  02564015
025641 2000-PROCESS-CALENDAR-DAY.                                       02564103
025642                                                                  02564203
025656*                                                                 02565616
025657*  "HOLIDAYS" FILE - DATES DATES ON WHICH THE CORPORATE OFFICES   02565716
025658*  ARE NOT OPEN FOR BUSINESS                                      02565816
025659*                                                                 02565916
025660     IF DPG55-CORPORATE-HOLIDAY                                   02566016
025661         MOVE DPG55-GREG-DATE-FMT-YR TO HF-CALENDAR-YEAR          02566116
025662         MOVE DPG55-GREG-DATE-FMT-DY TO HF-CALENDAR-DAY           02566216
025663         MOVE DPG55-ALPHA-MONTH-ABBR3 TO HF-CALENDAR-MONTH-ABBR3  02566316
025664         WRITE SH-SAS-HOLIDAYS-RECORD                             02566417
025665             FROM HF-HOLIDAYS-FILE-DATEPART                       02566516
025666         SET HF-OR-STATEMENT TO TRUE                              02566616
025667     END-IF.                                                      02566716
025668                                                                  02566816
025669*                                                                 02566916
025670*  "WEEKDATE" FILE - THE FIRST FISCAL DAY WITHIN EACH FISCAL YEAR 02567016
025671*  WITHIN THE SAS REQUEST PERIOD                                  02567116
025672*                                                                 02567216
025673     IF DPG56-FISCAL-YEAR-CCYY NOT = PV-LAST-FISCAL-YEAR          02567316
025674         MOVE DPG56-FISCAL-YEAR-NBR TO WF-WHEN-FISCAL-YEAR-NBR    02567416
025675         MOVE DPG56-FIRST-FD-GREG-FMT-MO TO WF-WHEN-MONTH         02567516
025676         MOVE DPG56-FIRST-FD-GREG-FMT-DY TO WF-WHEN-DAY           02567616
025680         MOVE DPG56-FIRST-FD-GREG-FMT-YR TO WF-WHEN-YEAR          02568009
025691         WRITE SW-SAS-WEEKDATE-RECORD                             02569117
025692             FROM WF-WEEKDATE-FILE-WHEN                           02569209
025693         MOVE DPG56-FISCAL-YEAR-CCYY TO PV-LAST-FISCAL-YEAR       02569302
025694     END-IF.                                                      02569402
025695                                                                  02569512
025696*                                                                 02569616
025697*  "FISCAL" FILE - THE FISCAL CHARACTERISTICS OF EACH DAY WITHIN  02569716
025698*  THE SAS REQUEST PERIOD, RELATIVE TO SAS'S DATE FORMAT          02569816
025699*                                                                 02569916
025700                                                                  02570016
025701     MOVE PV-DAYS-SINCE-SAS-BASELINE TO                           02570112
025702               FF-DAYS-SINCE-SAS-BASELINE.                        02570212
025703     MOVE DPG56-FISCAL-YEAR-NBR TO FF-FISCAL-YEAR-NBR.            02570312
025704     MOVE DPG56-FISCAL-QTR-NBR TO FF-FISCAL-QTR-NBR.              02570412
025705     MOVE DPG56-FISCAL-PERIOD-NBR TO FF-FISCAL-PERIOD-NBR.        02570512
025706     MOVE DPG56-FISCAL-WEEK-NBR TO FF-FISCAL-WEEK-NBR             02570612
025707                                                                  02570712
025708     WRITE SF-SAS-FISCAL-RECORD                                   02570817
025709         FROM FF-FISCAL-FILE-RECORD.                              02570912
025710                                                                  02571012
025711*                                                                 02571116
025712*  "YRWK" FILE - THE MONDAY DATE OF EACH FISCAL WEEK WITHIN       02571216
025713*  THE SAS REQUEST PERIOD                                         02571316
025714*                                                                 02571416
025715                                                                  02571516
025716     IF DPG55-ALPHA-WEEK-DAY-MONDAY                               02571612
025717         MOVE DPG56-FISCAL-YEAR-NBR TO YF-FISCAL-YEAR-NBR         02571712
025718         MOVE DPG56-FISCAL-WEEK-NBR TO YF-FISCAL-WEEK-NBR         02571812
025719         MOVE DPG55-GREG-DATE-FMT TO YF-MONDAY-GREG-DATE-FMT      02571913
025720         WRITE SY-SAS-YRWK-RECORD                                 02572017
025721             FROM YF-YRWK-FILE-RECORD                             02572113
025722     END-IF.                                                      02572212
025730                                                                  02573000
025800     INITIALIZE DPG51                                             02580000
025900                DPG52                                             02590000
026000                DPG53.                                            02600003
026800     SET DPG51-FISCAL-JAN-DEC-F2 TO TRUE.                         02680003
026900     SET DPG51-INCREMENT-DATE TO TRUE                             02690003
026910     MOVE 1 TO DPG51-INCR-DECR-DAYS-9.                            02691003
027000     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            02700003
027100     MOVE DPG55-DB2-ISO-DATE-FMT TO DPG52-DB2-ISO-DATE-FMT.       02710003
027810     INITIALIZE DPG54                                             02781003
027820                DPG55                                             02782003
027830                DPG56.                                            02783003
027900                                                                  02790000
028000     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                02800002
028100                                             DPG52                02810002
028110                                             DPG53                02811002
028120                                             DPG54                02812002
028130                                             DPG55                02813002
028200                                             DPG56.               02820002
028300                                                                  02830000
028400     IF ((DPG54-SEVERE-ERROR)                                     02840007
028500             OR (DPG54-WARNING-ERROR))                            02850007
028610         DISPLAY '** ABEND **'                                    02861004
028700         DISPLAY PC-CURRENT-PROGRAM-NAME ' - CALENDAR ROUTINE '   02870002
028710                   'ERROR ON INCREMENT TO THE NEXT DAY'           02871003
028720         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ERROR MESSAGE = '    02872002
028730                   DPG54-ERROR-MESSAGE                            02873002
028800         SET AC-CALENDAR-ROUTINE-ERROR-4019 TO TRUE               02880002
028900         CALL 'ILBOABN0' USING ABEND-CODE                         02890004
029400     END-IF.                                                      02940002
029401                                                                  02940112
029410     ADD +1 TO PV-DAYS-SINCE-SAS-BASELINE.                        02941012
029500*2000-EXIT.                                                       02950003
