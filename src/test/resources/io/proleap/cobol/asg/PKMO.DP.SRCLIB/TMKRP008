000100 IDENTIFICATION DIVISION.                                         00010048
000200                                                                  00020000
000300 PROGRAM-ID.             TMKRP008.                                00030000
000400 AUTHOR.                 TAMARA KOLTUN.                           00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            10/09/96.                                00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000810******************************************************************00081045
000820*  THIS PROGRAM USES XLKUT071 - LOCATION DOMAIN MODULE            00082045
000830******************************************************************00083045
000840                                                                  00084045
000900 ENVIRONMENT DIVISION.                                            00090000
001000 INPUT-OUTPUT SECTION.                                            00100000
001100                                                                  00110000
001200 FILE-CONTROL.                                                    00120000
001300                                                                  00130000
001400     SELECT TROUBLE-EXTRACT-FILE       ASSIGN TO INP01.           00140000
001500     SELECT DAILY-DIV-TRBL-SUM-BUY-RPT ASSIGN TO RPT01.           00150039
001600     SELECT DAILY-DIV-TRBL-SUM-MER-RPT ASSIGN TO RPT02.           00160041
001700     SELECT DAILY-DIV-TRBL-SUM-LOG-RPT ASSIGN TO RPT03.           00170041
001800                                                                  00180000
001900                                                                  00190000
002000 DATA DIVISION.                                                   00200000
002100                                                                  00210000
002200 FILE SECTION.                                                    00220000
002300 FD  TROUBLE-EXTRACT-FILE                                         00230000
002400     RECORDING MODE IS F                                          00240000
002500     LABEL RECORDS ARE STANDARD                                   00250000
002600     BLOCK CONTAINS 0 RECORDS.                                    00260000
002700                                                                  00270000
002800 01  TROUBLE-EXTRACT-RECORD         PIC X(400).                   00280000
002900                                                                  00290000
003000 FD  DAILY-DIV-TRBL-SUM-BUY-RPT                                   00300039
003100     RECORDING MODE IS F                                          00310000
003200     LABEL RECORDS ARE STANDARD                                   00320000
003300     BLOCK CONTAINS 0 RECORDS.                                    00330000
003400                                                                  00340000
003500 01  DAILY-DIV-TRBL-SUM-BUY-REC     PIC X(132).                   00350039
003600                                                                  00360039
003700 FD  DAILY-DIV-TRBL-SUM-MER-RPT                                   00370039
003800     RECORDING MODE IS F                                          00380039
003900     LABEL RECORDS ARE STANDARD                                   00390039
004000     BLOCK CONTAINS 0 RECORDS.                                    00400039
004100                                                                  00410039
004200 01  DAILY-DIV-TRBL-SUM-MER-REC     PIC X(132).                   00420039
004300                                                                  00430039
004400 FD  DAILY-DIV-TRBL-SUM-LOG-RPT                                   00440039
004500     RECORDING MODE IS F                                          00450039
004600     LABEL RECORDS ARE STANDARD                                   00460039
004700     BLOCK CONTAINS 0 RECORDS.                                    00470039
004800                                                                  00480039
004900 01  DAILY-DIV-TRBL-SUM-LOG-REC     PIC X(132).                   00490039
005000                                                                  00500039
005100 WORKING-STORAGE SECTION.                                         00510039
005200 01  PS-SWITCHES.                                                 00520039
005300     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     00530039
005400         88  PS-EOF                                VALUE 'Y'.     00540039
005500         88  PS-NOT-EOF                            VALUE 'N'.     00550039
005600     05  PS-REPORT-SW                PIC  X(01)    VALUE ' '.     00560039
005700         88  PS-TROUBLE-ASSIGNED-RPT               VALUE 'A'.     00570039
005800         88  PS-TOP-TROUBLE-RPT                    VALUE 'T'.     00580039
005900         88  PS-UNRESOLVED-TRBLS-RPT               VALUE 'U'.     00590039
006000     05  PS-FIRST-DMM-SW             PIC  X(01)    VALUE 'F'.     00600039
006100         88  PS-FIRST-DMM                          VALUE 'F'.     00610039
006200         88  PS-NOT-FIRST-DMM                      VALUE 'N'.     00620039
006300     05  PS-FIRST-ANAL-SW            PIC  X(01)    VALUE 'F'.     00630039
006400         88  PS-FIRST-ANAL                         VALUE 'F'.     00640039
006500         88  PS-NOT-FIRST-ANAL                     VALUE 'N'.     00650039
006600     05 PS-FIRST-PROCESS-AREA-SW     PIC X(01)     VALUE 'F'.     00660039
006700         88  PS-FIRST-PROCESS-AREA                 VALUE 'F'.     00670039
006800         88  PS-NOT-FIRST-PROCESS-AREA             VALUE 'N'.     00680039
006900     05  PS-AREA-SW                  PIC  X(01)    VALUE ' '.     00690039
007000         88  PS-AREA-BUYING                        VALUE 'D'.     00700039
007100         88  PS-AREA-MERCH                         VALUE 'A'.     00710039
007200         88  PS-AREA-LOGISTICS                     VALUE 'L'.     00720039
007300     05  PS-FIRST-CM-RECORD-SW       PIC  X(01)    VALUE 'F'.     00730039
007400         88  PS-FIRST-CM-RECORD                    VALUE 'F'.     00740039
007500         88  PS-NOT-FIRST-CM-RECORD                VALUE ' '.     00750039
007600     05 PS-FIRST-UNRSLVED-DETAIL-SW     PIC X(01)  VALUE 'F'.     00760039
007700        88 PS-FIRST-UNRSLVED-DETAIL                VALUE 'F'.     00770039
007800        88 PS-NOT-FIRST-UNRSLVD-DETAIL             VALUE ' '.     00780039
007900     05 PS-FIRST-TIME-THRU-SW           PIC X(01)  VALUE 'F'.     00790039
008000        88 PS-FIRST-TIME-THRU                      VALUE 'F'.     00800039
008100        88 PS-NOT-FIRST-TIME-THRU                  VALUE ' '.     00810039
008200 01  PC-PROGRAM-CONSTANTS.                                        00820000
008300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00830000
008400                                    'TMKRP008'.                   00840000
008500     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00850000
008600                                                   COMP SYNC.     00860000
008700     05  PC-SPECIAL-RUN-NOTE         PIC X(27)     VALUE          00870000
008800                                    '** SPECIAL REQUESTED RUN **'.00880000
008900     05  PC-ONE                      PIC 9(01)     VALUE  1.      00890000
009000     05  PC-TWO                      PIC 9(01)     VALUE  2.      00900035
009100     05  PC-THREE                    PIC 9(01)     VALUE  3.      00910035
009200     05  PC-NOT-FOUND                PIC X(05)     VALUE          00920035
009300                                                  'NTFND'.        00930035
009400     05  PC-TBL-MAX               PIC 9(03)   VALUE 250.          00940035
009500     05  PC-AREA-DMM              PIC X(03)   VALUE 'DMM'.        00950035
009600     05  PC-AREA-ANAL             PIC X(15)   VALUE               00960035
009700                                              'ANALIST MGR'.      00970035
009800     05  PC-PROCESS-AREA          PIC X(12)   VALUE               00980035
009900                                              'PROCESS AREA'.     00990035
010000  01 PV-PROGRAM-VARIABLES.                                        01000035
010100     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01010035
010200                                                   COMP SYNC.     01020035
010300     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01030035
010310     05  PV-ABEND-SQLCODE            PIC  X(10)    VALUE SPACES.  01031046
010400     05  PV-BUY-LINE-COUNT           PIC S9(04)    VALUE +80      01040039
010500                                                   COMP SYNC.     01050035
010600     05  PV-MER-LINE-COUNT           PIC S9(04)    VALUE +80      01060039
010700                                                   COMP SYNC.     01070039
010800     05  PV-LOG-LINE-COUNT           PIC S9(04)    VALUE +80      01080039
010900                                                   COMP SYNC.     01090039
011000     05  PV-BUY-PAGE-COUNT           PIC S9(04)    VALUE 0        01100039
011100                                                   COMP SYNC.     01110035
011200     05  PV-MER-PAGE-COUNT           PIC S9(04)    VALUE 0        01120039
011300                                                   COMP SYNC.     01130039
011400     05  PV-LOG-PAGE-COUNT           PIC S9(04)    VALUE 0        01140039
011500                                                   COMP SYNC.     01150039
011600     05  PV-TOP-TRBLS-COUNT          PIC S9(10)    VALUE 1        01160035
011700                                                   COMP-3.        01170035
011800     05  PV-VER-REC-COUNT            PIC S9(10)    VALUE 0        01180035
011900                                                   COMP-3.        01190035
012000     05  PV-DETAIL-COUNT             PIC S9(10)    VALUE 0        01200035
012100                                                   COMP-3.        01210035
012200     05  PV-CURRENT-DATE             PIC  X(10)    VALUE SPACE.   01220045
012210     05  PV-START-DATE               PIC  X(08)    VALUE SPACE.   01221045
012300     05  PV-END-DATE                 PIC  X(08)    VALUE SPACE.   01230035
012400     05  PV-START-EXTRACT.                                        01240035
012500         10 PV-START-YYYY.                                        01250035
012600            15 PV-START-CC           PIC 9(02)     VALUE 0.       01260035
012700            15 PV-START-YY           PIC 9(02)     VALUE 0.       01270035
012800         10 FILLER                   PIC X(01)     VALUE SPACE.   01280035
012900         10 PV-START-MM              PIC 9(02)     VALUE 0.       01290035
013000         10 FILLER                   PIC X(01)     VALUE SPACE.   01300035
013100         10 PV-START-DD              PIC 9(02)     VALUE 0.       01310035
013200         10 FILLER                   PIC X(01)     VALUE SPACE.   01320035
013300     05  PV-START-EXTRACT-MMDDYY.                                 01330035
013400         10 PV-START-EXTR-MM         PIC 9(02)     VALUE 0.       01340035
013500         10 PV-START-EXTR-DD         PIC 9(02)     VALUE 0.       01350035
013600         10 PV-START-EXTR-YY         PIC 9(02)     VALUE 0.       01360035
013700     05  PV-END-EXTRACT.                                          01370035
013800         10 PV-END-YYYY.                                          01380035
013900            15 PV-END-CC             PIC 9(02)     VALUE 0.       01390035
014000            15 PV-END-YY             PIC 9(02)     VALUE 0.       01400035
014100         10 FILLER                   PIC X(01)     VALUE SPACE.   01410035
014200         10 PV-END-MM                PIC 9(02)     VALUE 0.       01420035
014300         10 FILLER                   PIC X(01)     VALUE SPACE.   01430035
014400         10 PV-END-DD                PIC 9(02)     VALUE 0.       01440035
014500         10 FILLER                   PIC X(01)     VALUE SPACE.   01450035
014600     05  PV-END-EXTRACT-MMDDYY.                                   01460035
014700         10 PV-END-EXTR-MM           PIC 9(02)     VALUE 0.       01470035
014800         10 PV-END-EXTR-DD           PIC 9(02)     VALUE 0.       01480035
014900         10 PV-END-EXTR-YY           PIC 9(02)     VALUE 0.       01490035
015000     05  PV-REPORT-DATE              PIC X(10)     VALUE SPACE.   01500035
015100     05  PV-AVG-TOT-HOURS            PIC 9(10)     VALUE 0.       01510035
015200     05  PV-AVG-TOT-MINUTES          PIC 9(10)     VALUE 0.       01520035
015300     05  PV-AVG-MINUTES              PIC 9(10)     VALUE 0.       01530035
015400     05  PV-DMM-SAVE                PIC  X(02)   VALUE SPACES.    01540035
015500     05  PV-DMM-NAME-SAVE           PIC  X(30)   VALUE 'XXXX'.    01550035
015600     05  PV-ANAL-NAME-SAVE          PIC  X(30)   VALUE 'XXXX'.    01560035
015700     05  PV-TRBL-RSN-CDE-DESC-SAVE  PIC  X(20)   VALUE SPACES.    01570035
015800     05  PV-FCLTY-AREA-ID-SAVE      PIC  X(06)   VALUE SPACES.    01580035
015900     05  PV-PO-NBR-SAVE             PIC S9(9)    VALUE 0 COMP.    01590035
016000     05  PV-REC-SEQ-NBR-SAVE        PIC S9(9)    VALUE 0 COMP.    01600035
016100     05  PV-TRBL-RSN-CDE-SAVE       PIC S9(4)    VALUE 0 COMP.    01610035
016200     05  PV-TOT-MDS-TRBL-SAVE       PIC S9(7)    VALUE 0 COMP-3.  01620035
016300     05  PV-TOT-LOG-TRBL-SAVE       PIC S9(7)    VALUE 0 COMP-3.  01630035
016400     05  PV-RSN-CDE-TOT-QTY-SAVE    PIC S9(7)    VALUE 0 COMP-3.  01640035
016500     05  PV-NOTIF-DATE-SAVE         PIC  X(8)    VALUE SPACES.    01650035
017000     05  PV-PER-TO-TOT              PIC 9(3)V99  VALUE 0 COMP-3.  01700035
017100     05  PV-PER-OF-VER-REC          PIC 9(3)V99  VALUE 0 COMP-3.  01710035
017200     05  PV-ANAL-NAME-HOLD          PIC X(30)    VALUE SPACES.    01720035
017300     05  PV-RPT-AREA-SAVE           PIC X(01)    VALUE 'B'.       01730035
017400         88 PV-AREA-SAVE-BUYING VALUE 'B'.                        01740035
017500         88 PV-AREA-SAVE-ANAL   VALUE 'A'.                        01750035
017600         88 PV-AREA-SAVE-DC     VALUE 'D'.                        01760035
018000                                                                  01800035
018100 01  CT-CPU-TIME.                                                 01810035
018200     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    01820035
018300     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    01830035
018400     03  FILLER                      PIC  9(04)    VALUE ZERO.    01840035
018500                                                                  01850035
018600 01  CD-CPU-DATE.                                                 01860035
018700     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    01870035
018800     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    01880035
018900     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    01890035
019000                                                                  01900035
019100 01  UTT-UNRESOLVED-TROUBLE-TABLE.                                01910035
019200     05 UTT-UNRESOLVED-TRBL-ENTRY OCCURS 250 TIMES                01920035
019300                                  INDEXED BY UTT-INX.             01930035
019400       10  UTT-AREA                  PIC  X(12) VALUE SPACES.     01940035
019500       10  UTT-DMM-NBR               PIC  X(03) VALUE ZERO.       01950035
019600       10  UTT-NAME                  PIC  X(30) VALUE ZERO.       01960035
019700       10  UTT-TRBL-RSN-CDE          PIC S9(4)  VALUE 0 COMP.     01970035
019800       10  UTT-TRBL-RSN-CDE-DESC     PIC  X(30) VALUE SPACES.     01980035
019900       10  UTT-NBR-UNRSLVED-TRBLS    PIC  9(05) VALUE 0 COMP-3.   01990035
020000                                                                  02000035
020100                                                                  02010035
020200 01  PA-PROGRAM-ACCUMULATORS.                                     02020035
020300     05  PA-RESOLVE-HOURS            PIC  S9(10)  VALUE 0 COMP-3. 02030035
020400     05  PA-RESOLVE-MINUTES          PIC  S9(10)  VALUE 0 COMP-3. 02040035
020500     05  PA-TOT-TRBLS                PIC  S9(10)  VALUE 0 COMP-3. 02050035
020600     05  PA-TOT-OF-PRBLMS            PIC  S9(10)  VALUE 0 COMP-3. 02060035
020700     05  PA-NBR-OF-RESOLVED-TRBLS    PIC  S9(10)  VALUE 0 COMP-3. 02070035
020800     05  PA-NBR-UNRESOLVED-TRBLS     PIC  S9(10)  VALUE 0 COMP-3. 02080035
020900     05  PA-TOT-UNRESLVED-TRBLS      PIC  S9(10)  VALUE 0 COMP-3. 02090035
021000                                                                  02100035
021100     COPY DPWS132O.                                               02110035
021200                                                                  02120035
021300 01  HL1-HEADING-LINE-1.                                          02130035
021400     05  FILLER                      PIC  X(02)    VALUE SPACES.  02140035
021500     05  HL1-SPECIAL-RUN-NOTE        PIC  X(27)    VALUE SPACES.  02150035
021600     05  FILLER                      PIC  X(23)    VALUE SPACES.  02160035
021700     05  FILLER                      PIC  X(29)    VALUE          02170035
021800                                 '   DAILY DIVISIONAL SUMMARY  '. 02180035
021900     05  FILLER                      PIC  X(51)    VALUE SPACES.  02190035
022000                                                                  02200035
022100 01  HL2-HEADING-LINE-2.                                          02210035
022200     05  FILLER                      PIC  X(64)   VALUE SPACES.   02220035
022300     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  02230035
022400     05  FILLER                      PIC  X(32)   VALUE SPACES.   02240035
022500     05  FILLER                      PIC  X(07)   VALUE 'AVERAGE'.02250035
022600     05  FILLER                      PIC  X(36)   VALUE SPACES.   02260035
022700                                                                  02270035
022800 01  HL3-HEADING-LINE-3.                                          02280035
022900     05  FILLER                      PIC  X(06)    VALUE SPACES.  02290035
023000     05  FILLER                      PIC  X(04)    VALUE 'AREA'.  02300035
023100     05  FILLER                      PIC  X(49)    VALUE SPACE.   02310035
023200     05  FILLER                      PIC  X(16)    VALUE          02320035
023300                                              'TROUBLE CREATED '. 02330035
023400     05  FILLER                      PIC  X(05)    VALUE SPACES.  02340035
023500     05  FILLER                      PIC  X(10)    VALUE          02350035
023600                                                   '% TO TOTAL'.  02360035
023700     05  FILLER                      PIC  X(07)    VALUE SPACES.  02370035
023800     05  FILLER                      PIC  X(15)    VALUE          02380035
023900                                              'TIME TO RESOLVE'.  02390035
024000     05  FILLER                      PIC  X(27)    VALUE SPACES.  02400035
024100                                                                  02410035
024200 01  HL4-HEADING-LINE-4.                                          02420035
024300     05  FILLER                      PIC  X(02)    VALUE SPACES.  02430035
024400     05  FILLER                      PIC  X(21)    VALUE          02440035
024500                                         'TOP 5 TROUBLE REASONS'. 02450035
024600     05  FILLER                      PIC  X(109)   VALUE SPACE.   02460035
024700                                                                  02470035
024800 01  HL5-HEADING-LINE-5.                                          02480035
024900     05  FILLER                      PIC  X(06)    VALUE SPACES.  02490035
025000     05  FILLER                      PIC  X(07)    VALUE          02500035
025100                                                     'TROUBLE'.   02510035
025200     05  FILLER                      PIC  X(34)    VALUE SPACE.   02520035
025300     05  FILLER                      PIC  X(08)    VALUE          02530035
025400                                                     'CREATED '.  02540035
025500     05  FILLER                      PIC  X(86)    VALUE SPACES.  02550035
025600                                                                  02560035
025700 01  HL6-HEADING-LINE-6.                                          02570035
025800     05  FILLER                      PIC  X(06)    VALUE SPACES.  02580035
025900     05  FILLER                      PIC  X(06)    VALUE 'REASON'.02590035
026000     05  FILLER                      PIC  X(08)    VALUE SPACE.   02600035
026100     05  FILLER                      PIC  X(19)    VALUE          02610035
026200                                            'TROUBLE DESCRIPTION'.02620035
026300     05  FILLER                      PIC  X(08)    VALUE SPACES.  02630035
026400     05  FILLER                      PIC  X(08)    VALUE          02640035
026500                                            'QUANTITY'.           02650035
026600     05  FILLER                      PIC  X(07)    VALUE SPACES.  02660035
026700     05  FILLER                      PIC  X(10)    VALUE          02670035
026800                                            '% TO TOTAL'.         02680035
026900     05  FILLER                      PIC  X(52)    VALUE SPACES.  02690035
027000 01  HL7-HEADING-LINE-7.                                          02700035
027100     05  FILLER                      PIC  X(64)   VALUE SPACES.   02710035
027200     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  02720035
027300     05  FILLER                      PIC  X(71)   VALUE SPACES.   02730035
027400                                                                  02740035
027500 01  HL8-HEADING-LINE-8.                                          02750035
027600     05  FILLER                      PIC  X(06)    VALUE SPACES.  02760035
027700     05  FILLER                      PIC  X(04)    VALUE 'AREA'.  02770035
027800     05  FILLER                      PIC  X(49)    VALUE SPACE.   02780035
027900     05  FILLER                      PIC  X(18)    VALUE          02790035
028000                                             'UNRESOLVED TROUBLE'.02800035
028100     05  FILLER                      PIC  X(66)    VALUE SPACES.  02810035
028200                                                                  02820035
028300 01  HL9-HEADING-LINE-9.                                          02830035
028400     05  FILLER                      PIC  X(02)    VALUE SPACES.  02840035
028500     05  FILLER                      PIC  X(60)    VALUE SPACES.  02850035
028600     05  FILLER                      PIC  X(09)    VALUE          02860035
028700                                                    'LOGISTICS'.  02870035
028800     05  FILLER                      PIC  X(61)    VALUE SPACES.  02880035
028900                                                                  02890035
029000 01  HL10-HEADING-LINE-10.                                        02900035
029100     05  FILLER                      PIC  X(02)    VALUE SPACES.  02910035
029200     05  FILLER                      PIC  X(58)    VALUE SPACES.  02920035
029300     05  FILLER                      PIC  X(13)    VALUE          02930035
029400                                                'MERCHANDISING'.  02940035
029500     05  FILLER                      PIC  X(59)    VALUE SPACES.  02950035
029600                                                                  02960035
029700 01  HL11-HEADING-LINE-11.                                        02970035
029800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02980035
029900     05  FILLER                      PIC  X(58)    VALUE SPACES.  02990035
030000     05  FILLER                      PIC  X(13)    VALUE          03000035
030100                                                '   BUYING    '.  03010035
030200     05  FILLER                      PIC  X(59)    VALUE SPACES.  03020035
030300                                                                  03030035
030400 01  HL12-HEADING-LINE-12.                                        03040035
030500     05  FILLER                      PIC  X(02)  VALUE SPACES.    03050035
030600     05  FILLER                      PIC  X(04)  VALUE  'GMM:'.   03060035
030700     05  FILLER                      PIC  X(02)  VALUE SPACES.    03070035
030800     05  HL12-GMM-NBR                PIC  X(03)  VALUE SPACES.    03080035
030900     05  FILLER                      PIC  X(03)  VALUE ' - '.     03090035
031000     05  HL12-GMM-NAME               PIC  X(30)  VALUE SPACES.    03100035
031100     05  FILLER                      PIC  X(98)  VALUE SPACES.    03110035
031200                                                                  03120035
031300 01  HL13-HEADING-LINE-13.                                        03130035
031400     05  FILLER                      PIC  X(02)  VALUE SPACES.    03140035
031500     05  FILLER                      PIC  X(03)  VALUE  'DC:'.    03150035
031600     05  FILLER                      PIC  X(02)  VALUE SPACE.     03160035
031700     05  HL13-DC-NAME                PIC  X(05)  VALUE SPACE.     03170035
031800     05  FILLER                      PIC  X(107) VALUE SPACES.    03180035
031900                                                                  03190035
032000 01  DL-DMM-INFO.                                                 03200035
032100     05  DL-DMM-AREA               PIC  X(03)    VALUE 'DMM'.     03210035
032200     05  FILLER                    PIC  X(08)    VALUE ' -      '.03220035
032300     05  DL-DMM-NBR                PIC  X(03)    VALUE SPACES.    03230035
032400     05  FILLER                    PIC  X(01)    VALUE SPACE.     03240035
032500                                                                  03250035
032600 01  DL-ANALYST-INFO.                                             03260035
032700     05  DL-ANALYST-AREA           PIC  X(11)    VALUE            03270035
032800                                   'ANALYST MGR'.                 03280035
032900     05  FILLER                    PIC  X(04)    VALUE ' -  '.    03290035
033000                                                                  03300035
033100 01  DL-PROCESS-AREA-INFO.                                        03310035
033200     05  DL-ANALYST-AREA           PIC  X(12)    VALUE            03320035
033300                                   'PROCESS AREA'.                03330035
033400     05  FILLER                    PIC  X(03)    VALUE ' - '.     03340035
033500                                                                  03350035
033600                                                                  03360035
033700 01  DL1-DETAIL-LINE-1.                                           03370035
033800     05  FILLER                      PIC  X(06)    VALUE SPACES.  03380035
033900     05  DL1-INFO                    PIC  X(15)    VALUE SPACES.  03390035
034000     05  DL1-NAME                    PIC  X(30)    VALUE SPACES.  03400035
034100     05  FILLER                      PIC  X(15)    VALUE SPACE.   03410035
034200     05  DL1-TOT-ASSIGNED-TRBLS      PIC  ZZ,ZZ9   VALUE ZEROS.   03420035
034300     05  FILLER                      PIC  X(12)    VALUE SPACE.   03430035
034400     05  DL1-PER-TO-TOT              PIC  ZZ9.99   VALUE ZEROS.   03440035
034500     05  FILLER                      PIC  X(14)    VALUE SPACE.   03450035
034600     05  DL1-AVG-RESOLVE-HHH         PIC  Z(2)9    VALUE ZEROS.   03460035
034700     05  FILLER                      PIC  X(01)    VALUE ':'.     03470035
034800     05  DL1-AVG-RESOLVE-MM          PIC  9(02)    VALUE ZEROS.   03480035
034900     05  FILLER                      PIC  X(24)    VALUE SPACE.   03490035
035000                                                                  03500035
035100 01  DL2-DETAIL-LINE-2.                                           03510035
035200     05  FILLER                      PIC  X(08)    VALUE SPACES.  03520035
035300     05  DL2-TROUBLE-NBR             PIC  Z(3)9    VALUE ZEROS.   03530035
035400     05  FILLER                      PIC  X(08)    VALUE SPACES.  03540035
035500     05  DL2-TROUBLE-DESCRIPTION     PIC  X(20)    VALUE SPACES.  03550035
035600     05  FILLER                      PIC  X(08)    VALUE SPACE.   03560035
035700     05  DL2-ASSIGNED-QTY            PIC  ZZ,ZZ9   VALUE ZEROS.   03570035
035800     05  FILLER                      PIC  X(11)    VALUE SPACE.   03580035
035900     05  DL2-PER-TO-TOTAL            PIC  ZZ9.99   VALUE ZEROS.   03590035
036000     05  FILLER                      PIC  X(61)    VALUE SPACE.   03600035
036100                                                                  03610035
036200 01  DL3-DETAIL-LINE-3.                                           03620035
036300     05  FILLER                      PIC  X(06)    VALUE SPACES.  03630035
036400     05  DL3-INFO                    PIC  X(15)    VALUE SPACES.  03640035
036500     05  DL3-NAME                    PIC  X(30)    VALUE SPACES.  03650035
036600     05  FILLER                      PIC  X(10)    VALUE SPACE.   03660035
036700     05  DL3-TOT-ASSIGNED-TRBLS      PIC  ZZ,ZZ9   VALUE ZEROS.   03670035
036800     05  FILLER                      PIC  X(72)    VALUE SPACE.   03680035
036900                                                                  03690035
037000 01  TL1-TOTAL-LINE-1.                                            03700035
037100     05  FILLER                      PIC X(02)  VALUE SPACES.     03710035
037200     05  FILLER                      PIC X(26)  VALUE             03720035
037300                                   'TOTAL TROUBLE CREATED FOR '.  03730035
037400     05  TL1-DATE                    PIC X(10)  VALUE SPACES.     03740035
037500     05  FILLER                      PIC X(03)  VALUE ' - '.      03750035
037600     05  TL1-TROUBLE-TOTAL           PIC Z(02),Z(02)9.            03760035
037700     05  FILLER                      PIC X(77)  VALUE SPACE.      03770035
037800                                                                  03780035
037900 01  TL2-TOTAL-LINE-2.                                            03790035
038000     05  FILLER                      PIC X(02)   VALUE SPACES.    03800035
038100     05  FILLER                      PIC X(31)   VALUE            03810035
038200                            'TOTAL UNRESOLVED TROUBLE AS OF '.    03820035
038300     05  TL2-DATE                    PIC X(10)   VALUE SPACES.    03830035
038400     05  FILLER                      PIC X(03)   VALUE ' - '.     03840035
038500     05  TL2-UNRSLVED-TRBL-TOT       PIC ZZZ,ZZ9 VALUE SPACES.    03850035
038600     05  FILLER                      PIC X(79)   VALUE SPACES.    03860035
038700                                                                  03870000
038800 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  03880000
038900 01  ER-END-REPORT-LINE.                                          03890000
039000     05  FILLER                      PIC X(02)  VALUE SPACE.      03900000
039100     05  FILLER                      PIC X(16)  VALUE             03910000
039200                                     '** END REPORT **'.          03920000
039300     05  FILLER                      PIC X(116) VALUE SPACE.      03930000
039400                                                                  03940000
039500 01  ND-NO-DATA-LINE.                                             03950031
039600     05  FILLER                      PIC X(02)  VALUE SPACE.      03960031
039700     05  FILLER                      PIC X(39)  VALUE             03970031
039800                       'THERE IS NO DATA TO REPORT AT THIS TIME'. 03980031
039900     05  FILLER                      PIC X(91) VALUE SPACE.       03990031
040000                                                                  04000031
040100 01  PR-PRINT-FINAL.                                              04010000
040200     05  FILLER                      PIC X(53)  VALUE SPACES.     04020000
040300     05  FILLER                      PIC X(21)  VALUE             04030000
040400         '*** END OF REPORT ***'.                                 04040000
040500                                                                  04050000
040600     COPY DPWS004.                                                04060000
040700                                                                  04070000
040800     COPY TMRD001.                                                04080000
040900                                                                  04090045
041000** COPYBOOK FOR LOCATION CALLED MODULE - XLKUT071                 04100045
041010     COPY XLWS071.                                                04101045
041030                                                                  04103045
041700*---------------------------------------------------------------* 04170000
041800*    DB2 AREA FOR COMMUNICATIONS                                * 04180000
041900*---------------------------------------------------------------* 04190000
042000     EXEC SQL                                                     04200000
042100          INCLUDE SQLCA                                           04210000
042200     END-EXEC.                                                    04220000
042300***************************************************************** 04230000
042400 PROCEDURE DIVISION.                                              04240000
042500***************************************************************** 04250000
042600                                                                  04260000
042700 0000-MAINLINE.                                                   04270000
042800***************************************************************** 04280000
042900*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 04290000
043000***************************************************************** 04300000
043100     PERFORM 1000-INITIALIZE.                                     04310000
043200                                                                  04320000
043300     SET PS-NOT-EOF   TO TRUE.                                    04330000
043400     PERFORM 2000-MAIN-PROCESS                                    04340000
043500           UNTIL  PS-EOF.                                         04350000
043600                                                                  04360000
043700                                                                  04370000
043800     PERFORM 9000-END-PROCESS                  THRU 9000-EXIT.    04380000
043900                                                                  04390000
044000 0000-EXIT.  STOP RUN.                                            04400000
044100                                                                  04410000
044200 1000-INITIALIZE.                                                 04420000
044300      OPEN INPUT  TROUBLE-EXTRACT-FILE                            04430000
044400      OPEN OUTPUT DAILY-DIV-TRBL-SUM-BUY-RPT                      04440039
044500                  DAILY-DIV-TRBL-SUM-MER-RPT                      04450042
044600                  DAILY-DIV-TRBL-SUM-LOG-RPT                      04460042
044700**** READING THE HEADER RECORD.                                   04470000
044800      READ TROUBLE-EXTRACT-FILE    INTO                           04480000
044900                                  TM001-TROUBLE-EXT-RECORD        04490000
045000          AT END                                                  04500000
045100             SET PS-EOF TO TRUE                                   04510000
045200          NOT AT END                                              04520000
045300             MOVE TM001-RUN-BEGIN-DATE  TO PV-START-EXTRACT       04530000
045400             MOVE TM001-RUN-END-DATE    TO PV-END-EXTRACT         04540000
045500             STRING                                               04550000
045600                   PV-START-MM                                    04560000
045700                   '/'                                            04570000
045800                   PV-START-DD                                    04580000
045900                   '/'                                            04590000
046000                   PV-START-YYYY                                  04600000
046100                DELIMITED BY SIZE                                 04610000
046200                INTO PV-REPORT-DATE                               04620000
046300              END-STRING                                          04630000
046400             STRING                                               04640000
046500                   PV-START-YYYY                                  04650000
046600                   PV-START-MM                                    04660000
046700                   PV-START-DD                                    04670000
046800                DELIMITED BY SIZE                                 04680000
046900                INTO PV-START-DATE                                04690000
047000             END-STRING                                           04700000
047100             STRING                                               04710000
047200                   PV-END-YYYY                                    04720000
047300                   PV-END-MM                                      04730000
047400                   PV-END-DD                                      04740000
047500                DELIMITED BY SIZE                                 04750000
047600                INTO PV-END-DATE                                  04760000
047700             END-STRING                                           04770000
047800             MOVE PV-REPORT-DATE     TO TL1-DATE                  04780000
047900                                        TL2-DATE                  04790000
048000     END-READ.                                                    04800000
048100                                                                  04810000
048110** PV-CURRENT-DATE NOT USED, INCLUDED TO KEEP PROGRAM DB2         04811045
048120**  WITHOUT CHANGING JCL TO NON-DB2 PROGRAM                       04812045
048130     EXEC SQL                                                     04813045
048140         SET :PV-CURRENT-DATE = CURRENT DATE                      04814045
048150     END-EXEC.                                                    04815045
048160                                                                  04816045
048200     ACCEPT CT-CPU-TIME          FROM TIME.                       04820000
048300     MOVE   CT-HOUR              TO DP132O-RUN-HOUR.              04830000
048400     MOVE   CT-MINUTE            TO DP132O-RUN-MINUTE.            04840000
048500                                                                  04850000
048600     ACCEPT CD-CPU-DATE          FROM DATE.                       04860000
048700     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              04870000
048800     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             04880000
048900     MOVE CD-DAY                 TO DP132O-RUN-DAY.               04890000
049000                                                                  04900000
049100     MOVE 'TMKRP008'             TO DP132O-PROGRAM-NAME.          04910000
049200                                                                  04920000
049300     IF TM001-RUN-SPECIAL                                         04930000
049400        MOVE PC-SPECIAL-RUN-NOTE TO HL1-SPECIAL-RUN-NOTE          04940000
049500     ELSE                                                         04950000
049600        MOVE SPACE               TO HL1-SPECIAL-RUN-NOTE          04960000
049700     END-IF.                                                      04970000
049800                                                                  04980000
049900     MOVE LOW-VALUES  TO UTT-UNRESOLVED-TROUBLE-TABLE.            04990000
050000     SET UTT-INX   TO  1.                                         05000000
050100                                                                  05010000
050200 1000-EXIT.  EXIT.                                                05020000
050300                                                                  05030000
050400 2000-MAIN-PROCESS.                                               05040000
050500      READ TROUBLE-EXTRACT-FILE    INTO                           05050000
050600                                  TM001-TROUBLE-EXT-RECORD        05060000
050700          AT END                                                  05070000
050800             PERFORM 3000-WRITE-UNRESOLVED-TRBL-RPT               05080019
050900                                               THRU 3000-EXIT     05090019
051000             SET PS-EOF TO TRUE                                   05100000
051100          NOT AT END                                              05110000
051200             EVALUATE TRUE                                        05120000
051300               WHEN TM001-RECORD-TYPE-BYGMMTOT                    05130000
051400               WHEN TM001-RECORD-TYPE-MDSTOT                      05140000
051500               WHEN TM001-RECORD-TYPE-BYDCTOT                     05150000
051600                  PERFORM 2100-START-REPORT         THRU 2100-EXIT05160000
051700               WHEN TM001-RECORD-TYPE-DETAIL                      05170000
051800                  PERFORM 2200-SUMMARY-AREAS-REPORTS              05180002
051900                                                   THRU 2200-EXIT 05190002
052000               WHEN TM001-RECORD-TYPE-RSNTOT                      05200000
052100                  IF PS-FIRST-CM-RECORD                           05210001
052200                     PERFORM 6000-WRITE-DETAIL-LINE               05220004
052300                                                THRU 6000-EXIT    05230004
052400                     PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL        05240020
052500                                                THRU 2230-EXIT    05250020
052600                  END-IF                                          05260001
052700                  PERFORM 2300-TOP-TROUBLE-RPT      THRU 2300-EXIT05270000
052800             END-EVALUATE.                                        05280000
052900 2000-EXIT.  EXIT.                                                05290000
053000                                                                  05300000
053100 2100-START-REPORT.                                               05310000
053200     IF PS-NOT-FIRST-TIME-THRU                                    05320019
053300        PERFORM 3000-WRITE-UNRESOLVED-TRBL-RPT THRU 3000-EXIT     05330019
053400     END-IF                                                       05340019
053500     PERFORM 5100-RESET           THRU 5100-EXIT                  05350000
053600                                                                  05360031
053700                                                                  05370031
053800     EVALUATE TRUE                                                05380003
053900         WHEN TM001-RECORD-TYPE-BYGMMTOT                          05390003
054000              MOVE TM001-REPORT-GMM-NBR  TO HL12-GMM-NBR          05400024
054100              MOVE TM001-ATL-NAME        TO HL12-GMM-NAME         05410024
054200              SET  PS-AREA-BUYING   TO TRUE                       05420003
054300         WHEN TM001-RECORD-TYPE-MDSTOT                            05430003
054400              SET PS-AREA-MERCH     TO TRUE                       05440003
054500         WHEN TM001-RECORD-TYPE-BYDCTOT                           05450003
054600              SET PS-AREA-LOGISTICS TO TRUE                       05460003
054700     END-EVALUATE                                                 05470003
054800     PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT           05480003
054900                                                                  05490000
055000     MOVE TM001-ATL-ASSIGN-TOT-QTY TO                             05500000
055100                            TL1-TROUBLE-TOTAL                     05510000
055200                            PV-TOT-MDS-TRBL-SAVE.                 05520000
055300     EVALUATE TRUE                                                05530039
055400         WHEN PS-AREA-BUYING                                      05540039
055500             WRITE DAILY-DIV-TRBL-SUM-BUY-REC                     05550039
055600                      FROM TL1-TOTAL-LINE-1                       05560000
055700                           AFTER ADVANCING 2 LINES                05570000
055800             ADD 2   TO PV-BUY-LINE-COUNT                         05580039
055900         WHEN PS-AREA-MERCH                                       05590039
056000             WRITE DAILY-DIV-TRBL-SUM-MER-REC                     05600039
056100                      FROM TL1-TOTAL-LINE-1                       05610039
056200                           AFTER ADVANCING 2 LINES                05620039
056300             ADD 2   TO PV-MER-LINE-COUNT                         05630039
056400         WHEN PS-AREA-LOGISTICS                                   05640039
056500             WRITE DAILY-DIV-TRBL-SUM-LOG-REC                     05650039
056600                      FROM TL1-TOTAL-LINE-1                       05660039
056700                           AFTER ADVANCING 2 LINES                05670039
056800             ADD 2   TO PV-LOG-LINE-COUNT                         05680039
056900     END-EVALUATE.                                                05690039
057000                                                                  05700039
057100 2100-EXIT.  EXIT.                                                05710000
057200                                                                  05720000
057210 2150-GET-DC-NAME.                                                05721045
057220     INITIALIZE XL071-COMMAREA-REC.                               05722045
057230     MOVE TM001-OPER-UNT-ID   TO XL071-LOCATION-NUMBER.           05723045
057240                                                                  05724045
057250     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05725045
057260                                                                  05726045
057270     EVALUATE TRUE                                                05727045
057280         WHEN XL071-NO-ERRORS                                     05728045
057290             MOVE XL071-LOC-5-ABBR-NM  TO HL13-DC-NAME            05729045
057291         WHEN XL071-LOC-NOT-FOUND                                 05729145
057292         WHEN XL071-SQLCODE-N = -904                              05729248
057293         WHEN XL071-SQLCODE-N = -913                              05729348
057294             MOVE PC-NOT-FOUND       TO HL13-DC-NAME              05729445
057295         WHEN XL071-BAD-DB2-RETURN                                05729545
057296             MOVE XL071-DB2-TABLE    TO PV-ABEND-PARAGRAPH        05729645
057297             MOVE XL071-SQLCODE      TO PV-ABEND-SQLCODE          05729745
057298              DISPLAY '** ABEND ** IN TMKRP008'                   05729845
057299              DISPLAY 'PARAGRAPH:2150-GET-DC-NAME'                05729945
057300              DISPLAY 'SQLCODE:  ' PV-ABEND-SQLCODE               05730045
057301              DISPLAY                                             05730145
057302             'MESSAGE:  SQL ERROR SELECTING FROM XLT-LOC'         05730245
057303              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             05730345
057306     END-EVALUATE.                                                05730645
057307 2150-EXIT.  EXIT.                                                05730745
057308                                                                  05730845
057310 2200-SUMMARY-AREAS-REPORTS.                                      05731000
057400     SET   PS-TROUBLE-ASSIGNED-RPT    TO TRUE.                    05740000
057500                                                                  05750000
057600     EVALUATE TRUE                                                05760000
057700         WHEN PS-AREA-BUYING                                      05770005
057800             IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT                 05780039
057900                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      05790039
058000              END-IF                                              05800039
058100              PERFORM 2210-DMM-TOTALS THRU 2210-EXIT              05810000
058200         WHEN PS-AREA-MERCH                                       05820005
058300             IF PV-MER-LINE-COUNT > PC-LINE-LIMIT                 05830039
058400                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      05840039
058500              END-IF                                              05850039
058600              PERFORM 2220-ANAL-TOTALS THRU 2220-EXIT             05860000
058700         WHEN PS-AREA-LOGISTICS                                   05870005
058800             IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT                 05880039
058900                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      05890039
059000              END-IF                                              05900039
059100              PERFORM 2250-DC-TOTALS    THRU 2250-EXIT            05910000
059200     END-EVALUATE.                                                05920000
059300                                                                  05930000
059400     IF TM001-PO-NBR       NOT = PV-PO-NBR-SAVE                   05940000
059500         MOVE TM001-PO-NBR       TO PV-PO-NBR-SAVE                05950000
059600     END-IF.                                                      05960000
059700     IF TM001-REC-SEQ-NBR  NOT = PV-REC-SEQ-NBR-SAVE              05970000
059800         MOVE TM001-REC-SEQ-NBR  TO PV-REC-SEQ-NBR-SAVE           05980000
059900     END-IF.                                                      05990000
060000     IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE             06000000
060100         MOVE TM001-TRBL-RSN-CDE TO PV-TRBL-RSN-CDE-SAVE          06010000
060200         MOVE TM001-TRBL-RSN-CDE-DESC                             06020000
060300                                 TO PV-TRBL-RSN-CDE-DESC-SAVE     06030000
060400     END-IF.                                                      06040000
060500     IF (TM001-NOTIF-DATE  NOT = PV-NOTIF-DATE-SAVE)              06050000
060600         MOVE TM001-NOTIF-DATE TO PV-NOTIF-DATE-SAVE              06060000
060700     END-IF.                                                      06070000
060800 2200-EXIT.  EXIT.                                                06080000
060900                                                                  06090000
061000 2210-DMM-TOTALS.                                                 06100000
061100     IF TM001-DMM-NBR NOT = PV-DMM-SAVE                           06110000
061200        IF NOT PS-FIRST-DMM                                       06120000
061300          PERFORM 6000-WRITE-DETAIL-LINE        THRU 6000-EXIT    06130000
061400          PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL THRU 2230-EXIT    06140000
061500        END-IF                                                    06150000
061600        MOVE 0    TO PA-RESOLVE-HOURS                             06160000
061700                     PA-RESOLVE-MINUTES                           06170000
061800                     PV-AVG-MINUTES                               06180000
061900                     PA-NBR-OF-RESOLVED-TRBLS                     06190000
062000                     PV-AVG-TOT-HOURS                             06200000
062100                     PV-AVG-TOT-MINUTES                           06210000
062200                     PA-TOT-OF-PRBLMS                             06220000
062300                     PA-TOT-TRBLS                                 06230000
062400        IF PS-FIRST-DMM                                           06240000
062500           PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT   06250003
062600           SET PS-NOT-FIRST-DMM                    TO TRUE        06260003
062700        END-IF                                                    06270000
062800        MOVE TM001-DMM-NBR     TO PV-DMM-SAVE                     06280000
062900        MOVE TM001-DMM-NAME    TO PV-DMM-NAME-SAVE                06290000
063000     END-IF                                                       06300000
063100                                                                  06310000
063200     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             06320000
063300 2210-EXIT.  EXIT.                                                06330000
063400                                                                  06340000
063500 2220-ANAL-TOTALS.                                                06350000
063600     IF TM001-ANALYST-MGR-NAME NOT = PV-ANAL-NAME-SAVE            06360000
063700        IF NOT PS-FIRST-ANAL                                      06370000
063800           PERFORM 6000-WRITE-DETAIL-LINE         THRU 6000-EXIT  06380000
063900           PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL  THRU 2230-EXIT  06390000
064000        END-IF                                                    06400000
064100        MOVE 0    TO PA-RESOLVE-HOURS                             06410000
064200                     PA-RESOLVE-MINUTES                           06420000
064300                     PV-AVG-MINUTES                               06430000
064400                     PA-NBR-OF-RESOLVED-TRBLS                     06440000
064500                     PV-AVG-TOT-HOURS                             06450000
064600                     PV-AVG-TOT-MINUTES                           06460000
064700                     PA-TOT-OF-PRBLMS                             06470000
064800                     PA-TOT-TRBLS                                 06480000
064900        IF PS-FIRST-ANAL                                          06490000
065000           PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT   06500003
065100           SET PS-NOT-FIRST-ANAL                   TO TRUE        06510003
065200        END-IF                                                    06520000
065300        MOVE TM001-ANALYST-MGR-NAME  TO PV-ANAL-NAME-SAVE         06530000
065400     END-IF                                                       06540000
065500                                                                  06550000
065600     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             06560000
065700 2220-EXIT.  EXIT.                                                06570000
065800                                                                  06580000
065900 2250-DC-TOTALS.                                                  06590000
066000     IF TM001-FCLTY-AREA-ID NOT = PV-FCLTY-AREA-ID-SAVE           06600000
066100        IF NOT PS-FIRST-PROCESS-AREA                              06610000
066200           PERFORM 6000-WRITE-DETAIL-LINE         THRU 6000-EXIT  06620000
066300           PERFORM 2230-LOAD-UNRSLVD-TROUBLE-TBL  THRU 2230-EXIT  06630000
066400        END-IF                                                    06640000
066500        MOVE 0    TO PA-RESOLVE-HOURS                             06650000
066600                     PA-RESOLVE-MINUTES                           06660000
066700                     PV-AVG-MINUTES                               06670000
066800                     PA-NBR-OF-RESOLVED-TRBLS                     06680000
066900                     PV-AVG-TOT-HOURS                             06690000
067000                     PV-AVG-TOT-MINUTES                           06700000
067100                     PA-TOT-OF-PRBLMS                             06710000
067200                     PA-TOT-TRBLS                                 06720000
067300        IF PS-FIRST-PROCESS-AREA                                  06730000
067400           PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT   06740003
067500           SET PS-NOT-FIRST-PROCESS-AREA           TO TRUE        06750003
067600        END-IF                                                    06760000
067700        MOVE TM001-FCLTY-AREA-ID     TO PV-FCLTY-AREA-ID-SAVE     06770000
067800     END-IF                                                       06780000
067900                                                                  06790000
068000     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             06800000
068100 2250-EXIT.  EXIT.                                                06810000
068200                                                                  06820000
068300 2215-ACCUMULATE-TOTALS.                                          06830000
068400     IF TM001-NOTIF-DATE       <= PV-END-DATE     AND             06840000
068500        TM001-NOTIF-DATE       >= PV-START-DATE   AND             06850000
068600         ((TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR      06860000
068700          (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR      06870000
068800          (TM001-NOTIF-DATE   NOT = PV-NOTIF-DATE-SAVE)   OR      06880000
068900          (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE))       06890000
069000                                                                  06900000
069100        ADD 1   TO PA-TOT-TRBLS                                   06910000
069200     END-IF.                                                      06920000
069300                                                                  06930000
069400     IF TM001-RESOLVED-DATE    <= PV-END-DATE     AND             06940038
069500        TM001-RESOLVED-DATE    >= PV-START-DATE   AND             06950038
069600        TM001-RPT-RESOLVED                                        06960000
069700          ADD TM001-RESOLVED-HOURS    TO PA-RESOLVE-HOURS         06970000
069800          ADD TM001-RESOLVED-MINUTES  TO PA-RESOLVE-MINUTES       06980000
069900          ADD 1      TO PA-NBR-OF-RESOLVED-TRBLS                  06990000
070000     END-IF.                                                      07000000
070100                                                                  07010000
070200     IF (TM001-NOTIF-DATE  NOT = PV-NOTIF-DATE-SAVE)    OR        07020000
070300        (TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR        07030000
070400        (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR        07040000
070500        (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE)          07050000
070600         IF TM001-RPT-UNRESOLVED                                  07060000
070700            ADD 1      TO PA-NBR-UNRESOLVED-TRBLS                 07070000
070800            ADD 1      TO PA-TOT-UNRESLVED-TRBLS                  07080000
070900         END-IF                                                   07090000
071000      END-IF.                                                     07100000
071100 2215-EXIT.  EXIT.                                                07110000
071200                                                                  07120000
071300 2230-LOAD-UNRSLVD-TROUBLE-TBL.                                   07130000
071400     EVALUATE TRUE                                                07140000
071500       WHEN PS-AREA-BUYING                                        07150012
071600          MOVE PC-AREA-DMM      TO UTT-AREA (UTT-INX)             07160000
071700          MOVE PV-DMM-SAVE      TO UTT-DMM-NBR (UTT-INX)          07170000
071800          MOVE PV-DMM-NAME-SAVE TO UTT-NAME (UTT-INX)             07180000
071900       WHEN PS-AREA-MERCH                                         07190012
072000            MOVE PC-AREA-ANAL        TO UTT-AREA (UTT-INX)        07200000
072100            MOVE PV-ANAL-NAME-SAVE   TO UTT-NAME (UTT-INX)        07210000
072200            MOVE 0                   TO UTT-DMM-NBR (UTT-INX)     07220000
072300       WHEN PS-AREA-LOGISTICS                                     07230012
072400            MOVE PC-PROCESS-AREA     TO UTT-AREA (UTT-INX)        07240012
072500            MOVE PV-FCLTY-AREA-ID-SAVE                            07250012
072600                                     TO UTT-NAME (UTT-INX)        07260012
072700            MOVE 0                   TO UTT-DMM-NBR (UTT-INX)     07270012
072800     END-EVALUATE                                                 07280000
072900                                                                  07290000
073000     MOVE PV-TRBL-RSN-CDE-SAVE      TO UTT-TRBL-RSN-CDE           07300000
073100                                            (UTT-INX)             07310000
073200     MOVE PV-TRBL-RSN-CDE-DESC-SAVE TO UTT-TRBL-RSN-CDE-DESC      07320000
073300                                            (UTT-INX)             07330000
073400     MOVE PA-NBR-UNRESOLVED-TRBLS   TO                            07340000
073500                     UTT-NBR-UNRSLVED-TRBLS  (UTT-INX)            07350000
073600                                                                  07360000
073700     SET UTT-INX  UP BY 1                                         07370000
073800     MOVE 0       TO PA-NBR-UNRESOLVED-TRBLS.                     07380000
073900 2230-EXIT.  EXIT.                                                07390000
074000                                                                  07400000
074100 2300-TOP-TROUBLE-RPT.                                            07410000
074200     SET PS-TOP-TROUBLE-RPT    TO TRUE                            07420002
074300                                                                  07430000
074310     EVALUATE TRUE                                                07431044
074320         WHEN PS-AREA-BUYING                                      07432044
074400             IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT                 07440044
074500               PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT 07450044
074600             END-IF                                               07460044
074700         WHEN PS-AREA-MERCH                                       07470044
074800             IF PV-MER-LINE-COUNT > PC-LINE-LIMIT                 07480044
074900               PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT 07490044
075000             END-IF                                               07500044
075100         WHEN PS-AREA-LOGISTICS                                   07510044
075200             IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT                 07520044
075300               PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT 07530044
075400             END-IF                                               07540044
075410     END-EVALUATE.                                                07541044
075500                                                                  07550039
075600     IF PS-FIRST-CM-RECORD                                        07560000
075700         PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT     07570000
075800         SET PS-NOT-FIRST-CM-RECORD  TO TRUE                      07580000
075900     END-IF.                                                      07590000
076000                                                                  07600000
076100     IF PV-TOP-TRBLS-COUNT < 6                                    07610000
076200        IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE          07620000
076300           IF TM001-RTL-RSN-CDE-TOT-QTY > 0                       07630028
076400              PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT     07640028
076500              IF PV-TOP-TRBLS-COUNT = 5                           07650028
076600                 MOVE TM001-RTL-RSN-CDE-TOT-QTY TO                07660028
076700                                         PV-RSN-CDE-TOT-QTY-SAVE  07670028
076800              END-IF                                              07680028
076900              ADD  1  TO PV-TOP-TRBLS-COUNT                       07690028
077000           END-IF                                                 07700028
077100        END-IF                                                    07710000
077200     ELSE                                                         07720000
077300       IF TM001-RTL-RSN-CDE-TOT-QTY = PV-RSN-CDE-TOT-QTY-SAVE     07730000
077400           IF TM001-RTL-RSN-CDE-TOT-QTY > 0                       07740028
077500             PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT      07750028
077600             ADD  1  TO PV-TOP-TRBLS-COUNT                        07760029
077700           END-IF                                                 07770028
077800       END-IF                                                     07780000
077900     END-IF.                                                      07790000
078000 2300-EXIT.  EXIT.                                                07800000
078100                                                                  07810000
078200 5100-RESET.                                                      07820002
078300     INITIALIZE UTT-UNRESOLVED-TROUBLE-TABLE                      07830000
078400     MOVE ' '   TO PS-REPORT-SW                                   07840000
078500                   PS-AREA-SW                                     07850000
078600     SET  PS-NOT-FIRST-TIME-THRU   TO TRUE                        07860004
078700     SET  PS-FIRST-UNRSLVED-DETAIL TO TRUE                        07870000
078800     SET  PS-FIRST-DMM             TO TRUE                        07880000
078900     SET  PS-FIRST-ANAL            TO TRUE                        07890000
079000     SET  PS-FIRST-PROCESS-AREA    TO TRUE                        07900021
079100     SET  PS-FIRST-CM-RECORD       TO TRUE                        07910000
079200     MOVE 0  TO PA-TOT-UNRESLVED-TRBLS.                           07920000
079300     MOVE 1  TO PV-TOP-TRBLS-COUNT.                               07930009
079400     MOVE 0  TO PV-DETAIL-COUNT.                                  07940000
079500     SET UTT-INX   TO  1.                                         07950014
079600 5100-EXIT.  EXIT.                                                07960000
079700                                                                  07970000
079800 3000-WRITE-UNRESOLVED-TRBL-RPT.                                  07980000
079900     SET PS-UNRESOLVED-TRBLS-RPT    TO TRUE.                      07990000
080000                                                                  08000000
080010     EVALUATE TRUE                                                08001044
080020         WHEN PS-AREA-BUYING                                      08002044
080030             IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT                 08003044
080040               PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT 08004044
080050             END-IF                                               08005044
080060         WHEN PS-AREA-MERCH                                       08006044
080070             IF PV-MER-LINE-COUNT > PC-LINE-LIMIT                 08007044
080080               PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT 08008044
080090             END-IF                                               08009044
080091         WHEN PS-AREA-LOGISTICS                                   08009144
080092             IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT                 08009244
080093               PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT 08009344
080094             END-IF                                               08009444
080095     END-EVALUATE.                                                08009544
081200                                                                  08120039
081300     IF PS-FIRST-UNRSLVED-DETAIL                                  08130039
081400         MOVE  PA-TOT-UNRESLVED-TRBLS TO TL2-UNRSLVED-TRBL-TOT    08140000
081500         EVALUATE TRUE                                            08150039
081600             WHEN PS-AREA-BUYING                                  08160039
081700                 WRITE DAILY-DIV-TRBL-SUM-BUY-REC                 08170039
081800                       FROM TL2-TOTAL-LINE-2                      08180000
081900                            AFTER ADVANCING 4 LINES               08190000
082100                 WRITE DAILY-DIV-TRBL-SUM-BUY-REC                 08210039
082200                       FROM BL-BLANK-LINE                         08220039
082300                           AFTER ADVANCING 1 LINES                08230039
082400                 ADD 5   TO PV-BUY-LINE-COUNT                     08240044
082500             WHEN PS-AREA-MERCH                                   08250039
082600                 WRITE DAILY-DIV-TRBL-SUM-MER-REC                 08260039
082700                       FROM TL2-TOTAL-LINE-2                      08270039
082800                            AFTER ADVANCING 4 LINES               08280039
083000                 WRITE DAILY-DIV-TRBL-SUM-MER-REC                 08300039
083100                       FROM BL-BLANK-LINE                         08310039
083200                           AFTER ADVANCING 1 LINES                08320039
083300                 ADD 5   TO PV-BUY-LINE-COUNT                     08330044
083400             WHEN PS-AREA-LOGISTICS                               08340039
083500                 WRITE DAILY-DIV-TRBL-SUM-LOG-REC                 08350039
083600                       FROM TL2-TOTAL-LINE-2                      08360039
083700                            AFTER ADVANCING 4 LINES               08370039
083900                 WRITE DAILY-DIV-TRBL-SUM-LOG-REC                 08390039
084000                       FROM BL-BLANK-LINE                         08400000
084100                           AFTER ADVANCING 1 LINES                08410000
084200                 ADD 5   TO PV-LOG-LINE-COUNT                     08420044
084300         END-EVALUATE                                             08430039
084400                                                                  08440039
084500         IF  PA-TOT-UNRESLVED-TRBLS = 0                           08450032
084600            GO TO 3000-EXIT                                       08460032
084700         ELSE                                                     08470032
084800            PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT  08480032
084900            SET PS-NOT-FIRST-UNRSLVD-DETAIL   TO TRUE             08490032
085000         END-IF                                                   08500032
085100     END-IF.                                                      08510000
085200                                                                  08520000
085300     PERFORM VARYING UTT-INX   FROM 1 BY 1                        08530000
085400            UNTIL UTT-INX > 250                                   08540000
085500               OR UTT-UNRESOLVED-TRBL-ENTRY (UTT-INX) = LOW-VALUES08550000
085600        EVALUATE TRUE                                             08560042
085601            WHEN PS-AREA-BUYING                                   08560142
085610                 IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT             08561042
085700                    PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT   08570042
085800                 END-IF                                           08580042
085810            WHEN PS-AREA-MERCH                                    08581042
085820                 IF PV-MER-LINE-COUNT > PC-LINE-LIMIT             08582042
085830                    PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT   08583042
085840                 END-IF                                           08584042
085850            WHEN PS-AREA-LOGISTICS                                08585042
085860                 IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT             08586042
085870                    PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT   08587042
085880                 END-IF                                           08588042
085900        END-EVALUATE                                              08590042
085910        EVALUATE TRUE                                             08591042
086000          WHEN UTT-AREA (UTT-INX) = PC-AREA-DMM                   08600000
086100             MOVE UTT-DMM-NBR (UTT-INX) TO DL-DMM-NBR             08610000
086200             MOVE DL-DMM-INFO           TO DL3-INFO               08620002
086300          WHEN UTT-AREA (UTT-INX) = PC-AREA-ANAL                  08630000
086400             MOVE DL-ANALYST-INFO       TO DL3-INFO               08640002
086500          WHEN UTT-AREA (UTT-INX) = PC-PROCESS-AREA               08650002
086600             MOVE DL-PROCESS-AREA-INFO  TO DL3-INFO               08660002
086700        END-EVALUATE                                              08670000
086800        MOVE UTT-NAME (UTT-INX)          TO DL3-NAME              08680016
086900        MOVE UTT-NBR-UNRSLVED-TRBLS (UTT-INX)                     08690000
087000                                         TO DL3-TOT-ASSIGNED-TRBLS08700000
087100         IF  UTT-NBR-UNRSLVED-TRBLS (UTT-INX) NOT = 0             08710000
087200            PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT       08720000
087300         END-IF                                                   08730000
087400     END-PERFORM.                                                 08740000
087500 3000-EXIT.  EXIT.                                                08750000
087600                                                                  08760000
087700 6000-WRITE-DETAIL-LINE.                                          08770000
087800     EVALUATE TRUE                                                08780044
087801         WHEN PS-AREA-BUYING                                      08780144
087810             IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT                 08781044
087900                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      08790044
088000             END-IF                                               08800044
088100         WHEN PS-AREA-MERCH                                       08810044
088200             IF PV-MER-LINE-COUNT > PC-LINE-LIMIT                 08820044
088300                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      08830044
088400             END-IF                                               08840044
088500         WHEN PS-AREA-LOGISTICS                                   08850044
088600             IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT                 08860044
088700                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      08870044
088800             END-IF                                               08880044
088900     END-EVALUATE.                                                08890044
088910                                                                  08891044
089000     EVALUATE TRUE                                                08900000
089100       WHEN PS-TROUBLE-ASSIGNED-RPT                               08910039
089200         PERFORM 6200-CALC-AVG-RESOLVE-TIME THRU 6200-EXIT        08920000
089300         IF   PA-TOT-TRBLS        = 0  AND                        08930000
089400              PV-AVG-TOT-HOURS    = 0  AND                        08940000
089500              PV-AVG-TOT-MINUTES  = 0                             08950000
089600              GO TO 6000-EXIT                                     08960000
089700         END-IF                                                   08970000
089800         PERFORM 6100-SET-UP-INFO-PART THRU 6100-EXIT             08980001
089900         MOVE PA-TOT-TRBLS      TO DL1-TOT-ASSIGNED-TRBLS         08990000
090000         IF PV-TOT-MDS-TRBL-SAVE > 0                              09000000
090100            COMPUTE PV-PER-TO-TOT = PA-TOT-TRBLS * 100 /          09010000
090200                                           PV-TOT-MDS-TRBL-SAVE   09020000
090300         ELSE                                                     09030000
090400            MOVE 0   TO PV-PER-TO-TOT                             09040027
090500         END-IF                                                   09050000
090600         MOVE PV-PER-TO-TOT     TO DL1-PER-TO-TOT                 09060000
090700         EVALUATE TRUE                                            09070039
090800             WHEN PS-AREA-BUYING                                  09080039
090900                WRITE DAILY-DIV-TRBL-SUM-BUY-REC                  09090039
091000                      FROM DL1-DETAIL-LINE-1                      09100039
091100                           AFTER ADVANCING 1 LINE                 09110039
091200                ADD 1   TO PV-BUY-LINE-COUNT                      09120039
091300             WHEN PS-AREA-MERCH                                   09130039
091400                WRITE DAILY-DIV-TRBL-SUM-MER-REC                  09140039
091500                      FROM DL1-DETAIL-LINE-1                      09150039
091600                           AFTER ADVANCING 1 LINE                 09160039
091700                ADD 1   TO PV-MER-LINE-COUNT                      09170039
091800             WHEN PS-AREA-LOGISTICS                               09180039
091900                WRITE DAILY-DIV-TRBL-SUM-LOG-REC                  09190039
092000                      FROM DL1-DETAIL-LINE-1                      09200039
092100                           AFTER ADVANCING 1 LINE                 09210039
092200                ADD 1   TO PV-LOG-LINE-COUNT                      09220039
092300         END-EVALUATE                                             09230039
092400       WHEN PS-TOP-TROUBLE-RPT                                    09240039
092500         MOVE TM001-RTL-TRBL-RSN-CDE    TO DL2-TROUBLE-NBR        09250000
092600         MOVE TM001-RTL-TRBL-RSN-CDE-DESC                         09260000
092700                                        TO DL2-TROUBLE-DESCRIPTION09270000
092800         MOVE TM001-RTL-RSN-CDE-TOT-QTY TO DL2-ASSIGNED-QTY       09280000
092900         IF PV-TOT-MDS-TRBL-SAVE > 0                              09290026
093000            COMPUTE PV-PER-TO-TOT = TM001-RTL-RSN-CDE-TOT-QTY *   09300027
093100                                100 /  PV-TOT-MDS-TRBL-SAVE       09310027
093200         ELSE                                                     09320026
093300            MOVE 0       TO PV-PER-TO-TOT                         09330026
093400         END-IF                                                   09340026
093500         MOVE PV-PER-TO-TOT            TO DL2-PER-TO-TOTAL        09350000
093600                                                                  09360000
093700         EVALUATE TRUE                                            09370039
093800             WHEN PS-AREA-BUYING                                  09380039
093900                WRITE DAILY-DIV-TRBL-SUM-BUY-REC                  09390039
094000                      FROM DL2-DETAIL-LINE-2                      09400039
094100                           AFTER ADVANCING 1 LINE                 09410039
094200                ADD 1   TO PV-BUY-LINE-COUNT                      09420039
094300             WHEN PS-AREA-MERCH                                   09430039
094400                WRITE DAILY-DIV-TRBL-SUM-MER-REC                  09440039
094500                      FROM DL2-DETAIL-LINE-2                      09450039
094600                           AFTER ADVANCING 1 LINE                 09460039
094700                ADD 1   TO PV-MER-LINE-COUNT                      09470039
094800             WHEN PS-AREA-LOGISTICS                               09480039
094900                WRITE DAILY-DIV-TRBL-SUM-LOG-REC                  09490039
095000                      FROM DL2-DETAIL-LINE-2                      09500039
095100                           AFTER ADVANCING 1 LINE                 09510039
095200                ADD 1   TO PV-LOG-LINE-COUNT                      09520039
095300         END-EVALUATE                                             09530039
095400       WHEN PS-UNRESOLVED-TRBLS-RPT                               09540039
095500         EVALUATE TRUE                                            09550039
095600             WHEN PS-AREA-BUYING                                  09560039
095700                WRITE DAILY-DIV-TRBL-SUM-BUY-REC                  09570039
095800                      FROM DL3-DETAIL-LINE-3                      09580039
095900                           AFTER ADVANCING 1 LINE                 09590039
096000                ADD 1   TO PV-BUY-LINE-COUNT                      09600039
096100             WHEN PS-AREA-MERCH                                   09610039
096200                WRITE DAILY-DIV-TRBL-SUM-MER-REC                  09620039
096300                      FROM DL3-DETAIL-LINE-3                      09630039
096400                           AFTER ADVANCING 1 LINE                 09640039
096500                ADD 1   TO PV-MER-LINE-COUNT                      09650039
096600             WHEN PS-AREA-LOGISTICS                               09660039
096700                WRITE DAILY-DIV-TRBL-SUM-LOG-REC                  09670039
096800                      FROM DL3-DETAIL-LINE-3                      09680039
096900                           AFTER ADVANCING 1 LINE                 09690039
097000                ADD 1   TO PV-LOG-LINE-COUNT                      09700039
097100         END-EVALUATE                                             09710039
097200     END-EVALUATE.                                                09720000
097300                                                                  09730000
097400 6000-EXIT.  EXIT.                                                09740000
097500                                                                  09750000
097600 6100-SET-UP-INFO-PART.                                           09760001
097700      EVALUATE TRUE                                               09770001
097800         WHEN PS-AREA-BUYING                                      09780006
097900            MOVE PV-DMM-SAVE       TO DL-DMM-NBR                  09790001
098000            MOVE DL-DMM-INFO       TO DL1-INFO                    09800002
098100            MOVE PV-DMM-NAME-SAVE  TO DL1-NAME                    09810001
098200            IF NOT PS-FIRST-CM-RECORD                             09820002
098300               MOVE TM001-DMM-NAME    TO DL1-NAME                 09830002
098400            ELSE                                                  09840002
098500               MOVE PV-DMM-NAME-SAVE  TO DL1-NAME                 09850002
098600            END-IF                                                09860002
098700         WHEN PS-AREA-MERCH                                       09870006
098800           MOVE DL-ANALYST-INFO   TO DL1-INFO                     09880002
098900           IF NOT PS-FIRST-CM-RECORD                              09890001
099000              MOVE TM001-ANALYST-MGR-NAME  TO DL1-NAME            09900001
099100           ELSE                                                   09910001
099200              MOVE PV-ANAL-NAME-SAVE TO DL1-NAME                  09920001
099300           END-IF                                                 09930001
099400         WHEN PS-AREA-LOGISTICS                                   09940007
099500           MOVE DL-PROCESS-AREA-INFO TO DL1-INFO                  09950002
099600           IF NOT PS-FIRST-CM-RECORD                              09960002
099700              MOVE TM001-FCLTY-AREA-ID     TO DL1-NAME            09970002
099800           ELSE                                                   09980002
099900              MOVE PV-FCLTY-AREA-ID-SAVE   TO DL1-NAME            09990002
100000           END-IF                                                 10000002
100100           CONTINUE                                               10010001
100200     END-EVALUATE.                                                10020001
100300 6100-EXIT.  EXIT.                                                10030001
100400                                                                  10040001
100500 6200-CALC-AVG-RESOLVE-TIME.                                      10050000
100600       INITIALIZE                                                 10060000
100700                  DL1-AVG-RESOLVE-HHH                             10070000
100800                  DL1-AVG-RESOLVE-MM.                             10080000
100900                                                                  10090000
101000        IF PA-RESOLVE-HOURS          = 0 AND                      10100000
101100           PA-RESOLVE-MINUTES        = 0 AND                      10110000
101200           PA-NBR-OF-RESOLVED-TRBLS  = 0                          10120000
101300           MOVE 0   TO PV-AVG-TOT-HOURS                           10130000
101400           MOVE 0   TO PV-AVG-TOT-MINUTES                         10140000
101500       ELSE                                                       10150000
101600         MULTIPLY 60 BY PA-RESOLVE-HOURS                          10160000
101700         ADD PA-RESOLVE-HOURS TO PA-RESOLVE-MINUTES               10170000
101800         DIVIDE PA-RESOLVE-MINUTES                                10180000
101900                      BY PA-NBR-OF-RESOLVED-TRBLS                 10190000
102000                  GIVING PV-AVG-MINUTES ROUNDED                   10200000
102100                  ON SIZE ERROR                                   10210000
102200                       MOVE 0 TO PV-AVG-MINUTES                   10220000
102300         END-DIVIDE                                               10230000
102400                                                                  10240000
102500         DIVIDE PV-AVG-MINUTES BY 60                              10250000
102600                GIVING PV-AVG-TOT-HOURS                           10260000
102700                REMAINDER PV-AVG-TOT-MINUTES                      10270000
102800                ON SIZE ERROR                                     10280000
102900                      MOVE 0 TO PV-AVG-TOT-HOURS                  10290000
103000                                PV-AVG-TOT-MINUTES                10300000
103100         END-DIVIDE                                               10310000
103200      END-IF.                                                     10320000
103300                                                                  10330000
103400        MOVE PV-AVG-TOT-HOURS          TO DL1-AVG-RESOLVE-HHH     10340000
103500        MOVE PV-AVG-TOT-MINUTES        TO DL1-AVG-RESOLVE-MM.     10350000
103600                                                                  10360000
103700 6200-EXIT.  EXIT.                                                10370000
103800                                                                  10380000
103900 6900-PRINT-HEADINGS.                                             10390000
104000     PERFORM 6910-PRINT-COMMON-HEADINGS   THRU 6910-EXIT.         10400000
104100     PERFORM 6920-PRINT-SPECIFIC-HEADINGS THRU 6920-EXIT.         10410000
104200                                                                  10420000
104300 6900-EXIT.   EXIT.                                               10430000
104400*                                                                 10440000
104500 6910-PRINT-COMMON-HEADINGS.                                      10450000
104700     EVALUATE TRUE                                                10470037
104800         WHEN PS-AREA-BUYING                                      10480037
104900            MOVE 0                  TO PV-BUY-LINE-COUNT          10490039
105000            ADD  1                  TO PV-BUY-PAGE-COUNT          10500039
105100            MOVE PV-BUY-PAGE-COUNT  TO DP132O-PAGE-NUMBER         10510039
105200            MOVE PC-ONE             TO DP132O-REPORT-NUMBER       10520039
105300            WRITE DAILY-DIV-TRBL-SUM-BUY-REC                      10530039
105400                  FROM DP132O-STANDRD-HEADER-132-COLS             10540039
105500                       AFTER ADVANCING PAGE                       10550039
105700            WRITE DAILY-DIV-TRBL-SUM-BUY-REC                      10570039
105800                  FROM HL1-HEADING-LINE-1                         10580039
105900                       AFTER ADVANCING 2 LINES                    10590039
106100            WRITE DAILY-DIV-TRBL-SUM-BUY-REC                      10610039
106200                  FROM HL11-HEADING-LINE-11                       10620039
106300                       AFTER ADVANCING 1 LINES                    10630039
106400            WRITE DAILY-DIV-TRBL-SUM-BUY-REC                      10640039
106500                  FROM HL12-HEADING-LINE-12                       10650039
106600                       AFTER ADVANCING 3 LINES                    10660039
106700            ADD 6  TO PV-BUY-LINE-COUNT                           10670042
106800         WHEN PS-AREA-MERCH                                       10680037
106900            MOVE 0                  TO PV-MER-LINE-COUNT          10690039
107000            ADD  1                  TO PV-MER-PAGE-COUNT          10700039
107100            MOVE PV-MER-PAGE-COUNT  TO DP132O-PAGE-NUMBER         10710039
107200            MOVE PC-TWO    TO DP132O-REPORT-NUMBER                10720037
107300            WRITE DAILY-DIV-TRBL-SUM-MER-REC                      10730039
107400                  FROM DP132O-STANDRD-HEADER-132-COLS             10740039
107500                       AFTER ADVANCING PAGE                       10750039
107700            WRITE DAILY-DIV-TRBL-SUM-MER-REC                      10770039
107800                  FROM HL1-HEADING-LINE-1                         10780039
107900                       AFTER ADVANCING 2 LINES                    10790039
108100            WRITE DAILY-DIV-TRBL-SUM-MER-REC                      10810039
108200                  FROM HL10-HEADING-LINE-10                       10820039
108300                       AFTER ADVANCING 1 LINES                    10830039
108400            ADD 4  TO PV-MER-LINE-COUNT                           10840042
108500         WHEN PS-AREA-LOGISTICS                                   10850037
108600            MOVE 0                  TO PV-LOG-LINE-COUNT          10860039
108700            ADD  1                  TO PV-LOG-PAGE-COUNT          10870039
108800            MOVE PV-LOG-PAGE-COUNT  TO DP132O-PAGE-NUMBER         10880039
108900            MOVE PC-THREE  TO DP132O-REPORT-NUMBER                10890037
109000            WRITE DAILY-DIV-TRBL-SUM-LOG-REC                      10900039
109100                  FROM DP132O-STANDRD-HEADER-132-COLS             10910039
109200                       AFTER ADVANCING PAGE                       10920039
109400            WRITE DAILY-DIV-TRBL-SUM-LOG-REC                      10940039
109500                  FROM HL1-HEADING-LINE-1                         10950039
109600                       AFTER ADVANCING 2 LINES                    10960039
109800            WRITE DAILY-DIV-TRBL-SUM-LOG-REC                      10980039
109900                  FROM HL9-HEADING-LINE-9                         10990003
110000                       AFTER ADVANCING 1 LINES                    11000003
110200            PERFORM 2150-GET-DC-NAME  THRU 2150-EXIT              11020003
110300            WRITE DAILY-DIV-TRBL-SUM-LOG-REC                      11030039
110400                  FROM HL13-HEADING-LINE-13                       11040003
110500                       AFTER ADVANCING 3 LINES                    11050003
110600            ADD 7  TO PV-LOG-LINE-COUNT                           11060042
110700      END-EVALUATE.                                               11070003
110800 6910-EXIT.  EXIT.                                                11080000
110900                                                                  11090000
111000 6920-PRINT-SPECIFIC-HEADINGS.                                    11100000
111100     EVALUATE TRUE                                                11110000
111200        WHEN PS-TROUBLE-ASSIGNED-RPT                              11120000
111300            EVALUATE TRUE                                         11130040
111400                WHEN PS-AREA-BUYING                               11140040
111500                    WRITE DAILY-DIV-TRBL-SUM-BUY-REC              11150040
111600                          FROM HL2-HEADING-LINE-2                 11160040
111700                               AFTER ADVANCING 2 LINES            11170040
111800                    WRITE DAILY-DIV-TRBL-SUM-BUY-REC              11180040
111900                          FROM HL3-HEADING-LINE-3                 11190040
112000                               AFTER ADVANCING 1 LINE             11200040
112100                    WRITE DAILY-DIV-TRBL-SUM-BUY-REC              11210040
112200                          FROM BL-BLANK-LINE                      11220040
112300                               AFTER ADVANCING 1 LINE             11230040
112400                    ADD 4  TO PV-BUY-LINE-COUNT                   11240040
112500                WHEN PS-AREA-MERCH                                11250040
112600                    WRITE DAILY-DIV-TRBL-SUM-MER-REC              11260040
112700                          FROM HL2-HEADING-LINE-2                 11270040
112800                               AFTER ADVANCING 2 LINES            11280040
112900                    WRITE DAILY-DIV-TRBL-SUM-MER-REC              11290040
113000                          FROM HL3-HEADING-LINE-3                 11300040
113100                               AFTER ADVANCING 1 LINE             11310040
113200                    WRITE DAILY-DIV-TRBL-SUM-MER-REC              11320040
113300                          FROM BL-BLANK-LINE                      11330040
113400                               AFTER ADVANCING 1 LINE             11340040
113500                    ADD 4  TO PV-MER-LINE-COUNT                   11350040
113510                WHEN PS-AREA-LOGISTICS                            11351043
113520                    WRITE DAILY-DIV-TRBL-SUM-LOG-REC              11352043
113530                          FROM HL2-HEADING-LINE-2                 11353043
113540                               AFTER ADVANCING 2 LINES            11354043
113550                    WRITE DAILY-DIV-TRBL-SUM-LOG-REC              11355043
113560                          FROM HL3-HEADING-LINE-3                 11356043
113570                               AFTER ADVANCING 1 LINE             11357043
113580                    WRITE DAILY-DIV-TRBL-SUM-LOG-REC              11358043
113590                          FROM BL-BLANK-LINE                      11359043
113591                               AFTER ADVANCING 1 LINE             11359143
113592                    ADD 4  TO PV-LOG-LINE-COUNT                   11359243
113600            END-EVALUATE                                          11360040
113700        WHEN PS-TOP-TROUBLE-RPT                                   11370000
113800            EVALUATE TRUE                                         11380040
113900                WHEN PS-AREA-BUYING                               11390040
114000                     WRITE DAILY-DIV-TRBL-SUM-BUY-REC             11400040
114100                           FROM HL4-HEADING-LINE-4                11410040
114200                                AFTER ADVANCING 4 LINES           11420040
114300                     WRITE DAILY-DIV-TRBL-SUM-BUY-REC             11430040
114400                           FROM HL5-HEADING-LINE-5                11440040
114500                                AFTER ADVANCING 2 LINES           11450040
114600                     WRITE DAILY-DIV-TRBL-SUM-BUY-REC             11460040
114700                           FROM HL6-HEADING-LINE-6                11470040
114800                                AFTER ADVANCING 1 LINE            11480040
114900                     WRITE DAILY-DIV-TRBL-SUM-BUY-REC             11490040
115000                           FROM BL-BLANK-LINE                     11500040
115100                                AFTER ADVANCING 1 LINES           11510040
115200                     ADD 8  TO PV-BUY-LINE-COUNT                  11520040
115300                WHEN PS-AREA-MERCH                                11530040
115400                     WRITE DAILY-DIV-TRBL-SUM-MER-REC             11540040
115500                           FROM HL4-HEADING-LINE-4                11550040
115600                                AFTER ADVANCING 4 LINES           11560040
115700                     WRITE DAILY-DIV-TRBL-SUM-MER-REC             11570040
115800                           FROM HL5-HEADING-LINE-5                11580040
115900                                AFTER ADVANCING 2 LINES           11590040
116000                     WRITE DAILY-DIV-TRBL-SUM-MER-REC             11600040
116100                           FROM HL6-HEADING-LINE-6                11610040
116200                                AFTER ADVANCING 1 LINE            11620040
116300                     WRITE DAILY-DIV-TRBL-SUM-MER-REC             11630040
116400                           FROM BL-BLANK-LINE                     11640040
116500                                AFTER ADVANCING 1 LINES           11650040
116600                     ADD 8  TO PV-MER-LINE-COUNT                  11660040
116700                WHEN PS-AREA-LOGISTICS                            11670040
116800                     WRITE DAILY-DIV-TRBL-SUM-LOG-REC             11680040
116900                           FROM HL4-HEADING-LINE-4                11690040
117000                                AFTER ADVANCING 4 LINES           11700040
117100                     WRITE DAILY-DIV-TRBL-SUM-LOG-REC             11710040
117200                           FROM HL5-HEADING-LINE-5                11720040
117300                                AFTER ADVANCING 2 LINES           11730040
117400                     WRITE DAILY-DIV-TRBL-SUM-LOG-REC             11740040
117500                           FROM HL6-HEADING-LINE-6                11750040
117600                                AFTER ADVANCING 1 LINE            11760040
117700                     WRITE DAILY-DIV-TRBL-SUM-LOG-REC             11770040
117800                           FROM BL-BLANK-LINE                     11780040
117900                                AFTER ADVANCING 1 LINES           11790040
118000                     ADD 8  TO PV-LOG-LINE-COUNT                  11800040
118100            END-EVALUATE                                          11810040
118200        WHEN PS-UNRESOLVED-TRBLS-RPT                              11820040
118300            EVALUATE TRUE                                         11830040
118400                WHEN PS-AREA-BUYING                               11840040
118500                     WRITE DAILY-DIV-TRBL-SUM-BUY-REC             11850040
118600                           FROM HL7-HEADING-LINE-7                11860040
118700                                AFTER ADVANCING 1 LINE            11870040
118800                    WRITE DAILY-DIV-TRBL-SUM-BUY-REC              11880040
118900                           FROM HL8-HEADING-LINE-8                11890040
119000                                AFTER ADVANCING 1 LINE            11900040
119100                    WRITE DAILY-DIV-TRBL-SUM-BUY-REC              11910040
119200                           FROM BL-BLANK-LINE                     11920040
119300                                AFTER ADVANCING 1 LINE            11930040
119400                    ADD 2  TO PV-BUY-LINE-COUNT                   11940040
119500                WHEN PS-AREA-MERCH                                11950040
119600                     WRITE DAILY-DIV-TRBL-SUM-MER-REC             11960040
119700                           FROM HL7-HEADING-LINE-7                11970040
119800                                AFTER ADVANCING 1 LINE            11980040
119900                    WRITE DAILY-DIV-TRBL-SUM-MER-REC              11990040
120000                           FROM HL8-HEADING-LINE-8                12000040
120100                                AFTER ADVANCING 1 LINE            12010040
120200                    WRITE DAILY-DIV-TRBL-SUM-MER-REC              12020040
120300                           FROM BL-BLANK-LINE                     12030040
120400                                AFTER ADVANCING 1 LINE            12040040
120500                    ADD 2  TO PV-MER-LINE-COUNT                   12050040
120600                WHEN PS-AREA-LOGISTICS                            12060040
120700                     WRITE DAILY-DIV-TRBL-SUM-LOG-REC             12070040
120800                           FROM HL7-HEADING-LINE-7                12080040
120900                                AFTER ADVANCING 1 LINE            12090040
121000                    WRITE DAILY-DIV-TRBL-SUM-LOG-REC              12100040
121100                           FROM HL8-HEADING-LINE-8                12110040
121200                                AFTER ADVANCING 1 LINE            12120040
121300                    WRITE DAILY-DIV-TRBL-SUM-LOG-REC              12130040
121400                           FROM BL-BLANK-LINE                     12140040
121500                                AFTER ADVANCING 1 LINE            12150040
121600                    ADD 2  TO PV-LOG-LINE-COUNT                   12160040
121700            END-EVALUATE                                          12170040
121800     END-EVALUATE.                                                12180000
121900 6920-EXIT.  EXIT.                                                12190000
122000                                                                  12200000
122100 9000-END-PROCESS.                                                12210000
122200     WRITE DAILY-DIV-TRBL-SUM-BUY-REC                             12220040
122300           FROM ER-END-REPORT-LINE                                12230000
122400                AFTER ADVANCING 2 LINES.                          12240000
122500                                                                  12250000
122600     WRITE DAILY-DIV-TRBL-SUM-MER-REC                             12260040
122700           FROM ER-END-REPORT-LINE                                12270040
122800                AFTER ADVANCING 2 LINES.                          12280040
122900                                                                  12290040
123000     WRITE DAILY-DIV-TRBL-SUM-LOG-REC                             12300040
123100           FROM ER-END-REPORT-LINE                                12310040
123200                AFTER ADVANCING 2 LINES.                          12320040
123300                                                                  12330040
123400     CLOSE  TROUBLE-EXTRACT-FILE                                  12340000
123500            DAILY-DIV-TRBL-SUM-BUY-RPT                            12350040
123600            DAILY-DIV-TRBL-SUM-MER-RPT                            12360040
123700            DAILY-DIV-TRBL-SUM-LOG-RPT.                           12370040
123800 9000-EXIT.  EXIT.                                                12380000
123900                                                                  12390000
124000 9999-SQL-ERROR.                                                  12400000
124100                                                                  12410000
124200     COPY DPPD004.                                                12420000
124300                                                                  12430000
124400     MOVE +4013 TO PV-ABEND-CODE.                                 12440000
124500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12450000
124600 9999-EXIT.   EXIT.                                               12460000
127400                                                                  12740000
127500                                                                  12750000
