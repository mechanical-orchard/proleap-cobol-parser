000100 IDENTIFICATION DIVISION.                                         10/20/95
000200 PROGRAM-ID.    TRKCS142.                                         TRKCS142
000300 AUTHOR.        TOM RUSKA. G&R.                                      LV002
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          TRKCS142
000500 DATE-WRITTEN.  06-02-93.                                         TRKCS142
000600 DATE-COMPILED.                                                   TRKCS142
000700                                                                  TRKCS142
000800*---------------------------------------------------------------* TRKCS142
000900*    Y142 - TRAFFIC RECEIVER LIST                               * TRKCS142
001000*                                                               * TRKCS142
001100*    THIS PROGRAM GENERATES A LIST OF RECEIVERS FOR A FREIGHT   * TRKCS142
001200*    BILL, CARRIER AND TRAILER.                                 * TRKCS142
001300*                                                               * TRKCS142
001400*    NO RECORDS CAN BE SELECTED.                                * TRKCS142
001500*                                                               * TRKCS142
001600*---------------------------------------------------------------* TRKCS142
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697                 
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263697* MAKING THE CALL DYNAMIC VS STATIC.                                      
263697*---------------------------------------------------------------*         
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001700                                                                  TRKCS142
001800/                                                                 TRKCS142
001900 ENVIRONMENT DIVISION.                                            TRKCS142
002000                                                                  TRKCS142
002100 DATA DIVISION.                                                   TRKCS142
002200                                                                  TRKCS142
002300 WORKING-STORAGE SECTION.                                         TRKCS142
002400                                                                  TRKCS142
002500 01  DK-DB2-KEYS.                                                 TRKCS142
002600     05  DK-PO-NBR                      PIC  S9(09) COMP.         TRKCS142
002700     05  DK-PRO-NBR                     PIC  X(22).               TRKCS142
002800     05  DK-OWNER-SCAC-ID               PIC  X(04).               TRKCS142
002900                                                                  TRKCS142
003000 01  PA-PROGRAM-ACCUMULATORS.                                     TRKCS142
003100     05  PA-TOT-CART-CNT              PIC S9(09)    COMP-3        TRKCS142
003200                                                 VALUE +0.        TRKCS142
003300     05  PA-TOT-ACTL-CART-CNT         PIC S9(09)    COMP-3        TRKCS142
003400                                                 VALUE +0.        TRKCS142
003500     05  PA-TOT-DMG-CART-CNT          PIC S9(09)    COMP-3        TRKCS142
003600                                                 VALUE +0.        TRKCS142
003700     05  PA-TOT-FRGT-CHG              PIC S9(09)V99 COMP-3        TRKCS142
003800                                                 VALUE +0.        TRKCS142
003900                                                                  TRKCS142
004000 01  PC-PROGRAM-CONSTANTS.                                        TRKCS142
004100     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         TRKCS142
004200                                                    'TR142A  '.   TRKCS142
004300     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         TRKCS142
004400                                                    'TRKM142 '.   TRKCS142
004500     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         TRKCS142
004600                                                    'TRKCS142'.   TRKCS142
004700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      TRKCS142
004800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      TRKCS142
004900     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      TRKCS142
005000     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    TRKCS142
005100     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    TRKCS142
005200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +09     TRKCS142
005300                                                    COMP SYNC.    TRKCS142
005400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      TRKCS142
005500                                                    COMP SYNC.    TRKCS142
005600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         TRKCS142
005700                                                    +1000000      TRKCS142
005800                                                    COMP-3.       TRKCS142
005900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      TRKCS142
006000                                                    COMP SYNC.    TRKCS142
006100     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      TRKCS142
006200                                                    COMP-3.       TRKCS142
006300                                                                  TRKCS142
006400     05  PC-TSYMSG-NUMBERS.                                       TRKCS142
006500         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  TRKCS142
006600         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  TRKCS142
006700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  TRKCS142
006800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  TRKCS142
006900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  TRKCS142
007000         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  TRKCS142
007100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  TRKCS142
007200         10  PC-TSYMSG-00460            PIC  9(05)  VALUE 00460.  TRKCS142
007300                                                                  TRKCS142
007400 01  PS-PROGRAM-SWITCHES.                                         TRKCS142
007500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    TRKCS142
007600         88  PS-NO-ERROR                            VALUE 'Y'.    TRKCS142
007700         88  PS-ERROR                               VALUE 'N'.    TRKCS142
007800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    TRKCS142
007900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    TRKCS142
008000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    TRKCS142
008100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    TRKCS142
008200         88  PS-LIST-END                            VALUE 'Y'.    TRKCS142
008300         88  PS-NO-LIST-END                         VALUE 'N'.    TRKCS142
008400                                                                  TRKCS142
008500 01  PV-PROGRAM-VARIABLES.                                        TRKCS142
008600     05  PV-SUB                         PIC S9(04)   VALUE +0     TRKCS142
008700                                                     COMP SYNC.   TRKCS142
008800     05  PV-NULL-IND                    PIC S9(4) VALUE ZERO      TRKCS142
008900                                                     COMP SYNC.   TRKCS142
009000     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     TRKCS142
009100                                                     COMP SYNC.   TRKCS142
009200     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     TRKCS142
009300                                                     COMP-3.      TRKCS142
009400     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     TRKCS142
009500                                                     COMP-3.      TRKCS142
009600     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     TRKCS142
009700                                                     COMP-3.      TRKCS142
009800     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     TRKCS142
009900                                                     COMP SYNC.   TRKCS142
010000     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     TRKCS142
010100                                                     COMP SYNC.   TRKCS142
010200     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     TRKCS142
010300                                                     COMP SYNC.   TRKCS142
010400     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     TRKCS142
010500                                                     COMP SYNC.   TRKCS142
010600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      TRKCS142
010700                                                    COMP SYNC.    TRKCS142
010800                                                                  TRKCS142
010900     05  PV-OLD-RCVR-NBR              PIC  9(9).                  TRKCS142
011000     05  PV-OLD-RCVR-NBR-R REDEFINES PV-OLD-RCVR-NBR.             TRKCS142
011100         10  PV-OLD-RCVR-NBR-1        PIC X(01).                  TRKCS142
011200         10  PV-OLD-RCVR-NBR-2-8      PIC X(07).                  TRKCS142
011300         10  PV-OLD-RCVR-NBR-9        PIC X(01).                  TRKCS142
011400     05  PV-DEPT-NBR              PIC  X(04).                             
011500     05  PV-DEPT-NBR-N REDEFINES                                          
011501         PV-DEPT-NBR              PIC  9(04).                             
011502                                                                  TRKCS142
011503/                                                                 TRKCS142
011600*---------------------------------------------------------------* TRKCS142
011700*    MAP LAYOUT                                                 * TRKCS142
011800*---------------------------------------------------------------* TRKCS142
011900                                                                  TRKCS142
012000     COPY TRKM142.                                                TRKCS142
012100                                                                  TRKCS142
012200 01  MR-OCCURS-LAYOUT                   REDEFINES  TR142AO.       TRKCS142
012300     05  FILLER                         PIC X(48).                TRKCS142
012400                                                                  TRKCS142
012500     05  MR-PROL                        PIC S9(04) COMP.          TRKCS142
012600     05  MR-PROA                        PIC X(01).                TRKCS142
012700     05  MR-PROC                        PIC X(01).                TRKCS142
012800     05  MR-PROH                        PIC X(01).                TRKCS142
012900     05  MR-PRO-NBR                     PIC X(22).                TRKCS142
013000                                                                  TRKCS142
013100     05  MR-SCACL                       PIC S9(04) COMP.          TRKCS142
013200     05  MR-SCACA                       PIC X(01).                TRKCS142
013300     05  MR-SCACC                       PIC X(01).                TRKCS142
013400     05  MR-SCACH                       PIC X(01).                TRKCS142
013500     05  MR-OWNER-SCAC-ID               PIC X(04).                TRKCS142
013600                                                                  TRKCS142
013700     05  MR-TRLRL                       PIC S9(04) COMP.          TRKCS142
013800     05  MR-TRLRA                       PIC X(01).                TRKCS142
013900     05  MR-TRLRC                       PIC X(01).                TRKCS142
014000     05  MR-TRLRH                       PIC X(01).                TRKCS142
014100     05  MR-VEH-NBR                     PIC X(10).                TRKCS142
014200                                                                  TRKCS142
014300     05  MR-FCHGL                       PIC S9(04) COMP.          TRKCS142
014400     05  MR-FCHGA                       PIC X(01).                TRKCS142
014500     05  MR-FCHGC                       PIC X(01).                TRKCS142
014600     05  MR-FCHGH                       PIC X(01).                TRKCS142
014700     05  MR-FRGT-CHG-X.                                           TRKCS142
014800         10  MR-FRGT-CHG                PIC ZZZZZ9.99.            TRKCS142
014900                                                                  TRKCS142
015000     05  MR-TERML                       PIC S9(04) COMP.          TRKCS142
015100     05  MR-TERMA                       PIC X(01).                TRKCS142
015200     05  MR-TERMC                       PIC X(01).                TRKCS142
015300     05  MR-TERMH                       PIC X(01).                TRKCS142
015400     05  MR-TERMS                       PIC X(04).                TRKCS142
015500                                                                  TRKCS142
015600     05  MR-WGHTL                       PIC S9(04) COMP.          TRKCS142
015700     05  MR-WGHTA                       PIC X(01).                TRKCS142
015800     05  MR-WGHTC                       PIC X(01).                TRKCS142
015900     05  MR-WGHTH                       PIC X(01).                TRKCS142
016000     05  MR-FRGT-WGHT-X.                                          TRKCS142
016100         10  MR-FRGT-WGHT               PIC ZZZZZ9.               TRKCS142
016200                                                                  TRKCS142
016300     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          TRKCS142
016400         10  MR-PO-NBRL                 PIC S9(04) COMP.          TRKCS142
016500         10  MR-PO-NBRA                 PIC X(01).                TRKCS142
016600         10  MR-PO-NBRC                 PIC X(01).                TRKCS142
016700         10  MR-PO-NBRH                 PIC X(01).                TRKCS142
016700** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  TRKCS142
016800         10  MR-PO-NBR                  PIC X(08).                TRKCS142
016900                                                                  TRKCS142
016910         10  MR-DC-NBRL                 PIC S9(04) COMP.          TRKCS142
016920         10  MR-DC-NBRA                 PIC X(01).                TRKCS142
016930         10  MR-DC-NBRC                 PIC X(01).                TRKCS142
016940         10  MR-DC-NBRH                 PIC X(01).                TRKCS142
016950         10  MR-DC-NBR                  PIC X(04).                TRKCS142
016960                                                                  TRKCS142
017000         10  MR-REC-SEQ-NBRL            PIC S9(04) COMP.          TRKCS142
017100         10  MR-REC-SEQ-NBRA            PIC X(01).                TRKCS142
017200         10  MR-REC-SEQ-NBRC            PIC X(01).                TRKCS142
017300         10  MR-REC-SEQ-NBRH            PIC X(01).                TRKCS142
017400         10  MR-REC-SEQ-NBR             PIC X(04).                TRKCS142
017500                                                                  TRKCS142
017600         10  MR-OLD-RCVR-NBRL           PIC S9(04) COMP.          TRKCS142
017700         10  MR-OLD-RCVR-NBRA           PIC X(01).                TRKCS142
017800         10  MR-OLD-RCVR-NBRC           PIC X(01).                TRKCS142
017900         10  MR-OLD-RCVR-NBRH           PIC X(01).                TRKCS142
018000         10  MR-OLD-RCVR-NBR            PIC X(09).                TRKCS142
018100                                                                  TRKCS142
018200         10  MR-STATUS-CDEL             PIC S9(04) COMP.          TRKCS142
018300         10  MR-STATUS-CDEA             PIC X(01).                TRKCS142
018400         10  MR-STATUS-CDEC             PIC X(01).                TRKCS142
018500         10  MR-STATUS-CDEH             PIC X(01).                TRKCS142
018600         10  MR-STATUS-CDE              PIC X(02).                TRKCS142
018700                                                                  TRKCS142
018800         10  MR-DEPTL                   PIC S9(04) COMP.          TRKCS142
018900         10  MR-DEPTA                   PIC X(01).                TRKCS142
019000         10  MR-DEPTC                   PIC X(01).                TRKCS142
019100         10  MR-DEPTH                   PIC X(01).                TRKCS142
019200         10  MR-DEPT                    PIC X(04).                TRKCS142
019300                                                                  TRKCS142
019301         10  MR-CLASSL                  PIC S9(04) COMP.          TRKCS142
019302         10  MR-CLASSA                  PIC X(01).                TRKCS142
019303         10  MR-CLASSC                  PIC X(01).                TRKCS142
019304         10  MR-CLASSH                  PIC X(01).                TRKCS142
019305         10  MR-CLASS                   PIC X(04).                TRKCS142
019306                                                                  TRKCS142
019400         10  MR-CTN-CNTL                PIC S9(04) COMP.          TRKCS142
019500         10  MR-CTN-CNTA                PIC X(01).                TRKCS142
019600         10  MR-CTN-CNTC                PIC X(01).                TRKCS142
019700         10  MR-CTN-CNTH                PIC X(01).                TRKCS142
019800         10  MR-CTN-CNT-X.                                        TRKCS142
019900             15  MR-CTN-CNT             PIC ZZZ9.                 TRKCS142
020000                                                                  TRKCS142
020100         10  MR-ADJ-CNTL                PIC S9(04) COMP.          TRKCS142
020200         10  MR-ADJ-CNTA                PIC X(01).                TRKCS142
020300         10  MR-ADJ-CNTC                PIC X(01).                TRKCS142
020400         10  MR-ADJ-CNTH                PIC X(01).                TRKCS142
020500         10  MR-ADJ-CNT-X.                                        TRKCS142
020600             15  MR-ADJ-CNT             PIC ZZZ9.                 TRKCS142
020700                                                                  TRKCS142
020800         10  MR-DMG-CNTL                PIC S9(04) COMP.          TRKCS142
020900         10  MR-DMG-CNTA                PIC X(01).                TRKCS142
021000         10  MR-DMG-CNTC                PIC X(01).                TRKCS142
021100         10  MR-DMG-CNTH                PIC X(01).                TRKCS142
021200         10  MR-DMG-CNT-X.                                        TRKCS142
021300             15  MR-DMG-CNT             PIC ZZZ9.                 TRKCS142
021400                                                                  TRKCS142
021500         10  MR-CHGSL                   PIC S9(04) COMP.          TRKCS142
021600         10  MR-CHGSA                   PIC X(01).                TRKCS142
021700         10  MR-CHGSC                   PIC X(01).                TRKCS142
021800         10  MR-CHGSH                   PIC X(01).                TRKCS142
021900         10  MR-CHGS-X.                                           TRKCS142
022000             15  MR-CHARGES             PIC ZZZZ9.99.             TRKCS142
022100                                                                  TRKCS142
022200     05  MR-TOT-CTN-CNTL                PIC S9(04) COMP.          TRKCS142
022300     05  MR-TOT-CTN-CNTA                PIC X(01).                TRKCS142
022400     05  MR-TOT-CTN-CNTC                PIC X(01).                TRKCS142
022500     05  MR-TOT-CTN-CNTH                PIC X(01).                TRKCS142
022600     05  MR-TOT-CTN-CNT-X.                                        TRKCS142
022700         10  MR-TOT-CTN-CNT             PIC ZZZZ9.                TRKCS142
022800                                                                  TRKCS142
022900     05  MR-TOT-ADJ-CNTL                PIC S9(04) COMP.          TRKCS142
023000     05  MR-TOT-ADJ-CNTA                PIC X(01).                TRKCS142
023100     05  MR-TOT-ADJ-CNTC                PIC X(01).                TRKCS142
023200     05  MR-TOT-ADJ-CNTH                PIC X(01).                TRKCS142
023300     05  MR-TOT-ADJ-CNT-X.                                        TRKCS142
023400         10  MR-TOT-ADJ-CNT             PIC ZZZZ9.                TRKCS142
023500                                                                  TRKCS142
023600     05  MR-TOT-DMG-CNTL                PIC S9(04) COMP.          TRKCS142
023700     05  MR-TOT-DMG-CNTA                PIC X(01).                TRKCS142
023800     05  MR-TOT-DMG-CNTC                PIC X(01).                TRKCS142
023900     05  MR-TOT-DMG-CNTH                PIC X(01).                TRKCS142
024000     05  MR-TOT-DMG-CNT-X.                                        TRKCS142
024100         10  MR-TOT-DMG-CNT             PIC ZZZZ9.                TRKCS142
024200                                                                  TRKCS142
024300     05  MR-TOT-CHGSL                   PIC S9(04) COMP.          TRKCS142
024400     05  MR-TOT-CHGSA                   PIC X(01).                TRKCS142
024500     05  MR-TOT-CHGSC                   PIC X(01).                TRKCS142
024600     05  MR-TOT-CHGSH                   PIC X(01).                TRKCS142
024700     05  MR-TOT-CHGS-X.                                           TRKCS142
024800         10  MR-TOT-CHGS                PIC ZZZZZ9.99.            TRKCS142
024900                                                                  TRKCS142
025000/                                                                 TRKCS142
025100*---------------------------------------------------------------* TRKCS142
025200*    ABEND PROCESSING COPYBOOK.                                 * TRKCS142
025300*---------------------------------------------------------------* TRKCS142
025400     COPY DPWS013.                                                TRKCS142
025500                                                                  TRKCS142
025600/                                                                 TRKCS142
025700*---------------------------------------------------------------* TRKCS142
025800*    ATTRIBUTE SETTINGS COPYBOOK.                               * TRKCS142
025900*---------------------------------------------------------------* TRKCS142
026000     COPY DPWS015.                                                TRKCS142
026100                                                                  TRKCS142
026200*---------------------------------------------------------------* TRKCS142
026300*    FUNCTION KEYS COPYBOOK.                                    * TRKCS142
026400*---------------------------------------------------------------* TRKCS142
026500     COPY DPWS016.                                                TRKCS142
026600                                                                  TRKCS142
026700*---------------------------------------------------------------* TRKCS142
026800*    NUMERIC EDIT LAYOUT.                                       * TRKCS142
026900*---------------------------------------------------------------* TRKCS142
027000     COPY DPWS010I.                                               TRKCS142
027100                                                                  TRKCS142
027200/                                                                 TRKCS142
027300*---------------------------------------------------------------* TRKCS142
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * TRKCS142
027500*---------------------------------------------------------------* TRKCS142
027600     COPY DPWS030.                                                TRKCS142
CICS       COPY DPWS930.                                                TRKCS142
027800/                                                                 TRKCS142
027900*---------------------------------------------------------------* TRKCS142
028000*    STANDARD COMMAREA.                                         * TRKCS142
028100*---------------------------------------------------------------* TRKCS142
028200     COPY DPWS020.                                                TRKCS142
028300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                TRKCS142
028400                                                                  TRKCS142
028500*---------------------------------------------------------------* TRKCS142
028600* INTER-APPLICATION COMMAREA.                                   * TRKCS142
028700*---------------------------------------------------------------* TRKCS142
028800                                                                  TRKCS142
028900         10  INTER-APPL-COMM-AREA       PIC X(200).               TRKCS142
029000     COPY TRWS013.                                                TRKCS142
029100     COPY TRWS014.                                                TRKCS142
029200*---------------------------------------------------------------* TRKCS142
029300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * TRKCS142
029400*---------------------------------------------------------------* TRKCS142
029500         10  ASC-SPECIFIC-COMMAREA.                               TRKCS142
029600             15  ASC-LIST-KEYS.                                   TRKCS142
029700                 20  ASC-KEY-OWNER-SCAC-ID PIC X(04).             TRKCS142
029800                 20  ASC-KEY-PRO-NBR    PIC X(22).                TRKCS142
029900             15  ASC-VEH-NBR            PIC X(10).                TRKCS142
030000             15  ASC-FRGT-CHG           PIC X(08).                TRKCS142
030100             15  ASC-FRGT-CHG-N REDEFINES ASC-FRGT-CHG            TRKCS142
030200                                        PIC 9(06)V99.             TRKCS142
030300             15  ASC-TERMS              PIC X(04).                TRKCS142
030400             15  ASC-FRGT-WGHT          PIC X(06).                TRKCS142
030500             15  ASC-FRGT-WGHT-N REDEFINES ASC-FRGT-WGHT          TRKCS142
030600                                        PIC 9(06).                TRKCS142
030700             15  ASC-TOT-CTN            PIC X(05).                TRKCS142
030800             15  ASC-TOT-CTN-N REDEFINES ASC-TOT-CTN              TRKCS142
030900                                        PIC 9(05).                TRKCS142
031000             15  ASC-TOT-ADJ            PIC X(05).                TRKCS142
031100             15  ASC-TOT-ADJ-N REDEFINES ASC-TOT-ADJ              TRKCS142
031200                                        PIC 9(05).                TRKCS142
031300             15  ASC-TOT-DMG            PIC X(05).                TRKCS142
031400             15  ASC-TOT-DMG-N REDEFINES ASC-TOT-DMG              TRKCS142
031500                                        PIC 9(05).                TRKCS142
031600             15  ASC-TOT-CHGS           PIC X(08).                TRKCS142
031700             15  ASC-TOT-CHGS-N REDEFINES ASC-TOT-CHGS            TRKCS142
031800                                        PIC 9(06)V99.             TRKCS142
031900             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           TRKCS142
032000                 20  ASC-ITEM-ARRAY.                              TRKCS142
032100                     25  ASC-ITEM-ENTRIES OCCURS 09 TIMES.        TRKCS142
032200                         30  ASC-LIST-ITEM-NUMBER                 TRKCS142
032300                                        PIC S9(09) COMP-3.        TRKCS142
016700** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  TRKCS142
032400                         30  ASC-PO-NBR      PIC 9(08).           TRKCS142
032410                         30  ASC-DC-NBR      PIC X(04).                   
032500                         30  ASC-REC-SEQ-NBR PIC 9(04).           TRKCS142
032600                         30  ASC-OLD-RCVR.                        TRKCS142
032700                             35  ASC-OLD-RCVR-NBR   PIC X(07).    TRKCS142
032800                             35  ASC-OLD-RCVR-DASH  PIC X(01).    TRKCS142
032900                             35  ASC-OLD-RCVR-CKDG  PIC X(01).    TRKCS142
033000                         30  ASC-STATUS-CDE  PIC X(02).           TRKCS142
033100                         30  ASC-DEPT       PIC S9(04).           TRKCS142
033110                         30  ASC-CLASS      PIC S9(04).           TRKCS142
033200                         30  ASC-CTN-CNT    PIC 9(04).            TRKCS142
033300                         30  ASC-ADJ-CNT    PIC 9(04).            TRKCS142
033400                         30  ASC-DMG-CNT    PIC 9(04).            TRKCS142
033500                         30  ASC-CHGS       PIC 9(05)V99.         TRKCS142
033600                                                                  TRKCS142
033700             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     TRKCS142
033800             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     TRKCS142
033900             15  ASC-SEL-SUB            PIC S9(04) COMP SYNC.     TRKCS142
034000             15  ASC-SEL-ITEM           PIC S9(04) COMP SYNC.     TRKCS142
034100             15  ASC-NUMBER-OF-ITEMS-READ                         TRKCS142
034200                                        PIC S9(09) COMP-3.        TRKCS142
034300             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        TRKCS142
034400             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        TRKCS142
034500             15  ASC-ITEM-AT-TOP-OF-PANEL                         TRKCS142
034600                                        PIC S9(09) COMP-3.        TRKCS142
034700             15  ASC-ITEM-AT-BOT-OF-PANEL                         TRKCS142
034800                                        PIC S9(09) COMP-3.        TRKCS142
034900             15  ASC-HIGHEST-BLOCK-WRITTEN                        TRKCS142
035000                                        PIC S9(04) COMP SYNC.     TRKCS142
035100             15  ASC-ITEMS-LEFT-INDICATOR                         TRKCS142
035200                                        PIC  X(01).               TRKCS142
035300                 88  ASC-ITEMS-LEFT-ON-DB     VALUE 'Y'.          TRKCS142
035400                 88  ASC-NO-ITEMS-LEFT-ON-DB  VALUE 'N'.          TRKCS142
035500             15  ASC-USE-SELECTION-QUEUE-IND                      TRKCS142
035600                                        PIC  X(01).               TRKCS142
035700                 88  ASC-USE-SELECTION-QUEUE  VALUE 'Y'.          TRKCS142
035800             15  ASC-DTL-QUEUE-NAME.                              TRKCS142
035900                 20  ASC-DTL-TERM-ID     PIC  X(04).              TRKCS142
036000                 20  ASC-DTL-TASK-NUMBER PIC S9(05) COMP-3.       TRKCS142
036100                 20  ASC-DTL-SEQ         PIC  9(01).              TRKCS142
036200             15  ASC-SEL-QUEUE-NAME.                              TRKCS142
036300                 20  ASC-SEL-TERM-ID     PIC  X(04).              TRKCS142
036400                 20  ASC-SEL-TASK-NUMBER PIC S9(05) COMP-3.       TRKCS142
036500                 20  ASC-SEL-SEQ         PIC  9(01).              TRKCS142
036600                                                                  TRKCS142
036700             15  ASC-START-ITEM-REQUEST.                          TRKCS142
036800                 20  ASC-START-ITEM-REQUEST-N                     TRKCS142
036900                                        PIC 9(07).                TRKCS142
037000                                                                  TRKCS142
037100/                                                                 TRKCS142
037200*---------------------------------------------------------------* TRKCS142
037300*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * TRKCS142
037400*---------------------------------------------------------------* TRKCS142
037500     COPY TRWS015.                                                TRKCS142
037600                                                                  TRKCS142
037700/                                                                 TRKCS142
037800*---------------------------------------------------------------* TRKCS142
037900*    DB2 AREA FOR THE SHIPMENT TABLE                            * TRKCS142
038000*---------------------------------------------------------------* TRKCS142
038100     EXEC SQL                                                     TRKCS142
038200          INCLUDE TSHIPMT                                         TRKCS142
038300     END-EXEC.                                                    TRKCS142
038400                                                                  TRKCS142
038500/                                                                 TRKCS142
038600*---------------------------------------------------------------* TRKCS142
038700*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * TRKCS142
038800*---------------------------------------------------------------* TRKCS142
038900     EXEC SQL                                                     TRKCS142
039000          INCLUDE TVHTRIP                                         TRKCS142
039100     END-EXEC.                                                    TRKCS142
039200                                                                  TRKCS142
039300/                                                                 TRKCS142
039400*---------------------------------------------------------------* TRKCS142
039500*    DB2 AREA FOR THE RECEIVER TABLE                            * TRKCS142
039600*---------------------------------------------------------------* TRKCS142
039700     EXEC SQL                                                     TRKCS142
039800          INCLUDE TRECEIV                                         TRKCS142
039900     END-EXEC.                                                    TRKCS142
040000                                                                  TRKCS142
040100/                                                                 TRKCS142
040200*---------------------------------------------------------------* TRKCS142
040300*    DB2 AREA FOR THE SHIPMENT PO TABLE                         * TRKCS142
040400*---------------------------------------------------------------* TRKCS142
040500     EXEC SQL                                                     TRKCS142
040600          INCLUDE TSHPTPO                                         TRKCS142
040700     END-EXEC.                                                    TRKCS142
040800                                                                  TRKCS142
040900/                                                                 TRKCS142
041000*---------------------------------------------------------------* TRKCS142
041100*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * TRKCS142
041200*---------------------------------------------------------------* TRKCS142
041300     EXEC SQL                                                     TRKCS142
041400          INCLUDE TPURITM                                         TRKCS142
041500     END-EXEC.                                                    TRKCS142
041600                                                                  TRKCS142
041601/                                                                 TRKCS142
041602*---------------------------------------------------------------* TRKCS142
041603*    DB2 AREA FOR THE TPURCHS TABLE                             * TRKCS142
041604*---------------------------------------------------------------* TRKCS142
041605     EXEC SQL                                                     TRKCS142
041606          INCLUDE TPURCHS                                         TRKCS142
041607     END-EXEC.                                                    TRKCS142
041608                                                                  TRKCS142
041609/                                                                 TRKCS142
041610*---------------------------------------------------------------* TRKCS142
041611*    DB2 AREA FOR THE TSKXREF TABLE                             * TRKCS142
041612*---------------------------------------------------------------* TRKCS142
041613     EXEC SQL                                                     TRKCS142
041614          INCLUDE TSKXREF                                         TRKCS142
041615     END-EXEC.                                                    TRKCS142
041616                                                                  TRKCS142
041700/                                                                 TRKCS142
041800*---------------------------------------------------------------* TRKCS142
041900*    DB2 AREA FOR COMMUNICATIONS                                * TRKCS142
042000*---------------------------------------------------------------* TRKCS142
042100     EXEC SQL                                                     TRKCS142
042200          INCLUDE SQLCA                                           TRKCS142
042300     END-EXEC.                                                    TRKCS142
042400                                                                  TRKCS142
042500/                                                                 TRKCS142
042600*---------------------------------------------------------------* TRKCS142
042700*  CURSOR TO SELECT ALL RECEIVERS FOR A FREIGHT BILL            * TRKCS142
042800*---------------------------------------------------------------* TRKCS142
042900                                                                  TRKCS142
043000     EXEC SQL                                                     TRKCS142
043100         DECLARE RECEIVER-CSR CURSOR FOR                          TRKCS142
043200             SELECT  A.ORD_NBR                                    TRKCS142
043300                    ,A.REC_SEQ_NBR                                TRKCS142
043400                    ,A.RCVR_NBR                                   TRKCS142
043500                    ,A.STATUS_CDE                                 TRKCS142
043600                    ,A.EXPTED_CART_CNT                            TRKCS142
043700                    ,A.ACTL_CART_CNT                              TRKCS142
043710                    ,A.OPER_UNT_ID                                        
043800                    ,B.OWNER_SCAC_ID                              TRKCS142
043900                    ,B.VEH_NBR                                    TRKCS142
044000                    ,C.PO_NBR                                     TRKCS142
044200                    ,C.DMG_CART_CNT                               TRKCS142
044300                    ,C.FRGT_CHG_AMT                               TRKCS142
044400                    ,D.FRGT_TERMS_CDE                             TRKCS142
044500                    ,D.EXPTED_GRO_WGHT                            TRKCS142
044510                    ,E.DEPT_NBR                                   TRKCS142
044600               FROM TRECEIV A                                     TRKCS142
044700                   ,TVHTRIP B                                     TRKCS142
044800                   ,TSHPTPO C                                     TRKCS142
044900                   ,TSHIPMT D                                     TRKCS142
044910                   ,TPURCHS E                                             
045000              WHERE D.PRO_NBR        = :DK-PRO-NBR                TRKCS142
045100                AND D.PRO_SCAC_ID    = :DK-OWNER-SCAC-ID          TRKCS142
045200                AND A.VER_STATUS_CDE = 'A'                        TRKCS142
045300                AND A.ORD_NBR     = C.PO_NBR                      TRKCS142
045400                AND C.PO_NBR      = E.PO_NBR                              
045401                AND E.VER_STATUS_CDE = 'A'                                
045402                AND A.REC_SEQ_NBR = C.REC_SEQ_NBR                 TRKCS142
045500                AND C.SHIPT_ID    = D.SHIPT_ID                    TRKCS142
045600                AND D.TRIP_ID     = B.TRIP_ID                     TRKCS142
045700           ORDER BY A.ORD_NBR                                     TRKCS142
045800                   ,A.REC_SEQ_NBR                                 TRKCS142
045900     END-EXEC.                                                    TRKCS142
046000                                                                  TRKCS142
046100/                                                                 TRKCS142
046200 LINKAGE SECTION.                                                 TRKCS142
046300                                                                  TRKCS142
046400 01  DFHCOMMAREA.                                                 TRKCS142
046500     05  FILLER                         OCCURS  1 TO 4072 TIMES   TRKCS142
046600                                        DEPENDING ON EIBCALEN.    TRKCS142
046700         10  FILLER                     PIC X.                    TRKCS142
046800                                                                  TRKCS142
046900/                                                                 TRKCS142
047000 PROCEDURE DIVISION.                                              TRKCS142
047100*---------------------------------------------------------------* TRKCS142
047200*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * TRKCS142
047300*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * TRKCS142
047400*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * TRKCS142
047500*---------------------------------------------------------------* TRKCS142
047600 0000-MAIN-MODULE.                                                TRKCS142
047700                                                                  TRKCS142
047800     INITIALIZE DP030-CICS-API-FIELDS.                            TRKCS142
047900                                                                  TRKCS142
048000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       TRKCS142
048100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          TRKCS142
048200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         TRKCS142
048300                                                                  TRKCS142
048400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       TRKCS142
048500                                                                  TRKCS142
048600     MOVE LENGTH OF TR142AI        TO DP030-MAP-LENGTH (1).       TRKCS142
048700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     TRKCS142
048800                                                                  TRKCS142
048900     PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS142
049000     PERFORM 1000-CONTROL-PROCESSING                              TRKCS142
049100                                                                  TRKCS142
049200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     TRKCS142
049300     PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS142
049400                                                                  TRKCS142
049500*---------------------------------------------------------------* TRKCS142
049600*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * TRKCS142
049700*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * TRKCS142
049800*---------------------------------------------------------------* TRKCS142
049900 0001-CALL-CICS-ARCH-API.                                         TRKCS142
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
050100                                    DFHCOMMAREA                           
050200                                    DP030-CICS-API-FIELDS                 
050300                                    DP020-STANDARD-COMMAREA               
050400                                    TR142AI.                              
050500                                                                  TRKCS142
050600     IF  DP030-RC-CALL-SUCCESSFUL                                 TRKCS142
050700         CONTINUE                                                 TRKCS142
050800     ELSE                                                         TRKCS142
050900         SET DP013-NO-ROLLBACK                                    TRKCS142
051000             DP013-XCTL-DISPLAY-RESTART                           TRKCS142
051100             DP013-CICS-ABEND      TO TRUE                        TRKCS142
051200         MOVE '0001-CALL-CICS-ARCH-API'                           TRKCS142
051300                                   TO DP013-PARAGRAPH             TRKCS142
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE OTRKCS142
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      TRKCS142
051600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      TRKCS142
051700         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
051800     END-IF.                                                      TRKCS142
051900                                                                  TRKCS142
052000*----------------------------------------------------------------*TRKCS142
052100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *TRKCS142
052200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *TRKCS142
052300*                                                                *TRKCS142
052400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *TRKCS142
052500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *TRKCS142
052600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *TRKCS142
052700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *TRKCS142
052800*----------------------------------------------------------------*TRKCS142
052900                                                                  TRKCS142
053000 1000-CONTROL-PROCESSING.                                         TRKCS142
053100                                                                  TRKCS142
053200     EVALUATE TRUE                                                TRKCS142
053300         WHEN DP020-NEXT-ACT-INITIAL                              TRKCS142
053400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 TRKCS142
053500             MOVE EIBTRMID         TO ASC-DTL-TERM-ID             TRKCS142
053600             MOVE DP020-SRC-TASK-NUMBER                           TRKCS142
053700                                   TO ASC-DTL-TASK-NUMBER         TRKCS142
053800             MOVE PC-DTL-QUEUE-SEQ TO ASC-DTL-SEQ                 TRKCS142
053900                                                                  TRKCS142
054000***-----$TEMPLATE NOTE$-------------------------------------------TRKCS142
054100*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,TRKCS142
054200*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  TRKCS142
054300*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.TRKCS142
054400***---------------------------------------------------------------TRKCS142
054500             IF  PS-COMMAREA-NOT-VALID                            TRKCS142
054600                 SET DP020-NEXT-ACT-APPL-ERROR                    TRKCS142
054700                                   TO TRUE                        TRKCS142
054800             ELSE                                                 TRKCS142
054900                 PERFORM 2050-DELETE-DETAIL-QUEUE                 TRKCS142
055000                 PERFORM 4000-BUILD-INITIAL-PANEL                 TRKCS142
055100                 PERFORM 3200-RESET-ATTRIBUTES                    TRKCS142
055200             END-IF                                               TRKCS142
055300                                                                  TRKCS142
055400         WHEN DP020-NEXT-ACT-READ-MAP                             TRKCS142
055500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        TRKCS142
055600                                   TO PV-TOP-ITEM                 TRKCS142
055700             PERFORM 2000-PROCESS-PANEL                           TRKCS142
055800                                                                  TRKCS142
055900         WHEN DP020-NEXT-ACT-RETURN                               TRKCS142
056000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        TRKCS142
056100                                   TO PV-TOP-ITEM                 TRKCS142
056200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    TRKCS142
056300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS142
056400             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS142
056500                                                                  TRKCS142
056600         WHEN OTHER                                               TRKCS142
056700             SET DP013-LOGIC-ABEND TO TRUE                        TRKCS142
056800             SET DP013-NO-ROLLBACK TO TRUE                        TRKCS142
056900             MOVE '1000-CONTROL-PROCESSING'                       TRKCS142
057000                                   TO DP013-PARAGRAPH             TRKCS142
057100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    TRKCS142
057200                                   TO DP013-MESSAGE-TEXT(1)       TRKCS142
057300             PERFORM DP013-0000-PROCESS-ABEND                     TRKCS142
057400     END-EVALUATE.                                                TRKCS142
057500                                                                  TRKCS142
057600/                                                                 TRKCS142
057700*----------------------------------------------------------------*TRKCS142
057800* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *TRKCS142
057900*----------------------------------------------------------------*TRKCS142
058000                                                                  TRKCS142
058100 1100-PROCESS-INTER-APPL-COMM.                                    TRKCS142
058200                                                                  TRKCS142
058300     INITIALIZE ASC-SPECIFIC-COMMAREA.                            TRKCS142
058400                                                                  TRKCS142
058500     SET PS-COMMAREA-VALID         TO TRUE.                       TRKCS142
058600     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     TRKCS142
058700                                                                  TRKCS142
058800     EVALUATE DP020-INT-APPL-FORMAT-IND                           TRKCS142
058900         WHEN PC-CRIT-SPEC-FORMAT                                 TRKCS142
059000              IF  TR013-PRO-NBR = SPACES                          TRKCS142
059100              OR  TR013-OWNER-SCAC-ID = SPACES                    TRKCS142
059200                  MOVE PC-TSYMSG-00460                            TRKCS142
059300                                   TO DP020-MSG-NUMBER            TRKCS142
059400                  SET DP020-MSG-FATAL                             TRKCS142
059500                      DP020-NEXT-ACT-APPL-ERROR                   TRKCS142
059600                      PS-COMMAREA-NOT-VALID                       TRKCS142
059700                                   TO TRUE                        TRKCS142
059800              ELSE                                                TRKCS142
059900                  MOVE TR013-PRO-NBR                              TRKCS142
060000                                   TO DK-PRO-NBR                  TRKCS142
060100                                      ASC-KEY-PRO-NBR             TRKCS142
060200                  MOVE TR013-OWNER-SCAC-ID                        TRKCS142
060300                                   TO DK-OWNER-SCAC-ID            TRKCS142
060400                                      ASC-KEY-OWNER-SCAC-ID       TRKCS142
060500              END-IF                                              TRKCS142
060600                                                                  TRKCS142
060700         WHEN PC-LIST-FORMAT                                      TRKCS142
060800              SET ASC-USE-SELECTION-QUEUE TO TRUE                 TRKCS142
060900              MOVE TR014-NUMBER-OF-TS-ITEMS                       TRKCS142
061000                                   TO ASC-NUMBER-OF-TS-ITEMS      TRKCS142
061100              MOVE TR014-SEL-QUEUE-NAME                           TRKCS142
061200                                   TO ASC-SEL-QUEUE-NAME          TRKCS142
061300              PERFORM 1120-PREPARE-LIST-ENTRY                     TRKCS142
061400                                                                  TRKCS142
061500         WHEN OTHER                                               TRKCS142
061600              MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER            TRKCS142
061700              SET DP020-MSG-FATAL                                 TRKCS142
061800                  DP020-NEXT-ACT-APPL-ERROR                       TRKCS142
061900                                   TO TRUE                        TRKCS142
062000     END-EVALUATE.                                                TRKCS142
062100                                                                  TRKCS142
062200/                                                                 TRKCS142
062300*----------------------------------------------------------------*TRKCS142
062400*    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *TRKCS142
062500*----------------------------------------------------------------*TRKCS142
062600                                                                  TRKCS142
062700 1120-PREPARE-LIST-ENTRY.                                         TRKCS142
062800                                                                  TRKCS142
062900     MOVE TR015-MAX-ITEMS          TO ASC-SEL-SUB.                TRKCS142
063000     MOVE ZERO                     TO ASC-SEL-ITEM.               TRKCS142
063100     PERFORM 2140-GET-NEXT-RECORD.                                TRKCS142
063200                                                                  TRKCS142
063300/                                                                 TRKCS142
063400*----------------------------------------------------------------*TRKCS142
063500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *TRKCS142
063600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *TRKCS142
063700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *TRKCS142
063800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *TRKCS142
063900* FUNCTION KEYS CAN GET THIS FAR.                                *TRKCS142
064000*----------------------------------------------------------------*TRKCS142
064100                                                                  TRKCS142
064200 2000-PROCESS-PANEL.                                              TRKCS142
064300     EVALUATE TRUE                                                TRKCS142
064400         WHEN DP020-SRC-AID = DP016-CLEAR                         TRKCS142
064500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    TRKCS142
064600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS142
064700             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS142
064800                                                                  TRKCS142
064900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    TRKCS142
065000             MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID       TRKCS142
065100             MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR             TRKCS142
065200             PERFORM 2050-DELETE-DETAIL-QUEUE                     TRKCS142
065300             PERFORM 4000-BUILD-INITIAL-PANEL                     TRKCS142
065400             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS142
065500                                                                  TRKCS142
065600         WHEN OTHER                                               TRKCS142
065700             IF PS-NO-ERROR                                       TRKCS142
065800                PERFORM 2100-CHECK-FUNCTION-KEY                   TRKCS142
065900             END-IF                                               TRKCS142
066000     END-EVALUATE.                                                TRKCS142
066100                                                                  TRKCS142
066200/                                                                 TRKCS142
066300*----------------------------------------------------------------*TRKCS142
066400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *TRKCS142
066500*----------------------------------------------------------------*TRKCS142
066600 2050-DELETE-DETAIL-QUEUE.                                        TRKCS142
066700                                                                  TRKCS142
066800     EXEC CICS                                                    TRKCS142
066900         DELETEQ TS                                               TRKCS142
067000           QUEUE (ASC-DTL-QUEUE-NAME)                             TRKCS142
067100            RESP (PV-CICS-RESP)                                   TRKCS142
067200     END-EXEC.                                                    TRKCS142
067300                                                                  TRKCS142
067400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       TRKCS142
067500        (PV-CICS-RESP = DFHRESP(QIDERR))                          TRKCS142
067600         CONTINUE                                                 TRKCS142
067700     ELSE                                                         TRKCS142
067800         SET DP013-CICS-ABEND                                     TRKCS142
067900             DP013-NO-ROLLBACK     TO TRUE                        TRKCS142
068000                                                                  TRKCS142
068100         MOVE '2050-DELETE-DTL-QUEUE'                             TRKCS142
068200                                   TO DP013-PARAGRAPH             TRKCS142
068300         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  TRKCS142
068400                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
068500         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
068600     END-IF.                                                      TRKCS142
068700                                                                  TRKCS142
068800     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  TRKCS142
068900                                                                  TRKCS142
069000/                                                                 TRKCS142
069100*----------------------------------------------------------------*TRKCS142
069200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*TRKCS142
069300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *TRKCS142
069400* CICS ARCHITECTURE API.                                         *TRKCS142
069500*----------------------------------------------------------------*TRKCS142
069600 2100-CHECK-FUNCTION-KEY.                                         TRKCS142
069700                                                                  TRKCS142
069800     EVALUATE TRUE                                                TRKCS142
069900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  TRKCS142
070000             MOVE +1               TO PV-TOP-ITEM                 TRKCS142
070100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS142
070200             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS142
070300                                                                  TRKCS142
070400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   TRKCS142
070500             PERFORM 2110-BROWSE-BACKWARD                         TRKCS142
070600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS142
070700             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS142
070800                                                                  TRKCS142
070900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   TRKCS142
071000             PERFORM 2120-BROWSE-FORWARD                          TRKCS142
071100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS142
071200             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS142
071300                                                                  TRKCS142
071400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             TRKCS142
071500             IF  ASC-USE-SELECTION-QUEUE                          TRKCS142
071600                 PERFORM 2140-GET-NEXT-RECORD                     TRKCS142
071700                 IF PS-LIST-END                                   TRKCS142
071800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         TRKCS142
071900                     SET PS-NO-LIST-END                           TRKCS142
072000                                   TO TRUE                        TRKCS142
072100                 ELSE                                             TRKCS142
072200                     PERFORM 2050-DELETE-DETAIL-QUEUE             TRKCS142
072300                     PERFORM 4000-BUILD-INITIAL-PANEL             TRKCS142
072400                 END-IF                                           TRKCS142
072500                 PERFORM 3200-RESET-ATTRIBUTES                    TRKCS142
072600             ELSE                                                 TRKCS142
072700                 MOVE PC-TSYMSG-00070                             TRKCS142
072800                                   TO DP020-MSG-NUMBER            TRKCS142
072900                 SET DP020-MSG-INFORMATIONAL                      TRKCS142
073000                                   TO TRUE                        TRKCS142
073100             END-IF                                               TRKCS142
073200                                                                  TRKCS142
073300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             TRKCS142
073400             IF  ASC-USE-SELECTION-QUEUE                          TRKCS142
073500                 PERFORM 2150-GET-PREV-RECORD                     TRKCS142
073600                 IF PS-LIST-END                                   TRKCS142
073700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         TRKCS142
073800                     SET PS-NO-LIST-END                           TRKCS142
073900                                   TO TRUE                        TRKCS142
074000                 ELSE                                             TRKCS142
074100                     PERFORM 2050-DELETE-DETAIL-QUEUE             TRKCS142
074200                     PERFORM 4000-BUILD-INITIAL-PANEL             TRKCS142
074300                 END-IF                                           TRKCS142
074400                 PERFORM 3200-RESET-ATTRIBUTES                    TRKCS142
074500             ELSE                                                 TRKCS142
074600                 MOVE PC-TSYMSG-00069                             TRKCS142
074700                                   TO DP020-MSG-NUMBER            TRKCS142
074800                 SET DP020-MSG-INFORMATIONAL                      TRKCS142
074900                                   TO TRUE                        TRKCS142
075000             END-IF                                               TRKCS142
075100                                                                  TRKCS142
075200         WHEN DP020-SRC-AID = DP016-ENTER                         TRKCS142
075300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   TRKCS142
075400             IF  PS-ERROR                                         TRKCS142
075500                 CONTINUE                                         TRKCS142
075600             ELSE                                                 TRKCS142
075700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             TRKCS142
075800                 PERFORM 3200-RESET-ATTRIBUTES                    TRKCS142
075900             END-IF                                               TRKCS142
076000                                                                  TRKCS142
076100         WHEN OTHER                                               TRKCS142
076200             SET DP013-NO-ROLLBACK                                TRKCS142
076300                 DP013-XCTL-DISPLAY-RESTART                       TRKCS142
076400                 DP013-CICS-ABEND  TO TRUE                        TRKCS142
076500             MOVE '2100-CHECK-FUNCTION-KEY'                       TRKCS142
076600                                   TO DP013-PARAGRAPH             TRKCS142
076700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      TRKCS142
076800                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
076900             PERFORM DP013-0000-PROCESS-ABEND                     TRKCS142
077000     END-EVALUATE.                                                TRKCS142
077100                                                                  TRKCS142
077200/                                                                 TRKCS142
077300*----------------------------------------------------------------*TRKCS142
077400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *TRKCS142
077500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *TRKCS142
077600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *TRKCS142
077700*    MESSAGE.                                                    *TRKCS142
077800*----------------------------------------------------------------*TRKCS142
077900                                                                  TRKCS142
078000 2110-BROWSE-BACKWARD.                                            TRKCS142
078100                                                                  TRKCS142
078200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    TRKCS142
078300         GIVING PV-TOP-ITEM.                                      TRKCS142
078400                                                                  TRKCS142
078500     IF  ((PV-TOP-ITEM < +1)                                      TRKCS142
078600       OR (PV-TOP-ITEM = +1))                                     TRKCS142
078700         MOVE +1                   TO PV-TOP-ITEM                 TRKCS142
078800*        -- TOP OF LIST --                                        TRKCS142
078900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            TRKCS142
079000         SET DP020-MSG-INFORMATIONAL                              TRKCS142
079100                                   TO TRUE                        TRKCS142
079200     END-IF.                                                      TRKCS142
079300                                                                  TRKCS142
079400/                                                                 TRKCS142
079500*----------------------------------------------------------------*TRKCS142
079600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *TRKCS142
079700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *TRKCS142
079800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *TRKCS142
079900*----------------------------------------------------------------*TRKCS142
080000                                                                  TRKCS142
080100 2120-BROWSE-FORWARD.                                             TRKCS142
080200                                                                  TRKCS142
080300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              TRKCS142
080400         GIVING PV-TOP-ITEM.                                      TRKCS142
080500                                                                  TRKCS142
080600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   TRKCS142
080700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            TRKCS142
080800                                   TO PV-TOP-ITEM                 TRKCS142
080900*        -- BOTTOM OF LIST --                                     TRKCS142
081000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            TRKCS142
081100         SET DP020-MSG-INFORMATIONAL                              TRKCS142
081200                                   TO TRUE                        TRKCS142
081300     ELSE                                                         TRKCS142
081400         COMPUTE PV-BOTTOM-ITEM =                                 TRKCS142
081500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 TRKCS142
081600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            TRKCS142
081700*            -- BOTTOM OF LIST --                                 TRKCS142
081800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            TRKCS142
081900             SET DP020-MSG-INFORMATIONAL                          TRKCS142
082000                                   TO TRUE                        TRKCS142
082100         END-IF                                                   TRKCS142
082200     END-IF.                                                      TRKCS142
082300                                                                  TRKCS142
082400/                                                                 TRKCS142
082500*----------------------------------------------------------------*TRKCS142
082600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *TRKCS142
082700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *TRKCS142
082800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *TRKCS142
082900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *TRKCS142
083000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *TRKCS142
083100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *TRKCS142
083200*----------------------------------------------------------------*TRKCS142
083300                                                                  TRKCS142
083400 2130-CHECK-FOR-JUMP-BROWSE.                                      TRKCS142
083500                                                                  TRKCS142
083600     IF ASTRTITL > ZERO                                           TRKCS142
083700         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      TRKCS142
083800     ELSE                                                         TRKCS142
083900         IF ASTRTITF = DP015-ERASE-EOF                            TRKCS142
084000             INITIALIZE ASC-START-ITEM-REQUEST                    TRKCS142
084100         END-IF                                                   TRKCS142
084200     END-IF.                                                      TRKCS142
084300                                                                  TRKCS142
084400     SET PS-NO-ERROR               TO TRUE.                       TRKCS142
084500                                                                  TRKCS142
084600     IF (ASC-START-ITEM-REQUEST = SPACE)                          TRKCS142
084700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            TRKCS142
084800                                   TO PV-TOP-ITEM                 TRKCS142
084900     ELSE                                                         TRKCS142
085000         MOVE ASC-START-ITEM-REQUEST                              TRKCS142
085100                                   TO DP010I-UNEDITED-FIELD       TRKCS142
085200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       TRKCS142
085300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     TRKCS142
085400         SET DP010I-NEGATIVE-NOT-ALLOWED                          TRKCS142
085500                                   TO TRUE                        TRKCS142
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
085700                                                                  TRKCS142
085800         IF  NOT DP010I-ERROR-DETECTED                            TRKCS142
085900             MOVE DP010I-NUMERIC-FIELD                            TRKCS142
086000                                   TO ASC-START-ITEM-REQUEST-N    TRKCS142
086100             IF  ASC-START-ITEM-REQUEST-N > ZERO                  TRKCS142
086200                 IF  ASC-START-ITEM-REQUEST-N >                   TRKCS142
086300                                          ASC-NUMBER-OF-ITEMS-READTRKCS142
086400                     MOVE SPACE TO ASC-START-ITEM-REQUEST         TRKCS142
086500                     COMPUTE PV-TOP-ITEM =                        TRKCS142
086600                             ASC-NUMBER-OF-ITEMS-READ             TRKCS142
086700                             - PC-ITEMS-PER-PANEL + 1             TRKCS142
086800                     IF  PV-TOP-ITEM < +1                         TRKCS142
086900                         MOVE +1   TO PV-TOP-ITEM                 TRKCS142
087000                         MOVE PC-TSYMSG-00070                     TRKCS142
087100                                   TO DP020-MSG-NUMBER            TRKCS142
087200                         SET DP020-MSG-INFORMATIONAL              TRKCS142
087300                                   TO TRUE                        TRKCS142
087400                     END-IF                                       TRKCS142
087500                 ELSE                                             TRKCS142
087600                     MOVE ASC-START-ITEM-REQUEST-N                TRKCS142
087700                                   TO PV-TOP-ITEM                 TRKCS142
087800                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      TRKCS142
087900                     COMPUTE PV-BOTTOM-ITEM =                     TRKCS142
088000                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     TRKCS142
088100                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READTRKCS142
088200*                        -- BOTTOM OF LIST --                     TRKCS142
088300                         MOVE PC-TSYMSG-00070                     TRKCS142
088400                                   TO DP020-MSG-NUMBER            TRKCS142
088500                         SET DP020-MSG-INFORMATIONAL              TRKCS142
088600                                   TO TRUE                        TRKCS142
088700                     END-IF                                       TRKCS142
088800                 END-IF                                           TRKCS142
088900             ELSE                                                 TRKCS142
089000*                --- VALUE OUT OF RANGE ----                      TRKCS142
089100                 MOVE PC-TSYMSG-00101                             TRKCS142
089200                                   TO DP020-MSG-NUMBER            TRKCS142
089300                 MOVE -1           TO ASTRTITL                    TRKCS142
089400                 SET DP030-SET-CURSOR-APPL-1                      TRKCS142
089500                                   TO TRUE                        TRKCS142
089600                 MOVE DP015-REVERSE                               TRKCS142
089700                                   TO ASTRTITH                    TRKCS142
089800                 MOVE DP015-RED    TO ASTRTITC                    TRKCS142
089900                 MOVE DP015-UNP-NUM-BRT-MDT                       TRKCS142
090000                                   TO ASTRTITA                    TRKCS142
090100                 SET DP020-MSG-FATAL                              TRKCS142
090200                     PS-ERROR      TO TRUE                        TRKCS142
090300             END-IF                                               TRKCS142
090400                                                                  TRKCS142
090500         ELSE                                                     TRKCS142
090600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            TRKCS142
090700             MOVE -1               TO ASTRTITL                    TRKCS142
090800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  TRKCS142
090900             MOVE DP015-REVERSE    TO ASTRTITH                    TRKCS142
091000             MOVE DP015-RED        TO ASTRTITC                    TRKCS142
091100             MOVE DP015-UNP-NUM-BRT-MDT                           TRKCS142
091200                                   TO ASTRTITA                    TRKCS142
091300             SET DP020-MSG-FATAL                                  TRKCS142
091400                 PS-ERROR          TO TRUE                        TRKCS142
091500         END-IF                                                   TRKCS142
091600     END-IF.                                                      TRKCS142
091700                                                                  TRKCS142
091800/                                                                 TRKCS142
091900*----------------------------------------------------------------*TRKCS142
092000*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*TRKCS142
092100*----------------------------------------------------------------*TRKCS142
092200                                                                  TRKCS142
092300 2140-GET-NEXT-RECORD.                                            TRKCS142
092400                                                                  TRKCS142
092500     ADD +1                       TO ASC-SEL-SUB.                 TRKCS142
092600                                                                  TRKCS142
092700     IF  ASC-SEL-SUB > TR015-MAX-ITEMS                            TRKCS142
092800         ADD +1                   TO ASC-SEL-ITEM                 TRKCS142
092900         MOVE +1                  TO ASC-SEL-SUB                  TRKCS142
093000     END-IF.                                                      TRKCS142
093100                                                                  TRKCS142
093200     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                TRKCS142
093300         PERFORM 9100-READ-SEL-QUEUE                              TRKCS142
093400         IF  TR015-ITEM (ASC-SEL-SUB) > ZERO                      TRKCS142
093500             MOVE TR015-PRO-NBR (ASC-SEL-SUB)                     TRKCS142
093600                                  TO ASC-KEY-PRO-NBR              TRKCS142
093700             MOVE TR015-OWNER-SCAC-ID(ASC-SEL-SUB)                TRKCS142
093800                                  TO ASC-KEY-OWNER-SCAC-ID        TRKCS142
093900             SET TR015-INQ (ASC-SEL-SUB) TO TRUE                  TRKCS142
094000             PERFORM 9200-REWRITE-SEL-QUEUE                       TRKCS142
094100         ELSE                                                     TRKCS142
094200             SUBTRACT +1 FROM ASC-SEL-SUB                         TRKCS142
094300             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             TRKCS142
094400             SET DP020-MSG-INFORMATIONAL                          TRKCS142
094500                 PS-LIST-END             TO TRUE                  TRKCS142
094600         END-IF                                                   TRKCS142
094700     ELSE                                                         TRKCS142
094800         SUBTRACT +1 FROM ASC-SEL-ITEM                            TRKCS142
094900         MOVE TR015-MAX-ITEMS     TO ASC-SEL-SUB                  TRKCS142
095000         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             TRKCS142
095100         SET DP020-MSG-INFORMATIONAL                              TRKCS142
095200             PS-LIST-END             TO TRUE                      TRKCS142
095300     END-IF.                                                      TRKCS142
095400                                                                  TRKCS142
095500/                                                                 TRKCS142
095600*----------------------------------------------------------------*TRKCS142
095700*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *TRKCS142
095800*    PROCESSED.                                                  *TRKCS142
095900*----------------------------------------------------------------*TRKCS142
096000                                                                  TRKCS142
096100 2150-GET-PREV-RECORD.                                            TRKCS142
096200                                                                  TRKCS142
096300     SUBTRACT +1 FROM ASC-SEL-SUB.                                TRKCS142
096400                                                                  TRKCS142
096500     IF  ASC-SEL-SUB < +1                                         TRKCS142
096600         SUBTRACT +1 FROM ASC-SEL-ITEM                            TRKCS142
096700         MOVE TR015-MAX-ITEMS     TO ASC-SEL-SUB                  TRKCS142
096800     END-IF.                                                      TRKCS142
096900                                                                  TRKCS142
097000     IF  ASC-SEL-ITEM > ZERO                                      TRKCS142
097100         PERFORM 9100-READ-SEL-QUEUE                              TRKCS142
097200         MOVE TR015-PRO-NBR (ASC-SEL-SUB)                         TRKCS142
097300                                  TO ASC-KEY-PRO-NBR              TRKCS142
097400         MOVE TR015-OWNER-SCAC-ID(ASC-SEL-SUB)                    TRKCS142
097500                                  TO ASC-KEY-OWNER-SCAC-ID        TRKCS142
097600     ELSE                                                         TRKCS142
097700         MOVE +1                  TO ASC-SEL-ITEM                 TRKCS142
097800                                     ASC-SEL-SUB                  TRKCS142
097900         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             TRKCS142
098000         SET DP020-MSG-INFORMATIONAL                              TRKCS142
098100             PS-LIST-END             TO TRUE                      TRKCS142
098200     END-IF.                                                      TRKCS142
098300                                                                  TRKCS142
098400/                                                                 TRKCS142
098500*----------------------------------------------------------------*TRKCS142
098600*  RESET THE ATTRIBUTES.                                         *TRKCS142
098700*----------------------------------------------------------------*TRKCS142
098800                                                                  TRKCS142
098900 3200-RESET-ATTRIBUTES.                                           TRKCS142
099000                                                                  TRKCS142
099100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   TRKCS142
099200     MOVE DP015-GREEN              TO ASTRTITC.                   TRKCS142
099300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   TRKCS142
099400     MOVE -1                       TO ASTRTITL.                   TRKCS142
099500     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       TRKCS142
099600                                                                  TRKCS142
099700/                                                                 TRKCS142
099800*----------------------------------------------------------------*TRKCS142
099900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *TRKCS142
100000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *TRKCS142
100100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *TRKCS142
100200*    DISPLAY THE PANEL TO USER.                                  *TRKCS142
100300*----------------------------------------------------------------*TRKCS142
100400                                                                  TRKCS142
100500 4000-BUILD-INITIAL-PANEL.                                        TRKCS142
100600                                                                  TRKCS142
100700     INITIALIZE ASC-BLOCK-ENTRIES (1)                             TRKCS142
100800                ASC-BLOCK-ENTRIES (2).                            TRKCS142
100900                                                                  TRKCS142
101000     MOVE +1                       TO ASC-BLK-SUB.                TRKCS142
101100                                                                  TRKCS142
101200     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       TRKCS142
101300                                                                  TRKCS142
101400     MOVE +0                       TO ASC-ITEM-SUB                TRKCS142
101500                                      ASC-NUMBER-OF-ITEMS-READ    TRKCS142
101600                                      ASC-HIGHEST-BLOCK-WRITTEN   TRKCS142
101700                                      ASC-ITEM-AT-TOP-OF-PANEL.   TRKCS142
101800                                                                  TRKCS142
101900     PERFORM 4100-PREPARE-CURSOR.                                 TRKCS142
102000                                                                  TRKCS142
102100     PERFORM 4010-OPEN-CURSOR.                                    TRKCS142
102200                                                                  TRKCS142
102300     PERFORM 4300-READ-ITEMS-FROM-DB.                             TRKCS142
102400                                                                  TRKCS142
102500     PERFORM 4020-CLOSE-CURSOR.                                   TRKCS142
102600                                                                  TRKCS142
102700     MOVE +1                       TO PV-TOP-ITEM.                TRKCS142
102800                                                                  TRKCS142
102900     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          TRKCS142
103000         SET DP020-NEXT-ACT-APPL-ERROR                            TRKCS142
103100             DP020-MSG-FATAL       TO TRUE                        TRKCS142
103200         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            TRKCS142
103300     ELSE                                                         TRKCS142
103400         MOVE -1                   TO ASTRTITL                    TRKCS142
103500         SET DP030-SET-CURSOR-APPL-1                              TRKCS142
103600                                   TO TRUE                        TRKCS142
103700         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     TRKCS142
103800         PERFORM 3200-RESET-ATTRIBUTES                            TRKCS142
103900     END-IF.                                                      TRKCS142
104000                                                                  TRKCS142
104100/                                                                 TRKCS142
104200*----------------------------------------------------------------*TRKCS142
104300* OPEN THE RECEIVER CURSOR                                       *TRKCS142
104400*----------------------------------------------------------------*TRKCS142
104500                                                                  TRKCS142
104600 4010-OPEN-CURSOR.                                                TRKCS142
104700                                                                  TRKCS142
104800     PERFORM                                                      TRKCS142
104900         WITH TEST AFTER                                          TRKCS142
105000         VARYING PV-RETRY-COUNTER                                 TRKCS142
105100         FROM 1 BY 1                                              TRKCS142
105200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS142
105300            OR (SQLCODE = +0))                                    TRKCS142
105400                                                                  TRKCS142
105500         EXEC SQL                                                 TRKCS142
105600             OPEN RECEIVER-CSR                                    TRKCS142
105700         END-EXEC                                                 TRKCS142
105800                                                                  TRKCS142
105900         EVALUATE TRUE                                            TRKCS142
106000             WHEN SQLCODE = +0                                    TRKCS142
106100                  CONTINUE                                        TRKCS142
106200             WHEN SQLCODE = -904                                  TRKCS142
106300             WHEN SQLCODE = -913                                  TRKCS142
106400                  CONTINUE                                        TRKCS142
106500             WHEN SQLWARN0 NOT = SPACE                            TRKCS142
106600             WHEN SQLCODE  NOT = +0                               TRKCS142
106700                  MOVE '4010-OPEN-CURSOR'                         TRKCS142
106800                                   TO DP013-PARAGRAPH             TRKCS142
106900                  MOVE 'OPEN RECEIVER-CSR CURSOR'                 TRKCS142
107000                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
107100                  MOVE SQLCA       TO DP013-SQLCA                 TRKCS142
107200                  MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (1)    TRKCS142
107300                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (2)    TRKCS142
107400                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (3)    TRKCS142
107500                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (4)    TRKCS142
107600                  SET DP013-DB2-ABEND                             TRKCS142
107700                                   TO TRUE                        TRKCS142
107800                  PERFORM DP013-0000-PROCESS-ABEND                TRKCS142
107900         END-EVALUATE                                             TRKCS142
108000     END-PERFORM.                                                 TRKCS142
108100                                                                  TRKCS142
108200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                       CL**2
108300         SQLCODE  NOT = +0                                           CL**2
108400         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             TRKCS142
108500         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              TRKCS142
108600                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
108700         MOVE SQLCA                TO DP013-SQLCA                 TRKCS142
108800         SET DP013-DB2-ABEND       TO TRUE                        TRKCS142
108900         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
109000     END-IF.                                                      TRKCS142
109100                                                                  TRKCS142
109200/                                                                 TRKCS142
109300*----------------------------------------------------------------*TRKCS142
109400* CLOSE THE PROOF OF DELIVER CURSOR                              *TRKCS142
109500*----------------------------------------------------------------*TRKCS142
109600                                                                  TRKCS142
109700 4020-CLOSE-CURSOR.                                               TRKCS142
109800                                                                  TRKCS142
109900     EXEC SQL                                                     TRKCS142
110000         CLOSE RECEIVER-CSR                                       TRKCS142
110100     END-EXEC.                                                    TRKCS142
110200                                                                  TRKCS142
110300     EVALUATE TRUE                                                TRKCS142
110400         WHEN SQLCODE = +0                                        TRKCS142
110500              CONTINUE                                            TRKCS142
110600         WHEN SQLWARN0 NOT = SPACE                                TRKCS142
110700         WHEN SQLCODE  NOT = +0                                   TRKCS142
110800              MOVE '4020-CLOSE-CURSOR'                            TRKCS142
110900                                   TO DP013-PARAGRAPH             TRKCS142
111000              MOVE 'CLOSE RECEIVER-CSR CURSOR'                    TRKCS142
111100                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
111200              MOVE SQLCA           TO DP013-SQLCA                 TRKCS142
111300              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)    TRKCS142
111400              MOVE 'TVHTRIP'       TO DP013-DB2-TABLE-NAME (2)    TRKCS142
111500              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (3)    TRKCS142
111600              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (4)    TRKCS142
111700              SET DP013-DB2-ABEND  TO TRUE                        TRKCS142
111800              PERFORM DP013-0000-PROCESS-ABEND                    TRKCS142
111900     END-EVALUATE.                                                TRKCS142
112000                                                                  TRKCS142
112100/                                                                 TRKCS142
112200*----------------------------------------------------------------*TRKCS142
112300*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *TRKCS142
112400*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *TRKCS142
112500*----------------------------------------------------------------*TRKCS142
112600                                                                  TRKCS142
112700 4100-PREPARE-CURSOR.                                             TRKCS142
112800                                                                  TRKCS142
112900     EVALUATE DP020-INT-APPL-FORMAT-IND                           TRKCS142
113000         WHEN PC-CRIT-SPEC-FORMAT                                 TRKCS142
113100              MOVE TR013-PRO-NBR       TO DK-PRO-NBR              TRKCS142
113200              MOVE TR013-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID        TRKCS142
113300                                                                  TRKCS142
113400         WHEN PC-LIST-FORMAT                                      TRKCS142
113500              MOVE ASC-KEY-PRO-NBR       TO DK-PRO-NBR            TRKCS142
113600              MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID      TRKCS142
113700     END-EVALUATE.                                                TRKCS142
113800                                                                  TRKCS142
113900/                                                                 TRKCS142
114000*----------------------------------------------------------------*TRKCS142
114100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *TRKCS142
114200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *TRKCS142
114300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *TRKCS142
114400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *TRKCS142
114500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *TRKCS142
114600*                                                                *TRKCS142
114700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *TRKCS142
114800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *TRKCS142
114900*    UPON INITIALIZATION.                                        *TRKCS142
115000*----------------------------------------------------------------*TRKCS142
115100                                                                  TRKCS142
115200 4300-READ-ITEMS-FROM-DB.                                         TRKCS142
115300                                                                  TRKCS142
115400     PERFORM 4320-SUM-AMOUNTS.                                    TRKCS142
115500                                                                  TRKCS142
115600     MOVE PA-TOT-CART-CNT          TO ASC-TOT-CTN-N.              TRKCS142
115700     MOVE PA-TOT-ACTL-CART-CNT     TO ASC-TOT-ADJ-N.              TRKCS142
115800     MOVE PA-TOT-DMG-CART-CNT      TO ASC-TOT-DMG-N.              TRKCS142
115900     MOVE PA-TOT-FRGT-CHG          TO ASC-FRGT-CHG-N              TRKCS142
116000                                      ASC-TOT-CHGS-N.             TRKCS142
116100                                                                  TRKCS142
116200     PERFORM                                                      TRKCS142
116300         VARYING PV-READ-COUNT                                    TRKCS142
116400         FROM 1 BY 1                                              TRKCS142
116500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    TRKCS142
116600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         TRKCS142
116700                                                                  TRKCS142
116800         PERFORM 4310-FETCH                                       TRKCS142
116900                                                                  TRKCS142
117000         IF  ASC-ITEMS-LEFT-ON-DB                                 TRKCS142
117100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                TRKCS142
117200                 ADD +1            TO ASC-ITEM-SUB                TRKCS142
117300             ELSE                                                 TRKCS142
117400                 ADD +1            TO ASC-BLK-SUB                 TRKCS142
117500                 MOVE +1           TO ASC-ITEM-SUB                TRKCS142
117600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         TRKCS142
117700                     MOVE +1       TO ASC-BLK-SUB                 TRKCS142
117800                     PERFORM 5100-WRITE-TEMP-STORAGE              TRKCS142
117900                     MOVE ASC-BLOCK-ENTRIES                       TRKCS142
118000                               (PC-MAX-BLOCKS-IN-ARRAY)           TRKCS142
118100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) TRKCS142
118200                     ADD +1        TO ASC-BLK-SUB                 TRKCS142
118300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   TRKCS142
118400                 END-IF                                           TRKCS142
118500             END-IF                                               TRKCS142
118600             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    TRKCS142
118700             IF PV-NULL-IND = -1                                  TRKCS142
118800                 MOVE SPACES           TO ASC-VEH-NBR             TRKCS142
118900             ELSE                                                 TRKCS142
119000                 MOVE VHTRIP-VEH-NBR   TO ASC-VEH-NBR             TRKCS142
119100             END-IF                                               TRKCS142
119200             IF SHIPMT-FRGT-TERMS-CDE = 'C'                       TRKCS142
119300                MOVE 'COLL'        TO ASC-TERMS                   TRKCS142
119400             ELSE                                                 TRKCS142
119500                IF SHIPMT-FRGT-TERMS-CDE = 'P'                    TRKCS142
119600                   MOVE 'PPD'      TO ASC-TERMS                   TRKCS142
119610                ELSE                                                      
119620                    IF SHIPMT-FRGT-TERMS-CDE = 'F'                        
119630                       MOVE 'FREE' TO ASC-TERMS                           
119640                    END-IF                                                
119700                END-IF                                            TRKCS142
119800             END-IF                                               TRKCS142
119900             MOVE SHIPMT-EXPTED-GRO-WGHT                          TRKCS142
120000                                   TO ASC-FRGT-WGHT-N             TRKCS142
120100             MOVE ASC-NUMBER-OF-ITEMS-READ                        TRKCS142
120200                                   TO ASC-LIST-ITEM-NUMBER        TRKCS142
120300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  TRKCS142
120400             MOVE SHPTPO-PO-NBR    TO ASC-PO-NBR                  TRKCS142
120500                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS142
120600                                      DK-PO-NBR                   TRKCS142
120610             MOVE RECEIV-OPER-UNT-ID TO ASC-DC-NBR                        
120620                                       (ASC-BLK-SUB ASC-ITEM-SUB)         
120700             MOVE RECEIV-REC-SEQ-NBR TO ASC-REC-SEQ-NBR           TRKCS142
120800                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS142
120900             MOVE RECEIV-RCVR-NBR    TO PV-OLD-RCVR-NBR           TRKCS142
121000             MOVE PV-OLD-RCVR-NBR-2-8 TO ASC-OLD-RCVR-NBR         TRKCS142
121100                                        (ASC-BLK-SUB ASC-ITEM-SUB)TRKCS142
121200             MOVE '-'                 TO ASC-OLD-RCVR-DASH        TRKCS142
121300                                        (ASC-BLK-SUB ASC-ITEM-SUB)TRKCS142
121400             MOVE PV-OLD-RCVR-NBR-9   TO ASC-OLD-RCVR-CKDG        TRKCS142
121500                                        (ASC-BLK-SUB ASC-ITEM-SUB)TRKCS142
121600             MOVE RECEIV-STATUS-CDE  TO ASC-STATUS-CDE            TRKCS142
121700                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS142
121800             PERFORM 4330-GET-MAJOR-CLASS                         TRKCS142
121900             IF  SQLCODE = +100                                   TRKCS142
122000                 MOVE ZEROS        TO ASC-DEPT                    TRKCS142
122100                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS142
122101                                      ASC-CLASS                   TRKCS142
122102                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS142
122200             ELSE                                                 TRKCS142
122300                 MOVE SKXREF-CLASS       TO ASC-CLASS                     
122400                                       (ASC-BLK-SUB ASC-ITEM-SUB)         
122500                 MOVE PURCHS-DEPT-NBR    TO PV-DEPT-NBR-N         TRKCS141
122600                 MOVE PV-DEPT-NBR-N      TO ASC-DEPT                      
122700                                       (ASC-BLK-SUB ASC-ITEM-SUB)         
122900             END-IF                                               TRKCS142
123000             MOVE RECEIV-EXPTED-CART-CNT TO ASC-CTN-CNT           TRKCS142
123100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  TRKCS142
123200             MOVE RECEIV-ACTL-CART-CNT TO ASC-ADJ-CNT             TRKCS142
123300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  TRKCS142
123400             MOVE SHPTPO-DMG-CART-CNT TO ASC-DMG-CNT              TRKCS142
123500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  TRKCS142
123600             MOVE SHPTPO-FRGT-CHG-AMT TO ASC-CHGS                 TRKCS142
123700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  TRKCS142
123800         END-IF                                                   TRKCS142
123900     END-PERFORM.                                                 TRKCS142
124000                                                                  TRKCS142
124100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          TRKCS142
124200         MOVE +1                   TO ASC-BLK-SUB                 TRKCS142
124300         PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS142
124400         ADD +1                    TO ASC-BLK-SUB                 TRKCS142
124500         PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS142
124600         MOVE 1                    TO ASC-BLK-SUB                 TRKCS142
124700                                      PV-BLOCK-NUMBER             TRKCS142
124800         PERFORM 4410-READ-TEMP-STORAGE                           TRKCS142
124900         IF  ASC-HIGHEST-BLOCK-WRITTEN > 1                        TRKCS142
125000             MOVE 2                TO ASC-BLK-SUB                 TRKCS142
125100                                      PV-BLOCK-NUMBER             TRKCS142
125200             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS142
125300         END-IF                                                   TRKCS142
125400     END-IF.                                                      TRKCS142
125500                                                                  TRKCS142
125600/                                                                 TRKCS142
125700*----------------------------------------------------------------*TRKCS142
125800*    FETCH A RECEIVER ROW                                        *TRKCS142
125900*----------------------------------------------------------------*TRKCS142
126000                                                                  TRKCS142
126100 4310-FETCH.                                                      TRKCS142
126200                                                                  TRKCS142
126300     EXEC SQL                                                     TRKCS142
126400          FETCH  RECEIVER-CSR                                     TRKCS142
126500           INTO :RECEIV-ORD-NBR                                   TRKCS142
126600               ,:RECEIV-REC-SEQ-NBR                               TRKCS142
126700               ,:RECEIV-RCVR-NBR                                  TRKCS142
126800               ,:RECEIV-STATUS-CDE                                TRKCS142
126900               ,:RECEIV-EXPTED-CART-CNT                           TRKCS142
127000               ,:RECEIV-ACTL-CART-CNT                             TRKCS142
127010               ,:RECEIV-OPER-UNT-ID                                       
127100               ,:VHTRIP-OWNER-SCAC-ID                             TRKCS142
127200               ,:VHTRIP-VEH-NBR :PV-NULL-IND                      TRKCS142
127300               ,:SHPTPO-PO-NBR                                    TRKCS142
127500               ,:SHPTPO-DMG-CART-CNT                              TRKCS142
127600               ,:SHPTPO-FRGT-CHG-AMT                              TRKCS142
127700               ,:SHIPMT-FRGT-TERMS-CDE                            TRKCS142
127800               ,:SHIPMT-EXPTED-GRO-WGHT                           TRKCS142
127810               ,:PURCHS-DEPT-NBR                                  TRKCS142
127900     END-EXEC.                                                    TRKCS142
128000                                                                  TRKCS142
128100     EVALUATE TRUE                                                TRKCS142
128200         WHEN SQLCODE = +0                                        TRKCS142
128300              CONTINUE                                            TRKCS142
128400         WHEN SQLCODE = +100                                      TRKCS142
128500              SET ASC-NO-ITEMS-LEFT-ON-DB                         TRKCS142
128600                                   TO TRUE                        TRKCS142
128700         WHEN SQLWARN0 NOT = SPACE                                TRKCS142
128800         WHEN SQLCODE < +0                                        TRKCS142
128900         WHEN SQLCODE > +0                                        TRKCS142
129000              MOVE '4310-FETCH-CURSOR'                            TRKCS142
129100                                   TO DP013-PARAGRAPH             TRKCS142
129200              MOVE 'FETCH RECEIVER CURSOR'                        TRKCS142
129300                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
129400              MOVE SQLCA           TO DP013-SQLCA                 TRKCS142
129500              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)    TRKCS142
129600              MOVE 'TVHTRIP'       TO DP013-DB2-TABLE-NAME (2)    TRKCS142
129700              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (3)    TRKCS142
129800              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (4)    TRKCS142
129900              SET DP013-DB2-ABEND  TO TRUE                        TRKCS142
130000              PERFORM DP013-0000-PROCESS-ABEND                    TRKCS142
130100     END-EVALUATE.                                                TRKCS142
130200                                                                  TRKCS142
130300/                                                                 TRKCS142
130400*----------------------------------------------------------------*TRKCS142
130500* CALCULATE THE TOTAL FREIGHT CHARGES AND WEIGHT                 *TRKCS142
130600*----------------------------------------------------------------*TRKCS142
130700                                                                  TRKCS142
130800 4320-SUM-AMOUNTS.                                                TRKCS142
130900                                                                  TRKCS142
131000     PERFORM                                                      TRKCS142
131100         WITH TEST AFTER                                          TRKCS142
131200         VARYING PV-RETRY-COUNTER                                 TRKCS142
131300         FROM 1 BY 1                                              TRKCS142
131400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS142
131500            OR (SQLCODE = +0)                                     TRKCS142
131600            OR (SQLCODE = +100)                                   TRKCS142
131700            OR (SQLCODE = -305))                                  TRKCS142
131800                                                                  TRKCS142
131900         EXEC SQL                                                 TRKCS142
132000             SELECT SUM(C.FRGT_CHG_AMT)                           TRKCS142
132100                   ,SUM(A.EXPTED_CART_CNT)                        TRKCS142
132200                   ,SUM(A.ACTL_CART_CNT)                          TRKCS142
132300                   ,SUM(C.DMG_CART_CNT)                           TRKCS142
132400              INTO  :PA-TOT-FRGT-CHG                              TRKCS142
132500                   ,:PA-TOT-CART-CNT                              TRKCS142
132600                   ,:PA-TOT-ACTL-CART-CNT                         TRKCS142
132700                   ,:PA-TOT-DMG-CART-CNT                          TRKCS142
132800               FROM TRECEIV A                                     TRKCS142
132900                   ,TVHTRIP B                                     TRKCS142
133000                   ,TSHPTPO C                                     TRKCS142
133100                   ,TSHIPMT D                                     TRKCS142
133200              WHERE D.PRO_NBR        = :DK-PRO-NBR                TRKCS142
133300                AND D.PRO_SCAC_ID    = :DK-OWNER-SCAC-ID          TRKCS142
133400                AND A.VER_STATUS_CDE = 'A'                        TRKCS142
133500                AND A.ORD_NBR      = C.PO_NBR                     TRKCS142
133600                AND A.REC_SEQ_NBR  = C.REC_SEQ_NBR                TRKCS142
133700                AND C.SHIPT_ID     = D.SHIPT_ID                   TRKCS142
133800                AND D.TRIP_ID      = B.TRIP_ID                    TRKCS142
133900         END-EXEC                                                 TRKCS142
134000                                                                  TRKCS142
134100         EVALUATE TRUE                                            TRKCS142
134200             WHEN SQLCODE = +0                                    TRKCS142
134300             WHEN SQLCODE = +100                                  TRKCS142
134400             WHEN SQLCODE = -305                                  TRKCS142
134500             WHEN SQLCODE = -904                                  TRKCS142
134600             WHEN SQLCODE = -913                                  TRKCS142
134700                 CONTINUE                                         TRKCS142
134800             WHEN SQLWARN0 NOT = SPACE                            TRKCS142
134900             WHEN SQLCODE < +0                                    TRKCS142
135000             WHEN SQLCODE > +0                                    TRKCS142
135100                 MOVE '4320-SUM-AMOUNTS'                          TRKCS142
135200                                 TO DP013-PARAGRAPH               TRKCS142
135300                 MOVE 'SUM TO GET TOTAL AMOUNTS      '            TRKCS142
135400                                 TO DP013-MESSAGE-TEXT (1)        TRKCS142
135500                 MOVE SQLCA      TO DP013-SQLCA                   TRKCS142
135600                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      TRKCS142
135700                 MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (2)      TRKCS142
135800                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (3)      TRKCS142
135900                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (4)      TRKCS142
136000                 SET DP013-DB2-ABEND                              TRKCS142
136100                     DP013-XCTL-DISPLAY-RESTART                   TRKCS142
136200                                     TO TRUE                      TRKCS142
136300                 PERFORM DP013-0000-PROCESS-ABEND                 TRKCS142
136400         END-EVALUATE                                             TRKCS142
136500     END-PERFORM.                                                 TRKCS142
136600                                                                  TRKCS142
136700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                       CL**2
136800         SQLCODE  NOT = +0                                           CL**2
136900         MOVE '4320-SUM-AMOUNTS'   TO DP013-PARAGRAPH             TRKCS142
137000         MOVE 'MAX RETRIES EXCEEDED FOR SUM FOR TOTAL AMOUNTS'    TRKCS142
137100                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
137200         MOVE SQLCA                TO DP013-SQLCA                 TRKCS142
137300         MOVE 'TRECEIV'            TO DP013-DB2-TABLE-NAME (1)    TRKCS142
137400         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (2)    TRKCS142
137500         MOVE 'TSHPTPO'            TO DP013-DB2-TABLE-NAME (3)    TRKCS142
137600         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (4)    TRKCS142
137700         SET DP013-DB2-ABEND       TO TRUE                        TRKCS142
137800         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
137900     END-IF.                                                      TRKCS142
138000                                                                  TRKCS142
138100/                                                                 TRKCS142
138200*----------------------------------------------------------------*TRKCS142
138300*    GET THE CLASS NUMBER                                        *TRKCS142
138400*----------------------------------------------------------------*TRKCS142
138500 4330-GET-MAJOR-CLASS.                                            TRKCS142
138600                                                                  TRKCS142
138700     PERFORM                                                      TRKCS142
138800         WITH TEST AFTER                                          TRKCS142
138900         VARYING PV-RETRY-COUNTER                                 TRKCS142
139000         FROM 1 BY 1                                              TRKCS142
139100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS142
139200             OR (SQLCODE = +0)                                    TRKCS142
139300             OR (SQLCODE = +100))                                 TRKCS142
139400                                                                  TRKCS142
139500         EXEC SQL                                                 TRKCS142
139600              SELECT B.CLASS                                      TRKCS141
139700                INTO :SKXREF-CLASS                                TRKCS141
139800                FROM TPURITM A,                                   TRKCS141
139900                     TSKXREF B                                            
140000               WHERE A.PO_NBR         = :SHPTPO-PO-NBR            TRKCS141
140100                 AND A.VER_STATUS_CDE = 'A'                       TRKCS141
140200                 AND A.ITM_NBR        = B.ITM_NBR                         
140300                 AND A.PO_LNE_NBR =                               TRKCS141
140400                      (SELECT MIN(B.PO_LNE_NBR)                   TRKCS141
140500                       FROM   TPURITM B                           TRKCS141
140600                       WHERE  B.PO_NBR = A.PO_NBR                 TRKCS141
140601                         AND  B.VER_STATUS_CDE = 'A')             TRKCS141
140602         END-EXEC                                                 TRKCS142
140700                                                                  TRKCS142
140800         EVALUATE TRUE                                            TRKCS142
140900             WHEN SQLCODE = +0                                    TRKCS142
141000             WHEN SQLCODE = +100                                  TRKCS142
141100             WHEN SQLCODE = -904                                  TRKCS142
141200             WHEN SQLCODE = -913                                  TRKCS142
141300                  CONTINUE                                        TRKCS142
141400                                                                  TRKCS142
141500             WHEN SQLWARN0 NOT = SPACES                           TRKCS142
141600             WHEN SQLCODE < +0                                    TRKCS142
141700             WHEN SQLCODE > +0                                    TRKCS142
141800                  MOVE '4330-GET-MAJOR-CLASS'                     TRKCS142
141900                                  TO DP013-PARAGRAPH              TRKCS142
142000                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           TRKCS142
142100                                  TO DP013-MESSAGE-TEXT (1)       TRKCS142
142200                  MOVE SQLCA      TO DP013-SQLCA                  TRKCS142
142300                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     TRKCS142
142400                  SET DP013-DB2-ABEND                             TRKCS142
142500                      DP013-XCTL-DISPLAY-RESTART                  TRKCS142
142600                                  TO TRUE                         TRKCS142
142700                  PERFORM DP013-0000-PROCESS-ABEND                TRKCS142
142800         END-EVALUATE                                             TRKCS142
142900     END-PERFORM.                                                 TRKCS142
143000                                                                  TRKCS142
143100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                       CL**2
143200         SQLCODE  NOT = +0                                           CL**2
143300         MOVE '4330-GET-MAJOR-CLASS'                              TRKCS142
143400                                  TO DP013-PARAGRAPH              TRKCS142
143500         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            TRKCS142
143600                                  TO DP013-MESSAGE-TEXT (1)       TRKCS142
143700         MOVE SQLCA               TO DP013-SQLCA                  TRKCS142
143800         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     TRKCS142
143900         SET DP013-DB2-ABEND                                      TRKCS142
144000             DP013-XCTL-DISPLAY-RESTART                           TRKCS142
144100                                  TO TRUE                         TRKCS142
144200         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
144300     END-IF.                                                      TRKCS142
144400                                                                  TRKCS142
144500/                                                                 TRKCS142
144600*----------------------------------------------------------------*TRKCS142
144700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *TRKCS142
144800*----------------------------------------------------------------*TRKCS142
144900                                                                  TRKCS142
145000 4400-MOVE-COMMAREA-TO-SCREEN.                                    TRKCS142
145100                                                                  TRKCS142
145200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             TRKCS142
145300         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          TRKCS142
145400         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          TRKCS142
145500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             TRKCS142
145600                 GIVING PV-BLOCK-NUMBER                           TRKCS142
145700                 REMAINDER PV-REMAINDER                           TRKCS142
145800             IF  PV-REMAINDER > ZERO                              TRKCS142
145900                 ADD +1           TO PV-BLOCK-NUMBER              TRKCS142
146000             END-IF                                               TRKCS142
146100             MOVE +1              TO ASC-BLK-SUB                  TRKCS142
146200             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS142
146300             ADD +1               TO ASC-BLK-SUB                  TRKCS142
146400                                     PV-BLOCK-NUMBER              TRKCS142
146500             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS142
146600     END-IF.                                                      TRKCS142
146700                                                                  TRKCS142
146800     MOVE +1                       TO ASC-BLK-SUB.                TRKCS142
146900                                                                  TRKCS142
147000     COMPUTE ASC-ITEM-SUB =                                       TRKCS142
147100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              TRKCS142
147200         + PC-ITEMS-PER-PANEL).                                   TRKCS142
147300                                                                  TRKCS142
147400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        TRKCS142
147500         ADD +1                    TO ASC-BLK-SUB                 TRKCS142
147600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            TRKCS142
147700     END-IF.                                                      TRKCS142
147800                                                                  TRKCS142
147900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           TRKCS142
148000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                TRKCS142
148100                                                                  TRKCS142
148200     PERFORM 4420-FORMAT-LIST-LINES                               TRKCS142
148300         VARYING PV-SUB                                           TRKCS142
148400         FROM PC-ITEMS-PER-PANEL BY -1                            TRKCS142
148500         UNTIL PV-SUB < +1.                                       TRKCS142
148600                                                                  TRKCS142
148700     COMPUTE ASC-ITEMS-DISPLAYED =                                TRKCS142
148800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          TRKCS142
148900                                                                  TRKCS142
149000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    TRKCS142
149100                                      ASTRTITO.                   TRKCS142
149200                                                                  TRKCS142
149300     MOVE ASC-KEY-PRO-NBR          TO MR-PRO-NBR.                 TRKCS142
149400     MOVE ASC-KEY-OWNER-SCAC-ID    TO MR-OWNER-SCAC-ID.           TRKCS142
149500     MOVE ASC-VEH-NBR              TO MR-VEH-NBR.                 TRKCS142
149600                                                                  TRKCS142
149700     MOVE ASC-FRGT-CHG-N           TO MR-FRGT-CHG.                TRKCS142
149800     MOVE ASC-TERMS                TO MR-TERMS.                   TRKCS142
149900     MOVE ASC-FRGT-WGHT            TO MR-FRGT-WGHT.               TRKCS142
150000                                                                  TRKCS142
150100     MOVE ASC-TOT-CTN              TO MR-TOT-CTN-CNT.             TRKCS142
150200     MOVE ASC-TOT-DMG              TO MR-TOT-DMG-CNT.             TRKCS142
150300     MOVE ASC-TOT-ADJ              TO MR-TOT-ADJ-CNT.             TRKCS142
150400     MOVE ASC-TOT-CHGS-N           TO MR-TOT-CHGS.                TRKCS142
150500                                                                  TRKCS142
150600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    TRKCS142
150700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    TRKCS142
150800                                                                  TRKCS142
150900     IF  DP020-MSG-NUMBER-X = SPACE                               TRKCS142
151000         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  TRKCS142
151100*            --- MORE ITEMS TO DISPLAY ----                       TRKCS142
151200             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            TRKCS142
151300             SET DP020-MSG-INFORMATIONAL                          TRKCS142
151400                                   TO TRUE                        TRKCS142
151500         END-IF                                                   TRKCS142
151600     END-IF.                                                      TRKCS142
151700                                                                  TRKCS142
151800/                                                                 TRKCS142
151900*----------------------------------------------------------------*TRKCS142
152000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *TRKCS142
152100*----------------------------------------------------------------*TRKCS142
152200                                                                  TRKCS142
152300 4410-READ-TEMP-STORAGE.                                          TRKCS142
152400                                                                  TRKCS142
152500     EXEC CICS                                                    TRKCS142
152600         READQ TS                                                 TRKCS142
152700             QUEUE (ASC-DTL-QUEUE-NAME)                           TRKCS142
152800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               TRKCS142
152900             ITEM  (PV-BLOCK-NUMBER)                              TRKCS142
153000             RESP  (PV-CICS-RESP)                                 TRKCS142
153100     END-EXEC.                                                    TRKCS142
153200                                                                  TRKCS142
153300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       TRKCS142
153400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     TRKCS142
153500         CONTINUE                                                 TRKCS142
153600     ELSE                                                         TRKCS142
153700         SET DP013-CICS-ABEND      TO TRUE                        TRKCS142
153800         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS142
153900         MOVE '4410-READ-TEMP-STORAGE'                            TRKCS142
154000                                   TO DP013-PARAGRAPH             TRKCS142
154100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      TRKCS142
154200                                   TO DP013-MESSAGE-TEXT(1)       TRKCS142
154300         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
154400     END-IF.                                                      TRKCS142
154500                                                                  TRKCS142
154600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         TRKCS142
154700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               TRKCS142
154800     END-IF.                                                      TRKCS142
154900                                                                  TRKCS142
155000/                                                                 TRKCS142
155100*----------------------------------------------------------------*TRKCS142
155200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *TRKCS142
155300*----------------------------------------------------------------*TRKCS142
155400                                                                  TRKCS142
155500 4420-FORMAT-LIST-LINES.                                          TRKCS142
155600                                                                  TRKCS142
155700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      TRKCS142
155800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                TRKCS142
155900         MOVE SPACES               TO MR-PRO-NBR                  TRKCS142
156000                                      MR-OWNER-SCAC-ID            TRKCS142
156100                                      MR-VEH-NBR                  TRKCS142
156200                                      MR-FRGT-CHG-X               TRKCS142
156300                                      MR-TERMS                    TRKCS142
156400                                      MR-FRGT-WGHT-X              TRKCS142
156500                                      MR-PO-NBR     (PV-SUB)      TRKCS142
156510                                      MR-DC-NBR     (PV-SUB)              
156600                                      MR-REC-SEQ-NBR (PV-SUB)     TRKCS142
156700                                      MR-OLD-RCVR-NBR (PV-SUB)    TRKCS142
156800                                      MR-STATUS-CDE  (PV-SUB)     TRKCS142
156900                                      MR-DEPT       (PV-SUB)      TRKCS142
156910                                      MR-CLASS      (PV-SUB)      TRKCS142
157000                                      MR-CTN-CNT-X  (PV-SUB)      TRKCS142
157100                                      MR-ADJ-CNT-X  (PV-SUB)      TRKCS142
157200                                      MR-DMG-CNT-X  (PV-SUB)      TRKCS142
157300                                      MR-CHGS-X     (PV-SUB)      TRKCS142
157400     ELSE                                                         TRKCS142
157500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           TRKCS142
157600             MOVE ASC-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)           TRKCS142
157700                                   TO MR-PO-NBR (PV-SUB)          TRKCS142
157710             MOVE ASC-DC-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                   
157720                                   TO MR-DC-NBR (PV-SUB)                  
157800             MOVE ASC-REC-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB)      TRKCS142
157900                                   TO MR-REC-SEQ-NBR (PV-SUB)     TRKCS142
158000             MOVE ASC-OLD-RCVR     (ASC-BLK-SUB ASC-ITEM-SUB)     TRKCS142
158100                                   TO MR-OLD-RCVR-NBR (PV-SUB)    TRKCS142
158200             MOVE ASC-STATUS-CDE  (ASC-BLK-SUB ASC-ITEM-SUB)      TRKCS142
158300                                   TO MR-STATUS-CDE  (PV-SUB)     TRKCS142
158400             IF MR-STATUS-CDE (PV-SUB) NOT = 'VE'                 TRKCS142
158500                 MOVE DP015-YELLOW TO MR-STATUS-CDEC (PV-SUB)     TRKCS142
158600             END-IF                                               TRKCS142
158700             MOVE ASC-DEPT    (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS142
158800                                   TO MR-DEPT (PV-SUB)            TRKCS142
158801             MOVE ASC-CLASS   (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS142
158802                                   TO MR-CLASS (PV-SUB)           TRKCS142
158900             MOVE ASC-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS142
159000                                   TO MR-CTN-CNT (PV-SUB)         TRKCS142
159100             MOVE ASC-ADJ-CNT (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS142
159200                                   TO MR-ADJ-CNT (PV-SUB)         TRKCS142
159300             MOVE ASC-DMG-CNT (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS142
159400                                   TO MR-DMG-CNT (PV-SUB)         TRKCS142
159500             MOVE ASC-CHGS (ASC-BLK-SUB ASC-ITEM-SUB)             TRKCS142
159600                                   TO MR-CHARGES (PV-SUB)         TRKCS142
159700         END-IF                                                   TRKCS142
159800     END-IF.                                                      TRKCS142
159900                                                                  TRKCS142
160000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               TRKCS142
160100                                                                  TRKCS142
160200     IF  ASC-ITEM-SUB < + 1                                       TRKCS142
160300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                TRKCS142
160400         MOVE +1                   TO ASC-BLK-SUB                 TRKCS142
160500     END-IF.                                                      TRKCS142
160600                                                                  TRKCS142
160700/                                                                 TRKCS142
160800*----------------------------------------------------------------*TRKCS142
160900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *TRKCS142
161000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *TRKCS142
161100*----------------------------------------------------------------*TRKCS142
161200                                                                  TRKCS142
161300 5100-WRITE-TEMP-STORAGE.                                         TRKCS142
161400                                                                  TRKCS142
161500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     TRKCS142
161600                                   TO PV-LIST-ITEM-NUMBER.        TRKCS142
161700                                                                  TRKCS142
161800     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           TRKCS142
161900         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           TRKCS142
162000                                                                  TRKCS142
162100     EXEC CICS                                                    TRKCS142
162200         WRITEQ TS                                                TRKCS142
162300             QUEUE (ASC-DTL-QUEUE-NAME)                           TRKCS142
162400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               TRKCS142
162500             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     TRKCS142
162600             RESP  (PV-CICS-RESP)                                 TRKCS142
162700     END-EXEC.                                                    TRKCS142
162800                                                                  TRKCS142
162900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      TRKCS142
163000         SET DP013-CICS-ABEND                                     TRKCS142
163100             DP013-NO-ROLLBACK     TO TRUE                        TRKCS142
163200         MOVE '5100-WRITE-TEMP-STORAGE'                           TRKCS142
163300                                   TO DP013-PARAGRAPH             TRKCS142
163400         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       TRKCS142
163500                                   TO DP013-MESSAGE-TEXT(1)       TRKCS142
163600         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
163700     END-IF.                                                      TRKCS142
163800                                                                  TRKCS142
163900     ADD +1                        TO ASC-HIGHEST-BLOCK-WRITTEN.  TRKCS142
164000                                                                  TRKCS142
164100/                                                                 TRKCS142
164200*----------------------------------------------------------------*TRKCS142
164300* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *TRKCS142
164400*----------------------------------------------------------------*TRKCS142
164500                                                                  TRKCS142
164600 9100-READ-SEL-QUEUE.                                             TRKCS142
164700     EXEC CICS                                                    TRKCS142
164800         READQ TS                                                 TRKCS142
164900             QUEUE (ASC-SEL-QUEUE-NAME)                           TRKCS142
165000             INTO  (TR015-TS-SEL-REC)                             TRKCS142
165100             ITEM  (ASC-SEL-ITEM)                                 TRKCS142
165200             RESP  (PV-CICS-RESP)                                 TRKCS142
165300     END-EXEC.                                                    TRKCS142
165400                                                                  TRKCS142
165500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       TRKCS142
165600         CONTINUE                                                 TRKCS142
165700     ELSE                                                         TRKCS142
165800         SET DP013-LOGIC-ABEND                                    TRKCS142
165900             DP013-NO-ROLLBACK     TO TRUE                        TRKCS142
166000         MOVE '9100-READ-SEL-QUEUE'                               TRKCS142
166100                                   TO DP013-PARAGRAPH             TRKCS142
166200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   TRKCS142
166300                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
166400         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
166500     END-IF.                                                      TRKCS142
166600                                                                  TRKCS142
166700/                                                                 TRKCS142
166800*----------------------------------------------------------------*TRKCS142
166900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *TRKCS142
167000*----------------------------------------------------------------*TRKCS142
167100 9200-REWRITE-SEL-QUEUE.                                          TRKCS142
167200     EXEC CICS                                                    TRKCS142
167300          WRITEQ TS                                               TRKCS142
167400              QUEUE  (ASC-SEL-QUEUE-NAME)                         TRKCS142
167500              FROM   (TR015-TS-SEL-REC)                           TRKCS142
167600              ITEM   (ASC-SEL-ITEM)                               TRKCS142
167700              RESP   (PV-CICS-RESP)                               TRKCS142
167800              REWRITE                                             TRKCS142
167900     END-EXEC.                                                    TRKCS142
168000                                                                  TRKCS142
168100     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   TRKCS142
168200         SET DP013-CICS-ABEND                                     TRKCS142
168300             DP013-NO-ROLLBACK     TO TRUE                        TRKCS142
168400         MOVE '9200-REWRITE-SEL-QUEUE'                            TRKCS142
168500                                   TO DP013-PARAGRAPH             TRKCS142
168600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   TRKCS142
168700                                   TO DP013-MESSAGE-TEXT (1)      TRKCS142
168800         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS142
168900     END-IF.                                                      TRKCS142
169000                                                                  TRKCS142
169100/                                                                 TRKCS142
169200*----------------------------------------------------------------*TRKCS142
169300*    ABEND PROCESSOR MODULE                                      *TRKCS142
169400*----------------------------------------------------------------*TRKCS142
169500                                                                  TRKCS142
169600     COPY DPPD013.                                                TRKCS142
