000100******************************************************************00010000
000200******************************************************************00020000
000300**         I D E N T I F I C A T I O N   D I V I S I O N        **00030000
000400******************************************************************00040000
000500******************************************************************00050000
000600 IDENTIFICATION DIVISION.                                         00060000
000700 PROGRAM-ID.    SUKUT135.                                         00070000
000800 AUTHOR.        DAN HINTZ.                                        00080000
000900 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00090000
001000 DATE-WRITTEN.  OCTOBER, 2013.                                    00100000
001100 DATE-COMPILED.                                                   00110000
001200                                                                  00120000
001300******************************************************************00130000
001400*  THIS PROGRAM WILL BE USED TO RESEND DIRECTIVES FROM AN INPUT  *00141005
001500*  FILE OF DIRECTIVES THAT WAS CREATED IN SUKUT133.              *00150005
001600*                                                                *00160000
002000*  FOR EACH RECORD FROM THE INPUT FILE, THE DIRECTIVE GENERATOR  *00200005
002100*  COMMUNICATION AREA WILL BE POPULATED AND A CALL TO THE        *00210005
002200*  DIRECTIVE GENERATOR (SUKUT129) WILL BE MADE TO REQUEST THE    *00220005
002300*  ISSUANCE OF A DIRECTIVE.                                      *00230005
001600*                                                                *00240005
001400*  THIS PROGRAM ORIGINALLY WAS A COPY OF SUKUT134.  IT HAS BEEN  *00241005
001500*  CHANGED TO READ A FLAT FILE OF DIRECTIVE MESSAGES THAT WAS    *00242005
001500*  CREATED IN SUKUT133.                                          *00243005
002500******************************************************************00250000
002600 EJECT                                                            00260000
002700******************************************************************00270000
002800******************************************************************00280000
002900**            E N V I R O N M E N T   D I V I S I O N           **00290000
003000******************************************************************00300000
003100******************************************************************00310000
003200 ENVIRONMENT DIVISION.                                            00320000
003300                                                                  00330000
003400 CONFIGURATION SECTION.                                           00340000
003500                                                                  00350000
003600 SOURCE-COMPUTER.  IBM-3090.                                      00360000
003700 OBJECT-COMPUTER.  IBM-3090.                                      00370000
003800                                                                  00380000
003900 INPUT-OUTPUT SECTION.                                            00390000
004000                                                                  00400000
004100 FILE-CONTROL.                                                    00410000
004200                                                                  00420000
004300     SELECT SURD104-DIRECTIVE-FILE                                00461005
004400         ASSIGN TO INP01.                                         00462005
004600                                                                  00463005
004700 EJECT                                                            00470000
004800******************************************************************00480000
004900******************************************************************00490000
005000**                   D A T A   D I V I S I O N                  **00500000
005100******************************************************************00510000
005200******************************************************************00520000
005300 DATA DIVISION.                                                   00530000
005400                                                                  00540000
005500 FILE SECTION.                                                    00550000
005600                                                                  00560000
005700 FD  SURD104-DIRECTIVE-FILE                                       00561005
005800     RECORDING MODE IS F                                          00562005
005900     LABEL RECORDS ARE STANDARD                                   00563005
006000     BLOCK CONTAINS 0 RECORDS.                                    00564005
006100                                                                  00565005
006200 01  SURD104-DIRECTIVE-RECORD       PIC X(200).                   00566005
006300                                                                  00630000
006300                                                                  00631005
006400*----------------------------------------------------------------*00640000
006500*                         WORKING STORAGE                        *00650000
006600*----------------------------------------------------------------*00660000
006700 WORKING-STORAGE SECTION.                                         00670000
006800                                                                  00680000
007400 01  WS-ABEND-FIELDS.                                             00740000
007500     05  WS-AC-ABEND-CODE          PIC S9(04) VALUE ZEROES.       00750000
007600     05  WS-ABEND-CODE             PIC S9(04) VALUE +0            00760000
007700                                              COMP SYNC.          00770000
007800 01  WS-PROGRAM-ACCUMULATORS.                                     00780000
007900     05  WS-DIRECTIVE-RECS-READ    PIC 9(13)  VALUE 0.            00790005
008200     05  WS-DG-CALLS               PIC 9(13)  VALUE 0.            00820000
008300                                                                  00830000
008400 01  WS-PROGRAM-SWITCHES.                                         00840000
008500     05  WS-END-OF-SURD104-FILE    PIC X(01)  VALUE 'N'.          00850005
008600         88  SURD104-FILE-AT-END              VALUE 'Y'.          00860005
008700         88  SURD104-FILE-NOT-AT-END          VALUE 'N'.          00870005
008800                                                                  00880000
008900 01  WS-PROGRAM-CONSTANTS.                                        00890000
009000     05  WS-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'SUKUT135'.   00900000
009000     05  WS-CALLING-PROGRAM-NAME   PIC X(08)  VALUE 'RESEND  '.   00901009
009100                                                                  00910000
009200 01  WS-CONSTANTS.                                                00920000
009300     05  WS-LIT-ADD                PIC X(06)  VALUE 'ADD   '.     00930000
009400     05  WS-LIT-DELETE             PIC X(06)  VALUE 'DELETE'.     00940000
009500     05  WS-LIT-MODIFY             PIC X(06)  VALUE 'MODIFY'.     00950000
009600                                                                  00960000
009700 01  WS-MISCELLANEOUS.                                            00970000
009800     05  WS-TIMESTAMP              PIC X(26)  VALUE SPACES.       00980000
009900     05  WS-BEGIN-TIMESTAMP        PIC X(26)  VALUE SPACES.       00990000
010000     05  WS-END-TIMESTAMP          PIC X(26)  VALUE SPACES.       01000000
010100     05  WS-PARAGRAPH-NAME         PIC X(31)  VALUE SPACES.       01010000
010200*                                                                 01020005
010800*----------------------------------------------------------------*01080000
010900*  DIRECTIVE GENERATOR COMMUNICATION AREA                        *01090000
011000*----------------------------------------------------------------*01100000
011100     COPY SUWS090.                                                01110000
011200 EJECT                                                            01120000
010800*----------------------------------------------------------------*01130005
010900*  INPUT FILE FOR DIRECTIVES TO RESEND                           *01140005
011000*----------------------------------------------------------------*01150005
011100     COPY SURD104.                                                01160005
011200 EJECT                                                            01170005
001316******************************************************************01180011
001317*  DB2 DECLARATION - DB2 DUMMY SYSTEM TABLE (SYSIBM.SYSDUMMY1)    01190011
001318******************************************************************01200011
001319     EXEC SQL                                                     01210011
001320         INCLUDE SYSDUMMY                                         01220011
001321     END-EXEC.                                                    01230011
001322                                                                  01240011
011300*----------------------------------------------------------------*01250011
011400*  DB2 FORMATTED MESSAGE AREA                                    *01260011
011500*----------------------------------------------------------------*01270011
011600     COPY DPWS004.                                                01280011
011700 EJECT                                                            01290011
011800*----------------------------------------------------------------*01300011
011900*  COMMUNICATIONS AREA FOR DB2                                   *01310011
012000*----------------------------------------------------------------*01320011
012100     EXEC SQL INCLUDE SQLCA END-EXEC.                             01330011
012200 EJECT                                                            01340011
021700******************************************************************02170000
021900**             P R O C E D U R E   D I V I S I O N              **02190000
022000******************************************************************02200000
022100******************************************************************02210000
022200 PROCEDURE DIVISION.                                              02220000
022300                                                                  02230000
022400*----------------------------------------------------------------*02240000
022500*  MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.       *02250000
022600*----------------------------------------------------------------*02260000
022700 0000-MAINLINE.                                                   02270000
022800                                                                  02280000
022900**** PERFORM PROGRAM INITIALIZATION.                              02290000
023000                                                                  02300000
023100     PERFORM 1000-INITIALIZE.                                     02310005
023200                                                                  02320000
031300**** READ ANOTHER RECORD FROM THE DIRECTIVE RESEND FILE           02330006
031500     PERFORM 7000-READ-INPUT-FILE.                                02340006
023800                                                                  02350006
023600     PERFORM 2000-RESEND-DIRECTIVES                               02360005
023700       UNTIL SURD104-FILE-AT-END.                                 02370005
023800                                                                  02380000
023900**** PERFORM PROGRAM TERMINATION.                                 02390000
024000                                                                  02400000
024100     PERFORM 3000-TERMINATE.                                      02410005
024200                                                                  02420000
024300 0000-EXIT.                                                       02430000
024400     STOP RUN.                                                    02440000
024500 EJECT                                                            02450000
024600*----------------------------------------------------------------*02460000
024700*  PROGRAM INITIALIZATION                                        *02470000
024800*----------------------------------------------------------------*02480000
024900 1000-INITIALIZE.                                                 02490000
025000                                                                  02500000
025100**** NOTIFY OF PROGRAM STARTUP.                                   02510000
025200                                                                  02520000
021500     EXEC SQL                                                     02521011
021600         SELECT CURRENT TIMESTAMP                                 02522011
021700           INTO :WS-BEGIN-TIMESTAMP                               02523011
021800           FROM SYSIBM.SYSDUMMY1                                  02524011
021900     END-EXEC.                                                    02525011
025200                                                                  02526011
025300     DISPLAY '**************************************************' 02530012
025300             '*****'.                                             02531012
025400     DISPLAY '* PROGRAM '                                         02540000
025500             WS-CURRENT-PROGRAM-NAME                              02550000
025600                               ' BEGINS '                         02560000
025700             WS-BEGIN-TIMESTAMP                                   02570011
025800                                                            '  *'.02580000
025900     DISPLAY '* COMPILED: '                                       02590000
026000             FUNCTION WHEN-COMPILED                               02600000
026100                                         '                     *'.02610013
026200     DISPLAY '**************************************************' 02620012
026200             '*****'.                                             02621012
026300     DISPLAY ' '.                                                 02630000
026400                                                                  02640000
026800     OPEN INPUT SURD104-DIRECTIVE-FILE.                           02680005
026900                                                                  02690000
028100 1000-EXIT.                                                       02810000
028200     EXIT.                                                        02820000
028300 EJECT                                                            02830000
028400*----------------------------------------------------------------*02840000
028500*  PROCESS EACH RECORD FROM THE DIRECTIVE MESSAGE FILE           *02850006
028600*----------------------------------------------------------------*02860000
028700 2000-RESEND-DIRECTIVES.                                          02870000
028800                                                                  02880000
030700**** FOR EACH ROW ON THE CURSOR, CALL THE DIRECTIVE GENERATOR     03070000
030800**** TO ISSUE A DIRECTIVE.                                        03080000
030900                                                                  03090000
031000     PERFORM 2100-FORMAT-DG-COMMAREA.                             03100006
031200                                                                  03120000
031000     PERFORM 2200-REQUEST-DIRECTIVE.                              03121006
031200                                                                  03122006
031300**** READ ANOTHER RECORD FROM THE DIRECTIVE RESEND FILE           03130005
031500     PERFORM 7000-READ-INPUT-FILE.                                03150005
031600                                                                  03160000
031900 EJECT                                                            03190000
056800*----------------------------------------------------------------*05680000
056900*  FORMAT THE DIRECTIVE GENERATOR COMMUNICATION AREA             *05690000
057000*----------------------------------------------------------------*05700000
057100 2100-FORMAT-DG-COMMAREA.                                         05710006
057200                                                                  05720000
057300**** INITIALIZE THE DIRECTIVE GENERATOR COMMUNICATION AREA        05730000
057400                                                                  05740000
057500     INITIALIZE SU090-DG-REQUEST-COMMAREA.                        05750000
057600                                                                  05760000
057700**** SET UP SOME CONSTANT AREAS                                   05770000
057800                                                                  05780000
057900     SET SU090-BATCH            TO TRUE.                          05790000
058000     SET SU090-CARTON-DIRECTIVE TO TRUE.                          05800000
058100                                                                  05810000
058200**** DETERMINE THE KIND OF DIRECTIVE TO REQUEST                   05820000
058300                                                                  05830000
058400     EVALUATE SU104-CNVYR-PRC-ACTN-NM                             05840007
058500        WHEN WS-LIT-ADD                                           05850000
058600           SET SU090-ADD-ACTION    TO TRUE                        05860000
058700        WHEN WS-LIT-DELETE                                        05870000
058800           SET SU090-DELETE-ACTION TO TRUE                        05880000
058900        WHEN WS-LIT-MODIFY                                        05890000
059000           SET SU090-MODIFY-ACTION TO TRUE                        05900000
059100     END-EVALUATE.                                                05910000
059200                                                                  05920000
059300**** DETERMINE THE KIND OF BARCODE THAT IS BEING SENT             05930000
059400                                                                  05940000
059500     IF SU104-SML-BRCDE-NBR = 0                                   05950007
059600        SET SU090-P2L-BARCODE TO TRUE                             05960000
059700     ELSE                                                         05970000
059800        SET SU090-SML-BARCODE TO TRUE                             05980000
059900     END-IF.                                                      05990000
060000                                                                  06000000
060100**** SETUP THE REST OF THE DIRECTIVE GENEATOR COMMUNICATION AREA  06010000
060200                                                                  06020000
060300     MOVE WS-CALLING-PROGRAM-NAME  TO SU090-CALLING-PGM.          06030004
060400     MOVE SU104-P2L-BRCDE-NBR      TO SU090-P2L-BRCDE-NBR.        06040008
060500     MOVE SU104-OPER-UNT-ID        TO SU090-OPER-UNT-ID.          06050008
060600     MOVE SU104-DIRV-RSN-CDE       TO SU090-DIRV-RSN-CDE.         06060008
060700     MOVE SU104-AUD-CNTL-NBR       TO SU090-AUD-CNTL-NBR.         06070008
060800     MOVE SU104-SML-BRCDE-NBR      TO SU090-SML-BRCDE-NBR.        06080008
060900     MOVE SU104-AUD-STAT-CDE       TO SU090-AUD-STAT-CDE.         06090008
061000     MOVE SU104-PO-NBR             TO SU090-PO-NBR.               06100008
061100     MOVE SU104-RCVR-SEQ-NBR       TO SU090-RCVR-SEQ-NBR.         06110008
061200     MOVE SU104-PO-LNE-NBR         TO SU090-PO-LNE-NBR.           06120008
061300     MOVE SU104-PO-PREPK-ID        TO SU090-PO-PREPK-ID.          06130008
061400     MOVE SU104-STR-NBR            TO SU090-STR-NBR.              06140008
061500     MOVE SU104-CASI-CDE           TO SU090-CASI-CDE.             06150008
061600     MOVE SU104-CART-STAT-CDE      TO SU090-CART-STAT-CDE.        06160008
061700     MOVE SU104-AUD-FAIL-RSN       TO SU090-AUD-FAIL-RSN.         06170008
061800     MOVE SU104-STR-ZN             TO SU090-STR-ZN.               06180008
061900     MOVE SU104-SEASET-YR          TO SU090-SEASET-YR.            06190008
062000     MOVE SU104-SEASET-CDE         TO SU090-SEASET-CDE.           06200008
062100     MOVE SU104-ASSOC-ID           TO SU090-ASSOC-ID.             06210008
062200                                                                  06220000
062600*----------------------------------------------------------------*06260000
062700*  CALL THE DIRECTIVE GENERATOR TO REQUEST THE ISSUANCE OF A     *06270000
062800*  DIRECTIVE.                                                    *06280000
062900*----------------------------------------------------------------*06290000
063000 2200-REQUEST-DIRECTIVE.                                          06300006
063001                                                                  06300100
063002     CALL SU090-DIRV-GEN-PGM USING SU090-DG-REQUEST-COMMAREA.     06300200
063003                                                                  06300300
063004     EVALUATE TRUE                                                06300400
063005        WHEN SU090-SUCCESS                                        06300500
063006           ADD 1 TO WS-DG-CALLS                                   06300600
063007        WHEN OTHER                                                06300700
063008            DISPLAY '*!*!*!*!*! ABEND 10 !*!*!*!*!*!*'            06300800
063009            DISPLAY '*! DIRECTIVE GENERATOR FAILED.!*'            06300900
063010            DISPLAY '*!*!*!*!*! ABEND 10 !*!*!*!*!*!*'            06301000
063020            PERFORM 2300-DG-ERROR-DISPLAY                         06302006
063030            MOVE '2300-REQUEST-DIRECTIVE' TO WS-PARAGRAPH-NAME    06303006
063031            PERFORM 9999-ABEND                                    06303105
063032     END-EVALUATE.                                                06303200
063033                                                                  06303300
063037*----------------------------------------------------------------*06303700
063038*  DISPLAY THE NECESSARY ERROR FIELDS WHEN THE DIRECTIVE GENER-  *06303800
063039*  ATOR DOES NOT SUCCESSFULLY ISSUE A DIRECTIVE.                 *06303900
063040*----------------------------------------------------------------*06304000
063050 2300-DG-ERROR-DISPLAY.                                           06305006
063060                                                                  06306000
063070     EVALUATE TRUE                                                06307000
063080        WHEN SU090-PARAMETER-ERROR                                06308000
063090           DISPLAY 'DG FAILED WITH PARAMETER ERROR'               06309000
063100        WHEN SU090-DB2-ERROR                                      06310000
063200           DISPLAY 'DG FAILED WITH DB2 ERROR'                     06320000
063300        WHEN SU090-MQ-ERROR                                       06330000
063400           DISPLAY 'DG FAILED WITH MQ ERROR'                      06340000
063500        WHEN SU090-OTHER-ERROR                                    06350000
063600           DISPLAY 'DG FAILED WITH UNKNOWN ERROR'                 06360000
063700     END-EVALUATE.                                                06370000
063800                                                                  06380000
063900     DISPLAY ' '.                                                 06390000
064000     DISPLAY 'SU090-ERR-PROGRAM   = ' SU090-ERR-PROGRAM.          06400000
064100     DISPLAY 'SU090-ERR-PARAGRAPH = ' SU090-ERR-PARAGRAPH.        06410000
064200                                                                  06420000
064300     DISPLAY ' '.                                                 06430000
064400     DISPLAY 'DG COMMUNICATION AREA FIELDS'.                      06440000
064401     DISPLAY '----------------------------'.                      06440100
064402     DISPLAY 'SU090-CALLING-PGM       = ' SU090-CALLING-PGM.      06440200
064403     DISPLAY 'SU090-BATCH-ONLINE-IND  = ' SU090-BATCH-ONLINE-IND. 06440300
064404     DISPLAY 'SU090-OPER-UNT-ID       = ' SU090-OPER-UNT-ID.      06440400
064405     DISPLAY 'SU090-ACTN-CDE          = ' SU090-ACTN-CDE.         06440500
064406     DISPLAY 'SU090-DIRECTIVE-LVL-CDE = ' SU090-DIRECTIVE-LVL-CDE.06440600
064407     DISPLAY 'SU090-DIRV-RSN-CDE      = ' SU090-DIRV-RSN-CDE.     06440700
064408     DISPLAY 'SU090-BRCDE-TYP-CDE     = ' SU090-BRCDE-TYP-CDE.    06440800
064409     DISPLAY 'SU090-SML-BRCDE-NBR     = ' SU090-SML-BRCDE-NBR.    06440900
064410     DISPLAY 'SU090-P2L-BRCDE-NBR     = ' SU090-P2L-BRCDE-NBR.    06441000
064411     DISPLAY 'SU090-PO-NBR            = ' SU090-PO-NBR.           06441100
064412     DISPLAY 'SU090-PO-LNE-NBR        = ' SU090-PO-LNE-NBR.       06441200
064413     DISPLAY 'SU090-PO-PREPK-ID       = ' SU090-PO-PREPK-ID.      06441300
064414     DISPLAY 'SU090-RCVR-SEQ-NBR      = ' SU090-RCVR-SEQ-NBR.     06441400
064415     DISPLAY 'SU090-CASI-CDE          = ' SU090-CASI-CDE.         06441500
064416     DISPLAY 'SU090-CART-STAT-CDE     = ' SU090-CART-STAT-CDE.    06441600
064417     DISPLAY 'SU090-AUD-CNTL-NBR      = ' SU090-AUD-CNTL-NBR.     06441700
064418     DISPLAY 'SU090-AUD-STAT-CDE      = ' SU090-AUD-STAT-CDE.     06441800
064419     DISPLAY 'SU090-AUD-FAIL-RSN      = ' SU090-AUD-FAIL-RSN.     06441900
064420     DISPLAY 'SU090-STR-ZN            = ' SU090-STR-ZN.           06442000
064421     DISPLAY 'SU090-SEASET-YR         = ' SU090-SEASET-YR.        06442100
064422     DISPLAY 'SU090-SEASET-CDE        = ' SU090-SEASET-CDE.       06442200
064423     DISPLAY 'SU090-STR-NBR           = ' SU090-STR-NBR.          06442300
064424     DISPLAY 'SU090-ASSOC-ID          = ' SU090-ASSOC-ID.         06442400
064425                                                                  06442500
064426     EVALUATE TRUE                                                06442600
064427        WHEN SU090-DB2-ERROR                                      06442700
064428           DISPLAY 'SU090-SQLCODE = ' SU090-SQLCODE               06442800
064429           DISPLAY 'SU090-SQLCA   = ' SU090-SQLCA                 06442900
064430        WHEN SU090-MQ-ERROR                                       06443000
064440           DISPLAY 'SU090-MQ-COND-CODE = ' SU090-MQ-COND-CODE     06444000
064450           DISPLAY 'SU090-MQ-REAS-CODE = ' SU090-MQ-REAS-CODE     06445000
064460           DISPLAY 'SU090-MQ-REAS-TXT  = ' SU090-MQ-REAS-TXT      06446000
064470     END-EVALUATE.                                                06447000
064480                                                                  06448000
068100*----------------------------------------------------------------*06810000
068200*  PROGRAM TERMINATION                                           *06820000
068300*----------------------------------------------------------------*06830000
068400 3000-TERMINATE.                                                  06840000
068500                                                                  06850000
068600**** CLOSE THE CONTROL FILE                                       06860000
068700                                                                  06870000
068800     CLOSE SURD104-DIRECTIVE-FILE.                                06880010
068900                                                                  06890000
070100**** DISPLAY RUN STATS                                            07010000
070200                                                                  07020000
070300     PERFORM 3100-DISPLAY-RUN-STATS THRU 3100-EXIT.               07030000
070400                                                                  07040000
070500**** NOTIFY OF PROGRAM SHUTDOWN.                                  07050000
070600                                                                  07060000
021500     EXEC SQL                                                     07061011
021600         SELECT CURRENT TIMESTAMP                                 07062011
021700           INTO :WS-END-TIMESTAMP                                 07063011
021800           FROM SYSIBM.SYSDUMMY1                                  07064011
021900     END-EXEC.                                                    07065011
025200                                                                  07066011
070700     DISPLAY ' '.                                                 07070000
070800     DISPLAY '**************************************************' 07080012
025300             '*****'.                                             07081012
070900     DISPLAY '* PROGRAM '                                         07090000
071000             WS-CURRENT-PROGRAM-NAME                              07100000
071100                               ' ENDS '                           07110000
071200             WS-END-TIMESTAMP                                     07120011
071300                                                          '    *'.07130000
071400     DISPLAY '**************************************************' 07140012
025300             '*****'.                                             07141012
071500                                                                  07150000
071600 3000-EXIT.                                                       07160000
071700     EXIT.                                                        07170000
071800 EJECT                                                            07180000
071900******************************************************************07190000
072000* DISPLAY THE RUNSTATS                                           *07200000
072100******************************************************************07210000
072200 3100-DISPLAY-RUN-STATS.                                          07220000
072300                                                                  07230000
072400     DISPLAY ' '.                                                 07240000
072500     DISPLAY 'DIRECTIVE MESSAGE RECS READ.: '                     07250008
                    WS-DIRECTIVE-RECS-READ.                             07251008
072600     DISPLAY 'DG CALLS (DIRECTIVES RESENT): ' WS-DG-CALLS.        07260002
072700                                                                  07270000
072800 3100-EXIT.                                                       07280000
072900     EXIT.                                                        07290000
073000 EJECT                                                            07300000
032000*----------------------------------------------------------------*07301005
032100*  READ THE INPUT FILE OF DIRECTIVES TO RESEND                   *07302005
032200*----------------------------------------------------------------*07303005
032300 7000-READ-INPUT-FILE.                                            07304005
032400                                                                  07305005
032500     READ SURD104-DIRECTIVE-FILE                                  07306005
032500         INTO SU104-DIRECTIVE-RESEND-RECORD                       07307005
032500           AT END                                                 07308005
032500               SET SURD104-FILE-AT-END TO TRUE.                   07309005
032600                                                                  07309105
032700     IF  SURD104-FILE-NOT-AT-END                                  07309205
032700         ADD 1 TO WS-DIRECTIVE-RECS-READ                          07309305
032700     END-IF.                                                      07309405
035000 EJECT                                                            07309505
075300******************************************************************07530000
075400* 9999-ABEND                                                      07540000
075500*     ABEND PROGRAM WHEN AN ERROR OCCURS.                         07550000
075600******************************************************************07560000
075700 9999-ABEND.                                                      07570000
075800                                                                  07580000
068800     CLOSE SURD104-DIRECTIVE-FILE.                                07581010
075800                                                                  07582010
075900     PERFORM 3100-DISPLAY-RUN-STATS THRU 3100-EXIT.               07590000
076000                                                                  07600000
076100     DISPLAY '** ABEND           **'.                             07610000
076200     DISPLAY '** PROGRAM         ** = ' WS-CURRENT-PROGRAM-NAME.  07620000
076300     DISPLAY '** PARAGRAPH       ** = ' WS-PARAGRAPH-NAME.        07630000
076400                                                                  07640000
076500     CALL 'ILBOABN0' USING WS-AC-ABEND-CODE.                      07650000
076600                                                                  07660000
076700 9999-EXIT.                                                       07670000
076800     EXIT.                                                        07680000
