       IDENTIFICATION DIVISION.                                         00010001
       PROGRAM-ID.      PXKRP025.                                       00020001
       AUTHOR.          KOHLS DEPARTMENT STORES.                        00030001
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040001
       DATE-WRITTEN.    04/27/2010.                                     00050002
       DATE-COMPILED.                                                   00060001
      ******************************************************************00070000
      **YELLOW TICKET PRICE CHANGE REPORT                               00080000
      ******************************************************************00090000
      **THIS PROGRAM CREATES THE YELLOW TICKET 2 DAY OUT FINAL PRICE    00100000
      **CHANGE REPORT, WHICH ONLY INCLUDES THE FOLLOWING:               00110000
      **CONTENT ADDED, REMOVED, OR WITH ON HAND CHGS > 10 UNITS         00120000
      ******************************************************************00130000
      *DATE: 04/16/2010 CHANGED BY: THOMAS HANSON                       00140000
      *      MDO SPRING 2010 CHANGES; 2 DAY OUT REPORT - CHANGES ONLY   00150000
      *      BASED FROM PXKRP001, BUT DUE TO RECL DIFFS COULD NOT USE.  00160000
      *      ALL SUMMARY CONTENT REMOVED.                               00170000
      ***************************************************************** 00180000
SR3403**DATE: 02/21/2012 CHANGED BY: TEJA KARWEER ; MARKED AS 'SR3403'  00190016
SR3403**      LARGE RETAIL : AMOUNT FIELD EXPANSION                     00200023
SR3403******************************************************************00210016
P5207F***************************************************************** 00220032
P5207F**DATE: 01/15/2014 CHANGED BY: PRITHIVIRAJ (COGNIZANT)            00230030
P5207F**      CHANGED AS PART OF ORACLE RETAIL CHANGES, REMOVED THE     00240030
P5207F**      REPORT INDICATOR CHECK AND PRICE CHANGE ID FROM THE REPORT00250030
P5207F**      CHANGE TAG : P5207F.  CR NO: CHG0081217                   00260037
P5207F******************************************************************00270030
      ***************************************************************** 00280039
      **DATE: 08/22/2014 CHANGED BY: LINDA FRIESS                       00290039
      **      MODIFIED REPORT TITLE                                     00300039
      ******************************************************************00310039
       ENVIRONMENT DIVISION.                                            00320030
       CONFIGURATION SECTION.                                           00330030
       SOURCE-COMPUTER.        IBM-3090.                                00340030
       OBJECT-COMPUTER.        IBM-3090.                                00350030
       INPUT-OUTPUT SECTION.                                            00360030
       FILE-CONTROL.                                                    00370030
                                                                        00380030
           SELECT INPUT-FILE                                            00390030
                  ASSIGN TO INP01.                                      00400030
           SELECT SHOW-PRICE-CARD                                       00410000
                  ASSIGN TO INP02.                                      00420008
           SELECT INV-CHG-DIFF-CARD                                     00430012
                  ASSIGN TO INP03.                                      00440012
           SELECT REPORT-FILE                                           00450000
                  ASSIGN TO OUT01.                                      00460000
                                                                        00470000
       DATA DIVISION.                                                   00480000
       FILE SECTION.                                                    00490000
                                                                        00500000
       FD  INPUT-FILE                                                   00510000
           RECORDING MODE F                                             00520000
           BLOCK CONTAINS 0 RECORDS                                     00530000
           LABEL RECORDS ARE OMITTED                                    00540000
           DATA RECORD IS INPUT-RECORD.                                 00550000
       01  INPUT-RECORD                    PIC X(201).                  00560000
                                                                        00570000
       FD  SHOW-PRICE-CARD                                              00580000
           RECORDING MODE F                                             00590000
           BLOCK CONTAINS 0 RECORDS                                     00600000
           LABEL RECORDS ARE OMITTED                                    00610000
           DATA RECORD IS SHOW-PRICE-RECORD.                            00620000
       01  SHOW-PRICE-RECORD               PIC X(080).                  00630000
                                                                        00640012
       FD  INV-CHG-DIFF-CARD                                            00650012
           RECORDING MODE F                                             00660012
           BLOCK CONTAINS 0 RECORDS                                     00670012
           LABEL RECORDS ARE OMITTED                                    00680012
           DATA RECORD IS INV-CHG-DIFF-RECORD.                          00690012
       01  INV-CHG-DIFF-RECORD             PIC X(080).                  00700012
                                                                        00710000
       FD  REPORT-FILE                                                  00720000
           RECORDING MODE F                                             00730000
           BLOCK CONTAINS 0 RECORDS                                     00740000
           LABEL RECORDS ARE OMITTED                                    00750000
           DATA RECORD IS REPORT-RECORD.                                00760000
       01  REPORT-RECORD                   PIC X(133).                  00770000
                                                                        00780000
       WORKING-STORAGE SECTION.                                         00790000
      ******************************************************************00800000
      **SWITCHES                                                        00810000
      ******************************************************************00820000
       01  PS-PROGRAM-SWITCHES.                                         00830000
           05  PS-END-OF-INPUT-FILE-SW         PIC X(01)   VALUE 'N'.   00840000
               88  PS-END-OF-INPUT-FILE                    VALUE 'Y'.   00850000
               88  PS-NOT-END-OF-INPUT-FILE                VALUE 'N'.   00860000
      ******************************************************************00870000
      **HEADING CARD LAYOUTS                                            00880000
      ******************************************************************00890000
       01  CC-SHOW-PRICE-CARD-LAYOUT.                                   00900000
           05  CC-SHOW-PRICE-CARD-IND        PIC X(01).                 00910000
               88  CC-SHOW-PRICE-CARD-YES               VALUE 'Y'.      00920000
               88  CC-SHOW-PRICE-CARD-NO                VALUE 'N'.      00930000
           05  FILLER                        PIC X(79)  VALUE SPACES.   00940000
       01  CC-INV-CHG-DIFF-CARD-LAYOUT.                                 00950012
           05  CC-INV-CHG-DIFF-VALUE         PIC 99    VALUE ZEROS.     00960012
      ******************************************************************00970000
      **PROGRAM HOLDS                                                   00980000
      ******************************************************************00990000
       01  PH-PROGRAM-HOLDS-1.                                          01000000
           05  PH-STR-NBR                    PIC S9(04) COMP            01010000
                                                        VALUE ZEROS.    01020000
           05  PH-BUS-AREA-ID                PIC S9(02) COMP-3          01030000
                                                        VALUE ZEROS.    01040000
           05  PH-RPT-IND-ID                 PIC  X(01) VALUE SPACES.   01050004
                                                                        01060004
       01  PH-PROGRAM-HOLDS-2.                                          01070000
           05  PH-SUB-CL-NBR                 PIC S9(04) COMP-3          01080000
                                                        VALUE ZEROS.    01090000
           05  PH-DEPT-NBR                   PIC S9(04) COMP-3          01100000
                                                        VALUE ZEROS.    01110000
      ******************************************************************01120000
      **TIMESTAMP VARIABLES                                             01130000
      ******************************************************************01140000
       01 DF-DATE-TIME-FIELDS.                                          01150000
          05 DF-ACCEPT-DATE.                                            01160000
             10  DF-ACCEPT-YR                  PIC 9(02) VALUE ZEROS.   01170000
             10  DF-ACCEPT-MO                  PIC 9(02) VALUE ZEROS.   01180000
             10  DF-ACCEPT-DY                  PIC 9(02) VALUE ZEROS.   01190000
          05 DF-ACCEPT-TIME.                                            01200000
             10  DF-ACCEPT-HR                  PIC 9(02) VALUE ZEROS.   01210000
             10  DF-ACCEPT-MN                  PIC 9(02) VALUE ZEROS.   01220000
             10  DF-ACCEPT-SS                  PIC 9(04) VALUE ZEROS.   01230000
          05 DF-FORMAT-DATE.                                            01240000
             10  DF-FORMAT-DATE-MM             PIC 9(02) VALUE ZEROS.   01250000
             10  FILLER                        PIC X(01) VALUE '/'.     01260000
             10  DF-FORMAT-DATE-DD             PIC 9(02) VALUE ZEROS.   01270000
             10  FILLER                        PIC X(01) VALUE '/'.     01280000
             10  DF-FORMAT-DATE-YY             PIC 9(02) VALUE ZEROS.   01290000
      ******************************************************************01300000
      **PROGRAM CONSTANTS                                               01310000
      ******************************************************************01320000
       01  PC-PROGRAM-CONSTANTS.                                        01330000
           05  PC-CURRENT-PROGRAM-NAME         PIC X(08)                01340000
               VALUE 'PXKRP025'.                                        01350000
           05  PC-ALL-SKUS-MESSAGE             PIC X(90)                01360000
               VALUE '* INDICATES NOT ALL ACTIVE SKUS IN STYLE WILL BE M01370000
      -              'ARKED DOWN.  USE RF TO VERIFY.'.                  01380000
      ******************************************************************01390000
      **PROGRAM COUNTERS                                                01400000
      ******************************************************************01410000
       01  PC-PROGRAM-COUNTER.                                          01420000
           05  PC-INPUT-RECORDS-READ           PIC 9(09) VALUE ZEROS.   01430000
           05  PC-REPORT-RECORDS-WRITTEN       PIC 9(09) VALUE ZEROS.   01440000
           05  PC-REPORT-LINE-COUNTER          PIC 9(03) VALUE ZEROS.   01450000
           05  PC-PAGE-COUNTER                 PIC 9(03) VALUE ZEROS.   01460000
      ******************************************************************01470000
      **REPORT HEADINGS                                                 01480000
      ******************************************************************01490000
       01  RH-TITLE-1.                                                  01500000
           05  FILLER                          PIC X(50)  VALUE SPACES. 01510000
           05  FILLER                          PIC X(33)                01520000
                             VALUE 'YELLOW TICKET PRICE CHANGE REPORT'. 01530000
           05  FILLER                          PIC X(50)  VALUE SPACES. 01540000
       01  RH-TITLE-2.                                                  01550000
           05  FILLER                          PIC X(58) VALUE SPACES.  01560010
           05  FILLER                          PIC X(17)                01570013
                             VALUE ' 2 DAY OUT       '.                 01580038
           05  FILLER                          PIC X(58) VALUE SPACES.  01590013
       01  RH-HEADINGS-1.                                               01600000
           05  FILLER                          PIC X(02)  VALUE SPACES. 01610000
           05  FILLER                          PIC X(14)                01620000
                             VALUE ' STORE NUMBER:'.                    01630000
           05  RH-HEADINGS-1-STR-NBR           PIC Z9999  VALUE ZEROS.  01640000
           05  FILLER                          PIC X(01)  VALUE SPACES. 01650000
           05  RH-HEADING-1-STR-NAME           PIC X(20)  VALUE SPACES. 01660000
           05  FILLER                          PIC X(90)  VALUE SPACES. 01670000
       01  RH-HEADINGS-2.                                               01680000
           05  FILLER                          PIC X(17)                01690000
                             VALUE ' EFFECTIVE DATE: '.                 01700000
           05  RH-HEADINGS-2-EFF-DATE          PIC X(10)  VALUE SPACES. 01710000
       01  RH-HEADINGS-3.                                               01720000
           05  FILLER                          PIC X(01)  VALUE SPACES. 01730000
           05  FILLER                          PIC X(16)                01740000
                             VALUE ' BUSINESS AREA: '.                  01750000
           05  RH-HEADINGS-3-BUS-ID            PIC 99     VALUE ZEROS.  01760000
           05  FILLER                          PIC X(01)  VALUE SPACES. 01770000
           05  RH-HEADINGS-3-BUS-DESC          PIC X(25)  VALUE SPACES. 01780000
           05  FILLER                          PIC X(01)  VALUE SPACES. 01790000
           05  RH-HEADINGS-3-MESSAGE           PIC X(90)  VALUE SPACES. 01800000
           05  FILLER                          PIC X(11)  VALUE SPACES. 01810000
       01  RH-HEADINGS-4.                                               01820000
           05  FILLER                          PIC X(06)  VALUE SPACES. 01830000
           05  FILLER                          PIC X(05)                01840000
               VALUE ' SUB '.                                           01850000
           05  FILLER                          PIC X(01)  VALUE SPACES. 01860000
           05  FILLER                          PIC X(04)                01870000
               VALUE 'BOX '.                                            01880000
           05  FILLER                          PIC X(03)  VALUE SPACES. 01890000
           05  FILLER                          PIC X(73)  VALUE SPACES. 01900000
           05  FILLER                          PIC X(10)                01910000
               VALUE '   STR    '.                                      01920000
SR3403     05  FILLER                          PIC X(05)                01930020
SR3403         VALUE '  IN '.                                           01940021
           05  RH-HEADINGS-4-PRICE             PIC X(08)                01950000
SR3403         VALUE '   CLR  '.                                        01960026
           05  FILLER                          PIC X(01)  VALUE SPACES. 01970000
           05  RH-HEADINGS-4-PERCENT           PIC X(03)                01980000
               VALUE ' % '.                                             01990000
           05  FILLER                          PIC X(03)  VALUE SPACES. 02000000
P5207F     05  FILLER                          PIC X(05)  VALUE SPACES. 02010030
       01  RH-HEADINGS-5.                                               02020000
           05  FILLER                          PIC X(05)                02030000
               VALUE 'DEPT '.                                           02040000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02050000
           05  FILLER                          PIC X(05)                02060000
               VALUE 'CLASS'.                                           02070000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02080000
           05  FILLER                          PIC X(04)                02090000
               VALUE ' ID '.                                            02100000
           05  FILLER                          PIC X(03)  VALUE SPACES. 02110000
           05  FILLER                          PIC X(20)                02120000
               VALUE 'STYLE               '.                            02130000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02140000
           05  FILLER                          PIC X(30)                02150000
               VALUE 'STYLE DESCRIPTION             '.                  02160000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02170000
           05  FILLER                          PIC X(20)                02180000
               VALUE 'LABEL NAME          '.                            02190000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02200000
           05  FILLER                          PIC X(06)                02210000
               VALUE 'ONHAND'.                                          02220000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02230000
SR3403     05  FILLER                          PIC X(07)                02240020
SR3403         VALUE 'TRANSIT'.                                         02250022
           05  FILLER                          PIC X(01)  VALUE SPACES. 02260000
SR3403     05  RH-HEADINGS-5-PRICE             PIC X(09)                02270025
SR3403         VALUE '   RETAIL'.                                       02280024
           05  FILLER                          PIC X(01)  VALUE SPACES. 02290000
           05  RH-HEADINGS-5-PERCENT           PIC X(03)                02300000
               VALUE 'OFF'.                                             02310000
SR3403     05  FILLER                          PIC X(02)  VALUE SPACES. 02320028
P5207F     05  FILLER                          PIC X(09)  VALUE SPACES. 02330030
       01  RH-HEADINGS-6.                                               02340000
           05  FILLER                          PIC X(05)                02350000
               VALUE '-----'.                                           02360000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02370000
           05  FILLER                          PIC X(05)                02380000
               VALUE '-----'.                                           02390000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02400000
           05  FILLER                          PIC X(04)                02410000
               VALUE '----'.                                            02420000
           05  FILLER                          PIC X(03)  VALUE SPACES. 02430000
           05  FILLER                          PIC X(20)                02440000
               VALUE '--------------------'.                            02450000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02460000
           05  FILLER                          PIC X(30)                02470000
               VALUE '------------------------------'.                  02480000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02490000
           05  FILLER                          PIC X(20)                02500000
               VALUE '--------------------'.                            02510000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02520000
           05  FILLER                          PIC X(06)                02530000
               VALUE '------'.                                          02540000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02550000
SR3403     05  FILLER                          PIC X(07)                02560019
SR3403         VALUE '-------'.                                         02570019
           05  FILLER                          PIC X(01)  VALUE SPACES. 02580000
SR3403     05  RH-HEADINGS-6-PRICE             PIC X(09)                02590020
SR3403         VALUE '---------'.                                       02600020
           05  FILLER                          PIC X(01)  VALUE SPACES. 02610000
           05  RH-HEADINGS-6-PERCENT           PIC X(03)                02620000
               VALUE '---'.                                             02630000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02640000
P5207F     05  FILLER                          PIC X(10)  VALUE SPACES. 02650031
       01  RH-HEADINGS-7.                                               02660000
           05  FILLER                          PIC X(30)                02670000
               VALUE 'MERCHANDISE AREA              '.                  02680000
           05  FILLER                          PIC X(02)  VALUE SPACES. 02690000
           05  FILLER                          PIC X(08)                02700000
               VALUE ' ONHAND '.                                        02710000
           05  FILLER                          PIC X(50)  VALUE SPACES. 02720000
       01  RH-HEADINGS-8.                                               02730000
           05  FILLER                          PIC X(30)                02740000
               VALUE '------------------------------'.                  02750000
           05  FILLER                          PIC X(02)  VALUE SPACES. 02760000
           05  FILLER                          PIC X(08)                02770000
               VALUE '--------'.                                        02780000
           05  FILLER                          PIC X(50)  VALUE SPACES. 02790000
       01  RH-HEADINGS-9.                                               02800000
           05  FILLER                          PIC X(46)  VALUE SPACES. 02810000
           05  FILLER                          PIC X(46)                02820000
               VALUE '+ INDICATES THAT AT LEAST 1 SKU HAS BEEN ADDED'.  02830000
           05  FILLER                          PIC X(45)                02840000
               VALUE ' TO THE STYLE SINCE THE LAST PRINTING.'.          02850000
       01  RH-HEADINGS-10.                                              02860000
           05  FILLER                          PIC X(48)  VALUE SPACES. 02870000
           05  FILLER                          PIC X(45)                02880000
               VALUE 'ENSURE YOUR STORE LOCATES THESE ITEMS.'.          02890000
       01  RH-DETAIL-LINE.                                              02900000
           05  RH-COLUMN-1-DEPT-NBR            PIC ZZZZZ  VALUE ZEROS.  02910000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02920000
           05  RH-COLUMN-1-SUB-CLASS           PIC ZZZZZ  VALUE ZEROS.  02930000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02940000
           05  RH-COLUMN-1-STKR-NBR            PIC ZZZZ   VALUE SPACES. 02950000
SR3403     05  FILLER                          PIC X(02)  VALUE SPACES. 02960027
           05  RH-COLUMN-1-FULL-STYL-IND       PIC X(01)  VALUE ZEROS.  02970000
           05  RH-COLUMN-1-VS-NBR              PIC X(20)  VALUE ZEROS.  02980000
           05  FILLER                          PIC X(01)  VALUE SPACES. 02990000
           05  RH-COLUMN-1-VS-DESC             PIC X(30)  VALUE SPACES. 03000000
           05  FILLER                          PIC X(01)  VALUE SPACES. 03010000
           05  RH-COLUMN-1-LBL-NM              PIC X(20)  VALUE SPACES. 03020000
           05  FILLER                          PIC X(02)  VALUE SPACES. 03030000
           05  RH-COLUMN-1-STR-EXPTD-OH        PIC ZZZZ9  VALUE ZEROS.  03040000
SR3403     05  FILLER                          PIC X(03)  VALUE SPACES. 03050018
           05  RH-COLUMN-1-INTRNST             PIC ZZZZ9  VALUE ZEROS.  03060000
SR3403     05  FILLER                          PIC X(01)  VALUE SPACES. 03070027
SR3403     05  RH-COLUMN-1-RETAIL              PIC $ZZZZZ.ZZ.           03080017
SR3403     05  FILLER                          PIC X(02)  VALUE SPACES. 03090027
           05  RH-COLUMN-1-NUMBER              PIC  ZZ    VALUE ZEROS.  03100000
           05  FILLER                          PIC X(01)  VALUE SPACES. 03110000
P5207F     05  FILLER                          PIC X(25)  VALUE SPACES. 03120030
       01  RH-FOOTERS-1.                                                03130000
           05  FILLER                          PIC X(47)                03140000
               VALUE 'THIS REPORT SHOULD BE USED TO PURGE ALL FUTURE '. 03150000
           05  FILLER                          PIC X(30)                03160000
               VALUE 'CLEARANCE FROM YOUR STOCKROOM.'.                  03170000
           05  FILLER                          PIC X(75)  VALUE SPACES. 03180000
       01  RH-FOOTERS-2.                                                03190000
           05  FILLER                          PIC X(54)  VALUE SPACES. 03200000
           05  FILLER                          PIC X(19)                03210000
               VALUE '***END OF REPORT***'.                             03220000
      ******************************************************************03230000
      **COPYBOOKS                                                       03240000
      ******************************************************************03250000
      ***INPUT FILE FORMAT                                              03260000
           COPY PXRD125.                                                03270000
      ***STANDARD KOHLS HEADING FOR 132 BYTE REPORT                     03280000
           COPY DPWS132O.                                               03290000
      ******************************************************************03300000
      **ERROR HANDLING                                                  03310000
      ******************************************************************03320000
       01  PV-MISC-ABEND-FIELDS.                                        03330000
           05  PV-PARAGRAPH-NAME               PIC X(30) VALUE SPACE.   03340000
           05  PV-OPERATION-MSG-1              PIC X(40) VALUE SPACE.   03350000
           05  PV-OPERATION-MSG-2              PIC X(40) VALUE SPACE.   03360000
                                                                        03370000
       PROCEDURE DIVISION.                                              03380000
      ***************************************************************** 03390000
                                                                        03400000
           PERFORM 1000-INITIALIZATION.                                 03410000
           PERFORM 2000-PROCESS-RECORDS                                 03420000
                   UNTIL PS-END-OF-INPUT-FILE                           03430000
           PERFORM 9999-WRAPUP.                                         03440000
           GOBACK.                                                      03450000
                                                                        03460000
       EJECT.                                                           03470000
      ******************************************************************03480000
      **INITIALIZATION AREA                                             03490000
      ******************************************************************03500000
       1000-INITIALIZATION.                                             03510000
                                                                        03520000
           OPEN INPUT  INPUT-FILE                                       03530000
                       SHOW-PRICE-CARD                                  03540012
                       INV-CHG-DIFF-CARD.                               03550012
           OPEN OUTPUT REPORT-FILE.                                     03560000
                                                                        03570000
           ACCEPT DF-ACCEPT-TIME FROM TIME.                             03580000
           ACCEPT DF-ACCEPT-DATE FROM DATE.                             03590000
                                                                        03600000
           MOVE DF-ACCEPT-YR          TO DF-FORMAT-DATE-YY.             03610000
           MOVE DF-ACCEPT-MO          TO DF-FORMAT-DATE-MM.             03620000
           MOVE DF-ACCEPT-DY          TO DF-FORMAT-DATE-DD.             03630000
                                                                        03640000
           PERFORM 1200-READ-INV-CHG-DIFF-CARD.                         03650012
           PERFORM 1999-READ-SHOW-PRICE-CARD.                           03660000
           PERFORM 2999-READ-INPUT-FILE.                                03670000
                                                                        03680000
           IF  PS-NOT-END-OF-INPUT-FILE                                 03690000
               PERFORM 1100-HEADING-PREP                                03700000
               PERFORM 2100-WRITE-HEADINGS                              03710000
               MOVE PXRD125-BUS-AREA-ID  TO PH-BUS-AREA-ID              03720000
               MOVE PXRD125-STR-NBR      TO PH-STR-NBR                  03730000
           END-IF.                                                      03740000
                                                                        03750000
       EJECT.                                                           03760000
      ******************************************************************03770000
      **MOVE DATA TO FIELDS IN HEADING FOR REPORT                       03780000
      ******************************************************************03790000
       1100-HEADING-PREP.                                               03800000
                                                                        03810000
      ***PREPS KOHLS STANDARD HEADING                                   03820000
           MOVE PC-CURRENT-PROGRAM-NAME                                 03830000
                                     TO DP132O-PROGRAM-NAME.            03840000
           MOVE DF-FORMAT-DATE       TO DP132O-RUN-DATE.                03850000
           MOVE DF-ACCEPT-HR         TO DP132O-RUN-HOUR.                03860000
           MOVE DF-ACCEPT-MN         TO DP132O-RUN-MINUTE.              03870000
           MOVE 1                    TO DP132O-REPORT-NUMBER.           03880008
                                                                        03890000
      ***REMOVES PRICING HEADINGS                                       03900000
           IF  CC-SHOW-PRICE-CARD-NO                                    03910000
               MOVE SPACES           TO RH-HEADINGS-4-PRICE             03920000
               MOVE SPACES           TO RH-HEADINGS-5-PRICE             03930000
               MOVE SPACES           TO RH-HEADINGS-6-PRICE             03940000
               MOVE SPACES           TO RH-HEADINGS-4-PERCENT           03950000
               MOVE SPACES           TO RH-HEADINGS-5-PERCENT           03960000
               MOVE SPACES           TO RH-HEADINGS-6-PERCENT           03970000
           ELSE                                                         03980000
               MOVE ' % '            TO RH-HEADINGS-4-PERCENT           03990000
               MOVE 'OFF'            TO RH-HEADINGS-5-PERCENT           04000000
               MOVE '---'            TO RH-HEADINGS-6-PERCENT           04010000
           END-IF.                                                      04020000
                                                                        04030000
       EJECT.                                                           04040000
      ***************************************************************** 04050012
      **READ INVENTORY CHANGE DIFFERENCE CONTROL CARD.                  04060012
      ***************************************************************** 04070012
       1200-READ-INV-CHG-DIFF-CARD.                                     04080012
                                                                        04090012
           READ INV-CHG-DIFF-CARD INTO CC-INV-CHG-DIFF-CARD-LAYOUT.     04100012
           DISPLAY 'CC - INV CHG DIFF PARAM: ' CC-INV-CHG-DIFF-VALUE.   04110012
                                                                        04120012
       EJECT.                                                           04130012
      ***************************************************************** 04140000
      **READ SHOW PRICE CONTROL CARD                                    04150000
      ***************************************************************** 04160000
       1999-READ-SHOW-PRICE-CARD.                                       04170000
                                                                        04180000
           READ SHOW-PRICE-CARD INTO CC-SHOW-PRICE-CARD-LAYOUT.         04190000
                                                                        04200000
       EJECT.                                                           04210000
      ******************************************************************04220000
      **PROCESSES INPUT FILE                                            04230000
      ******************************************************************04240000
       2000-PROCESS-RECORDS.                                            04250000
                                                                        04260000
           EVALUATE TRUE                                                04270000
              WHEN PXRD125-STR-NBR EQUAL PH-STR-NBR                     04280000
                                                                        04290004
                   IF  PC-REPORT-LINE-COUNTER > 60                      04300000
                    OR PXRD125-BUS-AREA-ID NOT EQUAL PH-BUS-AREA-ID     04310000
                       PERFORM 2300-WRITE-FOOTERS                       04320000
                       PERFORM 2100-WRITE-HEADINGS                      04330000
                       INITIALIZE PH-PROGRAM-HOLDS-2                    04340000
                       MOVE PXRD125-BUS-AREA-ID                         04350000
                                        TO PH-BUS-AREA-ID               04360000
                   END-IF                                               04370000
                                                                        04380004
                                                                        04390004
                   PERFORM 2200-WRITE-DETAIL                            04400000
                                                                        04410004
              WHEN PXRD125-STR-NBR NOT EQUAL PH-STR-NBR                 04420000
                   INITIALIZE PC-PAGE-COUNTER                           04430000
                   PERFORM 2300-WRITE-FOOTERS                           04440000
                   PERFORM 1100-HEADING-PREP                            04450000
                   PERFORM 2100-WRITE-HEADINGS                          04460000
                   INITIALIZE PH-PROGRAM-HOLDS-2                        04470000
                   PERFORM 2200-WRITE-DETAIL                            04480000
                   MOVE PXRD125-STR-NBR TO PH-STR-NBR                   04490000
                   MOVE PXRD125-BUS-AREA-ID                             04500000
                                        TO PH-BUS-AREA-ID               04510000
           END-EVALUATE.                                                04520000
                                                                        04530000
           PERFORM 2999-READ-INPUT-FILE.                                04540000
                                                                        04550000
       EJECT.                                                           04560000
                                                                        04570000
      ***************************************************************** 04580006
      **WRITE REPORT HEADERS                                            04590006
      ***************************************************************** 04600006
       2100-WRITE-HEADINGS.                                             04610006
                                                                        04620006
           INITIALIZE PC-REPORT-LINE-COUNTER.                           04630006
                                                                        04640006
           ADD +1                      TO PC-PAGE-COUNTER.              04650006
           MOVE PC-PAGE-COUNTER        TO DP132O-PAGE-NUMBER.           04660006
                                                                        04670006
           MOVE PXRD125-STR-NBR        TO RH-HEADINGS-1-STR-NBR.        04680006
           MOVE PXRD125-LOC-NM         TO RH-HEADING-1-STR-NAME.        04690006
           MOVE PXRD125-BUS-AREA-ID    TO RH-HEADINGS-3-BUS-ID.         04700006
           MOVE PXRD125-BUS-AREA-DESC  TO RH-HEADINGS-3-BUS-DESC.       04710006
           MOVE PXRD125-EFF-DATE       TO RH-HEADINGS-2-EFF-DATE.       04720006
                                                                        04730006
           WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      04740006
                               AFTER ADVANCING PAGE.                    04750006
                                                                        04760006
           WRITE REPORT-RECORD FROM RH-TITLE-1 AFTER ADVANCING 1 LINE.  04770006
           WRITE REPORT-RECORD FROM RH-TITLE-2 AFTER ADVANCING 1 LINE.  04780006
                                                                        04790006
           WRITE REPORT-RECORD FROM RH-HEADINGS-1                       04800006
                               AFTER ADVANCING 2 LINES.                 04810006
           WRITE REPORT-RECORD FROM RH-HEADINGS-2                       04820006
                               AFTER ADVANCING 1 LINES.                 04830006
           WRITE REPORT-RECORD FROM RH-HEADINGS-3                       04840006
                               AFTER ADVANCING 1 LINES.                 04850006
           WRITE REPORT-RECORD FROM RH-HEADINGS-9                       04860006
                               AFTER ADVANCING 1 LINES.                 04870006
           WRITE REPORT-RECORD FROM RH-HEADINGS-10                      04880006
                               AFTER ADVANCING 1 LINES.                 04890006
                                                                        04900006
      ** PERHAPS ON NEW PAGE HEADINGS LIKE THIS, ALSO PRINT HEADER      04910006
      ** FOR IF IT WAS ADDED/REMOVED/INV CHG...                         04920006
                                                                        04930006
                                                                        04940006
           WRITE REPORT-RECORD FROM RH-HEADINGS-4                       04950006
                               AFTER ADVANCING 2 LINES.                 04960006
           WRITE REPORT-RECORD FROM RH-HEADINGS-5                       04970006
                               AFTER ADVANCING 1 LINES.                 04980006
           WRITE REPORT-RECORD FROM RH-HEADINGS-6                       04990006
                               AFTER ADVANCING 1 LINES.                 05000006
                                                                        05010006
           ADD +12             TO PC-REPORT-LINE-COUNTER.               05020006
                                                                        05030006
       EJECT.                                                           05040006
                                                                        05050006
                                                                        05060006
      ***************************************************************** 05070000
      **WRITE DETAIL LINE                                               05080000
      ***************************************************************** 05090000
       2200-WRITE-DETAIL.                                               05100000
                                                                        05110000
           INITIALIZE RH-DETAIL-LINE.                                   05120000
                                                                        05130000
           IF  PH-DEPT-NBR NOT EQUAL PXRD125-DEPT-NBR                   05140000
               MOVE PXRD125-DEPT-NBR   TO RH-COLUMN-1-DEPT-NBR          05150000
           END-IF.                                                      05160000
                                                                        05170000
           IF  PH-SUB-CL-NBR NOT EQUAL PXRD125-SUB-CL-NBR               05180000
               MOVE PXRD125-SUB-CL-NBR TO RH-COLUMN-1-SUB-CLASS         05190000
           END-IF.                                                      05200000
                                                                        05210000
           MOVE PXRD125-VS-NBR         TO RH-COLUMN-1-VS-NBR.           05220000
           MOVE PXRD125-VS-DESC        TO RH-COLUMN-1-VS-DESC.          05230000
           MOVE PXRD125-LBL-NM         TO RH-COLUMN-1-LBL-NM.           05240000
           MOVE PXRD125-STR-EXPTED-QTY TO RH-COLUMN-1-STR-EXPTD-OH.     05250000
           MOVE PXRD125-IN-TRNST-QTY   TO RH-COLUMN-1-INTRNST.          05260000
           MOVE PXRD125-STKR-NBR       TO RH-COLUMN-1-STKR-NBR.         05270000
                                                                        05280000
      ***DO NOT SHOW PRICE IF CC STATES NOT TO                          05290000
           IF  CC-SHOW-PRICE-CARD-YES                                   05300000
               MOVE PXRD125-UNT-RTL-AMT                                 05310000
                                       TO RH-COLUMN-1-RETAIL            05320000
      ***ONLY SHOW PRICE IF STORE IS PART OF PRICE OPTIMIZATION PILOT   05330000
011707*        MOVE PXRD125-STR-NBR    TO RFWS010-TEST-STORES           05340000
011707*        IF  RFWS010-TEST-STORES-ALL                              05350000
                   IF  PXRD125-LAST-NCLR-RTL-AMT > 0                    05360000
      ***NCLR SHOULD NEVER BE ZEROS, BUT JUST IN CASE                   05370000
                       COMPUTE RH-COLUMN-1-NUMBER =                     05380000
                               100 *( (PXRD125-LAST-NCLR-RTL-AMT        05390000
                                     - PXRD125-UNT-RTL-AMT)             05400000
                               /  PXRD125-LAST-NCLR-RTL-AMT)            05410000
                   END-IF                                               05420000
011707*        END-IF                                                   05430000
           END-IF.                                                      05440000
                                                                        05450000
      ***MARK STYLE IF NOT ALL INCLUDED IN MARKDOWN                     05460000
           IF  PXRD125-FULL-STYLE-MKDWN-NO                              05470000
               MOVE '*'                TO RH-COLUMN-1-FULL-STYL-IND     05480000
           ELSE                                                         05490000
               MOVE SPACES             TO RH-COLUMN-1-FULL-STYL-IND     05500000
           END-IF.                                                      05510000
                                                                        05520000
                                                                        05530000
           ADD +1                      TO PC-REPORT-LINE-COUNTER.       05540000
                                                                        05550000
           WRITE REPORT-RECORD FROM RH-DETAIL-LINE.                     05560000
                                                                        05570000
           MOVE PXRD125-DEPT-NBR       TO PH-DEPT-NBR.                  05580000
           MOVE PXRD125-SUB-CL-NBR     TO PH-SUB-CL-NBR.                05590000
                                                                        05600000
           ADD +1                      TO PC-REPORT-RECORDS-WRITTEN.    05610000
                                                                        05620000
       EJECT.                                                           05630000
      ***************************************************************** 05640000
      **WRITE FOOTERS                                                   05650000
      ***************************************************************** 05660000
       2300-WRITE-FOOTERS.                                              05670000
                                                                        05680000
           WRITE REPORT-RECORD FROM RH-FOOTERS-2.                       05690000
                                                                        05700000
       EJECT.                                                           05710000
      ***************************************************************** 05720000
      **READ INPUT FILE                                                 05730000
      ***************************************************************** 05740000
       2999-READ-INPUT-FILE.                                            05750000
                                                                        05760000
           READ INPUT-FILE INTO PXRD125-YELLOW-TICKET-REPORT            05770000
                AT END SET PS-END-OF-INPUT-FILE TO TRUE                 05780000
           END-READ.                                                    05790000
                                                                        05800000
           IF  PS-NOT-END-OF-INPUT-FILE                                 05810000
               ADD +1 TO PC-INPUT-RECORDS-READ                          05820000
           END-IF.                                                      05830000
                                                                        05840000
       EJECT.                                                           05850000
      ****************************************************************  05860000
      *END OF PROGRAM ROUTINE                                           05870000
      ****************************************************************  05880000
       9999-WRAPUP.                                                     05890000
                                                                        05900000
           IF  PC-REPORT-RECORDS-WRITTEN > 0                            05910000
               PERFORM 2300-WRITE-FOOTERS                               05920000
           END-IF.                                                      05930000
                                                                        05940000
           CLOSE INPUT-FILE                                             05950000
                 SHOW-PRICE-CARD                                        05960000
                 INV-CHG-DIFF-CARD                                      05970012
                 REPORT-FILE.                                           05980000
                                                                        05990000
           PERFORM 9999-DISPLAY-STATISTICS.                             06000000
                                                                        06010000
       EJECT.                                                           06020000
      ****************************************************************  06030000
      *DISPLAY PROGRAM STATISTICS                                       06040000
      ****************************************************************  06050000
       9999-DISPLAY-STATISTICS.                                         06060000
                                                                        06070000
           DISPLAY '*************************************************'. 06080000
           DISPLAY '* PROGRAM...............: ' PC-CURRENT-PROGRAM-NAME.06090000
           DISPLAY '* DATE..................: ' DF-ACCEPT-DATE.         06100000
           DISPLAY '* TIMESTAMP.............: ' DF-ACCEPT-TIME.         06110000
           DISPLAY '*************************************************'. 06120000
           DISPLAY '* INPUT RECORDS READ.........: '                    06130000
                                          PC-INPUT-RECORDS-READ.        06140000
           DISPLAY '* REPORT RECORDS WRITTEN.....: '                    06150000
                                          PC-REPORT-RECORDS-WRITTEN.    06160000
           DISPLAY '*************************************************'. 06170000
                                                                        06180000
       EJECT.                                                           06190000
