000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT045.                                         00040000
000500 AUTHOR.        PAUL OMAN.                                        00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   APRIL, 2003.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900****************************************************************  00090000
001000*    THIS PROGRAM WILL COMPARE RMS PO / LEGACY PO              *  00100000
001100* PO DOMAIN TEMPLATE.........:  XXT_INBD_ALLOC                 *  00110000
001200* PO DOMAIN TEMPLATE COPYBOOK:  XLRD019                        *  00120000
001300*                                                              *  00130000
001400*        INPUT COMES TO THIS PROGRAM FROM XLKUT040.            *  00140000
001500*                                                              *  00150000
001600*        THIS PROGRAM MATCHES THE LEGACY AND RMS FILES BY PO   *  00160000
001700*    NUMBER, SKU NUMBER AND LOCATION NUMBER. IT                *  00170000
001800*    WRITES ERROR RECORDS OUT FOR ANY UNMATCHED RECORDS. IT    *  00180000
001900*    ALSO CHECKS TO SEE IF THERE ARE ANY DATA DIFFERENCES FOR  *  00190000
002000*    THOSE RECORDS WHOSE PO NUMBERS MATCH. IF THERE ARE ANY,   *  00200000
002100*    AN ERROR RECORD IS WRITTEN INDICATING THE FIELDS THAT     *  00210000
002200*    ARE DIFFERENT.                                            *  00220000
002300*        THERE ARE SOME MOVES OF FIELDS COMMENTED OUT. THIS    *  00230000
002400*    HAS BEEN DONE BECAUSE SOME OF THESE FIELDS AREN'T AVAIL-  *  00240000
002500*    ABLE ON ONE OF THE SYSTEMS.  YOU MAY FIND THESE BY DOING  *  00250000
002600*    A F '**??'.                                               *  00260000
002700***************************************************************** 00270000
004300****************************************************************  00271099
      * DATE  08/04/2014                                                00272099
      *  CHANGE MADE: REMOVED THE CHECKS FOR BELOW FIELDS               00273099
      *      - DC ALLC MULT QTY                                         00274099
      *      - ALLOC RND CDE                                            00275099
      * MADE BY: CHERI PARMLEY           TKID: TKMAF76                  00279099
      * CHANGES TAGGED AS 'CLP 08/04/14' CR : CHG0088660                00279199
004300****************************************************************  00279299
002800 ENVIRONMENT DIVISION.                                            00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000                                                                  00300000
003100 FILE-CONTROL.                                                    00310000
003200                                                                  00320000
003300     SELECT RMS-PO-FILE                                           00330000
003400         ASSIGN TO INP01.                                         00340000
003500                                                                  00350000
003600     SELECT LEGACY-FILE                                           00360000
003700         ASSIGN TO INP02.                                         00370000
003800                                                                  00380000
003900     SELECT ERROR-FILE                                            00390000
004000         ASSIGN TO OUT01.                                         00400000
004100                                                                  00410000
004200***************************************************************** 00420000
004300 DATA DIVISION.                                                   00430000
004400***************************************************************** 00440000
004500 FILE SECTION.                                                    00450000
004600                                                                  00460000
004700 FD  RMS-PO-FILE                                                  00470000
004800     RECORDING MODE IS F                                          00480000
004900     BLOCK CONTAINS 0 RECORDS                                     00490000
005000     LABEL RECORDS ARE STANDARD.                                  00500000
005100                                                                  00510000
005200 01  RMS-PO-RECORD                PIC X(113).                     00520054
005300                                                                  00530000
005400 FD  LEGACY-FILE                                                  00540000
005500     RECORDING MODE IS F                                          00550000
005600     BLOCK CONTAINS 0 RECORDS                                     00560000
005700     LABEL RECORDS ARE STANDARD.                                  00570000
005800                                                                  00580000
005900 01  LEGACY-RECORD                PIC X(113).                     00590054
006000                                                                  00600000
006100                                                                  00610000
006200 FD  ERROR-FILE                                                   00620000
006300     RECORDING MODE IS F                                          00630000
006400     BLOCK CONTAINS 0 RECORDS                                     00640000
006500     LABEL RECORDS ARE STANDARD.                                  00650000
006600                                                                  00660000
006700 01  ERROR-RECORD                 PIC X(830).                     00670000
006800                                                                  00680000
006900                                                                  00690000
007000***************************************************************** 00700000
007100 WORKING-STORAGE SECTION.                                         00710000
007200                                                                  00720000
007300 01  PS-PROGRAM-SWITCHES.                                         00730000
007400     05  PS-EOF-INPUT1-SW             PIC X(01)  VALUE 'N'.       00740000
007500         88  PS-EOF-INPUT1-YES                   VALUE 'Y'.       00750000
007600         88  PS-EOF-INPUT1-NO                    VALUE 'N'.       00760000
007700     05  PS-EOF-INPUT2-SW             PIC X(01)  VALUE 'N'.       00770000
007800         88  PS-EOF-INPUT2-YES                   VALUE 'Y'.       00780000
007900         88  PS-EOF-INPUT2-NO                    VALUE 'N'.       00790000
008000     05  PS-EMAIL-SW                  PIC X(01)  VALUE 'N'.       00800000
008100         88  PS-EMAIL-YES                        VALUE 'Y'.       00810000
008200         88  PS-EMAIL-NO                         VALUE 'N'.       00820000
008000     05  PS-DONE-SW                   PIC X(01)  VALUE 'N'.       00821072
008100         88  PS-DONE-YES                         VALUE 'Y'.       00822072
008200         88  PS-DONE-NO                          VALUE 'N'.       00823072
008300                                                                  00830000
008400 01  PC-PROGRAM-CONSTANTS.                                        00840000
008500     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT045'.00850000
008600     05  PC-FIVE-BLANKS               PIC  X(05) VALUE SPACES.    00860000
008700                                                                  00870000
008800 01  PC-SORT-KEY.                                                 00880000
008900     05  PC-SKU-NBR                   PIC  9(08) VALUE ZEROES.    00890000
009000     05  PC-LOC-NBR                   PIC  9(04) VALUE ZEROES.    00900000
009100                                                                  00910000
004500 01  DK-KEYS.                                                     00911093
004600     05  DK-PO-NBR                    PIC S9(09) COMP.            00912093
004700     05  DK-PO-LNE-NBR                PIC S9(09) COMP.            00913093
004900     05  DK-DEST-NBR                  PIC S9(04) COMP.            00915093
                                                                        00916093
009200 01  PV-PROGRAM-VARIABLES.                                        00920000
           05  PV-DC-SPLT-CNCLD-QTY         PIC  S9(9) COMP.            00921099
009300     05  PV-PO-LNE-NBR                PIC  9(09) VALUE  0.        00930084
009300     05  PV-RECORDS-READ-1            PIC  9(09) VALUE  0.        00931084
009400     05  PV-RECORDS-READ-2            PIC  9(09) VALUE  0.        00940000
009500     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        00950000
009600     05  PV-RECORDS-ON-BOTH           PIC  9(09) VALUE  0.        00960000
009700     05  PV-RECORDS-ON-RMS-ONLY       PIC  9(09) VALUE  0.        00970000
009800     05  PV-RECORDS-ON-LEGACY-ONLY    PIC 9(09) VALUE 0.          00980000
009900     05  PV-RECORDS-DATA-MISMATCH     PIC  9(09) VALUE  0.        00990000
010000     05  PV-ALL-NINES                 PIC  9(09) VALUE  99999999. 01000000
010000     05  PV-RMS-ORD-QTY               PIC  9(08).9(04) VALUE      01001035
010100                                                 '00000000.0000'. 01001175
010000     05  PV-ITM-NBR                   PIC  9(15).                 01002075
010200 01  PV-ABEND-FIELDS.                                             01020000
009400     05  PV-SQLCODE                   PIC  ------9.               01021077
010300     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         01030000
010400                                                 COMP SYNC.       01040000
010500     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT045'.01050000
010600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01060000
010700     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01070000
010800     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    01080000
010900                                                                  01090000
007500 01  PC-TOT-QTY.                                                  01091036
007600     05  PC-ORD-QTY-AMT-RMS           PIC  9(08)V9(4) VALUE ZEROS.01092036
007600     05  PC-CNCLD-QTY-AMT-RMS         PIC  9(08)V9(4) VALUE ZEROS.01093036
004200     05  PV-WORK-QTY                  PIC  X(13) JUST RIGHT.      01098036
007700                                                                  01099036
006400****NUMERIC EDITING ROUTINE                                       01099136
006500     COPY DPWS010I.                                               01099236
004900*----------- COPYBOOK FOR THE LOGISTICS DOMAIN MODULE -----------*01099365
004700     COPY XLWS001.                                                01099465
006600                                                                  01099536
011000 01  PV-RMS-INPUT.                                                01100000
011100     COPY XLRD019.                                                01110000
011200                                                                  01120000
011300 01  PV-LEGACY-INPUT.                                             01130000
011400     COPY XLRD019.                                                01140000
011500                                                                  01150000
011600 01  PV-ERROR-OUTPUT.                                             01160000
011700     COPY XLRD023.                                                01170000
011800                                                                  01180000
006100*    LEGACY PO LINES                                              01180164
006200     EXEC SQL                                                     01180264
006300         INCLUDE TPURITM                                          01180364
006400     END-EXEC.                                                    01180464
007100*    LEGACY DC ALLOCATIONS                                        01181061
007200     EXEC SQL                                                     01182061
007300         INCLUDE TALLPLN                                          01183061
007400     END-EXEC.                                                    01184061
                                                                        01184161
008700     EXEC SQL                                                     01185061
008800          INCLUDE SQLCA                                           01186061
008900     END-EXEC.                                                    01187061
009000     COPY SQLCA2.                                                 01188061
009100* * *                                                             01189061
011900***************************************************************** 01190000
012000 PROCEDURE DIVISION.                                              01200000
012100***************************************************************** 01210000
012200     DISPLAY ' '.                                                 01220000
012300     DISPLAY '**** BEGINNING XLKUT045 ****'.                      01230000
012400                                                                  01240000
012500     OPEN INPUT  RMS-PO-FILE                                      01250000
012600                 LEGACY-FILE                                      01260000
012700          OUTPUT ERROR-FILE.                                      01270000
012800     SET PS-EMAIL-NO       TO TRUE.                               01280000
012900                                                                  01290000
013000     PERFORM 1000-READ-RMS-INPUT.                                 01300000
013100     PERFORM 1100-READ-LEGACY-INPUT.                              01310000
013200                                                                  01320000
013300     PERFORM 2000-PROCESS-INPUT-FILE                              01330000
013400       UNTIL PS-EOF-INPUT1-YES AND                                01340000
013500             PS-EOF-INPUT2-YES.                                   01350000
013600                                                                  01360000
013700     CLOSE RMS-PO-FILE                                            01370000
013800           LEGACY-FILE                                            01380000
013900           ERROR-FILE.                                            01390000
014000                                                                  01400000
014100     DISPLAY ' '.                                                 01410000
014200     DISPLAY '  INPUT RMS PO REC = ' PV-RECORDS-READ-1.           01420000
014300     DISPLAY '  INPUT LEGACY REC = ' PV-RECORDS-READ-2.           01430000
014400     DISPLAY ' '.                                                 01440000
014500     DISPLAY '          XLRD019 - XXT-INBD-ALLOC'.                01450000
014600     DISPLAY 'FILES ARE MATCHED BY PO NUMBER - 8 POSITIONS'.      01460000
014700     DISPLAY '                     SKU-NBR   - 8 POSITIONS'.      01470000
014800     DISPLAY '                     LOC-NBR   - 4 POSITIONS'.      01480000
014900     DISPLAY ' '.                                                 01490000
015000     DISPLAY PC-FIVE-BLANKS                                       01500000
015100             'RECORDS ON BOTH FILES ---------> '                  01510000
015200              PV-RECORDS-ON-BOTH.                                 01520000
015300     DISPLAY ' '.                                                 01530000
015400     DISPLAY '  OUTPUT RECORDS WRITTEN ------> '                  01540000
015500              PV-RECORDS-WRITTEN.                                 01550000
015600     DISPLAY PC-FIVE-BLANKS                                       01560000
015700             'RECORDS ON RMS ONLY -----------> '                  01570000
015800              PV-RECORDS-ON-RMS-ONLY                              01580000
015900             ' - "A" RECORD CODE'.                                01590000
016000     DISPLAY PC-FIVE-BLANKS                                       01600000
016100             'RECORDS ON LEGACY ONLY --------> '                  01610000
016200              PV-RECORDS-ON-LEGACY-ONLY                           01620000
016300             ' - "B" RECORD CODE'.                                01630000
016400     DISPLAY PC-FIVE-BLANKS                                       01640000
016500             'RECORDS WITH DATA MISMATCH ----> '                  01650000
016600              PV-RECORDS-DATA-MISMATCH                            01660000
016700             ' - "C" RECORD CODE'.                                01670000
016800     DISPLAY ' '.                                                 01680000
016900     DISPLAY '****  END OF  XLKUT045  ****'.                      01690000
017000     DISPLAY ' '.                                                 01700000
017100                                                                  01710000
017200*    SET RETURN CODE IF E-MAIL SWITCH IS TRUE.                    01720000
017300     IF PS-EMAIL-YES                                              01730000
017400         MOVE 4095 TO RETURN-CODE                                 01740000
017500     END-IF.                                                      01750000
017600     GOBACK.                                                      01760000
017700                                                                  01770000
017800                                                                  01780000
017900***************************************************************** 01790000
018000*  READ A RMS PO RECORD                                           01800000
018100***************************************************************** 01810000
018200 1000-READ-RMS-INPUT.                                             01820000
018300                                                                  01830000
018400     MOVE '1000-READ-RMS-INPUT    ' TO PV-ABEND-PARAGRAPH.        01840000
018500                                                                  01850000
018600     INITIALIZE PV-RMS-INPUT.                                     01860000
018700                                                                  01870000
018800     READ RMS-PO-FILE                                             01880000
018900          INTO PV-RMS-INPUT                                       01890000
019000            AT END                                                01900000
019100               SET PS-EOF-INPUT1-YES TO TRUE                      01910000
019200     END-READ.                                                    01920000
019300                                                                  01930000
019400     IF PS-EOF-INPUT1-YES                                         01940000
019500        MOVE PV-ALL-NINES TO XL019-PO-NBR OF PV-RMS-INPUT         01950000
019600                             XL019-SKU-NBR OF PV-RMS-INPUT        01960000
019700                             XL019-LOC-NBR OF PV-RMS-INPUT        01970000
019800     ELSE                                                         01980000
019900        ADD +1 TO PV-RECORDS-READ-1                               01990000
020000     END-IF.                                                      02000000
020100                                                                  02010000
020200***************************************************************** 02020000
020300*  READ A LEGACY RECORD                                           02030000
020400***************************************************************** 02040000
020500 1100-READ-LEGACY-INPUT.                                          02050000
020600                                                                  02060000
020700     MOVE '1100-READ-LEGACY-INPUT' TO PV-ABEND-PARAGRAPH.         02070000
020800                                                                  02080000
020900     INITIALIZE PV-LEGACY-INPUT.                                  02090000
021000                                                                  02100000
021100     READ LEGACY-FILE                                             02110000
021200          INTO PV-LEGACY-INPUT                                    02120000
021300            AT END                                                02130000
021400               SET PS-EOF-INPUT2-YES TO TRUE                      02140000
021500     END-READ.                                                    02150000
021600                                                                  02160000
021700     IF PS-EOF-INPUT2-YES                                         02170000
021800        MOVE PV-ALL-NINES TO XL019-PO-NBR OF PV-LEGACY-INPUT      02180000
021900                             XL019-SKU-NBR OF PV-LEGACY-INPUT     02190000
022000                             XL019-LOC-NBR OF PV-LEGACY-INPUT     02200000
022100     ELSE                                                         02210000
022200        ADD +1 TO PV-RECORDS-READ-2                               02220000
022300     END-IF.                                                      02230000
022400                                                                  02240000
022500***************************************************************** 02250000
022600*  REFORMAT THE RMS PO EXTRACT FILE                               02260000
022700***************************************************************** 02270000
022800 2000-PROCESS-INPUT-FILE.                                         02280000
022900                                                                  02290000
023000     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       02300000
023100                                                                  02310000
023200     IF XL019-PO-NBR   OF PV-RMS-INPUT    <                       02320000
023300        XL019-PO-NBR   OF PV-LEGACY-INPUT                         02330000
023400*******************************                                   02340000
023500***  ON RMS NOT ON LEGACY                                         02350000
023600*******************************                                   02360000
027000         IF XL019-ORD-QTY OF PV-RMS-INPUT  = '00000000.0000' AND  02361042
027200            XL019-CNCLD-QTY OF PV-RMS-INPUT = '00000000.0000'     02362042
027900               PERFORM 1000-READ-RMS-INPUT                        02363042
024100         ELSE                                                     02363142
028000                                                                  02364042
023700              ADD 1 TO PV-RECORDS-ON-RMS-ONLY                     02370042
023800              SET XL023-ON-RMS-ONLY TO TRUE                       02380042
023900              PERFORM 3400-WRITE-RMS-ERROR                        02390042
024000              PERFORM 1000-READ-RMS-INPUT                         02400042
024100         END-IF                                                   02401042
024100     ELSE                                                         02410000
024200        IF XL019-PO-NBR  OF PV-RMS-INPUT    >                     02420000
024300           XL019-PO-NBR  OF PV-LEGACY-INPUT                       02430000
024400*******************************                                   02440000
024500***   ON LEGACY NOT ON RMS                                        02450000
024600*******************************                                   02460000
027000          IF XL019-ORD-QTY OF PV-LEGACY-INPUT = '00000000.0000'   02461052
027200          AND XL019-CNCLD-QTY OF PV-LEGACY-INPUT = '00000000.0000'02463052
028600               PERFORM 1100-READ-LEGACY-INPUT                     02464052
025100          ELSE                                                    02466052
024700               ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                 02470042
024800               SET XL023-ON-LEGACY-ONLY TO TRUE                   02480042
024900               PERFORM 4000-WRITE-LEGACY-ERROR                    02490042
025000               PERFORM 1100-READ-LEGACY-INPUT                     02500042
025100          END-IF                                                  02501052
025100        ELSE                                                      02510000
025200*******************************                                   02520000
025300***  ON RMS AND ON LEGACY                                         02530000
025400*******************************                                   02540000
025500           PERFORM 2400-CHECK-KEY-VALUES                          02550000
025600        END-IF                                                    02560000
025700     END-IF.                                                      02570000
025800                                                                  02580000
025900****************************************************************  02590000
026000*    CHECK ALL THE KEY VALUES FOR MISMATCHES.                  *  02600000
026100*                                                              *  02610000
026200****************************************************************  02620000
026300 2400-CHECK-KEY-VALUES.                                           02630000
026400                                                                  02640000
026500     MOVE '2400-CHECK-KEY-VALUES ' TO PV-ABEND-PARAGRAPH.         02650000
026600                                                                  02660000
026700     EVALUATE TRUE                                                02670000
026800         WHEN XL019-SKU-NBR OF PV-RMS-INPUT <                     02680000
026900              XL019-SKU-NBR OF PV-LEGACY-INPUT                    02690000
027000           IF XL019-ORD-QTY OF PV-RMS-INPUT  = '00000000.0000' AND02700051
027200              XL019-CNCLD-QTY OF PV-RMS-INPUT = '00000000.0000'   02710051
030600                 PERFORM 1000-READ-RMS-INPUT                      02720051
028000           ELSE                                                   02730051
027500              ADD 1 TO PV-RECORDS-ON-RMS-ONLY                     02750000
027600              SET XL023-ON-RMS-ONLY TO TRUE                       02760000
027700              PERFORM 3400-WRITE-RMS-ERROR                        02770000
027900              PERFORM 1000-READ-RMS-INPUT                         02790000
028000            END-IF                                                02791051
028000                                                                  02800000
028100         WHEN XL019-SKU-NBR OF PV-RMS-INPUT >                     02810000
028200              XL019-SKU-NBR OF PV-LEGACY-INPUT                    02820000
028300              ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                  02830000
028400              SET XL023-ON-LEGACY-ONLY TO TRUE                    02840000
028500              PERFORM 4000-WRITE-LEGACY-ERROR                     02850000
028600              PERFORM 1100-READ-LEGACY-INPUT                      02860000
028700                                                                  02870000
028800         WHEN XL019-LOC-NBR OF PV-RMS-INPUT <                     02880000
028900              XL019-LOC-NBR OF PV-LEGACY-INPUT                    02890000
027000           IF XL019-ORD-QTY OF PV-RMS-INPUT  = '00000000.0000' AND02891051
027200              XL019-CNCLD-QTY OF PV-RMS-INPUT = '00000000.0000'   02892051
030600                 PERFORM 1000-READ-RMS-INPUT                      02893051
028000           ELSE                                                   02894051
029000              ADD 1 TO PV-RECORDS-ON-RMS-ONLY                     02900000
029100              SET XL023-ON-RMS-ONLY TO TRUE                       02910000
029200              PERFORM 3400-WRITE-RMS-ERROR                        02920000
029300              PERFORM 1000-READ-RMS-INPUT                         02930000
028000           END-IF                                                 02931051
029400                                                                  02940000
029500         WHEN XL019-LOC-NBR OF PV-RMS-INPUT >                     02950000
029600              XL019-LOC-NBR OF PV-LEGACY-INPUT                    02960000
029700              ADD 1 TO PV-RECORDS-ON-LEGACY-ONLY                  02970000
029800              SET XL023-ON-LEGACY-ONLY TO TRUE                    02980000
029900              PERFORM 4000-WRITE-LEGACY-ERROR                     02990000
030000              PERFORM 1100-READ-LEGACY-INPUT                      03000000
030100                                                                  03010000
030200         WHEN OTHER                                               03020000
030300              ADD 1 TO PV-RECORDS-ON-BOTH                         03030000
030400              IF XL019-DATA-AREA OF PV-RMS-INPUT    =             03040000
030500                 XL019-DATA-AREA OF PV-LEGACY-INPUT               03050000
030600                 PERFORM 1000-READ-RMS-INPUT                      03060000
030700                 PERFORM 1100-READ-LEGACY-INPUT                   03070000
030800              ELSE                                                03080000
030900                 SET XL023-ON-BOTH-RMS-LEGACY TO TRUE             03090000
031000                 PERFORM 3400-WRITE-RMS-ERROR                     03100000
031100                 PERFORM 4000-WRITE-LEGACY-ERROR                  03110000
031200                 PERFORM 1000-READ-RMS-INPUT                      03120000
031300                 PERFORM 1100-READ-LEGACY-INPUT                   03130000
031400              END-IF                                              03140000
031500                                                                  03150000
031600     END-EVALUATE.                                                03160000
031700                                                                  03170000
031800                                                                  03180000
031900***************************************************************** 03190000
032000*  WRITE A RMS RECORD TO THE ERROR FILE                           03200000
032100***************************************************************** 03210000
032200 3400-WRITE-RMS-ERROR.                                            03220000
032300                                                                  03230000
032400     SET XL023-XXT-PO-INBD-ALLOC  TO TRUE.                        03240000
032500     MOVE XL019-PO-NBR    OF PV-RMS-INPUT TO XL023-PO-SORT-KEY-PO.03250000
032600     MOVE XL019-SKU-NBR   OF PV-RMS-INPUT  TO PC-SKU-NBR.         03260000
032700     MOVE XL019-LOC-NBR OF PV-RMS-INPUT    TO PC-LOC-NBR.         03270000
032800     MOVE PC-SORT-KEY     TO XL023-PO-SORT-KEY-DATA.              03280000
032900     INITIALIZE XL023-INBD-ALLOC.                                 03290000
033000                                                                  03300000
033100     MOVE XL019-PO-NBR OF PV-RMS-INPUT    TO                      03310000
033200                         XL023-LO-PO-NBR-RMS.                     03320000
033300     MOVE XL019-SKU-NBR  OF PV-RMS-INPUT TO                       03330000
033400                         XL023-LO-SKU-NBR-RMS.                    03340000
033500     MOVE XL019-LOC-NBR OF PV-RMS-INPUT TO                        03350000
033600                         XL023-LO-LOC-NBR-RMS.                    03360000
033700                                                                  03370000
033800**?? MOVE XL019-LOC-TYP-CDE   OF PV-RMS-INPUT TO                  03380000
033900**??                   XL023-LO-LOC-TYP-CDE-RMS.                  03390000
035500     MOVE XL019-ORD-QTY       OF PV-RMS-INPUT TO                  03550000
035600                       XL023-LO-ORD-QTY-RMS.                      03560000
035700**?? MOVE XL019-ORIG-ORD-QTY  OF PV-RMS-INPUT TO                  03570000
035800**??                   XL023-LO-ORIG-ORD-QTY-RMS.                 03580000
035900     IF XL019-CNCLD-QTY  OF PV-RMS-INPUT(01:8) NUMERIC AND        03590000
036000        XL019-CNCLD-QTY  OF PV-RMS-INPUT(10:4) NUMERIC            03600000
036100         MOVE XL019-CNCLD-QTY   OF PV-RMS-INPUT TO                03610000
036200                         XL023-LO-CNCLD-QTY-RMS                   03620000
036300     ELSE                                                         03630000
036400         MOVE ZEROES TO  XL023-LO-CNCLD-QTY-RMS                   03640000
036500     END-IF.                                                      03650000
036600**?? MOVE XL019-CNCL-CDE      OF PV-RMS-INPUT TO                  03660000
036700**??                   XL023-LO-CNCL-CDE-RMS.                     03670000
036800**?? MOVE XL019-CNCL-DTE      OF PV-RMS-INPUT TO                  03680000
036900**??                   XL023-LO-CNCL-DTE-RMS.                     03690000
037000**?? MOVE XL019-CNCLD-BY-USR-ID    OF PV-RMS-INPUT TO             03700000
037100**??                   XL023-LO-CNCLD-BY-USR-ID-RMS.              03710000
037200     IF XL019-DC-ALLOC-MULT-QTY  OF PV-RMS-INPUT NUMERIC          03720000
037300         MOVE XL019-DC-ALLOC-MULT-QTY  OF PV-RMS-INPUT TO         03730000
037400                        XL023-LO-DC-ALLC-MULT-QTY-RMS             03740000
037500     ELSE                                                         03750000
037600         MOVE ZEROES TO XL023-LO-DC-ALLC-MULT-QTY-RMS             03760000
037700     END-IF.                                                      03770000
037800     IF XL019-STR-ALLOC-MULT-QTY OF PV-RMS-INPUT NUMERIC          03780000
037900         MOVE XL019-STR-ALLOC-MULT-QTY OF PV-RMS-INPUT TO         03790000
038000                         XL023-LO-STR-ALLC-MLT-QTY-RMS            03800000
038100     ELSE                                                         03810000
038200         MOVE ZEROES TO  XL023-LO-STR-ALLC-MLT-QTY-RMS            03820000
038300     END-IF.                                                      03830000
038400     MOVE XL019-ALLOC-RND-CDE      OF PV-RMS-INPUT TO             03840000
038500                       XL023-LO-ALLOC-RND-CDE-RMS.                03850000
038600     MOVE XL019-SHTG-PRRT-OPT-CDE  OF PV-RMS-INPUT TO             03860000
038700                       XL023-LO-SHTG-PRT-OPT-CDE-RMS.             03870000
038800     MOVE XL019-OVRG-PRRT-OPT-CDE  OF PV-RMS-INPUT TO             03880000
038900                       XL023-LO-OVRG-PRT-OPT-CDE-RMS.             03890000
039000     MOVE XL019-EXST-SHTG-THRS-IND OF PV-RMS-INPUT TO             03900000
039100                       XL023-LO-EXT-SHTG-THR-IND-RMS.             03910000
039200                                                                  03920000
039300     IF XL023-ON-BOTH-RMS-LEGACY                                  03930000
039400         CONTINUE                                                 03940000
039500     ELSE                                                         03950000
039600         PERFORM P5000-WRITE-ERROR-RECORD                         03960000
039700     END-IF.                                                      03970000
039800                                                                  03980000
039900***************************************************************** 03990000
040000*  WRITE A LEGACY RECORD TO THE ERROR FILE                        04000000
040100***************************************************************** 04010000
040200 4000-WRITE-LEGACY-ERROR.                                         04020000
040300                                                                  04030000
040400     IF XL023-ON-BOTH-RMS-LEGACY                                  04040000
040500         CONTINUE                                                 04050000
040600     ELSE                                                         04060000
040700         SET XL023-XXT-PO-INBD-ALLOC  TO TRUE                     04070000
040800         MOVE XL019-PO-NBR OF PV-LEGACY-INPUT                     04080000
040900                                        TO XL023-PO-SORT-KEY-PO   04090000
041000         MOVE XL019-SKU-NBR OF PV-LEGACY-INPUT TO PC-SKU-NBR      04100000
041100         MOVE XL019-LOC-NBR OF PV-LEGACY-INPUT TO PC-LOC-NBR      04110000
041200         MOVE PC-SORT-KEY     TO XL023-PO-SORT-KEY-DATA           04120000
041400         INITIALIZE XL023-INBD-ALLOC                              04140000
041500     END-IF.                                                      04150000
041600                                                                  04160000
041700     MOVE XL019-PO-NBR OF PV-LEGACY-INPUT TO                      04170000
041800                              XL023-LO-PO-NBR-LGCY.               04180000
041900     MOVE XL019-SKU-NBR OF PV-LEGACY-INPUT TO                     04190000
042000                              XL023-LO-SKU-NBR-LGCY.              04200000
042100     MOVE XL019-LOC-NBR OF PV-LEGACY-INPUT TO                     04210000
042200                              XL023-LO-LOC-NBR-LGCY.              04220000
042300                                                                  04230000
042400**?? MOVE XL019-LOC-TYP-CDE      OF PV-LEGACY-INPUT TO            04240000
042500**??                   XL023-LO-LOC-TYP-CDE-LGCY                  04250000
043200     MOVE XL019-ORD-QTY          OF PV-LEGACY-INPUT TO            04320000
043300                       XL023-LO-ORD-QTY-LGCY                      04330000
043400**?? MOVE XL019-ORIG-ORD-QTY     OF PV-LEGACY-INPUT TO            04340000
043500**??                   XL023-LO-ORIG-ORD-QTY-LGCY.                04350000
043600     MOVE XL019-CNCLD-QTY        OF PV-LEGACY-INPUT TO            04360000
043700                       XL023-LO-CNCLD-QTY-LGCY.                   04370000
043800**?? MOVE XL019-CNCL-CDE         OF PV-LEGACY-INPUT TO            04380000
043900**??                   XL023-LO-CNCL-CDE-LGCY.                    04390000
044000**?? MOVE XL019-CNCL-DTE         OF PV-LEGACY-INPUT TO            04400000
044100**??                   XL023-LO-CNCL-DTE-LGCY.                    04410000
044200**?? MOVE XL019-CNCLD-BY-USR-ID  OF PV-LEGACY-INPUT TO            04420000
044300**??                   XL023-LO-CNCLD-BY-USR-ID-LGCY.             04430000
044400     MOVE XL019-DC-ALLOC-MULT-QTY  OF PV-LEGACY-INPUT TO          04440000
044500                       XL023-LO-DC-ALLC-MULT-QTY-LGCY.            04450000
044600     MOVE XL019-STR-ALLOC-MULT-QTY OF PV-LEGACY-INPUT TO          04460000
044700                       XL023-LO-STR-ALLC-MLT-QTY-LGCY.            04470000
044800     MOVE XL019-ALLOC-RND-CDE      OF PV-LEGACY-INPUT TO          04480000
044900                       XL023-LO-ALLOC-RND-CDE-LGCY.               04490000
045000     MOVE XL019-SHTG-PRRT-OPT-CDE  OF PV-LEGACY-INPUT TO          04500000
045100                       XL023-LO-SHTG-PRT-OPT-CDE-LGCY.            04510000
045200     MOVE XL019-OVRG-PRRT-OPT-CDE  OF PV-LEGACY-INPUT TO          04520000
045300                       XL023-LO-OVRG-PRT-OPT-CDE-LGCY.            04530000
045400     MOVE XL019-EXST-SHTG-THRS-IND OF PV-LEGACY-INPUT TO          04540000
045500                       XL023-LO-EXT-SHTG-THR-IND-LGCY.            04550000
045600                                                                  04560000
045700     IF XL023-ON-BOTH-RMS-LEGACY                                  04570000
045800         PERFORM 4300-COMPARE                                     04580000
045900     ELSE                                                         04590000
046000         PERFORM P5000-WRITE-ERROR-RECORD                         04600000
046100     END-IF.                                                      04610000
046200                                                                  04620000
046300***************************************************************** 04630000
046400*  COMPARE FIELDS TO FIND DISCREPANCIES.                          04640000
046500***************************************************************** 04650000
046600 4300-COMPARE.                                                    04660000
046700                                                                  04670000
046800     IF XL023-LO-PO-NBR-RMS  NOT = XL023-LO-PO-NBR-LGCY           04680000
046900         MOVE '*'  TO  XL023-LO-PO-NBR-DIFF                       04690000
047000     END-IF.                                                      04700000
047100                                                                  04710000
047200     IF XL023-LO-SKU-NBR-RMS              NOT =                   04720000
047300        XL023-LO-SKU-NBR-LGCY                                     04730000
047400         MOVE '*'  TO  XL023-LO-SKU-NBR-DIFF                      04740000
047500     END-IF.                                                      04750000
047600                                                                  04760000
047700     IF XL023-LO-LOC-NBR-RMS              NOT =                   04770000
047800        XL023-LO-LOC-NBR-LGCY                                     04780000
047900         MOVE '*'  TO  XL023-LO-LOC-NBR-DIFF                      04790000
048000     END-IF.                                                      04800000
048100                                                                  04810000
048200**?? IF XL023-LO-LOC-TYP-CDE-RMS          NOT =                   04820000
048300**??    XL023-LO-LOC-TYP-CDE-LGCY                                 04830000
048400**??     MOVE '*'  TO  XL023-LO-LOC-TYP-CDE-DIFF                  04840000
048500**?? END-IF.                                                      04850000
048600                                                                  04860000
051300* 9/08/2003 - DEANNA BRANTNER                                     04861041
      *  CHANGE MADE: DUE TO SYSTEM DIFFERENCE BETWEEN RMS AND          04862041
      *  LEGACY, IT WAS DECIDED THAT LEGACY WOULD BE THE SYSTEM         04863041
      *  OF RECORD FOR PRICE CHANGES.  THE FOLLOWING 3 FIELDS           04864041
      *  WILL NO LONGER BE CHECKED FOR DATA INTEGRITY.                  04865041
048700*    IF XL023-LO-UNT-RTL-AMT-LGCY = '0000000.00'                  04870041
048800*        MOVE ' '  TO  XL023-LO-UNT-RTL-AMT-DIFF                  04880041
048900*    ELSE                                                         04890041
049000*        IF XL023-LO-UNT-RTL-AMT-RMS      NOT =                   04900041
049100*           XL023-LO-UNT-RTL-AMT-LGCY                             04910041
049200*              MOVE '*'  TO  XL023-LO-UNT-RTL-AMT-DIFF            04920041
049300*        END-IF                                                   04930041
049400*    END-IF.                                                      04940041
049500*                                                                 04950041
049600*    IF XL023-LO-GP-RTL-AMT-LGCY  = '0000000.00'                  04960041
049700*        MOVE ' '  TO  XL023-LO-GP-RTL-AMT-DIFF                   04970041
049800*    ELSE                                                         04980041
049900*        IF XL023-LO-GP-RTL-AMT-RMS       NOT =                   04990041
050000*           XL023-LO-GP-RTL-AMT-LGCY                              05000041
050100*              MOVE '*'  TO  XL023-LO-GP-RTL-AMT-DIFF             05010041
050200*        END-IF                                                   05020041
050300*    END-IF.                                                      05030041
050400*                                                                 05040041
050500*    IF XL023-LO-GP-RTL-QTY-LGCY = '0000000.00'                   05050041
050600*        MOVE ' '  TO  XL023-LO-GP-RTL-QTY-DIFF                   05060041
050700*    ELSE                                                         05070041
050800*        IF XL023-LO-GP-RTL-QTY-RMS       NOT =                   05080041
050900*           XL023-LO-GP-RTL-QTY-LGCY                              05090041
051000*              MOVE '*'  TO  XL023-LO-GP-RTL-QTY-DIFF             05100041
051100*        END-IF                                                   05110041
051200*    END-IF.                                                      05120041
                                                                        05121041
051300* 8/14/2003 - DEANNA BRANTNER                                     05130035
      *  CHANGE MADE: DUE TO SYSTEM DIFFERENCE BETWEEN RMS AND          05131035
      *  LEGACY, WHEN LEGACY CNCLD-QTY = ZERO; THE RMS ORD-QTY          05132035
      *  AND CNCLD-QTY NEED TO BE ADDED TOGETHER TO DETERMINE           05133035
      *  THE TOTAL ORD-QTY AMOUNT.  FRED SCHMELZER HELPED               05134035
      *  DESIGN THIS SOLUTION.                                          05135035
      * 8/20/2003 - DEANNA BRANTNER                                     05136040
      *  PER FRED SCHMELZER AND KAREN WALL, IF RMS AND LGCY ORD-        05137040
      *  QTY DON'T MATCH, ADD THE RMS ORD-QTY AND THE RMS CNCLD-        05138040
      *  QTY TOGETHER AND COMPARE THAT AMOUNT TO THE LEGACY             05139040
      *  ORD-QTY.                                                       05139140
           MOVE 8                       TO DP010I-MAXIMUM-DIGITS.       05150040
           MOVE 4                       TO DP010I-MAXIMUM-DECIMALS.     05151040
           MOVE XL023-LO-ORD-QTY-RMS    TO PV-WORK-QTY.                 05152040
           MOVE PV-WORK-QTY             TO DP010I-UNEDITED-FIELD.       05153040
           PERFORM 6000-NUMERIC-EDIT.                                   05154040
           MOVE DP010I-NUMERIC-FIELD    TO PC-ORD-QTY-AMT-RMS.          05155040
           MOVE 8                       TO DP010I-MAXIMUM-DIGITS.       05156040
           MOVE 4                       TO DP010I-MAXIMUM-DECIMALS.     05157040
           MOVE XL023-LO-CNCLD-QTY-RMS  TO PV-WORK-QTY.                 05158040
           MOVE PV-WORK-QTY             TO DP010I-UNEDITED-FIELD.       05159040
           PERFORM 6000-NUMERIC-EDIT.                                   05159140
           MOVE DP010I-NUMERIC-FIELD    TO PC-CNCLD-QTY-AMT-RMS.        05159240
      *    COMPUTE PV-RMS-ORD-QTY = PC-ORD-QTY-AMT-RMS +                05160099
      *                             PC-CNCLD-QTY-AMT-RMS.               05161099
051400*    IF XL023-LO-CNCLD-QTY-LGCY   = '00000000.0000'               05161199
051600*        MOVE PV-RMS-ORD-QTY TO XL023-LO-ORD-QTY-RMS              05162099
051600*        INITIALIZE PV-RMS-ORD-QTY                                05163043
051700*    END-IF.                                                      05170099
      *  BEFORE RMS WAS IMPLEMENTED, THERE WAS NOT A CANCEL             05170199
      *  QTY SO THE ORDER QTY WAS ALWAYS ADDED TO CANCEL QTY TO GET     05170299
      * THE CURRENT ORDER QTY.   ON LOCATION, WE DO NOT CARE ABOUT ANY  05170399
      * 899 LOCATION NUMBERS (THOSE ARE IN RMS TO MEAN THAT NO LOCATION 05170499
      * HAS BEEN ALLOCATED), THUS, WE DO NOT WANT TO DO ANY COMPARISONS 05170599
      * ON THIS ORDER QTY OR CANCEL QTY.                                05170699
051400     IF XL023-LO-ORD-QTY-RMS        NOT =                         05171040
051500        XL023-LO-ORD-QTY-LGCY                                     05172035
               IF XL023-LO-LOC-NBR-RMS        = 899                     05172199
                 AND XL023-LO-LOC-NBR-LGCY    = 899                     05172299
                   CONTINUE                                             05172399
               ELSE                                                     05172499
051600*          MOVE PV-RMS-ORD-QTY TO XL023-LO-ORD-QTY-RMS            05172599
051600*          INITIALIZE PV-RMS-ORD-QTY                              05172699
051400*          IF XL023-LO-ORD-QTY-RMS    NOT =                       05172799
051500*             XL023-LO-ORD-QTY-LGCY                               05172899
051600                MOVE '*'  TO  XL023-LO-ORD-QTY-DIFF               05173099
051700*          END-IF                                                 05174099
051700*      END-IF                                                     05174199
051700     END-IF.                                                      05175040
051800                                                                  05180000
051900**?? IF XL023-LO-ORIG-ORD-QTY-RMS         NOT =                   05190000
052000**??    XL023-LO-ORIG-ORD-QTY-LGCY                                05200000
052100**??     MOVE '*'  TO  XL023-LO-ORIG-ORD-QTY-DIFF                 05210000
052200**?? END-IF.                                                      05220000
052300*                                                                 05230000
052400*LMM                                                              05240000
052500*AS OF 7/22/03 - DETERMINED THAT RMS PROVIDES US WITH             05250000
052600*THE CANCELLED QUANTITY BY LOCATION BUT LEGACY IS UNABLE          05260000
052700*TO PROVIDE BY LOCATION.                                          05270000
052800*                                                                 05280000
      *AS OF 10/04 XL023-LO-CNCLD-QTY CHECK REACTIVATED                 05281063
      *AS OF 01/05/2005 BYPASS 899 LOC NBR FOR CNCLD-QTY-RMS            05282099
      *  BEFORE RMS WAS IMPLEMENTED, THERE WAS NOT A CANCEL             05283099
      *  QTY SO THE ORDER QTY WAS ALWAYS ADDED TO CANCEL QTY TO GET     05284099
      * THE CURRENT ORDER QTY.   ON LOCATION, WE DO NOT CARE ABOUT ANY  05285099
      * 899 LOCATION NUMBERS (THOSE ARE IN RMS TO MEAN THAT NO LOCATION 05286099
      * HAS BEEN ALLOCATED), THUS, WE DO NOT WANT TO DO ANY COMPARISONS 05287099
      * ON THIS ORDER QTY OR CANCEL QTY.                                05288099
052900     IF XL023-LO-CNCLD-QTY-RMS            NOT =                   05290063
053000        XL023-LO-CNCLD-QTY-LGCY                                   05300063
               IF XL023-LO-LOC-NBR-RMS        = 899                     05300199
                 AND XL023-LO-LOC-NBR-LGCY    = 899                     05300299
                   CONTINUE                                             05300399
               ELSE                                                     05300499
                 IF XL023-LO-PO-NBR-RMS       = XL023-LO-PO-NBR-LGCY    05300599
                   AND XL023-LO-SKU-NBR-RMS   = XL023-LO-SKU-NBR-LGCY   05300699
                   AND XL023-LO-LOC-NBR-RMS   = XL023-LO-LOC-NBR-LGCY   05300799
                     PERFORM 7000-UPD-TALLPLN-CNCL-QTY                  05301099
                 ELSE                                                   05302099
053100               MOVE '*'  TO  XL023-LO-CNCLD-QTY-DIFF              05310099
                 END-IF                                                 05310199
               END-IF                                                   05311099
053200     END-IF.                                                      05321095
053300                                                                  05330000
053400**?? IF XL023-LO-CNCL-CDE-RMS             NOT =                   05340000
053500**??    XL023-LO-CNCL-CDE-LGCY                                    05350000
053600**??     MOVE '*'  TO  XL023-LO-CNCL-CDE-DIFF                     05360000
053700**?? END-IF.                                                      05370000
053800                                                                  05380000
053900**?? IF XL023-LO-CNCL-DTE-RMS             NOT =                   05390000
054000**??    XL023-LO-CNCL-DTE-LGCY                                    05400000
054100**??     MOVE '*'  TO  XL023-LO-CNCL-DTE-DIFF                     05410000
054200**?? END-IF.                                                      05420000
054300                                                                  05430000
054400**?? IF XL023-LO-CNCLD-BY-USR-ID-RMS      NOT =                   05440000
054500**??    XL023-LO-CNCLD-BY-USR-ID-LGCY                             05450000
054600**??     MOVE '*'  TO  XL023-LO-CNCLD-BY-USR-ID-DIFF              05460000
054700**?? END-IF.                                                      05470000
054800                                                                  05480000
055400**?? THIS CHECK WAS REMOVED PER K. WALL BECAUSE NO ONE USES       05540000
055400**?? THE INFORMATION.  8/6  DEANNA BRANTNER                       05540100
055400**?? IF XL023-LO-STR-ALLC-MLT-QTY-RMS     NOT =                   05541000
055500**??    XL023-LO-STR-ALLC-MLT-QTY-LGCY                            05550000
055600**??     MOVE '*'  TO  XL023-LO-STR-ALLC-MLT-QTY-DIFF             05560000
055700**?? END-IF.                                                      05570000
055800                                                                  05580000
055400*  DUE TO SYSTEM DESIGN MISMATCHES BETWEEN RMS AND LEGACY         05586039
055400*  PER JACK KRAMER, IF SHTG-PRT-OPT-CDE-RMS, OVRG-PRT-            05587039
055400*  OPT-CDE-RMS, AND EXT-SHTG-THR-IND-RMS = SPACES, DON'T          05588039
055400*  DO DATA INTEGRITY ON THOSE FIELDS PLUS ALLOC-RND-CDE           05589039
055400*  AND DC-ALLC-MULT-QTY .  DEANNA BRANTNER 8/18/03                05589139
056700     IF XL023-LO-SHTG-PRT-OPT-CDE-RMS  = ' ' AND                  05589239
057100        XL023-LO-OVRG-PRT-OPT-CDE-RMS  = ' ' AND                  05589339
057500        XL023-LO-EXT-SHTG-THR-IND-RMS  = ' '                      05589439
                  CONTINUE                                              05589539
           ELSE                                                         05589639
      *CLP 08/04/14 START                                               05589799
054900*        IF XL023-LO-DC-ALLC-MULT-QTY-RMS     NOT =               05589899
055000*           XL023-LO-DC-ALLC-MULT-QTY-LGCY                        05589999
055100*               MOVE '*'  TO  XL023-LO-DC-ALLC-MULT-QTY-DIFF      05590099
055200*        END-IF                                                   05590199
055900*        IF XL023-LO-ALLOC-RND-CDE-RMS        NOT =               05591099
056000*           XL023-LO-ALLOC-RND-CDE-LGCY                           05600099
056100*            MOVE '*'  TO  XL023-LO-ALLOC-RND-CDE-DIFF            05610099
056200*        END-IF                                                   05620099
      *CLP 08/04/14 END                                                 05630099
056            IF XL023-LO-DC-ALLC-MULT-QTY-RMS > 0 OR                  05640039
056500            XL023-LO-STR-ALLC-MLT-QTY-RMS > 0 OR                  05650039
056600            XL023-LO-ALLOC-RND-CDE-RMS    > SPACES                05660039
056700            IF (XL023-LO-SHTG-PRT-OPT-CDE-RMS = ' ') AND          05670044
056800              (XL023-LO-SHTG-PRT-OPT-CDE-LGCY = 'X' OR 'S')       05680044
056900                   MOVE ' '  TO  XL023-LO-SHTG-PRT-OPT-CDE-DIFF   05680144
056700            ELSE                                                  05681044
056700                IF XL023-LO-SHTG-PRT-OPT-CDE-RMS     NOT =        05681144
056800                   XL023-LO-SHTG-PRT-OPT-CDE-LGCY                 05682044
056900                      MOVE '*'  TO  XL023-LO-SHTG-PRT-OPT-CDE-DIFF05690044
057000                END-IF                                            05700044
057000            END-IF                                                05701044
057100            IF (XL023-LO-OVRG-PRT-OPT-CDE-RMS = ' ')  AND         05710044
057200               (XL023-LO-OVRG-PRT-OPT-CDE-LGCY = 'X' OR 'S')      05720044
057300                   MOVE ' '  TO  XL023-LO-OVRG-PRT-OPT-CDE-DIFF   05730044
057400            ELSE                                                  05740044
057100                IF XL023-LO-OVRG-PRT-OPT-CDE-RMS     NOT =        05741044
057200                   XL023-LO-OVRG-PRT-OPT-CDE-LGCY                 05742044
057300                      MOVE '*'  TO  XL023-LO-OVRG-PRT-OPT-CDE-DIFF05743044
057400                END-IF                                            05744044
057400            END-IF                                                05745044
057500            IF XL023-LO-EXT-SHTG-THR-IND-RMS     NOT =            05750039
057600               XL023-LO-EXT-SHTG-THR-IND-LGCY                     05760039
057700                   MOVE '*'  TO  XL023-LO-EXT-SHTG-THR-IND-DIFF   05770039
057800            END-IF                                                05780039
057900         END-IF                                                   05790039
057900     END-IF.                                                      05791039
058000                                                                  05800000
058100     IF  XL023-LO-PO-NBR-DIFF              = '*' OR               05810000
058200         XL023-LO-SKU-NBR-DIFF             = '*' OR               05820000
058300         XL023-LO-LOC-NBR-DIFF             = '*' OR               05830000
058700         XL023-LO-ORD-QTY-DIFF             = '*' OR               05870000
058800         XL023-LO-CNCLD-QTY-DIFF           = '*' OR               05880000
058900         XL023-LO-DC-ALLC-MULT-QTY-DIFF    = '*' OR               05890000
059000*        XL023-LO-STR-ALLC-MLT-QTY-DIFF    = '*' OR               05900000
059100         XL023-LO-ALLOC-RND-CDE-DIFF       = '*' OR               05910000
059200         XL023-LO-SHTG-PRT-OPT-CDE-DIFF    = '*' OR               05920000
059300         XL023-LO-OVRG-PRT-OPT-CDE-DIFF    = '*' OR               05930000
059400         XL023-LO-EXT-SHTG-THR-IND-DIFF    = '*'                  05940000
059500                                                                  05950000
059600         ADD 1 TO PV-RECORDS-DATA-MISMATCH                        05960000
059700         PERFORM P5000-WRITE-ERROR-RECORD                         05970000
059800     END-IF.                                                      05980000
059900                                                                  05990000
060000 P5000-WRITE-ERROR-RECORD.                                        06000000
060100                                                                  06010000
060200     ADD +1 TO PV-RECORDS-WRITTEN.                                06020000
060300     WRITE ERROR-RECORD FROM PV-ERROR-OUTPUT.                     06030000
060400                                                                  06040000
060500*    SET SWITCH FOR E-MAIL NOTIFICATION OF ERROR.                 06050000
060600*    SET PS-EMAIL-YES       TO TRUE.                              06060000
060700                                                                  06070000
      *************************************                             06080037
      * NUMERIC EDIT ROUTINE.                                           06090037
      *************************************                             06100037
240300 6000-NUMERIC-EDIT.                                               06110037
240700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      06120037
240800     CALL DP010I-NUMERIC-EDIT-ROUTINE                             06130037
240900          USING DP010I-NUMERIC-EDIT-AREA                          06140037
241000     IF  DP010I-ERROR-DETECTED                                    06150037
241100         MOVE ZEROES    TO PV-WORK-QTY                            06160037
241200     END-IF.                                                      06170037
241300                                                                  06180037
080700 7000-UPD-TALLPLN-CNCL-QTY.                                       06190066
           SET PS-DONE-NO        TO TRUE.                               06190172
186400     INITIALIZE XL001-ITEM-COMMAREA.                              06191066
           MOVE XL019-SKU-NBR OF PV-RMS-INPUT                           06192089
                                 TO XL001-KEY-SKU                       06193089
           SET  XL001-BY-NUMERIC-SKU                                    06194067
                XL001-SELECT-SKU TO TRUE                                06195098
           CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA                 06196067
           IF XL001-SUCCESSFUL                                          06200068
               PERFORM 7010-GET-LINE-NBR                                06200171
           ELSE                                                         06200271
               MOVE '*'           TO  XL023-LO-CNCLD-QTY-DIFF           06200388
               SET PS-DONE-YES    TO TRUE                               06200477
               MOVE XL001-SKU-SQLCODE                                   06200577
                                  TO PV-SQLCODE                         06200678
419500         DISPLAY '** 7000-UPD-TALLPLN-CNCL-QTY ERROR'             06200778
419500         DISPLAY '** CALL TO XLKUT001 - XLT_SKU'                  06200880
719600         DISPLAY '** SQLCODE : '  PV-SQLCODE                      06200980
419700         DISPLAY '** PO NBR  : ' XL019-PO-NBR OF PV-RMS-INPUT     06201090
419700         DISPLAY '** SKU NBR : ' XL019-SKU-NBR OF PV-RMS-INPUT    06201190
           END-IF.                                                      06201280
           IF PS-DONE-NO                                                06201381
               PERFORM 7020-UPDATE-TALLPLN                              06201481
           END-IF.                                                      06201599
                                                                        06201680
       7010-GET-LINE-NBR.                                               06201780
010000     MOVE XL019-PO-NBR OF PV-RMS-INPUT                            06201894
                                    TO DK-PO-NBR                        06201994
009200     EXEC SQL                                                     06202073
009400         SELECT DISTINCT                                          06203073
009500               PO_LNE_NBR                                         06204073
                 INTO                                                   06205073
                     :PURITM-PO-LNE-NBR                                 06205173
009700           FROM                                                   06206073
009800               TPURITM                                            06207073
009900          WHERE                                                   06208073
010000                PO_NBR         = :DK-PO-NBR                       06209094
010200            AND VER_STATUS_CDE = 'A'                              06209273
010200            AND ITM_NBR        = :XL001-ITM-NBR                   06209399
010300     END-EXEC                                                     06209473
           IF SQLCODE NOT = ZERO                                        06209573
               MOVE '*'           TO  XL023-LO-CNCLD-QTY-DIFF           06209688
               SET PS-DONE-YES    TO TRUE                               06209776
419400         MOVE SQLCODE       TO PV-SQLCODE                         06209876
               MOVE XL001-ITM-NBR TO PV-ITM-NBR                         06209976
419500         DISPLAY '** 7010-GET-LINE-NBR ERROR'                     06210076
419500         DISPLAY '** TPURITM'                                     06210180
719600         DISPLAY '** SQLCODE : '  PV-SQLCODE                      06210280
419700         DISPLAY '** PO NBR  : ' XL019-PO-NBR OF PV-RMS-INPUT     06211091
               DISPLAY '** ITEM NBR: ' PV-ITM-NBR                       06211180
           END-IF.                                                      06212099
                                                                        06220069
       7020-UPDATE-TALLPLN.                                             06260081
081700     MOVE XL023-LO-CNCLD-QTY-RMS (1:8)                            06261096
                                        TO PV-DC-SPLT-CNCLD-QTY         06261199
082100     MOVE XL019-LOC-NBR OF PV-RMS-INPUT                           06261299
                                        TO DK-DEST-NBR                  06261397
081500*    EXEC SQL                                                     06270099
081600*        UPDATE TALLPLN                                           06280099
081700*        SET DC_SPLT_CNCLD_QTY    = :PV-DC-SPLT-CNCLD-QTY         06290099
081800*        WHERE                                                    06300099
081900*            PO_NBR               = :DK-PO-NBR                    06310099
082000*        AND PO_LNE_NBR           = :PURITM-PO-LNE-NBR            06320099
082100*        AND DEST_NBR             = :DK-DEST-NBR                  06330099
      *                                                                 06331099
082200*    END-EXEC.                                                    06340099
418900     EVALUATE SQLCODE                                             06341057
419000         WHEN 0                                                   06342057
419100              CONTINUE                                            06343057
419300         WHEN OTHER                                               06345057
                    MOVE '*'               TO  XL023-LO-CNCLD-QTY-DIFF  06345188
419400              MOVE SQLCODE           TO PV-SQLCODE                06346088
                    MOVE PURITM-PO-LNE-NBR TO PV-PO-LNE-NBR             06346183
419500              DISPLAY '7100-UPD-TALLPLN-CNCL-QTY ERROR - '        06347082
419600              DISPLAY 'SQLCODE : ' PV-SQLCODE                     06348085
419700              DISPLAY 'PO NBR  : ' XL019-PO-NBR OF PV-RMS-INPUT   06349099
419700              DISPLAY 'LINE NBR: ' PV-PO-LNE-NBR                  06349183
                    DISPLAY 'LOCATION: ' XL019-LOC-NBR OF PV-RMS-INPUT  06349299
082300     END-EVALUATE.                                                06350099
