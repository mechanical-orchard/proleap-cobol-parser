000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.    PCKUT023.                                         00050099
000600 AUTHOR.        TOM BOYD                                          00060099
000700 INSTALLATION.  KOHLS.                                            00070099
000800 DATE-WRITTEN   JULY 2002.                                        00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*** ON 12/12/2013, MADE CODE CHANGES TO THE PROGRAM TO DEAL    ***00120099
001300*** THE I AND C PACKAGE CODE NO LONGER BEING USED AS PART OF   ***00130099
001400*** THE NEW PO APPLICATION.  SEE PROGRAM DOC FOR SPECIFICS.    ***00140099
001500*** PROGRAM PCKRC023 IS ANOTHER VERSION OF THIS CODE THAT      ***00150099
001600*** CONTAINS A BUNCH OF DISPLAYS WHICH CAN BE USED TO TROUBLE  ***00160099
001700*** SHOOT ANY POSSIBLE ISSUES (PCKRC023 CAN BE FOUND IN THE    ***00170099
001800*** TEST SOURCE LIBRARY).                                      ***00180099
001900******************************************************************00190099
002000                                                                  00200099
002100******************************************************************00210099
002200* THIS PROGRAM TAKES IN THE SORTED FILE AND REFORMATS THE DATA    00220099
002300* TO A NEW LAYOUT(PCRD022).  IT WILL ALSO ACCESS SOME TABLES TO   00230099
002400* GATHER MORE INFORMATION WHICH COULD NOT BE RETRIEVED FROM THE   00240099
002500* FILE. THE OUTPUT FILE FROM THIS PROGRAM WILL BE FTP'D TO A      00250099
002600* SERVER, THE DC'S WILL HAVE THE ABILITY TO ACCESS THIS FILE AND  00260099
002700* UPDATE THE YARD MANAGEMENT SYSTEM                               00270099
002800******************************************************************00280099
002900                                                                  00290099
003000******************************************************************00300099
003100 ENVIRONMENT DIVISION.                                            00310099
003200******************************************************************00320099
003300                                                                  00330099
003400 CONFIGURATION SECTION.                                           00340099
003500                                                                  00350099
003600 SOURCE-COMPUTER.        IBM-3090.                                00360099
003700 OBJECT-COMPUTER.        IBM-3090.                                00370099
003800                                                                  00380099
003900 INPUT-OUTPUT SECTION.                                            00390099
004000                                                                  00400099
004100 FILE-CONTROL.                                                    00410099
004200                                                                  00420099
004300     SELECT INPUT-FILE                                            00430099
004400         ASSIGN TO INP4.                                          00440099
004500                                                                  00450099
004600     SELECT OUTPUT-FILE                                           00460099
004700         ASSIGN TO OUT4.                                          00470099
004800                                                                  00480099
004900******************************************************************00490099
005000 DATA DIVISION.                                                   00500099
005100******************************************************************00510099
005200                                                                  00520099
005300 FILE SECTION.                                                    00530099
005400                                                                  00540099
005500 FD  INPUT-FILE                                                   00550099
005600     RECORDING MODE IS F                                          00560099
005700     LABEL RECORDS ARE STANDARD                                   00570099
005710*** PRB0064829 start                                              00571099
005800*    RECORD CONTAINS 150                                          00580099
005810     RECORD CONTAINS 200                                          00581099
005900     BLOCK CONTAINS 0 RECORDS                                     00590099
006000     DATA RECORD IS INPUT-RECORD.                                 00600099
006100                                                                  00610099
006200*01  INPUT-RECORD              PIC  X(150).                       00620099
006210 01  INPUT-RECORD              PIC  X(200).                       00621099
006220*** PRB0064829 end                                                00622099
006300                                                                  00630099
006400 FD  OUTPUT-FILE                                                  00640099
006500     RECORDING MODE IS F                                          00650099
006600     LABEL RECORDS ARE STANDARD                                   00660099
006700     RECORD CONTAINS 254                                          00670099
006800     BLOCK CONTAINS 0 RECORDS                                     00680099
006900     DATA RECORD IS OUTPUT-RECORD.                                00690099
007000                                                                  00700099
007100 01  OUTPUT-RECORD             PIC  X(254).                       00710099
007200                                                                  00720099
007300******************************************************************00730099
007400 WORKING-STORAGE SECTION.                                         00740099
007500******************************************************************00750099
007600 01  PS-PROGRAM-SWITCHES.                                         00760099
007700     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00770099
007800         88  PS-EOF-INPUT                        VALUE 'Y'.       00780099
007900         88  PS-NOT-EOF-INPUT                    VALUE 'N'.       00790099
008000     05  PS-LINE-CRTN-UNKWN-SW        PIC X(01)  VALUE 'N'.       00800099
008100         88  PS-LINE-CRTN-KNWN                   VALUE 'Y'.       00810099
008200         88  PS-LINE-CRTN-UKNWN                  VALUE 'N'.       00820099
008300     05  PS-PACK-BY-STORE-SW          PIC X(01)  VALUE 'N'.       00830099
008400         88  PS-PACK-BY-STORE                    VALUE 'Y'.       00840099
008500         88  PS-NOT-PACK-BY-STORE                VALUE 'N'.       00850099
008600     05  PS-MIXED-PRESENT-SW          PIC X(01)  VALUE 'N'.       00860099
008700         88  PS-MIXED                            VALUE 'Y'.       00870099
008800         88  PS-NOT-MIXED                        VALUE 'N'.       00880099
008900     05  PS-JEWELRY-DEPT-SW           PIC X(01)  VALUE 'N'.       00890099
009000         88  PS-JEWELRY-DEPT                     VALUE 'Y'.       00900099
009100         88  PS-NOT-JEWELRY-DEPT                 VALUE 'N'.       00910099
009200     05  PS-P2L-ZONE                  PIC X(02).                  00920099
009300         88 PS-COMMODITY                         VALUE 'CM'.      00930099
009400         88 PS-HANG-FOLD                         VALUE 'HF'.      00940099
009500         88 PS-HANG-COMMODITY                    VALUE 'HC'.      00950099
009600     05  PS-P2L-AS-HNGFLD-SW          PIC X(02).                  00960099
009700         88 PS-P2L-AS-HNGFLD-YES                 VALUE 'Y'.       00970099
009800         88 PS-P2L-AS-HNGFLD-NO                  VALUE 'N'.       00980099
009900     05  PS-HANGER-IND                PIC X(01).                  00990099
010000         88 PS-HANGER-AGREEMENT                  VALUE 'Y'.       01000099
010100     05  PS-FULFILLMENT-IND           PIC X(01)  VALUE 'N'.       01010099
010200         88 PS-FULFILLMENT-CENTER                VALUE 'Y'.       01020099
010300         88 PS-FULFILLMENT-CENTER-NO             VALUE 'N'.       01030099
010400     05  PS-INBOUND-FOUND-SW          PIC X(01)  VALUE 'N'.       01040099
010500         88 PS-INBOUND-FOUND                     VALUE 'Y'.       01050099
010600         88 PS-INBOUND-NOT-FOUND                 VALUE 'N'.       01060099
010700     05  PS-CASE-GT-SW                PIC X(01)  VALUE 'N'.       01070099
010800         88 PS-CASE-GT-FOUND                     VALUE 'Y'.       01080099
010900         88 PS-CASE-GT-NOT-FOUND                 VALUE 'N'.       01090099
011000     05  PS-INNER-OUTER-SW            PIC X(01)  VALUE 'N'.       01100099
011100         88 PS-INNER-OUTER-EQUAL                 VALUE 'Y'.       01110099
011200         88 PS-INNER-OUTER-NOT-EQUAL             VALUE 'N'.       01120099
011300                                                                  01130099
011400 01  PC-PROGRAM-CONSTANTS.                                        01140099
011500     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'PCKUT023'. 01150099
011600     05  PC-BULK                      PIC X(04) VALUE 'BULK'.     01160099
011700     05  PC-MULTI                     PIC X(05) VALUE 'MULTI'.    01170099
011800     05  PC-CASE                      PIC X(04) VALUE 'CASE'.     01180099
011900     05  PC-SINGLE                    PIC X(06) VALUE 'SINGLE'.   01190099
012000     05  PC-INNER                     PIC X(05) VALUE 'INNER'.    01200099
012100     05  PC-HANG                      PIC X(04) VALUE 'HANG'.     01210099
012200     05  PC-FOLD                      PIC X(04) VALUE 'FOLD'.     01220099
012300     05  PC-MIXED                     PIC X(05) VALUE 'MIXED'.    01230099
012400     05  PC-PBS                       PIC X(03) VALUE 'PBS'.      01240099
012500     05  PC-FCSE                      PIC X(04) VALUE 'FCSE'.     01250099
012600     05  PC-FCS-P2L                   PIC X(07) VALUE 'FCS&P2L'.  01260099
012700     05  PC-P2L                       PIC X(03) VALUE 'P2L'.      01270099
012800     05  PC-CNFRMN-TMST               PIC X(26) VALUE             01280099
012900                                     '9999-09-09-09.09.09.999999'.01290099
013000     05  PC-DEFAULT-TMST              PIC X(26) VALUE             01300099
013100                                     '9999-99-99-99.99.99.999999'.01310099
013200     05  PC-A                         PIC X(01) VALUE 'A'.        01320099
013300     05  PC-B                         PIC X(01) VALUE 'B'.        01330099
013400     05  PC-C                         PIC X(01) VALUE 'C'.        01340099
013500     05  PC-I                         PIC X(01) VALUE 'I'.        01350099
013600     05  PC-M                         PIC X(01) VALUE 'M'.        01360099
013700     05  PC-N                         PIC X(01) VALUE 'N'.        01370099
013800     05  PC-S                         PIC X(01) VALUE 'S'.        01380099
013900     05  PC-Y                         PIC X(01) VALUE 'Y'.        01390099
014000                                                                  01400099
014100 01  PV-PROGRAM-VARIABLES.                                        01410099
014200     05  PV-DEPT-HOLD                 PIC  X(03).                 01420099
014300     05  PV-DEPT-HOLD-R REDEFINES  PV-DEPT-HOLD.                  01430099
014400         10  PV-DEPT-NUM              PIC 9(03).                  01440099
014500     05  PV-ATTR-DEPT                 PIC  S9(10)V9(5) COMP-3.    01450099
014600     05  PV-RECORDS-READ              PIC 9(09)     VALUE ZERO.   01460099
014700     05  PV-RECORDS-WRITTEN           PIC 9(09)     VALUE ZERO.   01470099
014710     05  PV-PREV-COUNT                PIC 9(09)     VALUE ZERO.   01471099
014720     05  PV-SQL-COUNT                 PIC 9(09)     VALUE ZERO.   01472099
014800     05  PV-PO-REC-CNT                PIC 9(04)     VALUE 1.      01480099
014900     05  PV-NBR-PO-LINES              PIC 9(06)     VALUE 1.      01490099
015000     05  PV-PKSLP-ITM-QTY             PIC 9(06)     VALUE ZERO.   01500099
015100     05  PV-PKSLP-ITM-QTY-SAVE        PIC 9(06)     VALUE ZERO.   01510099
015200     05  PV-DISPLAY-OPER              PIC 9(04)     VALUE ZERO.   01520099
015300     05  PV-DISPLAY-PO                PIC 9(09)     VALUE ZERO.   01530099
015400     05  PV-DISPLAY-REC-SEQ-NBR       PIC 9(09)     VALUE ZERO.   01540099
015500     05  PV-DISPLAY-PO-LINE-NBR       PIC 9(09)     VALUE ZERO.   01550099
015600     05  PV-DISPLAY-ITEM-NBR          PIC 9(18)     VALUE ZERO.   01560099
015700     05  PV-DISPLAY-ERROR-NBR         PIC 9(02)     VALUE ZERO.   01570099
015800     05  PV-DISPLAY-LOC-NBR           PIC 9(04)     VALUE ZERO.   01580099
015900     05  PV-DISPLAY-FIELD             PIC ZZZZZZZZ9 VALUE ZERO.   01590099
016000     05  PV-DISPLAY-FIELD-2           PIC ZZZZZZZZ9 VALUE ZERO.   01600099
016100     05  PV-DISPLAY-FIELD-3           PIC ZZZZZZZZ9 VALUE ZERO.   01610099
016200     05  PV-PKGNG-CDE                 PIC X(06)     VALUE SPACE.  01620099
016300     05  PV-PACK-BY-STORE             PIC X(01)     VALUE SPACE.  01630099
016400     05  PV-FCSE-INPK-CART-CNT        PIC X(08)     VALUE ZERO.   01640099
016500     05  PV-FCSE-INPK-CART-CNT-R REDEFINES PV-FCSE-INPK-CART-CNT. 01650099
016600         10 PV-FCSE-INPK-CART-CNT-NBR PIC 9(08).                  01660099
016700                                                                  01670099
016800     05  PV-P2L-CART-CNT              PIC X(08)     VALUE ZERO.   01680099
016900     05  PV-P2L-CART-CNT-R       REDEFINES PV-P2L-CART-CNT.       01690099
017000         10 PV-P2L-CART-CNT-NBR       PIC 9(08).                  01700099
017100                                                                  01710099
017200     05  PV-PRESENT-CDE               PIC X(05)     VALUE SPACE.  01720099
017300     05  PV-CALL-PRESENT-CDE          PIC X(05)     VALUE SPACE.  01730099
017400     05  PV-JEWELRY-DEPT              PIC 9(03).                  01740099
017500     05  PV-ORD-LNE-NBR               PIC X(09)     VALUE SPACE.  01750099
017600     05  PV-CRSDCK-UNIT-CT            PIC 9(06)     VALUE ZERO.   01760099
017700     05  PV-CRSDCK-CRTN-CT            PIC 9(06)     VALUE ZERO.   01770099
017800     05  PV-P2L-UNIT-CT               PIC 9(06)     VALUE ZERO.   01780099
017900     05  PV-P2L-CRTN-CT               PIC 9(06)     VALUE ZERO.   01790099
018000     05  PV-HRTW-UNIT-CT              PIC 9(06)     VALUE ZERO.   01800099
018100     05  PV-HRTW-CRTN-CT              PIC 9(06)     VALUE ZERO.   01810099
018200     05  PV-JWLRY-UNIT-QTY            PIC 9(06)     VALUE ZERO.   01820099
018300     05  PV-DISTDT-SUM-FCSE           PIC 9(06)     VALUE ZERO.   01830099
018400     05  PV-DISTDT-SUM-P2L            PIC 9(06)     VALUE ZERO.   01840099
018500     05  PV-DISTHD-FCSE-CART-CNT      PIC 9(06)     VALUE ZERO.   01850099
018600     05  PV-DISTDT-SUM-FCSE-ST        PIC X(06)     VALUE ZERO.   01860099
018700     05  PV-DISTDT-SUM-P2L-ST         PIC X(06)     VALUE ZERO.   01870099
018800     05  PV-INBOUND-CARTON-CNT        PIC S9(07)    VALUE ZERO    01880099
018900                                                     COMP.        01890099
019000     05  PV-DISTHD-FCSE-CART-CNT-ST   PIC S9(07)    VALUE ZERO    01900099
019100                                                     COMP.        01910099
019200     05  PV-SUM-CRTN-CT               PIC 9(06)     VALUE ZERO.   01920099
019300     05  PV-TOT-CRTN-CT               PIC 9(06)     VALUE ZERO.   01930099
019400     05  PV-RECITM-CASE-PACK-QTY      PIC  S9(9)V   VALUE ZERO    01940099
019500                                                    COMP-3.       01950099
019600                                                                  01960099
019700     05  PV-HANG-COUNT                PIC S9(09)  COMP.           01970099
019800     05  PV-FOLD-COUNT                PIC S9(09)  COMP.           01980099
019900     05  PV-COMMODITY-COUNT           PIC S9(09)  COMP.           01990099
020000     05  PV-OTHER-COUNT               PIC S9(09)  COMP.           02000099
020100     05  PV-P2L-ZONE                  PIC X(14).                  02010099
020200         88 PV-COMMODITY                 VALUE 'COMMODITY     '.  02020099
020300         88 PV-HANG-FOLD                 VALUE 'HANG/FOLD     '.  02030099
020400         88 PV-HANG-COMMODITY            VALUE 'HANG/COMMODITY'.  02040099
020500     05  PV-WST-STORE-ZONE            PIC X(05).                  02050099
020600     05  PV-DISPLAY-PO-NBR            PIC 9(09) VALUE ZEROS.      02060099
020700     05  PV-DISPLAY-RCVR-SEQ          PIC 9(04) VALUE ZEROS.      02070099
020800     05  PV-DISPLAY-LINE-NBR          PIC 9(04) VALUE ZEROS.      02080099
020900                                                                  02090099
021000* RPK 12/12/2013:  ADDED THE FOLLOWING FIELDS:                    02100099
021100 01  PV-CALC-CARTON-VARIABLES.                                    02110099
021200     05  PV-CC-PKSL-ITM-QTY           PIC S9(08) COMP VALUE ZERO. 02120099
021300     05  PV-CC-OUTER-QTY              PIC S9(08) COMP VALUE ZERO. 02130099
021400     05  PV-CC-CRTN-QTY               PIC S9(08) COMP VALUE ZERO. 02140099
021500     05  PV-CC-CRTN-REMAINDER         PIC S9(08) COMP VALUE ZERO. 02150099
021600* RPK 12/12/2013:  ADDED THE ABOVE FIELDS:                        02160099
021700                                                                  02170099
021800 01  PV-EXTRA-HOST-VARIABLES.                                     02180099
021900     05  PV-DB2-DISTHD-FCSE-CART-CNT  PIC S9(08) COMP VALUE ZERO. 02190099
022000     05  PV-DB2-DISTHD-P2L-CART-CNT   PIC S9(08) COMP VALUE ZERO. 02200099
022100 01  PV-PREV-RECORD.                                              02210099
022200     05  PV-PREV-OPER-UNT-ID          PIC 9(04) VALUE ZERO.       02220099
022300     05  PV-PREV-PO-NBR               PIC 9(08) VALUE ZERO.       02230099
022400     05  PV-PREV-REC-SEQ-NBR          PIC 9(04) VALUE ZERO.       02240099
022410     05  PV-PREV-RCVR-OPER-UNT-ID     PIC S9(04) COMP VALUE ZERO. 02241099
022420     05  PV-PREV-RCVR-CDE             PIC X(01) VALUE SPACE.      02242099
022430     05  PV-INTO-OPER-UNT-ID          PIC S9(04) COMP VALUE ZERO. 02243099
022440     05  PV-INTO-LOC-TYP-CDE          PIC X(02) VALUE SPACE.      02244099
022450     05  PV-INTO-E-BUS-IND            PIC X(01) VALUE SPACE.      02245099
022460     05  PV-INTO-FUNC-TXT             PIC X(25) VALUE SPACE.      02246099
022500                                                                  02250099
022600 01  PV-ABEND-FIELDS.                                             02260099
022700     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         02270099
022800                                                 COMP SYNC.       02280099
022900     05  PV-SQLCODE                   PIC  Z(08)9-.               02290099
023000     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02300099
023100     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    02310099
023200     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    02320099
023300     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    02330099
023400     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02340099
023500     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02350099
023600     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02360099
023700     05  PV-DB2-TABLE-NAME-1          PIC  X(15) VALUE SPACE.     02370099
023800     05  PV-DB2-TABLE-NAME-2          PIC  X(15) VALUE SPACE.     02380099
023900     05  PV-DB2-TABLE-NAME-3          PIC  X(15) VALUE SPACE.     02390099
024000     05  PV-DB2-TABLE-NAME-4          PIC  X(15) VALUE SPACE.     02400099
024100                                                                  02410099
024200 01  DN-NULL-INDICATORS.                                          02420099
024300     05  DN-NULL-IND-VEH              PIC S9(04)    VALUE ZERO    02430099
024400                                                     COMP SYNC.   02440099
024500     05  DN-NULL-IND-FCSE             PIC S9(04)    VALUE ZERO    02450099
024600                                                     COMP SYNC.   02460099
024700     05  DN-NULL-IND-P2L              PIC S9(04)    VALUE ZERO    02470099
024800                                                     COMP SYNC.   02480099
024900     05  DN-NULL-FCSE-SPLT            PIC S9(04)    VALUE ZERO    02490099
025000                                                     COMP SYNC.   02500099
025100     05  DN-NULL-P2L-SPLT             PIC S9(04)    VALUE ZERO    02510099
025200                                                     COMP SYNC.   02520099
025210     05  DN-NULL-FUNC-TXT             PIC S9(04)    VALUE ZERO    02521099
025220                                                     COMP SYNC.   02522099
025300 01  DK-DB-KEYS.                                                  02530099
025400     05 DK-PO-NBR                     PIC S9(08) COMP.            02540099
025410*** PRB0064829 start                                              02541099
025500*    05 DK-REC-SEQ-NBR                PIC S9(03) COMP.            02550099
025510     05 DK-REC-SEQ-NBR                PIC S9(04) COMP.            02551099
025520*** PRB0064829 end                                                02552099
025600     05 DK-PO-LINE-NBR                PIC S9(04) COMP.            02560099
025700     05 DK-OPER-UNT-ID                PIC S9(04) COMP.            02570099
025810     05 DK-LOC-NBR                    PIC S9(04) COMP.            02581099
025900     05 DK-IB-PO-NBR                  PIC S9(09) COMP.            02590099
026000     05 DK-IB-REC-SEQ-NBR             PIC S9(04) COMP.            02600099
026100     05 DK-IB-PO-LINE-NBR             PIC S9(09) COMP.            02610099
026110     05 DK-RCVR-OPER-UNT-ID           PIC S9(04) COMP.            02611099
026200                                                                  02620099
026210     05 DK-RECEIVER-OPER              PIC S9(04) COMP.            02621099
026211     05 DK-RECEIVER-FCLTY             PIC S9(04) COMP.            02621199
026220                                                                  02622099
026300                                                                  02630099
026400******************************************************************02640099
026500*  STORE ZONES THAT QUALIFY FOR HANG/FOLD IN PACK-TO-LIGHT       *02650099
026600*  WR-40826 - DMH 7/5/12                                         *02660099
026700******************************************************************02670099
026800 01  PT-HANG-FOLD-ZONE-TABLE.                                     02680099
026900     05  PT-HANG-FOLD-ZONE-ENTRIES OCCURS 50 TIMES INDEXED BY     02690099
027000                         PT-HANG-FOLD-ZONE-IDX.                   02700099
027100         10  PT-HANG-FOLD-ZONE        PIC X(05).                  02710099
027200                                                                  02720099
027300                                                                  02730099
027400                                                                  02740099
027500******************************************************************02750099
027600*  DB2 FORMATTED MESSAGE AREA                                     02760099
027700******************************************************************02770099
027800     COPY DPWS004.                                                02780099
027900*                                                                 02790099
028000******************************************************************02800099
028100*  COPYBOOK PCRD002.                                              02810099
028200******************************************************************02820099
028300     COPY PCRD002.                                                02830099
028400*                                                                 02840099
028500******************************************************************02850099
028600*  COPYBOOK XLWS001.                                              02860099
028700******************************************************************02870099
028800     COPY XLWS001.                                                02880099
028900*                                                                 02890099
029000******************************************************************02900099
029100*  COPYBOOK PCRD022.                                              02910099
029200******************************************************************02920099
029300     COPY PCRD022.                                                02930099
029400*                                                                 02940099
029410******************************************************************02941099
029420*  COPYBOOK POWS055 (USED FOR OTB)                                02942099
029430******************************************************************02943099
029440     COPY POWS055.                                                02944099
029450*                                                                 02945099
029500******************************************************************02950099
029600*  COMMUNICATIONS AREA FOR DB2                                    02960099
029700******************************************************************02970099
029800     EXEC SQL                                                     02980099
029900          INCLUDE SQLCA                                           02990099
030000     END-EXEC.                                                    03000099
030100*                                                                 03010099
030200******************************************************************03020099
030300*    TSHPTPO TABLE                                                03030099
030400******************************************************************03040099
030500     EXEC SQL                                                     03050099
030600          INCLUDE TSHPTPO                                         03060099
030700     END-EXEC.                                                    03070099
030800                                                                  03080099
030900******************************************************************03090099
031000*    TSHIPMT TABLE                                                03100099
031100******************************************************************03110099
031200     EXEC SQL                                                     03120099
031300          INCLUDE TSHIPMT                                         03130099
031400     END-EXEC.                                                    03140099
031500                                                                  03150099
031600******************************************************************03160099
031700*    TVHTRIP TABLE                                                03170099
031800******************************************************************03180099
031900     EXEC SQL                                                     03190099
032000          INCLUDE TVHTRIP                                         03200099
032100     END-EXEC.                                                    03210099
032200                                                                  03220099
032300******************************************************************03230099
032400*   TRECEIV TABLE                                                 03240099
032500******************************************************************03250099
032600     EXEC SQL                                                     03260099
032700          INCLUDE TRECEIV                                         03270099
032800     END-EXEC.                                                    03280099
032900                                                                  03290099
033000/                                                                 03300099
033100******************************************************************03310099
033200*    TMDSEAR TABLE                                                03320099
033300******************************************************************03330099
033400     EXEC SQL                                                     03340099
033500          INCLUDE TMDSEAR                                         03350099
033600     END-EXEC.                                                    03360099
033700                                                                  03370099
033800/                                                                 03380099
033900******************************************************************03390099
034000*    TPURCHS TABLE                                                03400099
034100******************************************************************03410099
034200     EXEC SQL                                                     03420099
034300          INCLUDE TPURCHS                                         03430099
034400     END-EXEC.                                                    03440099
034500                                                                  03450099
034510******************************************************************03451099
034520*    TPLNSHP TABLE                                                03452099
034530******************************************************************03453099
034540     EXEC SQL                                                     03454099
034550          INCLUDE TPLNSHP                                         03455099
034560     END-EXEC.                                                    03456099
034570                                                                  03457099
034600/                                                                 03460099
034700******************************************************************03470099
034800*    TNDSEDP TABLE                                                03480099
034900******************************************************************03490099
035000     EXEC SQL                                                     03500099
035100          INCLUDE TMDSEDP                                         03510099
035200     END-EXEC.                                                    03520099
035300                                                                  03530099
035400/                                                                 03540099
035500******************************************************************03550099
035600*    TDISTHD TABLE                                                03560099
035700******************************************************************03570099
035800     EXEC SQL                                                     03580099
035900          INCLUDE TDISTHD                                         03590099
036000     END-EXEC.                                                    03600099
036100                                                                  03610099
036200/                                                                 03620099
036300******************************************************************03630099
036400*    TDISTDT TABLE                                                03640099
036500******************************************************************03650099
036600     EXEC SQL                                                     03660099
036700          INCLUDE TDISTDT                                         03670099
036800     END-EXEC.                                                    03680099
036900                                                                  03690099
037000/                                                                 03700099
037100******************************************************************03710099
037200*    TPURITM TABLE                                                03720099
037300******************************************************************03730099
037400     EXEC SQL                                                     03740099
037500          INCLUDE TPURITM                                         03750099
037600     END-EXEC.                                                    03760099
037700                                                                  03770099
037800/                                                                 03780099
037900******************************************************************03790099
038000*    TPOPRPK TABLE                                                03800099
038100******************************************************************03810099
038200     EXEC SQL                                                     03820099
038300          INCLUDE TPOPRPK                                         03830099
038400     END-EXEC.                                                    03840099
038500                                                                  03850099
038600/                                                                 03860099
038700******************************************************************03870099
038800*    TRECITM TABLE                                                03880099
038900******************************************************************03890099
039000     EXEC SQL                                                     03900099
039100          INCLUDE TRECITM                                         03910099
039200     END-EXEC.                                                    03920099
039300                                                                  03930099
039400/                                                                 03940099
039500******************************************************************03950099
039600*    TPKSLIP TABLE                                                03960099
039700******************************************************************03970099
039800     EXEC SQL                                                     03980099
039900          INCLUDE TPKSLIP                                         03990099
040000     END-EXEC.                                                    04000099
040100                                                                  04010099
040200/                                                                 04020099
040300******************************************************************04030099
040400*    TINPKSU TABLE                                                04040099
040500******************************************************************04050099
040600     EXEC SQL                                                     04060099
040700          INCLUDE TINPKSU                                         04070099
040800     END-EXEC.                                                    04080099
040900                                                                  04090099
041000/                                                                 04100099
041100******************************************************************04110099
041200*    TSHPUNT TABLE                                                04120099
041300******************************************************************04130099
041400     EXEC SQL                                                     04140099
041500          INCLUDE TSHPUNT                                         04150099
041600     END-EXEC.                                                    04160099
041700                                                                  04170099
041800/                                                                 04180099
041900******************************************************************04190099
042000*    TSHUUPC TABLE                                                04200099
042100******************************************************************04210099
042200     EXEC SQL                                                     04220099
042300          INCLUDE TSHUUPC                                         04230099
042400     END-EXEC.                                                    04240099
042500                                                                  04250099
042600******************************************************************04260099
042700*  SQL AND COBOL DECLARATIONS FOR WST_INTGRTN_TYP                 04270099
042800******************************************************************04280099
042900     EXEC SQL                                                     04290099
043000          INCLUDE WST00008                                        04300099
043100     END-EXEC.                                                    04310099
043200******************************************************************04320099
043300*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_DEFN                   04330099
043400******************************************************************04340099
043500     EXEC SQL                                                     04350099
043600          INCLUDE WST00009                                        04360099
043700     END-EXEC.                                                    04370099
043800******************************************************************04380099
043900*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_ELEM                   04390099
044000******************************************************************04400099
044100     EXEC SQL                                                     04410099
044200          INCLUDE WST00010                                        04420099
044300     END-EXEC.                                                    04430099
044400                                                                  04440099
044500******************************************************************04450099
044600*  SQL AND COBOL DECLARATIONS FOR TKRPRPM                         04460099
044700******************************************************************04470099
044800     EXEC SQL                                                     04480099
044900          INCLUDE TKRPRPM                                         04490099
045000     END-EXEC.                                                    04500099
045100                                                                  04510099
045200******************************************************************04520099
045300*  SQL AND COBOL DECLARATIONS FOR XLT_SKU                         04530099
045400******************************************************************04540099
045500     EXEC SQL                                                     04550099
045600          INCLUDE XLT00003                                        04560099
045700     END-EXEC.                                                    04570099
045800                                                                  04580099
045900******************************************************************04590099
046000*  SQL AND COBOL DECLARATIONS FOR XLT_VND_STYL                    04600099
046100******************************************************************04610099
046200     EXEC SQL                                                     04620099
046300          INCLUDE XLT00004                                        04630099
046400     END-EXEC.                                                    04640099
046500                                                                  04650099
046600******************************************************************04660099
046700*  SQL AND COBOL DECLARATIONS FOR XLT_LOC                         04670099
046800******************************************************************04680099
046900     EXEC SQL                                                     04690099
047000          INCLUDE XLT00010                                        04700099
047100     END-EXEC.                                                    04710099
047200                                                                  04720099
047300******************************************************************04730099
047400*  HANG/FOLD CURSOR - SHOWS THE STORE ZONES TO BE PROCESSED AS   *04740099
047500*  HANG/FOLD IN PACK-TO-LIGHT                                    *04750099
047600******************************************************************04760099
047700     EXEC SQL                                                     04770099
047800         DECLARE HANG-FOLD-CSR CURSOR FOR                         04780099
047900          SELECT                                                  04790099
048000                   E.ATTR_ELEM_TXT  AS STORE_ZONE                 04800099
048100            FROM                                                  04810099
048200                   WST_INTGRTN_TYP  A                             04820099
048300               ,   WST_ATTR_DEFN    B                             04830099
048400               ,   WST_ATTR_ELEM    C                             04840099
048500               ,   WST_ATTR_ELEM    D                             04850099
048600               ,   WST_ATTR_ELEM    E                             04860099
048700               ,   WST_ATTR_ELEM    F                             04870099
048800               ,   WST_ATTR_ELEM    G                             04880099
048900            WHERE                                                 04890099
049000                  A.INTGRTN_TYP_CDE   = 'P2LHNGFLD'               04900099
049100              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         04910099
049200              AND B.ATTR_DEFN_SEQ_NBR = 1                         04920099
049300              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         04930099
049400              AND C.ATTR_DEFN_SEQ_NBR = 1                         04940099
049500              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         04950099
049600              AND D.ATTR_DEFN_SEQ_NBR = 2                         04960099
049700              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         04970099
049800              AND E.ATTR_DEFN_SEQ_NBR = 3                         04980099
049900              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         04990099
050000              AND F.ATTR_DEFN_SEQ_NBR = 4                         05000099
050100              AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE         05010099
050200              AND G.ATTR_DEFN_SEQ_NBR = 5                         05020099
050300              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       05030099
050400              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       05040099
050500              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       05050099
050600              AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR       05060099
050700              AND C.ATTR_ELEM_NBR     =  90                       05070099
050800              AND D.ATTR_ELEM_TXT     = 'P2L'                     05080099
050900              AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP        05090099
051000              AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP        05100099
051100               WITH UR                                            05110099
051200     END-EXEC.                                                    05120099
051300                                                                  05130099
051400******************************************************************05140099
051500 PROCEDURE DIVISION.                                              05150099
051600******************************************************************05160099
051720                                                                  05172099
051800 0000-PROGRAM-MAINLINE.                                           05180099
051900                                                                  05190099
052000     OPEN INPUT  INPUT-FILE                                       05200099
052100          OUTPUT OUTPUT-FILE                                      05210099
052200     PERFORM 9500-INITIALIZE-PC022.                               05220099
052300     PERFORM 1000-READ-INPUT-FILE.                                05230099
052400     IF PC002-PO-NBR = 00000000                                   05240099
052500        PERFORM 1000-READ-INPUT-FILE                              05250099
052600     END-IF.                                                      05260099
052700     MOVE PC002-CURRENT-OPER           TO PV-PREV-OPER-UNT-ID.    05270099
052800     MOVE PC002-PO-NBR                 TO PV-PREV-PO-NBR.         05280099
052900     MOVE PC002-REC-SEQ-NBR            TO PV-PREV-REC-SEQ-NBR.    05290099
053000     MOVE 1                            TO PV-PO-REC-CNT.          05300099
053100                                                                  05310099
053200*                                                                 05320099
053300*** WR-40826 - DMH BEGIN                                          05330099
053400*                                                                 05340099
053500     PERFORM 1005-CHECK-P2L-ZONES.                                05350099
053600     PERFORM 1020-CHECK-P2L-OTHER-QUALIFY.                        05360099
053700*                                                                 05370099
053800*** WR-40826 - DMH BEGIN                                          05380099
053900*                                                                 05390099
054000                                                                  05400099
054100     PERFORM 2000-PROCESS-INPUT-FILE                              05410099
054200         UNTIL PS-EOF-INPUT.                                      05420099
054300                                                                  05430099
054400     PERFORM 9000-EOJ.                                            05440099
054500                                                                  05450099
054600     STOP RUN.                                                    05460099
054700                                                                  05470099
054800/                                                                 05480099
054900******************************************************************05490099
055000* READS RECORD FROM THE INPUT FILE                                05500099
055100******************************************************************05510099
055200 1000-READ-INPUT-FILE.                                            05520099
055300                                                                  05530099
055400     MOVE '1000-READ-INPUT-FILE.'      TO  PV-ABEND-PARAGRAPH.    05540099
055500     INITIALIZE PC002-RECEIVER-EXT-RECORD                         05550099
055600     SET PS-LINE-CRTN-KNWN         TO TRUE                        05560099
055700                                                                  05570099
055800     READ INPUT-FILE                                              05580099
055900          INTO PC002-RECEIVER-EXT-RECORD                          05590099
056000            AT END                                                05600099
056100               SET PS-EOF-INPUT     TO TRUE                       05610099
056200                                                                  05620099
056300            NOT AT END                                            05630099
056400               SET PS-NOT-EOF-INPUT TO TRUE                       05640099
056500               ADD +1 TO PV-RECORDS-READ                          05650099
056600     END-READ.                                                    05660099
056700                                                                  05670099
056800/                                                                 05680099
056900                                                                  05690099
057000******************************************************************05700099
057100* CHECK TO SEE HOW DC IS PROCESSING P2L FREIGHT                  *05710099
057200* HANG/FOLD, HANG/COMMODITY, COMMODITY                           *05720099
057300* WR-4826 - DMH - 7/5/12                                         *05730099
057400******************************************************************05740099
057500 1005-CHECK-P2L-ZONES.                                            05750099
057600                                                                  05760099
057700     MOVE  PC002-CURRENT-OPER  TO  DK-OPER-UNT-ID.                05770099
057800                                                                  05780099
057900                                                                  05790099
058000      MOVE '1005-CHECK-P2L-ZONES   ' TO PV-ABEND-PARAGRAPH.       05800099
058100                                                                  05810099
058200      EXEC SQL                                                    05820099
058300           SELECT  FUNC_TXT                                       05830099
058400             INTO :PV-P2L-ZONE                                    05840099
058500             FROM  TKRPRPM                                        05850099
058600            WHERE  LOC_ID            = :DK-OPER-UNT-ID            05860099
058700              AND  SYS_PRC_FUNC_CDE  = 'P2LZON'                   05870099
058800              AND  INTFC_SYS_CDE     = 'KHL'                      05880099
058900              AND  FUNC_PRC_STAT_CDE = 'AC'                       05890099
059000              AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP         05900099
059100              AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP         05910099
059200                    WITH UR                                       05920099
059300       END-EXEC.                                                  05930099
059400                                                                  05940099
059500       EVALUATE TRUE                                              05950099
059600            WHEN SQLCODE = ZERO                                   05960099
059700                 MOVE  DK-OPER-UNT-ID  TO  PV-DISPLAY-OPER        05970099
059800                 IF  PV-HANG-FOLD                                 05980099
059900                     SET  PS-HANG-FOLD       TO  TRUE             05990099
060000                 ELSE                                             06000099
060100                 IF  PV-HANG-COMMODITY                            06010099
060200                     SET  PS-HANG-COMMODITY  TO  TRUE             06020099
060300                 ELSE                                             06030099
060400                     SET  PS-COMMODITY       TO  TRUE             06040099
060500                 END-IF                                           06050099
060600                 END-IF                                           06060099
060700            WHEN SQLCODE = +100                                   06070099
060800                 SET  PS-COMMODITY  TO  TRUE                      06080099
060900            WHEN OTHER                                            06090099
061000                MOVE '1005-CHECK-P2L-ZONES      '                 06100099
061100                                  TO PV-ABEND-PARAGRAPH           06110099
061200                MOVE 'TKRPRPM - P2LZON'                           06120099
061300                                     TO PV-DB2-OPERATION-MESSAGE-106130099
061400                MOVE 'CHECK P2L ZONE SETUP             '          06140099
061500                                     TO PV-DB2-OPERATION-MESSAGE-206150099
061600                MOVE 'TKRPRPM'           TO PV-DB2-TABLE-NAME-1   06160099
061700                PERFORM 9999-SQL-ABEND                            06170099
061800        END-EVALUATE.                                             06180099
061900                                                                  06190099
062000                                                                  06200099
062100******************************************************************06210099
062200* IF DC IS PROCESSING P2L AS HANG/FOLD, BUILD INTERNAL TABLE     *06220099
062300* WITH THE STORE ZONES THAT QUALIFY FOR HANG/FOLD                *06230099
062400* INITIALLY SET UP FOR CHILD, MENS, JRS, WOMEN.                 * 06240099
062500* WR-4826 - DMH - 7/5/12                                         *06250099
062600******************************************************************06260099
062700 1020-CHECK-P2L-OTHER-QUALIFY.                                    06270099
062800                                                                  06280099
062900     INITIALIZE PT-HANG-FOLD-ZONE-TABLE.                          06290099
063000     PERFORM 1030-OPEN-HANG-FOLD-CURSOR.                          06300099
063100     PERFORM 1035-FETCH-HANG-FOLD-CURSOR.                         06310099
063200     PERFORM VARYING PT-HANG-FOLD-ZONE-IDX FROM 1 BY 1            06320099
063300             UNTIL SQLCODE = +100 OR PT-HANG-FOLD-ZONE-IDX > 50   06330099
063400         MOVE PV-WST-STORE-ZONE                                   06340099
063500           TO PT-HANG-FOLD-ZONE(PT-HANG-FOLD-ZONE-IDX)            06350099
063600         PERFORM 1035-FETCH-HANG-FOLD-CURSOR                      06360099
063700     END-PERFORM.                                                 06370099
063800     PERFORM 1040-CLOSE-HANG-FOLD-CURSOR.                         06380099
063900                                                                  06390099
064000                                                                  06400099
064100******************************************************************06410099
064200* WR-4826 - DMH - 7/5/12                                         *06420099
064300******************************************************************06430099
064400 1030-OPEN-HANG-FOLD-CURSOR.                                      06440099
064500                                                                  06450099
064600     EXEC SQL                                                     06460099
064700         OPEN HANG-FOLD-CSR                                       06470099
064800     END-EXEC                                                     06480099
064900                                                                  06490099
065000     EVALUATE TRUE                                                06500099
065100         WHEN SQLCODE = ZERO                                      06510099
065200              CONTINUE                                            06520099
065300         WHEN OTHER                                               06530099
065400              MOVE '1030-OPEN-HANG-FOLD-CURSOR'                   06540099
065500                                  TO PV-ABEND-PARAGRAPH           06550099
065600              MOVE 'P2LHNGFLD - INTEGRATION PARM'                 06560099
065700                                     TO PV-DB2-OPERATION-MESSAGE-106570099
065800              MOVE 'WST00008'        TO PV-DB2-TABLE-NAME-1       06580099
065900              MOVE 'WST00008'        TO PV-DB2-TABLE-NAME-2       06590099
066000              MOVE 'WST00010'        TO PV-DB2-TABLE-NAME-3       06600099
066100              PERFORM 9999-SQL-ABEND                              06610099
066200     END-EVALUATE.                                                06620099
066300                                                                  06630099
066400                                                                  06640099
066500******************************************************************06650099
066600* WR-4826 - DMH - 7/5/12                                         *06660099
066700******************************************************************06670099
066800 1035-FETCH-HANG-FOLD-CURSOR.                                     06680099
066900                                                                  06690099
067000     EXEC SQL                                                     06700099
067100         FETCH HANG-FOLD-CSR                                      06710099
067200          INTO :PV-WST-STORE-ZONE                                 06720099
067300     END-EXEC.                                                    06730099
067400                                                                  06740099
067500     EVALUATE TRUE                                                06750099
067600         WHEN SQLCODE = ZERO                                      06760099
067700         WHEN SQLCODE = +100                                      06770099
067800              CONTINUE                                            06780099
067900         WHEN OTHER                                               06790099
068000              MOVE '1035-FETCH-HANG-FOLD-CURSOR'                  06800099
068100                                  TO PV-ABEND-PARAGRAPH           06810099
068200              MOVE 'P2LHNGFLD - INTEGRATION PARM'                 06820099
068300                                     TO PV-DB2-OPERATION-MESSAGE-106830099
068400              MOVE 'WST00008'        TO PV-DB2-TABLE-NAME-1       06840099
068500              MOVE 'WST00008'        TO PV-DB2-TABLE-NAME-2       06850099
068600              MOVE 'WST00010'        TO PV-DB2-TABLE-NAME-3       06860099
068700              PERFORM 9999-SQL-ABEND                              06870099
068800     END-EVALUATE.                                                06880099
068900                                                                  06890099
069000                                                                  06900099
069100******************************************************************06910099
069200* WR-4826 - DMH - 7/5/12                                         *06920099
069300******************************************************************06930099
069400 1040-CLOSE-HANG-FOLD-CURSOR.                                     06940099
069500                                                                  06950099
069600     EXEC SQL                                                     06960099
069700         CLOSE HANG-FOLD-CSR                                      06970099
069800     END-EXEC.                                                    06980099
069900                                                                  06990099
070000     EVALUATE TRUE                                                07000099
070100         WHEN SQLCODE = ZERO                                      07010099
070200              CONTINUE                                            07020099
070300         WHEN OTHER                                               07030099
070400              MOVE '1040-CLOSE-HANG-FOLD-CURSOR'                  07040099
070500                                  TO PV-ABEND-PARAGRAPH           07050099
070600              MOVE 'P2LHNGFLD - INTEGRATION PARM'                 07060099
070700                                     TO PV-DB2-OPERATION-MESSAGE-107070099
070800              MOVE 'WST00008'        TO PV-DB2-TABLE-NAME-1       07080099
070900              MOVE 'WST00008'        TO PV-DB2-TABLE-NAME-2       07090099
071000              MOVE 'WST00010'        TO PV-DB2-TABLE-NAME-3       07100099
071100              PERFORM 9999-SQL-ABEND                              07110099
071200     END-EVALUATE.                                                07120099
071300                                                                  07130099
071400                                                                  07140099
071500                                                                  07150099
071600                                                                  07160099
071700******************************************************************07170099
071800* PROCESS INPUT RECORDS                                          *07180099
071900******************************************************************07190099
072000 2000-PROCESS-INPUT-FILE.                                         07200099
072100                                                                  07210099
072200     MOVE '2000-PROCESS-INPUT-FILE.'   TO PV-ABEND-PARAGRAPH.     07220099
072300                                                                  07230099
072400*                                                                 07240099
072500*** DMH BEGIN 7/5/12                                              07250099
072600*                                                                 07260099
072700     IF  PC002-CURRENT-OPER  =  PV-PREV-OPER-UNT-ID               07270099
072800         CONTINUE                                                 07280099
072900     ELSE                                                         07290099
073000         PERFORM 1005-CHECK-P2L-ZONES                             07300099
073100     END-IF.                                                      07310099
073200*                                                                 07320099
073300*** DMH END   7/5/12                                              07330099
073400*                                                                 07340099
073500                                                                  07350099
073600     IF (PC002-PO-NBR EQUAL PV-PREV-PO-NBR AND                    07360099
073700            PC002-REC-SEQ-NBR EQUAL PV-PREV-REC-SEQ-NBR)          07370099
073800*        SAME PO/RECEIVER NBR                                     07380099
073900         PERFORM 3000-BUILD-REC-EXT-RECORD                        07390099
074000     ELSE                                                         07400099
074100*        WRITE PREV PO/RECEIVER REC,SET CNT =1                    07410099
074200         PERFORM 8400-MOVE-CRTN-UNIT-FIELDS                       07420099
074300         PERFORM 9000-WRITE-OUTPUT-RECORD                         07430099
074400         MOVE 1                        TO  PV-PO-REC-CNT          07440099
074500                                                                  07450099
074600         MOVE PC002-PO-NBR             TO PV-PREV-PO-NBR          07460099
074700         MOVE PC002-REC-SEQ-NBR        TO PV-PREV-REC-SEQ-NBR     07470099
074800         MOVE PC002-CURRENT-OPER       TO PV-PREV-OPER-UNT-ID     07480099
074900                                                                  07490099
075000         PERFORM 3000-BUILD-REC-EXT-RECORD                        07500099
075100     END-IF.                                                      07510099
075200                                                                  07520099
075300     PERFORM 1000-READ-INPUT-FILE.                                07530099
075400*    MOVE PC002-PO-NBR             TO PV-PREV-PO-NBR.             07540099
075500*    MOVE PC002-REC-SEQ-NBR        TO PV-PREV-REC-SEQ-NBR.        07550099
075600*    MOVE PC002-CURRENT-OPER       TO PV-PREV-OPER-UNT-ID.        07560099
075700                                                                  07570099
075800/                                                                 07580099
075900******************************************************************07590099
076000* BUILDS THE RECORD                                              *07600099
076100******************************************************************07610099
076200 3000-BUILD-REC-EXT-RECORD.                                       07620099
076300                                                                  07630099
076400     IF PV-PO-REC-CNT = 1                                         07640099
076500*       FILL FIELDS WHICH ONLY NEED TO BE FILLED ONCE             07650099
076600        PERFORM 4000-FILL-FIRST-RECORD                            07660099
076700        ADD +1  TO PV-PO-REC-CNT                                  07670099
076800     ELSE                                                         07680099
076900*       FILL FIELDS THAT NEED TO BE INCREMENTED                   07690099
077000        ADD +1  TO PV-PO-REC-CNT                                  07700099
077100        PERFORM 5000-INCREMENT-RECORD-TOTALS                      07710099
077200     END-IF.                                                      07720099
077300                                                                  07730099
077400******************************************************************07740099
077500* FILLS THE FIELDS OF THE FIRST RECORD FOR A PO/RECEIVER         *07750099
077600******************************************************************07760099
077700 4000-FILL-FIRST-RECORD.                                          07770099
077800                                                                  07780099
077900      MOVE '4000-FILL-FIRST-RECORD.'      TO PV-ABEND-PARAGRAPH.  07790099
078000                                                                  07800099
078100*     INITIALIZE COUNT VARIABLES FOR QUANTITY FIELDS              07810099
078200      MOVE SPACES TO PV-PRESENT-CDE.                              07820099
078300                                                                  07830099
078400      MOVE ZERO TO PV-NBR-PO-LINES                                07840099
078500                   PV-PKSLP-ITM-QTY                               07850099
078600                   PV-JWLRY-UNIT-QTY                              07860099
078700                   PV-CRSDCK-UNIT-CT                              07870099
078800                   PV-CRSDCK-CRTN-CT                              07880099
078900                   PV-HRTW-UNIT-CT                                07890099
079000                   PV-HRTW-CRTN-CT                                07900099
079100                   PV-P2L-UNIT-CT                                 07910099
079200                   PV-P2L-CRTN-CT.                                07920099
079300*   CURRENT OPER ID                                               07930099
079400      MOVE PC002-CURRENT-OPER    TO PC022-CURR-OPER-UNT-ID.       07940099
079500*   RCVD-DTE                                                      07950099
079600      MOVE PC002-REC-DATE     TO PC022-RCVD-DTE                   07960099
079700*  SCAC/TRAILER                                                   07970099
079800      PERFORM 4010-GET-SCAC-TRAILER.                              07980099
079900*  PO-NBR                                                         07990099
080000      MOVE PC002-PO-NBR                   TO PC022-PO-NBR.        08000099
080100*  RCVR-SEQ-NBR                                                   08010099
080200      MOVE PC002-REC-SEQ-NBR              TO PC022-RCVR-SEQ-NBR.  08020099
080300*  ENT-NAME                                                       08030099
080400      MOVE PC002-VNDR-NME                 TO PC022-ENT-NME.       08040099
080500*  NBR PO LINES                                                   08050099
080600      MOVE 1                              TO PV-NBR-PO-LINES.     08060099
080700*  NBR OF CRTNS                                                   08070099
080800      MOVE PC002-CART-CNT                 TO PC022-NBR-OF-CRTNS.  08080099
080900*  PACKSLIP ITM QTY                                               08090099
081000      MOVE PC002-PKSL-ITM-QTY             TO PV-PKSLP-ITM-QTY     08100099
081100                                             PV-PKSLP-ITM-QTY-SAVE08110099
081200                                             PC022-PKSLP-ITM-QTY. 08120099
081300*  PKGNG TYPE CODE                                                08130099
081400      PERFORM 4020-GET-PKGNG-TYP-CDE.                             08140099
081500*  SEASET SHRT NM                                                 08150099
081600      MOVE PC002-SEASET-NM                TO PC022-SEASET-SHRT-NM.08160099
081700*  NEW STORE IND                                                  08170099
081800      MOVE PC002-NEW-STR-IND              TO PC022-NEW-STR-IND.   08180099
081900*  LFC/EFC RECEIVER CODE                                          08190099
081910      PERFORM 6200-LOAD-RCVR-CDE.                                 08191099
082100*  TROUBLE CODE                                                   08210099
082200      PERFORM 4030-GET-TRBL-CDE.                                  08220099
082300*  PRESENT CODE                                                   08230099
082400      PERFORM 4040-GET-PRESENT-CDE.                               08240099
082500*  HANG IND/TICKET IND                                            08250099
082600      PERFORM 4050-GET-HANG-TICKET-IND.                           08260099
082700*  DEPT NBR                                                       08270099
082800      MOVE PC002-DEPT-NBR                 TO PC022-DPT-NBR.       08280099
082900*  STR ZN ID                                                      08290099
083000      PERFORM 4060-GET-STR-ZN-ID.                                 08300099
083010*  OTB                                                            08301099
083020      PERFORM 4090-GET-OTB.                                       08302099
083100                                                                  08310099
083200*                                                                 08320099
083300*** WR-40826 - DMH 7/5/12                                         08330099
083400*                                                                 08340099
083500      IF  PS-HANG-FOLD  OR                                        08350099
083600          PS-HANG-COMMODITY                                       08360099
083700          PERFORM 4062-CHECK-P2L-PRESENTATION                     08370099
083800      END-IF.                                                     08380099
083900*                                                                 08390099
084000*** WR-40826 - DMH 7/5/12                                         08400099
084100*                                                                 08410099
084200****  FOR TEST ONLY                                               08420099
084300     MOVE  PC002-CURRENT-OPER    TO  PV-DISPLAY-OPER              08430099
084400     MOVE  PC002-PO-NBR          TO  PV-DISPLAY-PO                08440099
084500     MOVE  PC002-REC-SEQ-NBR     TO  PV-DISPLAY-REC-SEQ-NBR       08450099
084600                                                                  08460099
084700*    DISPLAY  PV-DISPLAY-OPER          '-'                        08470099
084800*             PV-DISPLAY-PO            '-'                        08480099
084900*             PV-DISPLAY-REC-SEQ-NBR                              08490099
085000*             '   TMDSEDP:'            PC022-STR-ZN-ID            08500099
085100*             '  '                     PS-P2L-ZONE.               08510099
085200****  FOR TEST ONLY                                               08520099
085300                                                                  08530099
085400                                                                  08540099
085500*  PRCG AREA CDE                                                  08550099
085600      MOVE PC002-PROCESS-AREA             TO PC022-PRCG-AREA-CDE. 08560099
085700*  LNE LOC CDE                                                    08570099
085800      MOVE PC002-LNE-LOC-CDE              TO PC022-LNE-LOC-CDE.   08580099
085900*  PRCS CDE                                                       08590099
086000      PERFORM 4070-GET-PRCS-CDE.                                  08600099
086100*  CHECK TO SEE IF RECEIVER IS FOR FULFILLMENT FACILITY           08610099
086200      PERFORM 4080-CHECK-FOR-FULFILLMENT.                         08620099
086300*  CRTN/UNT QUANTITIES                                            08630099
086400      PERFORM 6000-POPULATE-QTY-FIELDS.                           08640099
086500                                                                  08650099
086600/                                                                 08660099
086700******************************************************************08670099
086800* GETS THE SCAC FROM AN SQL CALL BASED ON THE PO/RECIEVER        *08680099
086900******************************************************************08690099
087000 4010-GET-SCAC-TRAILER.                                           08700099
087100                                                                  08710099
087200      MOVE '4010-GET-SCAC-TRAILER.'  TO PV-ABEND-PARAGRAPH.       08720099
087300      MOVE PV-PREV-PO-NBR            TO DK-PO-NBR.                08730099
087400      MOVE PV-PREV-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.           08740099
087500                                                                  08750099
087600      EXEC SQL                                                    08760099
087700                SELECT                                            08770099
087800                      C.OWNER_SCAC_ID                             08780099
087900                     ,C.VEH_NBR                                   08790099
088000                 INTO  :VHTRIP-OWNER-SCAC-ID                      08800099
088100                      ,:VHTRIP-VEH-NBR     :DN-NULL-IND-VEH       08810099
088200                FROM TSHPTPO A                                    08820099
088300                   , TSHIPMT B                                    08830099
088400                   , TVHTRIP C                                    08840099
088500                WHERE   A.PO_NBR         = :DK-PO-NBR             08850099
088600                   AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR        08860099
088700                   AND  A.SHIPT_ID       = B.SHIPT_ID             08870099
088800                   AND  B.TRIP_ID        = C.TRIP_ID              08880099
088900                   AND  A.PRIM_SHIPT_IND = 'Y'                    08890099
089000                   AND  C.VEH_NBR  IS NOT NULL                    08900099
089100                   WITH UR                                        08910099
089200       END-EXEC.                                                  08920099
089300                                                                  08930099
089400       EVALUATE TRUE                                              08940099
089500            WHEN SQLCODE = ZERO                                   08950099
089600                MOVE VHTRIP-OWNER-SCAC-ID  TO PC022-SCAC          08960099
089700                IF  DN-NULL-IND-VEH < +0                          08970099
089800                    MOVE 'NO TRAILER' TO PC022-TRLR-NBR           08980099
089900                ELSE                                              08990099
090000                    MOVE VHTRIP-VEH-NBR TO PC022-TRLR-NBR         09000099
090100                END-IF                                            09010099
090200            WHEN SQLCODE = +100                                   09020099
090300                MOVE '????'       TO PC022-SCAC                   09030099
090400                MOVE 'NO TRAILER' TO PC022-TRLR-NBR               09040099
090500            WHEN SQLCODE = -811                                   09050099
090600                PERFORM 4015-GET-SCAC-TRAILER                     09060099
090700            WHEN OTHER                                            09070099
090800                MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO          09080099
090900                MOVE  DK-REC-SEQ-NBR   TO  PV-DISPLAY-REC-SEQ-NBR 09090099
091000                MOVE '4010-GET-SCAC-TRAILER '                     09100099
091100                                  TO PV-ABEND-PARAGRAPH           09110099
091200                MOVE 'SELECT SCAC ID'                             09120099
091300                                     TO PV-DB2-OPERATION-MESSAGE-109130099
091400                STRING ' PO-RECV - '            DELIMITED BY SIZE 09140099
091500                       PV-DISPLAY-PO '-'        DELIMITED BY SIZE 09150099
091600                       PV-DISPLAY-REC-SEQ-NBR   DELIMITED BY SIZE 09160099
091700                                   INTO PV-DB2-OPERATION-MESSAGE-209170099
091800                MOVE 'TSHPTPO'           TO PV-DB2-TABLE-NAME-1   09180099
091900                MOVE 'TSHIPMT'           TO PV-DB2-TABLE-NAME-2   09190099
092000                MOVE 'TVHTRIP'           TO PV-DB2-TABLE-NAME-3   09200099
092100                PERFORM 9999-SQL-ABEND                            09210099
092200        END-EVALUATE.                                             09220099
092300                                                                  09230099
092400/                                                                 09240099
092500******************************************************************09250099
092600* GETS THE SCAC FROM AN SQL CALL BASED ON THE PO/RECIEVER        *09260099
092700* AND LAST UPDATE TIMESTAMP WHEN THE PREVIOUS PARAGRAPH COMES    *09270099
092800* BACK WITH DUPLICATE ROWS (SQLCODE = -811).                     *09280099
092900******************************************************************09290099
093000 4015-GET-SCAC-TRAILER.                                           09300099
093100                                                                  09310099
093200      MOVE '4015-GET-SCAC-TRAILER.'  TO PV-ABEND-PARAGRAPH.       09320099
093300      MOVE PV-PREV-PO-NBR            TO DK-PO-NBR.                09330099
093400      MOVE PV-PREV-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.           09340099
093500                                                                  09350099
093600      EXEC SQL                                                    09360099
093700                SELECT                                            09370099
093800                      C.OWNER_SCAC_ID                             09380099
093900                     ,C.VEH_NBR                                   09390099
094000                 INTO  :VHTRIP-OWNER-SCAC-ID                      09400099
094100                      ,:VHTRIP-VEH-NBR     :DN-NULL-IND-VEH       09410099
094200                FROM TSHPTPO A                                    09420099
094300                   , TSHIPMT B                                    09430099
094400                   , TVHTRIP C                                    09440099
094500                WHERE   A.PO_NBR         = :DK-PO-NBR             09450099
094600                   AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR        09460099
094700                   AND  A.SHIPT_ID       = B.SHIPT_ID             09470099
094800                   AND  B.TRIP_ID        = C.TRIP_ID              09480099
094900                   AND  A.PRIM_SHIPT_IND = 'Y'                    09490099
095000                   AND  C.VEH_NBR  IS NOT NULL                    09500099
095100                   AND  A.CRE_TMST IN                             09510099
095200                    ( SELECT                                      09520099
095300                            MAX(D.CRE_TMST)                       09530099
095400                      FROM TSHPTPO D                              09540099
095500                         , TSHIPMT E                              09550099
095600                         , TVHTRIP F                              09560099
095700                      WHERE   D.PO_NBR         = :DK-PO-NBR       09570099
095800                         AND  D.REC_SEQ_NBR    = :DK-REC-SEQ-NBR  09580099
095900                         AND  D.SHIPT_ID       = E.SHIPT_ID       09590099
096000                         AND  E.TRIP_ID        = F.TRIP_ID        09600099
096100                         AND  D.PRIM_SHIPT_IND = 'Y'              09610099
096200                         AND  F.VEH_NBR  IS NOT NULL)             09620099
096300               WITH UR                                            09630099
096400       END-EXEC.                                                  09640099
096500                                                                  09650099
096600       EVALUATE TRUE                                              09660099
096700            WHEN SQLCODE = ZERO                                   09670099
096800                MOVE VHTRIP-OWNER-SCAC-ID  TO PC022-SCAC          09680099
096900                IF  DN-NULL-IND-VEH < +0                          09690099
097000                    MOVE 'NO TRAILER' TO PC022-TRLR-NBR           09700099
097100                ELSE                                              09710099
097200                    MOVE VHTRIP-VEH-NBR TO PC022-TRLR-NBR         09720099
097300                END-IF                                            09730099
097400            WHEN SQLCODE = +100                                   09740099
097500                MOVE '????'       TO PC022-SCAC                   09750099
097600                MOVE 'NO TRAILER' TO PC022-TRLR-NBR               09760099
097700            WHEN OTHER                                            09770099
097800                MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO          09780099
097900                MOVE  DK-REC-SEQ-NBR   TO  PV-DISPLAY-REC-SEQ-NBR 09790099
098000                MOVE '4015-GET-SCAC-TRAILER '                     09800099
098100                                  TO PV-ABEND-PARAGRAPH           09810099
098200                MOVE 'SELECT SCAC ID'                             09820099
098300                                     TO PV-DB2-OPERATION-MESSAGE-109830099
098400                STRING ' PO-RECV - '            DELIMITED BY SIZE 09840099
098500                       PV-DISPLAY-PO '-'        DELIMITED BY SIZE 09850099
098600                       PV-DISPLAY-REC-SEQ-NBR   DELIMITED BY SIZE 09860099
098700                                   INTO PV-DB2-OPERATION-MESSAGE-209870099
098800                MOVE 'TSHPTPO'           TO PV-DB2-TABLE-NAME-1   09880099
098900                MOVE 'TSHIPMT'           TO PV-DB2-TABLE-NAME-2   09890099
099000                MOVE 'TVHTRIP'           TO PV-DB2-TABLE-NAME-3   09900099
099100                PERFORM 9999-SQL-ABEND                            09910099
099200        END-EVALUATE.                                             09920099
099300                                                                  09930099
099400/                                                                 09940099
099500******************************************************************09950099
099600* GET THE PACKAGING TYPE CODE FROM TRECEIV                        09960099
099700******************************************************************09970099
099800 4020-GET-PKGNG-TYP-CDE.                                          09980099
099900                                                                  09990099
100000      MOVE '4020-GET-PKGNG-TYP-CDE.'      TO PV-ABEND-PARAGRAPH.  10000099
100100      SET  PS-NOT-PACK-BY-STORE      TO TRUE.                     10010099
100200      MOVE PV-PREV-PO-NBR            TO DK-PO-NBR.                10020099
100300      MOVE PV-PREV-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.           10030099
100400                                                                  10040099
100500      EXEC SQL                                                    10050099
100600                SELECT                                            10060099
100700                      PACK_BY_ST_IND                              10070099
100800                     ,PKGNG_CDE                                   10080099
100900                INTO  :RECEIV-PACK-BY-ST-IND                      10090099
101000                     ,:RECEIV-PKGNG-CDE                           10100099
101100                FROM TRECEIV                                      10110099
101200                WHERE   ORD_NBR        = :DK-PO-NBR               10120099
101300                   AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR          10130099
101400                   WITH UR                                        10140099
101500      END-EXEC.                                                   10150099
101600                                                                  10160099
101700       EVALUATE TRUE                                              10170099
101800            WHEN SQLCODE = ZERO                                   10180099
101900                MOVE RECEIV-PACK-BY-ST-IND TO PV-PACK-BY-STORE    10190099
102000                MOVE RECEIV-PKGNG-CDE      TO PV-PKGNG-CDE        10200099
102100            WHEN SQLCODE = +100                                   10210099
102200                MOVE SPACE                 TO PV-PACK-BY-STORE    10220099
102300                                              PV-PKGNG-CDE        10230099
102400            WHEN OTHER                                            10240099
102500                MOVE  SQLCODE          TO  PV-SQLCODE             10250099
102600                MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO          10260099
102700                MOVE  DK-REC-SEQ-NBR   TO  PV-DISPLAY-REC-SEQ-NBR 10270099
102800                MOVE '4020-GET-PKGNG-TYP-CDE.'                    10280099
102900                                       TO PV-ABEND-PARAGRAPH      10290099
103000                MOVE 'SELECT PACKING TYPE CODE'                   10300099
103100                                     TO PV-DB2-OPERATION-MESSAGE-110310099
103200                STRING ' PO-RECV - '           DELIMITED BY SIZE  10320099
103300                       PV-DISPLAY-PO '-'       DELIMITED BY SIZE  10330099
103400                       PV-DISPLAY-REC-SEQ-NBR  DELIMITED BY SIZE  10340099
103500                                   INTO PV-DB2-OPERATION-MESSAGE-210350099
103600                MOVE 'TRECEIV'           TO PV-DB2-TABLE-NAME-1   10360099
103700                PERFORM 9999-SQL-ABEND                            10370099
103800        END-EVALUATE.                                             10380099
103900                                                                  10390099
104000        IF PV-PACK-BY-STORE EQUAL PC-Y                            10400099
104100           SET PS-PACK-BY-STORE          TO TRUE                  10410099
104200        ELSE                                                      10420099
104300           SET PS-NOT-PACK-BY-STORE          TO TRUE              10430099
104400        END-IF.                                                   10440099
104500                                                                  10450099
104600        EVALUATE TRUE                                             10460099
104700                                                                  10470099
104800            WHEN PS-PACK-BY-STORE                                 10480099
104900                 MOVE PC-PBS             TO PC022-PKGNG-TYP-CDE   10490099
105000            WHEN PS-NOT-PACK-BY-STORE                             10500099
105100                                                                  10510099
105200                 EVALUATE TRUE                                    10520099
105300                    WHEN PV-PKGNG-CDE = PC-B                      10530099
105400                         MOVE PC-BULK    TO PC022-PKGNG-TYP-CDE   10540099
105500                    WHEN PV-PKGNG-CDE = PC-M                      10550099
105600                         MOVE PC-MULTI   TO PC022-PKGNG-TYP-CDE   10560099
105700                    WHEN PV-PKGNG-CDE = PC-C                      10570099
105800                         MOVE PC-CASE    TO PC022-PKGNG-TYP-CDE   10580099
105900                    WHEN PV-PKGNG-CDE = PC-S                      10590099
106000                         MOVE PC-SINGLE  TO PC022-PKGNG-TYP-CDE   10600099
106100                    WHEN PV-PKGNG-CDE = PC-I                      10610099
106200                         MOVE PC-INNER   TO PC022-PKGNG-TYP-CDE   10620099
106300                    WHEN OTHER                                    10630099
106400                         MOVE SPACES     TO PC022-PKGNG-TYP-CDE   10640099
106500                  END-EVALUATE                                    10650099
106600                                                                  10660099
106700        END-EVALUATE.                                             10670099
106800/                                                                 10680099
106900******************************************************************10690099
107000* GET THE TROUBLE CODE                                            10700099
107100******************************************************************10710099
107200 4030-GET-TRBL-CDE.                                               10720099
107300                                                                  10730099
107400     MOVE '4030-GET-TRBL-CDE.'   TO PV-ABEND-PARAGRAPH.           10740099
107500     STRING PC002-UNRESOLVED-TROUBLE DELIMITED BY SIZE            10750099
107600            PC002-MULTI-TROUBLE DELIMITED BY SIZE                 10760099
107700            ' ' DELIMITED BY SIZE                                 10770099
107800            PC002-LATEST-TROUBLE DELIMITED BY SIZE                10780099
107900            INTO PC022-TRBL-CDE.                                  10790099
108000                                                                  10800099
108100/                                                                 10810099
108200******************************************************************10820099
108300* GETS THE PRESENTATION CODE FOR THE PO/RECEIVER                 *10830099
108400******************************************************************10840099
108500 4040-GET-PRESENT-CDE.                                            10850099
108600                                                                  10860099
108700     MOVE '4040-GET-PRESENT-CDE.'      TO PV-ABEND-PARAGRAPH.     10870099
108710     PERFORM 4055-GET-ITM-NBR.                                    10871099
108800     IF PV-PO-REC-CNT = 1                                         10880099
108900        SET PS-NOT-MIXED               TO TRUE                    10890099
109000*       PERFORM 4055-GET-ITM-NBR                                  10900099
109100        MOVE PV-CALL-PRESENT-CDE       TO PV-PRESENT-CDE          10910099
109200     ELSE                                                         10920099
109300        IF NOT PS-MIXED                                           10930099
109400*          PERFORM 4055-GET-ITM-NBR                               10940099
109500           IF PV-PRESENT-CDE EQUAL SPACES                         10950099
109600              MOVE SPACES              TO PV-PRESENT-CDE          10960099
109700           ELSE                                                   10970099
109800              IF (PV-PRESENT-CDE EQUAL PC-HANG                    10980099
109900                 AND PV-CALL-PRESENT-CDE EQUAL PC-HANG)           10990099
110000                 OR  (PV-PRESENT-CDE EQUAL PC-FOLD                11000099
110100                 AND  PV-CALL-PRESENT-CDE EQUAL PC-FOLD)          11010099
110200                                                                  11020099
110300                     MOVE PV-CALL-PRESENT-CDE TO PV-PRESENT-CDE   11030099
110400                                                                  11040099
110500              ELSE                                                11050099
110600                 IF PV-CALL-PRESENT-CDE EQUAL SPACES AND          11060099
110700                    PV-PRESENT-CDE EQUAL PC-HANG                  11070099
110800                       MOVE PC-HANG    TO PV-PRESENT-CDE          11080099
110900                 ELSE                                             11090099
111000                    IF PV-CALL-PRESENT-CDE EQUAL SPACES AND       11100099
111100                       PV-PRESENT-CDE EQUAL PC-FOLD               11110099
111200                          MOVE PC-FOLD    TO PV-PRESENT-CDE       11120099
111300                    ELSE                                          11130099
111400                      MOVE PC-MIXED         TO PV-PRESENT-CDE     11140099
111500                      SET  PS-MIXED         TO TRUE               11150099
111600                    END-IF                                        11160099
111700                 END-IF                                           11170099
111800              END-IF                                              11180099
111900           END-IF                                                 11190099
112000        END-IF                                                    11200099
112100     END-IF.                                                      11210099
112200                                                                  11220099
112300/                                                                 11230099
112400******************************************************************11240099
112500* GETS THE ITEM NUMBER                                           *11250099
112600******************************************************************11260099
112700 4055-GET-ITM-NBR.                                                11270099
112800                                                                  11280099
112900     MOVE '4055-GET-ITM-NBR.'         TO PV-ABEND-PARAGRAPH.      11290099
113000     MOVE PV-PREV-PO-NBR              TO DK-PO-NBR.               11300099
113100     MOVE PV-PREV-REC-SEQ-NBR         TO DK-REC-SEQ-NBR.          11310099
113200     MOVE PC002-PO-LINE-NBR           TO DK-PO-LINE-NBR.          11320099
113201                                                                  11320199
113210* DMH BEGIN 5/18/2020                                             11321099
113220     MOVE PC002-LOGICAL-OPER          TO DK-RECEIVER-OPER.        11322099
113230     MOVE PC002-LOGICAL-FCLTY         TO DK-RECEIVER-FCLTY.       11323099
113240* DMH END   5/18/2020                                             11324099
113250                                                                  11325099
113300* RPK 12/12/2013:  ADDED THE FOLLOWING FIELDS TO THIS SQL:        11330099
113400* POITM.INNR_PK_QTY                                               11340099
113500* POITM.OUTR_PK_QTY                                               11350099
113600* REC.INNR_PACK_QTY                                               11360099
113700* REC.CASE_PACK_QTY                                               11370099
113800* REC.PREPK_DRV_LNE_CDE                                           11380099
113900                                                                  11390099
114000     EXEC SQL                                                     11400099
114100             SELECT                                               11410099
114200                  POITM.ITM_NBR                                   11420099
114300                 ,POITM.INNR_PK_QTY                               11430099
114400                 ,POITM.OUTR_PK_QTY                               11440099
114500                 ,REC.INNR_PACK_QTY                               11450099
114600                 ,REC.CASE_PACK_QTY                               11460099
114700                 ,REC.PREPK_DRV_LNE_CDE                           11470099
114800             INTO                                                 11480099
114900                  :PURITM-ITM-NBR                                 11490099
115000                 ,:PURITM-INNR-PK-QTY                             11500099
115100                 ,:PURITM-OUTR-PK-QTY                             11510099
115200                 ,:RECITM-INNR-PACK-QTY                           11520099
115300                 ,:RECITM-CASE-PACK-QTY                           11530099
115400                 ,:RECITM-PREPK-DRV-LNE-CDE                       11540099
115500             FROM                                                 11550099
115600                   TPURITM POITM                                  11560099
115700                  ,TRECITM REC                                    11570099
115800             WHERE                                                11580099
115900                   REC.ORD_NBR        = :DK-PO-NBR                11590099
116000               AND REC.ORD_LNE_NBR    = :DK-PO-LINE-NBR           11600099
116100               AND REC.REC_SEQ_NBR    = :DK-REC-SEQ-NBR           11610099
116110               AND REC.OPER_UNT_ID    = :DK-RECEIVER-OPER         11611099
116120               AND REC.FCLTY_ID       = :DK-RECEIVER-FCLTY        11612099
116200               AND REC.VER_STATUS_CDE = :PC-A                     11620099
116300               AND REC.ORD_NBR        =  POITM.PO_NBR             11630099
116400               AND REC.PO_VER_NBR     =  POITM.VER_NBR            11640099
116500               AND REC.ORD_LNE_NBR    =  POITM.APP_PO_LNE_NBR     11650099
116600               WITH UR                                            11660099
116700     END-EXEC.                                                    11670099
116800                                                                  11680099
116900     EVALUATE TRUE                                                11690099
117000         WHEN SQLCODE = ZERO                                      11700099
117100              IF RECITM-CASE-PACK-QTY = 0                         11710099
117200                 IF PURITM-OUTR-PK-QTY > 0                        11720099
117300                    MOVE PURITM-OUTR-PK-QTY TO                    11730099
117400                         RECITM-CASE-PACK-QTY                     11740099
117500                 END-IF                                           11750099
117600              END-IF                                              11760099
117700              IF RECITM-INNR-PACK-QTY = 0                         11770099
117800                 IF PURITM-INNR-PK-QTY > 0                        11780099
117900                    MOVE PURITM-INNR-PK-QTY TO                    11790099
118000                         RECITM-INNR-PACK-QTY                     11800099
118100                 END-IF                                           11810099
118200              END-IF                                              11820099
118300              PERFORM 4057-CALL-ITM-ACCESS-DOMAIN                 11830099
118400         WHEN OTHER                                               11840099
118500              CONTINUE                                            11850099
118600     END-EVALUATE.                                                11860099
118700/                                                                 11870099
118800******************************************************************11880099
118900* CALL LOGISTICS ITEM ACCESS MODULE (XLKUT001)                   *11890099
119000******************************************************************11900099
119100 4057-CALL-ITM-ACCESS-DOMAIN.                                     11910099
119200                                                                  11920099
119300      MOVE '4057-CALL-ITM-ACCESS-DOMAIN.' TO PV-ABEND-PARAGRAPH.  11930099
119400                                                                  11940099
119500      INITIALIZE XL001-ITEM-COMMAREA.                             11950099
119600*     DISPLAY PURITM-ITM-NBR.                                     11960099
119700      MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.                 11970099
119800                                                                  11980099
119900      SET  XL001-BY-ITEM                                          11990099
120000           XL001-SELECT-VND-STYL TO TRUE.                         12000099
120100                                                                  12010099
120200      CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.               12020099
120300                                                                  12030099
120400      EVALUATE TRUE                                               12040099
120500                                                                  12050099
120600          WHEN XL001-SUCCESSFUL                                   12060099
120700                                                                  12070099
120800             EVALUATE XL001-HNG-FOLD-CDE                          12080099
120900                 WHEN 'H'                                         12090099
121000                     MOVE PC-HANG  TO PV-CALL-PRESENT-CDE         12100099
121100                 WHEN 'F'                                         12110099
121200                     MOVE PC-FOLD  TO PV-CALL-PRESENT-CDE         12120099
121300                 WHEN 'M'                                         12130099
121400                     MOVE PC-MIXED TO PV-CALL-PRESENT-CDE         12140099
121500                     SET PS-MIXED  TO TRUE                        12150099
121600                 WHEN OTHER                                       12160099
121700                     MOVE SPACES        TO PV-CALL-PRESENT-CDE    12170099
121800             END-EVALUATE                                         12180099
121900                                                                  12190099
122000          WHEN XL001-SQL-ERROR                                    12200099
122100               IF XL001-SKU-SQLCODE = +100                        12210099
122200                  MOVE SPACES        TO PV-CALL-PRESENT-CDE       12220099
122300                                                                  12230099
122400               ELSE                                               12240099
122500                  MOVE XL001-SKU-SQLCODE TO  PV-SQLCODE           12250099
122600                  MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO        12260099
122700                  MOVE  DK-REC-SEQ-NBR  TO  PV-DISPLAY-REC-SEQ-NBR12270099
122800                  MOVE XL001-KEY-ITM-NBR TO PV-DISPLAY-ITEM-NBR   12280099
122900                  MOVE '4057-CALL-ITM-ACCESS-DOMAIN.'             12290099
123000                                         TO PV-ABEND-PARAGRAPH    12300099
123100                  MOVE 'GET PRESENT-CDE         '                 12310099
123200                                     TO PV-DB2-OPERATION-MESSAGE-112320099
123300                  STRING ' PO-RECV - '                            12330099
123400                         PV-DISPLAY-PO '-'                        12340099
123500                         PV-DISPLAY-REC-SEQ-NBR                   12350099
123600                         '  ITEM = ' PV-DISPLAY-ITEM-NBR          12360099
123700                         DELIMITED BY SIZE                        12370099
123800                                   INTO PV-DB2-OPERATION-MESSAGE-212380099
123900                  MOVE 'XLU_SKU'           TO PV-DB2-TABLE-NAME-1 12390099
124000                  PERFORM 9999-SQL-ABEND                          12400099
124100               END-IF                                             12410099
124200         END-EVALUATE.                                            12420099
124300/                                                                 12430099
124400                                                                  12440099
124500/                                                                 12450099
124600******************************************************************12460099
124700* GETS THE HANG IND AND THE TICKET IND FROM TRECEIV              *12470099
124800******************************************************************12480099
124900 4050-GET-HANG-TICKET-IND.                                        12490099
125000                                                                  12500099
125100      MOVE '4050-GET-HANG-TICKET-IND.'  TO PV-ABEND-PARAGRAPH.    12510099
125200      MOVE PV-PREV-PO-NBR            TO DK-PO-NBR.                12520099
125300      MOVE PV-PREV-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.           12530099
125400                                                                  12540099
125500      EXEC SQL                                                    12550099
125600                SELECT                                            12560099
125700                      GOH_IND                                     12570099
125800                     ,PRE_TKT_IND                                 12580099
125900                INTO  :RECEIV-GOH-IND                             12590099
126000                     ,:RECEIV-PRE-TKT-IND                         12600099
126100                FROM TRECEIV                                      12610099
126200                WHERE   ORD_NBR        = :DK-PO-NBR               12620099
126300                   AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR          12630099
126400                   WITH UR                                        12640099
126500      END-EXEC.                                                   12650099
126600                                                                  12660099
126700       EVALUATE TRUE                                              12670099
126800            WHEN SQLCODE = ZERO                                   12680099
126900                MOVE RECEIV-GOH-IND        TO PC022-HANG-IND      12690099
127000                MOVE RECEIV-PRE-TKT-IND    TO PC022-TCKT-IND      12700099
127100            WHEN SQLCODE = +100                                   12710099
127200                MOVE SPACE                 TO PC022-HANG-IND      12720099
127300                                              PC022-TCKT-IND      12730099
127400            WHEN OTHER                                            12740099
127500                MOVE  SQLCODE          TO  PV-SQLCODE             12750099
127600                MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO          12760099
127700                MOVE  DK-REC-SEQ-NBR   TO  PV-DISPLAY-REC-SEQ-NBR 12770099
127800                MOVE '4050-GET-HANG-TICKET-IND.'                  12780099
127900                                       TO PV-ABEND-PARAGRAPH      12790099
128000                MOVE 'SELECT HANG & TICKET IND'                   12800099
128100                                     TO PV-DB2-OPERATION-MESSAGE-112810099
128200                STRING ' PO-RECV - '           DELIMITED BY SIZE  12820099
128300                       PV-DISPLAY-PO '-'       DELIMITED BY SIZE  12830099
128400                       PV-DISPLAY-REC-SEQ-NBR  DELIMITED BY SIZE  12840099
128500                                   INTO PV-DB2-OPERATION-MESSAGE-212850099
128600                MOVE 'TRECEIV'           TO PV-DB2-TABLE-NAME-1   12860099
128700                PERFORM 9999-SQL-ABEND                            12870099
128800        END-EVALUATE.                                             12880099
128900                                                                  12890099
129000/                                                                 12900099
129100******************************************************************12910099
129200* GETS THE STORE ZONE ID                                         *12920099
129300******************************************************************12930099
129400 4060-GET-STR-ZN-ID.                                              12940099
129500                                                                  12950099
129600      MOVE '4060-GET-STR-ZN-ID.'        TO PV-ABEND-PARAGRAPH.    12960099
129700      MOVE PV-PREV-PO-NBR            TO DK-PO-NBR.                12970099
129800      MOVE PV-PREV-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.           12980099
129900                                                                  12990099
130000         EXEC SQL                                                 13000099
130100             SELECT C.STR_ZN_ID                                   13010099
130200               INTO :MDSEDP-STR-ZN-ID                             13020099
130300               FROM TPURCHS A,                                    13030099
130400                    TMDSEAR B,                                    13040099
130500                    TMDSEDP C                                     13050099
130600              WHERE A.PO_NBR         = :DK-PO-NBR                 13060099
130700                AND A.VER_STATUS_CDE = 'A'                        13070099
130800                AND A.DEPT_NBR       = B.DEPT_NBR                 13080099
130900                AND B.MDSELV_CDE     = 'DPT'                      13090099
131000                AND B.OPERCO_NBR     = '03'                       13100099
131100                AND (B.STRT_DTE     <= CURRENT DATE  AND          13110099
131200                     B.END_DTE      >  CURRENT DATE)              13120099
131300                AND B.MDSEAR_DKEY    = C.MDSEAR_DKEY              13130099
131400                WITH UR                                           13140099
131500         END-EXEC                                                 13150099
131600                                                                  13160099
131700         EVALUATE TRUE                                            13170099
131800             WHEN SQLCODE = +0                                    13180099
131900                  MOVE  MDSEDP-STR-ZN-ID                          13190099
132000                            TO  PC022-STR-ZN-ID                   13200099
132100             WHEN SQLCODE = +100                                  13210099
132200                  MOVE SPACES TO PC022-STR-ZN-ID                  13220099
132300                                                                  13230099
132400             WHEN OTHER                                           13240099
132500                  MOVE '4060-GET-STR-ZN-ID.'                      13250099
132600                                   TO PV-ABEND-PARAGRAPH          13260099
132700                  MOVE 'SELECT STORE ZONE DISPLY'                 13270099
132800                                   TO PV-DB2-OPERATION-MESSAGE-1  13280099
132900                  MOVE SQLCODE     TO PV-SQLCODE                  13290099
133000                  MOVE 'TMDSEDP '  TO PV-DB2-TABLE-NAME-1         13300099
133100                  PERFORM 9999-SQL-ABEND                          13310099
133200         END-EVALUATE.                                            13320099
133300                                                                  13330099
133400                                                                  13340099
133500******************************************************************13350099
133600*  CHECK IF STORE ZONE IS SET UP TO BE PROCESSED AS HANG/FOLD    *13360099
133700*  IF IT IS, COUNT THE NUMBER OF LINES ON THE RECEIVER THAT ARE  *13370099
133800*  HANG PRESENTATION, FOLD PRESENTATION, OTHER PRESENTATION      *13380099
133900*  WHICH EVER PRESENTATION HAS THE GREATEST NUMBER OF LINES FOR  *13390099
134000*  THE RECEIVER WILL BE THE PRESENTATION THAT WILL GO INTO THE   *13400099
134100*  STORE ZONE                                                    *13410099
134200* WR-40826 - DMH 7/5/12                                          *13420099
134300*                                                                 13430099
134400*   1.  COUNT THE NUMBER OF RCVR LINES WITH HANG PRESENTATION     13440099
134500*   2.  COUNT THE NUMBER OF RCVR LINES WITH FOLD PRESENTATION     13450099
134600*   3.  COUNT THE NUMBER OF RCVR LINES WITH OTHER PRESENTATION    13460099
134700*   4.  GET GOH_IND (GOODS ON HAND FROM RECEIVER)                 13470099
134800*       Y=VENDOR HANG AGREEMENT   N=NO VENDOR HANG AGREEMENT      13480099
134900*                                                                 13490099
135000*   IF DC IS PROCESSING P2L AS HANG/FOLD  AND                     13500099
135100*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          13510099
135200*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        13520099
135300*          IF GOH-IND = N    ADD OTHER-COUNT TO FOLD-COUNT        13530099
135400*      IF HANG-COUNT >  FOLD-COUNT =====  STORE-ZONE HANG         13540099
135500*         ELSE                                                    13550099
135600*      STORE-ZONE FOR P2L WILL BE FOLD                            13560099
135700*                                                                 13570099
135800* ELSE                                                            13580099
135900*                                                                 13590099
136000*   IF DC IS PROCESSING P2L AS HANG/COMMODITY AND                 13600099
136100*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          13610099
136200*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        13620099
136300*          IF GOH-IND = N    ADD OTHER-COUNT TO COMMODITY-COUNT   13630099
136400*      IF HANG-COUNT >  COMMODITY-COUNT =====  STORE-ZONE HANG    13640099
136500*         ELSE                                                    13650099
136600*      STORE-ZONE FOR P2L WILL BE COMMODITY                       13660099
136700*                                                                 13670099
136800******************************************************************13680099
136900 4062-CHECK-P2L-PRESENTATION.                                     13690099
137000                                                                  13700099
137100     MOVE ZEROES TO  PV-HANG-COUNT                                13710099
137200                     PV-FOLD-COUNT                                13720099
137300                     PV-OTHER-COUNT.                              13730099
137400                                                                  13740099
137500*                                                                 13750099
137600*** CHECK TO SEE IF THE STORE ZONE IS PROCESSED AS HANG/FOLD      13760099
137700*** initially set up as CHILD, MENS, JRS, WOMEN                   13770099
137800*                                                                 13780099
137900     IF  PV-HANG-FOLD       OR                                    13790099
138000         PV-HANG-COMMODITY                                        13800099
138100         PERFORM 4063-CHECK-HANG-FOLD                             13810099
138200     END-IF.                                                      13820099
138300                                                                  13830099
138400*                                                                 13840099
138500*** COUNT THE NUMBER OF LINES ON THE RCVR WITH HANG PRESENTATION  13850099
138600*                                                                 13860099
138700     IF  PS-P2L-AS-HNGFLD-YES                                     13870099
138800         IF  PS-HANG-FOLD       OR                                13880099
138900             PS-HANG-COMMODITY                                    13890099
139000             PERFORM 4064-COUNT-HANG                              13900099
139100         END-IF                                                   13910099
139200     END-IF.                                                      13920099
139300                                                                  13930099
139400*                                                                 13940099
139500*** COUNT THE NUMBER OF LINES ON THE RCVR WITH FOLD PRESENTATION  13950099
139600*                                                                 13960099
139700     IF  PS-P2L-AS-HNGFLD-YES                                     13970099
139800         IF  PS-HANG-FOLD                                         13980099
139900         PERFORM 4065-COUNT-FOLD                                  13990099
140000         END-IF                                                   14000099
140100     END-IF.                                                      14010099
140200                                                                  14020099
140300*                                                                 14030099
140400*** COUNT THE NUMBER OF LINES ON THE RCVR FOR COMMODITY           14040099
140500*                                                                 14050099
140600     IF  PS-P2L-AS-HNGFLD-YES                                     14060099
140700         IF  PS-HANG-COMMODITY                                    14070099
140800             PERFORM 4066-COUNT-COMMODITY                         14080099
140900         END-IF                                                   14090099
141000     END-IF.                                                      14100099
141100                                                                  14110099
141200*                                                                 14120099
141300*** COUNT THE NUMBER OF LINES ON THE RCVR NOT H/F PRESENTATION    14130099
141400*                                                                 14140099
141500     IF  PS-P2L-AS-HNGFLD-YES                                     14150099
141600         IF  PS-HANG-FOLD                                         14160099
141700             PERFORM 4067-COUNT-OTHER                             14170099
141800         END-IF                                                   14180099
141900     END-IF.                                                      14190099
142000                                                                  14200099
142100*                                                                 14210099
142200* DC PROCESSING P2L AS HANG/FOLD                                  14220099
142300* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   14230099
142400*                                                                 14240099
142500* DC PROCESSING P2L AS HANG/FOLD                                  14250099
142600* VENDOR HANGER AGREEMENT (GOH-IND = N) ADD OTHER TO FOLD-COUNT   14260099
142700*                                                                 14270099
142800     IF  PS-P2L-AS-HNGFLD-YES                                     14280099
142900         IF  PS-HANG-FOLD                                         14290099
143000             IF  PS-HANGER-AGREEMENT                              14300099
143100                 ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT           14310099
143200                 MOVE ZEROES          TO  PV-OTHER-COUNT          14320099
143300             ELSE                                                 14330099
143400                 ADD  PV-OTHER-COUNT  TO  PV-FOLD-COUNT           14340099
143500                 MOVE ZEROES          TO  PV-OTHER-COUNT          14350099
143600             END-IF                                               14360099
143700         END-IF                                                   14370099
143800     END-IF.                                                      14380099
143900                                                                  14390099
144000*                                                                 14400099
144100* DC PROCESSING P2L AS HANG/COMMODITY                             14410099
144200* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   14420099
144300*                                                                 14430099
144400     IF  PS-P2L-AS-HNGFLD-YES                                     14440099
144500         IF  PS-HANG-COMMODITY                                    14450099
144600             IF  PS-HANGER-AGREEMENT                              14460099
144700                 ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT           14470099
144800                 MOVE ZEROES          TO  PV-OTHER-COUNT          14480099
144900             END-IF                                               14490099
145000         END-IF                                                   14500099
145100     END-IF.                                                      14510099
145200                                                                  14520099
145300*                                                                 14530099
145400***  IF  DC IS PROCESSING P2L AS HANG/FOLD                        14540099
145500***       IF  HANG-COUNT >=  FOLD COUNT                           14550099
145600***           STORE ZONE WILL BE "HANG"                           14560099
145700***       OHERWISE                                                14570099
145800***           STORE ZONE WILL BE "FOLD"                           14580099
145900*                                                                 14590099
146000     IF  PS-P2L-AS-HNGFLD-YES                                     14600099
146100         IF  PS-HANG-FOLD                                         14610099
146200                                                                  14620099
146300             IF  PV-HANG-COUNT  >  PV-FOLD-COUNT  OR              14630099
146400                 PV-HANG-COUNT  =  PV-FOLD-COUNT                  14640099
146500                 MOVE  'HANG'  TO  PC022-STR-ZN-ID                14650099
146600             ELSE                                                 14660099
146700                 MOVE  'FOLD'  TO  PC022-STR-ZN-ID                14670099
146800             END-IF                                               14680099
146900         END-IF                                                   14690099
147000     END-IF.                                                      14700099
147100                                                                  14710099
147200*                                                                 14720099
147300***  IF  DC IS PROCESSING P2L AS HANG/COMMODITY                   14730099
147400***       IF  HANG-COUNT >=  COMMODITY COUNT                      14740099
147500***           STORE ZONE WILL BE "HANG"                           14750099
147600***       OHERWISE                                                14760099
147700***           STORE ZONE WILL BE COMMODITY                        14770099
147800*                                                                 14780099
147900     IF  PS-P2L-AS-HNGFLD-YES                                     14790099
148000         IF  PS-HANG-COMMODITY                                    14800099
148100             IF  PV-HANG-COUNT  >  PV-COMMODITY-COUNT  OR         14810099
148200                 PV-HANG-COUNT  =  PV-COMMODITY-COUNT             14820099
148300                 MOVE  'HANG'  TO  PC022-STR-ZN-ID                14830099
148400             END-IF                                               14840099
148500         END-IF                                                   14850099
148600     END-IF.                                                      14860099
148700                                                                  14870099
148800                                                                  14880099
148900*----------------------------------------------------------------*14890099
149000* CHECK TO SEE IF THE STORE ZONE FROM TMDSDP IS ONE THAT IS      *14900099
149100* TO BE PROCESSED AS HANG/FOLD IN THE DC'S                       *14910099
149200* DMH ADDED 6/26/12                                              *14920099
149300*----------------------------------------------------------------*14930099
149400 4063-CHECK-HANG-FOLD.                                            14940099
149500                                                                  14950099
149600     SET  PS-P2L-AS-HNGFLD-NO    TO  TRUE.                        14960099
149700     SET  PT-HANG-FOLD-ZONE-IDX  TO  1.                           14970099
149800                                                                  14980099
149900     SEARCH PT-HANG-FOLD-ZONE-ENTRIES                             14990099
150000         WHEN                                                     15000099
150100             PT-HANG-FOLD-ZONE (PT-HANG-FOLD-ZONE-IDX)            15010099
150200                                           = MDSEDP-STR-ZN-ID     15020099
150300                 SET PS-P2L-AS-HNGFLD-YES  TO  TRUE               15030099
150400     END-SEARCH.                                                  15040099
150500                                                                  15050099
150600                                                                  15060099
150700*----------------------------------------------------------------*15070099
150800* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *15080099
150900* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF HANG LINES    *15090099
151000* DMH ADDED 6/26/12                                              *15100099
151100*----------------------------------------------------------------*15110099
151200 4064-COUNT-HANG.                                                 15120099
151300                                                                  15130099
151400     EXEC SQL                                                     15140099
151500          SELECT COUNT(*)                                         15150099
151600            INTO :PV-HANG-COUNT                                   15160099
151700            FROM TRECITM A                                        15170099
151800                ,TPURITM B                                        15180099
151900                ,XLT_SKU C                                        15190099
152000                ,XLT_VND_STYL D                                   15200099
152100           WHERE A.ORD_NBR           = :DK-PO-NBR                 15210099
152200             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            15220099
152300             AND A.ORD_NBR           = B.PO_NBR                   15230099
152400             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           15240099
152500             AND A.VER_STATUS_CDE    = 'A'                        15250099
152600             AND A.PO_VER_NBR        = B.VER_NBR                  15260099
152700             AND B.ITM_NBR           = C.ITM_NBR                  15270099
152800             AND C.STYL_ID           = D.STYL_ID                  15280099
152900             AND D.HNG_FOLD_DESC     = 'HANG'                     15290099
153000              WITH UR                                             15300099
153100     END-EXEC.                                                    15310099
153200                                                                  15320099
153300     EVALUATE TRUE                                                15330099
153400         WHEN SQLCODE = +0                                        15340099
153500              CONTINUE                                            15350099
153600         WHEN SQLCODE = +100                                      15360099
153700              MOVE ZERO              TO  PV-HANG-COUNT            15370099
153800         WHEN SQLWARN0 NOT = SPACES                               15380099
153900         WHEN SQLCODE NOT = ZERO                                  15390099
154000              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      15400099
154100              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    15410099
154200              MOVE '4064-COUNT-HANG'    TO PV-ABEND-PARAGRAPH     15420099
154300              STRING ' PO/RCVR/LNE '                              15430099
154400                       PV-DISPLAY-PO-NBR                          15440099
154500                     '/'                                          15450099
154600                       PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE   15460099
154700                                 INTO PV-DB2-OPERATION-MESSAGE-2  15470099
154800              MOVE SQLCODE               TO PV-SQLCODE            15480099
154900              MOVE 'COUNT THE NUMBER OF LINE FOR HANG  '          15490099
155000                                   TO PV-DB2-OPERATION-MESSAGE-1  15500099
155100              MOVE 'FROM THE ABOVE TABLES              '          15510099
155200                                   TO PV-DB2-OPERATION-MESSAGE-2  15520099
155300              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME-1          15530099
155400              MOVE 'TPURITM '     TO PV-DB2-TABLE-NAME-2          15540099
155500              MOVE 'XLT_SKU '     TO PV-DB2-TABLE-NAME-3          15550099
155600              MOVE 'XLT_VND_STYL' TO PV-DB2-TABLE-NAME-4          15560099
155700             PERFORM 9999-SQL-ABEND                               15570099
155800                                                                  15580099
155900     END-EVALUATE.                                                15590099
156000                                                                  15600099
156100                                                                  15610099
156200*----------------------------------------------------------------*15620099
156300* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *15630099
156400* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF FOLD LINES    *15640099
156500* DMH ADDED 6/26/12                                              *15650099
156600*----------------------------------------------------------------*15660099
156700 4065-COUNT-FOLD.                                                 15670099
156800                                                                  15680099
156900     EXEC SQL                                                     15690099
157000          SELECT COUNT(*)                                         15700099
157100            INTO :PV-FOLD-COUNT                                   15710099
157200            FROM TRECITM A                                        15720099
157300                ,TPURITM B                                        15730099
157400                ,XLT_SKU C                                        15740099
157500                ,XLT_VND_STYL D                                   15750099
157600           WHERE A.ORD_NBR           = :DK-PO-NBR                 15760099
157700             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            15770099
157800             AND A.ORD_NBR           = B.PO_NBR                   15780099
157900             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           15790099
158000             AND A.VER_STATUS_CDE    = 'A'                        15800099
158100             AND A.PO_VER_NBR        = B.VER_NBR                  15810099
158200             AND B.ITM_NBR           = C.ITM_NBR                  15820099
158300             AND C.STYL_ID           = D.STYL_ID                  15830099
158400             AND D.HNG_FOLD_DESC     = 'FOLD'                     15840099
158500              WITH UR                                             15850099
158600     END-EXEC.                                                    15860099
158700                                                                  15870099
158800     EVALUATE TRUE                                                15880099
158900         WHEN SQLCODE = +0                                        15890099
159000              CONTINUE                                            15900099
159100         WHEN SQLCODE = +100                                      15910099
159200              MOVE ZERO              TO  PV-HANG-COUNT            15920099
159300         WHEN SQLWARN0 NOT = SPACES                               15930099
159400         WHEN SQLCODE NOT = ZERO                                  15940099
159500              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      15950099
159600              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    15960099
159700              MOVE '4065-COUNT-FOLD'    TO PV-ABEND-PARAGRAPH     15970099
159800              STRING ' PO/RCVR/LNE '                              15980099
159900                       PV-DISPLAY-PO-NBR                          15990099
160000                     '/'                                          16000099
160100                       PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE   16010099
160200                                 INTO PV-DB2-OPERATION-MESSAGE-2  16020099
160300              MOVE SQLCODE               TO PV-SQLCODE            16030099
160400              MOVE 'COUNT THE NUMBER OF LINE FOR FOLD  '          16040099
160500                                   TO PV-DB2-OPERATION-MESSAGE-1  16050099
160600              MOVE 'FROM THE ABOVE TABLES              '          16060099
160700                                   TO PV-DB2-OPERATION-MESSAGE-2  16070099
160800              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME-1          16080099
160900              MOVE 'TPURITM '     TO PV-DB2-TABLE-NAME-2          16090099
161000              MOVE 'XLT_SKU '     TO PV-DB2-TABLE-NAME-3          16100099
161100              MOVE 'XLT_VND_STYL' TO PV-DB2-TABLE-NAME-4          16110099
161200             PERFORM 9999-SQL-ABEND                               16120099
161300                                                                  16130099
161400     END-EVALUATE.                                                16140099
161500                                                                  16150099
161600                                                                  16160099
161700*----------------------------------------------------------------*16170099
161800* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *16180099
161900* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF <> HANG LINES *16190099
162000* DMH ADDED 6/26/12                                              *16200099
162100*----------------------------------------------------------------*16210099
162200 4066-COUNT-COMMODITY.                                            16220099
162300                                                                  16230099
162400     EXEC SQL                                                     16240099
162500          SELECT COUNT(*)                                         16250099
162600            INTO :PV-COMMODITY-COUNT                              16260099
162700            FROM TRECITM A                                        16270099
162800                ,TPURITM B                                        16280099
162900                ,XLT_SKU C                                        16290099
163000                ,XLT_VND_STYL D                                   16300099
163100           WHERE A.ORD_NBR           = :DK-PO-NBR                 16310099
163200             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            16320099
163300             AND A.ORD_NBR           = B.PO_NBR                   16330099
163400             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           16340099
163500             AND A.VER_STATUS_CDE    = 'A'                        16350099
163600             AND A.PO_VER_NBR        = B.VER_NBR                  16360099
163700             AND B.ITM_NBR           = C.ITM_NBR                  16370099
163800             AND C.STYL_ID           = D.STYL_ID                  16380099
163900             AND D.HNG_FOLD_DESC    <> 'HANG'                     16390099
164000              WITH UR                                             16400099
164100     END-EXEC.                                                    16410099
164200                                                                  16420099
164300     EVALUATE TRUE                                                16430099
164400         WHEN SQLCODE = +0                                        16440099
164500              CONTINUE                                            16450099
164600         WHEN SQLCODE = +100                                      16460099
164700              MOVE ZERO              TO  PV-HANG-COUNT            16470099
164800         WHEN SQLWARN0 NOT = SPACES                               16480099
164900         WHEN SQLCODE NOT = ZERO                                  16490099
165000              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      16500099
165100              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    16510099
165200              MOVE '4066-COUNT-COMMODITY'                         16520099
165300                                        TO PV-ABEND-PARAGRAPH     16530099
165400              STRING ' PO/RCVR/LNE '                              16540099
165500                       PV-DISPLAY-PO-NBR                          16550099
165600                     '/'                                          16560099
165700                       PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE   16570099
165800                                 INTO PV-DB2-OPERATION-MESSAGE-2  16580099
165900              MOVE SQLCODE               TO PV-SQLCODE            16590099
166000              MOVE 'COUNT THE NUMBER OF LINE FOR COMMODITY'       16600099
166100                                   TO PV-DB2-OPERATION-MESSAGE-1  16610099
166200              MOVE 'FROM THE ABOVE TABLES              '          16620099
166300                                   TO PV-DB2-OPERATION-MESSAGE-2  16630099
166400              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME-1          16640099
166500              MOVE 'TPURITM '     TO PV-DB2-TABLE-NAME-2          16650099
166600              MOVE 'XLT_SKU '     TO PV-DB2-TABLE-NAME-3          16660099
166700              MOVE 'XLT_VND_STYL' TO PV-DB2-TABLE-NAME-4          16670099
166800             PERFORM 9999-SQL-ABEND                               16680099
166900                                                                  16690099
167000     END-EVALUATE.                                                16700099
167100                                                                  16710099
167200                                                                  16720099
167300*----------------------------------------------------------------*16730099
167400* CHECK TO SEE HOW MANY LINES HAVE SOMETHING OTHER THAN HANG OR  *16740099
167500* FOLD                                                           *16750099
167600* DMH ADDED 6/26/12                                              *16760099
167700*----------------------------------------------------------------*16770099
167800 4067-COUNT-OTHER.                                                16780099
167900                                                                  16790099
168000     EXEC SQL                                                     16800099
168100          SELECT COUNT(*)                                         16810099
168200            INTO :PV-OTHER-COUNT                                  16820099
168300            FROM TRECITM A                                        16830099
168400                ,TPURITM B                                        16840099
168500                ,XLT_SKU C                                        16850099
168600                ,XLT_VND_STYL D                                   16860099
168700           WHERE A.ORD_NBR            =  :DK-PO-NBR               16870099
168800             AND A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR          16880099
168900             AND A.ORD_NBR            =  B.PO_NBR                 16890099
169000             AND A.ORD_LNE_NBR        =  B.APP_PO_LNE_NBR         16900099
169100             AND A.VER_STATUS_CDE     =  'A'                      16910099
169200             AND A.PO_VER_NBR         =  B.VER_NBR                16920099
169300             AND B.ITM_NBR            =  C.ITM_NBR                16930099
169400             AND C.STYL_ID            =  D.STYL_ID                16940099
169500             AND NOT D.HNG_FOLD_DESC IN ('FOLD', 'HANG')          16950099
169600              WITH UR                                             16960099
169700     END-EXEC.                                                    16970099
169800                                                                  16980099
169900     EVALUATE TRUE                                                16990099
170000         WHEN SQLCODE = +0                                        17000099
170100              CONTINUE                                            17010099
170200         WHEN SQLCODE = +100                                      17020099
170300              MOVE ZERO              TO  PV-OTHER-COUNT           17030099
170400         WHEN SQLWARN0 NOT = SPACES                               17040099
170500         WHEN SQLCODE NOT = ZERO                                  17050099
170600              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      17060099
170700              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    17070099
170800              MOVE '4067-COUNT-OTHER'   TO PV-ABEND-PARAGRAPH     17080099
170900              STRING ' PO/RCVR/LNE '                              17090099
171000                       PV-DISPLAY-PO-NBR                          17100099
171100                     '/'                                          17110099
171200                       PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE   17120099
171300                                 INTO PV-DB2-OPERATION-MESSAGE-2  17130099
171400              MOVE SQLCODE               TO PV-SQLCODE            17140099
171500              MOVE 'COUNT THE NUMBER OF LINE NON H/F      '       17150099
171600                                   TO PV-DB2-OPERATION-MESSAGE-1  17160099
171700              MOVE 'FROM THE ABOVE TABLES              '          17170099
171800                                   TO PV-DB2-OPERATION-MESSAGE-2  17180099
171900              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME-1          17190099
172000              MOVE 'TPURITM '     TO PV-DB2-TABLE-NAME-2          17200099
172100              MOVE 'XLT_SKU '     TO PV-DB2-TABLE-NAME-3          17210099
172200              MOVE 'XLT_VND_STYL' TO PV-DB2-TABLE-NAME-4          17220099
172300             PERFORM 9999-SQL-ABEND                               17230099
172400     END-EVALUATE.                                                17240099
172500                                                                  17250099
172600                                                                  17260099
172700******************************************************************17270099
172800* GETS THE PRCS-CDE BASED ON THE PACK_BY_STORE IND AND A SQL CALL*17280099
172900******************************************************************17290099
173000 4070-GET-PRCS-CDE.                                               17300099
173100                                                                  17310099
173200         MOVE '4070-GET-PRCS-CDE.'  TO PV-ABEND-PARAGRAPH.        17320099
173300         INITIALIZE PV-FCSE-INPK-CART-CNT                         17330099
173400                    PV-P2L-CART-CNT                               17340099
173500                    DN-NULL-IND-FCSE                              17350099
173600                    DN-NULL-IND-P2L.                              17360099
173700                                                                  17370099
173800         EVALUATE TRUE                                            17380099
173900             WHEN PS-PACK-BY-STORE                                17390099
174000                  MOVE PC-PBS           TO PC022-PRCS-CDE         17400099
174100             WHEN PS-NOT-PACK-BY-STORE                            17410099
174200                                                                  17420099
174300                  MOVE PV-PREV-PO-NBR           TO DK-PO-NBR.     17430099
174400                  MOVE PV-PREV-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.17440099
174500                                                                  17450099
174600                EXEC SQL                                          17460099
174700                   SELECT (SUM(FCSE_CART_CNT) +                   17470099
174800                              SUM(INPK_CART_CNT))                 17480099
174900                         , SUM(P2L_CART_CNT)                      17490099
175000                   INTO   :PV-DB2-DISTHD-FCSE-CART-CNT            17500099
175100                               :DN-NULL-IND-FCSE                  17510099
175200                         ,:PV-DB2-DISTHD-P2L-CART-CNT             17520099
175300                               :DN-NULL-IND-P2L                   17530099
175400                   FROM   TDISTHD                                 17540099
175500                   WHERE  ORD_NBR        = :DK-PO-NBR             17550099
175600                     AND  RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR        17560099
175700                     WITH UR                                      17570099
175800                END-EXEC                                          17580099
175900                                                                  17590099
176000                  EVALUATE TRUE                                   17600099
176100                      WHEN SQLCODE = +100                         17610099
176200                           MOVE SPACES         TO PC022-PRCS-CDE  17620099
176300                      WHEN SQLCODE = ZERO                         17630099
176400                                                                  17640099
176500                           IF  DN-NULL-IND-FCSE < +0              17650099
176600                               MOVE 0 TO                          17660099
176700                                   PV-DB2-DISTHD-FCSE-CART-CNT    17670099
176800                           END-IF                                 17680099
176900                                                                  17690099
177000                           IF  DN-NULL-IND-P2L < +0               17700099
177100                               MOVE 0 TO                          17710099
177200                                   PV-DB2-DISTHD-P2L-CART-CNT     17720099
177300                           END-IF                                 17730099
177400                                                                  17740099
177500                           IF (PV-DB2-DISTHD-FCSE-CART-CNT  > +0) 17750099
177600                            AND (PV-DB2-DISTHD-P2L-CART-CNT = +0) 17760099
177700                                MOVE PC-FCSE   TO PC022-PRCS-CDE  17770099
177800*                          END-IF                                 17780099
177900                           ELSE                                   17790099
178000                           IF (PV-DB2-DISTHD-FCSE-CART-CNT  = +0) 17800099
178100                           AND                                    17810099
178200                              (PV-DB2-DISTHD-P2L-CART-CNT = +0)   17820099
178300                                MOVE SPACES    TO PC022-PRCS-CDE  17830099
178400*                          END-IF                                 17840099
178500                           ELSE                                   17850099
178600                           IF (PV-DB2-DISTHD-FCSE-CART-CNT  > +0) 17860099
178700                           AND                                    17870099
178800                              (PV-DB2-DISTHD-P2L-CART-CNT > +0)   17880099
178900                                MOVE PC-FCS-P2L TO PC022-PRCS-CDE 17890099
179000*                          END-IF                                 17900099
179100                           ELSE                                   17910099
179200                           IF (PV-DB2-DISTHD-FCSE-CART-CNT  = +0) 17920099
179300                           AND                                    17930099
179400                              (PV-DB2-DISTHD-P2L-CART-CNT > +0)   17940099
179500                                MOVE PC-P2L     TO PC022-PRCS-CDE 17950099
179600                           END-IF                                 17960099
179700                           END-IF                                 17970099
179800                           END-IF                                 17980099
179900                           END-IF                                 17990099
180000                      WHEN OTHER                                  18000099
180100                          MOVE  SQLCODE          TO  PV-SQLCODE   18010099
180200                          MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO18020099
180300                          MOVE  DK-REC-SEQ-NBR                    18030099
180400                                        TO  PV-DISPLAY-REC-SEQ-NBR18040099
180500                          MOVE '4070-GET-PRCS-CDE     '           18050099
180600                                        TO PV-ABEND-PARAGRAPH     18060099
180700                          MOVE 'GETTING PROCESS CODE    '         18070099
180800                                     TO PV-DB2-OPERATION-MESSAGE-118080099
180900                          STRING ' PO-RECV - '  DELIMITED BY SIZE 18090099
181000                           PV-DISPLAY-PO '-'    DELIMITED BY SIZE 18100099
181100                         PV-DISPLAY-REC-SEQ-NBR  DELIMITED BY SIZE18110099
181200                                   INTO PV-DB2-OPERATION-MESSAGE-218120099
181300                          MOVE 'TDISTHD'  TO PV-DB2-TABLE-NAME-1  18130099
181400                          PERFORM 9999-SQL-ABEND                  18140099
181500         END-EVALUATE.                                            18150099
181600                                                                  18160099
181700/                                                                 18170099
181800******************************************************************18180099
181900* GETS THE PRCS-CDE BASED ON THE PACK_BY_STORE IND AND A SQL CALL*18190099
182000******************************************************************18200099
182100 4080-CHECK-FOR-FULFILLMENT.                                      18210099
182200                                                                  18220099
182300     MOVE '4080-CHECK-FOR-FULFILLMENT'   TO PV-ABEND-PARAGRAPH.   18230099
182400     MOVE PC002-LOGICAL-OPER TO DK-LOC-NBR.                       18240099
182500     SET PS-FULFILLMENT-CENTER-NO TO TRUE.                        18250099
182600                                                                  18260099
182700     EXEC SQL                                                     18270099
182800         SELECT LOC_NBR                                           18280099
182900           INTO :XLT00010-LOC-NBR                                 18290099
183000           FROM XLT_LOC                                           18300099
183100          WHERE LOC_NBR         =  :DK-LOC-NBR                    18310099
183200            AND LOC_TYP_CDE     =  'DC'                           18320099
183300            AND E_BUS_IND       =  'Y'                            18330099
183400         WITH UR                                                  18340099
183500     END-EXEC.                                                    18350099
183600                                                                  18360099
183700     EVALUATE TRUE                                                18370099
183800         WHEN SQLCODE = +0                                        18380099
183900              SET PS-FULFILLMENT-CENTER TO TRUE                   18390099
184000         WHEN SQLCODE = +100                                      18400099
184100              CONTINUE                                            18410099
184200         WHEN SQLWARN0 NOT = SPACES                               18420099
184300         WHEN SQLCODE NOT = ZERO                                  18430099
184400              MOVE DK-LOC-NBR           TO PV-DISPLAY-LOC-NBR     18440099
184500              MOVE '4080-CHECK-FOR-FULFILLMENT'                   18450099
184600                                        TO PV-ABEND-PARAGRAPH     18460099
184700              STRING ' LOC NUMBER '                               18470099
184800                       PV-DISPLAY-LOC-NBR     DELIMITED BY SIZE   18480099
184900                                 INTO PV-DB2-OPERATION-MESSAGE-2  18490099
185000              MOVE SQLCODE               TO PV-SQLCODE            18500099
185100              MOVE 'CHECK IF DC IS A FULFILLMENT CENTER   '       18510099
185200                                   TO PV-DB2-OPERATION-MESSAGE-1  18520099
185300              MOVE 'FROM THE FOLLOWING TABLE           '          18530099
185400                                   TO PV-DB2-OPERATION-MESSAGE-2  18540099
185500              MOVE 'XLT_LOC '     TO PV-DB2-TABLE-NAME-1          18550099
185600             PERFORM 9999-SQL-ABEND                               18560099
185700     END-EVALUATE.                                                18570099
185701                                                                  18570199
185710******************************************************************18571099
185720* GETS THE OTB INFORMATION FOR THE PO                            *18572099
185730******************************************************************18573099
185740 4090-GET-OTB.                                                    18574099
185750                                                                  18575099
185751*** PRB0064829 start                                              18575199
185752* Commenting out codes to get OTB week details. This info         18575299
185753* is already present in input file and same will be moved         18575399
185754* to output file                                                  18575499
185760*    PERFORM 4092-GET-OTB-PERIOD.                                 18576099
185761                                                                  18576199
185762*    MOVE PLNSHP-DONT-SHIP-BEF-DTE   TO POWS055-INPUT-DATE.       18576299
185763*    PERFORM POPD055-CALC-WEEKLY-OTB.                             18576399
185764*    IF POWS055-NO-ERROR                                          18576499
185765*          MOVE POWS055-OTB-FSCL-WEEK-NBR                         18576599
185766*                                   TO PC022-OTB-WEEK-NBR         18576699
185767*    ELSE                                                         18576799
185768*          MOVE ' ' TO PC022-OTB-WEEK-NBR                         18576899
185769*    END-IF.                                                      18576999
185783                                                                  18578399
185784     MOVE PC002-OPEN-TO-BUY-PERIOD   TO PC022-OTB-PERIOD.         18578499
185785     MOVE PC002-OPEN-TO-BUY-WEEK-NBR TO PC022-OTB-WEEK-NBR.       18578599
185786*** PRB0064829 end                                                18578699
185787******************************************************************18578799
185788* GETS THE OTB PERIOD FROM TPURCHS                               *18578899
185789******************************************************************18578999
185790 4092-GET-OTB-PERIOD.                                             18579099
185791                                                                  18579199
185792      MOVE '4092-GET-OTB-PERIOD'     TO PV-ABEND-PARAGRAPH.       18579299
185793      MOVE PV-PREV-PO-NBR            TO DK-PO-NBR.                18579399
185794      MOVE PV-PREV-REC-SEQ-NBR       TO DK-REC-SEQ-NBR.           18579499
185795                                                                  18579599
185796         EXEC SQL                                                 18579699
185797             SELECT A.OTB_PER_NBR                                 18579799
185798                  , B.DONT_SHIP_BEF_DTE                           18579899
185799               INTO :PURCHS-OTB-PER-NBR                           18579999
185800                  , :PLNSHP-DONT-SHIP-BEF-DTE                     18580099
185801               FROM TPURCHS A                                     18580199
185802                  , TPLNSHP B                                     18580299
185803              WHERE A.PO_NBR         = :DK-PO-NBR                 18580399
185804                AND A.VER_STATUS_CDE = 'A'                        18580499
185805                AND B.PO_NBR         = A.PO_NBR                   18580599
185806                AND B.VER_STATUS_CDE = 'A'                        18580699
185809                WITH UR                                           18580999
185810         END-EXEC                                                 18581099
185811                                                                  18581199
185812         EVALUATE TRUE                                            18581299
185813             WHEN SQLCODE = +0                                    18581399
185814                  MOVE  PURCHS-OTB-PER-NBR                        18581499
185815                            TO  PC022-OTB-PERIOD                  18581599
185816             WHEN SQLCODE = +100                                  18581699
185817                  MOVE SPACES TO PC022-OTB-PERIOD                 18581799
185818                                                                  18581899
185819             WHEN OTHER                                           18581999
185820                  MOVE '4092-GET-OTB-PERIOD'                      18582099
185821                                   TO PV-ABEND-PARAGRAPH          18582199
185822                  MOVE 'SELECT OTB PERIOD'                        18582299
185823                                   TO PV-DB2-OPERATION-MESSAGE-1  18582399
185824                  MOVE SQLCODE     TO PV-SQLCODE                  18582499
185825                  MOVE 'TPURCHS '  TO PV-DB2-TABLE-NAME-1         18582599
185826                  PERFORM 9999-SQL-ABEND                          18582699
185827         END-EVALUATE.                                            18582799
185830                                                                  18583099
185900******************************************************************18590099
186000* INCREMENTS TOTALS FOR SAME PO/RECEIVER                         *18600099
186100******************************************************************18610099
186200 5000-INCREMENT-RECORD-TOTALS.                                    18620099
186300                                                                  18630099
186400     MOVE '5000-INCREMENT-RECORD-TOTALS.'  TO PV-ABEND-PARAGRAPH. 18640099
186500     ADD +1                          TO PV-NBR-PO-LINES.          18650099
186600     ADD PC002-PKSL-ITM-QTY          TO PV-PKSLP-ITM-QTY.         18660099
186700     MOVE PV-PKSLP-ITM-QTY           TO PC022-PKSLP-ITM-QTY.      18670099
186800     PERFORM 4040-GET-PRESENT-CDE.                                18680099
186900     PERFORM 6000-POPULATE-QTY-FIELDS.                            18690099
187000/                                                                 18700099
187100******************************************************************18710099
187200* POPULATES JWLRY CRTN/UNIT QTY FIELDS                           *18720099
187300******************************************************************18730099
187400 6000-POPULATE-QTY-FIELDS.                                        18740099
187500                                                                  18750099
187600     MOVE '6000-POPULATE-QTY-FIELDS.'    TO PV-ABEND-PARAGRAPH.   18760099
187700                                                                  18770099
187800     IF  PC002-DEPT-NBR  =  SPACES                                18780099
187900         MOVE  ZEROES  TO  PV-DEPT-NUM                            18790099
188000     ELSE                                                         18800099
188100         MOVE  PC002-DEPT-NBR  TO  PV-DEPT-HOLD                   18810099
188200     END-IF.                                                      18820099
188300                                                                  18830099
188400     MOVE  PV-DEPT-NUM             TO  PV-ATTR-DEPT.              18840099
188500     SET   PS-NOT-JEWELRY-DEPT     TO  TRUE.                      18850099
188600                                                                  18860099
188700     EXEC SQL                                                     18870099
188800          SELECT C.INTGRTN_TYP_CDE                                18880099
188900            INTO :WST00010-INTGRTN-TYP-CDE                        18890099
189000            FROM WST_INTGRTN_TYP A                                18900099
189100               , WST_ATTR_DEFN   B                                18910099
189200               , WST_ATTR_ELEM   C                                18920099
189300           WHERE A.INTGRTN_TYP_CDE    =  'JEWLRYDEPT'             18930099
189400             AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE        18940099
189500             AND B.ATTR_DEFN_SEQ_NBR  =  1                        18950099
189600             AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE        18960099
189700             AND C.ATTR_DEFN_SEQ_NBR  =  1                        18970099
189800             AND C.ATTR_ELEM_NBR      =  :PV-ATTR-DEPT            18980099
189900              WITH UR                                             18990099
190000     END-EXEC.                                                    19000099
190100                                                                  19010099
190200     EVALUATE TRUE                                                19020099
190300         WHEN SQLCODE = +0                                        19030099
190400              SET PS-JEWELRY-DEPT        TO TRUE                  19040099
190500         WHEN SQLCODE = +100                                      19050099
190600              CONTINUE                                            19060099
190700         WHEN SQLWARN0 NOT = SPACE                                19070099
190800         WHEN SQLCODE  NOT = +0                                   19080099
190900              MOVE  SQLCODE          TO  PV-SQLCODE               19090099
191000              MOVE 'SELECT JEWELRY'  TO PV-DB2-OPERATION-MESSAGE-119100099
191100              MOVE 'WST_INTGRTN_TYP' TO PV-DB2-TABLE-NAME-1       19110099
191200              MOVE 'WST_ATTR_DEFN'   TO PV-DB2-TABLE-NAME-2       19120099
191300              MOVE 'WST_ATTR_ELEM'   TO PV-DB2-TABLE-NAME-3       19130099
191400             PERFORM 9999-SQL-ABEND                               19140099
191500     END-EVALUATE.                                                19150099
191600                                                                  19160099
191700                                                                  19170099
191800     IF PS-JEWELRY-DEPT                                           19180099
191900                                                                  19190099
192000         IF PV-PO-REC-CNT = 1                                     19200099
192100            MOVE PC002-CART-CNT     TO  PC022-JWLRY-CRTN-QTY      19210099
192200            ADD  PC002-PKSL-ITM-QTY TO  PV-JWLRY-UNIT-QTY         19220099
192300            MOVE PV-JWLRY-UNIT-QTY  TO  PC022-JWLRY-UNIT-QTY      19230099
192400                                                                  19240099
192500                                                                  19250099
192600            MOVE ZERO               TO  PC022-CRSDCK-CRTN-QTY     19260099
192700                                        PC022-P2L-CRTN-QTY        19270099
192800                                        PC022-HRTW-CRTN-QTY       19280099
192900                                        PC022-CRSDCK-UNIT-QTY     19290099
193000                                        PC022-P2L-UNIT-QTY        19300099
193100                                        PC022-HRTW-UNIT-QTY       19310099
193200         ELSE                                                     19320099
193300            ADD PC002-PKSL-ITM-QTY  TO PV-JWLRY-UNIT-QTY          19330099
193400            MOVE PV-JWLRY-UNIT-QTY  TO PC022-JWLRY-UNIT-QTY       19340099
193500                                                                  19350099
193600         END-IF                                                   19360099
193700                                                                  19370099
193800                                                                  19380099
193900     ELSE                                                         19390099
194000*     MOVE ZERO TO JWLRY FIELDS AND CONTINUE TO CHECK FOR         19400099
194100*     EITHER A CRSDCK CARTON OR BULK MERCHANDISE                  19410099
194200                                                                  19420099
194300          MOVE ZERO                 TO  PC022-JWLRY-CRTN-QTY      19430099
194400                                        PC022-JWLRY-UNIT-QTY      19440099
194500          PERFORM 7000-CRSDCK-CRTN-CHECK                          19450099
194600     END-IF.                                                      19460099
194700/                                                                 19470099
194701******************************************************************19470199
194702* THIS PARAGRAPH WILL LOAD UP THE RECEIVER CODE WITH A VALUE TO  *19470299
194703* INDICATE IF THE RECEIVER IS AN LFC RECEIVER OR EFC RECEIVER.   *19470399
194704******************************************************************19470499
194710 6200-LOAD-RCVR-CDE.                                              19471099
194711                                                                  19471199
194713     MOVE PC002-LOGICAL-OPER TO DK-RCVR-OPER-UNT-ID.              19471399
194714                                                                  19471499
194715     IF  DK-RCVR-OPER-UNT-ID = PV-PREV-RCVR-OPER-UNT-ID           19471599
194717         MOVE PV-PREV-RCVR-CDE TO PC022-LFC-EFC-RCVR-CDE          19471799
194718     ELSE                                                         19471899
194720         PERFORM 6210-GET-RCVR-CDE                                19472099
194721         MOVE DK-RCVR-OPER-UNT-ID TO PV-PREV-RCVR-OPER-UNT-ID     19472199
194722         MOVE PV-PREV-RCVR-CDE TO PC022-LFC-EFC-RCVR-CDE          19472299
194723     END-IF.                                                      19472399
194724                                                                  19472499
194725******************************************************************19472599
194726* THIS PARAGRAPH WILL EXECUTE SQL TO GET THE RECEIVER CODE       *19472699
194727* VALUE.                                                         *19472799
194728******************************************************************19472899
194729 6210-GET-RCVR-CDE.                                               19472999
194730                                                                  19473099
194731     MOVE '6210-GET-RCVR-CDE'    TO PV-ABEND-PARAGRAPH.           19473199
194732                                                                  19473299
194733     EXEC SQL                                                     19473399
194734          SELECT T1.LOC_NBR                                       19473499
194735               , T1.LOC_TYP_CDE                                   19473599
194736               , T1.E_BUS_IND                                     19473699
194737               , T2.FUNC_TXT                                      19473799
194738            INTO :PV-INTO-OPER-UNT-ID                             19473899
194739               , :PV-INTO-LOC-TYP-CDE                             19473999
194740               , :PV-INTO-E-BUS-IND                               19474099
194741               , :PV-INTO-FUNC-TXT   :DN-NULL-FUNC-TXT            19474199
194742            FROM                                                  19474299
194743          (                                                       19474399
194744           SELECT A.LOC_NBR                                       19474499
194745                , A.LOC_TYP_CDE                                   19474599
194746                , A.E_BUS_IND                                     19474699
194747             FROM XLT_LOC A                                       19474799
194748            WHERE A.LOC_NBR         = :DK-RCVR-OPER-UNT-ID        19474899
194749            ) AS T1                                               19474999
194750                                                                  19475099
194751           LEFT OUTER JOIN                                        19475199
194752           (                                                      19475299
194753           SELECT B.LOC_ID                                        19475399
194754                , B.FUNC_TXT                                      19475499
194755             FROM TKRPRPM B                                       19475599
194756            WHERE B.LOC_ID            = :DK-RCVR-OPER-UNT-ID      19475699
194757              AND B.INTFC_SYS_CDE     = 'KHL'                     19475799
194758             AND B.SYS_PRC_FUNC_CDE  = 'LFCEFC'                   19475899
194759             AND B.FUNC_PRC_STAT_CDE = 'AC'                       19475999
194760          ) AS T2                                                 19476099
194761             ON T1.LOC_NBR  =  T2.LOC_ID                          19476199
194762          WITH UR                                                 19476299
194763     END-EXEC.                                                    19476399
194764                                                                  19476499
194765     EVALUATE TRUE                                                19476599
194766         WHEN SQLCODE = +0                                        19476699
194767              IF  DN-NULL-FUNC-TXT < +0                           19476799
194768                  MOVE SPACES TO PV-INTO-FUNC-TXT                 19476899
194769              END-IF                                              19476999
194770              IF  PV-INTO-FUNC-TXT = 'Y'                          19477099
194771                  MOVE 'L' TO PV-PREV-RCVR-CDE                    19477199
194772              ELSE                                                19477299
194773                  IF  PV-INTO-E-BUS-IND = 'Y'                     19477399
194774                      MOVE 'E' TO PV-PREV-RCVR-CDE                19477499
194775                  ELSE                                            19477599
194776                      MOVE ' ' TO PV-PREV-RCVR-CDE                19477699
194777                  END-IF                                          19477799
194778              END-IF                                              19477899
194779         WHEN SQLCODE = +100                                      19477999
194780              MOVE ' ' TO PV-PREV-RCVR-CDE                        19478099
194781         WHEN SQLWARN0 NOT = SPACE                                19478199
194782         WHEN SQLCODE  NOT = +0                                   19478299
194783              MOVE  SQLCODE          TO PV-SQLCODE                19478399
194784              MOVE 'GET RCVR CODE '  TO PV-DB2-OPERATION-MESSAGE-119478499
194785              MOVE 'XLT_LOC        ' TO PV-DB2-TABLE-NAME-1       19478599
194786              MOVE 'TKRPRPM      '   TO PV-DB2-TABLE-NAME-2       19478699
194787              MOVE '             '   TO PV-DB2-TABLE-NAME-3       19478799
194788              DISPLAY 'RECORDS READ AT ABEND: ' PV-RECORDS-READ   19478899
194789              MOVE DK-RCVR-OPER-UNT-ID TO PV-DISPLAY-LOC-NBR      19478999
194790              DISPLAY 'LOC NUMBER IN SQL:     ' PV-DISPLAY-LOC-NBR19479099
194791             PERFORM 9999-SQL-ABEND                               19479199
194792     END-EVALUATE.                                                19479299
194793                                                                  19479399
194794                                                                  19479499
194795/                                                                 19479599
194800******************************************************************19480099
194900* CHECKS FOR A CROSSDOCK CARTON                                  *19490099
195000******************************************************************19500099
195100 7000-CRSDCK-CRTN-CHECK.                                          19510099
195200                                                                  19520099
195300     MOVE '7000-CRSDCK-CRTN-CHECK.' TO PV-ABEND-PARAGRAPH.        19530099
195400                                                                  19540099
195500     IF RECEIV-PACK-BY-ST-IND  = PC-Y                             19550099
195600*       POPULATE CRSDCK CRTN/UNIT QTY FIELDS                      19560099
195700        IF PV-PO-REC-CNT = 1                                      19570099
195800           MOVE PC002-CART-CNT     TO PC022-CRSDCK-CRTN-QTY       19580099
195900           ADD  PC002-PKSL-ITM-QTY TO PV-CRSDCK-UNIT-CT           19590099
196000           MOVE PV-CRSDCK-UNIT-CT  TO PC022-CRSDCK-UNIT-QTY       19600099
196100                                                                  19610099
196200           MOVE ZERO               TO PC022-JWLRY-CRTN-QTY        19620099
196300                                      PC022-P2L-CRTN-QTY          19630099
196400                                      PC022-HRTW-CRTN-QTY         19640099
196500                                      PC022-JWLRY-UNIT-QTY        19650099
196600                                      PC022-P2L-UNIT-QTY          19660099
196700                                      PC022-HRTW-UNIT-QTY         19670099
196800        ELSE                                                      19680099
196900           ADD  PC002-PKSL-ITM-QTY TO PV-CRSDCK-UNIT-CT           19690099
197000           MOVE PV-CRSDCK-UNIT-CT  TO PC022-CRSDCK-UNIT-QTY       19700099
197100        END-IF                                                    19710099
197200     ELSE                                                         19720099
197300         IF PS-FULFILLMENT-CENTER                                 19730099
197400*           POPULATE CRSDCK CRTN/UNIT QTY FIELDS                  19740099
197500            IF PV-PO-REC-CNT = 1                                  19750099
197600               MOVE PC002-CART-CNT     TO PC022-CRSDCK-CRTN-QTY   19760099
197700               ADD  PC002-PKSL-ITM-QTY TO PV-CRSDCK-UNIT-CT       19770099
197800               MOVE PV-CRSDCK-UNIT-CT  TO PC022-CRSDCK-UNIT-QTY   19780099
197900                                                                  19790099
198000               MOVE ZERO               TO PC022-P2L-CRTN-QTY      19800099
198100                                          PC022-HRTW-CRTN-QTY     19810099
198200                                          PC022-P2L-UNIT-QTY      19820099
198300                                          PC022-HRTW-UNIT-QTY     19830099
198400            ELSE                                                  19840099
198500               ADD  PC002-PKSL-ITM-QTY TO PV-CRSDCK-UNIT-CT       19850099
198600               MOVE PV-CRSDCK-UNIT-CT  TO PC022-CRSDCK-UNIT-QTY   19860099
198700            END-IF                                                19870099
198800         ELSE                                                     19880099
198900* RPK 12/27/2013 - MAKING CHANGES TO THIS LOGIC DUE TO            19890099
199000*                  I AND C PACKAGE CODES GOING AWAY.              19900099
199100*                  COMMENTED OUT THE PERFORM 8000 SINCE NOTHING   19910099
199200*                  SHOULD LOG TO HRTW ANYMORE (DC'S DO NOT DO     19920099
199300*                  HRTW).  JUST GO INTO THE 8100 PARAGRAPH TO     19930099
199400*                  FIGURE OUT WHERE TO LOG THE UNITS AND CARTONS. 19940099
199500*           PERFORM 8000-BULK-CRTN                                19950099
199600            PERFORM 8100-GET-FCSE-CRTNS                           19960099
199700         END-IF                                                   19970099
199800     END-IF.                                                      19980099
199900                                                                  19990099
200000/                                                                 20000099
200100******************************************************************20010099
200200* BULK MERCHANDISE                                               *20020099
200300******************************************************************20030099
200400 8000-BULK-CRTN.                                                  20040099
200500                                                                  20050099
200600     MOVE '8000-BULK-CRTN.'           TO PV-ABEND-PARAGRAPH.      20060099
200700                                                                  20070099
200800     IF RECEIV-GOH-IND = PC-N AND PV-PRESENT-CDE = PC-HANG        20080099
200900        MOVE +1                        TO PV-HRTW-CRTN-CT         20090099
201000        ADD PC002-PKSL-ITM-QTY         TO PV-HRTW-UNIT-CT         20100099
201100     ELSE                                                         20110099
201200        PERFORM 8100-GET-FCSE-CRTNS                               20120099
201300     END-IF.                                                      20130099
201400                                                                  20140099
201500/                                                                 20150099
201600******************************************************************20160099
201700*                                                                *20170099
201800******************************************************************20180099
201900 8100-GET-FCSE-CRTNS.                                             20190099
202000                                                                  20200099
202100     MOVE '8100-GET-FCSE-CRTNS.'      TO PV-ABEND-PARAGRAPH.      20210099
202200     MOVE PV-PREV-PO-NBR              TO DK-PO-NBR.               20220099
202300     MOVE PV-PREV-REC-SEQ-NBR         TO DK-REC-SEQ-NBR.          20230099
202400     MOVE PC002-PO-LINE-NBR           TO DK-PO-LINE-NBR.          20240099
202500     INITIALIZE SQLCODE.                                          20250099
202600                                                                  20260099
202700*    DISPLAY  DK-PO-NBR ' / ' DK-REC-SEQ-NBR ' / ' DK-PO-LINE-NBR 20270099
202800                                                                  20280099
202900     EXEC SQL                                                     20290099
203000        SELECT ORD_LNE_NBR                                        20300099
203100             , RSLTS_RCVD_TMST                                    20310099
203200             , FCSE_CNFRMN_TMST                                   20320099
203300             , TOT_CART_CNT                                       20330099
203400             , FCSE_CART_CNT                                      20340099
203500             , P2L_CART_CNT                                       20350099
203600             , (TOT_CART_CNT   -   P2L_CART_CNT)                  20360099
203700             ,  PREPK_LNE_PRC_CDE                                 20370099
203800        INTO   :DISTHD-ORD-LNE-NBR                                20380099
203900             , :DISTHD-RSLTS-RCVD-TMST                            20390099
204000             , :DISTHD-FCSE-CNFRMN-TMST                           20400099
204100             , :DISTHD-TOT-CART-CNT                               20410099
204200             , :DISTHD-FCSE-CART-CNT                              20420099
204300             , :DISTHD-P2L-CART-CNT                               20430099
204400             , :PV-DISTHD-FCSE-CART-CNT-ST                        20440099
204500             , :DISTHD-PREPK-LNE-PRC-CDE                          20450099
204600        FROM   TDISTHD                                            20460099
204700        WHERE                                                     20470099
204800               ORD_NBR      = :DK-PO-NBR                          20480099
204900          AND  RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                     20490099
205000          AND  ORD_LNE_NBR  = :DK-PO-LINE-NBR                     20500099
205100          AND  TOT_CART_CNT > 0                                   20510099
205200          WITH UR                                                 20520099
205300     END-EXEC.                                                    20530099
205400                                                                  20540099
205500     EVALUATE TRUE                                                20550099
205600        WHEN SQLCODE = +100                                       20560099
205700* RPK 12/12/2013 - MAKING CHANGES TO THIS +100 LOGIC DUE TO       20570099
205800*                  I AND C PACKAGE CODES GOING AWAY.              20580099
205900            IF PC022-PKGNG-TYP-CDE = PC-INNER                     20590099
206000               IF PV-PO-REC-CNT = 1                               20600099
206100                  MOVE PC002-CART-CNT    TO PV-P2L-CRTN-CT        20610099
206200                  MOVE ZERO            TO PC022-CRSDCK-CRTN-QTY   20620099
206300                  ADD PC002-PKSL-ITM-QTY TO PV-P2L-UNIT-CT        20630099
206400               ELSE                                               20640099
206500                  ADD PC002-PKSL-ITM-QTY TO PV-P2L-UNIT-CT        20650099
206600               END-IF                                             20660099
206700            ELSE                                                  20670099
206800               PERFORM 8800-INNER-OUTER-CHECK                     20680099
206900               IF PS-INNER-OUTER-EQUAL                            20690099
207000                  ADD PC002-PKSL-ITM-QTY TO PV-CRSDCK-UNIT-CT     20700099
207100                  MOVE PC002-PKSL-ITM-QTY TO PV-CC-PKSL-ITM-QTY   20710099
207200                  MOVE RECITM-CASE-PACK-QTY TO PV-CC-OUTER-QTY    20720099
207300                  PERFORM 8500-CALC-CARTONS                       20730099
207400                  ADD PV-CC-CRTN-QTY TO PV-CRSDCK-CRTN-CT         20740099
207500                  IF PC022-PKGNG-TYP-CDE = PC-BULK                20750099
207600                  OR PC022-PKGNG-TYP-CDE = PC-CASE                20760099
207700                     MOVE RECITM-CASE-PACK-QTY TO                 20770099
207800                          PV-RECITM-CASE-PACK-QTY                 20780099
207900                     SET PS-CASE-GT-NOT-FOUND TO TRUE             20790099
208000                     PERFORM 8700-CHECK-UNITS-IN-CARTON           20800099
208100                  END-IF                                          20810099
208200               ELSE                                               20820099
208300                  ADD PC002-PKSL-ITM-QTY TO PV-P2L-UNIT-CT        20830099
208400                  MOVE PC002-PKSL-ITM-QTY TO PV-CC-PKSL-ITM-QTY   20840099
208500                  MOVE RECITM-CASE-PACK-QTY TO PV-CC-OUTER-QTY    20850099
208600                  PERFORM 8500-CALC-CARTONS                       20860099
208700                  ADD PV-CC-CRTN-QTY TO PV-P2L-CRTN-CT            20870099
208800               END-IF                                             20880099
208900            END-IF                                                20890099
209000             SET PS-LINE-CRTN-UKNWN TO TRUE                       20900099
209100        WHEN SQLCODE = ZERO                                       20910099
209200             PERFORM 8200-GET-FCSE-P2L-UNITS                      20920099
209300        WHEN OTHER                                                20930099
209400             MOVE  SQLCODE          TO  PV-SQLCODE                20940099
209500             MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO             20950099
209600             MOVE  DK-REC-SEQ-NBR   TO  PV-DISPLAY-REC-SEQ-NBR    20960099
209700             MOVE '8100-GET-FCSE-CRTNS.  '                        20970099
209800                                    TO PV-ABEND-PARAGRAPH         20980099
209900             MOVE 'GET FCSE CRTNS.   '                            20990099
210000                                    TO PV-DB2-OPERATION-MESSAGE-1 21000099
210100             STRING ' PO-RECV - '           DELIMITED BY SIZE     21010099
210200                    PV-DISPLAY-PO '-'       DELIMITED BY SIZE     21020099
210300                    PV-DISPLAY-REC-SEQ-NBR  DELIMITED BY SIZE     21030099
210400                                INTO PV-DB2-OPERATION-MESSAGE-2   21040099
210500             MOVE 'TDISTHD'         TO PV-DB2-TABLE-NAME-1        21050099
210600             PERFORM 9999-SQL-ABEND                               21060099
210700     END-EVALUATE.                                                21070099
210800                                                                  21080099
210900/                                                                 21090099
211000******************************************************************21100099
211100*                                                                *21110099
211200******************************************************************21120099
211300 8200-GET-FCSE-P2L-UNITS.                                         21130099
211400                                                                  21140099
211500     MOVE '8200-GET-FCSE-P2L-UNITS.'  TO PV-ABEND-PARAGRAPH.      21150099
211600                                                                  21160099
211700                                                                  21170099
211800     EXEC SQL                                                     21180099
211900        SELECT SUM(P2L_SPLT_UNT_QTY)                              21190099
212000             , SUM(FCSE_SPLT_UNT_QTY +                            21200099
212100                   INPK_SPLT_UNT_QTY)                             21210099
212200        INTO   :DISTDT-P2L-SPLT-UNT-QTY                           21220099
212300             , :DISTDT-FCSE-SPLT-UNT-QTY                          21230099
212400        FROM   TDISTDT                                            21240099
212500        WHERE  ORD_NBR      = :DK-PO-NBR                          21250099
212600          AND  RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                     21260099
212700          AND  ORD_LNE_NBR  = :DK-PO-LINE-NBR                     21270099
212800          WITH UR                                                 21280099
212900     END-EXEC.                                                    21290099
213000                                                                  21300099
213100     MOVE DISTDT-P2L-SPLT-UNT-QTY    TO PV-DISTDT-SUM-P2L         21310099
213200     MOVE DISTDT-FCSE-SPLT-UNT-QTY   TO PV-DISTDT-SUM-FCSE        21320099
213300                                                                  21330099
213400*    DISPLAY 'DISTDT-FCSE: '            PV-DISTDT-SUM-FCSE        21340099
213500                                                                  21350099
213600     EVALUATE TRUE                                                21360099
213700        WHEN SQLCODE = ZERO                                       21370099
213800               PERFORM 8300-CHECK-TMST                            21380099
213900        WHEN SQLCODE = +100                                       21390099
214000            ADD PC002-PKSL-ITM-QTY    TO PV-CRSDCK-UNIT-CT        21400099
214100            SET PS-LINE-CRTN-UKNWN    TO TRUE                     21410099
214200        WHEN SQLCODE = -305                                       21420099
214300* RPK 12/12/2013 - MAKING CHANGES TO THIS -305 LOGIC DUE TO       21430099
214400*                  I AND C PACKAGE CODES GOING AWAY.              21440099
214500            IF PC022-PKGNG-TYP-CDE = PC-INNER                     21450099
214600               IF PV-PO-REC-CNT = 1                               21460099
214700                  MOVE PC002-CART-CNT    TO PV-P2L-CRTN-CT        21470099
214800                  MOVE ZERO            TO PC022-CRSDCK-CRTN-QTY   21480099
214900                  ADD PC002-PKSL-ITM-QTY TO PV-P2L-UNIT-CT        21490099
215000               ELSE                                               21500099
215100                  ADD PC002-PKSL-ITM-QTY TO PV-P2L-UNIT-CT        21510099
215200               END-IF                                             21520099
215300            ELSE                                                  21530099
215310               PERFORM 8800-INNER-OUTER-CHECK                     21531099
215320               IF PS-INNER-OUTER-EQUAL                            21532099
215500                  ADD PC002-PKSL-ITM-QTY TO PV-CRSDCK-UNIT-CT     21550099
215600*                 MOVE PC002-PKSL-ITM-QTY TO PV-CC-PKSL-ITM-QTY   21560099
215700*                 MOVE RECITM-CASE-PACK-QTY TO PV-CC-OUTER-QTY    21570099
215800*                 PERFORM 8500-CALC-CARTONS                       21580099
215900*                 ADD PV-CC-CRTN-QTY TO PV-CRSDCK-CRTN-CT         21590099
216000               ELSE                                               21600099
216100                  ADD PC002-PKSL-ITM-QTY TO PV-P2L-UNIT-CT        21610099
216200*                 MOVE PC002-PKSL-ITM-QTY TO PV-CC-PKSL-ITM-QTY   21620099
216300*                 MOVE RECITM-CASE-PACK-QTY TO PV-CC-OUTER-QTY    21630099
216400*                 PERFORM 8500-CALC-CARTONS                       21640099
216500*                 ADD PV-CC-CRTN-QTY TO PV-P2L-CRTN-CT            21650099
216600               END-IF                                             21660099
216700            END-IF                                                21670099
216800            SET PS-LINE-CRTN-UKNWN    TO TRUE                     21680099
216900        WHEN OTHER                                                21690099
217000             MOVE  SQLCODE          TO  PV-SQLCODE                21700099
217100             MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO             21710099
217200             MOVE  DK-REC-SEQ-NBR   TO  PV-DISPLAY-REC-SEQ-NBR    21720099
217300             MOVE '8200-GET-FCSE-P2L-UNIT'                        21730099
217400                                    TO PV-ABEND-PARAGRAPH         21740099
217500             MOVE 'GET FCSE P2L CRTNS'                            21750099
217600                                    TO PV-DB2-OPERATION-MESSAGE-1 21760099
217700             STRING ' PO-RECV - '           DELIMITED BY SIZE     21770099
217800                    PV-DISPLAY-PO '-'       DELIMITED BY SIZE     21780099
217900                    PV-DISPLAY-REC-SEQ-NBR  DELIMITED BY SIZE     21790099
218000                                INTO PV-DB2-OPERATION-MESSAGE-2   21800099
218100             MOVE 'TDISTDT'         TO PV-DB2-TABLE-NAME-1        21810099
218200             PERFORM 9999-SQL-ABEND                               21820099
218300     END-EVALUATE.                                                21830099
218400                                                                  21840099
218500/                                                                 21850099
218600******************************************************************21860099
218700*                                                                *21870099
218800******************************************************************21880099
218900 8300-CHECK-TMST.                                                 21890099
219000                                                                  21900099
219100     MOVE '8300-CHECK-TMST.'           TO PV-ABEND-PARAGRAPH.     21910099
219200                                                                  21920099
219300     IF (DISTHD-FCSE-CNFRMN-TMST NOT EQUAL PC-CNFRMN-TMST         21930099
219400         AND DISTHD-RSLTS-RCVD-TMST NOT EQUAL PC-CNFRMN-TMST)     21940099
219500            MOVE PC022-PKSLP-ITM-QTY    TO PV-PKSLP-ITM-QTY       21950099
219600            SUBTRACT PV-DISTDT-SUM-P2L  FROM PV-PKSLP-ITM-QTY     21960099
219700            MOVE PV-PKSLP-ITM-QTY       TO PC022-PKSLP-ITM-QTY    21970099
219800            MOVE PC022-PKSLP-ITM-QTY    TO PV-PKSLP-ITM-QTY       21980099
219900            SUBTRACT PV-DISTDT-SUM-FCSE FROM PV-PKSLP-ITM-QTY     21990099
220000            MOVE PV-PKSLP-ITM-QTY       TO  PC022-PKSLP-ITM-QTY   22000099
220100     ELSE                                                         22010099
220200         IF (DISTHD-FCSE-CNFRMN-TMST EQUAL PC-CNFRMN-TMST         22020099
220300             AND DISTHD-RSLTS-RCVD-TMST EQUAL PC-CNFRMN-TMST)     22030099
220400                ADD PV-DISTDT-SUM-FCSE      TO PV-CRSDCK-UNIT-CT  22040099
220500                ADD PV-DISTDT-SUM-P2L       TO PV-P2L-UNIT-CT     22050099
220600                IF DISTHD-PREPK-LNE-PRC-CDE = 'P'                 22060099
220700                   CONTINUE                                       22070099
220800                ELSE                                              22080099
220900                   ADD DISTHD-P2L-CART-CNT     TO PV-P2L-CRTN-CT  22090099
221000                   MOVE PV-DISTHD-FCSE-CART-CNT-ST TO             22100099
221100                                           PV-DISTHD-FCSE-CART-CNT22110099
221200                   ADD PV-DISTHD-FCSE-CART-CNT TO                 22120099
221300                                           PV-CRSDCK-CRTN-CT      22130099
221400                END-IF                                            22140099
221500         ELSE                                                     22150099
221600                                                                  22160099
221700             IF DISTHD-FCSE-CNFRMN-TMST EQUAL PC-CNFRMN-TMST      22170099
221800                IF DISTHD-PREPK-LNE-PRC-CDE = 'P'                 22180099
221900                   CONTINUE                                       22190099
222000                ELSE                                              22200099
222100                   MOVE PV-DISTHD-FCSE-CART-CNT-ST TO             22210099
222200                                           PV-DISTHD-FCSE-CART-CNT22220099
222300                   ADD PV-DISTHD-FCSE-CART-CNT TO                 22230099
222400                                           PV-CRSDCK-CRTN-CT      22240099
222500                END-IF                                            22250099
222600                ADD PV-DISTDT-SUM-FCSE      TO PV-CRSDCK-UNIT-CT  22260099
222700                MOVE PC022-PKSLP-ITM-QTY    TO PV-PKSLP-ITM-QTY   22270099
222800                SUBTRACT PV-DISTDT-SUM-P2L  FROM PV-PKSLP-ITM-QTY 22280099
222900                MOVE PV-PKSLP-ITM-QTY       TO PC022-PKSLP-ITM-QTY22290099
223000             ELSE                                                 22300099
223100                                                                  22310099
223200                IF DISTHD-RSLTS-RCVD-TMST EQUAL PC-CNFRMN-TMST    22320099
223300                   IF DISTHD-PREPK-LNE-PRC-CDE = 'P'              22330099
223400                      CONTINUE                                    22340099
223500                   ELSE                                           22350099
223600                     ADD DISTHD-P2L-CART-CNT     TO               22360099
223700                                            PV-P2L-CRTN-CT        22370099
223800                   END-IF                                         22380099
223900                   ADD PV-DISTDT-SUM-P2L       TO PV-P2L-UNIT-CT  22390099
224000                   MOVE PC022-PKSLP-ITM-QTY    TO PV-PKSLP-ITM-QTY22400099
224100                   SUBTRACT PV-DISTDT-SUM-FCSE FROM               22410099
224200                                             PV-PKSLP-ITM-QTY     22420099
224300                    MOVE PV-PKSLP-ITM-QTY       TO                22430099
224400                                            PC022-PKSLP-ITM-QTY   22440099
224500                END-IF                                            22450099
224600            END-IF                                                22460099
224700        END-IF                                                    22470099
224800     END-IF.                                                      22480099
224900/                                                                 22490099
225000******************************************************************22500099
225100*                                                                *22510099
225200******************************************************************22520099
225300 8400-MOVE-CRTN-UNIT-FIELDS.                                      22530099
225400                                                                  22540099
225500     MOVE '8400-MOVE-CRTN-UNIT-FIELDS' TO PV-ABEND-PARAGRAPH.     22550099
225600     MOVE PV-NBR-PO-LINES              TO PC022-NBR-PO-LINES.     22560099
225700     MOVE PV-PRESENT-CDE               TO PC022-PRESENT-CDE.      22570099
225800                                                                  22580099
225900     MOVE ZEROS TO PV-SUM-CRTN-CT.                                22590099
226000     COMPUTE PV-SUM-CRTN-CT =                                     22600099
226100             PV-HRTW-CRTN-CT +                                    22610099
226200             PV-CRSDCK-CRTN-CT +                                  22620099
226300             PV-P2L-CRTN-CT.                                      22630099
226400     MOVE PC022-NBR-OF-CRTNS TO PV-TOT-CRTN-CT.                   22640099
226500                                                                  22650099
226600     IF (PV-HRTW-UNIT-CT > ZERO AND PV-CRSDCK-UNIT-CT = ZERO      22660099
226700         AND PV-P2L-UNIT-CT = ZERO)                               22670099
226800            MOVE PC022-NBR-OF-CRTNS    TO PC022-HRTW-CRTN-QTY     22680099
226900            MOVE PC022-PKSLP-ITM-QTY   TO PC022-HRTW-UNIT-QTY     22690099
227000     ELSE                                                         22700099
227100        IF (PV-CRSDCK-UNIT-CT > ZERO AND PV-P2L-UNIT-CT = ZERO    22710099
227200            AND PV-HRTW-UNIT-CT = ZERO)                           22720099
227300            MOVE PV-CRSDCK-UNIT-CT     TO PC022-CRSDCK-UNIT-QTY   22730099
227400            MOVE PC022-NBR-OF-CRTNS    TO PC022-CRSDCK-CRTN-QTY   22740099
227500*GB         MOVE PC022-PKSLP-ITM-QTY   TO PC022-CRSDCK-UNIT-QTY   22750099
227600        ELSE                                                      22760099
227700*          IF (PV-P2L-UNIT-CT > 0 AND PV-CRSDCK-UNIT-CT = ZERO    22770099
227800*              AND PV-HRTW-UNIT-CT = ZERO)                        22780099
227900*              MOVE PV-P2L-UNIT-CT        TO PC022-P2L-UNIT-QTY   22790099
228000*              MOVE PC022-NBR-OF-CRTNS    TO PC022-P2L-CRTN-QTY   22800099
228100*          ELSE                                                   22810099
228200               MOVE PV-CRSDCK-UNIT-CT     TO PC022-CRSDCK-UNIT-QTY22820099
228300               MOVE PV-CRSDCK-CRTN-CT     TO PC022-CRSDCK-CRTN-QTY22830099
228400               MOVE PV-P2L-UNIT-CT        TO PC022-P2L-UNIT-QTY   22840099
228500               MOVE PV-P2L-CRTN-CT        TO PC022-P2L-CRTN-QTY   22850099
228600               MOVE PV-HRTW-UNIT-CT       TO PC022-HRTW-UNIT-QTY  22860099
228700               MOVE PV-HRTW-CRTN-CT       TO PC022-HRTW-CRTN-QTY  22870099
228800*          END-IF                                                 22880099
228900        END-IF                                                    22890099
229000     END-IF                                                       22900099
229100     MOVE ZERO TO PV-CRSDCK-UNIT-CT                               22910099
229200                  PV-CRSDCK-CRTN-CT                               22920099
229300                  PV-P2L-UNIT-CT                                  22930099
229400                  PV-P2L-CRTN-CT                                  22940099
229500                  PV-HRTW-UNIT-CT                                 22950099
229600                  PV-HRTW-CRTN-CT                                 22960099
229700                  PV-JWLRY-UNIT-QTY.                              22970099
229800/                                                                 22980099
229900* RPK 12/12/2013 - MAKING CHANGES TO THIS +100 LOGIC DUE TO       22990099
230000*                  I AND C PACKAGE CODES GOING AWAY.              23000099
230100******************************************************************23010099
230200* THIS PARAGRAPH WILL BE USED TO CALCULATE THE NUMBER OF CARTONS *23020099
230300* BASED ON THE OUTER PACK QUANTITY FOR A LINE AND THE NUMBER OF  *23030099
230400* UNITS FROM THE PC002-PKSL-ITM-QTY FIELD.  WILL ULTIMATELY BE   *23040099
230500* USED TO COME UP WITH A COUNT OF CROSS DOCK CARTONS VS NON      *23050099
230600* CROSS DOCK CARTONS.                                            *23060099
230700*                                                                *23070099
230800* LOGIC FOR THE CHECK FOR DRIVER LINE IS SO THAT WE ONLY COUNT   *23080099
230900* THE CARTONS ONCE FOR A PREPACK.                                *23090099
231000******************************************************************23100099
231100 8500-CALC-CARTONS.                                               23110099
231200                                                                  23120099
231300     MOVE ZEROS TO PV-CC-CRTN-QTY                                 23130099
231400                   PV-CC-CRTN-REMAINDER.                          23140099
231500                                                                  23150099
231600     IF PV-CC-PKSL-ITM-QTY = ZERO                                 23160099
231700     OR PV-CC-OUTER-QTY    = ZERO                                 23170099
231800        MOVE ZEROS TO PV-CC-CRTN-QTY                              23180099
231900     ELSE                                                         23190099
232000        IF PC022-PKGNG-TYP-CDE = PC-MULTI                         23200099
232100           IF RECITM-PREPK-DRV-LNE-CDE NOT EQUAL PC-A             23210099
232200              MOVE ZEROS TO PV-CC-CRTN-QTY                        23220099
232300           ELSE                                                   23230099
232400              SET PS-INBOUND-NOT-FOUND TO TRUE                    23240099
232500              MOVE ZEROS TO PV-INBOUND-CARTON-CNT                 23250099
232600              MOVE PC002-PO-NBR      TO DK-IB-PO-NBR              23260099
232700              MOVE PC002-REC-SEQ-NBR TO DK-IB-REC-SEQ-NBR         23270099
232800              MOVE PC002-PO-LINE-NBR TO DK-IB-PO-LINE-NBR         23280099
232900              PERFORM 8600-CHECK-INBOUND-CARTON                   23290099
233000              IF PS-INBOUND-FOUND                                 23300099
233100                 MOVE PV-INBOUND-CARTON-CNT TO PV-CC-CRTN-QTY     23310099
233200              ELSE                                                23320099
233300                 DIVIDE PV-CC-PKSL-ITM-QTY BY PV-CC-OUTER-QTY     23330099
233400                 GIVING PV-CC-CRTN-QTY                            23340099
233500                 REMAINDER PV-CC-CRTN-REMAINDER                   23350099
233600              END-IF                                              23360099
233700           END-IF                                                 23370099
233800        ELSE                                                      23380099
233900           SET PS-INBOUND-NOT-FOUND TO TRUE                       23390099
234000           MOVE ZEROS TO PV-INBOUND-CARTON-CNT                    23400099
234100           MOVE PC002-PO-NBR      TO DK-IB-PO-NBR                 23410099
234200           MOVE PC002-REC-SEQ-NBR TO DK-IB-REC-SEQ-NBR            23420099
234300           MOVE PC002-PO-LINE-NBR TO DK-IB-PO-LINE-NBR            23430099
234400           PERFORM 8600-CHECK-INBOUND-CARTON                      23440099
234500           IF PS-INBOUND-FOUND                                    23450099
234600              MOVE PV-INBOUND-CARTON-CNT TO PV-CC-CRTN-QTY        23460099
234700           ELSE                                                   23470099
234800              DIVIDE PV-CC-PKSL-ITM-QTY BY PV-CC-OUTER-QTY        23480099
234900              GIVING PV-CC-CRTN-QTY                               23490099
235000              REMAINDER PV-CC-CRTN-REMAINDER                      23500099
235100           END-IF                                                 23510099
235200        END-IF                                                    23520099
235300     END-IF.                                                      23530099
235400                                                                  23540099
235500 8600-CHECK-INBOUND-CARTON.                                       23550099
235600                                                                  23560099
235700     EXEC SQL                                                     23570099
235800          SELECT  COUNT(*)                                        23580099
235900          INTO  :PV-INBOUND-CARTON-CNT                            23590099
236000          FROM   TPKSLIP A                                        23600099
236100               , TINPKSU B                                        23610099
236200               , TSHPUNT C                                        23620099
236300               , TSHUUPC D                                        23630099
236400          WHERE A.PO_NBR        = :DK-IB-PO-NBR                   23640099
236500            AND A.REC_SEQ_NBR   = :DK-IB-REC-SEQ-NBR              23650099
236600            AND A.VER_STAT_CDE  = 'A'                             23660099
236700            AND A.PKSL_STAT_CDE = 'AC'                            23670099
236800            AND B.PO_NBR        = A.PO_NBR                        23680099
236900            AND B.SEQ_NBR       = A.SEQ_NBR                       23690099
237000            AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                  23700099
237100            AND C.ACTV_IND      = 'A'                             23710099
237200            AND D.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                  23720099
237210            AND D.TRN_NBR       = A.PO_NBR                        23721099
237300            AND D.TRN_LNE_NBR   = :DK-IB-PO-LINE-NBR              23730099
237400            WITH UR                                               23740099
237500     END-EXEC                                                     23750099
237600                                                                  23760099
237700                                                                  23770099
237800     EVALUATE TRUE                                                23780099
237900         WHEN SQLCODE = ZERO                                      23790099
238000              SET PS-INBOUND-FOUND TO TRUE                        23800099
238100         WHEN SQLCODE = +100                                      23810099
238200              CONTINUE                                            23820099
238300         WHEN OTHER                                               23830099
238400              MOVE  SQLCODE           TO  PV-SQLCODE              23840099
238500              MOVE  DK-IB-PO-NBR      TO  PV-DISPLAY-PO           23850099
238600              MOVE  DK-IB-REC-SEQ-NBR TO  PV-DISPLAY-REC-SEQ-NBR  23860099
238700              MOVE  DK-IB-PO-LINE-NBR TO  PV-DISPLAY-PO-LINE-NBR  23870099
238800              MOVE '8600-CHECK-INBOUND-CARTON'                    23880099
238900                                     TO PV-ABEND-PARAGRAPH        23890099
239000              MOVE 'GET INBOUND CARTON COUNT'                     23900099
239100                                     TO PV-DB2-OPERATION-MESSAGE-123910099
239200              STRING ' PO-RECV-LINE- '          DELIMITED BY SIZE 23920099
239300                     PV-DISPLAY-PO '-'          DELIMITED BY SIZE 23930099
239400                     PV-DISPLAY-REC-SEQ-NBR '-' DELIMITED BY SIZE 23940099
239500                     PV-DISPLAY-PO-LINE-NBR '-' DELIMITED BY SIZE 23950099
239600                                 INTO PV-DB2-OPERATION-MESSAGE-2  23960099
239700              MOVE 'TPKSLIP'         TO PV-DB2-TABLE-NAME-1       23970099
239800              MOVE 'TINPKSU'         TO PV-DB2-TABLE-NAME-2       23980099
239900              MOVE 'TSHPUNT'         TO PV-DB2-TABLE-NAME-3       23990099
240000              MOVE 'TSHUUPC'         TO PV-DB2-TABLE-NAME-4       24000099
240100              PERFORM 9999-SQL-ABEND                              24010099
240200     END-EVALUATE.                                                24020099
240300                                                                  24030099
240400                                                                  24040099
240500 8700-CHECK-UNITS-IN-CARTON.                                      24050099
240600                                                                  24060099
240700     EXEC SQL                                                     24070099
240800          SELECT  D.SHIPT_UNT_ID                                  24080099
240900          INTO  :SHUUPC-SHIPT-UNT-ID                              24090099
241000          FROM   TPKSLIP A                                        24100099
241100               , TINPKSU B                                        24110099
241200               , TSHPUNT C                                        24120099
241300               , TSHUUPC D                                        24130099
241400          WHERE A.PO_NBR        = :DK-IB-PO-NBR                   24140099
241500            AND A.REC_SEQ_NBR   = :DK-IB-REC-SEQ-NBR              24150099
241600            AND A.VER_STAT_CDE  = 'A'                             24160099
241700            AND A.PKSL_STAT_CDE = 'AC'                            24170099
241800            AND B.PO_NBR        = A.PO_NBR                        24180099
241900            AND B.SEQ_NBR       = A.SEQ_NBR                       24190099
242000            AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                  24200099
242100            AND C.ACTV_IND      = 'A'                             24210099
242200            AND D.SHIPT_UNT_ID  = C.SHIPT_UNT_ID                  24220099
242210            AND D.TRN_NBR       = A.PO_NBR                        24221099
242300            AND D.TRN_LNE_NBR   = :DK-IB-PO-LINE-NBR              24230099
242400            AND D.SHPD_QTY      > :PV-RECITM-CASE-PACK-QTY        24240099
242500            FETCH FIRST 1 ROW ONLY                                24250099
242600            WITH UR                                               24260099
242700     END-EXEC                                                     24270099
242800                                                                  24280099
242900                                                                  24290099
243000     EVALUATE TRUE                                                24300099
243100         WHEN SQLCODE = ZERO                                      24310099
243200         WHEN SQLCODE = -811                                      24320099
243300              SET PS-CASE-GT-FOUND TO TRUE                        24330099
243400         WHEN SQLCODE = +100                                      24340099
243500              CONTINUE                                            24350099
243600         WHEN OTHER                                               24360099
243700              MOVE  SQLCODE           TO  PV-SQLCODE              24370099
243800              MOVE  DK-IB-PO-NBR      TO  PV-DISPLAY-PO           24380099
243900              MOVE  DK-IB-REC-SEQ-NBR TO  PV-DISPLAY-REC-SEQ-NBR  24390099
244000              MOVE  DK-IB-PO-LINE-NBR TO  PV-DISPLAY-PO-LINE-NBR  24400099
244100              MOVE '8700-CHECK-UNITS-IN-CARTON'                   24410099
244200                                     TO PV-ABEND-PARAGRAPH        24420099
244300              MOVE 'CHECK INBOUND QUANTITY'                       24430099
244400                                     TO PV-DB2-OPERATION-MESSAGE-124440099
244500              STRING ' PO-RECV-LINE- '          DELIMITED BY SIZE 24450099
244600                     PV-DISPLAY-PO '-'          DELIMITED BY SIZE 24460099
244700                     PV-DISPLAY-REC-SEQ-NBR '-' DELIMITED BY SIZE 24470099
244800                     PV-DISPLAY-PO-LINE-NBR '-' DELIMITED BY SIZE 24480099
244900                                 INTO PV-DB2-OPERATION-MESSAGE-2  24490099
245000              MOVE 'TPKSLIP'         TO PV-DB2-TABLE-NAME-1       24500099
245100              MOVE 'TINPKSU'         TO PV-DB2-TABLE-NAME-2       24510099
245200              MOVE 'TSHPUNT'         TO PV-DB2-TABLE-NAME-3       24520099
245300              MOVE 'TSHUUPC'         TO PV-DB2-TABLE-NAME-4       24530099
245400              PERFORM 9999-SQL-ABEND                              24540099
245500     END-EVALUATE.                                                24550099
245600                                                                  24560099
245700                                                                  24570099
245800******************************************************************24580099
245900* THE FOLLOWING LOGIC WAS ADDED WHEN MOVING TO RMS PO V13 DUE TO *24590099
246000* THE I AND C PACKAGING CODES GOING AWAY.  THIS PARAGRAPH WILL   *24600099
246100* DRIVE CHECKS OF THE INNER/OUTER FIELDS FOR NON-PACK ORDERS AND *24610099
246200* PREPACK TYPE CODE FOR PACK ORDERS TO DETERMINE IF THE LINE OR  *24620099
246300* WOULD BE CONSIDERED PACK-TO-LIGHT VERSUS CROSS DOCK UNITS FOR  *24630099
246400* THIS PROCESS.                                                  *24640099
246500******************************************************************24650099
246600                                                                  24660099
246700 8800-INNER-OUTER-CHECK.                                          24670099
246800                                                                  24680099
246900     SET PS-INNER-OUTER-NOT-EQUAL TO TRUE.                        24690099
247000                                                                  24700099
247100     IF  PC022-PKGNG-TYP-CDE = PC-MULTI                           24710099
247200         PERFORM 8850-CHECK-PO-PREPACK                            24720099
247300     ELSE                                                         24730099
247400         IF  RECITM-CASE-PACK-QTY = RECITM-INNR-PACK-QTY          24740099
247500             SET PS-INNER-OUTER-EQUAL TO TRUE                     24750099
247600         END-IF                                                   24760099
247700     END-IF.                                                      24770099
247800                                                                  24780099
247900 8850-CHECK-PO-PREPACK.                                           24790099
248000                                                                  24800099
248100     MOVE '8850-CHECK-PO-PREPACK'  TO PV-ABEND-PARAGRAPH.         24810099
248300                                                                  24830099
248400     EXEC SQL                                                     24840099
248500        SELECT A.PREPK_TYP_CDE                                    24850099
248600        INTO   :POPRPK-PREPK-TYP-CDE                              24860099
248700        FROM   TPOPRPK A                                          24870099
248800           ,   TPURITM B                                          24880099
248900        WHERE  B.PO_NBR         = :DK-PO-NBR                      24890099
249100          AND  B.PO_LNE_NBR     = :DK-PO-LINE-NBR                 24910099
249101          AND  B.VER_STATUS_CDE = 'A'                             24910199
249110          AND  A.PO_NBR         = B.PO_NBR                        24911099
249120          AND  A.PO_PREPK_ID    = B.PO_PREPK_ID                   24912099
249200          WITH UR                                                 24920099
249300     END-EXEC.                                                    24930099
249400                                                                  24940099
250000     EVALUATE TRUE                                                25000099
250100        WHEN SQLCODE = ZERO                                       25010099
250200            IF  POPRPK-PREPK-TYP-CDE = 'I'                        25020099
250201                SET PS-INNER-OUTER-NOT-EQUAL TO TRUE              25020199
250202            ELSE                                                  25020299
250210                SET PS-INNER-OUTER-EQUAL TO TRUE                  25021099
250220            END-IF                                                25022099
250300        WHEN SQLCODE = +100                                       25030099
250310        WHEN SQLCODE = -305                                       25031099
250400            SET PS-INNER-OUTER-EQUAL TO TRUE                      25040099
253300        WHEN OTHER                                                25330099
253400             MOVE  SQLCODE          TO  PV-SQLCODE                25340099
253500             MOVE  DK-PO-NBR        TO  PV-DISPLAY-PO             25350099
253600             MOVE  DK-PO-LINE-NBR   TO  PV-DISPLAY-PO-LINE-NBR    25360099
253700             MOVE '8850-CHECK-PO-PREPACK'                         25370099
253800                                    TO PV-ABEND-PARAGRAPH         25380099
253900             MOVE 'GET PACK TYPE CODE'                            25390099
254000                                    TO PV-DB2-OPERATION-MESSAGE-1 25400099
254100             STRING ' PO-LINE - '           DELIMITED BY SIZE     25410099
254200                    PV-DISPLAY-PO '-'       DELIMITED BY SIZE     25420099
254300                    PV-DISPLAY-PO-LINE-NBR  DELIMITED BY SIZE     25430099
254400                                INTO PV-DB2-OPERATION-MESSAGE-2   25440099
254500             MOVE 'TPOPRPK'         TO PV-DB2-TABLE-NAME-1        25450099
254600             PERFORM 9999-SQL-ABEND                               25460099
254700     END-EVALUATE.                                                25470099
254800                                                                  25480099
254900/                                                                 25490099
255000******************************************************************25500099
255100* WRITES THE RECEIVER-EXT-RECORD TO THE OUTPUT FILE              *25510099
255200******************************************************************25520099
255300 9000-WRITE-OUTPUT-RECORD.                                        25530099
255400                                                                  25540099
255500     MOVE '9000-WRITE-OUTPUT-RECORD.'  TO PV-ABEND-PARAGRAPH.     25550099
255600                                                                  25560099
255700     IF PC022-JWLRY-CRTN-QTY = SPACE                              25570099
255800        MOVE ZERO TO PC022-JWLRY-CRTN-QTY                         25580099
255900     END-IF.                                                      25590099
256000     IF PC022-JWLRY-UNIT-QTY = SPACE                              25600099
256100        MOVE ZERO TO PC022-JWLRY-UNIT-QTY                         25610099
256200     END-IF.                                                      25620099
256300     IF PC022-CRSDCK-CRTN-QTY = SPACE                             25630099
256400        MOVE ZERO TO PC022-CRSDCK-CRTN-QTY                        25640099
256500     END-IF.                                                      25650099
256600     IF PC022-CRSDCK-UNIT-QTY = SPACE                             25660099
256700        MOVE ZERO TO PC022-CRSDCK-UNIT-QTY                        25670099
256800     END-IF.                                                      25680099
256900     IF PC022-P2L-CRTN-QTY    = SPACE                             25690099
257000        MOVE ZERO TO PC022-P2L-CRTN-QTY                           25700099
257100     END-IF.                                                      25710099
257200     IF PC022-P2L-UNIT-QTY    = SPACE                             25720099
257300        MOVE ZERO TO PC022-P2L-UNIT-QTY                           25730099
257400     END-IF.                                                      25740099
257500     IF PC022-HRTW-CRTN-QTY   = SPACE                             25750099
257600        MOVE ZERO TO PC022-HRTW-CRTN-QTY                          25760099
257700     END-IF.                                                      25770099
257800     IF PC022-HRTW-UNIT-QTY   = SPACE                             25780099
257900        MOVE ZERO TO PC022-HRTW-UNIT-QTY                          25790099
258000     END-IF.                                                      25800099
258100     IF PV-NBR-PO-LINES       = 1                                 25810099
258200        MOVE PV-PKSLP-ITM-QTY-SAVE TO  PC022-PKSLP-ITM-QTY        25820099
258300     END-IF.                                                      25830099
258400                                                                  25840099
258500*    DISPLAY PC022-RECEIVER-EXT-RECORD.                           25850099
258600     WRITE OUTPUT-RECORD                                          25860099
258700        FROM PC022-RECEIVER-EXT-RECORD.                           25870099
258800        ADD  1  TO  PV-RECORDS-WRITTEN.                           25880099
258900     PERFORM 9500-INITIALIZE-PC022.                               25890099
259000                                                                  25900099
259100/                                                                 25910099
259200******************************************************************25920099
259300*                                                                *25930099
259400******************************************************************25940099
259500 9500-INITIALIZE-PC022.                                           25950099
259600                                                                  25960099
259700     INITIALIZE PC022-RECEIVER-EXT-RECORD.                        25970099
259800     MOVE ','       TO   PC022-COMMA-1                            25980099
259900                         PC022-COMMA-2                            25990099
260000                         PC022-COMMA-3                            26000099
260100                         PC022-COMMA-4                            26010099
260200                         PC022-COMMA-5                            26020099
260300                         PC022-COMMA-6                            26030099
260400                         PC022-COMMA-7                            26040099
260500                         PC022-COMMA-8                            26050099
260600                         PC022-COMMA-9                            26060099
260700                         PC022-COMMA-10                           26070099
260800                         PC022-COMMA-11                           26080099
260900                         PC022-COMMA-12                           26090099
261000                         PC022-COMMA-13                           26100099
261100                         PC022-COMMA-14                           26110099
261200                         PC022-COMMA-15                           26120099
261300                         PC022-COMMA-16                           26130099
261400                         PC022-COMMA-17                           26140099
261500                         PC022-COMMA-18                           26150099
261600                         PC022-COMMA-19                           26160099
261700                         PC022-COMMA-20                           26170099
261800                         PC022-COMMA-21                           26180099
261900                         PC022-COMMA-22                           26190099
262000                         PC022-COMMA-23                           26200099
262100                         PC022-COMMA-24                           26210099
262200                         PC022-COMMA-25                           26220099
262300                         PC022-COMMA-26                           26230099
262400                         PC022-COMMA-27                           26240099
262500                         PC022-COMMA-28                           26250099
262600                         PC022-COMMA-29                           26260099
262700                         PC022-COMMA-30                           26270099
262800                         PC022-COMMA-31                           26280099
262810                         PC022-COMMA-32                           26281099
262820                         PC022-COMMA-33.                          26282099
262900/                                                                 26290099
263000 9000-EOJ.                                                        26300099
263100*        WRITE LAST RECORD                                        26310099
263200     PERFORM 8400-MOVE-CRTN-UNIT-FIELDS                           26320099
263300     PERFORM 9000-WRITE-OUTPUT-RECORD                             26330099
263400                                                                  26340099
263500     CLOSE INPUT-FILE                                             26350099
263600           OUTPUT-FILE.                                           26360099
263700                                                                  26370099
263800     DISPLAY ' RECORDS READ    = ' PV-RECORDS-READ                26380099
263900     DISPLAY ' RECORDS WRITTEN = ' PV-RECORDS-WRITTEN.            26390099
264000/                                                                 26400099
264100                                                                  26410099
264200******************************************************************26420099
264300* ABEND PROCEDURE                                                *26430099
264400******************************************************************26440099
264500 9999-SQL-ABEND.                                                  26450099
264600     DISPLAY '** ABEND           ** = SQLABEND'.                  26460099
264700     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          26470099
264800     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       26480099
264900     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-1.      26490099
265000     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-2.      26500099
265100     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-3.      26510099
265200     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-4.      26520099
265300     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-126530099
265400     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-226540099
265500     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               26550099
265600     COPY DPPD004.                                                26560099
265700     MOVE +4013                  TO PV-ABEND-CODE.                26570099
265800     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       26580099
265900                                                                  26590099
265901* PROCEDURE DIVISION CODE FOR CALCULATING THE OTB INFORMATION     26590199
265910     COPY POPD055.                                                26591099
266000                                                                  26600099
