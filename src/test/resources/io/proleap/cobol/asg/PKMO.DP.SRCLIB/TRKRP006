000100 IDENTIFICATION DIVISION.                                         RCKRP011
000200 TITLE 'RETRANSMISSION ERROR REPORT FOR IMPORT ORDERS'.                   
000300 PROGRAM-ID.             TRKRP006.                                   CL*17
000400 AUTHOR.                 DENNIS STEFFEN - OMNI RESOURCES.            CL*17
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                    CL*17
000600 DATE-WRITTEN            AUGUST, 1996.                               CL*17
000700 DATE-COMPILED.                                                      CL*17
000800                                                                     CL*17
000900*****************************************************************    CL*17
001100*  THIS PROGRAM CREATES A REPORT FROM AN EXTRACT CREATED IN     *    CL*17
001200*  PROGRAM TRKUP006 AND TRKUP005.                               *    CL*17
001400*****************************************************************    CL*17
001500 ENVIRONMENT DIVISION.                                               CL*17
001600                                                                     CL*17
001700 CONFIGURATION SECTION.                                              CL*17
001800                                                                     CL*17
001900 SOURCE-COMPUTER.        IBM-3090.                                   CL*17
002000 OBJECT-COMPUTER.        IBM-3090.                                   CL*17
002100                                                                     CL*17
002200 INPUT-OUTPUT SECTION.                                               CL*17
002300                                                                     CL*17
002400 FILE-CONTROL.                                                       CL*17
002500                                                                     CL*17
002600     SELECT TR006-REPORT-EXTRACT-FILE                                CL*17
002700         ASSIGN TO INP01.                                            CL*17
002800                                                                     CL*17
002900     SELECT REPORT-FILE                                              CL*17
003000         ASSIGN TO RPT01.                                            CL*17
003100                                                                     CL*17
003200                                                                     CL*17
003300******************************************************************   CL*17
003400 DATA DIVISION.                                                      CL*17
003500******************************************************************   CL*17
003600                                                                     CL*17
003700 FILE SECTION.                                                       CL*17
003800                                                                     CL*17
003900 FD  TR006-REPORT-EXTRACT-FILE                                       CL*17
004000     RECORDING MODE IS F                                             CL*17
004100     LABEL RECORDS ARE STANDARD                                      CL*17
004200     BLOCK CONTAINS 0 RECORDS.                                       CL*17
004300                                                                     CL*17
004400 01  TR006-REPORT-EXTRACT-RECORD     PIC X(254).                     CL*17
004500                                                                     CL*17
004600 FD  REPORT-FILE                                                     CL*17
004700     RECORDING MODE IS F                                             CL*17
004800     BLOCK CONTAINS 0  RECORDS.                                      CL*17
004900 01  REPORT-RECORD              PIC  X(132).                         CL*17
005000                                                                     CL*17
005100 WORKING-STORAGE SECTION.                                            CL*17
005200                                                                     CL*17
005300 01  FILLER.                                                         CL*17
005400     05  FILLER                      PIC  X(36)    VALUE             CL*17
005500         ' ***** WORKING STORAGE PGM=TRKRP006 '.                     CL*17
005600     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.      CL*17
005700     05  FILLER                      PIC  X(10)    VALUE             CL*17
005800         ' LOCATION='.                                               CL*17
005900     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.      CL*17
006000     05  FILLER                      PIC  X(06)    VALUE             CL*17
006100         ' *****'.                                                   CL*17
006200 EJECT                                                               CL*17
006300 01  PROGRAM-SWITCHES.                                               CL*17
006400     05  PS-EOF-IND                  PIC  X(01)    VALUE 'Y'.        CL*17
006500         88  PS-EOF                                VALUE 'N'.        CL*17
006600     05  PS-PO-BREAK-SW              PIC X(01)     VALUE 'N'.             
006700         88  PS-NOT-PO-BREAK                       VALUE 'N'.             
006800         88  PS-PO-BREAK                           VALUE 'Y'.             
006900                                                                     CL*17
007000 01  PC-CONSTANTS.                                                   CL*17
007100     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE             CL*17
007200                                                   'TRKRP006'.       CL*17
007300     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.          CL*17
007310     05  PC-REPORT-NBR-2             PIC  9(01)    VALUE 2.          CL*17
007320     05  PC-REPORT-NBR-3             PIC  9(01)    VALUE 3.          CL*17
007330     05  PC-REPORT-NBR-4             PIC  9(01)    VALUE 4.          CL*17
007400 EJECT                                                               CL*17
007500                                                                     CL*17
007600 01  PV-ACCUMULATOR-FIELDS.                                          CL*17
007700     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO        CL*17
007800                                                   COMP-3.           CL*17
007900     05  PV-LINE-CNT                 PIC S9(04)    VALUE ZERO        CL*17
008000                                                   COMP SYNC.        CL*17
008100     05  PV-DPT-VRFYD-QTY           PIC S9(07)    VALUE ZERO         CL*17
008200                                                   COMP-3.           CL*17
008300     05  PV-DPT-GOH-QTY             PIC S9(07)    VALUE ZERO         CL*17
008400                                                   COMP-3.           CL*17
008500     05  PV-DPT-PRETKT-QTY          PIC S9(07)    VALUE ZERO         CL*17
008600                                                   COMP-3.           CL*17
008700     05  PV-BYR-VRFYD-QTY           PIC S9(07)    VALUE ZERO         CL*17
008800                                                   COMP-3.           CL*17
008900     05  PV-BYR-GOH-QTY             PIC S9(07)    VALUE ZERO         CL*17
009000                                                   COMP-3.           CL*17
009100     05  PV-BYR-PRETKT-QTY          PIC S9(07)    VALUE ZERO         CL*17
009200                                                   COMP-3.           CL*17
009300     05  PV-DMM-VRFYD-QTY            PIC S9(09)    VALUE ZERO        CL*17
009400                                                   COMP-3.           CL*17
009500     05  PV-DMM-GOH-QTY              PIC S9(09)    VALUE ZERO        CL*17
009600                                                   COMP-3.           CL*17
009700     05  PV-DMM-PRETKT-QTY           PIC S9(09)    VALUE ZERO        CL*17
009800                                                   COMP-3.           CL*17
009900     05  PV-OPR-VRFYD-QTY            PIC S9(09)    VALUE ZERO        CL*18
010000                                                   COMP-3.           CL*18
010100     05  PV-OPR-GOH-QTY              PIC S9(09)    VALUE ZERO        CL*18
010200                                                   COMP-3.           CL*18
010300     05  PV-OPR-PRETKT-QTY           PIC S9(09)    VALUE ZERO        CL*18
010400                                                   COMP-3.           CL*18
010500 EJECT                                                               CL*17
010600                                                                     CL*17
010700 01  SAVE-FIELDS.                                                    CL*17
010800     05  SAVE-REPORT-TYPE            PIC  X(01)    VALUE SPACE.      CL*17
010900     05  SAVE-PROCESS-DATE           PIC  X(10)    VALUE SPACE.      CL*17
011000     05  SAVE-DEPT-NBR               PIC  9(04)    VALUE ZERO.       CL*17
011100     05  SAVE-PO-NBR                 PIC  9(09)    VALUE ZERO.       CL*17
011200     05  SAVE-ETA-DATE               PIC  X(08)    VALUE ZERO.       CL*17
011300                                                                     CL*17
011400 01  PV-MISC-FIELDS.                                                 CL*17
011500     05  PV-ABEND-CODE                   PIC S9(04)    VALUE ZERO    CL*21
011600                                                   COMP SYNC.        CL*17
011700     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE.    CL*20
011800     05  PV-ERROR-MESSAGE-1              PIC  X(60) VALUE SPACES.    CL*38
011900     05  PV-ERROR-MESSAGE-2              PIC  X(60) VALUE SPACES.    CL*38
012000     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE.    CL*20
012100     05  PV-DB2-TIMST                    PIC  X(26)  VALUE SPACES.        
012200                                                                     CL*17
012300     05  PV-CURR-DATE-YYMMDD.                                        CL*17
012400         10  PV-CURR-DATE-YY         PIC  9(02)    VALUE ZERO.       CL*17
012500         10  PV-CURR-DATE-MM         PIC  9(02)    VALUE ZERO.       CL*17
012600         10  PV-CURR-DATE-DD         PIC  9(02)    VALUE ZERO.       CL*17
012700                                                                     CL*17
012800     05  PV-CURR-TIME.                                               CL*17
012900         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.       CL*17
013000         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.       CL*17
013100         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.       CL*17
013200                                                                     CL*17
013300     05  PV-HOLD-CURR-DATE-MMDDYY    PIC  9(06)    VALUE ZERO.       CL*17
013400     05  PV-HOLD-CURR-DATE-MMDDYY-X  REDEFINES                       CL*17
013500         PV-HOLD-CURR-DATE-MMDDYY.                                   CL*17
013600         10  PV-HOLD-CURR-DATE-MM    PIC  9(02).                     CL*17
013700         10  PV-HOLD-CURR-DATE-DD    PIC  9(02).                     CL*17
013800         10  PV-HOLD-CURR-DATE-YY    PIC  9(02).                     CL*17
013900                                                                     CL*17
014000     05  PV-DATE-SHIPPED.                                            CL*17
014100         10  PV-DATE-SHIPPED-MM      PIC  9(02).                     CL*17
014200         10  PV-DATE-SHIPPED-DD      PIC  9(02).                     CL*17
014300         10  PV-DATE-SHIPPED-CCYY    PIC  9(04).                     CL*17
014400         10  FILLER REDEFINES PV-DATE-SHIPPED-CCYY.                  CL*17
014500             15  PV-DATE-SHIPPED-CC      PIC  9(02).                 CL*17
014600             15  PV-DATE-SHIPPED-YY      PIC  9(02).                 CL*17
014700                                                                     CL*17
014800 EJECT                                                               CL*17
014900     COPY TRRD006.                                                   CL*17
015000*01  CC-CONTROL-CARD.                                                     
015100*    05  CC-SEQUENCE                     PIC X(3).                        
015200*        88  CC-ETA-SEQUENCE                       VALUE 'ETA'.           
015300*        88  CC-ORD-SEQUENCE                       VALUE 'ORD'.           
015400*    05  FILLER                          PIC X(77).                       
015401                                                                          
015410 01  CC-CONTROL-CARD.                                                     
015420     05  CC-SEQUENCE                     PIC X(4).                        
015430         88  CC-ETA-SEQUENCE                       VALUE 'ETA '.          
015440         88  CC-ORD-SEQUENCE                       VALUE 'ORD '.          
015441         88  CC-ETA-SEQUENCE-MSPLT                 VALUE 'ETAS'.          
015442         88  CC-ORD-SEQUENCE-MSPLT                 VALUE 'ORDS'.          
015450     05  FILLER                          PIC X(76).                       
015500 EJECT                                                               CL*17
015600     COPY DPWS004.                                                   CL*20
015700******************************************************************   CL*17
015800*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.                  CL*17
015900******************************************************************   CL*17
016000     COPY DPWS132O.                                                  CL*17
016100                                                                     CL*17
016200 01  HEADING-LINES.                                                  CL*17
016300     05  HEADING-LINE-0.                                             CL*17
016400         10  FILLER                  PIC  X(39)    VALUE SPACES.     CL*17
016500         10  FILLER                  PIC  X(54)    VALUE             CL*24
016600         'DECONSOLIDATOR RETRANSMISSION ERRORS FOR IMPORT ORDERS'.   CL*18
016700         10  FILLER                  PIC  X(39)    VALUE SPACES.     CL*17
016800                                                                     CL*17
016900     05 HEADING-LINE-0A.                                          03380000
017000         10 FILLER                   PIC  X(01)  VALUE SPACE.     03390025
017100         10 FILLER                   PIC  X(40)  VALUE SPACE.     03400000
017200         10 FILLER                   PIC  X(52)  VALUE            03410000
017300         'DECONSOLIDATOR TRANSMISSION ERRORS FOR IMPORT ORDERS'.  03420000
017400         10 FILLER                   PIC  X(39)  VALUE SPACE.     03430000
017500                                                                  03440000
017510     05  HEADING-LINE-0B.                                            CL*17
017520         10  FILLER                  PIC  X(31)    VALUE SPACES.     CL*17
017530         10  FILLER                  PIC  X(54)    VALUE             CL*24
017540         'DECONSOLIDATOR RETRANSMISSION ERRORS FOR IMPORT ORDERS'.   CL*18
017541         10  FILLER                  PIC  X(15)    VALUE             CL*24
017542             '-MISSING SPLITS'.                                      CL*18
017550         10  FILLER                  PIC  X(32)    VALUE SPACES.     CL*17
017560                                                                          
017570     05 HEADING-LINE-0C.                                          03380000
017580         10 FILLER                   PIC  X(01)  VALUE SPACE.     03390025
017590         10 FILLER                   PIC  X(33)  VALUE SPACE.     03400000
017591         10 FILLER                   PIC  X(52)  VALUE            03410000
017592         'DECONSOLIDATOR TRANSMISSION ERRORS FOR IMPORT ORDERS'.  03420000
017593         10  FILLER                  PIC  X(15)    VALUE             CL*24
017594             '-MISSING SPLITS'.                                      CL*18
017595         10 FILLER                   PIC  X(31)  VALUE SPACE.     03430000
017596                                                                  03440000
017600     05  HEADING-LINE-1.                                             CL*17
017700         10 FILLER                       PIC  X(01)  VALUE SPACE. 03460025
017800         10 FILLER                       PIC  X(52)  VALUE SPACE. 03470034
017900         10 FILLER                       PIC  X(18)  VALUE        03480000
018000             'PROCESSING DATE: '.                                 03490000
018100         10 PH3-PROCESSING-MONTH         PIC  X(02)  VALUE SPACE. 03500025
018200         10 PH3-PROCESSING-SLASH1        PIC  X(01)  VALUE '/'.   03510025
018300         10 PH3-PROCESSING-DAY           PIC  X(02)  VALUE SPACE. 03520025
018400         10 PH3-PROCESSING-SLASH2        PIC  X(01)  VALUE '/'.   03530025
018500         10 PH3-PROCESSING-YEAR          PIC  X(02)  VALUE SPACE. 03540025
018600         10 FILLER                       PIC  X(54)  VALUE SPACE. 03550034
024300                                                                  04060000
024310*  COLUMN HEADERS                                                         
024320 01  DH1-DETAIL-HEADING-1.                                        03570000
024330     05  FILLER                          PIC  X(02)  VALUE SPACES.03590000
024340     05  FILLER                          PIC  X(03)  VALUE        03600000
024350         'ETA'.                                                           
024351     05  FILLER                          PIC  X(04)  VALUE SPACES.03590000
024360     05  FILLER                          PIC  X(03)  VALUE SPACES.03611078
024370     05  FILLER                          PIC  X(06)  VALUE        03612076
024380         'VESSEL'.                                                03613076
024390     05  FILLER                          PIC  X(10)  VALUE SPACES.03620078
024394     05  FILLER                          PIC  X(09)  VALUE        03630020
024395         'CONTAINER'.                                             03640020
024396     05  FILLER                          PIC  X(07)  VALUE SPACES.03650078
024397     05  FILLER                          PIC  X(08)  VALUE        03660076
024398         'DONT SHP'.                                              03670076
024399     05  FILLER                          PIC  X(01)  VALUE SPACES.03680085
024400     05  FILLER                          PIC  X(04)  VALUE        03681085
024401         'DEPT'.                                                  03682076
024402     05  FILLER                          PIC  X(34)  VALUE SPACES.03680085
024403     05  FILLER                          PIC  X(03)  VALUE        03681085
024404         'PCK'.                                                   03682076
024405     05  FILLER                          PIC  X(01)  VALUE SPACES.03680085
024406     05  FILLER                          PIC  X(04)  VALUE        03681085
024407         'PACK'.                                                  03682076
024408     05  FILLER                          PIC  X(35)  VALUE SPACES.03740081
024409                                                                  03750000
024410 01  DH1-DETAIL-HEADING-2.                                        03760000
024411     05  FILLER                          PIC  X(02)  VALUE SPACES.03780000
024412     05  FILLER                          PIC  X(04)  VALUE        03790000
024413         'DATE'.                                                  03800000
024414     05  FILLER                          PIC  X(03)  VALUE SPACES.03810000
024417     05  FILLER                          PIC  X(04)  VALUE SPACE. 03840076
024418     05  FILLER                          PIC  X(04)  VALUE        03850076
024419         'NAME'.                                                  03860076
024420     05  FILLER                          PIC  X(12)  VALUE SPACES.03870078
024424     05  FILLER                          PIC  X(06)  VALUE        03910000
024425         'NUMBER'.                                                03920000
024426     05  FILLER                          PIC  X(10)  VALUE SPACE. 03930076
024427     05  FILLER                          PIC  X(06)  VALUE        03931080
024428         'BEFORE'.                                                03932076
024429     05  FILLER                          PIC  X(02)  VALUE SPACE. 03933080
024430     05  FILLER                          PIC  X(03)  VALUE        03940053
024431         'NBR'.                                                   03950053
024432     05  FILLER                          PIC  X(05)  VALUE SPACE. 03960080
024433     05  FILLER                          PIC  X(02)  VALUE        03970079
024434         'PO'.                                                    03980076
024435     05  FILLER                          PIC  X(10)  VALUE SPACES.03990080
024436     05  FILLER                          PIC  X(03)  VALUE        04000000
024437         'UPC'.                                                   04010000
024438     05  FILLER                          PIC  X(10)  VALUE SPACES.03990080
024436     05  FILLER                          PIC  X(03)  VALUE        04000000
024437         'SKU'.                                                   04010000
024438     05  FILLER                          PIC  X(02)  VALUE SPACES.03990080
024439     05  FILLER                          PIC  X(03)  VALUE        04000000
024440         'TYP'.                                                   04010000
024441     05  FILLER                          PIC  X(02)  VALUE SPACES.03990080
024442     05  FILLER                          PIC  X(02)  VALUE        04000000
024443         'ID'.                                                    04010000
024444     05  FILLER                          PIC  X(09)  VALUE SPACES.04020076
024445     05  FILLER                          PIC  X(13)  VALUE        04030082
024446         'ERROR MESSAGE'.                                         04040000
024447     05  FILLER                          PIC  X(12)  VALUE SPACES.04050082
024448                                                                  04060000
024450 01  DL-DETAIL-LINE.                                              04070000
024600     05  DL-ETA-DATE.                                                     
024700         10 DL-ETA-MONTH                 PIC  X(02)  VALUE SPACES.04100026
024800         10 DL-ETA-SLASH1                PIC  X(01)  VALUE '/'.   04110026
024900         10 DL-ETA-DAY                   PIC  X(02)  VALUE SPACES.04120026
025000         10 DL-ETA-SLASH2                PIC  X(01)  VALUE '/'.   04130026
025100         10 DL-ETA-YEAR                  PIC  X(02)  VALUE SPACES.04140026
025200     05  FILLER                          PIC  X(02)  VALUE SPACES.04150000
025500     05  DL-VESSEL-NAME                  PIC  X(10)  VALUE SPACES.04180026
025600     05  FILLER                          PIC  X(01)  VALUE SPACES.04190076
025900     05  DL-CONTAINER-NUMBER             PIC  X(22)  VALUE SPACES.04220000
026000     05  FILLER                          PIC  X(01)  VALUE SPACES.04221076
026100     05  DL-DONT-SHIP-DTE.                                                
026200         10 DL-DONT-SHIP-BEFORE-MONTH    PIC  X(02)  VALUE SPACES.04222076
026300         10 DL-DONT-SHIP-BEFORE-SLASH1   PIC  X(01)  VALUE '/'.   04222176
026400         10 DL-DONT-SHIP-BEFORE-DAY      PIC  X(02)  VALUE SPACES.04223076
026500         10 DL-DONT-SHIP-BEFORE-SLASH2   PIC  X(01)  VALUE '/'.   04223177
026600         10 DL-DONT-SHIP-BEFORE-YEAR     PIC  X(02)  VALUE SPACES.        
026700     05  FILLER                          PIC  X(01)  VALUE SPACES.        
026820     05  DL-DPT-NBR                      PIC  ZZZ9.                       
026900     05  FILLER                          PIC  X(01)  VALUE SPACES.        
027000     05  DL-PO-NBR.                                                       
027100         10  DL-PO-NBR-N                 PIC  9(08)  VALUE ZEROES.        
027200     05  FILLER                          PIC  X(01)  VALUE SPACES.        
027300     05  DL-UPC-NBR.                                                      
027400         10 DL-UPC-NBR-N                 PIC  9(15)  VALUE ZEROES.        
027410     05  FILLER                          PIC  X(01)  VALUE SPACES.        
027300     05  DL-SKU-NBR.                                                      
027400         10 DL-SKU-NBR-N                 PIC  9(08)  VALUE ZEROES.        
027410     05  FILLER                          PIC  X(01)  VALUE SPACES.        
027420     05  DL-PACK-TYP                     PIC  X(01)  VALUE SPACES.        
027430     05  FILLER                          PIC  X(02)  VALUE SPACES.        
027440     05  DL-PACK-ID                      PIC  X(04)  VALUE SPACES.        
027500     05  FILLER                          PIC  X(01)  VALUE SPACES.        
027600     05  DL-ERROR-MSG                    PIC  X(32)  VALUE SPACES.        
027800                                                                          
027900 01  DL-DETAIL-LINE-2.                                                    
028000     05  FILLER                  PIC  X(33)  VALUE SPACE.                 
028100     05  D2-MESSAGE              PIC  X(100) VALUE                        
028200         'THERE ARE NO ERRORS TODAY'.                             04370025
028300                                                                  04380025
028400 01  DL-END-OF-REPORT.                                            04390056
028500     05  FILLER                  PIC  X(39)  VALUE SPACE.         04410056
028600     05  DL-END-OF-RPT           PIC  X(55) VALUE                 04420056
028700         '*************** E N D  O F  R E P O R T *************'. 04430057
028800     05  FILLER                  PIC  X(38)  VALUE SPACE.         04410056
028900                                                                     CL*17
029000 01  DL-NO-INPUT.                                                 04390056
029100     05  FILLER                  PIC  X(39)  VALUE SPACE.         04410056
029200     05  FILLER                  PIC  X(55) VALUE                 04420056
029300         '***  THERE IS NO DATA TO REPORT  ***                 '. 04430057
029400     05  FILLER                  PIC  X(38)  VALUE SPACE.         04410056
029500                                                                     CL*17
029600******************************************************************   CL*19
029700*  DB2 COMMUNICATION AREA.                                           CL*19
029800******************************************************************   CL*19
029900     EXEC SQL                                                        CL*19
030000          INCLUDE SQLCA                                              CL*19
030100     END-EXEC.                                                       CL*19
030200 EJECT                                                               CL*17
030300 PROCEDURE DIVISION.                                                 CL*17
030400                                                                     CL*17
030500     PERFORM 1000-INITIALIZATION.                                    CL*17
030600                                                                     CL*17
030700     PERFORM 2000-PROCESS-RECV-RPT-RECS                              CL*17
030800       UNTIL PS-EOF.                                                 CL*17
030900                                                                     CL*17
031000     WRITE REPORT-RECORD                                             CL*17
031100       FROM DL-END-OF-REPORT                                         CL*17
031200         AFTER ADVANCING 2 LINES.                                    CL*17
031300                                                                     CL*17
031400     IF TR006-REXMIT-RPT                                                  
031500         SET TR006-XMIT-RPT TO TRUE                                       
031600         PERFORM 8000-PRINT-HEADINGS                                      
031700         WRITE REPORT-RECORD                                              
031800            FROM DL-NO-INPUT                                              
031900            AFTER ADVANCING 2 LINES                                       
031901     END-IF.                                                              
031902                                                                     CL*17
031903     CLOSE TR006-REPORT-EXTRACT-FILE                                 CL*17
031904           REPORT-FILE.                                              CL*17
031905                                                                     CL*17
031906     STOP RUN.                                                       CL*17
031907 EJECT                                                               CL*17
031908 1000-INITIALIZATION.                                                CL*17
032000                                                                     CL*17
032100     ACCEPT CC-CONTROL-CARD FROM SYSIN.                                   
032200     IF CC-ETA-SEQUENCE       OR                                          
032201        CC-ORD-SEQUENCE       OR                                          
032202        CC-ETA-SEQUENCE-MSPLT OR                                          
032210        CC-ORD-SEQUENCE-MSPLT                                             
032300         CONTINUE                                                         
032400     ELSE                                                                 
032500         MOVE '1000-INITIALIZATION'  TO PV-PARAGRAPH-NAME            CL*33
032600         MOVE 'SYSIN CONTROL CARD IS MISSING OR INVALID'             CL*33
032700                                     TO PV-ERROR-MESSAGE-1                
032800         MOVE CC-CONTROL-CARD        TO PV-ERROR-MESSAGE-2           CL*33
032900         PERFORM 9200-ABEND                                          CL*33
033000     END-IF.                                                              
033100                                                                          
033200     OPEN INPUT  TR006-REPORT-EXTRACT-FILE                           CL*17
033300          OUTPUT REPORT-FILE.                                        CL*17
033400                                                                     CL*17
033500     ACCEPT PV-CURR-DATE-YYMMDD FROM DATE.                           CL*17
033600     MOVE PV-CURR-DATE-YY TO PV-HOLD-CURR-DATE-YY.                   CL*17
033700     MOVE PV-CURR-DATE-MM TO PV-HOLD-CURR-DATE-MM.                   CL*17
033800     MOVE PV-CURR-DATE-DD TO PV-HOLD-CURR-DATE-DD.                   CL*17
033900                                                                     CL*17
034000     ACCEPT PV-CURR-TIME FROM TIME.                                  CL*17
034100                                                                     CL*17
034200     MOVE PV-CURR-DATE-MM        TO DP132O-RUN-MONTH.                CL*17
034300     MOVE PV-CURR-DATE-DD        TO DP132O-RUN-DAY.                  CL*17
034400     MOVE PV-CURR-DATE-YY        TO DP132O-RUN-YEAR.                 CL*17
034500                                                                     CL*17
034600     MOVE PV-CURR-TIME-HH        TO DP132O-RUN-HOUR.                 CL*17
034700     MOVE PV-CURR-TIME-MM        TO DP132O-RUN-MINUTE.               CL*17
034800     MOVE PC-CURRENT-PROGRAM-NAME                                    CL*17
034900                                 TO DP132O-PROGRAM-NAME.             CL*17
035000     EXEC SQL                                                             
035100         SET :PV-DB2-TIMST = CURRENT TIMESTAMP                            
035200     END-EXEC.                                                            
035300                                                                          
035400     PERFORM 7000-READ-INPUT.                                        CL*17
035500                                                                          
035600     IF PS-EOF                                                       CL*17
035700         SET TR006-REXMIT-RPT    TO TRUE                          00083204
035800         PERFORM 8000-PRINT-HEADINGS                                 CL*17
035900         WRITE REPORT-RECORD                                         CL*17
036000           FROM DL-NO-INPUT                                          CL*17
036100           AFTER ADVANCING 2 LINES                                   CL*17
036200         SET TR006-XMIT-RPT      TO TRUE                          00083204
036300         PERFORM 8000-PRINT-HEADINGS                                 CL*17
036400         WRITE REPORT-RECORD                                         CL*17
036500           FROM DL-NO-INPUT                                          CL*17
049400           AFTER ADVANCING 2 LINES                                   CL*17
049401     ELSE                                                                 
049402         PERFORM 1100-FORMAT-PROCESS-DATE                            CL*17
049403         IF TR006-XMIT-RPT                                                
049404             SET TR006-REXMIT-RPT   TO TRUE                               
049405             PERFORM 8000-PRINT-HEADINGS                                  
049406             WRITE REPORT-RECORD                                          
049407               FROM DL-NO-INPUT                                           
049408               AFTER ADVANCING 2 LINES                                    
049409             MOVE 65 TO PV-LINE-CNT                                  CL*17
049410             SET TR006-XMIT-RPT     TO TRUE                               
049411         END-IF                                                           
049412     END-IF.                                                              
049413                                                                          
049414 1100-FORMAT-PROCESS-DATE.                                           CL*17
049415     MOVE TR006-PROCESS-DATE     TO SAVE-PROCESS-DATE.            00083304
049416     MOVE TR006-PROCESS-MM       TO PH3-PROCESSING-MONTH          03500025
049417     MOVE TR006-PROCESS-DD       TO PH3-PROCESSING-DAY            03520025
049418     MOVE TR006-PROCESS-YYYY(3:2) TO PH3-PROCESSING-YEAR          03540025
049419     MOVE '/'                    TO PH3-PROCESSING-SLASH1         03510025
049420                                    PH3-PROCESSING-SLASH2.        03530025
049421 EJECT                                                               CL*17
049422 2000-PROCESS-RECV-RPT-RECS.                                         CL*17
049423                                                                     CL*17
049424* THE INPUT FILE WILL NORMALLY CONSIST OF RE-TRANSMISSION            CL*17
049425* RECORDS FOLLOWED BY TRANSMISSION RECORDS.  WE NEED TO FORCE        CL*17
049426* A DEPT BREAK TO GET A NEW PAGE TO BEGIN THE NEW REPORT.            CL*17
049427* IF THE PROCESS DATE CHANGES, WE'LL ALSO FORCE A PAGE BREAK         CL*17
049428* WITH THE NEW DATE.                                                 CL*17
049429                                                                     CL*17
049430*  THERE ARE FOUR POSSIBLE SEQUENCES BASED ON THE PARM ACCEPTED      CL*17
049431*  FROM SYSIN:                                                       CL*17
049432*                                                                    CL*17
049433* CC-ETA-SEQUENCE WILL PAGE BREAK ON TR006-ETA-DATE FOR REGULAR ERRS CL*17
049435                                                                          
049436* CC-ORD-SEQUENCE WILL PAGE BREAK ON TR006-DEPT-NBR FOR REGULAR ERRS CL*17
049438                                                                          
049439* CC-ETA-SEQUENCE-MSPLT WILL PAGE BREAK ON TR006-ETA-DATE FOR        CL*17
049440* MISSING SPLIT ERRORS                                                    
049441                                                                          
049442* CC-ORD-SEQUENCE-MSPLT WILL PAGE BREAK ON TR006-DEPT-NBR FOR        CL*17
049443* MISSING SPLIT ERRORS                                                    
049444                                                                          
049448*   MINOR BREAKS WILL OCCUR ON A CHANGE OF PO.                       CL*17
049449*                                                                    CL*17
049458                                                                          
049460     EVALUATE TRUE                                                        
049461         WHEN CC-ETA-SEQUENCE                                             
049462         WHEN CC-ETA-SEQUENCE-MSPLT                                       
049463             IF TR006-ETA-DATE NOT = SAVE-ETA-DATE       OR               
049464                TR006-REPORT-TYPE NOT = SAVE-REPORT-TYPE OR               
049465                TR006-PROCESS-DATE NOT = SAVE-PROCESS-DATE                
049466                 PERFORM 1100-FORMAT-PROCESS-DATE                         
049467                 MOVE TR006-REPORT-TYPE  TO SAVE-REPORT-TYPE              
049468                 MOVE TR006-PROCESS-DATE TO SAVE-PROCESS-DATE             
049469                 MOVE ZERO               TO SAVE-ETA-DATE                 
049470             END-IF                                                       
049471                                                                          
049472             IF TR006-ETA-DATE     NOT = SAVE-ETA-DATE                    
049473                 PERFORM 8000-PRINT-HEADINGS                              
049474                 MOVE TR006-ETA-DATE TO SAVE-ETA-DATE                     
049475             END-IF                                                       
049476                                                                          
049477             MOVE TR006-DEPT-NBR     TO DL-DPT-NBR                        
049478             MOVE TR006-PO-NBR       TO DL-PO-NBR-N                       
049479             IF DL-PO-NBR = ALL ZEROS                                     
049480                 MOVE SPACES TO DL-PO-NBR                                 
049481             END-IF                                                       
049482                                                                          
049483         WHEN CC-ORD-SEQUENCE                                             
049484         WHEN CC-ORD-SEQUENCE-MSPLT                                       
049485             IF TR006-REPORT-TYPE NOT  = SAVE-REPORT-TYPE OR              
049486                TR006-PROCESS-DATE NOT = SAVE-PROCESS-DATE                
049487                 PERFORM 1100-FORMAT-PROCESS-DATE                         
049488                 MOVE TR006-REPORT-TYPE  TO SAVE-REPORT-TYPE              
049489                 MOVE ZERO               TO SAVE-DEPT-NBR                 
049490             END-IF                                                       
049491                                                                          
049493             EVALUATE TRUE                                                
049494                 WHEN TR006-DEPT-NBR = SAVE-DEPT-NBR  AND                 
049495                      TR006-PO-NBR   = SAVE-PO-NBR                        
049496                       CONTINUE                                           
049497                                                                          
049498                 WHEN TR006-DEPT-NBR NOT = SAVE-DEPT-NBR                  
049499                     PERFORM 8000-PRINT-HEADINGS                          
049500                     MOVE TR006-DEPT-NBR TO SAVE-DEPT-NBR                 
049501                                            DL-DPT-NBR                    
049502                     MOVE TR006-PO-NBR   TO DL-PO-NBR-N                   
049503                                            SAVE-PO-NBR                   
049504                     IF DL-PO-NBR = ALL ZEROS                             
049505                         MOVE SPACES TO DL-PO-NBR                         
049506                     END-IF                                               
049507                                                                          
049508                 WHEN TR006-PO-NBR  NOT = SAVE-PO-NBR                     
049509                     MOVE TR006-PO-NBR   TO DL-PO-NBR-N                   
049510                                            SAVE-PO-NBR                   
049511                     IF DL-PO-NBR = ALL ZEROS                             
049512                         MOVE SPACES TO DL-PO-NBR                         
049513                     END-IF                                               
049514                     SET PS-PO-BREAK     TO TRUE                          
049515             END-EVALUATE                                                 
049516     END-EVALUATE.                                                        
049574                                                                          
049575     PERFORM 2100-FORMAT-SHIP-DATE                                        
049576     PERFORM 2110-FORMAT-ETA-DATE                                         
049577                                                                          
049578     MOVE TR006-VESSEL-NAME      TO DL-VESSEL-NAME                        
049580     MOVE TR006-CONTAINER-NUMBER TO DL-CONTAINER-NUMBER                   
049581     MOVE TR006-PKGNG-CDE        TO DL-PACK-TYP                           
049582     MOVE TR006-PACK-ID(5:4)     TO DL-PACK-ID                            
049583                                                                          
049584     MOVE TR006-ERROR-MSG        TO DL-ERROR-MSG                     CL*17
049585                                                                     CL*17
049586     MOVE TR006-UPC-NBR          TO DL-UPC-NBR-N                          
049587     IF DL-UPC-NBR = ALL ZEROES                                           
049588         MOVE SPACES             TO DL-UPC-NBR                            
049589     END-IF.                                                              
049590                                                                          
049586     MOVE TR006-SKU              TO DL-SKU-NBR-N                          
049587     IF DL-SKU-NBR = ALL ZEROES                                           
049588         MOVE SPACES             TO DL-SKU-NBR                            
049589     END-IF.                                                              
049590                                                                          
049596     IF PV-LINE-CNT > 62                                             CL*17
049597             PERFORM 8000-PRINT-HEADINGS                             CL*17
049598     END-IF.                                                              
049599                                                                          
049600     IF PS-PO-BREAK                                                       
049601         WRITE REPORT-RECORD                                         CL*17
049602         FROM DL-DETAIL-LINE                                         CL*17
049603         AFTER ADVANCING 3 LINE                                      CL*17
049604         SET PS-NOT-PO-BREAK     TO TRUE                                  
049605         ADD +3 TO PV-LINE-CNT                                       CL*17
049606     ELSE                                                                 
049607         WRITE REPORT-RECORD                                         CL*17
049608         FROM DL-DETAIL-LINE                                         CL*17
049609         AFTER ADVANCING 2 LINE                                      CL*17
049610         ADD +2 TO PV-LINE-CNT                                       CL*17
049611     END-IF.                                                              
049612                                                                     CL*17
049613                                                                     CL*17
049614     PERFORM 7000-READ-INPUT.                                        CL*17
049615/                                                                         
049616 2100-FORMAT-SHIP-DATE.                                                   
049617     IF TR006-DONT-SHIP-BEFORE-DATE = SPACES                         CL*17
049618        MOVE SPACES              TO DL-DONT-SHIP-DTE                 CL*17
049619     ELSE                                                                 
049620         MOVE TR006-DONT-SHIP-BEFORE-DATE (1:2)                      CL*17
049621                                 TO DL-DONT-SHIP-BEFORE-MONTH             
049622         MOVE TR006-DONT-SHIP-BEFORE-DATE (3:2)                      CL*17
049623                                 TO DL-DONT-SHIP-BEFORE-DAY               
049624         MOVE TR006-DONT-SHIP-BEFORE-DATE (5:2)                      CL*17
049625                                 TO DL-DONT-SHIP-BEFORE-YEAR              
049626         MOVE '/'                TO DL-DONT-SHIP-BEFORE-SLASH1            
049627                                    DL-DONT-SHIP-BEFORE-SLASH2            
049628     END-IF.                                                              
049629 2110-FORMAT-ETA-DATE.                                                    
049630     IF TR006-ETA-DATE = SPACES                                      CL*17
049631         MOVE SPACES             TO DL-ETA-DATE                           
049632     ELSE                                                                 
049633         MOVE TR006-ETA-DATE(5:2) TO DL-ETA-MONTH                 04100026
049634         MOVE TR006-ETA-DATE(7:2) TO DL-ETA-DAY                   04100026
049635         MOVE TR006-ETA-DATE(3:2) TO DL-ETA-YEAR                  04100026
049636         MOVE '/'                 TO DL-ETA-SLASH1                04110026
049637                                     DL-ETA-SLASH2                04130026
049638     END-IF.                                                              
049639/                                                                         
049640 7000-READ-INPUT.                                                    CL*17
049641                                                                     CL*17
049642     MOVE '7000'                  TO PGM-LOCATION.                   CL*17
049643     MOVE '7000-READ-INPUT           '                               CL*17
049644                                  TO PV-PARAGRAPH-NAME.              CL*17
049645                                                                     CL*17
049646     READ TR006-REPORT-EXTRACT-FILE                                  CL*17
049647         INTO TR006-RECORD                                                
049648         AT END                                                      CL*17
049649           SET PS-EOF TO TRUE.                                       CL*17
049650                                                                     CL*17
049651 EJECT                                                               CL*17
049652 8000-PRINT-HEADINGS.                                                CL*17
049653                                                                     CL*17
049654     ADD 1                        TO PV-PAGE-CNT.                    CL*17
049655     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.             CL*17
049656                                                                          
049657     EVALUATE TRUE                                                        
049658                                                                          
049659         WHEN CC-ETA-SEQUENCE                                             
049660             MOVE PC-REPORT-NBR-1 TO DP132O-REPORT-NUMBER                 
049661                                                                          
049662         WHEN CC-ORD-SEQUENCE                                             
049663             MOVE PC-REPORT-NBR-2 TO DP132O-REPORT-NUMBER                 
049664                                                                          
049665         WHEN CC-ETA-SEQUENCE-MSPLT                                       
049666             MOVE PC-REPORT-NBR-3 TO DP132O-REPORT-NUMBER                 
049667                                                                          
049668         WHEN CC-ORD-SEQUENCE-MSPLT                                       
049669             MOVE PC-REPORT-NBR-4 TO DP132O-REPORT-NUMBER                 
049671     END-EVALUATE.                                                        
049672                                                                          
049679     WRITE REPORT-RECORD                                             CL*17
049680       FROM DP132O-STANDRD-HEADER-132-COLS                           CL*17
049681         AFTER ADVANCING PAGE.                                       CL*17
049682                                                                          
050510     IF TR006-REXMIT-RPT                                                  
050511       IF TR006-ERROR-TYPE-MISS-SPLT                                      
050512           WRITE REPORT-RECORD                                            
050513              FROM HEADING-LINE-0B                                        
050514              AFTER ADVANCING 2 LINES                                     
050515       ELSE                                                               
050520           WRITE REPORT-RECORD                                            
050530              FROM HEADING-LINE-0                                         
050540              AFTER ADVANCING 2 LINES                                     
050541       END-IF                                                             
050550     ELSE                                                                 
050551         IF TR006-XMIT-RPT                                                
050552           IF TR006-ERROR-TYPE-MISS-SPLT                                  
050560               WRITE REPORT-RECORD                                        
050570                  FROM HEADING-LINE-0C                                    
050580                  AFTER ADVANCING 2 LINES                                 
050581           ELSE                                                           
050582               WRITE REPORT-RECORD                                        
050583                  FROM HEADING-LINE-0A                                    
050584                  AFTER ADVANCING 2 LINES                                 
050585           END-IF                                                         
050586         END-IF                                                           
050590     END-IF.                                                              
050591                                                                          
050600     MOVE 2                       TO PV-LINE-CNT.                    CL*17
050700                                                                     CL*17
050800     WRITE REPORT-RECORD                                             CL*17
050900       FROM HEADING-LINE-1                                           CL*17
051000         AFTER ADVANCING 1 LINES.                                    CL*17
051100                                                                     CL*17
051200     ADD +1                       TO PV-LINE-CNT.                    CL*27
051300                                                                     CL*27
051400* COLUMN HEADINGS                                                         
051500     WRITE REPORT-RECORD                                             CL*17
051600       FROM DH1-DETAIL-HEADING-1                                  03570000
051700         AFTER ADVANCING 3 LINES.                                    CL*17
051800                                                                     CL*17
051900     ADD +3                       TO PV-LINE-CNT.                    CL*27
052000                                                                     CL*17
052100     WRITE REPORT-RECORD                                             CL*17
052200       FROM DH1-DETAIL-HEADING-2                                  03570000
052300         AFTER ADVANCING 1 LINES.                                    CL*17
052400                                                                     CL*17
052500     ADD +1                          TO PV-LINE-CNT.                 CL*27
052600/                                                                    CL*17
052700******************************************************************   CL*18
052800* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE         CL*18
052900* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                    CL*18
053000******************************************************************   CL*18
053100 9100-SQL-ABEND.                                                     CL*18
053200     DISPLAY '** ABEND     **'.                                      CL*18
053300     DISPLAY '** PROGRAM   ** = TRKRP006'.                           CL*18
053400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                 CL*18
053500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.        CL*18
053600                                                                     CL*18
053700******************************************************************   CL*18
053800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-       CL*18
053900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE            CL*18
054000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE        CL*18
054100* FORMAT.                                                            CL*18
054200******************************************************************   CL*18
054300     COPY DPPD004.                                                   CL*18
054400                                                                     CL*18
054500     MOVE +4013 TO PV-ABEND-CODE.                                    CL*18
054600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                            CL*18
054700                                                                     CL*18
054800 9200-ABEND.                                                         CL*33
054900******************************************************************   CL*33
055000*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                          CL*33
055100******************************************************************   CL*33
055200     DISPLAY '***************************'.                          CL*33
055300     DISPLAY '**       ABEND           **'.                          CL*33
055400     DISPLAY '**  IN PROGRAM TRKRP006  **'.                          CL*33
055500     DISPLAY '***************************'.                          CL*33
055600     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.           CL*33
055700     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.          CL*33
055800     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.          CL*33
055900                                                                     CL*33
056000     MOVE +4014                  TO PV-ABEND-CODE.                   CL*42
056100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                            CL*42
