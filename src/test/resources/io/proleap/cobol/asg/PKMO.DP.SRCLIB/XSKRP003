000900 IDENTIFICATION DIVISION.                                         00010000
001000 PROGRAM-ID.         XSKRP003.                                    00020000
001100 AUTHOR.             JIM LEIKNESS.                                00030000
001200 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
001300 DATE-WRITTEN.       12-27-2002.                                  00050000
001400 DATE-COMPILED.                                                   00060000
001510******************************************************************00070000
001520*  COMPARES DATA FROM DOMAIN TABLES AND SYSTEM OF RECORD TABLES   00080000
001530*  FOR THE XST_TERR TABLE.                                        00090000
001540******************************************************************00100000
001550                                                                  00110000
001600 ENVIRONMENT DIVISION.                                            00120000
001700                                                                  00130000
001800 CONFIGURATION SECTION.                                           00140000
001900                                                                  00150000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00160000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00170000
002200                                                                  00180000
002300 INPUT-OUTPUT SECTION.                                            00190000
002400                                                                  00200000
002500 FILE-CONTROL.                                                    00210000
002600                                                                  00220000
002700     SELECT XST-INPUT-FILE       ASSIGN TO INP01.                 00230000
002800     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00240000
002900     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00250000
003000                                                                  00260000
003100 DATA DIVISION.                                                   00270000
003200                                                                  00280000
003300 FILE SECTION.                                                    00290000
003400                                                                  00300000
003500 FD  RMS-INPUT-FILE                                               00310000
003600     RECORDING MODE IS F                                          00320000
003700     BLOCK CONTAINS 0 RECORDS                                     00330000
003800     LABEL RECORDS ARE OMITTED.                                   00340000
003900 01  RMS-INPUT-RECORD                    PIC  X(57).              00350000
004000                                                                  00360000
004100 FD  XST-INPUT-FILE                                               00370000
004200     RECORDING MODE IS F                                          00380000
004300     BLOCK CONTAINS 0 RECORDS                                     00390000
004400     LABEL RECORDS ARE OMITTED.                                   00400000
004500 01  XST-INPUT-RECORD                    PIC  X(57).              00410000
004600                                                                  00420000
004700 FD  ERROR-REPORT                                                 00430000
004800     RECORDING MODE IS F                                          00440000
004900     BLOCK CONTAINS 0 RECORDS                                     00450000
005000     LABEL RECORDS ARE OMITTED.                                   00460000
005100 01  ERR-RPT-LINE                        PIC  X(200).             00470000
005200                                                                  00480000
005300 WORKING-STORAGE SECTION.                                         00490000
005400                                                                  00500000
005500     COPY HORD007.                                                00510000
005600                                                                  00520000
005700     COPY DPWS200O.                                               00530000
005800                                                                  00540000
005900 01 XST-REC.                                                      00550000
006000     05 XST-TERR-NBR          PIC S9(04) COMP-3.                  00560000
006100     05 XST-TERR-NM           PIC X(20) VALUE SPACE.              00570000
006110     05 XST-TERR-MGR-NM       PIC X(32) VALUE SPACE.              00580000
006200                                                                  00590000
006300 01 PC-PROGRAM-CONSTANTS.                                         00600000
006400     05 PC-PGM-NAME           PIC X(08)  VALUE 'XSKRP003'.        00610000
006500                                                                  00620000
006600 01 PV-PROGRAM-VARIABLES.                                         00630000
006700     05 PV-XST-KEY.                                               00640000
006800        10 PV-XST-TERR-NBR       PIC 9(04).                       00650000
006900     05 PV-XST-TERR-NM           PIC X(20) VALUE SPACE.           00660000
006910     05 PV-XST-TERR-MGR-NM       PIC X(32) VALUE SPACE.           00670000
007000                                                                  00680000
007100     05 PV-RMS-KEY.                                               00690000
007200         10 PV-RMS-TERR-NBR       PIC 9(04).                      00700000
007300     05 PV-RMS-TERR-NM            PIC X(20) VALUE SPACE.          00710000
007310     05 PV-RMS-TERR-MGR-NM        PIC X(32) VALUE SPACE.          00720000
007400                                                                  00730000
007500     05 PV-PAGE-CNT               PIC S9(05)  VALUE ZERO.         00740000
007600     05 PV-LINE-CNT               PIC S9(04)  COMP VALUE ZERO.    00750000
007700     05 PV-MAX-LINES              PIC S9(04)  COMP VALUE +71.     00760000
007800                                                                  00770000
007900     05 PV-DISPLAY-CNT            PIC ZZZZ9.                      00780000
008000     05 PV-NBR-ERRORS             PIC S9(04)  COMP                00790000
008100                                                VALUE ZERO.       00800000
008200     05 PV-DATE-YYMMDD.                                           00810000
008300          10 PV-YYMMDD-YY       PIC X(02)  VALUE SPACE.           00820000
008400          10 PV-YYMMDD-MM       PIC X(02)  VALUE SPACE.           00830000
008500          10 PV-YYMMDD-DD       PIC X(02)  VALUE SPACE.           00840000
008600     05 PV-TIME-HHMMSS.                                           00850000
008700          10 PV-HHMMSS-HH       PIC X(02)  VALUE SPACE.           00860000
008800          10 PV-HHMMSS-MM       PIC X(02)  VALUE SPACE.           00870000
008900          10 PV-HHMMSS-SS       PIC X(02)  VALUE SPACE.           00880000
009000     05 PV-MESSAGE              PIC X(58)  VALUE SPACE.           00890000
009100                                                                  00900000
009200 01 RPT-TOTAL-LINE.                                               00910000
009300     05 FILLER     PIC  X(23) VALUE                               00920000
009400                         'TOTAL NUMBER OF ERRORS '.               00930000
009500     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00940000
009600                                                                  00950000
009700 01 RPT-END-OF-REPORT-LINE.                                       00960000
009800     05 FILLER     PIC  X(21) VALUE                               00970000
009900                            '*** END OF REPORT ***'.              00980000
010000 01 PA-PROGRAM-ACCUMULATORS.                                      00990000
010100     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              01000000
010200     05 PA-XST-RECS-READ       PIC 9(13) VALUE ZERO.              01010000
010300     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              01020000
010400                                                                  01030000
010500 01 PS-PROGRAM-SWITCHES.                                          01040000
010600     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01050000
010700         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           01060000
010800         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           01070000
010900     05 PS-MORE-XST-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01080000
011000         88 PS-MORE-XST-INPUT-RECS           VALUE 'Y'.           01090000
011100         88 PS-END-OF-XST-INPUT-RECS         VALUE 'N'.           01100000
011200     05 PS-RMS-OR-XST-ERR        PIC X(01)   VALUE '0'.           01110000
011300         88 PS-RMS-ERROR                     VALUE '1'.           01120000
011400         88 PS-XST-ERROR                     VALUE '2'.           01130000
011500         88 PS-DATA-ERROR                    VALUE '3'.           01140000
011600                                                                  01150000
011700 01 RPT-REPORT-HEADING.                                           01160000
011800     05 FILLER     PIC  X(84)    VALUE SPACES.                    01170000
011900     05 FILLER     PIC  X(37)    VALUE                            01180000
012000         'XS TERRITORY DATA INTEGRITY ERRORS'.                    01190000
012100                                                                  01200000
012200 01 RPT-COL-HEADING-1.                                            01210000
012300     05 FILLER     PIC  X(01) VALUE SPACE.                        01220000
012400     05 FILLER     PIC  X(02) VALUE ALL '-'.                      01230000
012500     05 FILLER     PIC  X(03) VALUE 'KEY'.                        01240000
012600     05 FILLER     PIC  X(02) VALUE ALL '-'.                      01250000
012700                                                                  01260000
012800 01 RPT-COL-HEADING-2.                                            01270000
012900     05 FILLER     PIC  X(01) VALUE SPACE.                        01280000
013000     05 FILLER     PIC  X(19) VALUE 'TERR_NBR'.                   01290000
013010     05 FILLER     PIC  X(03) VALUE SPACE.                        01300000
013100     05 FILLER     PIC  X(34) VALUE 'XSDOMAIN'.                   01310000
013200     05 FILLER     PIC  X(24) VALUE SPACE.                        01320000
013210     05 FILLER     PIC  X(41) VALUE 'SYSTEM OF RECORD'.           01321000
013220     05 FILLER     PIC  X(11) VALUE SPACE.                        01322000
013300     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    01323000
013400                                                                  01324000
013500 01 RPT-COL-HEADING-3.                                            01325000
013700     05 FILLER     PIC  X(12) VALUE SPACE.                        01326000
013800     05 FILLER     PIC  X(07) VALUE 'TERR_NM'.                    01327000
013801     05 FILLER     PIC  X(17) VALUE SPACE.                        01328000
013810     05 FILLER     PIC  X(11) VALUE 'TERR_MGR_NM'.                01329000
013811     05 FILLER     PIC  X(26) VALUE SPACE.                        01330000
013820     05 FILLER     PIC  X(07) VALUE 'TERR_NM'.                    01340000
013830     05 FILLER     PIC  X(17) VALUE SPACE.                        01350000
013840     05 FILLER     PIC  X(11) VALUE 'TERR_MGR_NM'.                01360000
014000                                                                  01370000
014100 01 RPT-COL-HEADING-4.                                            01380000
014200     05 FILLER     PIC  X(180) VALUE ALL '-'.                     01390000
014300                                                                  01400000
014400 01 DL-DETAIL-LINE.                                               01410000
014500     05 FILLER              PIC  X(01) VALUE SPACE.               01420000
014600     05 DL-TERR-NBR         PIC  X(04) VALUE SPACE.               01430000
014700     05 FILLER              PIC  X(06) VALUE SPACE.               01440000
014800     05 DL-XST-TERR-NM      PIC  X(20) VALUE SPACE.               01450000
014810     05 FILLER              PIC  X(04) VALUE SPACE.               01460000
014820     05 DL-XST-TERR-MGR-NM  PIC  X(32) VALUE SPACE.               01470000
014900     05 FILLER              PIC  X(06) VALUE SPACE.               01480000
015000     05 DL-RMS-TERR-NM      PIC  X(20) VALUE SPACE.               01490000
015010     05 FILLER              PIC  X(04) VALUE SPACE.               01500000
015020     05 DL-RMS-TERR-MGR-NM  PIC  X(32) VALUE SPACE.               01501000
015100     05 FILLER              PIC  X(04) VALUE SPACE.               01502000
015200     05 DL-MESSAGE          PIC  X(67) VALUE SPACE.               01503000
015300                                                                  01504000
015310******************************************************************01505000
015400 PROCEDURE DIVISION.                                              01506000
015410******************************************************************01507000
015600 0000-MAIN-MODULE.                                                01508000
015700                                                                  01509000
015800       OPEN INPUT RMS-INPUT-FILE                                  01510000
015900                  XST-INPUT-FILE                                  01520000
016000            OUTPUT ERROR-REPORT.                                  01530000
016100                                                                  01540000
016200       PERFORM 1000-INITIALIZE.                                   01550000
016300       PERFORM 7000-READ-XST-INPUT-FILE.                          01560000
016400       PERFORM 7100-READ-RMS-INPUT-FILE.                          01570000
016500                                                                  01580000
016600       PERFORM 2000-PROCESS-RECS                                  01590000
016700          UNTIL (PS-END-OF-XST-INPUT-RECS                         01600000
016800            AND PS-END-OF-RMS-INPUT-RECS).                        01610000
016900                                                                  01620000
017000       PERFORM 8400-WRITE-TOTALS.                                 01630000
017100                                                                  01640000
017200       CLOSE RMS-INPUT-FILE                                       01650000
017300             XST-INPUT-FILE                                       01660000
017400             ERROR-REPORT.                                        01670000
017500                                                                  01680000
017600       DISPLAY '**** XSKRP003 STATISTICS ****'                    01690000
017700       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     01700000
017800       DISPLAY 'TOTAL XST RECORDS READ : ' PA-XST-RECS-READ.      01710000
017900       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      01720000
018000       DISPLAY ' '                                                01730000
018100                                                                  01740000
018200       STOP RUN.                                                  01750000
018300                                                                  01760000
018400 1000-INITIALIZE.                                                 01770000
018500                                                                  01780000
018600       ACCEPT PV-DATE-YYMMDD FROM DATE.                           01790000
018700       MOVE PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      01800000
018800       MOVE PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     01810000
018900       MOVE PV-YYMMDD-DD TO DP200O-RUN-DAY.                       01820000
019000                                                                  01830000
019100       ACCEPT PV-TIME-HHMMSS FROM TIME.                           01840000
019200       MOVE PV-HHMMSS-HH TO DP200O-RUN-HOUR.                      01850000
019300       MOVE PV-HHMMSS-MM TO DP200O-RUN-MINUTE.                    01860000
019400       MOVE PC-PGM-NAME TO DP200O-PROGRAM-NAME.                   01870000
019500       MOVE 1        TO DP200O-REPORT-NUMBER.                     01880000
019600                                                                  01890000
019700       PERFORM 8100-WRITE-STD-RPT-HEADING.                        01900000
019800       PERFORM 8200-WRITE-REPORT-HEADING.                         01910000
019900       PERFORM 8300-WRITE-COLUMN-HEADING.                         01920000
020000                                                                  01930000
020100 2000-PROCESS-RECS.                                               01940000
020200                                                                  01950000
020300       MOVE HO007-TERR-NBR      TO  PV-RMS-TERR-NBR.              01960000
020400       MOVE HO007-TERR-NM       TO  PV-RMS-TERR-NM.               01970000
020410       MOVE HO007-TERR-MGR-NM   TO  PV-RMS-TERR-MGR-NM.           01980000
020500                                                                  01990000
020600       MOVE XST-TERR-NBR        TO  PV-XST-TERR-NBR.              02000000
020700       MOVE XST-TERR-NM         TO  PV-XST-TERR-NM.               02010000
020710       MOVE XST-TERR-MGR-NM     TO  PV-XST-TERR-MGR-NM.           02020000
020800                                                                  02030000
021800     IF PV-XST-KEY = PV-RMS-KEY                                   02040000
022000        PERFORM 3000-COMPARE-FIELDS                               02050000
022100        PERFORM 7000-READ-XST-INPUT-FILE                          02060000
022200        PERFORM 7100-READ-RMS-INPUT-FILE                          02070000
022300      ELSE                                                        02080000
022310          IF ((PV-RMS-KEY < PV-XST-KEY)                           02090000
022320             OR PS-END-OF-XST-INPUT-RECS) AND                     02100000
022330             PS-MORE-RMS-INPUT-RECS                               02110000
022340             MOVE '1' TO PS-RMS-OR-XST-ERR                        02120000
022350             MOVE 'KEY ON SYSTEM OF RECORD TABLES ONLY'           02130000
022360                 TO PV-MESSAGE                                    02140000
022370             PERFORM 8000-WRITE-OUTPUT-REC                        02150000
022380             PERFORM 7100-READ-RMS-INPUT-FILE                     02160000
022390          ELSE                                                    02170000
022400              IF (PV-RMS-KEY > PV-XST-KEY                         02180000
022500                   OR PS-END-OF-RMS-INPUT-RECS)                   02190000
022600                  AND PS-MORE-XST-INPUT-RECS                      02200000
022700                  MOVE '2' TO PS-RMS-OR-XST-ERR                   02210000
022800                  MOVE 'KEY ON XS DOMAIN TABLES ONLY'             02220000
022810                                                   TO PV-MESSAGE  02230000
022900                  PERFORM 8000-WRITE-OUTPUT-REC                   02240000
023000                  PERFORM 7000-READ-XST-INPUT-FILE                02250000
023100              END-IF                                              02260000
023200          END-IF                                                  02270000
023300      END-IF.                                                     02280000
023400                                                                  02290000
023500 3000-COMPARE-FIELDS.                                             02300000
023600                                                                  02310000
023700      EVALUATE TRUE                                               02320000
023800         WHEN PV-RMS-TERR-NM  NOT = PV-XST-TERR-NM                02330000
023900             MOVE '3' TO PS-RMS-OR-XST-ERR                        02340000
024000             MOVE 'TERRITORY NAME DATA DOES NOT MATCH'            02350000
024100                                                TO PV-MESSAGE     02360000
024200             PERFORM 8000-WRITE-OUTPUT-REC                        02370000
024210         WHEN PV-RMS-TERR-MGR-NM  NOT = PV-XST-TERR-MGR-NM        02380000
024220             MOVE '3' TO PS-RMS-OR-XST-ERR                        02390000
024230             MOVE 'TERRITORY MANAGER NAME DOES NOT MATCH'         02400000
024240                                                TO PV-MESSAGE     02410000
024250             PERFORM 8000-WRITE-OUTPUT-REC                        02420000
024300      END-EVALUATE.                                               02430000
024400                                                                  02440000
024500 7000-READ-XST-INPUT-FILE.                                        02450000
024600                                                                  02460000
024700       INITIALIZE XST-REC.                                        02470000
024800                                                                  02480000
024900       READ XST-INPUT-FILE INTO XST-REC                           02490000
025000           AT END SET PS-END-OF-XST-INPUT-RECS TO TRUE.           02500000
025100                                                                  02510000
025200       ADD 1 TO PA-XST-RECS-READ.                                 02520000
025300                                                                  02530000
025400 7100-READ-RMS-INPUT-FILE.                                        02540000
025500                                                                  02550000
025600       INITIALIZE HO007-TERRITORY-DATA.                           02560000
025700                                                                  02570000
025800       READ RMS-INPUT-FILE INTO HO007-TERRITORY-DATA              02580000
025900            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          02590000
026000                                                                  02600000
026100       ADD 1 TO PA-RMS-RECS-READ.                                 02610000
026200                                                                  02620000
026300 8000-WRITE-OUTPUT-REC.                                           02630000
026500                                                                  02640000
026600       IF PS-RMS-ERROR                                            02650000
026700          MOVE SPACES TO DL-DETAIL-LINE                           02660000
026800          MOVE PV-RMS-TERR-NBR      TO DL-TERR-NBR                02670000
026810          MOVE PV-RMS-TERR-NM       TO DL-RMS-TERR-NM             02680000
026900          MOVE PV-RMS-TERR-MGR-NM   TO DL-RMS-TERR-MGR-NM         02690000
027000          MOVE PV-MESSAGE TO DL-MESSAGE                           02700000
027100       ELSE                                                       02710000
027200          IF PS-XST-ERROR                                         02720000
027300             MOVE SPACES TO DL-DETAIL-LINE                        02730000
027400             MOVE PV-XST-TERR-NBR    TO DL-TERR-NBR               02740000
027410             MOVE PV-XST-TERR-NM     TO DL-XST-TERR-NM            02741000
027500             MOVE PV-XST-TERR-MGR-NM TO DL-XST-TERR-MGR-NM        02742000
027600             MOVE PV-MESSAGE TO DL-MESSAGE                        02743000
027700          ELSE                                                    02744000
027800             MOVE SPACES TO DL-DETAIL-LINE                        02745000
027900             MOVE PV-RMS-TERR-NBR     TO DL-TERR-NBR              02746000
027910             MOVE PV-RMS-TERR-NM      TO DL-RMS-TERR-NM           02747000
028000             MOVE PV-RMS-TERR-MGR-NM  TO DL-RMS-TERR-MGR-NM       02748000
028100             MOVE PV-XST-TERR-NM      TO DL-XST-TERR-NM           02749000
028110             MOVE PV-XST-TERR-MGR-NM  TO DL-XST-TERR-MGR-NM       02750000
028200             MOVE PV-MESSAGE TO DL-MESSAGE                        02760000
028300          END-IF                                                  02770000
028400       END-IF.                                                    02780000
028500                                                                  02790000
028600       IF PV-LINE-CNT > PV-MAX-LINES                              02800000
028700          PERFORM 8100-WRITE-STD-RPT-HEADING                      02810000
028800          PERFORM 8200-WRITE-REPORT-HEADING                       02820000
028900          PERFORM 8300-WRITE-COLUMN-HEADING                       02830000
029000       END-IF.                                                    02840000
029100                                                                  02850000
029200       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     02860000
029300             AFTER ADVANCING 1 LINE.                              02870000
029400       ADD +1 TO PV-LINE-CNT.                                     02880000
029500                                                                  02890000
029510       MOVE 4095 TO RETURN-CODE.                                  02900000
029600       ADD 1 TO PA-ERROR-MESSAGES.                                02910000
029700                                                                  02920000
029800 8100-WRITE-STD-RPT-HEADING.                                      02930000
029900                                                                  02940000
030000       ADD 1  TO PV-PAGE-CNT.                                     02950000
030100       MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                    02960000
030200       WRITE ERR-RPT-LINE FROM DP200O-STANDRD-HEADER-200-COLS     02970000
030300             AFTER ADVANCING PAGE.                                02980000
030400       MOVE +1 TO PV-LINE-CNT.                                    02990000
030500                                                                  03000000
030600 8200-WRITE-REPORT-HEADING.                                       03010000
030700                                                                  03020000
030800       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 03030000
030900            AFTER ADVANCING 1 LINES.                              03040000
031000       ADD +1 TO PV-LINE-CNT.                                     03050000
031100                                                                  03060000
031200 8300-WRITE-COLUMN-HEADING.                                       03070000
031300                                                                  03080000
031400       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  03090000
031500            AFTER ADVANCING 2 LINES.                              03100000
031600       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  03110000
031700            AFTER ADVANCING 1 LINES.                              03120000
031800       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  03130000
031900            AFTER ADVANCING 1 LINES.                              03140000
032000       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  03150000
032100            AFTER ADVANCING 1 LINES.                              03160000
032200       ADD +5 TO PV-LINE-CNT.                                     03170000
032300                                                                  03180000
032400 8400-WRITE-TOTALS.                                               03190000
032500                                                                  03200000
032600      IF PV-LINE-CNT > PV-MAX-LINES                               03210000
032700         PERFORM 8100-WRITE-STD-RPT-HEADING                       03220000
032800         PERFORM 8200-WRITE-REPORT-HEADING                        03230000
032900         PERFORM 8300-WRITE-COLUMN-HEADING                        03240000
033000      END-IF.                                                     03250000
033100                                                                  03260000
033200      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    03270000
033300      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      03280000
033400            AFTER ADVANCING 2 LINES.                              03290000
033500      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              03300000
033600            AFTER ADVANCING 1 LINES.                              03310000
033700                                                                  03320000
