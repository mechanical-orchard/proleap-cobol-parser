000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         XMKRP038.                                    00020000
000300 AUTHOR.             BOB MCASEY.                                  00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       02-17-2003.                                  00050000
000600 DATE-COMPILED.                                                   00060000
000700*                                                                 00070000
000800******************************************************************00080001
000810*  COMPARES DATA FROM THE XMDOMAIN AND SYSTEM OF RECORD           00090001
000811*  XMT_STR_GP TABLE.                                              00100002
000820******************************************************************00110001
      *---------------------------------------------------------------* 00120006
      *    WR/PITS#     DATE        DESCRIPTION                       * 00130006
      *    --------   ----------   ---------------------------------  * 00140006
      *    WR24442    08/20/2003   INITIAL CREATION.                  * 00150006
      *---------------------------------------------------------------* 00160006
000800 ENVIRONMENT DIVISION.                                            00170000
000900                                                                  00180000
001000 CONFIGURATION SECTION.                                           00190000
001100                                                                  00200000
001200 SOURCE-COMPUTER.    IBM-3090.                                    00210000
001300 OBJECT-COMPUTER.    IBM-3090.                                    00220000
001400                                                                  00230000
002000 INPUT-OUTPUT SECTION.                                            00240000
001600                                                                  00250000
001700 FILE-CONTROL.                                                    00260000
001800                                                                  00270000
001900     SELECT XMT-INPUT-FILE       ASSIGN TO INP01.                 00280000
002000     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00290000
002100     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00300000
002200                                                                  00310000
002300 DATA DIVISION.                                                   00320000
002400                                                                  00330000
002500 FILE SECTION.                                                    00340000
002600                                                                  00350000
003300 FD  XMT-INPUT-FILE                                               00360000
003400     RECORDING MODE IS F                                          00370000
003500     BLOCK CONTAINS 0 RECORDS                                     00380000
003600     LABEL RECORDS ARE OMITTED.                                   00390000
003700 01  XMT-INPUT-RECORD                    PIC  X(37).              00400000
003800                                                                  00410000
002700 FD  RMS-INPUT-FILE                                               00420000
002800     RECORDING MODE IS F                                          00430000
002900     BLOCK CONTAINS 0 RECORDS                                     00440000
003000     LABEL RECORDS ARE OMITTED.                                   00450000
003100 01  RMS-INPUT-RECORD                    PIC  X(44).              00460000
003200                                                                  00470000
003900 FD  ERROR-REPORT                                                 00480000
004000     RECORDING MODE IS F                                          00490000
004100     BLOCK CONTAINS 0 RECORDS                                     00500000
004200     LABEL RECORDS ARE OMITTED.                                   00510000
004300 01  ERR-RPT-LINE                        PIC  X(200).             00520000
004400                                                                  00530000
004500 WORKING-STORAGE SECTION.                                         00540000
005350                                                                  00550000
005351 01 PC-PROGRAM-CONSTANTS.                                         00560000
005352     05 PC-PGM-NAME                PIC X(08)  VALUE 'XMKRP038'.   00570000
005353                                                                  00580000
005360 01 PV-PROGRAM-VARIABLES.                                         00590000
005370     05 PV-XMT-KEY.                                               00600000
005380        10 PV-XMT-STR-GP-TYP-CDE   PIC 9(04).                     00610000
005381        10 PV-XMT-STR-GP-ID        PIC 9(04).                     00620000
005390     05 PV-XMT-GP-NM               PIC X(30) VALUE SPACE.         00630000
005391     05 PV-XMT-ST-CDE              PIC X(02) VALUE SPACE.         00640000
005392     05 PV-XMT-RPT-FLSH-SLS-IND    PIC X(01) VALUE SPACE.         00650000
005400                                                                  00660000
005410     05 PV-RMS-KEY.                                               00670000
005420         10 PV-RMS-STR-GP-TYP-CDE  PIC 9(04).                     00680000
005421         10 PV-RMS-STR-GP-ID       PIC 9(04).                     00690000
005430     05 PV-RMS-GP-NM               PIC X(30) VALUE SPACE.         00700000
005431     05 PV-RMS-ST-CDE              PIC X(02) VALUE SPACE.         00710000
005432     05 PV-RMS-RPT-FLSH-SLS-IND    PIC X(01) VALUE SPACE.         00720000
005433                                                                  00730000
005440     05 PV-PAGE-CNT                PIC S9(05)  VALUE ZERO.        00740000
005450     05 PV-LINE-CNT                PIC S9(04)  COMP VALUE ZERO.   00750000
005460     05 PV-MAX-LINES               PIC S9(04)  COMP VALUE +71.    00760000
005470                                                                  00770000
005480     05 PV-DISPLAY-CNT             PIC ZZZZ9.                     00780000
005492     05 PV-NBR-ERRORS              PIC S9(04)  COMP               00790000
005493                                                VALUE ZERO.       00800000
005494     05 PV-DATE-YYMMDD.                                           00810000
005495          10 PV-YYMMDD-YY          PIC X(02)  VALUE SPACE.        00820000
005496          10 PV-YYMMDD-MM          PIC X(02)  VALUE SPACE.        00830000
005497          10 PV-YYMMDD-DD          PIC X(02)  VALUE SPACE.        00840000
005498     05 PV-TIME-HHMMSS.                                           00850000
005499          10 PV-HHMMSS-HH          PIC X(02)  VALUE SPACE.        00860000
005500          10 PV-HHMMSS-MM          PIC X(02)  VALUE SPACE.        00870000
005501          10 PV-HHMMSS-SS          PIC X(02)  VALUE SPACE.        00880000
005502     05 PV-MESSAGE                 PIC X(40)  VALUE SPACE.        00890000
005510                                                                  00900000
005530 01 RPT-TOTAL-LINE.                                               00910000
005540     05 FILLER     PIC  X(23) VALUE                               00920000
005550                         'TOTAL NUMBER OF ERRORS '.               00930000
005560     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00940000
005561                                                                  00950000
005562 01 RPT-END-OF-REPORT-LINE.                                       00960000
005563     05 FILLER     PIC  X(21) VALUE                               00970000
005564                            '*** END OF REPORT ***'.              00980000
005565 01 PA-PROGRAM-ACCUMULATORS.                                      00990000
005566     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              01000000
005567     05 PA-XMT-RECS-READ       PIC 9(13) VALUE ZERO.              01010000
005568     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              01020000
005569                                                                  01030000
005571 01 PS-PROGRAM-SWITCHES.                                          01040000
005572     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01050000
005573         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           01060000
005574         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           01070000
005575     05 PS-MORE-XMT-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01080000
005576         88 PS-MORE-XMT-INPUT-RECS           VALUE 'Y'.           01090000
005577         88 PS-END-OF-XMT-INPUT-RECS         VALUE 'N'.           01100000
005578     05 PS-RMS-OR-XMT-ERR        PIC X(01)   VALUE '0'.           01110000
005579         88 PS-RMS-ERROR                     VALUE '1'.           01120000
005580         88 PS-XMT-ERROR                     VALUE '2'.           01130000
005581         88 PS-DATA-ERROR                    VALUE '3'.           01140000
005582                                                                  01150000
005583 01 RPT-REPORT-HEADING.                                           01160000
005584     05 FILLER     PIC  X(82)    VALUE SPACES.                    01170005
005585     05 FILLER     PIC  X(38)    VALUE                            01180000
005586         'XM STORE GROUP DATA INTEGRITY ERRORS'.                  01190000
005587                                                                  01200000
005588 01 RPT-COL-HEADING-1.                                            01210000
005589     05 FILLER     PIC  X(01) VALUE SPACE.                        01220000
005590     05 FILLER     PIC  X(07) VALUE ALL '-'.                      01230000
005591     05 FILLER     PIC  X(03) VALUE 'KEY'.                        01240000
005592     05 FILLER     PIC  X(05) VALUE ALL '-'.                      01250000
005593                                                                  01260000
005594 01 RPT-COL-HEADING-2.                                            01270000
005595     05 FILLER     PIC  X(01) VALUE SPACE.                        01280000
005596     05 FILLER     PIC  X(07) VALUE 'STR_GP'.                     01290000
005597     05 FILLER     PIC  X(02) VALUE SPACE.                        01300000
005598     05 FILLER     PIC  X(06) VALUE 'STR_GP'.                     01310000
005599     05 FILLER     PIC  X(06) VALUE SPACE.                        01320000
005600     05 FILLER     PIC  X(37) VALUE 'XMDOMAIN'.                   01330000
005601     05 FILLER     PIC  X(37) VALUE 'SYSTEM OF RECORD'.           01340000
005602     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    01350000
005603                                                                  01360000
005604 01 RPT-COL-HEADING-3.                                            01370000
005605     05 FILLER     PIC  X(01) VALUE SPACE.                        01380000
005606     05 FILLER     PIC  X(07) VALUE 'TYP_CDE'.                    01390000
005607     05 FILLER     PIC  X(02) VALUE SPACE.                        01400000
005608     05 FILLER     PIC  X(07) VALUE '_ID '.                       01410000
005609     05 FILLER     PIC  X(06) VALUE SPACE.                        01420000
005610     05 FILLER     PIC  X(37) VALUE 'VALUE'.                      01430000
005611     05 FILLER     PIC  X(05) VALUE 'VALUE'.                      01440000
005612                                                                  01450000
005613 01 RPT-COL-HEADING-4.                                            01460000
005614     05 FILLER     PIC  X(132) VALUE ALL '-'.                     01470000
005615                                                                  01480000
005616 01 DL-DETAIL-LINE.                                               01490000
005617     05 FILLER                PIC  X(01) VALUE SPACE.             01500000
005618     05 DL-STR-GP-TYP-CDE     PIC  X(04) VALUE SPACE.             01510000
005619     05 FILLER                PIC  X(05) VALUE SPACE.             01520000
005620     05 DL-STR-GP-ID          PIC  X(04) VALUE SPACE.             01530000
005621     05 FILLER                PIC  X(05) VALUE SPACE.             01540000
005622     05 DL-XMT-NM-VALUE       PIC  X(30) VALUE SPACE.             01550000
005623     05 FILLER                PIC  X(01) VALUE SPACE.             01560000
005624     05 DL-XMT-ST-VALUE       PIC  X(02) VALUE SPACE.             01570000
005625     05 FILLER                PIC  X(01) VALUE SPACE.             01580000
005626     05 DL-XMT-SLS-IND-VALUE  PIC  X(01) VALUE SPACE.             01590000
005627     05 FILLER                PIC  X(04) VALUE SPACE.             01600000
005628     05 DL-RMS-NM-VALUE       PIC  X(30) VALUE SPACE.             01610000
005629     05 FILLER                PIC  X(01) VALUE SPACE.             01620000
005630     05 DL-RMS-ST-VALUE       PIC  X(02) VALUE SPACE.             01630000
005631     05 FILLER                PIC  X(01) VALUE SPACE.             01640000
005632     05 DL-RMS-SLS-IND-VALUE  PIC  X(01) VALUE SPACE.             01650000
005633     05 FILLER                PIC  X(04) VALUE SPACE.             01660000
005634     05 DL-MESSAGE            PIC  X(41) VALUE SPACE.             01670000
004600                                                                  01680000
005300     COPY DPWS200O.                                               01690002
005301                                                                  01700000
004700     COPY HORD007.                                                01710002
004800                                                                  01720000
005310 01 XMT-REC.                                                      01730000
005320     05 XMT-STR-GP-TYP-CDE         PIC S9(04) COMP.               01740000
005330     05 XMT-STR-GP-ID              PIC S9(04) COMP.               01750000
005340     05 XMT-GP-NM                  PIC X(30) VALUE SPACE.         01760000
005341     05 XMT-ST-CDE                 PIC X(02) VALUE SPACE.         01770000
005342     05 XMT-RPT-FLSH-SLS-IND       PIC X(01) VALUE SPACE.         01780000
004800                                                                  01790000
005636 PROCEDURE DIVISION.                                              01800000
005637                                                                  01810000
005640 0000-MAIN-MODULE.                                                01820000
005650                                                                  01830000
005660       OPEN INPUT RMS-INPUT-FILE                                  01840000
005670                  XMT-INPUT-FILE                                  01850000
005680            OUTPUT ERROR-REPORT.                                  01860000
005681                                                                  01870000
005690       PERFORM 1000-INITIALIZE.                                   01880000
005691       PERFORM 7000-READ-XMT-INPUT-FILE.                          01890000
005692       PERFORM 7100-READ-RMS-INPUT-FILE.                          01900000
005693                                                                  01910000
005694       PERFORM 2000-PROCESS-RECS                                  01920000
005695          UNTIL (PS-END-OF-XMT-INPUT-RECS                         01930000
005696            AND PS-END-OF-RMS-INPUT-RECS).                        01940000
005700                                                                  01950000
005710       PERFORM 8400-WRITE-TOTALS.                                 01960000
005720                                                                  01970000
005800       CLOSE RMS-INPUT-FILE                                       01980000
005900             XMT-INPUT-FILE                                       01990000
006000             ERROR-REPORT.                                        02000000
006010                                                                  02010000
006100       DISPLAY '**** XMKRP038 STATISTICS ****'                    02020000
006200       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     02030000
006300       DISPLAY 'TOTAL XMT RECORDS READ : ' PA-XMT-RECS-READ.      02040000
006400       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      02050000
006500       DISPLAY ' '                                                02060000
006600                                                                  02070000
006700       STOP RUN.                                                  02080000
006710                                                                  02090000
006800 1000-INITIALIZE.                                                 02100000
006900                                                                  02110000
007000       ACCEPT PV-DATE-YYMMDD FROM DATE.                           02120000
007100       MOVE PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      02130000
007200       MOVE PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     02140000
007300       MOVE PV-YYMMDD-DD TO DP200O-RUN-DAY.                       02150000
007400                                                                  02160000
007500       ACCEPT PV-TIME-HHMMSS FROM TIME.                           02170000
007600       MOVE PV-HHMMSS-HH TO DP200O-RUN-HOUR.                      02180000
007700       MOVE PV-HHMMSS-MM TO DP200O-RUN-MINUTE.                    02190000
007800       MOVE PC-PGM-NAME TO DP200O-PROGRAM-NAME.                   02200000
007900       MOVE 1        TO DP200O-REPORT-NUMBER.                     02210000
008000                                                                  02220000
008100       PERFORM 8100-WRITE-STD-RPT-HEADING.                        02230000
008200       PERFORM 8200-WRITE-REPORT-HEADING.                         02240000
008300       PERFORM 8300-WRITE-COLUMN-HEADING.                         02250000
008400                                                                  02260000
008500 2000-PROCESS-RECS.                                               02270000
008501                                                                  02280000
008510       MOVE HO007-SGD-STR-GP-TYP-CDE  TO  PV-RMS-STR-GP-TYP-CDE.  02290000
008511       MOVE HO007-SGD-STR-GP-ID       TO  PV-RMS-STR-GP-ID.       02300000
008520       MOVE HO007-SGD-GP-NM           TO  PV-RMS-GP-NM.           02310000
008521       MOVE HO007-SGD-ST-CDE          TO  PV-RMS-ST-CDE.          02320000
008522       MOVE HO007-SGD-RPT-FLSH-SLS-IND                            02330000
008523                                 TO PV-RMS-RPT-FLSH-SLS-IND.      02340000
008530                                                                  02350000
008540       MOVE XMT-STR-GP-TYP-CDE  TO  PV-XMT-STR-GP-TYP-CDE.        02360000
008550       MOVE XMT-STR-GP-ID   TO  PV-XMT-STR-GP-ID.                 02370000
008551       MOVE XMT-GP-NM       TO  PV-XMT-GP-NM.                     02380000
008552       MOVE XMT-ST-CDE      TO  PV-XMT-ST-CDE.                    02390000
008553       MOVE XMT-RPT-FLSH-SLS-IND  TO  PV-XMT-RPT-FLSH-SLS-IND.    02400000
008560                                                                  02410000
008561      IF PV-XMT-KEY = PV-RMS-KEY                                  02420000
008563         PERFORM 3000-COMPARE-FIELDS                              02430000
008564         PERFORM 7000-READ-XMT-INPUT-FILE                         02440000
008565         PERFORM 7100-READ-RMS-INPUT-FILE                         02450000
008566      ELSE                                                        02460000
008571          IF ((PV-RMS-KEY < PV-XMT-KEY)                           02470000
008572             OR PS-END-OF-XMT-INPUT-RECS) AND                     02480000
008573             PS-MORE-RMS-INPUT-RECS                               02490000
008593             MOVE '1' TO PS-RMS-OR-XMT-ERR                        02500000
008594             MOVE 'KEY ON SYSTEM OF RECORD TABLE ONLY'            02510003
008595                 TO PV-MESSAGE                                    02520000
008596             PERFORM 8000-WRITE-OUTPUT-REC                        02530000
008597             PERFORM 7100-READ-RMS-INPUT-FILE                     02540000
008598          ELSE                                                    02550000
008630              IF ((PV-RMS-KEY > PV-XMT-KEY)                       02560000
008640                 OR PS-END-OF-RMS-INPUT-RECS) AND                 02570000
008641                 PS-MORE-XMT-INPUT-RECS                           02580000
008650                 MOVE '2' TO PS-RMS-OR-XMT-ERR                    02590000
008660                 MOVE 'KEY ON XM DOMAIN TABLE ONLY'               02600003
008661                     TO PV-MESSAGE                                02610000
008670                 PERFORM 8000-WRITE-OUTPUT-REC                    02620000
008680                 PERFORM 7000-READ-XMT-INPUT-FILE                 02630000
008690              END-IF                                              02640000
008691          END-IF                                                  02650000
008692      END-IF.                                                     02660000
008693                                                                  02670000
008694 3000-COMPARE-FIELDS.                                             02680000
008695                                                                  02690000
008696      EVALUATE TRUE                                               02700000
008697         WHEN HO007-SGD-GP-NM NOT = PV-XMT-GP-NM                  02710000
008703             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02720000
008704             MOVE 'STR_GP NAME DOES NOT MATCH'                    02730000
008705                        TO PV-MESSAGE                             02740000
008706             PERFORM 8000-WRITE-OUTPUT-REC                        02750000
008707         WHEN HO007-SGD-ST-CDE NOT = XMT-ST-CDE                   02760000
008708             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02770000
008709             MOVE 'STR_GP STATE CODE DOES NOT MATCH'              02780000
008710                        TO PV-MESSAGE                             02790000
008711             PERFORM 8000-WRITE-OUTPUT-REC                        02800000
008712         WHEN HO007-SGD-RPT-FLSH-SLS-IND                          02810000
008713                                      NOT = XMT-RPT-FLSH-SLS-IND  02820000
008714             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02830000
008715             MOVE 'SALES IND. CODE DOES NOT MATCH'                02840000
008716                        TO PV-MESSAGE                             02850000
008717             PERFORM 8000-WRITE-OUTPUT-REC                        02860000
008718      END-EVALUATE.                                               02870000
008719                                                                  02880000
008720 7000-READ-XMT-INPUT-FILE.                                        02890000
008800                                                                  02900000
008900       INITIALIZE XMT-REC.                                        02910000
009000                                                                  02920000
009100       READ XMT-INPUT-FILE INTO XMT-REC                           02930000
009200           AT END SET PS-END-OF-XMT-INPUT-RECS TO TRUE.           02940000
009300                                                                  02950000
009400       ADD 1 TO PA-XMT-RECS-READ.                                 02960000
009500                                                                  02970000
009600 7100-READ-RMS-INPUT-FILE.                                        02980000
009700                                                                  02990000
009800       INITIALIZE HO007-STR-GP-DATA.                              03000000
009900                                                                  03010000
010000       READ RMS-INPUT-FILE INTO HO007-STR-GP-DATA                 03020000
010100            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          03030000
010200                                                                  03040000
010300       ADD 1 TO PA-RMS-RECS-READ.                                 03050000
010400                                                                  03060000
010500 8000-WRITE-OUTPUT-REC.                                           03070000
010600                                                                  03080000
010620                                                                  03090000
010700       IF PS-RMS-ERROR                                            03100000
010800          MOVE SPACES TO DL-DETAIL-LINE                           03110000
010900          MOVE PV-RMS-STR-GP-TYP-CDE   TO DL-STR-GP-TYP-CDE       03120000
010910          MOVE PV-RMS-STR-GP-ID        TO DL-STR-GP-ID            03130000
011000          MOVE PV-RMS-GP-NM            TO DL-RMS-NM-VALUE         03140000
011010          MOVE PV-RMS-ST-CDE           TO DL-RMS-ST-VALUE         03150000
011020          MOVE PV-RMS-RPT-FLSH-SLS-IND TO DL-RMS-SLS-IND-VALUE    03160000
011100          MOVE PV-MESSAGE TO DL-MESSAGE                           03170000
011200       ELSE                                                       03180000
011300          IF PS-XMT-ERROR                                         03190000
011310             MOVE SPACES TO DL-DETAIL-LINE                        03200000
011320             MOVE PV-XMT-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      03210000
011330             MOVE PV-XMT-STR-GP-ID TO DL-STR-GP-ID                03220000
011340             MOVE PV-XMT-GP-NM  TO DL-XMT-NM-VALUE                03230000
011350             MOVE PV-XMT-ST-CDE TO DL-XMT-ST-VALUE                03240000
011360             MOVE PV-XMT-RPT-FLSH-SLS-IND                         03250000
011370                             TO DL-XMT-SLS-IND-VALUE              03260000
011600             MOVE PV-MESSAGE TO DL-MESSAGE                        03270000
011610          ELSE                                                    03280000
011611             MOVE SPACES TO DL-DETAIL-LINE                        03290000
011612             MOVE PV-RMS-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      03300000
011614             MOVE PV-RMS-STR-GP-ID TO DL-STR-GP-ID                03310000
011615             MOVE PV-RMS-GP-NM  TO DL-RMS-NM-VALUE                03320000
011616             MOVE PV-XMT-GP-NM  TO DL-XMT-NM-VALUE                03330000
011617             MOVE PV-RMS-ST-CDE TO DL-RMS-ST-VALUE                03340000
011618             MOVE PV-XMT-ST-CDE TO DL-XMT-ST-VALUE                03350000
011619             MOVE PV-RMS-RPT-FLSH-SLS-IND                         03360000
011620                                 TO  DL-RMS-SLS-IND-VALUE         03370000
011621             MOVE PV-XMT-RPT-FLSH-SLS-IND                         03380000
011622                                 TO  DL-XMT-SLS-IND-VALUE         03390000
011625             MOVE PV-MESSAGE TO DL-MESSAGE                        03400000
011630          END-IF                                                  03410000
011700       END-IF.                                                    03420000
011710                                                                  03430000
011800       IF PV-LINE-CNT > PV-MAX-LINES                              03440000
011810          PERFORM 8100-WRITE-STD-RPT-HEADING                      03450000
011820          PERFORM 8200-WRITE-REPORT-HEADING                       03460000
011830          PERFORM 8300-WRITE-COLUMN-HEADING                       03470000
011840       END-IF.                                                    03480000
011850                                                                  03490000
011900       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     03500000
012000             AFTER ADVANCING 1 LINE.                              03510000
012100       ADD +1 TO PV-LINE-CNT.                                     03520000
012200       MOVE 4095 TO RETURN-CODE.                                  03530000
012300       ADD 1 TO PA-ERROR-MESSAGES.                                03540000
012400                                                                  03550000
012500 8100-WRITE-STD-RPT-HEADING.                                      03560000
012600                                                                  03570000
012610       INITIALIZE PV-LINE-CNT.                                    03580000
012700       ADD 1  TO PV-PAGE-CNT.                                     03590000
012800       MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                    03600000
012900       WRITE ERR-RPT-LINE FROM DP200O-STANDRD-HEADER-200-COLS     03610000
013000             AFTER ADVANCING PAGE.                                03620000
013110       ADD +1 TO PV-LINE-CNT.                                     03630000
013200                                                                  03640000
013300 8200-WRITE-REPORT-HEADING.                                       03650000
013400                                                                  03660000
013500       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 03670000
013600            AFTER ADVANCING 1 LINES.                              03680000
013700       ADD +1 TO PV-LINE-CNT.                                     03690000
013800                                                                  03700000
013900 8300-WRITE-COLUMN-HEADING.                                       03710000
013910                                                                  03720000
013920       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  03730000
013930            AFTER ADVANCING 2 LINES.                              03740000
013940       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  03750000
013950            AFTER ADVANCING 1 LINES.                              03760000
013960       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  03770000
013970            AFTER ADVANCING 1 LINES.                              03780000
013971       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  03790000
013972            AFTER ADVANCING 1 LINES.                              03800000
013980       ADD +5 TO PV-LINE-CNT.                                     03810000
014000                                                                  03820000
014100 8400-WRITE-TOTALS.                                               03830000
014101                                                                  03840000
014102       IF PV-LINE-CNT > PV-MAX-LINES                              03850000
014103          PERFORM 8100-WRITE-STD-RPT-HEADING                      03860000
014104          PERFORM 8200-WRITE-REPORT-HEADING                       03870000
014105          PERFORM 8300-WRITE-COLUMN-HEADING                       03880000
014106       END-IF.                                                    03890000
014107                                                                  03900000
014110      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    03910000
014200      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      03920000
014210            AFTER ADVANCING 2 LINES.                              03930000
014211      ADD +2 TO PV-LINE-CNT.                                      03940000
014212                                                                  03950000
014220      IF PV-LINE-CNT > PV-MAX-LINES                               03960000
014230         PERFORM 8100-WRITE-STD-RPT-HEADING                       03970000
014240         PERFORM 8200-WRITE-REPORT-HEADING                        03980000
014250         PERFORM 8300-WRITE-COLUMN-HEADING                        03990000
014260      END-IF.                                                     04000000
014300      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              04010000
014400            AFTER ADVANCING 1 LINES.                              04020000
014500                                                                  04030000
