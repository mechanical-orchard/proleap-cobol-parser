000100***************************************************************** 00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300***************************************************************** 00030002
000400 PROGRAM-ID.             SUKRP034.                                00040002
000500 AUTHOR.                 TOM BOYD.                                00050002
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060002
000700 DATE-WRITTEN            AUGUST 2002.                             00070002
000800 DATE-COMPILED.                                                   00080002
000900***************************************************************** 00090002
001000*  THIS PROGRAM WILL CREATE THE DAILY TRAILER SUSPENSE REPORT - * 00100002
001100*  OPENED BUT NOT UNLOADED AT STORE REPORT.                     * 00110002
001200***************************************************************** 00120002
001300                                                                  00130002
001400 ENVIRONMENT DIVISION.                                            00140002
001500                                                                  00150002
001600 CONFIGURATION SECTION.                                           00160002
001700 SOURCE-COMPUTER.        IBM-3090.                                00170002
001800 OBJECT-COMPUTER.        IBM-3090.                                00180002
001900                                                                  00190002
002000 INPUT-OUTPUT SECTION.                                            00200002
002100 FILE-CONTROL.                                                    00210002
002200*                                                                 00220002
002300     SELECT INPUT-FILE                                            00230002
002400         ASSIGN TO INP01.                                         00240002
002500*                                                                 00250002
002600     SELECT REPORT-FILE                                           00260002
002700         ASSIGN TO RPT01.                                         00270002
002800*                                                                 00280002
002900***************************************************************** 00290002
003000 DATA DIVISION.                                                   00300002
003100***************************************************************** 00310002
003200 FILE SECTION.                                                    00320002
003300*                                                                 00330002
003400 FD  INPUT-FILE                                                   00340002
003500     RECORDING MODE IS F                                          00350002
003600     LABEL RECORDS ARE STANDARD                                   00360002
003700     BLOCK CONTAINS 0 RECORDS                                     00370002
003800     RECORD CONTAINS 081 CHARACTERS.                              00380002
003900 01  INPUT-RECORD                    PIC  X(081).                 00390002
004000*                                                                 00400002
004100 FD  REPORT-FILE                                                  00410002
004200     RECORDING MODE IS F                                          00420002
004300     BLOCK CONTAINS 0  RECORDS.                                   00430002
004400 01  REPORT-RECORD                   PIC  X(132).                 00440002
004500*                                                                 00450002
004600***************************************************************** 00460002
004700 WORKING-STORAGE SECTION.                                         00470002
004800*                                                                 00480002
004900 01  PROGRAM-SWITCHES.                                            00490002
005000     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00500002
005100         88  PS-END-OF-INPUT                   VALUE 'Y'.         00510002
005200         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00520002
005300*                                                                 00530002
005400 01  PV-PROGRAM-CONSTANTS.                                        00540002
005500     05  PC-SUKRP034                 PIC X(08) VALUE  'SUKRP034'. 00550002
005600     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00560002
005700     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00570002
005800                                                   COMP-3.        00580002
005900*                                                                 00590002
006000 01  PV-PROGRAM-VARIABLES.                                        00600002
006100     05  PV-TMST                     PIC X(26) VALUE SPACES.      00601019
006200     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00610002
006300     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00620002
006400                                                   COMP-3.        00630002
006500     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00640002
006600                                                   COMP-3.        00650002
006700     05  PV-OPER-UNT-ID              PIC 9(04) VALUE ZERO.        00660002
006800     05  PV-CURRENT-OPER-ID          PIC 9(04) VALUE ZERO.        00670002
006900     05  PV-PREVIOUS-OPER-ID         PIC 9(04) VALUE ZERO.        00680002
007000                                                                  00690002
007100     05  PV-TODAYS-DATE.                                          00700002
007200         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        00710002
007300         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        00720002
007400         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        00730002
007500     05  PV-TODAYS-TIME.                                          00740002
007600         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        00750002
007700         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        00760002
007800         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        00770002
007900         10  FILLER                  PIC 9(02) VALUE ZERO.        00780002
008000*                                                                 00790002
008100 01  PV-DATE-TIME.                                                00800002
008200     05  PV-DATE-TIME-CCYY            PIC X(04) VALUE SPACE.      00810002
008300     05  FILLER                       PIC X(01) VALUE SPACE.      00820002
008400     05  PV-DATE-TIME-MM              PIC X(02) VALUE SPACE.      00830002
008500     05  FILLER                       PIC X(01) VALUE SPACE.      00840002
008600     05  PV-DATE-TIME-DD              PIC X(02) VALUE SPACE.      00850002
008700     05  FILLER                       PIC X(01) VALUE SPACE.      00860002
008800     05  PV-DATE-TIME-HH              PIC X(02) VALUE SPACE.      00870002
008900     05  FILLER                       PIC X(01) VALUE SPACE.      00880002
009000     05  PV-DATE-TIME-MN              PIC X(02) VALUE SPACE.      00890002
009100     05  FILLER                       PIC X(01) VALUE SPACE.      00900002
009200     05  PV-DATE-TIME-SS              PIC X(02) VALUE SPACE.      00910002
009300     05  FILLER                       PIC X(07) VALUE SPACE.      00920002
009400*                                                                 00930002
009500 01  PV-DISPLAY-DATE.                                             00940002
009600     05  PV-DISPLAY-MM                PIC X(02) VALUE SPACE.      00950002
009700     05  FILLER                       PIC X(01) VALUE '/'.        00960002
009800     05  PV-DISPLAY-DD                PIC X(02) VALUE SPACE.      00970002
009900     05  FILLER                       PIC X(01) VALUE '/'.        00980002
010000     05  PV-DISPLAY-CCYY              PIC X(04) VALUE SPACE.      00990002
010100*                                                                 01000002
010200 01  PV-DISPLAY-TIME.                                             01010002
010300     05  PV-DISPLAY-HH                PIC X(02) VALUE SPACE.      01020002
010400     05  FILLER                       PIC X(01) VALUE ':'.        01030002
010500     05  PV-DISPLAY-MN                PIC X(02) VALUE SPACE.      01040002
010600*                                                                 01050002
010700 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01090002
010800                                                 COMP SYNC.       01100002
010900*                                                                 01110002
011000******************************************************************01120002
011100* COPY BOOK FOR TRAILER SUSPENSE                                  01130010
011200******************************************************************01140002
011300     COPY SURD023.                                                01150019
011400*                                                                 01160002
011500*  LOGISTICS DOMAIN LOCATION MODULE                               01161019
011600*                                                                 01162019
011700     COPY XLWS071.                                                01163019
011800                                                                  01164019
011900******************************************************************01171002
012000*  DB2 FORMATTED MESSAGE AREA                                     01180002
012100******************************************************************01190002
012200     COPY DPWS004.                                                01200002
012300*                                                                 01210002
012400*                                                                 01280002
012500***************************************************************** 01290002
012600*  DB2 COMMUNICATION AREA                                         01300002
012700***************************************************************** 01310002
012800     EXEC SQL                                                     01320002
012900         INCLUDE SQLCA                                            01330002
013000     END-EXEC.                                                    01340002
013100*                                                                 01350002
013200******************************************************************01360002
013300*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01370002
013400******************************************************************01380002
013500     COPY DPWS132O.                                               01390002
013600*                                                                 01400002
013700******************************************************************01410004
013800*                                                                 01420004
013900******************************************************************01430004
014000     COPY SQLCA2.                                                 01440004
014100*                                                                 01450004
014200 01  HEADING-LINES.                                               01460002
014300     05  HEADING-LINE-1.                                          01470002
014400         10  FILLER                  PIC  X(54)    VALUE SPACES.  01480002
014500         10  FILLER                  PIC  X(23)    VALUE          01490002
014600             'TRAILER SUSPENSE REPORT'.                           01500002
014700         10  FILLER                  PIC  X(47)    VALUE SPACES.  01510002
014800*                                                                 01520002
014900     05  HEADING-LINE-2.                                          01530002
015000         10  FILLER                  PIC  X(49)    VALUE SPACES.  01540002
015100         10  FILLER                  PIC  X(32)    VALUE          01550002
015200             'OPENED BUT NOT UNLOADED AT STORE'.                  01560002
015300         10  FILLER                  PIC  X(47)    VALUE SPACES.  01570002
015400*                                                                 01580002
015500     05  HEADING-LINE-3.                                          01590002
015600         10  FILLER                  PIC  X(02)    VALUE SPACE.   01600002
015700         10  FILLER                  PIC  X(11)    VALUE          01610002
015800             'OPER ID:   '.                                       01620002
015900         10  HL3-OPER-UNT            PIC  9(04)    VALUE ZEROES.  01630002
016000         10  FILLER                  PIC  X(02)    VALUE SPACES.  01640002
016100         10  HL3-OPER-NAME           PIC  X(25)    VALUE SPACES.  01650009
016200         10  FILLER                  PIC  X(24)    VALUE          01660009
016300             '*** TRAILERS OPENED FOR '.                          01670002
016400         10  HL3-TRIP-HOURS          PIC  ZZ9      VALUE ZEROES.  01680002
016500         10  FILLER                  PIC  X(01)    VALUE SPACES.  01690002
016600         10  FILLER                  PIC  X(17)    VALUE          01700002
016700             'OR MORE HOURS ***'.                                 01710002
016800         10  FILLER                  PIC  X(02)    VALUE SPACES.  01720002
016900         10  FILLER                  PIC  X(30)    VALUE SPACES.  01730002
017000*                                                                 01740002
017100     05  HEADING-LINE-4.                                          01750002
017200         10  FILLER                  PIC  X(72)    VALUE SPACES.  01760008
017300         10  FILLER                  PIC  X(07)    VALUE          01770002
017400             'TRAILER'.                                           01780002
017500         10  FILLER                  PIC  X(12)    VALUE SPACES.  01790002
017600         10  FILLER                  PIC  X(10)    VALUE          01800002
017700             'STORE OPEN'.                                        01810002
017800         10  FILLER                  PIC  X(31)    VALUE SPACES.  01820008
017900*                                                                 01830002
018000     05  HEADING-LINE-5.                                          01840002
018100         10  FILLER                  PIC  X(06)    VALUE          01850002
018200             'STORE '.                                            01860002
018300         10  FILLER                  PIC  X(30)    VALUE          01870011
018400             '          CITY           STATE'.                    01880012
018500         10  FILLER                  PIC  X(07)    VALUE SPACES.  01890002
018600         10  FILLER                  PIC  X(04)    VALUE          01900002
018700             'SCAC'.                                              01910002
018800         10  FILLER                  PIC  X(08)    VALUE SPACES.  01920002
018900         10  FILLER                  PIC  X(10)    VALUE          01930002
019000             'TRAILER ID'.                                        01940002
019100         10  FILLER                  PIC  X(07)    VALUE SPACES.  01950002
019200         10  FILLER                  PIC  X(08)    VALUE          01960002
019300             'SERIAL #'.                                          01970002
019400         10  FILLER                  PIC  X(12)    VALUE SPACES.  01980002
019500         10  FILLER                  PIC  X(09)    VALUE          01990002
019600             'DATE/TIME'.                                         02000002
019700         10  FILLER                  PIC  X(31)    VALUE SPACES.  02010008
019800*                                                                 02020002
019900     05  HEADING-LINE-6.                                          02030002
020000         10  FILLER                  PIC  X(06)    VALUE          02040002
020100             '----- '.                                            02050002
020200         10  FILLER                  PIC  X(30)    VALUE          02060012
020300             '     ---------------     -----'.                    02070012
020400         10  FILLER                  PIC  X(07)    VALUE SPACES.  02080002
020500         10  FILLER                  PIC  X(04)    VALUE          02090002
020600             '----'.                                              02100002
020700         10  FILLER                  PIC  X(08)    VALUE SPACES.  02110002
020800         10  FILLER                  PIC  X(10)    VALUE          02120002
020900             '----------'.                                        02130002
021000         10  FILLER                  PIC  X(07)    VALUE SPACES.  02140002
021100         10  FILLER                  PIC  X(08)    VALUE          02150002
021200             '--------'.                                          02160002
021300         10  FILLER                  PIC  X(12)    VALUE SPACES.  02170002
021400         10  FILLER                  PIC  X(09)    VALUE          02180002
021500             '---------'.                                         02190002
021600         10  FILLER                  PIC  X(31)    VALUE SPACES.  02200008
021700*                                                                 02210002
021800 01  DETAIL-LINES.                                                02220002
021900     05  DETAIL-LINE1.                                            02230002
022000         10  DL1-STR-NBR            PIC  Z(04)     VALUE SPACES.  02240002
022100         10  FILLER                 PIC  X(07)     VALUE SPACES.  02250012
022200         10  DL1-CITY               PIC  X(15)     VALUE SPACES.  02260011
022300         10  FILLER                 PIC  X(06)     VALUE SPACES.  02270011
022400         10  DL1-STATE              PIC  X(02)     VALUE SPACES.  02280011
022500         10  FILLER                 PIC  X(09)     VALUE SPACES.  02290011
022600         10  DL1-SCAC               PIC  X(04)     VALUE SPACES.  02300002
022700         10  FILLER                 PIC  X(08)     VALUE SPACES.  02310002
022800         10  DL1-TRLR-ID            PIC  X(12)     VALUE SPACES.  02320002
022900         10  FILLER                 PIC  X(05)     VALUE SPACES.  02330008
023000         10  DL1-TRLR-SRL-NBR       PIC  X(09)     VALUE SPACES.  02340002
023100         10  FILLER                 PIC  X(08)     VALUE SPACES.  02350002
023200         10  DL1-DATE               PIC  X(10)     VALUE SPACES.  02360002
023300         10  FILLER                 PIC  X(02)     VALUE SPACES.  02370002
023400         10  DL1-TIME               PIC  X(05)     VALUE SPACES.  02380002
023500         10  FILLER                 PIC  X(24)     VALUE SPACES.  02390008
023600*                                                                 02400002
023700 01  MISCELLANEOUS-LINES.                                         02410002
023800     05  BLANK-LINE.                                              02420002
023900         10  FILLER                  PIC  X(132)   VALUE SPACES.  02430002
024000     05  NO-DATA-LINE.                                            02440002
024100         10  FILLER                  PIC  X(42)    VALUE SPACES.  02450002
024200         10  FILLER                  PIC  X(47)    VALUE          02460002
024300             '**** NO INFORMATION EXISTS FOR THIS REPORT ****'.   02470002
024400         10  FILLER                  PIC  X(43)    VALUE SPACES.  02480002
024500     05  END-OF-REPORT-LINE.                                      02490002
024600         10  FILLER                  PIC  X(54)    VALUE SPACES.  02500002
024700         10  FILLER                  PIC  X(44)    VALUE          02510002
024800             '  ** END OF REPORT **                       '.      02520002
024900         10  FILLER                  PIC  X(44)    VALUE SPACES.  02530002
025000*                                                                 02540002
025100                                                                  02550002
025200                                                                  02560002
025300 PROCEDURE DIVISION.                                              02570002
025400*                                                                 02580002
025500 0000-MAINLINE-PROCESSING.                                        02590002
025600******************************************************************02600002
025700**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      02610002
025800******************************************************************02620002
025900     DISPLAY '****** STARTING SUKRP034 ******'.                   02630002
026000*                                                                 02640002
026100*OPEN FILES.                                                      02650002
026200     OPEN INPUT INPUT-FILE                                        02660002
026300          OUTPUT REPORT-FILE.                                     02670002
026400*                                                                 02680002
026500*PREPARE REPORT.                                                  02690002
026600     PERFORM 1000-INITIALIZATION.                                 02700002
026700*                                                                 02710002
026800     PERFORM 3000-READ-EXTRACT-FILE.                              02720002
026900     MOVE PV-CURRENT-OPER-ID TO PV-PREVIOUS-OPER-ID.              02730002
027000     PERFORM 2150-SELECT-LOCATION.                                02740019
027100                                                                  02750002
027200     PERFORM 1500-PAGE-BREAK.                                     02760002
027300*                                                                 02770002
027400*PROCESS INPUT FILE.                                              02780002
027500     IF PS-END-OF-INPUT                                           02790002
027600         WRITE REPORT-RECORD                                      02800002
027700           FROM NO-DATA-LINE                                      02810002
027800             AFTER ADVANCING 2 LINES                              02820002
027900     ELSE                                                         02830002
028000         PERFORM 2000-PROCESS-INPUT                               02840002
028100             UNTIL PS-END-OF-INPUT                                02850002
028200     END-IF.                                                      02860002
028300                                                                  02870002
028400*                                                                 02880002
028500*FINISH REPORT.                                                   02890002
028600     WRITE REPORT-RECORD                                          02900002
028700       FROM END-OF-REPORT-LINE                                    02910002
028800         AFTER ADVANCING 2 LINES.                                 02920008
028900*                                                                 02930002
029000*CLOSE FILES.                                                     02940002
029100     CLOSE INPUT-FILE                                             02950002
029200           REPORT-FILE.                                           02960002
029300*                                                                 02970002
029400     GOBACK.                                                      02980002
029500*                                                                 02990002
029600******************************************************************03000002
029700 1000-INITIALIZATION.                                             03010002
029800******************************************************************03020002
029900**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03030002
030000******************************************************************03040002
030100     ACCEPT PV-TODAYS-DATE                                        03050002
030200       FROM DATE.                                                 03060002
030300*                                                                 03070002
030400     ACCEPT PV-TODAYS-TIME                                        03080002
030500       FROM TIME.                                                 03090002
030600*                                                                 03100002
030700     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 03110002
030800     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   03120002
030900     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  03130002
031000*                                                                 03140002
031100     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  03150002
031200     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                03160002
031300*                                                                 03170002
031400     MOVE PC-SUKRP034        TO DP132O-PROGRAM-NAME.              03180002
031500     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             03190002
031600*                                                                 03200002
031700     MOVE +0                 TO PV-PAGE-COUNT.                    03210002
031800                                                                          
031900     EXEC SQL SET :PV-TMST = CURRENT TIMESTAMP END-EXEC.                  
032000*                                                                 03220002
032100*                                                                 03230002
032200******************************************************************03240002
032300**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  03250002
032400**  PAGES (AS NEEDED).                                            03260002
032500******************************************************************03270002
032600 1500-PAGE-BREAK.                                                 03280002
032700     ADD +1                  TO PV-PAGE-COUNT.                    03290002
032800     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               03300002
032900     MOVE PV-CURRENT-OPER-ID TO HL3-OPER-UNT.                     03310002
033000     MOVE SU023-TRIP-HOURS   TO HL3-TRIP-HOURS.                   03320009
033100                                                                  03330002
033200*                                                                 03340002
033300     WRITE REPORT-RECORD                                          03350002
033400       FROM DP132O-STANDRD-HEADER-132-COLS                        03360002
033500         AFTER ADVANCING PAGE.                                    03370002
033600*                                                                 03380002
033700     WRITE REPORT-RECORD                                          03390002
033800       FROM HEADING-LINE-1                                        03400002
033900         AFTER ADVANCING 2 LINES.                                 03410002
034000*                                                                 03420002
034100     WRITE REPORT-RECORD                                          03430002
034200       FROM HEADING-LINE-2                                        03440002
034300         AFTER ADVANCING 1 LINE.                                  03450002
034400*                                                                 03460002
034500     WRITE REPORT-RECORD                                          03470002
034600       FROM HEADING-LINE-3                                        03480002
034700         AFTER ADVANCING 2 LINES.                                 03490002
034800*                                                                 03500002
034900     WRITE REPORT-RECORD                                          03510002
035000       FROM HEADING-LINE-4                                        03520002
035100         AFTER ADVANCING 2 LINE.                                  03530002
035200*                                                                 03540002
035300     WRITE REPORT-RECORD                                          03550002
035400       FROM HEADING-LINE-5                                        03560002
035500         AFTER ADVANCING 1 LINE.                                  03570002
035600*                                                                 03580002
035700     WRITE REPORT-RECORD                                          03590002
035800       FROM HEADING-LINE-6                                        03600002
035900         AFTER ADVANCING 1 LINE.                                  03610002
036000*                                                                 03620002
036100     MOVE +10                TO PV-LINE-COUNT.                    03630002
036200*                                                                 03640002
036300******************************************************************03650002
036400**  READ INPUT-FILE, WHEN A STORE CHANGES, PRINT BLANK LINE,      03660002
036500**  WHEN DC CHANGES, FINISH OLD DC, GO TO NEW PAGE FOR NEXT DC.   03670002
036600******************************************************************03680002
036700 2000-PROCESS-INPUT.                                              03690002
036800                                                                  03700002
036900     IF PV-CURRENT-OPER-ID = PV-PREVIOUS-OPER-ID                  03710002
037000*       PRINT DETAIL LINE TO REPORT (CHECK LINE COUNT)            03720002
037100        PERFORM 2100-PRINT-DETAIL-LINE                            03730003
037200*LMM                                                              03740018
037300        MOVE PV-CURRENT-OPER-ID TO PV-PREVIOUS-OPER-ID            03750018
037400     ELSE                                                         03760002
037500*       PAGE BREAK, PRINT DETAIL REPORT                           03770002
037600        PERFORM 2150-SELECT-LOCATION                              03780019
037700        PERFORM 1500-PAGE-BREAK                                   03790003
037800        PERFORM 2100-PRINT-DETAIL-LINE                            03800003
037900*LMM                                                              03810017
038000        MOVE PV-CURRENT-OPER-ID TO PV-PREVIOUS-OPER-ID            03820017
038100     END-IF.                                                      03830002
038200*                                                                 03840002
038300     PERFORM 3000-READ-EXTRACT-FILE.                              03850002
038400*                                                                 03860002
038500******************************************************************03870002
038600**  MOVE INPUT RECORD TO DETAIL PRINT LINE                        03880010
038700******************************************************************03890002
038800 2100-PRINT-DETAIL-LINE.                                          03900002
038900*                                                                 03910002
039000     MOVE SU023-STR-NBR            TO DL1-STR-NBR.                03920006
039100     MOVE SU023-CITY               TO DL1-CITY                    03930011
039200     MOVE SU023-STATE              TO DL1-STATE                   03940011
039300     MOVE SU023-SCAC               TO DL1-SCAC.                   03950006
039400     MOVE SU023-TRLR-ID            TO DL1-TRLR-ID.                03960006
039500     MOVE SU023-TRLR-SRL-NBR       TO DL1-TRLR-SRL-NBR.           03970006
039600     MOVE SU023-OTBND-STAT-TMST    TO PV-DATE-TIME.               03980006
039700     MOVE PV-DATE-TIME-CCYY        TO PV-DISPLAY-CCYY.            03990002
039800     MOVE PV-DATE-TIME-MM          TO PV-DISPLAY-MM.              04000002
039900     MOVE PV-DATE-TIME-DD          TO PV-DISPLAY-DD.              04010002
040000     MOVE PV-DATE-TIME-HH          TO PV-DISPLAY-HH.              04020002
040100     MOVE PV-DATE-TIME-MN          TO PV-DISPLAY-MN.              04030002
040200     MOVE PV-DISPLAY-DATE          TO DL1-DATE.                   04040002
040300     MOVE PV-DISPLAY-TIME          TO DL1-TIME.                   04050002
040400                                                                  04060002
040500     ADD +1 TO PV-LINE-COUNT.                                     04070002
040600     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         04080004
040700         PERFORM 1500-PAGE-BREAK                                  04090002
040800     END-IF.                                                      04100002
040900*                                                                 04110002
041000     WRITE REPORT-RECORD                                          04120002
041100       FROM DETAIL-LINE1                                          04130002
041200         AFTER ADVANCING 1 LINE.                                  04140002
041300/                                                                 04150002
041400******************************************************************04160002
041500**  SELECT THE STORE NAME TO BE                                         02
041600**  DISPLAYED IN THE DETAIL PORTION OF THE REPORT.                04180002
041700******************************************************************04190002
041800 2150-SELECT-LOCATION.                                            04200019
041900     INITIALIZE XL071-COMMAREA-REC.                               04201019
042000     MOVE PV-CURRENT-OPER-ID    TO XL071-LOCATION-NUMBER          04202019
042100                                                                  04203019
042200     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         04204019
042300                                                                  04205019
042400     EVALUATE TRUE                                                04206019
042500     WHEN XL071-NO-ERRORS                                         04207019
042600         MOVE XL071-LOC-NM          TO HL3-OPER-NAME              04208019
042700     WHEN XL071-LOC-NOT-FOUND                                     04209019
042800     WHEN XL071-DC-ASGMT-NOT-FND                                  04209119
042900         MOVE 'UNKNOWN'             TO HL3-OPER-NAME              04209219
043000     WHEN XL071-BAD-DB2-RETURN                                    04209319
043100         DISPLAY '1200-SELECT-OPER-DESC'                          04209419
043200         DISPLAY 'CALL LOCATION MOD '                             04209519
043300         DISPLAY 'XLT00010'                                       04209619
043400         MOVE XL071-SQLCA             TO SQLCA                    04209719
043500         PERFORM Z999-SQL-ERROR                                   04209819
043600     END-EVALUATE.                                                04209919
043700/                                                                 04300019
043800******************************************************************04410002
043900*  READ A RECORD FROM THE TRAILER SUSPENSE UNLOAD FILE.          *04420002
044000******************************************************************04430002
044100 3000-READ-EXTRACT-FILE.                                          04440002
044200                                                                  04450007
044300     INITIALIZE SU023-EXTRACT-RECORD.                             04460007
044400                                                                  04470007
044500     READ INPUT-FILE                                              04480002
044600       INTO SU023-EXTRACT-RECORD                                  04490002
044700         AT END                                                   04500002
044800           SET PS-END-OF-INPUT TO TRUE                            04510002
044900         NOT AT END                                               04520002
045000           SET PS-NOT-END-OF-INPUT TO TRUE                        04530002
045100           MOVE SU023-OPER-UNT-ID  TO PV-CURRENT-OPER-ID          04540005
045200     END-READ.                                                    04550002
045300*                                                                 04560002
045400******************************************************************04570002
045500*     SQL WARNING OR ERROR PROCESSING                            *04580002
045600******************************************************************04590002
045700 Z999-SQL-ERROR.                                                  04600002
045800     MOVE SQLCODE    TO SQLCODE2.                                 04610002
045900     MOVE SQLERRD(3) TO SQLERRD3.                                 04620002
046000     DISPLAY '** ABEND **       ** = SQLERROR'.                   04630002
046100     DISPLAY '** PROGRAM        ** = SUKRP033'.                   04640002
046200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  04650002
046300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  04660002
046400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   04670002
046500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  04680002
046600*                                                                 04690002
046700******************************************************************04700002
046800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04710002
046900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04720002
047000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04730002
047100* FORMAT.                                                         04740002
047200******************************************************************04750002
047300     COPY DPPD004.                                                04760002
047400*                                                                 04770002
047500     MOVE +4003 TO  ABEND-CODE.                                   04780002
047600     CALL 'ILBOABN0' USING ABEND-CODE.                            04790002
047700******************************************************************04800002
