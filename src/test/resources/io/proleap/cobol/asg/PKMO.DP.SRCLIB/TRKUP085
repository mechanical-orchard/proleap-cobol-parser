000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.              TRKUP085.                               00020092
000300 AUTHOR.                  DAVID KIEFER.                           00030029
000400 DATE-WRITTEN.            AUGUST 2010.                            00040029
000500 DATE-COMPILED.                                                   00050000
000600                                                                  00060000
000700******************************************************************00070000
000800* THIS PROGRAM READ A FLAT FILE AND ADDS RECORDS TO THE TTRIPST  *00080043
000900* TABLE SO THE TRAILER IS 'COMPLETED'                            *00090043
001000******************************************************************00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200 CONFIGURATION SECTION.                                           00120000
001300                                                                  00130000
001400 INPUT-OUTPUT SECTION.                                            00140000
001500 FILE-CONTROL.                                                    00150000
001600                                                                  00160000
001700     SELECT INPUT-FILE                                            00170049
001800        ASSIGN TO INP01.                                          00180080
001900                                                                  00190000
002000 DATA DIVISION.                                                   00200000
002100 FILE SECTION.                                                    00210000
002200                                                                  00220000
002300 FD  INPUT-FILE                                                   00230043
002400     RECORDING MODE IS F                                          00240000
002500     LABEL RECORDS ARE STANDARD                                   00250000
002600     RECORD CONTAINS 200 CHARACTERS                               00260033
002700     DATA RECORD IS INPUT-RECORD.                                 00270057
002800                                                                  00280000
002900 01  INPUT-RECORD                PIC X(200).                      00290043
003000                                                                  00300000
003100                                                                  00310000
003200 WORKING-STORAGE SECTION.                                         00320000
003300                                                                  00330000
003400 01  PROGRAM-CONSTANTS.                                           00340000
003500     05  PC-CALENDAR-ROUTINE         PIC X(8)   VALUE 'DPKUT500'. 00350000
003600                                                                  00360000
003700 01  PROGRAM-SWITCHES.                                            00370000
003800     05  END-OF-TRIPST-SW            PIC X(1)   VALUE 'N'.        00380000
003900         88  END-OF-TRIPST                      VALUE 'Y'.        00390000
004840                                                                  00484000
005700 01  PROGRAM-VARIABLES.                                           00570000
005800                                                                  00580000
005900     05  WS-PROCESS-DATE             PIC X(10).                   00590000
006000     05  WS-STATUS-DATE              PIC X(10).                   00600000
006010     05  PV-DB2-HOST-DATE            PIC X(10)  VALUE SPACES.     00601099
006020     05  PV-DB2-HOST-TIME            PIC X(08)  VALUE SPACES.     00602099
006030     05  PV-TRIP-ID-HOLD             PIC S9(09) VALUE ZEROES.     00603099
006040     05  PV-TRIP-OPER-UNT-ID-HOLD    PIC S9(04) VALUE ZEROES.     00604099
006050     05  PV-TRIP-VEH-NBR             PIC X(10)  VALUE SPACES.     00605099
006060     05  PV-TRIP-OWNR-SCAC-ID        PIC X(04)  VALUE SPACES.     00606099
006100                                                                  00610000
006110     05  PV-COUNT                    PIC S9(04) COMP VALUE ZERO.  00611099
006111     05  PV-DISP-COUNT               PIC  9(05)      VALUE ZERO.  00611199
006112     05  PV-DISP-SHIPT-ID            PIC  Z(11)      VALUE ZERO.  00611299
006113     05  PV-DISP-TRIP-ID             PIC  Z(09)      VALUE ZERO.  00611399
006120                                                                  00612099
006200     05  WS-EST-AR-TMST              PIC X(26).                   00620000
006300     05  FILLER REDEFINES WS-EST-AR-TMST.                         00630000
006400         10  WS-DELIVERY-DATE        PIC X(10).                   00640000
006500         10  FILLER                  PIC X(16).                   00650000
006600                                                                  00660000
006700     05  WS-MAJOR-CLASS              PIC X(2).                    00670000
006800     05  FILLER REDEFINES WS-MAJOR-CLASS.                         00680000
006900         10  WS-CLASS-CHAR-1         PIC X(1).                    00690000
007000         10  WS-CLASS-CHAR-2         PIC X(1).                    00700000
007100                                                                  00710000
007200     05  SUB                         PIC 9(3).                    00720099
007300     05  CLASS-SUB                   PIC 9(2).                    00730000
007500     05  PV-PARAGRAPH-NAME           PIC X(30).                   00750000
007600     05  PV-DB2-OPER-ATTEMPTED       PIC X(30).                   00760000
007601     05  WS-SPACES                   PIC X(30) VALUE SPACES.      00760199
007602     05  TAUVHCL-STAT-CODE           PIC X(02) VALUE SPACES.      00760299
007603                                                                  00760399
007620     05  WS-TRIP-RECORDS-READ        PIC 9(9) VALUE ZEROES.       00762075
007621     05  WS-TRIP-RECORDS-DP          PIC 9(9) VALUE ZEROES.       00762199
007622     05  WS-TRIP-RECORDS-ET          PIC 9(9) VALUE ZEROES.       00762275
007623     05  WS-SHIP-RECORDS-DP          PIC 9(9) VALUE ZEROES.       00762375
007624     05  WS-SHIP-RECORDS-ET          PIC 9(9) VALUE ZEROES.       00762475
007625     05  WS-PRO-NBRS-UPDATED         PIC 9(9) VALUE ZEROES.       00762599
007626 01  ABEND-CODE                PIC S9(04)  VALUE +0 COMP SYNC.    00762662
007627     88 ABEND-4013                         VALUE +4013.           00762762
008200***************************************************************** 00820000
008300*    OUTPUT FILE LAYOUT.                                        * 00830000
008400***************************************************************** 00840000
008500     COPY TRRD065.                                                00850099
008600                                                                  00860000
008700***************************************************************** 00870000
008800*    CALENDAR ROUTINE WORK AREA.                                * 00880000
008900***************************************************************** 00890000
009000     COPY DPWS500.                                                00900000
009100                                                                  00910000
009200***************************************************************** 00920000
009300*    SQL ABEND ROUTINE WORKING STORAGE                          * 00930000
009400***************************************************************** 00940000
009500     COPY DPWS004.                                                00950000
009600                                                                  00960000
010500     EXEC SQL                                                     01050000
010600        INCLUDE TTRIPST                                           01060000
010700     END-EXEC.                                                    01070000
010800                                                                  01080000
010900     EXEC SQL                                                     01090000
011000        INCLUDE TVHTRIP                                           01100000
011100     END-EXEC.                                                    01110000
011110                                                                  01111062
011200     EXEC SQL                                                     01120062
011300        INCLUDE TSHIPST                                           01130062
011400     END-EXEC.                                                    01140062
015250                                                                  01525000
015260     EXEC SQL                                                     01526081
015270        INCLUDE TVEHICL                                           01527081
015280     END-EXEC.                                                    01528081
015281                                                                  01528199
015282     EXEC SQL                                                     01528299
015283        INCLUDE TSHIPMT                                           01528399
015284     END-EXEC.                                                    01528499
015285                                                                  01528587
015286     EXEC SQL                                                     01528687
015287        INCLUDE TAUVHCL                                           01528787
015288     END-EXEC.                                                    01528887
015290                                                                  01529081
015300     EXEC SQL                                                     01530000
015400        INCLUDE SQLCA                                             01540000
015500     END-EXEC.                                                    01550000
015501                                                                  01550131
019800                                                                  01980000
020100***********************************************************       02010000
020200 PROCEDURE DIVISION.                                              02020000
020300***********************************************************       02030000
020390                                                                  02039051
020400     OPEN INPUT INPUT-FILE.                                       02040044
020500                                                                  02050000
020900     PERFORM 2000-UPDATE-STATUS-TABLES                            02090044
021000        THRU 2000-EXIT.                                           02100031
021001     MOVE PV-COUNT TO PV-DISP-COUNT                               02100199
021002     DISPLAY '************************************************'   02100236
021003     DISPLAY '** TRKUP085 - RUN DATE ' PV-DB2-HOST-DATE           02100398
021004     DISPLAY '**   --RECORDS READ    ' WS-TRIP-RECORDS-READ       02100477
021005     DISPLAY '**   --TRIP RECORDS-DP ' WS-TRIP-RECORDS-DP         02100575
021006     DISPLAY '**   --TRIP RECORDS-ET ' WS-TRIP-RECORDS-ET         02100675
021007     DISPLAY '**   --SHIP RECORDS-DP ' WS-SHIP-RECORDS-DP         02100775
021008     DISPLAY '**   --SHIP RECORDS-ET ' WS-SHIP-RECORDS-ET         02100875
021009     DISPLAY '**   --NBR OF PRO UPDT ' PV-DISP-COUNT              02100999
021010     DISPLAY '************************************************'   02101099
021100                                                                  02110000
021200     CLOSE INPUT-FILE.                                            02120044
021300                                                                  02130000
021400     STOP RUN.                                                    02140000
033500                                                                  03350000
033610 2000-UPDATE-STATUS-TABLES.                                       03361044
033700                                                                  03370000
034700     PERFORM 3000-READ-RECORD                                     03470044
034800        THRU 3000-EXIT                                            03480031
034900           UNTIL END-OF-TRIPST.                                   03490000
035900                                                                  03590000
036000 2000-EXIT.                                                       03600031
036100     EXIT.                                                        03610045
036300                                                                  03630000
036410 3000-READ-RECORD.                                                03641044
036600     READ INPUT-FILE                                              03660044
036700       INTO TR065-DATA-RECORD                                     03670099
036710         AT END MOVE 'Y' TO END-OF-TRIPST-SW                      03671099
036711         GO TO 3000-EXIT.                                         03671199
036720*    DISPLAY TR065-DATA-RECORD                                    03672099
036730     ADD +1 TO WS-TRIP-RECORDS-READ                               03673061
036741                                                                  03674176
036810     IF NOT END-OF-TRIPST                                         03681045
036836                                                                  03683662
036837         PERFORM 3100-CHECK-PRO-NBR                               03683799
036838                                                                  03683899
036839*INSERT RECORDS INTO THE SHIP STATUS TABLE                        03683999
036840         MOVE TR065-SHIP-ID     TO SHIPST-SHIPT-ID                03684099
036841         MOVE 'TRKUP085'        TO SHIPST-STATUS-UID              03684193
036842         MOVE 'DP'              TO SHIPST-SHIPT-STATUS-CDE        03684270
036843                                                                  03684370
036846         MOVE SPACES            TO SHIPST-DELAY-RSN-CDE           03684670
036847                                   SHIPST-CARR-STATUS-CDE         03684770
036848                                   SHIPST-TIME-ZONE-CDE           03684870
036849                                   SHIPST-CITY-NAME               03684970
036854                                                                  03685470
036855         PERFORM 6000-INSERT-TSHIPST THRU 6000-EXIT               03685562
036856         ADD +1                 TO WS-SHIP-RECORDS-DP             03685662
036857         MOVE 'ET'               TO SHIPST-SHIPT-STATUS-CDE       03685764
036860         PERFORM 6000-INSERT-TSHIPST THRU 6000-EXIT               03686062
036870         ADD +1                 TO WS-SHIP-RECORDS-ET             03687062
036871                                                                  03687176
036880*INSERT RECORDS INTO THE TRIP STATUS TABLE                        03688076
036890         IF TR065-TRIP-ID NOT = PV-TRIP-ID-HOLD                   03689099
036900             MOVE TR065-TRIP-ID     TO TRIPST-TRIP-ID             03690099
036910             MOVE TR065-OPER-UNT-ID                               03691099
036911                                    TO TRIPST-OPER-UNT-ID         03691176
036920             MOVE 'TRKUP085'        TO TRIPST-STATUS-UID          03692093
036930             MOVE 'DP'              TO TRIPST-TRIP-STATUS-CDE     03693076
036940             ADD +1                 TO WS-TRIP-RECORDS-DP         03694076
036950             PERFORM 5400-INSERT-TTRIPST THRU 5400-EXIT           03695076
036960             MOVE 'ET'              TO TRIPST-TRIP-STATUS-CDE     03696076
036970             ADD +1                 TO WS-TRIP-RECORDS-ET         03697099
036980             PERFORM 5400-INSERT-TTRIPST THRU 5400-EXIT           03698076
036981             MOVE TR065-TRIP-ID     TO PV-TRIP-ID-HOLD            03698199
036982             MOVE TR065-OPER-UNT-ID TO PV-TRIP-OPER-UNT-ID-HOLD   03698299
036984                                                                  03698499
036987             MOVE 'TRKUP085'        TO VEHICL-LAST-UPD-UID        03698793
036988             MOVE 'ET'              TO VEHICL-CURR-STATUS-CDE     03698899
036989             PERFORM 7000-UPDATE-TVEHICL THRU 7000-EXIT           03698981
036990             MOVE 'DP'              TO TAUVHCL-STAT-CODE          03699099
036991             PERFORM 7500-AUDIT-TVEHICL THRU 7500-EXIT            03699199
036992             MOVE 'ET'              TO TAUVHCL-STAT-CODE          03699299
036993             PERFORM 7500-AUDIT-TVEHICL THRU 7500-EXIT            03699389
036994             MOVE TR065-VEH-NBR     TO PV-TRIP-VEH-NBR            03699499
036995             MOVE TR065-OWNR-SCAC-ID TO PV-TRIP-OWNR-SCAC-ID      03699599
036996         END-IF                                                   03699689
037000     END-IF.                                                      03700044
037300                                                                  03730000
040000 3000-EXIT.                                                       04000031
040100     EXIT.                                                        04010000
040110                                                                  04011045
040111 3100-CHECK-PRO-NBR.                                              04011199
040112     MOVE TR065-SHIP-ID TO SHIPMT-SHIPT-ID                        04011299
040113     EXEC SQL                                                     04011399
040114         SELECT PRO_NBR                                           04011499
040115           INTO :SHIPMT-PRO-NBR                                   04011599
040116           FROM TSHIPMT                                           04011699
040117          WHERE SHIPT_ID = :SHIPMT-SHIPT-ID                       04011799
040118         WITH UR                                                  04011899
040119     END-EXEC.                                                    04011999
040120                                                                  04012099
040121     IF SQLCODE = ZERO                                            04012199
040122         IF SHIPMT-PRO-NBR = '                      '             04012299
040123             PERFORM 3110-UPDATE-PRO-NBR                          04012399
040124         END-IF                                                   04012499
040125     END-IF.                                                      04012599
040126                                                                  04012699
040127 3110-UPDATE-PRO-NBR.                                             04012799
040128     EXEC SQL                                                     04012899
040129         UPDATE TSHIPMT                                           04012999
040130         SET PRO_NBR    = 'NOPRO - AUTO DEPART'                   04013099
040131         WHERE SHIPT_ID = :SHIPMT-SHIPT-ID                        04013199
040132     END-EXEC.                                                    04013299
040133     IF SQLCODE = ZERO                                            04013399
040134         ADD +1 TO PV-COUNT                                       04013499
040135         MOVE SHIPMT-SHIPT-ID TO PV-DISP-SHIPT-ID                 04013599
040136         MOVE TR065-TRIP-ID   TO PV-DISP-TRIP-ID                  04013699
040137         DISPLAY '*** '     PV-DISP-SHIPT-ID                      04013799
040138                 '  TRIP:'  PV-DISP-TRIP-ID                       04013899
040139                 '   PRO NBR UPDATED'                             04013999
040140     END-IF.                                                      04014099
040150                                                                  04015099
040200 5400-INSERT-TTRIPST.                                             04020062
040360     EXEC SQL                                                     04036053
040370         SET :PV-DB2-HOST-DATE  = CURRENT DATE                    04037099
040380     END-EXEC.                                                    04038053
040381                                                                  04038199
040390     IF TRIPST-TRIP-STATUS-CDE = 'DP'                             04039099
040391        EXEC SQL                                                  04039199
040392            SET :PV-DB2-HOST-TIME = CURRENT TIME                  04039299
040393        END-EXEC                                                  04039399
040394**GB 11/30/10 BEG                                                 04039499
040395     ELSE                                                         04039599
040396        EXEC SQL                                                  04039699
040397            SET :PV-DB2-HOST-TIME = CURRENT TIME + 1 SECOND       04039799
040398        END-EXEC                                                  04039899
040399     END-IF                                                       04039999
040400**GB 11/30/10 END                                                 04040099
040410**GB ADDED CHECK TO ELIMINATE DUPLICATE DATE AND TIME FIELD       04041099
040500                                                                  04050045
040800     EXEC SQL                                                     04080045
040900         INSERT  INTO TTRIPST                                     04090045
041000                (TRIP_ID                                          04100045
041100                ,TRIP_STATUS_CDE                                  04110045
041200                ,STATUS_DTE                                       04120045
041300                ,STATUS_TME                                       04130045
041400                ,STATUS_UID                                       04140045
041500                ,OPER_UNT_ID                                      04150045
041600                ,FCLTY_ID)                                        04160045
041700        VALUES  (:TRIPST-TRIP-ID                                  04170047
041800                ,:TRIPST-TRIP-STATUS-CDE                          04180045
041900                ,:PV-DB2-HOST-DATE                                04190045
042000                ,:PV-DB2-HOST-TIME                                04200045
042100                ,:TRIPST-STATUS-UID                               04210047
042200                ,:TRIPST-OPER-UNT-ID                              04220047
042300                ,1 )                                              04230045
042400     END-EXEC                                                     04240045
042500                                                                  04250045
042600     EVALUATE TRUE                                                04260045
042700         WHEN SQLCODE = +0                                        04270045
043800         WHEN SQLCODE = -904                                      04380045
043900         WHEN SQLCODE = -913                                      04390045
044000              CONTINUE                                            04400045
044010         WHEN SQLCODE = -803                                      04401062
044020             DISPLAY 'DUPLICATE RECORD ON TRIP STATUS INSERT '    04402062
044030             DISPLAY '  TRIP ID - ' TRIPST-TRIP-ID                04403062
044100         WHEN OTHER                                               04410045
044200             DISPLAY '  TRIP ID - ' TRIPST-TRIP-ID                04420099
044400           MOVE '5400-INSERT-TTRIPST  ' TO PV-PARAGRAPH-NAME      04440045
044500           MOVE 'INSERT TTRIPST TABLE' TO PV-DB2-OPER-ATTEMPTED   04450045
047010              PERFORM 9999-SQL-ERROR                              04701045
047100     END-EVALUATE.                                                04710045
047200                                                                  04720045
084170 5400-EXIT.                                                       08417045
084171     EXIT.                                                        08417145
084172                                                                  08417261
084222*----------------------------------------------------------------*08422262
084223*  INSERT A SHIPMENT STATUS ROW                                  *08422362
084224*----------------------------------------------------------------*08422462
084225 6000-INSERT-TSHIPST.                                             08422562
084226     EXEC SQL                                                     08422662
084227         SET :PV-DB2-HOST-DATE      = CURRENT DATE                08422762
084228     END-EXEC.                                                    08422862
084229                                                                  08422962
084230     EXEC SQL                                                     08423062
084231         SET :PV-DB2-HOST-TIME      = CURRENT TIME                08423162
084232     END-EXEC.                                                    08423262
084233                                                                  08423367
084236                                                                  08423662
084278     EXEC SQL                                                     08427862
084279         INSERT  INTO TSHIPST                                     08427962
084280                (SHIPT_ID                                         08428062
084281                ,SHIPT_STATUS_CDE                                 08428162
084282                ,STATUS_DTE                                       08428262
084283                ,STATUS_TME                                       08428362
084284                ,STATUS_UID                                       08428470
084285                ,DELAY_RSN_CDE                                    08428570
084286                ,CARR_STATUS_CDE                                  08428670
084287                ,TIME_ZONE_CDE                                    08428770
084288                ,CITY_NAME                                        08428870
084289                ,STATE_CDE )                                      08428970
084290        VALUES  (:SHIPST-SHIPT-ID                                 08429062
084292                ,:SHIPST-SHIPT-STATUS-CDE                         08429262
084293                ,:PV-DB2-HOST-DATE                                08429362
084294                ,:PV-DB2-HOST-TIME                                08429462
084295                ,:SHIPST-STATUS-UID                               08429570
084296                ,:SHIPST-DELAY-RSN-CDE                            08429670
084297                ,:SHIPST-CARR-STATUS-CDE                          08429770
084298                ,:SHIPST-TIME-ZONE-CDE                            08429870
084299                ,:SHIPST-CITY-NAME                                08429970
084300                ,:SHIPST-STATE-CDE)                               08430070
084306     END-EXEC                                                     08430662
084307                                                                  08430762
084308     EVALUATE TRUE                                                08430862
084309         WHEN SQLCODE = +0                                        08430962
084314         WHEN SQLCODE = -904                                      08431462
084315         WHEN SQLCODE = -913                                      08431562
084316             CONTINUE                                             08431662
084317         WHEN SQLCODE = -803                                      08431779
084318             DISPLAY 'DUPLICATE RECORD ON SHIP STATUS INSERT '    08431879
084319             DISPLAY '  SHIP ID - ' SHIPST-SHIPT-ID               08431979
084321         WHEN OTHER                                               08432162
084322           MOVE '6000-INSERT-TSHIPST  ' TO PV-PARAGRAPH-NAME      08432269
084323           MOVE 'INSERT TSHIPST TABLE' TO PV-DB2-OPER-ATTEMPTED   08432369
084324             DISPLAY '  SHIP ID - ' SHIPST-SHIPT-ID               08432499
084330              PERFORM 9999-SQL-ERROR                              08433062
084347     END-EVALUATE.                                                08434762
084348 6000-EXIT.                                                       08434862
084349     EXIT.                                                        08434962
084350                                                                  08435081
084351*----------------------------------------------------------------*08435181
084352*  UPDATE A VEHICLE ROW                                          *08435281
084353*----------------------------------------------------------------*08435381
084354 7000-UPDATE-TVEHICL.                                             08435481
084356     EXEC SQL                                                     08435681
084357         SET :PV-DB2-HOST-DATE      = CURRENT DATE                08435781
084358     END-EXEC.                                                    08435881
084359                                                                  08435981
084360     EXEC SQL                                                     08436081
084361         SET :PV-DB2-HOST-TIME      = CURRENT TIME                08436181
084362     END-EXEC.                                                    08436281
084363                                                                  08436381
084365                                                                  08436581
084366     EXEC SQL                                                     08436681
084367         UPDATE TVEHICL                                           08436781
084368            SET LAST_UPD_DTE     = :PV-DB2-HOST-DATE              08436881
084369               ,LAST_UPD_TME     = :PV-DB2-HOST-TIME              08436986
084371               ,LAST_UPD_UID     = :VEHICL-LAST-UPD-UID           08437185
084372               ,CURR_STATUS_DTE  = :PV-DB2-HOST-DATE              08437281
084373               ,CURR_STATUS_TME  = :PV-DB2-HOST-TIME              08437381
084374               ,CURR_STATUS_CDE  = :VEHICL-CURR-STATUS-CDE        08437481
084376               ,USAGE_CDE        = :WS-SPACES                     08437697
084377               ,CURR_TRIP_ID     = NULL                           08437795
084382         WHERE VEH_NBR           = :TR065-VEH-NBR                 08438299
084383           AND OWNER_SCAC_ID     = :TR065-OWNR-SCAC-ID            08438399
084392     END-EXEC                                                     08439281
084393                                                                  08439381
084394     EVALUATE TRUE                                                08439481
084395         WHEN SQLCODE = +0                                        08439581
084396         WHEN SQLCODE = -904                                      08439681
084397         WHEN SQLCODE = -913                                      08439781
084398             CONTINUE                                             08439881
084402         WHEN OTHER                                               08440281
084403           DISPLAY 'VEHICLE NUMBER ' TR065-VEH-NBR                08440399
084404           DISPLAY 'SCAC ID ' TR065-OWNR-SCAC-ID                  08440499
084405           MOVE '7000-UPDATE-TVEHICL  ' TO PV-PARAGRAPH-NAME      08440582
084406           MOVE 'UPDATE TVEHICL TABLE' TO PV-DB2-OPER-ATTEMPTED   08440682
084407              PERFORM 9999-SQL-ERROR                              08440781
084408     END-EVALUATE.                                                08440881
084409 7000-EXIT.                                                       08440982
084410     EXIT.                                                        08441081
084420                                                                  08442087
085313*----------------------------------------------------------------*08531387
085314*  TAKE A SNAPSHOT OF THE BEFORE IMAGE OF TVEHICL AND WRITE       08531487
085315*  TO THE AUDIT TABLE.                                            08531587
085316*----------------------------------------------------------------*08531687
085317 7500-AUDIT-TVEHICL.                                              08531789
085318                                                                  08531887
085319     INITIALIZE DCLTAUVHCL.                                       08531987
085320                                                                  08532087
085321         EXEC SQL                                                 08532187
085322             SELECT  OWNER_SCAC_ID                                08532287
085323                    ,VEH_NBR                                      08532387
085324                    ,CRT_SRC_CDE                                  08532487
085325                    ,LAST_UPD_DTE                                 08532587
085326                    ,LAST_UPD_TME                                 08532687
085327                    ,LAST_UPD_UID                                 08532787
085328                    ,USAGE_CDE                                    08532887
085329                    ,VEH_TYP_CDE                                  08532987
085330                    ,CURR_STATUS_CDE                              08533087
085331                    ,CURR_STATUS_DTE                              08533187
085332                    ,CURR_STATUS_TME                              08533287
085333                    ,CURR_OPER_UNT_ID                             08533387
085334                    ,CURR_FCLTY_ID                                08533487
085335                    ,CURR_FAC_AREA_ID                             08533587
085336                    ,CURR_LOC_DTE                                 08533687
085337                    ,CURR_LOC_TME                                 08533787
085339                    ,VEH_SIZE_CDE                                 08533987
085340            INTO     :VEHICL-OWNER-SCAC-ID                        08534087
085341                    ,:VEHICL-VEH-NBR                              08534187
085342                    ,:VEHICL-CRT-SRC-CDE                          08534287
085343                    ,:VEHICL-LAST-UPD-DTE                         08534387
085344                    ,:VEHICL-LAST-UPD-TME                         08534487
085345                    ,:VEHICL-LAST-UPD-UID                         08534587
085346                    ,:VEHICL-USAGE-CDE                            08534687
085347                    ,:VEHICL-VEH-TYP-CDE                          08534787
085348                    ,:VEHICL-CURR-STATUS-CDE                      08534887
085349                    ,:VEHICL-CURR-STATUS-DTE                      08534987
085350                    ,:VEHICL-CURR-STATUS-TME                      08535087
085351                    ,:VEHICL-CURR-OPER-UNT-ID                     08535187
085352                    ,:VEHICL-CURR-FCLTY-ID                        08535287
085353                    ,:VEHICL-CURR-FAC-AREA-ID                     08535387
085354                    ,:VEHICL-CURR-LOC-DTE                         08535487
085355                    ,:VEHICL-CURR-LOC-TME                         08535587
085358                    ,:VEHICL-VEH-SIZE-CDE                         08535887
085359           FROM   TVEHICL                                         08535987
085362               WHERE VEH_NBR         = :TR065-VEH-NBR             08536299
085363               AND OWNER_SCAC_ID     = :TR065-OWNR-SCAC-ID        08536399
085364         END-EXEC                                                 08536487
085366                                                                  08536687
085367         EVALUATE TRUE                                            08536787
085368             WHEN SQLCODE = +0                                    08536887
085369             WHEN SQLCODE = -904                                  08536987
085370             WHEN SQLCODE = -913                                  08537087
085371                 CONTINUE                                         08537187
085372                                                                  08537287
085373             WHEN OTHER                                           08537387
085374           MOVE '7500-AUDIT-TVEHICL  '                            08537489
085375                                  TO PV-PARAGRAPH-NAME            08537587
085376           MOVE 'UPDATE TVEHICL TABLE'                            08537687
085377                                  TO PV-DB2-OPER-ATTEMPTED        08537787
085378              PERFORM 9999-SQL-ERROR                              08537887
085385         END-EVALUATE.                                            08538587
085387                                                                  08538787
085388         EXEC SQL                                                 08538887
085389             INSERT  INTO TAUVHCL                                 08538987
085390                    (OWNER_SCAC_ID                                08539087
085391                    ,VEH_NBR                                      08539187
085392                    ,CRT_SRC_CDE                                  08539287
085393                    ,LAST_UPD_DTE                                 08539387
085394                    ,LAST_UPD_TME                                 08539487
085395                    ,LAST_UPD_UID                                 08539587
085396                    ,USAGE_CDE                                    08539687
085397                    ,VEH_TYP_CDE                                  08539787
085398                    ,CURR_STATUS_CDE                              08539887
085399                    ,CURR_STATUS_DTE                              08539987
085400                    ,CURR_STATUS_TME                              08540087
085401                    ,CURR_OPER_UNT_ID                             08540187
085402                    ,CURR_FCLTY_ID                                08540287
085403                    ,CURR_FAC_AREA_ID                             08540387
085404                    ,CURR_LOC_DTE                                 08540487
085405                    ,CURR_LOC_TME                                 08540587
085406                    ,CURR_TRIP_ID                                 08540699
085407                    ,VEH_SIZE_CDE)                                08540787
085408            VALUES  (:VEHICL-OWNER-SCAC-ID                        08540887
085409                    ,:VEHICL-VEH-NBR                              08540987
085410                    ,:VEHICL-CRT-SRC-CDE                          08541087
085411                    ,:VEHICL-LAST-UPD-DTE                         08541187
085412                    ,:VEHICL-LAST-UPD-TME                         08541287
085413                    ,:VEHICL-LAST-UPD-UID                         08541387
085414                    ,:WS-SPACES                                   08541497
085415                    ,:VEHICL-VEH-TYP-CDE                          08541587
085416                    ,:TAUVHCL-STAT-CODE                           08541699
085418                    ,:VEHICL-CURR-STATUS-DTE                      08541887
085419                    ,:VEHICL-CURR-STATUS-TME                      08541987
085420                    ,:VEHICL-CURR-OPER-UNT-ID                     08542087
085421                    ,:VEHICL-CURR-FCLTY-ID                        08542187
085422                    ,:VEHICL-CURR-FAC-AREA-ID                     08542287
085423                    ,:VEHICL-CURR-LOC-DTE                         08542387
085424                    ,:VEHICL-CURR-LOC-TME                         08542487
085425                    ,:TRIPST-TRIP-ID                              08542599
085426                    ,:VEHICL-VEH-SIZE-CDE)                        08542687
085427         END-EXEC                                                 08542787
085428                                                                  08542887
085429         EVALUATE TRUE                                            08542987
085430             WHEN SQLCODE = +0                                    08543087
085431             WHEN SQLCODE = -904                                  08543187
085432             WHEN SQLCODE = -913                                  08543287
085433                 CONTINUE                                         08543387
085434                                                                  08543487
085435             WHEN OTHER                                           08543587
085436                 MOVE '7500-AUDIT-TVEHICL  '                      08543689
085437                                  TO PV-PARAGRAPH-NAME            08543787
085438                 MOVE 'UPDATE TVEHICL TABLE'                      08543887
085439                                  TO PV-DB2-OPER-ATTEMPTED        08543987
085449         END-EVALUATE.                                            08544987
085450 7500-EXIT.                                                       08545089
085451     EXIT.                                                        08545189
085460                                                                  08546087
086612                                                                  08661281
086613 9999-SQL-ERROR.                                                  08661381
086614                                                                  08661481
086615     SET ABEND-4013 TO TRUE.                                      08661581
086616                                                                  08661681
086617     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            08661700
086618     DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        08661800
086619                                                                  08661900
086620     COPY DPPD004.                                                08662000
086621                                                                  08662100
086622     CALL 'ILBOABN0'  USING ABEND-CODE.                           08662200
086630 9999-EXIT.                                                       08663032
086700     EXIT.                                                        08670032
087642**************************************************************    08764262
