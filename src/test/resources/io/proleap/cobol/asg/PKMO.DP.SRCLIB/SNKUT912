000100******************************************************************00010040
000200 IDENTIFICATION DIVISION.                                         00020040
000300******************************************************************00030040
000400                                                                  00040040
000500******************************************************************00050040
000600******************************************************************00060040
000700***  NEED TO COMPLETE:                                         ***00070040
000800***    ==> PICKING UP THE INTERNAL UPC NUMBER TO PUT ON THE    ***00080040
000900***        ASN DATA - NOT SURE IF THIS IS CORRECT?             ***00090040
001000***    ==> FOUND SOME I PREPACK ASN'S WHERE THE SN1 SEGMENT    ***00100040
001100***        SAID 1 ASSORTMENT BUT THEN THE SNL SEGMENTS         ***00110040
001200***        HAD DOUBLE THE UNITS OF THE PREPACK RATIO WHICH     ***00120040
001300***        RELATES TO 2 PACKS IN THE CARTON WHICH IS WHAT IT   ***00130040
001400***        SHOULD BE (VS THE SN1 SAYING 2 ASSORTMENTS AND THE  ***00140040
001500***        SNL SEGMENTS BEING THE QUANTITY FROM THE PREPACK    ***00150040
001600***        RATIO FOR A SINGLE PACK REQARDLESS OF HOW MANY ARE  ***00160040
001700***        IN THE PACK).  SHOULD CHECK THE CARTON DATA FOR     ***00170040
001800***        THIS.  THIS PROGRAM CODED TO HAVE MULTIPLE          ***00180040
001900***        ASSORTMENTS ON THE SN1 SEGMENT FOR I TYPE PREPACKS. ***00190040
002000******************************************************************00200040
002100******************************************************************00210040
002200                                                                  00220040
002300 PROGRAM-ID.    SNKUT912.                                         00230040
002400 AUTHOR.        RON KRIER                                         00240040
002500 INSTALLATION.  KOHLS.                                            00250040
002600 DATE-WRITTEN   FEBRUARY, 2014.                                   00260040
002700 DATE-COMPILED.                                                   00270040
002800                                                                  00280040
002900******************************************************************00290040
003000*  THIS PROGRAM IS USED TO HELP BUILD TEST ASN DATA FROM THE      00300040
003100*  PO'S BEING REQUESTED ON THE INPUT FILE.                        00310040
003200*  THE INPUT INTO THIS PROGRAM WILL BE FROM A FILE OUT OF         00320040
003300*  SNKUT910.  THE FILE WILL GIVE US THE DC, TRAILER AND PO        00330040
003400*  INFORMATION THAT CAN BE USED TO GENERATE THE ASN DATA TO A     00340040
003500*  FILE THAT COULD BE USED TO DROP INTO THE ASN REPOSITORY        00350040
003600*  TABLES.                                                        00360040
003700*                                                                 00370040
003800*  THIS PROGRAM WILL ONLY GENERATE THE ORDER LEVEL ASN DATA       00380040
003900*  BASED ON THE INPUT FILE.  THE SAME INPUT FILE WILL BE FED      00390040
004000*  INTO SNKUT911 TO CREATE THE SHIPMENT LEVEL DATA FOR THE        00400040
004100*  ASN'S.                                                         00410040
004200*                                                                 00420040
004300*  THE OUTPUT FILES FROM THIS PROGRAM AND SNKUT911 WILL THEN      00430040
004400*  BE SORTED TOGETHER AND PULLED INTO ANOTHER PROGRAM TO LOAD     00440040
004500*  UP THE REPOSITORY TABLES.                                      00450040
004600*                                                                 00460040
004700*  THIS PROGRAM WILL GENERATE THE FOLLOWING ASN SEGMENTS RELATED  00470040
004800*  TO ORDER INFO:                                                 00480040
004900*   'HL ' (VARIOUS LEVELS LIKE ORDER, PACK AND ITEM), PRF, TD1,   00490040
005000*   'MAN', 'LIN', 'SN1', 'REF', 'SLN', 'PO4'                      00500040
005100*                                                                 00510040
005200******************************************************************00520040
005300*  OF NOTE:  THE INBOUND CARTON DATA CREATED ON THE MAN SEGMENT  *00530040
005400*            WILL USE A RANGE OF NUMBERS BETWEEN                 *00540040
005500*            000000010000000001 AND 000000019999999999.          *00550040
005600*            PROGRAM WILL DETERMINE MAX NUMBER IN THAT RANGE     *00560040
005700*            CURRENTLY ON THE TABLE AND THEN INCREMENT THAT BY   *00570040
005800*            1 FOR USE IN THE PROGRAM.                           *00580040
005900******************************************************************00590040
006000*                                                                 00600040
006100******************************************************************00610040
006200******************************************************************00620040
006300 ENVIRONMENT DIVISION.                                            00630040
006400******************************************************************00640040
006500                                                                  00650040
006600 CONFIGURATION SECTION.                                           00660040
006700                                                                  00670040
006800 SOURCE-COMPUTER.        IBM-3090.                                00680040
006900 OBJECT-COMPUTER.        IBM-3090.                                00690040
007000                                                                  00700040
007100 INPUT-OUTPUT SECTION.                                            00710040
007200                                                                  00720040
007300 FILE-CONTROL.                                                    00730040
007400                                                                  00740040
007500                                                                  00750040
007600     SELECT INPUT-FILE                                            00760040
007700         ASSIGN TO INP01.                                         00770040
007800                                                                  00780040
007900     SELECT OUTPUT-FILE                                           00790040
008000         ASSIGN TO OUT01.                                         00800040
008100******************************************************************00810040
008200 DATA DIVISION.                                                   00820040
008300******************************************************************00830040
008400                                                                  00840040
008500 FILE SECTION.                                                    00850040
008600                                                                  00860040
008700 FD  INPUT-FILE                                                   00870040
008800     RECORDING MODE IS F                                          00880040
008900     LABEL RECORDS ARE STANDARD                                   00890040
009000     BLOCK CONTAINS 0 RECORDS.                                    00900040
009100                                                                  00910040
009200 01  INPUT-RECORD                     PIC   X(80).                00920040
009300                                                                  00930040
009400 FD  OUTPUT-FILE                                                  00940040
009500     RECORDING MODE IS F                                          00950040
009600     LABEL RECORDS ARE STANDARD                                   00960040
009700     RECORD CONTAINS 400                                          00970040
009800     BLOCK CONTAINS 0 RECORDS                                     00980040
009900     DATA RECORD IS OUTPUT-RECORD.                                00990040
010000                                                                  01000040
010100 01  OUTPUT-RECORD                    PIC   X(400).               01010040
010200*                                                                 01020040
010300******************************************************************01030040
010400 WORKING-STORAGE SECTION.                                         01040040
010500******************************************************************01050040
010600*                                                                 01060040
010700 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01070040
010800                                                   COMP SYNC.     01080040
010900                                                                  01090040
011000 01  PS-PROGRAM-SWITCHES.                                         01100040
011100     05  PS-EOF-INPUT-SW             PIC  X(01)    VALUE 'N'.     01110040
011200         88  PS-EOF-INPUT                          VALUE 'Y'.     01120040
011300         88  PS-MORE-INPUT                         VALUE 'N'.     01130040
011400     05  PS-PRINT-INFO-SW            PIC  X(01)    VALUE 'N'.     01140040
011500         88  PS-PRINT-INFO                         VALUE 'Y'.     01150040
011600         88  PS-NOT-PRINT-INFO                     VALUE 'N'.     01160040
011700     05  PS-INBOUND-LINE-SW          PIC  X(01)    VALUE 'N'.     01170040
011800         88  PS-INBOUND-LINE-FOUND                 VALUE 'Y'.     01180040
011900         88  PS-INBOUND-LINE-NOT-FOUND             VALUE 'N'.     01190040
012000     05  PS-EOF-CURSOR-SW            PIC  X(01)    VALUE 'N'.     01200040
012100         88  PS-EOF-CURSOR                         VALUE 'Y'.     01210040
012200         88  PS-NOT-EOF-CURSOR                     VALUE 'N'.     01220040
012300     05  PS-EOF-PACK-ITEM-CURSOR-SW  PIC  X(01)    VALUE 'N'.     01230040
012400         88  PS-EOF-PACK-ITEM-CURSOR               VALUE 'Y'.     01240040
012500         88  PS-NOT-EOF-PACK-ITEM-CURSOR           VALUE 'N'.     01250040
012600     05  PS-REPLACE-LINE-FOUND-SW    PIC  X(01)    VALUE 'N'.     01260040
012700         88  PS-REPLACE-LINE-FOUND                 VALUE 'Y'.     01270040
012800         88  PS-REPLACE-LINE-NOT-FOUND             VALUE 'N'.     01280040
012810     05  PS-UNIQUE-TRACK-SW          PIC  X(01)    VALUE 'N'.     01281040
012820         88  PS-UNIQUE-TRACK                       VALUE 'Y'.     01282040
012830         88  PS-UNIQUE-TRACK-NO                    VALUE 'N'.     01283040
012840                                                                  01284040
012850 01  PC-PROGRAM-CONSTANTS.                                        01285040
012860     05  PC-RANDOM-PGM               PIC  X(08)    VALUE          01286040
012870         'DPKUT902'.                                              01287040
012880     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     01288040
012890                                                   COMP SYNC.     01289040
012900     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01290040
013000         'SNKUT912'.                                              01300040
013100     05  PC-CURRENT-OPERATING-COMPANY                             01310040
013200                                     PIC  X(02)    VALUE '03'.    01320040
013300     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01330040
013400                                                   COMP SYNC.     01340040
013500     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  01350040
013600     05  PC-MIN-UCC128-RANGE         PIC  9(18)    VALUE          01360040
013700                                     000000010000000001.          01370040
013800     05  PC-MAX-UCC128-RANGE         PIC  9(18)    VALUE          01380040
013900                                     000000019999999999.          01390040
014000     05  PC-ONE                      PIC S9(03)    VALUE  +1.     01400040
014100     05  PC-TWO                      PIC S9(03)    VALUE  +2.     01410040
014200     05  PC-TWENTY-TWO               PIC S9(03)    VALUE  +22.    01420040
014300                                                                  01430040
014400 01  PV-PROGRAM-VARIABLES.                                        01440040
014500     05  PV-LOOP-COUNT               PIC  9(08)    VALUE ZERO.    01450040
014600     05  PV-UCC128-NUMBER            PIC  9(18)    VALUE ZERO.    01460040
014700     05  PV-UCC128-CHAR.                                          01470040
014800         10  PV-UCC128-PREFIX        PIC  9(02)    VALUE ZEROS.   01480040
014900         10  PV-UCC128-18            PIC  9(18)    VALUE ZEROS.   01490040
015000     05  PV-HL03-LVL-CDE             PIC  X(02)    VALUE SPACES.  01500040
015100     05  PV-PREV-DC-NBR              PIC  9(04)    VALUE ZERO.    01510040
015200     05  PV-HOLD-N1-SHIP-NBR         PIC  9(04)    VALUE ZERO.    01520040
015300     05  PV-PREV-TRAILER-NBR         PIC  9(08)    VALUE ZERO.    01530040
015400     05  PV-PREV-STRUCTURE-CDE       PIC  X(04)    VALUE SPACES.  01540040
015500     05  PV-PREV-ENT-ID              PIC  9(09)    VALUE ZERO.    01550040
015600     05  PV-PREV-PO-PREPK-ID         PIC S9(4)     VALUE ZERO     01560040
015700                                                   COMP.          01570040
015800     05  PV-PREV-STR-NBR             PIC S9(4)     VALUE ZERO     01580040
015900                                                   COMP.          01590040
016000     05  PV-PO-LNE-NBR               PIC S9(9)     VALUE ZERO     01600040
016100                                                   COMP.          01610040
016200     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    01620040
016300     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    01630040
016400     05  PV-NUM-FIELD                PIC  9(06)    VALUE ZERO.    01640040
016500     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  01650040
016600     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01660040
016700     05  PV-ABEND-MESSAGE            PIC  X(30)    VALUE SPACE.   01670040
016800     05  PV-COMPONENT-QTY            PIC S9(09)    VALUE ZERO     01680040
016900                                                   COMP SYNC.     01690040
017000     05  PV-PACKS-PER-CARTON         PIC S9(09)    VALUE ZERO     01700040
017100                                                   COMP SYNC.     01710040
017200     05  PV-PACKS-TO-RECEIVE         PIC S9(09)    VALUE ZERO     01720040
017300                                                   COMP SYNC.     01730040
017400     05  PV-CURR-SPLIT-PCT-QTY       PIC S9(09)    VALUE ZERO     01740040
017500                                                   COMP SYNC.     01750040
017600     05  PV-STR-DISTRO-PCT-QTY       PIC S9(09)    VALUE ZERO     01760040
017700                                                   COMP SYNC.     01770040
017800     05  PV-STR-TOTAL-IN-CRTN-QTY    PIC S9(09)    VALUE ZERO     01780040
017900                                                   COMP SYNC.     01790040
018000     05  PV-CARTON-SHIP-QTY          PIC S9(09)    VALUE ZERO     01800040
018100                                                   COMP SYNC.     01810040
018200     05  PV-CARTON-QTY               PIC S9(09)    VALUE ZERO     01820040
018300                                                   COMP SYNC.     01830040
018400     05  PV-LINE-SHIP-QTY            PIC S9(09)    VALUE ZERO     01840040
018500                                                   COMP SYNC.     01850040
018600     05  PV-INPUT-COUNTER            PIC S9(09)    VALUE ZERO     01860040
018700                                                   COMP SYNC.     01870040
018800     05  PV-INPUT-DISPLAY-COUNTER    PIC S9(09)    VALUE ZERO     01880040
018900                                                   COMP SYNC.     01890040
019000     05  PV-OUTPUT-COUNTER           PIC S9(09)    VALUE ZERO     01900040
019100                                                   COMP SYNC.     01910040
019200     05  PV-MULT-PKITEM-COUNTER      PIC S9(09)    VALUE ZERO     01920040
019300                                                   COMP SYNC.     01930040
019400     05  PV-NO-PKITEM-COUNTER        PIC S9(09)    VALUE ZERO     01940040
019500                                                   COMP SYNC.     01950040
019600     05  PV-YES-PKITEM-COUNTER       PIC S9(09)    VALUE ZERO     01960040
019700                                                   COMP SYNC.     01970040
019800     05  PV-NO-MATCH-INBOUND-COUNTER PIC S9(09)    VALUE ZERO     01980040
019900                                                   COMP SYNC.     01990040
020000     05  PV-MATCH-INBOUND-COUNTER    PIC S9(09)    VALUE ZERO     02000040
020100                                                   COMP SYNC.     02010040
020200     05  PV-YES-INBOUND-COUNTER      PIC S9(09)    VALUE ZERO     02020040
020300                                                   COMP SYNC.     02030040
020400     05  PV-NO-INBOUND-COUNTER       PIC S9(09)    VALUE ZERO     02040040
020500                                                   COMP SYNC.     02050040
020600     05  PV-MULT-INBOUND-COUNTER     PIC S9(09)    VALUE ZERO     02060040
020700                                                   COMP SYNC.     02070040
020800     05  PV-MATCH-COUNTER            PIC S9(09)    VALUE ZERO     02080040
020900                                                   COMP SYNC.     02090040
021000     05  PV-MISMATCH-COUNTER         PIC S9(09)    VALUE ZERO     02100040
021100                                                   COMP SYNC.     02110040
021200     05  PV-MULT-DATA-COUNTER        PIC S9(09)    VALUE ZERO     02120040
021300                                                   COMP SYNC.     02130040
021400     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             02140040
021500                                                                  02150040
021600     05  PV-TEMP-FIELD               PIC S9(09)    VALUE ZERO     02160040
021700                                                   COMP SYNC.     02170040
021800     05  PV-IO-TOT-PKSLP-ITM-QTY     PIC S9(09)    VALUE ZERO     02180040
021900                                                   COMP SYNC.     02190040
022000     05  PV-IO-TOT-NBR-OF-CRTNS      PIC S9(09)    VALUE ZERO     02200040
022100                                                   COMP SYNC.     02210040
022200     05  PV-IO-TOT-CRSDCK-CRTN-QTY   PIC S9(09)    VALUE ZERO     02220040
022300                                                   COMP SYNC.     02230040
022400     05  PV-IO-TOT-P2L-CRTN-QTY      PIC S9(09)    VALUE ZERO     02240040
022500                                                   COMP SYNC.     02250040
022600     05  PV-IO-TOT-HRTW-CRTN-QTY     PIC S9(09)    VALUE ZERO     02260040
022700                                                   COMP SYNC.     02270040
022800     05  PV-IO-TOT-JWLRY-CRTN-QTY    PIC S9(09)    VALUE ZERO     02280040
022900                                                   COMP SYNC.     02290040
023000     05  PV-IO-TOT-CRSDCK-UNIT-QTY   PIC S9(09)    VALUE ZERO     02300040
023100                                                   COMP SYNC.     02310040
023200     05  PV-IO-TOT-P2L-UNIT-QTY      PIC S9(09)    VALUE ZERO     02320040
023300                                                   COMP SYNC.     02330040
023400     05  PV-IO-TOT-HRTW-UNIT-QTY     PIC S9(09)    VALUE ZERO     02340040
023500                                                   COMP SYNC.     02350040
023600     05  PV-IO-TOT-JWLRY-UNIT-QTY    PIC S9(09)    VALUE ZERO     02360040
023700                                                   COMP SYNC.     02370040
023800                                                                  02380040
023900     05  PV-IN-TOT-PKSLP-ITM-QTY     PIC S9(09)    VALUE ZERO     02390040
024000                                                   COMP SYNC.     02400040
024100     05  PV-IN-TOT-NBR-OF-CRTNS      PIC S9(09)    VALUE ZERO     02410040
024200                                                   COMP SYNC.     02420040
024300     05  PV-IN-TOT-CRSDCK-CRTN-QTY   PIC S9(09)    VALUE ZERO     02430040
024400                                                   COMP SYNC.     02440040
024500     05  PV-IN-TOT-P2L-CRTN-QTY      PIC S9(09)    VALUE ZERO     02450040
024600                                                   COMP SYNC.     02460040
024700     05  PV-IN-TOT-HRTW-CRTN-QTY     PIC S9(09)    VALUE ZERO     02470040
024800                                                   COMP SYNC.     02480040
024900     05  PV-IN-TOT-JWLRY-CRTN-QTY    PIC S9(09)    VALUE ZERO     02490040
025000                                                   COMP SYNC.     02500040
025100     05  PV-IN-TOT-CRSDCK-UNIT-QTY   PIC S9(09)    VALUE ZERO     02510040
025200                                                   COMP SYNC.     02520040
025300     05  PV-IN-TOT-P2L-UNIT-QTY      PIC S9(09)    VALUE ZERO     02530040
025400                                                   COMP SYNC.     02540040
025500     05  PV-IN-TOT-HRTW-UNIT-QTY     PIC S9(09)    VALUE ZERO     02550040
025600                                                   COMP SYNC.     02560040
025700     05  PV-IN-TOT-JWLRY-UNIT-QTY    PIC S9(09)    VALUE ZERO     02570040
025800                                                   COMP SYNC.     02580040
025900     05  PV-SHPD-QTY                 PIC  9(07)    VALUE ZEROS.   02590040
026000                                                                  02600040
026100     05  PV-PKSL-ITM-QTY             PIC  9(07)    VALUE ZEROS.   02610040
026200                                                                  02620040
026300     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     02630040
026400                                                   COMP-3.        02640040
026500     05  PV-ALLPLN-CURR-SPLIT-QTY    PIC S9(09)    VALUE ZERO     02650040
026600                                                   COMP SYNC.     02660040
026700     05  PV-TOTAL-CARTON-QTY         PIC S9(09)    VALUE ZERO     02670040
026800                                                   COMP SYNC.     02680040
026900     05  PV-TOTAL-CARTON-SHIP-QTY    PIC S9(09)    VALUE ZERO     02690040
027000                                                   COMP SYNC.     02700040
027100     05  PV-TOTAL-CARTON-SHIP-LBS    PIC S9(09)    VALUE ZERO     02710040
027200                                                   COMP SYNC.     02720040
027300     05  PV-PERCENT-OF-PO-UNITS      PIC S9(01)V99 VALUE ZERO     02730040
027400                                                   COMP-3.        02740040
027500                                                                  02750040
027600     05  PV-SEQ-NBR                   PIC 9(08)     VALUE ZERO.   02760040
027700     05  PV-HOLD-TD1-SHIP-SEQ-NBR     PIC 9(08)     VALUE ZERO.   02770040
027800     05  PV-HOLD-TD1-ORDER-SEQ-NBR    PIC 9(08)     VALUE ZERO.   02780040
027900     05  PV-TD1-ORDER-CRTN-COUNT      PIC 9(08)     VALUE ZERO.   02790040
028000     05  PV-TD1-SHIP-CRTN-COUNT       PIC 9(08)     VALUE ZERO.   02800040
028100     05  PV-RANDOM-NBR                PIC 9(09)     VALUE ZERO.   02810040
028200     05  PV-DISPLAY-OPER              PIC 9(04)     VALUE ZERO.   02820040
028300     05  PV-DISPLAY-PO                PIC 9(09)     VALUE ZERO.   02830040
028400     05  PV-DISPLAY-ENT-ID            PIC 9(09)     VALUE ZERO.   02840040
028500     05  PV-DISPLAY-SEQ-NBR           PIC 9(09)     VALUE ZERO.   02850040
028600     05  PV-DISPLAY-ITEM-NBR          PIC 9(18)     VALUE ZERO.   02860040
028700     05  PV-DISPLAY-SKU-NBR           PIC 9(08)     VALUE ZERO.   02870040
028800     05  PV-DISPLAY-ERROR-NBR         PIC 9(02)     VALUE ZERO.   02880040
028900     05  PV-DISPLAY-LOC-NBR           PIC 9(04)     VALUE ZERO.   02890040
029000     05  PV-DISPLAY-OPER-UNT          PIC 9(04)     VALUE ZERO.   02900040
029100     05  PV-DISPLAY-FIELD             PIC ZZZZZZZZ9 VALUE ZERO.   02910040
029200     05  PV-DISPLAY-FIELD-2           PIC ZZZZZZZZ9 VALUE ZERO.   02920040
029300     05  PV-DISPLAY-FIELD-3           PIC ZZZZZZZZ9 VALUE ZERO.   02930040
029400                                                                  02940040
029500* FIELDS FOR FETCHING THE PACK-ITEM-CURSOR INTO                   02950040
029600     05  PV-PIC-PO-NBR                PIC  S9(9) COMP.            02960040
029700     05  PV-PIC-UPC-NBR               PIC  S9(15)V COMP-3.        02970040
029800     05  PV-PIC-PREPK-RATO-QTY        PIC  S9(4) COMP.            02980040
029900     05  PV-PIC-PO-LNE-NBR            PIC  S9(9) COMP.            02990040
030000                                                                  03000040
030100* FIELDS FOR FETCHING THE REPLACEMENT PO LINE DATA INTO           03010040
030200     05  PV-REP-PO-NBR                PIC  S9(9) COMP.            03020040
030300     05  PV-REP-UPC-NBR               PIC  S9(15)V COMP-3.        03030040
030400     05  PV-REP-PREPK-RATO-QTY        PIC  S9(4) COMP.            03040040
030500     05  PV-REP-PO-LNE-NBR            PIC  S9(9) COMP.            03050040
030600                                                                  03060040
030700     05  PV-SHIPMENT-ID.                                          03070040
030800         10  PV-SCAC                  PIC  X(04).                 03080040
030900         10  PV-DC-NBR                PIC  9(04).                 03090040
031000         10  PV-NSEC                  PIC  X(06).                 03100040
031100         10  PV-SEC                   PIC  X(02).                 03110040
031200         10  PV-MIN                   PIC  X(02).                 03120040
031300         10  PV-HRS                   PIC  X(02).                 03130040
031400         10  PV-DD                    PIC  X(02).                 03140040
031500     05  PV-SHIP-TO-DC.                                           03150040
031600         10  PV-SHIP-TO-DC-NBR        PIC  9(04).                 03160040
031700         10  PV-SHIP-TO-DC-FILLER     PIC  X(13).                 03170040
031800     05  PV-PO-NBR-8.                                             03180040
031900         10  PV-PO-NBR-1              PIC  9(01).                 03190040
032000         10  PV-PO-NBR-7              PIC  9(07).                 03200040
032100                                                                  03210040
032200     05  PV-CURRENT-TIMESTAMP         PIC  X(26).                 03220040
032300     05  PV-CURR-TMST.                                            03230040
032400         10  PV-CURR-TMST-CC          PIC  X(02).                 03240040
032500         10  PV-CURR-TMST-YY          PIC  X(02).                 03250040
032600         10  FILLER                   PIC  X(01).                 03260040
032700         10  PV-CURR-TMST-MM          PIC  X(02).                 03270040
032800         10  FILLER                   PIC  X(01).                 03280040
032900         10  PV-CURR-TMST-DD          PIC  X(02).                 03290040
033000         10  FILLER                   PIC  X(01).                 03300040
033100         10  PV-CURR-TMST-HRS         PIC  X(02).                 03310040
033200         10  FILLER                   PIC  X(01).                 03320040
033300         10  PV-CURR-TMST-MIN         PIC  X(02).                 03330040
033400         10  FILLER                   PIC  X(01).                 03340040
033500         10  PV-CURR-TMST-SEC         PIC  X(02).                 03350040
033600         10  FILLER                   PIC  X(01).                 03360040
033700         10  PV-CURR-TMST-NSEC        PIC  X(06).                 03370040
033800                                                                  03380040
033900     05  PV-ASN-CRE-DATE.                                         03390040
034000         10  PV-ASN-CRE-DATE-YY       PIC  X(02).                 03400040
034100         10  PV-ASN-CRE-DATE-MM       PIC  X(02).                 03410040
034200         10  PV-ASN-CRE-DATE-DD       PIC  X(02).                 03420040
034300                                                                  03430040
034400     05  PV-ASN-CRE-TIME.                                         03440040
034500         10  PV-ASN-CRE-TIME-HH       PIC  X(02).                 03450040
034600         10  PV-ASN-CRE-TIME-MM       PIC  X(02).                 03460040
034700                                                                  03470040
034800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03480040
034900* DMH 3/9/16 - ADDED FOR CARRIER PACKAGE ID                       03490040
035000* UPS TRACKING#:  1Z XXX XXX YY ZZZZ ZZZC                         03500040
035001*      X:  SHIPPER'S ACCOUNT # (6 DIGITS)                         03500140
035002*      Y:  SERVICE CODE (2 DIGITS) 03 = UPS UNITED STATES GROUND  03500240
035003*      Z:  SHIPPER'S REFERENCE #                                  03500340
035004*      C:  CHECK DIGIT                                            03500440
035005* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03500540
035006* DMH 3/9/16 - ADDED FOR CARRIER PACKAGE ID                       03500640
035007     05  PV-UPS-TRACK-NUMBER          PIC X(18) VALUE SPACES.     03500740
035008     05  PV-UPS-TRACK-NUMBER-R REDEFINES PV-UPS-TRACK-NUMBER.     03500840
035009         10  PV-UPS-TRACK-01-02       PIC X(02).                  03500940
035010         10  PV-UPS-TRACK-03-08       PIC X(06).                  03501040
035020         10  PV-UPS-TRACK-09-10       PIC X(02).                  03502040
035030         10  PV-UPS-TRACK-11-18       PIC 9(08).                  03503040
035040                                                                  03504040
035050     05  PV-UPS-SRVC-ACCT             PIC X(06)  VALUE SPACES.    03505040
035060     05  PV-UPS-SRVC-CODE             PIC X(02)  VALUE SPACES.    03506040
035070     05  PV-PREV-UPS-PO               PIC 9(08)  VALUE ZEROS.     03507040
035080* DMH 3/9/16                                                      03508040
035090                                                                  03509040
035100 01  PV-ABEND-FIELDS.                                             03510040
035200     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         03520040
035300                                                 COMP SYNC.       03530040
035400     05  PV-SQLCODE                   PIC  Z(08)9-.               03540040
035500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    03550040
035600     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    03560040
035700     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    03570040
035800     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    03580040
035900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    03590040
036000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    03600040
036100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    03610040
036200     05  PV-DB2-TABLE-NAME-1          PIC  X(15) VALUE SPACE.     03620040
036300     05  PV-DB2-TABLE-NAME-2          PIC  X(15) VALUE SPACE.     03630040
036400     05  PV-DB2-TABLE-NAME-3          PIC  X(15) VALUE SPACE.     03640040
036500     05  PV-DB2-TABLE-NAME-4          PIC  X(15) VALUE SPACE.     03650040
036600                                                                  03660040
036700                                                                  03670040
036800 01  PV-INPUT.                                                    03680040
036900     05  FILLER                       PIC  X(01) VALUE SPACES.    03690040
037000     05  PVI-DC-NBR                   PIC  9(04) VALUE ZEROS.     03700040
037100     05  FILLER                       PIC  X(01) VALUE SPACES.    03710040
037200     05  PVI-TRAILER-NBR              PIC  9(08) VALUE ZEROS.     03720040
037300     05  FILLER                       PIC  X(01) VALUE SPACES.    03730040
037400     05  PVI-PO-NBR                   PIC  9(08) VALUE ZEROS.     03740040
037500     05  FILLER                       PIC  X(01) VALUE SPACES.    03750040
037600     05  PVI-PERCENT-OF-PO-UNITS      PIC  9(03) VALUE ZEROS.     03760040
037700         88  PVI-ALL-PO-UNITS                    VALUE 100.       03770040
037800     05  FILLER                       PIC  X(01) VALUE SPACE.     03780040
037900     05  PVI-PREPACK-ASN-BUILD-CDE    PIC  X(01) VALUE ZEROS.     03790040
038000         88 PVI-BUILD-PACK-AND-COMP              VALUE 'A'.       03800040
038100         88 PVI-BUILD-PACK-ONLY                  VALUE 'B'.       03810040
038200         88 PVI-BUILD-COMP-ONLY                  VALUE 'C'.       03820040
038300     05  FILLER                       PIC  X(01) VALUE SPACE.     03830040
038400     05  PVI-ID-SEGMENT-STRUC-CDE     PIC  X(04) VALUE ZEROS.     03840040
038500         88 PVI-ID-SEG-STRUC-PICK-PACK           VALUE '0001'.    03850040
038600         88 PVI-ID-SEG-STRUC-STANDARD            VALUE '0002'.    03860040
038700     05  FILLER                       PIC  X(01) VALUE SPACE.     03870040
038800     05  PVI-ENT-ID                   PIC  9(09) VALUE ZEROS.     03880040
038900     05  FILLER                       PIC  X(01) VALUE SPACE.     03890040
039000     05  PVI-BUILD-AS-PBS-ASN-CDE     PIC  X(01) VALUE ZEROS.     03900040
039100         88 PVI-BUILD-AS-PBS-ASN                 VALUE 'Y'.       03910040
039200     05  FILLER                       PIC  X(01) VALUE SPACE.     03920040
039300     05  PVI-PACK-RAT-LNE1-DF-NBR     PIC  9(03) VALUE ZEROS.     03930040
039400     05  FILLER                       PIC  X(01) VALUE SPACE.     03940040
039500     05  PVI-PACK-RAT-LNE1-DF-CDE     PIC  X(01) VALUE SPACE.     03950040
039600         88 PVI-PACK-RAT-LNE1-DF-PLUS            VALUE 'P'.       03960040
039700         88 PVI-PACK-RAT-LNE1-DF-NEG             VALUE 'N'.       03970040
039800     05  FILLER                       PIC  X(01) VALUE SPACE.     03980040
039900     05  PVI-PACK-RAT-LNE1-DF-QTY     PIC  9(03) VALUE ZEROS.     03990040
040000     05  FILLER                       PIC  X(01) VALUE SPACE.     04000040
040100     05  PVI-PACK-RAT-LNE2-DF-NBR     PIC  9(03) VALUE ZEROS.     04010040
040200     05  FILLER                       PIC  X(01) VALUE SPACE.     04020040
040300     05  PVI-PACK-RAT-LNE2-DF-CDE     PIC  X(01) VALUE SPACE.     04030040
040400         88 PVI-PACK-RAT-LNE2-DF-PLUS            VALUE 'P'.       04040040
040500         88 PVI-PACK-RAT-LNE2-DF-NEG             VALUE 'N'.       04050040
040600     05  FILLER                       PIC  X(01) VALUE SPACE.     04060040
040700     05  PVI-PACK-RAT-LNE2-DF-QTY     PIC  9(03) VALUE ZEROS.     04070040
040800     05  FILLER                       PIC  X(01) VALUE SPACE.     04080040
040900     05  PVI-PACK-COMP-BYPASS-LNE-NBR PIC  9(03) VALUE ZEROS.     04090040
041000     05  FILLER                       PIC  X(01) VALUE SPACE.     04100040
041100     05  PVI-PACK-COMP-RPLACE-LNE-NBR PIC  9(03) VALUE ZEROS.     04110040
041110* DMH 3/9/16 - ADDED FOR CARRIER PACKAGE ID                       04111040
041120     05  FILLER                       PIC  X(01) VALUE SPACE.     04112040
041130     05  PVI-GENERATE-CARR-TRACK      PIC  X(01) VALUE SPACE.     04113040
041140         88  PVI-NO-CARR-TRACK-NO                VALUE 'N' ' '.   04114040
041150         88  PVI-GENERATE-UPS-TRACK              VALUE 'U'.       04115040
041160* DMH 3/9/16                                                      04116040
041170     05  FILLER                       PIC  X(04) VALUE SPACE.     04117040
041180                                                                  04118040
041190 01  PV-OUTPUT.                                                   04119040
041200     05  FILLER                       PIC  X(01) VALUE SPACES.    04120040
041300     05  PVO-DC-NBR                   PIC  9(04) VALUE ZEROS.     04130040
041400     05  FILLER                       PIC  X(01) VALUE SPACES.    04140040
041500     05  PVO-TRAILER-NBR              PIC  9(08) VALUE ZEROS.     04150040
041600     05  FILLER                       PIC  X(01) VALUE SPACES.    04160040
041700     05  PVO-ENT-ID                   PIC  9(09) VALUE ZEROS.     04170040
041800     05  FILLER                       PIC  X(01) VALUE SPACES.    04180040
041900     05  PVO-STRUCTURE-CDE            PIC  X(04) VALUE ZEROS.     04190040
042000     05  FILLER                       PIC  X(01) VALUE SPACES.    04200040
042100     05  PVO-SEQ-NBR                  PIC  9(08) VALUE ZEROS.     04210040
042200     05  FILLER                       PIC  X(01) VALUE SPACES.    04220040
042300     05  PVO-ASN-DATA-RECORD          PIC  X(350).                04230040
042400     05  FILLER                       PIC  X(11) VALUE SPACE.     04240040
042500                                                                  04250040
042600                                                                  04260040
042700 01  SD-SYSTEM-DATE.                                              04270040
042800     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  04280040
042900     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  04290040
043000     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  04300040
043100                                                                  04310040
043200 01  DK-DB-KEYS.                                                  04320040
043300     05 DK-PO-NBR                     PIC S9(09) COMP.            04330040
043400     05 DK-PO-LINE-NBR                PIC S9(09) COMP.            04340040
043500     05 DK-PO-PREPK-ID                PIC S9(04) COMP.            04350040
043600     05 DK-ASN-NBR                    PIC  X(30).                 04360040
043700     05 DK-SKU-NBR                    PIC S9(08)V COMP-3.         04370040
043800     05 DK-OPER-UNIT                  PIC S9(04) COMP.            04380040
043900     05 DK-DC-NBR                     PIC S9(04) COMP.            04390040
044000     05 DK-STORE-NBR                  PIC S9(04) COMP.            04400040
044100     05 DK-SEQ-NBR                    PIC S9(04) COMP.            04410040
044200     05 DK-ENT-ID                     PIC S9(09) COMP.            04420040
044300     05 DK-UCC128-MIN                 PIC S9(18)V COMP-3.         04430040
044400     05 DK-UCC128-MAX                 PIC S9(18)V COMP-3.         04440040
044500     05 DK-RP-PO-NBR                  PIC S9(09) COMP.            04450040
044600     05 DK-RP-PO-LINE-NBR             PIC S9(09) COMP.            04460040
044700                                                                  04470040
044800*================================================================*04480040
044900* UPS SERVICE ACCOUNTS - RANDOM                                  *04490040
045000*================================================================*04500040
045001 01  PT-UPS-SRVC-ACCT-VALUES.                                     04500140
045002     05  FILLER  PIC X(06) VALUE 'M30916'.                        04500240
045003     05  FILLER  PIC X(23) VALUE 'P69511'.                        04500340
045004     05  FILLER  PIC X(23) VALUE 'X22858'.                        04500440
045005                                                                  04500540
045006 01  PT-UPS-SRVC-ACCT-TABLE REDEFINES PT-UPS-SRVC-ACCT-VALUES.    04500640
045007     05  PT-UPS-DATA OCCURS 03 TIMES                              04500740
045008                              INDEXED BY PT-SRVC-IDX.             04500840
045009         10  PT-UPS-SRVC-ACCT         PIC X(06).                  04500940
045010                                                                  04501040
045011*================================================================*04501140
045012* UPS TRACKING NUMBER - SERVICE CODE TABLE                       *04501240
045013*================================================================*04501340
045014 01  PT-UPS-TRACKING-VALUES.                                      04501440
045015     05  FILLER  PIC X(23) VALUE '01 UPS USA NEXT DAY AIR'.       04501540
045016     05  FILLER  PIC X(23) VALUE '02 UPS USA 2ND DAY AIR '.       04501640
045017     05  FILLER  PIC X(23) VALUE '03 UPS USA GROUND      '.       04501740
045018     05  FILLER  PIC X(23) VALUE '12 UPS USA 3RD DAY     '.       04501840
045019     05  FILLER  PIC X(23) VALUE '13 UPS USA RED SAVER   '.       04501940
045020     05  FILLER  PIC X(23) VALUE '15 UPS USA NEXT AM     '.       04502040
045021     05  FILLER  PIC X(23) VALUE '22 UPS USA GRND 3PKUPS '.       04502140
045022     05  FILLER  PIC X(23) VALUE '32 UPS USA NEXT AM COD '.       04502240
045023     05  FILLER  PIC X(23) VALUE '33 UPS USA NEXT SAT COD'.       04502340
045024     05  FILLER  PIC X(23) VALUE '41 UPS USA NEXT SAT AM '.       04502440
045025     05  FILLER  PIC X(23) VALUE '42 UPS USA GROUND SIGN '.       04502540
045026     05  FILLER  PIC X(23) VALUE '44 UPS USA NEXT SAT    '.       04502640
045027     05  FILLER  PIC X(23) VALUE '66 UPS USA WORLDWIDE   '.       04502740
045028     05  FILLER  PIC X(23) VALUE '72 UPS USA GRND COD    '.       04502840
045029     05  FILLER  PIC X(23) VALUE '78 UPS USA GRND 1PKUP  '.       04502940
045030     05  FILLER  PIC X(23) VALUE '90 UPS USA GRND RETURN '.       04503040
045031     05  FILLER  PIC X(23) VALUE 'A0 UPS USA AIR AM SIGN '.       04503140
045032     05  FILLER  PIC X(23) VALUE 'A1 UPS USA AIR SAT SIGN'.       04503240
045033     05  FILLER  PIC X(23) VALUE 'A2 UPS USA AIR SIGN    '.       04503340
045034     05  FILLER  PIC X(23) VALUE 'A8 UPS USA GRND ADULT  '.       04503440
045035     05  FILLER  PIC X(23) VALUE 'A9 UPS USA AM COD ADULT'.       04503540
045036     05  FILLER  PIC X(23) VALUE 'AA UPS USA SAT COD ADUL'.       04503640
045037                                                                  04503740
045038 01  PT-UPS-TRACKING-TABLE REDEFINES PT-UPS-TRACKING-VALUES.      04503840
045039     05  PT-UPS-DATA OCCURS 22 TIMES                              04503940
045040                              INDEXED BY PT-UPS-IDX.              04504040
045041         10  PT-UPS-SERVICE-CODE      PIC X(02).                  04504140
045042         10  FILLER                   PIC X(01).                  04504240
045043         10  PT-UPS-SC-DESC           PIC X(20).                  04504340
045044                                                                  04504440
045045* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04504540
045046                                                                  04504640
045047*----------------------------------------------------------------*04504740
045048*  RANDOM NUMBER AREA                                             04504840
045049*----------------------------------------------------------------*04504940
045050     COPY DPWS902.                                                04505040
045060                                                                  04506040
045070******************************************************************04507040
045080*  DB2 FORMATTED MESSAGE AREA                                     04508040
045090******************************************************************04509040
045100     COPY DPWS004.                                                04510040
045200                                                                  04520040
045300******************************************************************04530040
045400*  ASN OUTPUT LAYOUT                                              04540040
045500******************************************************************04550040
045600     COPY SNRD005.                                                04560040
045700*                                                                 04570040
045800******************************************************************04580040
045900*  COMMUNICATIONS AREA FOR DB2                                    04590040
046000******************************************************************04600040
046100     EXEC SQL                                                     04610040
046200          INCLUDE SQLCA                                           04620040
046300     END-EXEC.                                                    04630040
046400*                                                                 04640040
046500******************************************************************04650040
046600*   TCOCNTL TABLE                                                 04660040
046700******************************************************************04670040
046800     EXEC SQL                                                     04680040
046900          INCLUDE TCOCNTL                                         04690040
047000     END-EXEC.                                                    04700040
047100*                                                                 04710040
047200******************************************************************04720040
047300*   TPURCHS TABLE                                                 04730040
047400******************************************************************04740040
047500     EXEC SQL                                                     04750040
047600          INCLUDE TPURCHS                                         04760040
047700     END-EXEC.                                                    04770040
047800*                                                                 04780040
047900******************************************************************04790040
048000*   TPURITM TABLE                                                 04800040
048100******************************************************************04810040
048200     EXEC SQL                                                     04820040
048300          INCLUDE TPURITM                                         04830040
048400     END-EXEC.                                                    04840040
048500                                                                  04850040
048600*                                                                 04860040
048700******************************************************************04870040
048800*   TPOPRPK TABLE                                                 04880040
048900******************************************************************04890040
049000     EXEC SQL                                                     04900040
049100          INCLUDE TPOPRPK                                         04910040
049200     END-EXEC.                                                    04920040
049300                                                                  04930040
049400*                                                                 04940040
049500******************************************************************04950040
049600*   TALLPLN TABLE                                                 04960040
049700******************************************************************04970040
049800     EXEC SQL                                                     04980040
049900          INCLUDE TALLPLN                                         04990040
050000     END-EXEC.                                                    05000040
050100                                                                  05010040
050200*                                                                 05020040
050300******************************************************************05030040
050400*   TMESTDS TABLE                                                 05040040
050500******************************************************************05050040
050600     EXEC SQL                                                     05060040
050700          INCLUDE TMESTDS                                         05070040
050800     END-EXEC.                                                    05080040
050900                                                                  05090040
051000*                                                                 05100040
051100******************************************************************05110040
051200*   XLT_UPC TABLE                                                 05120040
051300******************************************************************05130040
051400     EXEC SQL                                                     05140040
051500          INCLUDE XLT00006                                        05150040
051600     END-EXEC.                                                    05160040
051700                                                                  05170040
051800*                                                                 05180040
051900******************************************************************05190040
052000*   XLT_SKU TABLE                                                 05200040
052100******************************************************************05210040
052200     EXEC SQL                                                     05220040
052300          INCLUDE XLT00003                                        05230040
052400     END-EXEC.                                                    05240040
052500                                                                  05250040
052600*                                                                 05260040
052700******************************************************************05270040
052800*   TEXTENT TABLE                                                 05280040
052900******************************************************************05290040
053000     EXEC SQL                                                     05300040
053100          INCLUDE TEXTENT                                         05310040
053200     END-EXEC.                                                    05320040
053300                                                                  05330040
053400*                                                                 05340040
053500******************************************************************05350040
053600*   TSHPUNT TABLE                                                 05360040
053700******************************************************************05370040
053800     EXEC SQL                                                     05380040
053900          INCLUDE TSHPUNT                                         05390040
054000     END-EXEC.                                                    05400040
054100                                                                  05410040
054200******************************************************************05420040
054300*   SUT_INBD_CART_TRKG                                            05430040
054400******************************************************************05440040
054500     EXEC SQL                                                     05450040
054600          INCLUDE SUT00116                                        05460040
054700     END-EXEC.                                                    05470040
054800                                                                  05480040
054900******************************************************************05490040
054910*                                                                 05491040
054920******************************************************************05492040
054930     EXEC SQL                                                     05493040
054940          DECLARE BULK-CASE-CRTN-CURSOR CURSOR FOR                05494040
054950           SELECT A.PO_NBR , C.PO_LNE_NBR , E.UPC_NBR             05495040
054960                , C.INNR_PK_QTY , C.OUTR_PK_QTY , B.CURR_SPLIT_QTY05496040
054970                , (B.CURR_SPLIT_QTY * :PV-PERCENT-OF-PO-UNITS)    05497040
054980             FROM TPURCHS A                                       05498040
054990                , TALLPLN B                                       05499040
055000                , TPURITM C                                       05500040
055100                , XLT_SKU D                                       05510040
055200                , XLT_UPC E                                       05520040
055300           WHERE  A.PO_NBR         = :DK-PO-NBR                   05530040
055400             AND  A.VER_STATUS_CDE = 'A'                          05540040
055500             AND  B.PO_NBR         = A.PO_NBR                     05550040
055600             AND  B.DEST_NBR       = :DK-DC-NBR                   05560040
055700             AND  B.CURR_SPLIT_QTY > 0                            05570040
055800             AND  C.PO_NBR         = A.PO_NBR                     05580040
055900             AND  C.PO_LNE_NBR     = B.PO_LNE_NBR                 05590040
056000             AND  D.ITM_NBR        = C.ITM_NBR                    05600040
056100             AND  E.INTR_UPC_ID    = D.INTR_UPC_ID                05610040
056200             AND  E.UPC_TYP_CDE    = 'I'                          05620040
056300         ORDER BY A.PO_NBR , C.PO_LNE_NBR                         05630040
056400     END-EXEC.                                                    05640040
056500                                                                  05650040
056600     EXEC SQL                                                     05660040
056700          DECLARE PACK-CRTN-CURSOR CURSOR FOR                     05670040
056800           SELECT A.PO_NBR , C.PO_LNE_NBR , A.PO_PREPK_ID         05680040
056900                , A.PREPK_RATO_QTY , A.INNR_PK_QTY , A.OUTR_PK_QTY05690040
057000                , A.UNT_QTY , B.PREPK_UPC_NBR , B.INPK_UNT_QTY    05700040
057100                , B.OTPK_UNT_QTY , B.OTPK_ORD_QTY                 05710040
057200                , C.CURR_SPLIT_QTY , E.UPC_NBR                    05720040
057300                , (C.CURR_SPLIT_QTY * :PV-PERCENT-OF-PO-UNITS)    05730040
057400             FROM TPURITM A                                       05740040
057500                , TPOPRPK B                                       05750040
057600                , TALLPLN C                                       05760040
057700                , XLT_SKU D                                       05770040
057800                , XLT_UPC E                                       05780040
057900           WHERE  A.PO_NBR         = :DK-PO-NBR                   05790040
058000             AND  B.PO_NBR         = A.PO_NBR                     05800040
058100             AND  B.PO_PREPK_ID    = A.PO_PREPK_ID                05810040
058200             AND  B.VER_NBR        = A.VER_NBR                    05820040
058300             AND  C.PO_NBR         = A.PO_NBR                     05830040
058400             AND  C.PO_LNE_NBR     = A.PO_LNE_NBR                 05840040
058500             AND  C.DEST_NBR       = :DK-DC-NBR                   05850040
058600             AND  C.CURR_SPLIT_QTY > 0                            05860040
058700             AND  D.ITM_NBR        = A.ITM_NBR                    05870040
058800             AND  E.INTR_UPC_ID    = D.INTR_UPC_ID                05880040
058900             AND  E.UPC_TYP_CDE    = 'I'                          05890040
059000         ORDER BY A.PO_NBR , A.PO_PREPK_ID , A.PO_LNE_NBR         05900040
059100     END-EXEC.                                                    05910040
059200                                                                  05920040
059300     EXEC SQL                                                     05930040
059400          DECLARE PACK-ITEM-CURSOR CURSOR FOR                     05940040
059500           SELECT A.PO_NBR , C.UPC_NBR, A.PREPK_RATO_QTY          05950040
059600                , A.PO_LNE_NBR                                    05960040
059700             FROM TPURITM A                                       05970040
059800                , XLT_SKU B                                       05980040
059900                , XLT_UPC C                                       05990040
060000           WHERE  A.PO_NBR         = :DK-PO-NBR                   06000040
060100             AND  A.PO_PREPK_ID    = :DK-PO-PREPK-ID              06010040
060200             AND  B.ITM_NBR        = A.ITM_NBR                    06020040
060300             AND  C.INTR_UPC_ID    = B.INTR_UPC_ID                06030040
060400             AND  C.UPC_TYP_CDE    = 'I'                          06040040
060500         ORDER BY A.PO_NBR , C.UPC_NBR                            06050040
060600     END-EXEC.                                                    06060040
060700                                                                  06070040
060800     EXEC SQL                                                     06080040
060900          DECLARE PACK-BY-STORE-CURSOR CURSOR FOR                 06090040
061000           SELECT A.PO_NBR , B.DEST_NBR , B.PO_LNE_NBR            06100040
061100                , B.CURR_SPLIT_QTY , C.STR_NBR                    06110040
061200                , C.STR_DISTRO_QTY , F.UPC_NBR                    06120040
061300                , (C.STR_DISTRO_QTY * :PV-PERCENT-OF-PO-UNITS)    06130040
061400             FROM TPURCHS A                                       06140040
061500                , TALLPLN B                                       06150040
061600                , TMESTDS C                                       06160040
061700                , TPURITM D                                       06170040
061800                , XLT_SKU E                                       06180040
061900                , XLT_UPC F                                       06190040
062000           WHERE  A.VER_STATUS_CDE = 'A'                          06200040
062100             AND  A.PO_NBR         = :DK-PO-NBR                   06210040
062200             AND  B.PO_NBR         = A.PO_NBR                     06220040
062300             AND  B.DEST_NBR       = :DK-DC-NBR                   06230040
062400             AND  B.CURR_SPLIT_QTY > 0                            06240040
062500             AND  C.PO_NBR         = A.PO_NBR                     06250040
062600             AND  C.PO_LNE_NBR     = B.PO_LNE_NBR                 06260040
062700             AND  C.PLAN_NBR       = B.PLAN_NBR                   06270040
062800             AND  D.PO_NBR         = A.PO_NBR                     06280040
062900             AND  D.PO_LNE_NBR     = B.PO_LNE_NBR                 06290040
063000             AND  E.ITM_NBR        = D.ITM_NBR                    06300040
063100             AND  F.INTR_UPC_ID    = E.INTR_UPC_ID                06310040
063200             AND  F.UPC_TYP_CDE    = 'I'                          06320040
063300           ORDER BY 1, 2, 5, 3                                    06330040
063400     END-EXEC.                                                    06340040
063500                                                                  06350040
063600                                                                  06360040
063700******************************************************************06370040
063800 PROCEDURE DIVISION.                                              06380040
063900******************************************************************06390040
064000                                                                  06400040
064100 0000-PROGRAM-MAINLINE.                                           06410040
064200******************************************************************06420040
064300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     06430040
064400*      PROGRAM.                                                   06440040
064500******************************************************************06450040
064600                                                                  06460040
064700     PERFORM 1000-INITIALIZE.                                     06470040
064800                                                                  06480040
064900     IF PS-MORE-INPUT                                             06490040
065000         PERFORM 2000-PROCESS-INPUT                               06500040
065100            UNTIL PS-EOF-INPUT                                    06510040
065200     END-IF.                                                      06520040
065300                                                                  06530040
065400     PERFORM 2500-CREATE-SHIPMENT-TD1.                            06540040
065500                                                                  06550040
065600     PERFORM 9000-EOJ-ROUTINE.                                    06560040
065700                                                                  06570040
065800     STOP RUN.                                                    06580040
065900                                                                  06590040
066000 1000-INITIALIZE.                                                 06600040
066100******************************************************************06610040
066200*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    06620040
066300******************************************************************06630040
066400                                                                  06640040
066500     OPEN INPUT INPUT-FILE.                                       06650040
066600     OPEN OUTPUT OUTPUT-FILE.                                     06660040
066700     PERFORM 8000-READ-INPUT.                                     06670040
066800                                                                  06680040
066900 2000-PROCESS-INPUT.                                              06690040
067000******************************************************************06700040
067100*  PROCESS THE FILE AND COMPARE THE FIELDS                        06710040
067200******************************************************************06720040
067300                                                                  06730040
067400* DMH                                                             06740040
067500     IF  PVI-GENERATE-UPS-TRACK                                   06750040
067600         IF  PVI-PO-NBR  =  PV-PREV-UPS-PO                        06760040
067700             CONTINUE                                             06770040
067800         ELSE                                                     06780040
067900             PERFORM 2010-GET-UPS-SRCV-ACCT                       06790040
068000             PERFORM 2020-GET-UPS-SRVC-CODE                       06800040
068010             PERFORM 2030-BUILD-1ST-TRACK-NBR                     06801040
068011             MOVE PVI-PO-NBR  TO  PV-PREV-UPS-PO                  06801140
068012         END-IF                                                   06801240
068013     END-IF.                                                      06801340
068014* DMH                                                             06801440
068015                                                                  06801540
068016     IF  PVI-DC-NBR      =  PV-PREV-DC-NBR                        06801640
068017     AND PVI-TRAILER-NBR =  PV-PREV-TRAILER-NBR                   06801740
068018     AND PVI-ID-SEGMENT-STRUC-CDE =  PV-PREV-STRUCTURE-CDE        06801840
068019     AND PVI-ENT-ID               =  PV-PREV-ENT-ID               06801940
068020         MOVE ZERO            TO PV-TD1-ORDER-CRTN-COUNT          06802040
068030         MOVE PVI-DC-NBR      TO PVO-DC-NBR                       06803040
068040         MOVE PVI-TRAILER-NBR TO PVO-TRAILER-NBR                  06804040
068050         MOVE PVI-ENT-ID               TO PVO-ENT-ID              06805040
068060         MOVE PVI-ID-SEGMENT-STRUC-CDE TO PVO-STRUCTURE-CDE       06806040
068070         PERFORM 2400-PROCESS-PO-INFO                             06807040
068080     ELSE                                                         06808040
068090         IF  PV-OUTPUT-COUNTER > 0                                06809040
068100             PERFORM 2500-CREATE-SHIPMENT-TD1                     06810040
068200         END-IF                                                   06820040
068300         MOVE 20              TO PV-SEQ-NBR                       06830040
068400         MOVE ZERO            TO PV-TD1-ORDER-CRTN-COUNT          06840040
068500         MOVE ZERO            TO PV-TD1-SHIP-CRTN-COUNT           06850040
068600         MOVE PVI-DC-NBR      TO PVO-DC-NBR                       06860040
068700         MOVE PVI-TRAILER-NBR TO PVO-TRAILER-NBR                  06870040
068800         MOVE PVI-ENT-ID               TO PVO-ENT-ID              06880040
068900         MOVE PVI-ID-SEGMENT-STRUC-CDE TO PVO-STRUCTURE-CDE       06890040
069000         PERFORM 2400-PROCESS-PO-INFO                             06900040
069100         MOVE PVI-DC-NBR      TO PV-PREV-DC-NBR                   06910040
069200         MOVE PVI-TRAILER-NBR TO PV-PREV-TRAILER-NBR              06920040
069300         MOVE PVI-ID-SEGMENT-STRUC-CDE TO PV-PREV-STRUCTURE-CDE   06930040
069400         MOVE PVI-ENT-ID               TO PV-PREV-ENT-ID          06940040
069500     END-IF.                                                      06950040
069600                                                                  06960040
069700     PERFORM 8000-READ-INPUT.                                     06970040
069800                                                                  06980040
069900                                                                  06990040
070000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07000040
070100* GET NEXT UPS SERVICE ACCOUNT NUMBER                             07010040
070200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07020040
070300 2010-GET-UPS-SRCV-ACCT.                                          07030040
070400                                                                  07040040
070500     SET  PT-SRVC-IDX UP BY +1.                                   07050040
070600     IF  PT-SRVC-IDX  >  PC-TWO                                   07060040
070700         SET  PT-SRVC-IDX  TO  PC-ONE                             07070040
070800     END-IF.                                                      07080040
070900                                                                  07090040
071000     MOVE  PT-UPS-SRVC-ACCT(PT-SRVC-IDX)  TO PV-UPS-SRVC-ACCT.    07100040
071010     DISPLAY 'UPS-SRVC-ACCT: ' PV-UPS-SRVC-ACCT.                  07101040
071020                                                                  07102040
071030                                                                  07103040
071040* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07104040
071050* GET NEXT UPS SERVICE CODE                                       07105040
071060* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07106040
071070 2020-GET-UPS-SRVC-CODE.                                          07107040
071080                                                                  07108040
071090     SET PT-UPS-IDX UP BY +1                                      07109040
071100     IF  PT-UPS-IDX  >  PC-TWENTY-TWO                             07110040
071101         SET  PT-UPS-IDX  TO  PC-ONE                              07110140
071102     END-IF.                                                      07110240
071103                                                                  07110340
071104     MOVE  PT-UPS-SERVICE-CODE(PT-UPS-IDX) TO PV-UPS-SRVC-CODE.   07110440
071105                                                                  07110540
071106                                                                  07110640
071107* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07110740
071108* BUILD FIRST CARRIER CARTON TRACKING RECORD FOR THE PO           07110840
071109* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07110940
071110 2030-BUILD-1ST-TRACK-NBR.                                        07111040
071111                                                                  07111140
071112     PERFORM 2040-GET-RANDOM-NBR.                                 07111240
071113                                                                  07111340
071114     MOVE '1Z'                TO  PV-UPS-TRACK-01-02.             07111440
071115     MOVE PV-UPS-SRVC-ACCT    TO  PV-UPS-TRACK-03-08.             07111540
071116     MOVE PV-UPS-SRVC-CODE    TO  PV-UPS-TRACK-09-10.             07111640
071117     MOVE PV-RANDOM-NBR       TO  PV-UPS-TRACK-11-18.             07111740
071118                                                                  07111840
071119     SET  PS-UNIQUE-TRACK-NO  TO  TRUE.                           07111940
071120     PERFORM 2050-CHECK-FOR-DUP-TRACK                             07112040
071130       UNTIL PS-UNIQUE-TRACK.                                     07113040
071131                                                                  07113140
071132                                                                  07113240
071133* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07113340
071134* GET RANDOM NUMBER FOR CARRIER TRACKING NUMBER                   07113440
071135* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07113540
071136 2040-GET-RANDOM-NBR.                                             07113640
071137                                                                  07113740
071138     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     07113840
071139     CALL PC-RANDOM-PGM                                           07113940
071140          USING DP902-RANDNBR-ROUTINE-FIELDS.                     07114040
071141                                                                  07114140
071142     IF DP902-SUCCESSFUL                                          07114240
071143         MOVE DP902-RANDOM-NUMBER   TO PV-RANDOM-NBR              07114340
071144     ELSE                                                         07114440
071145         MOVE 'RANDOM NUMBER GENERATOR DKPUT902'                  07114540
071146                                    TO PV-DB2-OPERATION-MESSAGE-1 07114640
071147         STRING ' TMST:'               DP902-TIMESTAMP            07114740
071148                ' RETURN CODE:'        DP902-RETURN-CODE          07114840
071149                                       DELIMITED BY SIZE          07114940
071150                                INTO PV-DB2-OPERATION-MESSAGE-2   07115040
071151         PERFORM 9999-SQL-ABEND                                   07115140
071152     END-IF.                                                      07115240
071153                                                                  07115340
071154                                                                  07115440
071155* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07115540
071156* CHECK UNIQUE UPS CARTON TRACKING NUMBER                         07115640
071157* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07115740
071158 2050-CHECK-FOR-DUP-TRACK.                                        07115840
071159                                                                  07115940
071160      MOVE '2050-CHECK-FOR-DUP-TRACK'     TO PV-ABEND-PARAGRAPH.  07116040
071170                                                                  07117040
071180      EXEC SQL                                                    07118040
071181          SELECT TRKG_NBR                                         07118140
071182            INTO :SUT00116-TRKG-NBR                               07118240
071183            FROM SUT_INBD_CART_TRKG                               07118340
071184           WHERE  TRKG_NBR         = :PV-UPS-TRACK-NUMBER         07118440
071185            WITH UR                                               07118540
071186      END-EXEC.                                                   07118640
071187                                                                  07118740
071188       EVALUATE TRUE                                              07118840
071189            WHEN SQLCODE = ZERO                                   07118940
071190            WHEN SQLCODE = -811                                   07119040
071200                 SET PS-UNIQUE-TRACK-NO    TO TRUE                07120040
071201                 ADD  100  TO  PV-UPS-TRACK-11-18                 07120140
071202            WHEN SQLCODE = +100                                   07120240
071203                 SET PS-UNIQUE-TRACK       TO TRUE                07120340
071204            WHEN OTHER                                            07120440
071205                MOVE  SQLCODE          TO  PV-SQLCODE             07120540
071206                MOVE 'SELECT UPS CARTON TRACKING TABLE    '       07120640
071207                                     TO PV-DB2-OPERATION-MESSAGE-107120740
071208                STRING ' PO:'           PVI-PO-NBR                07120840
071209                       ' TRACK:'        PV-UPS-TRACK-NUMBER       07120940
071210                                        DELIMITED BY SIZE         07121040
071220                                   INTO PV-DB2-OPERATION-MESSAGE-207122040
071221                MOVE 'SUT_INBD_CART_TRKG' TO PV-DB2-TABLE-NAME-1  07122140
071222                PERFORM 9999-SQL-ABEND                            07122240
071223        END-EVALUATE.                                             07122340
071224                                                                  07122440
071225                                                                  07122540
071226* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07122640
071227*                                                                 07122740
071228* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07122840
071229 2400-PROCESS-PO-INFO.                                            07122940
071230                                                                  07123040
071240     PERFORM 6200-GET-VENDOR-INFO.                                07124040
071250                                                                  07125040
071260     IF  PURCHS-PKGNG-CDE = 'I'                                   07126040
071270     OR  PURCHS-PKGNG-CDE = 'M'                                   07127040
071280         IF  PVI-BUILD-AS-PBS-ASN                                 07128040
071290             PERFORM 4800-BUILD-PBS                               07129040
071300         ELSE                                                     07130040
071400             IF  PVI-BUILD-PACK-ONLY                              07140040
071500                 PERFORM 3200-BUILD-PACK-ONLY                     07150040
071600             ELSE                                                 07160040
071700                 IF  PVI-BUILD-COMP-ONLY                          07170040
071800                     PERFORM 3600-BUILD-COMP-ONLY                 07180040
071900                 ELSE                                             07190040
072000                     PERFORM 4000-BUILD-PACK-AND-COMP             07200040
072100                 END-IF                                           07210040
072200             END-IF                                               07220040
072300         END-IF                                                   07230040
072400     ELSE                                                         07240040
072500         IF  PURCHS-PKGNG-CDE = 'B'                               07250040
072600         OR  PURCHS-PKGNG-CDE = 'C'                               07260040
072700             IF  PVI-BUILD-AS-PBS-ASN                             07270040
072800                 PERFORM 4800-BUILD-PBS                           07280040
072900             ELSE                                                 07290040
073000                 IF  PVI-ID-SEG-STRUC-PICK-PACK                   07300040
073100                     PERFORM 4600-BUILD-BULK-CASE-PICKPACK        07310040
073200                 ELSE                                             07320040
073300                     PERFORM 4400-BUILD-BULK-CASE-STANDARD        07330040
073400                 END-IF                                           07340040
073500             END-IF                                               07350040
073600         ELSE                                                     07360040
073700             PERFORM 4800-BUILD-PBS                               07370040
073800         END-IF                                                   07380040
073900     END-IF.                                                      07390040
074000                                                                  07400040
074100                                                                  07410040
074200 2410-GENERATE-HL-ORDER-SEGMENT.                                  07420040
074300                                                                  07430040
074400* CREATE 'HL ' ORDER SEGMENT                                      07440040
074500     MOVE 'HL '               TO SN005-HL-ID.                     07450040
074600     MOVE SPACES              TO SN005-HL01-ID-NBR.               07460040
074700     MOVE SPACES              TO SN005-HL02-PARENT-ID.            07470040
074800     MOVE PV-HL03-LVL-CDE     TO SN005-HL03-LVL-CDE.              07480040
074900     MOVE SPACES              TO SN005-HL04-CHILD-CDE.            07490040
075000     MOVE SPACES              TO SN005-HL-FILLER.                 07500040
075100     MOVE SN005-HL-SEGMENT    TO PVO-ASN-DATA-RECORD.             07510040
075200     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     07520040
075300     ADD  +1                  TO PV-SEQ-NBR.                      07530040
075400     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07540040
075500                                                                  07550040
075600 2420-GENERATE-PRF-SEGMENT.                                       07560040
075700                                                                  07570040
075800* CREATE 'PRF' SEGMENT                                            07580040
075900     MOVE 'PRF'               TO SN005-PRF-ID.                    07590040
076000     MOVE PVI-PO-NBR          TO PV-PO-NBR-8.                     07600040
076100     IF PV-PO-NBR-1 = 0                                           07610040
076200        MOVE PV-PO-NBR-7      TO SN005-PRF01-PO-NBR               07620040
076300     ELSE                                                         07630040
076400        MOVE PV-PO-NBR-8      TO SN005-PRF01-PO-NBR               07640040
076500     END-IF.                                                      07650040
076600     MOVE SPACES              TO SN005-PRF03-PO-SEQ-NBR.          07660040
076700     MOVE ZEROS               TO SN005-PRF04-PO-DTE.              07670040
076800     MOVE SPACES              TO SN005-PRF-FILLER.                07680040
076900     MOVE SN005-PRF-SEGMENT   TO PVO-ASN-DATA-RECORD.             07690040
077000     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     07700040
077100     ADD  +1                  TO PV-SEQ-NBR.                      07710040
077200     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07720040
077300                                                                  07730040
077400 2430-GENERATE-REF-ORD-SEGMENT.                                   07740040
077500                                                                  07750040
077600* CREATE 'REF' ORDER SEGMENT                                      07760040
077700     MOVE 'REF'               TO SN005-REF-ID.                    07770040
077800     MOVE 'DP'                TO SN005-REF01-NBR-QUAL-CDE.        07780040
077900     MOVE PURCHS-DEPT-NBR     TO SN005-REF02-NBR.                 07790040
078000     MOVE SPACES              TO SN005-REF-FILLER.                07800040
078100     MOVE SN005-REF-SEGMENT   TO PVO-ASN-DATA-RECORD.             07810040
078200     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     07820040
078300     ADD  +1                  TO PV-SEQ-NBR.                      07830040
078400     PERFORM 8400-WRITE-OUTPUT-RECORD.                            07840040
078500                                                                  07850040
078600 2440-GENERATE-N1-ORDER-SEGMENT.                                  07860040
078700                                                                  07870040
078800* CREATE 'N1 ' ORDER SEGMENT                                      07880040
078900     MOVE 'N1 '               TO SN005-N1-ID.                     07890040
079000     MOVE 'BY'                TO SN005-N101-ID-CDE.               07900040
079100     MOVE SPACES              TO SN005-N102-CUST-NME.             07910040
079200     MOVE '92'                TO SN005-N103-NME-ID-QUAL-CDE.      07920040
079300     MOVE PV-HOLD-N1-SHIP-NBR TO PV-SHIP-TO-DC-NBR.               07930040
079400     MOVE SPACES              TO PV-SHIP-TO-DC-FILLER.            07940040
079500     MOVE PV-SHIP-TO-DC       TO SN005-N104-NME-ID-CDE.           07950040
079600     MOVE SPACES              TO SN005-N1-FILLER.                 07960040
079700     MOVE SN005-N1-SEGMENT    TO PVO-ASN-DATA-RECORD.             07970040
079800     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     07980040
079900     ADD  +1                  TO PV-SEQ-NBR.                      07990040
080000     PERFORM 8400-WRITE-OUTPUT-RECORD.                            08000040
080100                                                                  08010040
080200 2500-CREATE-SHIPMENT-TD1.                                        08020040
080300                                                                  08030040
080400* BUILD SHIPMENT LEVEL TD1                                        08040040
080500     MOVE 'TD1'               TO SN005-TD1-ID.                    08050040
080600     MOVE 'CTN25'             TO SN005-TD101-PKG-CDE.             08060040
080700     MOVE PV-TD1-SHIP-CRTN-COUNT                                  08070040
080800                              TO SN005-TD102-SHIPT-QTY.           08080040
080900     MOVE 'G'                 TO SN005-TD106-WGHT-QUAL-CDE.       08090040
081000     COMPUTE PV-TOTAL-CARTON-SHIP-LBS =                           08100040
081100             PV-TD1-SHIP-CRTN-COUNT * 15.                         08110040
081200     MOVE PV-TOTAL-CARTON-SHIP-LBS                                08120040
081300                              TO SN005-TD107-WGHT-MSMT.           08130040
081400     MOVE 'LB'                TO SN005-TD108-UM-CDE.              08140040
081500     MOVE SPACES              TO SN005-TD1-FILLER.                08150040
081600     MOVE SN005-TD1-SEGMENT   TO PVO-ASN-DATA-RECORD.             08160040
081700     MOVE 3                   TO PVO-SEQ-NBR.                     08170040
081800     PERFORM 8400-WRITE-OUTPUT-RECORD.                            08180040
081900                                                                  08190040
082000 3200-BUILD-PACK-ONLY.                                            08200040
082100                                                                  08210040
082200     MOVE 'O ' TO PV-HL03-LVL-CDE.                                08220040
082300     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      08230040
082400     PERFORM 2420-GENERATE-PRF-SEGMENT.                           08240040
082500                                                                  08250040
082600* ORDER LEVEL TD1 SEGMENT WILL BE CREATED WHEN PO FOR DC HAS      08260040
082700* BEEN PROCESSED BY NEEDS TO FIT INTO THE DATA AT THIS POINT      08270040
082800* THUS SAVING THE SEQUENCE NUMBER FOR USE LATER WHEN THE DATA     08280040
082900* IS WRITTEN.                                                     08290040
083000     MOVE PV-SEQ-NBR TO PV-HOLD-TD1-ORDER-SEQ-NBR.                08300040
083100     ADD  +1         TO PV-SEQ-NBR.                               08310040
083200                                                                  08320040
083300     PERFORM 2430-GENERATE-REF-ORD-SEGMENT.                       08330040
083400     MOVE PVI-DC-NBR TO PV-HOLD-N1-SHIP-NBR.                      08340040
083500     PERFORM 2440-GENERATE-N1-ORDER-SEGMENT.                      08350040
083600                                                                  08360040
083700     MOVE PVI-PO-NBR                TO DK-PO-NBR.                 08370040
083800     MOVE PVI-DC-NBR                TO DK-DC-NBR.                 08380040
083900     COMPUTE PV-PERCENT-OF-PO-UNITS ROUNDED =                     08390040
084000             PVI-PERCENT-OF-PO-UNITS / 100.                       08400040
084100     SET PS-NOT-EOF-CURSOR TO TRUE.                               08410040
084200     MOVE ZEROS            TO PV-PREV-PO-PREPK-ID.                08420040
084300     PERFORM 3210-OPEN-PK-UPC-ONLY-CURSOR.                        08430040
084400     PERFORM 3220-FETCH-PK-UPC-ONLY-CURSOR                        08440040
084500       UNTIL PS-EOF-CURSOR.                                       08450040
084600     PERFORM 3280-CLOSE-PK-UPC-ONLY-CURSOR.                       08460040
084700                                                                  08470040
084800* BUILD ORDER LEVEL TD1                                           08480040
084900     MOVE 'TD1'               TO SN005-TD1-ID.                    08490040
085000     MOVE 'CTN25'             TO SN005-TD101-PKG-CDE.             08500040
085100     MOVE PV-TD1-ORDER-CRTN-COUNT                                 08510040
085200                              TO SN005-TD102-SHIPT-QTY.           08520040
085300     MOVE SPACES              TO SN005-TD106-WGHT-QUAL-CDE.       08530040
085400     MOVE ZEROS               TO SN005-TD107-WGHT-MSMT.           08540040
085500     MOVE SPACES              TO SN005-TD108-UM-CDE.              08550040
085600     MOVE SPACES              TO SN005-TD1-FILLER.                08560040
085700     MOVE SN005-TD1-SEGMENT   TO PVO-ASN-DATA-RECORD.             08570040
085800     MOVE PV-HOLD-TD1-ORDER-SEQ-NBR                               08580040
085900                              TO PVO-SEQ-NBR.                     08590040
086000     PERFORM 8400-WRITE-OUTPUT-RECORD.                            08600040
086100                                                                  08610040
086200 3210-OPEN-PK-UPC-ONLY-CURSOR.                                    08620040
086300                                                                  08630040
086400     MOVE '3210-OPEN-PK-UPC-ONLY-CURSOR' TO PV-ABEND-PARAGRAPH.   08640040
086500                                                                  08650040
086600     EXEC SQL                                                     08660040
086700          OPEN PACK-CRTN-CURSOR                                   08670040
086800     END-EXEC.                                                    08680040
086900                                                                  08690040
087000     EVALUATE TRUE                                                08700040
087100         WHEN SQLCODE = 0                                         08710040
087200             CONTINUE                                             08720040
087300         WHEN SQLWARN0 NOT = SPACES                               08730040
087400         WHEN SQLCODE < ZERO                                      08740040
087500         WHEN SQLCODE > ZERO                                      08750040
087600             MOVE '3210-OPEN-PK-UPC-ONLY-CURSOR'                  08760040
087700                             TO PV-PARAGRAPH-NAME                 08770040
087800             MOVE 'OPEN THE PREPACK CURSOR      '                 08780040
087900                             TO PV-DB2-OPERATION-ATTEMPTED        08790040
088000             PERFORM 9999-SQL-ABEND                               08800040
088100     END-EVALUATE.                                                08810040
088200                                                                  08820040
088300                                                                  08830040
088400 3220-FETCH-PK-UPC-ONLY-CURSOR.                                   08840040
088500                                                                  08850040
088600     MOVE '3220-FETCH-PK-UPC-ONLY-CURSOR' TO PV-ABEND-PARAGRAPH.  08860040
088700                                                                  08870040
088800     EXEC SQL                                                     08880040
088900          FETCH PACK-CRTN-CURSOR                                  08890040
089000          INTO  :PURITM-PO-NBR                                    08900040
089100              , :PURITM-PO-LNE-NBR                                08910040
089200              , :PURITM-PO-PREPK-ID                               08920040
089300              , :PURITM-PREPK-RATO-QTY                            08930040
089400              , :PURITM-INNR-PK-QTY                               08940040
089500              , :PURITM-OUTR-PK-QTY                               08950040
089600              , :PURITM-UNT-QTY                                   08960040
089700              , :POPRPK-PREPK-UPC-NBR                             08970040
089800              , :POPRPK-INPK-UNT-QTY                              08980040
089900              , :POPRPK-OTPK-UNT-QTY                              08990040
090000              , :POPRPK-OTPK-ORD-QTY                              09000040
090100              , :ALLPLN-CURR-SPLIT-QTY                            09010040
090200              , :XLT00006-UPC-NBR                                 09020040
090300              , :PV-CURR-SPLIT-PCT-QTY                            09030040
090400     END-EXEC.                                                    09040040
090500                                                                  09050040
090600     EVALUATE TRUE                                                09060040
090700       WHEN SQLCODE = ZEROS                                       09070040
090800            PERFORM 3230-PROCESS-FETCH                            09080040
090900       WHEN SQLCODE = +100                                        09090040
091000            SET PS-EOF-CURSOR  TO TRUE                            09100040
091100       WHEN SQLWARN0 NOT = SPACES                                 09110040
091200       WHEN SQLCODE < ZERO                                        09120040
091300       WHEN SQLCODE > ZERO                                        09130040
091400           MOVE '3220-FETCH-PK-UPC-ONLY-CURSOR'                   09140040
091500                               TO PV-PARAGRAPH-NAME               09150040
091600           MOVE 'FETCH THE PREPACK CURSOR     '                   09160040
091700                               TO PV-DB2-OPERATION-ATTEMPTED      09170040
091800           PERFORM 9999-SQL-ABEND                                 09180040
091900     END-EVALUATE.                                                09190040
092000                                                                  09200040
092100 3230-PROCESS-FETCH.                                              09210040
092200                                                                  09220040
092300     IF  PURITM-PO-PREPK-ID   = PV-PREV-PO-PREPK-ID               09230040
092400         NEXT SENTENCE                                            09240040
092500     ELSE                                                         09250040
092600         MOVE PURITM-PO-PREPK-ID TO PV-PREV-PO-PREPK-ID           09260040
092700         PERFORM 3240-CALC-VALUES                                 09270040
092800         PERFORM 3250-GENERATE-CARTON-DATA                        09280040
092900                 VARYING PV-LOOP-COUNT FROM 1 BY 1                09290040
093000                   UNTIL PV-LOOP-COUNT > PV-CARTON-QTY            09300040
093100     END-IF.                                                      09310040
093200                                                                  09320040
093300 3240-CALC-VALUES.                                                09330040
093400                                                                  09340040
093500     IF  POPRPK-OTPK-UNT-QTY = 0                                  09350040
093600     OR  POPRPK-OTPK-UNT-QTY = 1                                  09360040
093700         MOVE 1 TO PV-PACKS-PER-CARTON                            09370040
093800     ELSE                                                         09380040
093900         COMPUTE PV-PACKS-PER-CARTON =                            09390040
094000                 POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY        09400040
094100     END-IF.                                                      09410040
094200                                                                  09420040
094300     COMPUTE PV-PACKS-TO-RECEIVE ROUNDED =                        09430040
094400             PV-CURR-SPLIT-PCT-QTY / PURITM-PREPK-RATO-QTY.       09440040
094500                                                                  09450040
094600     IF  PV-PACKS-TO-RECEIVE = 0                                  09460040
094700         MOVE 1 TO PV-PACKS-TO-RECEIVE.                           09470040
094800                                                                  09480040
094900     IF  PV-PACKS-PER-CARTON = 1                                  09490040
095000         MOVE PV-PACKS-TO-RECEIVE TO PV-CARTON-QTY                09500040
095100     ELSE                                                         09510040
095200         COMPUTE PV-CARTON-QTY ROUNDED =                          09520040
095300                 PV-PACKS-TO-RECEIVE / PV-PACKS-PER-CARTON        09530040
095400         IF  PV-CARTON-QTY = 0                                    09540040
095500             MOVE 1 TO PV-CARTON-QTY                              09550040
095600         END-IF                                                   09560040
095700     END-IF.                                                      09570040
095800                                                                  09580040
095900                                                                  09590040
096000 3250-GENERATE-CARTON-DATA.                                       09600040
096100                                                                  09610040
096200     MOVE 'P ' TO PV-HL03-LVL-CDE.                                09620040
096300     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      09630040
096400                                                                  09640040
096500     IF  PV-UCC128-NUMBER = ZERO                                  09650040
096600         PERFORM 4450-GET-MAX-UCC128                              09660040
096700     END-IF.                                                      09670040
096800                                                                  09680040
096900* DMH                                                             09690040
097000     IF  PVI-GENERATE-UPS-TRACK                                   09700040
097100         IF  PV-UPS-TRACK-11-18  > 0                              09710040
097200             ADD  1  TO  PV-UPS-TRACK-11-18                       09720040
097300             SET  PS-UNIQUE-TRACK-NO  TO  TRUE                    09730040
097400             PERFORM 2050-CHECK-FOR-DUP-TRACK                     09740040
097401                     UNTIL PS-UNIQUE-TRACK                        09740140
097402             DISPLAY PV-UPS-TRACK-NUMBER                          09740240
097403         END-IF                                                   09740340
097404     END-IF.                                                      09740440
097405* DMH                                                             09740540
097406                                                                  09740640
097407* CREATE 'MAN' SEGMENT                                            09740740
097408     MOVE 'MAN'               TO SN005-MAN-ID.                    09740840
097409     MOVE 'GM'                TO SN005-MAN01-NBR-QUAL-CDE.        09740940
097410     ADD  +1                  TO PV-UCC128-NUMBER.                09741040
097420     MOVE PV-UCC128-NUMBER    TO PV-UCC128-18.                    09742040
097430     MOVE PV-UCC128-CHAR      TO SN005-MAN02-NBR.                 09743040
097440                                                                  09744040
097450* DMH                                                             09745040
097460     IF  PVI-GENERATE-UPS-TRACK                                   09746040
097470         MOVE 'CP'                TO SN005-MAN04-NBR-QUAL-CDE     09747040
097480         MOVE PV-UPS-TRACK-NUMBER TO SN005-MAN05-NBR              09748040
097490     ELSE                                                         09749040
097500         MOVE SPACES              TO SN005-MAN04-NBR-QUAL-CDE     09750040
097600                                     SN005-MAN05-NBR              09760040
097700     END-IF.                                                      09770040
097800* DMH                                                             09780040
097900                                                                  09790040
098000     MOVE SPACES              TO SN005-MAN-FILLER.                09800040
098100     MOVE SN005-MAN-SEGMENT   TO PVO-ASN-DATA-RECORD.             09810040
098200     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     09820040
098300     ADD  +1                  TO PV-SEQ-NBR                       09830040
098400                                 PV-TD1-ORDER-CRTN-COUNT          09840040
098500                                 PV-TD1-SHIP-CRTN-COUNT.          09850040
098600     PERFORM 8400-WRITE-OUTPUT-RECORD.                            09860040
098700                                                                  09870040
098800     MOVE 'I ' TO PV-HL03-LVL-CDE.                                09880040
098900     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      09890040
099000                                                                  09900040
099100* CREATE 'LIN' SEGMENT                                            09910040
099200     MOVE SPACES               TO SN005-LIN-SEGMENT.              09920040
099300     MOVE 'LIN'                TO SN005-LIN-ID.                   09930040
099400     MOVE SPACES               TO SN005-LIN01-ID-CDE.             09940040
099500     MOVE 'UP'                TO SN005-LIN02-PROD-ID-QUAL-CDE (1).09950040
099600     MOVE POPRPK-PREPK-UPC-NBR TO PV-UPC-NBR.                     09960040
099700     MOVE PV-UPC-NBR          TO SN005-LIN03-PROD-ID (1).         09970040
099800     MOVE SN005-LIN-SEGMENT   TO PVO-ASN-DATA-RECORD.             09980040
099900     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     09990040
100000     ADD  +1                  TO PV-SEQ-NBR.                      10000040
100100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            10010040
100200                                                                  10020040
100300* CREATE 'SN1' SEGMENT                                            10030040
100400     MOVE 'SN1'               TO SN005-SN1-ID.                    10040040
100500     MOVE SPACES              TO SN005-SN101-ID-CDE.              10050040
100600     MOVE PV-PACKS-PER-CARTON TO SN005-SN102-SHIP-QTY.            10060040
100700     MOVE 'AS'                TO SN005-SN103-SHIP-UM-CDE.         10070040
100800     MOVE ZEROS               TO SN005-SN104-SHIPT-DTE-QTY.       10080040
100900     MOVE ZEROS               TO SN005-SN105-ORD-QTY.             10090040
101000     MOVE SPACES              TO SN005-SN106-ORD-UM-CDE.          10100040
101100     MOVE SPACES              TO SN005-SN1-FILLER.                10110040
101200     MOVE SN005-SN1-SEGMENT   TO PVO-ASN-DATA-RECORD.             10120040
101300     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     10130040
101400     ADD  +1                  TO PV-SEQ-NBR.                      10140040
101500     PERFORM 8400-WRITE-OUTPUT-RECORD.                            10150040
101600                                                                  10160040
101700 3280-CLOSE-PK-UPC-ONLY-CURSOR.                                   10170040
101800                                                                  10180040
101900     MOVE '3280-CLOSE-PK-UPC-ONLY-CURSOR' TO PV-ABEND-PARAGRAPH.  10190040
102000                                                                  10200040
102100     EXEC SQL                                                     10210040
102200         CLOSE PACK-CRTN-CURSOR                                   10220040
102300     END-EXEC.                                                    10230040
102400                                                                  10240040
102500     EVALUATE TRUE                                                10250040
102600         WHEN SQLCODE = ZERO                                      10260040
102700         WHEN SQLCODE = -904                                      10270040
102800         WHEN SQLCODE = -911                                      10280040
102900              CONTINUE                                            10290040
103000         WHEN SQLWARN0 NOT = SPACES                               10300040
103100         WHEN SQLCODE < ZERO                                      10310040
103200         WHEN SQLCODE > ZERO                                      10320040
103300              MOVE '3280-CLOSE-PK-UPC-ONLY-CURSOR'                10330040
103400                              TO PV-PARAGRAPH-NAME                10340040
103500              MOVE 'CLOSE THE PREPACK CURSOR       '              10350040
103600                              TO PV-DB2-OPERATION-ATTEMPTED       10360040
103700              PERFORM 9999-SQL-ABEND                              10370040
103800     END-EVALUATE.                                                10380040
103900                                                                  10390040
104000                                                                  10400040
104100 3600-BUILD-COMP-ONLY.                                            10410040
104200                                                                  10420040
104300     MOVE 'O ' TO PV-HL03-LVL-CDE.                                10430040
104400     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      10440040
104500     PERFORM 2420-GENERATE-PRF-SEGMENT.                           10450040
104600                                                                  10460040
104700* ORDER LEVEL TD1 SEGMENT WILL BE CREATED WHEN PO FOR DC HAS      10470040
104800* BEEN PROCESSED BY NEEDS TO FIT INTO THE DATA AT THIS POINT      10480040
104900* THUS SAVING THE SEQUENCE NUMBER FOR USE LATER WHEN THE DATA     10490040
105000* IS WRITTEN.                                                     10500040
105100     MOVE PV-SEQ-NBR TO PV-HOLD-TD1-ORDER-SEQ-NBR.                10510040
105200     ADD  +1         TO PV-SEQ-NBR.                               10520040
105300                                                                  10530040
105400     PERFORM 2430-GENERATE-REF-ORD-SEGMENT.                       10540040
105500     MOVE PVI-DC-NBR TO PV-HOLD-N1-SHIP-NBR.                      10550040
105600     PERFORM 2440-GENERATE-N1-ORDER-SEGMENT.                      10560040
105700                                                                  10570040
105800     MOVE PVI-PO-NBR                TO DK-PO-NBR.                 10580040
105900     MOVE PVI-DC-NBR                TO DK-DC-NBR.                 10590040
106000     COMPUTE PV-PERCENT-OF-PO-UNITS ROUNDED =                     10600040
106100             PVI-PERCENT-OF-PO-UNITS / 100.                       10610040
106200     SET PS-NOT-EOF-CURSOR TO TRUE.                               10620040
106300     MOVE ZEROS            TO PV-PREV-PO-PREPK-ID.                10630040
106400     PERFORM 3610-OPEN-PK-COMP-CURSOR.                            10640040
106500     PERFORM 3620-FETCH-PK-COMP-CURSOR                            10650040
106600       UNTIL PS-EOF-CURSOR.                                       10660040
106700     PERFORM 3720-CLOSE-PK-COMP-CURSOR.                           10670040
106800                                                                  10680040
106900* BUILD ORDER LEVEL TD1                                           10690040
107000     MOVE 'TD1'               TO SN005-TD1-ID.                    10700040
107100     MOVE 'CTN25'             TO SN005-TD101-PKG-CDE.             10710040
107200     MOVE PV-TD1-ORDER-CRTN-COUNT                                 10720040
107300                              TO SN005-TD102-SHIPT-QTY.           10730040
107400     MOVE SPACES              TO SN005-TD106-WGHT-QUAL-CDE.       10740040
107500     MOVE ZEROS               TO SN005-TD107-WGHT-MSMT.           10750040
107600     MOVE SPACES              TO SN005-TD108-UM-CDE.              10760040
107700     MOVE SPACES              TO SN005-TD1-FILLER.                10770040
107800     MOVE SN005-TD1-SEGMENT   TO PVO-ASN-DATA-RECORD.             10780040
107900     MOVE PV-HOLD-TD1-ORDER-SEQ-NBR                               10790040
108000                              TO PVO-SEQ-NBR.                     10800040
108100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            10810040
108200                                                                  10820040
108300 3610-OPEN-PK-COMP-CURSOR.                                        10830040
108400                                                                  10840040
108500     MOVE '3610-OPEN-PK-COMP-CURSOR' TO PV-ABEND-PARAGRAPH.       10850040
108600                                                                  10860040
108700     EXEC SQL                                                     10870040
108800          OPEN PACK-CRTN-CURSOR                                   10880040
108900     END-EXEC.                                                    10890040
109000                                                                  10900040
109100     EVALUATE TRUE                                                10910040
109200         WHEN SQLCODE = 0                                         10920040
109300             CONTINUE                                             10930040
109400         WHEN SQLWARN0 NOT = SPACES                               10940040
109500         WHEN SQLCODE < ZERO                                      10950040
109600         WHEN SQLCODE > ZERO                                      10960040
109700             MOVE '3610-OPEN-PK-COMP-CURSOR    '                  10970040
109800                             TO PV-PARAGRAPH-NAME                 10980040
109900             MOVE 'OPEN THE PREPACK CURSOR      '                 10990040
110000                             TO PV-DB2-OPERATION-ATTEMPTED        11000040
110100             PERFORM 9999-SQL-ABEND                               11010040
110200     END-EVALUATE.                                                11020040
110300                                                                  11030040
110400                                                                  11040040
110500 3620-FETCH-PK-COMP-CURSOR.                                       11050040
110600                                                                  11060040
110700     MOVE '3620-FETCH-PK-COMP-CURSOR    ' TO PV-ABEND-PARAGRAPH.  11070040
110800                                                                  11080040
110900     EXEC SQL                                                     11090040
111000          FETCH PACK-CRTN-CURSOR                                  11100040
111100          INTO  :PURITM-PO-NBR                                    11110040
111200              , :PURITM-PO-LNE-NBR                                11120040
111300              , :PURITM-PO-PREPK-ID                               11130040
111400              , :PURITM-PREPK-RATO-QTY                            11140040
111500              , :PURITM-INNR-PK-QTY                               11150040
111600              , :PURITM-OUTR-PK-QTY                               11160040
111700              , :PURITM-UNT-QTY                                   11170040
111800              , :POPRPK-PREPK-UPC-NBR                             11180040
111900              , :POPRPK-INPK-UNT-QTY                              11190040
112000              , :POPRPK-OTPK-UNT-QTY                              11200040
112100              , :POPRPK-OTPK-ORD-QTY                              11210040
112200              , :ALLPLN-CURR-SPLIT-QTY                            11220040
112300              , :XLT00006-UPC-NBR                                 11230040
112400              , :PV-CURR-SPLIT-PCT-QTY                            11240040
112500     END-EXEC.                                                    11250040
112600                                                                  11260040
112700     EVALUATE TRUE                                                11270040
112800       WHEN SQLCODE = ZEROS                                       11280040
112900            PERFORM 3630-PROCESS-FETCH                            11290040
113000       WHEN SQLCODE = +100                                        11300040
113100            SET PS-EOF-CURSOR  TO TRUE                            11310040
113200       WHEN SQLWARN0 NOT = SPACES                                 11320040
113300       WHEN SQLCODE < ZERO                                        11330040
113400       WHEN SQLCODE > ZERO                                        11340040
113500           MOVE '3620-FETCH-PK-COMP-CURSOR    '                   11350040
113600                               TO PV-PARAGRAPH-NAME               11360040
113700           MOVE 'FETCH THE PREPACK CURSOR     '                   11370040
113800                               TO PV-DB2-OPERATION-ATTEMPTED      11380040
113900           PERFORM 9999-SQL-ABEND                                 11390040
114000     END-EVALUATE.                                                11400040
114100                                                                  11410040
114200 3630-PROCESS-FETCH.                                              11420040
114300                                                                  11430040
114400     IF  PURITM-PO-PREPK-ID   = PV-PREV-PO-PREPK-ID               11440040
114500         NEXT SENTENCE                                            11450040
114600     ELSE                                                         11460040
114700         MOVE PURITM-PO-PREPK-ID TO PV-PREV-PO-PREPK-ID           11470040
114800         PERFORM 3640-CALC-VALUES                                 11480040
114900         PERFORM 3650-GENERATE-CARTON-DATA                        11490040
115000                 VARYING PV-LOOP-COUNT FROM 1 BY 1                11500040
115100                   UNTIL PV-LOOP-COUNT > PV-CARTON-QTY            11510040
115200     END-IF.                                                      11520040
115300                                                                  11530040
115400 3640-CALC-VALUES.                                                11540040
115500                                                                  11550040
115600     IF  POPRPK-OTPK-UNT-QTY = 0                                  11560040
115700     OR  POPRPK-OTPK-UNT-QTY = 1                                  11570040
115800         MOVE 1 TO PV-PACKS-PER-CARTON                            11580040
115900     ELSE                                                         11590040
116000         COMPUTE PV-PACKS-PER-CARTON =                            11600040
116100                 POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY        11610040
116200     END-IF.                                                      11620040
116300                                                                  11630040
116400     COMPUTE PV-PACKS-TO-RECEIVE ROUNDED =                        11640040
116500             PV-CURR-SPLIT-PCT-QTY / PURITM-PREPK-RATO-QTY.       11650040
116600                                                                  11660040
116700     IF  PV-PACKS-TO-RECEIVE = 0                                  11670040
116800         MOVE 1 TO PV-PACKS-TO-RECEIVE.                           11680040
116900                                                                  11690040
117000     IF  PV-PACKS-PER-CARTON = 1                                  11700040
117100         MOVE PV-PACKS-TO-RECEIVE TO PV-CARTON-QTY                11710040
117200     ELSE                                                         11720040
117300         COMPUTE PV-CARTON-QTY ROUNDED =                          11730040
117400                 PV-PACKS-TO-RECEIVE / PV-PACKS-PER-CARTON        11740040
117500         IF  PV-CARTON-QTY = 0                                    11750040
117600             MOVE 1 TO PV-CARTON-QTY                              11760040
117700         END-IF                                                   11770040
117800     END-IF.                                                      11780040
117900                                                                  11790040
118000                                                                  11800040
118100 3650-GENERATE-CARTON-DATA.                                       11810040
118200                                                                  11820040
118300     MOVE 'P ' TO PV-HL03-LVL-CDE.                                11830040
118400     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      11840040
118500                                                                  11850040
118600     IF  PV-UCC128-NUMBER = ZERO                                  11860040
118700         PERFORM 4450-GET-MAX-UCC128                              11870040
118800     END-IF.                                                      11880040
118900                                                                  11890040
118910* DMH                                                             11891040
118920     IF  PVI-GENERATE-UPS-TRACK                                   11892040
118930         IF  PV-UPS-TRACK-11-18  > 0                              11893040
118940             ADD  1  TO  PV-UPS-TRACK-11-18                       11894040
118950             SET  PS-UNIQUE-TRACK-NO  TO  TRUE                    11895040
118960             PERFORM 2050-CHECK-FOR-DUP-TRACK                     11896040
118970                     UNTIL PS-UNIQUE-TRACK                        11897040
118980             DISPLAY PV-UPS-TRACK-NUMBER                          11898040
118990         END-IF                                                   11899040
118991     END-IF.                                                      11899140
118992* DMH                                                             11899240
118993                                                                  11899340
118994* CREATE 'MAN' SEGMENT                                            11899440
118995     MOVE 'MAN'               TO SN005-MAN-ID.                    11899540
118996     MOVE 'GM'                TO SN005-MAN01-NBR-QUAL-CDE.        11899640
118997     ADD  +1                  TO PV-UCC128-NUMBER.                11899740
118998     MOVE PV-UCC128-NUMBER    TO PV-UCC128-18.                    11899840
118999     MOVE PV-UCC128-CHAR      TO SN005-MAN02-NBR.                 11899940
119000                                                                  11900040
119100* DMH                                                             11910040
119200     IF  PVI-GENERATE-UPS-TRACK                                   11920040
119300         MOVE 'CP'                TO SN005-MAN04-NBR-QUAL-CDE     11930040
119400         MOVE PV-UPS-TRACK-NUMBER TO SN005-MAN05-NBR              11940040
119500     ELSE                                                         11950040
119600         MOVE SPACES              TO SN005-MAN04-NBR-QUAL-CDE     11960040
119610                                     SN005-MAN05-NBR              11961040
119620     END-IF.                                                      11962040
119630* DMH                                                             11963040
119640                                                                  11964040
119650     MOVE SPACES              TO SN005-MAN-FILLER.                11965040
119660     MOVE SN005-MAN-SEGMENT   TO PVO-ASN-DATA-RECORD.             11966040
119670     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     11967040
119680     ADD  +1                  TO PV-SEQ-NBR                       11968040
119690                                 PV-TD1-ORDER-CRTN-COUNT          11969040
119700                                 PV-TD1-SHIP-CRTN-COUNT.          11970040
119800     PERFORM 8400-WRITE-OUTPUT-RECORD.                            11980040
119900                                                                  11990040
120000     PERFORM 3660-BUILD-COMPONENTS.                               12000040
120100                                                                  12010040
120200 3660-BUILD-COMPONENTS.                                           12020040
120300                                                                  12030040
120400     MOVE PURITM-PO-NBR       TO DK-PO-NBR.                       12040040
120500     MOVE PURITM-PO-PREPK-ID  TO DK-PO-PREPK-ID.                  12050040
120600     SET PS-NOT-EOF-PACK-ITEM-CURSOR TO TRUE.                     12060040
120700     PERFORM 3670-OPEN-PACK-ITEM-CURSOR.                          12070040
120800     PERFORM 3680-FETCH-PACK-ITEM-CURSOR                          12080040
120900       UNTIL PS-EOF-PACK-ITEM-CURSOR.                             12090040
121000     PERFORM 3710-CLOSE-PACK-ITEM-CURSOR.                         12100040
121100                                                                  12110040
121200                                                                  12120040
121300 3670-OPEN-PACK-ITEM-CURSOR.                                      12130040
121400                                                                  12140040
121500     MOVE '3670-OPEN-PACK-ITEM-CURSOR' TO PV-ABEND-PARAGRAPH.     12150040
121600                                                                  12160040
121700     EXEC SQL                                                     12170040
121800          OPEN PACK-ITEM-CURSOR                                   12180040
121900     END-EXEC.                                                    12190040
122000                                                                  12200040
122100     EVALUATE TRUE                                                12210040
122200         WHEN SQLCODE = 0                                         12220040
122300             CONTINUE                                             12230040
122400         WHEN SQLWARN0 NOT = SPACES                               12240040
122500         WHEN SQLCODE < ZERO                                      12250040
122600         WHEN SQLCODE > ZERO                                      12260040
122700             MOVE '3670-OPEN-PACK-ITEM-CURSOR  '                  12270040
122800                             TO PV-PARAGRAPH-NAME                 12280040
122900             MOVE 'OPEN THE PACK ITEM CURSOR    '                 12290040
123000                             TO PV-DB2-OPERATION-ATTEMPTED        12300040
123100             PERFORM 9999-SQL-ABEND                               12310040
123200     END-EVALUATE.                                                12320040
123300                                                                  12330040
123400 3680-FETCH-PACK-ITEM-CURSOR.                                     12340040
123500                                                                  12350040
123600     MOVE '3680-FETCH-PACK-ITEM-CURSOR  ' TO PV-ABEND-PARAGRAPH.  12360040
123700                                                                  12370040
123800     EXEC SQL                                                     12380040
123900          FETCH PACK-ITEM-CURSOR                                  12390040
124000          INTO  :PV-PIC-PO-NBR                                    12400040
124100              , :PV-PIC-UPC-NBR                                   12410040
124200              , :PV-PIC-PREPK-RATO-QTY                            12420040
124300              , :PV-PIC-PO-LNE-NBR                                12430040
124400     END-EXEC.                                                    12440040
124500                                                                  12450040
124600     EVALUATE TRUE                                                12460040
124700       WHEN SQLCODE = ZEROS                                       12470040
124800            IF  PVI-PACK-COMP-BYPASS-LNE-NBR = ZEROS              12480040
124900                PERFORM 3690-PROCESS-FETCH                        12490040
125000            ELSE                                                  12500040
125100                MOVE PVI-PACK-COMP-BYPASS-LNE-NBR TO              12510040
125200                     PV-PO-LNE-NBR                                12520040
125300                IF  PV-PO-LNE-NBR = PV-PIC-PO-LNE-NBR             12530040
125400                    IF  PVI-PACK-COMP-RPLACE-LNE-NBR = ZEROS      12540040
125500                        NEXT SENTENCE                             12550040
125600                    ELSE                                          12560040
125700                        PERFORM 3685-GET-REPLACE-INFO             12570040
125800                        IF  PS-REPLACE-LINE-FOUND                 12580040
125900                            MOVE PV-REP-PO-NBR          TO        12590040
126000                                 PV-PIC-PO-NBR                    12600040
126100                            MOVE PV-REP-UPC-NBR         TO        12610040
126200                                 PV-PIC-UPC-NBR                   12620040
126300                            MOVE PV-REP-PREPK-RATO-QTY  TO        12630040
126400                                 PV-PIC-PREPK-RATO-QTY            12640040
126500                            MOVE PV-REP-PO-LNE-NBR      TO        12650040
126600                                 PV-PIC-PO-LNE-NBR                12660040
126700                            PERFORM 3690-PROCESS-FETCH            12670040
126800                        ELSE                                      12680040
126900                            NEXT SENTENCE                         12690040
127000                        END-IF                                    12700040
127100                    END-IF                                        12710040
127200                ELSE                                              12720040
127300                    PERFORM 3690-PROCESS-FETCH                    12730040
127400                END-IF                                            12740040
127500            END-IF                                                12750040
127600       WHEN SQLCODE = +100                                        12760040
127700            SET PS-EOF-PACK-ITEM-CURSOR TO TRUE                   12770040
127800       WHEN SQLWARN0 NOT = SPACES                                 12780040
127900       WHEN SQLCODE < ZERO                                        12790040
128000       WHEN SQLCODE > ZERO                                        12800040
128100           MOVE '3680-FETCH-PACK-ITEM-CURSOR  '                   12810040
128200                               TO PV-PARAGRAPH-NAME               12820040
128300           MOVE 'FETCH THE PACK ITEM CURSOR   '                   12830040
128400                               TO PV-DB2-OPERATION-ATTEMPTED      12840040
128500           PERFORM 9999-SQL-ABEND                                 12850040
128600     END-EVALUATE.                                                12860040
128700                                                                  12870040
128800 3685-GET-REPLACE-INFO.                                           12880040
128900                                                                  12890040
129000      MOVE '3685-GET-REPLACE-INFO  '      TO PV-ABEND-PARAGRAPH.  12900040
129100      MOVE PVI-PO-NBR                     TO DK-RP-PO-NBR.        12910040
129200      MOVE PVI-PACK-COMP-RPLACE-LNE-NBR   TO DK-RP-PO-LINE-NBR.   12920040
129300      SET PS-REPLACE-LINE-NOT-FOUND       TO TRUE.                12930040
129400                                                                  12940040
129500      EXEC SQL                                                    12950040
129600          SELECT A.PO_NBR , C.UPC_NBR, A.PREPK_RATO_QTY           12960040
129700               , A.PO_LNE_NBR                                     12970040
129800            INTO :PV-REP-PO-NBR                                   12980040
129900               , :PV-REP-UPC-NBR                                  12990040
130000               , :PV-REP-PREPK-RATO-QTY                           13000040
130100               , :PV-REP-PO-LNE-NBR                               13010040
130200            FROM TPURITM A                                        13020040
130300               , XLT_SKU B                                        13030040
130400               , XLT_UPC C                                        13040040
130500           WHERE  A.PO_NBR         = :DK-RP-PO-NBR                13050040
130600             AND  A.PO_LNE_NBR     = :DK-RP-PO-LINE-NBR           13060040
130700             AND  B.ITM_NBR        = A.ITM_NBR                    13070040
130800             AND  C.INTR_UPC_ID    = B.INTR_UPC_ID                13080040
130900             AND  C.UPC_TYP_CDE    = 'I'                          13090040
131000            WITH UR                                               13100040
131100      END-EXEC.                                                   13110040
131200                                                                  13120040
131300       EVALUATE TRUE                                              13130040
131400            WHEN SQLCODE = ZERO                                   13140040
131500            WHEN SQLCODE = -811                                   13150040
131600                 SET PS-REPLACE-LINE-FOUND TO TRUE                13160040
131700            WHEN SQLCODE = +100                                   13170040
131800                DISPLAY 'PO LINE NOT FOUND         '              13180040
131900                DISPLAY 'PO NBR     :  ' PVI-PO-NBR               13190040
132000                DISPLAY 'PO LINE NBR:  '                          13200040
132100                        PVI-PACK-COMP-RPLACE-LNE-NBR              13210040
132200            WHEN OTHER                                            13220040
132300                MOVE  SQLCODE          TO  PV-SQLCODE             13230040
132400                MOVE 'SELECT TPURITM FOR REPLACEMENT LINE '       13240040
132500                                     TO PV-DB2-OPERATION-MESSAGE-113250040
132600                STRING ' PO NUMBER -  '        DELIMITED BY SIZE  13260040
132700                       PVI-PO-NBR              DELIMITED BY SIZE  13270040
132800                                   INTO PV-DB2-OPERATION-MESSAGE-213280040
132900                STRING ' PO LINE NUMBER - '    DELIMITED BY SIZE  13290040
133000                       PVI-PACK-COMP-RPLACE-LNE-NBR               13300040
133100                                               DELIMITED BY SIZE  13310040
133200                                   INTO PV-DB2-OPERATION-MESSAGE-313320040
133300                MOVE 'TPURITM'           TO PV-DB2-TABLE-NAME-1   13330040
133400                MOVE 'XLT_SKU'           TO PV-DB2-TABLE-NAME-2   13340040
133500                MOVE 'XLT_UPC'           TO PV-DB2-TABLE-NAME-3   13350040
133600                PERFORM 9999-SQL-ABEND                            13360040
133700        END-EVALUATE.                                             13370040
133800                                                                  13380040
133900                                                                  13390040
134000 3690-PROCESS-FETCH.                                              13400040
134100                                                                  13410040
134200     MOVE PVI-PACK-RAT-LNE1-DF-NBR TO PV-PO-LNE-NBR.              13420040
134300     IF  PV-PIC-PO-LNE-NBR = PV-PO-LNE-NBR                        13430040
134400         IF  PVI-PACK-RAT-LNE1-DF-PLUS                            13440040
134500             ADD PVI-PACK-RAT-LNE1-DF-QTY                         13450040
134600              TO PV-PIC-PREPK-RATO-QTY                            13460040
134700         ELSE                                                     13470040
134800             SUBTRACT PVI-PACK-RAT-LNE1-DF-QTY                    13480040
134900                 FROM PV-PIC-PREPK-RATO-QTY                       13490040
135000             IF  PV-PIC-PREPK-RATO-QTY <= ZERO                    13500040
135100                 MOVE 1 TO PV-PIC-PREPK-RATO-QTY                  13510040
135200             END-IF                                               13520040
135300         END-IF                                                   13530040
135400     END-IF.                                                      13540040
135500                                                                  13550040
135600     MOVE PVI-PACK-RAT-LNE2-DF-NBR TO PV-PO-LNE-NBR.              13560040
135700     IF  PV-PIC-PO-LNE-NBR = PV-PO-LNE-NBR                        13570040
135800         IF  PVI-PACK-RAT-LNE2-DF-PLUS                            13580040
135900             ADD PVI-PACK-RAT-LNE2-DF-QTY                         13590040
136000              TO PV-PIC-PREPK-RATO-QTY                            13600040
136100         ELSE                                                     13610040
136200             SUBTRACT PVI-PACK-RAT-LNE2-DF-QTY                    13620040
136300                 FROM PV-PIC-PREPK-RATO-QTY                       13630040
136400             IF  PV-PIC-PREPK-RATO-QTY <= ZERO                    13640040
136500                 MOVE 1 TO PV-PIC-PREPK-RATO-QTY                  13650040
136600             END-IF                                               13660040
136700         END-IF                                                   13670040
136800     END-IF.                                                      13680040
136900                                                                  13690040
137000* CREATE 'HL ' ITEM LEVEL SEGMENT                                 13700040
137100     MOVE 'I ' TO PV-HL03-LVL-CDE.                                13710040
137200     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      13720040
137300                                                                  13730040
137400* CREATE 'LIN' SEGMENT                                            13740040
137500     MOVE SPACES               TO SN005-LIN-SEGMENT.              13750040
137600     MOVE 'LIN'                TO SN005-LIN-ID.                   13760040
137700     MOVE SPACES               TO SN005-LIN01-ID-CDE.             13770040
137800     MOVE 'UP'                TO SN005-LIN02-PROD-ID-QUAL-CDE (1).13780040
137900     MOVE PV-PIC-UPC-NBR       TO PV-UPC-NBR.                     13790040
138000     MOVE PV-UPC-NBR          TO SN005-LIN03-PROD-ID (1).         13800040
138100     MOVE SN005-LIN-SEGMENT   TO PVO-ASN-DATA-RECORD.             13810040
138200     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     13820040
138300     ADD  +1                  TO PV-SEQ-NBR.                      13830040
138400     PERFORM 8400-WRITE-OUTPUT-RECORD.                            13840040
138500                                                                  13850040
138600* CREATE 'SN1' SEGMENT                                            13860040
138700     MOVE 'SN1'               TO SN005-SN1-ID.                    13870040
138800     MOVE SPACES              TO SN005-SN101-ID-CDE.              13880040
138900     COMPUTE PV-COMPONENT-QTY =                                   13890040
139000             PV-PACKS-PER-CARTON * PV-PIC-PREPK-RATO-QTY.         13900040
139100     MOVE PV-COMPONENT-QTY    TO SN005-SN102-SHIP-QTY.            13910040
139200     MOVE 'EA'                TO SN005-SN103-SHIP-UM-CDE.         13920040
139300     MOVE ZEROS               TO SN005-SN104-SHIPT-DTE-QTY.       13930040
139400     MOVE ZEROS               TO SN005-SN105-ORD-QTY.             13940040
139500     MOVE SPACES              TO SN005-SN106-ORD-UM-CDE.          13950040
139600     MOVE SPACES              TO SN005-SN1-FILLER.                13960040
139700     MOVE SN005-SN1-SEGMENT   TO PVO-ASN-DATA-RECORD.             13970040
139800     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     13980040
139900     ADD  +1                  TO PV-SEQ-NBR.                      13990040
140000     PERFORM 8400-WRITE-OUTPUT-RECORD.                            14000040
140100                                                                  14010040
140200* CREATE 'PO4' SEGMENT                                            14020040
140300     MOVE 'PO4'               TO SN005-PO4-ID                     14030040
140400     MOVE 1                   TO SN005-PO401-PKG-SIZE-QTY         14040040
140500     MOVE ZEROS               TO SN005-PO402-SIZE-MSMT            14050040
140600     MOVE SPACES              TO SN005-PO403-SIZE-UM-CDE          14060040
140700     MOVE SPACES              TO SN005-PO405-WGHT-QUAL-CDE        14070040
140800     MOVE ZEROS               TO SN005-PO406-GRO-WGHT-MSMT        14080040
140900     MOVE SPACES              TO SN005-PO407-WGHT-UM-CDE          14090040
141000     MOVE ZEROS               TO SN005-PO408-GRO-VOL-MSMT         14100040
141100     MOVE SPACES              TO SN005-PO409-VOL-UM-CDE           14110040
141200     MOVE ZEROS               TO SN005-PO410-LEN-MSMT             14120040
141300     MOVE ZEROS               TO SN005-PO411-WDTH-MSMT            14130040
141400     MOVE ZEROS               TO SN005-PO412-HT-MSMT              14140040
141500     MOVE SPACES              TO SN005-PO413-UM-CDE               14150040
141600     MOVE 1                   TO SN005-PO414-INPK-EA-QTY          14160040
141700     MOVE SPACES              TO SN005-PO4-FILLER                 14170040
141800     MOVE SN005-PO4-SEGMENT   TO PVO-ASN-DATA-RECORD.             14180040
141900     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     14190040
142000     ADD  +1                  TO PV-SEQ-NBR.                      14200040
142100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            14210040
142200                                                                  14220040
142300 3710-CLOSE-PACK-ITEM-CURSOR.                                     14230040
142400                                                                  14240040
142500     MOVE '3710-CLOSE-PACK-ITEM-CURSOR  ' TO PV-ABEND-PARAGRAPH.  14250040
142600                                                                  14260040
142700     EXEC SQL                                                     14270040
142800         CLOSE PACK-ITEM-CURSOR                                   14280040
142900     END-EXEC.                                                    14290040
143000                                                                  14300040
143100     EVALUATE TRUE                                                14310040
143200         WHEN SQLCODE = ZERO                                      14320040
143300         WHEN SQLCODE = -904                                      14330040
143400         WHEN SQLCODE = -911                                      14340040
143500              CONTINUE                                            14350040
143600         WHEN SQLWARN0 NOT = SPACES                               14360040
143700         WHEN SQLCODE < ZERO                                      14370040
143800         WHEN SQLCODE > ZERO                                      14380040
143900              MOVE '3710-CLOSE-PACK-ITEM-CURSOR  '                14390040
144000                              TO PV-PARAGRAPH-NAME                14400040
144100              MOVE 'CLOSE THE PACK ITEM CURSOR     '              14410040
144200                              TO PV-DB2-OPERATION-ATTEMPTED       14420040
144300              PERFORM 9999-SQL-ABEND                              14430040
144400     END-EVALUATE.                                                14440040
144500                                                                  14450040
144600 3720-CLOSE-PK-COMP-CURSOR.                                       14460040
144700                                                                  14470040
144800     MOVE '3720-CLOSE-PK-COMP-CURSOR    ' TO PV-ABEND-PARAGRAPH.  14480040
144900                                                                  14490040
145000     EXEC SQL                                                     14500040
145100         CLOSE PACK-CRTN-CURSOR                                   14510040
145200     END-EXEC.                                                    14520040
145300                                                                  14530040
145400     EVALUATE TRUE                                                14540040
145500         WHEN SQLCODE = ZERO                                      14550040
145600         WHEN SQLCODE = -904                                      14560040
145700         WHEN SQLCODE = -911                                      14570040
145800              CONTINUE                                            14580040
145900         WHEN SQLWARN0 NOT = SPACES                               14590040
146000         WHEN SQLCODE < ZERO                                      14600040
146100         WHEN SQLCODE > ZERO                                      14610040
146200              MOVE '3720-CLOSE-PK-COMP-CURSOR    '                14620040
146300                              TO PV-PARAGRAPH-NAME                14630040
146400              MOVE 'CLOSE THE PREPACK CURSOR       '              14640040
146500                              TO PV-DB2-OPERATION-ATTEMPTED       14650040
146600              PERFORM 9999-SQL-ABEND                              14660040
146700     END-EVALUATE.                                                14670040
146800                                                                  14680040
146900                                                                  14690040
147000                                                                  14700040
147100 4000-BUILD-PACK-AND-COMP.                                        14710040
147200                                                                  14720040
147300     MOVE 'O ' TO PV-HL03-LVL-CDE.                                14730040
147400     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      14740040
147500     PERFORM 2420-GENERATE-PRF-SEGMENT.                           14750040
147600                                                                  14760040
147700* ORDER LEVEL TD1 SEGMENT WILL BE CREATED WHEN PO FOR DC HAS      14770040
147800* BEEN PROCESSED BY NEEDS TO FIT INTO THE DATA AT THIS POINT      14780040
147900* THUS SAVING THE SEQUENCE NUMBER FOR USE LATER WHEN THE DATA     14790040
148000* IS WRITTEN.                                                     14800040
148100     MOVE PV-SEQ-NBR TO PV-HOLD-TD1-ORDER-SEQ-NBR.                14810040
148200     ADD  +1         TO PV-SEQ-NBR.                               14820040
148300                                                                  14830040
148400     PERFORM 2430-GENERATE-REF-ORD-SEGMENT.                       14840040
148500     MOVE PVI-DC-NBR TO PV-HOLD-N1-SHIP-NBR.                      14850040
148600     PERFORM 2440-GENERATE-N1-ORDER-SEGMENT.                      14860040
148700                                                                  14870040
148800     MOVE PVI-PO-NBR                TO DK-PO-NBR.                 14880040
148900     MOVE PVI-DC-NBR                TO DK-DC-NBR.                 14890040
149000     COMPUTE PV-PERCENT-OF-PO-UNITS ROUNDED =                     14900040
149100             PVI-PERCENT-OF-PO-UNITS / 100.                       14910040
149200     SET PS-NOT-EOF-CURSOR TO TRUE.                               14920040
149300     MOVE ZEROS            TO PV-PREV-PO-PREPK-ID.                14930040
149400     PERFORM 4010-OPEN-PK-COMP-CURSOR.                            14940040
149500     PERFORM 4020-FETCH-PK-COMP-CURSOR                            14950040
149600       UNTIL PS-EOF-CURSOR.                                       14960040
149700     PERFORM 4120-CLOSE-PK-COMP-CURSOR.                           14970040
149800                                                                  14980040
149900* BUILD ORDER LEVEL TD1                                           14990040
150000     MOVE 'TD1'               TO SN005-TD1-ID.                    15000040
150100     MOVE 'CTN25'             TO SN005-TD101-PKG-CDE.             15010040
150200     MOVE PV-TD1-ORDER-CRTN-COUNT                                 15020040
150300                              TO SN005-TD102-SHIPT-QTY.           15030040
150400     MOVE SPACES              TO SN005-TD106-WGHT-QUAL-CDE.       15040040
150500     MOVE ZEROS               TO SN005-TD107-WGHT-MSMT.           15050040
150600     MOVE SPACES              TO SN005-TD108-UM-CDE.              15060040
150700     MOVE SPACES              TO SN005-TD1-FILLER.                15070040
150800     MOVE SN005-TD1-SEGMENT   TO PVO-ASN-DATA-RECORD.             15080040
150900     MOVE PV-HOLD-TD1-ORDER-SEQ-NBR                               15090040
151000                              TO PVO-SEQ-NBR.                     15100040
151100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            15110040
151200                                                                  15120040
151300 4010-OPEN-PK-COMP-CURSOR.                                        15130040
151400                                                                  15140040
151500     MOVE '4010-OPEN-PK-COMP-CURSOR' TO PV-ABEND-PARAGRAPH.       15150040
151600                                                                  15160040
151700     EXEC SQL                                                     15170040
151800          OPEN PACK-CRTN-CURSOR                                   15180040
151900     END-EXEC.                                                    15190040
152000                                                                  15200040
152100     EVALUATE TRUE                                                15210040
152200         WHEN SQLCODE = 0                                         15220040
152300             CONTINUE                                             15230040
152400         WHEN SQLWARN0 NOT = SPACES                               15240040
152500         WHEN SQLCODE < ZERO                                      15250040
152600         WHEN SQLCODE > ZERO                                      15260040
152700             MOVE '4010-OPEN-PK-COMP-CURSOR    '                  15270040
152800                             TO PV-PARAGRAPH-NAME                 15280040
152900             MOVE 'OPEN THE PREPACK CURSOR      '                 15290040
153000                             TO PV-DB2-OPERATION-ATTEMPTED        15300040
153100             PERFORM 9999-SQL-ABEND                               15310040
153200     END-EVALUATE.                                                15320040
153300                                                                  15330040
153400                                                                  15340040
153500 4020-FETCH-PK-COMP-CURSOR.                                       15350040
153600                                                                  15360040
153700     MOVE '4020-FETCH-PK-COMP-CURSOR    ' TO PV-ABEND-PARAGRAPH.  15370040
153800                                                                  15380040
153900     EXEC SQL                                                     15390040
154000          FETCH PACK-CRTN-CURSOR                                  15400040
154100          INTO  :PURITM-PO-NBR                                    15410040
154200              , :PURITM-PO-LNE-NBR                                15420040
154300              , :PURITM-PO-PREPK-ID                               15430040
154400              , :PURITM-PREPK-RATO-QTY                            15440040
154500              , :PURITM-INNR-PK-QTY                               15450040
154600              , :PURITM-OUTR-PK-QTY                               15460040
154700              , :PURITM-UNT-QTY                                   15470040
154800              , :POPRPK-PREPK-UPC-NBR                             15480040
154900              , :POPRPK-INPK-UNT-QTY                              15490040
155000              , :POPRPK-OTPK-UNT-QTY                              15500040
155100              , :POPRPK-OTPK-ORD-QTY                              15510040
155200              , :ALLPLN-CURR-SPLIT-QTY                            15520040
155300              , :XLT00006-UPC-NBR                                 15530040
155400              , :PV-CURR-SPLIT-PCT-QTY                            15540040
155500     END-EXEC.                                                    15550040
155600                                                                  15560040
155700     EVALUATE TRUE                                                15570040
155800       WHEN SQLCODE = ZEROS                                       15580040
155900            PERFORM 4030-PROCESS-FETCH                            15590040
156000       WHEN SQLCODE = +100                                        15600040
156100            SET PS-EOF-CURSOR  TO TRUE                            15610040
156200       WHEN SQLWARN0 NOT = SPACES                                 15620040
156300       WHEN SQLCODE < ZERO                                        15630040
156400       WHEN SQLCODE > ZERO                                        15640040
156500           MOVE '4020-FETCH-PK-COMP-CURSOR    '                   15650040
156600                               TO PV-PARAGRAPH-NAME               15660040
156700           MOVE 'FETCH THE PREPACK CURSOR     '                   15670040
156800                               TO PV-DB2-OPERATION-ATTEMPTED      15680040
156900           PERFORM 9999-SQL-ABEND                                 15690040
157000     END-EVALUATE.                                                15700040
157100                                                                  15710040
157200 4030-PROCESS-FETCH.                                              15720040
157300                                                                  15730040
157400     IF  PURITM-PO-PREPK-ID   = PV-PREV-PO-PREPK-ID               15740040
157500         NEXT SENTENCE                                            15750040
157600     ELSE                                                         15760040
157700         MOVE PURITM-PO-PREPK-ID TO PV-PREV-PO-PREPK-ID           15770040
157800         PERFORM 4040-CALC-VALUES                                 15780040
157900         PERFORM 4050-GENERATE-CARTON-DATA                        15790040
158000                 VARYING PV-LOOP-COUNT FROM 1 BY 1                15800040
158100                   UNTIL PV-LOOP-COUNT > PV-CARTON-QTY            15810040
158200     END-IF.                                                      15820040
158300                                                                  15830040
158400 4040-CALC-VALUES.                                                15840040
158500                                                                  15850040
158600     IF  POPRPK-OTPK-UNT-QTY = 0                                  15860040
158700     OR  POPRPK-OTPK-UNT-QTY = 1                                  15870040
158800         MOVE 1 TO PV-PACKS-PER-CARTON                            15880040
158900     ELSE                                                         15890040
159000         COMPUTE PV-PACKS-PER-CARTON =                            15900040
159100                 POPRPK-OTPK-UNT-QTY / POPRPK-INPK-UNT-QTY        15910040
159200     END-IF.                                                      15920040
159300                                                                  15930040
159400     COMPUTE PV-PACKS-TO-RECEIVE ROUNDED =                        15940040
159500             PV-CURR-SPLIT-PCT-QTY / PURITM-PREPK-RATO-QTY.       15950040
159600                                                                  15960040
159700     IF  PV-PACKS-TO-RECEIVE = 0                                  15970040
159800         MOVE 1 TO PV-PACKS-TO-RECEIVE.                           15980040
159900                                                                  15990040
160000     IF  PV-PACKS-PER-CARTON = 1                                  16000040
160100         MOVE PV-PACKS-TO-RECEIVE TO PV-CARTON-QTY                16010040
160200     ELSE                                                         16020040
160300         COMPUTE PV-CARTON-QTY ROUNDED =                          16030040
160400                 PV-PACKS-TO-RECEIVE / PV-PACKS-PER-CARTON        16040040
160500         IF  PV-CARTON-QTY = 0                                    16050040
160600             MOVE 1 TO PV-CARTON-QTY                              16060040
160700         END-IF                                                   16070040
160800     END-IF.                                                      16080040
160900                                                                  16090040
161000                                                                  16100040
161100 4050-GENERATE-CARTON-DATA.                                       16110040
161200                                                                  16120040
161300     MOVE 'P ' TO PV-HL03-LVL-CDE.                                16130040
161400     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      16140040
161500                                                                  16150040
161600     IF  PV-UCC128-NUMBER = ZERO                                  16160040
161700         PERFORM 4450-GET-MAX-UCC128                              16170040
161800     END-IF.                                                      16180040
161900                                                                  16190040
162000* DMH                                                             16200040
162100     IF  PVI-GENERATE-UPS-TRACK                                   16210040
162200         IF  PV-UPS-TRACK-11-18  > 0                              16220040
162300             ADD  1  TO  PV-UPS-TRACK-11-18                       16230040
162310             SET  PS-UNIQUE-TRACK-NO  TO  TRUE                    16231040
162320             PERFORM 2050-CHECK-FOR-DUP-TRACK                     16232040
162330                     UNTIL PS-UNIQUE-TRACK                        16233040
162340             DISPLAY PV-UPS-TRACK-NUMBER                          16234040
162350         END-IF                                                   16235040
162360     END-IF.                                                      16236040
162370* DMH                                                             16237040
162380                                                                  16238040
162390* CREATE 'MAN' SEGMENT                                            16239040
162400     MOVE 'MAN'               TO SN005-MAN-ID.                    16240040
162500     MOVE 'GM'                TO SN005-MAN01-NBR-QUAL-CDE.        16250040
162600     ADD  +1                  TO PV-UCC128-NUMBER.                16260040
162700     MOVE PV-UCC128-NUMBER    TO PV-UCC128-18.                    16270040
162800     MOVE PV-UCC128-CHAR      TO SN005-MAN02-NBR.                 16280040
162900                                                                  16290040
163000* DMH                                                             16300040
163010     IF  PVI-GENERATE-UPS-TRACK                                   16301040
163020         MOVE 'CP'                TO SN005-MAN04-NBR-QUAL-CDE     16302040
163030         MOVE PV-UPS-TRACK-NUMBER TO SN005-MAN05-NBR              16303040
163040     ELSE                                                         16304040
163050         MOVE SPACES              TO SN005-MAN04-NBR-QUAL-CDE     16305040
163060                                     SN005-MAN05-NBR              16306040
163070     END-IF.                                                      16307040
163080* DMH                                                             16308040
163090                                                                  16309040
163100     MOVE SPACES              TO SN005-MAN-FILLER.                16310040
163200     MOVE SN005-MAN-SEGMENT   TO PVO-ASN-DATA-RECORD.             16320040
163300     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     16330040
163400     ADD  +1                  TO PV-SEQ-NBR                       16340040
163500                                 PV-TD1-ORDER-CRTN-COUNT          16350040
163600                                 PV-TD1-SHIP-CRTN-COUNT.          16360040
163700     PERFORM 8400-WRITE-OUTPUT-RECORD.                            16370040
163800                                                                  16380040
163900     MOVE 'I ' TO PV-HL03-LVL-CDE.                                16390040
164000     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      16400040
164100                                                                  16410040
164200* CREATE 'LIN' SEGMENT                                            16420040
164300     MOVE SPACES               TO SN005-LIN-SEGMENT.              16430040
164400     MOVE 'LIN'                TO SN005-LIN-ID.                   16440040
164500     MOVE SPACES               TO SN005-LIN01-ID-CDE.             16450040
164600     MOVE 'UP'                TO SN005-LIN02-PROD-ID-QUAL-CDE (1).16460040
164700     MOVE POPRPK-PREPK-UPC-NBR TO PV-UPC-NBR.                     16470040
164800     MOVE PV-UPC-NBR          TO SN005-LIN03-PROD-ID (1).         16480040
164900     MOVE SN005-LIN-SEGMENT   TO PVO-ASN-DATA-RECORD.             16490040
165000     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     16500040
165100     ADD  +1                  TO PV-SEQ-NBR.                      16510040
165200     PERFORM 8400-WRITE-OUTPUT-RECORD.                            16520040
165300                                                                  16530040
165400* CREATE 'SN1' SEGMENT                                            16540040
165500     MOVE 'SN1'               TO SN005-SN1-ID.                    16550040
165600     MOVE SPACES              TO SN005-SN101-ID-CDE.              16560040
165700     MOVE PV-PACKS-PER-CARTON TO SN005-SN102-SHIP-QTY.            16570040
165800     MOVE 'AS'                TO SN005-SN103-SHIP-UM-CDE.         16580040
165900     MOVE ZEROS               TO SN005-SN104-SHIPT-DTE-QTY.       16590040
166000     MOVE ZEROS               TO SN005-SN105-ORD-QTY.             16600040
166100     MOVE SPACES              TO SN005-SN106-ORD-UM-CDE.          16610040
166200     MOVE SPACES              TO SN005-SN1-FILLER.                16620040
166300     MOVE SN005-SN1-SEGMENT   TO PVO-ASN-DATA-RECORD.             16630040
166400     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     16640040
166500     ADD  +1                  TO PV-SEQ-NBR.                      16650040
166600     PERFORM 8400-WRITE-OUTPUT-RECORD.                            16660040
166700                                                                  16670040
166800     PERFORM 4060-BUILD-COMPONENTS.                               16680040
166900                                                                  16690040
167000 4060-BUILD-COMPONENTS.                                           16700040
167100                                                                  16710040
167200     MOVE PURITM-PO-NBR       TO DK-PO-NBR.                       16720040
167300     MOVE PURITM-PO-PREPK-ID  TO DK-PO-PREPK-ID.                  16730040
167400     SET PS-NOT-EOF-PACK-ITEM-CURSOR TO TRUE.                     16740040
167500     PERFORM 4070-OPEN-PACK-ITEM-CURSOR.                          16750040
167600     PERFORM 4080-FETCH-PACK-ITEM-CURSOR                          16760040
167700       UNTIL PS-EOF-PACK-ITEM-CURSOR.                             16770040
167800     PERFORM 4110-CLOSE-PACK-ITEM-CURSOR.                         16780040
167900                                                                  16790040
168000                                                                  16800040
168100 4070-OPEN-PACK-ITEM-CURSOR.                                      16810040
168200                                                                  16820040
168300     MOVE '4070-OPEN-PACK-ITEM-CURSOR' TO PV-ABEND-PARAGRAPH.     16830040
168400                                                                  16840040
168500     EXEC SQL                                                     16850040
168600          OPEN PACK-ITEM-CURSOR                                   16860040
168700     END-EXEC.                                                    16870040
168800                                                                  16880040
168900     EVALUATE TRUE                                                16890040
169000         WHEN SQLCODE = 0                                         16900040
169100             CONTINUE                                             16910040
169200         WHEN SQLWARN0 NOT = SPACES                               16920040
169300         WHEN SQLCODE < ZERO                                      16930040
169400         WHEN SQLCODE > ZERO                                      16940040
169500             MOVE '4070-OPEN-PACK-ITEM-CURSOR  '                  16950040
169600                             TO PV-PARAGRAPH-NAME                 16960040
169700             MOVE 'OPEN THE PACK ITEM CURSOR    '                 16970040
169800                             TO PV-DB2-OPERATION-ATTEMPTED        16980040
169900             PERFORM 9999-SQL-ABEND                               16990040
170000     END-EVALUATE.                                                17000040
170100                                                                  17010040
170200 4080-FETCH-PACK-ITEM-CURSOR.                                     17020040
170300                                                                  17030040
170400     MOVE '4080-FETCH-PACK-ITEM-CURSOR  ' TO PV-ABEND-PARAGRAPH.  17040040
170500                                                                  17050040
170600     EXEC SQL                                                     17060040
170700          FETCH PACK-ITEM-CURSOR                                  17070040
170800          INTO  :PV-PIC-PO-NBR                                    17080040
170900              , :PV-PIC-UPC-NBR                                   17090040
171000              , :PV-PIC-PREPK-RATO-QTY                            17100040
171100              , :PV-PIC-PO-LNE-NBR                                17110040
171200     END-EXEC.                                                    17120040
171300                                                                  17130040
171400     EVALUATE TRUE                                                17140040
171500       WHEN SQLCODE = ZEROS                                       17150040
171600            IF  PVI-PACK-COMP-BYPASS-LNE-NBR = ZEROS              17160040
171700                PERFORM 4090-PROCESS-FETCH                        17170040
171800            ELSE                                                  17180040
171900                MOVE PVI-PACK-COMP-BYPASS-LNE-NBR TO              17190040
172000                     PV-PO-LNE-NBR                                17200040
172100                IF  PV-PO-LNE-NBR = PV-PIC-PO-LNE-NBR             17210040
172200                    IF  PVI-PACK-COMP-RPLACE-LNE-NBR = ZEROS      17220040
172300                        NEXT SENTENCE                             17230040
172400                    ELSE                                          17240040
172500                        PERFORM 3685-GET-REPLACE-INFO             17250040
172600                        IF  PS-REPLACE-LINE-FOUND                 17260040
172700                            MOVE PV-REP-PO-NBR          TO        17270040
172800                                 PV-PIC-PO-NBR                    17280040
172900                            MOVE PV-REP-UPC-NBR         TO        17290040
173000                                 PV-PIC-UPC-NBR                   17300040
173100                            MOVE PV-REP-PREPK-RATO-QTY  TO        17310040
173200                                 PV-PIC-PREPK-RATO-QTY            17320040
173300                            MOVE PV-REP-PO-LNE-NBR      TO        17330040
173400                                 PV-PIC-PO-LNE-NBR                17340040
173500                            PERFORM 4090-PROCESS-FETCH            17350040
173600                        ELSE                                      17360040
173700                            NEXT SENTENCE                         17370040
173800                        END-IF                                    17380040
173900                    END-IF                                        17390040
174000                ELSE                                              17400040
174100                    PERFORM 4090-PROCESS-FETCH                    17410040
174200                END-IF                                            17420040
174300            END-IF                                                17430040
174400       WHEN SQLCODE = +100                                        17440040
174500            SET PS-EOF-PACK-ITEM-CURSOR TO TRUE                   17450040
174600       WHEN SQLWARN0 NOT = SPACES                                 17460040
174700       WHEN SQLCODE < ZERO                                        17470040
174800       WHEN SQLCODE > ZERO                                        17480040
174900           MOVE '4080-FETCH-PACK-ITEM-CURSOR  '                   17490040
175000                               TO PV-PARAGRAPH-NAME               17500040
175100           MOVE 'FETCH THE PACK ITEM CURSOR   '                   17510040
175200                               TO PV-DB2-OPERATION-ATTEMPTED      17520040
175300           PERFORM 9999-SQL-ABEND                                 17530040
175400     END-EVALUATE.                                                17540040
175500                                                                  17550040
175600 4090-PROCESS-FETCH.                                              17560040
175700                                                                  17570040
175800     MOVE PVI-PACK-RAT-LNE1-DF-NBR TO PV-PO-LNE-NBR.              17580040
175900     IF  PV-PIC-PO-LNE-NBR = PV-PO-LNE-NBR                        17590040
176000         IF  PVI-PACK-RAT-LNE1-DF-PLUS                            17600040
176100             ADD PVI-PACK-RAT-LNE1-DF-QTY                         17610040
176200              TO PV-PIC-PREPK-RATO-QTY                            17620040
176300         ELSE                                                     17630040
176400             SUBTRACT PVI-PACK-RAT-LNE1-DF-QTY                    17640040
176500                 FROM PV-PIC-PREPK-RATO-QTY                       17650040
176600             IF  PV-PIC-PREPK-RATO-QTY <= ZERO                    17660040
176700                 MOVE 1 TO PV-PIC-PREPK-RATO-QTY                  17670040
176800             END-IF                                               17680040
176900         END-IF                                                   17690040
177000     END-IF.                                                      17700040
177100                                                                  17710040
177200     MOVE PVI-PACK-RAT-LNE2-DF-NBR TO PV-PO-LNE-NBR.              17720040
177300     IF  PV-PIC-PO-LNE-NBR = PV-PO-LNE-NBR                        17730040
177400         IF  PVI-PACK-RAT-LNE2-DF-PLUS                            17740040
177500             ADD PVI-PACK-RAT-LNE2-DF-QTY                         17750040
177600              TO PV-PIC-PREPK-RATO-QTY                            17760040
177700         ELSE                                                     17770040
177800             SUBTRACT PVI-PACK-RAT-LNE2-DF-QTY                    17780040
177900                 FROM PV-PIC-PREPK-RATO-QTY                       17790040
178000             IF  PV-PIC-PREPK-RATO-QTY <= ZERO                    17800040
178100                 MOVE 1 TO PV-PIC-PREPK-RATO-QTY                  17810040
178200             END-IF                                               17820040
178300         END-IF                                                   17830040
178400     END-IF.                                                      17840040
178500                                                                  17850040
178600* CREATE 'SLN' SEGMENT                                            17860040
178700     MOVE SPACES              TO SN005-SLN-SEGMENT.               17870040
178800     MOVE 'SLN'               TO SN005-SLN-ID.                    17880040
178900     MOVE SPACES              TO SN005-SLN01-ID.                  17890040
179000     MOVE 'I'                 TO SN005-SLN03-CONFIG-CDE.          17900040
179100     MOVE PV-PIC-PREPK-RATO-QTY TO SN005-SLN04-QTY.               17910040
179200     MOVE 'EA'                TO SN005-SLN05-UM-CDE.              17920040
179300     MOVE ZEROS               TO SN005-SLN06-UNIT-PRICE-AMT.      17930040
179400     MOVE SPACES              TO SN005-SLN07-UNIT-PRICE-CDE.      17940040
179500     MOVE SPACES              TO SN005-SLN08-PRICE-CD.            17950040
179600     MOVE 'UP'                TO SN005-SLN09-PROD-ID-QUAL-CDE (1) 17960040
179700     MOVE PV-PIC-UPC-NBR      TO PV-UPC-NBR.                      17970040
179800     MOVE PV-UPC-NBR          TO SN005-SLN10-PROD-ID (1).         17980040
179900     MOVE SPACES              TO SN005-SLN-FILLER.                17990040
180000     MOVE SN005-SLN-SEGMENT   TO PVO-ASN-DATA-RECORD.             18000040
180100     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     18010040
180200     ADD  +1                  TO PV-SEQ-NBR.                      18020040
180300     PERFORM 8400-WRITE-OUTPUT-RECORD.                            18030040
180400                                                                  18040040
180500                                                                  18050040
180600 4110-CLOSE-PACK-ITEM-CURSOR.                                     18060040
180700                                                                  18070040
180800     MOVE '4110-CLOSE-PACK-ITEM-CURSOR  ' TO PV-ABEND-PARAGRAPH.  18080040
180900                                                                  18090040
181000     EXEC SQL                                                     18100040
181100         CLOSE PACK-ITEM-CURSOR                                   18110040
181200     END-EXEC.                                                    18120040
181300                                                                  18130040
181400     EVALUATE TRUE                                                18140040
181500         WHEN SQLCODE = ZERO                                      18150040
181600         WHEN SQLCODE = -904                                      18160040
181700         WHEN SQLCODE = -911                                      18170040
181800              CONTINUE                                            18180040
181900         WHEN SQLWARN0 NOT = SPACES                               18190040
182000         WHEN SQLCODE < ZERO                                      18200040
182100         WHEN SQLCODE > ZERO                                      18210040
182200              MOVE '4110-CLOSE-PACK-ITEM-CURSOR  '                18220040
182300                              TO PV-PARAGRAPH-NAME                18230040
182400              MOVE 'CLOSE THE PACK ITEM CURSOR     '              18240040
182500                              TO PV-DB2-OPERATION-ATTEMPTED       18250040
182600              PERFORM 9999-SQL-ABEND                              18260040
182700     END-EVALUATE.                                                18270040
182800                                                                  18280040
182900 4120-CLOSE-PK-COMP-CURSOR.                                       18290040
183000                                                                  18300040
183100     MOVE '4120-CLOSE-PK-COMP-CURSOR    ' TO PV-ABEND-PARAGRAPH.  18310040
183200                                                                  18320040
183300     EXEC SQL                                                     18330040
183400         CLOSE PACK-CRTN-CURSOR                                   18340040
183500     END-EXEC.                                                    18350040
183600                                                                  18360040
183700     EVALUATE TRUE                                                18370040
183800         WHEN SQLCODE = ZERO                                      18380040
183900         WHEN SQLCODE = -904                                      18390040
184000         WHEN SQLCODE = -911                                      18400040
184100              CONTINUE                                            18410040
184200         WHEN SQLWARN0 NOT = SPACES                               18420040
184300         WHEN SQLCODE < ZERO                                      18430040
184400         WHEN SQLCODE > ZERO                                      18440040
184500              MOVE '4120-CLOSE-PK-COMP-CURSOR    '                18450040
184600                              TO PV-PARAGRAPH-NAME                18460040
184700              MOVE 'CLOSE THE PREPACK CURSOR       '              18470040
184800                              TO PV-DB2-OPERATION-ATTEMPTED       18480040
184900              PERFORM 9999-SQL-ABEND                              18490040
185000     END-EVALUATE.                                                18500040
185100                                                                  18510040
185200                                                                  18520040
185300******************************************************************18530040
185400** THIS WILL BUILD THE STANDARD PACK ASN FOR THE BULK OR CASE     18540040
185500** PACKAGE CODE.                                                  18550040
185600******************************************************************18560040
185700                                                                  18570040
185800 4400-BUILD-BULK-CASE-STANDARD.                                   18580040
185900                                                                  18590040
186000     MOVE 'O ' TO PV-HL03-LVL-CDE.                                18600040
186100     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      18610040
186200     PERFORM 2420-GENERATE-PRF-SEGMENT.                           18620040
186300                                                                  18630040
186400* ORDER LEVEL TD1 SEGMENT WILL BE CREATED WHEN PO FOR DC HAS      18640040
186500* BEEN PROCESSED BY NEEDS TO FIT INTO THE DATA AT THIS POINT      18650040
186600* THUS SAVING THE SEQUENCE NUMBER FOR USE LATER WHEN THE DATA     18660040
186700* IS WRITTEN.                                                     18670040
186800     MOVE PV-SEQ-NBR TO PV-HOLD-TD1-ORDER-SEQ-NBR.                18680040
186900     ADD  +1         TO PV-SEQ-NBR.                               18690040
187000                                                                  18700040
187100     PERFORM 2430-GENERATE-REF-ORD-SEGMENT.                       18710040
187200     MOVE PVI-DC-NBR TO PV-HOLD-N1-SHIP-NBR.                      18720040
187300     PERFORM 2440-GENERATE-N1-ORDER-SEGMENT.                      18730040
187400                                                                  18740040
187500     MOVE PVI-PO-NBR                TO DK-PO-NBR.                 18750040
187600     MOVE PVI-DC-NBR                TO DK-DC-NBR.                 18760040
187700     COMPUTE PV-PERCENT-OF-PO-UNITS ROUNDED =                     18770040
187800             PVI-PERCENT-OF-PO-UNITS / 100.                       18780040
187900     SET PS-NOT-EOF-CURSOR TO TRUE.                               18790040
188000     PERFORM 4410-OPEN-BULK-CASE-CURSOR.                          18800040
188100     PERFORM 4420-FETCH-BULK-CASE-CURSOR                          18810040
188200       UNTIL PS-EOF-CURSOR.                                       18820040
188300     PERFORM 4480-CLOSE-BULK-CASE-CURSOR.                         18830040
188400                                                                  18840040
188500* BUILD ORDER LEVEL TD1                                           18850040
188600     MOVE 'TD1'               TO SN005-TD1-ID.                    18860040
188700     MOVE 'CTN25'             TO SN005-TD101-PKG-CDE.             18870040
188800     MOVE PV-TD1-ORDER-CRTN-COUNT                                 18880040
188900                              TO SN005-TD102-SHIPT-QTY.           18890040
189000     MOVE SPACES              TO SN005-TD106-WGHT-QUAL-CDE.       18900040
189100     MOVE ZEROS               TO SN005-TD107-WGHT-MSMT.           18910040
189200     MOVE SPACES              TO SN005-TD108-UM-CDE.              18920040
189300     MOVE SPACES              TO SN005-TD1-FILLER.                18930040
189400     MOVE SN005-TD1-SEGMENT   TO PVO-ASN-DATA-RECORD.             18940040
189500     MOVE PV-HOLD-TD1-ORDER-SEQ-NBR                               18950040
189600                              TO PVO-SEQ-NBR.                     18960040
189700     PERFORM 8400-WRITE-OUTPUT-RECORD.                            18970040
189800                                                                  18980040
189900 4410-OPEN-BULK-CASE-CURSOR.                                      18990040
190000                                                                  19000040
190100     MOVE '4410-OPEN-BULK-CASE-CURSOR'  TO PV-ABEND-PARAGRAPH.    19010040
190200                                                                  19020040
190300     EXEC SQL                                                     19030040
190400          OPEN BULK-CASE-CRTN-CURSOR                              19040040
190500     END-EXEC.                                                    19050040
190600                                                                  19060040
190700     EVALUATE TRUE                                                19070040
190800         WHEN SQLCODE = 0                                         19080040
190900             CONTINUE                                             19090040
191000         WHEN SQLWARN0 NOT = SPACES                               19100040
191100         WHEN SQLCODE < ZERO                                      19110040
191200         WHEN SQLCODE > ZERO                                      19120040
191300             MOVE '4410-OPEN-BULK-CASE-CURSOR'                    19130040
191400                             TO PV-PARAGRAPH-NAME                 19140040
191500             MOVE 'OPEN THE BULK CASE CURSOR      '               19150040
191600                             TO PV-DB2-OPERATION-ATTEMPTED        19160040
191700             PERFORM 9999-SQL-ABEND                               19170040
191800     END-EVALUATE.                                                19180040
191900                                                                  19190040
192000                                                                  19200040
192100 4420-FETCH-BULK-CASE-CURSOR.                                     19210040
192200                                                                  19220040
192300     MOVE '4420-FETCH-BULK-CASE-CURSOR'   TO PV-ABEND-PARAGRAPH.  19230040
192400                                                                  19240040
192500     EXEC SQL                                                     19250040
192600          FETCH BULK-CASE-CRTN-CURSOR                             19260040
192700          INTO  :PURCHS-PO-NBR                                    19270040
192800              , :PURITM-PO-LNE-NBR                                19280040
192900              , :XLT00006-UPC-NBR                                 19290040
193000              , :PURITM-INNR-PK-QTY                               19300040
193100              , :PURITM-OUTR-PK-QTY                               19310040
193200              , :ALLPLN-CURR-SPLIT-QTY                            19320040
193300              , :PV-CURR-SPLIT-PCT-QTY                            19330040
193400     END-EXEC.                                                    19340040
193500                                                                  19350040
193600     EVALUATE TRUE                                                19360040
193700       WHEN SQLCODE = ZEROS                                       19370040
193800            PERFORM 4430-PROCESS-FETCH                            19380040
193900       WHEN SQLCODE = +100                                        19390040
194000            SET PS-EOF-CURSOR  TO TRUE                            19400040
194100       WHEN SQLWARN0 NOT = SPACES                                 19410040
194200       WHEN SQLCODE < ZERO                                        19420040
194300       WHEN SQLCODE > ZERO                                        19430040
194400           MOVE '4420-FETCH-BULK-CASE-CURSOR'                     19440040
194500                               TO PV-PARAGRAPH-NAME               19450040
194600           MOVE 'FETCH THE BULK CASE CURSOR     '                 19460040
194700                               TO PV-DB2-OPERATION-ATTEMPTED      19470040
194800           PERFORM 9999-SQL-ABEND                                 19480040
194900     END-EVALUATE.                                                19490040
195000                                                                  19500040
195100 4430-PROCESS-FETCH.                                              19510040
195200                                                                  19520040
195300     MOVE 'I ' TO PV-HL03-LVL-CDE.                                19530040
195400     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      19540040
195500                                                                  19550040
195600* CREATE 'LIN' SEGMENT                                            19560040
195700     MOVE SPACES              TO SN005-LIN-SEGMENT.               19570040
195800     MOVE 'LIN'               TO SN005-LIN-ID.                    19580040
195900     MOVE SPACES              TO SN005-LIN01-ID-CDE.              19590040
196000     MOVE 'UP'                TO SN005-LIN02-PROD-ID-QUAL-CDE (1).19600040
196100     MOVE XLT00006-UPC-NBR    TO PV-UPC-NBR.                      19610040
196200     MOVE PV-UPC-NBR          TO SN005-LIN03-PROD-ID (1).         19620040
196300     MOVE SN005-LIN-SEGMENT   TO PVO-ASN-DATA-RECORD.             19630040
196400     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     19640040
196500     ADD  +1                  TO PV-SEQ-NBR.                      19650040
196600     PERFORM 8400-WRITE-OUTPUT-RECORD.                            19660040
196700                                                                  19670040
196800     COMPUTE PV-CARTON-QTY ROUNDED =                              19680040
196900             PV-CURR-SPLIT-PCT-QTY / PURITM-OUTR-PK-QTY.          19690040
197000                                                                  19700040
197100     COMPUTE PV-LINE-SHIP-QTY =                                   19710040
197200             PV-CARTON-QTY * PURITM-OUTR-PK-QTY.                  19720040
197300                                                                  19730040
197400* CREATE 'SN1' SEGMENT                                            19740040
197500     MOVE 'SN1'               TO SN005-SN1-ID.                    19750040
197600     MOVE SPACES              TO SN005-SN101-ID-CDE.              19760040
197700     MOVE PV-LINE-SHIP-QTY    TO SN005-SN102-SHIP-QTY.            19770040
197800     MOVE 'EA'                TO SN005-SN103-SHIP-UM-CDE.         19780040
197900     MOVE ZEROS               TO SN005-SN104-SHIPT-DTE-QTY.       19790040
198000     MOVE ZEROS               TO SN005-SN105-ORD-QTY.             19800040
198100     MOVE SPACES              TO SN005-SN106-ORD-UM-CDE.          19810040
198200     MOVE SPACES              TO SN005-SN1-FILLER.                19820040
198300     MOVE SN005-SN1-SEGMENT   TO PVO-ASN-DATA-RECORD.             19830040
198400     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     19840040
198500     ADD  +1                  TO PV-SEQ-NBR.                      19850040
198600     PERFORM 8400-WRITE-OUTPUT-RECORD.                            19860040
198700                                                                  19870040
198800     PERFORM 4440-GENERATE-CARTON-DATA                            19880040
198900             VARYING PV-LOOP-COUNT FROM 1 BY 1                    19890040
199000               UNTIL PV-LOOP-COUNT > PV-CARTON-QTY.               19900040
199100                                                                  19910040
199200                                                                  19920040
199300 4440-GENERATE-CARTON-DATA.                                       19930040
199400                                                                  19940040
199500     MOVE 'P ' TO PV-HL03-LVL-CDE.                                19950040
199600     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      19960040
199700                                                                  19970040
199800* CREATE 'PO4' SEGMENT                                            19980040
199900     MOVE 'PO4'               TO SN005-PO4-ID                     19990040
200000     MOVE PURITM-OUTR-PK-QTY  TO SN005-PO401-PKG-SIZE-QTY         20000040
200100     MOVE ZEROS               TO SN005-PO402-SIZE-MSMT            20010040
200200     MOVE SPACES              TO SN005-PO403-SIZE-UM-CDE          20020040
200300     MOVE SPACES              TO SN005-PO405-WGHT-QUAL-CDE        20030040
200400     MOVE ZEROS               TO SN005-PO406-GRO-WGHT-MSMT        20040040
200500     MOVE SPACES              TO SN005-PO407-WGHT-UM-CDE          20050040
200600     MOVE ZEROS               TO SN005-PO408-GRO-VOL-MSMT         20060040
200700     MOVE SPACES              TO SN005-PO409-VOL-UM-CDE           20070040
200800     MOVE ZEROS               TO SN005-PO410-LEN-MSMT             20080040
200900     MOVE ZEROS               TO SN005-PO411-WDTH-MSMT            20090040
201000     MOVE ZEROS               TO SN005-PO412-HT-MSMT              20100040
201100     MOVE SPACES              TO SN005-PO413-UM-CDE               20110040
201200     MOVE ZEROS               TO SN005-PO414-INPK-EA-QTY          20120040
201300     MOVE SPACES              TO SN005-PO4-FILLER                 20130040
201400     MOVE SN005-PO4-SEGMENT   TO PVO-ASN-DATA-RECORD.             20140040
201500     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     20150040
201600     ADD  +1                  TO PV-SEQ-NBR.                      20160040
201700     PERFORM 8400-WRITE-OUTPUT-RECORD.                            20170040
201800                                                                  20180040
201900     IF  PV-UCC128-NUMBER = ZERO                                  20190040
202000         PERFORM 4450-GET-MAX-UCC128                              20200040
202100     END-IF.                                                      20210040
202110                                                                  20211040
202120* DMH                                                             20212040
202130     IF  PVI-GENERATE-UPS-TRACK                                   20213040
202140         IF  PV-UPS-TRACK-11-18  > 0                              20214040
202150             ADD  1  TO  PV-UPS-TRACK-11-18                       20215040
202160             SET  PS-UNIQUE-TRACK-NO  TO  TRUE                    20216040
202170             PERFORM 2050-CHECK-FOR-DUP-TRACK                     20217040
202180                     UNTIL PS-UNIQUE-TRACK                        20218040
202190             DISPLAY PV-UPS-TRACK-NUMBER                          20219040
202191         END-IF                                                   20219140
202192     END-IF.                                                      20219240
202193* DMH                                                             20219340
202194                                                                  20219440
202195* CREATE 'MAN' SEGMENT                                            20219540
202196     MOVE 'MAN'               TO SN005-MAN-ID.                    20219640
202197     MOVE 'GM'                TO SN005-MAN01-NBR-QUAL-CDE.        20219740
202198     ADD  +1                  TO PV-UCC128-NUMBER.                20219840
202199     MOVE PV-UCC128-NUMBER    TO PV-UCC128-18.                    20219940
202200     MOVE PV-UCC128-CHAR      TO SN005-MAN02-NBR.                 20220040
202300                                                                  20230040
202400* DMH                                                             20240040
202500     IF  PVI-GENERATE-UPS-TRACK                                   20250040
202600         MOVE 'CP'                TO SN005-MAN04-NBR-QUAL-CDE     20260040
202700         MOVE PV-UPS-TRACK-NUMBER TO SN005-MAN05-NBR              20270040
202800     ELSE                                                         20280040
202810         MOVE SPACES              TO SN005-MAN04-NBR-QUAL-CDE     20281040
202820                                     SN005-MAN05-NBR              20282040
202830     END-IF.                                                      20283040
202840* DMH                                                             20284040
202850                                                                  20285040
202860     MOVE SPACES              TO SN005-MAN-FILLER.                20286040
202870     MOVE SN005-MAN-SEGMENT   TO PVO-ASN-DATA-RECORD.             20287040
202880     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     20288040
202890     ADD  +1                  TO PV-SEQ-NBR                       20289040
202900                                 PV-TD1-ORDER-CRTN-COUNT          20290040
203000                                 PV-TD1-SHIP-CRTN-COUNT.          20300040
203100     PERFORM 8400-WRITE-OUTPUT-RECORD.                            20310040
203200                                                                  20320040
203300 4450-GET-MAX-UCC128.                                             20330040
203400                                                                  20340040
203500     MOVE '4450-GET-MAX-UCC128        '  TO PV-ABEND-PARAGRAPH.   20350040
203600     MOVE PC-MIN-UCC128-RANGE            TO DK-UCC128-MIN.        20360040
203700     MOVE PC-MAX-UCC128-RANGE            TO DK-UCC128-MAX.        20370040
203800                                                                  20380040
203900      EXEC SQL                                                    20390040
204000                SELECT MAX(SHIPT_UNT_ID)                          20400040
204100                INTO  :SHPUNT-SHIPT-UNT-ID                        20410040
204200                  FROM TSHPUNT                                    20420040
204300                WHERE SHIPT_UNT_ID   >= :DK-UCC128-MIN            20430040
204400                  AND SHIPT_UNT_ID   <= :DK-UCC128-MAX            20440040
204500                WITH UR                                           20450040
204600      END-EXEC.                                                   20460040
204700                                                                  20470040
204800       EVALUATE TRUE                                              20480040
204900            WHEN SQLCODE = ZERO                                   20490040
205000            WHEN SQLCODE = -811                                   20500040
205100                MOVE SHPUNT-SHIPT-UNT-ID TO PV-UCC128-NUMBER      20510040
205200            WHEN SQLCODE = +100                                   20520040
205300                MOVE PC-MIN-UCC128-RANGE TO PV-UCC128-NUMBER      20530040
205400            WHEN OTHER                                            20540040
205500                MOVE  SQLCODE          TO  PV-SQLCODE             20550040
205600                MOVE 'SELECT MAX TSHPUNT        '                 20560040
205700                                     TO PV-DB2-OPERATION-MESSAGE-120570040
205800                STRING ' NO DATA      '        DELIMITED BY SIZE  20580040
205900                                   INTO PV-DB2-OPERATION-MESSAGE-220590040
206000                MOVE 'TSHPUNT'           TO PV-DB2-TABLE-NAME-1   20600040
206100                PERFORM 9999-SQL-ABEND                            20610040
206200        END-EVALUATE.                                             20620040
206300                                                                  20630040
206400                                                                  20640040
206500 4480-CLOSE-BULK-CASE-CURSOR.                                     20650040
206600                                                                  20660040
206700     MOVE '4480-CLOSE-BULK-CASE-CURSOR'  TO PV-ABEND-PARAGRAPH.   20670040
206800                                                                  20680040
206900     EXEC SQL                                                     20690040
207000         CLOSE BULK-CASE-CRTN-CURSOR                              20700040
207100     END-EXEC.                                                    20710040
207200                                                                  20720040
207300     EVALUATE TRUE                                                20730040
207400         WHEN SQLCODE = ZERO                                      20740040
207500         WHEN SQLCODE = -904                                      20750040
207600         WHEN SQLCODE = -911                                      20760040
207700              CONTINUE                                            20770040
207800         WHEN SQLWARN0 NOT = SPACES                               20780040
207900         WHEN SQLCODE < ZERO                                      20790040
208000         WHEN SQLCODE > ZERO                                      20800040
208100              MOVE '4480-CLOSE-BULK-CASE-CURSOR'                  20810040
208200                              TO PV-PARAGRAPH-NAME                20820040
208300              MOVE 'CLOSE THE BULK CASE CURSOR     '              20830040
208400                              TO PV-DB2-OPERATION-ATTEMPTED       20840040
208500              PERFORM 9999-SQL-ABEND                              20850040
208600     END-EVALUATE.                                                20860040
208700                                                                  20870040
208800******************************************************************20880040
208900** THIS WILL BUILD THE PICK PACK ASN FOR THE BULK OR CASE         20890040
209000** PACKAGE CODE.                                                  20900040
209100******************************************************************20910040
209200                                                                  20920040
209300 4600-BUILD-BULK-CASE-PICKPACK.                                   20930040
209400                                                                  20940040
209500     MOVE 'O ' TO PV-HL03-LVL-CDE.                                20950040
209600     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      20960040
209700     PERFORM 2420-GENERATE-PRF-SEGMENT.                           20970040
209800                                                                  20980040
209900* ORDER LEVEL TD1 SEGMENT WILL BE CREATED WHEN PO FOR DC HAS      20990040
210000* BEEN PROCESSED BY NEEDS TO FIT INTO THE DATA AT THIS POINT      21000040
210100* THUS SAVING THE SEQUENCE NUMBER FOR USE LATER WHEN THE DATA     21010040
210200* IS WRITTEN.                                                     21020040
210300     MOVE PV-SEQ-NBR TO PV-HOLD-TD1-ORDER-SEQ-NBR.                21030040
210400     ADD  +1         TO PV-SEQ-NBR.                               21040040
210500                                                                  21050040
210600     PERFORM 2430-GENERATE-REF-ORD-SEGMENT.                       21060040
210700     MOVE PVI-DC-NBR TO PV-HOLD-N1-SHIP-NBR.                      21070040
210800     PERFORM 2440-GENERATE-N1-ORDER-SEGMENT.                      21080040
210900                                                                  21090040
211000     MOVE PVI-PO-NBR                TO DK-PO-NBR.                 21100040
211100     MOVE PVI-DC-NBR                TO DK-DC-NBR.                 21110040
211200     COMPUTE PV-PERCENT-OF-PO-UNITS ROUNDED =                     21120040
211300             PVI-PERCENT-OF-PO-UNITS / 100.                       21130040
211400     SET PS-NOT-EOF-CURSOR TO TRUE.                               21140040
211500     PERFORM 4610-OPEN-BULK-CASE-CURSOR.                          21150040
211600     PERFORM 4620-FETCH-BULK-CASE-CURSOR                          21160040
211700       UNTIL PS-EOF-CURSOR.                                       21170040
211800     PERFORM 4680-CLOSE-BULK-CASE-CURSOR.                         21180040
211900                                                                  21190040
212000* BUILD ORDER LEVEL TD1                                           21200040
212100     MOVE 'TD1'               TO SN005-TD1-ID.                    21210040
212200     MOVE 'CTN25'             TO SN005-TD101-PKG-CDE.             21220040
212300     MOVE PV-TD1-ORDER-CRTN-COUNT                                 21230040
212400                              TO SN005-TD102-SHIPT-QTY.           21240040
212500     MOVE SPACES              TO SN005-TD106-WGHT-QUAL-CDE.       21250040
212600     MOVE ZEROS               TO SN005-TD107-WGHT-MSMT.           21260040
212700     MOVE SPACES              TO SN005-TD108-UM-CDE.              21270040
212800     MOVE SPACES              TO SN005-TD1-FILLER.                21280040
212900     MOVE SN005-TD1-SEGMENT   TO PVO-ASN-DATA-RECORD.             21290040
213000     MOVE PV-HOLD-TD1-ORDER-SEQ-NBR                               21300040
213100                              TO PVO-SEQ-NBR.                     21310040
213200     PERFORM 8400-WRITE-OUTPUT-RECORD.                            21320040
213300                                                                  21330040
213400 4610-OPEN-BULK-CASE-CURSOR.                                      21340040
213500                                                                  21350040
213600     MOVE '4610-OPEN-BULK-CASE-CURSOR'  TO PV-ABEND-PARAGRAPH.    21360040
213700                                                                  21370040
213800     EXEC SQL                                                     21380040
213900          OPEN BULK-CASE-CRTN-CURSOR                              21390040
214000     END-EXEC.                                                    21400040
214100                                                                  21410040
214200     EVALUATE TRUE                                                21420040
214300         WHEN SQLCODE = 0                                         21430040
214400             CONTINUE                                             21440040
214500         WHEN SQLWARN0 NOT = SPACES                               21450040
214600         WHEN SQLCODE < ZERO                                      21460040
214700         WHEN SQLCODE > ZERO                                      21470040
214800             MOVE '4610-OPEN-BULK-CASE-CURSOR'                    21480040
214900                             TO PV-PARAGRAPH-NAME                 21490040
215000             MOVE 'OPEN THE BULK CASE CURSOR      '               21500040
215100                             TO PV-DB2-OPERATION-ATTEMPTED        21510040
215200             PERFORM 9999-SQL-ABEND                               21520040
215300     END-EVALUATE.                                                21530040
215400                                                                  21540040
215500                                                                  21550040
215600 4620-FETCH-BULK-CASE-CURSOR.                                     21560040
215700                                                                  21570040
215800     MOVE '4620-FETCH-BULK-CASE-CURSOR'   TO PV-ABEND-PARAGRAPH.  21580040
215900                                                                  21590040
216000     EXEC SQL                                                     21600040
216100          FETCH BULK-CASE-CRTN-CURSOR                             21610040
216200          INTO  :PURCHS-PO-NBR                                    21620040
216300              , :PURITM-PO-LNE-NBR                                21630040
216400              , :XLT00006-UPC-NBR                                 21640040
216500              , :PURITM-INNR-PK-QTY                               21650040
216600              , :PURITM-OUTR-PK-QTY                               21660040
216700              , :ALLPLN-CURR-SPLIT-QTY                            21670040
216800              , :PV-CURR-SPLIT-PCT-QTY                            21680040
216900     END-EXEC.                                                    21690040
217000                                                                  21700040
217100     EVALUATE TRUE                                                21710040
217200       WHEN SQLCODE = ZEROS                                       21720040
217300            PERFORM 4630-PROCESS-FETCH                            21730040
217400       WHEN SQLCODE = +100                                        21740040
217500            SET PS-EOF-CURSOR  TO TRUE                            21750040
217600       WHEN SQLWARN0 NOT = SPACES                                 21760040
217700       WHEN SQLCODE < ZERO                                        21770040
217800       WHEN SQLCODE > ZERO                                        21780040
217900           MOVE '4620-FETCH-BULK-CASE-CURSOR'                     21790040
218000                               TO PV-PARAGRAPH-NAME               21800040
218100           MOVE 'FETCH THE BULK CASE CURSOR     '                 21810040
218200                               TO PV-DB2-OPERATION-ATTEMPTED      21820040
218300           PERFORM 9999-SQL-ABEND                                 21830040
218400     END-EVALUATE.                                                21840040
218500                                                                  21850040
218600 4630-PROCESS-FETCH.                                              21860040
218700                                                                  21870040
218800     COMPUTE PV-CARTON-QTY ROUNDED =                              21880040
218900             PV-CURR-SPLIT-PCT-QTY / PURITM-OUTR-PK-QTY.          21890040
219000                                                                  21900040
219100     PERFORM 4640-GENERATE-CARTON-DATA                            21910040
219200             VARYING PV-LOOP-COUNT FROM 1 BY 1                    21920040
219300               UNTIL PV-LOOP-COUNT > PV-CARTON-QTY.               21930040
219400                                                                  21940040
219500                                                                  21950040
219600 4640-GENERATE-CARTON-DATA.                                       21960040
219700                                                                  21970040
219800     MOVE 'P ' TO PV-HL03-LVL-CDE.                                21980040
219900     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      21990040
220000                                                                  22000040
220100     IF  PV-UCC128-NUMBER = ZERO                                  22010040
220200         PERFORM 4650-GET-MAX-UCC128                              22020040
220300     END-IF.                                                      22030040
220400                                                                  22040040
220500* DMH                                                             22050040
220600     IF  PVI-GENERATE-UPS-TRACK                                   22060040
220700         IF  PV-UPS-TRACK-11-18  > 0                              22070040
220710             ADD  1  TO  PV-UPS-TRACK-11-18                       22071040
220720             SET  PS-UNIQUE-TRACK-NO  TO  TRUE                    22072040
220730             PERFORM 2050-CHECK-FOR-DUP-TRACK                     22073040
220740                     UNTIL PS-UNIQUE-TRACK                        22074040
220750             DISPLAY PV-UPS-TRACK-NUMBER                          22075040
220760         END-IF                                                   22076040
220770     END-IF.                                                      22077040
220780* DMH                                                             22078040
220790                                                                  22079040
220800* CREATE 'MAN' SEGMENT                                            22080040
220900     MOVE 'MAN'               TO SN005-MAN-ID.                    22090040
221000     MOVE 'GM'                TO SN005-MAN01-NBR-QUAL-CDE.        22100040
221100     ADD  +1                  TO PV-UCC128-NUMBER.                22110040
221200     MOVE PV-UCC128-NUMBER    TO PV-UCC128-18.                    22120040
221300     MOVE PV-UCC128-CHAR      TO SN005-MAN02-NBR.                 22130040
221400                                                                  22140040
221410* DMH                                                             22141040
221420     IF  PVI-GENERATE-UPS-TRACK                                   22142040
221430         MOVE 'CP'                TO SN005-MAN04-NBR-QUAL-CDE     22143040
221440         MOVE PV-UPS-TRACK-NUMBER TO SN005-MAN05-NBR              22144040
221450     ELSE                                                         22145040
221460         MOVE SPACES              TO SN005-MAN04-NBR-QUAL-CDE     22146040
221470                                     SN005-MAN05-NBR              22147040
221480     END-IF.                                                      22148040
221490* DMH                                                             22149040
221491                                                                  22149140
221492     MOVE SPACES              TO SN005-MAN-FILLER.                22149240
221493     MOVE SN005-MAN-SEGMENT   TO PVO-ASN-DATA-RECORD.             22149340
221494     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     22149440
221495     ADD  +1                  TO PV-SEQ-NBR                       22149540
221496                                 PV-TD1-ORDER-CRTN-COUNT          22149640
221497                                 PV-TD1-SHIP-CRTN-COUNT.          22149740
221498     PERFORM 8400-WRITE-OUTPUT-RECORD.                            22149840
221499                                                                  22149940
221500* CREATE 'HL ' ITEM SEGMENT                                       22150040
221600     MOVE 'I ' TO PV-HL03-LVL-CDE.                                22160040
221700     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      22170040
221800                                                                  22180040
221900* CREATE 'LIN' SEGMENT                                            22190040
222000     MOVE SPACES              TO SN005-LIN-SEGMENT.               22200040
222100     MOVE 'LIN'               TO SN005-LIN-ID.                    22210040
222200     MOVE SPACES              TO SN005-LIN01-ID-CDE.              22220040
222300     MOVE 'UP'                TO SN005-LIN02-PROD-ID-QUAL-CDE (1).22230040
222400     MOVE XLT00006-UPC-NBR    TO PV-UPC-NBR.                      22240040
222500     MOVE PV-UPC-NBR          TO SN005-LIN03-PROD-ID (1).         22250040
222600     MOVE SN005-LIN-SEGMENT   TO PVO-ASN-DATA-RECORD.             22260040
222700     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     22270040
222800     ADD  +1                  TO PV-SEQ-NBR.                      22280040
222900     PERFORM 8400-WRITE-OUTPUT-RECORD.                            22290040
223000                                                                  22300040
223100* CREATE 'SN1' SEGMENT                                            22310040
223200     MOVE 'SN1'               TO SN005-SN1-ID.                    22320040
223300     MOVE SPACES              TO SN005-SN101-ID-CDE.              22330040
223400     MOVE PURITM-OUTR-PK-QTY  TO SN005-SN102-SHIP-QTY.            22340040
223500     MOVE 'EA'                TO SN005-SN103-SHIP-UM-CDE.         22350040
223600     MOVE ZEROS               TO SN005-SN104-SHIPT-DTE-QTY.       22360040
223700     MOVE ZEROS               TO SN005-SN105-ORD-QTY.             22370040
223800     MOVE SPACES              TO SN005-SN106-ORD-UM-CDE.          22380040
223900     MOVE SPACES              TO SN005-SN1-FILLER.                22390040
224000     MOVE SN005-SN1-SEGMENT   TO PVO-ASN-DATA-RECORD.             22400040
224100     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     22410040
224200     ADD  +1                  TO PV-SEQ-NBR.                      22420040
224300     PERFORM 8400-WRITE-OUTPUT-RECORD.                            22430040
224400                                                                  22440040
224500 4650-GET-MAX-UCC128.                                             22450040
224600                                                                  22460040
224700     MOVE '4650-GET-MAX-UCC128        '  TO PV-ABEND-PARAGRAPH.   22470040
224800     MOVE PC-MIN-UCC128-RANGE            TO DK-UCC128-MIN.        22480040
224900     MOVE PC-MAX-UCC128-RANGE            TO DK-UCC128-MAX.        22490040
225000                                                                  22500040
225100      EXEC SQL                                                    22510040
225200                SELECT MAX(SHIPT_UNT_ID)                          22520040
225300                INTO  :SHPUNT-SHIPT-UNT-ID                        22530040
225400                  FROM TSHPUNT                                    22540040
225500                WHERE SHIPT_UNT_ID   >= :DK-UCC128-MIN            22550040
225600                  AND SHIPT_UNT_ID   <= :DK-UCC128-MAX            22560040
225700                WITH UR                                           22570040
225800      END-EXEC.                                                   22580040
225900                                                                  22590040
226000       EVALUATE TRUE                                              22600040
226100            WHEN SQLCODE = ZERO                                   22610040
226200            WHEN SQLCODE = -811                                   22620040
226300                MOVE SHPUNT-SHIPT-UNT-ID TO PV-UCC128-NUMBER      22630040
226400            WHEN SQLCODE = +100                                   22640040
226500                MOVE PC-MIN-UCC128-RANGE TO PV-UCC128-NUMBER      22650040
226600            WHEN OTHER                                            22660040
226700                MOVE  SQLCODE          TO  PV-SQLCODE             22670040
226800                MOVE 'SELECT MAX TSHPUNT        '                 22680040
226900                                     TO PV-DB2-OPERATION-MESSAGE-122690040
227000                STRING ' NO DATA      '        DELIMITED BY SIZE  22700040
227100                                   INTO PV-DB2-OPERATION-MESSAGE-222710040
227200                MOVE 'TSHPUNT'           TO PV-DB2-TABLE-NAME-1   22720040
227300                PERFORM 9999-SQL-ABEND                            22730040
227400        END-EVALUATE.                                             22740040
227500                                                                  22750040
227600                                                                  22760040
227700 4680-CLOSE-BULK-CASE-CURSOR.                                     22770040
227800                                                                  22780040
227900     MOVE '4680-CLOSE-BULK-CASE-CURSOR'  TO PV-ABEND-PARAGRAPH.   22790040
228000                                                                  22800040
228100     EXEC SQL                                                     22810040
228200         CLOSE BULK-CASE-CRTN-CURSOR                              22820040
228300     END-EXEC.                                                    22830040
228400                                                                  22840040
228500     EVALUATE TRUE                                                22850040
228600         WHEN SQLCODE = ZERO                                      22860040
228700         WHEN SQLCODE = -904                                      22870040
228800         WHEN SQLCODE = -911                                      22880040
228900              CONTINUE                                            22890040
229000         WHEN SQLWARN0 NOT = SPACES                               22900040
229100         WHEN SQLCODE < ZERO                                      22910040
229200         WHEN SQLCODE > ZERO                                      22920040
229300              MOVE '4680-CLOSE-BULK-CASE-CURSOR'                  22930040
229400                              TO PV-PARAGRAPH-NAME                22940040
229500              MOVE 'CLOSE THE BULK CASE CURSOR     '              22950040
229600                              TO PV-DB2-OPERATION-ATTEMPTED       22960040
229700              PERFORM 9999-SQL-ABEND                              22970040
229800     END-EVALUATE.                                                22980040
229900                                                                  22990040
230000 4800-BUILD-PBS.                                                  23000040
230100                                                                  23010040
230200     MOVE PVI-PO-NBR                TO DK-PO-NBR.                 23020040
230300     MOVE PVI-DC-NBR                TO DK-DC-NBR.                 23030040
230400     COMPUTE PV-PERCENT-OF-PO-UNITS ROUNDED =                     23040040
230500             PVI-PERCENT-OF-PO-UNITS / 100.                       23050040
230600     MOVE ZEROS TO PV-PREV-STR-NBR.                               23060040
230700     SET PS-NOT-EOF-CURSOR TO TRUE.                               23070040
230800     PERFORM 4810-OPEN-PBS-CURSOR.                                23080040
230900     PERFORM 4820-FETCH-PBS-CURSOR                                23090040
231000       UNTIL PS-EOF-CURSOR.                                       23100040
231100     PERFORM 4870-CLOSE-PBS-CURSOR.                               23110040
231200                                                                  23120040
231300     PERFORM 4860-BUILD-PBS-TD1.                                  23130040
231400     MOVE ZERO TO PV-TD1-ORDER-CRTN-COUNT.                        23140040
231500                                                                  23150040
231600 4810-OPEN-PBS-CURSOR.                                            23160040
231700                                                                  23170040
231800     MOVE '4810-OPEN-PBS-CURSOR' TO PV-ABEND-PARAGRAPH.           23180040
231900                                                                  23190040
232000     EXEC SQL                                                     23200040
232100          OPEN PACK-BY-STORE-CURSOR                               23210040
232200     END-EXEC.                                                    23220040
232300                                                                  23230040
232400     EVALUATE TRUE                                                23240040
232500         WHEN SQLCODE = 0                                         23250040
232600             CONTINUE                                             23260040
232700         WHEN SQLWARN0 NOT = SPACES                               23270040
232800         WHEN SQLCODE < ZERO                                      23280040
232900         WHEN SQLCODE > ZERO                                      23290040
233000             MOVE '4810-OPEN-PBS-CURSOR    '                      23300040
233100                             TO PV-PARAGRAPH-NAME                 23310040
233200             MOVE 'OPEN THE PACK BY STORE CURSOR'                 23320040
233300                             TO PV-DB2-OPERATION-ATTEMPTED        23330040
233400             PERFORM 9999-SQL-ABEND                               23340040
233500     END-EVALUATE.                                                23350040
233600                                                                  23360040
233700                                                                  23370040
233800 4820-FETCH-PBS-CURSOR.                                           23380040
233900                                                                  23390040
234000     MOVE '4820-FETCH-PBS-CURSOR        ' TO PV-ABEND-PARAGRAPH.  23400040
234100                                                                  23410040
234200     EXEC SQL                                                     23420040
234300          FETCH PACK-BY-STORE-CURSOR                              23430040
234400          INTO  :PURITM-PO-NBR                                    23440040
234500              , :ALLPLN-DEST-NBR                                  23450040
234600              , :PURITM-PO-LNE-NBR                                23460040
234700              , :ALLPLN-CURR-SPLIT-QTY                            23470040
234800              , :MESTDS-STR-NBR                                   23480040
234900              , :MESTDS-STR-DISTRO-QTY                            23490040
235000              , :XLT00006-UPC-NBR                                 23500040
235100              , :PV-STR-DISTRO-PCT-QTY                            23510040
235200     END-EXEC.                                                    23520040
235300                                                                  23530040
235400     EVALUATE TRUE                                                23540040
235500       WHEN SQLCODE = ZEROS                                       23550040
235600            PERFORM 4830-PROCESS-FETCH                            23560040
235700       WHEN SQLCODE = +100                                        23570040
235800            SET PS-EOF-CURSOR  TO TRUE                            23580040
235900       WHEN SQLWARN0 NOT = SPACES                                 23590040
236000       WHEN SQLCODE < ZERO                                        23600040
236100       WHEN SQLCODE > ZERO                                        23610040
236200           MOVE '4820-FETCH-PBS-CURSOR        '                   23620040
236300                               TO PV-PARAGRAPH-NAME               23630040
236400           MOVE 'FETCH THE PACK-BY-STORE CURSOR'                  23640040
236500                               TO PV-DB2-OPERATION-ATTEMPTED      23650040
236600           PERFORM 9999-SQL-ABEND                                 23660040
236700     END-EVALUATE.                                                23670040
236800                                                                  23680040
236900 4830-PROCESS-FETCH.                                              23690040
237000                                                                  23700040
237100     IF  MESTDS-STR-NBR       = PV-PREV-STR-NBR                   23710040
237200         PERFORM 4840-GENERATE-CARTON-DATA                        23720040
237300     ELSE                                                         23730040
237400         IF  PV-PREV-STR-NBR > 0                                  23740040
237500             PERFORM 4860-BUILD-PBS-TD1                           23750040
237600             MOVE ZERO TO PV-TD1-ORDER-CRTN-COUNT                 23760040
237700         END-IF                                                   23770040
237800         MOVE 999   TO PV-STR-TOTAL-IN-CRTN-QTY                   23780040
237900         MOVE 'O ' TO PV-HL03-LVL-CDE                             23790040
238000         PERFORM 2410-GENERATE-HL-ORDER-SEGMENT                   23800040
238100         PERFORM 2420-GENERATE-PRF-SEGMENT                        23810040
238200* ORDER LEVEL TD1 SEGMENT WILL BE CREATED WHEN PO FOR DC HAS      23820040
238300* BEEN PROCESSED BY NEEDS TO FIT INTO THE DATA AT THIS POINT      23830040
238400* THUS SAVING THE SEQUENCE NUMBER FOR USE LATER WHEN THE DATA     23840040
238500* IS WRITTEN.                                                     23850040
238600         MOVE PV-SEQ-NBR TO PV-HOLD-TD1-ORDER-SEQ-NBR             23860040
238700         ADD  +1         TO PV-SEQ-NBR                            23870040
238800         PERFORM 2430-GENERATE-REF-ORD-SEGMENT                    23880040
238900         MOVE MESTDS-STR-NBR     TO PV-PREV-STR-NBR               23890040
239000         MOVE MESTDS-STR-NBR     TO PV-HOLD-N1-SHIP-NBR           23900040
239100         PERFORM 2440-GENERATE-N1-ORDER-SEGMENT                   23910040
239200         PERFORM 4840-GENERATE-CARTON-DATA                        23920040
239300     END-IF.                                                      23930040
239400                                                                  23940040
239500 4840-GENERATE-CARTON-DATA.                                       23950040
239600                                                                  23960040
239700     IF  PV-STR-TOTAL-IN-CRTN-QTY >= 14                           23970040
239800         MOVE ZEROS TO PV-STR-TOTAL-IN-CRTN-QTY                   23980040
239900         PERFORM 4850-GENERATE-HL-MAN-SEGMENT                     23990040
240000     END-IF.                                                      24000040
240100                                                                  24010040
240200* CREATE 'HL ' ITEM LEVEL SEGMENT                                 24020040
240300     MOVE 'I ' TO PV-HL03-LVL-CDE.                                24030040
240400     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      24040040
240500                                                                  24050040
240600* CREATE 'LIN' SEGMENT                                            24060040
240700     MOVE SPACES               TO SN005-LIN-SEGMENT.              24070040
240800     MOVE 'LIN'                TO SN005-LIN-ID.                   24080040
240900     MOVE SPACES               TO SN005-LIN01-ID-CDE.             24090040
241000     MOVE 'UP'                TO SN005-LIN02-PROD-ID-QUAL-CDE (1).24100040
241100     MOVE XLT00006-UPC-NBR     TO PV-UPC-NBR.                     24110040
241200     MOVE PV-UPC-NBR          TO SN005-LIN03-PROD-ID (1).         24120040
241300     MOVE SN005-LIN-SEGMENT   TO PVO-ASN-DATA-RECORD.             24130040
241400     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     24140040
241500     ADD  +1                  TO PV-SEQ-NBR.                      24150040
241600     PERFORM 8400-WRITE-OUTPUT-RECORD.                            24160040
241700                                                                  24170040
241800* CREATE 'SN1' SEGMENT                                            24180040
241900     MOVE 'SN1'               TO SN005-SN1-ID.                    24190040
242000     MOVE SPACES              TO SN005-SN101-ID-CDE.              24200040
242100     IF  PV-STR-DISTRO-PCT-QTY = 0                                24210040
242200         MOVE 1               TO SN005-SN102-SHIP-QTY             24220040
242300         ADD  1               TO PV-STR-TOTAL-IN-CRTN-QTY         24230040
242400     ELSE                                                         24240040
242500         MOVE PV-STR-DISTRO-PCT-QTY                               24250040
242600                              TO SN005-SN102-SHIP-QTY             24260040
242700         ADD  PV-STR-DISTRO-PCT-QTY                               24270040
242800                              TO PV-STR-TOTAL-IN-CRTN-QTY         24280040
242900     END-IF.                                                      24290040
243000     MOVE 'EA'                TO SN005-SN103-SHIP-UM-CDE.         24300040
243100     MOVE ZEROS               TO SN005-SN104-SHIPT-DTE-QTY.       24310040
243200     MOVE ZEROS               TO SN005-SN105-ORD-QTY.             24320040
243300     MOVE SPACES              TO SN005-SN106-ORD-UM-CDE.          24330040
243400     MOVE SPACES              TO SN005-SN1-FILLER.                24340040
243500     MOVE SN005-SN1-SEGMENT   TO PVO-ASN-DATA-RECORD.             24350040
243600     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     24360040
243700     ADD  +1                  TO PV-SEQ-NBR.                      24370040
243800     PERFORM 8400-WRITE-OUTPUT-RECORD.                            24380040
243900                                                                  24390040
244000 4850-GENERATE-HL-MAN-SEGMENT.                                    24400040
244100                                                                  24410040
244200* CREATE 'HL ' PACKAGE LEVEL SEGMENT                              24420040
244300     MOVE 'P ' TO PV-HL03-LVL-CDE.                                24430040
244400     PERFORM 2410-GENERATE-HL-ORDER-SEGMENT.                      24440040
244500                                                                  24450040
244600     IF  PV-UCC128-NUMBER = ZERO                                  24460040
244700         PERFORM 4450-GET-MAX-UCC128                              24470040
244800     END-IF.                                                      24480040
244900                                                                  24490040
245000* DMH                                                             24500040
245100     IF  PVI-GENERATE-UPS-TRACK                                   24510040
245200         IF  PV-UPS-TRACK-11-18  > 0                              24520040
245300             ADD  1  TO  PV-UPS-TRACK-11-18                       24530040
245400             SET  PS-UNIQUE-TRACK-NO  TO  TRUE                    24540040
245500             PERFORM 2050-CHECK-FOR-DUP-TRACK                     24550040
245600                     UNTIL PS-UNIQUE-TRACK                        24560040
245610             DISPLAY PV-UPS-TRACK-NUMBER                          24561040
245620         END-IF                                                   24562040
245630     END-IF.                                                      24563040
245640* DMH                                                             24564040
245650                                                                  24565040
245660* CREATE 'MAN' SEGMENT                                            24566040
245670     MOVE 'MAN'               TO SN005-MAN-ID.                    24567040
245680     MOVE 'GM'                TO SN005-MAN01-NBR-QUAL-CDE.        24568040
245690     ADD  +1                  TO PV-UCC128-NUMBER.                24569040
245700     MOVE PV-UCC128-NUMBER    TO PV-UCC128-18.                    24570040
245800     MOVE PV-UCC128-CHAR      TO SN005-MAN02-NBR.                 24580040
245900                                                                  24590040
246000* DMH                                                             24600040
246100     IF  PVI-GENERATE-UPS-TRACK                                   24610040
246200         MOVE 'CP'                TO SN005-MAN04-NBR-QUAL-CDE     24620040
246300         MOVE PV-UPS-TRACK-NUMBER TO SN005-MAN05-NBR              24630040
246310     ELSE                                                         24631040
246320         MOVE SPACES              TO SN005-MAN04-NBR-QUAL-CDE     24632040
246330                                     SN005-MAN05-NBR              24633040
246340     END-IF.                                                      24634040
246350* DMH                                                             24635040
246360                                                                  24636040
246370     MOVE SPACES              TO SN005-MAN-FILLER.                24637040
246380     MOVE SN005-MAN-SEGMENT   TO PVO-ASN-DATA-RECORD.             24638040
246390     MOVE PV-SEQ-NBR          TO PVO-SEQ-NBR.                     24639040
246400     ADD  +1                  TO PV-SEQ-NBR                       24640040
246500                                 PV-TD1-ORDER-CRTN-COUNT          24650040
246600                                 PV-TD1-SHIP-CRTN-COUNT.          24660040
246700     PERFORM 8400-WRITE-OUTPUT-RECORD.                            24670040
246800                                                                  24680040
246900 4860-BUILD-PBS-TD1.                                              24690040
247000                                                                  24700040
247100* BUILD ORDER LEVEL TD1                                           24710040
247200     MOVE 'TD1'               TO SN005-TD1-ID.                    24720040
247300     MOVE 'CTN25'             TO SN005-TD101-PKG-CDE.             24730040
247400     MOVE PV-TD1-ORDER-CRTN-COUNT                                 24740040
247500                              TO SN005-TD102-SHIPT-QTY.           24750040
247600     MOVE SPACES              TO SN005-TD106-WGHT-QUAL-CDE.       24760040
247700     MOVE ZEROS               TO SN005-TD107-WGHT-MSMT.           24770040
247800     MOVE SPACES              TO SN005-TD108-UM-CDE.              24780040
247900     MOVE SPACES              TO SN005-TD1-FILLER.                24790040
248000     MOVE SN005-TD1-SEGMENT   TO PVO-ASN-DATA-RECORD.             24800040
248100     MOVE PV-HOLD-TD1-ORDER-SEQ-NBR                               24810040
248200                              TO PVO-SEQ-NBR.                     24820040
248300     PERFORM 8400-WRITE-OUTPUT-RECORD.                            24830040
248400                                                                  24840040
248500 4870-CLOSE-PBS-CURSOR.                                           24850040
248600                                                                  24860040
248700     MOVE '4870-CLOSE-PBS-CURSOR    ' TO PV-ABEND-PARAGRAPH.      24870040
248800                                                                  24880040
248900     EXEC SQL                                                     24890040
249000         CLOSE PACK-BY-STORE-CURSOR                               24900040
249100     END-EXEC.                                                    24910040
249200                                                                  24920040
249300     EVALUATE TRUE                                                24930040
249400         WHEN SQLCODE = ZERO                                      24940040
249500         WHEN SQLCODE = -904                                      24950040
249600         WHEN SQLCODE = -911                                      24960040
249700              CONTINUE                                            24970040
249800         WHEN SQLWARN0 NOT = SPACES                               24980040
249900         WHEN SQLCODE < ZERO                                      24990040
250000         WHEN SQLCODE > ZERO                                      25000040
250100              MOVE '4870-CLOSE-PBS-CURSOR        '                25010040
250200                              TO PV-PARAGRAPH-NAME                25020040
250300              MOVE 'CLOSE THE PACK-BY-STORE CURSOR'               25030040
250400                              TO PV-DB2-OPERATION-ATTEMPTED       25040040
250500              PERFORM 9999-SQL-ABEND                              25050040
250600     END-EVALUATE.                                                25060040
250700                                                                  25070040
250800                                                                  25080040
250900                                                                  25090040
251000 6200-GET-VENDOR-INFO.                                            25100040
251100                                                                  25110040
251200      MOVE '6200-GET-VENDOR-INFO   '      TO PV-ABEND-PARAGRAPH.  25120040
251300      MOVE PVI-PO-NBR                     TO DK-PO-NBR.           25130040
251400                                                                  25140040
251500      EXEC SQL                                                    25150040
251600                SELECT B.ENT_ID , B.DUN_NBR , A.PKGNG_CDE         25160040
251700                     , A.DEPT_NBR                                 25170040
251800                INTO  :EXTENT-ENT-ID                              25180040
251900                   ,  :EXTENT-DUN-NBR                             25190040
252000                   ,  :PURCHS-PKGNG-CDE                           25200040
252100                   ,  :PURCHS-DEPT-NBR                            25210040
252200                  FROM TPURCHS A                                  25220040
252300                     , TEXTENT B                                  25230040
252400                WHERE A.PO_NBR       = :DK-PO-NBR                 25240040
252500                  AND A.VER_STATUS_CDE = 'A'                      25250040
252600                  AND B.ENT_ID         = A.ENT_ID                 25260040
252700                WITH UR                                           25270040
252800      END-EXEC.                                                   25280040
252900                                                                  25290040
253000       EVALUATE TRUE                                              25300040
253100            WHEN SQLCODE = ZERO                                   25310040
253200            WHEN SQLCODE = -811                                   25320040
253300                CONTINUE                                          25330040
253400            WHEN SQLCODE = +100                                   25340040
253500                ADD +1 TO PV-NO-INBOUND-COUNTER                   25350040
253600                DISPLAY 'PO OR VEDOR DOES NOT EXIST'              25360040
253700                DISPLAY 'PO NBR:  ' PVI-PO-NBR                    25370040
253800            WHEN OTHER                                            25380040
253900                MOVE  SQLCODE          TO  PV-SQLCODE             25390040
254000                MOVE 'SELECT TPURCHS AND TEXTENT '                25400040
254100                                     TO PV-DB2-OPERATION-MESSAGE-125410040
254200                STRING ' PO NUMBER -  '        DELIMITED BY SIZE  25420040
254300                       PVI-PO-NBR              DELIMITED BY SIZE  25430040
254400                                   INTO PV-DB2-OPERATION-MESSAGE-225440040
254500                MOVE 'TPURCHS'           TO PV-DB2-TABLE-NAME-1   25450040
254600                MOVE 'TEXTENT'           TO PV-DB2-TABLE-NAME-2   25460040
254700                PERFORM 9999-SQL-ABEND                            25470040
254800        END-EVALUATE.                                             25480040
254900                                                                  25490040
255000 8000-READ-INPUT.                                                 25500040
255100******************************************************************25510040
255200*  READ THE INPUT FILE                                            25520040
255300******************************************************************25530040
255400     READ INPUT-FILE                                              25540040
255500          INTO PV-INPUT                                           25550040
255600          AT END                                                  25560040
255700             SET PS-EOF-INPUT TO TRUE.                            25570040
255800                                                                  25580040
255900     IF PS-EOF-INPUT                                              25590040
256000        CONTINUE                                                  25600040
256100     ELSE                                                         25610040
256200        ADD +1 TO PV-INPUT-COUNTER                                25620040
256300        ADD +1 TO PV-INPUT-DISPLAY-COUNTER                        25630040
256400        DISPLAY 'PO NUMBER     : ' PVI-PO-NBR                     25640040
256500        DISPLAY 'DC NUMBER     : ' PVI-DC-NBR                     25650040
256600        DISPLAY 'TRAILER NUMBER: ' PVI-TRAILER-NBR                25660040
256700        DISPLAY ' '                                               25670040
256800     END-IF.                                                      25680040
256900                                                                  25690040
257000     IF  PV-INPUT-DISPLAY-COUNTER = 2000                          25700040
257100         MOVE PV-INPUT-COUNTER       TO PV-DISPLAY-FIELD          25710040
257200         DISPLAY 'READ INPUT RECORD: '                            25720040
257300                 PV-DISPLAY-FIELD                                 25730040
257400         MOVE ZEROS TO PV-INPUT-DISPLAY-COUNTER                   25740040
257500     END-IF.                                                      25750040
257600                                                                  25760040
257700******************************************************************25770040
257800* WRITES TO THE OUTPUT FILE                                       25780040
257900******************************************************************25790040
258000 8400-WRITE-OUTPUT-RECORD.                                        25800040
258100                                                                  25810040
258200     WRITE OUTPUT-RECORD                                          25820040
258300        FROM PV-OUTPUT.                                           25830040
258400        ADD  1  TO  PV-OUTPUT-COUNTER.                            25840040
258500                                                                  25850040
258600 9000-EOJ-ROUTINE.                                                25860040
258700******************************************************************25870040
258800*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                          25880040
258900******************************************************************25890040
259000     CLOSE INPUT-FILE.                                            25900040
259100     CLOSE OUTPUT-FILE.                                           25910040
259200                                                                  25920040
259300     MOVE PV-INPUT-COUNTER TO PV-DISPLAY-COUNT.                   25930040
259400     DISPLAY 'INPUT RECORDS READ:        ' PV-DISPLAY-COUNT.      25940040
259500     MOVE PV-OUTPUT-COUNTER TO PV-DISPLAY-COUNT.                  25950040
259600     DISPLAY 'OUTPUT RECORDS WRITTEN:    ' PV-DISPLAY-COUNT.      25960040
259700                                                                  25970040
259800******************************************************************25980040
259900* ABEND PROCEDURE                                                *25990040
260000******************************************************************26000040
260100 9999-SQL-ABEND.                                                  26010040
260200     DISPLAY '** ABEND           ** = SQLABEND'.                  26020040
260300     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  26030040
260400     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       26040040
260500     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-1.      26050040
260600     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-2.      26060040
260700     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-3.      26070040
260800     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME-4.      26080040
260900     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-126090040
261000     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-226100040
261100     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-326110040
261200     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               26120040
261300     COPY DPPD004.                                                26130040
261400     MOVE +4013                  TO PV-ABEND-CODE.                26140040
261500     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       26150040
