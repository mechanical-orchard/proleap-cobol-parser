000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   TRKUT230.                                          00050000
000600 AUTHOR.       THERESE RAMSEYER / MARGARET MORRISON.              00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. AUGUST, 1998.                                      00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM EDITS THE VESSEL / VOYAGE ARRIVAL DATA.          *00120000
001300*  THE INPUT FOR THIS PROGRAM CONSISTS OF THE FOLLOWING RECORD    00130000
001400*  TYPES:                                                         00140000
001500*  ETA = ESTIMATED PORT OF ENTRY DATE AND ESTIMATED LAND BRIDGE   00150000
001600*        DATA.                                                    00160000
001700*  ADU = ACTUAL PORT OF ENTRY FIELDS.                             00170000
001800*  ADURDA = ACTUAL PORT OF ENTRY FIELDS RECYCLED FROM CONTAINER   00180000
001900*           LOAD PROCESSING                                       00190000
002000*                                                                 00200000
002100*  THE ETA REC-TYPE CAN ONLY BE A CHANGE TRANSACTION.             00210000
002200*  THE ADU REC-TYPE CAN BE (A) ADD, (D) DELETE OR (C) CHANGE.     00220000
002300*  THE ADURDA REC-TYPE CAN BE (A) ADD.                            00230000
002400*                                                                 00240000
002500*  THE KEY FIELDS ARE: PO NUMBER AND EXTERNAL REFERENCE NUMBER.   00250000
002600*                                                                 00260000
002700*  A PROCESS SEQUENCE NUMBER IS ASSIGNED TO EACH RECORD. THIS     00270000
002800*  NUMBER WILL BE REFLECTED IN THE LOAD PROGRAM ON EACH CONTAINER 00280000
002900*  RECORD. THIS WAY, THE ERROR EXTRACT CAN BE SORTED AND ALL OF   00290000
003000*  THE ERROR/WARNING MESSAGES WILL BE INCLUDED TOGETHER FOR EACH  00300000
003100*  CONTAINER RECORD WHETHER IT CAME FROM THE EDIT PROGRAM OR THE  00310000
003200*  LOAD.                                                          00320000
003300*  DATES ARE CHECKED FOR VALIDITY BY CALLING THE KOHL'S CALENDAR  00330000
003400*  ROUTINE DPKUT500.                                              00340000
003500*  TIME FIELDS ARE GENERALLY ONLY EDITED FOR VALIDITY IF THEY ARE 00350000
003600*  SENT. MOST ARE NOT REQUIRED SINCE IT IS NECESSARY TO USE A     00360000
003700*  DEFAULT TIME WHEN UPDATING AND DEFAULT DATE AND TIME WHEN      00370000
003800*  DELETING.                                                      00380000
003900* EACH RECORD TYPE IS INDEPENDENT OF EACH OTHER. NO ONE TYPE      00390000
004000* OF RECORD IS REQUIRED BEFORE THE PROCESSING OF ANOTHER.         00400000
004100*                                                                 00410000
004200* ALL EDITS ARE FAIRLY STRAIGHT FORWARD EXCEPT THE LAND BRIDGE    00420000
004300* DATE/NAME EDITING. ON THE ETA RECORD TYPE, THE LBD DATE AND     00430000
004400* NAME ARE NOT REQUIRED, BUT IF THEY ARE SENT, THEY ARE EDITED    00440000
004500* FOR VALIDITY. IF DATE IS SENT WITHOUT NAME OR VICE VERSA,       00450000
004600* WARNING MESSAGES ARE SENT TO USERS. ON THE ADU RECORD,THE       00460000
004700* ACTUAL LAND BRIDGE NAME IS NOT REQUIRED, BUT THE DATE IS        00470000
004800* REQUIRED BECAUSE THERE ARE ONLY A FEW DATA FIELDS BEING         00480000
004900* TRANSMITTED BESIDE THE KEY.                                     00490000
005000******************************************************************00500000
005100******************************************************************00510000
005200 ENVIRONMENT DIVISION.                                            00520000
005300******************************************************************00530000
005400                                                                  00540000
005500 CONFIGURATION SECTION.                                           00550000
005600                                                                  00560000
005700 SOURCE-COMPUTER.        IBM-3090.                                00570000
005800 OBJECT-COMPUTER.        IBM-3090.                                00580000
005900                                                                  00590000
006000 INPUT-OUTPUT SECTION.                                            00600000
006100                                                                  00610000
006200 FILE-CONTROL.                                                    00620000
006300                                                                  00630000
006400     SELECT TR016-ARRIVAL-FILE                                    00640000
006500         ASSIGN TO INP01.                                         00650000
006600                                                                  00660000
006700     SELECT TR026-UPDATE-ARRIVAL-FILE                             00670000
006800         ASSIGN TO OUT01.                                         00680000
006900                                                                  00690000
007000     SELECT TR231-ARRIVAL-ERROR-FILE                              00700000
007100         ASSIGN TO OUT02.                                         00710000
007200                                                                  00720000
007300     SELECT TR016-ARRIVAL-TURNAROUND-FILE                         00730000
007400         ASSIGN TO OUT03.                                         00740000
007500                                                                  00750000
007600******************************************************************00760000
007700 DATA DIVISION.                                                   00770000
007800******************************************************************00780000
007900                                                                  00790000
008000 FILE SECTION.                                                    00800000
008100                                                                  00810000
008200 FD  TR016-ARRIVAL-FILE                                           00820000
008300     RECORDING MODE IS F                                          00830000
008400     LABEL RECORDS ARE STANDARD                                   00840000
008500     BLOCK CONTAINS 0 RECORDS.                                    00850000
008600                                                                  00860000
008700 01  TR016-ARRIVAL-RECORD            PIC X(300).                  00870000
008800                                                                  00880000
008900 FD  TR026-UPDATE-ARRIVAL-FILE                                    00890000
009000     RECORDING MODE IS F                                          00900000
009100     LABEL RECORDS ARE STANDARD                                   00910000
009200     BLOCK CONTAINS 0 RECORDS.                                    00920000
009300                                                                  00930000
009400 01  TR026-UPDATE-ARRIVAL-RECORD     PIC X(300).                  00940000
009500                                                                  00950000
009600 FD  TR231-ARRIVAL-ERROR-FILE                                     00960000
009700     RECORDING MODE IS F                                          00970000
009800     LABEL RECORDS ARE STANDARD                                   00980000
009900     BLOCK CONTAINS 0 RECORDS.                                    00990000
010000                                                                  01000000
010100 01  TR231-ARRIVAL-ERROR-RECORD      PIC X(508).                  01010000
010200                                                                  01020000
010300 FD  TR016-ARRIVAL-TURNAROUND-FILE                                01030000
010400     RECORDING MODE IS F                                          01040000
010500     LABEL RECORDS ARE STANDARD                                   01050000
010600     BLOCK CONTAINS 0 RECORDS.                                    01060000
010700                                                                  01070000
010800 01  TR016-ARRIVAL-TURNAROUND-REC    PIC X(300).                  01080000
010900                                                                  01090000
011000******************************************************************01100000
011100 WORKING-STORAGE SECTION.                                         01110000
011200******************************************************************01120000
011300                                                                  01130000
011400******************************************************************01140000
011500*  DB2 FORMATTED MESSAGE AREA                                     01150000
011600******************************************************************01160000
011700     COPY DPWS004.                                                01170000
011800                                                                  01180000
011900******************************************************************01190000
012000*  COMMUNICATIONS AREA FOR DB2                                    01200000
012100******************************************************************01210000
012200     EXEC SQL                                                     01220000
012300          INCLUDE SQLCA                                           01230000
012400     END-EXEC.                                                    01240000
012500                                                                  01250000
012600******************************************************************01260000
012700*  DB2 TABLE DECLARATION -  ET-TRADING PARTNERSHIP TABLE.         01270000
012800*      (TTRDPRT)                                                  01280000
012900******************************************************************01290000
013000     EXEC SQL                                                     01300000
013100          INCLUDE TTRDPRT                                         01310000
013200     END-EXEC.                                                    01320000
013300                                                                  01330000
013400******************************************************************01340000
013500*  DB2 TABLE DECLARATION -  ENTERPRISE NAME TABLE.                01350000
013600*      (TENTNME)                                                  01360000
013700******************************************************************01370000
013800     EXEC SQL                                                     01380000
013900          INCLUDE TENTNME                                         01390000
014000     END-EXEC.                                                    01400000
014100                                                                  01410000
014200******************************************************************01420000
014300*  DB2 TABLE DECLARATION -  CONTAINER TABLE.                      01430000
014400*      (TIMCNTK)                                                  01440000
014500******************************************************************01450000
014600     EXEC SQL                                                     01460000
014700          INCLUDE TIMCNTK                                         01470000
014800     END-EXEC.                                                    01480000
014900                                                                  01490000
015000******************************************************************01500000
015100*  DB2 TABLE DECLARATION -  CONTAINER PURCHASE ORDER TABLE.       01510000
015200*      (TIMCNPO)                                                  01520000
015300******************************************************************01530000
015400     EXEC SQL                                                     01540000
015500          INCLUDE TIMCNPO                                         01550000
015600     END-EXEC.                                                    01560000
015700                                                                  01570000
015800******************************************************************01580000
015900*  DB2 TABLE DECLARATION -  PLANNED SHIPMENT TABLE.               01590000
016000*      (TPLNSHP)                                                  01600000
016100******************************************************************01610000
016200     EXEC SQL                                                     01620000
016300          INCLUDE TPLNSHP                                         01630000
016400     END-EXEC.                                                    01640000
016500                                                                  01650000
016600******************************************************************01660000
016700*  DB2 TABLE DECLARATION - IMPORT PORT OF ENTRY TABLE.            01670000
016800*      (TIMPOE)                                                   01680000
016900******************************************************************01690000
017000     EXEC SQL                                                     01700000
017100          INCLUDE TIMPOE                                          01710000
017200     END-EXEC.                                                    01720000
017300                                                                  01730000
017400******************************************************************01740000
017500*  DB2 TABLE DECLARATION - IMPORTS FREIGHT ON BOARD.              01750000
017600*      (TIMFOB)                                                   01760000
017700******************************************************************01770000
017800     EXEC SQL                                                     01780000
017900          INCLUDE TIMFOB                                          01790000
018000     END-EXEC.                                                    01800000
018100                                                                  01810000
018200******************************************************************01820000
018300*  DB2 TABLE DECLARATION - TEXTENT                                01830000
018400******************************************************************01840000
018500     EXEC SQL                                                     01850000
018600          INCLUDE TEXTENT                                         01860000
018700     END-EXEC.                                                    01870000
018800                                                                  01880000
018900******************************************************************01890000
019000*  DB2 TABLE DECLARATION -  TPURCHS                               01900000
019100*      (TPURCHS)                                                  01910000
019200******************************************************************01920000
019300     EXEC SQL                                                     01930000
019400          INCLUDE TPURCHS                                         01940000
019500     END-EXEC.                                                    01950000
019600                                                                  01960000
019700******************************************************************01970000
019800*  VESSEL / VOYAGE ARRIVAL DATA LAYOUT                            01980000
019900******************************************************************01990000
020000     COPY TRRD016.                                                02000000
020100 EJECT                                                            02010000
020200******************************************************************02020000
020300*  EDITED VESSEL / VOYAGE ARRIVAL DATA LAYOUT                     02030000
020400******************************************************************02040000
020500     COPY TRRD026.                                                02050000
020600 EJECT                                                            02060000
020700******************************************************************02070000
020800*  ARRIVAL REPORT RECORD LAYOUT - EXTRACT FOR THE ERROR REPORT.  *02080000
020900*  IT IS USED TO FORMAT THE ERROR RECORDS.  THEY ARE THEN        *02090000
021000*  WRITTEN TO AN OUTPUT FILE.  THE ERRORS WILL BE COMBINED WITH  *02100000
021100*  ERRORS FROM PROGRAM TRKUP235 AND WILL LATER BE USED AS INPUT  *02110000
021200*  TO THE ERROR REPORT PROGRAM WHICH WILL CREATE AN ERROR REPORT *02120000
021300*  OF BOOKING RECORDS.                                           *02130000
021400******************************************************************02140000
021500     COPY TRRD231.                                                02150000
021600 EJECT                                                            02160000
021700                                                                  02170000
021800     COPY DPWS500.                                                02180000
021900 EJECT                                                            02190000
022000                                                                  02200000
022100                                                                  02210000
022200                                                                  02220000
022300 01  ABEND-CODE                      PIC S9(04)    VALUE +0       02230000
022400                                                   COMP SYNC.     02240000
022500 01  PA-PROGRAM-ACCUMULATORS.                                     02250000
022600     05  PA-TOTALS.                                               02260000
022700         10 PA-TOTAL-INPUT-READ       PIC  S9(09)  VALUE +0       02270000
022800                                                     COMP-3.      02280000
022900         10 PA-TOTAL-EDI-REC-READ     PIC  S9(13)  VALUE +0       02290000
023000                                                     COMP-3.      02300000
023100         10 PA-TOT-ARVL-RECS-ADD      PIC  S9(13)  VALUE +0       02310000
023200                                                     COMP-3.      02320000
023300         10 PA-TOT-ARVL-RECS-DELETE   PIC  S9(13)  VALUE +0       02330000
023400                                                     COMP-3.      02340000
023500         10 PA-TOT-ARVL-RECS-CHANGE   PIC  S9(13)  VALUE +0       02350000
023600                                                     COMP-3.      02360000
023700         10 PA-TOT-NON-OCEAN-RECS     PIC  S9(13)  VALUE +0       02370000
023800                                                     COMP-3.      02380000
023900                                                                  02390000
024000 01  PS-PROGRAM-SWITCHES.                                         02400000
024100     05  PS-END-OF-ARRIVALS-SW         PIC  X(01)    VALUE 'N'.   02410000
024200         88  PS-END-OF-ARRIVALS                      VALUE 'Y'.   02420000
024300         88  PS-END-OF-ARRIVALS-NO                   VALUE 'N'.   02430000
024400     05  PS-VALID-TRN-TYP-SW           PIC  X(01)    VALUE 'N'.   02440000
024500         88  PS-VALID-TRN-TYP                        VALUE 'Y'.   02450000
024600         88  PS-VALID-TRN-TYP-NO                     VALUE 'N'.   02460000
024700     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.   02470000
024800         88  PS-EDIT-ERROR                           VALUE 'Y'.   02480000
024900         88  PS-EDIT-ERROR-NO                        VALUE 'N'.   02490000
025000     05  PS-EDI-RECORD-SW              PIC  X(01)    VALUE 'N'.   02500000
025100         88  PS-EDI-RECORD                           VALUE 'Y'.   02510000
025200         88  PS-EDI-RECORD-NO                        VALUE 'N'.   02520000
025300     05  PS-WRITE-THIS-EDI-SW          PIC  X(01)    VALUE 'N'.   02530000
025400         88  PS-WRITE-THIS-EDI                       VALUE 'Y'.   02540000
025500         88  PS-WRITE-THIS-EDI-NO                    VALUE 'N'.   02550000
025600     05  PS-GOOD-RECORD-SW             PIC  X(01)    VALUE 'N'.   02560000
025700         88  PS-GOOD-RECORD                          VALUE 'Y'.   02570000
025800         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   02580000
025900     05  PS-SAME-INPUT-FIELDS-SW       PIC  X(01)    VALUE 'N'.   02590000
026000         88  PS-SAME-INPUT-FIELDS                    VALUE 'Y'.   02600000
026100         88  PS-NOT-SAME-INPUT-FIELDS                VALUE 'N'.   02610000
026200     05  PS-NEW-ARRIVAL-SW             PIC  X(01)    VALUE 'N'.   02620000
026300         88  PS-NEW-ARRIVAL                          VALUE 'Y'.   02630000
026400         88  PS-NEW-ARRIVAL-NO                       VALUE 'N'.   02640000
026500     05  PS-NEW-GROUP-SW               PIC  X(01)    VALUE 'N'.   02650000
026600         88  PS-NEW-GROUP                            VALUE 'Y'.   02660000
026700         88  PS-NEW-GROUP-NO                         VALUE 'N'.   02670000
026800     05  PS-FIELDS-OK-SW               PIC  X(01)    VALUE 'N'.   02680000
026900         88  PS-FIELDS-OK                            VALUE 'Y'.   02690000
027000         88  PS-FIELDS-NOT-OK                        VALUE 'N'.   02700000
027100     05  PS-PO-EXISTS-ON-TIMCNPO-SW    PIC  X(01)    VALUE 'N'.   02710000
027200         88  PS-PO-EXISTS-ON-TIMCNPO                 VALUE 'Y'.   02720000
027300         88  PS-PO-EXISTS-ON-TIMCNPO-NO              VALUE 'N'.   02730000
027400     05  PS-EST-POE-DTE-VALID-SW       PIC  X(01)    VALUE 'N'.   02740000
027500         88  PS-EST-POE-DTE-VALID                    VALUE 'Y'.   02750000
027600         88  PS-EST-POE-DTE-VALID-NO                 VALUE 'N'.   02760000
027700     05  PS-EST-LBD-DTE-PRESENT-SW     PIC  X(01)    VALUE 'N'.   02770000
027800         88  PS-EST-LBD-DTE-PRESENT                  VALUE 'Y'.   02780000
027900         88  PS-EST-LBD-DTE-PRESENT-NO               VALUE 'N'.   02790000
028000     05  PS-EST-LBD-NM-PRESENT-SW      PIC  X(01)    VALUE 'N'.   02800000
028100         88  PS-EST-LBD-NM-PRESENT                   VALUE 'Y'.   02810000
028200         88  PS-EST-LBD-NM-PRESENT-NO                VALUE 'N'.   02820000
028300***  05  PS-EST-LBD-DTE-VALID-SW       PIC  X(01)    VALUE 'N'.   02830000
028400***      88  PS-EST-LBD-DTE-VALID                    VALUE 'Y'.   02840000
028500***      88  PS-EST-LBD-DTE-VALID-NO                 VALUE 'N'.   02850000
028600     05  PS-ACTL-POE-DTE-TM-PRESENT-SW PIC  X(01)    VALUE 'N'.   02860000
028700         88  PS-ACTL-POE-DTE-TM-PRESENT              VALUE 'Y'.   02870000
028800         88  PS-ACTL-POE-DTE-TM-PRESENT-NO           VALUE 'N'.   02880000
028900     05  PS-ACTL-POE-DTE-VALID-SW       PIC  X(01)   VALUE 'N'.   02890000
029000         88  PS-ACTL-POE-DTE-VALID                   VALUE 'Y'.   02900000
029100         88  PS-ACTL-POE-DTE-VALID-NO                VALUE 'N'.   02910000
029200     05  PS-ACTL-LBD-DTE-PRESENT-SW    PIC  X(01)    VALUE 'N'.   02920000
029300         88  PS-ACTL-LBD-DTE-PRESENT                 VALUE 'Y'.   02930000
029400         88  PS-ACTL-LBD-DTE-PRESENT-NO              VALUE 'N'.   02940000
029500     05  PS-ACTL-LBD-NM-PRESENT-SW     PIC  X(01)    VALUE 'N'.   02950000
029600         88  PS-ACTL-LBD-NM-PRESENT                  VALUE 'Y'.   02960000
029700         88  PS-ACTL-LBD-NM-PRESENT-NO               VALUE 'N'.   02970000
029800     05  PS-ACTL-LBD-DTE-VALID-SW       PIC  X(01)   VALUE 'N'.   02980000
029900         88  PS-ACTL-LBD-DTE-VALID                   VALUE 'Y'.   02990000
030000         88  PS-ACTL-LBD-DTE-VALID-NO                VALUE 'N'.   03000000
030100     05  PS-ACTL-LBD-TM-VALID-SW        PIC  X(01)   VALUE 'N'.   03010000
030200         88  PS-ACTL-LBD-TM-VALID                    VALUE 'Y'.   03020000
030300         88  PS-ACTL-LBD-TM-VALID-NO                 VALUE 'N'.   03030000
030400     05  PS-WARNING-TIME-SW            PIC  X(01)    VALUE 'N'.   03040000
030500         88  PS-WARNING-TIME                         VALUE 'Y'.   03050000
030600         88  PS-WARNING-TIME-NO                      VALUE 'N'.   03060000
030700     05  PS-WARNING-DATE-SW            PIC  X(01)    VALUE 'N'.   03070000
030800         88  PS-WARNING-DATE                         VALUE 'Y'.   03080000
030900         88  PS-WARNING-DATE-NO                      VALUE 'N'.   03090000
031000     05  PS-ENTNME-SW                  PIC X(01)     VALUE 'Y'.   03100000
031100         88  PS-VALID-ENTNME                         VALUE 'Y'.   03110000
031200         88  PS-INVALID-ENTNME                       VALUE 'N'.   03120000
031300     05  PS-CONTNR-EXISTS-SW           PIC X(01)     VALUE 'N'.   03130000
031400         88  PS-CONTNR-EXISTS                        VALUE 'Y'.   03140000
031500         88  PS-CONTNR-EXISTS-NO                     VALUE 'N'.   03150000
031600     05  PS-EOC-CONTNR-CURSOR-SW       PIC X(01)     VALUE 'N'.   03160000
031700         88  PS-EOC-CONTNR-CURSOR                    VALUE 'Y'.   03170000
031800         88  PS-EOC-CONTNR-CURSOR-NO                 VALUE 'N'.   03180000
031900     05  PS-THERE-IS-A-CONTNR-SW       PIC X(01)     VALUE 'N'.   03190000
032000         88  PS-THERE-IS-A-CONTNR                    VALUE 'Y'.   03200000
032100         88  PS-THERE-IS-A-CONTNR-NO                 VALUE 'N'.   03210000
032200     05 PS-VALID-POE-NAME-SW           PIC X(01)     VALUE 'N'.   03220000
032300         88  PS-VALID-POE-NAME                       VALUE 'Y'.   03230000
032400         88  PS-VALID-POE-NAME-NO                    VALUE 'N'.   03240000
032500     05 PS-PO-ON-MAINFRAME-SW   PIC  X(01)           VALUE 'N'.   03250000
032600         88  PS-PO-ON-MAINFRAME                      VALUE 'Y'.   03260000
032700         88  PS-PO-ON-MAINFRAME-NO                   VALUE 'N'.   03270000
032710     05 PS-PO-ACTIVE-ON-MAINFRAME-SW   PIC  X(01)    VALUE 'N'.   03271000
032720         88  PS-PO-ACTIVE-ON-MAINFRAME               VALUE 'Y'.   03272000
032730         88  PS-PO-ACTIVE-ON-MAINFRAME-NO            VALUE 'N'.   03273000
032740     05 PS-AIR-SHIPMENT-SW             PIC  X(01)    VALUE 'N'.   03274000
032750         88  PS-AIR-SHIPMENT                         VALUE 'Y'.   03275000
032760         88  PS-AIR-SHIPMENT-NO                      VALUE 'N'.   03276000
032770     05 PS-ALPI-OR-CAP1-SW             PIC  X(01)    VALUE 'N'.   03277000
032780         88  PS-ALPI-OR-CAP1                         VALUE 'Y'.   03278000
032790         88  PS-ALPI-OR-CAP1-NO                      VALUE 'N'.   03279000
032800                                                                  03280000
032900                                                                  03290000
033000 01  PC-PROGRAM-CONSTANTS.                                        03300000
033100     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          03310000
033200         'TRKUT230'.                                              03320000
033300     05  PC-01                       PIC X(02)     VALUE '01'.    03330000
033400     05  PC-10                       PIC X(02)     VALUE '10'.    03340000
033500     05  PC-11                       PIC X(02)     VALUE '11'.    03350000
033600     05  PC-19                       PIC X(02)     VALUE '19'.    03360000
033700     05  PC-20                       PIC X(02)     VALUE '20'.    03370000
033800     05  PC-21                       PIC X(02)     VALUE '21'.    03380000
033900     05  PC-22                       PIC X(02)     VALUE '22'.    03390000
034000     05  PC-98                       PIC X(02)     VALUE '98'.    03400000
034100     05  PC-99                       PIC X(02)     VALUE '99'.    03410000
034200     05  PC-A                        PIC X(01)     VALUE 'A'.     03420000
034300     05  PC-B                        PIC X(01)     VALUE 'B'.     03430000
034400     05  PC-C                        PIC X(01)     VALUE 'C'.     03440000
034500     05  PC-D                        PIC X(01)     VALUE 'D'.     03450000
034600     05  PC-E                        PIC X(01)     VALUE 'E'.     03460000
034700     05  PC-M                        PIC X(01)     VALUE 'M'.     03470000
034800     05  PC-O                        PIC X(01)     VALUE 'O'.     03480000
034900     05  PC-Z                        PIC X(01)     VALUE 'Z'.     03490000
035000     05  PC-A0                       PIC X(02)     VALUE 'A0'.    03500000
035100     05  PC-CFS                      PIC X(03)     VALUE 'CFS'.   03510000
035200     05  PC-CY                       PIC X(02)     VALUE 'CY'.    03520000
035300                                                                  03530000
035400     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.   03540000
035500     05  PC-CTT                      PIC X(03)     VALUE 'CTT'.   03550000
035600     05  PC-IEA                      PIC X(03)     VALUE 'IEA'.   03560000
035700     05  PC-ETA                      PIC X(06)     VALUE 'ETA   '.03570000
035800     05  PC-ADU                      PIC X(06)     VALUE 'ADU   '.03580000
035900     05  PC-ADURD                    PIC X(06)     VALUE 'ADURDA'.03590000
036000                                                                  03600000
036100     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   03610000
036200     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   03620000
036300     05  PC-EMPTY                    PIC X(03)     VALUE 'EMT'.   03630000
036400     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.03640000
036500     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.   03650000
036600     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.   03660000
036700     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.   03670000
036800     05  PC-DASH                     PIC X(01)     VALUE '-'.     03680000
036900     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE          03690000
037000                                     '9999-09-09-00.00.00.000000'.03700000
037100     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          03710000
037200                                     '0001-01-01-00.00.00.000000'.03720000
037300     05  PC-DEFAULT-DTE              PIC X(08)     VALUE          03730000
037400                                     '00010101'.                  03740000
037500     05  PC-DEFAULT-DATE             PIC X(08)     VALUE          03750000
037600                                     '00010101'.                  03760000
037700     05  PC-DEFAULT-TIME             PIC X(04)     VALUE          03770000
037800                                     '0000'.                      03780000
037900     05  PC-DAYS-TO-DECREMENT        PIC 9(02)     VALUE 7.       03790003
038000     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       03800000
038100                                                     COMP-3.      03810000
038200     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0       03820000
038300                                                   COMP.          03830000
038400                                                                  03840000
038500 01  PV-HOLD-VARIABLES.                                           03850000
038800     05  PV-HOLD-PROCESS-SEQ-NBR     PIC S9(06)    VALUE +0       03880000
038900                                                   COMP.          03890000
039000     05  PV-PO-NBR                   PIC S9(09)    VALUE ZEROS    03900000
039100                                                   COMP.          03910000
039200     05  PV-PO-NBR-FOB               PIC S9(09)    VALUE ZEROS    03920000
039300                                                   COMP.          03930000
039400     05  PV-VEND-ID-QUAL             PIC X(02)     VALUE SPACES.  03940000
039500     05  PV-VEND-ID                  PIC X(15)     VALUE SPACES.  03950000
039600                                                                  03960000
039700     05  PV-HOLD-LAST-TRN-TYP        PIC X(01)     VALUE SPACES.  03970000
039800     05  PV-HOLD-LAST-REC-TYP        PIC X(03)     VALUE SPACES.  03980000
039900                                                                  03990000
040000                                                                  04000000
040100                                                                  04010000
040200     05  PV-REC-CHECK                PIC  X(03)  VALUE SPACES.    04020000
040300                                                                  04030000
040400     05  PV-EDI-RECORDS              PIC  X(03).                  04040000
040500         88  EDI-IEA-RECORD                        VALUE 'IEA'.   04050000
040600         88  EDI-CTT-RECORD                        VALUE 'CTT'.   04060000
040700         88  EDI-ISA-RECORD                        VALUE 'ISA'.   04070000
040800*    ***********************************************************  04080000
040801*    * TOTAL BYTES WHERE WE HOLD EDI RECORD TYPES MUST = LRECL *  04080100
040802*    * OF TR016-ARRIVAL-RECORD                                 *  04080200
040810*    ***********************************************************  04081000
040900     05  PV-HOLD-EDI-RECORD.                                      04090000
041000         10  FILLER                  PIC X(32)     VALUE SPACES.  04100000
041100         10  PV-EDI-VEND-ID-QUAL     PIC X(02)     VALUE SPACES.  04110000
041200         10  FILLER                  PIC X(01)     VALUE SPACES.  04120000
041300         10  PV-EDI-VEND-ID          PIC X(15)     VALUE SPACES.  04130000
041400         10  FILLER                  PIC X(20)     VALUE SPACES.  04140000
041500         10  PV-EDI-CONSOL-TRNS-DTE  PIC X(06)     VALUE SPACES.  04150000
041600         10  FILLER                  PIC X(01)     VALUE SPACES.  04160000
041700         10  PV-EDI-CONSOL-TRNS-TM   PIC X(04)     VALUE SPACES.  04170000
041800         10  FILLER                  PIC X(09)     VALUE SPACES.  04180000
041900         10  PV-EDI-CONSOL-FIL-ID    PIC X(09)     VALUE SPACES.  04190000
042000         10  FILLER                  PIC X(201)    VALUE SPACES.  04200000
042100                                                                  04210000
042200     05  PV-HOLD-IEA-RECORD.                                      04220000
042300         10  FILLER                  PIC X(300)    VALUE SPACES.  04230000
042400                                                                  04240000
042500     05  PV-TURN-ISA-WRITTEN         PIC X(300)    VALUE SPACES.  04250000
042600     05  PV-HOLD-TR016-REC-TYP-ETA.                               04260000
042700         10 FILLER                   PIC X(125)    VALUE SPACES.  04270000
042800         10 FILLER                   PIC X(10)     VALUE SPACES.  04280000
042900         10 PV-HOLD-TR016-ETA-TURN-CRE-DTE PIC X(08) VALUE SPACES.04290000
043000         10 PV-HOLD-TR016-ETA-TURN-CRE-TM  PIC X(04) VALUE SPACES.04300000
043100         10 FILLER                   PIC X(153)    VALUE SPACES.  04310000
043200     05  PV-TMST                     PIC X(26)     VALUE SPACES.  04320000
043300     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  04330000
043400     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  04340000
043500     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       04350000
043600                                                    COMP SYNC.    04360000
043700                                                                  04370000
043800     05  PV-FORMAT-TMST.                                          04380000
043900         10  PV-FORMAT-TMST-DTE.                                  04390000
044000             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  04400000
044100             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     04410000
044200             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  04420000
044300             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     04430000
044400             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  04440000
044500             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     04450000
044600         10  PV-FORMAT-TMST-TM.                                   04460000
044700             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  04470000
044800             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     04480000
044900             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  04490000
045000             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          04500000
045100                                                     '.00.000000'.04510000
045200     05  PV-FORMAT-ARDT.                                          04520000
045300         10  PV-FORMAT-ARDT-DTE-CY  PIC X(04)  VALUE SPACES.      04530000
045400         10  PV-FORMAT-ARDT-DTE-D1  PIC X(01)  VALUE '-'.         04540000
045500         10  PV-FORMAT-ARDT-DTE-MM  PIC X(02)  VALUE SPACES.      04550000
045600         10  PV-FORMAT-ARDT-DTE-D2  PIC X(01)  VALUE '-'.         04560000
045700         10  PV-FORMAT-ARDT-DTE-DD  PIC X(02)  VALUE SPACES.      04570000
045800         10  PV-FORMAT-ARDT-DTE-D3  PIC X(01)  VALUE '-'.         04580000
045900         10  PV-FORMAT-ARDT-TM-HH   PIC X(02)  VALUE SPACES.      04590000
046000         10  PV-FORMAT-ARDT-TM-D1   PIC X(01)  VALUE '.'.         04600000
046100         10  PV-FORMAT-ARDT-TM-MM   PIC X(02)  VALUE SPACES.      04610000
046200         10  PV-FORMAT-ARDT-TM-D2   PIC X(10)  VALUE '.00.000000'.04620000
046300                                                                  04630000
046400     05  PV-REFORMAT-TMST.                                        04640000
046500         10  PV-REFORMAT-TMST-DTE.                                04650000
046600             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.04660000
046700             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.04670000
046800             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.04680000
046900         10  PV-REFORMAT-TMST-TM.                                 04690000
047000             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.04700000
047100             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.04710000
047200                                                                  04720000
047300     05  PV-HDR-CONSOL-TRNS-DTE.                                  04730000
047400         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.04740000
047500         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.04750000
047600                                                                  04760000
047700     05  PV-WRK-POE-NM                PIC X(30).                  04770000
047800     05  PV-WRK-POE-CDE               PIC X(04).                  04780000
047900     05  PV-LAST-POE-CDE              PIC X(04).                  04790000
048000     05  PV-WRK-POE-CDE-AIR           PIC X(03).                  04800000
048100     05  PV-WRK-TRIP-TYPE-CDE-MOM     PIC X(01).                  04810000
048200     05  PV-LAST-TRIP-TYPE-CDE-MOM    PIC X(01).                  04820000
048300                                                                  04830000
048400***************************************************************** 04840000
048500*    CURSOR DECLARATION TO OBTAIN CONTAINER ROWS                * 04850000
048600***************************************************************** 04860000
048700                                                                  04870000
048800     EXEC SQL                                                     04880000
048900          DECLARE CONTNR_CURSOR CURSOR FOR                        04890000
049000           SELECT                                                 04900000
049100                  A.CONTNR_ID                                     04910000
049200                , A.CONTNR_SEQ_NBR                                04920000
049300             FROM                                                 04930000
049400                  TIMCNTK   A                                     04940000
049500                , TIMCNPO   B                                     04950000
049600             WHERE B.PO_NBR         =  :PV-PO-NBR                 04960000
049700               AND B.EXTL_REF_NBR   =  :TR016-ETA-EXTL-REF-NBR    04970000
049800               AND A.CONTNR_ID      =  B.CONTNR_ID                04980000
049900               AND A.CONTNR_SEQ_NBR =  B.CONTNR_SEQ_NBR           04990000
050000             ORDER BY A.CONTNR_ID                                 05000000
050100     END-EXEC.                                                    05010000
050200                                                                  05020000
050300*---------------------------------------------------------------* 05030000
050400*    CURSOR DECLARATION FOR SELECTING POE CODE AIR              * 05040000
050500*---------------------------------------------------------------* 05050000
050600                                                                  05060000
050700     EXEC SQL                                                     05070000
050800          DECLARE  POE-CSR-AIR CURSOR                             05080000
050900              FOR  SELECT DISTINCT                                05090000
051000                   A.POE_NM                                       05100000
051100             FROM  TIMPOE  A                                      05110000
051200            WHERE  A.STD_IATA_CDE  =  :PV-WRK-POE-CDE-AIR         05120000
051300              AND  A.STAT_CDE      =  :PC-A                       05130000
051400     END-EXEC.                                                    05140000
051500                                                                  05150000
051600 EJECT                                                            05160000
051700*---------------------------------------------------------------* 05170000
051800*    CURSOR DECLARATION FOR SELECTING POE CODE OCEAN            * 05180000
051900*---------------------------------------------------------------* 05190000
052000                                                                  05200000
052100     EXEC SQL                                                     05210000
052200          DECLARE  POE-CSR-OCEAN CURSOR                           05220000
052300              FOR  SELECT DISTINCT                                05230000
052400                   A.POE_NM                                       05240000
052500             FROM  TIMPOE  A                                      05250000
052600            WHERE  A.POE_STD_EDI_CDE  = :PV-WRK-POE-CDE           05260000
052700              AND  A.STAT_CDE         = :PC-A                     05270000
052800     END-EXEC.                                                    05280000
052900                                                                  05290000
053000 EJECT                                                            05300000
053100                                                                  05310000
053200******************************************************************05320000
053300 LINKAGE SECTION.                                                 05330000
053400******************************************************************05340000
053500                                                                  05350000
053600******************************************************************05360000
053700 PROCEDURE DIVISION.                                              05370000
053800******************************************************************05380000
053900******************************************************************05390000
054000*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *05400000
054100******************************************************************05410000
054200 0000-PROGRAM-MAINLINE.                                           05420000
054300                                                                  05430000
054400     PERFORM 1000-INITIALIZE.                                     05440000
054500                                                                  05450000
054600     PERFORM 2000-PROCESS-ARRIVAL-RECORDS                         05460000
054700         UNTIL PS-END-OF-ARRIVALS.                                05470000
054800                                                                  05480000
054900     PERFORM 8000-EOJ-ROUTINE.                                    05490000
055000     STOP RUN.                                                    05500000
055100                                                                  05510000
055200******************************************************************05520000
055300*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *05530000
055400*  JOB PROCESSES - PRIMING READ, INITIALIZATION, EMPTY FILE ETC. *05540000
055500******************************************************************05550000
055600 1000-INITIALIZE.                                                 05560000
055700                                                                  05570000
055800     OPEN INPUT TR016-ARRIVAL-FILE                                05580000
055900         OUTPUT TR026-UPDATE-ARRIVAL-FILE                         05590000
056000                TR231-ARRIVAL-ERROR-FILE                          05600000
056100                TR016-ARRIVAL-TURNAROUND-FILE.                    05610000
056200                                                                  05620000
056300     INITIALIZE TR231-RECORD                                      05630000
056400                TR231-REC-TYP-HDR                                 05640000
056500                TR016-REC-TYP-ETA.                                05650000
056800                                                                  05680000
056900     SET PS-GOOD-RECORD-NO TO TRUE.                               05690000
057000                                                                  05700000
057100     MOVE PC-IEA TO PV-HOLD-LAST-REC-TYP.                         05710000
057200                                                                  05720000
057300     PERFORM 6000-READ-ARRIVAL-RECORD                             05730000
057400         UNTIL PS-GOOD-RECORD OR PS-END-OF-ARRIVALS.              05740000
057500                                                                  05750000
057600     SET PS-GOOD-RECORD-NO TO TRUE.                               05760000
057700                                                                  05770000
057800     IF PS-END-OF-ARRIVALS                                        05780000
057900         MOVE PC-EMPTY       TO TR231-ERROR-TYPE                  05790000
058000     END-IF.                                                      05800000
058100                                                                  05810000
058200 EJECT                                                            05820000
058300******************************************************************05830000
058400* MAIN PROCESSING / EDIT PARAGRAPH.                              *05840000
058500*                                                                *05850000
058600*  IN THIS PARAGRAPH, A CHECK IS PERFORMED TO MAKE SURE THE      *05860000
058700*  RECORD HAS A VALID TRANSACTION TYP AND RECORD TYP.  IF NOT,   *05870000
058800*  AN ERROR RECORD IS WRITTEN OUR IMMEDIATELY.                   *05880000
058900*  IF EITHER IS MISSING OR INVALID, THE RECORD IS WRITTEN OUT TO *05890000
059000*  ERROR REPORT AND THE PROCESSING PASSES TO THE NEXT RECORD.    *05900000
059100*  WHEN TRAN TYPE, RECORD TYPE, ARE PRESENT AND VALID, THE       *05910000
059200*  THE PROCESSING WILL                                           *05920000
059300*  PASS THRU ALL OF THE EDITS BEFORE READING THE NEXT RECORD.    *05930000
059400*  THIS IS DONE TO TRY TO CATCH ALL OF THE ERRORS ON THE FIRST   *05940000
059500*  TIME THROUGH THE PROGRAM.                                     *05950000
059600******************************************************************05960000
059700 2000-PROCESS-ARRIVAL-RECORDS.                                    05970000
059800                                                                  05980000
059900     PERFORM 7400-SELECT-FOB-AND-SCAC-CODES.                      05990000
059901     IF EXTENT-SCAC-CDE = 'ALPI' OR 'CAP1'                        05990100
059910       SET PS-ALPI-OR-CAP1   TO TRUE                              05991000
059920     END-IF.                                                      05992000
059921                                                                  05992100
059930     IF TR016-ETA-TRIP-TYP-CDE-MOM = PC-A                         05993000
059940       SET PS-AIR-SHIPMENT       TO TRUE                          05994000
059950     ELSE                                                         05995000
059960       SET PS-AIR-SHIPMENT-NO    TO TRUE                          05996000
059970     END-IF.                                                      05997000
059980                                                                  05998000
059990     MOVE TR016-ETA-DEST-POE-CDE-MOM TO PV-WRK-POE-CDE.           05999000
059992     MOVE TR016-ETA-TRIP-TYP-CDE-MOM                              05999200
059993                           TO PV-WRK-TRIP-TYPE-CDE-MOM.           05999300
059994     PERFORM 7040-GET-POE-NAME.                                   05999400
059996                                                                  05999600
060000     PERFORM 3150-CHECK-VALID-TRAN-TYP.                           06000000
060100     IF PS-VALID-TRN-TYP                                          06010000
060200         EVALUATE TRUE                                            06020000
060300            WHEN TR016-ETA-REC-TYP-CDE-ETA                        06030000
060400                INITIALIZE TR026-REC-TYP-ETA                      06040000
060500                PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                06050000
060600                PERFORM 3300-EDIT-ETA-FIELDS                      06060000
060700            WHEN TR016-ADU-REC-TYP-CDE-ADU                        06070000
060800                INITIALIZE TR026-REC-TYP-ADU                      06080000
060900                PERFORM 3200-EDIT-KEYS-LIKE-FIELDS                06090000
061000                PERFORM 3400-EDIT-ADU-FIELDS                      06100000
061100            WHEN TR016-ADURD-REC-TYP-CDE-ADURDA                   06110000
061200                INITIALIZE TR026-REC-TYP-ADURD                    06120000
061300                PERFORM 3600-PROCESS-RECYCLE-RECORD               06130000
061400            WHEN OTHER                                            06140000
061500                MOVE PC-E                  TO TR231-RPT-TYP       06150000
061600                MOVE TR016-ETA-TRN-TYP     TO TR231-TRN-TYP       06160000
061700                MOVE 'RECORD TYPE'         TO TR231-DATA-IN-ERROR 06170000
061800                MOVE TR016-ETA-REC-TYP-CDE TO TR231-DATA-VALUE    06180000
061900                                            TR231-REC-TYP-ETA-CDE 06190000
062000                MOVE PC-ERROR              TO TR231-ERROR-TYPE    06200000
062100                MOVE 'INVALID RECORD TYPE' TO TR231-ERROR-MSG     06210000
062200                SET PS-EDIT-ERROR          TO TRUE                06220000
062300                MOVE PV-PROCESS-SEQ-NBR  TO TR231-PROCESS-SEQ-NBR 06230000
062400                PERFORM 6200-WRITE-ERROR-REPORT                   06240000
062500         END-EVALUATE                                             06250000
062600     END-IF.                                                      06260000
062700                                                                  06270000
062800        PERFORM 6000-READ-ARRIVAL-RECORD                          06280000
062900                UNTIL PS-GOOD-RECORD OR PS-END-OF-ARRIVALS.       06290000
063000                                                                  06300000
063100        SET   PS-GOOD-RECORD-NO            TO TRUE.               06310000
063200                                                                  06320000
063300                                                                  06330000
063400 EJECT                                                            06340000
064300******************************************************************06430000
064400* CHECK TO MAKE SURE THAT THE TRANSACTION TYPES ARE EITHER       *06440000
064500* A, C, OR D.  SETS A SWITCHE AND CONTINUES EDITING.             *06450000
064600******************************************************************06460000
064700                                                                  06470000
064800 3150-CHECK-VALID-TRAN-TYP.                                       06480000
064900                                                                  06490000
065000     EVALUATE TRUE                                                06500000
065100                                                                  06510000
065200        WHEN TR016-ETA-TRN-TYP-ADD                                06520000
065300             SET PS-VALID-TRN-TYP              TO TRUE            06530000
065400             ADD +1 TO PA-TOT-ARVL-RECS-ADD                       06540000
065500        WHEN TR016-ETA-TRN-TYP-CHG                                06550000
065600             SET PS-VALID-TRN-TYP              TO TRUE            06560000
065700             ADD +1 TO PA-TOT-ARVL-RECS-CHANGE                    06570000
065800        WHEN TR016-ETA-TRN-TYP-DEL                                06580000
065900             SET PS-VALID-TRN-TYP              TO TRUE            06590000
066000             ADD +1 TO PA-TOT-ARVL-RECS-DELETE                    06600000
066100        WHEN OTHER                                                06610000
066200             SET PS-VALID-TRN-TYP-NO           TO TRUE            06620000
066300             MOVE PC-E                         TO TR231-RPT-TYP   06630000
066400             MOVE TR016-ETA-TRN-TYP            TO TR231-TRN-TYP   06640000
066500             MOVE 'TRAN TYPE'              TO TR231-DATA-IN-ERROR 06650000
066600             MOVE TR016-ETA-TRN-TYP        TO TR231-DATA-VALUE    06660000
066700             MOVE PC-ERROR                 TO TR231-ERROR-TYPE    06670000
066800             MOVE 'INVALID TRAN TYPE'      TO TR231-ERROR-MSG     06680000
066900             SET PS-EDIT-ERROR             TO TRUE                06690000
067000             MOVE PV-PROCESS-SEQ-NBR  TO TR231-PROCESS-SEQ-NBR    06700000
067100             PERFORM 6190-MOVES-FOR-ERROR-REC                     06710000
067200             PERFORM 6200-WRITE-ERROR-REPORT                      06720000
067300     END-EVALUATE.                                                06730000
067400                                                                  06740000
067500 EJECT                                                            06750000
067600******************************************************************06760000
067700* EDIT THE KEY FIELDS AND FIELDS THAT ARE PRESENT ON ALL OF THE  *06770000
067800* RECORD TYPES - ETA AND ADU.                                    *06780000
067900******************************************************************06790000
067910                                                                  06791000
068000 3200-EDIT-KEYS-LIKE-FIELDS.                                      06800000
068100                                                                  06810000
068160                                                                  06816000
068170     MOVE TR016-ETA-FILE-ID TO TR026-ETA-FILE-ID.                 06817000
068180     MOVE TR016-ETA-ENT-ID  TO TR026-ETA-DAT-SRC-ENT-ID.          06818000
068190                                                                  06819000
068200     EVALUATE TRUE                                                06820000
068300     WHEN TR016-ETA-PO-NBR NUMERIC                                06830000
068400       AND TR016-ETA-PO-NBR   GREATER THAN   ZERO                 06840000
068500        PERFORM 7110-SELECT-TPURCHS                               06850000
068700        MOVE TR016-ETA-PO-NBR      TO TR026-ETA-PO-NBR            06870000
068800                                      PV-PO-NBR                   06880000
068810        IF PS-PO-ACTIVE-ON-MAINFRAME                              06881000
068820           CONTINUE                                               06882000
068900        ELSE                                                      06890000
069000          MOVE PC-E                     TO TR231-RPT-TYP          06900000
069100          MOVE TR016-ETA-TRN-TYP        TO TR231-TRN-TYP          06910000
069200          MOVE 'PO NUMBER'              TO TR231-DATA-IN-ERROR    06920000
069300          MOVE TR016-ETA-PO-NBR         TO TR231-DATA-VALUE       06930000
069301          IF PS-PO-ON-MAINFRAME-NO                                06930100
069320             MOVE 'PO NOT ON MAINFRAME' TO TR231-ERROR-MSG        06932000
069330          ELSE                                                    06933000
069400             MOVE 'PO NOT ACTIVE OR APPROVED ON MAINFRAME'        06940000
069500                                        TO TR231-ERROR-MSG        06950000
069510          END-IF                                                  06951000
069600          MOVE PC-WARNING               TO TR231-ERROR-TYPE       06960000
069800          MOVE TR016-ETA-TRN-TYP        TO TR026-ETA-TRN-TYP      06980000
069900          MOVE TR016-ETA-REC-TYP-CDE    TO TR026-ETA-REC-TYP-CDE  06990000
070000          MOVE TR016-ETA-SEQ-NBR        TO TR026-ETA-SEQ-NBR      07000000
070100          MOVE TR016-ETA-3RD-PARTY-CDE                            07010000
070200                                     TO TR026-ETA-3RD-PARTY-CDE   07020000
070300          MOVE PV-PROCESS-SEQ-NBR    TO TR231-PROCESS-SEQ-NBR     07030000
070400          PERFORM 6190-MOVES-FOR-ERROR-REC                        07040000
070500          PERFORM 6200-WRITE-ERROR-REPORT                         07050000
070600        END-IF                                                    07060000
070700                                                                  07070000
070800     WHEN TR016-ETA-PO-NBR NOT NUMERIC                            07080000
070900        MOVE PC-E                     TO TR231-RPT-TYP            07090000
071000        MOVE TR016-ETA-TRN-TYP        TO TR231-TRN-TYP            07100000
071100        MOVE 'PO NUMBER'              TO TR231-DATA-IN-ERROR      07110000
071200        MOVE TR016-ETA-PO-NBR         TO TR231-DATA-VALUE         07120000
071300        IF TR016-ETA-PO-NBR  = SPACES                             07130000
071400          MOVE 'PO NUMBER MISSING'      TO TR231-ERROR-MSG        07140000
071500        ELSE                                                      07150000
071600          MOVE 'INVALID PO NUMBER'    TO TR231-ERROR-MSG          07160000
071700        END-IF                                                    07170000
071800        MOVE PC-ERROR                 TO TR231-ERROR-TYPE         07180000
071900        SET PS-EDIT-ERROR             TO TRUE                     07190000
072000        MOVE TR016-ETA-TRN-TYP        TO TR026-ETA-TRN-TYP        07200000
072100        MOVE TR016-ETA-REC-TYP-CDE    TO TR026-ETA-REC-TYP-CDE    07210000
072200        MOVE TR016-ETA-SEQ-NBR        TO TR026-ETA-SEQ-NBR        07220000
072300        MOVE TR016-ETA-3RD-PARTY-CDE  TO TR026-ETA-3RD-PARTY-CDE  07230000
072400        MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR    07240000
072500        PERFORM 6190-MOVES-FOR-ERROR-REC                          07250000
072600        PERFORM 6200-WRITE-ERROR-REPORT                           07260000
072700                                                                  07270000
072800     WHEN TR016-ETA-PO-NBR = ZERO                                 07280000
072900        MOVE PC-E                     TO TR231-RPT-TYP            07290000
073000        MOVE TR016-ETA-TRN-TYP        TO TR231-TRN-TYP            07300000
073100        MOVE 'PO NUMBER'              TO TR231-DATA-IN-ERROR      07310000
073200        MOVE TR016-ETA-PO-NBR         TO TR231-DATA-VALUE         07320000
073300        MOVE 'PO NUMBER MISSING'      TO TR231-ERROR-MSG          07330000
073400        MOVE PC-ERROR                 TO TR231-ERROR-TYPE         07340000
073500        SET PS-EDIT-ERROR             TO TRUE                     07350000
073600        MOVE TR016-ETA-TRN-TYP        TO TR026-ETA-TRN-TYP        07360000
073700        MOVE TR016-ETA-REC-TYP-CDE    TO TR026-ETA-REC-TYP-CDE    07370000
073800        MOVE TR016-ETA-SEQ-NBR        TO TR026-ETA-SEQ-NBR        07380000
073900        MOVE TR016-ETA-3RD-PARTY-CDE  TO TR026-ETA-3RD-PARTY-CDE  07390000
074000        MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR    07400000
074100        PERFORM 6190-MOVES-FOR-ERROR-REC                          07410000
074200        PERFORM 6200-WRITE-ERROR-REPORT                           07420000
074300     END-EVALUATE.                                                07430000
074400                                                                  07440000
074500                                                                  07450000
074600     IF TR016-ETA-EXTL-REF-NBR EQUAL SPACES                       07460000
074700        MOVE PC-E                     TO TR231-RPT-TYP            07470000
074800        MOVE TR016-ETA-TRN-TYP        TO TR231-TRN-TYP            07480000
074900        MOVE 'EXTL REF NBR'           TO TR231-DATA-IN-ERROR      07490000
075000        MOVE TR016-ETA-EXTL-REF-NBR   TO TR231-DATA-VALUE         07500000
075100        MOVE PC-ERROR                 TO TR231-ERROR-TYPE         07510000
075200        SET PS-EDIT-ERROR             TO TRUE                     07520000
075300        MOVE 'EXTL REF NBR MISSING'   TO TR231-ERROR-MSG          07530000
075400        MOVE TR016-ETA-TRN-TYP        TO TR026-ETA-TRN-TYP        07540000
075500        MOVE TR016-ETA-REC-TYP-CDE    TO TR026-ETA-REC-TYP-CDE    07550000
075600        MOVE TR016-ETA-SEQ-NBR        TO TR026-ETA-SEQ-NBR        07560000
075700        MOVE TR016-ETA-3RD-PARTY-CDE  TO TR026-ETA-3RD-PARTY-CDE  07570000
075800        MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR    07580000
075900        PERFORM 6190-MOVES-FOR-ERROR-REC                          07590000
076000        PERFORM 6200-WRITE-ERROR-REPORT                           07600000
076100     ELSE                                                         07610000
076200        MOVE TR016-ETA-EXTL-REF-NBR  TO TR026-ETA-EXTL-REF-NBR    07620000
076300     END-IF.                                                      07630000
076400                                                                  07640000
076500      IF TR016-ETA-CARR-SCAC-ID EQUAL SPACES                      07650000
076510       AND TR016-ADU-TRN-TYP   NOT =   PC-D                       07651002
076600        MOVE PC-E                      TO TR231-RPT-TYP           07660000
076700        MOVE TR016-ETA-TRN-TYP         TO TR231-TRN-TYP           07670000
076800        MOVE 'CARRIER SCAC ID'         TO TR231-DATA-IN-ERROR     07680000
076900        MOVE TR016-ETA-CARR-SCAC-ID    TO TR231-DATA-VALUE        07690000
077000        MOVE PC-WARNING                TO TR231-ERROR-TYPE        07700000
077100        MOVE 'DATA NOT SENT'           TO TR231-ERROR-MSG         07710000
077200        MOVE PV-PROCESS-SEQ-NBR        TO TR231-PROCESS-SEQ-NBR   07720000
077300        MOVE TR016-ETA-TRN-TYP         TO TR026-ETA-TRN-TYP       07730000
077400        MOVE TR016-ETA-REC-TYP-CDE     TO TR026-ETA-REC-TYP-CDE   07740000
077500        MOVE TR016-ETA-SEQ-NBR         TO TR026-ETA-SEQ-NBR       07750000
077600        MOVE TR016-ETA-3RD-PARTY-CDE   TO TR026-ETA-3RD-PARTY-CDE 07760000
077700        MOVE TR016-ETA-CARR-SCAC-ID    TO TR026-ETA-CARR-SCAC-ID  07770000
077800        PERFORM 6190-MOVES-FOR-ERROR-REC                          07780000
077900        PERFORM 6200-WRITE-ERROR-REPORT                           07790000
078000      ELSE                                                        07800000
078100        MOVE TR016-ETA-CARR-SCAC-ID    TO TR026-ETA-CARR-SCAC-ID  07810000
078200      END-IF.                                                     07820000
078300                                                                  07830000
078400      IF TR016-ETA-IMPRT-TRIP-ID EQUAL SPACES                     07840000
078410       AND TR016-ADU-TRN-TYP   NOT =   PC-D                       07841002
078500        MOVE PC-E                      TO TR231-RPT-TYP           07850000
078600        MOVE TR016-ETA-TRN-TYP         TO TR231-TRN-TYP           07860000
078700        MOVE 'IMPORT TRIP ID'          TO TR231-DATA-IN-ERROR     07870000
078800        MOVE TR016-ETA-IMPRT-TRIP-ID   TO TR231-DATA-VALUE        07880000
078900        MOVE PC-WARNING                TO TR231-ERROR-TYPE        07890000
079000        MOVE 'DATA NOT SENT'           TO TR231-ERROR-MSG         07900000
079100        MOVE PV-PROCESS-SEQ-NBR        TO TR231-PROCESS-SEQ-NBR   07910000
079200        MOVE TR016-ETA-TRN-TYP         TO TR026-ETA-TRN-TYP       07920000
079300        MOVE TR016-ETA-REC-TYP-CDE     TO TR026-ETA-REC-TYP-CDE   07930000
079400        MOVE TR016-ETA-SEQ-NBR         TO TR026-ETA-SEQ-NBR       07940000
079500        MOVE TR016-ETA-3RD-PARTY-CDE   TO TR026-ETA-3RD-PARTY-CDE 07950000
079600        MOVE TR016-ETA-IMPRT-TRIP-ID   TO TR026-ETA-IMPRT-TRIP-ID 07960000
079700        PERFORM 6190-MOVES-FOR-ERROR-REC                          07970000
079800        PERFORM 6200-WRITE-ERROR-REPORT                           07980000
079900      ELSE                                                        07990000
080000        MOVE TR016-ETA-IMPRT-TRIP-ID   TO TR026-ETA-IMPRT-TRIP-ID 08000000
080100      END-IF.                                                     08010000
080200                                                                  08020000
080300      IF TR016-ETA-IMPRT-VEH-NM  EQUAL SPACES                     08030000
080400        MOVE PC-E                      TO TR231-RPT-TYP           08040000
080500        MOVE TR016-ETA-TRN-TYP         TO TR231-TRN-TYP           08050000
080600        MOVE 'VESSEL NAME'             TO TR231-DATA-IN-ERROR     08060000
080700        MOVE TR016-ETA-IMPRT-VEH-NM    TO TR231-DATA-VALUE        08070000
080800        MOVE PC-WARNING                TO TR231-ERROR-TYPE        08080000
080900        MOVE 'DATA NOT SENT'           TO TR231-ERROR-MSG         08090000
081000        MOVE PV-PROCESS-SEQ-NBR        TO TR231-PROCESS-SEQ-NBR   08100000
081100        MOVE TR016-ETA-TRN-TYP         TO TR026-ETA-TRN-TYP       08110000
081200        MOVE TR016-ETA-REC-TYP-CDE     TO TR026-ETA-REC-TYP-CDE   08120000
081300        MOVE TR016-ETA-SEQ-NBR         TO TR026-ETA-SEQ-NBR       08130000
081400        MOVE TR016-ETA-3RD-PARTY-CDE   TO TR026-ETA-3RD-PARTY-CDE 08140000
081500        MOVE TR016-ETA-IMPRT-VEH-NM    TO TR026-ETA-IMPRT-VEH-NM  08150000
081600        PERFORM 6190-MOVES-FOR-ERROR-REC                          08160000
081700        PERFORM 6200-WRITE-ERROR-REPORT                           08170000
081800      ELSE                                                        08180000
081900        MOVE TR016-ETA-IMPRT-VEH-NM    TO TR026-ETA-IMPRT-VEH-NM  08190000
082000      END-IF.                                                     08200000
082100                                                                  08210000
082200 EJECT                                                            08220000
082300******************************************************************08230000
082400* EDIT THE FIELDS THAT ARE PRESENT ON THE ETA RECORD TYPE ONLY.  *08240000
082500* THE EXCEPTION IS DEST-POE-CDE WHICH OCCURS ON THE ETA AND ADU  *08250000
082600* RECORD TYPES. THE DEST-POE-CDE AND DEST-POE-DATE ARE REQUIRED. *08260000
082700******************************************************************08270000
082800 3300-EDIT-ETA-FIELDS.                                            08280000
082900                                                                  08290000
083000     IF TR016-ETA-TRN-TYP NOT EQUAL PC-C                          08300000
083100        MOVE PC-E                        TO TR231-RPT-TYP         08310000
083200        MOVE TR016-ETA-TRN-TYP           TO TR231-TRN-TYP         08320000
083300        MOVE 'ETA TRN TYPE'              TO TR231-DATA-IN-ERROR   08330000
083400        MOVE TR016-ETA-TRN-TYP           TO TR231-DATA-VALUE      08340000
083500        MOVE PC-ERROR                    TO TR231-ERROR-TYPE      08350000
083600        SET PS-EDIT-ERROR                TO TRUE                  08360000
083700        MOVE 'ETA TRAN TYPE MUST BE C'   TO TR231-ERROR-MSG       08370000
083800        MOVE PV-PROCESS-SEQ-NBR          TO TR231-PROCESS-SEQ-NBR 08380000
083900        PERFORM 6190-MOVES-FOR-ERROR-REC                          08390000
084000        PERFORM 6200-WRITE-ERROR-REPORT                           08400000
084100     END-IF.                                                      08410000
084200                                                                  08420000
084300     IF TR016-ETA-DEST-POE-CDE-MOM EQUAL SPACES OR                08430000
084400        TR016-ETA-DEST-POE-CDE-MOM EQUAL ZEROES                   08440000
084500        MOVE PC-E                        TO TR231-RPT-TYP         08450000
084600        MOVE TR016-ETA-TRN-TYP           TO TR231-TRN-TYP         08460000
084700        MOVE 'EST POE CDE'               TO TR231-DATA-IN-ERROR   08470000
084800        MOVE TR016-ETA-DEST-POE-CDE-MOM  TO TR231-DATA-VALUE      08480000
084900        MOVE PC-ERROR                    TO TR231-ERROR-TYPE      08490000
085000        SET PS-EDIT-ERROR                TO TRUE                  08500000
085100        MOVE 'DATA NOT SENT'             TO TR231-ERROR-MSG       08510000
085200        MOVE PV-PROCESS-SEQ-NBR          TO TR231-PROCESS-SEQ-NBR 08520000
085300        PERFORM 6190-MOVES-FOR-ERROR-REC                          08530000
085400        PERFORM 6200-WRITE-ERROR-REPORT                           08540000
085500     ELSE                                                         08550000
085600        MOVE TR016-ETA-DEST-POE-CDE-MOM                           08560000
085700                                    TO TR026-ETA-DEST-POE-CDE-MOM 08570000
086200        MOVE PV-WRK-POE-NM TO TR026-ETA-DEST-POE-NAME             08620000
086300     END-IF.                                                      08630000
086400                                                                  08640000
086500     IF TR016-ETA-EST-POE-DELY-DTE EQUAL SPACES                   08650000
086600           MOVE PC-E                        TO TR231-RPT-TYP      08660000
086700           MOVE TR016-ETA-TRN-TYP           TO TR231-TRN-TYP      08670000
086800           MOVE 'EST POE DELY DT'           TO TR231-DATA-IN-ERROR08680000
086900           MOVE TR016-ETA-EST-POE-DELY-DTE  TO TR231-DATA-VALUE   08690000
087000           MOVE PC-ERROR                    TO TR231-ERROR-TYPE   08700000
087100           SET PS-EDIT-ERROR                TO TRUE               08710000
087200           MOVE 'DATA NOT SENT'             TO TR231-ERROR-MSG    08720000
087300           MOVE PV-PROCESS-SEQ-NBR        TO TR231-PROCESS-SEQ-NBR08730000
087400           PERFORM 6190-MOVES-FOR-ERROR-REC                       08740000
087500           PERFORM 6200-WRITE-ERROR-REPORT                        08750000
087600     ELSE                                                         08760000
087700        PERFORM 5610-CHK-VALID-EST-POE-DTE-TM                     08770000
087800     END-IF.                                                      08780000
087900                                                                  08790000
088000***  SET PS-EST-LBD-DTE-PRESENT-NO       TO TRUE.                 08800000
088100***  SET PS-EST-LBD-NM-PRESENT-NO        TO TRUE.                 08810000
088200***                                                               08820000
088300***  IF  TR016-ETA-EST-LBD-DTE EQUAL SPACES  OR                   08830000
088400***      TR016-ETA-EST-LBD-DTE EQUAL ZEROES                       08840000
088500***      SET PS-EST-LBD-DTE-PRESENT-NO   TO TRUE                  08850000
088600***  ELSE                                                         08860000
088700***      SET PS-EST-LBD-DTE-PRESENT    TO TRUE                    08870000
088800***  END-IF.                                                      08880000
088900***                                                               08890000
089000***  IF  TR016-ETA-EST-LBD-NM EQUAL SPACES   OR                   08900000
089100***      TR016-ETA-EST-LBD-NM EQUAL ZEROES                        08910000
089200***      SET PS-EST-LBD-NM-PRESENT-NO    TO TRUE                  08920000
089300***  ELSE                                                         08930000
089400***      SET PS-EST-LBD-NM-PRESENT     TO TRUE                    08940000
089500***  END-IF.                                                      08950000
089600***                                                               08960000
089700***  IF (PS-EST-LBD-DTE-PRESENT-NO AND PS-EST-LBD-NM-PRESENT)     08970000
089800***           OR                                                  08980000
089900***     (TR016-ETA-EST-LBD-DTE = PC-DEFAULT-DATE AND              08990000
090000***      PS-EST-LBD-NM-PRESENT)                                   09000000
090100***        MOVE PC-E                     TO TR231-RPT-TYP         09010000
090200***        MOVE TR016-ETA-TRN-TYP        TO TR231-TRN-TYP         09020000
090300***        MOVE 'EST LBD DATE'           TO TR231-DATA-IN-ERROR   09030000
090400***        MOVE TR016-ETA-EST-LBD-DTE    TO TR231-DATA-VALUE      09040000
090500***        MOVE PC-WARNING               TO TR231-ERROR-TYPE      09050000
090600***        MOVE 'INVALID ESTIMATED LAND BRIDGE DATE'  TO          09060000
090700***              TR231-ERROR-MSG                                  09070000
090800***        MOVE SPACES                   TO TR231-ETA-EST-LBD-DTE 09080000
090900***        MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR 09090000
091000***        PERFORM 6190-MOVES-FOR-ERROR-REC                       09100000
091100***        PERFORM 6200-WRITE-ERROR-REPORT                        09110000
091200***  END-IF.                                                      09120000
091300***                                                               09130000
091400***  IF PS-EST-LBD-DTE-PRESENT    AND                             09140000
091500***     PS-EST-LBD-NM-PRESENT-NO  AND                             09150000
091600***     TR016-ETA-EST-LBD-DTE NOT = PC-DEFAULT-DATE               09160000
091700***        MOVE PC-E                     TO TR231-RPT-TYP         09170000
091800***        MOVE TR016-ETA-TRN-TYP        TO TR231-TRN-TYP         09180000
091900***        MOVE 'EST LBD NAME'           TO TR231-DATA-IN-ERROR   09190000
092000***        MOVE TR016-ETA-EST-LBD-NM     TO TR231-DATA-VALUE      09200000
092100***        MOVE PC-WARNING               TO TR231-ERROR-TYPE      09210000
092200***        MOVE 'DATA NOT SENT'          TO TR231-ERROR-MSG       09220000
092300***        MOVE SPACES                   TO TR231-ETA-EST-LBD-NM  09230000
092400***        MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR 09240000
092500***        PERFORM 6190-MOVES-FOR-ERROR-REC                       09250000
092600***        PERFORM 6200-WRITE-ERROR-REPORT                        09260000
092700***  END-IF.                                                      09270000
092800***                                                               09280000
092900***  IF (PS-EST-LBD-DTE-PRESENT AND                               09290000
093000***      PS-EST-LBD-NM-PRESENT  AND                               09300000
093100***      TR016-ETA-EST-LBD-DTE NOT = PC-DEFAULT-DATE)             09310000
093200***              OR                                               09320000
093300***     (PS-EST-LBD-DTE-PRESENT    AND                            09330000
093400***      PS-EST-LBD-NM-PRESENT-NO  AND                            09340000
093500***      TR016-ETA-EST-LBD-DTE NOT = PC-DEFAULT-DATE)             09350000
093600***       PERFORM 5620-CHK-VALID-EST-LBD-DTE-TM                   09360000
093700***          IF PS-EST-LBD-DTE-VALID AND                          09370000
093800***             PS-EST-LBD-NM-PRESENT                             09380000
093900***                MOVE TR016-ETA-EST-LBD-DTE       TO            09390000
094000***                       TR026-ETA-EST-LBD-DTE                   09400000
094100***                MOVE TR016-ETA-EST-LBD-NM        TO            09410000
094200***                       TR026-ETA-EST-LBD-NM                    09420000
094300***          ELSE                                                 09430000
094400***                MOVE PC-DEFAULT-DATE             TO            09440000
094500***                        TR026-ETA-EST-LBD-DTE                  09450000
094600***                MOVE ZEROES                      TO            09460000
094700***                        TR026-ETA-EST-LBD-TM                   09470000
094800***                MOVE SPACES                      TO            09480000
094900***                        TR026-ETA-EST-LBD-NM                   09490000
095000***          END-IF                                               09500000
095100***   ELSE                                                        09510000
095200***     MOVE PC-DEFAULT-DTE              TO                       09520000
095300***             TR026-ETA-EST-LBD-DTE                             09530000
095400***     MOVE ZEROES                      TO                       09540000
095500***             TR026-ETA-EST-LBD-TM                              09550000
095600***     MOVE SPACES                      TO                       09560000
095700***             TR026-ETA-EST-LBD-NM                              09570000
095800***   END-IF.                                                     09580000
095900                                                                  09590000
096000      IF TR016-ETA-TRIP-TYP-CDE-MOM EQUAL PC-O                    09600000
096100          MOVE TR016-ETA-TRIP-TYP-CDE-MOM TO                      09610000
096200                                      TR026-ETA-TRIP-TYP-CDE-MOM  09620000
096300      ELSE                                                        09630000
096400          SET PS-EDIT-ERROR TO TRUE                               09640000
096500          ADD +1 TO PA-TOT-NON-OCEAN-RECS                         09650000
096600          DISPLAY '**********************************'            09660000
096700          DISPLAY '** NON OCEAN RECORD             **'            09670000
096800          DISPLAY '** PO NUMBER     = ' TR016-ETA-PO-NBR          09680000
096900          DISPLAY '** EXTL REF NBR  = ' TR016-ETA-EXTL-REF-NBR    09690000
097000          DISPLAY '** TRIP TYPE CDE = ' TR016-ETA-TRIP-TYP-CDE-MOM09700000
097100          DISPLAY '** TRAN TYPE     = ' TR016-ETA-TRN-TYP         09710000
097200          DISPLAY '** RECORD TYPE   = ' TR016-ETA-REC-TYP-CDE     09720000
097300          DISPLAY '**********************************'            09730000
097400      END-IF.                                                     09740000
097500                                                                  09750000
097600      IF PS-EDIT-ERROR-NO                                         09760000
097700         MOVE TR016-ETA-TRN-TYP       TO TR026-ETA-TRN-TYP        09770000
097800         MOVE TR016-ETA-REC-TYP-CDE   TO TR026-ETA-REC-TYP-CDE    09780000
097900         MOVE TR016-ETA-SEQ-NBR       TO TR026-ETA-SEQ-NBR        09790000
098000         MOVE TR016-ETA-3RD-PARTY-CDE TO TR026-ETA-3RD-PARTY-CDE  09800000
098100         MOVE PV-PROCESS-SEQ-NBR     TO TR026-ETA-PROCESS-SEQ-NBR 09810000
098200         MOVE PLNSHP-FOB-CDE         TO TR026-ETA-FOB-CDE         09820000
098300         MOVE EXTENT-SCAC-CDE        TO TR026-ETA-EXTENT-SCAC-CDE 09830000
098400                                                                  09840000
098500         PERFORM 7310-OPEN-CONTNR-CURSOR                          09850000
098600         SET PS-EOC-CONTNR-CURSOR-NO TO TRUE                      09860000
098700         SET PS-CONTNR-EXISTS TO TRUE                             09870000
098800         SET PS-THERE-IS-A-CONTNR-NO TO TRUE                      09880000
098900         PERFORM 3500-PROCESS-CONTNR-CURSOR                       09890000
099000             UNTIL PS-EOC-CONTNR-CURSOR                           09900000
099100         IF PS-EOC-CONTNR-CURSOR                                  09910000
099200             PERFORM 7320-CLOSE-CONTNR-CURSOR                     09920000
099300         END-IF                                                   09930000
099400         IF PS-THERE-IS-A-CONTNR                                  09940000
099500             CONTINUE                                             09950000
099600         ELSE                                                     09960000
099700             PERFORM 3510-PROCESS-TURNAROUND-RECORD               09970000
099800         END-IF                                                   09980000
099900      END-IF.                                                     09990000
100000                                                                  10000000
100100  EJECT                                                           10010000
100200******************************************************************10020000
100300* EDIT THE FIELDS THAT ARE PRESENT ON THE ADU RECORD TYPE ONLY.  *10030000
100400* THE EXCEPTION IS DEST-POE-CDE WHICH OCCURS ON THE ETA AND ADU  *10040000
100500* RECORD TYPES. THE DEST-POE-CDE AND DEST-POE-DATE ARE REQUIRED. *10050000
100600******************************************************************10060000
100700 3400-EDIT-ADU-FIELDS.                                            10070000
100800                                                                  10080000
100900     IF TR016-ADU-TRN-TYP EQUAL PC-D                              10090001
101200         MOVE SPACES       TO  TR026-ADU-ACTL-DEST-POE-CDE        10120001
101300     ELSE                                                         10130000
101400         IF TR016-ADU-ACTL-DEST-POE-CDE EQUAL SPACES OR           10140000
101500            TR016-ADU-ACTL-DEST-POE-CDE EQUAL ZEROES              10150000
101600              MOVE PC-E                        TO TR231-RPT-TYP   10160000
101700              MOVE TR016-ADU-TRN-TYP           TO TR231-TRN-TYP   10170000
101800              MOVE 'ACTL POE CDE'          TO TR231-DATA-IN-ERROR 10180000
101900              MOVE TR016-ADU-ACTL-DEST-POE-CDE TO TR231-DATA-VALUE10190000
102000              MOVE PC-ERROR                    TO TR231-ERROR-TYPE10200000
102100              SET PS-EDIT-ERROR                TO TRUE            10210000
102200              MOVE 'DATA NOT SENT'             TO TR231-ERROR-MSG 10220000
102300              MOVE PV-PROCESS-SEQ-NBR     TO TR231-PROCESS-SEQ-NBR10230000
102400              PERFORM 6190-MOVES-FOR-ERROR-REC                    10240000
102500              PERFORM 6200-WRITE-ERROR-REPORT                     10250000
102600         ELSE                                                     10260000
102700              MOVE TR016-ADU-ACTL-DEST-POE-CDE                    10270000
102900                                   TO TR026-ADU-ACTL-DEST-POE-CDE 10290000
103300              MOVE PV-WRK-POE-NM TO TR026-ADU-ACTL-DEST-POE-NAME  10330000
103400         END-IF                                                   10340000
103500     END-IF.                                                      10350000
103600                                                                  10360000
103700     SET PS-ACTL-POE-DTE-TM-PRESENT-NO TO TRUE.                   10370000
103800                                                                  10380000
103900     IF TR016-ADU-TRN-TYP EQUAL PC-D                              10390001
104200          MOVE PC-DEFAULT-DATE  TO TR026-ADU-ACTL-POE-DELY-DTE    10420001
104300          MOVE ZEROES           TO TR026-ADU-ACTL-POE-DELY-TM     10430001
104400     ELSE                                                         10440000
104500       IF TR016-ADU-ACTL-POE-DELY-DTE EQUAL SPACES                10450000
104600          MOVE PC-E                     TO TR231-RPT-TYP          10460000
104700          MOVE TR016-ADU-TRN-TYP        TO TR231-TRN-TYP          10470000
104800          MOVE 'ACTL POE DTE'           TO TR231-DATA-IN-ERROR    10480000
104900          MOVE TR016-ADU-ACTL-POE-DELY-DTE TO TR231-DATA-VALUE    10490000
105000          MOVE PC-ERROR                 TO TR231-ERROR-TYPE       10500000
105100          MOVE 'DATA NOT SENT'          TO TR231-ERROR-MSG        10510000
105200          SET PS-EDIT-ERROR             TO TRUE                   10520000
105300          MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR  10530000
105400          MOVE TR016-ADU-TRN-TYP        TO TR026-ADU-TRN-TYP      10540000
105500          MOVE TR016-ADU-REC-TYP-CDE    TO TR026-ADU-REC-TYP-CDE  10550000
105600          MOVE TR016-ADU-SEQ-NBR        TO TR026-ADU-SEQ-NBR      10560000
105700          MOVE TR016-ADU-3RD-PARTY-CDE TO TR026-ADU-3RD-PARTY-CDE 10570000
105800          PERFORM 6190-MOVES-FOR-ERROR-REC                        10580000
105900          PERFORM 6200-WRITE-ERROR-REPORT                         10590000
106000       ELSE                                                       10600000
106100          SET PS-ACTL-POE-DTE-TM-PRESENT  TO TRUE                 10610000
106200       END-IF                                                     10620000
106300     END-IF.                                                      10630000
106400                                                                  10640000
106500     IF PS-ACTL-POE-DTE-TM-PRESENT                                10650000
106600        PERFORM 5630-CHK-VALID-ACTL-POE-DTE-TM                    10660000
106700     ELSE                                                         10670000
106800        CONTINUE                                                  10680000
106900     END-IF.                                                      10690000
107000                                                                  10700000
107100      IF TR016-ADU-TRIP-TYP-CDE-MOM EQUAL PC-O                    10710000
107200          MOVE TR016-ADU-TRIP-TYP-CDE-MOM TO                      10720000
107300                                      TR026-ADU-TRIP-TYP-CDE-MOM  10730000
107400      ELSE                                                        10740000
107500          SET PS-EDIT-ERROR TO TRUE                               10750000
107600          ADD +1 TO PA-TOT-NON-OCEAN-RECS                         10760000
107700          DISPLAY '**********************************'            10770000
107800          DISPLAY '** NON OCEAN RECORD             **'            10780000
107900          DISPLAY '** PO NUMBER     = ' TR016-ADU-PO-NBR          10790000
108000          DISPLAY '** EXTL REF NBR  = ' TR016-ADU-EXTL-REF-NBR    10800000
108100          DISPLAY '** TRIP TYPE CDE = ' TR016-ADU-TRIP-TYP-CDE-MOM10810000
108200          DISPLAY '** TRAN TYPE     = ' TR016-ADU-TRN-TYP         10820000
108300          DISPLAY '** RECORD TYPE   = ' TR016-ADU-REC-TYP-CDE     10830000
108400          DISPLAY '**********************************'            10840000
108500      END-IF.                                                     10850000
108600                                                                  10860000
108700      IF PS-EDIT-ERROR-NO                                         10870000
108800         MOVE TR016-ADU-TRN-TYP       TO TR026-ADU-TRN-TYP        10880000
108900         MOVE TR016-ADU-REC-TYP-CDE   TO TR026-ADU-REC-TYP-CDE    10890000
109000         MOVE TR016-ADU-SEQ-NBR       TO TR026-ADU-SEQ-NBR        10900000
109100         MOVE TR016-ADU-3RD-PARTY-CDE TO TR026-ADU-3RD-PARTY-CDE  10910000
109200         MOVE PV-PROCESS-SEQ-NBR     TO TR026-ADU-PROCESS-SEQ-NBR 10920000
109300         MOVE PLNSHP-FOB-CDE         TO TR026-ADU-FOB-CDE         10930000
109400         MOVE EXTENT-SCAC-CDE        TO TR026-ADU-EXTENT-SCAC-CDE 10940000
109500                                                                  10950000
109600         PERFORM 7310-OPEN-CONTNR-CURSOR                          10960000
109700         SET PS-EOC-CONTNR-CURSOR-NO TO TRUE                      10970000
109800         SET PS-CONTNR-EXISTS TO TRUE                             10980000
109900         SET PS-THERE-IS-A-CONTNR-NO TO TRUE                      10990000
110000         PERFORM 3500-PROCESS-CONTNR-CURSOR                       11000000
110100             UNTIL PS-EOC-CONTNR-CURSOR                           11010000
110200         IF PS-EOC-CONTNR-CURSOR                                  11020000
110300             PERFORM 7320-CLOSE-CONTNR-CURSOR                     11030000
110400         END-IF                                                   11040000
110500         IF PS-THERE-IS-A-CONTNR                                  11050000
110600             CONTINUE                                             11060000
110700         ELSE                                                     11070000
110800            PERFORM 3510-PROCESS-TURNAROUND-RECORD                11080000
110900         END-IF                                                   11090000
111000      END-IF.                                                     11100000
111100                                                                  11110000
111200 EJECT                                                            11120000
111300******************************************************************11130000
111400* PROCESS THE CONTAINER CURSOR TO OBTAIN THE CONTAINER ID AND    *11140000
111500* CONTAINER SEQUENCE NUMBER TO PASS TO THE LOAD PROGRAM.         *11150000
111600******************************************************************11160000
111700 3500-PROCESS-CONTNR-CURSOR.                                      11170000
111800                                                                  11180000
111900     PERFORM 7330-FETCH-CONTNR-CURSOR.                            11190000
112000                                                                  11200000
112100     IF PS-CONTNR-EXISTS                                          11210000
112200         MOVE IMCNTK-CONTNR-ID      TO TR026-ETA-CONTNR-ID        11220000
112300         MOVE IMCNTK-CONTNR-SEQ-NBR TO TR026-ETA-CONTNR-SEQ       11230000
112400         PERFORM 6400-WRITE-LOAD-FILE                             11240000
112500     END-IF.                                                      11250000
112600                                                                  11260000
112700******************************************************************11270000
112800* PROCESS TURNAROUND RECORD.                                     *11280000
112900* BYPASS AIR SHIPMENTS  (PV-WRK-TRIP-TYPE-CDE-MOM = PC-A) AND    *11290000
113000* ALPI OR CAPITAL (SCAC - 'ALPI' OR 'CAP1').                     *11300000
113100******************************************************************11310000
113200                                                                  11320000
113300 3510-PROCESS-TURNAROUND-RECORD.                                  11330000
113400                                                                  11340000
113500     EVALUATE TRUE                                                11350000
113600                                                                  11360000
113700       WHEN PS-ALPI-OR-CAP1                                       11370000
113702       WHEN PS-AIR-SHIPMENT                                       11370200
114000         CONTINUE                                                 11400000
114100                                                                  11410000
114200       WHEN OTHER                                                 11420000
114300         PERFORM 3520-CONTAINER-NOT-FOUND-ERROR                   11430000
114400         IF PV-HOLD-EDI-RECORD   NOT =  PV-TURN-ISA-WRITTEN       11440000
114500             IF PV-HOLD-IEA-RECORD = SPACES                       11450000
114600               CONTINUE                                           11460000
114700             ELSE                                                 11470000
114800               MOVE PV-HOLD-IEA-RECORD TO TR016-REC-TYP-ETA       11480000
114900               PERFORM 6500-WRITE-TURNAROUND-RECORD               11490000
115000             END-IF                                               11500000
115100***MAM       MOVE TR016-REC-TYP-ETA                               11510000
115200***MAM                           TO PV-HOLD-TR016-REC-TYP-ETA     11520000
115300             MOVE PV-HOLD-EDI-RECORD TO TR016-REC-TYP-ETA         11530000
115400                                        PV-TURN-ISA-WRITTEN       11540000
115500             PERFORM 6500-WRITE-TURNAROUND-RECORD                 11550000
115600         END-IF                                                   11560000
115700                                                                  11570000
115800         IF PV-HOLD-TR016-ETA-TURN-CRE-DTE = SPACES               11580000
115900             PERFORM 7100-SET-CURRENT-TMST                        11590000
116000             PERFORM 5730-REFORMAT-CURRENT-TMST                   11600000
116100             MOVE PV-HOLD-TR016-REC-TYP-ETA TO TR016-REC-TYP-ETA  11610000
116200             MOVE PV-REFORMAT-TMST-DTE TO TR016-ETA-TURN-CRE-DTE  11620000
116300             MOVE PV-REFORMAT-TMST-TM  TO TR016-ETA-TURN-CRE-TM   11630000
116400             PERFORM 6500-WRITE-TURNAROUND-RECORD                 11640000
116500         ELSE                                                     11650000
116600             MOVE PV-HOLD-TR016-REC-TYP-ETA TO TR016-REC-TYP-ETA  11660000
116700             PERFORM 6500-WRITE-TURNAROUND-RECORD                 11670000
116800         END-IF                                                   11680000
116900                                                                  11690000
117000     END-EVALUATE.                                                11700000
117100                                                                  11710000
117200******************************************************************11720000
117300* PROCESS CONTAINER NOT FOUND ERROR.                             *11730000
117400******************************************************************11740000
117500                                                                  11750000
117600 3520-CONTAINER-NOT-FOUND-ERROR.                                  11760000
117700                                                                  11770000
117800     MOVE PC-E                     TO TR231-RPT-TYP.              11780000
117900     MOVE TR016-ETA-TRN-TYP        TO TR231-TRN-TYP.              11790000
118000     MOVE 'CONTNR ID   '           TO TR231-DATA-IN-ERROR.        11800000
118100     MOVE SPACES                   TO TR231-DATA-VALUE            11810000
118200     MOVE PC-ERROR                 TO TR231-ERROR-TYPE.           11820000
118300                                                                  11830000
118400*    *********************************************************    11840000
118500*    * WHICH ERROR MESSAGE?                                  *    11850000
118600*    *  WE KNOW NO CONTAINER EXISTS FOR PO/XREF COMBO. NOW   *    11860000
118700*    *  DETERMINE IF A CONTAINER EXISTS AT ALL FOR THIS PO.  *    11870000
118800*    *  IF IT DOES, THE REFERENCE NUMBER IS BAD ON EITHER    *    11880000
118900*    *  THE ARRIVAL OR CONTAINER DATA SENT.  ELSE THE PO NBR *    11890000
119000*    *  IS THE BAD DATA.                                     *    11900000
119100*    *********************************************************    11910000
119200     SET PS-PO-EXISTS-ON-TIMCNPO-NO TO TRUE.                      11920000
119300     PERFORM 7450-SELECT-TIMCNPO.                                 11930000
119400     IF PS-PO-EXISTS-ON-TIMCNPO                                   11940000
119500       MOVE 'NO CONTAINER MANIFEST FOR REF NBR - NOT PROCESSED'   11950000
119600                                   TO TR231-ERROR-MSG             11960000
119700     ELSE                                                         11970000
119800       MOVE 'NO CONTAINER MANIFEST FOR PO NBR - NOT PROCESSED'    11980000
119900                                   TO TR231-ERROR-MSG             11990000
120000     END-IF.                                                      12000000
120100*    *********************************************************    12010000
120200                                                                  12020000
120300     MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR.      12030000
120400     MOVE TR016-ETA-TRN-TYP        TO TR026-ETA-TRN-TYP.          12040000
120500     MOVE TR016-ETA-REC-TYP-CDE    TO TR026-ETA-REC-TYP-CDE.      12050000
120600     MOVE TR016-ETA-SEQ-NBR        TO TR026-ETA-SEQ-NBR.          12060000
120700     MOVE TR016-ETA-3RD-PARTY-CDE  TO TR026-ETA-3RD-PARTY-CDE.    12070000
120800     PERFORM 6190-MOVES-FOR-ERROR-REC.                            12080000
120900     PERFORM 6200-WRITE-ERROR-REPORT.                             12090000
121000                                                                  12100000
121100******************************************************************12110000
121200* PROCESS THE RECYCLE RECORDS FROM CONTAINER DELETE PROCESSING.  *12120000
121300* IF THE CONTAINER HAS BEEN READDED SEND THE RECORD THRU TO THE  *12130000
121400* LOAD PROGRAM OTHERWISE RECYCLE (TURNAROUND) THE RECORD FOR THE *12140000
121500* NEXT RUN.                                                      *12150000
121600******************************************************************12160000
121700 3600-PROCESS-RECYCLE-RECORD.                                     12170000
121800                                                                  12180000
121900     MOVE TR016-ADURD-PO-NBR     TO PV-PO-NBR.                    12190000
122000     MOVE TR016-ADURD-TRN-TYP    TO TR026-ADURD-TRN-TYP.          12200000
122100     SET  TR026-ADURD-REC-TYP-CDE-ADURDA                          12210000
122200          TR026-ADURD-SEQ-NBR-25 TO TRUE.                         12220000
122300     MOVE TR016-ADURD-3RD-PARTY-CDE                               12230000
122400                                 TO TR026-ADURD-3RD-PARTY-CDE.    12240000
122500     MOVE TR016-ADURD-PO-NBR     TO TR026-ADURD-PO-NBR.           12250000
122600     MOVE TR016-ADURD-EXTL-REF-NBR                                12260000
122700                                 TO TR026-ADURD-EXTL-REF-NBR.     12270000
122800     MOVE TR016-ADURD-TRIP-TYP-CDE-MOM                            12280000
122900                                 TO TR026-ADURD-TRIP-TYP-CDE-MOM. 12290000
123000     MOVE TR016-ADURD-CARR-SCAC-ID                                12300000
123100                                 TO TR026-ADURD-CARR-SCAC-ID.     12310000
123200     MOVE TR016-ADURD-IMPRT-TRIP-ID                               12320000
123300                                 TO TR026-ADURD-IMPRT-TRIP-ID.    12330000
123400     MOVE TR016-ADURD-IMPRT-VEH-NM                                12340000
123500                                 TO TR026-ADURD-IMPRT-VEH-NM.     12350000
123600     MOVE TR016-ADURD-ACTL-DEST-POE-CDE                           12360000
123700                                 TO TR026-ADURD-ACTL-DEST-POE-CDE.12370000
123800     MOVE TR016-ADURD-ACTL-POE-DELY-DTE                           12380000
123900                                 TO TR026-ADURD-ACTL-POE-DELY-DTE.12390000
124000     MOVE TR016-ADURD-ACTL-POE-DELY-TM                            12400000
124100                                 TO TR026-ADURD-ACTL-POE-DELY-TM. 12410000
124200                                                                  12420000
124300     MOVE TR016-ETA-DEST-POE-CDE-MOM                              12430000
124400                                 TO PV-WRK-POE-CDE.               12440000
124500     MOVE TR016-ETA-TRIP-TYP-CDE-MOM                              12450000
124600                                 TO PV-WRK-TRIP-TYPE-CDE-MOM.     12460000
124700     PERFORM 7040-GET-POE-NAME.                                   12470000
124800     MOVE PV-WRK-POE-NM         TO TR026-ADURD-ACTL-DEST-POE-NAME.12480000
124900     MOVE PLNSHP-FOB-CDE        TO TR026-ADURD-FOB-CDE.           12490000
125000     MOVE EXTENT-SCAC-CDE       TO TR026-ADURD-EXTENT-SCAC-CDE.   12500000
125100     MOVE PV-PROCESS-SEQ-NBR    TO TR026-ADURD-PROCESS-SEQ-NBR.   12510000
125200                                                                  12520000
125300     PERFORM 7310-OPEN-CONTNR-CURSOR.                             12530000
125400     SET PS-EOC-CONTNR-CURSOR-NO                                  12540000
125500         PS-CONTNR-EXISTS                                         12550000
125600         PS-THERE-IS-A-CONTNR-NO     TO TRUE.                     12560000
125700     PERFORM 3500-PROCESS-CONTNR-CURSOR                           12570000
125800         UNTIL PS-EOC-CONTNR-CURSOR.                              12580000
125900     IF PS-EOC-CONTNR-CURSOR                                      12590000
126000         PERFORM 7320-CLOSE-CONTNR-CURSOR                         12600000
126100     END-IF.                                                      12610000
126200     IF PS-THERE-IS-A-CONTNR                                      12620000
126300         CONTINUE                                                 12630000
126400     ELSE                                                         12640000
126500         PERFORM 3510-PROCESS-TURNAROUND-RECORD                   12650000
126600     END-IF.                                                      12660000
126700                                                                  12670000
126800******************************************************************12680000
126900* CHECK THE INPUT EST POE DATE WITH A CALENDAR ROUTINE TO MAKE   *12690000
127000* SURE THE DATE IS VALID, THEN EDIT THE EST POE TIME FIELD.      *12700000
127100******************************************************************12710000
127200 5610-CHK-VALID-EST-POE-DTE-TM.                                   12720000
127300                                                                  12730000
127400     INITIALIZE   DPG51 DPG52 DPG53                               12740000
127500                  DPG54 DPG55 DPG56.                              12750000
127600                                                                  12760000
127700     SET DPG52-LK-DTE-ISO              TO TRUE.                   12770000
127800     SET PS-EST-POE-DTE-VALID-NO       TO TRUE.                   12780000
127900     MOVE TR016-ETA-EST-POE-DELY-DTE   TO                         12790000
128000            DPG52-LK-DATE-INPUT.                                  12800000
128100     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 12810000
128200                                                                  12820000
128300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    12830000
128400                                             DPG54 DPG55 DPG56.   12840000
128500                                                                  12850000
128600     EVALUATE TRUE                                                12860000
128700         WHEN DPG54-SEVERE-ERROR                                  12870000
128800         WHEN DPG54-WARNING-ERROR                                 12880000
128900            MOVE PC-E                    TO TR231-RPT-TYP         12890000
129000            MOVE TR016-ETA-TRN-TYP       TO TR231-TRN-TYP         12900000
129100            MOVE 'EST POE DELY DT'       TO TR231-DATA-IN-ERROR   12910000
129200            MOVE TR016-ETA-EST-POE-DELY-DTE TO TR231-DATA-VALUE   12920000
129300            MOVE PC-ERROR                TO TR231-ERROR-TYPE      12930000
129400            SET PS-EDIT-ERROR            TO TRUE                  12940000
129500            MOVE 'INVALID DATE'          TO TR231-ERROR-MSG       12950000
129600            MOVE PV-PROCESS-SEQ-NBR      TO TR231-PROCESS-SEQ-NBR 12960000
129700            PERFORM 6190-MOVES-FOR-ERROR-REC                      12970000
129800            PERFORM 6200-WRITE-ERROR-REPORT                       12980000
129900     END-EVALUATE.                                                12990000
130000                                                                  13000000
130100         IF TR016-ETA-EST-POE-DELY-TM EQUAL SPACES OR             13010000
130200            TR016-ETA-EST-POE-DELY-TM EQUAL ZEROES                13020000
130300              MOVE ZEROES TO TR026-ETA-EST-POE-DELY-TM            13030000
130400              MOVE TR016-ETA-EST-POE-DELY-DTE TO                  13040000
130500                    TR026-ETA-EST-POE-DELY-DTE                    13050000
130600         ELSE                                                     13060000
130700              IF TR016-ETA-EST-POE-DELY-TM (1:2) < 25 AND         13070000
130800                 TR016-ETA-EST-POE-DELY-TM (3:2) < 61             13080000
130900                   MOVE TR016-ETA-EST-POE-DELY-TM   TO            13090000
131000                           TR026-ETA-EST-POE-DELY-TM              13100000
131100                   MOVE TR016-ETA-EST-POE-DELY-DTE TO             13110000
131200                           TR026-ETA-EST-POE-DELY-DTE             13120000
131300              ELSE                                                13130000
131400                   MOVE PC-E                 TO TR231-RPT-TYP     13140000
131500                   MOVE TR016-ETA-TRN-TYP    TO TR231-TRN-TYP     13150000
131600                   MOVE 'EST POE DELY TM' TO TR231-DATA-IN-ERROR  13160000
131700                   MOVE TR016-ETA-EST-POE-DELY-TM   TO            13170000
131800                          TR231-DATA-VALUE                        13180000
131900                   MOVE PC-WARNING           TO TR231-ERROR-TYPE  13190000
132000                   MOVE 'INVALID TIME'       TO TR231-ERROR-MSG   13200000
132100                   MOVE ZEROES       TO TR026-ETA-EST-POE-DELY-TM 13210000
132200                   MOVE PV-PROCESS-SEQ-NBR   TO                   13220000
132300                         TR231-PROCESS-SEQ-NBR                    13230000
132400                   PERFORM 6190-MOVES-FOR-ERROR-REC               13240000
132500                   PERFORM 6200-WRITE-ERROR-REPORT                13250000
132600                   MOVE TR016-ETA-EST-POE-DELY-DTE TO             13260000
132700                           TR026-ETA-EST-POE-DELY-DTE             13270000
132800                   MOVE TR016-ETA-EST-POE-DELY-TM    TO           13280000
132900                           TR026-ETA-EST-POE-DELY-TM              13290000
133000              END-IF                                              13300000
133100         END-IF.                                                  13310000
133200                                                                  13320000
133300 EJECT                                                            13330000
133400******************************************************************13340000
133500* CHECK THE INPUT EST LBD DATE WITH A CALENDAR ROUTINE TO MAKE   *13350000
133600* SURE THE DATE IS VALID, THEN EDIT THE EST LBD TIME FIELD.      *13360000
133700******************************************************************13370000
133800*                                                                *13380000
133900*5620-CHK-VALID-EST-LBD-DTE-TM.                                  *13390000
134000*                                                                *13400000
134100*    INITIALIZE   DPG51 DPG52 DPG53                              *13410000
134200*                 DPG54 DPG55 DPG56.                             *13420000
134300*                                                                *13430000
134400*    SET DPG52-LK-DTE-ISO              TO TRUE.                  *13440000
134500*    SET PS-EST-LBD-DTE-VALID-NO       TO TRUE.                  *13450000
134600*    MOVE TR016-ETA-EST-LBD-DTE        TO                        *13460000
134700*           DPG52-LK-DATE-INPUT.                                 *13470000
134800*    MOVE PC-A0                           TO DPG51-CALENDAR-TYPE.*13480000
134900*                                                                *13490000
135000*    CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53   *13500000
135100*                                            DPG54 DPG55 DPG56.  *13510000
135200*                                                                *13520000
135300*    EVALUATE TRUE                                               *13530000
135400*        WHEN DPG54-SEVERE-ERROR                                 *13540000
135500*        WHEN DPG54-WARNING-ERROR                                *13550000
135600*           MOVE PC-E                    TO TR231-RPT-TYP        *13560000
135700*           MOVE TR016-ETA-TRN-TYP       TO TR231-TRN-TYP        *13570000
135800*           MOVE 'EST LBD DATE'          TO TR231-DATA-IN-ERROR  *13580000
135900*           MOVE TR016-ETA-EST-LBD-DTE   TO TR231-DATA-VALUE     *13590000
136000*           MOVE PC-WARNING              TO TR231-ERROR-TYPE     *13600000
136100*           MOVE 'INVALID ESTIMATED LAND BRIDGE DATE'            *13610000
136200*                                        TO TR231-ERROR-MSG      *13620000
136300*           MOVE PV-PROCESS-SEQ-NBR      TO TR231-PROCESS-SEQ-NBR*13630000
136400*           PERFORM 6190-MOVES-FOR-ERROR-REC                     *13640000
136500*           PERFORM 6200-WRITE-ERROR-REPORT                      *13650000
136600*        WHEN OTHER                                              *13660000
136700*           SET PS-EST-LBD-DTE-VALID     TO TRUE                 *13670000
136800*    END-EVALUATE.                                               *13680000
136900*                                                                *13690000
137000*        IF TR016-ETA-EST-LBD-TM EQUAL SPACES OR                 *13700000
137100*           TR016-ETA-EST-LBD-TM EQUAL ZEROES                    *13710000
137200*           MOVE ZEROES                   TO TR026-ETA-EST-LBD-TM*13720000
137300*        ELSE                                                    *13730000
137400*             IF TR016-ETA-EST-LBD-TM (1:2) < 25 AND             *13740000
137500*                TR016-ETA-EST-LBD-TM (3:2) < 61                 *13750000
137600*                  MOVE TR016-ETA-EST-LBD-TM   TO                *13760000
137700*                         TR026-ETA-EST-LBD-TM                   *13770000
137800*             ELSE                                               *13780000
137900*                MOVE PC-E                 TO TR231-RPT-TYP      *13790000
138000*                MOVE TR016-ETA-TRN-TYP    TO TR231-TRN-TYP      *13800000
138100*                MOVE 'EST LBD TIME'       TO TR231-DATA-IN-ERROR*13810000
138200*                MOVE TR016-ETA-EST-LBD-TM TO TR231-DATA-VALUE   *13820000
138300*                MOVE PC-WARNING           TO TR231-ERROR-TYPE   *13830000
138400*                MOVE 'INVALID TIME'       TO TR231-ERROR-MSG    *13840000
138500*                MOVE ZEROES               TO TR026-ETA-EST-LBD-TM13850000
138600*                MOVE PV-PROCESS-SEQ-NBR TO TR231-PROCESS-SEQ-NBR*13860000
138700*                PERFORM 6190-MOVES-FOR-ERROR-REC                *13870000
138800*                PERFORM 6200-WRITE-ERROR-REPORT                 *13880000
138900*        END-IF.                                                 *13890000
139000*                                                                *13900000
139100*EJECT                                                           *13910000
139200******************************************************************13920000
139300* CHECK THE INPUT ACTL POE DATE WITH A CALENDAR ROUTINE TO MAKE  *13930000
139400* SURE THE DATE IS VALID, THEN EDIT THE ACTL POE TIME FIELD.     *13940000
139500******************************************************************13950000
139600 5630-CHK-VALID-ACTL-POE-DTE-TM.                                  13960000
139700                                                                  13970000
139800     INITIALIZE   DPG51 DPG52 DPG53                               13980000
139900                  DPG54 DPG55 DPG56.                              13990000
140000                                                                  14000000
140100     SET DPG52-LK-DTE-ISO              TO TRUE.                   14010000
140200     SET PS-ACTL-POE-DTE-VALID-NO      TO TRUE.                   14020000
140300     MOVE TR016-ADU-ACTL-POE-DELY-DTE  TO                         14030000
140400            DPG52-LK-DATE-INPUT.                                  14040000
140500     MOVE PC-A0                           TO DPG51-CALENDAR-TYPE. 14050000
140600                                                                  14060000
140700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    14070000
140800                                             DPG54 DPG55 DPG56.   14080000
140900                                                                  14090000
141000     EVALUATE TRUE                                                14100000
141100         WHEN DPG54-SEVERE-ERROR                                  14110000
141200         WHEN DPG54-WARNING-ERROR                                 14120000
141300            MOVE PC-E                    TO TR231-RPT-TYP         14130000
141400            MOVE TR016-ETA-TRN-TYP       TO TR231-TRN-TYP         14140000
141500            MOVE 'ACT POE DELY DT'       TO TR231-DATA-IN-ERROR   14150000
141600            MOVE TR016-ADU-ACTL-POE-DELY-DTE TO TR231-DATA-VALUE  14160000
141700            MOVE PC-ERROR                TO TR231-ERROR-TYPE      14170000
141800            SET PS-EDIT-ERROR            TO TRUE                  14180000
141900            MOVE 'INVALID DATE'          TO TR231-ERROR-MSG       14190000
142000            MOVE PV-PROCESS-SEQ-NBR      TO TR231-PROCESS-SEQ-NBR 14200000
142100            PERFORM 6190-MOVES-FOR-ERROR-REC                      14210000
142200            PERFORM 6200-WRITE-ERROR-REPORT                       14220000
142300     END-EVALUATE.                                                14230000
142400                                                                  14240000
142500         IF TR016-ADU-ACTL-POE-DELY-TM EQUAL SPACES OR            14250000
142600            TR016-ADU-ACTL-POE-DELY-TM EQUAL ZEROES               14260000
142700              MOVE ZEROES TO TR026-ADU-ACTL-POE-DELY-TM           14270000
142800              MOVE TR016-ADU-ACTL-POE-DELY-DTE TO                 14280000
142900                    TR026-ADU-ACTL-POE-DELY-DTE                   14290000
143000         ELSE                                                     14300000
143100              IF TR016-ADU-ACTL-POE-DELY-TM (1:2) < 25 AND        14310000
143200                 TR016-ADU-ACTL-POE-DELY-TM (3:2) < 61            14320000
143300                   MOVE TR016-ADU-ACTL-POE-DELY-TM   TO           14330000
143400                           TR026-ADU-ACTL-POE-DELY-TM             14340000
143500                   MOVE TR016-ADU-ACTL-POE-DELY-DTE TO            14350000
143600                           TR026-ADU-ACTL-POE-DELY-DTE            14360000
143700              ELSE                                                14370000
143800                   MOVE PC-E                 TO TR231-RPT-TYP     14380000
143900                   MOVE TR016-ETA-TRN-TYP    TO TR231-TRN-TYP     14390000
144000                   MOVE 'ACT POE DELY TM'  TO TR231-DATA-IN-ERROR 14400000
144100                   MOVE TR016-ADU-ACTL-POE-DELY-TM   TO           14410000
144200                          TR231-DATA-VALUE                        14420000
144300                   MOVE PC-WARNING           TO TR231-ERROR-TYPE  14430000
144400                   MOVE 'INVALID TIME'       TO TR231-ERROR-MSG   14440000
144500                   MOVE ZEROES      TO TR026-ETA-EST-POE-DELY-TM  14450000
144600                   MOVE PV-PROCESS-SEQ-NBR   TO                   14460000
144700                          TR231-PROCESS-SEQ-NBR                   14470000
144800                   PERFORM 6190-MOVES-FOR-ERROR-REC               14480000
144900                   PERFORM 6200-WRITE-ERROR-REPORT                14490000
145000                   MOVE TR016-ADU-ACTL-POE-DELY-TM  TO            14500000
145100                          TR026-ADU-ACTL-POE-DELY-TM              14510000
145200                   MOVE TR016-ADU-ACTL-POE-DELY-DTE TO            14520000
145300                           TR026-ADU-ACTL-POE-DELY-DTE            14530000
145400              END-IF                                              14540000
145500         END-IF.                                                  14550000
145600                                                                  14560000
145700 EJECT                                                            14570000
145800******************************************************************14580000
145900* REFORMAT CURRENT TIMESTAMP.                                    *14590000
146000******************************************************************14600000
146100 5730-REFORMAT-CURRENT-TMST.                                      14610000
146200                                                                  14620000
146300     MOVE PV-CURRENT-TMST (1:4) TO                                14630000
146400                      PV-REFORMAT-TMST-DTE-CY.                    14640000
146500     MOVE PV-CURRENT-TMST (6:2) TO                                14650000
146600                      PV-REFORMAT-TMST-DTE-MM.                    14660000
146700     MOVE PV-CURRENT-TMST (9:2) TO                                14670000
146800                      PV-REFORMAT-TMST-DTE-DD.                    14680000
146900     MOVE PV-CURRENT-TMST (12:2) TO                               14690000
147000                      PV-REFORMAT-TMST-TM-HH.                     14700000
147100     MOVE PV-CURRENT-TMST (15:2) TO                               14710000
147200                      PV-REFORMAT-TMST-TM-MM.                     14720000
147300                                                                  14730000
147400 EJECT                                                            14740000
147500******************************************************************14750000
147600* READ A RECORD FROM THE ORIGIN ARRIVAL FILE.                    *14760000
147700******************************************************************14770000
147800 6000-READ-ARRIVAL-RECORD.                                        14780000
147900                                                                  14790000
148100*    *************************                                    14810000
148110*    *  RESET SWITCHES FIRST *                                    14811000
148120*    *************************                                    14812000
148160     SET PS-AIR-SHIPMENT-NO           TO TRUE.                    14816000
148170     SET PS-ALPI-OR-CAP1-NO           TO TRUE.                    14817000
148180     SET PS-EDIT-ERROR-NO             TO TRUE.                    14818000
148190     SET PS-WRITE-THIS-EDI-NO         TO TRUE.                    14819000
148200                                                                  14820000
148300     READ TR016-ARRIVAL-FILE                                      14830000
148400         INTO TR016-REC-TYP-ETA                                   14840000
148500         AT END                                                   14850000
148600           SET PS-END-OF-ARRIVALS TO TRUE.                        14860000
148700                                                                  14870000
148800           IF PS-END-OF-ARRIVALS-NO                               14880000
148900              ADD +1               TO PA-TOTAL-INPUT-READ         14890000
149000           END-IF.                                                14900000
149100                                                                  14910000
149200          MOVE TR016-REC-TYP-ETA (1:3)     TO PV-REC-CHECK.       14920000
149300                                                                  14930000
149400          EVALUATE TRUE                                           14940000
149500                 WHEN PV-REC-CHECK EQUAL 'CTT'                    14950000
149600                      ADD  +1           TO PV-PROCESS-SEQ-NBR     14960000
149700                                           PA-TOTAL-EDI-REC-READ  14970000
149800                      SET PS-GOOD-RECORD-NO TO TRUE               14980000
149900                 WHEN PV-REC-CHECK EQUAL 'IEA'                    14990000
150000                      MOVE TR016-REC-TYP-ETA                      15000000
150100                                          TO PV-HOLD-IEA-RECORD   15010000
150200                      IF PS-END-OF-ARRIVALS-NO                    15020000
150300                         ADD  +1          TO PA-TOTAL-EDI-REC-READ15030000
150400                      END-IF                                      15040000
150500                         ADD  +1          TO PV-PROCESS-SEQ-NBR   15050000
150600                      SET PS-GOOD-RECORD-NO TO TRUE               15060000
150700                 WHEN PV-REC-CHECK EQUAL 'ISA'                    15070000
150800                      ADD  +1            TO PA-TOTAL-EDI-REC-READ 15080000
150900          END-EVALUATE.                                           15090000
151000                                                                  15100000
151100                                                                  15110000
151200     IF PS-END-OF-ARRIVALS AND PS-GOOD-RECORD                     15120000
151300         CONTINUE                                                 15130000
151400     ELSE                                                         15140000
151500         MOVE TR016-REC-TYP-ETA    (1:3) TO PV-EDI-RECORDS        15150000
151600                                                                  15160000
151700                IF EDI-ISA-RECORD                                 15170000
151800                   PERFORM 6040-CHECK-IEA-RECORD                  15180000
151900                   SET PS-EDI-RECORD TO TRUE                      15190000
152000                   PERFORM 6030-PROCESS-EDI-RECORD                15200000
152100                ELSE                                              15210000
152200                   IF PV-REC-CHECK NOT EQUAL 'CTT' AND            15220000
152300                      PV-REC-CHECK NOT EQUAL 'IEA'                15230000
152400                         SET PS-GOOD-RECORD TO TRUE               15240000
152500                         ADD +1 TO PV-PROCESS-SEQ-NBR             15250000
152600                         PERFORM 6050-CHECK-TURN-DTE              15260000
152700                   END-IF                                         15270000
152800                END-IF                                            15280000
152900           END-IF.                                                15290000
153000                                                                  15300000
153100     IF PS-END-OF-ARRIVALS-NO                                     15310000
153200         MOVE TR016-REC-TYP-ETA (1:3) TO PV-HOLD-LAST-REC-TYP     15320000
153300         MOVE TR016-REC-TYP-ETA  TO PV-HOLD-TR016-REC-TYP-ETA     15330000
153400     END-IF.                                                      15340000
153500                                                                  15350000
153600 EJECT                                                            15360000
153700***************************************************************** 15370000
153800* CHECK EDI RECORDS FOR AN ISA RECORD TO DETERMINE THE          * 15380000
153900* CONSOLIDATOR NAME.                                            * 15390000
154000***************************************************************** 15400000
154100 6030-PROCESS-EDI-RECORD.                                         15410000
154200                                                                  15420000
154300     IF TR016-REC-TYP-ETA    (1:3) EQUAL PC-ISA                   15430000
154400         ADD +1 TO PV-PROCESS-SEQ-NBR                             15440000
154500         MOVE TR016-REC-TYP-ETA   TO  PV-HOLD-EDI-RECORD          15450000
154600         MOVE PV-EDI-VEND-ID-QUAL     TO PV-VEND-ID-QUAL          15460000
154700         MOVE PV-EDI-VEND-ID          TO PV-VEND-ID               15470000
154800         PERFORM 6035-PROCESS-ISA-RECORD                          15480000
154900     END-IF.                                                      15490000
155000                                                                  15500000
155100 EJECT                                                            15510000
155200***************************************************************** 15520000
155300* PROCESS THE ISA RECORD TO OBTAIN HEADER RECORD FIELDS.        * 15530000
155400***************************************************************** 15540000
155500 6035-PROCESS-ISA-RECORD.                                         15550000
155600                                                                  15560000
155700      INITIALIZE                TR231-ARRVL-PAR-1-ODR.            15570000
155800      MOVE PC-HEADER1           TO TR231-ERROR-TYPE.              15580000
155900      MOVE PC-HDR               TO TR231-REC-TYP-HDR-CDE.         15590000
156000      MOVE PC-01                TO TR231-HDR-SEQ-NBR.             15600000
156100      MOVE PV-PROCESS-SEQ-NBR   TO TR231-PROCESS-SEQ-NBR.         15610000
156200                                                                  15620000
156300      PERFORM 7292-SELECT-TENTNME.                                15630000
156400      IF PS-VALID-ENTNME                                          15640000
156500          MOVE ENTNME-ENT-NAME-DESC TO TR231-HDR-CONSOL-ENTNME    15650000
156700      ELSE                                                        15670000
156800          MOVE SPACES               TO TR231-HDR-CONSOL-ENTNME    15680000
157000      END-IF.                                                     15700000
157100                                                                  15710000
157200      MOVE PV-EDI-CONSOL-TRNS-DTE  TO PV-HDR-CONSOL-TRNS-DTE-REST.15720000
157300                                                                  15730000
157400      IF PV-EDI-CONSOL-TRNS-DTE (1:2) EQUAL PC-98 OR PC-99        15740000
157500          MOVE PC-19 TO PV-HDR-CONSOL-TRNS-DTE-CC                 15750000
157600      ELSE                                                        15760000
157700          MOVE PC-20 TO PV-HDR-CONSOL-TRNS-DTE-CC                 15770000
157800      END-IF.                                                     15780000
157900                                                                  15790000
158000      MOVE PV-HDR-CONSOL-TRNS-DTE   TO TR231-HDR-CONSOL-TRNS-DTE. 15800000
158100                                                                  15810000
158200      MOVE PV-EDI-CONSOL-TRNS-TM    TO TR231-HDR-CONSOL-TRNS-TM.  15820000
158300      MOVE PV-EDI-CONSOL-FIL-ID     TO TR231-HDR-CONSOL-FIL-ID.   15830000
158400                                                                  15840000
158500      PERFORM 7100-SET-CURRENT-TMST.                              15850000
158600      PERFORM 5730-REFORMAT-CURRENT-TMST.                         15860000
158700      MOVE PV-REFORMAT-TMST-DTE     TO TR231-HDR-LOAD-DTE.        15870000
158800      MOVE PV-REFORMAT-TMST-TM      TO TR231-HDR-LOAD-TM.         15880000
158900      MOVE PC-E          TO TR231-RPT-TYP.                        15890000
159000      PERFORM 6201-WRITE-ERROR-REPORT-HDR.                        15900000
159100                                                                  15910000
159200      MOVE PC-HEADER2               TO TR231-ERROR-TYPE.          15920000
159300      MOVE PV-PROCESS-SEQ-NBR       TO TR231-PROCESS-SEQ-NBR.     15930000
159400      MOVE PC-D          TO TR231-RPT-TYP.                        15940000
159500      PERFORM 6201-WRITE-ERROR-REPORT-HDR.                        15950000
159600                                                                  15960000
159700      MOVE TR016-REC-TYP-ETA (1:3)  TO TR026-ETA-REC-TYP-CDE.     15970000
159800      MOVE PV-PROCESS-SEQ-NBR       TO TR026-ETA-PROCESS-SEQ-NBR. 15980000
159900      PERFORM 6401-WRITE-UPDATE-REPORT-HDR.                       15990000
160000      INITIALIZE TR231-RECORD.                                    16000000
160100      INITIALIZE TR231-REC-TYP-HDR.                               16010000
160200                                                                  16020000
160300                                                                  16030000
160400 EJECT                                                            16040000
160500***************************************************************** 16050000
160600* CHECK TO SEE IF PREVIOUS RECORD WAS AN IEA RECORD.            * 16060000
160700***************************************************************** 16070000
160800 6040-CHECK-IEA-RECORD.                                           16080000
160900                                                                  16090000
161000     IF PV-HOLD-LAST-REC-TYP EQUAL PC-IEA                         16100000
161100         CONTINUE                                                 16110000
161200     ELSE                                                         16120000
161300         INITIALIZE          TR231-ARRVL-PAR-1-ODR                16130000
161400         MOVE PC-EDI         TO TR231-ERROR-TYPE                  16140000
161500         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  16150000
161600                             TO TR231-ERROR-MSG                   16160000
161700         ADD +1 TO PV-PROCESS-SEQ-NBR                             16170000
161800         MOVE PV-PROCESS-SEQ-NBR TO TR231-PROCESS-SEQ-NBR         16180000
161900         PERFORM 6205-WRITE-ERROR-REPORT-IEA                      16190000
162000     END-IF.                                                      16200000
162100                                                                  16210000
162200 EJECT                                                            16220000
162300***************************************************************** 16230000
162400* CHECK TO SEE IF THE INPUT RECORD IS FROM THE PRIOR TURNOVER   * 16240000
162500* FILE AND NEEDS TO BE PROCESSED OR BYPASSED.                   * 16250000
162600***************************************************************** 16260000
162700 6050-CHECK-TURN-DTE.                                             16270000
162800                                                                  16280000
162900     IF TR016-ETA-TURN-CRE-DTE = SPACES                           16290000
163000         CONTINUE                                                 16300000
163100     ELSE                                                         16310000
163200         PERFORM 7100-SET-CURRENT-TMST                            16320000
163300         PERFORM 5730-REFORMAT-CURRENT-TMST                       16330000
163400         PERFORM 6060-CHECK-TURNOVER-CRE-DTE                      16340000
163500         IF TR016-ETA-TURN-CRE-DTE GREATER THAN OR EQUAL TO       16350000
163600            DPG55-DB2-ISO-DATE                                    16360000
163700             CONTINUE                                             16370000
163800         ELSE                                                     16380000
163900             IF TR016-ETA-TURN-CRE-DTE LESS THAN                  16390000
164000                DPG55-DB2-ISO-DATE                                16400000
164100                 SET PS-GOOD-RECORD-NO TO TRUE                    16410000
164200             END-IF                                               16420000
164300         END-IF                                                   16430000
164400     END-IF.                                                      16440000
164500                                                                  16450000
164600*    CHECK IF RECYCLED RECORD IS MORE THAN 2 WEEKS OLD            16460000
164700*    IF TR016-ADURD-REC-TYP-CDE-ADURDA AND PS-GOOD-RECORD-NO      16470000
164800*        MOVE PC-E                TO TR231-RPT-TYP                16480000
164900*        MOVE TR016-ADURD-TRN-TYP TO TR231-TRN-TYP                16490000
165000*        MOVE SPACES              TO TR231-DATA-IN-ERROR          16500000
165100*        MOVE TR016-ADURD-IMPRT-TRIP-ID                           16510000
165200*                                 TO TR231-DATA-VALUE             16520000
165300*        MOVE PC-WARNING          TO TR231-ERROR-TYPE             16530000
165400*        MOVE 'CONTAINER DELETED 2 WEEKS AGO - NEVER RESENT    '  16540000
165500*                                 TO TR231-ERROR-MSG              16550000
165600*        MOVE PV-PROCESS-SEQ-NBR  TO TR231-PROCESS-SEQ-NBR        16560000
165700*        MOVE TR016-ADURD-REC-TYP-CDE                             16570000
165800*                                 TO TR231-REC-TYP-ADURD-CDE      16580000
165900*        MOVE TR016-ADURD-SEQ-NBR TO TR231-ADURD-SEQ-NBR          16590000
166000*        MOVE TR016-ADURD-3RD-PARTY-CDE                           16600000
166100*                                 TO TR231-ADURD-3RD-PARTY-CDE    16610000
166200*        MOVE TR016-ADURD-PO-NBR  TO TR231-PO-NBR                 16620000
166300*        MOVE TR016-ADURD-IMPRT-TRIP-ID                           16630000
166400*                                 TO TR231-ADURD-IMPRT-TRIP-ID    16640000
166500*        MOVE TR016-ADURD-EXTL-REF-NBR                            16650000
166600*                                 TO TR231-EXTL-REF-NBR           16660000
166700*        MOVE TR016-ADURD-TRIP-TYP-CDE-MOM                        16670000
166800*                                 TO TR231-ADURD-TRIP-TYP-CDE-MOM 16680000
166900*        MOVE TR016-ADURD-CARR-SCAC-ID                            16690000
167000*                                 TO TR231-ADURD-CARR-SCAC-ID     16700000
167100*        MOVE TR016-ADURD-IMPRT-VEH-NM                            16710000
167200*                                 TO TR231-ADURD-IMPRT-VEH-NM     16720000
167300*        MOVE TR016-ADURD-ACTL-POE-DELY-DTE                       16730000
167400*                                 TO TR231-ADURD-ACTL-POE-DELY-DTE16740000
167500*        MOVE TR016-ADURD-ACTL-POE-DELY-TM                        16750000
167600*                                 TO TR231-ADURD-ACTL-POE-DELY-TM 16760000
167700*        PERFORM 6200-WRITE-ERROR-REPORT                          16770000
167800*    END-IF.                                                      16780000
167900                                                                  16790000
168000******************************************************************16800000
168100* CHECK THE INPUT TURNOVER CREATE DATE TO DETERMINE IF THIS      *16810000
168200* RECORD SHOULD BE PROCESSED OR BYPASSED.                        *16820000
168300******************************************************************16830000
168400 6060-CHECK-TURNOVER-CRE-DTE.                                     16840000
168500                                                                  16850000
168600     INITIALIZE   DPG51 DPG52 DPG53                               16860000
168700                  DPG54 DPG55 DPG56.                              16870000
168800                                                                  16880000
168900     SET DPG52-LK-DTE-ISO              TO TRUE.                   16890000
169000     SET DPG51-DECREMENT-DATE          TO TRUE.                   16900000
169100     MOVE PV-REFORMAT-TMST-DTE         TO DPG52-LK-DATE-INPUT.    16910000
169200     MOVE PC-DAYS-TO-DECREMENT         TO DPG51-INCR-DECR-DAYS-9. 16920000
169300     MOVE PC-A0                        TO DPG51-CALENDAR-TYPE.    16930000
169400                                                                  16940000
169500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    16950000
169600                                             DPG54 DPG55 DPG56.   16960000
169700                                                                  16970000
169800     EVALUATE TRUE                                                16980000
169900         WHEN DPG54-SEVERE-ERROR                                  16990000
170000         WHEN DPG54-DATE-INVALID                                  17000000
170100             MOVE TR016-ETA-TRN-TYP       TO TR231-TRN-TYP        17010000
170200             MOVE 'TURNAROUND PROC'       TO TR231-DATA-IN-ERROR  17020000
170300             MOVE PV-REFORMAT-TMST-DTE    TO TR231-DATA-VALUE     17030000
170400             MOVE PC-WARNING              TO TR231-ERROR-TYPE     17040000
170500             MOVE 'BAD CALL TO CALANDER ROUTINE'                  17050000
170600                                          TO TR231-ERROR-MSG      17060000
170700             MOVE PV-PROCESS-SEQ-NBR      TO TR231-PROCESS-SEQ-NBR17070000
170800             PERFORM 6190-MOVES-FOR-ERROR-REC                     17080000
170900             PERFORM 6200-WRITE-ERROR-REPORT                      17090000
171000     END-EVALUATE.                                                17100000
171100                                                                  17110000
171200*MAM MOVE DPG55-DB2-ISO-DATE        TO PV-BEG-WK-DTE.             17120000
171300                                                                  17130000
171400 EJECT                                                            17140000
171500***************************************************************** 17150000
171600* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 17160000
171700***************************************************************** 17170000
171800 6190-MOVES-FOR-ERROR-REC.                                        17180000
171900                                                                  17190000
172000     MOVE PLNSHP-FOB-CDE   TO TR231-FOB-CDE.                      17200000
172100     MOVE EXTENT-SCAC-CDE  TO TR231-EXTENT-SCAC-CDE.              17210000
172200                                                                  17220000
172300     EVALUATE TR016-ETA-REC-TYP-CDE                               17230000
172400       WHEN PC-ETA                                                17240000
172500         PERFORM 7300-SELECT-CONTNR-ID                            17250000
172600         MOVE TR016-ETA-REC-TYP-CDE       TO                      17260000
172700                TR231-REC-TYP-ETA-CDE                             17270000
172800         MOVE TR016-ETA-SEQ-NBR           TO                      17280000
172900                TR231-ETA-SEQ-NBR                                 17290000
173000         MOVE TR016-ETA-3RD-PARTY-CDE     TO                      17300000
173100                TR231-ETA-3RD-PARTY-CDE                           17310000
173200         MOVE TR016-ETA-CARR-SCAC-ID      TO                      17320000
173300                TR231-ETA-CARR-SCAC-ID                            17330000
173400         MOVE TR016-ETA-TRIP-TYP-CDE-MOM  TO                      17340000
173500                TR231-ETA-TRIP-TYP-CDE-MOM                        17350000
173600         MOVE TR016-ETA-IMPRT-TRIP-ID     TO                      17360000
173700                TR231-ETA-IMPRT-TRIP-ID                           17370000
173800         MOVE TR016-ETA-IMPRT-VEH-NM      TO                      17380000
173900                TR231-ETA-IMPRT-VEH-NM                            17390000
174000         MOVE PV-WRK-POE-NM  TO                                   17400000
174100                TR231-ETA-DEST-POE-NM                             17410000
174200         MOVE TR016-ETA-EST-POE-DELY-DTE  TO                      17420000
174300                TR231-ETA-EST-POE-DELY-DTE                        17430000
174310         MOVE TR016-ETA-ENT-ID TO                                 17431000
174320                TR231-DAT-SRC-ENT-ID                              17432000
174400         IF TR016-ETA-EST-POE-DELY-TM EQUAL SPACES OR ZEROES      17440000
174500             MOVE ZEROES TO TR231-ETA-EST-POE-DELY-TM             17450000
174600         ELSE                                                     17460000
174700             MOVE TR016-ETA-EST-POE-DELY-TM   TO                  17470000
174800                   TR231-ETA-EST-POE-DELY-TM                      17480000
174900         END-IF                                                   17490000
175000***      MOVE TR016-ETA-EST-LBD-NM        TO                      17500000
175100***             TR231-ETA-EST-LBD-NM                              17510000
175200***      MOVE TR016-ETA-EST-LBD-DTE       TO                      17520000
175300***             TR231-ETA-EST-LBD-DTE                             17530000
175400***      IF TR016-ETA-EST-LBD-TM EQUAL SPACES OR ZEROES           17540000
175500***          MOVE ZEROES TO TR231-ETA-EST-LBD-TM                  17550000
175600***      ELSE                                                     17560000
175700***          MOVE TR016-ETA-EST-LBD-TM        TO                  17570000
175800***                TR231-ETA-EST-LBD-TM                           17580000
175900***      END-IF                                                   17590000
176000                                                                  17600000
176100       WHEN PC-ADU                                                17610000
176200         PERFORM 7300-SELECT-CONTNR-ID                            17620000
176300         MOVE TR016-ADU-REC-TYP-CDE       TO                      17630000
176400                TR231-REC-TYP-ADU-CDE                             17640000
176500         MOVE TR016-ADU-SEQ-NBR           TO                      17650000
176600                TR231-ADU-SEQ-NBR                                 17660000
176700         MOVE TR016-ADU-3RD-PARTY-CDE     TO                      17670000
176800                TR231-ADU-3RD-PARTY-CDE                           17680000
176900         MOVE TR016-ADU-TRIP-TYP-CDE-MOM  TO                      17690000
177000                TR231-ADU-TRIP-TYP-CDE-MOM                        17700000
177100         MOVE TR016-ADU-CARR-SCAC-ID      TO                      17710000
177200                TR231-ADU-CARR-SCAC-ID                            17720000
177300         MOVE TR016-ADU-IMPRT-TRIP-ID     TO                      17730000
177400                TR231-ADU-IMPRT-TRIP-ID                           17740000
177500         MOVE TR016-ADU-IMPRT-VEH-NM      TO                      17750000
177600                TR231-ADU-IMPRT-VEH-NM                            17760000
177700         MOVE PV-WRK-POE-NM TO                                    17770000
177800                TR231-ADU-ACTL-DEST-POE-NM                        17780000
177900         MOVE TR016-ADU-ACTL-POE-DELY-DTE TO                      17790000
178000                TR231-ADU-ACTL-POE-DELY-DTE                       17800000
178010         MOVE TR016-ADU-ENT-ID TO                                 17801000
178020                TR231-DAT-SRC-ENT-ID                              17802000
178100         IF TR016-ADU-ACTL-POE-DELY-TM EQUAL SPACES OR ZEROES     17810000
178200             MOVE ZEROES TO TR231-ADU-ACTL-POE-DELY-TM            17820000
178300         ELSE                                                     17830000
178400             MOVE TR016-ADU-ACTL-POE-DELY-TM  TO                  17840000
178500                   TR231-ADU-ACTL-POE-DELY-TM                     17850000
178600         END-IF                                                   17860000
178700                                                                  17870000
178720       WHEN PC-ADURD                                              17872000
178730         PERFORM 7300-SELECT-CONTNR-ID                            17873000
178740         MOVE TR016-ADURD-REC-TYP-CDE       TO                    17874000
178750                TR231-REC-TYP-ADURD-CDE                           17875000
178760         MOVE TR016-ADURD-SEQ-NBR           TO                    17876000
178770                TR231-ADURD-SEQ-NBR                               17877000
178780         MOVE TR016-ADURD-3RD-PARTY-CDE     TO                    17878000
178790                TR231-ADURD-3RD-PARTY-CDE                         17879000
178791         MOVE TR016-ADURD-TRIP-TYP-CDE-MOM  TO                    17879100
178792                TR231-ADURD-TRIP-TYP-CDE-MOM                      17879200
178793         MOVE TR016-ADURD-CARR-SCAC-ID      TO                    17879300
178794                TR231-ADURD-CARR-SCAC-ID                          17879400
178795         MOVE TR016-ADURD-IMPRT-TRIP-ID     TO                    17879500
178796                TR231-ADURD-IMPRT-TRIP-ID                         17879600
178797         MOVE TR016-ADURD-IMPRT-VEH-NM      TO                    17879700
178798                TR231-ADURD-IMPRT-VEH-NM                          17879800
178799         MOVE PV-WRK-POE-NM TO                                    17879900
178800                TR231-ADURD-ACTL-DEST-POE-NM                      17880000
178801         MOVE TR016-ADURD-ACTL-POE-DELY-DTE TO                    17880100
178802                TR231-ADURD-ACTL-POE-DELY-DTE                     17880200
178803         MOVE TR016-ADURD-ENT-ID TO                               17880300
178804                TR231-DAT-SRC-ENT-ID                              17880400
178805         IF TR016-ADURD-ACTL-POE-DELY-TM EQUAL SPACES OR ZEROES   17880500
178806             MOVE ZEROES TO TR231-ADURD-ACTL-POE-DELY-TM          17880600
178807         ELSE                                                     17880700
178808             MOVE TR016-ADURD-ACTL-POE-DELY-TM  TO                17880800
178809                   TR231-ADURD-ACTL-POE-DELY-TM                   17880900
178810         END-IF                                                   17881000
178811         MOVE 'RDA - RECYCLE FROM CONTAINER DELETE    '           17881100
178812                                         TO TR231-ADURD-TEXT-MSG1 17881200
178813                                                                  17881300
178820     END-EVALUATE.                                                17882000
178900                                                                  17890000
179000 EJECT                                                            17900000
179100***************************************************************** 17910000
179200* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 17920000
179300***************************************************************** 17930000
179400 6200-WRITE-ERROR-REPORT.                                         17940000
179500                                                                  17950000
179600      MOVE PC-E                          TO TR231-RPT-TYP.        17960000
179700      MOVE TR016-ETA-EXTL-REF-NBR        TO TR231-EXTL-REF-NBR.   17970000
179800      MOVE TR016-ETA-PO-NBR              TO TR231-PO-NBR.         17980000
179900                                                                  17990000
179910      IF PS-ALPI-OR-CAP1                                          17991000
179920       OR PS-AIR-SHIPMENT                                         17992000
179930        CONTINUE                                                  17993000
179940      ELSE                                                        17994000
180000        WRITE TR231-ARRIVAL-ERROR-RECORD FROM                     18000000
180100             TR231-RECORD                                         18010000
180110      END-IF.                                                     18011000
180200                                                                  18020000
180300      INITIALIZE      TR231-ARRVL-PAR-1-ODR                       18030000
180400                      TR231-REC-TYP-ETA.                          18040000
180500                                                                  18050000
180600 EJECT                                                            18060000
180700***************************************************************** 18070000
180800* SETUP THE ERROR RECORD PRIOR TO WRITING THE HEADER RECORD.    * 18080000
180900* THE DIFFERENCE BETWEEN THIS PARA AND 6200 IS THAT THIS DOES   * 18090000
181000* NOT INITIALIZE THE ERROR RECORD SO THE ORIGINAL ISA RECORD    * 18100000
181100* READ FROM INPUT CAN BE PASSED TO THE EXTRACT RECORD.          * 18110000
181200***************************************************************** 18120000
181300 6201-WRITE-ERROR-REPORT-HDR.                                     18130000
181400                                                                  18140000
181500       WRITE TR231-ARRIVAL-ERROR-RECORD FROM                      18150000
181600             TR231-RECORD.                                        18160000
181700                                                                  18170000
181800                                                                  18180000
181900 EJECT                                                            18190000
182000***************************************************************** 18200000
182100* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 18210000
182200***************************************************************** 18220000
182300 6205-WRITE-ERROR-REPORT-IEA.                                     18230000
182400                                                                  18240000
182500      MOVE PC-E      TO TR231-RPT-TYP.                            18250000
182600                                                                  18260000
182700      WRITE TR231-ARRIVAL-ERROR-RECORD FROM                       18270000
182800            TR231-RECORD.                                         18280000
182900                                                                  18290000
183000      INITIALIZE      TR231-ARRVL-PAR-1-ODR                       18300000
183100                      TR231-REC-TYP-ETA.                          18310000
183200                                                                  18320000
183300 EJECT                                                            18330000
183400***************************************************************** 18340000
183500* SETUP THE EDITED UPDATE RECORD PRIOR TO WRITING TO THE UPDATE * 18350000
183600* FILE THAT WILL BE PASSED TO PROGRAM TRKUP235.                 * 18360000
183700***************************************************************** 18370000
183800 6400-WRITE-LOAD-FILE.                                            18380000
183900                                                                  18390000
184000     WRITE TR026-UPDATE-ARRIVAL-RECORD FROM                       18400000
184100           TR026-REC-TYP-ETA.                                     18410000
184200                                                                  18420000
184300 EJECT                                                            18430000
184400***************************************************************** 18440000
184500* WRITE THE EXTRACT RECORD FROM THE INPUT RECORD THAT WAS READ  * 18450000
184600* INTO THE WORKING STORAGE VARIABLE PV-HOLD-EDI-RECORD. THIS IS * 18460000
184700* ONLY EXECUTED TO PASS THE ISA RECORD TO THE EXTRACT FILE.     * 18470000
184800* THIS PARA ALSO INITIALIZES THE ERROR RECORD BECAUSE ALL OF THE* 18480000
184900* ISA RECORD WRITING WILL HAVE BEEN DONE AND THE FIELDS WII BE  * 18490000
185000* READY FOR THE NEXT RECORD.                                    * 18500000
185100***************************************************************** 18510000
185200 6401-WRITE-UPDATE-REPORT-HDR.                                    18520000
185300                                                                  18530000
185400     MOVE TR016-REC-TYP-ETA  TO TR026-REC-TYP-ETA.                18540000
185500                                                                  18550000
185600     WRITE TR026-UPDATE-ARRIVAL-RECORD FROM                       18560000
185700           TR026-REC-TYP-ETA.                                     18570000
185800                                                                  18580000
185900     INITIALIZE TR231-RECORD.                                     18590000
186000                                                                  18600000
186100 EJECT                                                            18610000
186200***************************************************************** 18620000
186300* WRITE A RECORD TO THE TURNAROUND FILE.  THIS FILE WILL BE     * 18630000
186400* SORTED WITH THE INPUT FILE INTO THE NEXT EDIT RUN.            * 18640000
186500***************************************************************** 18650000
186600 6500-WRITE-TURNAROUND-RECORD.                                    18660000
186700                                                                  18670000
186800     WRITE TR016-ARRIVAL-TURNAROUND-REC FROM                      18680000
186900           TR016-REC-TYP-ETA.                                     18690000
187000                                                                  18700000
187100                                                                  18710000
187200 EJECT                                                            18720000
187300******************************************************************18730000
187400* RETRIEVE POE NAME FOR REPORT:                                  *18740000
187500*                                                                *18750000
187600* WHEN THE POE CODE OR TRIP TYPE CODE ARE NOT THE SAME AS ON     *18760000
187700* THE LAST RECORD, FETCH THE POE NAME.  IF THE POE NAME IS NOT   *18770000
187800* FOUND, MOVE THE POE CODE TO THE NAME FIELD.                    *18780000
187900******************************************************************18790000
188000                                                                  18800000
188100 7040-GET-POE-NAME.                                               18810000
188200                                                                  18820000
188300     EVALUATE TRUE                                                18830000
188400                                                                  18840000
188500       WHEN PV-WRK-TRIP-TYPE-CDE-MOM  NOT =                       18850000
188600                                    PV-LAST-TRIP-TYPE-CDE-MOM     18860000
188700       WHEN PV-WRK-POE-CDE  NOT =   PV-LAST-POE-CDE               18870000
188800                                                                  18880000
188900         MOVE PV-WRK-TRIP-TYPE-CDE-MOM                            18890000
189000                                 TO PV-LAST-TRIP-TYPE-CDE-MOM     18900000
189100         MOVE PV-WRK-POE-CDE     TO PV-LAST-POE-CDE               18910000
189200         INITIALIZE PV-WRK-POE-NM                                 18920000
189300         SET PS-VALID-POE-NAME-NO   TO TRUE                       18930000
189400                                                                  18940000
189500         IF PS-AIR-SHIPMENT                                       18950000
189600            MOVE PV-WRK-POE-CDE (1:3)   TO PV-WRK-POE-CDE-AIR     18960000
189700            PERFORM 7060-OPEN-TIMPOE-AIR                          18970000
189800            PERFORM 7062-FETCH-TIMPOE-AIR                         18980000
189900            PERFORM 7064-CLOSE-TIMPOE-AIR                         18990000
190000         ELSE                                                     19000000
190100            PERFORM 7050-OPEN-TIMPOE-OCEAN                        19010000
190200            PERFORM 7052-FETCH-TIMPOE-OCEAN                       19020000
190300            PERFORM 7054-CLOSE-TIMPOE-OCEAN                       19030000
190400         END-IF                                                   19040000
190500                                                                  19050000
190600         IF PS-VALID-POE-NAME                                     19060000
190700            MOVE IMPOE-POE-NM      TO PV-WRK-POE-NM               19070000
190800         ELSE                                                     19080000
190900            MOVE PV-WRK-POE-CDE    TO PV-WRK-POE-NM               19090000
191000         END-IF                                                   19100000
191100                                                                  19110000
191200     END-EVALUATE.                                                19120000
191300                                                                  19130000
191400******************************************************************19140000
191500*   OPEN  POE NAME CURSOR - OCEAN                                *19150000
191600******************************************************************19160000
191700                                                                  19170000
191800 7050-OPEN-TIMPOE-OCEAN.                                          19180000
191900                                                                  19190000
192000                                                                  19200000
192100     EXEC SQL                                                     19210000
192200         OPEN POE-CSR-OCEAN                                       19220000
192300     END-EXEC                                                     19230000
192400                                                                  19240000
192500     EVALUATE TRUE                                                19250000
192600         WHEN SQLCODE = ZERO                                      19260000
192700             CONTINUE                                             19270000
192800         WHEN SQLWARN0 NOT EQUAL SPACE                            19280000
192900         WHEN SQLCODE NOT EQUAL ZERO                              19290000
193000             DISPLAY '**************************************'     19300000
193100             DISPLAY '** ABEND                            **'     19310000
193200             DISPLAY '** PROGRAM = TRKUP230               **'     19320000
193300             DISPLAY '** PARAGRAPH = 7050-OPEN-TIMPOE-OCEAN'      19330000
193400             DISPLAY '** CONTNR ID          '                     19340000
193500                                IMCNTK-CONTNR-ID                  19350000
193600             DISPLAY '** TR026-ETA-EXTL-REF-NBR '                 19360000
193700                                TR026-ETA-EXTL-REF-NBR            19370000
193800             DISPLAY '** TR026-ETA-PO-NBR        '                19380000
193900                                TR026-ETA-PO-NBR                  19390000
194000             DISPLAY '**************************************'     19400000
194100             PERFORM 9100-SQL-ABEND                               19410000
194200                                                                  19420000
194300     END-EVALUATE.                                                19430000
194400                                                                  19440000
194500******************************************************************19450000
194600*   FETCH POE NAME - OCEAN                                       *19460000
194700******************************************************************19470000
194800                                                                  19480000
194900 7052-FETCH-TIMPOE-OCEAN.                                         19490000
195000                                                                  19500000
195100     EXEC SQL                                                     19510000
195200        FETCH POE-CSR-OCEAN                                       19520000
195300         INTO :IMPOE-POE-NM                                       19530000
195400     END-EXEC.                                                    19540000
195500                                                                  19550000
195600     EVALUATE TRUE                                                19560000
195700         WHEN SQLCODE = ZERO                                      19570000
195800             SET PS-VALID-POE-NAME TO TRUE                        19580000
195900         WHEN SQLCODE = +100                                      19590000
196000             CONTINUE                                             19600000
196100         WHEN SQLWARN0 NOT EQUAL SPACE                            19610000
196200         WHEN SQLCODE NOT EQUAL ZERO                              19620000
196300             DISPLAY '**************************************'     19630000
196400             DISPLAY '** ABEND                            **'     19640000
196500             DISPLAY '** PROGRAM = TRKUP230               **'     19650000
196600             DISPLAY '** PARAGRAPH = 7052-FETCH-TIMPOE-OCEAN '    19660000
196700             DISPLAY '** CONTNR ID          '                     19670000
196800                                IMCNTK-CONTNR-ID                  19680000
196900             DISPLAY '** TR026-ETA-EXTL-REF-NBR '                 19690000
197000                                TR026-ETA-EXTL-REF-NBR            19700000
197100             DISPLAY '** TR026-ETA-PO-NBR        '                19710000
197200                                TR026-ETA-PO-NBR                  19720000
197300             DISPLAY '** POE STD EDI CODE        '                19730000
197400                                PV-WRK-POE-CDE                    19740000
197500             DISPLAY '**************************************'     19750000
197600             PERFORM 9100-SQL-ABEND                               19760000
197700                                                                  19770000
197800     END-EVALUATE.                                                19780000
197900                                                                  19790000
198000******************************************************************19800000
198100*   CLOSE POE NAME CURSOR - OCEAN                                *19810000
198200******************************************************************19820000
198300                                                                  19830000
198400 7054-CLOSE-TIMPOE-OCEAN.                                         19840000
198500                                                                  19850000
198600                                                                  19860000
198700     EXEC SQL                                                     19870000
198800        CLOSE POE-CSR-OCEAN                                       19880000
198900     END-EXEC                                                     19890000
199000                                                                  19900000
199100     EVALUATE TRUE                                                19910000
199200         WHEN SQLCODE = ZERO                                      19920000
199300             CONTINUE                                             19930000
199400         WHEN SQLWARN0 NOT EQUAL SPACE                            19940000
199500         WHEN SQLCODE NOT EQUAL ZERO                              19950000
199600             DISPLAY '**************************************'     19960000
199700             DISPLAY '** ABEND                            **'     19970000
199800             DISPLAY '** PROGRAM = TRKUP235               **'     19980000
199900             DISPLAY '** PARAGRAPH = 7054-CLOSE-TIMPOE-OCEAN'     19990000
200000             DISPLAY '** CONTNR ID          '                     20000000
200100                                IMCNTK-CONTNR-ID                  20010000
200200             DISPLAY '** TR026-ETA-EXTL-REF-NBR '                 20020000
200300                                TR026-ETA-EXTL-REF-NBR            20030000
200400             DISPLAY '** TR026-ETA-PO-NBR        '                20040000
200500                                TR026-ETA-PO-NBR                  20050000
200600             DISPLAY '**************************************'     20060000
200700             PERFORM 9100-SQL-ABEND                               20070000
200800                                                                  20080000
200900     END-EVALUATE.                                                20090000
201000                                                                  20100000
201100******************************************************************20110000
201200*   OPEN  POE NAME CURSOR - AIR                                  *20120000
201300******************************************************************20130000
201400                                                                  20140000
201500 7060-OPEN-TIMPOE-AIR.                                            20150000
201600                                                                  20160000
201700                                                                  20170000
201800     EXEC SQL                                                     20180000
201900         OPEN POE-CSR-AIR                                         20190000
202000     END-EXEC                                                     20200000
202100                                                                  20210000
202200     EVALUATE TRUE                                                20220000
202300         WHEN SQLCODE = ZERO                                      20230000
202400             CONTINUE                                             20240000
202500         WHEN SQLWARN0 NOT EQUAL SPACE                            20250000
202600         WHEN SQLCODE NOT EQUAL ZERO                              20260000
202700             DISPLAY '**************************************'     20270000
202800             DISPLAY '** ABEND                            **'     20280000
202900             DISPLAY '** PROGRAM = TRKUP230               **'     20290000
203000             DISPLAY '** PARAGRAPH = 7060-OPEN-TIMPOE-AIR'        20300000
203100             DISPLAY '** CONTNR ID          '                     20310000
203200                                IMCNTK-CONTNR-ID                  20320000
203300             DISPLAY '** TR026-ETA-EXTL-REF-NBR '                 20330000
203400                                TR026-ETA-EXTL-REF-NBR            20340000
203500             DISPLAY '** TR026-ETA-PO-NBR        '                20350000
203600                                TR026-ETA-PO-NBR                  20360000
203700             DISPLAY '**************************************'     20370000
203800             PERFORM 9100-SQL-ABEND                               20380000
203900                                                                  20390000
204000     END-EVALUATE.                                                20400000
204100                                                                  20410000
204200******************************************************************20420000
204300*   FETCH POE NAME - AIR                                         *20430000
204400******************************************************************20440000
204500                                                                  20450000
204600 7062-FETCH-TIMPOE-AIR.                                           20460000
204700                                                                  20470000
204800     EXEC SQL                                                     20480000
204900        FETCH POE-CSR-AIR                                         20490000
205000         INTO :IMPOE-POE-NM                                       20500000
205100     END-EXEC.                                                    20510000
205200                                                                  20520000
205300     EVALUATE TRUE                                                20530000
205400         WHEN SQLCODE = ZERO                                      20540000
205500             SET PS-VALID-POE-NAME TO TRUE                        20550000
205600         WHEN SQLCODE = +100                                      20560000
205700             CONTINUE                                             20570000
205800         WHEN SQLWARN0 NOT EQUAL SPACE                            20580000
205900         WHEN SQLCODE NOT EQUAL ZERO                              20590000
206000             DISPLAY '**************************************'     20600000
206100             DISPLAY '** ABEND                            **'     20610000
206200             DISPLAY '** PROGRAM = TRKUP230               **'     20620000
206300             DISPLAY '** PARAGRAPH = 7062-FETCH-TIMPOE-AIR'       20630000
206400             DISPLAY '** CONTNR ID          '                     20640000
206500                                IMCNTK-CONTNR-ID                  20650000
206600             DISPLAY '** TR026-ETA-EXTL-REF-NBR '                 20660000
206700                                TR026-ETA-EXTL-REF-NBR            20670000
206800             DISPLAY '** TR026-ETA-PO-NBR        '                20680000
206900                                TR026-ETA-PO-NBR                  20690000
207000             DISPLAY '** POE STD EDI CODE        '                20700000
207100                                PV-WRK-POE-CDE                    20710000
207200             DISPLAY '**************************************'     20720000
207300             PERFORM 9100-SQL-ABEND                               20730000
207400                                                                  20740000
207500     END-EVALUATE.                                                20750000
207600                                                                  20760000
207700******************************************************************20770000
207800*   CLOSE POE NAME CURSOR - AIR                                  *20780000
207900******************************************************************20790000
208000                                                                  20800000
208100 7064-CLOSE-TIMPOE-AIR.                                           20810000
208200                                                                  20820000
208300     EXEC SQL                                                     20830000
208400        CLOSE POE-CSR-AIR                                         20840000
208500     END-EXEC                                                     20850000
208600                                                                  20860000
208700     EVALUATE TRUE                                                20870000
208800         WHEN SQLCODE = ZERO                                      20880000
208900             CONTINUE                                             20890000
209000         WHEN SQLWARN0 NOT EQUAL SPACE                            20900000
209100         WHEN SQLCODE NOT EQUAL ZERO                              20910000
209200             DISPLAY '**************************************'     20920000
209300             DISPLAY '** ABEND                            **'     20930000
209400             DISPLAY '** PROGRAM = TRKUP230               **'     20940000
209500             DISPLAY '** PARAGRAPH = 7064-CLOSE-TIMPOE-AIR'       20950000
209600             DISPLAY '** CONTNR ID          '                     20960000
209700                                IMCNTK-CONTNR-ID                  20970000
209800             DISPLAY '** TR026-ETA-EXTL-REF-NBR '                 20980000
209900                                TR026-ETA-EXTL-REF-NBR            20990000
210000             DISPLAY '** TR026-ETA-PO-NBR        '                21000000
210100                                TR026-ETA-PO-NBR                  21010000
210200             DISPLAY '**************************************'     21020000
210300             PERFORM 9100-SQL-ABEND                               21030000
210400                                                                  21040000
210500     END-EVALUATE.                                                21050000
210600                                                                  21060000
210700 EJECT                                                            21070000
210800****************************************************************  21080000
210900* SELECT TPURCHS                                                  21090000
211000****************************************************************  21100000
211100                                                                  21110000
211200 7110-SELECT-TPURCHS.                                             21120000
211300                                                                  21130000
211310     SET PS-PO-ON-MAINFRAME-NO        TO TRUE                     21131000
211400     SET PS-PO-ACTIVE-ON-MAINFRAME-NO TO TRUE                     21140000
211500     MOVE TR016-ETA-PO-NBR   TO PURCHS-PO-NBR                     21150000
211600                                                                  21160000
211700     PERFORM                                                      21170000
211800         WITH TEST AFTER                                          21180000
211900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     21190000
212000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            21200000
212100                 SQLCODE = ZERO                     OR            21210000
212200                 SQLCODE = +100                                   21220000
212300                                                                  21230000
212400         EXEC SQL                                                 21240000
212500             SELECT PO_NBR,                                       21250000
212600                    STATUS_CDE                                    21260000
212700              INTO :PURCHS-PO-NBR,                                21270000
212800                   :PURCHS-STATUS-CDE                             21280000
212900               FROM TPURCHS                                       21290000
213000              WHERE PO_NBR           = :PURCHS-PO-NBR AND         21300000
213100                    VER_STATUS_CDE   = :PC-A                      21310000
213200         END-EXEC                                                 21320000
213300                                                                  21330000
213400         EVALUATE TRUE                                            21340000
213500           WHEN SQLCODE = ZERO                                    21350000
213510                SET PS-PO-ON-MAINFRAME TO TRUE                    21351000
213600                IF PURCHS-STATUS-CDE = 'AC' OR 'AP'               21360000
213700                   SET PS-PO-ACTIVE-ON-MAINFRAME TO TRUE          21370000
213800                END-IF                                            21380000
213810                                                                  21381000
213900           WHEN SQLCODE = +100                                    21390000
213901                   CONTINUE                                       21390100
213997                                                                  21399700
214100           WHEN SQLWARN0 NOT EQUAL SPACE                          21410000
214200           WHEN SQLCODE NOT EQUAL ZERO                            21420000
214300                 DISPLAY '**************************************' 21430000
214400                 DISPLAY '** ABEND                              ' 21440000
214500                 DISPLAY '** PROGRAM = TRKUT230                 ' 21450000
214600                 DISPLAY '** PARAGRAPH = 7110-SELECT-TPURCHS    ' 21460000
214700                 DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR          21470000
214800                 DISPLAY '** SELECT FROM TPURCHS                ' 21480000
214900                 DISPLAY '**************************************' 21490000
215000                 PERFORM 9100-SQL-ABEND                           21500000
215100         END-EVALUATE                                             21510000
215200     END-PERFORM.                                                 21520000
215300                                                                  21530000
215400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    21540000
215500         (SQLCODE NOT = ZERO AND                                  21550000
215600             SQLCODE NOT = +100)                                  21560000
215700         DISPLAY '****************************************'       21570000
215800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO   '       21580000
215900         DISPLAY '** SELECT FROM TPURCHS                  '       21590000
216000         DISPLAY '** PO NUMBER = ' PURCHS-PO-NBR                  21600000
216100         DISPLAY '** PARAGRAPH = 7110-SELECT-TPURCHS      '       21610000
216200         DISPLAY '****************************************'       21620000
216300         PERFORM 9100-SQL-ABEND                                   21630000
216400     END-IF.                                                      21640000
216500                                                                  21650000
216600******************************************************************21660000
216700* SET THE CURRENT TIMESTAMP.                                     *21670000
216800******************************************************************21680000
216900 7100-SET-CURRENT-TMST.                                           21690000
217000                                                                  21700000
217100          EXEC SQL                                                21710000
217200              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            21720000
217300          END-EXEC                                                21730000
217400                                                                  21740000
217500         EVALUATE TRUE                                            21750000
217600             WHEN SQLCODE = ZERO                                  21760000
217700                 CONTINUE                                         21770000
217800                                                                  21780000
217900             WHEN SQLWARN0 NOT EQUAL SPACE                        21790000
218000             WHEN SQLCODE NOT EQUAL ZERO                          21800000
218100                 DISPLAY '**************************************' 21810000
218200                 DISPLAY '** ABEND                            **' 21820000
218300                 DISPLAY '** PROGRAM = TRKUT230               **' 21830000
218400                 DISPLAY '** PARAGRAPH = 7100-SET-CURRENT-TMST**' 21840000
218500                 DISPLAY '** SET CURRENT TIMESTAMP            **' 21850000
218600                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   21860000
218700                 DISPLAY '**************************************' 21870000
218800                 PERFORM 9100-SQL-ABEND                           21880000
218900         END-EVALUATE.                                            21890000
219000                                                                  21900000
219100 EJECT                                                            21910000
219200******************************************************************21920000
219300* SELECT THE CONSOLIDATOR ENTERPRISE NAME FOR HEADER RECORD.     *21930000
219400******************************************************************21940000
219500 7292-SELECT-TENTNME.                                             21950000
219600                                                                  21960000
219700     PERFORM                                                      21970000
219800         WITH TEST AFTER                                          21980000
219900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     21990000
220000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            22000000
220100                 SQLCODE = ZERO                     OR            22010000
220200                 SQLCODE = +100                                   22020000
220300                                                                  22030000
220400         EXEC SQL                                                 22040000
220500             SELECT DISTINCT                                      22050000
220600                    A.ENT_NAME_DESC                               22060000
220700                 ,  A.ENT_ID                                      22070000
220800              INTO :ENTNME-ENT-NAME-DESC                          22080000
220900                 , :ENTNME-ENT-ID                                 22090000
221000               FROM TENTNME  A                                    22100000
221100                   ,TTRDPRT  B                                    22110000
221200              WHERE B.VEND_INCHG_ID       = :PV-VEND-ID           22120000
221300                AND B.VEND_INCHG_ID_DESC  = :PV-VEND-ID-QUAL      22130000
221400                AND A.ENT_ID              = B.ENT_ID              22140000
221500                AND A.TYPE_CDE            = '01'                  22150000
221600                AND B.INACTV_DTE          = '9999-09-09'          22160000
221700         END-EXEC                                                 22170000
221800                                                                  22180000
221900         EVALUATE TRUE                                            22190000
222000             WHEN SQLCODE = ZERO                                  22200000
222100             WHEN SQLCODE = -811                                  22210000
222200                 SET PS-VALID-ENTNME   TO TRUE                    22220000
222300                                                                  22230000
222400             WHEN SQLCODE = +100                                  22240000
222500                 SET PS-INVALID-ENTNME TO TRUE                    22250000
222600                                                                  22260000
222700             WHEN SQLCODE = -904                                  22270000
222800             WHEN SQLCODE = -913                                  22280000
222900                 CONTINUE                                         22290000
223000                                                                  22300000
223100             WHEN SQLWARN0 NOT EQUAL SPACE                        22310000
223200             WHEN SQLCODE NOT EQUAL ZERO                          22320000
223300                 DISPLAY '**************************************' 22330000
223400                 DISPLAY '** ABEND                            **' 22340000
223500                 DISPLAY '** PROGRAM = TRKUT230               **' 22350000
223600                 DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME  **' 22360000
223700                 DISPLAY '** SELECT CONSOLIDATOR NAME         **' 22370000
223800                 DISPLAY '** FROM ISA RECORD.                 **' 22380000
223900                 DISPLAY '** VEND ID      = ' PV-VEND-ID          22390000
224000                 DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL     22400000
224100                 DISPLAY '**************************************' 22410000
224200                 PERFORM 9100-SQL-ABEND                           22420000
224300         END-EVALUATE                                             22430000
224400     END-PERFORM.                                                 22440000
224500                                                                  22450000
224600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    22460000
224700         (SQLCODE NOT = ZERO    AND                               22470000
224800             SQLCODE NOT = +100 AND                               22480000
224900             SQLCODE NOT = -811)                                  22490000
225000         DISPLAY '****************************************'       22500000
225100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       22510000
225200         DISPLAY '** SELECT FROM TENTNME                **'       22520000
225300         DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME    **'       22530000
225400         DISPLAY '** VEND ID      = ' PV-VEND-ID                  22540000
225500         DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL             22550000
225600         DISPLAY '****************************************'       22560000
225700         PERFORM 9100-SQL-ABEND                                   22570000
225800     END-IF.                                                      22580000
225900                                                                  22590000
226000 EJECT                                                            22600000
226100******************************************************************22610000
226200* SELECT CONTAINER ID.                                           *22620000
226300******************************************************************22630000
226400 7300-SELECT-CONTNR-ID.                                           22640000
226500                                                                  22650000
226600     PERFORM                                                      22660000
226700         WITH TEST AFTER                                          22670000
226800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     22680000
226900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            22690000
227000                 SQLCODE = ZERO                     OR            22700000
227100                 SQLCODE = +100                     OR            22710000
227200                 SQLCODE = -811                                   22720000
227300                                                                  22730000
227400         EXEC SQL                                                 22740000
227500             SELECT A.CONTNR_ID                                   22750000
227600              INTO :IMCNPO-CONTNR-ID                              22760000
227700               FROM TIMCNPO  A                                    22770000
227800                   ,TIMCNTK  B                                    22780000
227900              WHERE A.PO_NBR         = :PV-PO-NBR                 22790000
228000                AND A.EXTL_REF_NBR   = :TR016-ETA-EXTL-REF-NBR    22800000
228100                AND A.CONTNR_ID      = B.CONTNR_ID                22810000
228200                AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR           22820000
228300         END-EXEC                                                 22830000
228400                                                                  22840000
228500         EVALUATE TRUE                                            22850000
228600             WHEN SQLCODE = ZERO                                  22860000
228700             WHEN SQLCODE = -811                                  22870000
228800                 MOVE IMCNPO-CONTNR-ID      TO TR231-CONTNR-ID    22880000
228900                                                                  22890000
229000             WHEN SQLCODE = +100                                  22900000
229100                 MOVE SPACES TO TR231-CONTNR-ID                   22910000
229200                                                                  22920000
229300             WHEN SQLCODE = -904                                  22930000
229400             WHEN SQLCODE = -913                                  22940000
229500                 CONTINUE                                         22950000
229600                                                                  22960000
229700             WHEN SQLWARN0 NOT EQUAL SPACE                        22970000
229800             WHEN SQLCODE NOT EQUAL ZERO                          22980000
229900                 DISPLAY '**************************************' 22990000
230000                 DISPLAY '** ABEND                            **' 23000000
230100                 DISPLAY '** PROGRAM = TRKUT230               **' 23010000
230200                 DISPLAY '** PARAGRAPH = 7300-SELECT-CONTNR-ID**' 23020000
230300                 DISPLAY '** SELECT CONTAINER ID              **' 23030000
230400                 DISPLAY '** PO NUMBER   =' TR016-ETA-PO-NBR      23040000
230500                 DISPLAY '** EXTL REF NBR=' TR016-ETA-EXTL-REF-NBR23050000
230600                 DISPLAY '**************************************' 23060000
230700                 PERFORM 9100-SQL-ABEND                           23070000
230800         END-EVALUATE                                             23080000
230900     END-PERFORM.                                                 23090000
231000                                                                  23100000
231100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    23110000
231200            (SQLCODE NOT = ZERO AND                               23120000
231300             SQLCODE NOT = +100 AND                               23130000
231400             SQLCODE NOT = -811)                                  23140000
231500         DISPLAY '****************************************'       23150000
231600         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       23160000
231700         DISPLAY '** SELECT FROM TIMCNPO/TIMCNTK        **'       23170000
231800         DISPLAY '** PARAGRAPH = 7300-SELECT-CONTNR-ID  **'       23180000
231900         DISPLAY '** PO NUMBER    = ' TR016-ETA-PO-NBR            23190000
232000         DISPLAY '** EXTL REF NBR = ' TR016-ETA-EXTL-REF-NBR      23200000
232100         DISPLAY '****************************************'       23210000
232200         PERFORM 9100-SQL-ABEND                                   23220000
232300     END-IF.                                                      23230000
232400                                                                  23240000
232500 EJECT                                                            23250000
232600******************************************************************23260000
232700* OPEN THE CONTAINER CURSOR.                                     *23270000
232800******************************************************************23280000
232900 7310-OPEN-CONTNR-CURSOR.                                         23290000
233000                                                                  23300000
233100     EXEC SQL                                                     23310000
233200          OPEN CONTNR_CURSOR                                      23320000
233300     END-EXEC.                                                    23330000
233400                                                                  23340000
233500     EVALUATE TRUE                                                23350000
233600         WHEN SQLWARN0 NOT EQUAL SPACE                            23360000
233700         WHEN SQLCODE NOT EQUAL ZERO                              23370000
233800             DISPLAY '** ABEND **'                                23380000
233900             DISPLAY '** PROGRAM = TRKUT230 **'                   23390000
234000             DISPLAY '** PARAGRAPH = 7310-OPEN-CONTNR-CURSOR **'  23400000
234100             PERFORM 9100-SQL-ABEND                               23410000
234200     END-EVALUATE.                                                23420000
234300                                                                  23430000
234400******************************************************************23440000
234500* CLOSE THE CONTAINER CURSOR.                                    *23450000
234600******************************************************************23460000
234700 7320-CLOSE-CONTNR-CURSOR.                                        23470000
234800                                                                  23480000
234900     EXEC SQL                                                     23490000
235000         CLOSE CONTNR_CURSOR                                      23500000
235100     END-EXEC.                                                    23510000
235200                                                                  23520000
235300     EVALUATE TRUE                                                23530000
235400         WHEN SQLWARN0 NOT EQUAL SPACE                            23540000
235500         WHEN SQLCODE NOT EQUAL ZERO                              23550000
235600             DISPLAY '** ABEND **'                                23560000
235700             DISPLAY '** PROGRAM = TRKUT230 **'                   23570000
235800             DISPLAY '** PARAGRAPH = 7320-CLOSE-CONTNR-CURSOR **' 23580000
235900             PERFORM 9100-SQL-ABEND                               23590000
236000     END-EVALUATE.                                                23600000
236100                                                                  23610000
236200******************************************************************23620000
236300* FETCH THE CONTAINER CURSOR.                                    *23630000
236400******************************************************************23640000
236500 7330-FETCH-CONTNR-CURSOR.                                        23650000
236600                                                                  23660000
236700     EXEC SQL                                                     23670000
236800          FETCH CONTNR_CURSOR                                     23680000
236900              INTO :IMCNTK-CONTNR-ID                              23690000
237000                  ,:IMCNTK-CONTNR-SEQ-NBR                         23700000
237100     END-EXEC.                                                    23710000
237200                                                                  23720000
237300     EVALUATE TRUE                                                23730000
237400         WHEN SQLCODE = ZERO                                      23740000
237500         WHEN SQLCODE = -811                                      23750000
237600             SET PS-CONTNR-EXISTS     TO TRUE                     23760000
237700             SET PS-THERE-IS-A-CONTNR TO TRUE                     23770000
237800                                                                  23780000
237900         WHEN SQLCODE = +100                                      23790000
238000             SET PS-CONTNR-EXISTS-NO  TO TRUE                     23800000
238100             SET PS-EOC-CONTNR-CURSOR TO TRUE                     23810000
238200                                                                  23820000
238300         WHEN SQLWARN0 NOT EQUAL SPACE                            23830000
238400         WHEN SQLCODE NOT EQUAL ZERO                              23840000
238500             DISPLAY '** ABEND                                **' 23850000
238600             DISPLAY '** PROGRAM = TRKUT230                   **' 23860000
238700             DISPLAY '** PARAGRAPH = 7330-FETCH-CONTNR-CURSOR **' 23870000
238800             PERFORM 9100-SQL-ABEND                               23880000
238900     END-EVALUATE.                                                23890000
239000                                                                  23900000
239100 EJECT                                                            23910000
239200******************************************************************23920000
239300* SELECT FOB CODE.                                               *23930000
239400******************************************************************23940000
239500 7400-SELECT-FOB-AND-SCAC-CODES.                                  23950000
239600                                                                  23960000
239610     INITIALIZE EXTENT-SCAC-CDE.                                  23961000
239700     MOVE TR016-ETA-PO-NBR TO PV-PO-NBR-FOB.                      23970000
239800                                                                  23980000
239900     PERFORM                                                      23990000
240000         WITH TEST AFTER                                          24000000
240100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     24010000
240200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            24020000
240300                 SQLCODE = ZERO                     OR            24030000
240400                 SQLCODE = +100                     OR            24040000
240500                 SQLCODE = -811                                   24050000
240600                                                                  24060000
240700         EXEC SQL                                                 24070000
240800             SELECT A.FOB_CDE                                     24080000
240900                   ,C.SCAC_CDE                                    24090000
241000               INTO :PLNSHP-FOB-CDE                               24100000
241100                   ,:EXTENT-SCAC-CDE                              24110000
241200               FROM TPLNSHP  A                                    24120000
241300                   ,TIMFOB   B                                    24130000
241400                   ,TEXTENT  C                                    24140000
241500              WHERE A.PO_NBR         = :PV-PO-NBR-FOB             24150000
241600                AND A.VER_STATUS_CDE = :PC-A                      24160000
241700                AND A.FOB_CDE = B.FOB_CDE                         24170000
241800                AND B.CONSLR_ENT_ID = C.ENT_ID                    24180000
241900         END-EXEC                                                 24190000
242000                                                                  24200000
242100         EVALUATE TRUE                                            24210000
242200             WHEN SQLCODE = ZERO                                  24220000
242300             WHEN SQLCODE = -811                                  24230000
242400                 CONTINUE                                         24240000
242500                                                                  24250000
242600             WHEN SQLCODE = +100                                  24260000
242700                 MOVE SPACES TO PLNSHP-FOB-CDE                    24270000
242800                                EXTENT-SCAC-CDE                   24280000
242900                                                                  24290000
243000             WHEN SQLCODE = -904                                  24300000
243100             WHEN SQLCODE = -913                                  24310000
243200                 CONTINUE                                         24320000
243300                                                                  24330000
243400             WHEN SQLWARN0 NOT EQUAL SPACE                        24340000
243500             WHEN SQLCODE NOT EQUAL ZERO                          24350000
243600                 DISPLAY '**************************************' 24360000
243700                 DISPLAY '** ABEND                            **' 24370000
243800                 DISPLAY '** PROGRAM = TRKUT230               **' 24380000
243900                 DISPLAY '** PARAGRAPH = 7400-SELECT-FOB-CDE  **' 24390000
244000                 DISPLAY '** SELECT FOB CODE                  **' 24400000
244100                 DISPLAY '** PO NUMBER   =' TR016-ETA-PO-NBR      24410000
244200                 DISPLAY '** EXTL REF NBR=' TR016-ETA-EXTL-REF-NBR24420000
244300                 DISPLAY '**************************************' 24430000
244400                 PERFORM 9100-SQL-ABEND                           24440000
244500         END-EVALUATE                                             24450000
244600     END-PERFORM.                                                 24460000
244700                                                                  24470000
244800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    24480000
244900            (SQLCODE NOT = ZERO AND                               24490000
245000             SQLCODE NOT = +100 AND                               24500000
245100             SQLCODE NOT = -811)                                  24510000
245200         DISPLAY '****************************************'       24520000
245300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       24530000
245400         DISPLAY '** SELECT FROM TPLNSHP                **'       24540000
245500         DISPLAY '** PARAGRAPH = 7400-SELECT-FOB-AND-SCAC-CODES'  24550000
245600         DISPLAY '** PO NUMBER    = ' TR016-ETA-PO-NBR            24560000
245700         DISPLAY '** EXTL REF NBR = ' TR016-ETA-EXTL-REF-NBR      24570000
245800         DISPLAY '****************************************'       24580000
245900         PERFORM 9100-SQL-ABEND                                   24590000
246000     END-IF.                                                      24600000
246100                                                                  24610000
246200******************************************************************24620000
246300* SELECT TIMCNPO WHERE PO = CUSTOMS PO TO SEE IF CONTAINER EXISTS 24630000
246400******************************************************************24640000
246500                                                                  24650000
246600 7450-SELECT-TIMCNPO.                                             24660000
246700                                                                  24670000
246800     MOVE TR016-ETA-PO-NBR TO IMCNPO-PO-NBR                       24680000
246900                                                                  24690000
247000     PERFORM                                                      24700000
247100         WITH TEST AFTER                                          24710000
247200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     24720000
247300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            24730000
247400                 SQLCODE = ZERO                     OR            24740000
247500                 SQLCODE = +100                     OR            24750000
247600                 SQLCODE = -811                                   24760000
247700                                                                  24770000
247800         EXEC SQL                                                 24780000
247900             SELECT DISTINCT                                      24790000
248000               A.CONTNR_ID                                        24800000
248100               INTO :IMCNPO-CONTNR-ID                             24810000
248200               FROM TIMCNPO  A                                    24820000
248300              WHERE A.PO_NBR         = :IMCNPO-PO-NBR             24830000
248400         END-EXEC                                                 24840000
248500                                                                  24850000
248600         EVALUATE TRUE                                            24860000
248700             WHEN SQLCODE = ZERO                                  24870000
248800             WHEN SQLCODE = -811                                  24880000
248900                 SET PS-PO-EXISTS-ON-TIMCNPO TO TRUE              24890000
249000                                                                  24900000
249100             WHEN SQLCODE = +100                                  24910000
249200                 CONTINUE                                         24920000
249300                                                                  24930000
249400             WHEN SQLCODE = -904                                  24940000
249500             WHEN SQLCODE = -913                                  24950000
249600                 CONTINUE                                         24960000
249700                                                                  24970000
249800             WHEN SQLWARN0 NOT EQUAL SPACE                        24980000
249900             WHEN SQLCODE NOT EQUAL ZERO                          24990000
250000                 DISPLAY '**************************************' 25000000
250100                 DISPLAY '** ABEND                            **' 25010000
250200                 DISPLAY '** PROGRAM = TRKUT230               **' 25020000
250300                 DISPLAY '** PARAGRAPH = 7450-SELECT-PO       **' 25030000
250400                 DISPLAY '** PO NUMBER   =' TR016-ETA-PO-NBR      25040000
250500                 DISPLAY '**************************************' 25050000
250600                 PERFORM 9100-SQL-ABEND                           25060000
250700         END-EVALUATE                                             25070000
250800     END-PERFORM.                                                 25080000
250900                                                                  25090000
251000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25100000
251100            (SQLCODE NOT = ZERO AND                               25110000
251200             SQLCODE NOT = +100 AND                               25120000
251300             SQLCODE NOT = -811)                                  25130000
251400         DISPLAY '****************************************'       25140000
251500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       25150000
251600         DISPLAY '** PROGRAM = TRKUT230                 **'       25160000
251700         DISPLAY '** PARAGRAPH = 7450-SELECT-PO         **'       25170000
251800         DISPLAY '** PO NUMBER   =' TR016-ETA-PO-NBR              25180000
251900         DISPLAY '****************************************'       25190000
252000         PERFORM 9100-SQL-ABEND                                   25200000
252100     END-IF.                                                      25210000
252200                                                                  25220000
252300 EJECT                                                            25230000
252400******************************************************************25240000
252500* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *25250000
252600* JOB SUMMARY INFORMATION.                                       *25260000
252700* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *25270000
252800* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *25280000
252900* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *25290000
253000* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*25300000
253100* NO RETURN CODE OR MESSAGE IS SENT.                             *25310000
253200******************************************************************25320000
253300 8000-EOJ-ROUTINE.                                                25330000
253400                                                                  25340000
253500     IF EDI-IEA-RECORD OR                                         25350000
253600        TR231-ERROR-TYPE = PC-EMPTY                               25360000
253700         CONTINUE                                                 25370000
253800     ELSE                                                         25380000
253900         INITIALIZE          TR231-ARRVL-PAR-1-ODR                25390000
254000         MOVE PC-EDI         TO TR231-ERROR-TYPE                  25400000
254100         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  25410000
254200                             TO TR231-ERROR-MSG                   25420000
254300         ADD +1 TO PV-PROCESS-SEQ-NBR                             25430000
254400         MOVE PV-PROCESS-SEQ-NBR TO TR231-PROCESS-SEQ-NBR         25440000
254500         PERFORM 6205-WRITE-ERROR-REPORT-IEA                      25450000
254600     END-IF.                                                      25460000
254700                                                                  25470000
254800     IF PV-TURN-ISA-WRITTEN  =  SPACES                            25480000
254900       CONTINUE                                                   25490000
255000     ELSE                                                         25500000
255100         IF PV-HOLD-IEA-RECORD = SPACES                           25510000
255200           CONTINUE                                               25520000
255300         ELSE                                                     25530000
255400           MOVE PV-HOLD-IEA-RECORD TO TR016-REC-TYP-ETA           25540000
255500           PERFORM 6500-WRITE-TURNAROUND-RECORD                   25550000
255600         END-IF                                                   25560000
255700     END-IF.                                                      25570000
255800                                                                  25580000
255900     CLOSE TR016-ARRIVAL-FILE                                     25590000
256000           TR026-UPDATE-ARRIVAL-FILE                              25600000
256100           TR016-ARRIVAL-TURNAROUND-FILE                          25610000
256200           TR231-ARRIVAL-ERROR-FILE.                              25620000
256300                                                                  25630000
256400     DISPLAY '**********************************'.                25640000
256500     DISPLAY '** TRKUT230 SUMMARY             **'.                25650000
256600     DISPLAY '**********************************'.                25660000
256700     DISPLAY 'TOTAL ARVL INPUT RECS  = ' PA-TOTAL-INPUT-READ.     25670000
256800     DISPLAY 'TOTAL EDI RECS         = ' PA-TOTAL-EDI-REC-READ.   25680000
256900     DISPLAY 'TOTAL ARVL ADD RECS    = ' PA-TOT-ARVL-RECS-ADD.    25690000
257000     DISPLAY 'TOTAL ARVL CHG RECS    = ' PA-TOT-ARVL-RECS-CHANGE. 25700000
257100     DISPLAY 'TOTAL ARVL DEL RECS    = ' PA-TOT-ARVL-RECS-DELETE. 25710000
257200     DISPLAY 'TOTAL NON OCEAN RECS   = ' PA-TOT-NON-OCEAN-RECS.   25720000
257300     DISPLAY '**********************************'.                25730000
257400                                                                  25740000
257500 EJECT                                                            25750000
257600******************************************************************25760000
257700* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *25770000
257800* ERROR OR WARNING CODE OCCURS.                                  *25780000
257900******************************************************************25790000
258000 9100-SQL-ABEND.                                                  25800000
258100******************************************************************25810000
258200* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *25820000
258300* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *25830000
258400* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *25840000
258500* FORMAT.                                                        *25850000
258600******************************************************************25860000
258700                                                                  25870000
258800     COPY DPPD004.                                                25880000
258900                                                                  25890000
259000     DISPLAY 'PO NUMBER    '  TR016-ETA-PO-NBR.                   25900000
259100     DISPLAY 'EXTL REF NBR '  TR016-ETA-EXTL-REF-NBR.             25910000
259200     MOVE +4013 TO ABEND-CODE.                                    25920000
259300     CALL 'ILBOABN0' USING ABEND-CODE.                            25930000
259400                                                                  25940000
