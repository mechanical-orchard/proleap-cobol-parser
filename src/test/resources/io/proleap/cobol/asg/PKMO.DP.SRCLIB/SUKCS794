000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    SUKCS794.                                         00040002
000500 AUTHOR.        OMAN.                                             00050003
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
000700 DATE-WRITTEN.  OCTOBER 2008.                                     00070004
000800 DATE-COMPILED.                                                   00080002
000900                                                                  00090002
001000*---------------------------------------------------------------* 00100002
001100*    12/08 OMAN   ADDED LOGIC TO 2420- TO SKIP ANY LINES WITH   * 00110099
001101*                 "AVAILABLE" IN THE TRAILER FOR F22 (UNASSIGN) * 00110199
001102*                 THEY HAVE NOTHING TO UNASSIGN.                * 00110299
001103*                                                               * 00110399
001104*                 ADDED YELLOW HIGHLIGHTING TO YELLOW INDICATES * 00110499
001105*                 LINES ON SCREEN TO MAKE THEM MORE OBVIOUS.    * 00110599
001106*                                                               * 00110699
001107*          2460-  ADDED PC-DEFAULT-TMST TO WHERE CONDITION AS   * 00110799
001108*          PARA   CURRENT UPDATE WASN'T SPECIFIC ENOUGH.        * 00110899
001109*                                                               * 00110999
001110*    12/10 OMAN   ADD LOGIC TO F22 TO COMPARE WHAT OPER UNIT    * 00111099
001111*                 THE PERSON IS IN.  SENT 2571 IF NO MATCH      * 00111199
001112*                 TO WHAT THEY ARE TRYING TO CHANGE.            * 00111299
001113*                                                               * 00111399
001114*    12/10 OMAN   ADD LOGIC TO F15 TO ALLOW IT TO GO TO 796     * 00111499
001115*                 BUT EVERYTHING WILL BE PROTECTED.             * 00111599
001116*                                                               * 00111699
001117*    12/23 OMAN   17794 FIXED 4300- LOGIC TO RETURN TO CALLING  * 00111799
001118*                 SCREEN WITH 00050 MESSAGE IF NO ITEMS WERE    * 00111899
001119*                 FOUND AND ONLY 1 ITEM WAS SELECTED ON         * 00111999
001120*                 SUKCS795.  IF MORE THAN 1 ITEM WAS SELECTED   * 00112099
001123*                 ON SUKCS795 AND THERE AREN'T ANY ITEMS TO     * 00112399
001124*                 DISPLAY, STAY ON SUKCS794 AND DISPLAY THE     * 00112499
001125*                 00050 MESSAGE.                                * 00112599
001126*                                                               * 00112699
001127*    01/16/09     CHRISTINE TWIEHAUS IR 18,058                    00112799
001128*                 POPULTE ASC-USR-ID WITH DP020-USERID            00112899
001129*                                                               * 00112999
001130*    01/23/09     CHRISTINE TWIEHAUS IR 18,258                    00113099
001131*                 SELECT LOGGED ON WORKERS ONLY                   00113199
001132*                                                               * 00113299
001133*    01/26/09     CHRISTINE TWIEHAUS IR 18,063                    00113399
001134*                 IN 1000-, DP020-NEXT-ACT-RETURN, IF UPDATE HAS  00113499
001136*                 WAS DONE IN 796, DISPLAY NEW DATA               00113699
001137*                 IN 2100-CHECK-FUNCTION-KEY, F22                 00113799
001138*                 IF UNASSIGN DONE WITHIN THIS SCREEN,            00113899
001139*                 DISPLAY NEW DATA                                00113999
001140*    01/29/09     GERMAN BANDA 18,210                             00114099
001141*                 IN 2210- , CORRECT ISSUE WITH 'S' REMAINING ON  00114199
001142*                 SCREEN AFTER BEING SPACED OUT                   00114299
001140*    04/13/17     CHERI PARMLEY                                   00114399
001141*                 CHANGE TO ALLOW ONLY ONE DOOR AVAILABLE BASED   00114499
001142*                 ON A PARM-'PASGND' CURRENTLY USED FOR BLUE      00114599
001142*                 SPRINGS.                                        00114699
001146*                                                               * 00114799
001147*---------------------------------------------------------------* 00114899
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00115099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00115199
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00115299
001130*                                                                 00115399
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00115499
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00115599
263968*---------------------------------------------------------------* 00115699
001148                                                                  00115799
001149*---------------------------------------------------------------* 00115899
001150*    S794 - PRINT AND APPLY DOOR TRIP LIST                      * 00116099
001200*---------------------------------------------------------------* 00120002
001300 ENVIRONMENT DIVISION.                                            00130002
001400 DATA DIVISION.                                                   00140002
001500                                                                  00150002
001600 WORKING-STORAGE SECTION.                                         00160002
001700                                                                  00170002
001800 01  DK-DB2-KEYS.                                                 00180002
001900     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00190002
002000     05  DK-DOOR-ID                PIC X(04)   VALUE SPACES.      00200041
002100     05  DK-ACM-LBL-STA-NBR        PIC S9(09) COMP VALUE +0.      00210099
002200     05  DK-TRIP-ID                PIC S9(09) COMP VALUE +0.      00220041
002300     05  DK-USR-ID                 PIC X(08)   VALUE SPACES.      00230082
002400     05  DK-TIMESTAMP              PIC X(26)   VALUE SPACES.      00240082
002500     05  DK-TIMESTAMP-1-19         PIC X(19)   VALUE SPACES.      00250085
002600     05  DK-ASGD-STRT-TMST         PIC X(26)   VALUE SPACES.      00260099
002700     05  DK-ASSIGN-FROM-DATE       PIC X(10)   VALUE SPACES.      00270099
002800     05  DK-ASSIGN-TO-DATE         PIC X(10)   VALUE SPACES.      00280060
002900                                                                  00290099
003000 01  DN-DB2-NULL-INDICATORS.                                      00300099
003100     05  DN-ASGD-STRT-IND          PIC S9(04) COMP VALUE +0.      00310099
003200     05  DN-ASGD-END-IND           PIC S9(04) COMP VALUE +0.      00320099
003300     05  DN-INBD-TRIP-IND          PIC S9(04) COMP VALUE +0.      00330099
003400                                                                  00340002
003500 01  PC-PROGRAM-CONSTANTS.                                        00350002
003600     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SUK794  '.  00360002
003700     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM794 '.  00370002
003800     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS794'.  00380002
003900     05  PC-APPL-MAP               PIC S9(04)  VALUE  +1          00390002
004000                                                     COMP.        00400002
004100     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00410002
004200     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00420002
004300     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00430002
004400     05  PC-DETAIL-SCREEN          PIC  X(01)  VALUE '2'.         00440002
004500     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +9           00450030
004600                                               COMP SYNC.         00460002
004700     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00470002
004800                                               COMP SYNC.         00480002
004900     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00490002
005000                                               COMP-3.            00500002
005100     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00510002
005200                                               COMP SYNC.         00520002
005300     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00530002
005400                                               COMP-3.            00540002
005500     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00550002
005600     05  PC-ADD                    PIC  X(03)  VALUE 'ADD'.       00560002
005700     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00570002
005800     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00580002
005900     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00590002
006000     05  PC-YELLOW                 PIC  X(01)  VALUE 'Y'.         00600099
006100     05  PC-GREEN                  PIC  X(01)  VALUE 'G'.         00610099
006200     05  PC-BLUE                   PIC  X(01)  VALUE 'B'.         00620099
006300     05  PC-DOOR                   PIC  X(04)  VALUE 'DOOR'.      00630099
006400     05  PC-STORE                  PIC  X(05)  VALUE 'STORE'.     00640099
006500     05  PC-01                     PIC  X(02)  VALUE '01'.        00650099
006600     05  PC-A                      PIC  X(01)  VALUE 'A'.         00660099
006700     05  PC-D                      PIC  X(01)  VALUE 'D'.         00670099
006800     05  PC-N                      PIC  X(01)  VALUE 'N'.         00680099
006900     05  PC-S                      PIC  X(01)  VALUE 'S'.         00690099
007000     05  PC-U                      PIC  X(01)  VALUE 'U'.         00700099
007100     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     00710099
007200     05  PC-AVAILABLE              PIC  X(09)  VALUE 'AVAILABLE'. 00720099
007200     05  PC-UNAVAIL                PIC  X(09)  VALUE 'UNAVAIL  '. 00721099
007300     05  PC-DEFAULT-TRIP          PIC  9(09)   VALUE 999999999.   00730099
007400     05  PC-DEFAULT-TMST          PIC  X(26)                      00740099
007500                          VALUE  '9999-09-09-09.09.09.999999'.    00750099
007600     05  PC-DEFAULT-DATE          PIC  X(10)                      00760099
007700                          VALUE  '9999-09-09'.                    00770099
007800                                                                  00780002
007900*----------------------------------------------------------------*00790002
008000*  SYSTEM MESSAGES                                               *00800002
008100*----------------------------------------------------------------*00810002
008200*   00005 = INVALID VALUE                                        *00820002
008300*   00008 = MUST BE NUMERIC                                      *00830002
008400*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00840002
008500*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00850002
008600*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00860002
008700*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00870002
008800*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00880002
008900*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00890002
009000*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00900002
009100*   00069 - TOP OF LIST                                          *00910002
009200*   00070 - BOTTOM OF LIST                                       *00920002
009300*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00930002
009400*   00279 - MORE ITEMS TO DISPLAY                                *00940002
009500*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00950002
009600*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI00960002
009700*----------------------------------------------------------------*00970002
009800     05  PC-TSYMSG-NUMBERS.                                       00980002
009900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00990002
010000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01000002
010100         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01010074
010200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01020074
010300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01030002
010400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01040002
010500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01050002
010600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01060002
010700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01070002
010800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01080002
010900         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01090096
011000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01100002
011100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01110002
011200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01120002
011300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01130002
011400         10  PC-TSYMSG-02571            PIC  9(05)  VALUE 02571.  01140002
011500         10  PC-TSYMSG-02575            PIC  9(05)  VALUE 02575.  01150002
011600         10  PC-TSYMSG-03628            PIC  9(05)  VALUE 03628.  01160097
011700         10  PC-TSYMSG-03650            PIC  9(05)  VALUE 03650.  01170099
011800*                                                                 01180002
011900 01  PS-PROGRAM-SWITCHES.                                         01190002
012000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01200002
012100         88  PS-NO-ERROR                            VALUE 'Y'.    01210002
012200         88  PS-ERROR                               VALUE 'N'.    01220002
012300     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01230002
012400         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01240002
012500         88  PS-BLOCK-ERROR                         VALUE 'N'.    01250002
012600     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   01260002
012700         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   01270002
012800         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   01280002
012900     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01290002
013000         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01300002
013100         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01310002
013200     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01320002
013300         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01330002
013400         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01340002
013500     05  PS-LIST-END-SW             PIC  X(01)  VALUE 'N'.        01350099
013600         88  PS-LIST-END                        VALUE 'Y'.        01360099
013700         88  PS-NO-LIST-END                     VALUE 'N'.        01370099
013800     05  PS-END-OF-DOOR-CSR-SW      PIC  X(01)  VALUE 'N'.        01380099
013900         88  PS-END-OF-DOOR-CSR                 VALUE 'Y'.        01390099
014000         88  PS-NOT-END-OF-DOOR-CSR             VALUE 'N'.        01400099
014100     05  PS-DOOR-ASSIGNED-SW        PIC  X(01)  VALUE 'N'.        01410099
014200         88  PS-DOOR-ASSIGNED-YES               VALUE 'Y'.        01420099
014300         88  PS-DOOR-ASSIGNED-NO                VALUE 'N'.        01430099
014602     05  PS-IS-PASGND-FOUND         PIC  X(01)  VALUE 'N'.        01431099
014603         88  PS-DC-PASGND-FOUND                 VALUE 'Y'.        01432099
014604         88  PS-DC-PASGND-NOT-FOUND             VALUE 'N'.        01433099
014400*                                                                 01440002
014500 01  PV-PROGRAM-VARIABLES.                                        01450002
014600     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01460002
014700                                        COMP SYNC.                01470002
014800     05  PV-SUB                         PIC S9(04)  VALUE +0      01480002
014900                                                    COMP SYNC.    01490002
015000     05  PV-SUB1                        PIC S9(04)  VALUE +0      01500089
015100                                                    COMP SYNC.    01510089
015200     05  PV-TK-COUNT                    PIC S9(04)  VALUE +0      01520099
015300                                                    COMP SYNC.    01530099
015400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01540002
015500                                                    COMP SYNC.    01550002
015600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01560002
015700                                                    COMP-3.       01570002
015800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01580002
015900                                                    COMP-3.       01590002
016000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01600002
016100                                                    COMP-3.       01610002
016200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01620002
016300                                                    COMP-3.       01630002
016400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01640002
016500                                                    COMP-3.       01650002
016600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01660002
016700                                                    COMP-3.       01670002
016800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01680002
016900                                                    COMP-3.       01690002
017000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01700002
017100                                                    COMP SYNC.    01710002
017200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01720002
017300                                                    COMP SYNC.    01730002
017400     05  PV-ITEM                        PIC S9(04)  VALUE +0      01740002
017500                                                    COMP SYNC.    01750002
017600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01760002
017700                                                    COMP SYNC.    01770002
017800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01780002
017900                                                    COMP SYNC.    01790002
018000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01800002
018100                                                    COMP SYNC.    01810002
018200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01820002
018300                                                    COMP SYNC.    01830002
018400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01840002
018500                                                    COMP SYNC.    01850002
018600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01860002
018700                                                    COMP SYNC.    01870002
018800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01880002
018900                                                    COMP SYNC.    01890002
019000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01900002
019100                                                    COMP SYNC.    01910002
019200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01920002
019300                                                    COMP SYNC.    01930002
019400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01940002
019500                                                    COMP SYNC.    01950002
019600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01960002
019700                                                    COMP SYNC.    01970002
019800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01980002
019900                                                    COMP SYNC.    01990002
020000     05  PV-SOFT-ABORT-MSG.                                       02000002
020100         10  FILLER            PIC X(12) VALUE ' SUKCS794 - '.    02010002
020200         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02020002
020300         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02030002
020400         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02040002
020500         10  PV-SOFT-PARAGRAPH PIC X(30).                         02050002
020600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02060002
020700                                                     COMP SYNC.   02070002
020800     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02080002
020900     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02090002
021000     05  PV-CICS-MSG-HOLD.                                        02100002
021100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02110002
021200         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02120002
021300     05  PV-CICS-MSG-HOLD2.                                       02130002
021400         10  FILLER                      PIC  X(01)  VALUE SPACE. 02140002
021500         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02150002
021600                                                                  02160002
021700     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02170002
021800                                                     COMP SYNC.   02180002
021900     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02190002
022000     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02200002
022100     05  PV-SAVE-DOOR-ID          PIC  X(04)  VALUE SPACES.       02210099
022200     05  PV-UNION-TYPE                  PIC  X(01).               02220099
022300     05  PV-UNION-SEQUENCE            PIC S9(04) COMP VALUE ZERO. 02230099
           05  PV-CNT                          PIC S9(09)  VALUE +0     02231099
                                                           COMP-3.      02232099
                                                                        02233099
           05  PV-FUNC-QTY                     PIC  9(09)  VALUE ZEROES.02234099
           05  PV-FUNC-QTY-R REDEFINES PV-FUNC-QTY.                     02235099
               10  FILLER                      PIC  9(08).              02236099
               10  PV-FUNC-QTYX                PIC  X(01).              02237099
022400******************************************************************02240002
022500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02250002
022600**  THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          **02260002
022700**  APPLICATION-SPECIFIC COMMAREA.                              **02270002
022800******************************************************************02280002
022900 01  LQW-LIST-QUEUE-WORK-AREA.                                    02290002
023000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02300002
023100     05  LQW-ITEM-ENTRIES               OCCURS 09 TIMES           02310010
023200                                        INDEXED BY LQW-IDX.       02320002
023300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02330002
023400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02340002
023500         10  LQW-SELECTED-SW            PIC  X(01).               02350002
023600             88  LQW-SELECT                         VALUE 'S'.    02360002
023700             88  LQW-DESELECT                       VALUE ' '.    02370002
023800         10  LQW-ACTION                 PIC  X(03).               02380002
023900             88  LQW-ADD                            VALUE 'ADD'.  02390002
024000             88  LQW-INQ                            VALUE 'INQ'.  02400002
024100             88  LQW-UPD                            VALUE 'UPD'.  02410002
024200             88  LQW-ERR                            VALUE 'ERR'.  02420002
024300         10  LQW-DOOR-ID                PIC  X(04).               02430002
024400         10  LQW-SCAC                   PIC  X(04).               02440004
024500         10  LQW-TRAILER                PIC  X(10).               02450012
024600         10  LQW-ACTV-IND               PIC  X(01).               02460004
024700         10  LQW-TRIP-ID                PIC  9(09).               02470004
024800         10  LQW-ASSIGN-TMST            PIC  X(26).               02480099
024900         10  LQW-UNASSIGN-TMST          PIC  X(26).               02490099
025000         10  LQW-TK-NBR                 PIC  X(08).               02500099
025100         10  LQW-TRIP-COLOR             PIC  X(01).               02510099
025200         10  LQW-TK-COUNT               PIC  9(03).               02520099
025300                                                                  02530002
025400*---------------------------------------------------------------* 02540002
025500* SELECTION QUEUE LAYOUT                                        * 02550002
025600*---------------------------------------------------------------* 02560002
025700     COPY SUWS088.                                                02570007
025800                                                                  02580002
025900*---------------------------------------------------------------* 02590002
026000*    MAP LAYOUT                                                 * 02600002
026100*---------------------------------------------------------------* 02610002
026200     COPY SUKM794.                                                02620002
026300*                                                                 02630002
026400 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK794O.       02640002
026500**?? 05  FILLER                         PIC X(90).                02650099
026510     05  FILLER                         PIC X(120).               02651099
026600     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          02660010
026700         10  MR-SELECTL                 PIC S9(04) COMP.          02670002
026800         10  MR-SELECTA                 PIC  X(01).               02680002
026900         10  MR-SELECTC                 PIC  X(01).               02690002
027000         10  MR-SELECTH                 PIC  X(01).               02700002
027100         10  MR-SELECTI                 PIC  X(01).               02710002
027200                                                                  02720002
027300         10  MR-ACTIONL                 PIC S9(04) COMP.          02730002
027400         10  MR-ACTIONA                 PIC  X(01).               02740002
027500         10  MR-ACTIONC                 PIC  X(01).               02750002
027600         10  MR-ACTIONH                 PIC  X(01).               02760002
027700         10  MR-ACTION                  PIC  X(03).               02770002
027800                                                                  02780002
027900         10  MR-DOOR-IDL               PIC S9(04) COMP.           02790002
028000         10  MR-DOOR-IDA               PIC  X(01).                02800002
028100         10  MR-DOOR-IDC               PIC  X(01).                02810002
028200         10  MR-DOOR-IDH               PIC  X(01).                02820002
028300         10  MR-DOOR-ID                PIC  X(04).                02830002
028400                                                                  02840002
028500         10  MR-SCACL                  PIC S9(04) COMP.           02850003
028600         10  MR-SCACA                  PIC  X(01).                02860003
028700         10  MR-SCACC                  PIC  X(01).                02870003
028800         10  MR-SCACH                  PIC  X(01).                02880003
028900         10  MR-SCAC                   PIC  X(04).                02890003
029000                                                                  02900002
029100         10  MR-TRAILERL               PIC S9(04) COMP.           02910003
029200         10  MR-TRAILERA               PIC  X(01).                02920003
029300         10  MR-TRAILERC               PIC  X(01).                02930003
029400         10  MR-TRAILERH               PIC  X(01).                02940003
029500         10  MR-TRAILER                PIC  X(10).                02950012
029600                                                                  02960002
029700         10  MR-ACTV-INDL              PIC S9(04) COMP.           02970003
029800         10  MR-ACTV-INDA              PIC  X(01).                02980003
029900         10  MR-ACTV-INDC              PIC  X(01).                02990003
030000         10  MR-ACTV-INDH              PIC  X(01).                03000003
030100         10  MR-ACTV-IND               PIC  X(01).                03010003
030200                                                                  03020002
030300         10  MR-TRIP-IDL               PIC S9(04) COMP.           03030003
030400         10  MR-TRIP-IDA               PIC  X(01).                03040003
030500         10  MR-TRIP-IDC               PIC  X(01).                03050003
030600         10  MR-TRIP-IDH               PIC  X(01).                03060003
030700         10  MR-TRIP-ID                PIC  Z(09).                03070055
030800                                                                  03080002
030900         10  MR-ASSIGN-DATEL           PIC S9(04) COMP.           03090017
031000         10  MR-ASSIGN-DATEA           PIC  X(01).                03100017
031100         10  MR-ASSIGN-DATEC           PIC  X(01).                03110017
031200         10  MR-ASSIGN-DATEH           PIC  X(01).                03120017
031300         10  MR-ASSIGN-DATE            PIC  X(08).                03130017
031400                                                                  03140003
031500         10  MR-ASSIGN-TIMEL           PIC S9(04) COMP.           03150017
031600         10  MR-ASSIGN-TIMEA           PIC  X(01).                03160017
031700         10  MR-ASSIGN-TIMEC           PIC  X(01).                03170017
031800         10  MR-ASSIGN-TIMEH           PIC  X(01).                03180017
031900         10  MR-ASSIGN-TIME            PIC  X(08).                03190017
032000                                                                  03200002
032100         10  MR-UNASSIGN-DATEL         PIC S9(04) COMP.           03210017
032200         10  MR-UNASSIGN-DATEA         PIC  X(01).                03220017
032300         10  MR-UNASSIGN-DATEC         PIC  X(01).                03230017
032400         10  MR-UNASSIGN-DATEH         PIC  X(01).                03240017
032500         10  MR-UNASSIGN-DATE          PIC  X(08).                03250017
032600                                                                  03260003
032700         10  MR-UNASSIGN-TIMEL         PIC S9(04) COMP.           03270017
032800         10  MR-UNASSIGN-TIMEA         PIC  X(01).                03280017
032900         10  MR-UNASSIGN-TIMEC         PIC  X(01).                03290017
033000         10  MR-UNASSIGN-TIMEH         PIC  X(01).                03300017
033100         10  MR-UNASSIGN-TIME          PIC  X(08).                03310017
033200                                                                  03320002
033300     05  FILLER                         PIC  X(12).               03330003
033400                                                                  03340003
033500*----------------------------------------------------------------*03350003
033600*  SENDING/RECEIVING AREA FOR THE                                 03360003
033700*  PRINTER VALIDATION ROUTING (DPKCS060)                          03370003
033800*----------------------------------------------------------------*03380003
033900     COPY DPWS072.                                                03390002
034000                                                                  03400002
034100*---------------------------------------------------------------* 03410002
034200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03420002
034300*---------------------------------------------------------------* 03430002
034400     COPY DPWS015.                                                03440002
034500                                                                  03450002
034600*---------------------------------------------------------------* 03460002
034700*    FUNCTION KEYS COPYBOOK.                                    * 03470002
034800*---------------------------------------------------------------* 03480002
034900     COPY DPWS016.                                                03490002
035000                                                                  03500002
035100*---------------------------------------------------------------* 03510002
035200*    NUMERIC EDIT LAYOUT.                                       * 03520002
035300*---------------------------------------------------------------* 03530002
035400     COPY DPWS010I.                                               03540002
035500                                                                  03550002
035600*---------------------------------------------------------------* 03560002
035700*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 03570099
035800*---------------------------------------------------------------* 03580002
035900     COPY DPWS030.                                                03590002
035900     COPY DPWS930.                                                03591099
036000                                                                  03600002
036100*---------------------------------------------------------------* 03610002
036200*    STANDARD COMMAREA.                                         * 03620002
036300*---------------------------------------------------------------* 03630002
036400     COPY DPWS020.                                                03640002
036500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03650002
036600                                                                  03660002
036700*---------------------------------------------------------------* 03670002
036800* INTER-APPLICATION COMMAREA.                                   * 03680002
036900*   SUWS087 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 03690007
037000*             SPEC SCREEN.                                      * 03700002
037100*   SUWS089 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03710015
037200*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 03720002
037300*---------------------------------------------------------------* 03730002
037400         10  INTER-APPL-COMM-AREA       PIC X(200).               03740002
037500     COPY SUWS087.                                                03750007
037600     COPY SUWS089.                                                03760015
037700                                                                  03770002
037800*---------------------------------------------------------------* 03780002
037900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03790002
038000*---------------------------------------------------------------* 03800002
038100         10  ASC-SPECIFIC-COMMAREA.                               03810002
038200             15  ASC-FUNCTION                 PIC  X(01).         03820002
038300             15  ASC-OPER-UNT-ID              PIC  9(04).         03830002
038400             15  ASC-FCLTY-NAME               PIC  X(25).         03840002
038500             15  ASC-PNA-STA-NBR              PIC  9(04).         03850057
038600             15  ASC-ASSIGN-TMST-HDR          PIC X(26).          03860099
038700             15  ASC-ASSIGN-FROM-DATE         PIC X(10).          03870099
039100             15  ASC-ASSIGN-TO-DATE           PIC  X(10).         03910099
039600             15  ASC-COUNT                    PIC S9(09) COMP.    03960002
039700             15  ASC-WORK-COUNT               PIC S9(09) COMP.    03970099
039800             15  ASC-USR-ID                  PIC  X(08).          03980099
039900             15  ASC-INT-APPL-FORMAT-IND     PIC  X(01).          03990099
040000             15  ASC-BLK-SUB                  PIC S9(04) COMP     04000002
040100                                                         SYNC.    04010002
040200             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04020002
040300                                                         SYNC.    04030002
040400             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04040002
040500             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04050002
040600             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04060002
040700             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04070002
040800             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04080002
040900             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04090002
041000                                                         SYNC.    04100002
041100             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04110002
041200             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04120002
041300             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         04130002
041400                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     04140002
041500                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     04150002
041600             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04160002
041700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04170002
041800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04180002
041900             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04190002
042000                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04200002
042100                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04210002
042200             15  ASC-LIST-QUEUE-NAME.                             04220002
042300                 20  ASC-LIST-TERM-ID         PIC  X(04).         04230002
042400                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04240002
042500                 20  ASC-LIST-SEQ             PIC  9(01).         04250002
042600                                                                  04260002
042700             15  ASC-START-ITEM-REQUEST.                          04270002
042800                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04280002
042900                                                                  04290002
043000             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04300002
043100             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04310002
043200             15  ASC-CURSOR-SW                PIC  X(02).         04320002
043300                 88  ASC-NO-CURSOR                   VALUE 'Z '.  04330002
043400                 88  ASC-DOOR-TRIP-CSR               VALUE 'A '.  04340039
043500             15  ASC-STORE-SW                 PIC  X(01).         04350002
043600                 88  ASC-LIST-BY-STORE               VALUE 'S'.   04360002
043700                 88  ASC-LIST-BY-DOOR                VALUE 'D'.   04370002
043800                                                                  04380002
043900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04390002
044000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04400002
044100             15  ASC-SEL-QUEUE-NAME.                              04410002
044200                 20  ASC-SEL-TERM-ID          PIC  X(04).         04420002
044300                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04430002
044400                 20  ASC-SEL-SEQ              PIC  9(01).         04440002
044410             15  ASC-SEL-QUEUE-NAME-IN.                           04441099
044420                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         04442099
044430                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  04443099
044440                 20  ASC-SEL-SEQ-IN           PIC  9(01).         04444099
044500                                                                  04450002
044600             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04460002
044601                                                                  04460199
044800*-----------------------------------------------------------------04480002
044900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04490002
045000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04500002
045100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04510002
045200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04520002
045300                                                                  04530002
045400                 20  ASC-ITEM-ARRAY.                              04540002
045500                     25  ASC-ITEM-ENTRIES OCCURS 09 TIMES.        04550010
045600                         30  ASC-LIST-ITEM-NUMBER                 04560002
045700                                                     PIC S9(09)   04570002
045800                                                     COMP-3.      04580002
045900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  04590002
046000                             88  ASC-VALID-SELECT    VALUE ' '    04600002
046100                                                           'S'    04610002
046200                                                           'B'    04620002
046300                                                           'E'.   04630002
046400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04640002
046500                             88  ASC-TEMP-SELECT     VALUE 'S'.   04650002
046600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04660002
046700                             88  ASC-TEMP-END        VALUE 'E'.   04670002
046800                         30  ASC-SELECTED-SW         PIC  X(01).  04680002
046900                             88  ASC-NO-SELECT       VALUE ' '.   04690002
047000                             88  ASC-SELECT          VALUE 'S'.   04700002
047100                             88  ASC-BEGIN           VALUE 'B'.   04710002
047200                             88  ASC-END             VALUE 'E'.   04720002
047300                         30  ASC-ACTION              PIC  X(03).  04730002
047400                         30  ASC-DOOR-ID             PIC  X(04).  04740002
047500                         30  ASC-SCAC                PIC  X(04).  04750006
047600                         30  ASC-TRAILER             PIC  X(10).  04760012
047700                         30  ASC-ACTV-IND            PIC  X(01).  04770006
047800                         30  ASC-TRIP-ID             PIC  9(09).  04780006
047900                         30  ASC-ASSIGN-TMST         PIC  X(26).  04790099
048000                         30  ASC-UNASSIGN-TMST       PIC  X(26).  04800099
048100                         30  ASC-TK-NBR              PIC  X(08).  04810099
048200                         30  ASC-TRIP-COLOR          PIC  X(01).  04820099
048300                         30  ASC-TK-COUNT            PIC  9(03).  04830099
048400                                                                  04840002
048500*---------------------------------------------------------------* 04850002
048600*    ABEND PROCESSING COPYBOOK.                                 * 04860002
048700*---------------------------------------------------------------* 04870002
048800     COPY DPWS013.                                                04880002
048900                                                                  04890038
049000*----------------------------------------------------------------*04900038
049100*    DB2 TABLE FOR PRINT AND APPLY STATION DOOR                   04910099
049200*----------------------------------------------------------------*04920038
049300     EXEC SQL                                                     04930038
049400          INCLUDE SUT00109                                        04940099
049500     END-EXEC.                                                    04950038
049600                                                                  04960099
049700*----------------------------------------------------------------*04970099
049800*    DB2 TABLE FOR PRINT AND APPLY TRIP ASSIGNMENT                04980099
049900*----------------------------------------------------------------*04990099
050000     EXEC SQL                                                     05000099
050100          INCLUDE SUT00110                                        05010099
050200     END-EXEC.                                                    05020099
050300                                                                  05030099
050400*----------------------------------------------------------------*05040099
050500*    DB2 TABLE FOR PRINT AND APPLY STATION WORKER                 05050099
050600*----------------------------------------------------------------*05060099
050700     EXEC SQL                                                     05070099
050800          INCLUDE SUT00111                                        05080099
050900     END-EXEC.                                                    05090099
051000                                                                  05100099
051100*----------------------------------------------------------------*05110099
051200*    DB2 TABLE FOR TRIP TABLE                                     05120099
051300*----------------------------------------------------------------*05130099
051400     EXEC SQL                                                     05140099
051500          INCLUDE TVHTRIP                                         05150099
051600     END-EXEC.                                                    05160099
051700                                                                  05170099
      *CLP 03-30-17                                                     05170199
051100*----------------------------------------------------------------*05171099
051200*    DB2 TABLE FOR PARM TABLE                                     05172099
051300*----------------------------------------------------------------*05173099
040470*  PARM TABLE                                                     05173199
040480     EXEC SQL                                                     05173299
040490          INCLUDE TKRPRPM                                         05173399
040500     END-EXEC.                                                    05173499
051700                                                                  05177099
051800*---------------------------------------------------------------* 05180002
051900*    DOOR TRIP CURSOR                                             05190039
052000*---------------------------------------------------------------* 05200002
052100     EXEC SQL                                                     05210002
052200        DECLARE DOOR-TRIP-CSR CURSOR FOR                          05220039
052300         SELECT                                                   05230038
052400                 DOOR_ID                                          05240039
052500                ,INBD_TRIP_ID                                     05250039
052600                ,ASGD_STRT_TMST                                   05260039
052700                ,ASGD_END_TMST                                    05270039
052800                                                                  05280038
052900           FROM  SUT_PNA_TRIP_ASGMT                               05290039
053000          WHERE  OPER_UNT_ID      = :DK-OPER-UNT-ID               05300039
053100            AND  ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR           05310039
053200     END-EXEC.                                                    05320099
053300                                                                  05330002
053400*    EXEC SQL                                                     05340099
053500*       DECLARE DOOR-TRIP-CSR-UNION CURSOR  FOR                   05350099
053600*        SELECT                                                   05360099
053700*                S109.DOOR_ID                                     05370099
053800*               ,999999999                                        05380099
053900*               ,:PC-DEFAULT-TMST                                 05390099
054000*               ,:PC-DEFAULT-TMST                                 05400099
054100*                                                                 05410099
054200*          FROM  SUT_PNA_STA_DOOR      S109                       05420099
054300*                                                                 05430099
054400*         WHERE  S109.OPER_UNT_ID      = :DK-OPER-UNT-ID          05440099
054500*           AND  S109.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR      05450099
054600*        UNION                                                    05460099
054700*           SELECT                                                05470099
054800*                S109.DOOR_ID                                     05480099
054900*               ,S110.INBD_TRIP_ID                                05490099
055000*               ,S110.ASGD_STRT_TMST                              05500099
055100*               ,S110.ASGD_END_TMST                               05510099
055200*                                                                 05520099
055300*          FROM  SUT_PNA_STA_DOOR      S109                       05530099
055400*               ,SUT_PNA_TRIP_ASGMT    S110                       05540099
055500*                                                                 05550099
055600*         WHERE  S109.OPER_UNT_ID      = :DK-OPER-UNT-ID          05560099
055700*           AND  S109.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR      05570099
055800*           AND  S109.OPER_UNT_ID     = S110.OPER_UNT_ID          05580099
055900*           AND  S109.ACM_LBL_STA_NBR = S110.ACM_LBL_STA_NBR      05590099
056000*           AND  S109.DOOR_ID         = S110.DOOR_ID              05600099
056100*           AND  DATE(S110.ASGD_STRT_TMST) >=                     05610099
056200*                                :DK-ASSIGN-FROM-DATE             05620099
056300*           AND  DATE(S110.ASGD_STRT_TMST)  <=                    05630099
056400*                                :DK-ASSIGN-TO-DATE               05640099
056500*    END-EXEC.                                                    05650099
056600                                                                  05660099
056700     EXEC SQL                                                     05670099
056800        DECLARE DOOR-TRIP-CSR-UNION CURSOR  FOR                   05680099
056900           SELECT  'A'                                            05690099
057000              ,     1                                             05700099
057100              ,S109.DOOR_ID                                       05710099
057200              ,999999999                                          05720099
057300              ,'9999-09-09-09.09.09.999999'                       05730099
057400              ,'9999-09-09-09.09.09.999999'                       05740099
057500                                                                  05750099
057600         FROM  SUT_PNA_STA_DOOR      S109                         05760099
057700        WHERE  S109.OPER_UNT_ID      = :DK-OPER-UNT-ID            05770099
057800          AND  S109.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR        05780099
057900            AND S109.DOOR_ID NOT IN                               05790099
058000        (SELECT S110.DOOR_ID                                      05800099
058100          FROM SUT_PNA_TRIP_ASGMT    S110                         05810099
058200        WHERE  S110.OPER_UNT_ID      = :DK-OPER-UNT-ID            05820099
058300         AND  S110.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR         05830099
058400         AND  S110.ASGD_END_TMST    = '9999-09-09-09.09.09.999999'05840099
058500        )                                                         05850099
058600        UNION                                                     05860099
058700           SELECT 'B'                                             05870099
058800              ,    1                                              05880099
058900              , S110.DOOR_ID                                      05890099
059000               ,S110.INBD_TRIP_ID                                 05900099
059100               ,S110.ASGD_STRT_TMST                               05910099
059200               ,S110.ASGD_END_TMST                                05920099
059300                                                                  05930099
059400          FROM  SUT_PNA_STA_DOOR      S109                        05940099
059500               ,SUT_PNA_TRIP_ASGMT    S110                        05950099
059600                                                                  05960099
059700        WHERE  S109.OPER_UNT_ID      = :DK-OPER-UNT-ID            05970099
059800          AND  S109.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR        05980099
059900          AND  S109.OPER_UNT_ID     = S110.OPER_UNT_ID            05990099
060000          AND  S109.ACM_LBL_STA_NBR = S110.ACM_LBL_STA_NBR        06000099
060100          AND  S109.DOOR_ID         = S110.DOOR_ID                06010099
060200          AND  S110.ASGD_END_TMST   = '9999-09-09-09.09.09.999999'06020099
060300          AND  DATE(S110.ASGD_STRT_TMST) >=                       06030099
060400                               :DK-ASSIGN-FROM-DATE               06040099
060500         AND  DATE(S110.ASGD_STRT_TMST)  <=                       06050099
060600                             :DK-ASSIGN-TO-DATE                   06060099
060700                                                                  06070099
060800        UNION                                                     06080099
060900           SELECT 'C'                                             06090099
061000              ,    9                                              06100099
061100              , S110.DOOR_ID                                      06110099
061200               ,S110.INBD_TRIP_ID                                 06120099
061300               ,S110.ASGD_STRT_TMST                               06130099
061400               ,S110.ASGD_END_TMST                                06140099
061500                                                                  06150099
061600          FROM  SUT_PNA_STA_DOOR      S109                        06160099
061700               ,SUT_PNA_TRIP_ASGMT    S110                        06170099
061800                                                                  06180099
061900         WHERE  S109.OPER_UNT_ID      = :DK-OPER-UNT-ID           06190099
062000          AND  S109.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR        06200099
062100          AND  S109.OPER_UNT_ID     = S110.OPER_UNT_ID            06210099
062200          AND  S109.ACM_LBL_STA_NBR = S110.ACM_LBL_STA_NBR        06220099
062300          AND  S109.DOOR_ID         = S110.DOOR_ID                06230099
062400          AND  S110.ASGD_END_TMST  <> '9999-09-09-09.09.09.999999'06240099
062500           AND  DATE(S110.ASGD_STRT_TMST) >=                      06250099
062600                                :DK-ASSIGN-FROM-DATE              06260099
062700         AND  DATE(S110.ASGD_STRT_TMST)  <=                       06270099
062800                             :DK-ASSIGN-TO-DATE                   06280099
062900      ORDER BY 2                                                  06290099
063000              ,3                                                  06300099
063100              ,6                                                  06310099
063200     END-EXEC.                                                    06320099
063300                                                                  06330099
063400     EXEC SQL                                                     06340099
063500        DECLARE DOOR-TRIP-CSR-LEFT CURSOR  FOR                    06350099
063600         SELECT                                                   06360099
063700                 S109.DOOR_ID                                     06370099
063800                ,S110.INBD_TRIP_ID                                06380099
063900                ,S110.ASGD_STRT_TMST                              06390099
064000                ,S110.ASGD_END_TMST                               06400099
064100                                                                  06410099
064200           FROM  SUT_PNA_STA_DOOR      S109                       06420099
064300           LEFT  OUTER JOIN                                       06430099
064400                 SUT_PNA_TRIP_ASGMT    S110                       06440099
064500             ON  S109.OPER_UNT_ID     = S110.OPER_UNT_ID          06450099
064600            AND  S109.ACM_LBL_STA_NBR = S110.ACM_LBL_STA_NBR      06460099
064700            AND  S109.DOOR_ID         = S110.DOOR_ID              06470099
064800            AND  DATE(S110.ASGD_STRT_TMST) >=                     06480099
064900                                 :DK-ASSIGN-FROM-DATE             06490099
065000            AND  DATE(S110.ASGD_END_TMST)  <=                     06500099
065100                                 :DK-ASSIGN-TO-DATE               06510099
065200                                                                  06520099
065300          WHERE  S109.OPER_UNT_ID      = :DK-OPER-UNT-ID          06530099
065400            AND  S109.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR      06540099
065500     END-EXEC.                                                    06550099
065700                                                                  06570099
065800*---------------------------------------------------------------* 06580099
065900*    DB2 AREA FOR COMMUNICATIONS                                * 06590099
066000*---------------------------------------------------------------* 06600099
066100     EXEC SQL                                                     06610099
066200          INCLUDE SQLCA                                           06620099
066300     END-EXEC.                                                    06630099
066400                                                                  06640099
066500***************************************************************** 06650099
066600 LINKAGE SECTION.                                                 06660099
066700                                                                  06670099
066800 01  DFHCOMMAREA.                                                 06680099
066900     05  FILLER                         OCCURS  1 TO 4072 TIMES   06690099
067000                                        DEPENDING ON EIBCALEN.    06700099
067100         10  FILLER                     PIC X.                    06710099
067200                                                                  06720099
067300                                                                  06730099
067400 PROCEDURE DIVISION.                                              06740099
067500******************************************************************06750099
067600**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06760002
067700**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06770002
067800**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06780002
067900******************************************************************06790002
068000 0000-MAIN-MODULE.                                                06800002
068100     INITIALIZE DP030-CICS-API-FIELDS.                            06810002
068200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06820002
068300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06830002
068400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06840002
068500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06850002
068600     MOVE LENGTH OF SUK794I        TO DP030-MAP-LENGTH (1).       06860002
068700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06870002
068800     PERFORM 0001-CALL-CICS-ARCH-API.                             06880002
068900*                                                                 06890002
069000     PERFORM 1000-CONTROL-PROCESSING                              06900002
069100*                                                                 06910002
069200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06920002
069300     PERFORM 0001-CALL-CICS-ARCH-API.                             06930002
069400                                                                  06940002
069500******************************************************************06950002
069600**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **06960002
069700**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **06970002
069800******************************************************************06980002
069900 0001-CALL-CICS-ARCH-API.                                         06990002
070000*    CALL 'DPKCS030' USING DFHEIBLK                               07000099
070000     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07001099
070100                           DFHCOMMAREA                            07010002
070200                           DP030-CICS-API-FIELDS                  07020002
070300                           DP020-STANDARD-COMMAREA                07030002
070400                           SUK794I.                               07040002
070500*                                                                 07050002
070600     IF  DP030-RC-CALL-SUCCESSFUL                                 07060002
070700         CONTINUE                                                 07070002
070800     ELSE                                                         07080002
070900         SET DP013-NO-ROLLBACK                                    07090002
071000             DP013-XCTL-DISPLAY-RESTART                           07100002
071100             DP013-CICS-ABEND      TO TRUE                        07110002
071200         MOVE '0001-CALL-CICS-ARCH-API'                           07120002
071300                                   TO DP013-PARAGRAPH             07130002
071400*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07140099
071500*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07150099
071400         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07151099
071500-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07152099
071600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07160002
071700         PERFORM DP013-0000-PROCESS-ABEND                         07170002
071800     END-IF.                                                      07180002
071900                                                                  07190002
072000*----------------------------------------------------------------*07200002
072100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07210002
072200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07220002
072300*                                                                *07230002
072400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07240002
072500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07250002
072600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07260002
072700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07270002
072800*----------------------------------------------------------------*07280002
072900 1000-CONTROL-PROCESSING.                                         07290002
073000     EVALUATE TRUE                                                07300002
073100         WHEN DP020-NEXT-ACT-INITIAL                              07310002
073200             INITIALIZE ASC-SPECIFIC-COMMAREA                     07320002
073300             MOVE EIBTRMID    TO ASC-LIST-TERM-ID                 07330002
073400                                 ASC-SEL-TERM-ID                  07340002
073500             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   07350002
073600                                           ASC-SEL-TASK-NUMBER    07360002
073700             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               07370002
073800             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                07380002
073900             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07390002
074000             MOVE ASC-DOOR-ID   (1 1)  TO  DK-DOOR-ID             07400002
074100             PERFORM 4000-BUILD-INITIAL-PANEL                     07410002
074200                                                                  07420002
074300         WHEN DP020-NEXT-ACT-READ-MAP                             07430002
074400             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07440002
074500             PERFORM 2000-PROCESS-PANEL                           07450002
074600                                                                  07460002
074700         WHEN DP020-NEXT-ACT-RETURN                               07470002
074800             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07480002
074900             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               07490002
075000             MOVE SPACES               TO  DK-DOOR-ID             07500002
075001*CT BEGIN 01/26/09 IR 12,063                                      07500199
075002             EVALUATE TRUE                                        07500299
075010                 WHEN SU087-UPD-DOOR                              07501099
075020                     PERFORM 2050-DELETE-LIST-QUEUE               07502099
075030                     PERFORM 4000-BUILD-INITIAL-PANEL             07503099
075031                     PERFORM 3200-RESET-ATTRIBUTES                07503199
075040                 WHEN OTHER                                       07504099
075100                     PERFORM 6000-REFRESH-PANEL-FROM-TEMP         07510099
075200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07520099
075201             END-EVALUATE                                         07520199
075210*CT END   01/26/09 IR 12,063                                      07521099
075300                                                                  07530002
075400         WHEN OTHER                                               07540002
075500             SET DP013-LOGIC-ABEND TO TRUE                        07550002
075600             SET DP013-NO-ROLLBACK TO TRUE                        07560002
075700             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    07570002
075800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07580002
075900                                   TO DP013-MESSAGE-TEXT(1)       07590002
076000             PERFORM DP013-0000-PROCESS-ABEND                     07600002
076100     END-EVALUATE.                                                07610002
076200                                                                  07620002
076300*----------------------------------------------------------------*07630002
076400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07640002
076500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07650002
076600*----------------------------------------------------------------*07660002
076700 1100-PROCESS-INTER-APPL-COMM.                                    07670002
076800                                                                  07680002
076900     SET PS-COMMAREA-VALID         TO TRUE.                       07690002
077000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07700002
077010     MOVE DP020-INT-APPL-FORMAT-IND                               07701099
077020                                   TO ASC-INT-APPL-FORMAT-IND.    07702099
077021*CT BEGIN 1/16/09                                                 07702199
077030     MOVE DP020-USERID TO ASC-USR-ID.                             07703099
077040*CT END   1/16/09                                                 07704099
077100                                                                  07710002
077200     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07720002
077300         MOVE SU087-OPER-UNT-ID        TO ASC-OPER-UNT-ID         07730009
077400         MOVE SU087-FCLTY-NME          TO ASC-FCLTY-NAME          07740009
077500         MOVE SU087-PNA-STA-NBR        TO ASC-PNA-STA-NBR         07750057
077600         MOVE SU087-ASSIGN-FROM-DATE    TO                        07760099
077700                           ASC-ASSIGN-FROM-DATE                   07770099
077800         MOVE SU087-ASSIGN-TO-DATE    TO                          07780099
077900                           ASC-ASSIGN-TO-DATE                     07790099
078000     ELSE                                                         07800002
078100         IF SU089-NUMBER-OF-SELECTED-ITEMS > 0                    07810070
078200            SET  ASC-USE-SELECTION-QUEUE TO TRUE                  07820099
078300            MOVE SU089-NUMBER-OF-SELECTED-ITEMS                   07830070
078400                               TO ASC-NUMBER-OF-SELECTED-ITEMS    07840070
078500            MOVE SU089-NUMBER-OF-TS-ITEMS                         07850070
078600                               TO ASC-NUMBER-OF-TS-ITEMS          07860070
078700            MOVE SU089-SEL-QUEUE-NAME                             07870070
078800                                   TO ASC-SEL-QUEUE-NAME-IN       07880099
078900            MOVE SU089-OPER-UNT-ID        TO ASC-OPER-UNT-ID      07890070
079000            MOVE SU089-FCLTY-NME          TO ASC-FCLTY-NAME       07900070
079100            MOVE SU089-ASSIGN-FROM-DATE    TO                     07910099
079200                              ASC-ASSIGN-FROM-DATE                07920099
079300            MOVE SU089-ASSIGN-TO-DATE    TO                       07930099
079400                              ASC-ASSIGN-TO-DATE                  07940099
079500            PERFORM 1120-PREPARE-LIST-ENTRY                       07950070
079600                                                                  07960099
079700         END-IF                                                   07970070
079800     END-IF.                                                      07980070
079900                                                                  07990068
080000                                                                  08000068
080100*----------------------------------------------------------------*08010068
080200* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *08020068
080300* STORAGE QUEUE PASSED FROM THE LIST.                            *08030068
080400*----------------------------------------------------------------*08040068
080500 1120-PREPARE-LIST-ENTRY.                                         08050068
080600     MOVE SU088-MAX-ITEMS          TO ASC-SEL-SUB.                08060068
080700     MOVE ZERO                     TO ASC-SEL-ITEM.               08070068
080800     PERFORM 1130-GET-NEXT-RECORD.                                08080068
080900                                                                  08090068
081000*---------------------------------------------------------------- 08100068
081100*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08110068
081200*---------------------------------------------------------------- 08120068
081300 1130-GET-NEXT-RECORD.                                            08130068
081400     ADD +1                        TO ASC-SEL-SUB.                08140068
081500                                                                  08150068
081600     SET ASC-UPDATE-TSQ TO TRUE.                                  08160068
081700                                                                  08170068
081800     IF  ASC-SEL-SUB > SU088-MAX-ITEMS                            08180068
081900         ADD +1                    TO ASC-SEL-ITEM                08190068
082000         MOVE +1                   TO ASC-SEL-SUB                 08200068
082100     END-IF.                                                      08210068
082200                                                                  08220068
082300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08230068
082400         PERFORM 9100-READ-SEL-QUEUE                              08240068
082500         IF  SU088-ITEM (ASC-SEL-SUB) > ZERO                      08250068
082600             PERFORM 1160-MOVE-TO-ASC                             08260068
082700             SET SU088-INQ (ASC-SEL-SUB) TO TRUE                  08270068
082800             PERFORM 9200-REWRITE-SEL-QUEUE                       08280068
082900         ELSE                                                     08290068
083000             SUBTRACT +1 FROM ASC-SEL-SUB                         08300068
083100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            08310068
083200             SET DP020-MSG-INFORMATIONAL                          08320068
083300                 PS-LIST-END       TO TRUE                        08330068
083400         END-IF                                                   08340068
083500     ELSE                                                         08350068
083600         SUBTRACT +1 FROM ASC-SEL-ITEM                            08360068
083700         MOVE SU088-MAX-ITEMS      TO ASC-SEL-SUB                 08370068
083800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            08380068
083900         SET DP020-MSG-INFORMATIONAL                              08390068
084000                 PS-LIST-END       TO TRUE                        08400068
084100     END-IF.                                                      08410068
084200                                                                  08420068
084300******************************************************************08430068
084400*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         08440068
084500*  PROCESSED.                                                     08450068
084600******************************************************************08460068
084700 1140-GET-PREV-RECORD.                                            08470068
084800     SUBTRACT +1 FROM ASC-SEL-SUB.                                08480068
084900                                                                  08490068
085000     IF  ASC-SEL-SUB < +1                                         08500068
085100         SUBTRACT +1 FROM ASC-SEL-ITEM                            08510068
085200         MOVE SU088-MAX-ITEMS      TO ASC-SEL-SUB                 08520068
085300     END-IF.                                                      08530068
085400                                                                  08540068
085500     IF  ASC-SEL-ITEM > ZERO                                      08550068
085600         PERFORM 9100-READ-SEL-QUEUE                              08560068
085700         IF  SU088-ITEM (ASC-SEL-SUB) > ZERO                      08570068
085800             PERFORM 1160-MOVE-TO-ASC                             08580068
085900         END-IF                                                   08590068
086000                                                                  08600068
086100         SET SU088-INQ (ASC-SEL-SUB) TO TRUE                      08610068
086200         PERFORM 9200-REWRITE-SEL-QUEUE                           08620068
086300     ELSE                                                         08630068
086400         MOVE +1                   TO ASC-SEL-ITEM                08640068
086500                                      ASC-SEL-SUB                 08650068
086600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            08660068
086700         SET DP020-MSG-INFORMATIONAL                              08670068
086800             PS-LIST-END             TO TRUE                      08680068
086900     END-IF.                                                      08690068
087000                                                                  08700068
087100 1160-MOVE-TO-ASC.                                                08710068
087200                                                                  08720068
087300     MOVE SU088-PNA-STA-NBR (ASC-SEL-SUB)  TO ASC-PNA-STA-NBR.    08730069
087400                                                                  08740099
087500     MOVE SU088-ASSIGN-TMST      (ASC-SEL-SUB)  TO                08750099
087600                                  ASC-ASSIGN-TMST-HDR.            08760099
087700                                                                  08770099
088400                                                                  08840002
088500*----------------------------------------------------------------*08850002
088600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08860002
088700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08870002
088800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08880002
088900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08890002
089000* FUNCTION KEYS CAN GET THIS FAR.                                *08900002
089100*----------------------------------------------------------------*08910002
089200 2000-PROCESS-PANEL.                                              08920002
089300     EVALUATE TRUE                                                08930002
089400         WHEN DP020-SRC-AID = DP016-CLEAR                         08940002
089500             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                08950002
089600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08960002
089700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08970002
089800                                                                  08980002
089900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08990002
090000             PERFORM 2050-DELETE-LIST-QUEUE                       09000002
090100             PERFORM 4000-BUILD-INITIAL-PANEL                     09010002
090200                                                                  09020002
090300         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   09030002
090400             PERFORM 2140-DESELECT-ALL-ITEMS                      09040002
090500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09050002
090600                                                                  09060002
090700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09070002
090800             PERFORM 2150-SELECT-ALL-ITEMS                        09080002
090900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09090002
091000                                                                  09100073
091100*F20-NEXT SEL                                                     09110073
091200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09120073
091300**??   17794 MOVE DP020-INT-APPL-FORMAT-IND                       09130099
091400**??                                  TO ASC-INT-APPL-FORMAT-IND  09140099
091500             IF ASC-INT-APPL-FORMAT-IND = '2'                     09150073
091600               IF  ASC-USE-SELECTION-QUEUE                        09160073
091700                   PERFORM 1130-GET-NEXT-RECORD                   09170073
091710**??   17794 IR                                                   09171099
091800**??               PERFORM 3000-EDIT-DATA-IN-COMMAREA             09180099
091900                   IF PS-LIST-END                                 09190073
092000                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       09200073
092100                       SET PS-NO-LIST-END TO TRUE                 09210073
092200                   ELSE                                           09220073
092400                       PERFORM 2050-DELETE-LIST-QUEUE             09240099
092500                       PERFORM 3200-RESET-ATTRIBUTES              09250099
092600                       PERFORM 4000-BUILD-INITIAL-PANEL           09260073
092700**??   17794 IR        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       09270099
092800                   END-IF                                         09280073
092900               ELSE                                               09290073
093000*                --- BOTTOM OF LIST ---                           09300073
093100                   MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER       09310073
093200                   SET DP020-MSG-INFORMATIONAL TO TRUE            09320073
093300               END-IF                                             09330073
093400           ELSE                                                   09340073
093500               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           09350073
093600               SET DP020-MSG-FATAL TO TRUE                        09360073
093700           END-IF                                                 09370073
093800                                                                  09380073
093900*F19-PREV SEL                                                     09390073
094000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09400073
094100**??  17794  MOVE DP020-INT-APPL-FORMAT-IND                       09410099
094200**??                                  TO ASC-INT-APPL-FORMAT-IND  09420099
094300             IF ASC-INT-APPL-FORMAT-IND = '2'                     09430073
094400                IF  ASC-USE-SELECTION-QUEUE                       09440073
094500                   PERFORM 1140-GET-PREV-RECORD                   09450073
094510**??   17794 IR                                                   09451099
094600**??               PERFORM 3000-EDIT-DATA-IN-COMMAREA             09460099
094700                   IF PS-LIST-END                                 09470073
094800                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       09480073
094900                       SET PS-NO-LIST-END TO TRUE                 09490073
095000                   ELSE                                           09500073
095200                       PERFORM 2050-DELETE-LIST-QUEUE             09520099
095300                       PERFORM 3200-RESET-ATTRIBUTES              09530099
095400                       PERFORM 4000-BUILD-INITIAL-PANEL           09540073
095500**??  17794  IR        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       09550099
095600                   END-IF                                         09560073
095700               ELSE                                               09570073
095800                   MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER       09580073
095900                   SET DP020-MSG-INFORMATIONAL TO TRUE            09590073
096000               END-IF                                             09600073
096100           ELSE                                                   09610073
096200               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           09620073
096300               SET DP020-MSG-FATAL TO TRUE                        09630073
096400           END-IF                                                 09640073
096500                                                                  09650073
096600                                                                  09660007
096700         WHEN OTHER                                               09670002
096800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09680002
096900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09690002
097000             IF  PS-NO-ERROR                                      09700002
097100                 SET DP030-CONTINUE-GO TO TRUE                    09710002
097200                 PERFORM 2100-CHECK-FUNCTION-KEY                  09720002
097300             ELSE                                                 09730002
097400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09740002
097500                 SET DP030-OVERRIDE-GO TO TRUE                    09750002
097600             END-IF                                               09760002
097700     END-EVALUATE.                                                09770002
097800                                                                  09780002
097900*----------------------------------------------------------------*09790002
098000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09800002
098100*----------------------------------------------------------------*09810002
098200 2050-DELETE-LIST-QUEUE.                                          09820002
098300                                                                  09830002
098400     EXEC CICS                                                    09840002
098500         DELETEQ TS                                               09850002
098600             QUEUE (ASC-LIST-QUEUE-NAME)                          09860002
098700             RESP  (PV-CICS-RESP)                                 09870002
098800     END-EXEC.                                                    09880002
098900                                                                  09890002
099000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09900002
099100        (PV-CICS-RESP = DFHRESP(QIDERR))                          09910002
099200         CONTINUE                                                 09920002
099300     ELSE                                                         09930002
099400         SET DP013-CICS-ABEND      TO TRUE                        09940002
099500         SET DP013-NO-ROLLBACK     TO TRUE                        09950002
099600                                                                  09960002
099700         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         09970002
099800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09980002
099900                                   TO DP013-MESSAGE-TEXT (1)      09990002
100000         PERFORM DP013-0000-PROCESS-ABEND                         10000002
100100     END-IF.                                                      10010002
100200                                                                  10020002
100300     MOVE +0  TO ASC-HIGHEST-BLOCK-WRITTEN.                       10030002
100400                                                                  10040002
100500*----------------------------------------------------------------*10050002
100600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10060002
100700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10070002
100800* CICS ARCHITECTURE API.                                         *10080002
100900*----------------------------------------------------------------*10090002
101000 2100-CHECK-FUNCTION-KEY.                                         10100002
101100                                                                  10110002
101200     EVALUATE TRUE                                                10120002
101300                                                                  10130013
101400* F15 -  INQ/UPD (LOCAL-FUNC-01) SUKCS796 - DETAIL                10140015
101500*                PRINT AND APPLY ASSIGN / LOGIN                   10150015
101600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10160015
101700             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            10170002
101800**??         IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                  10180099
101900                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              10190002
102000                     SET ASC-USE-SELECTION-QUEUE TO TRUE          10200002
102100                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            10210002
102200                                TO SU089-NUMBER-OF-SELECTED-ITEMS 10220015
102300                     MOVE ASC-NUMBER-OF-TS-ITEMS                  10230002
102400                                      TO SU089-NUMBER-OF-TS-ITEMS 10240015
102500                     MOVE ASC-SEL-QUEUE-NAME                      10250002
102600                                         TO  SU089-SEL-QUEUE-NAME 10260015
102700                     MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID    10270002
102800                     MOVE ASC-OPER-UNT-ID  TO SU089-OPER-UNT-ID   10280015
102900                     MOVE 1                TO SU089-FCLTY-ID      10290018
103000                     MOVE ASC-FCLTY-NAME   TO SU089-FCLTY-NME     10300065
103100                     MOVE ASC-PNA-STA-NBR  TO SU089-PNA-STA-NBR   10310065
103200                     SET SU089-UPD-DOOR  TO TRUE                  10320015
103300                     PERFORM 5000-PREPARE-SEL-QUEUE               10330002
103400                 ELSE                                             10340002
103500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10350002
103600                     SET DP030-OVERRIDE-GO TO TRUE                10360002
103700                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    10370002
103800                     SET DP020-MSG-FATAL   TO TRUE                10380002
103900                 END-IF                                           10390002
104000**??                                                              10400099
104010**??         ELSE                                                 10401099
104100**??             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10410099
104200**??             SET DP030-OVERRIDE-GO TO TRUE                    10420099
104300**??             MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        10430099
104400**??             SET PS-ERROR                                     10440099
104500**??                 DP020-MSG-FATAL   TO TRUE                    10450099
104600**??         END-IF                                               10460099
104700                                                                  10470015
104800                                                                  10480076
104900* F17 -  INQ/UPD (LOCAL-FUNC-02) SUKCS797 - LIST                  10490076
105000*                PRINT AND APPLY TK LIST                          10500076
105100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10510076
105200             MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID            10520076
105300             IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                  10530076
105400                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              10540076
105500                     SET ASC-USE-SELECTION-QUEUE TO TRUE          10550076
105600                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            10560076
105700                                TO SU089-NUMBER-OF-SELECTED-ITEMS 10570076
105800                     MOVE ASC-NUMBER-OF-TS-ITEMS                  10580076
105900                                      TO SU089-NUMBER-OF-TS-ITEMS 10590076
106000                     MOVE ASC-SEL-QUEUE-NAME                      10600076
106100                                         TO  SU089-SEL-QUEUE-NAME 10610076
106200                     MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID    10620076
106300                     MOVE ASC-OPER-UNT-ID  TO SU089-OPER-UNT-ID   10630076
106400                     MOVE 1                TO SU089-FCLTY-ID      10640076
106500                     MOVE ASC-FCLTY-NAME   TO SU089-FCLTY-NME     10650076
106600                     MOVE ASC-PNA-STA-NBR  TO SU089-PNA-STA-NBR   10660076
106700                     SET SU089-UPD-DOOR  TO TRUE                  10670076
106800                     PERFORM 5000-PREPARE-SEL-QUEUE               10680076
106900                 ELSE                                             10690076
107000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10700076
107100                     SET DP030-OVERRIDE-GO TO TRUE                10710076
107200                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    10720076
107300                     SET DP020-MSG-FATAL   TO TRUE                10730076
107400                 END-IF                                           10740076
107500             ELSE                                                 10750076
107600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10760076
107700                 SET DP030-OVERRIDE-GO TO TRUE                    10770076
107800                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        10780076
107900                 SET PS-ERROR                                     10790076
108000                     DP020-MSG-FATAL   TO TRUE                    10800076
108100             END-IF                                               10810076
108200                                                                  10820002
108300* F22 -  UNASSIGN (LOCAL-FUNC-03)                                 10830013
108400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              10840013
108410            MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID             10841099
108420            IF ASC-OPER-UNT-ID = DK-OPER-UNT-ID                   10842099
108500               IF ASC-NUMBER-OF-SELECTED-ITEMS > 0                10850099
108600                  PERFORM 2400-EDIT-FOR-UPDATE                    10860099
108700                          VARYING PV-ITEM FROM 1 BY 1             10870099
108800                            UNTIL PV-ITEM >                       10880099
108900                                     ASC-HIGHEST-BLOCK-WRITTEN    10890099
109000                               OR PS-ERROR                        10900099
109100                                                                  10910099
109200                  IF PS-NO-ERROR                                  10920099
109210*CT BEGIN 01/27/09 IR 12,063                                      10921099
109220                     PERFORM 2050-DELETE-LIST-QUEUE               10922099
109230                     PERFORM 4000-BUILD-INITIAL-PANEL             10923099
109240                     PERFORM 3200-RESET-ATTRIBUTES                10924099
109300                     MOVE PC-TSYMSG-03628  TO DP020-MSG-NUMBER    10930099
109400                     SET DP030-OVERRIDE-GO TO TRUE                10940099
109500                     SET DP020-MSG-WARNING TO TRUE                10950099
109600*                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10960099
109610*CT END   01/27/09 IR 12,063                                      10961099
109700                  END-IF                                          10970099
109800               ELSE                                               10980099
109900                  SET DP030-OVERRIDE-GO TO TRUE                   10990099
110000                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       11000099
110100                  SET DP020-MSG-WARNING TO TRUE                   11010099
110200               END-IF                                             11020099
110201            ELSE                                                  11020199
110202               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               11020299
110203               SET DP030-OVERRIDE-GO TO TRUE                      11020399
110204               MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER          11020499
110205               SET PS-ERROR                                       11020599
110206                   DP020-MSG-FATAL   TO TRUE                      11020699
110210            END-IF                                                11021099
110300                                                                  11030092
110400* F6 - FIRST PAGE                                                 11040092
110500         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 11050092
110600             MOVE +1               TO PV-TOP-ITEM                 11060092
110700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11070092
110800                                                                  11080092
110900* F7 - PREVIOUS PAGE                                              11090092
111000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11100092
111100             PERFORM 2110-BROWSE-BACKWARD                         11110002
111200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11120002
111300                                                                  11130002
111400* F8 - NEXT PAGE                                                  11140002
111500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11150002
111600             PERFORM 2120-BROWSE-FORWARD                          11160002
111700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11170002
111800                                                                  11180002
111900* ENTER KEY                                                       11190002
112000         WHEN DP020-SRC-AID = DP016-ENTER                         11200002
112100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11210002
112200             IF  PS-ERROR                                         11220002
112300                 CONTINUE                                         11230002
112400             ELSE                                                 11240002
112500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11250002
112600             END-IF                                               11260002
112700                                                                  11270002
112800         WHEN OTHER                                               11280002
112900             SET DP013-NO-ROLLBACK                                11290002
113000                 DP013-XCTL-DISPLAY-RESTART                       11300002
113100                 DP013-CICS-ABEND  TO TRUE                        11310002
113200             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    11320002
113300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11330002
113400                                   TO DP013-MESSAGE-TEXT (1)      11340002
113500             PERFORM DP013-0000-PROCESS-ABEND                     11350002
113600     END-EVALUATE.                                                11360002
113700                                                                  11370002
113800******************************************************************11380002
113900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **11390002
114000** INTER-APPLICATION COMMAREA.                                  **11400002
114100******************************************************************11410002
114200 2110-PREPARE-INTER-APPL-COMM.                                    11420002
114300                                                                  11430002
114400     INITIALIZE SU087-INTER-APPL-COMMAREA.                        11440009
114500                                                                  11450002
114600     MOVE DP020-LOCATION-NBR       TO DK-OPER-UNT-ID.             11460002
114700     MOVE ASC-OPER-UNT-ID          TO SU087-OPER-UNT-ID.          11470009
114800     MOVE ASC-FCLTY-NAME           TO SU087-FCLTY-NME.            11480058
114900     MOVE ASC-PNA-STA-NBR          TO SU087-PNA-STA-NBR.          11490057
115000                                                                  11500002
115100*----------------------------------------------------------------*11510002
115200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11520002
115300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11530002
115400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11540002
115500*    MESSAGE.                                                    *11550002
115600*----------------------------------------------------------------*11560002
115700 2110-BROWSE-BACKWARD.                                            11570002
115800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11580002
115900         GIVING PV-TOP-ITEM.                                      11590002
116000*                                                                 11600002
116100     IF  ((PV-TOP-ITEM < +1)                                      11610002
116200       OR (PV-TOP-ITEM = +1))                                     11620002
116300         MOVE +1                   TO PV-TOP-ITEM                 11630002
116400*        -- TOP OF LIST --                                        11640002
116500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11650002
116600         SET DP020-MSG-INFORMATIONAL TO TRUE                      11660002
116700     END-IF.                                                      11670002
116800                                                                  11680002
116900*----------------------------------------------------------------*11690002
117000*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11700002
117100*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11710002
117200*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11720002
117300*----------------------------------------------------------------*11730002
117400 2120-BROWSE-FORWARD.                                             11740002
117500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11750002
117600         GIVING PV-TOP-ITEM.                                      11760002
117700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11770002
117800         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11780002
117900*        -- BOTTOM OF LIST --                                     11790002
118000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11800002
118100         SET DP020-MSG-INFORMATIONAL TO TRUE                      11810002
118200     ELSE                                                         11820002
118300         COMPUTE PV-BOTTOM-ITEM =                                 11830002
118400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11840002
118500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11850002
118600*            -- BOTTOM OF LIST --                                 11860002
118700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11870002
118800             SET DP020-MSG-INFORMATIONAL TO TRUE                  11880002
118900         END-IF                                                   11890002
119000     END-IF.                                                      11900002
119100                                                                  11910002
119200*----------------------------------------------------------------*11920002
119300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11930002
119400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11940002
119500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11950002
119600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11960002
119700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11970002
119800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11980002
119900*----------------------------------------------------------------*11990002
120000 2130-CHECK-FOR-JUMP-BROWSE.                                      12000002
120100     SET PS-NO-ERROR               TO TRUE.                       12010002
120200     IF (ASC-START-ITEM-REQUEST = SPACE)                          12020002
120300         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12030002
120400     ELSE                                                         12040002
120500         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     12050002
120600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12060002
120700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12070002
120800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12080002
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12091099
263968              USING DP010I-NUMERIC-EDIT-AREA                      12092099
121000                                                                  12100002
121100         IF  NOT DP010I-ERROR-DETECTED                            12110002
121200             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N12120002
121300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12130002
121400                 IF  ASC-START-ITEM-REQUEST-N >                   12140002
121500                                          ASC-NUMBER-OF-ITEMS-READ12150002
121600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12160002
121700                     COMPUTE PV-TOP-ITEM =                        12170002
121800                             ASC-NUMBER-OF-ITEMS-READ             12180002
121900                             - PC-ITEMS-PER-PANEL + 1             12190002
122000                     IF  PV-TOP-ITEM < +1                         12200002
122100                         MOVE +1   TO PV-TOP-ITEM                 12210002
122200                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 12220002
122300                         SET DP020-MSG-INFORMATIONAL TO TRUE      12230002
122400                     END-IF                                       12240002
122500                 ELSE                                             12250002
122600                     MOVE ASC-START-ITEM-REQUEST-N                12260002
122700                                   TO PV-TOP-ITEM                 12270002
122800                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12280002
122900                     COMPUTE PV-BOTTOM-ITEM =                     12290002
123000                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12300002
123100                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12310002
123200*                        -- BOTTOM OF LIST --                     12320002
123300                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 12330002
123400                         SET DP020-MSG-INFORMATIONAL TO TRUE      12340002
123500                     END-IF                                       12350002
123600                 END-IF                                           12360002
123700             ELSE                                                 12370002
123800*                --- VALUE OUT OF RANGE ----                      12380002
123900                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         12390002
124000                 MOVE -1              TO ASTRTITL                 12400002
124100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12410002
124200                 MOVE DP015-REVERSE   TO ASTRTITH                 12420027
124300                 MOVE DP015-RED       TO ASTRTITC                 12430002
124400                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           12440002
124500                 SET DP020-MSG-FATAL  TO TRUE                     12450002
124600                 SET PS-ERROR         TO TRUE                     12460002
124700             END-IF                                               12470002
124800         ELSE                                                     12480002
124900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12490002
125000             MOVE -1               TO ASTRTITL                    12500002
125100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12510002
125200             MOVE DP015-REVERSE    TO ASTRTITH                    12520002
125300             MOVE DP015-RED        TO ASTRTITC                    12530002
125400             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               12540002
125500             SET DP020-MSG-FATAL   TO TRUE                        12550002
125600             SET PS-ERROR          TO TRUE                        12560002
125700         END-IF                                                   12570002
125800     END-IF.                                                      12580002
125900                                                                  12590002
126000*----------------------------------------------------------------*12600002
126100*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12610002
126200*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12620002
126300*----------------------------------------------------------------*12630002
126400 2140-DESELECT-ALL-ITEMS.                                         12640002
126500     MOVE +1                       TO ASC-BLK-SUB.                12650002
126600                                                                  12660002
126700     PERFORM 2141-CLEAR-SELECTED-INDS                             12670002
126800         VARYING ASC-ITEM-SUB                                     12680002
126900         FROM 1 BY 1                                              12690002
127000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12700002
127100                                                                  12710002
127200     ADD +1                        TO ASC-BLK-SUB.                12720002
127300                                                                  12730002
127400     PERFORM 2141-CLEAR-SELECTED-INDS                             12740002
127500         VARYING ASC-ITEM-SUB                                     12750002
127600         FROM 1 BY 1                                              12760002
127700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12770002
127800                                                                  12780002
127900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12790002
128000                                   TO PV-LIST-ITEM-NUMBER.        12800002
128100                                                                  12810002
128200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12820002
128300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12830002
128400                                                                  12840002
128500     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            12850002
128600         MOVE +1                   TO ASC-BLK-SUB                 12860002
128700                                                                  12870002
128800         PERFORM 5100-WRITE-TEMP-STORAGE                          12880002
128900         MOVE +2                   TO ASC-BLK-SUB                 12890002
129000         PERFORM 5100-WRITE-TEMP-STORAGE                          12900002
129100         MOVE +1                   TO ASC-BLK-SUB                 12910002
129200         MOVE +1                   TO PV-BLOCK-NUMBER             12920002
129300     END-IF.                                                      12930002
129400                                                                  12940002
129500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12950002
129600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12960002
129700         MOVE +1                   TO ASC-BLK-SUB                 12970002
129800                                                                  12980002
129900         PERFORM 5100-WRITE-TEMP-STORAGE                          12990002
130000         MOVE +2  TO ASC-BLK-SUB                                  13000002
130100         PERFORM 5100-WRITE-TEMP-STORAGE                          13010002
130200         MOVE +1  TO ASC-BLK-SUB                                  13020002
130300         MOVE +1  TO PV-BLOCK-NUMBER                              13030002
130400                                                                  13040002
130500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13050002
130600             PV-FIRST-BLOCK-IN-ARRAY - 1                          13060002
130700                                                                  13070002
130800         PERFORM                                                  13080002
130900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13090002
131000                                                                  13100002
131100             PERFORM 4410-READ-TEMP-STORAGE                       13110002
131200                                                                  13120002
131300             PERFORM 2141-CLEAR-SELECTED-INDS                     13130002
131400                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13140002
131500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13150002
131600                                                                  13160002
131700             PERFORM 5100-WRITE-TEMP-STORAGE                      13170002
131800                                                                  13180002
131900             ADD +1                TO PV-BLOCK-NUMBER             13190002
132000                                                                  13200002
132100         END-PERFORM                                              13210002
132200                                                                  13220002
132300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13230002
132400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13240002
132500                                                                  13250002
132600         PERFORM                                                  13260002
132700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13270002
132800                   ASC-HIGHEST-BLOCK-WRITTEN                      13280002
132900                                                                  13290002
133000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13300002
133100                                   TO PV-BLOCK-NUMBER             13310002
133200                                                                  13320002
133300             PERFORM 4410-READ-TEMP-STORAGE                       13330002
133400                                                                  13340002
133500             PERFORM 2141-CLEAR-SELECTED-INDS                     13350002
133600                 VARYING ASC-ITEM-SUB                             13360002
133700                 FROM 1 BY 1                                      13370002
133800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13380002
133900                                                                  13390002
134000             PERFORM 5100-WRITE-TEMP-STORAGE                      13400002
134100                                                                  13410002
134200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13420002
134300                                                                  13430002
134400         END-PERFORM                                              13440002
134500                                                                  13450002
134600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13460002
134700                                   TO PV-BLOCK-NUMBER             13470002
134800                                                                  13480002
134900         PERFORM 4410-READ-TEMP-STORAGE                           13490002
135000     END-IF.                                                      13500002
135100                                                                  13510002
135200     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 13520002
135300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.13530002
135400     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  13540002
135500                                                                  13550002
135600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13560002
135700                                                                  13570002
135800*----------------------------------------------------------------*13580002
135900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13590002
136000*----------------------------------------------------------------*13600002
136100 2141-CLEAR-SELECTED-INDS.                                        13610002
136200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13620002
136300             NOT EQUAL ZERO                                       13630002
136400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13640002
136500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13650002
136600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13660002
136700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          13670002
136800         END-IF                                                   13680002
136900     END-IF.                                                      13690002
137000                                                                  13700002
137100*----------------------------------------------------------------*13710002
137200*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *13720002
137300*  FOR ALL ITEMS.                                                *13730002
137400*----------------------------------------------------------------*13740002
137500 2150-SELECT-ALL-ITEMS.                                           13750002
137600     MOVE +1                       TO ASC-BLK-SUB.                13760002
137700                                                                  13770002
137800     PERFORM 2151-SET-SELECTED-INDS                               13780002
137900         VARYING ASC-ITEM-SUB                                     13790002
138000         FROM 1 BY 1                                              13800002
138100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13810002
138200                                                                  13820002
138300     ADD +1                        TO ASC-BLK-SUB.                13830002
138400                                                                  13840002
138500     PERFORM 2151-SET-SELECTED-INDS                               13850002
138600         VARYING ASC-ITEM-SUB                                     13860002
138700         FROM 1 BY 1                                              13870002
138800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13880002
138900                                                                  13890002
139000     MOVE ASC-LIST-ITEM-NUMBER(1 1)  TO PV-LIST-ITEM-NUMBER.      13900002
139100                                                                  13910002
139200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13920002
139300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13930002
139400                                                                  13940002
139500     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            13950002
139600         MOVE +1                   TO ASC-BLK-SUB                 13960002
139700                                                                  13970002
139800         PERFORM 5100-WRITE-TEMP-STORAGE                          13980002
139900         MOVE +2                   TO ASC-BLK-SUB                 13990002
140000         PERFORM 5100-WRITE-TEMP-STORAGE                          14000002
140100         MOVE +1                   TO ASC-BLK-SUB                 14010002
140200         MOVE +1                   TO PV-BLOCK-NUMBER             14020002
140300     END-IF.                                                      14030002
140400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14040002
140500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14050002
140600         MOVE +1                   TO ASC-BLK-SUB                 14060002
140700                                                                  14070002
140800         PERFORM 5100-WRITE-TEMP-STORAGE                          14080002
140900                                                                  14090002
141000         MOVE +1                   TO PV-BLOCK-NUMBER             14100002
141100                                                                  14110002
141200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14120002
141300             PV-FIRST-BLOCK-IN-ARRAY - 1                          14130002
141400                                                                  14140002
141500         PERFORM                                                  14150002
141600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14160002
141700                                                                  14170002
141800             PERFORM 4410-READ-TEMP-STORAGE                       14180002
141900                                                                  14190002
142000             PERFORM 2151-SET-SELECTED-INDS                       14200002
142100                 VARYING ASC-ITEM-SUB                             14210002
142200                 FROM 1 BY 1                                      14220002
142300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14230002
142400                                                                  14240002
142500             PERFORM 5100-WRITE-TEMP-STORAGE                      14250002
142600                                                                  14260002
142700             ADD +1                TO PV-BLOCK-NUMBER             14270002
142800                                                                  14280002
142900         END-PERFORM                                              14290002
143000                                                                  14300002
143100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14310002
143200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14320002
143300                                                                  14330002
143400         PERFORM                                                  14340002
143500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14350002
143600                   ASC-HIGHEST-BLOCK-WRITTEN                      14360002
143700                                                                  14370002
143800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14380002
143900                                   TO PV-BLOCK-NUMBER             14390002
144000                                                                  14400002
144100             PERFORM 4410-READ-TEMP-STORAGE                       14410002
144200                                                                  14420002
144300             PERFORM 2151-SET-SELECTED-INDS                       14430002
144400                 VARYING ASC-ITEM-SUB                             14440002
144500                 FROM 1 BY 1                                      14450002
144600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14460002
144700                                                                  14470002
144800             PERFORM 5100-WRITE-TEMP-STORAGE                      14480002
144900                                                                  14490002
145000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14500002
145100                                                                  14510002
145200         END-PERFORM                                              14520002
145300                                                                  14530002
145400         MOVE PV-FIRST-BLOCK-IN-ARRAY  TO PV-BLOCK-NUMBER         14540002
145500                                                                  14550002
145600         PERFORM 4410-READ-TEMP-STORAGE                           14560002
145700     END-IF.                                                      14570002
145800                                                                  14580002
145900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14590002
146000                       ASC-NUMBER-OF-SELECTED-ITEMS.              14600002
146100                                                                  14610002
146200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14620002
146300                                                                  14630002
146400*----------------------------------------------------------------*14640002
146500*    MARK EACH ITEM AS BEING SELECTED.                           *14650002
146600*----------------------------------------------------------------*14660002
146700 2151-SET-SELECTED-INDS.                                          14670002
146800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14680002
146900             NOT EQUAL ZERO                                       14690002
147000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14700002
147100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14710002
147200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14720002
147300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14730002
147400                               TO  TRUE                           14740002
147500         END-IF                                                   14750002
147600     END-IF.                                                      14760002
147700                                                                  14770002
147800******************************************************************14780002
147900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **14790002
148000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **14800002
148100******************************************************************14810002
148200 2200-MOVE-SCREEN-TO-COMMAREA.                                    14820002
148300                                                                  14830002
148400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14840002
148500     MOVE +1                       TO PV-SUB.                     14850002
148600*                                                                 14860002
148700     PERFORM 3100-SET-SUBSCRIPTS.                                 14870002
148800                                                                  14880002
148900     IF  ASTRTITL > ZERO                                          14890002
149000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14900002
149100     ELSE                                                         14910002
149200         IF  ASTRTITF = DP015-ERASE-EOF                           14920002
149300             INITIALIZE ASC-START-ITEM-REQUEST                    14930002
149400         END-IF                                                   14940002
149500     END-IF.                                                      14950002
149600                                                                  14960002
149700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14970002
149800         VARYING PV-SUB FROM 1 BY 1                               14980002
149900         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14990002
150000                                                                  15000002
150100******************************************************************15010002
150200** MOVE THE ENTERABLE FIELDS OF EACH LIST LINE INTO THE COMMAREA**15020002
150300******************************************************************15030002
150400 2210-MOVE-LINES-TO-COMMAREA.                                     15040002
150500     IF  MR-SELECTL (PV-SUB) > ZERO                               15050002
150600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             15060002
150700         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        15070002
150800                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 15080002
150900     ELSE                                                         15090002
151000         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                15100002
151100                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     15110002
151200                 MOVE SPACE  TO ASC-TEMP-SELECTED-SW              15120002
151300                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 15130002
151400         END-IF                                                   15140002
151500     END-IF.                                                      15150002
151600                                                                  15160002
151700     ADD +1                        TO ASC-ITEM-SUB.               15170002
151710     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15171099
151720         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15172099
151730             COMPUTE PV-BLOCK-NUMBER  =                           15173099
151740                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         15174099
151750                    PC-ITEMS-PER-PANEL                            15175099
151760             PERFORM 5105-REWRITE-ASC-LISTQ                       15176099
151770         END-IF                                                   15177099
151780         ADD +1                    TO ASC-BLK-SUB                 15178099
151790         MOVE +1                   TO ASC-ITEM-SUB                15179099
151791     ELSE                                                         15179199
151792**GB 1/28/09 IR18210 BEG                                          15179299
151793     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             15179399
151794         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15179499
151795             COMPUTE PV-BLOCK-NUMBER  =                           15179599
151796                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         15179699
151797                    PC-ITEMS-PER-PANEL                            15179799
151798             PERFORM 5105-REWRITE-ASC-LISTQ                       15179899
151799         END-IF                                                   15179999
151800**GB 1/28/09 IR18210 END                                          15180099
151900     END-IF.                                                      15190099
152200                                                                  15220002
152300******************************************************************15230002
152400*                                                                 15240081
152500*                                                                 15250081
152600******************************************************************15260002
152700 2400-EDIT-FOR-UPDATE.                                            15270087
152800                                                                  15280092
152900     MOVE +1                       TO ASC-BLK-SUB.                15290092
153000     PERFORM 5100-WRITE-TEMP-STORAGE.                             15300092
153100     ADD +1                        TO ASC-BLK-SUB.                15310092
153200     PERFORM 5100-WRITE-TEMP-STORAGE.                             15320092
153300                                                                  15330092
153400     PERFORM 6112-READ-LIST-QUEUE.                                15340092
153500                                                                  15350092
153600     SET  LQW-IDX  TO   1.                                        15360092
153700                                                                  15370092
153800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           15380092
153900         PERFORM                                                  15390092
154000         VARYING LQW-IDX  FROM 1 BY 1                             15400092
154100         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     15410092
154200            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            15420092
154300            OR   PS-ERROR                                         15430092
154400             IF  LQW-SELECT (LQW-IDX)                             15440092
154500                 PERFORM 2420-PROCESS-SELECTIONS                  15450099
154600             END-IF                                               15460092
154700         END-PERFORM                                              15470092
154800     END-IF.                                                      15480092
154900                                                                  15490092
155000     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           15500092
155100     PERFORM 6111-WRITE-LIST-QUEUE.                               15510092
155200                                                                  15520092
155300     MOVE +1                     TO  ASC-BLK-SUB.                 15530092
155400     PERFORM 4410-READ-TEMP-STORAGE.                              15540092
155500                                                                  15550092
155600     ADD +1                      TO  ASC-BLK-SUB                  15560092
155700                                     PV-BLOCK-NUMBER.             15570092
155800                                                                  15580092
155900     PERFORM 4410-READ-TEMP-STORAGE.                              15590092
156000                                                                  15600092
156100******************************************************************15610092
156200*                                                                 15620092
156300*                                                                 15630092
156400******************************************************************15640092
156500 2420-PROCESS-SELECTIONS.                                         15650099
156600                                                                  15660099
156700     IF LQW-TRAILER       (LQW-IDX) = PC-AVAILABLE                15670099
156701        CONTINUE                                                  15670199
156716     ELSE                                                         15671699
156720        IF LQW-UNASSIGN-TMST (LQW-IDX) = SPACES                   15672099
156800           PERFORM 2440-UPD-TRIP-ASSIGNMENT                       15680099
156900           PERFORM 2460-UPD-STATION-WORKER                        15690099
156910**??                                                              15691099
157000**??    ELSE                                                      15700099
157100**??       MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              15710099
157200**??       MOVE -1               TO ASTRTITL                      15720099
157300**??       SET DP030-SET-CURSOR-APPL-1 TO TRUE                    15730099
157400**??       MOVE DP015-REVERSE    TO ASTRTITH                      15740099
157500**??       MOVE DP015-RED        TO ASTRTITC                      15750099
157600**??       MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA                 15760099
157700**??       SET DP020-MSG-FATAL   TO TRUE                          15770099
157800**??       SET PS-ERROR          TO TRUE                          15780099
157900        END-IF                                                    15790099
157910     END-IF.                                                      15791099
158000                                                                  15800099
158100                                                                  15810099
158200******************************************************************15820099
158300*                                                                 15830099
158400*                                                                 15840099
158500******************************************************************15850099
158600 2440-UPD-TRIP-ASSIGNMENT.                                        15860099
158700                                                                  15870099
158800     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     15880099
158900     MOVE ASC-PNA-STA-NBR  TO DK-ACM-LBL-STA-NBR.                 15890099
159000     MOVE LQW-DOOR-ID (LQW-IDX) TO DK-DOOR-ID.                    15900099
159100     MOVE LQW-TRIP-ID (LQW-IDX) TO DK-TRIP-ID.                    15910099
159101*CT BEGIN 1/16/09                                                 15910199
159110     MOVE ASC-USR-ID       TO DK-USR-ID.                          15911099
159120*CT END   1/16/09                                                 15912099
159200                                                                  15920099
159300     MOVE LQW-ASSIGN-TMST (LQW-IDX) TO DK-TIMESTAMP.              15930099
159400                                                                  15940099
159500     EXEC SQL                                                     15950099
159600         UPDATE  SUT_PNA_TRIP_ASGMT   S110                        15960099
159700            SET  S110.ASGD_END_TMST      = CURRENT TIMESTAMP      15970099
159800                ,S110.UPDATE_BY_USERID   = :DK-USR-ID             15980099
159900                ,S110.UPDATE_TIMESTAMP   = CURRENT TIMESTAMP      15990099
160000                                                                  16000099
160100          WHERE  OPER_UNT_ID          = :DK-OPER-UNT-ID           16010099
160200            AND  ACM_LBL_STA_NBR      = :DK-ACM-LBL-STA-NBR       16020099
160300            AND  DOOR_ID              = :DK-DOOR-ID               16030099
160400            AND  INBD_TRIP_ID         = :DK-TRIP-ID               16040099
160500            AND  ASGD_STRT_TMST       = :DK-TIMESTAMP             16050099
160600     END-EXEC.                                                    16060099
160700                                                                  16070099
160800     EVALUATE TRUE                                                16080099
160900         WHEN SQLCODE = +0                                        16090099
161000              CONTINUE                                            16100099
161100         WHEN SQLWARN0 NOT = SPACES                               16110099
161200         WHEN SQLCODE < +0                                        16120099
161300         WHEN SQLCODE > +0                                        16130099
161400             MOVE '2440-UPD-TRIP-ASSIGNMENT '                     16140099
161500                                       TO DP013-PARAGRAPH         16150099
161600             MOVE 'TRIP NOT FOUNDTE DOOR TYPE CODE'               16160099
161700                                 TO DP013-MESSAGE-TEXT (1)        16170099
161800             MOVE SQLCA      TO DP013-SQLCA                       16180099
161900             MOVE 'SUT_PNA_TRIP_ASGMT'  TO                        16190099
162000                                DP013-DB2-TABLE-NAME (1)          16200099
162100             SET DP013-DB2-ABEND                                  16210099
162200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16220099
162300             PERFORM DP013-0000-PROCESS-ABEND                     16230099
162400     END-EVALUATE.                                                16240099
162500                                                                  16250099
162600                                                                  16260099
162700 2460-UPD-STATION-WORKER.                                         16270099
162800                                                                  16280099
162900     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   16290099
163000     MOVE ASC-PNA-STA-NBR    TO DK-ACM-LBL-STA-NBR.               16300099
163100     MOVE LQW-DOOR-ID (LQW-IDX) TO DK-DOOR-ID.                    16310099
163200     MOVE LQW-TRIP-ID (LQW-IDX) TO DK-TRIP-ID.                    16320099
163300     MOVE LQW-ASSIGN-TMST (LQW-IDX) TO DK-TIMESTAMP.              16330099
163400                                                                  16340099
163500     EXEC SQL                                                     16350099
163600         UPDATE  SUT_PNA_STA_WRKR  S111                           16360099
163700            SET  S111.WRKR_END_TMST      = CURRENT TIMESTAMP      16370099
163800                ,S111.UPDATE_BY_USERID   = :DK-USR-ID             16380099
163900                ,S111.UPDATE_TIMESTAMP   = CURRENT TIMESTAMP      16390099
164000                                                                  16400099
164100          WHERE  OPER_UNT_ID          = :DK-OPER-UNT-ID           16410099
164200            AND  ACM_LBL_STA_NBR      = :DK-ACM-LBL-STA-NBR       16420099
164300            AND  DOOR_ID              = :DK-DOOR-ID               16430099
164400            AND  INBD_TRIP_ID         = :DK-TRIP-ID               16440099
164500            AND  ASGD_STRT_TMST       = :DK-TIMESTAMP             16450099
164520            AND  WRKR_END_TMST        = :PC-DEFAULT-TMST          16452099
164600     END-EXEC.                                                    16460099
164700                                                                  16470099
164800     EVALUATE TRUE                                                16480099
164900         WHEN SQLCODE = +0                                        16490099
165000              CONTINUE                                            16500099
165100         WHEN SQLCODE = +100                                      16510099
165200              CONTINUE                                            16520099
165300         WHEN SQLWARN0 NOT = SPACES                               16530099
165400         WHEN SQLCODE < +0                                        16540099
165500         WHEN SQLCODE > +0                                        16550099
165600             MOVE '2460-UPD-STATION-WORKER  '                     16560099
165700                                       TO DP013-PARAGRAPH         16570099
165800             MOVE 'TRIP NOT FOUNDTE DOOR TYPE CODE'               16580099
165900                                 TO DP013-MESSAGE-TEXT (1)        16590099
166000             MOVE SQLCA      TO DP013-SQLCA                       16600099
166100             MOVE 'SUT_PNA_PNA_WRKR '   TO                        16610099
166200                                DP013-DB2-TABLE-NAME (1)          16620099
166300             SET DP013-DB2-ABEND                                  16630099
166400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16640099
166500             PERFORM DP013-0000-PROCESS-ABEND                     16650099
166600     END-EVALUATE.                                                16660099
166700                                                                  16670099
166800                                                                  16680099
166900******************************************************************16690099
167000** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **16700099
167100** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **16710099
167200******************************************************************16720099
167300 3000-EDIT-DATA-IN-COMMAREA.                                      16730099
167400     PERFORM 3200-RESET-ATTRIBUTES.                               16740099
167500     SET PS-NO-ERROR               TO TRUE.                       16750002
167600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16760002
167700                                                                  16770002
167800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16780002
167900* EDITTING IS DONE FROM THE BOTTOM UP.                            16790002
168000**                                                                16800002
168100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16810002
168200         ASC-ITEMS-DISPLAYED - 1.                                 16820002
168300     PERFORM 3100-SET-SUBSCRIPTS.                                 16830002
168400                                                                  16840002
168500      IF  PS-NO-ERROR                                             16850002
168600          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       16860002
168700      END-IF.                                                     16870002
168800                                                                  16880002
168900     IF  PS-NO-ERROR                                              16890002
169000         PERFORM 3400-CHECK-RANGE-SEQUENCE                        16900002
169100     END-IF.                                                      16910002
169200                                                                  16920002
169300     IF  ((PS-NO-ERROR)                                           16930002
169400       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   16940002
169500       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    16950002
169600             PERFORM 3500-MARK-RANGE-AS-SELECTED                  16960002
169700     END-IF.                                                      16970002
169800                                                                  16980002
169900*----------------------------------------------------------------*16990002
170000* 3005-EDIT-COMMAREA-BLOCKS                                      *17000002
170100*----------------------------------------------------------------*17010002
170200 3005-EDIT-COMMAREA-BLOCKS.                                       17020002
170300     MOVE +1                       TO PV-BLOCK-NUMBER.            17030002
170400     MOVE +1                       TO ASC-BLK-SUB.                17040002
170500     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               17050002
170600                                                                  17060002
170700     COMPUTE PV-BLOCK-NUMBER  =                                   17070002
170800             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            17080002
170900             PC-ITEMS-PER-PANEL.                                  17090002
171000                                                                  17100002
171100     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          17110002
171200                                                                  17120002
171300     PERFORM                                                      17130002
171400        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         17140002
171500           OR PS-ERROR                                            17150002
171600           OR PS-BLOCK-ERROR                                      17160002
171700                                                                  17170002
171800              COMPUTE PV-ITEMS-HOLD  =                            17180002
171900                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       17190002
172000                      PC-ITEMS-PER-PANEL - 1                      17200002
172100                                                                  17210002
172200               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     17220002
172300                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             17230002
172400                       FROM  PV-ITEMS-HOLD                        17240002
172500                     GIVING  PV-ITEMS-DIFF                        17250002
172600                   SUBTRACT  PV-ITEMS-DIFF                        17260002
172700                       FROM  PC-ITEMS-PER-PANEL                   17270002
172800                     GIVING  PV-ITEMS-HOLD                        17280002
172900                       MOVE  PV-ITEMS-HOLD TO PV-SUB              17290002
173000                                              ASC-ITEM-SUB        17300002
173100                                              ASC-ITEMS-DISPLAYED 17310002
173200               ELSE                                               17320002
173300                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            17330002
173400                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      17340002
173500               END-IF                                             17350002
173600                                                                  17360002
173700               PERFORM 3300-EDIT-SELECTIONS                       17370002
173800                       VARYING PV-SUB                             17380002
173900                          FROM PV-SUB BY -1                       17390002
174000                          UNTIL PV-SUB < +1                       17400002
174100                                                                  17410002
174200               MOVE +1               TO ASC-BLK-SUB               17420002
174300                                                                  17430002
174400               PERFORM 5105-REWRITE-ASC-LISTQ                     17440002
174500                                                                  17450002
174600               MOVE +1                TO ASC-BLK-SUB              17460002
174700                                                                  17470002
174800               IF  PS-BLOCK-ERROR                                 17480002
174900                   SET  PS-ERROR     TO TRUE                      17490002
175000                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      17500002
175100                                     TO PV-TOP-ITEM               17510002
175200               ELSE                                               17520002
175300                   ADD  +1           TO PV-BLOCK-NUMBER           17530002
175400                   IF  PV-BLOCK-NUMBER >                          17540002
175500                       ASC-HIGHEST-BLOCK-WRITTEN                  17550002
175600                       MOVE +2       TO ASC-BLK-SUB               17560002
175700                       PERFORM 4410-READ-TEMP-STORAGE             17570002
175800                       MOVE +1       TO ASC-BLK-SUB               17580002
175900                   ELSE                                           17590002
176000                       PERFORM 4410-READ-TEMP-STORAGE             17600002
176100                       ADD  +1        TO PV-BLOCK-NUMBER          17610002
176200                       MOVE +2        TO ASC-BLK-SUB              17620002
176300                       PERFORM 4410-READ-TEMP-STORAGE             17630002
176400                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          17640002
176500                       MOVE +1        TO ASC-BLK-SUB              17650002
176600               END-IF                                             17660002
176700           END-IF                                                 17670002
176800     END-PERFORM.                                                 17680002
176900                                                                  17690002
177000     IF  (PV-ORIGINAL-BLOCK  = +1   AND                           17700002
177100          ASC-LIST-ITEM-NUMBER (1 1) = 1)  OR                     17710002
177200         PS-ERROR                   OR                            17720002
177300         PS-BLOCK-ERROR                                           17730002
177400             CONTINUE                                             17740002
177500     ELSE                                                         17750002
177600         MOVE +1                 TO PV-BLOCK-NUMBER               17760002
177700         MOVE +1                 TO ASC-BLK-SUB                   17770002
177800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  17780002
177900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           17790002
178000         PERFORM 4410-READ-TEMP-STORAGE                           17800002
178100                                                                  17810002
178200         PERFORM                                                  17820002
178300            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             17830002
178400               OR PS-ERROR                                        17840002
178500               OR PS-BLOCK-ERROR                                  17850002
178600                                                                  17860002
178700                  COMPUTE PV-ITEMS-HOLD  =                        17870002
178800                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   17880002
178900                          PC-ITEMS-PER-PANEL - 1                  17890002
179000                                                                  17900002
179100                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    17910002
179200                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          17920002
179300                          FROM  PV-ITEMS-HOLD                     17930002
179400                        GIVING  PV-ITEMS-DIFF                     17940002
179500                      SUBTRACT  PV-ITEMS-DIFF                     17950002
179600                          FROM  PC-ITEMS-PER-PANEL                17960002
179700                        GIVING  PV-ITEMS-HOLD                     17970002
179800                          MOVE  PV-ITEMS-HOLD TO PV-SUB           17980002
179900                                                 ASC-ITEM-SUB     17990002
180000                                              ASC-ITEMS-DISPLAYED 18000002
180100                  ELSE                                            18010002
180200                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         18020002
180300                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   18030002
180400                  END-IF                                          18040002
180500                                                                  18050002
180600                  PERFORM 3300-EDIT-SELECTIONS                    18060002
180700                          VARYING PV-SUB                          18070002
180800                             FROM PV-SUB BY -1                    18080002
180900                            UNTIL PV-SUB < +1                     18090002
181000                                                                  18100002
181100                  MOVE +1               TO ASC-BLK-SUB            18110002
181200                                                                  18120002
181300                  PERFORM 5105-REWRITE-ASC-LISTQ                  18130002
181400                                                                  18140002
181500                  MOVE +1                TO ASC-BLK-SUB           18150002
181600                                                                  18160002
181700                  IF  PS-BLOCK-ERROR                              18170002
181800                      SET  PS-ERROR     TO TRUE                   18180002
181900                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   18190002
182000                                        TO PV-TOP-ITEM            18200002
182100                  ELSE                                            18210002
182200                      ADD  +1            TO PV-BLOCK-NUMBER       18220002
182300                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     18230002
182400                          MOVE +2        TO ASC-BLK-SUB           18240002
182500                          PERFORM 4410-READ-TEMP-STORAGE          18250002
182600                          MOVE +1        TO ASC-BLK-SUB           18260002
182700                      ELSE                                        18270002
182800                          PERFORM 4410-READ-TEMP-STORAGE          18280002
182900                          ADD  +1        TO PV-BLOCK-NUMBER       18290002
183000                          MOVE +2        TO ASC-BLK-SUB           18300002
183100                          PERFORM 4410-READ-TEMP-STORAGE          18310002
183200                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       18320002
183300                          MOVE +1        TO ASC-BLK-SUB           18330002
183400                      END-IF                                      18340002
183500                  END-IF                                          18350002
183600     END-PERFORM.                                                 18360002
183700     MOVE +0 TO PV-ITEMS-HOLD.                                    18370002
183800                                                                  18380002
183900*----------------------------------------------------------------*18390002
184000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18400002
184100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18410002
184200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18420002
184300*                                                                *18430002
184400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18440002
184500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18450002
184600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18460002
184700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18470002
184800*----------------------------------------------------------------*18480002
184900 3100-SET-SUBSCRIPTS.                                             18490002
185000     COMPUTE ASC-ITEM-SUB =                                       18500002
185100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18510002
185200                                                                  18520002
185300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18530002
185400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18540002
185500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               18550002
185600     ELSE                                                         18560002
185700         MOVE +1                     TO ASC-BLK-SUB               18570002
185800     END-IF.                                                      18580002
185900                                                                  18590002
186000******************************************************************18600002
186100** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **18610002
186200******************************************************************18620002
186300 3200-RESET-ATTRIBUTES.                                           18630002
186400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   18640002
186500     MOVE DP015-GREEN              TO ASTRTITC.                   18650002
186600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18660002
186700                                                                  18670002
187710     PERFORM                                                      18771099
187720         VARYING PV-SUB                                           18772099
187730         FROM 1 BY 1                                              18773099
187740         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18774099
187750                                                                  18775099
187760         IF ( PV-SUB > ASC-ITEMS-DISPLAYED )                      18776099
187770             MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)       18777099
187780             MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)       18778099
187790             MOVE SPACES             TO MR-SELECTI (PV-SUB)       18779099
187791         ELSE                                                     18779199
187792             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    18779299
187793             MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)    18779399
187794             MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)    18779499
      *CLP 03-30-17                                                     18779599
                   IF MR-TRAILER (PV-SUB) = PC-UNAVAIL                  18779699
282000                MOVE DP015-BLUE        TO MR-SELECTC (PV-SUB)     18779799
282000                MOVE DP015-PRO-NOR-MDT TO MR-SELECTA (PV-SUB)     18779899
                   END-IF                                               18779999
187795         END-IF                                                   18780099
187796                                                                  18780199
187797     END-PERFORM.                                                 18780299
187798/                                                                 18780399
187800******************************************************************18781002
187900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18790002
188000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18800002
188100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18810002
188200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18820002
188300******************************************************************18830002
188400 3300-EDIT-SELECTIONS.                                            18840002
188500     EVALUATE TRUE                                                18850002
188600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18860002
188700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18870002
188800                 CONTINUE                                         18880002
188900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18890002
189000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18900002
189100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   18910002
189200                 MOVE ASC-TEMP-SELECTED-SW                        18920002
189300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18930002
189400                                TO ASC-SELECTED-SW                18940002
189500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18950002
189600             END-IF                                               18960002
189700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18970002
189800                 = SPACE                                          18980002
189900             EVALUATE TRUE                                        18990002
190000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19000002
190100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19010002
190200                     MOVE SPACE TO ASC-SELECTED-SW                19020002
190300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19030002
190400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19040002
190500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    19050002
190600                     MOVE SPACE TO ASC-SELECTED-SW                19060002
190700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19070002
190800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19080002
190900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      19090002
191000                     MOVE SPACE TO ASC-SELECTED-SW                19100002
191100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19110002
191200             END-EVALUATE                                         19120002
191300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19130002
191400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19140002
191500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19150002
191600             END-IF                                               19160002
191700             PERFORM 3310-EDIT-RANGE                              19170002
191800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19180002
191900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19190002
192000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19200002
192100             END-IF                                               19210002
192200             PERFORM 3310-EDIT-RANGE                              19220002
192300         WHEN OTHER                                               19230002
192400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           19240002
192500             SET DP020-MSG-FATAL    TO TRUE                       19250002
192600             MOVE -1                TO ASTRTITL                   19260002
192700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19270002
192800*            MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        19280002
192900*            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        19290002
193000             SET PS-ERROR TO TRUE                                 19300002
193100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19310002
193200                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19320002
193300                 MOVE SPACE         TO ASC-SELECTED-SW            19330002
193400                                        (ASC-BLK-SUB ASC-ITEM-SUB)19340002
193500             END-IF                                               19350002
193600     END-EVALUATE.                                                19360002
193700                                                                  19370002
193800**?? EDIT FOR THOSE DOORS THAT ARE AVAILABLE.                     19380099
193900**   YOU SHOULD NOT BE ABLE TO SELECT THEM FOR F17 OR F22         19390099
194000                                                                  19400099
194100     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     19410099
194200        PERFORM 3330-EDIT-LINES                                   19420099
194300     END-IF.                                                      19430099
194400                                                                  19440099
194500     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 19450002
194600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19460002
194700     IF  ASC-ITEM-SUB < 1                                         19470002
194800         SUBTRACT +1 FROM ASC-BLK-SUB                             19480002
194900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                19490002
195000     END-IF.                                                      19500002
195100                                                                  19510002
195200******************************************************************19520002
195300** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **19530002
195400** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **19540002
195500** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**19550002
195600** THE ENDING.                                                  **19560002
195700******************************************************************19570002
195800 3310-EDIT-RANGE.                                                 19580002
195900     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                19590002
196000         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   19600002
196100             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)19610002
196200                                   TO ASC-SELECTED-SW             19620002
196300                                        (ASC-BLK-SUB ASC-ITEM-SUB)19630002
196400             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 19640002
196500         ELSE                                                     19650002
196600             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     19660002
196700                 CONTINUE                                         19670002
196800             ELSE                                                 19680002
196900*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        19690002
197000                 MOVE PC-TSYMSG-00054                             19700002
197100                                   TO DP020-MSG-NUMBER            19710002
197200                 SET DP020-MSG-FATAL                              19720002
197300                                   TO TRUE                        19730002
197400                 MOVE -1           TO ASTRTITL                    19740002
197500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19750002
197600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         19760002
197700                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      19770002
197800                 SET PS-ERROR      TO TRUE                        19780002
197900             END-IF                                               19790002
198000         END-IF                                                   19800002
198100     ELSE                                                         19810002
198200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     19820002
198300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19830002
198400                                   TO ASC-SELECTED-SW             19840002
198500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19850002
198600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   19860002
198700         ELSE                                                     19870002
198800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       19880002
198900                 CONTINUE                                         19890002
199000             ELSE                                                 19900002
199100*                -- ONLY ONE END-OF-RANGE ALLOWED --              19910002
199200                 MOVE PC-TSYMSG-00055                             19920002
199300                                   TO DP020-MSG-NUMBER            19930002
199400                 SET DP020-MSG-FATAL                              19940002
199500                                   TO TRUE                        19950002
199600                 MOVE -1           TO ASTRTITL                    19960002
199700                 SET DP030-SET-CURSOR-APPL-1                      19970002
199800                                   TO TRUE                        19980002
199900                 SET PS-ERROR      TO TRUE                        19990002
200000             END-IF                                               20000002
200100         END-IF                                                   20010002
200200     END-IF.                                                      20020002
200300                                                                  20030099
200400******************************************************************20040002
200500*    EDIT SELECTED LINES FOR AVAILABLE IN TRAILER.                20050099
200600*                                                                 20060099
200700******************************************************************20070002
200800 3330-EDIT-LINES.                                                 20080099
200900                                                                  20090099
201000     EVALUATE TRUE                                                20100099
201100*        NEITHER F17 OR F22 SHOULD BE ABLE TO SELECT A LINE       20110099
201110* NO CT 1/7 F17 -  INQ/UPD (LOCAL-FUNC-02) SUKCS797 - LIST        20111099
201200*                PRINT AND APPLY TK LIST                          20120099
201210* F22 -  UNASSIGN (LOCAL-FUNC-03)                                 20121099
201300*        WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              20130099
201302         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              20130299
201400              IF (ASC-TRAILER (ASC-BLK-SUB ASC-ITEM-SUB) =        20140099
201500                                         PC-AVAILABLE )           20150099
201510                 OR                                               20151099
201520              (ASC-ACTV-IND (ASC-BLK-SUB ASC-ITEM-SUB) = 'I')     20152099
201600                 MOVE PC-TSYMSG-03650  TO DP020-MSG-NUMBER        20160099
201700                 MOVE -1               TO MR-SELECTL (PV-SUB)     20170099
201800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              20180099
201900                 MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)     20190099
202000                 MOVE DP015-RED        TO MR-SELECTC (PV-SUB)     20200099
202100                 SET DP020-MSG-FATAL   TO TRUE                    20210099
202200                 SET PS-ERROR          TO TRUE                    20220099
202300              END-IF                                              20230099
202400                                                                  20240099
202500     END-EVALUATE.                                                20250099
202600                                                                  20260099
202700******************************************************************20270099
202800** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20280099
202900** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20290099
203000******************************************************************20300099
203100 3400-CHECK-RANGE-SEQUENCE.                                       20310099
203200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20320002
203300       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20330002
203400       AND  ASC-START-OF-SELECTED-RANGE >                         20340002
203500                                         ASC-END-OF-SELECTED-RANGE20350002
203600*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20360002
203700         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20370002
203800         SET DP020-MSG-FATAL TO TRUE                              20380002
203900         SET PS-ERROR TO TRUE                                     20390002
204000         PERFORM 3410-POSITION-AT-ERROR                           20400002
204100     END-IF.                                                      20410002
204200                                                                  20420002
204300******************************************************************20430002
204400** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20440002
204500** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20450002
204600** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20460002
204700******************************************************************20470002
204800 3410-POSITION-AT-ERROR.                                          20480002
204900     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       20490002
205000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20500002
205100                    - PV-TOP-ITEM + 1.                            20510002
205200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20520002
205300         CONTINUE                                                 20530002
205400     ELSE                                                         20540002
205500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20550002
205600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20560002
205700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20570002
205800     END-IF.                                                      20580002
205900                                                                  20590002
206000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20600002
206100                    - PV-TOP-ITEM + 1.                            20610002
206200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20620002
206300         CONTINUE                                                 20630002
206400     ELSE                                                         20640002
206500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20650002
206600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20660002
206700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20670002
206800     END-IF.                                                      20680002
206900                                                                  20690002
207000*----------------------------------------------------------------*20700002
207100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *20710002
207200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *20720002
207300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *20730002
207400*----------------------------------------------------------------*20740002
207500 3500-MARK-RANGE-AS-SELECTED.                                     20750002
207600     MOVE +1                       TO  ASC-BLK-SUB.               20760002
207700     PERFORM 3510-MARK-SELECTED-INDS                              20770002
207800         VARYING ASC-ITEM-SUB                                     20780002
207900         FROM 1 BY 1                                              20790002
208000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20800002
208100                                                                  20810002
208200     ADD +1                        TO ASC-BLK-SUB.                20820002
208300     PERFORM 3510-MARK-SELECTED-INDS                              20830002
208400         VARYING ASC-ITEM-SUB                                     20840002
208500         FROM 1 BY 1                                              20850002
208600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20860002
208700                                                                  20870002
208800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20880002
208900                                   TO  PV-LIST-ITEM-NUMBER.       20890002
209000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20900002
209100         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         20910002
209200               PC-ITEMS-PER-PANEL).                               20920002
209300                                                                  20930002
209400     MOVE ASC-START-OF-SELECTED-RANGE                             20940002
209500                                   TO PV-START-OF-SELECTED-RANGE. 20950002
209600     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            20960002
209700         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  20970002
209800               PC-ITEMS-PER-PANEL).                               20980002
209900                                                                  20990002
210000     MOVE ASC-END-OF-SELECTED-RANGE                               21000002
210100                                   TO  PV-END-OF-SELECTED-RANGE.  21010002
210200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21020002
210300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21030002
210400               PC-ITEMS-PER-PANEL).                               21040002
210500     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21050002
210600         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21060002
210700                                                                  21070002
210800     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21080002
210900        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21090002
211000         MOVE +1                   TO ASC-BLK-SUB                 21100002
211100         PERFORM 5100-WRITE-TEMP-STORAGE                          21110002
211200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21120002
211300             PV-FIRST-BLOCK-IN-ARRAY - 1                          21130002
211400                                                                  21140002
211500         PERFORM                                                  21150002
211600             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21160002
211700                   PV-PREV-BLOCK-IN-ARRAY                         21170002
211800             MOVE PV-FIRST-BLOCK-IN-RANGE                         21180002
211900                                   TO PV-BLOCK-NUMBER             21190002
212000             PERFORM 4410-READ-TEMP-STORAGE                       21200002
212100             PERFORM 3510-MARK-SELECTED-INDS                      21210002
212200                 VARYING ASC-ITEM-SUB                             21220002
212300                 FROM 1 BY 1                                      21230002
212400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21240002
212500             PERFORM 5100-WRITE-TEMP-STORAGE                      21250002
212600             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21260002
212700         END-PERFORM                                              21270002
212800                                                                  21280002
212900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21290002
213000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21300002
213100         PERFORM                                                  21310002
213200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21320002
213300                   PV-LAST-BLOCK-IN-RANGE                         21330002
213400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21340002
213500                                   TO PV-BLOCK-NUMBER             21350002
213600             PERFORM 4410-READ-TEMP-STORAGE                       21360002
213700             PERFORM 3510-MARK-SELECTED-INDS                      21370002
213800                 VARYING ASC-ITEM-SUB                             21380002
213900                 FROM 1 BY 1                                      21390002
214000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21400002
214100             PERFORM 5100-WRITE-TEMP-STORAGE                      21410002
214200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21420002
214300         END-PERFORM                                              21430002
214400                                                                  21440002
214500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21450002
214600                                   TO PV-BLOCK-NUMBER             21460002
214700         PERFORM 4410-READ-TEMP-STORAGE                           21470002
214800     END-IF.                                                      21480002
214900                                                                  21490002
215000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21500002
215100                                      ASC-END-OF-SELECTED-RANGE.  21510002
215200                                                                  21520002
215300*----------------------------------------------------------------*21530002
215400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21540002
215500*----------------------------------------------------------------*21550002
215600 3510-MARK-SELECTED-INDS.                                         21560002
215700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21570002
215800                                ASC-ITEM-SUB) >                   21580002
215900         ASC-START-OF-SELECTED-RANGE)                             21590002
216000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21600002
216100                                ASC-ITEM-SUB) =                   21610002
216200         ASC-START-OF-SELECTED-RANGE)                             21620002
216300                                                                  21630002
216400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21640002
216500                                    ASC-ITEM-SUB) <               21650002
216600             ASC-END-OF-SELECTED-RANGE)                           21660002
216700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21670002
216800                                    ASC-ITEM-SUB) =               21680002
216900             ASC-END-OF-SELECTED-RANGE)                           21690002
217000                                                                  21700002
217100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21710002
217200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   21720002
217300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   21730002
217400                               TO TRUE                            21740002
217500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              21750002
217600                               TO TRUE                            21760002
217700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    21770002
217800             END-IF                                               21780002
217900         END-IF                                                   21790002
218000     END-IF.                                                      21800002
218100                                                                  21810002
218200*----------------------------------------------------------------*21820002
218300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *21830002
218400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *21840002
218500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *21850002
218600*    DISPLAY THE PANEL TO USER.                                  *21860002
218700*----------------------------------------------------------------*21870002
218800 4000-BUILD-INITIAL-PANEL.                                        21880002
218900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            21890002
219000                                 ASC-BLOCK-ENTRIES (2).           21900002
219100     MOVE +1                   TO ASC-BLK-SUB.                    21910002
219200     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           21920002
219300                                                                  21930002
219400     MOVE +0                 TO ASC-ITEM-SUB                      21940002
219500                                ASC-NUMBER-OF-ITEMS-READ          21950002
219600                                ASC-NUMBER-OF-SELECTED-ITEMS      21960002
219700                                ASC-HIGHEST-BLOCK-WRITTEN         21970002
219800                                ASC-START-OF-SELECTED-RANGE       21980002
219900                                ASC-END-OF-SELECTED-RANGE         21990002
220000                                ASC-ITEM-AT-TOP-OF-PANEL.         22000002
220001                                                                  22000199
220010*CT BEGIN 01/26/09 IR 12,063                                      22001099
220020     SET SU087-FUNCTION-NONE TO TRUE.                             22002099
220030*CT END   01/26/09 IR 12,063                                      22003099
220100                                                                  22010099
220200     PERFORM 4100-PREPARE-CURSOR.                                 22020047
220300     PERFORM 4110-OPEN-CURSOR.                                    22030047
220400     PERFORM 4300-READ-ITEMS-FROM-DB.                             22040047
220500     PERFORM 4120-CLOSE-CURSOR.                                   22050047
220600                                                                  22060002
220700     MOVE +1                   TO  PV-TOP-ITEM.                   22070002
220800     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          22080002
220801**?? IR 17794 WHEN COMING FROM CS795 AND ONLY ONE ITEM WAS        22080199
220802**            SELECTED, IF THERE AREN'T ANY ITEMS, RETURN         22080299
220803**            TO CS795 WITH ERROR MESSAGE                         22080399
220810        IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT OR    22081099
220820           (DP020-INT-APPL-FORMAT-IND = '2' AND                   22082099
220840            ASC-USE-SELECTION-QUEUE         AND                   22084099
220850            SU089-NUMBER-OF-SELECTED-ITEMS = 1)                   22085099
220900            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                 22090099
221000            SET DP020-MSG-FATAL   TO  TRUE                        22100099
221100            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            22110099
221200        ELSE                                                      22120099
221201**?? IR 17794 WHEN COMING FROM CS795 AND ONE OF THE SELECTS       22120199
221202**            DOESN'T HAVE ANY ITEMS TO DISPLAY, STAY ON          22120299
221203**            SCREEN AND DISPLAY MSG                              22120399
221204            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            22120499
221206            SET DP020-MSG-WARNING TO TRUE                         22120699
221207            SET PS-ERROR          TO TRUE                         22120799
221208            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                  22120899
221209        END-IF                                                    22120999
221210     ELSE                                                         22121099
221300         MOVE -1               TO MR-SELECTL (1)                  22130002
221400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      22140002
221500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22150002
221600     END-IF.                                                      22160002
221700                                                                  22170002
221800*----------------------------------------------------------------*22180002
221900* OPEN THE CURSOR.                                               *22190002
222000*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *22200002
222100*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *22210002
222200*   ASSOCIATE.                                                   *22220002
222300*----------------------------------------------------------------*22230002
222400 4110-OPEN-CURSOR.                                                22240047
222500     PERFORM                                                      22250002
222600         WITH TEST AFTER                                          22260002
222700         VARYING PV-RETRY-COUNTER                                 22270002
222800         FROM 1 BY 1                                              22280002
222900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22290002
223000                   OR (SQLCODE = ZERO))                           22300002
223100                                                                  22310002
223200         MOVE 'CURSOR:  DOOR-TRIP-CSR'                            22320039
223300                                        TO DP013-MESSAGE-TEXT (2) 22330002
223400         EXEC SQL                                                 22340021
223500              OPEN DOOR-TRIP-CSR-UNION                            22350099
223600         END-EXEC                                                 22360024
223800                                                                  22380002
223900         EVALUATE TRUE                                            22390002
224000             WHEN SQLCODE = ZERO                                  22400002
224100             WHEN SQLCODE = -904                                  22410002
224200             WHEN SQLCODE = -913                                  22420002
224300                 CONTINUE                                         22430002
224400             WHEN SQLWARN0 NOT = SPACES                           22440002
224500             WHEN SQLCODE < ZERO                                  22450002
224600             WHEN SQLCODE > ZERO                                  22460002
224700                 MOVE '4110-OPEN-CURSOR' TO DP013-PARAGRAPH       22470047
224800                 MOVE 'UNABLE TO OPEN A CURSOR -'                 22480002
224900                                   TO DP013-MESSAGE-TEXT (1)      22490002
225000                 MOVE SQLCA        TO DP013-SQLCA                 22500002
225100                 MOVE 'SUT_PNA_TRIP_ASGMT' TO                     22510047
225200                                      DP013-DB2-TABLE-NAME (1)    22520047
225300                 SET DP013-DB2-ABEND                              22530002
225400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           22540002
225500                 PERFORM DP013-0000-PROCESS-ABEND                 22550002
225600         END-EVALUATE                                             22560002
225700     END-PERFORM.                                                 22570002
225800                                                                  22580002
225900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22590002
226000         MOVE '4110-OPEN-CURSOR'   TO DP013-PARAGRAPH             22600047
226100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   22610002
226200                                   TO DP013-MESSAGE-TEXT (1)      22620002
226300         MOVE SQLCA                TO DP013-SQLCA                 22630002
226400         MOVE 'SUT_PNA_TRIP_ASGMT' TO DP013-DB2-TABLE-NAME (1)    22640047
226500         SET DP013-DB2-ABEND                                      22650002
226600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   22660002
226700         PERFORM DP013-0000-PROCESS-ABEND                         22670002
226800     END-IF.                                                      22680002
226900                                                                  22690002
227000*----------------------------------------------------------------*22700002
227100* CLOSE THE CURSOR                                               *22710002
227200*----------------------------------------------------------------*22720002
227300 4120-CLOSE-CURSOR.                                               22730047
227400                                                                  22740021
227500     EXEC SQL                                                     22750021
227600          CLOSE DOOR-TRIP-CSR-UNION                               22760099
227700     END-EXEC.                                                    22770021
227900                                                                  22790002
228000     EVALUATE TRUE                                                22800002
228100         WHEN SQLCODE = ZERO                                      22810002
228200             CONTINUE                                             22820002
228300         WHEN SQLWARN0 NOT = SPACES                               22830002
228400         WHEN SQLCODE < ZERO                                      22840002
228500         WHEN SQLCODE > ZERO                                      22850002
228600             MOVE '4120-CLOSE-CURSOR' TO DP013-PARAGRAPH          22860047
228700             MOVE 'UNABLE TO CLOSE CURSOR '                       22870002
228800                               TO DP013-MESSAGE-TEXT (1)          22880002
228900             MOVE SQLCA        TO DP013-SQLCA                     22890002
229000             MOVE 'SUT_PNA_TRIP_ASGMT'  TO                        22900047
229100                                  DP013-DB2-TABLE-NAME (1)        22910047
229200             SET DP013-DB2-ABEND                                  22920002
229300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22930002
229400             PERFORM DP013-0000-PROCESS-ABEND                     22940002
229500     END-EVALUATE.                                                22950002
229600                                                                  22960002
229700                                                                  22970002
229800*----------------------------------------------------------------*22980002
229900*    SET UP THE HOST VARIABLES.                                  *22990002
230000*----------------------------------------------------------------*23000002
230100 4100-PREPARE-CURSOR.                                             23010002
230200                                                                  23020002
230300     MOVE ASC-OPER-UNT-ID      TO  DK-OPER-UNT-ID.                23030002
230400     MOVE ASC-PNA-STA-NBR      TO  DK-ACM-LBL-STA-NBR.            23040057
230500                                                                  23050099
231900     MOVE ASC-ASSIGN-FROM-DATE TO DK-ASSIGN-FROM-DATE.            23190099
232000     MOVE ASC-ASSIGN-TO-DATE   TO DK-ASSIGN-TO-DATE.              23200099
232100                                                                  23210002
232200*----------------------------------------------------------------*23220002
232300*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *23230002
232400*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *23240002
232500*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *23250002
232600*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *23260002
232700*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *23270002
232800*                                                                *23280002
232900*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *23290002
233000*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *23300002
233100*    UPON INITIALIZATION.                                        *23310002
233200*----------------------------------------------------------------*23320002
233300 4300-READ-ITEMS-FROM-DB.                                         23330002
233400     PERFORM                                                      23340002
233500         VARYING PV-READ-COUNT                                    23350002
233600         FROM 1 BY 1                                              23360002
233700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    23370002
233800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         23380002
233900                                                                  23390002
234000         PERFORM 4340-FETCH-DOOR-INFO                             23400099
234100                                                                  23410002
234200         IF  ASC-ITEMS-LEFT-ON-DB                                 23420002
234300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                23430002
234400                 ADD +1            TO ASC-ITEM-SUB                23440002
234500             ELSE                                                 23450002
234600                 ADD +1            TO ASC-BLK-SUB                 23460002
234700                 MOVE +1           TO ASC-ITEM-SUB                23470002
234800                                                                  23480002
234900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         23490002
235000                     MOVE +1       TO ASC-BLK-SUB                 23500002
235100                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           23510002
235200                     PERFORM 5100-WRITE-TEMP-STORAGE              23520002
235300                     MOVE ASC-BLOCK-ENTRIES                       23530002
235400                               (PC-MAX-BLOCKS-IN-ARRAY)           23540002
235500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 23550002
235600                     ADD +1        TO ASC-BLK-SUB                 23560002
235700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   23570002
235800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      23580002
235900                                   TO TRUE                        23590002
236000                 END-IF                                           23600002
236100             END-IF                                               23610002
236200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    23620002
236300             MOVE ASC-NUMBER-OF-ITEMS-READ                        23630002
236400                                   TO ASC-LIST-ITEM-NUMBER        23640002
236500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23650002
236600                                                                  23660099
236700             PERFORM 4320-FORMAT-LINE                             23670099
236800                                                                  23680099
236900         END-IF                                                   23690099
237000     END-PERFORM.                                                 23700099
237100                                                                  23710045
237200     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          23720002
237300         MOVE +1               TO ASC-BLK-SUB                     23730002
237400         PERFORM 5100-WRITE-TEMP-STORAGE                          23740002
237500         ADD +1                TO ASC-BLK-SUB                     23750002
237600         PERFORM 5100-WRITE-TEMP-STORAGE                          23760002
237700                                                                  23770002
237800         MOVE 1                TO ASC-BLK-SUB                     23780002
237900                                  PV-BLOCK-NUMBER                 23790002
238000         PERFORM 4410-READ-TEMP-STORAGE                           23800002
238100         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             23810002
238200             MOVE 2            TO ASC-BLK-SUB                     23820002
238300                                  PV-BLOCK-NUMBER                 23830002
238400             PERFORM 4410-READ-TEMP-STORAGE                       23840002
238500         END-IF                                                   23850002
238600     END-IF.                                                      23860002
238700                                                                  23870002
238800*----------------------------------------------------------------*23880002
238900*                                                                 23890099
239000*----------------------------------------------------------------*23900002
239100 4320-FORMAT-LINE.                                                23910099
239200                                                                  23920099
239300     IF ASC-BLK-SUB  = 1 AND                                      23930099
239400        ASC-ITEM-SUB = 1                                          23940099
239500**      1ST DOOR - RESET EVERYTHING                               23950099
239600        MOVE SUT00109-DOOR-ID   TO  PV-SAVE-DOOR-ID               23960099
239700        SET PS-DOOR-ASSIGNED-NO TO  TRUE                          23970099
239800**      END TIMESTAMP OF DEFAULT DATE / TIME INDICATES            23980099
239900**      IT IS CURRENTLY ASSIGNED, SO SET SWITCH                   23990099
240000        IF SUT00110-ASGD-END-TMST (01:10) =                       24000099
240100                                  PC-DEFAULT-DATE                 24010099
240200           SET PS-DOOR-ASSIGNED-YES TO  TRUE                      24020099
240300        END-IF                                                    24030099
240400        PERFORM 4330-FORMAT-DATA                                  24040099
240500     ELSE                                                         24050099
240600        IF SUT00109-DOOR-ID = PV-SAVE-DOOR-ID                     24060099
240700**            TRIP ID OF "ALL NINES" IS JUST A DOOR ROW           24070099
240800           IF SUT00110-INBD-TRIP-ID = 999999999                   24080099
240900              IF PS-DOOR-ASSIGNED-NO                              24090099
241000**               DOOR IS NOT CURRENTLY ASSIGNED SO SHOW           24100099
241100**               "AVAILABLE" LINE                                 24110099
241200                 PERFORM 4330-FORMAT-DATA                         24120099
241300              ELSE                                                24130099
241400**               DOOR IS CURRENTLY ASSIGNED SKIP SHOWING          24140099
241500**               "AVAILABLE" LINE                                 24150099
241600**??  FOLLOWING STATEMENT IS TEMPORARY                            24160099
241700                 PERFORM 4330-FORMAT-DATA                         24170099
241800**??             CONTINUE                                         24180099
241900              END-IF                                              24190099
242000           ELSE                                                   24200099
242100**            END TIMESTAMP OF DEFAULT DATE / TIME INDICATES      24210099
242200**            IT IS CURRENTLY ASSIGNED, SO SET SWITCH             24220099
242300              IF SUT00110-ASGD-END-TMST (01:10) =                 24230099
242400                                        PC-DEFAULT-DATE           24240099
242500                 SET PS-DOOR-ASSIGNED-YES TO  TRUE                24250099
242600              END-IF                                              24260099
242700              PERFORM 4330-FORMAT-DATA                            24270099
242800           END-IF                                                 24280099
242900        ELSE                                                      24290099
243000**         NEW DOOR - DISPLAY ROW AND RESET EVERYTHING            24300099
243100           PERFORM 4330-FORMAT-DATA                               24310099
243200           MOVE SUT00109-DOOR-ID   TO  PV-SAVE-DOOR-ID            24320099
243300           SET PS-DOOR-ASSIGNED-NO TO  TRUE                       24330099
243400        END-IF                                                    24340099
243500     END-IF.                                                      24350099
243600                                                                  24360099
243700                                                                  24370099
243800 4330-FORMAT-DATA.                                                24380099
243900                                                                  24390099
244000     MOVE SUT00109-DOOR-ID   TO  ASC-DOOR-ID                      24400099
244100                               (ASC-BLK-SUB ASC-ITEM-SUB).        24410099
244200                                                                  24420099
244300     IF DN-INBD-TRIP-IND = 0 AND                                  24430099
244400        SUT00110-INBD-TRIP-ID NOT = 999999999                     24440099
244500        MOVE VHTRIP-OWNER-SCAC-ID TO ASC-SCAC                     24450099
244600                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24460099
244700        MOVE VHTRIP-VEH-NBR      TO   ASC-TRAILER                 24470099
244800                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24480099
244900        MOVE PC-N                TO  ASC-ACTV-IND                 24490099
245000                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24500099
245100        MOVE SUT00110-INBD-TRIP-ID TO ASC-TRIP-ID                 24510099
245200                               (ASC-BLK-SUB ASC-ITEM-SUB)         24520099
245300        IF PV-TK-COUNT > 1                                        24530099
245400           MOVE PC-YELLOW   TO  ASC-TRIP-COLOR                    24540099
245500                            (ASC-BLK-SUB ASC-ITEM-SUB)            24550099
245600        ELSE                                                      24560099
245700           MOVE PC-BLUE     TO  ASC-TRIP-COLOR                    24570099
245800                            (ASC-BLK-SUB ASC-ITEM-SUB)            24580099
245900        END-IF                                                    24590099
246000                                                                  24600099
246100        MOVE SUT00110-ASGD-STRT-TMST TO                           24610099
246200                                    ASC-ASSIGN-TMST               24620099
246300                               (ASC-BLK-SUB ASC-ITEM-SUB)         24630099
246400        MOVE SUT00111-WRKR-USR-ID  TO                             24640099
246500                                   ASC-TK-NBR                     24650099
246600                               (ASC-BLK-SUB ASC-ITEM-SUB)         24660099
246700        MOVE PV-TK-COUNT           TO                             24670099
246800                                   ASC-TK-COUNT                   24680099
246900                               (ASC-BLK-SUB ASC-ITEM-SUB)         24690099
247000                                                                  24700099
247100        IF SUT00110-ASGD-END-TMST (01:10) =                       24710099
247200                    PC-DEFAULT-DATE                               24720099
247300           MOVE 'A'    TO ASC-ACTV-IND                            24730099
247400                         (ASC-BLK-SUB ASC-ITEM-SUB)               24740099
247500                                                                  24750099
247600           MOVE SPACES TO ASC-UNASSIGN-TMST                       24760099
247700                         (ASC-BLK-SUB ASC-ITEM-SUB)               24770099
247800        ELSE                                                      24780099
247900           MOVE 'I'    TO ASC-ACTV-IND                            24790099
248000                         (ASC-BLK-SUB ASC-ITEM-SUB)               24800099
248100           MOVE SUT00110-ASGD-END-TMST   TO                       24810099
248200                          ASC-UNASSIGN-TMST                       24820099
248300                         (ASC-BLK-SUB ASC-ITEM-SUB)               24830099
248400        END-IF                                                    24840099
248500     ELSE                                                         24850099
248600        MOVE SPACES               TO ASC-SCAC                     24860099
248700                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24870099
248800        MOVE SPACES               TO ASC-SCAC                     24880099
248900                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24890099
249000        MOVE PC-AVAILABLE         TO ASC-TRAILER                  24900099
249100                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24910099
249200        MOVE 'I'                  TO  ASC-ACTV-IND                24920099
249300                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24930099
249400        MOVE ZEROES               TO ASC-TRIP-ID                  24940099
249500                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24950099
249600                                                                  24960099
249700        MOVE SPACES               TO ASC-ASSIGN-TMST              24970099
249800                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24980099
249900        MOVE SPACES               TO ASC-UNASSIGN-TMST            24990099
250000                                  (ASC-BLK-SUB ASC-ITEM-SUB)      25000099
250100        MOVE SPACES               TO ASC-TK-NBR                   25010099
250200                                  (ASC-BLK-SUB ASC-ITEM-SUB)      25020099
      *CLP 03-30-17                                                     25021099
              PERFORM 4395-GET-DC-AVAIL-DOORS                           25022099
              IF PS-DC-PASGND-FOUND                                     25022199
                  PERFORM 4396-CHECK-PRIOR-DOOR                         25022299
                  IF PV-CNT > 0                                         25022399
249000                MOVE PC-UNAVAIL       TO ASC-TRAILER              25024099
249100                                  (ASC-BLK-SUB ASC-ITEM-SUB)      25025099
                  END-IF                                                25026099
              END-IF                                                    25027099
250400     END-IF.                                                      25040099
250500                                                                  25050099
250600*----------------------------------------------------------------*25060099
250700*    FETCH THE CURSOR                                             25070099
250800*----------------------------------------------------------------*25080099
250900 4340-FETCH-DOOR-INFO.                                            25090099
251000                                                                  25100099
251100     EXEC SQL                                                     25110021
251200          FETCH   DOOR-TRIP-CSR-UNION                             25120099
251300           INTO  :PV-UNION-TYPE                                   25130099
251400                ,:PV-UNION-SEQUENCE                               25140099
251500                ,:SUT00109-DOOR-ID                                25150099
251600                ,:SUT00110-INBD-TRIP-ID    :DN-INBD-TRIP-IND      25160099
251700                ,:SUT00110-ASGD-STRT-TMST  :DN-ASGD-STRT-IND      25170099
251800                ,:SUT00110-ASGD-END-TMST   :DN-ASGD-END-IND       25180099
251900                                                                  25190039
252000     END-EXEC.                                                    25200021
252700                                                                  25270002
252800     EVALUATE TRUE                                                25280002
252900         WHEN SQLCODE = ZERO                                      25290002
253000              SET PS-NOT-END-OF-DOOR-CSR TO TRUE                  25300099
253100              IF DN-INBD-TRIP-IND = 0                             25310099
253200                 PERFORM 4360-SELECT-TVHTRIP                      25320099
253300                 PERFORM 4380-SELECT-WORKER-COUNT                 25330099
253400                 PERFORM 4390-SELECT-WORKER                       25340099
253500              END-IF                                              25350099
253600         WHEN SQLCODE = +100                                      25360099
253700              SET PS-END-OF-DOOR-CSR TO TRUE                      25370099
253800         WHEN SQLWARN0 NOT = SPACE                                25380099
253900         WHEN SQLCODE NOT = ZERO                                  25390002
254000              MOVE '4340-FETCH-DOOR-INFO' TO DP013-PARAGRAPH      25400099
254100              MOVE 'COULD NOT FETCH CURSOR'                       25410002
254200                               TO DP013-MESSAGE-TEXT (1)          25420002
254300              MOVE SQLCA       TO DP013-SQLCA                     25430002
254400              SET DP013-DB2-ABEND TO TRUE                         25440002
254500              PERFORM DP013-0000-PROCESS-ABEND                    25450002
254600     END-EVALUATE.                                                25460002
254700                                                                  25470002
254800     IF  PS-END-OF-DOOR-CSR                                       25480099
254900         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      25490002
255000     END-IF.                                                      25500002
255100                                                                  25510002
255200*----------------------------------------------------------------*25520002
255300*    RETRIEVE INFORMATION FROM THE TVHTRIP                        25530041
255400*----------------------------------------------------------------*25540002
255500 4360-SELECT-TVHTRIP.                                             25550099
255600     INITIALIZE ASC-COUNT.                                        25560002
255700     MOVE SUT00110-INBD-TRIP-ID  TO DK-TRIP-ID.                   25570040
255800                                                                  25580002
255900     EXEC SQL                                                     25590002
256000         SELECT                                                   25600040
256100                OWNER_SCAC_ID                                     25610044
256200               ,VEH_NBR                                           25620040
256300               ,TRIP_ID                                           25630040
256400          INTO                                                    25640040
256500                :VHTRIP-OWNER-SCAC-ID                             25650041
256600               ,:VHTRIP-VEH-NBR                                   25660043
256700               ,:VHTRIP-TRIP-ID                                   25670040
256800         FROM  TVHTRIP                                            25680042
256900        WHERE  TRIP_ID     = :DK-TRIP-ID                          25690040
257000     END-EXEC.                                                    25700040
257100                                                                  25710002
257200     EVALUATE TRUE                                                25720002
257300         WHEN SQLCODE = ZERO                                      25730002
257400              CONTINUE                                            25740040
257500                                                                  25750002
257600         WHEN SQLCODE = +100                                      25760002
257700              CONTINUE                                            25770040
257800                                                                  25780040
257900         WHEN SQLWARN0 NOT = SPACES                               25790002
258000         WHEN SQLCODE < +0                                        25800002
258100         WHEN SQLCODE > +0                                        25810002
258200             MOVE '4360-SELECT-VHTRIP      ' TO DP013-PARAGRAPH   25820099
258300             MOVE 'TROUBLE RETRIEVING TRIP'                       25830040
258400                                      TO DP013-MESSAGE-TEXT (1)   25840002
258500             MOVE SQLCA        TO DP013-SQLCA                     25850002
258600             MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (1)        25860040
258700             SET DP013-DB2-ABEND                                  25870002
258800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25880002
258900             PERFORM DP013-0000-PROCESS-ABEND                     25890002
259000         END-EVALUATE.                                            25900002
259100                                                                  25910002
259200                                                                  25920098
259300*----------------------------------------------------------------*25930098
259400*    RETRIEVE INFORMATION FROM THE TVHTRIP                        25940098
259500*----------------------------------------------------------------*25950098
259600 4380-SELECT-WORKER-COUNT.                                        25960099
259700     MOVE ASC-OPER-UNT-ID     TO DK-OPER-UNT-ID.                  25970098
259800     MOVE ASC-USR-ID          TO DK-USR-ID.                       25980098
259900     MOVE SUT00109-DOOR-ID    TO  DK-DOOR-ID.                     25990099
260000     MOVE SUT00110-ASGD-STRT-TMST TO DK-ASGD-STRT-TMST.           26000099
260100                                                                  26010098
260200     EXEC SQL                                                     26020099
260300         SELECT  COUNT(DISTINCT(WRKR_USR_ID))                     26030099
260400                                                                  26040099
260500           INTO  :PV-TK-COUNT                                     26050099
260600                                                                  26060099
260700           FROM  SUT_PNA_STA_WRKR    SUT111                       26070099
260800          WHERE  SUT111.OPER_UNT_ID      = :DK-OPER-UNT-ID        26080099
260900            AND  SUT111.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR    26090099
261000            AND  SUT111.DOOR_ID          = :DK-DOOR-ID            26100099
261100            AND  SUT111.INBD_TRIP_ID     = :DK-TRIP-ID            26110099
261200            AND  SUT111.ASGD_STRT_TMST   = :DK-ASGD-STRT-TMST     26120099
261300     END-EXEC.                                                    26130099
261400                                                                  26140098
261500     EVALUATE TRUE                                                26150098
261600         WHEN SQLCODE = ZERO                                      26160098
261700              CONTINUE                                            26170099
261800                                                                  26180099
261900         WHEN SQLWARN0 NOT = SPACES                               26190099
262000         WHEN SQLCODE < +0                                        26200099
262100         WHEN SQLCODE > +0                                        26210099
262200             MOVE '4380-SELECT-WORKER-COUNT' TO DP013-PARAGRAPH   26220099
262300             MOVE 'TROUBLE RETRIEVING TRIP'                       26230099
262400                                      TO DP013-MESSAGE-TEXT (1)   26240099
262500             MOVE SQLCA        TO DP013-SQLCA                     26250099
262600             MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (1)        26260099
262700             SET DP013-DB2-ABEND                                  26270099
262800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26280099
262900             PERFORM DP013-0000-PROCESS-ABEND                     26290099
263000         END-EVALUATE.                                            26300099
263100                                                                  26310099
263200*----------------------------------------------------------------*26320099
263300*    RETRIEVE WORKER TK NUMBER                                    26330099
263400*----------------------------------------------------------------*26340099
263500 4390-SELECT-WORKER.                                              26350099
263600     MOVE ASC-OPER-UNT-ID     TO DK-OPER-UNT-ID.                  26360099
263700     MOVE ASC-USR-ID          TO DK-USR-ID.                       26370099
263800     MOVE SUT00109-DOOR-ID    TO  DK-DOOR-ID.                     26380099
263900     MOVE SUT00110-ASGD-STRT-TMST TO DK-ASGD-STRT-TMST.           26390099
264000                                                                  26400099
264010*CT 01/23/09 IR 18,258 ADDED WHERE WRKR_END_TMST = 9999-09-0...   26401099
264100     EXEC SQL                                                     26410099
264200         SELECT  WRKR_USR_ID                                      26420099
264300                                                                  26430099
264400           INTO  :SUT00111-WRKR-USR-ID                            26440099
264500                                                                  26450099
264600           FROM  SUT_PNA_STA_WRKR    SUT111                       26460099
264700          WHERE  SUT111.OPER_UNT_ID      = :DK-OPER-UNT-ID        26470099
264800            AND  SUT111.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR    26480099
264900            AND  SUT111.DOOR_ID          = :DK-DOOR-ID            26490099
265000            AND  SUT111.INBD_TRIP_ID     = :DK-TRIP-ID            26500099
265100            AND  SUT111.ASGD_STRT_TMST   = :DK-ASGD-STRT-TMST     26510099
265110            AND  WRKR_END_TMST           = :PC-DEFAULT-TMST       26511099
265200     END-EXEC.                                                    26520099
265500                                                                  26550099
265600     EVALUATE TRUE                                                26560099
265700         WHEN SQLCODE = ZERO                                      26570099
265800              CONTINUE                                            26580099
265900                                                                  26590099
266000         WHEN SQLCODE = +100                                      26600099
266100              MOVE SPACES TO SUT00111-WRKR-USR-ID                 26610099
266200                                                                  26620099
266300         WHEN SQLCODE = -811                                      26630099
266400              CONTINUE                                            26640099
266500                                                                  26650099
266600         WHEN SQLWARN0 NOT = SPACES                               26660099
266700         WHEN SQLCODE < +0                                        26670099
266800         WHEN SQLCODE > +0                                        26680099
266900             MOVE '4390-SELECT-WORKER      ' TO DP013-PARAGRAPH   26690099
267000             MOVE 'TROUBLE RETRIEVING TRIP'                       26700099
267100                                      TO DP013-MESSAGE-TEXT (1)   26710099
267200             MOVE SQLCA        TO DP013-SQLCA                     26720099
267300             MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (1)        26730099
267400             SET DP013-DB2-ABEND                                  26740099
267500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26750099
267600             PERFORM DP013-0000-PROCESS-ABEND                     26760099
267700         END-EVALUATE.                                            26770099
267800                                                                  26780099
267900                                                                  26790099
263200*----------------------------------------------------------------*26790199
263300*    CHECK THIS PARM TO SEE IF ITS ON TABLE WITH 'Y' AND ONLY 1   26790299
263300*    DOOR AVAILABLE,                                              26790399
263300*    IF IT IS THEN ONLY 1 DOOR IS AVAILABLE TO ASSIGN TRAILER TO  26790499
263400*----------------------------------------------------------------*26790599
                                                                        26790699
091901 4395-GET-DC-AVAIL-DOORS.                                         26791099
091902     SET PS-DC-PASGND-NOT-FOUND  TO TRUE.                         26792099
091920     MOVE ASC-OPER-UNT-ID    TO  KRPRPM-LOC-ID.                   26793099
091930                                                                  26794099
091940     EXEC SQL                                                     26795099
091950          SELECT  SYS_PRC_FUNC_CDE                                26796099
091960            INTO :KRPRPM-SYS-PRC-FUNC-CDE                         26797099
091970            FROM  TKRPRPM                                         26798099
091980           WHERE  LOC_ID            = :KRPRPM-LOC-ID              26799099
091990             AND  INTFC_SYS_CDE     = 'KHL'                       26799199
091991             AND  SYS_PRC_FUNC_CDE  = 'PASGND'                    26799299
091992             AND  FUNC_TXT          = 'Y'                         26799399
                   AND  FUNC_QTY          = 1                           26799499
091993            WITH UR                                               26799599
091994     END-EXEC.                                                    26799699
091995                                                                  26799799
091996     EVALUATE TRUE                                                26799899
091997       WHEN SQLCODE = +0                                          26799999
091998           SET  PS-DC-PASGND-FOUND       TO TRUE                  26800099
092001       WHEN SQLCODE = +100                                        26800299
092002           SET  PS-DC-PASGND-NOT-FOUND   TO TRUE                  26800399
261900       WHEN SQLWARN0 NOT = SPACES                                 26800499
262000       WHEN SQLCODE < +0                                          26800599
262100       WHEN SQLCODE > +0                                          26800699
266900           MOVE '4395-GET-DC-AVAIL-DOORS ' TO DP013-PARAGRAPH     26800999
267000           MOVE 'TROUBLE RETRIEVING PARM'                         26801099
267100                                    TO DP013-MESSAGE-TEXT (1)     26801199
267200           MOVE SQLCA        TO DP013-SQLCA                       26801299
267300           MOVE 'TKRPRPM '   TO DP013-DB2-TABLE-NAME (1)          26801399
267400           SET DP013-DB2-ABEND                                    26801499
267500               DP013-XCTL-DISPLAY-RESTART TO TRUE                 26801599
267600           PERFORM DP013-0000-PROCESS-ABEND                       26801699
092019     END-EVALUATE.                                                26802899
                                                                        26802999
263200*----------------------------------------------------------------*26803099
263300*    CHECK IF THERE IS ALREADY A DOOR ASSIGNED IF THE PARM        26803199
263300*    FROM 4395 WAS SET TO 'Y'                                     26803299
263400*----------------------------------------------------------------*26803399
091901 4396-CHECK-PRIOR-DOOR.                                           26803499
091930                                                                  26803799
091940     EXEC SQL                                                     26803899
              SELECT COUNT(*)                                           26803999
              INTO :PV-CNT                                              26804099
                FROM SUT_PNA_TRIP_ASGMT                                 26804199
053000          WHERE  OPER_UNT_ID      = :DK-OPER-UNT-ID               26804399
053100            AND  ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR           26804499
                  AND ASGD_END_TMST     = :PC-DEFAULT-TMST              26804699
091994     END-EXEC.                                                    26804899
091995                                                                  26804999
091996     EVALUATE TRUE                                                26805099
091997       WHEN SQLCODE = +0                                          26805199
091998           CONTINUE                                               26805299
092001       WHEN SQLCODE = +100                                        26805399
092002           MOVE 0 TO PV-CNT                                       26805499
261900       WHEN SQLWARN0 NOT = SPACES                                 26805599
262000       WHEN SQLCODE < +0                                          26805699
262100       WHEN SQLCODE > +0                                          26805799
266900           MOVE '4396-CHECK-PRIOR-DOOR   ' TO DP013-PARAGRAPH     26805899
267000           MOVE 'TROUBLE RETRIEVING DOOR'                         26805999
267100                                    TO DP013-MESSAGE-TEXT (1)     26806099
267200           MOVE SQLCA        TO DP013-SQLCA                       26806199
267300           MOVE 'TRIP_ASGMT'  TO DP013-DB2-TABLE-NAME (1)         26806299
267400           SET DP013-DB2-ABEND                                    26806399
267500               DP013-XCTL-DISPLAY-RESTART TO TRUE                 26806499
267600           PERFORM DP013-0000-PROCESS-ABEND                       26806599
092019     END-EVALUATE.                                                26806699
                                                                        26806799
268000*----------------------------------------------------------------*26807099
268100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *26810099
268200*----------------------------------------------------------------*26820099
268300 4400-MOVE-COMMAREA-TO-SCREEN.                                    26830099
268400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             26840099
268500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          26850099
268600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          26860002
268700             MOVE +1    TO ASC-BLK-SUB                            26870002
268800             PERFORM 5100-WRITE-TEMP-STORAGE                      26880002
268900             ADD +1     TO ASC-BLK-SUB                            26890002
269000             PERFORM 5100-WRITE-TEMP-STORAGE                      26900002
269100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             26910002
269200                 GIVING PV-BLOCK-NUMBER                           26920002
269300                 REMAINDER PV-REMAINDER                           26930002
269400             IF  PV-REMAINDER > ZERO                              26940002
269500                 ADD +1 TO PV-BLOCK-NUMBER                        26950002
269600             END-IF                                               26960002
269700             MOVE +1    TO ASC-BLK-SUB                            26970002
269800             PERFORM 4410-READ-TEMP-STORAGE                       26980002
269900             ADD +1     TO ASC-BLK-SUB                            26990002
270000                           PV-BLOCK-NUMBER                        27000002
270100             PERFORM 4410-READ-TEMP-STORAGE                       27010002
270200     END-IF.                                                      27020002
270300     MOVE +1            TO ASC-BLK-SUB.                           27030002
270400     COMPUTE ASC-ITEM-SUB =                                       27040002
270500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              27050002
270600         + PC-ITEMS-PER-PANEL).                                   27060002
270700*                                                                 27070002
270800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        27080002
270900         ADD +1         TO ASC-BLK-SUB                            27090002
271000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            27100002
271100     END-IF.                                                      27110002
271200*                                                                 27120002
271300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           27130002
271400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                27140002
271500     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        27150002
271600     PERFORM 4420-FORMAT-LIST-LINES                               27160002
271700         VARYING PV-SUB                                           27170002
271800         FROM PC-ITEMS-PER-PANEL BY -1                            27180002
271900         UNTIL PV-SUB < +1.                                       27190002
272000*                                                                 27200002
272100     COMPUTE ASC-ITEMS-DISPLAYED =                                27210002
272200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          27220002
272300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    27230002
272400                                      ASTRTITO.                   27240002
272500     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    27250002
272600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    27260002
272700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27270002
272800                                   TO ASELITO.                    27280002
272900     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   27290002
273000     MOVE ASC-FCLTY-NAME           TO AOPRNMEO.                   27300002
273100     MOVE ASC-PNA-STA-NBR          TO ASTANBRO.                   27310057
273101     STRING ASC-ASSIGN-FROM-DATE (6:5) '-'                        27310199
273102            ASC-ASSIGN-FROM-DATE (1:4)                            27310299
273103            DELIMITED BY SIZE                                     27310399
273104            INTO ABEGDTEO.                                        27310499
273105     STRING ASC-ASSIGN-TO-DATE (6:5) '-'                          27310599
273106            ASC-ASSIGN-TO-DATE (1:4)                              27310699
273107            DELIMITED BY SIZE                                     27310799
273108            INTO AENDDTEO.                                        27310899
273200                                                                  27320002
273300     IF  DP020-MSG-NUMBER-X = SPACE                               27330002
273400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  27340002
273500*            --- MORE ITEMS TO DISPLAY ----                       27350002
273600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            27360002
273700             SET DP020-MSG-INFORMATIONAL TO TRUE                  27370002
273800         END-IF                                                   27380002
273900     END-IF.                                                      27390002
274000                                                                  27400002
274100*----------------------------------------------------------------*27410002
274200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *27420002
274300*----------------------------------------------------------------*27430002
274400 4410-READ-TEMP-STORAGE.                                          27440002
274500     EXEC CICS                                                    27450002
274600         READQ TS                                                 27460002
274700             QUEUE (ASC-LIST-QUEUE-NAME)                          27470002
274800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27480002
274900             ITEM  (PV-BLOCK-NUMBER)                              27490002
275000             RESP  (PV-CICS-RESP)                                 27500002
275100     END-EXEC.                                                    27510002
275200                                                                  27520002
275300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       27530002
275400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     27540002
275500         CONTINUE                                                 27550002
275600     ELSE                                                         27560002
275700         SET DP013-CICS-ABEND     TO TRUE                         27570002
275800         SET DP013-NO-ROLLBACK    TO TRUE                         27580002
275900         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         27590002
276000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      27600002
276100                                  TO DP013-MESSAGE-TEXT(1)        27610002
276200         PERFORM DP013-0000-PROCESS-ABEND                         27620002
276300     END-IF.                                                      27630002
276400                                                                  27640002
276500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             27650002
276600*                                                                 27660002
276700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         27670002
276800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               27680002
276900     END-IF.                                                      27690002
277000                                                                  27700002
277100*----------------------------------------------------------------*27710002
277200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *27720002
277300*----------------------------------------------------------------*27730002
277400 4420-FORMAT-LIST-LINES.                                          27740002
277500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      27750002
277600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                27760002
277700         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           27770002
277800         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           27780002
277900                                                                  27790099
278000         MOVE SPACES             TO MR-SELECTI      (PV-SUB)      27800052
278100                                    MR-ACTION       (PV-SUB)      27810051
278200                                    MR-DOOR-ID      (PV-SUB)      27820051
278300                                    MR-SCAC         (PV-SUB)      27830051
278400                                    MR-TRAILER      (PV-SUB)      27840051
278500                                    MR-ACTV-IND     (PV-SUB)      27850051
278600                                    MR-ASSIGN-DATE  (PV-SUB)      27860051
278700                                    MR-ASSIGN-TIME  (PV-SUB)      27870051
278800                                    MR-UNASSIGN-DATE (PV-SUB)     27880051
278900                                    MR-UNASSIGN-TIME (PV-SUB)     27890051
279000         MOVE ZEROES             TO MR-TRIP-ID      (PV-SUB)      27900051
279100     ELSE                                                         27910002
279200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27920002
279300                                                   > SPACE        27930002
279400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 27940002
279500                                          TO MR-SELECTI (PV-SUB)  27950002
279600         ELSE                                                     27960002
279700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27970002
279800                                           TO MR-SELECTI (PV-SUB) 27980002
279900         END-IF                                                   27990002
280000                                                                  28000002
280100         IF  DP030-SET-CURSOR-TRAILER                             28010002
280200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)28020002
280300                 > SPACE)                                         28030002
280400               OR (PV-SUB = 1))                                   28040002
280500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               28050002
280600                MOVE -1          TO MR-SELECTL (PV-SUB)           28060002
280700             END-IF                                               28070002
280800         END-IF                                                   28080002
280900*>>>>>>>>                                                         28090002
281000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               28100002
281100                                            TO MR-ACTION (PV-SUB) 28110002
281200         MOVE ASC-DOOR-ID  (ASC-BLK-SUB ASC-ITEM-SUB)             28120002
281300                                          TO MR-DOOR-ID  (PV-SUB) 28130002
281400         MOVE ASC-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)                 28140005
281500                                        TO MR-SCAC (PV-SUB)       28150007
281600         MOVE ASC-TRAILER (ASC-BLK-SUB ASC-ITEM-SUB)              28160005
281700                                          TO MR-TRAILER (PV-SUB)  28170007
281800         IF ASC-TRAILER (ASC-BLK-SUB ASC-ITEM-SUB) =              28180099
281900                                         PC-AVAILABLE             28190099
282000            MOVE DP015-YELLOW  TO MR-TRAILERC (PV-SUB)            28200099
282100         ELSE                                                     28210099
282200            MOVE DP015-BLUE    TO MR-TRAILERC (PV-SUB)            28220099
282300         END-IF                                                   28230099
      *03-30-17 CLP                                                     28231099
281800         IF ASC-TRAILER (ASC-BLK-SUB ASC-ITEM-SUB) =              28232099
281900                                         PC-UNAVAIL               28233099
282000            MOVE DP015-BLUE        TO MR-SELECTC (PV-SUB)         28234099
282000            MOVE DP015-PRO-NOR-MDT TO MR-SELECTA (PV-SUB)         28235099
282300         END-IF                                                   28237099
      *                                                                 28238099
282400         MOVE ASC-ACTV-IND (ASC-BLK-SUB ASC-ITEM-SUB)             28240099
282500                                      TO MR-ACTV-IND (PV-SUB)     28250007
282600         MOVE ASC-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)              28260005
282700                                        TO MR-TRIP-ID (PV-SUB)    28270099
282800         EVALUATE ASC-TRIP-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)       28280099
282900             WHEN PC-GREEN                                        28290099
283000                  MOVE DP015-GREEN   TO MR-TRIP-IDC (PV-SUB)      28300099
283100                                                                  28310099
283200             WHEN PC-YELLOW                                       28320099
283300                  MOVE DP015-YELLOW  TO MR-TRIP-IDC (PV-SUB)      28330099
283400                                                                  28340099
283500             WHEN PC-BLUE                                         28350099
283600                  MOVE DP015-BLUE    TO MR-TRIP-IDC (PV-SUB)      28360099
283700                                                                  28370099
283800         END-EVALUATE                                             28380099
283900                                                                  28390099
284000         STRING                                                   28400099
284100               ASC-ASSIGN-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (6:6)   28410099
284200               ASC-ASSIGN-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (3:2)   28420099
284300               DELIMITED BY SIZE INTO MR-ASSIGN-DATE (PV-SUB)     28430099
284400         MOVE ASC-ASSIGN-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (12:8)   28440099
284500                                    TO MR-ASSIGN-TIME (PV-SUB)    28450099
284600                                                                  28460099
284700         STRING                                                   28470099
284800             ASC-UNASSIGN-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (6:6)   28480099
284900             ASC-UNASSIGN-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (3:2)   28490099
285000             DELIMITED BY SIZE                                    28500099
285100             INTO MR-UNASSIGN-DATE (PV-SUB)                       28510099
285200         MOVE ASC-UNASSIGN-TMST (ASC-BLK-SUB ASC-ITEM-SUB) (12:8) 28520099
285300                                    TO MR-UNASSIGN-TIME (PV-SUB)  28530099
285400     END-IF.                                                      28540002
285500     SUBTRACT +1 FROM ASC-ITEM-SUB                                28550002
285600     IF  ASC-ITEM-SUB < + 1                                       28560002
285700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  28570002
285800         MOVE +1                 TO ASC-BLK-SUB                   28580002
285900     END-IF.                                                      28590002
286000                                                                  28600002
286100******************************************************************28610002
286200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **28620002
286300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **28630002
286400** ISSUE A WARNING.                                             **28640002
286500******************************************************************28650002
286600 4430-CHECK-FOR-BEGIN-AND-END.                                    28660002
286700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       28670002
286800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28680002
286900*            -- NO END-OF-RANGE SPECFIED ---                      28690002
287000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            28700002
287100             SET DP020-MSG-WARNING TO TRUE                        28710002
287200             PERFORM 4431-POSITION-AT-WARNING                     28720002
287300         END-IF                                                   28730002
287400     ELSE                                                         28740002
287500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     28750002
287600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                28760002
287700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            28770002
287800             SET DP020-MSG-WARNING TO TRUE                        28780002
287900             PERFORM 4431-POSITION-AT-WARNING                     28790002
288000         END-IF                                                   28800002
288100     END-IF.                                                      28810002
288200                                                                  28820002
288300******************************************************************28830002
288400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **28840002
288500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **28850002
288600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **28860002
288700** POSITION THE CURSOR THERE.                                   **28870002
288800******************************************************************28880002
288900 4431-POSITION-AT-WARNING.                                        28890002
289000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 28900002
289100                    - PV-TOP-ITEM + 1.                            28910002
289200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28920002
289300         CONTINUE                                                 28930002
289400     ELSE                                                         28940002
289500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      28950002
289600         MOVE -1                     TO MR-SELECTL (PV-SUB)       28960002
289700         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       28970002
289800         MOVE DP015-YELLOW           TO MR-SELECTC (PV-SUB)       28980002
289900     END-IF.                                                      28990002
290000                                                                  29000002
290100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   29010002
290200                    - PV-TOP-ITEM + 1.                            29020002
290300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29030002
290400         CONTINUE                                                 29040002
290500     ELSE                                                         29050002
290600         SET DP030-SET-CURSOR-APPL-1                              29060002
290700                                   TO TRUE                        29070002
290800         MOVE -1                   TO MR-SELECTL (PV-SUB)         29080002
290900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29090002
291000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         29100002
291100     END-IF.                                                      29110002
291200                                                                  29120002
291300*----------------------------------------------------------------*29130002
291400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *29140002
291500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *29150002
291600* FOR THE SELECTED ITEMS QUEUE.                                  *29160002
291700*                                                                *29170002
291800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *29180002
291900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *29190002
292000* THE ARRAY IS FULL.                                             *29200002
292100*----------------------------------------------------------------*29210002
292200 5000-PREPARE-SEL-QUEUE.                                          29220002
292300     MOVE +1                   TO  ASC-BLK-SUB.                   29230002
292400     PERFORM 5100-WRITE-TEMP-STORAGE.                             29240002
292500     ADD +1                    TO  ASC-BLK-SUB.                   29250002
292600     PERFORM 5100-WRITE-TEMP-STORAGE.                             29260002
292700                                                                  29270002
292800     MOVE ASC-SEL-QUEUE-NAME   TO  SU089-SEL-QUEUE-NAME.          29280015
292900     PERFORM 6010-DELETE-SEL-QUEUE.                               29290002
293000                                                                  29300002
293100     SET ASC-UPDATE-TSQ        TO  TRUE.                          29310002
293200                                                                  29320002
293300     SET SU088-IDX             TO  1.                             29330007
293400     MOVE ZERO                 TO SU089-NUMBER-OF-TS-ITEMS.       29340015
293500     INITIALIZE SU088-SELECTED-ITEM-ARRAY.                        29350007
293600                                                                  29360002
293700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           29370002
293800             VARYING PV-ITEM                                      29380002
293900             FROM 1 BY 1                                          29390002
294000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     29400002
294100                                                                  29410002
294200     IF  SU088-IDX > 1                                            29420007
294300         PERFORM 5205-WRITE-SEL-QUEUE                             29430002
294400         ADD +1                TO SU089-NUMBER-OF-TS-ITEMS        29440015
294500     END-IF.                                                      29450002
294600                                                                  29460002
294700*----------------------------------------------------------------*29470002
294800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *29480002
294900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *29490002
295000*----------------------------------------------------------------*29500002
295100 5100-WRITE-TEMP-STORAGE.                                         29510002
295200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     29520002
295300                                   TO PV-LIST-ITEM-NUMBER.        29530002
295400     COMPUTE PV-BLOCK-NUMBER =                                    29540002
295500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    29550002
295600                                                                  29560002
295700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             29570002
295800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             29580002
295900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      29590002
296000             PERFORM 5105-REWRITE-ASC-LISTQ                       29600002
296100         END-IF                                                   29610002
296200     ELSE                                                         29620002
296300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       29630002
296400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            29640002
296500         PERFORM 5110-WRITE-ASC-LISTQ                             29650002
296600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   29660002
296700     END-IF.                                                      29670002
296800                                                                  29680002
296900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             29690002
297000                                                                  29700002
297100******************************************************************29710002
297200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **29720002
297300** SPECIFIC COMMAREA.                                           **29730002
297400******************************************************************29740002
297500 5105-REWRITE-ASC-LISTQ.                                          29750002
297600     EXEC CICS                                                    29760002
297700         WRITEQ TS                                                29770002
297800             QUEUE (ASC-LIST-QUEUE-NAME)                          29780002
297900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29790002
298000             ITEM  (PV-BLOCK-NUMBER)                              29800002
298100             REWRITE                                              29810002
298200             RESP  (PV-CICS-RESP)                                 29820002
298300     END-EXEC.                                                    29830002
298400                                                                  29840002
298500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           29850002
298600         CONTINUE                                                 29860002
298700     ELSE                                                         29870002
298800         SET DP013-CICS-ABEND            TO TRUE                  29880002
298900         SET DP013-NO-ROLLBACK           TO TRUE                  29890002
299000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       29900002
299100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     29910002
299200                                         TO DP013-MESSAGE-TEXT(1) 29920002
299300         PERFORM DP013-0000-PROCESS-ABEND                         29930002
299400     END-IF.                                                      29940002
299500                                                                  29950002
299600******************************************************************29960002
299700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **29970002
299800** SPECIFIC COMMAREA.                                           **29980002
299900******************************************************************29990002
300000 5110-WRITE-ASC-LISTQ.                                            30000002
300100     EXEC CICS                                                    30010002
300200         WRITEQ TS                                                30020002
300300             QUEUE (ASC-LIST-QUEUE-NAME)                          30030002
300400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30040002
300500             ITEM  (PV-BLOCK-NUMBER)                              30050002
300600             RESP  (PV-CICS-RESP)                                 30060002
300700     END-EXEC.                                                    30070002
300800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      30080002
300900         SET DP013-CICS-ABEND      TO TRUE                        30090002
301000         SET DP013-NO-ROLLBACK     TO TRUE                        30100002
301100         MOVE '5110-WRITE-ASC-LISTQ'                              30110002
301200                                   TO DP013-PARAGRAPH             30120002
301300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           30130002
301400                                   TO DP013-MESSAGE-TEXT(1)       30140002
301500         PERFORM DP013-0000-PROCESS-ABEND                         30150002
301600     END-IF.                                                      30160002
301700                                                                  30170002
301800*----------------------------------------------------------------*30180002
301900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *30190002
302000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *30200002
302100*----------------------------------------------------------------*30210002
302200 5200-FILL-SEL-QUEUE-RECORD.                                      30220002
302300     PERFORM 6112-READ-LIST-QUEUE.                                30230002
302400                                                                  30240002
302500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       30250002
302600         PERFORM VARYING LQW-IDX                                  30260002
302700         FROM 1 BY 1                                              30270002
302800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            30280002
302900           OR  LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZERO               30290002
303000                                                                  30300002
303100           IF LQW-SELECT (LQW-IDX)                                30310002
303200                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX) TO            30320002
303300                                            SU088-ITEM (SU088-IDX)30330007
303400                 MOVE LQW-ACTION (LQW-IDX)                        30340002
303500                                   TO SU088-ACTION-SW (SU088-IDX) 30350007
303600                 MOVE LQW-DOOR-ID (LQW-IDX)                       30360002
303700                                     TO SU088-DOOR-ID (SU088-IDX) 30370007
303800                 MOVE LQW-SCAC (LQW-IDX)                          30380004
303900                                   TO SU088-SCAC (SU088-IDX)      30390007
304000                 MOVE LQW-TRAILER (LQW-IDX)                       30400004
304100                                    TO SU088-TRAILER (SU088-IDX)  30410007
304200                 MOVE LQW-TRIP-ID (LQW-IDX)                       30420004
304300                               TO SU088-TRIP-ID (SU088-IDX)       30430007
304400                                                                  30440099
304500                 MOVE LQW-ASSIGN-TMST (LQW-IDX)                   30450099
304600                             TO SU088-ASSIGN-TMST      (SU088-IDX)30460099
304700                 MOVE LQW-UNASSIGN-TMST (LQW-IDX)                 30470099
304800                             TO SU088-UNASSIGN-TMST    (SU088-IDX)30480099
304900                 MOVE LQW-TK-NBR        (LQW-IDX)                 30490099
305000                             TO SU088-TK-NBR         (SU088-IDX)  30500099
305100                 MOVE LQW-TK-COUNT      (LQW-IDX)                 30510099
305200                             TO SU088-TK-COUNT       (SU088-IDX)  30520099
305300                                                                  30530002
305400                 SET SU088-IDX UP BY 1                            30540007
305500                 IF  SU088-IDX > SU088-MAX-ITEMS                  30550007
305600                     PERFORM 5205-WRITE-SEL-QUEUE                 30560002
305700                     ADD +1        TO SU089-NUMBER-OF-TS-ITEMS    30570015
305800                     INITIALIZE SU088-SELECTED-ITEM-ARRAY         30580007
305900                     SET SU088-IDX TO  1                          30590007
306000                 END-IF                                           30600002
306100           END-IF                                                 30610002
306200         END-PERFORM                                              30620002
306300     END-IF.                                                      30630002
306400                                                                  30640002
306500*----------------------------------------------------------------*30650002
306600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *30660002
306700*----------------------------------------------------------------*30670002
306800 5205-WRITE-SEL-QUEUE.                                            30680002
306900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU088-SELECTED-ITEMS.   30690007
307000                                                                  30700002
307100     EXEC CICS                                                    30710002
307200          WRITEQ TS                                               30720002
307300              QUEUE (ASC-SEL-QUEUE-NAME)                          30730002
307400              FROM  (SU088-SELECT-RECORD)                         30740007
307500              ITEM  (PV-SEL-QUEUE-ITEM)                           30750002
307600              RESP  (PV-CICS-RESP)                                30760002
307700     END-EXEC.                                                    30770002
307800                                                                  30780002
307900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          30790002
308000         CONTINUE                                                 30800002
308100     ELSE                                                         30810002
308200         SET DP013-CICS-ABEND      TO TRUE                        30820002
308300         SET DP013-NO-ROLLBACK     TO TRUE                        30830002
308400         MOVE '5205-WRITE-SEL-QUEUE'                              30840002
308500                                   TO DP013-PARAGRAPH             30850002
308600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          30860002
308700                                   TO DP013-MESSAGE-TEXT(1)       30870002
308800         PERFORM DP013-0000-PROCESS-ABEND                         30880002
308900     END-IF.                                                      30890002
309000                                                                  30900002
309100******************************************************************30910002
309200** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **30920002
309300** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **30930002
309400** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **30940002
309500** THE USER.                                                    **30950002
309600******************************************************************30960002
309700 6000-REFRESH-PANEL-FROM-TEMP.                                    30970002
309800     IF  ASC-UPDATE-TSQ                                           30980002
309900         SET ASC-NO-TSQ-UPDATE TO TRUE                            30990002
310000         MOVE ZERO                 TO PV-SAVE-ITEM                31000002
310100                                      PV-SEL-QUEUE-ITEM           31010002
310200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        31020002
310300                                   TO PV-HOLD-SELECTED-ITEMS      31030002
310400         MOVE +1                   TO PV-ITEMS-PROCESSED          31040002
310500         PERFORM 6100-UPDATE-TSQ                                  31050002
310600             UNTIL PV-ITEMS-PROCESSED >                           31060002
310700                                     PV-HOLD-SELECTED-ITEMS       31070002
310800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         31080002
310900                    ASC-BLOCK-ENTRIES (2)                         31090002
311000     END-IF.                                                      31100002
311100                                                                  31110002
311200*----------------------------------------------------------------*31120002
311300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *31130002
311400*----------------------------------------------------------------*31140002
311500 6010-DELETE-SEL-QUEUE.                                           31150002
311600                                                                  31160002
311700     EXEC CICS                                                    31170002
311800         DELETEQ TS                                               31180002
311900             QUEUE (ASC-SEL-QUEUE-NAME)                           31190002
312000             RESP  (PV-CICS-RESP)                                 31200002
312100     END-EXEC.                                                    31210002
312200*                                                                 31220002
312300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      31230002
312400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         31240002
312500         CONTINUE                                                 31250002
312600     ELSE                                                         31260002
312700         SET DP013-CICS-ABEND TO TRUE                             31270002
312800         SET DP013-NO-ROLLBACK TO TRUE                            31280002
312900         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          31290002
313000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         31300002
313100                                        TO DP013-MESSAGE-TEXT (1) 31310002
313200         PERFORM DP013-0000-PROCESS-ABEND                         31320002
313300     END-IF.                                                      31330002
313400                                                                  31340002
313500*----------------------------------------------------------------*31350002
313600*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *31360002
313700*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *31370002
313800*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *31380002
313900*    THE TEMP QUEUE.                                             *31390002
314000*----------------------------------------------------------------*31400002
314100 6100-UPDATE-TSQ.                                                 31410002
314200                                                                  31420002
314300     ADD 1    TO  PV-SEL-QUEUE-ITEM.                              31430002
314400     PERFORM 6105-READ-SEL-QUEUE.                                 31440002
314500     PERFORM                                                      31450002
314600         VARYING SU088-IDX FROM 1 BY 1                            31460007
314700         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     31470002
314800         OR (SU088-IDX GREATER THAN SU088-MAX-ITEMS))             31480007
314900         IF  SU088-ACTION-SW (SU088-IDX) > SPACE                  31490007
315000             PERFORM 6110-PROCESS-ITEMS                           31500002
315100         END-IF                                                   31510002
315200         ADD +1                TO PV-ITEMS-PROCESSED              31520002
315300     END-PERFORM.                                                 31530002
315400     PERFORM 6111-WRITE-LIST-QUEUE.                               31540002
315500                                                                  31550002
315600*----------------------------------------------------------------*31560002
315700*    READ THE LIST QUEUE RECORD.                                 *31570002
315800*----------------------------------------------------------------*31580002
315900 6105-READ-SEL-QUEUE.                                             31590002
316000                                                                  31600002
316100     EXEC CICS                                                    31610002
316200          READQ TS                                                31620002
316300              QUEUE (ASC-SEL-QUEUE-NAME)                          31630002
316400              INTO  (SU088-SELECT-RECORD)                         31640007
316500              ITEM  (PV-SEL-QUEUE-ITEM)                           31650002
316600              RESP  (PV-CICS-RESP)                                31660002
316700     END-EXEC.                                                    31670002
316800*                                                                 31680002
316900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31690002
317000         CONTINUE                                                 31700002
317100     ELSE                                                         31710002
317200         SET DP013-CICS-ABEND      TO  TRUE                       31720002
317300         SET DP013-NO-ROLLBACK     TO  TRUE                       31730002
317400         MOVE '6105-READ-SEL-QUEUE'                               31740002
317500                                   TO  DP013-PARAGRAPH            31750002
317600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           31760002
317700                                   TO  DP013-MESSAGE-TEXT(1)      31770002
317800         PERFORM DP013-0000-PROCESS-ABEND                         31780002
317900     END-IF.                                                      31790002
318000                                                                  31800002
318100*----------------------------------------------------------------*31810002
318200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*31820002
318300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*31830002
318400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *31840002
318500*----------------------------------------------------------------*31850002
318600 6110-PROCESS-ITEMS.                                              31860002
318700                                                                  31870002
318800     COMPUTE PV-ITEM = 1 + ((SU088-ITEM (SU088-IDX) - 1)          31880007
318900                     / PC-ITEMS-PER-PANEL).                       31890002
319000                                                                  31900002
319100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           31910002
319200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          31920002
319300             PERFORM 6111-WRITE-LIST-QUEUE                        31930002
319400         END-IF                                                   31940002
319500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    31950002
319600                                                                  31960002
319700         PERFORM 6112-READ-LIST-QUEUE                             31970002
319800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               31980002
319900             CONTINUE                                             31990002
320000         END-IF                                                   32000002
320100     END-IF.                                                      32010002
320200                                                                  32020002
320300     COMPUTE PV-SUB = (SU088-ITEM (SU088-IDX)                     32030007
320400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              32040002
320500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         32050002
320600     MOVE LQW-SELECTED-SW (PV-SUB)                                32060002
320700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  32070002
320800     EVALUATE TRUE                                                32080002
320900         WHEN SU088-INQ (SU088-IDX)                               32090007
321000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             32100002
321100                                                                  32110002
321200         WHEN SU088-UPD (SU088-IDX)                               32120007
321300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             32130002
321400              MOVE SU088-DOOR-ID  (SU088-IDX)                     32140016
321500                               TO LQW-DOOR-ID (PV-SUB)            32150004
321600              MOVE SU088-SCAC     (SU088-IDX)                     32160016
321700                               TO LQW-SCAC (PV-SUB)               32170004
321800              MOVE SU088-TRAILER  (SU088-IDX)                     32180016
321900                               TO LQW-TRAILER (PV-SUB)            32190004
322000              MOVE SU088-TRIP-ID  (SU088-IDX)                     32200016
322100                               TO LQW-TRIP-ID (PV-SUB)            32210004
322200                                                                  32220002
322300         WHEN SU088-DEL (SU088-IDX)                               32230007
322400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             32240002
322500                                                                  32250002
322600         WHEN SU088-ERR (SU088-IDX)                               32260007
322700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             32270002
322800                                                                  32280002
322900         WHEN OTHER                                               32290002
323000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             32300002
323100                                                                  32310002
323200     END-EVALUATE.                                                32320002
323300                                                                  32330002
323400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                32340002
323500                                                                  32350002
323600*----------------------------------------------------------------*32360002
323700*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *32370002
323800*----------------------------------------------------------------*32380002
323900 6111-WRITE-LIST-QUEUE.                                           32390002
324000                                                                  32400002
324100     EXEC CICS                                                    32410002
324200         WRITEQ TS                                                32420002
324300             QUEUE (ASC-LIST-QUEUE-NAME)                          32430002
324400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     32440002
324500             ITEM  (PV-SAVE-ITEM)                                 32450002
324600             REWRITE                                              32460002
324700             RESP  (PV-CICS-RESP)                                 32470002
324800     END-EXEC.                                                    32480002
324900*                                                                 32490002
325000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32500002
325100         CONTINUE                                                 32510002
325200     ELSE                                                         32520002
325300         SET DP013-CICS-ABEND  TO  TRUE                           32530002
325400         SET DP013-NO-ROLLBACK TO  TRUE                           32540002
325500         MOVE '6111-WRITE-LIST-QUEUE' TO  DP013-PARAGRAPH         32550002
325600         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  32560002
325700                               TO  DP013-MESSAGE-TEXT(1)          32570002
325800         PERFORM DP013-0000-PROCESS-ABEND                         32580002
325900     END-IF.                                                      32590002
326000                                                                  32600002
326100*----------------------------------------------------------------*32610002
326200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*32620002
326300*----------------------------------------------------------------*32630002
326400 6112-READ-LIST-QUEUE.                                            32640002
326500     EXEC CICS                                                    32650002
326600         READQ TS                                                 32660002
326700             QUEUE (ASC-LIST-QUEUE-NAME)                          32670002
326800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     32680002
326900             ITEM  (PV-ITEM)                                      32690002
327000             RESP  (PV-CICS-RESP)                                 32700002
327100     END-EXEC.                                                    32710002
327200*                                                                 32720002
327300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32730002
327400         CONTINUE                                                 32740002
327500     ELSE                                                         32750002
327600         SET DP013-CICS-ABEND        TO TRUE                      32760002
327700         SET DP013-NO-ROLLBACK       TO TRUE                      32770002
327800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           32780002
327900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    32790002
328000                                     TO DP013-MESSAGE-TEXT(1)     32800002
328100         PERFORM DP013-0000-PROCESS-ABEND                         32810002
328200     END-IF.                                                      32820002
328300                                                                  32830099
328400*----------------------------------------------------------------*32840099
328500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*32850099
328600*----------------------------------------------------------------*32860099
328700                                                                  32870099
328800 7000-COUNT-WORKER-ROWS.                                          32880099
328900                                                                  32890099
329000     MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                     32900099
329100     MOVE ASC-PNA-STA-NBR  TO DK-ACM-LBL-STA-NBR.                 32910099
329200     MOVE LQW-DOOR-ID (LQW-IDX) TO DK-DOOR-ID.                    32920099
329300     MOVE LQW-TRIP-ID (LQW-IDX) TO DK-TRIP-ID.                    32930099
329400     MOVE LQW-ASSIGN-TMST (LQW-IDX) TO DK-TIMESTAMP.              32940099
329500                                                                  32950099
329600     EXEC SQL                                                     32960099
329700         SELECT  COUNT(*)                                         32970099
329800                ,SUT111.OPER_UNT_ID                               32980099
329900                ,SUT111.ACM_LBL_STA_NBR                           32990099
330000                ,SUT111.DOOR_ID                                   33000099
330100                ,SUT111.INBD_TRIP_ID                              33010099
330200                ,SUT111.ASGD_STRT_TMST                            33020099
330300                                                                  33030099
330400           INTO                                                   33040099
330500                 :PV-TK-COUNT                                     33050099
330600                ,:SUT00111-OPER-UNT-ID                            33060099
330700                ,:SUT00111-ACM-LBL-STA-NBR                        33070099
330800                ,:SUT00111-DOOR-ID                                33080099
330900                ,:SUT00111-INBD-TRIP-ID                           33090099
331000                ,:SUT00111-ASGD-STRT-TMST                         33100099
331100                                                                  33110099
331200           FROM  SUT_PNA_STA_WRKR    SUT111                       33120099
331300          WHERE  SUT111.OPER_UNT_ID      = :DK-OPER-UNT-ID        33130099
331400            AND  SUT111.ACM_LBL_STA_NBR  = :DK-ACM-LBL-STA-NBR    33140099
331500            AND  SUT111.DOOR_ID          = :DK-DOOR-ID            33150099
331600            AND  SUT111.INBD_TRIP_ID     = :DK-TRIP-ID            33160099
331700            AND  SUT111.ASGD_STRT_TMST   = :DK-TIMESTAMP          33170099
331800       GROUP BY  SUT111.OPER_UNT_ID                               33180099
331900                ,SUT111.ACM_LBL_STA_NBR                           33190099
332000                ,SUT111.DOOR_ID                                   33200099
332100                ,SUT111.INBD_TRIP_ID                              33210099
332200                ,SUT111.ASGD_STRT_TMST                            33220099
332300     END-EXEC.                                                    33230099
332400                                                                  33240099
332500     EVALUATE TRUE                                                33250099
332600         WHEN SQLCODE = ZERO                                      33260099
332700              CONTINUE                                            33270099
332800         WHEN SQLCODE = +100                                      33280099
332900              CONTINUE                                            33290099
333000         WHEN SQLWARN0 NOT = SPACE                                33300099
333100         WHEN SQLCODE NOT = ZERO                                  33310099
333200              MOVE '7000-COUNT-WORKER-ROWS  ' TO DP013-PARAGRAPH  33320099
333300              MOVE 'COULD NOT COUNT ROWS  '                       33330099
333400                               TO DP013-MESSAGE-TEXT (1)          33340099
333500              MOVE SQLCA       TO DP013-SQLCA                     33350099
333600              SET DP013-DB2-ABEND TO TRUE                         33360099
333700              PERFORM DP013-0000-PROCESS-ABEND                    33370099
333800     END-EVALUATE.                                                33380099
333900                                                                  33390069
334000*----------------------------------------------------------------*33400069
334100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *33410069
334200*----------------------------------------------------------------*33420069
334300 9100-READ-SEL-QUEUE.                                             33430069
334400     EXEC CICS                                                    33440069
334500         READQ TS                                                 33450069
334600             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        33460099
334700             INTO  (SU088-SELECT-RECORD)                          33470069
334800             ITEM  (ASC-SEL-ITEM)                                 33480069
334900             RESP  (PV-CICS-RESPONSE)                             33490069
335000     END-EXEC.                                                    33500069
335100                                                                  33510069
335200     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       33520069
335300         CONTINUE                                                 33530069
335400     ELSE                                                         33540069
335500         SET DP013-LOGIC-ABEND                                    33550069
335600             DP013-NO-ROLLBACK     TO TRUE                        33560069
335700         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            33570069
335800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   33580069
335900                                   TO DP013-MESSAGE-TEXT (1)      33590069
336000         PERFORM DP013-0000-PROCESS-ABEND                         33600069
336100     END-IF.                                                      33610069
336200                                                                  33620069
336300*----------------------------------------------------------------*33630069
336400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *33640069
336500*----------------------------------------------------------------*33650069
336600 9200-REWRITE-SEL-QUEUE.                                          33660069
336700     EXEC CICS                                                    33670069
336800          WRITEQ TS                                               33680069
336900              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      33690099
337000              FROM   (SU088-SELECT-RECORD)                        33700069
337100              ITEM   (ASC-SEL-ITEM)                               33710069
337200              RESP   (PV-CICS-RESPONSE)                           33720069
337300              REWRITE                                             33730069
337400     END-EXEC.                                                    33740069
337500                                                                  33750069
337600     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   33760069
337700         SET DP013-CICS-ABEND                                     33770069
337800             DP013-NO-ROLLBACK     TO TRUE                        33780069
337900         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        33790069
338000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33800069
338100                                   TO DP013-MESSAGE-TEXT (1)      33810069
338200         PERFORM DP013-0000-PROCESS-ABEND                         33820069
338300     END-IF.                                                      33830069
338400                                                                  33840002
338500*----------------------------------------------------------------*33850002
338600*    ABEND PROCESSOR MODULE                                      *33860002
338700*----------------------------------------------------------------*33870002
338800     COPY DPPD013.                                                33880002
