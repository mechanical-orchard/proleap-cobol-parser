000100****************************************************************  00010040
000200 IDENTIFICATION DIVISION.                                         00020006
000300****************************************************************  00030040
000400                                                                  00040006
000500 PROGRAM-ID.             SSKUT009.                                00050006
000600 AUTHOR.                 LIHUA LIANG.                             00060006
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070006
000800 DATE-WRITTEN            FEB 2001.                                00080006
000900 DATE-COMPILED.                                                   00090006
001000                                                                  00100006
001100****************************************************************  00110040
001200*                                                                 00120006
001300*  THIS PROGRAM WILL CREATE A FILE WHICH CONTAINS TOTAL COUNT OF  00130006
001400*  RETURN ITEMS, TOTAL RETURN AMOUNT PLUS TAX, AND TOTAL RETURN   00140006
001400*  TAX AMOUNT. THE NUMBERS BREAK DOWN INTO FOUR CATEGORIES.       00140006
001400*  RETURN WITH 30 DAYS; RETURN AFTER 30 DAYS BUT WITHIN 60 DAYS;  00140006
001400*  RETURN AFTER 61 DAYS BUT WITH 90 DAYS; AND RETURN AFTER 90     00140006
001400*  DAYS. THE DATA IS BREAK BY STORE AND BY STATE. THIS PROGRAM    00140006
001400*  EXECUTES AT FISCAL MONTH END.                                  00140006
001500*                                                                 00150006
001800*  OUTPUT: OUT01 - FILE SHOWING TOTAL COUNT ON RETURN ITEMS,      00180006
001900*                  TOTAL RETURN AMOUNT PLUS TAX, AND TOTAL TAX    00190006
002000*                  AMOUNT BY STORE, BY STATE.                     00200006
002400****************************************************************  00240040
FSH13 * HISTORY LOG:                                                            
FSH13 *                                                                         
FSH13 * DATE: 09/06/13                                                          
FSH13 * WR/IR#: CHG0062728 - FSH 2013                                           
FSH13 * PROGRAMMER: COGNIZANT                                                   
FSH13 * DESCRIPTION: REMOVED LOGIC THAT REFERENCING THE FOLLOWING               
FSH13 *              HISTORY TABLES.                                            
FSH13 *              TEPITMH                                                    
FSH13 *              TEPTRNH                                                    
FSH13 *              TEPIRTH                                                    
FSH13 *              TEPRTXH                                                    
FSH13 *              THE ABOVE TABLES REFERRED IN HIST-CSR CURSOR ONLY          
FSH13 *              BUT THIS HIST-CSR CURSOR IS JUST DECLARED BUT NOT          
FSH13 *              USED. REMOVED HIST-CSR CURSOR.                             
OUTLT ****************************************************************  00240040
OUTLT * HISTORY LOG:                                                    00530040
OUTLT *                                                                 00530040
OUTLT * DATE: 05/20/16                                                  00530040
OUTLT * WR/IR#: CHG0062728 - 10849C - OUTLET PROJECT                    00530040
OUTLT * PROGRAMMER: BARB SCHULTZ                                        00530040
OUTLT * DESCRIPTION: ADDED EPTRN.POS_TYP_CDE IS NULL STATEMENT TO THE   00530040
OUTLT *     CURSOR SO NO OUTLET STORES WILL BE PROCESSED. THIS COLUMN   00530040
OUTLT *     WILL HAVE A '001' IF IT WAS FROM AN OUTLET POS SYSTEM,      00530040
OUTLT *     OTHERWISE IT WILL HAVE NULLS FOR KOHLS POS.  THE TAX        00530040
OUTLT *     DEPT DETERMINED THEY DID NOT WANT OUTLET TRANSACTIONS ON    00530040
OUTLT *     THIS OUTPUT FILE.                                           00530040
002400****************************************************************  00530040
STCFEE* CHANGE #: CHG0160001     FIND 'STCFEE'      DATE:2016-11-01             
STCFEE* PROGRAMMER: JIM HUNTER                                                  
STCFEE* ----------------------                                                  
STCFEE* REPLACING CALCULATIONS USING CUST CHARGED AMT TO GET SALES AND          
STCFEE* TAX AMOUNTS WITH THE ACTUAL TRANSACTION TOTALS                          
STCFEE* FOR THE SALES TAX COMPLIANCE PROJECT.                                   
STCFEE******************************************************************        
010900 ENVIRONMENT DIVISION.                                            00540006
011000****************************************************************  00550040
011100                                                                  00560006
011200 CONFIGURATION SECTION.                                           00570006
011300                                                                  00580006
011400 SOURCE-COMPUTER.        IBM-3090.                                00590006
011500                                                                  00600006
011600 OBJECT-COMPUTER.        IBM-3090.                                00610006
011700                                                                  00620006
011800 INPUT-OUTPUT SECTION.                                            00630006
011900                                                                  00640006
012000 FILE-CONTROL.                                                    00650006
012100                                                                  00660006
005900     SELECT POS-DATE-CARD-FILE                                    00670099
006000         ASSIGN TO INP01.                                         00680003
006100                                                                  00690001
005900     SELECT STATE-FILE                                            00670099
006000         ASSIGN TO INP02.                                         00680003
006100                                                                  00690001
012500     SELECT OUTPUT-FILE                                           00700006
012600         ASSIGN TO OUT01.                                         00710006
012700                                                                  00720006
012900***************************************************************** 00740040
013000 DATA DIVISION.                                                   00750006
013100***************************************************************** 00760040
013200                                                                  00770006
013300 FILE SECTION.                                                    00780006
007800                                                                  00860001
007200 FD  POS-DATE-CARD-FILE                                           00800099
007300     RECORDING MODE IS F                                          00810001
007400     BLOCK CONTAINS 0 RECORDS                                     00820001
007500     LABEL RECORDS ARE STANDARD.                                  00830001
007600                                                                  00840001
007700 01  POS-DATE-CARD-RECORD            PIC X(80).                   00850099
013400                                                                  00790006
007200 FD  STATE-FILE                                                   00800099
007300     RECORDING MODE IS F                                          00810001
007400     BLOCK CONTAINS 0 RECORDS                                     00820001
007500     LABEL RECORDS ARE STANDARD.                                  00830001
007600                                                                  00840001
007700 01  STATE-RECORD                    PIC X(80).                   00850099
013400                                                                  00790006
014200 FD  OUTPUT-FILE                                                  00870006
014300     RECORDING MODE IS F                                          00880006
014400     BLOCK CONTAINS 0  RECORDS.                                   00890006
014500                                                                  00900006
014600 01  OUTPUT-RECORD                    PIC  X(80).                 00910006
014800                                                                  00930006
014900***************************************************************** 00940040
015000 WORKING-STORAGE SECTION.                                         00950006
015100***************************************************************** 00960040
015400                                                                  00990006
015200 01  FILLER                           PIC  X(50) VALUE            00970006
015300     ' *** WORKING STORAGE STARTS HERE FOR SSKUT009 *** '.        00980006
015400                                                                  00990006
016600***************************************************************** 01110040
016700*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01120006
016800***************************************************************** 01130040
017600                                                                  01210006
016900     COPY DPWS500.                                                01140006
017000                                                                  01150006
017100 01  AC-ABEND-CODE                    PIC S9(04) VALUE ZERO       01160006
017200                                                 COMP SYNC.       01170006
017400     88  AC-CONTROL-CARD-ERROR                   VALUE +4003.     01190006
017400     88  AC-DB2-ERROR                            VALUE +4013.     01190006
017500     88  AC-CALENDAR-ROUTINE-ERROR               VALUE +4019.     01200006
017700                                                                  01220006
017900 01  PS-PROGRAM-SWITCHES.                                         01240006
018000     05  PS-END-OF-CURSOR-SW          PIC  X(01) VALUE 'N'.       01270012
018100         88  PS-END-OF-CURSOR-YES                VALUE 'Y'.       01280012
018100         88  PS-END-OF-CURSOR-NO                 VALUE 'N'.       01280012
018000     05  PS-END-OF-FILE-SW            PIC  X(01) VALUE 'N'.       01270012
018100         88  PS-END-OF-FILE-YES                  VALUE 'Y'.       01280012
018000     05  PS-END-OF-STATE-FILE-SW      PIC  X(01) VALUE 'N'.       01270012
018100         88  PS-END-OF-STATE-FILE-YES            VALUE 'Y'.       01280012
018100         88  PS-END-OF-STATE-FILE-NO             VALUE 'N'.       01280012
018000     05  PS-FIRST-TIME-SW             PIC  X(01) VALUE 'Y'.       01270012
018100         88  PS-FIRST-TIME-YES                   VALUE 'Y'.       01280012
018100         88  PS-FIRST-TIME-NO                    VALUE 'N'.       01280012
020800                                                                  01380006
020900 01  PC-CONSTANTS.                                                01390006
021100     05  PC-ROW-NOT-FOUND             PIC S9(04) VALUE +100       01410006
021200                                                 COMP SYNC.       01420006
021300     05  PC-PROGRAM-NAME              PIC  X(08) VALUE            01440006
021400                                                 'SSKUT009'.      01450006
021300     05  PC-TOTAL                     PIC  X(05) VALUE 'TOTAL'.   01440006
026300                                                                  01830006
009200 01  CC-DATE-CARD.                                                00860000
009800     05  CC-END-DATE                   PIC  X(10) VALUE SPACE.    00890000
009600     05  FILLER                        PIC  X(70) VALUE SPACE.    00900000
011100                                                                  00910000
009200 01  CC-STATE-CONTROL-CARD.                                       00920000
009500     05  CC-STATE                      PIC  X(02) VALUE SPACE.    00930000
009600     05  FILLER                        PIC  X(78) VALUE SPACE.    00950000
011100                                                                  00960000
026400 01  PV-MISC-FIELDS.                                              01840006
023100     05  PV-ITEM-CNT                  PIC  9(09) VALUE ZERO.      01530012
023100     05  PV-LINE-SPACING              PIC  9(01) VALUE 1.         01530012
026800     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     01880048
026900     05  PV-OPERATION-MSG-1           PIC  X(40) VALUE SPACE.     01890048
027000     05  PV-OPERATION-MSG-2           PIC  X(40) VALUE SPACE.     01900048
027100     05  PV-DB2-OPERATION             PIC  X(30) VALUE SPACE.     01910048
027100     05  PV-FISCAL-START-DATE         PIC  X(10) VALUE SPACE.     01910048
027100     05  PV-FISCAL-END-DATE           PIC  X(10) VALUE SPACE.     01910048
023100     05  PV-TAX-AMT                   PIC  9(04)V99 VALUE ZERO.   01530012
023100     05  PV-ITM-AMT                   PIC  9(04)V99 VALUE ZERO.   01530012
023100     05  PV-PRINT-RECORD              PIC  X(200) VALUE SPACE.    01530012
034600                                                                  02210006
026400 01  HL-HEADER-LINE.                                              01840006
023100     05  FILLER                       PIC  X(08) VALUE 'BEG DATE'.01530012
023100     05  FILLER                       PIC  X(01) VALUE ','.       01530012
023100     05  FILLER                       PIC  X(08) VALUE 'END DATE'.01530012
023100     05  FILLER                       PIC  X(01) VALUE ','.       01530012
023100     05  FILLER                       PIC  X(06) VALUE 'STATE '.  01530012
023100     05  FILLER                       PIC  X(05) VALUE 'CODE,'.   01530012
023100     05  FILLER                       PIC  X(06) VALUE 'STORE '.  01530012
023100     05  FILLER                       PIC  X(07) VALUE 'NUMBER,'. 01530012
023100     05  FILLER                       PIC  X(08) VALUE 'CATEGORY'.01530012
023100     05  FILLER                       PIC  X(01) VALUE ','.       01530012
023100     05  FILLER                       PIC  X(05) VALUE 'ITEM '.   01530012
023100     05  FILLER                       PIC  X(06) VALUE 'COUNT,'.  01530012
023100     05  FILLER                       PIC  X(06) VALUE 'TOTAL '.  01530012
023100     05  FILLER                       PIC  X(04) VALUE 'AMT,'.    01530012
023100     05  FILLER                       PIC  X(08) VALUE 'TAX AMT,'.01530012
034600                                                                  02210006
034700***************************************************************** 02220040
034800*  TABLE TO HOLD DATA UNTIL READY TO PRINT.                       02230006
035000***************************************************************** 02250040
035100 01  PV-DATE-CTG.                                                 02260017
035200     05  PV-STATE                     PIC  X(02) VALUE SPACE.     02270071
035200     05  PV-STORE                     PIC  9(04) VALUE ZERO.      02270071
035200     05  PV-DATE-CTG-TABLE            OCCURS 4 TIMES              02270071
035300                                      INDEXED BY PV-SUB.          02271071
035400         10  PV-CTG                   PIC  X(09) VALUE SPACE.     02280046
035400         10  PV-TOT-ITEM-RTN-CNT      PIC  9(09) VALUE ZERO.      02280046
035500         10  PV-TOT-RTN-AMT           PIC  9(12)V99 VALUE ZERO.   02300046
035600         10  PV-TOT-TAX-AMT           PIC  9(10)V99 VALUE ZERO.   02320046
036800                                                                  02430006
034700***************************************************************** 02220040
034800*  TABLE TO HOLD DATA UNTIL READY TO PRINT.                       02230006
035000***************************************************************** 02250040
035100 01  PV-DATE-CTG-2.                                               02260017
035200     05  PV-STATE-2                   PIC  X(02) VALUE SPACE.     02270071
035200     05  PV-STORE-2                   PIC  9(04) VALUE ZERO.      02270071
035200     05  PV-DATE-CTG-TABLE-2          OCCURS 4 TIMES              02270071
035300                                      INDEXED BY PV-SUB-2.        02271071
035400         10  PV-CTG-2                 PIC  X(09) VALUE SPACE.     02280046
035400         10  PV-TOT-ITEM-RTN-CNT-2    PIC  9(09) VALUE ZERO.      02280046
035500         10  PV-TOT-RTN-AMT-2         PIC  9(12)V99 VALUE ZERO.   02300046
035600         10  PV-TOT-TAX-AMT-2         PIC  9(10)V99 VALUE ZERO.   02320046
036800                                                                  02430006
048000***************************************************************** 03770040
048100*  FILE DETAIL DATA.                                              03780006
048400***************************************************************** 03810040
048500 01  DL-DETAIL-LINE.                                              03820006
048600     05  DL-BEG-DATE                  PIC  X(10) VALUE SPACE.     03830046
048600     05  FILLER                       PIC  X(01) VALUE ','.       03830046
048600     05  DL-END-DATE                  PIC  X(10) VALUE SPACE.     03830046
048600     05  FILLER                       PIC  X(01) VALUE ','.       03830046
048600     05  DL-STATE                     PIC  X(02) VALUE SPACE.     03830046
048600     05  FILLER                       PIC  X(01) VALUE ','.       03830046
048600     05  DL-STORE                     PIC  9(04) VALUE ZERO.      03830046
048600     05  FILLER                       PIC  X(01) VALUE ','.       03830046
048600     05  DL-CTG                       PIC  X(09) VALUE SPACE.     03830046
048600     05  FILLER                       PIC  X(01) VALUE ','.       03830046
048600     05  DL-TOT-ITEM-RTN-CNT          PIC  Z(08)9 VALUE ZERO.     03830046
048600     05  FILLER                       PIC  X(01) VALUE ','.       03830046
048700     05  DL-TOT-RTN-AMT               PIC  Z(11)9.99 VALUE ZERO.  03830146
048600     05  FILLER                       PIC  X(01) VALUE ','.       03830046
048600     05  DL-TOT-TAX-AMT               PIC  Z(09)9.99 VALUE ZERO.  03830046
053000                                                                  03861046
053100***************************************************************** 03870040
053200*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            03880006
053300***************************************************************** 03890040
053400     COPY DPWS004.                                                03900006
053500                                                                  03910006
053600***************************************************************** 03920040
053700*  DB2 COMMUNICATION AREA.                                        03930006
053800***************************************************************** 03940040
053900     EXEC SQL                                                     03950006
054000          INCLUDE SQLCA                                           03960006
054100     END-EXEC.                                                    03970006
054200                                                                  03980006
054300***************************************************************** 03990040
054400*  DB2 TABLE TEPTRN - TRANSACTION TABLE                           04000006
054500***************************************************************** 04010040
054600     EXEC SQL                                                     04040006
054700          INCLUDE TEPTRN                                          04050077
054800     END-EXEC.                                                    04060006
054900                                                                  04070006
055000***************************************************************** 04080040
055100*  DB2 TABLE TEPPART - PARTITION TABLE                            04090006
055200***************************************************************** 04100040
055300     EXEC SQL                                                     04110006
055400          INCLUDE TEPPART                                         04120006
055500     END-EXEC.                                                    04130006
055600                                                                  04140006
056400***************************************************************** 04220040
056500*  DB2 TABLE TEPIRT - ITEM RETURN INFORMATION TABLE               04230009
056600***************************************************************** 04240040
056700     EXEC SQL                                                     04250006
056800          INCLUDE TEPIRT                                          04260009
056900     END-EXEC.                                                    04270006
057000                                                                  04280006
057100***************************************************************** 04290040
057200*  DB2 TABLE TEPITM - TRANSACTION ITEM TABLE                      04300009
057300***************************************************************** 04310040
057400     EXEC SQL                                                     04340006
057500          INCLUDE TEPITM                                          04350077
057600     END-EXEC.                                                    04360006
057700                                                                  04370006
057800***************************************************************** 04290040
057900*  DB2 TABLE XST_LOC - STORE TABLE                                04300009
058000***************************************************************** 04310040
058100     EXEC SQL                                                     04340006
058200          INCLUDE XST00001                                        04350077
058300     END-EXEC.                                                    04360006
058400                                                                  04370006
060000***************************************************************** 04380040
060100*  DB2 TABLE TEPRTX - ITEM TAX RATE TABLE                                 
060200***************************************************************** 04410040
060300     EXEC SQL                                                     04420006
060400          INCLUDE TEPRTX                                          04430009
060500     END-EXEC.                                                            
060600                                                                  04450006
STCFEE******************************************************************        
STCFEE*  LINE ITEM SERVICE FEES TABLE                                           
STCFEE******************************************************************        
STCFEE     EXEC SQL                                                             
STCFEE         INCLUDE TEPLIS                                                   
STCFEE     END-EXEC.                                                            
STCFEE                                                                          
062100***************************************************************** 04600040
062200*  CURSOR TO RETRIEVE OPERATIONAL DATA.                           04610012
062500***************************************************************** 04640040
062600     EXEC SQL                                                     04650006
062700        DECLARE OPER-CSR CURSOR FOR                               04660012
065900           SELECT  RTX.TX_RT_PCT                                  04980009
066000                  ,PRT.SLS_DTE                                    04990009
066100                  ,IRT.ORIG_SLS_DTE                               05000009
066200                  ,ITM.CUST_CHRGD_AMT                             05010009
066200                  ,IRT.PARTN_NBR                                  05010009
066200                  ,IRT.STR_NBR                                    05010009
066200                  ,IRT.RGST_ID                                    05010009
066200                  ,IRT.TRN_NBR                                    05010009
STCFEE                  ,IRT.STRT_TM                                    05010009
STCFEE                  ,IRT.SLS_CORR_SEQ_NBR                           05120009
066200                  ,IRT.LNE_ITM_SEQ_NBR                            05010009
STCFEE                  ,ITM.SBJCT_TO_TX_AMT                            05010009
STCFEE                  ,ITM.NET_CHRGD_AMT                              05010009
STCFEE                  ,ITM.TX_AMT                                     05010009
066500            FROM  TEPIRT  IRT                                     05040009
066600                 ,TEPTRN  TRN                                     05050077
066700                 ,TEPITM  ITM                                     05060009
066700                 ,TEPRTX  RTX                                     05060009
066700                 ,TEPPART PRT                                     05060009
066700                 ,XST_LOC STR                                     05060009
066800           WHERE  IRT.PARTN_NBR         = TRN.PARTN_NBR           05070009
066800             AND  IRT.PARTN_NBR         = ITM.PARTN_NBR           05070009
066800             AND  IRT.PARTN_NBR         = RTX.PARTN_NBR           05070009
066800             AND  IRT.PARTN_NBR         = PRT.PARTN_NBR           05070009
066800                                                                  05070009
066900             AND  IRT.STR_NBR           = TRN.STR_NBR             05080009
066900             AND  IRT.STR_NBR           = ITM.STR_NBR             05080009
066900             AND  IRT.STR_NBR           = RTX.STR_NBR             05080009
067800             AND  IRT.STR_NBR           = STR.LOC_NBR             05170046
067800             AND  IRT.STR_NBR           = IRT.ORIG_STR_NBR        05170046
066800                                                                  05070009
067000             AND  IRT.RGST_ID           = TRN.RGST_ID             05090009
067000             AND  IRT.RGST_ID           = ITM.RGST_ID             05090009
067000             AND  IRT.RGST_ID           = RTX.RGST_ID             05090009
066800                                                                  05070009
067100             AND  IRT.TRN_NBR           = TRN.TRN_NBR             05100009
067100             AND  IRT.TRN_NBR           = ITM.TRN_NBR             05100009
067100             AND  IRT.TRN_NBR           = RTX.TRN_NBR             05100009
066800                                                                  05070009
067200             AND  IRT.STRT_TM           = TRN.STRT_TM             05110022
067200             AND  IRT.STRT_TM           = ITM.STRT_TM             05110022
067200             AND  IRT.STRT_TM           = RTX.STRT_TM             05110022
066800                                                                  05070009
067300             AND  IRT.SLS_CORR_SEQ_NBR  = TRN.SLS_CORR_SEQ_NBR    05120009
067300             AND  IRT.SLS_CORR_SEQ_NBR  = ITM.SLS_CORR_SEQ_NBR    05120009
067300             AND  IRT.SLS_CORR_SEQ_NBR  = RTX.SLS_CORR_SEQ_NBR    05120009
066800                                                                  05070009
067400             AND  IRT.LNE_ITM_SEQ_NBR   = ITM.LNE_ITM_SEQ_NBR     05130009
067600             AND  TRN.TRN_STAT_CDE     IN ('Z', 'L')              05150071
OUTLT              AND  TRN.POS_TYP_CDE      IS NULL                    05150071
067700             AND  TRN.VOID_ABRT_CDE     = 'N'                     05160046
067800             AND  ITM.RCPT_TX_TOT_CDE   = RTX.RCPT_TX_TOT_CDE     05170046
067800             AND  ITM.LIV_RSLU_CDE     IN ('+', '-')              05170046
067800             AND  PRT.SLS_DTE     BETWEEN :PV-FISCAL-START-DATE   05170046
067800                                      AND :PV-FISCAL-END-DATE     05170046
067800             AND  STR.ST_CDE            = :CC-STATE               05170046
067800             AND  STR.LOC_TYP_CDE       = 'DS'                    05170046
068000         WITH UR                                                  05190006
068100     END-EXEC.                                                    05200006
068200                                                                  05210006
086200***************************************************************** 05723006
086500 PROCEDURE DIVISION.                                              05750006
086200***************************************************************** 05723006
086600                                                                  05760006
086700***************************************************************** 05770040
087100 0000-MAINLINE-PARAGRAPH.                                         05810006
086900*     PROGRAM FLOW CONTROL.                                       05790009
087000***************************************************************** 05800040
087200                                                                  05820006
087300     PERFORM 1000-HOUSE-KEEPING.                                  05830006
087400                                                                  05840006
087500     PERFORM 2000-PROCESS-CURSOR                                  05850064
087600         UNTIL PS-END-OF-STATE-FILE-YES.                          05860014
087700                                                                  05880025
056000     CLOSE POS-DATE-CARD-FILE                                     08840000
056001           STATE-FILE                                             08850000
056010           OUTPUT-FILE.                                           08860000
087500*    PERFORM 6000-EOJ-ROUTINE.                                    05850064
087700                                                                  05880025
088100     DISPLAY '*************** SSKUT009 ***************'           05920009
088500     DISPLAY 'MASTER CURSOR ROWS FETCHED.....' PV-ITEM-CNT.       06000013
089000                                                                  06050006
089100     STOP RUN.                                                    06060006
089200                                                                  06070006
055124***********************************************************       08590000
055700 1000-HOUSE-KEEPING.                                              08820000
055430*     OPEN FILES.                                                 08760000
055440*     PROCESS CONTROL CARDS.                                      08770000
055124***********************************************************       08590000
055800                                                                  08830000
056000     OPEN INPUT  POS-DATE-CARD-FILE                               08840000
056001                 STATE-FILE                                       08850000
056010          OUTPUT OUTPUT-FILE.                                     08860000
056100                                                                  08870000
027200     READ POS-DATE-CARD-FILE        INTO CC-DATE-CARD             01970002
027200        AT END                                                    01980002
027200           SET PS-END-OF-FILE-YES     TO TRUE.                    01990002
027200                                                                  02000002
027200     IF PS-END-OF-FILE-YES                                        02010002
027200        MOVE 'NO DATE TO PROCESS'     TO PV-OPERATION-MSG-1       02020003
027200        SET AC-CONTROL-CARD-ERROR     TO TRUE                     02030002
027200        PERFORM 9999-ABEND                                        02040002
027200     END-IF.                                                      02050002
027200                                                                  02060002
027200     DISPLAY PC-PROGRAM-NAME                                      02070002
027200             ' - CONTROL CARD = (' CC-DATE-CARD ')'.              02080002
027200                                                                  02090005
027200     PERFORM 1115-CONVERT-INPUT-DATE.                             02140005
027200                                                                  02170003
027200     READ STATE-FILE                INTO CC-STATE-CONTROL-CARD    02180003
027200        AT END                                                    02190003
027200           SET PS-END-OF-STATE-FILE-YES TO TRUE.                  02200003
027200                                                                  02210003
027200     IF PS-END-OF-STATE-FILE-YES                                  02220003
027200        MOVE 'NO STATE TO PROCESS'    TO PV-OPERATION-MSG-1       02230003
027200        SET AC-CONTROL-CARD-ERROR     TO TRUE                     02240003
027200        PERFORM 9999-ABEND                                        02250003
027200     END-IF.                                                      02260003
056112                                                                  08900000
079798******************************************************************02280005
079799 1115-CONVERT-INPUT-DATE.                                         02290005
079800*     CALL KOHLS CALENDAR ROUTINE TO VALIDATE THE INPUT DATE AND  02300005
079800*     GETS STARTING FISCAL CALENDAR MONTH DATE.                   02300005
079803******************************************************************02310005
079804                                                                  02320005
079805     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02330005
079806                                                                  02340005
079807     SET DPG51-FISCAL-454-CALENDAR     TO TRUE.                   02350005
079808     SET DPG52-LK-DTE-ISO-FMT          TO TRUE.                   02360005
079809     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   02370007
079810     MOVE CC-END-DATE                  TO DPG52-LK-DATE-INPUT.    02380005
079811                                                                  02390005
079812     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    02400005
079813                                             DPG54 DPG55 DPG56.   02410005
079814     EVALUATE TRUE                                                02420005
079815         WHEN DPG54-SEVERE-ERROR                                  02430005
079816         WHEN DPG54-DATE-INVALID                                  02440005
079817             MOVE '1115-CONVERT-INPUT-DATE'                       02450005
079818                                           TO PV-PARAGRAPH-NAME   02460005
079819             MOVE 'ERROR CONVERTING INPUT CARD DATE'              02470005
079820                                           TO PV-OPERATION-MSG-1  02480005
079821             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                02490005
079822             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  02500005
079823             PERFORM 9999-ABEND                                   02510005
079824     END-EVALUATE.                                                02520005
079824                                                                  02520005
079824     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-FISCAL-START-DATE.     02520005
079824     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO PV-FISCAL-END-DATE.       02520005
027300                                                                  02530001
094200***************************************************************** 06570040
094900 1116-CALL-KOHLS-ROUTINE.                                         06640006
094400*     CALL KOHLS CALENDAR ROUTINE TO CALCULATE DAYS BETWEEN       06590006
094400*     PURCHASE AND RETURN DATE.                                   06590006
094700***************************************************************** 06620040
095000                                                                  06650006
095100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06660006
095200                                                                  06670006
095300     SET  DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                    06680006
095400     SET  DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                    06690006
095500     SET  DPG52-LK-DTE-ISO-FMT        TO TRUE.                    06700006
095500     SET  DPG53-LK-CMPR-DTE-ISO-FMT   TO TRUE.                    06700006
095600     MOVE EPPART-SLS-DTE              TO DPG52-LK-DATE-INPUT.     06710006
095600     MOVE EPIRT-ORIG-SLS-DTE          TO DPG53-LK-CMPR-DATE-INPUT.06710006
095700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    06720006
095800                                             DPG54 DPG55 DPG56.   06730006
095900     EVALUATE TRUE                                                06740006
096000         WHEN DPG54-SEVERE-ERROR                                  06750006
096100         WHEN DPG54-DATE-INVALID                                  06760006
096200            MOVE '1116-CALL-KOHLS-ROUTINE'                        06770006
096300                                      TO PV-PARAGRAPH-NAME        06780006
096400            MOVE 'ERROR CONVERTING INPUT CARD DATE'               06790006
096500                                      TO PV-OPERATION-MSG-1       06800006
096600            SET AC-CALENDAR-ROUTINE-ERROR                         06810006
096700                                      TO TRUE                     06820006
096800            MOVE DPG54-ERROR-MESSAGE                              06830006
096900                                      TO PV-OPERATION-MSG-2       06840006
097000            PERFORM 9999-ABEND                                    06850006
097100     END-EVALUATE.                                                06860006
097200                                                                  06870006
079798******************************************************************02280005
058375 2000-PROCESS-CURSOR.                                             09670000
058366*     PROCESS MAIN CURSOR.                                        09580000
079798******************************************************************02280005
058376                                                                  09680000
027200     PERFORM 3000-OPEN-CURSOR.                                    02590003
027300                                                                  02620003
025400     PERFORM 4000-FETCH-CURSOR                                    02690003
025500        UNTIL PS-END-OF-CURSOR-YES.                               02700003
025600                                                                  02710003
025400     PERFORM 5000-CLOSE-CURSOR.                                   02720003
025900                                                                  02730003
027200     READ STATE-FILE                INTO CC-STATE-CONTROL-CARD    02740003
027200        AT END                                                    02750003
027200           SET PS-END-OF-STATE-FILE-YES TO TRUE.                  02760003
027200                                                                  02770003
025500     IF PS-END-OF-STATE-FILE-NO                                   02780003
025500        SET PS-END-OF-CURSOR-NO         TO TRUE                   02780003
025500        MOVE SPACE                      TO PV-STATE               02780003
025500        MOVE ZERO                       TO PV-STORE               02780003
025500     END-IF.                                                      02780003
027200                                                                  02790003
094200***************************************************************** 06570040
094900 2200-EVALUATE-DAYS.                                              06640006
094400*     EVALUATE THE NUMBER OF DAYS RETURNED FROM THE CALENDAR      06590006
094500*     ROUTINE.                                                    06600006
094700***************************************************************** 06620040
095000                                                                  06650006
095100     EVALUATE TRUE                                                06660006
095200        WHEN DPG55-DAYS-DIFFERENCE < 31                           06670006
105500           ADD 1                      TO PV-TOT-ITEM-RTN-CNT(1)         40
105500           ADD PV-ITM-AMT             TO PV-TOT-RTN-AMT(1)              40
105500           ADD PV-TAX-AMT             TO PV-TOT-TAX-AMT(1)              40
095200        WHEN DPG55-DAYS-DIFFERENCE < 61                           06670006
105500           ADD 1                      TO PV-TOT-ITEM-RTN-CNT(2)         40
105500           ADD PV-ITM-AMT             TO PV-TOT-RTN-AMT(2)              40
105500           ADD PV-TAX-AMT             TO PV-TOT-TAX-AMT(2)              40
095200        WHEN DPG55-DAYS-DIFFERENCE < 91                           06670006
105500           ADD 1                      TO PV-TOT-ITEM-RTN-CNT(3)         40
105500           ADD PV-ITM-AMT             TO PV-TOT-RTN-AMT(3)              40
105500           ADD PV-TAX-AMT             TO PV-TOT-TAX-AMT(3)              40
095200        WHEN DPG55-DAYS-DIFFERENCE > 90                           06670006
105500           ADD 1                      TO PV-TOT-ITEM-RTN-CNT(4)         40
105500           ADD PV-ITM-AMT             TO PV-TOT-RTN-AMT(4)              40
105500           ADD PV-TAX-AMT             TO PV-TOT-TAX-AMT(4)              40
095300     END-EVALUATE.                                                06680006
097200                                                                  06870006
088600     ADD 1                            TO PV-ITEM-CNT.             06010006
097200                                                                  06870006
089500***************************************************************** 06100040
090000 3000-OPEN-CURSOR.                                                06150006
089700*     OPEN CURSOR.                                                06120006
089900***************************************************************** 06140040
090100                                                                  06160006
090500     EXEC SQL                                                     06200006
090600        OPEN OPER-CSR                                             06210009
090500     END-EXEC.                                                    06200006
109800                                                                  07860006
109800     IF NOT SQLCODE = ZERO                                        07860006
110300        MOVE '3000-OPEN-CURSOR'       TO PV-PARAGRAPH-NAME        07910040
110500        MOVE SQLCODE                  TO PV-DB2-OPERATION         07930024
110700        PERFORM 9100-SQL-ABEND                                    07950006
110800     END-IF.                                                      07960006
110900                                                                  07970006
104200***************************************************************** 07500040
104600 4000-FETCH-CURSOR.                                               07540017
104400*     FETCH OPERATIONAL CURSOR.                                   07520014
104500***************************************************************** 07530040
104700                                                                  07550014
104800     EXEC SQL                                                     07560040
104900        FETCH  OPER-CSR                                           07570040
104900         INTO :EPRTX-TX-RT-PCT                                    07570040
105000             ,:EPPART-SLS-DTE                                             
105100             ,:EPIRT-ORIG-SLS-DTE                                       44
105200             ,:EPITM-CUST-CHRGD-AMT                                       
105200             ,:EPIRT-PARTN-NBR                                            
105200             ,:EPIRT-STR-NBR                                              
105200             ,:EPIRT-RGST-ID                                              
105200             ,:EPIRT-TRN-NBR                                              
STCFEE             ,:EPIRT-STRT-TM                                      05010009
STCFEE             ,:EPIRT-SLS-CORR-SEQ-NBR                             05120009
105200             ,:EPITM-LNE-ITM-SEQ-NBR                                      
STCFEE             ,:EPITM-SBJCT-TO-TX-AMT                                      
STCFEE             ,:EPITM-NET-CHRGD-AMT                                        
STCFEE             ,:EPITM-TX-AMT                                               
105300     END-EXEC.                                                            
105400                                                                          
105500     EVALUATE SQLCODE                                                   40
105500        WHEN ZERO                                                       40
105500           PERFORM 4500-EVAL-STORE-STATE                                40
105500           PERFORM 1116-CALL-KOHLS-ROUTINE                              40
105500           PERFORM 2200-EVALUATE-DAYS                                   40
105500        WHEN PC-ROW-NOT-FOUND                                           40
105500           SET PS-END-OF-CURSOR-YES   TO TRUE                           40
105500                                                                        40
105500           IF PS-FIRST-TIME-YES                                         40
105500              MOVE HL-HEADER-LINE     TO PV-PRINT-RECORD                40
114100              PERFORM 8000-WRITE-REPORT-LINE                      08245073
105500           END-IF                                                       40
105500                                                                        40
114100           MOVE 'WITHIN 30'           TO PV-CTG (1)               08245073
114100           MOVE 'WITHIN 30'           TO PV-CTG (1)               08245073
114100           MOVE 'WITHIN 60'           TO PV-CTG (2)               08245073
114100           MOVE 'WITHIN 90'           TO PV-CTG (3)               08245073
114100           MOVE 'EXCEED 90'           TO PV-CTG (4)               08245073
114100                                                                  08245073
105500           PERFORM 7000-PRINT-STORE-INFO VARYING PV-SUB                 40
105500              FROM 1 BY 1                                               40
105500                 UNTIL PV-SUB > 4                                       40
114100                                                                  08245073
114100           PERFORM 8000-WRITE-REPORT-LINE                         08245073
114100                                                                  08245073
114100*          MOVE PV-STATE              TO PV-STATE-2               08245073
114100*          MOVE ZEROS                 TO PV-STORE-2               08245073
114100*          MOVE 'WITHIN 30'           TO PV-CTG-2 (1)             08245073
114100*          MOVE 'WITHIN 60'           TO PV-CTG-2 (2)             08245073
114100*          MOVE 'WITHIN 90'           TO PV-CTG-2 (3)             08245073
114100*          MOVE 'EXCEED 90'           TO PV-CTG-2 (4)             08245073
105500*          PERFORM 7500-PRINT-STATE-INFO VARYING PV-SUB-2               40
105500*             FROM 1 BY 1                                               40
105500*                UNTIL PV-SUB-2 > 4                                     40
114100*          PERFORM 8000-WRITE-REPORT-LINE                         08245073
105500        WHEN OTHER                                                      40
110300           MOVE '4000-FETCH-CURSOR'   TO PV-PARAGRAPH-NAME        07910040
110500           MOVE SQLCODE               TO PV-DB2-OPERATION         07930024
110700           PERFORM 9100-SQL-ABEND                                 07950006
105500     END-EVALUATE.                                                      40
105600                                                                  07590040
104200***************************************************************** 07500040
104600 4500-EVAL-STORE-STATE.                                           07540017
104400*     CHECK IF THERE'S A CHANGE IN STORE OR STATE.                07520014
104500***************************************************************** 07530040
104700                                                                  07550014
105500     IF PV-STATE                       = SPACE                          40
105500        SET PS-FIRST-TIME-NO          TO TRUE                           40
105500        MOVE CC-STATE                 TO PV-STATE                       40
105500        MOVE EPIRT-STR-NBR            TO PV-STORE                       40
114100        MOVE HL-HEADER-LINE           TO PV-PRINT-RECORD          08245073
114100        PERFORM 8000-WRITE-REPORT-LINE                            08245073
105500     ELSE                                                               40
105500        IF CC-STATE                   = PV-STATE                        40
105500           IF EPIRT-STR-NBR           = PV-STORE                        40
105500              CONTINUE                                                  40
105500           ELSE                                                         40
114100              MOVE 'WITHIN 30'        TO PV-CTG (1)               08245073
114100              MOVE 'WITHIN 60'        TO PV-CTG (2)               08245073
114100              MOVE 'WITHIN 90'        TO PV-CTG (3)               08245073
114100              MOVE 'EXCEED 90'        TO PV-CTG (4)               08245073
105500              PERFORM 7000-PRINT-STORE-INFO VARYING PV-SUB              40
105500                 FROM 1 BY 1                                            40
105500                    UNTIL PV-SUB > 4                                    40
105500              MOVE EPIRT-STR-NBR        TO PV-STORE                     40
114100              PERFORM 8000-WRITE-REPORT-LINE                      08245073
105500           END-IF                                                       40
105500        END-IF                                                          40
105500     END-IF.                                                            40
105500                                                                        40
STCFEE     MOVE EPITM-TX-AMT         TO PV-TAX-AMT.                           40
STCFEE**   SINCE PV-TAX-AMT IS NOT SIGNED AND THIS PROGRAM ONLY               40
STCFEE**   PROCESSES RETURNS, IT NEEDS TO BE SUBTRACTED FROM                  40
STCFEE**   NET-CHARGED-AMOUNT (EPITM-NET-CHRGD-AMT AND EPLIS-SRVC-AMT         40
STCFEE**   WILL BOTH BE NEGATIVE VALUES.                                      40
STCFEE     PERFORM 4600-GET-FEE-AMT.                                            
STCFEE     COMPUTE PV-ITM-AMT = EPITM-NET-CHRGD-AMT                           40
STCFEE                        - PV-TAX-AMT                                    40
STCFEE                        + EPLIS-SRVC-AMT.                               40
STCFEE                                                                  07590040
STCFEE                                                                        40
STCFEE*****************************************************************         
STCFEE* GET THE FEES FOR THE ITEM                                               
STCFEE*****************************************************************         
STCFEE 4600-GET-FEE-AMT.                                                        
STCFEE                                                                          
STCFEE     EXEC SQL                                                             
STCFEE       SELECT  SUM(SRVC_AMT)                                              
STCFEE         INTO  :EPLIS-SRVC-AMT                                            
STCFEE         FROM  TEPLIS                                                     
STCFEE        WHERE  PARTN_NBR          = :EPIRT-PARTN-NBR                      
STCFEE          AND  STR_NBR            = :EPIRT-STR-NBR                        
STCFEE          AND  RGST_ID            = :EPIRT-RGST-ID                        
STCFEE          AND  TRN_NBR            = :EPIRT-TRN-NBR                        
STCFEE          AND  STRT_TM            = :EPIRT-STRT-TM                        
STCFEE          AND  SLS_CORR_SEQ_NBR   = :EPIRT-SLS-CORR-SEQ-NBR               
STCFEE          AND  LNE_ITM_SEQ_NBR    = :EPITM-LNE-ITM-SEQ-NBR                
STCFEE          AND  SRVC_TYP_CDE       = 'F'                                   
STCFEE       WITH UR                                                            
STCFEE     END-EXEC.                                                            
STCFEE                                                                          
STCFEE     EVALUATE TRUE                                                        
STCFEE         WHEN SQLCODE = ZERO                                              
STCFEE            CONTINUE                                                      
STCFEE                                                                          
STCFEE         WHEN SQLCODE = +100 OR -305                                      
STCFEE            MOVE ZEROES  TO  EPLIS-SRVC-AMT                               
STCFEE                                                                          
STCFEE         WHEN OTHER                                                       
STCFEE             DISPLAY ' '                                                  
STCFEE             DISPLAY 'PARTN_NBR        = ' EPIRT-PARTN-NBR                
STCFEE             DISPLAY 'STR_NBR          = ' EPIRT-STR-NBR                  
STCFEE             DISPLAY 'RGST_ID          = ' EPIRT-RGST-ID                  
STCFEE             DISPLAY 'TRN_NBR          = ' EPIRT-TRN-NBR                  
STCFEE             DISPLAY 'STRT_TM          = ' EPIRT-STRT-TM                  
STCFEE             DISPLAY 'SLS_CORR_SEQ_NBR = ' EPIRT-SLS-CORR-SEQ-NBR         
STCFEE             DISPLAY 'LNE_ITM_SEQ_NBR  = ' EPITM-LNE-ITM-SEQ-NBR          
STCFEE             DISPLAY '*****************************'                      
STCFEE                                                                          
STCFEE             MOVE '4600-GET-FEE-AMT'       TO PV-PARAGRAPH-NAME           
STCFEE             MOVE SQLCODE                  TO PV-DB2-OPERATION    03140001
STCFEE             PERFORM 9100-SQL-ABEND                               03150001
STCFEE     END-EVALUATE.                                                        
STCFEE                                                                          
105600                                                                  07590040
037200******************************************************************03030001
037300 5000-CLOSE-CURSOR.                                               03040003
037400*     CLOSE OPER-CSR CURSOR.                                      03050001
037500******************************************************************03060001
037600                                                                  03070001
037700     EXEC SQL                                                     03080001
037800        CLOSE OPER-CSR                                            03090001
038000     END-EXEC.                                                    03100001
038100                                                                  03110001
038200     IF NOT SQLCODE = ZERO                                        03120008
051700        MOVE '5000-CLOSE-CURSOR'      TO PV-PARAGRAPH-NAME        03130003
051800        MOVE SQLCODE                  TO PV-DB2-OPERATION         03140001
051900        PERFORM 9100-SQL-ABEND                                    03150001
038200     END-IF.                                                      03160001
049600                                                                  03170001
113700***************************************************************** 08241073
113800 7000-PRINT-STORE-INFO.                                           08242073
113900***************************************************************** 08243073
114000                                                                  08244073
114100     ADD PV-TOT-ITEM-RTN-CNT(PV-SUB)  TO                          08245073
114100         PV-TOT-ITEM-RTN-CNT-2(PV-SUB-2).                         08245073
114200     ADD PV-TOT-RTN-AMT(PV-SUB)       TO                          08246073
114200         PV-TOT-RTN-AMT-2(PV-SUB-2).                              08246073
114300     ADD PV-TOT-TAX-AMT(PV-SUB)       TO                          08247073
114300         PV-TOT-TAX-AMT-2(PV-SUB-2).                              08247073
114700                                                                  08280006
114100     MOVE PV-FISCAL-START-DATE        TO DL-BEG-DATE.             08245073
114100     MOVE PV-FISCAL-END-DATE          TO DL-END-DATE.             08245073
114100     MOVE PV-STATE                    TO DL-STATE.                08245073
114100     MOVE PV-STORE                    TO DL-STORE.                08245073
114100     MOVE PV-CTG(PV-SUB)              TO DL-CTG.                  08245073
114100     MOVE PV-TOT-ITEM-RTN-CNT(PV-SUB) TO DL-TOT-ITEM-RTN-CNT.     08245073
114200     MOVE PV-TOT-RTN-AMT(PV-SUB)      TO DL-TOT-RTN-AMT.          08246073
114300     MOVE PV-TOT-TAX-AMT(PV-SUB)      TO DL-TOT-TAX-AMT.          08247073
114300     MOVE DL-DETAIL-LINE              TO PV-PRINT-RECORD.         08247073
114700                                                                  08280006
114300     PERFORM 8000-WRITE-REPORT-LINE.                              08247073
114300                                                                  08247073
105500     INITIALIZE PV-DATE-CTG-TABLE (PV-SUB)                              40
114300                DL-DETAIL-LINE                                    08247073
114300                PV-PRINT-RECORD.                                  08247073
114300                                                                  08247073
113700***************************************************************** 08241073
113800 7500-PRINT-STATE-INFO.                                           08242073
113900***************************************************************** 08243073
114000                                                                  08244073
114100     MOVE PV-CTG-2 (PV-SUB-2)         TO DL-CTG.                  08245073
114100     MOVE PV-TOT-ITEM-RTN-CNT-2 (PV-SUB-2)                        08245073
114100                                      TO DL-TOT-ITEM-RTN-CNT.     08245073
114200     MOVE PV-TOT-RTN-AMT-2 (PV-SUB-2) TO DL-TOT-RTN-AMT.          08246073
114300     MOVE PV-TOT-TAX-AMT-2 (PV-SUB-2) TO DL-TOT-TAX-AMT.          08247073
114300     MOVE DL-DETAIL-LINE              TO PV-PRINT-RECORD.         08247073
114700                                                                  08280006
114300     PERFORM 8000-WRITE-REPORT-LINE.                              08247073
114300                                                                  08247073
114300     INITIALIZE PV-DATE-CTG-2                                     08247073
114300                DL-DETAIL-LINE                                    08247073
114300                PV-PRINT-RECORD.                                  08247073
114300                                                                  08247073
259200***************************************************************** 12490040
259300 8000-WRITE-REPORT-LINE.                                          12500019
259500***************************************************************** 12520040
259700                                                                  12540014
259800     WRITE OUTPUT-RECORD                                          12550019
259900       FROM PV-PRINT-RECORD                                       12560019
260000        AFTER ADVANCING PV-LINE-SPACING.                          12570014
260100                                                                  12580014
260200     INITIALIZE OUTPUT-RECORD                                     12590019
260200                PV-PRINT-RECORD.                                  12590019
260400                                                                  12610014
260500***************************************************************** 12620040
260600* 9100-SQL-ABEND                                                  12630006
260700*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.12640006
260800***************************************************************** 12650040
260900 9100-SQL-ABEND.                                                  12660006
261000     DISPLAY '** ABEND     **'.                                   12670006
263400     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                12870006
263500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              12880006
263600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               12890006
261800                                                                  12710006
261900***************************************************************** 12720040
262000* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     12730006
262100* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      12740006
262200***************************************************************** 12750040
262300     COPY DPPD004.                                                12760006
262400                                                                  12770006
262500     SET AC-DB2-ERROR TO TRUE.                                    12780006
262600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         12790006
262700                                                                  12800006
262800***************************************************************** 12810040
262900* 9999-ABEND                                                      12820006
263000*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  12830006
263100***************************************************************** 12840040
263200 9999-ABEND.                                                      12850006
263300     DISPLAY '** ABEND           **'.                             12860006
263400     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          12870006
263500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        12880006
263600     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       12890006
263700     DISPLAY '** ERROR           ** = ' PV-OPERATION-MSG-2.       12900006
263800     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         12910006
