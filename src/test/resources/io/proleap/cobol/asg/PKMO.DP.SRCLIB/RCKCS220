000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS220.                                         00040000
000500 AUTHOR.        M. FURLICK - STRATAGEM                            00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  03/94.                                            00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E220 - VERIFY BY LINE LIST                                 * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF THE LINES RECEIVED FOR A  * 00130000
001400*    RECEIVER.  THE USER MAY UPDATE A SELECTED LINE ITEM IF     * 00140000
001500*    THE STATUS CODE IS 'CM'.  THE UPDATE ENTAILS MOVING THE    * 00150000
001600*    EXPECTED QUANTITY TO THE VERIFIED QUANTITY AND CHANGING    * 00160000
001700*    THE STATUS CODE TO 'VE'.                                   * 00170000
001800*                                                               * 00180000
001900*    THE USER MAY SELECT LINE ITEMS AND NAVIGATE TO THE STORE   * 00190000
002000*    ADJUSTMENT SCREEN FOR FURTHER PROCESSING.                  * 00200000
002100*                                                               * 00210000
002200*    IR-134: ADD SKU AND UNITS TO THE SCROLL AREA, ADD TOTAL    * 00220000
002300*            UNITS TO THE HEADING.                              * 00230000
002400*            6/9/94 BY M. FURLICK                               * 00240000
002500*                                                               * 00250000
002600*    DC-154: ENSURE A RECDIS ROW EXISTS BEFORE A RECITM MAY BE  * 00260000
002700*            VERIFIED.                                          * 00270000
002800*            CHECK FOR TROUBLE.  IF PO LEVEL TROUBLE, NOTHING   * 00280000
002900*            CAN BE VERIFIED.  IF LINE LEVEL TROUBLE, ONLY      * 00290000
003000*            THAT LINE MAY NOT BE VERIFIED.                     * 00300000
003100*            6/21/94 BY M. FURLICK                              * 00310000
003200*                                                               * 00320000
003300*    IR-164: CHECK ACROSS DC'S TO DETERMINE THE VERIFIED STATUS.* 00330000
003400*            7/14/94 BY M. FURLICK                              * 00340000
003500*                                                               * 00350000
003600*    WR-28767 REMOVE ARCHIVING OF TRECEIVER SEGMENT REPLACE     * 00360000
003700*             WITH UPDATE.                                      * 00370000
003800*             BY GARDNER     8/26/94                            * 00380000
003900*                                                               * 00390000
004000*---------------------------------------------------------------* 00400000
004010* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00401003
004020* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00402004
004030* MAKING THE CALL DYNAMIC VS STATIC.                              00403004
004040*---------------------------------------------------------------* 00404004
004100/                                                                 00410000
004200 ENVIRONMENT DIVISION.                                            00420000
004300                                                                  00430000
004400 DATA DIVISION.                                                   00440000
004500                                                                  00450000
004600 WORKING-STORAGE SECTION.                                         00460000
004700                                                                  00470000
004800 01  DK-DB2-KEYS.                                                 00480000
004900     05  DK-LINE-NUMBER               PIC  S9(9) COMP.            00490000
005000                                                                  00500000
005100 01  PC-PROGRAM-CONSTANTS.                                        00510000
005200     05  PC-FKEY-MODULE               PIC X(08) VALUE 'RCKUT126'. 00520000
005300     05  PC-FKEY-MODULE-LENGTH        PIC S9(04) VALUE  +400      00530000
005400                                                    COMP SYNC.    00540000
005500     05  PC-TMKCS520                  PIC X(08) VALUE 'TMKCS520'. 00550000
005600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00560000
005700                                                    'RC220A  '.   00570000
005800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00580000
005900                                                    'RCKM220 '.   00590000
006000     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00600000
006100                                                    'RCKCS220'.   00610000
006200     05  PC-UNTS-WRKD-PGRM-NAME       PIC  X(08) VALUE 'PCKCS756'.00620000
006300     05  PC-VRFY-AT-0-PROG-NAME         PIC  X(08)  VALUE         00630000
006400                                                    'RCK220V0'.   00640000
006500     05  PC-AUDIT-RTN                   PIC  X(08)  VALUE         00650000
006600                                                    'RCKCS290'.   00660000
006700     05  PC-AUDIT-RTN-LENGTH            PIC S9(04)  VALUE  +300   00670000
006800                                                    COMP SYNC.    00680000
006900     05  PC-RCKUT124                    PIC X(08) VALUE           00690000
007000                                                    'RCKUT124'.   00700000
007100     05  PC-FA-HANDLER-PGM          PIC  X(08)  VALUE 'SUKUT705'. 00710000
007200     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00720000
007300     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00730000
007400     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00740000
007500                                                    COMP SYNC.    00750000
007600     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00760000
007700                                                    COMP SYNC.    00770000
007800     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00780000
007900                                                    +1000000      00790000
008000                                                    COMP-3.       00800000
008100     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00810000
008200                                                    COMP SYNC.    00820000
008300     05  PC-ZERO                        PIC S9(09)  VALUE ZERO    00830000
008400                                                    COMP.         00840000
008500     05  PC-DB2-NINES-DATE              PIC X(26)   VALUE         00850000
008600         '9999-09-09-09.09.09.999999'.                            00860000
008700     05  PC-FS-TIMESTAMP                PIC X(26)   VALUE         00870000
008800         '9999-09-09-09.09.09.999999'.                            00880000
008900     05  PC-9999                        PIC S9(04)  VALUE 9999    00890000
009000                                                    COMP.         00900000
009100     05  PC-DISPLAY-PO                  PIC  9(8)  VALUE ZEROS.   00910000
009200     05  PC-DISPLAY-RCVR                PIC  9(4)  VALUE ZEROS.   00920000
009300     05  PC-DISPLAY-LINE                PIC  9(4)  VALUE ZEROS.   00930000
009400     05  PC-DISPLAY-OPER                PIC  9(4)  VALUE ZEROS.   00940000
009500     05  PC-DISPLAY-SQL-CODE            PIC  9999- VALUE ZEROS.   00950000
009600     05  PC-DISPLAY-CICS-RESP           PIC  999999999-           00960000
009700                                                  VALUE ZEROS.    00970000
009800     05  PV-CURRENT-TIMESTAMP           PIC X(26)   VALUE         00980000
009900                                                       SPACES.    00990000
010000     05  PV-VERIFY-TIMESTAMP            PIC X(26)   VALUE         01000000
010100                                                       SPACES.    01010000
010200     05  PV-RECEIV-CURRENT-TIMESTAMP    PIC X(26)   VALUE         01020000
010300                                                       SPACES.    01030000
010400     05  PV-INV-CUTOFF-DATE             PIC  X(10)  VALUE SPACES. 01040000
010500     05  PV-WORK-DATE                    PIC  X(10)  VALUE ZEROS. 01050000
010600     05  FILLER    REDEFINES PV-WORK-DATE.                        01060000
010700         10  PV-WORK-CC                  PIC  X(02).              01070000
010800         10  PV-WORK-YY                  PIC  X(02).              01080000
010900         10  FILLER                      PIC  X(01).              01090000
011000         10  PV-WORK-MM                  PIC  X(02).              01100000
011100         10  FILLER                      PIC  X(01).              01110000
011200         10  PV-WORK-DD                  PIC  X(02).              01120000
011300     05  PV-HOLD-WORK-DATE.                                       01130000
011400         10  PV-HOLD-WORK-CC             PIC  9(02).              01140000
011500         10  PV-HOLD-WORK-YY             PIC  9(02).              01150000
011600         10  PV-HOLD-WORK-MM             PIC  9(02).              01160000
011700         10  PV-HOLD-WORK-DD             PIC  9(02).              01170000
011800     05  PV-CURR-DATE                    PIC  X(10)  VALUE ZEROS. 01180000
011900     05  PV-CURRENT-DATE                 PIC  X(10)  VALUE ZEROS. 01190000
012000     05  FILLER   REDEFINES PV-CURRENT-DATE.                      01200000
012100         10  PV-CURRENT-CC               PIC  X(02).              01210000
012200         10  PV-CURRENT-YY               PIC  X(02).              01220000
012300         10  FILLER                      PIC  X(01).              01230000
012400         10  PV-CURRENT-MM               PIC  X(02).              01240000
012500         10  FILLER                      PIC  X(01).              01250000
012600         10  PV-CURRENT-DD               PIC  X(02).              01260000
012700     05  PV-HOLD-CURR-DATE.                                       01270000
012800         10  PV-HOLD-CURR-CC             PIC  9(02).              01280000
012900         10  PV-HOLD-CURR-YY             PIC  9(02).              01290000
013000         10  PV-HOLD-CURR-MM             PIC  9(02).              01300000
013100         10  PV-HOLD-CURR-DD             PIC  9(02).              01310000
013200     05  PV-HOLD-CUTOFF-DATE.                                     01320000
013300         10  PV-HOLD-CUTOFF-CC           PIC  9(02).              01330000
013400         10  PV-HOLD-CUTOFF-YY           PIC  9(02).              01340000
013500         10  PV-HOLD-CUTOFF-MM           PIC  9(02).              01350000
013600         10  PV-HOLD-CUTOFF-DD           PIC  9(02).              01360000
013700     05  PV-CURRENT-TIME                 PIC X(08)  VALUE SPACES. 01370000
013800                                                                  01380000
013900     05  PC-EXPECTED            PIC  X(08)  VALUE 'EXPECTED'.     01390000
014000     05  PC-ACTUAL              PIC  X(08)  VALUE 'ACTUAL  '.     01400000
014100     05  PC-MANUAL              PIC  X(08)  VALUE 'MANUAL  '.     01410000
014200     05  PC-P2L-CASE            PIC  X(08)  VALUE 'P2L/CASE'.     01420000
014300     05  PC-P2L                 PIC  X(03)  VALUE 'P2L'.          01430000
014400     05  PC-CASE                PIC  X(04)  VALUE 'CASE'.         01440000
014500*    05  PC-VERIFIED-MESSAGE    PIC  X(55)  VALUE                 01450000
014600*        'NNNNN-E-SOME OR ALL SELECTED LINES PREVIOUSLY VERIFIED'.01460000
014700                                                                  01470000
014800*---------------------------------------------------------------* 01480000
014900*                                                               * 01490000
015000*---------------------------------------------------------------* 01500000
015100* 00005 - INVALID VALUE                                         * 01510000
015200* 00008 - MUST BE NUMERIC                                       * 01520000
015300* 00045 - INVALID FUNCTION KEY                                  * 01530000
015400* 00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED   * 01540000
015500* 00051 - NO END OF RANGE HAS BEEN SPECIFIED                    * 01550000
015600* 00052 - END OF RANGE PRECEDES START OF RANGE                  * 01560000
015700* 00053 - NO START OF RANGE HAS BEEN SPECIFIED                  * 01570000
015800* 00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED    * 01580000
015900* 00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED      * 01590000
016000* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        * 01600000
016100* 00059 - UPDATE(S) SUCCESSFUL                                  * 01610000
016200* 00069 - TOP OF LIST                                           * 01620000
016300* 00070 - BOTTOM OF LIST                                        * 01630000
016400* 00101 - VALUE MUST BE GREATER THAN ZERO AND LESS THAN         * 01640000
016500* 00279 - MORE ITEMS TO DISPLAY                                 * 01650000
016600* 00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL * 01660000
016700* 01061 - USER IS NOT AUTHORIZED                                * 01670000
016800* 01127 - NOT ALL SELECTED LINES HAVE A STATUS OF "VE"          * 01680000
016900* 01128 - RECEIVER POSTED TO FASHION SALES, UNVERIFY NOT ALLOWED* 01690000
017000* 01129 - SELECTED ITEMS WILL BE UNVERIFIED - F2 TO CONFIRM     * 01700000
017100* 01818 - F2 TO CONFIRM THE VERIFY OF A LINE WITH A SOURCE OTHER* 01710000
017200* 01876 - LINE(S) WILL BE VERIFIED TO A QUANTITY OF 0 - F2 TO   * 01720000
017300* 02875 - PROBLEM ENCOUNTED WITH UNITS WORKED PROCESSING - CONTA* 01730000
017400* 03303 - AUTOVE PO - CANNOT VERIFY @ 0                         * 01740000
017500*---------------------------------------------------------------* 01750000
017600     05  PC-TSYMSG-NUMBERS.                                       01760000
017700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01770000
017800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01780000
017900         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01790000
018000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01800000
018100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01810000
018200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01820000
018300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01830000
018400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01840000
018500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01850000
018600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01860000
018700         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01870000
018800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01880000
018900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01890000
019000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01900000
019100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01910000
019200         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01920000
019300         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01930000
019400         10  PC-TSYMSG-01061            PIC  9(05)  VALUE 01061.  01940000
019500         10  PC-TSYMSG-01127            PIC  9(05)  VALUE 01127.  01950000
019600         10  PC-TSYMSG-01128            PIC  9(05)  VALUE 01128.  01960000
019700         10  PC-TSYMSG-01129            PIC  9(05)  VALUE 01129.  01970000
019800         10  PC-TSYMSG-01818            PIC  9(05)  VALUE 01818.  01980000
019900         10  PC-TSYMSG-01876            PIC  9(05)  VALUE 01876.  01990000
020000         10  PC-TSYMSG-02875            PIC  9(05)  VALUE 02875.  02000000
020100         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  02010000
020200         10  PC-TSYMSG-03135            PIC  9(05)  VALUE 03135.  02020000
020300         10  PC-TSYMSG-03231            PIC  9(05)  VALUE 03231.  02030000
020400                                                                  02040000
020500*        VEM MODULE ERROR MESSAGES                                02050000
020600         10  PC-TSYMSG-03290            PIC  9(05)  VALUE 03290.  02060000
020700         10  PC-TSYMSG-03291            PIC  9(05)  VALUE 03291.  02070000
020800         10  PC-TSYMSG-03292            PIC  9(05)  VALUE 03292.  02080000
020900         10  PC-TSYMSG-03293            PIC  9(05)  VALUE 03293.  02090000
021000         10  PC-TSYMSG-03294            PIC  9(05)  VALUE 03294.  02100000
021100         10  PC-TSYMSG-03295            PIC  9(05)  VALUE 03295.  02110000
021200         10  PC-TSYMSG-03296            PIC  9(05)  VALUE 03296.  02120000
021300                                                                  02130000
021400         10  PC-TSYMSG-03303            PIC  9(05)  VALUE 03303.  02140000
021500         10  PC-TSYMSG-03406            PIC  9(05)  VALUE 03406.  02150000
021600                                                                  02160000
021700*----------------------------------------------------------------*02170000
021800* INCLUDED PROGRAM CONSTANTS PC-000 AND PC-999.      WR # 21361  *02180000
021900*----------------------------------------------------------------*02190000
022000     05  PC-000                       PIC X(03) VALUE '000'.      02200000
022100     05  PC-999                       PIC X(03) VALUE '999'.      02210000
022200*----------------------------------------------------------------*02220000
022300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02230000
022400*----------------------------------------------------------------*02240000
022500*                                                                 02250000
022600 01  PS-PROGRAM-SWITCHES.                                         02260000
022700     05  PS-END-TRECDIS-CSR-SW          PIC  X(01)  VALUE 'N'.    02270000
022800         88  PS-END-TRECDIS-CSR                     VALUE 'Y'.    02280000
022900         88  PS-NOT-END-TRECDIS-CSR                 VALUE 'N'.    02290000
023000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02300000
023100         88  PS-NO-ERROR                            VALUE 'Y'.    02310000
023200         88  PS-ERROR                               VALUE 'N'.    02320000
023300     05  PS-HIDDEN-TROUBLE-SW           PIC  X(01)  VALUE 'N'.    02330000
023400         88  PS-HIDDEN-LINE-ERRORS                  VALUE 'Y'.    02340000
023500         88  PS-NO-HIDDEN-LINE-ERRORS               VALUE 'N'.    02350000
023600     05  PS-STORE-REC-SW                PIC  X(01)  VALUE 'N'.    02360000
023700         88  PS-STORE-REC                           VALUE 'Y'.    02370000
023800         88  PS-NO-STORE-REC                        VALUE 'N'.    02380000
023900     05  PS-DATA-OK-SW                  PIC  X(01)  VALUE 'N'.    02390000
024000         88  PS-DATA-OK                             VALUE 'Y'.    02400000
024100         88  PS-DATA-NOT-OK                         VALUE 'N'.    02410000
024200     05  PS-OPER-UNT-TYPE-SW            PIC  X(01)  VALUE ' '.    02420000
024300         88  PS-OPER-UNT-IS-DC                      VALUE 'Y'.    02430000
024400         88  PS-OPER-UNT-NOT-DC                     VALUE 'N'.    02440000
024500     05  PS-VERIFY-SW                   PIC  X(01)  VALUE 'N'.    02450000
024600         88  PS-CAN-VERIFY                          VALUE 'Y'.    02460000
024700         88  PS-CANT-VERIFY                         VALUE 'N'.    02470000
024800     05  PS-UNVERIFY-SW                 PIC  X(01)  VALUE 'N'.    02480000
024900         88  PS-CAN-UNVERIFY                        VALUE 'Y'.    02490000
025000         88  PS-CANT-UNVERIFY                       VALUE 'N'.    02500000
025100     05  PS-TROUBLE-SW                  PIC  X(01)  VALUE 'N'.    02510000
025200         88  PS-IN-TROUBLE                          VALUE 'Y'.    02520000
025300         88  PS-NOT-IN-TROUBLE                      VALUE 'N'.    02530000
025400     05  PS-PO-SW                       PIC  X(01)  VALUE 'N'.    02540000
025500         88  PS-PO-VERIFY                           VALUE 'Y'.    02550000
025600         88  PS-PO-UNVERIFY                         VALUE 'N'.    02560000
025700     05  PS-CONTINUE-FUNC-03-SW         PIC  X(01)  VALUE 'N'.    02570000
025800         88  PS-CONTINUE-FUNC-03                    VALUE 'Y'.    02580000
025900         88  PS-END-FUNC-03                         VALUE 'N'.    02590000
026000     05  PS-TDISTHD-SW                PIC  X    VALUE 'N'.        02600000
026100         88  PS-TDISTHD-FOUND                   VALUE 'Y'.        02610000
026200         88  PS-NO-TDISTHD-FOUND                VALUE 'N'.        02620000
026300     05  PS-UPDATE-SW                 PIC  X    VALUE 'N'.        02630000
026400         88  PS-NO-UPDATES-DONE                 VALUE 'N'.        02640000
026500         88  PS-UPDATES-DONE                    VALUE 'Y'.        02650000
026600     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        02660000
026700         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        02670000
026800         88  PS-NEXT-SCREEN                     VALUE 'Y'.        02680000
026900     05  PS-INVENTORY-CYCLE-SW        PIC  X    VALUE 'N'.        02690000
027000         88  PS-NO-INVENTORY-CYCLE              VALUE 'N'.        02700000
027100         88  PS-INVENTORY-CYCLE                 VALUE 'Y'.        02710000
027200     05  PS-CHECK-FOR-INV-CYCLE-SW    PIC  X    VALUE 'N'.        02720000
027300         88  PS-CHECKED-FOR-INV-CYCLE           VALUE 'Y'.        02730000
027400     05  PS-STR-INV-CYCLE-SW          PIC  X    VALUE 'N'.        02740000
027500         88  PS-FOUND-STR-INV-CYCLE             VALUE 'Y'.        02750000
027600         88  PS-NO-STR-INV-CYCLE                VALUE 'N'.        02760000
027700     05  PS-RECDIS-STR-FOUND-SW       PIC  X    VALUE 'N'.        02770000
027800         88  PS-RECDIS-STR-FOUND                VALUE 'Y'.        02780000
027900         88  PS-RECDIS-STR-NOT-FOUND            VALUE 'N'.        02790000
028000     05  PS-EOF-INV-CURSOR-SW         PIC  X    VALUE 'N'.        02800000
028100         88  PS-EOF-INV-CURSOR                  VALUE 'Y'.        02810000
028200         88  PS-NOT-EOF-INV-CURSOR              VALUE 'N'.        02820000
028300     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01)  VALUE 'N'.       02830000
028400         88  PS-UNITS-WORKED-ERROR               VALUE 'Y'.       02840000
028500         88  PS-NO-UNITS-WORKED-ERROR            VALUE 'N'.       02850000
028600     05  PS-CHECK-FOR-RMS-PO-SW       PIC  X    VALUE 'N'.        02860000
028700         88  PS-CHECKED-FOR-RMS-PO              VALUE 'Y'.        02870000
028800     05  PS-RMS-PO-SW                 PIC  X    VALUE 'N'.        02880000
028900         88  PS-RMS-PO                          VALUE 'Y'.        02890000
029000         88  PS-NO-RMS-PO                       VALUE 'N'.        02900000
029100*----------------------------------------------------------------*02910000
029200*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *02920000
029300*----------------------------------------------------------------*02930000
029400     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        02940000
029500         88  PS-CALL-API-NO                     VALUE 'N'.        02950000
029600         88  PS-CALL-API-YES                    VALUE 'Y'.        02960000
029700*----------------------------------------------------------------*02970000
029800* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02980000
029900*----------------------------------------------------------------*02990000
030000*                                                                 03000000
030100 01  PV-PROGRAM-VARIABLES.                                        03010000
030200     05  PV-SUB                         PIC S9(04)  VALUE +0      03020000
030300                                                    COMP SYNC.    03030000
030400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03040000
030500                                                    COMP SYNC.    03050000
030600     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      03060000
030700                                                    COMP SYNC.    03070000
030800     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      03080000
030900                                                    COMP-3.       03090000
031000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03100000
031100                                                    COMP-3.       03110000
031200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      03120000
031300                                                    COMP-3.       03130000
031400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03140000
031500                                                    COMP-3.       03150000
031600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03160000
031700                                                    COMP SYNC.    03170000
031800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03180000
031900                                                    COMP SYNC.    03190000
032000     05  PV-ITEM                        PIC S9(04)  VALUE +0      03200000
032100                                                    COMP SYNC.    03210000
032200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03220000
032300                                                    COMP SYNC.    03230000
032400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03240000
032500                                                    COMP SYNC.    03250000
032600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03260000
032700                                                    COMP SYNC.    03270000
032800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03280000
032900                                                    COMP SYNC.    03290000
033000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03300000
033100                                                    COMP SYNC.    03310000
033200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03320000
033300                                                    COMP SYNC.    03330000
033400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03340000
033500                                                    COMP SYNC.    03350000
033600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03360000
033700                                                    COMP SYNC.    03370000
033800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03380000
033900                                                    COMP SYNC.    03390000
034000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03400000
034100                                                    COMP SYNC.    03410000
034200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03420000
034300                                                    COMP SYNC.    03430000
034400     05  PV-START-ITEM-REQUEST          PIC  X(05).               03440000
034500     05  PV-DEPT-NBR-KEY                PIC S9(4)   VALUE +0      03450000
034600                                                    COMP-3.       03460000
034700     05  PV-DB2-COUNT                   PIC S9(9)   VALUE +0      03470000
034800                                                    COMP-3.       03480000
034900     05  PV-DB2-TROUBLE-COUNT           PIC S9(9)   VALUE +0      03490000
035000                                                    COMP-3.       03500000
035100     05  PV-WORK-STORE-X.                                         03510000
035200         10  PV-WORK-STORE              PIC  9(03).               03520000
035300     05  PV-DEPT-NBR-X.                                           03530000
035400         10  PV-DEPT-NBR                PIC  9(03).               03540000
035500     05  PV-DISPLAY-CICS-RESP           PIC  9(04).               03550000
035600     05  PV-DISPLAY-PO                  PIC  9(09).               03560000
035700     05  PV-DISPLAY-REC-SEQ-NBR         PIC  9(04).               03570000
035800     05  PV-DISPLAY-PO-LNE-NBR          PIC  9(04).               03580000
035900     05  PV-DISPLAY-OPER                PIC  9(04).               03590000
036000     05  PV-DISPLAY-FCLTY               PIC  9(04).               03600000
036100     05  PV-DISPLAY-SKU.                                          03610000
036200         10  PV-DS-CL-NBR               PIC  X(02).               03620000
036300         10  FILLER                     PIC  X(01)  VALUE ' '.    03630000
036400         10  PV-SKU                     PIC  X(08).               03640000
036500     05  PV-DS-DEPT-NBR                 PIC  X(03).               03650000
036600     05  PV-STATUS-CDE                  PIC  X(02).               03660000
036700     05  PV-RECITM-STATUS-CDE           PIC  X(02).               03670000
036800     05  PV-COUNT-STATUS-CDE            PIC  X(02).               03680000
036900     05  PV-RCPT-DISTR-UPD-CDE          PIC  X(01).               03690000
037000     05  PV-VERIFY-USER                 PIC  X(08).               03700000
037100     05  PV-HOLD-LNE-NBR                PIC  S9(09) COMP-3.       03710000
037200     05  PV-RECEIV-VRFY-INFO.                                     03720000
037300         10  PV-LEFT-PAREN              PIC X(01).                03730000
037400         10  PV-VRFY-DATE               PIC X(10).                03740000
037500         10  FILLER                     PIC X(01).                03750000
037600         10  PV-VRFY-TIME               PIC X(05).                03760000
037700         10  PV-SEPARATOR               PIC X(03).                03770000
037800         10  PV-VRFY-USERID             PIC X(08).                03780000
037900         10  PV-RIGHT-PAREN             PIC X(01).                03790000
038000     05  PV-WORK-TIMESTAMP.                                       03800000
038100         10  PV-WORK-YEAR               PIC X(04).                03810000
038200         10  FILLER                     PIC X(01).                03820000
038300         10  PV-WORK-MONTH              PIC X(02).                03830000
038400         10  FILLER                     PIC X(01).                03840000
038500         10  PV-WORK-DAY                PIC X(02).                03850000
038600         10  FILLER                     PIC X(01).                03860000
038700         10  PV-WORK-HH                 PIC X(02).                03870000
038800         10  FILLER                     PIC X(01).                03880000
038900         10  PV-WORK-MIN                PIC X(02).                03890000
039000         10  FILLER                     PIC X(10).                03900000
039100     05  PV-DISPLAY-DATE.                                         03910000
039200         10  PV-DISPLAY-MONTH           PIC X(02).                03920000
039300         10  PV-SLASH-1                 PIC X(01).                03930000
039400         10  PV-DISPLAY-DAY             PIC X(02).                03940000
039500         10  PV-SLASH-2                 PIC X(01).                03950000
039600         10  PV-DISPLAY-YEAR            PIC X(04).                03960000
039700     05  PV-DISPLAY-TIME.                                         03970000
039800         10  PV-DISPLAY-HH              PIC X(02).                03980000
039900         10  PV-COLON-1                 PIC X(01).                03990000
040000         10  PV-DISPLAY-MM              PIC X(02).                04000000
040100     05  PV-OPER-UNT-ID                 PIC S9(04) COMP.          04010000
040200                                                                  04020000
040300     05  PV-VERIFY-ZERO-DISPLAY.                                  04030000
040400         10  FILLER           PIC X(12) VALUE ' RCKCS220 - '.     04040000
040500         10  FILLER           PIC X(13) VALUE 'F24 VRFY@0 - '.    04050000
040600         10  FILLER           PIC X(10) VALUE 'PO/RCVR - '.       04060000
040700** CHG0094517  CHANGED MSG-PO LENGTH FROM 7 TO 8                  04070002
040800         10  PV-VRFY-MSG-PO   PIC 9(08).                          04080004
040900         10  FILLER           PIC X(01) VALUE '-'.                04090000
041000         10  PV-VRFY-MSG-RCVR PIC 9(04).                          04100000
041100         10  FILLER           PIC X(08) VALUE ' USERID-'.         04110000
041200         10  PV-VRFY-MSG-USER PIC X(07).                          04120000
041300         10  FILLER           PIC X(06) VALUE ' TMST-'.           04130000
041400         10  PV-VRFY-MSG-TMST PIC X(26).                          04140000
041500     05  PV-CICS-MSG-HOLD2.                                       04150000
041600         10  FILLER                      PIC  X(01)  VALUE SPACE. 04160000
041700         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 04170000
041800     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     04180000
041900                                                     COMP SYNC.   04190000
042000     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 04200000
042100     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 04210000
042200                                                                  04220000
042300                                                                  04230000
042400*----------------------------------------------------------------*04240000
042500*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *04250000
042600*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *04260000
042700*   APPLICATION-SPECIFIC COMMAREA.                               *04270000
042800*----------------------------------------------------------------*04280000
042900*----------------------------------------------------------------*04290000
043000*                                                **   WR # 21361 *04300000
043100* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *04310000
043200* LQW-SKU CHANGED FROM PIC  X(10) TO PIC  X(11)                  *04320000
043300*----------------------------------------------------------------*04330000
043400 01  LQW-LIST-QUEUE-WORK-AREA.                                    04340000
043500     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04350000
043600     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           04360000
043700                                        INDEXED BY LQW-IDX.       04370000
043800         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04380000
043900         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04390000
044000         10  LQW-SELECTED-SW            PIC  X(01).               04400000
044100             88  LQW-SELECT                         VALUE 'S'.    04410000
044200             88  LQW-DESELECT                       VALUE ' '.    04420000
044300         10  LQW-ACTION                 PIC  X(03).               04430000
044400             88  LQW-UPDATE                         VALUE 'UPD'.  04440000
044500             88  LQW-ERROR                          VALUE 'ERR'.  04450000
044600             88  LQW-INVENTORY                      VALUE 'INV'.  04460000
044700         10  LQW-PO-LNE-NBR             PIC S9(09)  COMP.         04470000
044800         10  LQW-PREPK-ID               PIC S9(09)  COMP.         04480000
044900         10  LQW-STATUS-CDE             PIC  X(02).               04490000
045000         10  LQW-SKU                    PIC  X(11).               04500000
045100         10  LQW-PCK-QTY                PIC S9(09)  COMP.         04510000
045200         10  LQW-ACT-QTY                PIC S9(09)  COMP.         04520000
045300         10  LQW-VFY-QTY                PIC S9(09)  COMP.         04530000
045400         10  LQW-VFY-SRC                PIC  X(08).               04540000
045500         10  LQW-LINE-TRBL-SW           PIC  X(01).               04550000
045600         10  LQW-DISTR-UPD-SW           PIC  X(01).               04560000
045700         10  LQW-CANNOT-VERIFY-SW       PIC  X(01).               04570000
045800/                                                                 04580000
045900*----------------------------------------------------------------*04590000
046000*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        04600000
046100*----------------------------------------------------------------*04610000
046200***************************************************************** 04620000
046300*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04630000
046400*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 04640000
046500***************************************************************** 04650000
046600     COPY RCWS040.                                                04660000
046700                                                                  04670000
046800     COPY TMWS500.                                                04680000
046900                                                                  04690000
047000***************************************************************** 04700000
047100*   RCWS039 - IS THE LAYOUT THAT IS USED TO PASS INFO TO        * 04710000
047200*             THE F-KEY ELIGIBILITY MODULE (RCKUT126).          * 04720000
047300***************************************************************** 04730000
047400     COPY RCWS039.                                                04740000
047500                                                                  04750000
047600***************************************************************** 04760000
047700*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 04770000
047800*             FUNCTIONS                                        .* 04780000
047900***************************************************************** 04790000
048000     COPY RCWS071.                                                04800000
048100                                                                  04810000
048200*---------------------------------------------------------------* 04820000
048300*    LAYOUT FOR THE CALLED DATE ROUTINE - DPKUT500              * 04830000
048400*---------------------------------------------------------------* 04840000
048500     COPY DPWS500.                                                04850000
048600                                                                  04860000
048700*---------------------------------------------------------------* 04870000
048800*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 04880000
048900*---------------------------------------------------------------* 04890000
049000     COPY RCWS074.                                                04900000
049100                                                                  04910000
049200*---------------------------------------------------------------* 04920000
049300*    RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE.        * 04930000
049400*---------------------------------------------------------------* 04940000
049500     COPY RCWS013.                                                04950000
049600                                                                  04960000
049700*---------------------------------------------------------------* 04970000
049800*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 04980000
049900*---------------------------------------------------------------* 04990000
050000     COPY RCWS031.                                                05000000
050100                                                                  05010000
050200*---------------------------------------------------------------* 05020000
050300*  RECORD LAYOUTS FOR THE FREE ASTRAY HANDLER MODULE              05030000
050400*---------------------------------------------------------------* 05040000
050500     COPY SUWS044.                                                05050000
050600                                                                  05060000
050700*---------------------------------------------------------------* 05070000
050800*  RECORD LAYOUTS FOR THE VEM MODULE                              05080000
050900*---------------------------------------------------------------* 05090000
051000     COPY RCWS038.                                                05100000
051100                                                                  05110000
051200*---------------------------------------------------------------* 05120000
051300* COPY BOOK FOR CALLED MODULE PCKCS756                            05130000
051400*---------------------------------------------------------------* 05140000
051500     COPY PCWS238.                                                05150000
051600                                                                  05160000
051700*---------------------------------------------------------------* 05170000
051800*    MAP LAYOUT                                                 * 05180000
051900*---------------------------------------------------------------* 05190000
052000     COPY RCKM220.                                                05200000
052100*                                                                 05210000
052200*----------------------------------------------------------------*05220000
052300*                                                    WR # 21361  *05230000
052400* CHANGED THE FILLER OF MR-OCCURS-LAYOUT FROM X(201) TO X(209)   *05240000
052500* AS A NEW FIELD DEPT IS ADDED IN THE MAP RCKM220.               *05250000
052600*----------------------------------------------------------------*05260000
052700 01  MR-OCCURS-LAYOUT                   REDEFINES  RC220AO.       05270000
052800     05  FILLER                         PIC X(210).               05280000
052900     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          05290000
053000         10  MR-SELECTL                 PIC S9(04) COMP.          05300000
053100         10  MR-SELECTA                 PIC  X(01).               05310000
053200         10  MR-SELECTC                 PIC  X(01).               05320000
053300         10  MR-SELECTH                 PIC  X(01).               05330000
053400         10  MR-SELECTI                 PIC  X(01).               05340000
053500                                                                  05350000
053600         10  MR-ACTIONL                 PIC S9(04) COMP.          05360000
053700         10  MR-ACTIONA                 PIC  X(01).               05370000
053800         10  MR-ACTIONC                 PIC  X(01).               05380000
053900         10  MR-ACTIONH                 PIC  X(01).               05390000
054000         10  MR-ACTION                  PIC  X(03).               05400000
054100                                                                  05410000
054200         10  MR-LNE-NBRL                PIC S9(04) COMP.          05420000
054300         10  MR-LNE-NBRA                PIC  X(01).               05430000
054400         10  MR-LNE-NBRC                PIC  X(01).               05440000
054500         10  MR-LNE-NBRH                PIC  X(01).               05450000
054600         10  MR-LNE-NBR-X.                                        05460000
054700             15  MR-LNE-NBR             PIC ZZZZ9.                05470000
054800                                                                  05480000
054900         10  MR-STATUS-CDEL             PIC S9(04) COMP.          05490000
055000         10  MR-STATUS-CDEA             PIC  X(01).               05500000
055100         10  MR-STATUS-CDEC             PIC  X(01).               05510000
055200         10  MR-STATUS-CDEH             PIC  X(01).               05520000
055300         10  MR-STATUS-CDE-X.                                     05530000
055400             15  MR-STATUS-CDE          PIC  X(02).               05540000
055500                                                                  05550000
055600         10  MR-SKUL                    PIC S9(04) COMP.          05560000
055700         10  MR-SKUA                    PIC  X(01).               05570000
055800         10  MR-SKUC                    PIC  X(01).               05580000
055900         10  MR-SKUH                    PIC  X(01).               05590000
056000         10  MR-SKU                     PIC  X(11).               05600000
056100                                                                  05610000
056200         10  MR-PCK-QTYL                PIC S9(04) COMP.          05620000
056300         10  MR-PCK-QTYA                PIC  X(01).               05630000
056400         10  MR-PCK-QTYC                PIC  X(01).               05640000
056500         10  MR-PCK-QTYH                PIC  X(01).               05650000
056600         10  MR-PCK-QTY-X.                                        05660000
056700             15  MR-PCK-QTY             PIC  ZZZZZ9.              05670000
056800                                                                  05680000
056900         10  MR-ACT-QTYL                PIC S9(04) COMP.          05690000
057000         10  MR-ACT-QTYA                PIC  X(01).               05700000
057100         10  MR-ACT-QTYC                PIC  X(01).               05710000
057200         10  MR-ACT-QTYH                PIC  X(01).               05720000
057300         10  MR-ACT-QTY-X.                                        05730000
057400             15  MR-ACT-QTY             PIC  ZZZZZ9.              05740000
057500                                                                  05750000
057600         10  MR-VFY-QTYL                PIC S9(04) COMP.          05760000
057700         10  MR-VFY-QTYA                PIC  X(01).               05770000
057800         10  MR-VFY-QTYC                PIC  X(01).               05780000
057900         10  MR-VFY-QTYH                PIC  X(01).               05790000
058000         10  MR-VFY-QTY-X.                                        05800000
058100             15  MR-VFY-QTY             PIC  ZZZZZ9.              05810000
058200                                                                  05820000
058300         10  MR-VFY-SRCL                PIC S9(04) COMP.          05830000
058400         10  MR-VFY-SRCA                PIC  X(01).               05840000
058500         10  MR-VFY-SRCC                PIC  X(01).               05850000
058600         10  MR-VFY-SRCH                PIC  X(01).               05860000
058700         10  MR-VFY-SRC-X.                                        05870000
058800             15  MR-VFY-SRC             PIC  X(08).               05880000
058900/                                                                 05890000
059000*----------------------------------------------------------------*05900000
059100* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *05910000
059200*----------------------------------------------------------------*05920000
059300*----------------------------------------------------------------*05930000
059400**  SECURITY SUBROUTINE PARAMETERS                                05940000
059500*----------------------------------------------------------------*05950000
059600                                                                  05960000
059700     COPY DPWS008.                                                05970000
059800                                                                  05980000
059900*---------------------------------------------------------------* 05990000
060000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 06000000
060100*---------------------------------------------------------------* 06010000
060200                                                                  06020000
060300     COPY DPWS015.                                                06030000
060400                                                                  06040000
060500*---------------------------------------------------------------* 06050000
060600*    FUNCTION KEYS COPYBOOK.                                    * 06060000
060700*---------------------------------------------------------------* 06070000
060800                                                                  06080000
060900     COPY DPWS016.                                                06090000
061000                                                                  06100000
061100*---------------------------------------------------------------* 06110000
061200*    NUMERIC EDIT LAYOUT.                                       * 06120000
061300*---------------------------------------------------------------* 06130000
061400                                                                  06140000
061500     COPY DPWS010I.                                               06150000
061600/                                                                 06160000
061700******************************************************************06170004
061800** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **06180004
061810** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **06181004
061900******************************************************************06190004
062000                                                                  06200000
062100     COPY DPWS030.                                                06210000
062110     COPY DPWS930.                                                06211004
062200/                                                                 06220000
062300*---------------------------------------------------------------* 06230000
062400*    STANDARD COMMAREA.                                         * 06240000
062500*---------------------------------------------------------------* 06250000
062600                                                                  06260000
062700     COPY DPWS020.                                                06270000
062800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06280000
062900                                                                  06290000
063000         10  INTER-APPL-COMM-AREA       PIC X(200).               06300000
063100     COPY RCWS012.                                                06310000
063200     COPY RCWS015.                                                06320000
063300*---------------------------------------------------------------* 06330000
063400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06340000
063500*---------------------------------------------------------------* 06350000
063600         10  ASC-SPECIFIC-COMMAREA.                               06360000
063700             15  ASC-LIST-KEYS.                                   06370000
063800                 20  ASC-OPER-UNT-ID                 PIC S9(04)   06380000
063900                                                     COMP.        06390000
064000                 20  ASC-FCLTY-ID                    PIC S9(04)   06400000
064100                                                     COMP.        06410000
064200                 20  ASC-PO-NBR                      PIC S9(09)   06420000
064300                                                     COMP.        06430000
064400                 20  ASC-REC-SEQ-NBR                 PIC S9(09)   06440000
064500                                                     COMP.        06450000
064600                 20  ASC-PO-LNE-NBR-LOW              PIC S9(09)   06460000
064700                                                     COMP.        06470000
064800                 20  ASC-PO-LNE-NBR-HIGH             PIC S9(09)   06480000
064900                                                     COMP.        06490000
065000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06500000
065100                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06510000
065200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06520000
065300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06530000
065400                                                                  06540000
065500                 20  ASC-ITEM-ARRAY.                              06550000
065600                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        06560000
065700                         30  ASC-LIST-ITEM-NUMBER                 06570000
065800                                                     PIC S9(09)   06580000
065900                                                     COMP-3.      06590000
066000                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06600000
066100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06610000
066200                             88  ASC-TEMP-SELECT     VALUE 'S'.   06620000
066300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06630000
066400                             88  ASC-TEMP-END        VALUE 'E'.   06640000
066500                         30  ASC-SELECTED-SW         PIC  X(01).  06650000
066600                             88  ASC-NO-SELECT       VALUE ' '.   06660000
066700                             88  ASC-SELECT          VALUE 'S'.   06670000
066800                             88  ASC-BEGIN           VALUE 'B'.   06680000
066900                             88  ASC-END             VALUE 'E'.   06690000
067000                         30  ASC-ACTION              PIC  X(03).  06700000
067100                         30  ASC-PO-LNE-NBR          PIC S9(09)   06710000
067200                                                          COMP.   06720000
067300                         30  ASC-PREPK-ID            PIC S9(09)   06730000
067400                                                          COMP.   06740000
067500                         30  ASC-STATUS-CDE          PIC  X(02).  06750000
067600*----------------------------------------------------------------*06760000
067700*                                             WR # 21361         *06770000
067800* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *06780000
067900* ASC-SKU FIELD IS INCREASED FROM X(10) TO X(11).                *06790000
068000*----------------------------------------------------------------*06800000
068100                         30  ASC-SKU                 PIC  X(11).  06810000
068200*----------------------------------------------------------------*06820000
068300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *06830000
068400*----------------------------------------------------------------*06840000
068500                         30  ASC-PCK-QTY             PIC S9(09)   06850000
068600                                                          COMP.   06860000
068700                         30  ASC-ACT-QTY             PIC S9(09)   06870000
068800                                                          COMP.   06880000
068900                         30  ASC-VFY-QTY             PIC S9(09)   06890000
069000                                                          COMP.   06900000
069100                         30  ASC-VFY-SRC             PIC  X(08).  06910000
069200                         30  ASC-LINE-TRBL-SW        PIC  X(01).  06920000
069300                         30  ASC-DISTR-UPD-SW        PIC  X(01).  06930000
069400                         30  ASC-CANNOT-VERIFY-SW    PIC  X(01).  06940000
069500                                                                  06950000
069600             15  ASC-BLK-SUB                         PIC S9(04)   06960000
069700                                                          COMP    06970000
069800                                                          SYNC.   06980000
069900             15  ASC-ITEM-SUB                        PIC S9(04)   06990000
070000                                                          COMP    07000000
070100                                                          SYNC.   07010000
070200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   07020000
070300                                                          COMP-3. 07030000
070400             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   07040000
070500                                                          COMP-3. 07050000
070600             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   07060000
070700                                                          COMP-3. 07070000
070800             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   07080000
070900                                                          COMP-3. 07090000
071000             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   07100000
071100                                                          COMP-3. 07110000
071200             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   07120000
071300                                                          COMP    07130000
071400                                                          SYNC.   07140000
071500             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   07150000
071600                                                          COMP-3. 07160000
071700             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   07170000
071800                                                          COMP-3. 07180000
071900                                                                  07190000
072000             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07200000
072100                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07210000
072200                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07220000
072300             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  07230000
072400                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07240000
072500                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07250000
072600             15  ASC-AREA-ASTERISK-SW                PIC  X(01).  07260000
072700                 88  ASC-AREA-ASTERISK               VALUE 'Y'.   07270000
072800             15  ASC-DISPLAY-COMPLETE-SW             PIC  X(01).  07280000
072900                 88  ASC-DISPLAY-COMPLETE            VALUE 'Y'.   07290000
073000             15  ASC-VERIFY-SW                       PIC  X(01).  07300000
073100                 88  ASC-CAN-VERIFY                  VALUE 'Y'.   07310000
073200                 88  ASC-CANT-VERIFY                 VALUE 'N'.   07320000
073300             15  ASC-UNVERIFY-SW                     PIC  X(01).  07330000
073400                 88  ASC-CAN-UNVERIFY                VALUE 'Y'.   07340000
073500                 88  ASC-CANT-UNVERIFY-FS            VALUE 'F'.   07350000
073600                 88  ASC-CANT-UNVERIFY-ST            VALUE 'S'.   07360000
073700                 88  ASC-CANT-UNVERIFY               VALUE 'N'.   07370000
073800                                                                  07380000
073900             15  ASC-FASHION-UPDATE                  PIC  X(01).  07390000
074000                 88  ASC-FASHION-UPDATED             VALUE 'Y'.   07400000
074100                 88  ASC-FASHION-NOT-UPDATED         VALUE 'N'.   07410000
074200                                                                  07420000
074300             15  ASC-STORE-TYPE-SW                   PIC  X(01).  07430000
074400                 88  ASC-NOT-DC-STORE-TYPE           VALUE 'N'.   07440000
074500                 88  ASC-DC-STORE-TYPE               VALUE 'D'.   07450000
074600             15  ASC-TROUBLE-SW                      PIC  X(01).  07460000
074700                 88  ASC-IN-TROUBLE                  VALUE 'Y'.   07470000
074800                 88  ASC-NOT-IN-TROUBLE              VALUE 'N'.   07480000
074900             15  ASC-CONFIRM-SWITCH        PIC X.                 07490000
075000                 88  ASC-CONFIRM           VALUE 'Y'.             07500000
075100                 88  ASC-NOT-CONFIRM       VALUE 'N'.             07510000
075200                                                                  07520000
075300             15  ASC-CONFIRM-ZERO-SW       PIC X.                 07530000
075400                 88  ASC-CONFIRM-ZERO      VALUE 'Y'.             07540000
075500                 88  ASC-NOT-CONFIRM-ZERO  VALUE 'N'.             07550000
075600                                                                  07560000
075700             15  ASC-CONFIRM-VERIFY-SW     PIC X.                 07570000
075800                 88  ASC-CONFIRM-VERIFY    VALUE 'V'.             07580000
075900                 88  ASC-CONFIRM-UNVERIFY  VALUE 'U'.             07590000
076000                 88  ASC-STOP-VERIFY       VALUE 'S'.             07600000
076100                                                                  07610000
076200             15  ASC-LIST-QUEUE-NAME.                             07620000
076300                 20  ASC-LIST-TERM-ID                PIC  X(04).  07630000
076400                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07640000
076500                                                          COMP-3. 07650000
076600                 20  ASC-LIST-SEQ                    PIC  9(01).  07660000
076700             15  ASC-SEL-QUEUE-NAME.                              07670000
076800                 20  ASC-SEL-TERM-ID                 PIC  X(04).  07680000
076900                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   07690000
077000                                                          COMP-3. 07700000
077100                 20  ASC-SEL-SEQ                     PIC  9(01).  07710000
077200                                                                  07720000
077300             15  ASC-TOT-ACT-QTY                     PIC S9(09)   07730000
077400                                                          COMP-3. 07740000
077500             15  ASC-TOT-VFY-QTY                     PIC S9(09)   07750000
077600                                                          COMP-3. 07760000
077700             15  ASC-TOT-PCK-QTY                     PIC S9(09)   07770000
077800                                                          COMP-3. 07780000
077900             15  ASC-DEPT-NBR                        PIC  X(03).  07790000
078000             15  ASC-RECEIV-STATUS-CDE               PIC  X(02).  07800000
078100                 88 ASC-RECEIV-STATUS-VERIFY         VALUE 'VE'.  07810000
078200             15  ASC-RECEIV-VRFY-INFO                PIC  X(29).  07820000
078300             15  ASC-FCLTY-NME                       PIC  X(25).  07830000
078400             15  ASC-CURSOR-SW                       PIC  X(01).  07840000
078500                 88  ASC-NO-CURSOR                   VALUE 'Z'.   07850000
078600                 88  ASC-SYSTEM-ID-CURSOR            VALUE 'S'.   07860000
078700                 88  ASC-MESSAGE-NUMBER-CURSOR       VALUE 'N'.   07870000
078800                 88  ASC-MESSAGE-TEXT-CURSOR         VALUE 'T'.   07880000
078900             15  ASC-START-ITEM-REQUEST.                          07890000
079000                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  07900000
079100             15  ASC-PACK-BY-ST-SW                   PIC X(01).   07910000
079200                 88  ASC-PACK-BY-STORE        VALUE 'Y'.          07920000
079300                 88  ASC-NOT-PACK-BY-STORE    VALUE 'N'.          07930000
079400             15  ASC-RECEIV-PKGNG-CDE                PIC X(01).   07940000
079500             15  ASC-AUTO-VE-SW           PIC X.                  07950000
079600                 88  ASC-AUTO-VE-YES      VALUE 'Y'.              07960000
079700                 88  ASC-AUTO-VE-NO       VALUE 'N'.              07970000
079800             15  ASC-PBS-UNVERIFY-SW      PIC X.                  07980000
079900                 88  ASC-PBS-UNVERIFIED-YES        VALUE 'Y'.     07990000
080000                 88  ASC-PBS-UNVERIFIED-NO         VALUE 'N'.     08000000
080100             15  ASC-REC-TYP-CDE                     PIC  X(02).  08010000
080200             15  ASC-HOLD-INTER-APPL                 PIC X(200).  08020000
080300/                                                                 08030000
080400*---------------------------------------------------------------* 08040000
080500*    ABEND PROCESSING COPYBOOK.                                 * 08050000
080600*---------------------------------------------------------------* 08060000
080700                                                                  08070000
080800     COPY DPWS013.                                                08080000
080900                                                                  08090000
081000/                                                                 08100000
081100*---------------------------------------------------------------* 08110000
081200*                                                **   WR # 21361* 08120000
081300*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE        * 08130000
081400*---------------------------------------------------------------* 08140000
081500     COPY XLWS001.                                                08150000
081600*---------------------------------------------------------------* 08160000
081700*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        08170000
081800*---------------------------------------------------------------* 08180000
081900*---------------------------------------------------------------* 08190000
082000*    DB2 AREA FOR PURCHASE ORDER HEADER TABLE                   * 08200000
082100*---------------------------------------------------------------* 08210000
082200     EXEC SQL                                                     08220000
082300          INCLUDE TPURCHS                                         08230000
082400     END-EXEC.                                                    08240000
082500/                                                                 08250000
082600*---------------------------------------------------------------* 08260000
082700*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 08270000
082800*---------------------------------------------------------------* 08280000
082900     EXEC SQL                                                     08290000
083000          INCLUDE TPURITM                                         08300000
083100     END-EXEC.                                                    08310000
083200/                                                                 08320000
083300*---------------------------------------------------------------* 08330000
083400*    DB2 AREA FOR RECEIPT HEADER TABLE                          * 08340000
083500*---------------------------------------------------------------* 08350000
083600     EXEC SQL                                                     08360000
083700          INCLUDE TRECEIV                                         08370000
083800     END-EXEC.                                                    08380000
083900*---------------------------------------------------------------* 08390000
084000*    DB2 AREA FOR RECEIPT ITEM TABLE                            * 08400000
084100*---------------------------------------------------------------* 08410000
084200     EXEC SQL                                                     08420000
084300          INCLUDE TRECITM                                         08430000
084400     END-EXEC.                                                    08440000
084500*---------------------------------------------------------------* 08450000
084600*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 08460000
084700*---------------------------------------------------------------* 08470000
084800     EXEC SQL                                                     08480000
084900          INCLUDE TRECDIS                                         08490000
085000     END-EXEC.                                                    08500000
085100*---------------------------------------------------------------* 08510000
085200*    DB2 AREA FOR XLT STORE TABLE XLT_LOC                       * 08520000
085300*---------------------------------------------------------------* 08530000
085400     EXEC SQL                                                     08540000
085500          INCLUDE XLT00010                                        08550000
085600     END-EXEC.                                                    08560000
085700*---------------------------------------------------------------* 08570000
085800*    DB2 AREA FOR DIST HEADER                                   * 08580000
085900*---------------------------------------------------------------* 08590000
086000     EXEC SQL                                                     08600000
086100          INCLUDE TDISTHD                                         08610000
086200     END-EXEC.                                                    08620000
086300*---------------------------------------------------------------* 08630000
086400*    DB2 AREA FOR TROUBLE NOTIFICATION TABLE                    * 08640000
086500*---------------------------------------------------------------* 08650000
086600     EXEC SQL                                                     08660000
086700          INCLUDE TTRBNTF                                         08670000
086800     END-EXEC.                                                    08680000
086900*---------------------------------------------------------------* 08690000
087000*    DB2 AREA FOR TROUBLE REASON TABLE                          * 08700000
087100*---------------------------------------------------------------* 08710000
087200     EXEC SQL                                                     08720000
087300          INCLUDE TTRBRSN                                         08730000
087400     END-EXEC.                                                    08740000
087500*---------------------------------------------------------------* 08750000
087600*    DB2 AREA FOR TDISTDT - DISTRIBUTION DETAIL TABLE           * 08760000
087700*---------------------------------------------------------------* 08770000
087800     EXEC SQL                                                     08780000
087900          INCLUDE TDISTDT                                         08790000
088000     END-EXEC.                                                    08800000
088100*                                                                 08810000
088200*---------------------------------------------------------------* 08820000
088300*    DB2 AREA FOR THE PO/RMS ROLLOUT CONTROL TABLE              * 08830000
088400*    (POT_RMS_RLOUT_CTL)                                        * 08840000
088500*---------------------------------------------------------------* 08850000
088600     EXEC SQL                                                     08860000
088700          INCLUDE POT00006                                        08870000
088800     END-EXEC.                                                    08880000
088900*---------------------------------------------------------------* 08890000
089000*    DB2 AREA FOR THE OUTBOUND CARTON TABLE                     * 08900000
089100*    (SUT_OTBND_CART)                                           * 08910000
089200*---------------------------------------------------------------* 08920000
089300     EXEC SQL                                                     08930000
089400          INCLUDE SUT00024                                        08940000
089500     END-EXEC.                                                    08950000
089600*---------------------------------------------------------------* 08960000
089700*    DB2 AREA FOR THE OUTBOUND UPC TABLE                        * 08970000
089800*    (SUT_OTBND_UPC)                                            * 08980000
089900*---------------------------------------------------------------* 08990000
090000     EXEC SQL                                                     09000000
090100          INCLUDE SUT00028                                        09010000
090200     END-EXEC.                                                    09020000
090300*                                                                 09030000
090400*---------------------------------------------------------------* 09040000
090500*    DB2 AREA FOR COMMUNICATIONS                                * 09050000
090600*---------------------------------------------------------------* 09060000
090700     EXEC SQL                                                     09070000
090800          INCLUDE SQLCA                                           09080000
090900     END-EXEC.                                                    09090000
091000                                                                  09100000
091100                                                                  09110000
091200*    ARECITM CURSOR DECLARATION.                                * 09120000
091300* ADDED ITM_NBR TO THE CSR                       WR/IR# 21361   * 09130000
091400                                                                  09140000
091500     EXEC SQL                                                     09150000
091600          DECLARE LIST-CSR CURSOR                                 09160000
091700          FOR SELECT                                              09170000
091800                A.FS_POST_TMST                                    09180000
091900              , A.PACK_BY_ST_IND                                  09190000
092000              , A.PKGNG_CDE                                       09200000
092100              , B.ORD_LNE_NBR                                     09210000
092200              , B.PREPK_ID                                        09220000
092300              , B.STATUS_CDE                                      09230000
092400              , B.RCPT_DISTR_UPD_CDE                              09240000
092500              , B.VRFD_USR_ID                                     09250000
092600              , C.CL_NBR                                          09260000
092700              , C.SKU_SEQ_NBR                                     09270000
092800              , C.ITM_NBR                                         09280000
092900          FROM                                                    09290000
093000                  TRECEIV  A                                      09300000
093100              ,   TRECITM  B                                      09310000
093200              ,   TPURITM  C                                      09320000
093300          WHERE                                                   09330000
093400                A.ORD_NBR          =  :ASC-PO-NBR                 09340000
093500           AND  A.ORD_NBR          =  B.ORD_NBR                   09350000
093600           AND  A.ORD_NBR          =  C.PO_NBR                    09360000
093700           AND  A.VER_STATUS_CDE   =  'A'                         09370000
093800           AND  B.VER_STATUS_CDE   =  'A'                         09380000
093900           AND  A.OPER_UNT_ID      =  :ASC-OPER-UNT-ID            09390000
094000           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               09400000
094100           AND  A.FCLTY_ID         =  :ASC-FCLTY-ID               09410000
094200           AND  A.FCLTY_ID         =  B.FCLTY_ID                  09420000
094300           AND  A.REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR            09430000
094400           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               09440000
094500           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            09450000
094600           AND  B.PO_VER_NBR       =  C.VER_NBR                   09460000
094700           AND  B.ORD_LNE_NBR BETWEEN :ASC-PO-LNE-NBR-LOW         09470000
094800                                 AND  :ASC-PO-LNE-NBR-HIGH        09480000
094900          ORDER BY                                                09490000
095000                B.ORD_LNE_NBR                                     09500000
095100     END-EXEC.                                                    09510000
095200                                                                  09520000
095300     EXEC SQL                                                     09530000
095400          DECLARE TRECDIS-CSR CURSOR                              09540000
095500          FOR SELECT                                              09550000
095600                 STR_NBR                                          09560000
095700          FROM                                                    09570000
095800                 TRECDIS                                          09580000
095900          WHERE                                                   09590000
096000                ORD_NBR          =  :ASC-PO-NBR                   09600000
096100           AND  ORD_LNE_NBR      =  :RECITM-ORD-LNE-NBR           09610000
096200           AND  REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR              09620000
096300           AND  FCLTY_ID         =  :ASC-FCLTY-ID                 09630000
096400           AND  OPER_UNT_ID      =  :ASC-OPER-UNT-ID              09640000
096600     END-EXEC.                                                    09660000
096700/                                                                 09670000
096800 LINKAGE SECTION.                                                 09680000
096900                                                                  09690000
097000 01  DFHCOMMAREA.                                                 09700000
097100     05  FILLER                         OCCURS  1 TO 4072 TIMES   09710000
097200                                        DEPENDING ON EIBCALEN.    09720000
097300         10  FILLER                     PIC X.                    09730000
097400                                                                  09740000
097500 PROCEDURE DIVISION.                                              09750000
097600******************************************************************09760000
097700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09770000
097800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09780000
097900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09790000
098000******************************************************************09800000
098100                                                                  09810000
098200 0000-MAIN-MODULE.                                                09820000
098300                                                                  09830000
098400     INITIALIZE DP030-CICS-API-FIELDS.                            09840000
098500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09850000
098600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09860000
098700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09870000
098800     SET DP030-RECEIVE-APPL-MAP                                   09880000
098900         DP030-OVERRIDE-APPL-ERROR TO TRUE.                       09890000
099000                                                                  09900000
099100     MOVE LENGTH OF RC220AI        TO DP030-MAP-LENGTH (1).       09910000
099200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09920000
099300     PERFORM 0001-CALL-CICS-ARCH-API.                             09930000
099400                                                                  09940000
099500     PERFORM 1000-CONTROL-PROCESSING                              09950000
099600                                                                  09960000
099700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09970000
099800     PERFORM 0001-CALL-CICS-ARCH-API.                             09980000
099900                                                                  09990000
100000*----------------------------------------------------------------*10000000
100100*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *10010000
100200*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *10020000
100300*----------------------------------------------------------------*10030000
100400                                                                  10040000
100500 0001-CALL-CICS-ARCH-API.                                         10050000
100600                                                                  10060000
100710     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10071004
100800                                    DFHCOMMAREA                   10080004
100900                                    DP030-CICS-API-FIELDS         10090004
101000                                    DP020-STANDARD-COMMAREA       10100004
101100                                    RC220AI.                      10110004
101200                                                                  10120000
101300     IF  DP030-RC-CALL-SUCCESSFUL OR                              10130000
101400         DP030-RC-APPL-ERROR                                      10140000
101500         CONTINUE                                                 10150000
101600     ELSE                                                         10160000
101700         SET DP013-NO-ROLLBACK                                    10170000
101800             DP013-XCTL-DISPLAY-RESTART                           10180000
101900             DP013-CICS-ABEND      TO TRUE                        10190000
102000         MOVE '0001-CALL-CICS-ARCH-API'                           10200000
102100                                   TO DP013-PARAGRAPH             10210000
102110         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O10211004
102120-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10212004
102400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10240000
102500         PERFORM DP013-0000-PROCESS-ABEND                         10250000
102600     END-IF.                                                      10260000
102700                                                                  10270000
102800*----------------------------------------------------------------*10280000
102900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10290000
103000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10300000
103100*                                                                *10310000
103200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10320000
103300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10330000
103400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10340000
103500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10350000
103600*----------------------------------------------------------------*10360000
103700                                                                  10370000
103800 1000-CONTROL-PROCESSING.                                         10380000
103900                                                                  10390000
104000     EVALUATE TRUE                                                10400000
104100         WHEN DP020-NEXT-ACT-INITIAL                              10410000
104200              INITIALIZE ASC-SPECIFIC-COMMAREA                    10420000
104300              MOVE EIBTRMID        TO ASC-LIST-TERM-ID            10430000
104400                                      ASC-SEL-TERM-ID             10440000
104500              MOVE DP020-SRC-TASK-NUMBER                          10450000
104600                                   TO ASC-LIST-TASK-NUMBER        10460000
104700                                      ASC-SEL-TASK-NUMBER         10470000
104800              MOVE PC-LIST-QUEUE-SEQ                              10480000
104900                                   TO ASC-LIST-SEQ                10490000
105000              MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                10500000
105100                                                                  10510000
105200              MOVE INTER-APPL-COMM-AREA                           10520000
105300                                   TO ASC-HOLD-INTER-APPL         10530000
105400              SET ASC-NOT-CONFIRM                                 10540000
105500                  ASC-NOT-CONFIRM-ZERO TO TRUE                    10550000
105600              PERFORM 4100-PREPARE-CURSOR                         10560000
105700              PERFORM 4000-BUILD-INITIAL-PANEL                    10570000
105800              PERFORM 3200-RESET-ATTRIBUTES                       10580000
105900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10590000
106000              IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                 10600000
106100                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           10610000
106200              END-IF                                              10620000
106300                                                                  10630000
106400         WHEN DP020-NEXT-ACT-READ-MAP                             10640000
106500              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10650000
106600                                   TO PV-TOP-ITEM                 10660000
106700              PERFORM 2000-PROCESS-PANEL                          10670000
106800                                                                  10680000
106900         WHEN DP020-NEXT-ACT-RETURN                               10690000
107000              MOVE ASC-HOLD-INTER-APPL                            10700000
107100                                   TO INTER-APPL-COMM-AREA        10710000
107200              PERFORM 2050-DELETE-LIST-QUEUE                      10720000
107300              PERFORM 4000-BUILD-INITIAL-PANEL                    10730000
107400              PERFORM 3200-RESET-ATTRIBUTES                       10740000
107500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10750000
107600                                                                  10760000
107700         WHEN OTHER                                               10770000
107800              SET DP013-LOGIC-ABEND TO TRUE                       10780000
107900              SET DP013-NO-ROLLBACK TO TRUE                       10790000
108000              MOVE '1000-CONTROL-PROCESSING'                      10800000
108100                                   TO DP013-PARAGRAPH             10810000
108200              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   10820000
108300                                   TO DP013-MESSAGE-TEXT(1)       10830000
108400              PERFORM DP013-0000-PROCESS-ABEND                    10840000
108500     END-EVALUATE.                                                10850000
108600/                                                                 10860000
108700*----------------------------------------------------------------*10870000
108800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10880000
108900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10890000
109000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10900000
109100* OF THE  UNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10910000
109200* FUNCTION KEYS CAN GET THIS FAR.                                *10920000
109300*----------------------------------------------------------------*10930000
109400                                                                  10940000
109500 2000-PROCESS-PANEL.                                              10950000
109600                                                                  10960000
109700     SET PS-NEXT-SCREEN TO TRUE.                                  10970000
109800                                                                  10980000
109900     MOVE ASC-HOLD-INTER-APPL     TO INTER-APPL-COMM-AREA.        10990000
110000                                                                  11000000
110100     EVALUATE TRUE                                                11010000
110200         WHEN DP020-SRC-AID = DP016-CLEAR                         11020000
110300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11030000
110400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11040000
110500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11050000
110600                                                                  11060000
110700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11070000
110800             PERFORM 2050-DELETE-LIST-QUEUE                       11080000
110900             PERFORM 4000-BUILD-INITIAL-PANEL                     11090000
111000             PERFORM 3200-RESET-ATTRIBUTES                        11100000
111100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11110000
111200                                                                  11120000
111300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11130000
111400             PERFORM 2140-DESELECT-ALL-ITEMS                      11140000
111500             PERFORM 3200-RESET-ATTRIBUTES                        11150000
111600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11160000
111700                                                                  11170000
111800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11180000
111900             PERFORM 2150-SELECT-ALL-ITEMS                        11190000
112000             PERFORM 3200-RESET-ATTRIBUTES                        11200000
112100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11210000
112200                                                                  11220000
112300         WHEN OTHER                                               11230000
112400              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                11240000
112500                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              11250000
112600                  IF  PS-NO-ERROR                                 11260000
112700                      SET DP030-CONTINUE-GO                       11270000
112800                                 TO TRUE                          11280000
112900                      PERFORM 2100-CHECK-FUNCTION-KEY             11290000
113000                  ELSE                                            11300000
113100                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        11310000
113200                      SET DP030-OVERRIDE-GO                       11320000
113300                                 TO TRUE                          11330000
113400                  END-IF                                          11340000
113500     END-EVALUATE.                                                11350000
113600 EJECT                                                            11360000
113700*----------------------------------------------------------------*11370000
113800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11380000
113900*----------------------------------------------------------------*11390000
114000 2050-DELETE-LIST-QUEUE.                                          11400000
114100                                                                  11410000
114200     EXEC CICS                                                    11420000
114300         DELETEQ TS                                               11430000
114400             QUEUE (ASC-LIST-QUEUE-NAME)                          11440000
114500             RESP  (PV-CICS-RESP)                                 11450000
114600     END-EXEC.                                                    11460000
114700                                                                  11470000
114800     IF (PV-CICS-RESP = DFHRESP(NORMAL)                           11480000
114900     OR  PV-CICS-RESP = DFHRESP(QIDERR))                          11490000
115000         CONTINUE                                                 11500000
115100     ELSE                                                         11510000
115200         SET DP013-CICS-ABEND      TO TRUE                        11520000
115300         SET DP013-NO-ROLLBACK     TO TRUE                        11530000
115400                                                                  11540000
115500         MOVE '2050-DELETE-LIST-QUEUE'                            11550000
115600                                   TO DP013-PARAGRAPH             11560000
115700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11570000
115800                                   TO DP013-MESSAGE-TEXT (1)      11580000
115900         PERFORM DP013-0000-PROCESS-ABEND                         11590000
116000     END-IF.                                                      11600000
116100                                                                  11610000
116200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11620000
116300/                                                                 11630000
116400*----------------------------------------------------------------*11640000
116500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11650000
116600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11660000
116700* CICS ARCHITECTURE API.                                         *11670000
116800*----------------------------------------------------------------*11680000
116900                                                                  11690000
117000 2100-CHECK-FUNCTION-KEY.                                         11700000
117100                                                                  11710000
117200*===TKMA408=== THIS IS IN JUST FOR TESTING                        11720000
117300*    EVALUATE TRUE                                                11730000
117400*        WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               11740000
117500*           MOVE ASC-PO-NBR           TO  PV-VRFY-MSG-PO          11750000
117600*           MOVE ASC-REC-SEQ-NBR      TO  PV-VRFY-MSG-RCVR        11760000
117700*           MOVE DP020-USERID         TO  PV-VRFY-MSG-USER        11770000
117800*           EXEC SQL                                              11780000
117900*               SET :PV-VRFY-MSG-TMST  = CURRENT TIMESTAMP        11790000
118000*           END-EXEC                                              11800000
118100*           MOVE PV-VERIFY-ZERO-DISPLAY TO PV-CICS-MSG-DATA2      11810000
118200*           MOVE PV-CICS-MSG-HOLD2      TO PV-CICS-MSG-AREA2      11820000
118300*                                                                 11830000
118400*           MOVE LENGTH OF PV-CICS-MSG-AREA2                      11840000
118500*                                       TO PV-COMMAREA-LENGTH     11850000
118600*           EXEC CICS                                             11860000
118700*               WRITEQ TD                                         11870000
118800*                   QUEUE ('CSSL')                                11880000
118900*                   FROM (PV-CICS-MSG-AREA2)                      11890000
119000*                   LENGTH (PV-COMMAREA-LENGTH)                   11900000
119100*                   RESP (PV-CICS-RESP)                           11910000
119200*           END-EXEC                                              11920000
119300*    END-EVALUATE.                                                11930000
119400*===TKMA408=== THIS IS IN JUST FOR TESTING                        11940000
119500                                                                  11950000
119600                                                                  11960000
119700     EVALUATE TRUE                                                11970000
119800         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  11980000
119900             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    11990000
120000                            TO RC013-SELECTED-ITEMS               12000000
120100             PERFORM 5000-PREPARE-SEL-QUEUE                       12010000
120200             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    12020000
120300                            TO RC015-NUMBER-OF-SELECTED-ITEMS     12030000
120400* VERIFY                                                          12040000
120500         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               12050000
120600             SET RC039-FUNC-VRFY           TO TRUE                12060000
120700             PERFORM 2108-LINK-FKEY-MODULE                        12070000
120800             IF RC039-FUNCTION-NO                                 12080000
120900                 MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER     12090000
121000                 SET DP020-MSG-WARNING TO TRUE                    12100000
121100             ELSE                                                 12110000
121200                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          12120000
121300                   IF ASC-STOP-VERIFY                             12130000
121400                     MOVE PC-TSYMSG-03231  TO                     12140000
121500                                     DP020-MSG-NUMBER             12150000
121600                     SET DP020-MSG-FATAL                          12160000
121700                         PS-ERROR      TO  TRUE                   12170000
121800                     SET PS-CANT-VERIFY                           12180000
121900                                       TO  TRUE                   12190000
122000                   ELSE                                           12200000
122100                    IF ASC-CONFIRM-VERIFY                         12210000
122200                        SET  ASC-CONFIRM-ZERO TO  TRUE            12220000
122300                        MOVE PC-TSYMSG-01876  TO                  12230000
122400                                       DP020-MSG-NUMBER           12240000
122500                        SET DP020-MSG-WARNING TO TRUE             12250000
122600                    ELSE                                          12260000
122700                     PERFORM 5050-PREPARE-TO-VERIFY               12270000
122800                     IF  NOT PS-ERROR                             12280000
122900                         MOVE PC-TSYMSG-00059                     12290000
123000                                       TO  DP020-MSG-NUMBER       12300000
123100                         SET DP020-MSG-INFORMATIONAL              12310000
123200                                       TO  TRUE                   12320000
123300                     END-IF                                       12330000
123400                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                12340000
123500                                       TO  PV-TOP-ITEM            12350000
123600                     MOVE ZERO        TO  ASC-ITEM-AT-TOP-OF-PANEL12360000
123700                                                                  12370000
123800                     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL     12380000
123900                         GIVING PV-BLOCK-NUMBER                   12390000
124000                         REMAINDER PV-REMAINDER                   12400000
124100                     IF  PV-REMAINDER > ZERO                      12410000
124200                         ADD +1 TO PV-BLOCK-NUMBER                12420000
124300                     END-IF                                       12430000
124400                                                                  12440000
124500                     MOVE +1        TO ASC-BLK-SUB                12450000
124600                     PERFORM 4410-READ-TEMP-STORAGE               12460000
124700                     ADD +1         TO ASC-BLK-SUB                12470000
124800                                       PV-BLOCK-NUMBER            12480000
124900                     PERFORM 4410-READ-TEMP-STORAGE               12490000
125000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12500000
125100                    END-IF                                        12510000
125200                   END-IF                                         12520000
125300                 ELSE                                             12530000
125400                     SET DP030-OVERRIDE-GO                        12540000
125500                                       TO TRUE                    12550000
125600                     MOVE PC-TSYMSG-00057                         12560000
125700                                       TO DP020-MSG-NUMBER        12570000
125800                     SET DP020-MSG-WARNING                        12580000
125900                                       TO TRUE                    12590000
126000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12600000
126100                 END-IF                                           12610000
126200             END-IF                                               12620000
126300* VERIFY @ 0                                                      12630000
126400         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               12640000
126500             IF ASC-AUTO-VE-YES                                   12650000
126600                SET  DP030-OVERRIDE-GO  TO TRUE                   12660000
126700                MOVE PC-TSYMSG-03303    TO DP020-MSG-NUMBER       12670000
126800                SET DP020-MSG-WARNING   TO TRUE                   12680000
126900                                                                  12690000
127000             ELSE                                                 12700000
127100                                                                  12710000
127200               SET RC039-FUNC-VRFY           TO TRUE              12720000
127300               PERFORM 2108-LINK-FKEY-MODULE                      12730000
127400               IF RC039-FUNCTION-NO                               12740000
127500                  MOVE PC-TSYMSG-03135 TO DP020-MSG-NUMBER        12750000
127600                  SET DP020-MSG-WARNING TO TRUE                   12760000
127700               ELSE                                               12770000
127800                 IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO           12780000
127900                   IF ASC-STOP-VERIFY                             12790000
128000                      MOVE PC-TSYMSG-03231 TO                     12800000
128100                                         DP020-MSG-NUMBER         12810000
128200                      SET DP020-MSG-FATAL                         12820000
128300                          PS-ERROR                                12830000
128400                          PS-CANT-VERIFY   TO TRUE                12840000
128500                   ELSE                                           12850000
128600                   IF ASC-CONFIRM-VERIFY                          12860000
128700                      SET ASC-CONFIRM-ZERO TO  TRUE               12870000
128800                          MOVE PC-TSYMSG-01876 TO                 12880000
128900                                       DP020-MSG-NUMBER           12890000
129000                      SET DP020-MSG-WARNING TO TRUE               12900000
129100                   ELSE                                           12910000
129200                     PERFORM 5050-PREPARE-TO-VERIFY               12920000
129300                     IF  NOT PS-ERROR                             12930000
129400                         MOVE PC-TSYMSG-00059                     12940000
129500                                       TO  DP020-MSG-NUMBER       12950000
129600                         SET DP020-MSG-INFORMATIONAL              12960000
129700                                       TO  TRUE                   12970000
129800                     END-IF                                       12980000
129900                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                12990000
130000                                       TO  PV-TOP-ITEM            13000000
130100                     MOVE ZERO    TO  ASC-ITEM-AT-TOP-OF-PANEL    13010000
130200                     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL     13020000
130300                         GIVING PV-BLOCK-NUMBER                   13030000
130400                         REMAINDER PV-REMAINDER                   13040000
130500                     IF  PV-REMAINDER > ZERO                      13050000
130600                         ADD +1 TO PV-BLOCK-NUMBER                13060000
130700                     END-IF                                       13070000
130800                                                                  13080000
130900                     MOVE +1        TO ASC-BLK-SUB                13090000
131000                     PERFORM 4410-READ-TEMP-STORAGE               13100000
131100                     ADD +1         TO ASC-BLK-SUB                13110000
131200                                       PV-BLOCK-NUMBER            13120000
131300                     PERFORM 4410-READ-TEMP-STORAGE               13130000
131400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13140000
131500                   END-IF                                         13150000
131600                   END-IF                                         13160000
131700                 ELSE                                             13170000
131800                     SET DP030-OVERRIDE-GO                        13180000
131900                                       TO TRUE                    13190000
132000                     MOVE PC-TSYMSG-00057                         13200000
132100                                       TO DP020-MSG-NUMBER        13210000
132200                     SET DP020-MSG-WARNING                        13220000
132300                                       TO TRUE                    13230000
132400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13240000
132500                 END-IF                                           13250000
132600               END-IF                                             13260000
132700             END-IF                                               13270000
132800* UNVERIFY                                                        13280000
132900         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               13290000
133000             SET RC039-FUNC-UNVRFY         TO TRUE                13300000
133100             IF ASC-REC-TYP-CDE = 'CD'                            13310000
133200                 MOVE PC-TSYMSG-03406     TO DP020-MSG-NUMBER     13320000
133300                 SET DP020-MSG-WARNING TO TRUE                    13330000
133400             ELSE                                                 13340000
133500               PERFORM 2108-LINK-FKEY-MODULE                      13350000
133600               IF RC039-FUNCTION-NO                               13360000
133700                   MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER   13370000
133800                   SET DP020-MSG-WARNING TO TRUE                  13380000
133900               ELSE                                               13390000
134000                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          13400000
134100                    PERFORM 2170-CHECK-RACF-ACCESS                13410000
134200                       SET PS-CONTINUE-FUNC-03 TO TRUE            13420000
134300                       IF DP008-ACCESS-DENIED                     13430000
134400*                        -- NO SECURITY CLEARANCE FOR FUNCTION -- 13440000
134500                          SET DP030-OVERRIDE-GO                   13450000
134600                                           TO TRUE                13460000
134700                          MOVE PC-TSYMSG-01061                    13470000
134800                                           TO DP020-MSG-NUMBER    13480000
134900                          SET DP020-MSG-WARNING                   13490000
135000                                 PS-END-FUNC-03 TO TRUE           13500000
135100                          SET DP020-MSG-FATAL                     13510000
135200                                  PS-ERROR  TO  TRUE              13520000
135300                       END-IF                                     13530000
135400                       IF PS-END-FUNC-03                          13540000
135500                           CONTINUE                               13550000
135600                       ELSE                                       13560000
135700                          IF ASC-CANT-UNVERIFY-FS                 13570000
135800                             MOVE PC-TSYMSG-01128                 13580000
135900                                              TO DP020-MSG-NUMBER 13590000
136000                             SET DP020-MSG-FATAL                  13600000
136100                                 ASC-NOT-CONFIRM                  13610000
136200                                 ASC-NOT-CONFIRM-ZERO             13620000
136300                                 PS-ERROR    TO  TRUE             13630000
136400                          END-IF                                  13640000
136500                       END-IF                                     13650000
136600**               --- PRESS F2 TO CONFIRM ---                      13660000
136700                     IF NOT PS-ERROR                              13670000
136800                         SET ASC-CONFIRM TO TRUE                  13680000
136900                         SET ASC-CONFIRM-UNVERIFY TO TRUE         13690000
137000                                                                  13700000
137100                         MOVE PC-TSYMSG-01129 TO                  13710000
137200                                             DP020-MSG-NUMBER     13720000
137300                         SET DP020-MSG-WARNING TO TRUE            13730000
137400                     END-IF                                       13740000
137500                 ELSE                                             13750000
137600                     SET DP030-OVERRIDE-GO                        13760000
137700                                       TO TRUE                    13770000
137800                     MOVE PC-TSYMSG-00057                         13780000
137900                                       TO DP020-MSG-NUMBER        13790000
138000                     SET DP020-MSG-WARNING                        13800000
138100                                       TO TRUE                    13810000
138200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13820000
138300                 END-IF                                           13830000
138400               END-IF                                             13840000
138500             END-IF                                               13850000
138600* CONFIRM                                                         13860000
138700         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    13870000
138800             IF ASC-NOT-CONFIRM AND                               13880000
138900                ASC-NOT-CONFIRM-ZERO                              13890000
139000                 MOVE PC-TSYMSG-00045   TO  DP020-MSG-NUMBER      13900000
139100                 SET DP020-MSG-FATAL                              13910000
139200                             PS-ERROR        TO  TRUE             13920000
139300             ELSE                                                 13930000
139400             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13940000
139500               IF ASC-CONFIRM-UNVERIFY                            13950000
139600                 PERFORM 5060-PREPARE-TO-UNVERIFY                 13960000
139700                 MOVE SPACE TO ASC-CONFIRM-VERIFY-SW              13970000
139800                 IF  NOT PS-ERROR                                 13980000
139900                     MOVE PC-TSYMSG-00059                         13990000
140000                                   TO  DP020-MSG-NUMBER           14000000
140100                     SET DP020-MSG-INFORMATIONAL                  14010000
140200                                   TO  TRUE                       14020000
140300                     SET ASC-CANT-UNVERIFY                        14030000
140400                         ASC-NOT-CONFIRM                          14040000
140500                         ASC-NOT-CONFIRM-ZERO TO TRUE             14050000
140600                 END-IF                                           14060000
140700                 MOVE ASC-ITEM-AT-TOP-OF-PANEL                    14070000
140800                                   TO  PV-TOP-ITEM                14080000
140900                 MOVE ZERO         TO  ASC-ITEM-AT-TOP-OF-PANEL   14090000
141000                                                                  14100000
141100                 DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL         14110000
141200                     GIVING PV-BLOCK-NUMBER                       14120000
141300                     REMAINDER PV-REMAINDER                       14130000
141400                 IF  PV-REMAINDER > ZERO                          14140000
141500                     ADD +1 TO PV-BLOCK-NUMBER                    14150000
141600                 END-IF                                           14160000
141700                                                                  14170000
141800                 MOVE +1        TO ASC-BLK-SUB                    14180000
141900                 PERFORM 4410-READ-TEMP-STORAGE                   14190000
142000                 ADD +1         TO ASC-BLK-SUB                    14200000
142100                                   PV-BLOCK-NUMBER                14210000
142200                 PERFORM 4410-READ-TEMP-STORAGE                   14220000
142300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14230000
142400              ELSE                                                14240000
142500                 IF ASC-CONFIRM-VERIFY                            14250000
142600                    MOVE SPACE TO ASC-CONFIRM-VERIFY-SW           14260000
142700                    PERFORM 5050-PREPARE-TO-VERIFY                14270000
142800                    IF  NOT PS-ERROR                              14280000
142900                        MOVE PC-TSYMSG-00059                      14290000
143000                                      TO  DP020-MSG-NUMBER        14300000
143100                        SET DP020-MSG-INFORMATIONAL               14310000
143200                                      TO  TRUE                    14320000
143300                    SET  ASC-NOT-CONFIRM                          14330000
143400                         ASC-NOT-CONFIRM-ZERO TO TRUE             14340000
143500                    END-IF                                        14350000
143600                    MOVE ASC-ITEM-AT-TOP-OF-PANEL                 14360000
143700                                      TO  PV-TOP-ITEM             14370000
143800                    MOVE ZERO         TO  ASC-ITEM-AT-TOP-OF-PANEL14380000
143900                                                                  14390000
144000                    DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL      14400000
144100                        GIVING PV-BLOCK-NUMBER                    14410000
144200                        REMAINDER PV-REMAINDER                    14420000
144300                    IF  PV-REMAINDER > ZERO                       14430000
144400                        ADD +1 TO PV-BLOCK-NUMBER                 14440000
144500                    END-IF                                        14450000
144600                                                                  14460000
144700                    MOVE +1        TO ASC-BLK-SUB                 14470000
144800                    PERFORM 4410-READ-TEMP-STORAGE                14480000
144900                    ADD +1         TO ASC-BLK-SUB                 14490000
145000                                      PV-BLOCK-NUMBER             14500000
145100                    PERFORM 4410-READ-TEMP-STORAGE                14510000
145200                    IF ASC-AUTO-VE-YES                            14520000
145300                        INITIALIZE RC074-FIELDS                   14530000
145400                        PERFORM 4350-CALL-RCKUT128                14540000
145500                        MOVE RC074-TOTAL-ACTL-ITM-QTY             14550000
145600                                  TO  ASC-TOT-ACT-QTY             14560000
145700                        MOVE RC074-VERIFY-ITM-QTY                 14570000
145800                                  TO  ASC-TOT-VFY-QTY             14580000
145900                        MOVE RC074-INVCED-ITM-QTY                 14590000
146000                                  TO  ASC-TOT-PCK-QTY             14600000
146100                    ELSE                                          14610000
146200                        PERFORM 4330-SUM-TRECDIS-ALL              14620000
146300                        MOVE RECDIS-VERIFY-ITM-QTY                14630000
146400                                  TO  ASC-TOT-ACT-QTY             14640000
146500                        MOVE RECDIS-AP-VERIFY-ITM-QTY             14650000
146600                                  TO  ASC-TOT-VFY-QTY             14660000
146700                        MOVE RECDIS-EXPTED-ITM-QTY                14670000
146800                                  TO  ASC-TOT-PCK-QTY             14680000
146900                    END-IF                                        14690000
147000                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          14700000
147100                END-IF                                            14710000
147200             ELSE                                                 14720000
147300                 SET DP030-OVERRIDE-GO                            14730000
147400                                   TO TRUE                        14740000
147500                 MOVE PC-TSYMSG-00057                             14750000
147600                                   TO DP020-MSG-NUMBER            14760000
147700                 SET DP020-MSG-WARNING                            14770000
147800                                   TO TRUE                        14780000
147900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14790000
148000             END-IF                                               14800000
148100         END-IF                                                   14810000
148200* FIRST PAGE                                                      14820000
148300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14830000
148400             MOVE +1               TO PV-TOP-ITEM                 14840000
148500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14850000
148600* PREV PAGE                                                       14860000
148700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14870000
148800             PERFORM 2110-BROWSE-BACKWARD                         14880000
148900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14890000
149000* NEXT PAGE                                                       14900000
149100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14910000
149200             PERFORM 2120-BROWSE-FORWARD                          14920000
149300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14930000
149400* ENTER                                                           14940000
149500         WHEN DP020-SRC-AID = DP016-ENTER                         14950000
149600             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   14960000
149700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14970000
149800             MOVE SPACE TO ASC-CONFIRM-VERIFY-SW                  14980000
149900                                                                  14990000
150000         WHEN OTHER                                               15000000
150100             PERFORM 2050-DELETE-LIST-QUEUE                       15010000
150200             PERFORM 4000-BUILD-INITIAL-PANEL                     15020000
150300             PERFORM 3200-RESET-ATTRIBUTES                        15030000
150400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15040000
150500     END-EVALUATE.                                                15050000
150600                                                                  15060000
150700*----------------------------------------------------------------*15070000
150800*    LINK TO F-KEY ELIGIBILITY MODULE (RCKUT126)                 *15080000
150900*----------------------------------------------------------------*15090000
151000 2108-LINK-FKEY-MODULE.                                           15100000
151100                                                                  15110000
151200     MOVE DP020-LOCATION-NBR TO RC039-SIGNON-LOCATION.            15120000
151300     MOVE ASC-OPER-UNT-ID    TO RC039-OPER-UNT-ID.                15130000
151400     MOVE ASC-FCLTY-ID       TO RC039-FCLTY-ID.                   15140000
151500     MOVE ASC-PO-NBR         TO RC039-PO-NBR.                     15150000
151600     MOVE ASC-REC-SEQ-NBR    TO RC039-REC-SEQ-NBR.                15160000
151700     MOVE 0                  TO RC039-PO-LNE-NBR.                 15170000
151800     MOVE 0                  TO RC039-PREPACK-ID.                 15180000
151900     MOVE DP020-USERID       TO RC039-USER-ID.                    15190000
152000     MOVE 'RCKCS220'         TO RC039-PROGRAM-NAME.               15200000
152100                                                                  15210000
152200     EXEC CICS                                                    15220000
152300          LINK PROGRAM (PC-FKEY-MODULE)                           15230000
152400          COMMAREA (RC039-FIELDS)                                 15240000
152500          LENGTH (PC-FKEY-MODULE-LENGTH)                          15250000
152600          RESP (PV-CICS-RESP)                                     15260000
152700     END-EXEC.                                                    15270000
152800                                                                  15280000
152900     EVALUATE TRUE                                                15290000
153000         WHEN RC039-SUCCESSFUL                                    15300000
153100            CONTINUE                                              15310000
153200                                                                  15320000
153300         WHEN RC039-DATABASE-BUSY                                 15330000
153400             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         15340000
153500             SET DP020-MSG-WARNING    TO TRUE                     15350000
153600                                                                  15360000
153700         WHEN RC039-INVALID-SQL                                   15370000
153800             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         15380000
153900             SET DP020-MSG-WARNING    TO TRUE                     15390000
154000                                                                  15400000
154100         WHEN OTHER                                               15410000
154200             MOVE '2108-LINK-FKEY-MODULE' TO DP013-PARAGRAPH      15420000
154300             MOVE 'UNSUCCESSFUL CALL TO FKEY ELIGIBILITY MODULE'  15430000
154400                                 TO DP013-MESSAGE-TEXT (1)        15440000
154500             MOVE RC039-SUCCESS-IND TO DP013-MESSAGE-TEXT (2)     15450000
154600             MOVE RC039-CRA-RET-MSG TO DP013-MESSAGE-TEXT (3)     15460000
154700             MOVE ASC-OPER-UNT-ID   TO PV-DISPLAY-OPER            15470000
154800             MOVE ASC-FCLTY-ID      TO PV-DISPLAY-FCLTY           15480000
154900             MOVE ASC-PO-NBR        TO PV-DISPLAY-PO              15490000
155000             MOVE ASC-REC-SEQ-NBR   TO PV-DISPLAY-REC-SEQ-NBR     15500000
155100                 STRING ' PO = '                                  15510000
155200                        PV-DISPLAY-PO                             15520000
155300                        ' RECV ='                                 15530000
155400                        PV-DISPLAY-REC-SEQ-NBR                    15540000
155500                        ' OPER = '                                15550000
155600                        PV-DISPLAY-OPER                           15560000
155700                        ' FCLTY = '                               15570000
155800                        PV-DISPLAY-FCLTY                          15580000
155900                                          DELIMITED BY SIZE       15590000
156000                                 INTO DP013-MESSAGE-TEXT (4)      15600000
156100             MOVE RC039-SQLCA    TO DP013-SQLCA                   15610000
156200             SET DP013-DB2-ABEND                                  15620000
156300                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              15630000
156400             PERFORM DP013-0000-PROCESS-ABEND                     15640000
156500     END-EVALUATE.                                                15650000
156600                                                                  15660000
156700*----------------------------------------------------------------*15670000
156800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *15680000
156900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *15690000
157000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *15700000
157100*    MESSAGE.                                                    *15710000
157200*----------------------------------------------------------------*15720000
157300                                                                  15730000
157400 2110-BROWSE-BACKWARD.                                            15740000
157500                                                                  15750000
157600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15760000
157700         GIVING PV-TOP-ITEM.                                      15770000
157800                                                                  15780000
157900     IF  ((PV-TOP-ITEM < +1)                                      15790000
158000       OR (PV-TOP-ITEM = +1))                                     15800000
158100         MOVE +1                   TO PV-TOP-ITEM                 15810000
158200*        -- TOP OF LIST --                                        15820000
158300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15830000
158400         SET DP020-MSG-INFORMATIONAL TO TRUE                      15840000
158500     END-IF.                                                      15850000
158600                                                                  15860000
158700/                                                                 15870000
158800*----------------------------------------------------------------*15880000
158900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *15890000
159000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *15900000
159100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *15910000
159200*----------------------------------------------------------------*15920000
159300                                                                  15930000
159400 2120-BROWSE-FORWARD.                                             15940000
159500                                                                  15950000
159600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15960000
159700         GIVING PV-TOP-ITEM.                                      15970000
159800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15980000
159900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15990000
160000                                   TO PV-TOP-ITEM                 16000000
160100*        -- BOTTOM OF LIST --                                     16010000
160200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16020000
160300         SET DP020-MSG-INFORMATIONAL                              16030000
160400                                   TO TRUE                        16040000
160500     ELSE                                                         16050000
160600         COMPUTE PV-BOTTOM-ITEM =                                 16060000
160700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16070000
160800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16080000
160900*            -- BOTTOM OF LIST --                                 16090000
161000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16100000
161100             SET DP020-MSG-INFORMATIONAL                          16110000
161200                                   TO TRUE                        16120000
161300         END-IF                                                   16130000
161400     END-IF.                                                      16140000
161500/                                                                 16150000
161600*----------------------------------------------------------------*16160000
161700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16170000
161800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16180000
161900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *16190000
162000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *16200000
162100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *16210000
162200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *16220000
162300*----------------------------------------------------------------*16230000
162400                                                                  16240000
162500 2130-CHECK-FOR-JUMP-BROWSE.                                      16250000
162600                                                                  16260000
162700     SET PS-NO-ERROR               TO TRUE.                       16270000
162800     IF  ASC-START-ITEM-REQUEST = SPACE                           16280000
162900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16290000
163000                                   TO PV-TOP-ITEM                 16300000
163100     ELSE                                                         16310000
163200         MOVE ASC-START-ITEM-REQUEST                              16320000
163300                                   TO DP010I-UNEDITED-FIELD       16330000
163400                                      PV-START-ITEM-REQUEST       16340000
163500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       16350000
163600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     16360000
163700         SET DP010I-NEGATIVE-NOT-ALLOWED                          16370000
163800                                   TO TRUE                        16380000
163910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16391003
163920              USING DP010I-NUMERIC-EDIT-AREA                      16392003
164000                                                                  16400000
164100         IF  NOT DP010I-ERROR-DETECTED                            16410000
164200             MOVE DP010I-NUMERIC-FIELD                            16420000
164300                                   TO  ASC-START-ITEM-REQUEST-N   16430000
164400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  16440000
164500                 IF  ASC-START-ITEM-REQUEST-N >                   16450000
164600                                          ASC-NUMBER-OF-ITEMS-READ16460000
164700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         16470000
164800                     COMPUTE PV-TOP-ITEM =                        16480000
164900                             ASC-NUMBER-OF-ITEMS-READ             16490000
165000                             - PC-ITEMS-PER-PANEL + 1             16500000
165100                     IF  PV-TOP-ITEM < +1                         16510000
165200                         MOVE +1   TO PV-TOP-ITEM                 16520000
165300                         MOVE PC-TSYMSG-00070                     16530000
165400                                   TO DP020-MSG-NUMBER            16540000
165500                         SET DP020-MSG-INFORMATIONAL              16550000
165600                                   TO TRUE                        16560000
165700                     END-IF                                       16570000
165800                 ELSE                                             16580000
165900                     MOVE ASC-START-ITEM-REQUEST-N                16590000
166000                                   TO PV-TOP-ITEM                 16600000
166100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      16610000
166200                     COMPUTE PV-BOTTOM-ITEM =                     16620000
166300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16630000
166400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16640000
166500*                        -- BOTTOM OF LIST --                     16650000
166600                         MOVE PC-TSYMSG-00070                     16660000
166700                                   TO DP020-MSG-NUMBER            16670000
166800                         SET DP020-MSG-INFORMATIONAL              16680000
166900                                   TO TRUE                        16690000
167000                     END-IF                                       16700000
167100                 END-IF                                           16710000
167200             ELSE                                                 16720000
167300*                --- VALUE OUT OF RANGE ----                      16730000
167400                 MOVE PC-TSYMSG-00101                             16740000
167500                                   TO DP020-MSG-NUMBER            16750000
167600                 MOVE -1           TO ASTRTITL                    16760000
167700                 SET DP030-SET-CURSOR-APPL-1                      16770000
167800                                   TO TRUE                        16780000
167900                 MOVE DP015-REVERSE                               16790000
168000                                   TO ASTRTITH                    16800000
168100                 MOVE DP015-RED    TO ASTRTITC                    16810000
168200                 MOVE DP015-UNP-NUM-BRT-OFF                       16820000
168300                                   TO ASTRTITA                    16830000
168400                 SET DP020-MSG-FATAL                              16840000
168500                                   TO TRUE                        16850000
168600                 SET PS-ERROR      TO TRUE                        16860000
168700             END-IF                                               16870000
168800                                                                  16880000
168900         ELSE                                                     16890000
169000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16900000
169100             MOVE -1               TO ASTRTITL                    16910000
169200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16920000
169300             MOVE DP015-REVERSE    TO ASTRTITH                    16930000
169400             MOVE DP015-RED        TO ASTRTITC                    16940000
169500             MOVE DP015-UNP-NUM-BRT-OFF                           16950000
169600                                   TO ASTRTITA                    16960000
169700             SET DP020-MSG-FATAL   TO TRUE                        16970000
169800             SET PS-ERROR          TO TRUE                        16980000
169900         END-IF                                                   16990000
170000     END-IF.                                                      17000000
170100/                                                                 17010000
170200*----------------------------------------------------------------*17020000
170300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *17030000
170400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *17040000
170500*----------------------------------------------------------------*17050000
170600                                                                  17060000
170700 2140-DESELECT-ALL-ITEMS.                                         17070000
170800                                                                  17080000
170900     MOVE +1                       TO ASC-BLK-SUB.                17090000
171000                                                                  17100000
171100     PERFORM 2141-CLEAR-SELECTED-INDS                             17110000
171200         VARYING ASC-ITEM-SUB                                     17120000
171300         FROM 1 BY 1                                              17130000
171400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17140000
171500                                                                  17150000
171600     ADD +1                        TO ASC-BLK-SUB.                17160000
171700                                                                  17170000
171800     PERFORM 2141-CLEAR-SELECTED-INDS                             17180000
171900         VARYING ASC-ITEM-SUB                                     17190000
172000         FROM 1 BY 1                                              17200000
172100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17210000
172200                                                                  17220000
172300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17230000
172400                                   TO PV-LIST-ITEM-NUMBER.        17240000
172500                                                                  17250000
172600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17260000
172700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17270000
172800                                                                  17280000
172900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17290000
173000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      17300000
173100         MOVE +1                   TO ASC-BLK-SUB                 17310000
173200                                                                  17320000
173300         PERFORM 5100-WRITE-TEMP-STORAGE                          17330000
173400                                                                  17340000
173500         MOVE +1                   TO PV-BLOCK-NUMBER             17350000
173600                                                                  17360000
173700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17370000
173800             PV-FIRST-BLOCK-IN-ARRAY - 1                          17380000
173900                                                                  17390000
174000         PERFORM                                                  17400000
174100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17410000
174200                                                                  17420000
174300             PERFORM 4410-READ-TEMP-STORAGE                       17430000
174400                                                                  17440000
174500             PERFORM 2141-CLEAR-SELECTED-INDS                     17450000
174600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 17460000
174700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17470000
174800                                                                  17480000
174900             PERFORM 5100-WRITE-TEMP-STORAGE                      17490000
175000                                                                  17500000
175100             ADD +1                TO PV-BLOCK-NUMBER             17510000
175200                                                                  17520000
175300         END-PERFORM                                              17530000
175400                                                                  17540000
175500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17550000
175600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17560000
175700                                                                  17570000
175800         PERFORM                                                  17580000
175900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17590000
176000                   ASC-HIGHEST-BLOCK-WRITTEN                      17600000
176100                                                                  17610000
176200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17620000
176300                                   TO PV-BLOCK-NUMBER             17630000
176400                                                                  17640000
176500             PERFORM 4410-READ-TEMP-STORAGE                       17650000
176600                                                                  17660000
176700             PERFORM 2141-CLEAR-SELECTED-INDS                     17670000
176800                 VARYING ASC-ITEM-SUB                             17680000
176900                 FROM 1 BY 1                                      17690000
177000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17700000
177100                                                                  17710000
177200             PERFORM 5100-WRITE-TEMP-STORAGE                      17720000
177300                                                                  17730000
177400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17740000
177500                                                                  17750000
177600         END-PERFORM                                              17760000
177700                                                                  17770000
177800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17780000
177900                                   TO PV-BLOCK-NUMBER             17790000
178000                                                                  17800000
178100         PERFORM 4410-READ-TEMP-STORAGE                           17810000
178200     END-IF.                                                      17820000
178300                                                                  17830000
178400     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 17840000
178500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.17850000
178600     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  17860000
178700                                                                  17870000
178800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17880000
178900                                                                  17890000
179000/                                                                 17900000
179100*----------------------------------------------------------------*17910000
179200*    MARK EACH ITEM AS BEING NOT SELECTED.                       *17920000
179300*----------------------------------------------------------------*17930000
179400                                                                  17940000
179500 2141-CLEAR-SELECTED-INDS.                                        17950000
179600                                                                  17960000
179700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17970000
179800             NOT EQUAL ZERO                                       17980000
179900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17990000
180000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18000000
180100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    18010000
180200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18020000
180300                                   TO TRUE                        18030000
180400         END-IF                                                   18040000
180500     END-IF.                                                      18050000
180600                                                                  18060000
180700/                                                                 18070000
180800*----------------------------------------------------------------*18080000
180900*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *18090000
181000*  FOR ALL ITEMS.                                                *18100000
181100*----------------------------------------------------------------*18110000
181200                                                                  18120000
181300 2150-SELECT-ALL-ITEMS.                                           18130000
181400                                                                  18140000
181500     MOVE +1                       TO ASC-BLK-SUB.                18150000
181600                                                                  18160000
181700     PERFORM 2151-SET-SELECTED-INDS                               18170000
181800         VARYING ASC-ITEM-SUB                                     18180000
181900         FROM 1 BY 1                                              18190000
182000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18200000
182100                                                                  18210000
182200     ADD +1                        TO ASC-BLK-SUB.                18220000
182300                                                                  18230000
182400     PERFORM 2151-SET-SELECTED-INDS                               18240000
182500         VARYING ASC-ITEM-SUB                                     18250000
182600         FROM 1 BY 1                                              18260000
182700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18270000
182800                                                                  18280000
182900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18290000
183000                                   TO PV-LIST-ITEM-NUMBER.        18300000
183100                                                                  18310000
183200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18320000
183300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18330000
183400                                                                  18340000
183500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18350000
183600        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18360000
183700         MOVE +1                   TO ASC-BLK-SUB                 18370000
183800                                                                  18380000
183900         PERFORM 5100-WRITE-TEMP-STORAGE                          18390000
184000                                                                  18400000
184100         MOVE +1                   TO PV-BLOCK-NUMBER             18410000
184200                                                                  18420000
184300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18430000
184400             PV-FIRST-BLOCK-IN-ARRAY - 1                          18440000
184500                                                                  18450000
184600         PERFORM                                                  18460000
184700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18470000
184800                                                                  18480000
184900             PERFORM 4410-READ-TEMP-STORAGE                       18490000
185000                                                                  18500000
185100             PERFORM 2151-SET-SELECTED-INDS                       18510000
185200                 VARYING ASC-ITEM-SUB                             18520000
185300                 FROM 1 BY 1                                      18530000
185400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18540000
185500                                                                  18550000
185600             PERFORM 5100-WRITE-TEMP-STORAGE                      18560000
185700                                                                  18570000
185800             ADD +1                TO PV-BLOCK-NUMBER             18580000
185900                                                                  18590000
186000         END-PERFORM                                              18600000
186100                                                                  18610000
186200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18620000
186300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18630000
186400                                                                  18640000
186500         PERFORM                                                  18650000
186600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18660000
186700                   ASC-HIGHEST-BLOCK-WRITTEN                      18670000
186800                                                                  18680000
186900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18690000
187000                                   TO PV-BLOCK-NUMBER             18700000
187100                                                                  18710000
187200             PERFORM 4410-READ-TEMP-STORAGE                       18720000
187300                                                                  18730000
187400             PERFORM 2151-SET-SELECTED-INDS                       18740000
187500                 VARYING ASC-ITEM-SUB                             18750000
187600                 FROM 1 BY 1                                      18760000
187700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18770000
187800                                                                  18780000
187900             PERFORM 5100-WRITE-TEMP-STORAGE                      18790000
188000                                                                  18800000
188100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18810000
188200                                                                  18820000
188300         END-PERFORM                                              18830000
188400                                                                  18840000
188500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18850000
188600                                   TO PV-BLOCK-NUMBER             18860000
188700                                                                  18870000
188800         PERFORM 4410-READ-TEMP-STORAGE                           18880000
188900     END-IF.                                                      18890000
189000                                                                  18900000
189100                                                                  18910000
189200     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18920000
189300                       ASC-NUMBER-OF-SELECTED-ITEMS.              18930000
189400                                                                  18940000
189500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18950000
189600                                                                  18960000
189700/                                                                 18970000
189800*----------------------------------------------------------------*18980000
189900*    MARK EACH ITEM AS BEING SELECTED.                           *18990000
190000*----------------------------------------------------------------*19000000
190100                                                                  19010000
190200 2151-SET-SELECTED-INDS.                                          19020000
190300                                                                  19030000
190400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19040000
190500             NOT EQUAL ZERO                                       19050000
190600         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19060000
190700             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19070000
190800                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        19080000
190900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19090000
191000                               TO  TRUE                           19100000
191100         END-IF                                                   19110000
191200     END-IF.                                                      19120000
191300/                                                                 19130000
191400*----------------------------------------------------------------*19140000
191500*    MARK EACH ITEM AS BEING SELECTED.                           *19150000
191600*----------------------------------------------------------------*19160000
191700                                                                  19170000
191800 2170-CHECK-RACF-ACCESS.                                          19180000
191900     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         19190000
192000     MOVE 'RCUNVER '              TO DP008-FUNCTION-NAME          19200000
192100     SET DP008-ACCESS-TYPE-USE    TO TRUE                         19210000
192200                                                                  19220000
192300     EXEC CICS                                                    19230000
192400        LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                  19240000
192500             COMMAREA (DP008-SECURITY-COMMAREA)                   19250000
192600             LENGTH (DP008-SECURITY-COMMAREA-LENGTH)              19260000
192700     END-EXEC                                                     19270000
192800                                                                  19280000
192900     IF DP008-CALL-SUCCESSFUL                                     19290000
193000         CONTINUE                                                 19300000
193100     ELSE                                                         19310000
193200        MOVE '2170-CHECK-RACF-ACCESS'                             19320000
193300                              TO DP013-PARAGRAPH                  19330000
193400         MOVE 'UNABLE TO ACCESS CICS'                             19340000
193500                              TO DP013-MESSAGE-TEXT (1)           19350000
193600         MOVE SQLCA           TO DP013-SQLCA                      19360000
193700         SET DP013-DB2-ABEND                                      19370000
193800             DP013-XCTL-DISPLAY-RESTART                           19380000
193900                              TO TRUE                             19390000
194000         PERFORM DP013-0000-PROCESS-ABEND                         19400000
194100     END-IF.                                                      19410000
194200*----------------------------------------------------------------*19420000
194300*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *19430000
194400*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *19440000
194500*----------------------------------------------------------------*19450000
194600                                                                  19460000
194700 2200-MOVE-SCREEN-TO-COMMAREA.                                    19470000
194800                                                                  19480000
194900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             19490000
195000     MOVE +1                       TO PV-SUB.                     19500000
195100                                                                  19510000
195200     IF  ASTRTITL > ZERO                                          19520000
195300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          19530000
195400     ELSE                                                         19540000
195500         IF  ASTRTITF EQUAL DP015-ERASE-EOF                       19550000
195600             INITIALIZE ASC-START-ITEM-REQUEST                    19560000
195700         END-IF                                                   19570000
195800     END-IF.                                                      19580000
195900                                                                  19590000
196000     PERFORM 3100-SET-SUBSCRIPTS.                                 19600000
196100                                                                  19610000
196200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          19620000
196300         VARYING PV-SUB                                           19630000
196400         FROM 1 BY 1                                              19640000
196500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      19650000
196600                                                                  19660000
196700******************************************************************19670000
196800** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**19680000
196900******************************************************************19690000
197000                                                                  19700000
197100 2210-MOVE-LINES-TO-COMMAREA.                                     19710000
197200                                                                  19720000
197300     IF  MR-SELECTL (PV-SUB) > ZERO                               19730000
197400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19740000
197500         MOVE MR-SELECTI (PV-SUB)                                 19750000
197600                                   TO ASC-TEMP-SELECTED-SW        19760000
197700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19770000
197800     ELSE                                                         19780000
197900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19790000
198000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19800000
198100                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        19810000
198200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19820000
198300         END-IF                                                   19830000
198400     END-IF.                                                      19840000
198500                                                                  19850000
198600     ADD +1                        TO ASC-ITEM-SUB.               19860000
198700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19870000
198800         ADD +1                    TO ASC-BLK-SUB                 19880000
198900         MOVE +1                   TO ASC-ITEM-SUB                19890000
199000     END-IF.                                                      19900000
199100                                                                  19910000
199200*----------------------------------------------------------------*19920000
199300*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *19930000
199400*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *19940000
199500*----------------------------------------------------------------*19950000
199600                                                                  19960000
199700 3000-EDIT-DATA-IN-COMMAREA.                                      19970000
199800                                                                  19980000
199900     SET PS-NO-ERROR               TO TRUE.                       19990000
200000     PERFORM 3200-RESET-ATTRIBUTES.                               20000000
200100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     20010000
200200**                                                                20020000
200300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              20030000
200400* EDITTING IS DONE FROM THE BOTTOM UP.                            20040000
200500**                                                                20050000
200600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       20060000
200700         ASC-ITEMS-DISPLAYED - 1.                                 20070000
200800     PERFORM 3100-SET-SUBSCRIPTS.                                 20080000
200900     PERFORM 3300-EDIT-SELECTIONS                                 20090000
201000         VARYING PV-SUB                                           20100000
201100         FROM PV-SUB BY -1                                        20110000
201200         UNTIL PV-SUB < +1.                                       20120000
201300                                                                  20130000
201400     IF  PS-NO-ERROR                                              20140000
201500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20150000
201600     END-IF.                                                      20160000
201700                                                                  20170000
201800     IF  ((PS-NO-ERROR)                                           20180000
201900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   20190000
202000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    20200000
202100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  20210000
202200     END-IF.                                                      20220000
202300/                                                                 20230000
202400*----------------------------------------------------------------*20240000
202500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *20250000
202600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*20260000
202700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *20270000
202800*                                                                *20280000
202900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *20290000
203000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *20300000
203100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *20310000
203200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *20320000
203300*----------------------------------------------------------------*20330000
203400                                                                  20340000
203500 3100-SET-SUBSCRIPTS.                                             20350000
203600                                                                  20360000
203700     COMPUTE ASC-ITEM-SUB =                                       20370000
203800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        20380000
203900                                                                  20390000
204000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         20400000
204100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20410000
204200                                                                  20420000
204300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               20430000
204400     ELSE                                                         20440000
204500         MOVE +1                     TO ASC-BLK-SUB               20450000
204600     END-IF.                                                      20460000
204700                                                                  20470000
204800*----------------------------------------------------------------*20480000
204900*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *20490000
205000*----------------------------------------------------------------*20500000
205100                                                                  20510000
205200 3200-RESET-ATTRIBUTES.                                           20520000
205300                                                                  20530000
205400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   20540000
205500     MOVE DP015-GREEN              TO ASTRTITC.                   20550000
205600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   20560000
205700                                                                  20570000
205800     PERFORM                                                      20580000
205900         VARYING PV-SUB                                           20590000
206000         FROM 1 BY 1                                              20600000
206100         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        20610000
206200         MOVE DP015-UNP-ALP-NOR-OFF                               20620000
206300                               TO MR-SELECTA (PV-SUB)             20630000
206400         MOVE DP015-GREEN      TO MR-SELECTC (PV-SUB)             20640000
206500         MOVE DP015-UNDERLINE  TO MR-SELECTH (PV-SUB)             20650000
206600     END-PERFORM.                                                 20660000
206700                                                                  20670000
206800     EVALUATE TRUE                                                20680000
206900         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     20690000
207000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  20700000
207100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   20710000
207200         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   20720000
207300         WHEN DP020-SRC-AID = DP016-ENTER                         20730000
207400             CONTINUE                                             20740000
207500         WHEN OTHER                                               20750000
207600             SET  ASC-NOT-CONFIRM-ZERO  TO  TRUE                  20760000
207700     END-EVALUATE.                                                20770000
207800                                                                  20780000
207900*----------------------------------------------------------------*20790000
208000*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *20800000
208100*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *20810000
208200*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *20820000
208300*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *20830000
208400*----------------------------------------------------------------*20840000
208500                                                                  20850000
208600 3300-EDIT-SELECTIONS.                                            20860000
208700                                                                  20870000
208800     EVALUATE TRUE                                                20880000
208900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20890000
209000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         20900000
209100             IF ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)        20910000
209200                 NOT = SPACES                                     20920000
209300                 IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)        20930000
209400                    IF ASC-CANNOT-VERIFY-SW                       20940000
209500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20950000
209600                         = 'Y'                                    20960000
209700                        SET ASC-STOP-VERIFY    TO TRUE            20970000
209800                    END-IF                                        20980000
209900                 END-IF                                           20990000
210000                 IF  DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)        21000000
210100                    IF ASC-CANNOT-VERIFY-SW                       21010000
210200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21020000
210300                         = 'Y'                                    21030000
210400                        SET ASC-STOP-VERIFY    TO TRUE            21040000
210500                    ELSE                                          21050000
210600                        SET ASC-CONFIRM-VERIFY TO TRUE            21060000
210700                    END-IF                                        21070000
210800                 END-IF                                           21080000
210900             END-IF                                               21090000
211000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         21100000
211100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        21110000
211200                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   21120000
211300                 MOVE ASC-TEMP-SELECTED-SW                        21130000
211400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21140000
211500                                TO ASC-SELECTED-SW                21150000
211600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21160000
211700                 IF  DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)        21170000
211800                      IF ASC-CANNOT-VERIFY-SW                     21180000
211900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21190000
212000                           = 'Y'                                  21200000
212100                            SET ASC-STOP-VERIFY    TO TRUE        21210000
212200                     END-IF                                       21220000
212300                 END-IF                                           21230000
212400                 IF  DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)        21240000
212500                     IF ASC-CANNOT-VERIFY-SW                      21250000
212600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21260000
212700                         = 'Y'                                    21270000
212800                        SET ASC-STOP-VERIFY    TO TRUE            21280000
212900                    ELSE                                          21290000
213000                        SET ASC-CONFIRM-VERIFY TO TRUE            21300000
213100                    END-IF                                        21310000
213200                 END-IF                                           21320000
213300             END-IF                                               21330000
213400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21340000
213500                 = SPACE                                          21350000
213600             EVALUATE TRUE                                        21360000
213700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       21370000
213800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS21380000
213900                     MOVE SPACE TO ASC-SELECTED-SW                21390000
214000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21400000
214100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        21410000
214200                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    21420000
214300                     MOVE SPACE TO ASC-SELECTED-SW                21430000
214400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21440000
214500                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          21450000
214600                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      21460000
214700                     MOVE SPACE TO ASC-SELECTED-SW                21470000
214800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21480000
214900             END-EVALUATE                                         21490000
215000                                                                  21500000
215100         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           21510000
215200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21520000
215300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    21530000
215400             END-IF                                               21540000
215500             PERFORM 3310-EDIT-RANGE                              21550000
215600                                                                  21560000
215700         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             21570000
215800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21580000
215900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    21590000
216000             END-IF                                               21600000
216100             PERFORM 3310-EDIT-RANGE                              21610000
216200                                                                  21620000
216300         WHEN OTHER                                               21630000
216400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           21640000
216500             SET DP020-MSG-FATAL    TO TRUE                       21650000
216600             MOVE -1                TO MR-SELECTL (PV-SUB)        21660000
216700             SET DP030-SET-CURSOR-APPL-1                          21670000
216800                                    TO TRUE                       21680000
216900             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        21690000
217000             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        21700000
217100             SET PS-ERROR TO TRUE                                 21710000
217200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21720000
217300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     21730000
217400                 MOVE SPACE         TO ASC-SELECTED-SW            21740000
217500                                        (ASC-BLK-SUB ASC-ITEM-SUB)21750000
217600             END-IF                                               21760000
217700                                                                  21770000
217800     END-EVALUATE.                                                21780000
217900                                                                  21790000
218000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 21800000
218100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               21810000
218200     IF  ASC-ITEM-SUB < 1                                         21820000
218300         SUBTRACT +1 FROM ASC-BLK-SUB                             21830000
218400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                21840000
218500     END-IF.                                                      21850000
218600                                                                  21860000
218700*----------------------------------------------------------------*21870000
218800*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *21880000
218900*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *21890000
219000*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *21900000
219100*  THE ENDING.                                                   *21910000
219200*----------------------------------------------------------------*21920000
219300                                                                  21930000
219400 3310-EDIT-RANGE.                                                 21940000
219500                                                                  21950000
219600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                21960000
219700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   21970000
219800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)21980000
219900                                   TO ASC-SELECTED-SW             21990000
220000                                        (ASC-BLK-SUB ASC-ITEM-SUB)22000000
220100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 22010000
220200         ELSE                                                     22020000
220300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     22030000
220400                 CONTINUE                                         22040000
220500             ELSE                                                 22050000
220600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        22060000
220700                 MOVE PC-TSYMSG-00054                             22070000
220800                                   TO DP020-MSG-NUMBER            22080000
220900                 SET DP020-MSG-FATAL                              22090000
221000                                   TO TRUE                        22100000
221100                 MOVE -1           TO MR-SELECTL (PV-SUB)         22110000
221200                 SET DP030-SET-CURSOR-APPL-1                      22120000
221300                                   TO TRUE                        22130000
221400                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         22140000
221500                 MOVE DP015-UNDERLINE                             22150000
221600                                   TO MR-SELECTH (PV-SUB)         22160000
221700                 SET PS-ERROR      TO TRUE                        22170000
221800             END-IF                                               22180000
221900         END-IF                                                   22190000
222000     ELSE                                                         22200000
222100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22210000
222200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 22220000
222300                                   TO ASC-SELECTED-SW             22230000
222400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22240000
222500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   22250000
222600         ELSE                                                     22260000
222700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       22270000
222800                 CONTINUE                                         22280000
222900             ELSE                                                 22290000
223000*                -- ONLY ONE END-OF-RANGE ALLOWED --              22300000
223100                 MOVE PC-TSYMSG-00055                             22310000
223200                                   TO DP020-MSG-NUMBER            22320000
223300                 SET DP020-MSG-FATAL                              22330000
223400                                   TO TRUE                        22340000
223500                 MOVE -1           TO MR-SELECTL (PV-SUB)         22350000
223600                 SET DP030-SET-CURSOR-APPL-1                      22360000
223700                                   TO TRUE                        22370000
223800                 SET PS-ERROR      TO TRUE                        22380000
223900             END-IF                                               22390000
224000         END-IF                                                   22400000
224100     END-IF.                                                      22410000
224200                                                                  22420000
224300*----------------------------------------------------------------*22430000
224400*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *22440000
224500*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *22450000
224600*----------------------------------------------------------------*22460000
224700                                                                  22470000
224800 3400-CHECK-RANGE-SEQUENCE.                                       22480000
224900                                                                  22490000
225000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       22500000
225100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      22510000
225200       AND  ASC-START-OF-SELECTED-RANGE >                         22520000
225300                                         ASC-END-OF-SELECTED-RANGE22530000
225400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                22540000
225500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 22550000
225600         SET DP020-MSG-FATAL TO TRUE                              22560000
225700         SET PS-ERROR TO TRUE                                     22570000
225800         PERFORM 3410-POSITION-AT-ERROR                           22580000
225900     END-IF.                                                      22590000
226000                                                                  22600000
226100*----------------------------------------------------------------*22610000
226200*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *22620000
226300*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *22630000
226400*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *22640000
226500*----------------------------------------------------------------*22650000
226600                                                                  22660000
226700 3410-POSITION-AT-ERROR.                                          22670000
226800                                                                  22680000
226900     SET DP030-SET-CURSOR-APPL-1                                  22690000
227000                                   TO TRUE.                       22700000
227100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22710000
227200                    - PV-TOP-ITEM + 1.                            22720000
227300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22730000
227400         CONTINUE                                                 22740000
227500     ELSE                                                         22750000
227600         MOVE -1                   TO MR-SELECTL (PV-SUB)         22760000
227700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22770000
227800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22780000
227900     END-IF.                                                      22790000
228000*                                                                 22800000
228100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22810000
228200                    - PV-TOP-ITEM + 1.                            22820000
228300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22830000
228400         CONTINUE                                                 22840000
228500     ELSE                                                         22850000
228600         MOVE -1                   TO MR-SELECTL (PV-SUB)         22860000
228700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22870000
228800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22880000
228900     END-IF.                                                      22890000
229000/                                                                 22900000
229100*----------------------------------------------------------------*22910000
229200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *22920000
229300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *22930000
229400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *22940000
229500*----------------------------------------------------------------*22950000
229600                                                                  22960000
229700 3500-MARK-RANGE-AS-SELECTED.                                     22970000
229800                                                                  22980000
229900     MOVE +1                       TO  ASC-BLK-SUB.               22990000
230000     PERFORM 3510-MARK-SELECTED-INDS                              23000000
230100         VARYING ASC-ITEM-SUB                                     23010000
230200         FROM 1 BY 1                                              23020000
230300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23030000
230400                                                                  23040000
230500     ADD +1                        TO ASC-BLK-SUB.                23050000
230600     PERFORM 3510-MARK-SELECTED-INDS                              23060000
230700         VARYING ASC-ITEM-SUB                                     23070000
230800         FROM 1 BY 1                                              23080000
230900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23090000
231000                                                                  23100000
231100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23110000
231200                                   TO  PV-LIST-ITEM-NUMBER.       23120000
231300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23130000
231400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         23140000
231500               PC-ITEMS-PER-PANEL).                               23150000
231600                                                                  23160000
231700     MOVE ASC-START-OF-SELECTED-RANGE                             23170000
231800                                   TO PV-START-OF-SELECTED-RANGE. 23180000
231900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            23190000
232000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  23200000
232100               PC-ITEMS-PER-PANEL).                               23210000
232200                                                                  23220000
232300     MOVE ASC-END-OF-SELECTED-RANGE                               23230000
232400                                   TO  PV-END-OF-SELECTED-RANGE.  23240000
232500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             23250000
232600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    23260000
232700               PC-ITEMS-PER-PANEL).                               23270000
232800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             23280000
232900         PV-FIRST-BLOCK-IN-ARRAY + 1.                             23290000
233000                                                                  23300000
233100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    23310000
233200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        23320000
233300         MOVE +1                   TO ASC-BLK-SUB                 23330000
233400         PERFORM 5100-WRITE-TEMP-STORAGE                          23340000
233500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23350000
233600             PV-FIRST-BLOCK-IN-ARRAY - 1                          23360000
233700                                                                  23370000
233800         PERFORM                                                  23380000
233900             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      23390000
234000                   PV-PREV-BLOCK-IN-ARRAY                         23400000
234100             MOVE PV-FIRST-BLOCK-IN-RANGE                         23410000
234200                                   TO PV-BLOCK-NUMBER             23420000
234300             PERFORM 4410-READ-TEMP-STORAGE                       23430000
234400             PERFORM 3510-MARK-SELECTED-INDS                      23440000
234500                 VARYING ASC-ITEM-SUB                             23450000
234600                 FROM 1 BY 1                                      23460000
234700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23470000
234800             PERFORM 5100-WRITE-TEMP-STORAGE                      23480000
234900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     23490000
235000         END-PERFORM                                              23500000
235100                                                                  23510000
235200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23520000
235300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23530000
235400         PERFORM                                                  23540000
235500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23550000
235600                   PV-LAST-BLOCK-IN-RANGE                         23560000
235700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23570000
235800                                   TO PV-BLOCK-NUMBER             23580000
235900             PERFORM 4410-READ-TEMP-STORAGE                       23590000
236000             PERFORM 3510-MARK-SELECTED-INDS                      23600000
236100                 VARYING ASC-ITEM-SUB                             23610000
236200                 FROM 1 BY 1                                      23620000
236300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23630000
236400             PERFORM 5100-WRITE-TEMP-STORAGE                      23640000
236500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23650000
236600         END-PERFORM                                              23660000
236700                                                                  23670000
236800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23680000
236900                                   TO PV-BLOCK-NUMBER             23690000
237000         PERFORM 4410-READ-TEMP-STORAGE                           23700000
237100     END-IF.                                                      23710000
237200                                                                  23720000
237300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 23730000
237400                                      ASC-END-OF-SELECTED-RANGE.  23740000
237500/                                                                 23750000
237600*----------------------------------------------------------------*23760000
237700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *23770000
237800*----------------------------------------------------------------*23780000
237900                                                                  23790000
238000 3510-MARK-SELECTED-INDS.                                         23800000
238100                                                                  23810000
238200     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23820000
238300                                ASC-ITEM-SUB) >                   23830000
238400         ASC-START-OF-SELECTED-RANGE)                             23840000
238500     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23850000
238600                                ASC-ITEM-SUB) =                   23860000
238700         ASC-START-OF-SELECTED-RANGE)                             23870000
238800                                                                  23880000
238900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23890000
239000                                    ASC-ITEM-SUB) <               23900000
239100             ASC-END-OF-SELECTED-RANGE)                           23910000
239200         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23920000
239300                                    ASC-ITEM-SUB) =               23930000
239400             ASC-END-OF-SELECTED-RANGE)                           23940000
239500                                                                  23950000
239600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23960000
239700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   23970000
239800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   23980000
239900                               TO TRUE                            23990000
240000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              24000000
240100                               TO TRUE                            24010000
240200                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    24020000
240300             END-IF                                               24030000
240400         END-IF                                                   24040000
240500     END-IF.                                                      24050000
240600/                                                                 24060000
240700*----------------------------------------------------------------*24070000
240800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *24080000
240900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *24090000
241000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *24100000
241100*    DISPLAY THE PANEL TO USER.                                  *24110000
241200*----------------------------------------------------------------*24120000
241300                                                                  24130000
241400 4000-BUILD-INITIAL-PANEL.                                        24140000
241500                                                                  24150000
241600     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            24160000
241700                                 ASC-BLOCK-ENTRIES (2).           24170000
241800     MOVE +1                 TO ASC-BLK-SUB.                      24180000
241900     SET ASC-ITEMS-LEFT-ON-DB                                     24190000
242000         ASC-CAN-VERIFY                                           24200000
242100         ASC-CAN-UNVERIFY    TO TRUE.                             24210000
242200                                                                  24220000
242300     MOVE +0                 TO ASC-ITEM-SUB                      24230000
242400                                ASC-NUMBER-OF-ITEMS-READ          24240000
242500                                ASC-NUMBER-OF-SELECTED-ITEMS      24250000
242600                                ASC-HIGHEST-BLOCK-WRITTEN         24260000
242700                                ASC-START-OF-SELECTED-RANGE       24270000
242800                                ASC-END-OF-SELECTED-RANGE         24280000
242900                                ASC-ITEM-AT-TOP-OF-PANEL          24290000
243000                                ASC-TOT-PCK-QTY                   24300000
243100                                ASC-TOT-ACT-QTY                   24310000
243200                                ASC-TOT-VFY-QTY.                  24320000
243300     MOVE SPACE              TO ASC-CONFIRM-VERIFY-SW.            24330000
243400     PERFORM 4040-GET-DEPARTMENT.                                 24340000
243500                                                                  24350000
243600     PERFORM 4050-CHECK-AUTOVRFD.                                 24360000
243700                                                                  24370000
243800     PERFORM 4010-OPEN-CURSOR.                                    24380000
243900                                                                  24390000
244000     PERFORM 4300-READ-ITEMS-FROM-DB.                             24400000
244100                                                                  24410000
244200     PERFORM 4020-CLOSE-CURSOR.                                   24420000
244300                                                                  24430000
244400     MOVE +1                   TO  PV-TOP-ITEM.                   24440000
244500     MOVE SPACE                TO  ASC-START-ITEM-REQUEST.        24450000
244600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          24460000
244700         SET DP020-FK-RETURN (DP020-SRC-AID)                      24470000
244800             DP020-MSG-FATAL   TO  TRUE                           24480000
244900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24490000
245000     ELSE                                                         24500000
245100         MOVE -1               TO MR-SELECTL (1)                  24510000
245200         SET DP030-SET-CURSOR-APPL-1                              24520000
245300                               TO TRUE                            24530000
245400         PERFORM 5720-GET-TRECEIV-STATUS                          24540000
245500         IF RECEIV-STATUS-CDE = 'VE'                              24550000
245600             MOVE PC-ACTUAL TO AVERITO                            24560000
245700         ELSE                                                     24570000
245800             MOVE PC-EXPECTED TO AVERITO                          24580000
245900         END-IF                                                   24590000
246000         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     24600000
246100         PERFORM 4030-GET-STORE-TYPE                              24610000
246200         MOVE ZERO             TO  RECDIS-ORD-LNE-NBR             24620000
246300         MOVE ZERO             TO  TRBNTF-PREPK-ID                24630000
246400     END-IF.                                                      24640000
246500/                                                                 24650000
246600*----------------------------------------------------------------*24660000
246700* OPEN THE CURSOR.                                               *24670000
246800*----------------------------------------------------------------*24680000
246900                                                                  24690000
247000 4010-OPEN-CURSOR.                                                24700000
247100                                                                  24710000
247200     EXEC SQL                                                     24720000
247300          OPEN LIST-CSR                                           24730000
247400     END-EXEC.                                                    24740000
247500                                                                  24750000
247600     EVALUATE TRUE                                                24760000
247700         WHEN SQLCODE = ZERO                                      24770000
247800         WHEN SQLCODE = +100                                      24780000
247900              CONTINUE                                            24790000
248000         WHEN SQLCODE = -904                                      24800000
248100         WHEN SQLCODE = -911                                      24810000
248200         WHEN SQLCODE = -913                                      24820000
248300             PERFORM 9900-SOFT-ABORT                              24830000
248400         WHEN SQLWARN0 NOT = SPACES                               24840000
248500         WHEN SQLCODE < ZERO                                      24850000
248600         WHEN SQLCODE > ZERO                                      24860000
248700              MOVE '4010-OPEN-CURSOR'                             24870000
248800                                   TO  DP013-PARAGRAPH            24880000
248900              MOVE 'OPEN LIST CURSOR - '                          24890000
249000                                   TO  DP013-MESSAGE-TEXT (1)     24900000
249100              MOVE SQLCA           TO  DP013-SQLCA                24910000
249200              MOVE 'TRECEIV '      TO  DP013-DB2-TABLE-NAME (1)   24920000
249300              MOVE 'TRECITM '      TO  DP013-DB2-TABLE-NAME (2)   24930000
249400              SET DP013-DB2-ABEND                                 24940000
249500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              24950000
249600                 PERFORM DP013-0000-PROCESS-ABEND                 24960000
249700         END-EVALUATE.                                            24970000
249800/                                                                 24980000
249900*----------------------------------------------------------------*24990000
250000* CLOSE THE TRECITM CURSOR.                                      *25000000
250100*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *25010000
250200*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *25020000
250300*   USER.                                                        *25030000
250400*----------------------------------------------------------------*25040000
250500                                                                  25050000
250600 4020-CLOSE-CURSOR.                                               25060000
250700                                                                  25070000
250800     EXEC SQL                                                     25080000
250900          CLOSE LIST-CSR                                          25090000
251000     END-EXEC.                                                    25100000
251100                                                                  25110000
251200     EVALUATE TRUE                                                25120000
251300         WHEN SQLCODE = ZERO                                      25130000
251400             CONTINUE                                             25140000
251500         WHEN SQLWARN0 NOT = SPACES                               25150000
251600         WHEN SQLCODE < ZERO                                      25160000
251700         WHEN SQLCODE > ZERO                                      25170000
251800             MOVE '4020-CLOSE-CURSOR'                             25180000
251900                               TO DP013-PARAGRAPH                 25190000
252000             MOVE 'CLOSE LIST CURSOR '                            25200000
252100                               TO DP013-MESSAGE-TEXT (1)          25210000
252200             MOVE SQLCA        TO DP013-SQLCA                     25220000
252300             MOVE 'TRECEIV '      TO  DP013-DB2-TABLE-NAME (1)    25230000
252400             MOVE 'TRECITM '      TO  DP013-DB2-TABLE-NAME (2)    25240000
252500             SET DP013-DB2-ABEND                                  25250000
252600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25260000
252700             PERFORM DP013-0000-PROCESS-ABEND                     25270000
252800     END-EVALUATE.                                                25280000
252900/                                                                 25290000
253000*----------------------------------------------------------------*25300000
253100*    GET THE STORE TYPE FOR THE "IP" STATUS CODES.               *25310000
253200*----------------------------------------------------------------*25320000
253300                                                                  25330000
253400 4030-GET-STORE-TYPE.                                             25340000
253500                                                                  25350000
253600     MOVE ASC-OPER-UNT-ID         TO  XLT00010-LOC-NBR.           25360000
253700                                                                  25370000
253800     EXEC SQL                                                     25380000
253900          SELECT                                                  25390000
254000                 LOC_TYP_CDE                                      25400000
254100           INTO                                                   25410000
254200                :XLT00010-LOC-TYP-CDE                             25420000
254300           FROM                                                   25430000
254400                 XLT_LOC                                          25440000
254500          WHERE                                                   25450000
254600                 LOC_NBR          =  :XLT00010-LOC-NBR            25460000
254700     END-EXEC.                                                    25470000
254800                                                                  25480000
254900     EVALUATE TRUE                                                25490000
255000         WHEN SQLCODE = ZERO                                      25500000
255100              IF  XLT00010-LOC-TYP-CDE EQUAL 'DC'                 25510000
255200                  SET ASC-DC-STORE-TYPE                           25520000
255300                               TO  TRUE                           25530000
255400              ELSE                                                25540000
255500                  SET ASC-NOT-DC-STORE-TYPE                       25550000
255600                               TO  TRUE                           25560000
255700              END-IF                                              25570000
255800         WHEN SQLWARN0 NOT = SPACES                               25580000
255900         WHEN SQLCODE < ZERO                                      25590000
256000         WHEN SQLCODE > ZERO                                      25600000
256100             MOVE '4030-GET-STORE-TYPE'                           25610000
256200                               TO DP013-PARAGRAPH                 25620000
256300             MOVE 'GET STORE TYPE'                                25630000
256400                               TO DP013-MESSAGE-TEXT (1)          25640000
256500             MOVE SQLCA        TO DP013-SQLCA                     25650000
256600             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (1)        25660000
256700             SET DP013-DB2-ABEND                                  25670000
256800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25680000
256900             PERFORM DP013-0000-PROCESS-ABEND                     25690000
257000     END-EVALUATE.                                                25700000
257100/                                                                 25710000
257200 4040-GET-DEPARTMENT.                                             25720000
257300                                                                  25730000
257400     EXEC SQL                                                     25740000
257500          SELECT DEPT_NBR                                         25750000
257600          INTO                                                    25760000
257700                :PV-DS-DEPT-NBR                                   25770000
257800          FROM                                                    25780000
257900                 TPURCHS                                          25790000
258000          WHERE                                                   25800000
258100                 PO_NBR             =  :ASC-PO-NBR                25810000
258200          AND    VER_STATUS_CDE     =  'A'                        25820000
258300     END-EXEC.                                                    25830000
258400                                                                  25840000
258500     EVALUATE TRUE                                                25850000
258600         WHEN SQLCODE = ZERO                                      25860000
258700              CONTINUE                                            25870000
258800         WHEN SQLCODE = -904                                      25880000
258900         WHEN SQLCODE = -911                                      25890000
259000         WHEN SQLCODE = -913                                      25900000
259100             PERFORM 9900-SOFT-ABORT                              25910000
259200         WHEN SQLCODE = +100                                      25920000
259300              CONTINUE                                            25930000
259400         WHEN SQLWARN0 NOT = SPACE                                25940000
259500         WHEN SQLCODE NOT = ZERO                                  25950000
259600              MOVE '4040-GET-DEPARTMENT'                          25960000
259700                               TO DP013-PARAGRAPH                 25970000
259800              MOVE 'GET THE DEPARTMENT NUMBER'                    25980000
259900                               TO DP013-MESSAGE-TEXT (1)          25990000
260000              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        26000000
260100              MOVE SQLCA       TO DP013-SQLCA                     26010000
260200              SET DP013-DB2-ABEND                                 26020000
260300                               TO TRUE                            26030000
260400              PERFORM DP013-0000-PROCESS-ABEND                    26040000
260500     END-EVALUATE.                                                26050000
260600*----------------------------------------------------------------*26060000
260700*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          26070000
260800*----------------------------------------------------------------*26080000
260900 4050-CHECK-AUTOVRFD.                                             26090000
261000                                                                  26100000
261100     INITIALIZE RC040-FIELDS.                                     26110000
261200     MOVE DP020-LOCATION-NBR  TO RC040-SIGNON-LOCATION.           26120000
261300     MOVE ASC-PO-NBR          TO RC040-PO-NBR.                    26130000
261400     MOVE ASC-REC-SEQ-NBR     TO RC040-PO-RCVR.                   26140000
261500     MOVE DP020-USERID        TO RC040-USER-ID.                   26150000
261600     MOVE 'RCKCS220'          TO RC040-CALLING-PROGRAM.           26160000
261700                                                                  26170000
261800     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  26180000
261900                                        RC040-COMMAREA            26190000
262000                                        RC040-FIELDS.             26200000
262100                                                                  26210000
262200     EVALUATE TRUE                                                26220000
262300         WHEN RC040-SUCCESSFUL                                    26230000
262400                 MOVE RC040-AUTO-VE-SW TO ASC-AUTO-VE-SW          26240000
262500         WHEN RC040-DATABASE-BUSY OR                              26250000
262600              RC040-INVALID-SQL                                   26260000
262700                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       26270000
262800                  SET DP020-MSG-WARNING TO TRUE                   26280000
262900                  SET DP030-OVERRIDE-GO TO TRUE                   26290000
263000         WHEN RC040-NOT-SUCCESSFUL                                26300000
263100                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       26310000
263200                  SET DP020-MSG-WARNING TO TRUE                   26320000
263300                  SET DP030-OVERRIDE-GO TO TRUE                   26330000
263400         WHEN OTHER                                               26340000
263500             MOVE '4050-CHECK-AUTOVRFD ' TO DP013-PARAGRAPH       26350000
263600             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              26360000
263700                                         TO DP013-MESSAGE-TEXT (1)26370000
263800             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)26380000
263900             MOVE RC040-SQLCA            TO DP013-SQLCA           26390000
264000             SET DP013-DB2-ABEND                                  26400000
264100                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              26410000
264200             PERFORM DP013-0000-PROCESS-ABEND                     26420000
264300     END-EVALUATE.                                                26430000
264400                                                                  26440000
264500/                                                                 26450000
264600*----------------------------------------------------------------*26460000
264700*    SET UP THE HOST VARIABLES.                                  *26470000
264800*----------------------------------------------------------------*26480000
264900                                                                  26490000
265000 4100-PREPARE-CURSOR.                                             26500000
265100                                                                  26510000
265200     MOVE RC012-OPER-UNT-ID       TO  ASC-OPER-UNT-ID.            26520000
265300     MOVE RC012-FCLTY-ID          TO  ASC-FCLTY-ID.               26530000
265400     MOVE RC012-PO-NBR            TO  ASC-PO-NBR.                 26540000
265500     MOVE RC012-REC-SEQ-NBR       TO  ASC-REC-SEQ-NBR.            26550000
265600     MOVE RC012-FCLTY-NME         TO  ASC-FCLTY-NME.              26560000
265700     MOVE RC012-PACK-BY-ST-SW     TO  ASC-PACK-BY-ST-SW.          26570000
265800                                                                  26580000
265900                                                                  26590000
266000     IF  RC012-PO-LNE-NBR GREATER THAN ZERO                       26600000
266100         MOVE RC012-PO-LNE-NBR    TO  ASC-PO-LNE-NBR-LOW          26610000
266200                                      ASC-PO-LNE-NBR-HIGH         26620000
266300     ELSE                                                         26630000
266400         MOVE ZERO                TO  ASC-PO-LNE-NBR-LOW          26640000
266500         MOVE PC-9999             TO  ASC-PO-LNE-NBR-HIGH         26650000
266600     END-IF.                                                      26660000
266700/                                                                 26670000
266800*----------------------------------------------------------------*26680000
266900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *26690000
267000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *26700000
267100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *26710000
267200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *26720000
267300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *26730000
267400*                                                                *26740000
267500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *26750000
267600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *26760000
267700*    UPON INITIALIZATION.                                        *26770000
267800*----------------------------------------------------------------*26780000
267900                                                                  26790000
268000*----------------------------------------------------------------*26800000
268100*                                               **   WR # 21361  *26810000
268200* ADDED CODE TO CHECK DUMMY SKU                                  *26820000
268300* ADDED CODE TO INCLUDE XLKUT001 LOGIC.                          *26830000
268400*----------------------------------------------------------------*26840000
268500 4300-READ-ITEMS-FROM-DB.                                         26850000
268600                                                                  26860000
268700     PERFORM                                                      26870000
268800         VARYING PV-READ-COUNT                                    26880000
268900         FROM 1 BY 1                                              26890000
269000         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26900000
269100            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         26910000
269200                                                                  26920000
269300         PERFORM 4310-FETCH                                       26930000
269400                                                                  26940000
269500         IF PS-CALL-API-YES                                       26950000
269600             IF PURITM-ITM-NBR < 0                                26960000
269700                MOVE '4300-READ-ITEMS-FROM-DB'                    26970000
269800                                 TO DP013-PARAGRAPH               26980000
269900                MOVE 'PURITM-ITM-NBR < 0     '                    26990000
270000                                 TO DP013-MESSAGE-TEXT (1)        27000000
270100                MOVE SQLCA       TO DP013-SQLCA                   27010000
270200                SET DP013-DB2-ABEND                               27020000
270300                                 TO TRUE                          27030000
270400                PERFORM DP013-0000-PROCESS-ABEND                  27040000
270500             END-IF                                               27050000
270600                                                                  27060000
270700             IF PURITM-ITM-NBR = 0                                27070000
270800                IF PURITM-SKU-SEQ-NBR = PC-000                    27080000
270900                   MOVE '00000000' TO PV-SKU                      27090000
271000                ELSE                                              27100000
271100                   IF PURITM-SKU-SEQ-NBR = PC-999                 27110000
271200                      MOVE '99999999' TO PV-SKU                   27120000
271300                   ELSE                                           27130000
271400                      MOVE '4300-READ-ITEMS-FROM-DB'              27140000
271500                                   TO DP013-PARAGRAPH             27150000
271600                      MOVE 'PURITM-ITM-NBR = 0    '               27160000
271700                                   TO DP013-MESSAGE-TEXT (1)      27170000
271800                      MOVE SQLCA      TO DP013-SQLCA              27180000
271900                      SET DP013-DB2-ABEND                         27190000
272000                                   TO TRUE                        27200000
272100                      PERFORM DP013-0000-PROCESS-ABEND            27210000
272200                   END-IF                                         27220000
272300                END-IF                                            27230000
272400             END-IF                                               27240000
272500                                                                  27250000
272600             IF PURITM-ITM-NBR > 0 AND                            27260000
272700                ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND            27270000
272800                 (PURITM-SKU-SEQ-NBR NOT = PC-999))               27280000
272900                                                                  27290000
273000                INITIALIZE XL001-ITEM-COMMAREA                    27300000
273100                MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR        27310000
273200                                                                  27320000
273300                SET  XL001-BY-ITEM                                27330000
273400                     XL001-SELECT-SKU TO TRUE                     27340000
273500                                                                  27350000
273600                CALL XL001-VSM-PGM USING  DFHEIBLK                27360000
273700                                          XL001-COMMAREA          27370000
273800                                          XL001-ITEM-COMMAREA     27380000
273900                                                                  27390000
274000                EVALUATE TRUE                                     27400000
274100                                                                  27410000
274200                    WHEN XL001-SKU-SQLCODE = +0                   27420000
274300                          MOVE XL001-SKU-NBR                      27430000
274400                                           TO  PV-SKU             27440000
274500                                                                  27450000
274600                    WHEN XL001-SKU-SQLCODE = +100                 27460000
274700                          MOVE SPACES      TO  PV-SKU             27470000
274800                                                                  27480000
274900                    WHEN XL001-SKU-CONTENTION                     27490000
275000                          MOVE '7020-SELECT-SKU-BY-ITM'           27500000
275100                                       TO DP013-PARAGRAPH         27510000
275200                          MOVE 'SKU CONTENTION'                   27520000
275300                                       TO DP013-MESSAGE-TEXT (1)  27530000
275400                          MOVE 'XLV_SKU '                         27540000
275500                                       TO DP013-DB2-TABLE-NAME (1)27550000
275600                          MOVE XL001-SQLCA TO DP013-SQLCA         27560000
275700                          SET DP013-DB2-ABEND                     27570000
275800                                           TO TRUE                27580000
275900                          PERFORM DP013-0000-PROCESS-ABEND        27590000
276000                                                                  27600000
276100                    WHEN OTHER                                    27610000
276200                          MOVE '7020-SELECT-SKU-BY-ITM'           27620000
276300                                       TO DP013-PARAGRAPH         27630000
276400                          MOVE 'INVALID RETURN'                   27640000
276500                                       TO DP013-MESSAGE-TEXT (1)  27650000
276600                          MOVE 'XLV_SKU '                         27660000
276700                                       TO DP013-DB2-TABLE-NAME (1)27670000
276800                          MOVE XL001-SQLCA TO DP013-SQLCA         27680000
276900                          SET DP013-DB2-ABEND                     27690000
277000                                           TO TRUE                27700000
277100                          PERFORM DP013-0000-PROCESS-ABEND        27710000
277200                END-EVALUATE                                      27720000
277300             ELSE                                                 27730000
277400                MOVE SPACES      TO  PV-SKU                       27740000
277500             END-IF                                               27750000
277600         END-IF                                                   27760000
277700                                                                  27770000
277800         IF  ASC-ITEMS-LEFT-ON-DB                                 27780000
277900                                                                  27790000
278000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                27800000
278100                 ADD +1            TO  ASC-ITEM-SUB               27810000
278200             ELSE                                                 27820000
278300                 ADD +1            TO  ASC-BLK-SUB                27830000
278400                 MOVE +1           TO  ASC-ITEM-SUB               27840000
278500                                                                  27850000
278600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         27860000
278700                     MOVE +1       TO  ASC-BLK-SUB                27870000
278800                     SET ASC-BLOCK-MODIFIED (1)                   27880000
278900                                   TO  TRUE                       27890000
279000                     PERFORM 5100-WRITE-TEMP-STORAGE              27900000
279100                     MOVE ASC-BLOCK-ENTRIES                       27910000
279200                               (PC-MAX-BLOCKS-IN-ARRAY)           27920000
279300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 27930000
279400                     ADD +1        TO  ASC-BLK-SUB                27940000
279500                     INITIALIZE ASC-BLOCK-ENTRIES(ASC-BLK-SUB)    27950000
279600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      27960000
279700                                   TO  TRUE                       27970000
279800                 END-IF                                           27980000
279900             END-IF                                               27990000
280000                                                                  28000000
280100               ADD +1            TO ASC-NUMBER-OF-ITEMS-READ      28010000
280200               MOVE ASC-NUMBER-OF-ITEMS-READ                      28020000
280300                                 TO  ASC-LIST-ITEM-NUMBER         28030000
280400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28040000
280500               MOVE RECEIV-PACK-BY-ST-IND                         28050000
280600                                 TO  ASC-PACK-BY-ST-SW            28060000
280700               MOVE RECEIV-PKGNG-CDE                              28070000
280800                                 TO  ASC-RECEIV-PKGNG-CDE         28080000
280900               MOVE RECITM-ORD-LNE-NBR                            28090000
281000                                 TO  ASC-PO-LNE-NBR               28100000
281100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28110000
281200               MOVE RECITM-PREPK-ID                               28120000
281300                                 TO  ASC-PREPK-ID                 28130000
281400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28140000
281500               MOVE RECITM-STATUS-CDE                             28150000
281600                                 TO  ASC-STATUS-CDE               28160000
281700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28170000
281800               MOVE 'N'          TO ASC-CANNOT-VERIFY-SW          28180000
281900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28190000
282000               IF RECITM-STATUS-CDE = 'VE'                        28200000
282100                  IF RECITM-VRFD-USR-ID (1:2) = 'TK'              28210000
282200                  OR RECITM-VRFD-USR-ID (1:2) = 'TC'              28220000
282300                  OR RECITM-VRFD-USR-ID (1:2) = 'TV'              28230000
282400                  OR SPACES                                       28240000
282500                     MOVE PC-MANUAL TO ASC-VFY-SRC                28250000
282600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28260000
282700                  ELSE                                            28270000
282800                     MOVE RECITM-VRFD-USR-ID TO ASC-VFY-SRC       28280000
282900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28290000
283000                  END-IF                                          28300000
283100               ELSE                                               28310000
283200                  MOVE ASC-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)  28320000
283300                  TO PV-HOLD-LNE-NBR                              28330000
283400                  PERFORM 5460-SELECT-TDISTHD                     28340000
283500                  IF PS-NO-TDISTHD-FOUND                          28350000
283600                     MOVE PC-MANUAL TO ASC-VFY-SRC                28360000
283700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28370000
283800                  ELSE                                            28380000
283900                     IF DISTHD-VRFD-TMST = PC-DB2-NINES-DATE AND  28390000
284000                        DISTHD-TOT-CART-CNT > 0                   28400000
284100                         MOVE 'Y'          TO ASC-CANNOT-VERIFY-SW28410000
284200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28420000
284300                     END-IF                                       28430000
284400                     IF DISTHD-TOT-CART-CNT = 0                   28440000
284500                       MOVE PC-MANUAL TO ASC-VFY-SRC              28450000
284600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28460000
284700                     ELSE                                         28470000
284800                       IF (DISTHD-P2L-CART-CNT = 0                28480000
284900                          AND (DISTHD-FCSE-CART-CNT > 0           28490000
285000                          OR DISTHD-INPK-CART-CNT > 0))           28500000
285100                          MOVE PC-CASE TO ASC-VFY-SRC             28510000
285200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     28520000
285300                       ELSE                                       28530000
285400                          IF (DISTHD-P2L-CART-CNT > 0             28540000
285500                            AND (DISTHD-FCSE-CART-CNT > 0         28550000
285600                              OR DISTHD-INPK-CART-CNT > 0))       28560000
285700                              MOVE PC-P2L-CASE TO ASC-VFY-SRC     28570000
285800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    28580000
285900                          ELSE                                    28590000
286000                          IF (DISTHD-P2L-CART-CNT > 0             28600000
286100                             AND (DISTHD-FCSE-CART-CNT = 0        28610000
286200                             AND DISTHD-INPK-CART-CNT = 0))       28620000
286300                             MOVE PC-P2L TO ASC-VFY-SRC           28630000
286400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28640000
286500                          ELSE                                    28650000
286600                                MOVE PC-MANUAL TO ASC-VFY-SRC     28660000
286700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28670000
286800                          END-IF                                  28680000
286900                       END-IF                                     28690000
287000                     END-IF                                       28700000
287100                  END-IF                                          28710000
287200              END-IF                                              28720000
287300           END-IF                                                 28730000
287400                 MOVE PURITM-CL-NBR    TO PV-DS-CL-NBR            28740000
287500                 MOVE PV-DISPLAY-SKU                              28750000
287600                                   TO  ASC-SKU                    28760000
287700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28770000
287800                 MOVE PV-DS-DEPT-NBR   TO ASC-DEPT-NBR            28780000
287900                 MOVE RECITM-ORD-LNE-NBR                          28790000
288000                                       TO  RECDIS-ORD-LNE-NBR     28800000
288100                 MOVE RECITM-PREPK-ID                             28810000
288200                                       TO  TRBNTF-PREPK-ID        28820000
288300                 PERFORM 5475-CHECK-FOR-TROUBLE                   28830000
288400                 MOVE PS-TROUBLE-SW    TO  ASC-LINE-TRBL-SW       28840000
288500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28850000
288600                 MOVE RECITM-RCPT-DISTR-UPD-CDE TO                28860000
288700                                           ASC-DISTR-UPD-SW       28870000
288800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28880000
288900                 IF  RECITM-STATUS-CDE NOT EQUAL 'CM'             28890000
289000                     SET ASC-CANT-VERIFY                          28900000
289100                                   TO  TRUE                       28910000
289200                 END-IF                                           28920000
289300                 IF  RECITM-STATUS-CDE NOT EQUAL 'VE'             28930000
289400                     SET ASC-CANT-UNVERIFY-ST                     28940000
289500                                   TO  TRUE                       28950000
289600                 END-IF                                           28960000
289700                 IF  RECEIV-FS-POST-TMST NOT EQUAL TO             28970000
289800                     PC-FS-TIMESTAMP                              28980000
289900                        SET ASC-CANT-UNVERIFY-FS                  28990000
290000                                   TO  TRUE                       29000000
290100                 END-IF                                           29010000
290200                 IF ASC-AUTO-VE-YES                               29020000
290300                     INITIALIZE RC074-FIELDS                      29030000
290400                     MOVE RECITM-ORD-LNE-NBR  TO RC074-LINE-NBR   29040000
290500                     PERFORM 4350-CALL-RCKUT128                   29050000
290600                     MOVE RC074-INVCED-ITM-QTY                    29060000
290700                        TO  ASC-PCK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)29070000
290800                     IF  RECITM-STATUS-CDE NOT EQUAL 'VE'         29080000
290900                         MOVE RC074-TOTAL-ACTL-ITM-QTY            29090000
291000                         TO ASC-ACT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)29100000
291100                     ELSE                                         29110000
291200                         MOVE RC074-VERIFY-ITM-QTY                29120000
291300                         TO ASC-ACT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)29130000
291400                     END-IF                                       29140000
291500                     MOVE RC074-VERIFY-ITM-QTY                    29150000
291600                        TO  ASC-VFY-QTY (ASC-BLK-SUB ASC-ITEM-SUB)29160000
291700                     ADD RC074-INVCED-ITM-QTY                     29170000
291800                                          TO  ASC-TOT-PCK-QTY     29180000
291900                     ADD RC074-TOTAL-ACTL-ITM-QTY                 29190000
292000                                          TO  ASC-TOT-ACT-QTY     29200000
292100                     ADD RC074-VERIFY-ITM-QTY                     29210000
292200                                          TO  ASC-TOT-VFY-QTY     29220000
292300                 ELSE                                             29230000
292400                     PERFORM 4320-SUM-TRECDIS                     29240000
292500                     MOVE RECDIS-EXPTED-ITM-QTY                   29250000
292600                                   TO  ASC-PCK-QTY                29260000
292700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29270000
292800                     MOVE RECDIS-VERIFY-ITM-QTY                   29280000
292900                                   TO  ASC-ACT-QTY                29290000
293000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29300000
293100                     MOVE RECDIS-AP-VERIFY-ITM-QTY                29310000
293200                                   TO  ASC-VFY-QTY                29320000
293300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29330000
293400                 END-IF                                           29340000
293500         END-IF                                                   29350000
293600     END-PERFORM.                                                 29360000
293700     IF ASC-AUTO-VE-NO                                            29370000
293800         PERFORM 4330-SUM-TRECDIS-ALL                             29380000
293900         MOVE RECDIS-VERIFY-ITM-QTY                               29390000
294000            TO  ASC-TOT-ACT-QTY                                   29400000
294100         MOVE RECDIS-AP-VERIFY-ITM-QTY                            29410000
294200            TO  ASC-TOT-VFY-QTY                                   29420000
294300         MOVE RECDIS-EXPTED-ITM-QTY                               29430000
294400            TO  ASC-TOT-PCK-QTY                                   29440000
294500     END-IF.                                                      29450000
294600                                                                  29460000
294700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          29470000
294800         MOVE +1               TO ASC-BLK-SUB                     29480000
294900         PERFORM 5100-WRITE-TEMP-STORAGE                          29490000
295000         ADD +1                TO ASC-BLK-SUB                     29500000
295100         PERFORM 5100-WRITE-TEMP-STORAGE                          29510000
295200                                                                  29520000
295300         MOVE 1                TO ASC-BLK-SUB                     29530000
295400                                  PV-BLOCK-NUMBER                 29540000
295500         PERFORM 4410-READ-TEMP-STORAGE                           29550000
295600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             29560000
295700             MOVE 2            TO ASC-BLK-SUB                     29570000
295800                                  PV-BLOCK-NUMBER                 29580000
295900             PERFORM 4410-READ-TEMP-STORAGE                       29590000
296000         END-IF                                                   29600000
296100     END-IF.                                                      29610000
296200/                                                                 29620000
296300*----------------------------------------------------------------*29630000
296400* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *29640000
296500*----------------------------------------------------------------*29650000
296600*----------------------------------------------------------------*29660000
296700*    FETCH THE CURSOR.                                           *29670000
296800*----------------------------------------------------------------*29680000
296900*----------------------------------------------------------------*29690000
297000* INCLUDED NEW VARIABLE ITM_NBR.                     WR # 21361  *29700000
297100* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *29710000
297200* TO TRUE.                                                       *29720000
297300*----------------------------------------------------------------*29730000
297400                                                                  29740000
297500 4310-FETCH.                                                      29750000
297600                                                                  29760000
297700     SET PS-CALL-API-NO      TO TRUE                              29770000
297800                                                                  29780000
297900     EXEC SQL                                                     29790000
298000          FETCH                                                   29800000
298100                LIST-CSR                                          29810000
298200          INTO                                                    29820000
298300                :RECEIV-FS-POST-TMST                              29830000
298400              , :RECEIV-PACK-BY-ST-IND                            29840000
298500              , :RECEIV-PKGNG-CDE                                 29850000
298600              , :RECITM-ORD-LNE-NBR                               29860000
298700              , :RECITM-PREPK-ID                                  29870000
298800              , :RECITM-STATUS-CDE                                29880000
298900              , :RECITM-RCPT-DISTR-UPD-CDE                        29890000
299000              , :RECITM-VRFD-USR-ID                               29900000
299100              , :PURITM-CL-NBR                                    29910000
299200              , :PURITM-SKU-SEQ-NBR                               29920000
299300              , :PURITM-ITM-NBR                                   29930000
299400     END-EXEC.                                                    29940000
299500                                                                  29950000
299600     EVALUATE TRUE                                                29960000
299700         WHEN SQLCODE = ZERO                                      29970000
299800              SET PS-CALL-API-YES     TO TRUE                     29980000
299900         WHEN SQLCODE = +100                                      29990000
300000              CONTINUE                                            30000000
300100         WHEN SQLCODE = -904                                      30010000
300200         WHEN SQLCODE = -911                                      30020000
300300         WHEN SQLCODE = -913                                      30030000
300400             PERFORM 9900-SOFT-ABORT                              30040000
300500         WHEN SQLWARN0 NOT = SPACE                                30050000
300600         WHEN SQLCODE NOT = ZERO                                  30060000
300700              MOVE '4310-FETCH-CURSOR'                            30070000
300800                               TO DP013-PARAGRAPH                 30080000
300900              MOVE 'FETCH LIST CURSOR'                            30090000
301000                               TO DP013-MESSAGE-TEXT (1)          30100000
301100              MOVE SQLCA       TO DP013-SQLCA                     30110000
301200              SET DP013-DB2-ABEND                                 30120000
301300                               TO TRUE                            30130000
301400              PERFORM DP013-0000-PROCESS-ABEND                    30140000
301500     END-EVALUATE.                                                30150000
301600                                                                  30160000
301700     IF  SQLCODE EQUAL +100                                       30170000
301800         SET ASC-NO-ITEMS-LEFT-ON-DB                              30180000
301900             PS-STORE-REC      TO  TRUE                           30190000
302000     END-IF.                                                      30200000
302100/                                                                 30210000
302200*----------------------------------------------------------------*30220000
302300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *30230000
302400*----------------------------------------------------------------*30240000
302500 4320-SUM-TRECDIS.                                                30250000
302600                                                                  30260000
302700     MOVE ZERO                 TO  RECDIS-AP-VERIFY-ITM-QTY.      30270000
302800     MOVE ZERO                 TO  RECDIS-VERIFY-ITM-QTY.         30280000
302900     MOVE ZERO                 TO  RECDIS-EXPTED-ITM-QTY.         30290000
303000                                                                  30300000
303100     EXEC SQL                                                     30310000
303200          SELECT                                                  30320000
303300                 SUM(EXPTED_ITM_QTY)                              30330000
303400                ,SUM(AP_VERIFY_ITM_QTY)                           30340000
303500                ,SUM(VERIFY_ITM_QTY)                              30350000
303600          INTO                                                    30360000
303700                :RECDIS-EXPTED-ITM-QTY :PV-NULL-IND               30370000
303800               ,:RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND            30380000
303900               ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND               30390000
304000          FROM                                                    30400000
304100                 TRECDIS                                          30410000
304200          WHERE                                                   30420000
304300                ORD_NBR          =  :ASC-PO-NBR                   30430000
304400           AND  ORD_LNE_NBR      =  :RECITM-ORD-LNE-NBR           30440000
304500           AND  REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR              30450000
304600           AND  FCLTY_ID         =  :ASC-FCLTY-ID                 30460000
304700           AND  OPER_UNT_ID      =  :ASC-OPER-UNT-ID              30470000
304900     END-EXEC.                                                    30490000
305000                                                                  30500000
305100     EVALUATE TRUE                                                30510000
305200         WHEN SQLCODE = ZERO                                      30520000
305300         WHEN SQLCODE = +100                                      30530000
305400              CONTINUE                                            30540000
305500         WHEN SQLCODE = -904                                      30550000
305600         WHEN SQLCODE = -911                                      30560000
305700         WHEN SQLCODE = -913                                      30570000
305800             PERFORM 9900-SOFT-ABORT                              30580000
305900         WHEN SQLCODE = -305                                      30590000
306000              CONTINUE                                            30600000
306100         WHEN SQLWARN0 NOT = SPACE                                30610000
306200         WHEN SQLCODE NOT = ZERO                                  30620000
306300              MOVE '4320-SUM-TRECDIS'                             30630000
306400                               TO DP013-PARAGRAPH                 30640000
306500              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  30650000
306600                               TO DP013-MESSAGE-TEXT (1)          30660000
306700              MOVE SQLCA       TO DP013-SQLCA                     30670000
306800              SET DP013-DB2-ABEND                                 30680000
306900                               TO TRUE                            30690000
307000              PERFORM DP013-0000-PROCESS-ABEND                    30700000
307100     END-EVALUATE.                                                30710000
307200/                                                                 30720000
307300 4330-SUM-TRECDIS-ALL.                                            30730000
307400                                                                  30740000
307500     MOVE ZERO                 TO  RECDIS-AP-VERIFY-ITM-QTY.      30750000
307600     MOVE ZERO                 TO  RECDIS-VERIFY-ITM-QTY.         30760000
307700     MOVE ZERO                 TO  RECDIS-EXPTED-ITM-QTY.         30770000
307800                                                                  30780000
307900     EXEC SQL                                                     30790000
308000          SELECT                                                  30800000
308100                 SUM(AP_VERIFY_ITM_QTY)                           30810000
308200                ,SUM(VERIFY_ITM_QTY)                              30820000
308300                ,SUM(EXPTED_ITM_QTY)                              30830000
308400          INTO                                                    30840000
308500                :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND            30850000
308600               ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND               30860000
308700               ,:RECDIS-EXPTED-ITM-QTY :PV-NULL-IND               30870000
308800          FROM                                                    30880000
308900                 TRECDIS                                          30890000
309000          WHERE                                                   30900000
309100                ORD_NBR          =  :ASC-PO-NBR                   30910000
309200           AND  REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR              30920000
309300           AND  FCLTY_ID         =  :ASC-FCLTY-ID                 30930000
309400           AND  OPER_UNT_ID      =  :ASC-OPER-UNT-ID              30940000
309600     END-EXEC.                                                    30960000
309700                                                                  30970000
309800     EVALUATE TRUE                                                30980000
309900         WHEN SQLCODE = ZERO                                      30990000
310000         WHEN SQLCODE = +100                                      31000000
310100              CONTINUE                                            31010000
310200         WHEN SQLCODE = -904                                      31020000
310300         WHEN SQLCODE = -911                                      31030000
310400         WHEN SQLCODE = -913                                      31040000
310500             PERFORM 9900-SOFT-ABORT                              31050000
310600         WHEN SQLCODE = -305                                      31060000
310700              CONTINUE                                            31070000
310800         WHEN SQLWARN0 NOT = SPACE                                31080000
310900         WHEN SQLCODE NOT = ZERO                                  31090000
311000              MOVE '4320-SUM-TRECDIS'                             31100000
311100                               TO DP013-PARAGRAPH                 31110000
311200              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  31120000
311300                               TO DP013-MESSAGE-TEXT (1)          31130000
311400              MOVE SQLCA       TO DP013-SQLCA                     31140000
311500              SET DP013-DB2-ABEND                                 31150000
311600                               TO TRUE                            31160000
311700              PERFORM DP013-0000-PROCESS-ABEND                    31170000
311800     END-EVALUATE.                                                31180000
311900/                                                                 31190000
312000 4350-CALL-RCKUT128.                                              31200000
312100     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               31210000
312200     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  31220000
312300     MOVE ASC-PO-NBR          TO RC074-PO-NBR.                    31230000
312400     MOVE ASC-REC-SEQ-NBR     TO RC074-RCVR-SEQ-NBR.              31240000
312500     MOVE ASC-AUTO-VE-SW      TO RC074-AUTO-VE-SW.                31250000
312600     SET RC074-UNIT-QTY-YES   TO TRUE.                            31260000
312700                                                                  31270000
312800     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 31280000
312900                                         RC074-COMMAREA           31290000
313000                                         RC074-FIELDS.            31300000
313100                                                                  31310000
313200     EVALUATE TRUE                                                31320000
313300         WHEN RC074-SUCCESSFUL                                    31330000
313400             CONTINUE                                             31340000
313500         WHEN OTHER                                               31350000
313600             MOVE '4350-CALL-RCKUT128'                            31360000
313700                                 TO DP013-PARAGRAPH               31370000
313800             STRING                                               31380000
313900                  'UNSUCCESSFUL CALL TO RCKUT128 '                31390000
314000                  'SUCCESS-IND = '                                31400000
314100                  RC074-SUCCESS-IND                               31410000
314200                               DELIMITED BY SIZE                  31420000
314300                               INTO DP013-MESSAGE-TEXT (1)        31430000
314400             MOVE RC074-CRA-RET-MSG                               31440000
314500                                 TO DP013-MESSAGE-TEXT (2)        31450000
314600             MOVE RC074-SQLCA    TO DP013-SQLCA                   31460000
314700             SET DP013-DB2-ABEND                                  31470000
314800                 DP013-XCTL-DISPLAY-RESTART                       31480000
314900                                 TO TRUE                          31490000
315000             PERFORM DP013-0000-PROCESS-ABEND                     31500000
315100     END-EVALUATE.                                                31510000
315200                                                                  31520000
315300*----------------------------------------------------------------*31530000
315400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31540000
315500*----------------------------------------------------------------*31550000
315600                                                                  31560000
315700 4400-MOVE-COMMAREA-TO-SCREEN.                                    31570000
315800                                                                  31580000
315900                                                                  31590000
316000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             31600000
316100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          31610000
316200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          31620000
316300             MOVE +1    TO ASC-BLK-SUB                            31630000
316400             PERFORM 5100-WRITE-TEMP-STORAGE                      31640000
316500             ADD +1     TO ASC-BLK-SUB                            31650000
316600             PERFORM 5100-WRITE-TEMP-STORAGE                      31660000
316700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             31670000
316800                 GIVING PV-BLOCK-NUMBER                           31680000
316900                 REMAINDER PV-REMAINDER                           31690000
317000             IF  PV-REMAINDER > ZERO                              31700000
317100                 ADD +1 TO PV-BLOCK-NUMBER                        31710000
317200             END-IF                                               31720000
317300             MOVE +1    TO ASC-BLK-SUB                            31730000
317400             PERFORM 4410-READ-TEMP-STORAGE                       31740000
317500             ADD +1     TO ASC-BLK-SUB                            31750000
317600                           PV-BLOCK-NUMBER                        31760000
317700             PERFORM 4410-READ-TEMP-STORAGE                       31770000
317800     END-IF.                                                      31780000
317900                                                                  31790000
318000     MOVE +1            TO ASC-BLK-SUB.                           31800000
318100     COMPUTE ASC-ITEM-SUB =                                       31810000
318200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              31820000
318300         + PC-ITEMS-PER-PANEL).                                   31830000
318400                                                                  31840000
318500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        31850000
318600         ADD +1         TO ASC-BLK-SUB                            31860000
318700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            31870000
318800     END-IF.                                                      31880000
318900                                                                  31890000
319000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           31900000
319100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                31910000
319200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        31920000
319300     PERFORM 4420-FORMAT-LIST-LINES                               31930000
319400         VARYING PV-SUB                                           31940000
319500         FROM PC-ITEMS-PER-PANEL BY -1                            31950000
319600         UNTIL PV-SUB < +1.                                       31960000
319700                                                                  31970000
319800     COMPUTE ASC-ITEMS-DISPLAYED =                                31980000
319900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          31990000
320000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL.   32000000
320100     IF  PS-NO-ERROR                                              32010000
320200         MOVE PV-TOP-ITEM          TO ASTRTITO                    32020000
320300     END-IF.                                                      32030000
320400     MOVE ASC-RECEIV-STATUS-CDE    TO ARCVSTAO.                   32040000
320500     MOVE ASC-RECEIV-VRFY-INFO     TO ARCVFYAO.                   32050000
320600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    32060000
320700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    32070000
320800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32080000
320900                                   TO ASELITO.                    32090000
321000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     32100000
321100                                                                  32110000
321200     EVALUATE TRUE                                                32120000
321300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   32130000
321400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   32140000
321500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  32150000
321600         WHEN DP020-SRC-AID = DP016-ENTER                         32160000
321700             IF  ASC-CONFIRM-ZERO                                 32170000
321800                 MOVE PC-TSYMSG-01876  TO DP020-MSG-NUMBER        32180000
321900                 SET DP020-MSG-WARNING TO TRUE                    32190000
322000             ELSE                                                 32200000
322100             IF  ASC-CONFIRM-UNVERIFY                             32210000
322200                 MOVE PC-TSYMSG-01129  TO DP020-MSG-NUMBER        32220000
322300                 SET DP020-MSG-WARNING TO TRUE                    32230000
322400             END-IF                                               32240000
322500             END-IF                                               32250000
322600     END-EVALUATE.                                                32260000
322700                                                                  32270000
322800     IF  DP020-MSG-NUMBER-X = SPACE                               32280000
322900         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32290000
323000*            --- MORE ITEMS TO DISPLAY ----                       32300000
323100             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            32310000
323200             SET DP020-MSG-INFORMATIONAL TO TRUE                  32320000
323300         END-IF                                                   32330000
323400     END-IF.                                                      32340000
323500                                                                  32350000
323600     MOVE ASC-PO-NBR               TO ARCVNBRO.                   32360000
323700     MOVE ASC-REC-SEQ-NBR          TO ARCVSEQO.                   32370000
323800     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     32380000
323900     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    32390000
324000     MOVE ASC-FCLTY-NME            TO AFCLNAMO.                   32400000
324100     MOVE ASC-TOT-PCK-QTY          TO ARCVPCKO.                   32410000
324200     MOVE ASC-TOT-ACT-QTY          TO ARCVACTO.                   32420000
324300     MOVE ASC-TOT-VFY-QTY          TO ARCVVERO.                   32430000
324400     MOVE ASC-DEPT-NBR             TO ADEPTO.                     32440000
324500                                                                  32450000
324600*----------------------------------------------------------------*32460000
324700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *32470000
324800*----------------------------------------------------------------*32480000
324900                                                                  32490000
325000 4410-READ-TEMP-STORAGE.                                          32500000
325100                                                                  32510000
325200     EXEC CICS                                                    32520000
325300         READQ TS                                                 32530000
325400             QUEUE (ASC-LIST-QUEUE-NAME)                          32540000
325500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32550000
325600             ITEM  (PV-BLOCK-NUMBER)                              32560000
325700             RESP  (PV-CICS-RESP)                                 32570000
325800     END-EXEC.                                                    32580000
325900                                                                  32590000
326000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       32600000
326100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     32610000
326200         CONTINUE                                                 32620000
326300     ELSE                                                         32630000
326400         SET DP013-CICS-ABEND     TO TRUE                         32640000
326500         SET DP013-NO-ROLLBACK    TO TRUE                         32650000
326600         MOVE '4410-READ-TEMP-STORAGE'                            32660000
326700                                  TO DP013-PARAGRAPH              32670000
326800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      32680000
326900                                  TO DP013-MESSAGE-TEXT(1)        32690000
327000         PERFORM DP013-0000-PROCESS-ABEND                         32700000
327100     END-IF.                                                      32710000
327200                                                                  32720000
327300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             32730000
327400                                                                  32740000
327500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         32750000
327600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               32760000
327700     END-IF.                                                      32770000
327800/                                                                 32780000
327900*----------------------------------------------------------------*32790000
328000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *32800000
328100*----------------------------------------------------------------*32810000
328200                                                                  32820000
328300 4420-FORMAT-LIST-LINES.                                          32830000
328400                                                                  32840000
328500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      32850000
328600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                32860000
328700         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA      (PV-SUB)      32870000
328800         MOVE DP015-BLUE         TO MR-STATUS-CDEC  (PV-SUB)      32880000
328900         MOVE SPACE              TO MR-SELECTI      (PV-SUB)      32890000
329000                                    MR-ACTION       (PV-SUB)      32900000
329100                                    MR-LNE-NBR-X    (PV-SUB)      32910000
329200                                    MR-STATUS-CDE   (PV-SUB)      32920000
329300                                    MR-PCK-QTY-X    (PV-SUB)      32930000
329400                                    MR-ACT-QTY-X    (PV-SUB)      32940000
329500                                    MR-VFY-QTY-X    (PV-SUB)      32950000
329600                                    MR-SKU          (PV-SUB)      32960000
329700                                    MR-VFY-SRC-X    (PV-SUB)      32970000
329800     ELSE                                                         32980000
329900         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32990000
330000                                                   > SPACE        33000000
330100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33010000
330200                                 TO MR-SELECTI (PV-SUB)           33020000
330300         ELSE                                                     33030000
330400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33040000
330500                                 TO MR-SELECTI (PV-SUB)           33050000
330600         END-IF                                                   33060000
330700                                                                  33070000
330800         IF  DP030-SET-CURSOR-TRAILER                             33080000
330900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33090000
331000                 > SPACE)                                         33100000
331100               OR (PV-SUB = 1))                                   33110000
331200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33120000
331300                MOVE -1          TO MR-SELECTL (PV-SUB)           33130000
331400             END-IF                                               33140000
331500         END-IF                                                   33150000
331600                                                                  33160000
331700         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           33170000
331800             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           33180000
331900                                 TO MR-ACTION         (PV-SUB)    33190000
332000             MOVE ASC-PO-LNE-NBR   (ASC-BLK-SUB ASC-ITEM-SUB)     33200000
332100                                 TO MR-LNE-NBR        (PV-SUB)    33210000
332200             MOVE ASC-STATUS-CDE   (ASC-BLK-SUB ASC-ITEM-SUB)     33220000
332300                                 TO MR-STATUS-CDE     (PV-SUB)    33230000
332400             MOVE ASC-VFY-SRC   (ASC-BLK-SUB ASC-ITEM-SUB)        33240000
332500                                 TO MR-VFY-SRC-X      (PV-SUB)    33250000
332600             IF ASC-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB) =       33260000
332700                'VE'                                              33270000
332800                 MOVE DP015-BLUE    TO MR-VFY-SRCC (PV-SUB)       33280000
332900             ELSE                                                 33290000
333000                 MOVE DP015-YELLOW  TO MR-VFY-SRCC (PV-SUB)       33300000
333100             END-IF                                               33310000
333200             IF ASC-LINE-TRBL-SW (ASC-BLK-SUB ASC-ITEM-SUB) = 'Y' 33320000
333300                 MOVE DP015-YELLOW   TO MR-STATUS-CDEC  (PV-SUB)  33330000
333400             ELSE                                                 33340000
333500                 MOVE DP015-BLUE     TO MR-STATUS-CDEC  (PV-SUB)  33350000
333600             END-IF                                               33360000
333700             MOVE ASC-PCK-QTY      (ASC-BLK-SUB ASC-ITEM-SUB)     33370000
333800                                 TO MR-PCK-QTY        (PV-SUB)    33380000
333900             MOVE ASC-ACT-QTY      (ASC-BLK-SUB ASC-ITEM-SUB)     33390000
334000                                 TO MR-ACT-QTY        (PV-SUB)    33400000
334100             IF ASC-STATUS-CDE   (ASC-BLK-SUB ASC-ITEM-SUB)       33410000
334200                      = 'VE'                                      33420000
334300                  MOVE                                            33430000
334400                    ASC-VFY-QTY (ASC-BLK-SUB ASC-ITEM-SUB)        33440000
334500                              TO MR-VFY-QTY     (PV-SUB)          33450000
334600             ELSE                                                 33460000
334700                  MOVE                                            33470000
334800                      SPACES TO MR-VFY-QTY-X   (PV-SUB)           33480000
334900             END-IF                                               33490000
335000             MOVE ASC-SKU          (ASC-BLK-SUB ASC-ITEM-SUB)     33500000
335100                                 TO MR-SKU            (PV-SUB)    33510000
335200         END-IF                                                   33520000
335300     END-IF.                                                      33530000
335400                                                                  33540000
335500     SUBTRACT +1 FROM ASC-ITEM-SUB                                33550000
335600     IF  ASC-ITEM-SUB < + 1                                       33560000
335700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  33570000
335800         MOVE +1                 TO ASC-BLK-SUB                   33580000
335900     END-IF.                                                      33590000
336000                                                                  33600000
336100******************************************************************33610000
336200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **33620000
336300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **33630000
336400** ISSUE A WARNING.                                             **33640000
336500******************************************************************33650000
336600                                                                  33660000
336700 4430-CHECK-FOR-BEGIN-AND-END.                                    33670000
336800                                                                  33680000
336900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       33690000
337000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     33700000
337100*            -- NO END-OF-RANGE SPECFIED ---                      33710000
337200             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            33720000
337300             SET DP020-MSG-WARNING TO TRUE                        33730000
337400             PERFORM 4431-POSITION-AT-WARNING                     33740000
337500         END-IF                                                   33750000
337600     ELSE                                                         33760000
337700         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     33770000
337800*            -- NO BEGINNING-OF-RANGE SPECFIED ---                33780000
337900             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            33790000
338000             SET DP020-MSG-WARNING TO TRUE                        33800000
338100             PERFORM 4431-POSITION-AT-WARNING                     33810000
338200         END-IF                                                   33820000
338300     END-IF.                                                      33830000
338400******************************************************************33840000
338500** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **33850000
338600** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **33860000
338700** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **33870000
338800** POSITION THE CURSOR THERE.                                   **33880000
338900******************************************************************33890000
339000                                                                  33900000
339100 4431-POSITION-AT-WARNING.                                        33910000
339200                                                                  33920000
339300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 33930000
339400                    - PV-TOP-ITEM + 1.                            33940000
339500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      33950000
339600         CONTINUE                                                 33960000
339700     ELSE                                                         33970000
339800         SET DP030-SET-CURSOR-APPL-1                              33980000
339900                                   TO TRUE                        33990000
340000         MOVE -1                   TO MR-SELECTL (PV-SUB)         34000000
340100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34010000
340200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34020000
340300     END-IF.                                                      34030000
340400                                                                  34040000
340500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34050000
340600                    - PV-TOP-ITEM + 1.                            34060000
340700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34070000
340800         CONTINUE                                                 34080000
340900     ELSE                                                         34090000
341000         SET DP030-SET-CURSOR-APPL-1                              34100000
341100                                   TO TRUE                        34110000
341200         MOVE -1                   TO MR-SELECTL (PV-SUB)         34120000
341300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34130000
341400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34140000
341500     END-IF.                                                      34150000
341600/                                                                 34160000
341700*----------------------------------------------------------------*34170000
341800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34180000
341900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34190000
342000* FOR THE SELECTED ITEMS QUEUE.                                  *34200000
342100*                                                                *34210000
342200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *34220000
342300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *34230000
342400* THE ARRAY IS FULL.                                             *34240000
342500*----------------------------------------------------------------*34250000
342600                                                                  34260000
342700 5000-PREPARE-SEL-QUEUE.                                          34270000
342800                                                                  34280000
342900     MOVE +1                   TO  ASC-BLK-SUB.                   34290000
343000     PERFORM 5100-WRITE-TEMP-STORAGE.                             34300000
343100     ADD +1                    TO  ASC-BLK-SUB.                   34310000
343200     PERFORM 5100-WRITE-TEMP-STORAGE.                             34320000
343300                                                                  34330000
343400     INITIALIZE RC015-INTER-APPL-COMMAREA.                        34340000
343500     MOVE ASC-OPER-UNT-ID      TO  RC015-OPER-UNT-ID.             34350000
343600     MOVE ASC-FCLTY-ID         TO  RC015-FCLTY-ID.                34360000
343700     MOVE ASC-PO-NBR           TO  RC015-PO-NBR.                  34370000
343800     MOVE ASC-REC-SEQ-NBR      TO  RC015-REC-SEQ-NBR.             34380000
343900     MOVE ASC-SEL-QUEUE-NAME   TO  RC015-SEL-QUEUE-NAME.          34390000
344000     MOVE ASC-PACK-BY-ST-SW    TO  RC015-PACK-BY-ST-SW.           34400000
344100     PERFORM 6010-DELETE-SEL-QUEUE.                               34410000
344200                                                                  34420000
344300     SET ASC-UPDATE-TSQ        TO  TRUE.                          34430000
344400                                                                  34440000
344500     SET RC013-IDX             TO  1.                             34450000
344600     MOVE ZERO                 TO RC015-NUMBER-OF-TS-ITEMS.       34460000
344700     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        34470000
344800                                                                  34480000
344900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           34490000
345000             VARYING PV-ITEM                                      34500000
345100             FROM 1 BY 1                                          34510000
345200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     34520000
345300                                                                  34530000
345400     IF  RC013-IDX > 1                                            34540000
345500         PERFORM 5205-WRITE-SEL-QUEUE                             34550000
345600         ADD +1                TO RC015-NUMBER-OF-TS-ITEMS        34560000
345700     END-IF.                                                      34570000
345800/                                                                 34580000
345900*----------------------------------------------------------------*34590000
346000*                                                                *34600000
346100*    ENSURE EACH SELECTED ITEM HAS A STATUS CODE OF CM.  IF SO,  *34610000
346200*    UPDATE THE VERIFIED ITEM QUANTITY AND THE AP VERIFIED ITEM  *34620000
346300*    QUANTITY ON TRECDIS; SET THE STATUS TO VE                   *34630000
346400*    NEXT, CHECK IF ALL TRECITM ROWS FOR THIS RECEIVER HAVE A    *34640000
346500*    VE STATUS CODE.  IF SO, UPDATE THE TRECEIV ROW TO A STATUS  *34650000
346600*    OF VE.                                                      *34660000
346700*----------------------------------------------------------------*34670000
346800                                                                  34680000
346900 5050-PREPARE-TO-VERIFY.                                          34690000
347000                                                                  34700000
347100     MOVE +1                   TO  ASC-BLK-SUB.                   34710000
347200     PERFORM 5100-WRITE-TEMP-STORAGE.                             34720000
347300     ADD +1                    TO  ASC-BLK-SUB.                   34730000
347400     PERFORM 5100-WRITE-TEMP-STORAGE.                             34740000
347500*                                                                 34750000
347600*    IF ALL ITEMS IN LIST HAVE A 'CM' STATUS, SKIP 5300 AND       34760000
347700*    PROCESS 5400 DIRECTLY.                                       34770000
347800*                                                                 34780000
347900     IF  ASC-CAN-VERIFY                                           34790000
348000         PERFORM 5400-PROCESS-TRECDIS                             34800000
348100                 VARYING PV-ITEM                                  34810000
348200                 FROM 1 BY 1                                      34820000
348300                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  34830000
348400         SET ASC-CANT-VERIFY   TO  TRUE                           34840000
348500         PERFORM 5700-COUNT-TRECITM                               34850000
348600     ELSE                                                         34860000
348700         SET PS-CAN-VERIFY     TO  TRUE                           34870000
348800         PERFORM 5300-FIRST-PASS-TRECDIS                          34880000
348900                 VARYING PV-ITEM                                  34890000
349000                 FROM 1 BY 1                                      34900000
349100                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  34910000
349200                   OR  PS-CANT-VERIFY                             34920000
349300         IF  PS-CAN-VERIFY                                        34930000
349400             PERFORM 5400-PROCESS-TRECDIS                         34940000
349500                     VARYING PV-ITEM                              34950000
349600                     FROM 1 BY 1                                  34960000
349700                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    34970000
349800             PERFORM 5700-COUNT-TRECITM                           34980000
349900         ELSE                                                     34990000
350000*            MOVE PC-VERIFIED-MESSAGE                             35000000
350100*                              TO  DP020-MSG-MESSAGE              35010000
350200             MOVE PC-TSYMSG-03296 TO DP020-MSG-NUMBER             35020000
350300             SET DP020-MSG-FATAL                                  35030000
350400                 PS-ERROR      TO  TRUE                           35040000
350500         END-IF                                                   35050000
350600     END-IF.                                                      35060000
350700                                                                  35070000
350800 5060-PREPARE-TO-UNVERIFY.                                        35080000
350900                                                                  35090000
351000     MOVE +1                   TO  ASC-BLK-SUB.                   35100000
351100     PERFORM 5100-WRITE-TEMP-STORAGE.                             35110000
351200     ADD +1                    TO  ASC-BLK-SUB.                   35120000
351300     PERFORM 5100-WRITE-TEMP-STORAGE.                             35130000
351400*                                                                 35140000
351500     IF  ASC-CAN-UNVERIFY                                         35150000
351600         PERFORM 5410-PROCESS-TRECDIS-UNVERIFY                    35160000
351700                 VARYING PV-ITEM                                  35170000
351800                 FROM 1 BY 1                                      35180000
351900                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  35190000
352000         SET ASC-CANT-UNVERIFY TO  TRUE                           35200000
352100         PERFORM 5705-COUNT-TRECITM-UNVERIFY                      35210000
352200     ELSE                                                         35220000
352300         SET PS-CAN-UNVERIFY     TO  TRUE                         35230000
352400         PERFORM 5310-FIRST-PASS-TRECDIS-UNVRF                    35240000
352500                 VARYING PV-ITEM                                  35250000
352600                 FROM 1 BY 1                                      35260000
352700                 UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN  35270000
352800                   OR  PS-CANT-UNVERIFY                           35280000
352900         IF  PS-CAN-UNVERIFY                                      35290000
353000             PERFORM 5410-PROCESS-TRECDIS-UNVERIFY                35300000
353100                     VARYING PV-ITEM                              35310000
353200                     FROM 1 BY 1                                  35320000
353300                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    35330000
353400             PERFORM 5705-COUNT-TRECITM-UNVERIFY                  35340000
353500         ELSE                                                     35350000
353600             IF ASC-CANT-UNVERIFY-FS                              35360000
353700                  MOVE PC-TSYMSG-01128     TO  DP020-MSG-NUMBER   35370000
353800                  SET DP020-MSG-FATAL                             35380000
353900                      PS-ERROR      TO  TRUE                      35390000
354000             ELSE                                                 35400000
354100                  MOVE PC-TSYMSG-01127     TO  DP020-MSG-NUMBER   35410000
354200                  SET DP020-MSG-FATAL                             35420000
354300                  PS-ERROR      TO  TRUE                          35430000
354400             END-IF                                               35440000
354500         END-IF                                                   35450000
354600     END-IF.                                                      35460000
354700/                                                                 35470000
354800*----------------------------------------------------------------*35480000
354900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *35490000
355000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *35500000
355100*----------------------------------------------------------------*35510000
355200                                                                  35520000
355300 5100-WRITE-TEMP-STORAGE.                                         35530000
355400                                                                  35540000
355500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35550000
355600                                   TO PV-LIST-ITEM-NUMBER.        35560000
355700     COMPUTE PV-BLOCK-NUMBER =                                    35570000
355800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35580000
355900                                                                  35590000
356000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35600000
356100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35610000
356200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35620000
356300             PERFORM 5105-REWRITE-ASC-LISTQ                       35630000
356400         END-IF                                                   35640000
356500     ELSE                                                         35650000
356600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35660000
356700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35670000
356800         PERFORM 5110-WRITE-ASC-LISTQ                             35680000
356900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35690000
357000     END-IF.                                                      35700000
357100                                                                  35710000
357200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35720000
357300                                                                  35730000
357400******************************************************************35740000
357500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **35750000
357600** SPECIFIC COMMAREA.                                           **35760000
357700******************************************************************35770000
357800                                                                  35780000
357900 5105-REWRITE-ASC-LISTQ.                                          35790000
358000                                                                  35800000
358100     EXEC CICS                                                    35810000
358200         WRITEQ TS                                                35820000
358300             QUEUE (ASC-LIST-QUEUE-NAME)                          35830000
358400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35840000
358500             ITEM  (PV-BLOCK-NUMBER)                              35850000
358600             REWRITE                                              35860000
358700             RESP  (PV-CICS-RESP)                                 35870000
358800     END-EXEC.                                                    35880000
358900                                                                  35890000
359000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35900000
359100         CONTINUE                                                 35910000
359200     ELSE                                                         35920000
359300         SET DP013-CICS-ABEND            TO TRUE                  35930000
359400         SET DP013-NO-ROLLBACK           TO TRUE                  35940000
359500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       35950000
359600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35960000
359700                                         TO DP013-MESSAGE-TEXT(1) 35970000
359800         PERFORM DP013-0000-PROCESS-ABEND                         35980000
359900     END-IF.                                                      35990000
360000                                                                  36000000
360100******************************************************************36010000
360200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **36020000
360300** SPECIFIC COMMAREA.                                           **36030000
360400******************************************************************36040000
360500                                                                  36050000
360600 5110-WRITE-ASC-LISTQ.                                            36060000
360700                                                                  36070000
360800     EXEC CICS                                                    36080000
360900         WRITEQ TS                                                36090000
361000             QUEUE (ASC-LIST-QUEUE-NAME)                          36100000
361100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36110000
361200             ITEM  (PV-BLOCK-NUMBER)                              36120000
361300             RESP  (PV-CICS-RESP)                                 36130000
361400     END-EXEC.                                                    36140000
361500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      36150000
361600         SET DP013-CICS-ABEND      TO TRUE                        36160000
361700         SET DP013-NO-ROLLBACK     TO TRUE                        36170000
361800         MOVE '5110-WRITE-ASC-LISTQ'                              36180000
361900                                   TO DP013-PARAGRAPH             36190000
362000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           36200000
362100                                   TO DP013-MESSAGE-TEXT(1)       36210000
362200         PERFORM DP013-0000-PROCESS-ABEND                         36220000
362300     END-IF.                                                      36230000
362400/                                                                 36240000
362500*----------------------------------------------------------------*36250000
362600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *36260000
362700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *36270000
362800*----------------------------------------------------------------*36280000
362900                                                                  36290000
363000 5200-FILL-SEL-QUEUE-RECORD.                                      36300000
363100                                                                  36310000
363200     PERFORM 6112-READ-LIST-QUEUE.                                36320000
363300                                                                  36330000
363400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36340000
363500         PERFORM                                                  36350000
363600         VARYING LQW-IDX                                          36360000
363700         FROM 1 BY 1                                              36370000
363800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36380000
363900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          36390000
364000                                                                  36400000
364100             IF  LQW-SELECT (LQW-IDX)                             36410000
364200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              36420000
364300                                   TO RC013-ITEM (RC013-IDX)      36430000
364400                 MOVE LQW-PO-LNE-NBR     (LQW-IDX)                36440000
364500                                   TO RC013-PKSL-LNE-NBR-N        36450000
364600                                        (RC013-IDX)               36460000
364700                 MOVE SPACE        TO RC013-ACTION-SW (RC013-IDX) 36470000
364800                 EVALUATE LQW-VFY-SRC (LQW-IDX)                   36480000
364900                    WHEN PC-MANUAL                                36490000
365000                        MOVE '1' TO RC013-CSR-IND (RC013-IDX)     36500000
365100                    WHEN PC-P2L                                   36510000
365200                        MOVE '2' TO RC013-CSR-IND (RC013-IDX)     36520000
365300                    WHEN PC-CASE                                  36530000
365400                        MOVE '3' TO RC013-CSR-IND (RC013-IDX)     36540000
365500                    WHEN PC-P2L-CASE                              36550000
365600                        MOVE '4' TO RC013-CSR-IND (RC013-IDX)     36560000
365700                    WHEN OTHER                                    36570000
365800                        MOVE SPACE TO RC013-CSR-IND (RC013-IDX)   36580000
365900                 END-EVALUATE                                     36590000
366000                 SET RC013-IDX UP BY 1                            36600000
366100                 IF  RC013-IDX > RC013-MAX-ITEMS                  36610000
366200                     PERFORM 5205-WRITE-SEL-QUEUE                 36620000
366300                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    36630000
366400                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         36640000
366500                     SET RC013-IDX TO  1                          36650000
366600                 END-IF                                           36660000
366700             END-IF                                               36670000
366800         END-PERFORM                                              36680000
366900     END-IF.                                                      36690000
367000/                                                                 36700000
367100*----------------------------------------------------------------*36710000
367200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *36720000
367300*----------------------------------------------------------------*36730000
367400                                                                  36740000
367500 5205-WRITE-SEL-QUEUE.                                            36750000
367600                                                                  36760000
367700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36770000
367800                                   TO RC013-SELECTED-ITEMS.       36780000
367900                                                                  36790000
368000     EXEC CICS                                                    36800000
368100          WRITEQ TS                                               36810000
368200              QUEUE (ASC-SEL-QUEUE-NAME)                          36820000
368300              FROM  (RC013-DC-SELECT-RECORD)                      36830000
368400              ITEM  (PV-SEL-QUEUE-ITEM)                           36840000
368500              RESP  (PV-CICS-RESP)                                36850000
368600     END-EXEC.                                                    36860000
368700                                                                  36870000
368800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36880000
368900         CONTINUE                                                 36890000
369000     ELSE                                                         36900000
369100         SET DP013-CICS-ABEND      TO TRUE                        36910000
369200         SET DP013-NO-ROLLBACK     TO TRUE                        36920000
369300         MOVE '5205-WRITE-SEL-QUEUE'                              36930000
369400                                   TO DP013-PARAGRAPH             36940000
369500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36950000
369600                                   TO DP013-MESSAGE-TEXT(1)       36960000
369700         PERFORM DP013-0000-PROCESS-ABEND                         36970000
369800     END-IF.                                                      36980000
369900/                                                                 36990000
370000*----------------------------------------------------------------*37000000
370100*    CHECK IF ALL SELECTED ITEMS HAVE A 'CM' STATUS CODE         *37010000
370200*----------------------------------------------------------------*37020000
370300                                                                  37030000
370400 5300-FIRST-PASS-TRECDIS.                                         37040000
370500                                                                  37050000
370600     PERFORM 6112-READ-LIST-QUEUE.                                37060000
370700                                                                  37070000
370800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37080000
370900         PERFORM                                                  37090000
371000         VARYING LQW-IDX                                          37100000
371100         FROM 1 BY 1                                              37110000
371200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37120000
371300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37130000
371400           OR  PS-CANT-VERIFY                                     37140000
371500                                                                  37150000
371600             IF  LQW-SELECT (LQW-IDX)                             37160000
371700                 IF  LQW-STATUS-CDE (LQW-IDX) EQUAL 'CM'          37170000
371800                 OR  LQW-STATUS-CDE (LQW-IDX) EQUAL 'IP'          37180000
371900                     CONTINUE                                     37190000
372000                 ELSE                                             37200000
372100                     SET PS-CANT-VERIFY                           37210000
372200                                   TO  TRUE                       37220000
372300                 END-IF                                           37230000
372400             END-IF                                               37240000
372500         END-PERFORM                                              37250000
372600     END-IF.                                                      37260000
372700                                                                  37270000
372800 5310-FIRST-PASS-TRECDIS-UNVRF.                                   37280000
372900                                                                  37290000
373000     PERFORM 6112-READ-LIST-QUEUE.                                37300000
373100                                                                  37310000
373200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37320000
373300         PERFORM                                                  37330000
373400         VARYING LQW-IDX                                          37340000
373500         FROM 1 BY 1                                              37350000
373600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37360000
373700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37370000
373800           OR  PS-CANT-UNVERIFY                                   37380000
373900                                                                  37390000
374000             IF  LQW-SELECT (LQW-IDX)                             37400000
374100                 IF  LQW-STATUS-CDE (LQW-IDX) EQUAL 'VE'          37410000
374200                     CONTINUE                                     37420000
374300                 ELSE                                             37430000
374400                     SET PS-CANT-UNVERIFY                         37440000
374500                                   TO  TRUE                       37450000
374600                 END-IF                                           37460000
374700             END-IF                                               37470000
374800         END-PERFORM                                              37480000
374900     END-IF.                                                      37490000
375000/                                                                 37500000
375100*----------------------------------------------------------------*37510000
375200*    UPDATE TRECDIS FOR EACH SELECTED ITEM.                      *37520000
375300*----------------------------------------------------------------*37530000
375400                                                                  37540000
375500 5400-PROCESS-TRECDIS.                                            37550000
375600                                                                  37560000
375700     PERFORM 6112-READ-LIST-QUEUE.                                37570000
375800                                                                  37580000
375900                                                                  37590000
376000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37600000
376100         PERFORM                                                  37610000
376200         VARYING LQW-IDX                                          37620000
376300         FROM 1 BY 1                                              37630000
376400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37640000
376500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37650000
376600                                                                  37660000
376700             IF  LQW-SELECT (LQW-IDX)                             37670000
376800                 MOVE LQW-PO-LNE-NBR(LQW-IDX)                     37680000
376900                                 TO  RECDIS-ORD-LNE-NBR           37690000
377000                 MOVE LQW-PREPK-ID(LQW-IDX)                       37700000
377100                                 TO  TRBNTF-PREPK-ID              37710000
377200                 PERFORM 5450-COUNT-TRECDIS-ROWS                  37720000
377300                 INITIALIZE RC038-FIELDS                          37730000
377400                 SET RC038-VERIFY TO TRUE                         37740000
377500                 PERFORM 7000-CALL-VEM-MODULE                     37750000
377600                 PERFORM 5415-CHECK-ERRORS                        37760000
377700                 IF PS-ERROR                                      37770000
377800                     CONTINUE                                     37780000
377900                 ELSE                                             37790000
378000                     MOVE 'VE'   TO  PV-STATUS-CDE                37800000
378100                     PERFORM 5500-UPDATE-TRECDIS-VERIFY           37810000
378200                     SET PS-PO-VERIFY TO TRUE                     37820000
378300                     PERFORM 5600-UPDATE-TRECITM                  37830000
378400                     PERFORM 9000-CALL-PO-RCVR-TRKING-MOD         37840000
378500                     IF PS-NO-ERROR                               37850000
378600                         PERFORM 5800-CHECK-POLINE-FOR-UPDATE     37860000
378700                         MOVE 'VE'   TO  LQW-STATUS-CDE (LQW-IDX) 37870000
378800                         MOVE PC-MANUAL TO  LQW-VFY-SRC (LQW-IDX) 37880000
378900                                                                  37890000
379000                         IF ASC-AUTO-VE-YES                       37900000
379100                             INITIALIZE RC074-FIELDS              37910000
379200                             MOVE LQW-PO-LNE-NBR(LQW-IDX)         37920000
379300                                              TO RC074-LINE-NBR   37930000
379400                             PERFORM 4350-CALL-RCKUT128           37940000
379500                             MOVE RC074-TOTAL-ACTL-ITM-QTY        37950000
379600                                         TO LQW-ACT-QTY (LQW-IDX) 37960000
379700                             SUBTRACT  LQW-VFY-QTY  (LQW-IDX)     37970000
379800                                             FROM ASC-TOT-VFY-QTY 37980000
379900                             ADD RC074-VERIFY-ITM-QTY             37990000
380000                                               TO ASC-TOT-VFY-QTY 38000000
380100                             MOVE RC074-VERIFY-ITM-QTY            38010000
380200                                         TO LQW-VFY-QTY (LQW-IDX) 38020000
380300                         ELSE                                     38030000
380400                             PERFORM 4320-SUM-TRECDIS             38040000
380500                             MOVE RECDIS-VERIFY-ITM-QTY           38050000
380600                                         TO LQW-ACT-QTY (LQW-IDX) 38060000
380700                             SUBTRACT  LQW-VFY-QTY  (LQW-IDX)     38070000
380800                                             FROM ASC-TOT-VFY-QTY 38080000
380900                             ADD RECDIS-AP-VERIFY-ITM-QTY         38090000
381000                                               TO ASC-TOT-VFY-QTY 38100000
381100                             MOVE RECDIS-AP-VERIFY-ITM-QTY        38110000
381200                                         TO LQW-VFY-QTY (LQW-IDX) 38120000
381300                         END-IF                                   38130000
381400                         SET LQW-UPDATE (LQW-IDX)   TO  TRUE      38140000
381500                         SET LQW-DESELECT (LQW-IDX) TO  TRUE      38150000
381600                         MOVE SPACE  TO                           38160000
381700                                    LQW-TEMP-SELECTED-SW (LQW-IDX)38170000
381800                         SUBTRACT 1 FROM                          38180000
381900                                     ASC-NUMBER-OF-SELECTED-ITEMS 38190000
382000                     END-IF                                       38200000
382100                 END-IF                                           38210000
382200             END-IF                                               38220000
382300         END-PERFORM                                              38230000
382400     END-IF.                                                      38240000
382500                                                                  38250000
382600     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                38260000
382700     PERFORM 6111-WRITE-LIST-QUEUE.                               38270000
382800                                                                  38280000
382900 5410-PROCESS-TRECDIS-UNVERIFY.                                   38290000
383000                                                                  38300000
383100     PERFORM 6112-READ-LIST-QUEUE.                                38310000
383200                                                                  38320000
383300                                                                  38330000
383400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38340000
383500         PERFORM                                                  38350000
383600         VARYING LQW-IDX                                          38360000
383700         FROM 1 BY 1                                              38370000
383800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38380000
383900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          38390000
384000                                                                  38400000
384100             IF  LQW-SELECT (LQW-IDX)                             38410000
384200                 MOVE LQW-PO-LNE-NBR(LQW-IDX)                     38420000
384300                                 TO  RECDIS-ORD-LNE-NBR           38430000
384400                 MOVE RECITM-PREPK-ID                             38440000
384500                                 TO  TRBNTF-PREPK-ID              38450000
384600                 PERFORM 5450-COUNT-TRECDIS-ROWS                  38460000
384700                 INITIALIZE RC038-FIELDS                          38470000
384800                 SET RC038-UNVERIFY TO TRUE                       38480000
384900                 PERFORM 7000-CALL-VEM-MODULE                     38490000
385000                 IF  RC038-RECV-TROUBLE                           38500000
385100*    ALLOW THE UNVERIFY TO PROCEED IF THE THE ONLY TROUBLE        38510000
385200*    WAS CAUSED BY A PRIOR UNVERIFY ON THE RECEIVER               38520000
385300                     PERFORM 5410A-TRBL-EXCEPTIONS                38530000
385400                     IF PV-DB2-TROUBLE-COUNT > ZERO               38540000
385500                         MOVE SPACE TO RC038-NO-VERIFY-REASON     38550000
385600                     END-IF                                       38560000
385700                 END-IF                                           38570000
385800                 IF (PV-DB2-COUNT EQUAL ZERO                      38580000
385900                 OR  RC038-RECV-TROUBLE                           38590000
386000                 OR  RC038-LINE-TROUBLE)                          38600000
386100                     SET LQW-ERROR (LQW-IDX)                      38610000
386200                         PS-ERROR                                 38620000
386300                                 TO  TRUE                         38630000
386400*                    MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" I38640000
386500*                         'NDICATES NO RECDIS OR IN TROUBLE'      38650000
386600*                                TO  DP020-MSG-MESSAGE            38660000
386700                     MOVE PC-TSYMSG-03290 TO DP020-MSG-NUMBER     38670000
386800                     SET DP020-MSG-WARNING TO TRUE                38680000
386900                 ELSE                                             38690000
387000                     MOVE 'CM'   TO  PV-STATUS-CDE                38700000
387100                     PERFORM 5411-CHECK-SOURCE                    38710000
387200                     PERFORM 5510-UPDATE-TRECDIS-UNVERIFY         38720000
387300                     SET PS-PO-UNVERIFY TO TRUE                   38730000
387400                     PERFORM 5600-UPDATE-TRECITM                  38740000
387500                     PERFORM 9000-CALL-PO-RCVR-TRKING-MOD         38750000
387600                     IF PS-NO-ERROR                               38760000
387700                         PERFORM 5805-CHECK-POLINE-FOR-UPDATE     38770000
387800                         MOVE 'IP'   TO  LQW-STATUS-CDE (LQW-IDX) 38780000
387900                         IF ASC-AUTO-VE-YES                       38790000
388000                             INITIALIZE RC074-FIELDS              38800000
388100                             MOVE LQW-PO-LNE-NBR(LQW-IDX)         38810000
388200                                              TO RC074-LINE-NBR   38820000
388300                             PERFORM 4350-CALL-RCKUT128           38830000
388400                             MOVE RC074-TOTAL-ACTL-ITM-QTY        38840000
388500                                         TO LQW-ACT-QTY (LQW-IDX) 38850000
388600                             SUBTRACT  LQW-VFY-QTY  (LQW-IDX)     38860000
388700                                             FROM ASC-TOT-VFY-QTY 38870000
388800                             ADD RC074-VERIFY-ITM-QTY             38880000
388900                                               TO ASC-TOT-VFY-QTY 38890000
389000                             MOVE RC074-VERIFY-ITM-QTY            38900000
389100                                         TO LQW-VFY-QTY (LQW-IDX) 38910000
389200                         ELSE                                     38920000
389300                             PERFORM 4320-SUM-TRECDIS             38930000
389400                             MOVE RECDIS-VERIFY-ITM-QTY           38940000
389500                                         TO LQW-ACT-QTY (LQW-IDX) 38950000
389600                             SUBTRACT  LQW-VFY-QTY  (LQW-IDX)     38960000
389700                                             FROM ASC-TOT-VFY-QTY 38970000
389800                             ADD RECDIS-AP-VERIFY-ITM-QTY         38980000
389900                                              TO  ASC-TOT-VFY-QTY 38990000
390000                             MOVE RECDIS-AP-VERIFY-ITM-QTY        39000000
390100                                         TO LQW-VFY-QTY (LQW-IDX) 39010000
390200                         END-IF                                   39020000
390300                         SET LQW-UPDATE (LQW-IDX)   TO  TRUE      39030000
390400                         SET LQW-DESELECT (LQW-IDX) TO  TRUE      39040000
390500                         MOVE SPACE  TO                           39050000
390600                                    LQW-TEMP-SELECTED-SW (LQW-IDX)39060000
390700                         SUBTRACT 1 FROM                          39070000
390800                                     ASC-NUMBER-OF-SELECTED-ITEMS 39080000
390900                     END-IF                                       39090000
391000                 END-IF                                           39100000
391100             END-IF                                               39110000
391200         END-PERFORM                                              39120000
391300     END-IF.                                                      39130000
391400                                                                  39140000
391500     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                39150000
391600     PERFORM 6111-WRITE-LIST-QUEUE.                               39160000
391700                                                                  39170000
391800 5410A-TRBL-EXCEPTIONS.                                           39180000
391900     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        39190000
392000     PERFORM 5475A-CHECK-FOR-375-TROUBLE.                         39200000
392100                                                                  39210000
392200 5411-CHECK-SOURCE.                                               39220000
392300     MOVE LQW-PO-LNE-NBR (LQW-IDX)                                39230000
392400     TO PV-HOLD-LNE-NBR.                                          39240000
392500     PERFORM 5460-SELECT-TDISTHD.                                 39250000
392600     IF PS-NO-TDISTHD-FOUND                                       39260000
392700        MOVE PC-MANUAL TO LQW-VFY-SRC (LQW-IDX)                   39270000
392800     ELSE                                                         39280000
392900        IF DISTHD-TOT-CART-CNT = 0                                39290000
393000          MOVE PC-MANUAL TO LQW-VFY-SRC (LQW-IDX)                 39300000
393100        ELSE                                                      39310000
393200          IF (DISTHD-P2L-CART-CNT = 0                             39320000
393300             AND (DISTHD-FCSE-CART-CNT > 0                        39330000
393400             OR DISTHD-INPK-CART-CNT > 0))                        39340000
393500             MOVE PC-CASE TO LQW-VFY-SRC (LQW-IDX)                39350000
393600          ELSE                                                    39360000
393700             IF (DISTHD-P2L-CART-CNT > 0                          39370000
393800               AND (DISTHD-FCSE-CART-CNT > 0                      39380000
393900                 OR DISTHD-INPK-CART-CNT > 0))                    39390000
394000                 MOVE PC-P2L-CASE TO LQW-VFY-SRC (LQW-IDX)        39400000
394100             ELSE                                                 39410000
394200             IF (DISTHD-P2L-CART-CNT > 0                          39420000
394300                AND (DISTHD-FCSE-CART-CNT = 0                     39430000
394400                AND DISTHD-INPK-CART-CNT = 0))                    39440000
394500                MOVE PC-P2L TO LQW-VFY-SRC (LQW-IDX)              39450000
394600             ELSE                                                 39460000
394700                   MOVE PC-MANUAL TO LQW-VFY-SRC (LQW-IDX)        39470000
394800             END-IF                                               39480000
394900          END-IF                                                  39490000
395000        END-IF                                                    39500000
395100       END-IF                                                     39510000
395200     END-IF.                                                      39520000
395300 5415-CHECK-ERRORS.                                               39530000
395400                                                                  39540000
395500     IF PV-DB2-COUNT EQUAL ZERO                                   39550000
395600         SET LQW-ERROR (LQW-IDX)                                  39560000
395700             PS-ERROR  TO TRUE                                    39570000
395800*            MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" INDICATES39580000
395900*                 ' NO RECDIS '                                   39590000
396000*                                TO  DP020-MSG-MESSAGE            39600000
396100                     MOVE PC-TSYMSG-03291 TO DP020-MSG-NUMBER     39610000
396200                     SET DP020-MSG-WARNING TO TRUE                39620000
396300     ELSE                                                         39630000
396400        IF RC038-LINE-TROUBLE                                     39640000
396500            SET LQW-ERROR (LQW-IDX)                               39650000
396600                PS-ERROR  TO TRUE                                 39660000
396700*           MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" INDICATES 39670000
396800*                'LINE IN TROUBLE     '                           39680000
396900*                          TO  DP020-MSG-MESSAGE                  39690000
397000                     MOVE PC-TSYMSG-03292 TO DP020-MSG-NUMBER     39700000
397100                     SET DP020-MSG-WARNING TO TRUE                39710000
397200        ELSE                                                      39720000
397300           IF RC038-RECV-TROUBLE                                  39730000
397400               SET LQW-ERROR (LQW-IDX)                            39740000
397500                   PS-ERROR  TO TRUE                              39750000
397600*              MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "ERR" INDICAT39760000
397700*                   'ES RECEIVER IN TROUBLE '                     39770000
397800*                          TO  DP020-MSG-MESSAGE                  39780000
397900                     MOVE PC-TSYMSG-03293 TO DP020-MSG-NUMBER     39790000
398000                     SET DP020-MSG-WARNING TO TRUE                39800000
398100           ELSE                                                   39810000
398200              IF RC038-STORE-INVENTORY                            39820000
398300                  SET LQW-INVENTORY (LQW-IDX)                     39830000
398400                      PS-ERROR   TO TRUE                          39840000
398500*                 MOVE 'NNNNN-E-NOT ALL LINES VERIFIED! "INV" INDI39850000
398600*                      'CATES STORES IN INV FLUSH PROCESS '       39860000
398700*                            TO  DP020-MSG-MESSAGE                39870000
398800                     MOVE PC-TSYMSG-03294 TO DP020-MSG-NUMBER     39880000
398900                     SET DP020-MSG-WARNING TO TRUE                39890000
399000              ELSE                                                39900000
399100                  IF RC038-VERIFY-NO                              39910000
399200**  IF DIRECT STR RCPT THEN ITS OK THAT THERE IS NO PRO OR NOT AR 39920000
399300                     IF ASC-NOT-DC-STORE-TYPE                     39930000
399400                        IF RC038-NO-PRO OR RC038-NOT-ARRIVED      39940000
399500                           CONTINUE                               39950000
399600                        ELSE                                      39960000
399700                           SET LQW-ERROR (LQW-IDX)                39970000
399800                               PS-ERROR   TO TRUE                 39980000
399900                           MOVE PC-TSYMSG-03295                   39990000
400000                                         TO DP020-MSG-NUMBER      40000000
400100                           SET DP020-MSG-WARNING TO TRUE          40010000
400200                           MOVE RC038-PO-NBR   TO PV-DISPLAY-PO   40020000
400300                           MOVE RC038-REC-SEQ-NBR                 40030000
400400                                        TO PV-DISPLAY-REC-SEQ-NBR 40040000
400500                           MOVE RC038-PO-LNE-NBR                  40050000
400600                                       TO PV-DISPLAY-PO-LNE-NBR   40060000
400700                           STRING ' RCKCS220 - '                  40070000
400800                                  ' 5415-CHECK-ERRORS '           40080000
400900                                  ' PO '                          40090000
401000                                  PV-DISPLAY-PO                   40100000
401100                                  ' PO '                          40110000
401200                                  PV-DISPLAY-REC-SEQ-NBR          40120000
401300                                  ' PO '                          40130000
401400                                  PV-DISPLAY-PO-LNE-NBR           40140000
401500                                  ' RSN CDE '                     40150000
401600                                  RC038-NO-VERIFY-REASON          40160000
401700                                               DELIMITED BY SIZE  40170000
401800                                          INTO PV-CICS-MSG-AREA   40180000
401900                           PERFORM 9200-WRITE-TO-CICS-LOG         40190000
402000                        END-IF                                    40200000
402100                     ELSE                                         40210000
402200                        SET LQW-ERROR (LQW-IDX)                   40220000
402300                            PS-ERROR   TO TRUE                    40230000
402400                        MOVE PC-TSYMSG-03295                      40240000
402500                                        TO DP020-MSG-NUMBER       40250000
402600                        SET DP020-MSG-WARNING TO TRUE             40260000
402700                        MOVE RC038-PO-NBR   TO PV-DISPLAY-PO      40270000
402800                        MOVE RC038-REC-SEQ-NBR                    40280000
402900                                     TO PV-DISPLAY-REC-SEQ-NBR    40290000
403000                        MOVE RC038-PO-LNE-NBR                     40300000
403100                                    TO PV-DISPLAY-PO-LNE-NBR      40310000
403200                        STRING ' RCKCS220 - '                     40320000
403300                               ' 5415-CHECK-ERRORS '              40330000
403400                               ' PO '                             40340000
403500                               PV-DISPLAY-PO                      40350000
403600                               ' PO '                             40360000
403700                               PV-DISPLAY-REC-SEQ-NBR             40370000
403800                               ' PO '                             40380000
403900                               PV-DISPLAY-PO-LNE-NBR              40390000
404000                               ' RSN CDE '                        40400000
404100                               RC038-NO-VERIFY-REASON             40410000
404200                                            DELIMITED BY SIZE     40420000
404300                                       INTO PV-CICS-MSG-AREA      40430000
404400                        PERFORM 9200-WRITE-TO-CICS-LOG            40440000
404500                     END-IF                                       40450000
404600                  END-IF                                          40460000
404700              END-IF                                              40470000
404800           END-IF                                                 40480000
404900        END-IF                                                    40490000
405000     END-IF.                                                      40500000
405100/                                                                 40510000
405200 5450-COUNT-TRECDIS-ROWS.                                         40520000
405300                                                                  40530000
405400     MOVE ZERO            TO  PV-DB2-COUNT.                       40540000
405500     EXEC SQL                                                     40550000
405600          SELECT                                                  40560000
405700                COUNT(*)                                          40570000
405800          INTO                                                    40580000
405900                :PV-DB2-COUNT :PV-NULL-IND                        40590000
406000          FROM                                                    40600000
406100                TRECDIS                                           40610000
406200          WHERE                                                   40620000
406300                ORD_NBR          =  :ASC-PO-NBR                   40630000
406400          AND   ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR           40640000
406500          AND   REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR              40650000
406600          AND   OPER_UNT_ID      =  :ASC-OPER-UNT-ID              40660000
406700          AND   FCLTY_ID         =  :ASC-FCLTY-ID                 40670000
406900     END-EXEC.                                                    40690000
407000                                                                  40700000
407100     EVALUATE TRUE                                                40710000
407200         WHEN SQLCODE = ZERO                                      40720000
407300         WHEN SQLCODE = +100                                      40730000
407400              CONTINUE                                            40740000
407500         WHEN SQLCODE = -904                                      40750000
407600         WHEN SQLCODE = -911                                      40760000
407700         WHEN SQLCODE = -913                                      40770000
407800             PERFORM 9900-SOFT-ABORT                              40780000
407900         WHEN SQLWARN0 NOT = SPACE                                40790000
408000         WHEN SQLCODE NOT = ZERO                                  40800000
408100              MOVE '5450-COUNT-TRECDIS-ROWS'                      40810000
408200                               TO DP013-PARAGRAPH                 40820000
408300              MOVE 'CHECK IF ANY RECDIS ROWS EXIST'               40830000
408400                               TO DP013-MESSAGE-TEXT (1)          40840000
408500              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        40850000
408600              MOVE SQLCA       TO DP013-SQLCA                     40860000
408700              SET DP013-DB2-ABEND                                 40870000
408800                               TO TRUE                            40880000
408900              PERFORM DP013-0000-PROCESS-ABEND                    40890000
409000     END-EVALUATE.                                                40900000
409100/                                                                 40910000
409200 5460-SELECT-TDISTHD.                                             40920000
409300                                                                  40930000
409400                                                                  40940000
409500     EXEC SQL                                                     40950000
409600          SELECT                                                  40960000
409700                TOT_CART_CNT,                                     40970000
409800                FCSE_CART_CNT,                                    40980000
409900                P2L_CART_CNT,                                     40990000
410000                INPK_CART_CNT,                                    41000000
410100                VRFD_TMST                                         41010000
410200          INTO                                                    41020000
410300                :DISTHD-TOT-CART-CNT,                             41030000
410400                :DISTHD-FCSE-CART-CNT,                            41040000
410500                :DISTHD-P2L-CART-CNT,                             41050000
410600                :DISTHD-INPK-CART-CNT,                            41060000
410700                :DISTHD-VRFD-TMST                                 41070000
410800          FROM                                                    41080000
410900                TDISTHD                                           41090000
411000          WHERE                                                   41100000
411100                ORD_NBR          =  :ASC-PO-NBR                   41110000
411200          AND   ORD_LNE_NBR      =  :PV-HOLD-LNE-NBR              41120000
411300          AND   RCVR_SEQ_NBR     =  :ASC-REC-SEQ-NBR              41130000
411400     END-EXEC.                                                    41140000
411500                                                                  41150000
411600     EVALUATE TRUE                                                41160000
411700         WHEN SQLCODE = ZERO                                      41170000
411800              SET PS-TDISTHD-FOUND TO TRUE                        41180000
411900         WHEN SQLCODE = +100                                      41190000
412000              SET PS-NO-TDISTHD-FOUND TO TRUE                     41200000
412100         WHEN SQLCODE = -904                                      41210000
412200         WHEN SQLCODE = -911                                      41220000
412300         WHEN SQLCODE = -913                                      41230000
412400             PERFORM 9900-SOFT-ABORT                              41240000
412500         WHEN SQLWARN0 NOT = SPACE                                41250000
412600         WHEN SQLCODE NOT = ZERO                                  41260000
412700              MOVE '5460-SELECT-TDISTHD'                          41270000
412800                               TO DP013-PARAGRAPH                 41280000
412900              MOVE 'GET TDISTHD ROW'                              41290000
413000                               TO DP013-MESSAGE-TEXT (1)          41300000
413100              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        41310000
413200              MOVE SQLCA       TO DP013-SQLCA                     41320000
413300              SET DP013-DB2-ABEND                                 41330000
413400                               TO TRUE                            41340000
413500              PERFORM DP013-0000-PROCESS-ABEND                    41350000
413600     END-EVALUATE.                                                41360000
413700/                                                                 41370000
413800 5475-CHECK-FOR-TROUBLE.                                          41380000
413900                                                                  41390000
414000     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        41400000
414100     EXEC SQL                                                     41410000
414200          SELECT COUNT(*)                                         41420000
414300          INTO  :PV-DB2-TROUBLE-COUNT :PV-NULL-IND                41430000
414400          FROM   TTRBNTF A                                        41440000
414500                ,TTRBRSN B                                        41450000
414600          WHERE  A.PO_NBR           =  :ASC-PO-NBR                41460000
414700          AND  ((A.PO_LNE_NBR       =  :RECDIS-ORD-LNE-NBR        41470000
414800          AND    B.TRBL_LVL_IND     <> 'M')                       41480000
414900           OR   (A.PREPK_ID         =  :TRBNTF-PREPK-ID           41490000
415000          AND    B.TRBL_LVL_IND     =  'M'))                      41500000
415100          AND    A.REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR           41510000
415200          AND    A.OPER_UNT_ID      =  :ASC-OPER-UNT-ID           41520000
415300          AND    A.FCLTY_ID         =  :ASC-FCLTY-ID              41530000
415400          AND    A.RESOLVED_IND    IN  ('N','I','R')              41540000
415500          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             41550000
415600          AND    B.NOTIF_IND        =  'T'                        41560000
415700     END-EXEC.                                                    41570000
415800                                                                  41580000
415900     EVALUATE TRUE                                                41590000
416000         WHEN SQLCODE = ZERO                                      41600000
416100         WHEN SQLCODE = +100                                      41610000
416200              CONTINUE                                            41620000
416300         WHEN SQLCODE = -904                                      41630000
416400         WHEN SQLCODE = -911                                      41640000
416500         WHEN SQLCODE = -913                                      41650000
416600              PERFORM 9900-SOFT-ABORT                             41660000
416700         WHEN SQLWARN0 NOT = SPACE                                41670000
416800         WHEN SQLCODE NOT = ZERO                                  41680000
416900              MOVE '5475-CHECK-FOR-TROUBLE'                       41690000
417000                                    TO DP013-PARAGRAPH            41700000
417100              MOVE 'SELECT RESOLVE IND FROM TROUBLE TABLE'        41710000
417200                                    TO DP013-MESSAGE-TEXT (1)     41720000
417300              MOVE SQLCA       TO DP013-SQLCA                     41730000
417400              SET DP013-DB2-ABEND                                 41740000
417500                               TO TRUE                            41750000
417600              PERFORM DP013-0000-PROCESS-ABEND                    41760000
417700     END-EVALUATE.                                                41770000
417800                                                                  41780000
417900     IF  PV-DB2-TROUBLE-COUNT EQUAL ZERO                          41790000
418000         SET PS-NOT-IN-TROUBLE TO  TRUE                           41800000
418100     ELSE                                                         41810000
418200         SET PS-IN-TROUBLE     TO  TRUE                           41820000
418300     END-IF.                                                      41830000
418400/                                                                 41840000
418500 5475A-CHECK-FOR-375-TROUBLE.                                     41850000
418600                                                                  41860000
418700     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        41870000
418800     EXEC SQL                                                     41880000
418900          SELECT COUNT(*)                                         41890000
419000          INTO  :PV-DB2-TROUBLE-COUNT :PV-NULL-IND                41900000
419100          FROM   TTRBNTF A                                        41910000
419200                ,TTRBRSN B                                        41920000
419300         WHERE  A.PO_NBR           =  :ASC-PO-NBR                 41930000
419400          AND    A.REC_SEQ_NBR      = :ASC-REC-SEQ-NBR            41940000
419500          AND    A.PO_LNE_NBR       =  0                          41950000
419600          AND    A.PREPK_ID         =  0                          41960000
419700          AND    A.RESOLVED_IND    IN  ('N', 'I', 'R')            41970000
419800          AND    A.TRBL_RSN_CDE     =  375                        41980000
419900          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             41990000
420000          AND    B.NOTIF_IND        =  'T'                        42000000
420100         FETCH FIRST 1 ROWS ONLY                                  42010000
420200     END-EXEC.                                                    42020000
420300                                                                  42030000
420400     EVALUATE TRUE                                                42040000
420500         WHEN SQLCODE = ZERO                                      42050000
420600         WHEN SQLCODE = +100                                      42060000
420700              CONTINUE                                            42070000
420800         WHEN SQLCODE = -904                                      42080000
420900         WHEN SQLCODE = -911                                      42090000
421000         WHEN SQLCODE = -913                                      42100000
421100              PERFORM 9900-SOFT-ABORT                             42110000
421200         WHEN SQLWARN0 NOT = SPACE                                42120000
421300         WHEN SQLCODE NOT = ZERO                                  42130000
421400              MOVE '5475A-CHECK-FOR-375-TROUBLE'                  42140000
421500                                    TO DP013-PARAGRAPH            42150000
421600              MOVE 'SELECT RESOLVE IND FROM TROUBLE TABLE'        42160000
421700                                    TO DP013-MESSAGE-TEXT (1)     42170000
421800              MOVE SQLCA       TO DP013-SQLCA                     42180000
421900              SET DP013-DB2-ABEND                                 42190000
422000                               TO TRUE                            42200000
422100              PERFORM DP013-0000-PROCESS-ABEND                    42210000
422200     END-EVALUATE.                                                42220000
422300/                                                                 42230000
422400                                                                  42240000
422500 5500-UPDATE-TRECDIS-VERIFY.                                      42250000
422600                                                                  42260000
422700     PERFORM 5610-SELECT-TRECITM.                                 42270000
422800                                                                  42280000
422900     IF (DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)  OR                42290000
423000         ASC-CONFIRM-ZERO)                                        42300000
423100         PERFORM 5535-UPDATE-TRECDIS-ZERO                         42310000
423200         IF ASC-AUTO-VE-YES                                       42320000
423300             PERFORM 5573-CREATE-376-TROUBLE                      42330000
423400         END-IF                                                   42340000
423500     ELSE                                                         42350000
423600         IF ASC-AUTO-VE-YES                                       42360000
423700             PERFORM 5900-PROCESS-TRECDIS                         42370000
423800             PERFORM 5573-CREATE-376-TROUBLE                      42380000
423900         ELSE                                                     42390000
424000             PERFORM 5530-UPDATE-TRECDIS                          42400000
424100         END-IF                                                   42410000
424200     END-IF.                                                      42420000
424300/                                                                 42430000
424400 5510-UPDATE-TRECDIS-UNVERIFY.                                    42440000
424500                                                                  42450000
424600     PERFORM 5610-SELECT-TRECITM.                                 42460000
424700                                                                  42470000
424800     PERFORM 5540-UPDATE-TRECDIS-UNVERIFY.                        42480000
424900     IF ASC-AUTO-VE-YES                                           42490000
425000        IF  ASC-PACK-BY-STORE  AND                                42500000
425100            ASC-PBS-UNVERIFIED-YES                                42510000
425200            CONTINUE                                              42520000
425300        ELSE                                                      42530000
425400            PERFORM 5560-UPDATE-DISTHD                            42540000
425500            PERFORM 5570-CREATE-375-TROUBLE                       42550000
425600        END-IF                                                    42560000
425700     END-IF.                                                      42570000
425800/                                                                 42580000
425900                                                                  42590000
426000 5530-UPDATE-TRECDIS.                                             42600000
426100     EXEC SQL                                                     42610000
426200          UPDATE TRECDIS                                          42620000
426300          SET    AP_VERIFY_ITM_QTY   =  VERIFY_ITM_QTY            42630000
426400          WHERE                                                   42640000
426500                 ORD_NBR          =  :ASC-PO-NBR                  42650000
426600          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          42660000
426700          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             42670000
426800          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             42680000
426900          AND    FCLTY_ID         =  :ASC-FCLTY-ID                42690000
427100     END-EXEC.                                                    42710000
427200                                                                  42720000
427300     EVALUATE TRUE                                                42730000
427400         WHEN SQLCODE = ZERO                                      42740000
427500              CONTINUE                                            42750000
427600         WHEN SQLCODE = +100                                      42760000
427700              CONTINUE                                            42770000
427800         WHEN SQLCODE = -904                                      42780000
427900         WHEN SQLCODE = -911                                      42790000
428000         WHEN SQLCODE = -913                                      42800000
428100              SET PS-UPDATES-DONE TO TRUE                         42810000
428200              PERFORM 9900-SOFT-ABORT                             42820000
428300         WHEN SQLWARN0 NOT = SPACE                                42830000
428400         WHEN SQLCODE NOT = ZERO                                  42840000
428500              MOVE '5530-UPDATE-TRECDIS'                          42850000
428600                               TO DP013-PARAGRAPH                 42860000
428700              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            42870000
428800                               TO DP013-MESSAGE-TEXT (1)          42880000
428900              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        42890000
429000              MOVE SQLCA       TO DP013-SQLCA                     42900000
429100              SET DP013-DB2-ABEND                                 42910000
429200                               TO TRUE                            42920000
429300              PERFORM DP013-0000-PROCESS-ABEND                    42930000
429400     END-EVALUATE.                                                42940000
429500                                                                  42950000
429600                                                                  42960000
429700 5535-UPDATE-TRECDIS-ZERO.                                        42970000
429800     MOVE  ZEROES  TO  RECDIS-VERIFY-ITM-QTY.                     42980000
429900     MOVE  ZEROES  TO  RECDIS-AP-VERIFY-ITM-QTY.                  42990000
430000     EXEC SQL                                                     43000000
430100          UPDATE TRECDIS                                          43010000
430200          SET    AP_VERIFY_ITM_QTY = :RECDIS-AP-VERIFY-ITM-QTY    43020000
430300                ,VERIFY_ITM_QTY    = :RECDIS-VERIFY-ITM-QTY       43030000
430400          WHERE                                                   43040000
430500                 ORD_NBR          =  :ASC-PO-NBR                  43050000
430600          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          43060000
430700          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             43070000
430800          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             43080000
430900          AND    FCLTY_ID         =  :ASC-FCLTY-ID                43090000
431100     END-EXEC.                                                    43110000
431200                                                                  43120000
431300     EVALUATE TRUE                                                43130000
431400         WHEN SQLCODE = ZERO                                      43140000
431500              CONTINUE                                            43150000
431600         WHEN SQLCODE = +100                                      43160000
431700              CONTINUE                                            43170000
431800         WHEN SQLCODE = -904                                      43180000
431900         WHEN SQLCODE = -911                                      43190000
432000         WHEN SQLCODE = -913                                      43200000
432100              SET PS-UPDATES-DONE TO TRUE                         43210000
432200              PERFORM 9900-SOFT-ABORT                             43220000
432300         WHEN SQLWARN0 NOT = SPACE                                43230000
432400         WHEN SQLCODE NOT = ZERO                                  43240000
432500              MOVE '5535-UPDATE-TRECDIS'                          43250000
432600                               TO DP013-PARAGRAPH                 43260000
432700              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            43270000
432800                               TO DP013-MESSAGE-TEXT (1)          43280000
432900              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        43290000
433000              MOVE SQLCA       TO DP013-SQLCA                     43300000
433100              SET DP013-DB2-ABEND                                 43310000
433200                               TO TRUE                            43320000
433300              PERFORM DP013-0000-PROCESS-ABEND                    43330000
433400     END-EVALUATE.                                                43340000
433500                                                                  43350000
433600                                                                  43360000
433700 5540-UPDATE-TRECDIS-UNVERIFY.                                    43370000
433800     EXEC SQL                                                     43380000
433900          UPDATE TRECDIS                                          43390000
434000          SET    AP_VERIFY_ITM_QTY   =  :PC-ZERO                  43400000
434100          WHERE                                                   43410000
434200                 ORD_NBR          =  :ASC-PO-NBR                  43420000
434300          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          43430000
434400          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             43440000
434500          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             43450000
434600          AND    FCLTY_ID         =  :ASC-FCLTY-ID                43460000
434800     END-EXEC.                                                    43480000
434900                                                                  43490000
435000     EVALUATE TRUE                                                43500000
435100         WHEN SQLCODE = ZERO                                      43510000
435200              CONTINUE                                            43520000
435300         WHEN SQLCODE = +100                                      43530000
435400              CONTINUE                                            43540000
435500         WHEN SQLCODE = -904                                      43550000
435600         WHEN SQLCODE = -911                                      43560000
435700         WHEN SQLCODE = -913                                      43570000
435800              SET PS-UPDATES-DONE TO TRUE                         43580000
435900              PERFORM 9900-SOFT-ABORT                             43590000
436000         WHEN SQLWARN0 NOT = SPACE                                43600000
436100         WHEN SQLCODE NOT = ZERO                                  43610000
436200              MOVE '5540-UPDATE-TRECDIS'                          43620000
436300                               TO DP013-PARAGRAPH                 43630000
436400              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            43640000
436500                               TO DP013-MESSAGE-TEXT (1)          43650000
436600              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        43660000
436700              MOVE SQLCA       TO DP013-SQLCA                     43670000
436800              SET DP013-DB2-ABEND                                 43680000
436900                               TO TRUE                            43690000
437000              PERFORM DP013-0000-PROCESS-ABEND                    43700000
437100     END-EVALUATE.                                                43710000
437200                                                                  43720000
437300                                                                  43730000
437400 5550-UPDATE-RECDIS-OTBND.                                        43740000
437500                                                                  43750000
437600     EXEC SQL                                                     43760000
437700          UPDATE TRECDIS                                          43770000
437800          SET    AP_VERIFY_ITM_QTY =  :RC074-TOTAL-ACTL-ITM-QTY   43780000
437900                ,VERIFY_ITM_QTY    =  :RC074-TOTAL-ACTL-ITM-QTY   43790000
438000          WHERE                                                   43800000
438100                 ORD_NBR          =  :RC074-PO-NBR                43810000
438200          AND    ORD_LNE_NBR      =  :RC074-LINE-NBR              43820000
438300          AND    REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR          43830000
438400          AND    OPER_UNT_ID      =  :RC074-OPER-UNT-ID           43840000
438500          AND    FCLTY_ID         =  :RC074-FCLTY-ID              43850000
438600          AND    STR_NBR          =  :RC074-STR-NBR               43860000
438800     END-EXEC.                                                    43880000
438900                                                                  43890000
439000     EVALUATE TRUE                                                43900000
439100         WHEN SQLCODE = ZERO                                      43910000
439200              CONTINUE                                            43920000
439300         WHEN SQLCODE = +100                                      43930000
439400              CONTINUE                                            43940000
439500         WHEN SQLCODE = -904                                      43950000
439600         WHEN SQLCODE = -911                                      43960000
439700         WHEN SQLCODE = -913                                      43970000
439800              SET PS-UPDATES-DONE TO TRUE                         43980000
439900              PERFORM 9900-SOFT-ABORT                             43990000
440000         WHEN SQLWARN0 NOT = SPACE                                44000000
440100         WHEN SQLCODE NOT = ZERO                                  44010000
440200              MOVE '5550-UPDATE-RECDIS-OTBND'                     44020000
440300                               TO DP013-PARAGRAPH                 44030000
440400              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            44040000
440500                               TO DP013-MESSAGE-TEXT (1)          44050000
440600              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        44060000
440700              MOVE SQLCA       TO DP013-SQLCA                     44070000
440800              SET DP013-DB2-ABEND                                 44080000
440900                               TO TRUE                            44090000
441000              PERFORM DP013-0000-PROCESS-ABEND                    44100000
441100     END-EVALUATE.                                                44110000
441200                                                                  44120000
441300 5560-UPDATE-DISTHD.                                              44130000
441400                                                                  44140000
441500     IF  ASC-PACK-BY-STORE                                        44150000
441600         MOVE  ZEROES             TO  DK-LINE-NUMBER              44160000
441700     ELSE                                                         44170000
441800         MOVE RECDIS-ORD-LNE-NBR  TO  DK-LINE-NUMBER              44180000
441900     END-IF.                                                      44190000
442000                                                                  44200000
442100     EXEC SQL                                                     44210000
442200          UPDATE  TDISTHD                                         44220000
442300            SET PRCG_STAT_CDE      = 'R'                          44230000
442400            ,   VRFD_TMST          = :PC-DB2-NINES-DATE           44240000
442500          WHERE ORD_NBR            = :ASC-PO-NBR                  44250000
442600            AND RCVR_SEQ_NBR       = :ASC-REC-SEQ-NBR             44260000
442700            AND ORD_LNE_NBR        = :DK-LINE-NUMBER              44270000
442800     END-EXEC.                                                    44280000
442900                                                                  44290000
443000                                                                  44300000
443100     EVALUATE TRUE                                                44310000
443200         WHEN SQLCODE = ZERO                                      44320000
443300              PERFORM 5563-UPDATE-DISTDT                          44330000
443400              IF  ASC-PACK-BY-STORE                               44340000
443500                  SET  ASC-PBS-UNVERIFIED-YES  TO  TRUE           44350000
443600              END-IF                                              44360000
443700         WHEN SQLCODE = +100                                      44370000
443800              CONTINUE                                            44380000
443900         WHEN SQLCODE = -904                                      44390000
444000         WHEN SQLCODE = -911                                      44400000
444100         WHEN SQLCODE = -913                                      44410000
444200              SET PS-UPDATES-DONE TO TRUE                         44420000
444300              PERFORM 9900-SOFT-ABORT                             44430000
444400         WHEN SQLWARN0 NOT = SPACE                                44440000
444500         WHEN SQLCODE NOT = ZERO                                  44450000
444600              MOVE '5560-UPDATE-DISTHD'                           44460000
444700                               TO DP013-PARAGRAPH                 44470000
444800              MOVE 'UPDATE DISTRIBUTION HEADER TABLE'             44480000
444900                               TO DP013-MESSAGE-TEXT (1)          44490000
445000              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        44500000
445100              MOVE SQLCA       TO DP013-SQLCA                     44510000
445200              SET DP013-DB2-ABEND                                 44520000
445300                               TO TRUE                            44530000
445400              PERFORM DP013-0000-PROCESS-ABEND                    44540000
445500     END-EVALUATE.                                                44550000
445600                                                                  44560000
445700 5561-VERIFY-DISTHD-RCVR.                                         44570000
445800                                                                  44580000
445900     EXEC SQL                                                     44590000
446000         UPDATE  TDISTHD                                          44600000
446100           SET PRCG_STAT_CDE      = 'V'                           44610000
446200           ,   VRFD_TMST          = :PV-RECEIV-CURRENT-TIMESTAMP  44620000
446300      WHERE ORD_NBR           = :ASC-PO-NBR                       44630000
446400        AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR                  44640000
446500        AND VRFD_TMST         = :PC-DB2-NINES-DATE                44650000
446600     END-EXEC.                                                    44660000
446700                                                                  44670000
446800     EVALUATE TRUE                                                44680000
446900         WHEN SQLCODE = ZERO                                      44690000
447000              CONTINUE                                            44700000
447100         WHEN SQLCODE = +100                                      44710000
447200              CONTINUE                                            44720000
447300         WHEN SQLCODE = -904                                      44730000
447400         WHEN SQLCODE = -911                                      44740000
447500         WHEN SQLCODE = -913                                      44750000
447600              SET PS-UPDATES-DONE TO TRUE                         44760000
447700              PERFORM 9900-SOFT-ABORT                             44770000
447800         WHEN SQLWARN0 NOT = SPACE                                44780000
447900         WHEN SQLCODE NOT = ZERO                                  44790000
448000              MOVE '5561-VERIFY-DISTHD-RCVR'                      44800000
448100                               TO DP013-PARAGRAPH                 44810000
448200              MOVE 'UPDATE DISTRIBUTION HEADER TABLE'             44820000
448300                               TO DP013-MESSAGE-TEXT (1)          44830000
448400              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        44840000
448500              MOVE SQLCA       TO DP013-SQLCA                     44850000
448600              SET DP013-DB2-ABEND                                 44860000
448700                               TO TRUE                            44870000
448800              PERFORM DP013-0000-PROCESS-ABEND                    44880000
448900     END-EVALUATE.                                                44890000
449000                                                                  44900000
449100 5562-VERIFY-DISTHD-LINE.                                         44910000
449200                                                                  44920000
449300     EXEC SQL                                                     44930000
449400         UPDATE  TDISTHD                                          44940000
449500           SET PRCG_STAT_CDE      = 'V'                           44950000
449600           ,   VRFD_TMST          = :PV-RECEIV-CURRENT-TIMESTAMP  44960000
449700      WHERE ORD_NBR           = :ASC-PO-NBR                       44970000
449800        AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR                  44980000
449900        AND ORD_LNE_NBR       = :RECDIS-ORD-LNE-NBR               44990000
450000     END-EXEC.                                                    45000000
450100                                                                  45010000
450200     EVALUATE TRUE                                                45020000
450300         WHEN SQLCODE = ZERO                                      45030000
450400              CONTINUE                                            45040000
450500         WHEN SQLCODE = +100                                      45050000
450600              CONTINUE                                            45060000
450700         WHEN SQLCODE = -904                                      45070000
450800         WHEN SQLCODE = -911                                      45080000
450900         WHEN SQLCODE = -913                                      45090000
451000              SET PS-UPDATES-DONE TO TRUE                         45100000
451100              PERFORM 9900-SOFT-ABORT                             45110000
451200         WHEN SQLWARN0 NOT = SPACE                                45120000
451300         WHEN SQLCODE NOT = ZERO                                  45130000
451400              MOVE '5562-VERIFY-DISTHD-LINE'                      45140000
451500                               TO DP013-PARAGRAPH                 45150000
451600              MOVE 'UPDATE DISTRIBUTION HEADER TABLE'             45160000
451700                               TO DP013-MESSAGE-TEXT (1)          45170000
451800              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        45180000
451900              MOVE SQLCA       TO DP013-SQLCA                     45190000
452000              SET DP013-DB2-ABEND                                 45200000
452100                               TO TRUE                            45210000
452200              PERFORM DP013-0000-PROCESS-ABEND                    45220000
452300     END-EVALUATE.                                                45230000
452400/                                                                 45240000
452500 5563-UPDATE-DISTDT.                                              45250000
452600                                                                  45260000
452700     EXEC SQL                                                     45270000
452800         UPDATE  TDISTDT                                          45280000
452900           SET RCVG_PSTD_STAT_CDE = 'N'                           45290000
453000      WHERE ORD_NBR           = :ASC-PO-NBR                       45300000
453100        AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR                  45310000
453200        AND ORD_LNE_NBR       = :RECDIS-ORD-LNE-NBR               45320000
453300     END-EXEC.                                                    45330000
453400                                                                  45340000
453500                                                                  45350000
453600     EVALUATE TRUE                                                45360000
453700         WHEN SQLCODE = ZERO                                      45370000
453800              CONTINUE                                            45380000
453900         WHEN SQLCODE = +100                                      45390000
454000              CONTINUE                                            45400000
454100         WHEN SQLCODE = -904                                      45410000
454200         WHEN SQLCODE = -911                                      45420000
454300         WHEN SQLCODE = -913                                      45430000
454400              SET PS-UPDATES-DONE TO TRUE                         45440000
454500              PERFORM 9900-SOFT-ABORT                             45450000
454600         WHEN SQLWARN0 NOT = SPACE                                45460000
454700         WHEN SQLCODE NOT = ZERO                                  45470000
454800              MOVE '5563-UPDATE-DISTDT'                           45480000
454900                               TO DP013-PARAGRAPH                 45490000
455000              MOVE 'UPDATE DISTRIBUTION DETAIL TABLE'             45500000
455100                               TO DP013-MESSAGE-TEXT (1)          45510000
455200              MOVE 'TDISTDT '  TO DP013-DB2-TABLE-NAME (1)        45520000
455300              MOVE SQLCA       TO DP013-SQLCA                     45530000
455400              SET DP013-DB2-ABEND                                 45540000
455500                               TO TRUE                            45550000
455600              PERFORM DP013-0000-PROCESS-ABEND                    45560000
455700     END-EVALUATE.                                                45570000
455800                                                                  45580000
455900 5570-CREATE-375-TROUBLE.                                         45590000
456000                                                                  45600000
456100     INITIALIZE TM500-FIELDS.                                     45610000
456200     MOVE 375                      TO  TM500-TRBL-RSN-CDE.        45620000
456300     PERFORM 5580-GET-DATE-TIME.                                  45630000
456400     STRING 'MANUALLY UNVERIFIED - '                              45640000
456500            DP020-USERID                                          45650000
456600            ' ON '                                                45660000
456700            PV-CURRENT-DATE                                       45670000
456800            ' '                                                   45680000
456900            PV-CURRENT-TIME       DELIMITED BY SIZE               45690000
457000            INTO TM500-FREEFORM-TEXT.                             45700000
457100     PERFORM 5576-CREATE-TROUBLE.                                 45710000
457200                                                                  45720000
457300 5573-CREATE-376-TROUBLE.                                         45730000
457400                                                                  45740000
457500     INITIALIZE TM500-FIELDS.                                     45750000
457600     MOVE 376                      TO  TM500-TRBL-RSN-CDE.        45760000
457700     PERFORM 5580-GET-DATE-TIME.                                  45770000
457800     STRING 'MANUALLY VERIFIED - '                                45780000
457900            DP020-USERID                                          45790000
458000            ' ON '                                                45800000
458100            PV-CURRENT-DATE                                       45810000
458200            ' '                                                   45820000
458300            PV-CURRENT-TIME       DELIMITED BY SIZE               45830000
458400            INTO TM500-FREEFORM-TEXT.                             45840000
458500     PERFORM 5576-CREATE-TROUBLE.                                 45850000
458600                                                                  45860000
458700 5576-CREATE-TROUBLE.                                             45870000
458800     SET TM500-ADD-DETAILS                                        45880000
458900         TM500-CREATE-MANUAL       TO  TRUE.                      45890000
459000                                                                  45900000
459100     MOVE 0                        TO  TM500-NOTIF-NBR.           45910000
459200     MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         45920000
459300     MOVE 1                        TO  TM500-FCLTY-ID.            45930000
459400                                                                  45940000
459500     MOVE ASC-PO-NBR               TO  TM500-PO-NBR.              45950000
459600                                                                  45960000
459700     SET TM500-PO-LEVEL            TO  TRUE.                      45970000
459800                                                                  45980000
459900     MOVE ASC-REC-SEQ-NBR          TO  TM500-REC-SEQ-NBR.         45990000
460000                                                                  46000000
460100     MOVE DP020-USERID             TO  TM500-CRE-UID              46010000
460200                                       TM500-NOTIF-UID.           46020000
460300                                                                  46030000
460400     PERFORM 5590-LINK-TO-UPDATE.                                 46040000
460500     IF TM500-CALL-SUCCESSFUL                                     46050000
460600      OR TM500-DUPLICATE-TROUBLE                                  46060000
460700             CONTINUE                                             46070000
460800     ELSE                                                         46080000
460900         MOVE '5576-CREATE-TROUBLE'                               46090000
461000                          TO DP013-PARAGRAPH                      46100000
461100         MOVE ASC-PO-NBR          TO PV-DISPLAY-PO                46110000
461200         MOVE ASC-REC-SEQ-NBR     TO PV-DISPLAY-REC-SEQ-NBR       46120000
461300         MOVE RC074-LINE-NBR      TO PV-DISPLAY-PO-LNE-NBR        46130000
461400         STRING   ' RET CODE= '                                   46140000
461500                  TM500-RETURN-CODE                               46150000
461600                  ' PO= '                                         46160000
461700                  PV-DISPLAY-PO                                   46170000
461800                  ' RCV= '                                        46180000
461900                  PV-DISPLAY-REC-SEQ-NBR                          46190000
462000                  ' LNE= '                                        46200000
462100                  PV-DISPLAY-PO-LNE-NBR                           46210000
462200                  DELIMITED BY SIZE                               46220000
462300                        INTO DP013-MESSAGE-TEXT (1)               46230000
462400         PERFORM DP013-0000-PROCESS-ABEND                         46240000
462500     END-IF.                                                      46250000
462600                                                                  46260000
462700 5580-GET-DATE-TIME.                                              46270000
462800                                                                  46280000
462900     EXEC SQL                                                     46290000
463000         SELECT  CURRENT DATE                                     46300000
463100                ,CURRENT TIME                                     46310000
463200           INTO  :PV-CURRENT-DATE                                 46320000
463300                ,:PV-CURRENT-TIME                                 46330000
463400           FROM  SYSIBM.SYSDUMMY1                                 46340000
463500     END-EXEC.                                                    46350000
463600                                                                  46360000
463700                                                                  46370000
463800     EVALUATE TRUE                                                46380000
463900         WHEN SQLCODE = ZERO                                      46390000
464000              CONTINUE                                            46400000
464100         WHEN SQLWARN0 NOT = SPACE                                46410000
464200         WHEN SQLCODE NOT = ZERO                                  46420000
464300              MOVE '5580-GET-DATE-TIME'                           46430000
464400                               TO DP013-PARAGRAPH                 46440000
464500              MOVE 'SELECT DATE AND TIME'                         46450000
464600                               TO DP013-MESSAGE-TEXT (1)          46460000
464700              MOVE 'SYSDUMMY1' TO DP013-DB2-TABLE-NAME (1)        46470000
464800              MOVE SQLCA       TO DP013-SQLCA                     46480000
464900              SET DP013-DB2-ABEND                                 46490000
465000                               TO TRUE                            46500000
465100              PERFORM DP013-0000-PROCESS-ABEND                    46510000
465200     END-EVALUATE.                                                46520000
465300                                                                  46530000
465400                                                                  46540000
465500 5590-LINK-TO-UPDATE.                                             46550000
465600                                                                  46560000
465700     EXEC CICS LINK                                               46570000
465800          PROGRAM (PC-TMKCS520)                                   46580000
465900          COMMAREA(TM500-FIELDS)                                  46590000
466000          RESP    (PV-CICS-RESP)                                  46600000
466100     END-EXEC.                                                    46610000
466200                                                                  46620000
466300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   46630000
466400         MOVE PV-CICS-RESP         TO PV-DISPLAY-CICS-RESP        46640000
466500         MOVE '5590-LINK-TO-UPDATE'                               46650000
466600                          TO DP013-PARAGRAPH                      46660000
466700         STRING   ' CICS RESP='                                   46670000
466800                  PV-DISPLAY-CICS-RESP                            46680000
466900                  DELIMITED BY SIZE                               46690000
467000                        INTO DP013-MESSAGE-TEXT (1)               46700000
467100         SET DP013-DB2-ABEND                                      46710000
467200                          TO TRUE                                 46720000
467300         PERFORM DP013-0000-PROCESS-ABEND                         46730000
467400     END-IF.                                                      46740000
467500                                                                  46750000
467600/                                                                 46760000
467700*----------------------------------------------------------------*46770000
467800*    TO UPDATE A ROW, THE CURRENT ROW MUST BE CHANGED TO         *46780000
467900*    INACTIVE STATUS.  NEXT, A NEW ROW, WITH THE UPDATED         *46790000
468000*    COLUMNS, IS INSERTED WITH AN ACTIVE STATUS.                 *46800000
468100*----------------------------------------------------------------*46810000
468200 5600-UPDATE-TRECITM.                                             46820000
468300                                                                  46830000
468400     SET PS-DATA-OK          TO  TRUE                             46840000
468500                                                                  46850000
468600     IF  PS-DATA-OK                                               46860000
468700         MOVE 'I'                TO RC031-TABLE-TO-AUDIT          46870000
468800         MOVE 'B'                TO RC031-AUD-TYP-CDE             46880000
468900         MOVE 'U'                TO RC031-AUD-FUNC-CDE            46890000
469000         MOVE ASC-OPER-UNT-ID    TO RC031-OPER-UNT-ID             46900000
469100         MOVE ASC-FCLTY-ID       TO RC031-FCLTY-ID                46910000
469200         MOVE ASC-PO-NBR         TO RC031-PO-NBR                  46920000
469300         MOVE ASC-REC-SEQ-NBR    TO RC031-REC-SEQ-NBR             46930000
469400         MOVE RECDIS-ORD-LNE-NBR TO RC031-PO-LNE-NBR              46940000
469500                                                                  46950000
469600     IF (DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)  OR                46960000
469700         ASC-CONFIRM-ZERO)                                        46970000
469800             MOVE PC-VRFY-AT-0-PROG-NAME                          46980000
469900                                 TO RC031-UPD-PGM-ID              46990000
470000         ELSE                                                     47000000
470100             MOVE PC-CURRENT-PROGRAM-NAME                         47010000
470200                                 TO RC031-UPD-PGM-ID              47020000
470300         END-IF                                                   47030000
470400                                                                  47040000
470500         EXEC CICS                                                47050000
470600              LINK PROGRAM  (PC-AUDIT-RTN)                        47060000
470700              COMMAREA (RC031-FIELDS)                             47070000
470800              LENGTH   (PC-AUDIT-RTN-LENGTH)                      47080000
470900         END-EXEC                                                 47090000
471000                                                                  47100000
471100         EVALUATE TRUE                                            47110000
471200             WHEN RC031-CALL-SUCCESSFUL                           47120000
471300                 CONTINUE                                         47130000
471400             WHEN OTHER                                           47140000
471500                 MOVE '5600-UDDATE-TRECITM'                       47150000
471600                                     TO DP013-PARAGRAPH           47160000
471700                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            47170000
471800                                     TO DP013-MESSAGE-TEXT (1)    47180000
471900                 MOVE RC031-RETURN-DESC                           47190000
472000                                     TO DP013-MESSAGE-TEXT (2)    47200000
472100                 MOVE RC031-SQLCA    TO DP013-SQLCA               47210000
472200                 SET DP013-DB2-ABEND                              47220000
472300                     DP013-XCTL-DISPLAY-RESTART                   47230000
472400                                     TO TRUE                      47240000
472500                 PERFORM DP013-0000-PROCESS-ABEND                 47250000
472600         END-EVALUATE                                             47260000
472700     END-IF.                                                      47270000
472800                                                                  47280000
472900     IF  PS-DATA-OK                                               47290000
473000         IF PS-PO-UNVERIFY                                        47300000
473100             MOVE PC-DB2-NINES-DATE TO                            47310000
473200                                       PV-VERIFY-TIMESTAMP        47320000
473300             MOVE 'U'                TO                           47330000
473400                                       PV-RCPT-DISTR-UPD-CDE      47340000
473500             MOVE 'IP'               TO PV-RECITM-STATUS-CDE      47350000
473600             MOVE SPACES             TO PV-VERIFY-USER            47360000
473700             PERFORM 5620-UPDATE-TRECITM                          47370000
473800             MOVE 'X'                TO PC238-TRANS-TYPE-CDE      47380000
473900          ELSE                                                    47390000
474000             MOVE PV-CURRENT-TIMESTAMP TO                         47400000
474100                                       PV-VERIFY-TIMESTAMP        47410000
474200             MOVE RECITM-RCPT-DISTR-UPD-CDE TO                    47420000
474300                                       PV-RCPT-DISTR-UPD-CDE      47430000
474400             MOVE PV-STATUS-CDE      TO PV-RECITM-STATUS-CDE      47440000
474500             MOVE DP020-USERID       TO PV-VERIFY-USER            47450000
474600             PERFORM 5620-UPDATE-TRECITM                          47460000
474700                                                                  47470000
474800             IF ASC-AUTO-VE-YES                                   47480000
474900                 IF ASC-PACK-BY-STORE                             47490000
475000                     CONTINUE                                     47500000
475100                 ELSE                                             47510000
475200                     PERFORM 5562-VERIFY-DISTHD-LINE              47520000
475300                 END-IF                                           47530000
475400             END-IF                                               47540000
475500                                                                  47550000
475600             MOVE 'V'                TO PC238-TRANS-TYPE-CDE      47560000
475700          END-IF                                                  47570000
475800     END-IF.                                                      47580000
475900                                                                  47590000
476000     IF  PS-OPER-UNT-TYPE-SW = SPACES                             47600000
476100         PERFORM 8000-SELECT-TRECEIV                              47610000
476200     END-IF.                                                      47620000
476300     IF  PS-OPER-UNT-IS-DC                                        47630000
476400         IF  ASC-CONFIRM-ZERO                                     47640000
476500             MOVE ZEROES                TO PC238-WRKD-UNT-QTY     47650000
476600         ELSE                                                     47660000
476700             MOVE LQW-ACT-QTY (LQW-IDX) TO PC238-WRKD-UNT-QTY     47670000
476800         END-IF                                                   47680000
476900         PERFORM 8500-UPDATE-UNITS-WRKD                           47690000
477000     ELSE                                                         47700000
477100     IF  PS-OPER-UNT-NOT-DC                                       47710000
477200         MOVE LQW-ACT-QTY (LQW-IDX) TO PC238-WRKD-UNT-QTY         47720000
477300         MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      47730000
477400         PERFORM 8500-UPDATE-UNITS-WRKD                           47740000
477500     END-IF.                                                      47750000
477600/                                                                 47760000
477700*----------------------------------------------------------------*47770000
477800*    GET THE CURRENT ROW FOR PROCESSING.                         *47780000
477900*----------------------------------------------------------------*47790000
478000 5610-SELECT-TRECITM.                                             47800000
478100                                                                  47810000
478200     EXEC SQL                                                     47820000
478300          SELECT                                                  47830000
478400                ORD_NBR                                           47840000
478500              , ORD_LNE_NBR                                       47850000
478600              , REC_SEQ_NBR                                       47860000
478700              , OPER_UNT_ID                                       47870000
478800              , FCLTY_ID                                          47880000
478900              , CRE_TMST                                          47890000
479000              , CRE_UID                                           47900000
479100              , PO_VER_NBR                                        47910000
479200              , ITM_NBR                                           47920000
479300              , PRE_TKT_IND                                       47930000
479400              , TKT_FMT_ID                                        47940000
479500              , RTV_IND                                           47950000
479600              , STATUS_CDE                                        47960000
479700              , VER_STATUS_CDE                                    47970000
479800              , PKSL_ITM_QTY                                      47980000
479900              , DTL_CK_ITM_QTY                                    47990000
480000              , INNR_PACK_QTY                                     48000000
480100              , CASE_PACK_QTY                                     48010000
480200              , RTV_QTY                                           48020000
480300              , EXPTED_CART_CNT                                   48030000
480400              , ACTL_CART_CNT                                     48040000
480500              , MKING_APRON_TMST                                  48050000
480600              , UNT_COST_AMT                                      48060000
480700              , COLOR_DESC                                        48070000
480800              , SIZE_DESC                                         48080000
480900              , VEND_STYL_NAME                                    48090000
481000              , VEND_DESC                                         48100000
481100              , VERFYD_TMST                                       48110000
481200              , PKSL_NBR                                          48120000
481300              , REC_INV_LNE_NBR                                   48130000
481400              , DMG_ITM_QTY                                       48140000
481500              , UPD_TMST                                          48150000
481600              , UPD_UID                                           48160000
481700              , UPD_PGM_ID                                        48170000
481800              , RCPT_DISTR_UPD_CDE                                48180000
481900              , VRFD_USR_ID                                       48190000
482000              , CURRENT TIMESTAMP                                 48200000
482100          INTO                                                    48210000
482200                :RECITM-ORD-NBR                                   48220000
482300              , :RECITM-ORD-LNE-NBR                               48230000
482400              , :RECITM-REC-SEQ-NBR                               48240000
482500              , :RECITM-OPER-UNT-ID                               48250000
482600              , :RECITM-FCLTY-ID                                  48260000
482700              , :RECITM-CRE-TMST                                  48270000
482800              , :RECITM-CRE-UID                                   48280000
482900              , :RECITM-PO-VER-NBR                                48290000
483000              , :RECITM-ITM-NBR                                   48300000
483100              , :RECITM-PRE-TKT-IND                               48310000
483200              , :RECITM-TKT-FMT-ID                                48320000
483300              , :RECITM-RTV-IND                                   48330000
483400              , :RECITM-STATUS-CDE                                48340000
483500              , :RECITM-VER-STATUS-CDE                            48350000
483600              , :RECITM-PKSL-ITM-QTY                              48360000
483700              , :RECITM-DTL-CK-ITM-QTY                            48370000
483800              , :RECITM-INNR-PACK-QTY                             48380000
483900              , :RECITM-CASE-PACK-QTY                             48390000
484000              , :RECITM-RTV-QTY                                   48400000
484100              , :RECITM-EXPTED-CART-CNT                           48410000
484200              , :RECITM-ACTL-CART-CNT                             48420000
484300              , :RECITM-MKING-APRON-TMST                          48430000
484400              , :RECITM-UNT-COST-AMT                              48440000
484500              , :RECITM-COLOR-DESC                                48450000
484600              , :RECITM-SIZE-DESC                                 48460000
484700              , :RECITM-VEND-STYL-NAME                            48470000
484800              , :RECITM-VEND-DESC                                 48480000
484900              , :RECITM-VERFYD-TMST                               48490000
485000              , :RECITM-PKSL-NBR                                  48500000
485100              , :RECITM-REC-INV-LNE-NBR                           48510000
485200              , :RECITM-DMG-ITM-QTY                               48520000
485300              , :RECITM-UPD-TMST                                  48530000
485400              , :RECITM-UPD-UID                                   48540000
485500              , :RECITM-UPD-PGM-ID                                48550000
485600              , :RECITM-RCPT-DISTR-UPD-CDE                        48560000
485700              , :RECITM-VRFD-USR-ID                               48570000
485800              , :PV-CURRENT-TIMESTAMP                             48580000
485900          FROM                                                    48590000
486000                TRECITM                                           48600000
486100          WHERE                                                   48610000
486200                 ORD_NBR          =  :ASC-PO-NBR                  48620000
486300          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          48630000
486400          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             48640000
486500          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             48650000
486600          AND    FCLTY_ID         =  :ASC-FCLTY-ID                48660000
486700          AND    VER_STATUS_CDE   =  'A'                          48670000
486800     END-EXEC.                                                    48680000
486900                                                                  48690000
487000     EVALUATE TRUE                                                48700000
487100         WHEN SQLCODE = ZERO                                      48710000
487200              CONTINUE                                            48720000
487300         WHEN SQLCODE = +100                                      48730000
487400              SET PS-DATA-NOT-OK    TO  TRUE                      48740000
487500         WHEN SQLCODE = -904                                      48750000
487600         WHEN SQLCODE = -911                                      48760000
487700         WHEN SQLCODE = -913                                      48770000
487800              PERFORM 9900-SOFT-ABORT                             48780000
487900         WHEN SQLWARN0 NOT = SPACE                                48790000
488000         WHEN SQLCODE NOT = ZERO                                  48800000
488100              MOVE '5610-SELECT-TRECITM'                          48810000
488200                               TO DP013-PARAGRAPH                 48820000
488300              MOVE 'SELECT TRECITM'                               48830000
488400                               TO DP013-MESSAGE-TEXT (1)          48840000
488500              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        48850000
488600              MOVE SQLCA       TO DP013-SQLCA                     48860000
488700              SET DP013-DB2-ABEND                                 48870000
488800                               TO TRUE                            48880000
488900              PERFORM DP013-0000-PROCESS-ABEND                    48890000
489000     END-EVALUATE.                                                48900000
489100/                                                                 48910000
489200*----------------------------------------------------------------*48920000
489300*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *48930000
489400*----------------------------------------------------------------*48940000
489500                                                                  48950000
489600 5620-UPDATE-TRECITM.                                             48960000
489700                                                                  48970000
489800     EXEC SQL                                                     48980000
489900          UPDATE                                                  48990000
490000                TRECITM                                           49000000
490100          SET   STATUS_CDE        =  :PV-RECITM-STATUS-CDE        49010000
490200               ,VERFYD_TMST       =  :PV-VERIFY-TIMESTAMP         49020000
490300               ,RCPT_DISTR_UPD_CDE =  :PV-RCPT-DISTR-UPD-CDE      49030000
490400               ,VRFD_USR_ID        = :PV-VERIFY-USER              49040000
490500          WHERE                                                   49050000
490600                 ORD_NBR          =  :ASC-PO-NBR                  49060000
490700          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          49070000
490800          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             49080000
490900          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             49090000
491000          AND    FCLTY_ID         =  :ASC-FCLTY-ID                49100000
491100          AND    VER_STATUS_CDE   =  'A'                          49110000
491200     END-EXEC.                                                    49120000
491300                                                                  49130000
491400     EVALUATE TRUE                                                49140000
491500         WHEN SQLCODE = ZERO                                      49150000
491600              CONTINUE                                            49160000
491700         WHEN SQLCODE = -904                                      49170000
491800         WHEN SQLCODE = -911                                      49180000
491900         WHEN SQLCODE = -913                                      49190000
492000              SET PS-UPDATES-DONE TO TRUE                         49200000
492100              PERFORM 9900-SOFT-ABORT                             49210000
492200         WHEN SQLWARN0 NOT = SPACE                                49220000
492300         WHEN SQLCODE NOT = ZERO                                  49230000
492400              MOVE '5620-UPDATE-TRECITM'                          49240000
492500                               TO DP013-PARAGRAPH                 49250000
492600              MOVE 'UPDATE TRECITM STATUS CODE'                   49260000
492700                               TO DP013-MESSAGE-TEXT (1)          49270000
492800              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        49280000
492900              MOVE SQLCA       TO DP013-SQLCA                     49290000
493000              SET DP013-DB2-ABEND                                 49300000
493100                               TO TRUE                            49310000
493200              PERFORM DP013-0000-PROCESS-ABEND                    49320000
493300     END-EVALUATE.                                                49330000
493400/                                                                 49340000
493500*----------------------------------------------------------------*49350000
493600*    FIRST, SEE IF THERE ARE ANY ROWS LEFT THAT ARE NOT          *49360000
493700*    'VE' STATUS CODE.                                           *49370000
493800*    IF THERE ARE NONE, CHECK THE RECEIVER STATUS.  IF IT        *49380000
493900*    IS 'CM', UPDATE IT TO 'VE'.                                 *49390000
494000*----------------------------------------------------------------*49400000
494100                                                                  49410000
494200 5700-COUNT-TRECITM.                                              49420000
494300                                                                  49430000
494400     MOVE 'VE'  TO PV-COUNT-STATUS-CDE.                           49440000
494500     PERFORM 5710-COUNT-TRECITM-ROWS.                             49450000
494600     IF  PV-DB2-COUNT EQUAL ZERO                                  49460000
494700         MOVE PC-ACTUAL TO AVERITO                                49470000
494800         PERFORM 5720-GET-TRECEIV-STATUS                          49480000
494900             IF  RECEIV-STATUS-CDE EQUAL 'CM'                     49490000
495000             OR  RECEIV-STATUS-CDE EQUAL 'IP'                     49500000
495100                 PERFORM 5730-UPDATE-TRECEIV-STATUS               49510000
495200             END-IF                                               49520000
495300     END-IF.                                                      49530000
495400                                                                  49540000
495500                                                                  49550000
495600 5705-COUNT-TRECITM-UNVERIFY.                                     49560000
495700     PERFORM 5720-GET-TRECEIV-STATUS                              49570000
495800     IF RECEIV-STATUS-CDE EQUAL 'VE'                              49580000
495900         MOVE PC-EXPECTED TO AVERITO                              49590000
496000         PERFORM 5735-UPDATE-RECEIV-STATUS-UNV                    49600000
496100     END-IF.                                                      49610000
496200                                                                  49620000
496300 5710-COUNT-TRECITM-ROWS.                                         49630000
496400                                                                  49640000
496500     MOVE ZERO            TO  PV-DB2-COUNT.                       49650000
496600     EXEC SQL                                                     49660000
496700          SELECT                                                  49670000
496800                COUNT(*)                                          49680000
496900          INTO                                                    49690000
497000                :PV-DB2-COUNT :PV-NULL-IND                        49700000
497100          FROM                                                    49710000
497200                TRECITM                                           49720000
497300          WHERE                                                   49730000
497400                ORD_NBR            =  :ASC-PO-NBR                 49740000
497500          AND   STATUS_CDE        ^=  :PV-COUNT-STATUS-CDE        49750000
497600          AND   REC_SEQ_NBR        =  :ASC-REC-SEQ-NBR            49760000
497700          AND   OPER_UNT_ID        =  :ASC-OPER-UNT-ID            49770000
497800          AND   FCLTY_ID           =  :ASC-FCLTY-ID               49780000
497900          AND   VER_STATUS_CDE     =  'A'                         49790000
498000     END-EXEC.                                                    49800000
498100                                                                  49810000
498200     EVALUATE TRUE                                                49820000
498300         WHEN SQLCODE = ZERO                                      49830000
498400         WHEN SQLCODE = +100                                      49840000
498500              CONTINUE                                            49850000
498600         WHEN SQLCODE = -904                                      49860000
498700         WHEN SQLCODE = -911                                      49870000
498800         WHEN SQLCODE = -913                                      49880000
498900              PERFORM 9900-SOFT-ABORT                             49890000
499000         WHEN SQLWARN0 NOT = SPACE                                49900000
499100         WHEN SQLCODE NOT = ZERO                                  49910000
499200              MOVE '5700-COUNT-TRECITM'                           49920000
499300                               TO DP013-PARAGRAPH                 49930000
499400              MOVE 'COUNT NUMBER OF "VE" STATUS RECITM ROWS'      49940000
499500                               TO DP013-MESSAGE-TEXT (1)          49950000
499600              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        49960000
499700              MOVE SQLCA       TO DP013-SQLCA                     49970000
499800              SET DP013-DB2-ABEND                                 49980000
499900                               TO TRUE                            49990000
500000              PERFORM DP013-0000-PROCESS-ABEND                    50000000
500100     END-EVALUATE.                                                50010000
500200/                                                                 50020000
500300 5720-GET-TRECEIV-STATUS.                                         50030000
500400                                                                  50040000
500500     EXEC SQL                                                     50050000
500600          SELECT                                                  50060000
500700             ORD_NBR                                              50070000
500800            ,REC_SEQ_NBR                                          50080000
500900            ,CRE_TMST                                             50090000
501000            ,CRE_UID                                              50100000
501100            ,PO_VER_NBR                                           50110000
501200            ,OPER_UNT_ID                                          50120000
501300            ,FCLTY_ID                                             50130000
501400            ,STATUS_CDE                                           50140000
501500            ,SYST_CRE_CDE                                         50150000
501600            ,REC_TYP_CDE                                          50160000
501700            ,VER_STATUS_CDE                                       50170000
501800            ,PACK_BY_ST_IND                                       50180000
501900            ,REC_TMST                                             50190000
502000            ,EXPTED_CART_CNT                                      50200000
502100            ,ACTL_CART_CNT                                        50210000
502200            ,EXPTED_ITM_QTY                                       50220000
502300            ,ACTL_ITM_QTY                                         50230000
502400            ,RCVR_NBR                                             50240000
502500            ,ML_POST_TMST                                         50250000
502600            ,FS_POST_TMST                                         50260000
502700            ,PRE_TKT_IND                                          50270000
502800            ,AD_INFO_DESC                                         50280000
502900            ,IN_TRBL_TMST                                         50290000
503000            ,IN_TRBL_MIN_CNT                                      50300000
503100            ,IN_TRBL_HOUR_CNT                                     50310000
503200            ,VERFYD_TMST                                          50320000
503300            ,RCVG_CLERK_INIT_ID                                   50330000
503400            ,REFER_BACK_SEQ_NBR                                   50340000
503500            ,AP_PRC_CDE                                           50350000
503600            ,AP_PRC_DTE                                           50360000
503700            ,MIS_DIRECT_IND                                       50370000
503800            ,IMPRT_IND                                            50380000
503900            ,CRE_OPER_UNT_ID                                      50390000
504000            ,CRE_FCLTY_ID                                         50400000
504100            ,CURR_OPER_UNT_ID                                     50410000
504200            ,CURR_FCLTY_ID                                        50420000
504300            ,UPD_TMST                                             50430000
504400            ,UPD_UID                                              50440000
504500            ,UPD_PGM_ID                                           50450000
504600            ,APRON_LOC_DESC                                       50460000
504700            ,MKNG_APRN_PRT_TMST                                   50470000
504800            ,GOH_IND                                              50480000
504900            ,CURRENT TIMESTAMP                                    50490000
505000            ,VRFD_USR_ID                                          50500000
505100        INTO                                                      50510000
505200             :RECEIV-ORD-NBR                                      50520000
505300           , :RECEIV-REC-SEQ-NBR                                  50530000
505400           , :RECEIV-CRE-TMST                                     50540000
505500           , :RECEIV-CRE-UID                                      50550000
505600           , :RECEIV-PO-VER-NBR                                   50560000
505700           , :RECEIV-OPER-UNT-ID                                  50570000
505800           , :RECEIV-FCLTY-ID                                     50580000
505900           , :RECEIV-STATUS-CDE                                   50590000
506000           , :RECEIV-SYST-CRE-CDE                                 50600000
506100           , :RECEIV-REC-TYP-CDE                                  50610000
506200           , :RECEIV-VER-STATUS-CDE                               50620000
506300           , :RECEIV-PACK-BY-ST-IND                               50630000
506400           , :RECEIV-REC-TMST                                     50640000
506500           , :RECEIV-EXPTED-CART-CNT                              50650000
506600           , :RECEIV-ACTL-CART-CNT                                50660000
506700           , :RECEIV-EXPTED-ITM-QTY                               50670000
506800           , :RECEIV-ACTL-ITM-QTY                                 50680000
506900           , :RECEIV-RCVR-NBR                                     50690000
507000           , :RECEIV-ML-POST-TMST                                 50700000
507100           , :RECEIV-FS-POST-TMST                                 50710000
507200           , :RECEIV-PRE-TKT-IND                                  50720000
507300           , :RECEIV-AD-INFO-DESC                                 50730000
507400           , :RECEIV-IN-TRBL-TMST                                 50740000
507500           , :RECEIV-IN-TRBL-MIN-CNT                              50750000
507600           , :RECEIV-IN-TRBL-HOUR-CNT                             50760000
507700           , :RECEIV-VERFYD-TMST                                  50770000
507800           , :RECEIV-RCVG-CLERK-INIT-ID                           50780000
507900           , :RECEIV-REFER-BACK-SEQ-NBR                           50790000
508000           , :RECEIV-AP-PRC-CDE                                   50800000
508100           , :RECEIV-AP-PRC-DTE                                   50810000
508200           , :RECEIV-MIS-DIRECT-IND                               50820000
508300           , :RECEIV-IMPRT-IND                                    50830000
508400           , :RECEIV-CRE-OPER-UNT-ID                              50840000
508500           , :RECEIV-CRE-FCLTY-ID                                 50850000
508600           , :RECEIV-CURR-OPER-UNT-ID                             50860000
508700           , :RECEIV-CURR-FCLTY-ID                                50870000
508800           , :RECEIV-UPD-TMST                                     50880000
508900           , :RECEIV-UPD-UID                                      50890000
509000           , :RECEIV-UPD-PGM-ID                                   50900000
509100           , :RECEIV-APRON-LOC-DESC                               50910000
509200           , :RECEIV-MKNG-APRN-PRT-TMST                           50920000
509300           , :RECEIV-GOH-IND                                      50930000
509400           , :PV-RECEIV-CURRENT-TIMESTAMP                         50940000
509500           , :RECEIV-VRFD-USR-ID                                  50950000
509600          FROM  TRECEIV                                           50960000
509700          WHERE                                                   50970000
509800                 ORD_NBR          =  :ASC-PO-NBR                  50980000
509900          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             50990000
510000          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             51000000
510100          AND    FCLTY_ID         =  :ASC-FCLTY-ID                51010000
510200          AND    VER_STATUS_CDE   =  'A'                          51020000
510300     END-EXEC.                                                    51030000
510400                                                                  51040000
510500     EVALUATE TRUE                                                51050000
510600         WHEN SQLCODE = ZERO                                      51060000
510700              MOVE RECEIV-STATUS-CDE TO ASC-RECEIV-STATUS-CDE     51070000
510800              MOVE RECEIV-REC-TYP-CDE                             51080000
510900                                     TO ASC-REC-TYP-CDE           51090000
511000              IF  ASC-RECEIV-STATUS-VERIFY                        51100000
511100                  MOVE  RECEIV-VERFYD-TMST TO PV-WORK-TIMESTAMP   51110000
511200                  MOVE  PV-WORK-YEAR       TO PV-DISPLAY-YEAR     51120000
511300                  MOVE  PV-WORK-MONTH      TO PV-DISPLAY-MONTH    51130000
511400                  MOVE  PV-WORK-DAY        TO PV-DISPLAY-DAY      51140000
511500                  MOVE  '/'                TO PV-SLASH-1          51150000
511600                  MOVE  '/'                TO PV-SLASH-2          51160000
511700                  MOVE  PV-WORK-HH         TO PV-DISPLAY-HH       51170000
511800                  MOVE  PV-WORK-MIN        TO PV-DISPLAY-MM       51180000
511900                  MOVE  ':'                TO PV-COLON-1          51190000
512000                  MOVE  '('                TO PV-LEFT-PAREN       51200000
512100                  MOVE  PV-DISPLAY-DATE    TO PV-VRFY-DATE        51210000
512200                  MOVE  PV-DISPLAY-TIME    TO PV-VRFY-TIME        51220000
512300                  MOVE  ' - '              TO PV-SEPARATOR        51230000
512400                  MOVE  RECEIV-VRFD-USR-ID TO PV-VRFY-USERID      51240000
512500                  MOVE  ')'                TO PV-RIGHT-PAREN      51250000
512600                  MOVE  PV-RECEIV-VRFY-INFO                       51260000
512700                                           TO ASC-RECEIV-VRFY-INFO51270000
512800              ELSE                                                51280000
512900                  MOVE  SPACES             TO ASC-RECEIV-VRFY-INFO51290000
513000              END-IF                                              51300000
513100         WHEN SQLCODE = +100                                      51310000
513200              SET PS-DATA-NOT-OK    TO  TRUE                      51320000
513300         WHEN SQLCODE = -904                                      51330000
513400         WHEN SQLCODE = -911                                      51340000
513500         WHEN SQLCODE = -913                                      51350000
513600              PERFORM 9900-SOFT-ABORT                             51360000
513700         WHEN SQLWARN0 NOT = SPACE                                51370000
513800         WHEN SQLCODE NOT = ZERO                                  51380000
513900              MOVE '5720-GET-TRECEIV-STATUS'                      51390000
514000                               TO DP013-PARAGRAPH                 51400000
514100              MOVE 'SELECT TRECEIV'                               51410000
514200                               TO DP013-MESSAGE-TEXT (1)          51420000
514300              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        51430000
514400              MOVE SQLCA       TO DP013-SQLCA                     51440000
514500              SET DP013-DB2-ABEND                                 51450000
514600                               TO TRUE                            51460000
514700              PERFORM DP013-0000-PROCESS-ABEND                    51470000
514800     END-EVALUATE.                                                51480000
514900/                                                                 51490000
515000*----------------------------------------------------------------*51500000
515100*    FIRST WE MUST GET THE DATA.                                 *51510000
515200*    NEXT, UPDATE THE CURRENT ROW; MAKE IT INACTIVE.             *51520000
515300*    NOW, INSERT A NEW ROW WITH THE APPROPRIATE CHANGES.         *51530000
515400*----------------------------------------------------------------*51540000
515500                                                                  51550000
515600 5730-UPDATE-TRECEIV-STATUS.                                      51560000
515700                                                                  51570000
515800     IF  PS-DATA-OK                                               51580000
515900         MOVE 'V'                TO RC031-TABLE-TO-AUDIT          51590000
516000         MOVE 'B'                TO RC031-AUD-TYP-CDE             51600000
516100         MOVE 'U'                TO RC031-AUD-FUNC-CDE            51610000
516200         MOVE ASC-OPER-UNT-ID    TO RC031-OPER-UNT-ID             51620000
516300         MOVE ASC-FCLTY-ID       TO RC031-FCLTY-ID                51630000
516400         MOVE ASC-PO-NBR         TO RC031-PO-NBR                  51640000
516500         MOVE ASC-REC-SEQ-NBR    TO RC031-REC-SEQ-NBR             51650000
516600                                                                  51660000
516700         EXEC CICS                                                51670000
516800              LINK PROGRAM  (PC-AUDIT-RTN)                        51680000
516900              COMMAREA (RC031-FIELDS)                             51690000
517000              LENGTH   (PC-AUDIT-RTN-LENGTH)                      51700000
517100         END-EXEC                                                 51710000
517200                                                                  51720000
517300         EVALUATE TRUE                                            51730000
517400             WHEN RC031-CALL-SUCCESSFUL                           51740000
517500                 CONTINUE                                         51750000
517600             WHEN OTHER                                           51760000
517700                 MOVE '5730-UPDATE-TRECEIV-STATUS'                51770000
517800                                     TO DP013-PARAGRAPH           51780000
517900                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            51790000
518000                                     TO DP013-MESSAGE-TEXT (1)    51800000
518100                 MOVE RC031-RETURN-DESC                           51810000
518200                                     TO DP013-MESSAGE-TEXT (2)    51820000
518300                 MOVE RC031-SQLCA    TO DP013-SQLCA               51830000
518400                 SET DP013-DB2-ABEND                              51840000
518500                     DP013-XCTL-DISPLAY-RESTART                   51850000
518600                                     TO TRUE                      51860000
518700                 PERFORM DP013-0000-PROCESS-ABEND                 51870000
518800         END-EVALUATE                                             51880000
518900     END-IF.                                                      51890000
519000                                                                  51900000
519100     IF PS-DATA-OK                                                51910000
519200                                                                  51920000
519300     MOVE 'VE'                TO  ASC-RECEIV-STATUS-CDE           51930000
519400                                  PV-STATUS-CDE                   51940000
519500     MOVE  PV-RECEIV-CURRENT-TIMESTAMP                            51950000
519600                              TO PV-WORK-TIMESTAMP                51960000
519700     MOVE  PV-WORK-YEAR       TO PV-DISPLAY-YEAR                  51970000
519800     MOVE  PV-WORK-MONTH      TO PV-DISPLAY-MONTH                 51980000
519900     MOVE  PV-WORK-DAY        TO PV-DISPLAY-DAY                   51990000
520000     MOVE  '/'                TO PV-SLASH-1                       52000000
520100     MOVE  '/'                TO PV-SLASH-2                       52010000
520200     MOVE  PV-WORK-HH         TO PV-DISPLAY-HH                    52020000
520300     MOVE  PV-WORK-MIN        TO PV-DISPLAY-MM                    52030000
520400     MOVE  ':'                TO PV-COLON-1                       52040000
520500     MOVE  '('                TO PV-LEFT-PAREN                    52050000
520600     MOVE  PV-DISPLAY-DATE    TO PV-VRFY-DATE                     52060000
520700     MOVE  PV-DISPLAY-TIME    TO PV-VRFY-TIME                     52070000
520800     MOVE  ' - '              TO PV-SEPARATOR                     52080000
520900     MOVE  DP020-USERID       TO PV-VRFY-USERID                   52090000
521000     MOVE  ')'                TO PV-RIGHT-PAREN                   52100000
521100     MOVE  PV-RECEIV-VRFY-INFO                                    52110000
521200                              TO ASC-RECEIV-VRFY-INFO.            52120000
521300     IF PS-DATA-OK                                                52130000
521400         PERFORM 5732-UPDATE-TRECEIV                              52140000
521500         IF ASC-AUTO-VE-YES                                       52150000
521600             PERFORM 5760-LINK-TO-FRASTY-HANDLER                  52160000
521700             IF ASC-PACK-BY-STORE                                 52170000
521800                 PERFORM 5561-VERIFY-DISTHD-RCVR                  52180000
521900             END-IF                                               52190000
522000         END-IF                                                   52200000
522100     END-IF.                                                      52210000
522200                                                                  52220000
522300     MOVE SPACES TO PS-OPER-UNT-TYPE-SW.                          52230000
522400     PERFORM 8000-SELECT-TRECEIV                                  52240000
522500     IF  PS-OPER-UNT-IS-DC                                        52250000
522600         MOVE 'W'             TO PC238-TRANS-TYPE-CDE             52260000
522700         MOVE ASC-TOT-ACT-QTY TO PC238-WRKD-UNT-QTY               52270000
522800         PERFORM 8500-UPDATE-UNITS-WRKD                           52280000
522900     END-IF.                                                      52290000
523000                                                                  52300000
523100 5732-UPDATE-TRECEIV.                                             52310000
523200                                                                  52320000
523300     EXEC SQL                                                     52330000
523400          UPDATE                                                  52340000
523500                TRECEIV                                           52350000
523600          SET   STATUS_CDE         =  :PV-STATUS-CDE              52360000
523700               ,VERFYD_TMST        =  :PV-RECEIV-CURRENT-TIMESTAMP52370000
523800               ,VRFD_USR_ID        =  :DP020-USERID               52380000
523900               ,UPD_TMST           =  :PV-RECEIV-CURRENT-TIMESTAMP52390000
524000               ,UPD_UID            =  :DP020-USERID               52400000
524100               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    52410000
524200          WHERE                                                   52420000
524300                 ORD_NBR          =  :ASC-PO-NBR                  52430000
524400          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             52440000
524500          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             52450000
524600          AND    FCLTY_ID         =  :ASC-FCLTY-ID                52460000
524700          AND    VER_STATUS_CDE   =  'A'                          52470000
524800     END-EXEC.                                                    52480000
524900                                                                  52490000
525000     EVALUATE TRUE                                                52500000
525100         WHEN SQLCODE = ZERO                                      52510000
525200              CONTINUE                                            52520000
525300         WHEN SQLCODE = -904                                      52530000
525400         WHEN SQLCODE = -911                                      52540000
525500         WHEN SQLCODE = -913                                      52550000
525600              SET PS-UPDATES-DONE TO TRUE                         52560000
525700              PERFORM 9900-SOFT-ABORT                             52570000
525800         WHEN SQLWARN0 NOT = SPACE                                52580000
525900         WHEN SQLCODE NOT = ZERO                                  52590000
526000              MOVE '5732-UPDATE-TRECEIV'                          52600000
526100                               TO DP013-PARAGRAPH                 52610000
526200              MOVE 'UPDATE TRECEIV STATUS CODE'                   52620000
526300                               TO DP013-MESSAGE-TEXT (1)          52630000
526400              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        52640000
526500              MOVE SQLCA       TO DP013-SQLCA                     52650000
526600              SET DP013-DB2-ABEND                                 52660000
526700                               TO TRUE                            52670000
526800              PERFORM DP013-0000-PROCESS-ABEND                    52680000
526900     END-EVALUATE.                                                52690000
527000                                                                  52700000
527100/                                                                 52710000
527200*----------------------------------------------------------------*52720000
527300*    FIRST WE MUST GET THE DATA.                                 *52730000
527400*    NEXT, UPDATE THE CURRENT ROW; MAKE IT INACTIVE.             *52740000
527500*    NOW, INSERT A NEW ROW WITH THE APPROPRIATE CHANGES.         *52750000
527600*----------------------------------------------------------------*52760000
527700 5735-UPDATE-RECEIV-STATUS-UNV.                                   52770000
527800                                                                  52780000
527900     IF  PS-DATA-OK                                               52790000
528000         MOVE 'V'                TO RC031-TABLE-TO-AUDIT          52800000
528100         MOVE 'B'                TO RC031-AUD-TYP-CDE             52810000
528200         MOVE 'U'                TO RC031-AUD-FUNC-CDE            52820000
528300         MOVE ASC-OPER-UNT-ID    TO RC031-OPER-UNT-ID             52830000
528400         MOVE ASC-FCLTY-ID       TO RC031-FCLTY-ID                52840000
528500         MOVE ASC-PO-NBR         TO RC031-PO-NBR                  52850000
528600         MOVE ASC-REC-SEQ-NBR    TO RC031-REC-SEQ-NBR             52860000
528700                                                                  52870000
528800         EXEC CICS                                                52880000
528900              LINK PROGRAM  (PC-AUDIT-RTN)                        52890000
529000              COMMAREA (RC031-FIELDS)                             52900000
529100              LENGTH   (PC-AUDIT-RTN-LENGTH)                      52910000
529200         END-EXEC                                                 52920000
529300                                                                  52930000
529400         EVALUATE TRUE                                            52940000
529500             WHEN RC031-CALL-SUCCESSFUL                           52950000
529600                 CONTINUE                                         52960000
529700             WHEN OTHER                                           52970000
529800                 MOVE '5735-UDDATE-TRECEIV-STATUS-UNV'            52980000
529900                                     TO DP013-PARAGRAPH           52990000
530000                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            53000000
530100                                     TO DP013-MESSAGE-TEXT (1)    53010000
530200                 MOVE RC031-RETURN-DESC                           53020000
530300                                     TO DP013-MESSAGE-TEXT (2)    53030000
530400                 MOVE RC031-SQLCA    TO DP013-SQLCA               53040000
530500                 SET DP013-DB2-ABEND                              53050000
530600                     DP013-XCTL-DISPLAY-RESTART                   53060000
530700                                     TO TRUE                      53070000
530800                 PERFORM DP013-0000-PROCESS-ABEND                 53080000
530900         END-EVALUATE                                             53090000
531000     END-IF.                                                      53100000
531100     IF PS-DATA-OK                                                53110000
531200                                                                  53120000
531300     MOVE 'CM'                TO  ASC-RECEIV-STATUS-CDE           53130000
531400                                  PV-STATUS-CDE                   53140000
531500     MOVE SPACES              TO  ASC-RECEIV-VRFY-INFO.           53150000
531600     IF PS-DATA-OK                                                53160000
531700         PERFORM 5740-UPDATE-TRECEIV                              53170000
531800     END-IF.                                                      53180000
531900                                                                  53190000
532000     MOVE SPACES TO PS-OPER-UNT-TYPE-SW.                          53200000
532100     PERFORM 8000-SELECT-TRECEIV                                  53210000
532200     IF  PS-OPER-UNT-IS-DC                                        53220000
532300         MOVE 'Y'       TO PC238-TRANS-TYPE-CDE                   53230000
532400         MOVE ZEROES    TO PC238-WRKD-UNT-QTY                     53240000
532500         PERFORM 8500-UPDATE-UNITS-WRKD                           53250000
532600     END-IF.                                                      53260000
532700                                                                  53270000
532800 5740-UPDATE-TRECEIV.                                             53280000
532900                                                                  53290000
533000     EXEC SQL                                                     53300000
533100          UPDATE                                                  53310000
533200                TRECEIV                                           53320000
533300          SET   STATUS_CDE         =  :PV-STATUS-CDE              53330000
533400               ,VERFYD_TMST        =  :PC-FS-TIMESTAMP            53340000
533500               ,UPD_TMST           =  :PV-RECEIV-CURRENT-TIMESTAMP53350000
533600               ,UPD_UID            =  :DP020-USERID               53360000
533700               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    53370000
533800               ,VRFD_USR_ID        =  ' '                         53380000
533900          WHERE                                                   53390000
534000                 ORD_NBR          =  :ASC-PO-NBR                  53400000
534100          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             53410000
534200          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             53420000
534300          AND    FCLTY_ID         =  :ASC-FCLTY-ID                53430000
534400          AND    VER_STATUS_CDE   =  'A'                          53440000
534500     END-EXEC.                                                    53450000
534600                                                                  53460000
534700     EVALUATE TRUE                                                53470000
534800         WHEN SQLCODE = ZERO                                      53480000
534900              CONTINUE                                            53490000
535000         WHEN SQLCODE = -904                                      53500000
535100         WHEN SQLCODE = -911                                      53510000
535200         WHEN SQLCODE = -913                                      53520000
535300              SET PS-UPDATES-DONE TO TRUE                         53530000
535400              PERFORM 9900-SOFT-ABORT                             53540000
535500         WHEN SQLWARN0 NOT = SPACE                                53550000
535600         WHEN SQLCODE NOT = ZERO                                  53560000
535700              MOVE '5740-UPDATE-TRECEIV'                          53570000
535800                               TO DP013-PARAGRAPH                 53580000
535900              MOVE 'UPDATE TRECEIV STATUS CODE'                   53590000
536000                               TO DP013-MESSAGE-TEXT (1)          53600000
536100              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        53610000
536200              MOVE SQLCA       TO DP013-SQLCA                     53620000
536300              SET DP013-DB2-ABEND                                 53630000
536400                               TO TRUE                            53640000
536500              PERFORM DP013-0000-PROCESS-ABEND                    53650000
536600     END-EVALUATE.                                                53660000
536700                                                                  53670000
536800 5760-LINK-TO-FRASTY-HANDLER.                                     53680000
536900                                                                  53690000
537000     INITIALIZE SU044-COMM-AREA.                                  53700000
537100     MOVE ASC-PO-NBR               TO SU044-PO.                   53710000
537200     MOVE ASC-REC-SEQ-NBR          TO SU044-ORIG-REC-SEQ-NBR.     53720000
537300     MOVE ASC-OPER-UNT-ID          TO SU044-OPER-UNT-ID.          53730000
537400     MOVE ASC-FCLTY-ID             TO SU044-FCLTY-ID.             53740000
537500     MOVE PC-CURRENT-PROGRAM-NAME  TO SU044-PROGRAM-NAME.         53750000
537600     SET  SU044-SRC-VERIFICATION   TO TRUE.                       53760000
537700     IF ASC-PACK-BY-STORE                                         53770000
537800        SET SU044-RCVR-PBS         TO TRUE                        53780000
537900     ELSE                                                         53790000
538000        MOVE ZEROES                TO SU044-DEST-STR-NBR          53800000
538100        IF ASC-RECEIV-PKGNG-CDE = 'M' OR 'I'                      53810000
538200           SET SU044-RCVR-PREPK    TO TRUE                        53820000
538300        ELSE                                                      53830000
538400           SET SU044-RCVR-BULK     TO TRUE                        53840000
538500        END-IF                                                    53850000
538600     END-IF                                                       53860000
538700                                                                  53870000
538800     MOVE LENGTH OF SU044-COMM-AREA TO  PV-COMMAREA-LENGTH.       53880000
538900                                                                  53890000
539000     EXEC CICS                                                    53900000
539100         LINK PROGRAM  (PC-FA-HANDLER-PGM)                        53910000
539200              COMMAREA (SU044-COMM-AREA)                          53920000
539300              LENGTH   (PV-COMMAREA-LENGTH)                       53930000
539400     END-EXEC.                                                    53940000
539500                                                                  53950000
539600                                                                  53960000
539700     EVALUATE TRUE                                                53970000
539800         WHEN SU044-SUCCESSFUL                                    53980000
539900              CONTINUE                                            53990000
540000                                                                  54000000
540100         WHEN OTHER                                               54010000
540200             MOVE '5760-LINK-TO-FRASTY-HANDLER'                   54020000
540300                                  TO DP013-PARAGRAPH              54030000
540400             STRING ' SUCCESS IND = '                             54040000
540500                    SU044-SUCCESS-IND                             54050000
540600                         DELIMITED BY SIZE                        54060000
540700                                INTO DP013-MESSAGE-TEXT (1)       54070000
540800             MOVE SQLCA           TO DP013-SQLCA                  54080000
540900             SET DP013-DB2-ABEND                                  54090000
541000                 DP013-XCTL-DISPLAY-RESTART                       54100000
541100                                  TO TRUE                         54110000
541200             PERFORM DP013-0000-PROCESS-ABEND                     54120000
541300     END-EVALUATE.                                                54130000
541400                                                                  54140000
541500*----------------------------------------------------------------*54150000
541600*    SEE IF ALL RECEIVING FOR THIS PO LINE HAS BEEN VERIFIED.    *54160000
541700*    IF SO, SET THE PURCHASE ITEM ROW TO STATUS 'CM'.            *54170000
541800*    FIRST, GET THE PURCHASE ITEM ROW.                           *54180000
541900*    NEXT, GET ALL RECEIPTS.                                     *54190000
542000*----------------------------------------------------------------*54200000
542100                                                                  54210000
542200 5800-CHECK-POLINE-FOR-UPDATE.                                    54220000
542300                                                                  54230000
542400     MOVE ZERO                  TO  PURITM-UNT-QTY.               54240000
542500     PERFORM 5810-GET-PO-UNT-QTY.                                 54250000
542600     IF  PURITM-UNT-QTY GREATER THAN ZERO                         54260000
542700         MOVE ZERO              TO  RECDIS-AP-VERIFY-ITM-QTY      54270000
542800         PERFORM 5820-GET-RECDIS-QTY                              54280000
542900         IF  PURITM-UNT-QTY NOT GREATER RECDIS-AP-VERIFY-ITM-QTY  54290000
543000             PERFORM 5830-UPDATE-PURITM-PROCESS                   54300000
543100***          PERFORM 5851-CHECK-PURCHS-FOR-UPDATE                 54310000
543200     END-IF.                                                      54320000
543300/                                                                 54330000
543400                                                                  54340000
543500*----------------------------------------------------------------*54350000
543600*    SEE IF ALL RECEIVING FOR THIS PO LINE HAS BEEN VERIFIED.    *54360000
543700*    IF THE PURCHASE ITEM ROW IS EQUAL TO 'CM' SET IT TO 'AC'    *54370000
543800*    FOR THE UNVERIFY.                                           *54380000
543900*----------------------------------------------------------------*54390000
544000                                                                  54400000
544100 5805-CHECK-POLINE-FOR-UPDATE.                                    54410000
544200                                                                  54420000
544300     PERFORM 5830-UPDATE-PURITM-PROCESS.                          54430000
544400***  PERFORM 5850-CHECK-PURCHS-FOR-UPDATE.                        54440000
544500/                                                                 54450000
544600 5810-GET-PO-UNT-QTY.                                             54460000
544700                                                                  54470000
544800     EXEC SQL                                                     54480000
544900          SELECT                                                  54490000
545000                 B.UNT_QTY                                        54500000
545100           INTO                                                   54510000
545200                 :PURITM-UNT-QTY                                  54520000
545300           FROM                                                   54530000
545400                 TPURCHS A                                        54540000
545500               , TPURITM B                                        54550000
545600          WHERE                                                   54560000
545700                 A.PO_NBR            =  :ASC-PO-NBR               54570000
545800           AND   A.PO_NBR            =  B.PO_NBR                  54580000
545900           AND   B.APP_PO_LNE_NBR    =  :RECDIS-ORD-LNE-NBR       54590000
546000           AND   A.VER_STATUS_CDE    =  'A'                       54600000
546100           AND   B.VER_STATUS_CDE    =  'A'                       54610000
546200     END-EXEC.                                                    54620000
546300                                                                  54630000
546400     EVALUATE TRUE                                                54640000
546500         WHEN SQLCODE = ZERO                                      54650000
546600         WHEN SQLCODE = +100                                      54660000
546700              CONTINUE                                            54670000
546800         WHEN SQLCODE = -904                                      54680000
546900         WHEN SQLCODE = -911                                      54690000
547000         WHEN SQLCODE = -913                                      54700000
547100              PERFORM 9900-SOFT-ABORT                             54710000
547200         WHEN SQLWARN0 NOT = SPACE                                54720000
547300         WHEN SQLCODE NOT = ZERO                                  54730000
547400              MOVE '5810-GET-PO-UNT-QTY'                          54740000
547500                               TO DP013-PARAGRAPH                 54750000
547600              MOVE 'GET PO LINE UNIT QUANTITY'                    54760000
547700                               TO DP013-MESSAGE-TEXT (1)          54770000
547800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        54780000
547900              MOVE SQLCA       TO DP013-SQLCA                     54790000
548000              SET DP013-DB2-ABEND                                 54800000
548100                               TO TRUE                            54810000
548200              PERFORM DP013-0000-PROCESS-ABEND                    54820000
548300     END-EVALUATE.                                                54830000
548400/                                                                 54840000
548500 5820-GET-RECDIS-QTY.                                             54850000
548600                                                                  54860000
548700     EXEC SQL                                                     54870000
548800          SELECT                                                  54880000
548900                 SUM(C.AP_VERIFY_ITM_QTY)                         54890000
549000           INTO                                                   54900000
549100                 :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND           54910000
549200           FROM                                                   54920000
549300                 TRECEIV A                                        54930000
549400               , TRECITM B                                        54940000
549500               , TRECDIS C                                        54950000
549600           WHERE                                                  54960000
549700                 A.ORD_NBR         =  :ASC-PO-NBR                 54970000
549800            AND  A.ORD_NBR         =  B.ORD_NBR                   54980000
549900            AND  A.ORD_NBR         =  C.ORD_NBR                   54990000
550000            AND  B.ORD_LNE_NBR     =  :RECDIS-ORD-LNE-NBR         55000000
550100            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               55010000
550200            AND  A.VER_STATUS_CDE  =  'A'                         55020000
550300            AND  B.VER_STATUS_CDE  =  'A'                         55030000
550500            AND  B.STATUS_CDE      =  'VE'                        55050000
550600            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               55060000
550700            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               55070000
550800     END-EXEC.                                                    55080000
550900                                                                  55090000
551000     EVALUATE TRUE                                                55100000
551100         WHEN SQLCODE = ZERO                                      55110000
551200         WHEN SQLCODE = +100                                      55120000
551300              CONTINUE                                            55130000
551400         WHEN SQLCODE = -904                                      55140000
551500         WHEN SQLCODE = -911                                      55150000
551600         WHEN SQLCODE = -913                                      55160000
551700              PERFORM 9900-SOFT-ABORT                             55170000
551800         WHEN SQLWARN0 NOT = SPACE                                55180000
551900         WHEN SQLCODE NOT = ZERO                                  55190000
552000              MOVE '5820-GET-RECDIS-QTY'                          55200000
552100                               TO DP013-PARAGRAPH                 55210000
552200              MOVE 'SUM RECDIS VERIFY QUANTITY'                   55220000
552300                               TO DP013-MESSAGE-TEXT (1)          55230000
552400              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        55240000
552500              MOVE SQLCA       TO DP013-SQLCA                     55250000
552600              SET DP013-DB2-ABEND                                 55260000
552700                               TO TRUE                            55270000
552800              PERFORM DP013-0000-PROCESS-ABEND                    55280000
552900     END-EVALUATE.                                                55290000
553000/                                                                 55300000
553100*----------------------------------------------------------------*55310000
553200*    TO UPDATE THE PURCHASE ITEM ROW, WE REALLY MAKE THE CURRENT *55320000
553300*    ROW INACTIVE AND INSERT A NEW ROW WITH AN ACTIVE STATUS.    *55330000
553400*                                                                *55340000
553500*    ** NOTE **                                                  *55350000
553600*    WE WILL NOT BE MAKING THE CURRENT ROW ACTIVE AND INSERTING  *55360000
553700*    A NEW ROW WITH AN ACTIVE STATUS FOR PUCHASE ITEM ROWS ON    *55370000
553800*    PURCHASE ORDERS THAT ARE IN RMS.                            *55380000
553900*----------------------------------------------------------------*55390000
554000                                                                  55400000
554100 5830-UPDATE-PURITM-PROCESS.                                      55410000
554200                                                                  55420000
554300     PERFORM 5831-GET-PURITM.                                     55430000
554400     IF  SQLCODE EQUAL ZERO                                       55440000
554500     AND PURITM-STATUS-CDE NOT = 'RV'                             55450000
554600         IF PS-PO-UNVERIFY                                        55460000
554700             IF PURITM-STATUS-CDE = 'CM'                          55470000
554800                 MOVE ASC-DEPT-NBR   TO PV-DEPT-NBR-X             55480000
554900                 MOVE PV-DEPT-NBR    TO PV-DEPT-NBR-KEY           55490000
555000                 SET PS-NO-RMS-PO    TO TRUE                      55500000
555100*** CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO      55510000
555200*** VERSION THE TPURITM ROWS; WE JUST WANT TO UPDATE THE ROW.     55520000
555300                 PERFORM 5855-CHECK-FOR-RMS-PO                    55530000
555400                 IF PV-DB2-COUNT > ZERO                           55540000
555500                     SET PS-RMS-PO   TO TRUE                      55550000
555600                     PERFORM 5835-UPDATE-PURITM-UNVERIFY          55560000
555700                 ELSE                                             55570000
555800                     PERFORM 5832-UPDATE-PURITM                   55580000
555900                     ADD 1           TO  PURITM-VER-NBR           55590000
556000                     PERFORM 5833-INSERT-PURITM                   55600000
556100                 END-IF                                           55610000
556200              END-IF                                              55620000
556300         ELSE                                                     55630000
556400             PERFORM 5834-UPDATE-PURITM-VERIFY                    55640000
556500         END-IF                                                   55650000
556600     END-IF.                                                      55660000
556700                                                                  55670000
556800 5831-GET-PURITM.                                                 55680000
556900                                                                  55690000
557000     EXEC SQL                                                     55700000
557100          SELECT                                                  55710000
557200                  PO_NBR                                          55720000
557300                , VER_NBR                                         55730000
557400                , PO_LNE_NBR                                      55740000
557500                , VER_STATUS_CDE                                  55750000
557600                , SKU_SEQ_NBR                                     55760000
557700                , CL_NBR                                          55770000
557800                , VEND_STYL_NAME                                  55780000
557900                , COLOR_DESC                                      55790000
558000                , SIZE_DESC                                       55800000
558100                , UM_IND                                          55810000
558200                , UNT_QTY                                         55820000
558300                , UNT_RTL_PR_AMT                                  55830000
558400                , UNT_COST_AMT                                    55840000
558500                , TOT_VAL_COST_AMT                                55850000
558600                , TOT_VAL_RTL_AMT                                 55860000
558700                , MU_PCT                                          55870000
558800                , CRE_TMST                                        55880000
558900                , LAST_UPD_TMST                                   55890000
559000                , ITM_NBR                                         55900000
559100                , SKU_DESC                                        55910000
559200                , COLOR_CDE                                       55920000
559300                , SIZE_CDE                                        55930000
559400                , AD_EVNT_DTE                                     55940000
559500                , STATUS_CDE                                      55950000
559600                , CRE_BY_UID                                      55960000
559700                , LAST_UPD_BY_UID                                 55970000
559800                , GP_RTL_AMT                                      55980000
559900                , GP_QTY                                          55990000
560000                , APP_PO_LNE_NBR                                  56000000
560100                , PIC_ITM_IND                                     56010000
560200                , PIC_PG_NBR                                      56020000
560300                , PRD_1ST_COST_AMT                                56030000
560400                , PO_PREPK_ID                                     56040000
560500                , PREPK_RATO_QTY                                  56050000
560600                , SHIP_TO_TMP_DC_IND                              56060000
560700                , RMS_PO_SKU_NBR                                  56070000
560800                , CNCLD_UNT_QTY                                   56080000
560900           INTO                                                   56090000
561000                  :PURITM-PO-NBR                                  56100000
561100                , :PURITM-VER-NBR                                 56110000
561200                , :PURITM-PO-LNE-NBR                              56120000
561300                , :PURITM-VER-STATUS-CDE                          56130000
561400                , :PURITM-SKU-SEQ-NBR                             56140000
561500                , :PURITM-CL-NBR                                  56150000
561600                , :PURITM-VEND-STYL-NAME                          56160000
561700                , :PURITM-COLOR-DESC                              56170000
561800                , :PURITM-SIZE-DESC                               56180000
561900                , :PURITM-UM-IND                                  56190000
562000                , :PURITM-UNT-QTY                                 56200000
562100                , :PURITM-UNT-RTL-PR-AMT                          56210000
562200                , :PURITM-UNT-COST-AMT                            56220000
562300                , :PURITM-TOT-VAL-COST-AMT                        56230000
562400                , :PURITM-TOT-VAL-RTL-AMT                         56240000
562500                , :PURITM-MU-PCT                                  56250000
562600                , :PURITM-CRE-TMST                                56260000
562700                , :PURITM-LAST-UPD-TMST                           56270000
562800                , :PURITM-ITM-NBR                                 56280000
562900                , :PURITM-SKU-DESC                                56290000
563000                , :PURITM-COLOR-CDE                               56300000
563100                , :PURITM-SIZE-CDE                                56310000
563200                , :PURITM-AD-EVNT-DTE                             56320000
563300                , :PURITM-STATUS-CDE                              56330000
563400                , :PURITM-CRE-BY-UID                              56340000
563500                , :PURITM-LAST-UPD-BY-UID                         56350000
563600                , :PURITM-GP-RTL-AMT                              56360000
563700                , :PURITM-GP-QTY                                  56370000
563800                , :PURITM-APP-PO-LNE-NBR                          56380000
563900                , :PURITM-PIC-ITM-IND                             56390000
564000                , :PURITM-PIC-PG-NBR                              56400000
564100                , :PURITM-PRD-1ST-COST-AMT                        56410000
564200                , :PURITM-PO-PREPK-ID                             56420000
564300                , :PURITM-PREPK-RATO-QTY                          56430000
564400                , :PURITM-SHIP-TO-TMP-DC-IND                      56440000
564500                , :PURITM-RMS-PO-SKU-NBR                          56450000
564600                , :PURITM-CNCLD-UNT-QTY                           56460000
564700           FROM                                                   56470000
564800                  TPURITM                                         56480000
564900          WHERE                                                   56490000
565000                  PO_NBR             =  :ASC-PO-NBR               56500000
565100           AND    APP_PO_LNE_NBR     =  :RECDIS-ORD-LNE-NBR       56510000
565200           AND    VER_STATUS_CDE     =  'A'                       56520000
565300     END-EXEC.                                                    56530000
565400                                                                  56540000
565500     EVALUATE TRUE                                                56550000
565600         WHEN SQLCODE = ZERO                                      56560000
565700         WHEN SQLCODE = +100                                      56570000
565800              CONTINUE                                            56580000
565900         WHEN SQLWARN0 NOT = SPACE                                56590000
566000         WHEN SQLCODE = -904                                      56600000
566100         WHEN SQLCODE = -911                                      56610000
566200         WHEN SQLCODE = -913                                      56620000
566300              PERFORM 9900-SOFT-ABORT                             56630000
566400         WHEN SQLCODE NOT = ZERO                                  56640000
566500              MOVE '5831-GET-PURITM'                              56650000
566600                               TO DP013-PARAGRAPH                 56660000
566700              MOVE 'SUM RECDIS VERIFY QUANTITY'                   56670000
566800                               TO DP013-MESSAGE-TEXT (1)          56680000
566900              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        56690000
567000              MOVE SQLCA       TO DP013-SQLCA                     56700000
567100              SET DP013-DB2-ABEND                                 56710000
567200                               TO TRUE                            56720000
567300              PERFORM DP013-0000-PROCESS-ABEND                    56730000
567400     END-EVALUATE.                                                56740000
567500/                                                                 56750000
567600 5832-UPDATE-PURITM.                                              56760000
567700                                                                  56770000
567800     EXEC SQL                                                     56780000
567900          UPDATE                                                  56790000
568000                 TPURITM                                          56800000
568100          SET    VER_STATUS_CDE   =  'I'                          56810000
568200          WHERE                                                   56820000
568300                 PO_NBR           =  :ASC-PO-NBR                  56830000
568400          AND    APP_PO_LNE_NBR   =  :RECDIS-ORD-LNE-NBR          56840000
568500          AND    VER_STATUS_CDE   =  'A'                          56850000
568600     END-EXEC.                                                    56860000
568700                                                                  56870000
568800     EVALUATE TRUE                                                56880000
568900         WHEN SQLCODE = ZERO                                      56890000
569000              CONTINUE                                            56900000
569100         WHEN SQLCODE = -904                                      56910000
569200         WHEN SQLCODE = -911                                      56920000
569300         WHEN SQLCODE = -913                                      56930000
569400              SET PS-UPDATES-DONE TO TRUE                         56940000
569500              PERFORM 9900-SOFT-ABORT                             56950000
569600         WHEN SQLWARN0 NOT = SPACE                                56960000
569700         WHEN SQLCODE NOT = ZERO                                  56970000
569800              MOVE '5832-UPDATE-PURITM'                           56980000
569900                               TO DP013-PARAGRAPH                 56990000
570000              MOVE 'SET CURRENT ROW TO INACTIVE'                  57000000
570100                               TO DP013-MESSAGE-TEXT (1)          57010000
570200              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        57020000
570300              MOVE SQLCA       TO DP013-SQLCA                     57030000
570400              SET DP013-DB2-ABEND                                 57040000
570500                               TO TRUE                            57050000
570600              PERFORM DP013-0000-PROCESS-ABEND                    57060000
570700     END-EVALUATE.                                                57070000
570800/                                                                 57080000
570900 5833-INSERT-PURITM.                                              57090000
571000                                                                  57100000
571100     EXEC SQL                                                     57110000
571200          INSERT                                                  57120000
571300           INTO   TPURITM                                         57130000
571400                 (PO_NBR                                          57140000
571500                , VER_NBR                                         57150000
571600                , PO_LNE_NBR                                      57160000
571700                , VER_STATUS_CDE                                  57170000
571800                , SKU_SEQ_NBR                                     57180000
571900                , CL_NBR                                          57190000
572000                , VEND_STYL_NAME                                  57200000
572100                , COLOR_DESC                                      57210000
572200                , SIZE_DESC                                       57220000
572300                , UM_IND                                          57230000
572400                , UNT_QTY                                         57240000
572500                , UNT_RTL_PR_AMT                                  57250000
572600                , UNT_COST_AMT                                    57260000
572700                , TOT_VAL_COST_AMT                                57270000
572800                , TOT_VAL_RTL_AMT                                 57280000
572900                , MU_PCT                                          57290000
573000                , CRE_TMST                                        57300000
573100                , LAST_UPD_TMST                                   57310000
573200                , ITM_NBR                                         57320000
573300                , SKU_DESC                                        57330000
573400                , COLOR_CDE                                       57340000
573500                , SIZE_CDE                                        57350000
573600                , AD_EVNT_DTE                                     57360000
573700                , STATUS_CDE                                      57370000
573800                , CRE_BY_UID                                      57380000
573900                , LAST_UPD_BY_UID                                 57390000
574000                , GP_RTL_AMT                                      57400000
574100                , GP_QTY                                          57410000
574200                , APP_PO_LNE_NBR                                  57420000
574300                , PIC_ITM_IND                                     57430000
574400                , PIC_PG_NBR                                      57440000
574500                , PRD_1ST_COST_AMT                                57450000
574600                , STAT_TMST                                       57460000
574700                , PO_PREPK_ID                                     57470000
574800                , PREPK_RATO_QTY                                  57480000
574900                , SHIP_TO_TMP_DC_IND                              57490000
575000                , RMS_PO_SKU_NBR                                  57500000
575100                , CNCLD_UNT_QTY                                   57510000
575200                )                                                 57520000
575300          VALUES                                                  57530000
575400                 (:PURITM-PO-NBR                                  57540000
575500                , :PURITM-VER-NBR                                 57550000
575600                , :PURITM-PO-LNE-NBR                              57560000
575700                , 'A'                                             57570000
575800                , :PURITM-SKU-SEQ-NBR                             57580000
575900                , :PURITM-CL-NBR                                  57590000
576000                , :PURITM-VEND-STYL-NAME                          57600000
576100                , :PURITM-COLOR-DESC                              57610000
576200                , :PURITM-SIZE-DESC                               57620000
576300                , :PURITM-UM-IND                                  57630000
576400                , :PURITM-UNT-QTY                                 57640000
576500                , :PURITM-UNT-RTL-PR-AMT                          57650000
576600                , :PURITM-UNT-COST-AMT                            57660000
576700                , :PURITM-TOT-VAL-COST-AMT                        57670000
576800                , :PURITM-TOT-VAL-RTL-AMT                         57680000
576900                , :PURITM-MU-PCT                                  57690000
577000                , :PURITM-CRE-TMST                                57700000
577100                ,  CURRENT TIMESTAMP                              57710000
577200                , :PURITM-ITM-NBR                                 57720000
577300                , :PURITM-SKU-DESC                                57730000
577400                , :PURITM-COLOR-CDE                               57740000
577500                , :PURITM-SIZE-CDE                                57750000
577600                , :PURITM-AD-EVNT-DTE                             57760000
577700                , 'AC'                                            57770000
577800                , :PURITM-CRE-BY-UID                              57780000
577900                , :DP020-USERID                                   57790000
578000                , :PURITM-GP-RTL-AMT                              57800000
578100                , :PURITM-GP-QTY                                  57810000
578200                , :PURITM-APP-PO-LNE-NBR                          57820000
578300                , :PURITM-PIC-ITM-IND                             57830000
578400                , :PURITM-PIC-PG-NBR                              57840000
578500                , :PURITM-PRD-1ST-COST-AMT                        57850000
578600                ,  CURRENT TIMESTAMP                              57860000
578700                , :PURITM-PO-PREPK-ID                             57870000
578800                , :PURITM-PREPK-RATO-QTY                          57880000
578900                , :PURITM-SHIP-TO-TMP-DC-IND                      57890000
579000                , :PURITM-RMS-PO-SKU-NBR                          57900000
579100                , :PURITM-CNCLD-UNT-QTY                           57910000
579200                  )                                               57920000
579300     END-EXEC.                                                    57930000
579400                                                                  57940000
579500     EVALUATE TRUE                                                57950000
579600         WHEN SQLCODE = ZERO                                      57960000
579700              CONTINUE                                            57970000
579800         WHEN SQLCODE = -904                                      57980000
579900         WHEN SQLCODE = -911                                      57990000
580000         WHEN SQLCODE = -913                                      58000000
580100              SET PS-UPDATES-DONE TO TRUE                         58010000
580200              PERFORM 9900-SOFT-ABORT                             58020000
580300         WHEN SQLWARN0 NOT = SPACE                                58030000
580400         WHEN SQLCODE NOT = ZERO                                  58040000
580500              MOVE '5833-INSERT-PURITM'                           58050000
580600                               TO DP013-PARAGRAPH                 58060000
580700              MOVE 'INSERT NEW ROW IN TPURITM TABLE'              58070000
580800                               TO DP013-MESSAGE-TEXT (1)          58080000
580900              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        58090000
581000              MOVE SQLCA       TO DP013-SQLCA                     58100000
581100              SET DP013-DB2-ABEND                                 58110000
581200                               TO TRUE                            58120000
581300              PERFORM DP013-0000-PROCESS-ABEND                    58130000
581400     END-EVALUATE.                                                58140000
581500                                                                  58150000
581600                                                                  58160000
581700 5834-UPDATE-PURITM-VERIFY.                                       58170000
581800                                                                  58180000
581900     EXEC SQL                                                     58190000
582000          UPDATE                                                  58200000
582100                 TPURITM                                          58210000
582200          SET    STATUS_CDE   =  'CM'                             58220000
582300                ,STAT_TMST    =  CURRENT TIMESTAMP                58230000
582400          WHERE                                                   58240000
582500                 PO_NBR           =  :ASC-PO-NBR                  58250000
582600          AND    APP_PO_LNE_NBR   =  :RECDIS-ORD-LNE-NBR          58260000
582700          AND    VER_STATUS_CDE   =  'A'                          58270000
582800     END-EXEC.                                                    58280000
582900                                                                  58290000
583000     EVALUATE TRUE                                                58300000
583100         WHEN SQLCODE = ZERO                                      58310000
583200              CONTINUE                                            58320000
583300         WHEN SQLCODE = -904                                      58330000
583400         WHEN SQLCODE = -911                                      58340000
583500         WHEN SQLCODE = -913                                      58350000
583600              SET PS-UPDATES-DONE TO TRUE                         58360000
583700              PERFORM 9900-SOFT-ABORT                             58370000
583800         WHEN SQLWARN0 NOT = SPACE                                58380000
583900         WHEN SQLCODE NOT = ZERO                                  58390000
584000              MOVE '5834-UPDATE-PURITM-VERIFY'                    58400000
584100                               TO DP013-PARAGRAPH                 58410000
584200              MOVE 'SET STATUS TO "CM" COMPLETE'                  58420000
584300                               TO DP013-MESSAGE-TEXT (1)          58430000
584400              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        58440000
584500              MOVE SQLCA       TO DP013-SQLCA                     58450000
584600              SET DP013-DB2-ABEND                                 58460000
584700                               TO TRUE                            58470000
584800              PERFORM DP013-0000-PROCESS-ABEND                    58480000
584900     END-EVALUATE.                                                58490000
585000/                                                                 58500000
585100 5835-UPDATE-PURITM-UNVERIFY.                                     58510000
585200                                                                  58520000
585300     EXEC SQL                                                     58530000
585400          UPDATE                                                  58540000
585500                 TPURITM                                          58550000
585600          SET    STATUS_CDE   =  'AC'                             58560000
585700                ,STAT_TMST    =  CURRENT TIMESTAMP                58570000
585800          WHERE                                                   58580000
585900                 PO_NBR           =  :ASC-PO-NBR                  58590000
586000          AND    APP_PO_LNE_NBR   =  :RECDIS-ORD-LNE-NBR          58600000
586100          AND    VER_STATUS_CDE   =  'A'                          58610000
586200     END-EXEC.                                                    58620000
586300                                                                  58630000
586400     EVALUATE TRUE                                                58640000
586500         WHEN SQLCODE = ZERO                                      58650000
586600              CONTINUE                                            58660000
586700         WHEN SQLCODE = -904                                      58670000
586800         WHEN SQLCODE = -911                                      58680000
586900         WHEN SQLCODE = -913                                      58690000
587000              SET PS-UPDATES-DONE TO TRUE                         58700000
587100              PERFORM 9900-SOFT-ABORT                             58710000
587200         WHEN SQLWARN0 NOT = SPACE                                58720000
587300         WHEN SQLCODE NOT = ZERO                                  58730000
587400              MOVE '5835-UPDATE-PURITM-UNVERIFY'                  58740000
587500                               TO DP013-PARAGRAPH                 58750000
587600              MOVE 'SET STATUS TO "AC" ACTIVE'                    58760000
587700                               TO DP013-MESSAGE-TEXT (1)          58770000
587800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        58780000
587900              MOVE SQLCA       TO DP013-SQLCA                     58790000
588000              SET DP013-DB2-ABEND                                 58800000
588100                               TO TRUE                            58810000
588200              PERFORM DP013-0000-PROCESS-ABEND                    58820000
588300     END-EVALUATE.                                                58830000
588400/                                                                 58840000
588500*----------------------------------------------------------------*58850000
588600*    HERE, WE CHECK THE STATUS OF THE PURCHASE ORDER AS PART OF  *58860000
588700*    THE UNVERIFY PROCESS.  IF THE PURCHASE ORDER IS COMPLETE    *58870000
588800*    IT NEEDS TO BE SET BACK TO A STATUS OF ACTIVE ('AC').       *58880000
588900*    AN UPDATE ENTAILS THE CHANGING OF THE CURRENT ROW TO AN     *58890000
589000*    INACTIVE STATUS AND INSERTING A NEW "ACTIVE" ROW.           *58900000
589100*                                                                *58910000
589200* ** 06/02/2003 CHANGE **                                        *58920000
589300*    CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO    *58930000
589400*    UPDATE THE PURCHASE ORDER TABLE.  THIS TABLE WILL GET       *58940000
589500*    UPDATED THROUGH AN RMS PROCESS.                             *58950000
589600*----------------------------------------------------------------*58960000
589700                                                                  58970000
589800 5850-CHECK-PURCHS-FOR-UPDATE.                                    58980000
589900                                                                  58990000
590000     PERFORM 5852-GET-TPURCHS-STATUS.                             59000000
590100     IF  PURCHS-STATUS-CDE EQUAL 'CM'                             59010000
590200         IF  PS-RMS-PO                                            59020000
590300             CONTINUE                                             59030000
590400         ELSE                                                     59040000
590500             IF  PS-CHECKED-FOR-RMS-PO                            59050000
590600                 PERFORM 5853-UPDATE-PURCHS-STATUS                59060000
590700                 ADD 1        TO  PURCHS-VER-NBR                  59070000
590800                 PERFORM 5854-INSERT-PURCHS                       59080000
590900             ELSE                                                 59090000
591000                 MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X               59100000
591100                 MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY             59110000
591200                 SET PS-NO-RMS-PO  TO TRUE                        59120000
591300                 PERFORM 5855-CHECK-FOR-RMS-PO                    59130000
591400                 IF  PV-DB2-COUNT > ZERO                          59140000
591500                     SET PS-RMS-PO TO TRUE                        59150000
591600                 ELSE                                             59160000
591700                     PERFORM 5853-UPDATE-PURCHS-STATUS            59170000
591800                     ADD 1    TO  PURCHS-VER-NBR                  59180000
591900                     PERFORM 5854-INSERT-PURCHS                   59190000
592000                 END-IF                                           59200000
592100             END-IF                                               59210000
592200         END-IF                                                   59220000
592300     END-IF.                                                      59230000
592400                                                                  59240000
592500                                                                  59250000
592600*----------------------------------------------------------------*59260000
592700*    HERE, WE CHECK IF ALL PURCHASE ITEM LINES ARE EQUAL TO      *59270000
592800*    'CM' 'CB' OR 'CA' AND THE PURCHASE ORDER HEADER IS EQUAL    *59280000
592900*    TO 'AP' OR 'AC'.  IF SO, UPDATE THE PURCHASE ORDER HEADER   *59290000
593000*    TO A STATUS OF 'CM'.                                        *59300000
593100*                                                                *59310000
593200* ** 06/02/2003 CHANGE **                                        *59320000
593300*    CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO    *59330000
593400*    UPDATE THE PURCHASE ORDER TABLE.  THIS TABLE WILL GET       *59340000
593500*    UPDATED THROUGH AN RMS PROCESS.                             *59350000
593600*----------------------------------------------------------------*59360000
593700 5851-CHECK-PURCHS-FOR-UPDATE.                                    59370000
593800                                                                  59380000
593900     PERFORM 5851-COUNT-PO-LINE-ROWS.                             59390000
594000     IF  PV-DB2-COUNT EQUAL ZERO                                  59400000
594100         PERFORM 5852-GET-TPURCHS-STATUS                          59410000
594200         IF  PURCHS-STATUS-CDE EQUAL 'AP'  OR 'AC'                59420000
594300             IF  PS-RMS-PO                                        59430000
594400                 CONTINUE                                         59440000
594500             ELSE                                                 59450000
594600                 IF  PS-CHECKED-FOR-RMS-PO                        59460000
594700                     PERFORM 5853-UPDATE-PURCHS-STATUS-VER        59470000
594800                 ELSE                                             59480000
594900                     MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X           59490000
595000                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         59500000
595100                     SET PS-NO-RMS-PO  TO TRUE                    59510000
595200                     PERFORM 5855-CHECK-FOR-RMS-PO                59520000
595300                     IF  PV-DB2-COUNT = ZERO                      59530000
595400                         PERFORM 5853-UPDATE-PURCHS-STATUS-VER    59540000
595500                     END-IF                                       59550000
595600                 END-IF                                           59560000
595700             END-IF                                               59570000
595800         END-IF                                                   59580000
595900     END-IF.                                                      59590000
596000                                                                  59600000
596100                                                                  59610000
596200 5851-COUNT-PO-LINE-ROWS.                                         59620000
596300                                                                  59630000
596400     MOVE ZERO            TO  PV-DB2-COUNT.                       59640000
596500     EXEC SQL                                                     59650000
596600          SELECT                                                  59660000
596700                COUNT(*)                                          59670000
596800          INTO                                                    59680000
596900                :PV-DB2-COUNT :PV-NULL-IND                        59690000
597000          FROM                                                    59700000
597100                TPURITM                                           59710000
597200          WHERE                                                   59720000
597300                PO_NBR             =  :ASC-PO-NBR                 59730000
597400          AND   VER_STATUS_CDE     =  'A'                         59740000
597500          AND  (STATUS_CDE        ^=  'CM'                        59750000
597600           AND  STATUS_CDE        ^=  'CB'                        59760000
597700           AND  STATUS_CDE        ^=  'CA')                       59770000
597800     END-EXEC.                                                    59780000
597900                                                                  59790000
598000     EVALUATE TRUE                                                59800000
598100         WHEN SQLCODE = ZERO                                      59810000
598200         WHEN SQLCODE = +100                                      59820000
598300              CONTINUE                                            59830000
598400         WHEN SQLCODE = -904                                      59840000
598500         WHEN SQLCODE = -911                                      59850000
598600         WHEN SQLCODE = -913                                      59860000
598700              PERFORM 9900-SOFT-ABORT                             59870000
598800         WHEN SQLWARN0 NOT = SPACE                                59880000
598900         WHEN SQLCODE NOT = ZERO                                  59890000
599000              MOVE '5851-COUNT-PO-LINE-ROWS'                      59900000
599100                               TO DP013-PARAGRAPH                 59910000
599200              MOVE 'COUNT NUMBER OF "CM", "CB", "CA" STATUS ROWS' 59920000
599300                               TO DP013-MESSAGE-TEXT (1)          59930000
599400              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        59940000
599500              MOVE SQLCA       TO DP013-SQLCA                     59950000
599600              SET DP013-DB2-ABEND                                 59960000
599700                               TO TRUE                            59970000
599800              PERFORM DP013-0000-PROCESS-ABEND                    59980000
599900     END-EVALUATE.                                                59990000
600000/                                                                 60000000
600100*----------------------------------------------------------------*60010000
600200*    GET THE STATUS CODE OF THE CURRENT P.O.                     *60020000
600300*----------------------------------------------------------------*60030000
600400 5852-GET-TPURCHS-STATUS.                                         60040000
600500                                                                  60050000
600600     EXEC SQL                                                     60060000
600700          SELECT                                                  60070000
600800                  PO_NBR                                          60080000
600900                , VER_NBR                                         60090000
601000                , VER_STATUS_CDE                                  60100000
601100                , PO_TYP_CDE                                      60110000
601200                , PO_CATEG_CDE                                    60120000
601300                , EDI_IND                                         60130000
601400                , TOT_UNT_QTY                                     60140000
601500                , TOT_VAL_COST_AMT                                60150000
601600                , TOT_VAL_RTL_AMT                                 60160000
601700                , TOT_MU_PCT                                      60170000
601800                , TOT_SKUS_QTY                                    60180000
601900                , IMPRT_AGNT_PO_NBR                               60190000
602000                , IMPRT_ORD_OFF_NAME                              60200000
602100                , IMPRT_VEND_NAME                                 60210000
602200                , IMPRT_FCTRY_NAME                                60220000
602300                , IMPRT_CNTRY_NAME                                60230000
602400                , VEND_CNTRY_NAME                                 60240000
602500                , NEW_STR_PO_IND                                  60250000
602600                , IMPRT_PO_IND                                    60260000
602700                , IMPRT_AGNT_PO_IND                               60270000
602800                , STATUS_TMST                                     60280000
602900                , LAST_UPD_TMST                                   60290000
603000                , EDI_REXMIT_IND                                  60300000
603100                , EDI_REXMIT_TMST                                 60310000
603200                , DIR_STR_IND                                     60320000
603300                , LAST_UPD_BY_UID                                 60330000
603400                , APP_BY_UID                                      60340000
603500                , OTB_PER_NBR                                     60350000
603600                , DEPT_NBR                                        60360000
603700                , ENT_ID                                          60370000
603800                , STATUS_CDE                                      60380000
603900                , CRE_BY_UID                                      60390000
604000                , REJ_CT                                          60400000
604100                , REJ_UID                                         60410000
604200                , ORD_DTE                                         60420000
604300                , REVISION_CT                                     60430000
604400                , ADR_SEQ_NBR                                     60440000
604500                , DEST_KNOWN_IND                                  60450000
604600                , RLSE_IND                                        60460000
604700                , RLSE_DTE                                        60470000
604800                , PLCMNT_CNTRY_CDE                                60480000
604900                , PROD_CNTRY_CDE                                  60490000
605000                , UNT_PER_CBMT_QTY                                60500000
605100                , CRE_TMST                                        60510000
605200                , PRG_LAST_ACTVY_DTE                              60520000
605300                , PKGNG_CDE                                       60530000
605400                , SEASET_YR                                       60540000
605500                , SEASET_SHRT_NM                                  60550000
605600                , QTA_CTG_CDE                                     60560000
605700                , PO_IN_RMS_IND                                   60570000
605800                , RMS_PO_UPD_TMST                                 60580000
605900                , DUP_SKU_IND                                     60590000
606000                , ORIG_PKGNG_CDE                                  60600000
606100           INTO                                                   60610000
606200                 :PURCHS-PO-NBR                                   60620000
606300                ,:PURCHS-VER-NBR                                  60630000
606400                ,:PURCHS-VER-STATUS-CDE                           60640000
606500                ,:PURCHS-PO-TYP-CDE                               60650000
606600                ,:PURCHS-PO-CATEG-CDE                             60660000
606700                ,:PURCHS-EDI-IND                                  60670000
606800                ,:PURCHS-TOT-UNT-QTY                              60680000
606900                ,:PURCHS-TOT-VAL-COST-AMT                         60690000
607000                ,:PURCHS-TOT-VAL-RTL-AMT                          60700000
607100                ,:PURCHS-TOT-MU-PCT                               60710000
607200                ,:PURCHS-TOT-SKUS-QTY                             60720000
607300                ,:PURCHS-IMPRT-AGNT-PO-NBR                        60730000
607400                ,:PURCHS-IMPRT-ORD-OFF-NAME                       60740000
607500                ,:PURCHS-IMPRT-VEND-NAME                          60750000
607600                ,:PURCHS-IMPRT-FCTRY-NAME                         60760000
607700                ,:PURCHS-IMPRT-CNTRY-NAME                         60770000
607800                ,:PURCHS-VEND-CNTRY-NAME                          60780000
607900                ,:PURCHS-NEW-STR-PO-IND                           60790000
608000                ,:PURCHS-IMPRT-PO-IND                             60800000
608100                ,:PURCHS-IMPRT-AGNT-PO-IND                        60810000
608200                ,:PURCHS-STATUS-TMST                              60820000
608300                ,:PURCHS-LAST-UPD-TMST                            60830000
608400                ,:PURCHS-EDI-REXMIT-IND                           60840000
608500                ,:PURCHS-EDI-REXMIT-TMST                          60850000
608600                ,:PURCHS-DIR-STR-IND                              60860000
608700                ,:PURCHS-LAST-UPD-BY-UID                          60870000
608800                ,:PURCHS-APP-BY-UID                               60880000
608900                ,:PURCHS-OTB-PER-NBR                              60890000
609000                ,:PURCHS-DEPT-NBR                                 60900000
609100                ,:PURCHS-ENT-ID                                   60910000
609200                ,:PURCHS-STATUS-CDE                               60920000
609300                ,:PURCHS-CRE-BY-UID                               60930000
609400                ,:PURCHS-REJ-CT                                   60940000
609500                ,:PURCHS-REJ-UID                                  60950000
609600                ,:PURCHS-ORD-DTE                                  60960000
609700                ,:PURCHS-REVISION-CT                              60970000
609800                ,:PURCHS-ADR-SEQ-NBR                              60980000
609900                ,:PURCHS-DEST-KNOWN-IND                           60990000
610000                ,:PURCHS-RLSE-IND                                 61000000
610100                ,:PURCHS-RLSE-DTE                                 61010000
610200                ,:PURCHS-PLCMNT-CNTRY-CDE                         61020000
610300                ,:PURCHS-PROD-CNTRY-CDE                           61030000
610400                ,:PURCHS-UNT-PER-CBMT-QTY                         61040000
610500                ,:PURCHS-CRE-TMST                                 61050000
610600                ,:PURCHS-PRG-LAST-ACTVY-DTE                       61060000
610700                ,:PURCHS-PKGNG-CDE                                61070000
610800                ,:PURCHS-SEASET-YR                                61080000
610900                ,:PURCHS-SEASET-SHRT-NM                           61090000
611000                ,:PURCHS-QTA-CTG-CDE                              61100000
611100                ,:PURCHS-PO-IN-RMS-IND                            61110000
611200                ,:PURCHS-RMS-PO-UPD-TMST                          61120000
611300                ,:PURCHS-DUP-SKU-IND                              61130000
611400                ,:PURCHS-ORIG-PKGNG-CDE                           61140000
611500          FROM                                                    61150000
611600                 TPURCHS                                          61160000
611700          WHERE                                                   61170000
611800                PO_NBR             =  :ASC-PO-NBR                 61180000
611900          AND   VER_STATUS_CDE     =  'A'                         61190000
612000     END-EXEC.                                                    61200000
612100                                                                  61210000
612200     EVALUATE TRUE                                                61220000
612300         WHEN SQLCODE = ZERO                                      61230000
612400         WHEN SQLCODE = +100                                      61240000
612500              CONTINUE                                            61250000
612600         WHEN SQLCODE = -904                                      61260000
612700         WHEN SQLCODE = -911                                      61270000
612800         WHEN SQLCODE = -913                                      61280000
612900              PERFORM 9900-SOFT-ABORT                             61290000
613000         WHEN SQLWARN0 NOT = SPACE                                61300000
613100         WHEN SQLCODE NOT = ZERO                                  61310000
613200              MOVE '5852-GET-TPURCHS-STATUS'                      61320000
613300                               TO DP013-PARAGRAPH                 61330000
613400              MOVE 'GET THE PURCHASE HEADER'                      61340000
613500                               TO DP013-MESSAGE-TEXT (1)          61350000
613600              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        61360000
613700              MOVE SQLCA       TO DP013-SQLCA                     61370000
613800              SET DP013-DB2-ABEND                                 61380000
613900                               TO TRUE                            61390000
614000              PERFORM DP013-0000-PROCESS-ABEND                    61400000
614100     END-EVALUATE.                                                61410000
614200/                                                                 61420000
614300 5853-UPDATE-PURCHS-STATUS.                                       61430000
614400                                                                  61440000
614500     EXEC SQL                                                     61450000
614600          UPDATE                                                  61460000
614700                TPURCHS                                           61470000
614800           SET                                                    61480000
614900                VER_STATUS_CDE     =  'I'                         61490000
615000          WHERE                                                   61500000
615100                PO_NBR             =  :ASC-PO-NBR                 61510000
615200          AND   VER_STATUS_CDE     =  'A'                         61520000
615300     END-EXEC.                                                    61530000
615400                                                                  61540000
615500     EVALUATE TRUE                                                61550000
615600         WHEN SQLCODE = ZERO                                      61560000
615700         WHEN SQLCODE = +100                                      61570000
615800              CONTINUE                                            61580000
615900         WHEN SQLCODE = -904                                      61590000
616000         WHEN SQLCODE = -911                                      61600000
616100         WHEN SQLCODE = -913                                      61610000
616200              SET PS-UPDATES-DONE TO TRUE                         61620000
616300              PERFORM 9900-SOFT-ABORT                             61630000
616400         WHEN SQLWARN0 NOT = SPACE                                61640000
616500         WHEN SQLCODE NOT = ZERO                                  61650000
616600              MOVE '5853-UPDATE-PURCHS-STATUS'                    61660000
616700                               TO DP013-PARAGRAPH                 61670000
616800              MOVE 'GET THE PURCHASE HEADER'                      61680000
616900                               TO DP013-MESSAGE-TEXT (1)          61690000
617000              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        61700000
617100              MOVE SQLCA       TO DP013-SQLCA                     61710000
617200              SET DP013-DB2-ABEND                                 61720000
617300                               TO TRUE                            61730000
617400              PERFORM DP013-0000-PROCESS-ABEND                    61740000
617500     END-EVALUATE.                                                61750000
617600/                                                                 61760000
617700 5853-UPDATE-PURCHS-STATUS-VER.                                   61770000
617800                                                                  61780000
617900     EXEC SQL                                                     61790000
618000          UPDATE                                                  61800000
618100                TPURCHS                                           61810000
618200           SET                                                    61820000
618300                STATUS_CDE         =  'CM'                        61830000
618400              , STATUS_TMST        =  (CURRENT TIMESTAMP)         61840000
618500          WHERE                                                   61850000
618600                PO_NBR             =  :ASC-PO-NBR                 61860000
618700          AND   VER_STATUS_CDE     =  'A'                         61870000
618800     END-EXEC.                                                    61880000
618900                                                                  61890000
619000     EVALUATE TRUE                                                61900000
619100         WHEN SQLCODE = ZERO                                      61910000
619200         WHEN SQLCODE = +100                                      61920000
619300              CONTINUE                                            61930000
619400         WHEN SQLCODE = -904                                      61940000
619500         WHEN SQLCODE = -911                                      61950000
619600         WHEN SQLCODE = -913                                      61960000
619700              SET PS-UPDATES-DONE TO TRUE                         61970000
619800              PERFORM 9900-SOFT-ABORT                             61980000
619900         WHEN SQLWARN0 NOT = SPACE                                61990000
620000         WHEN SQLCODE NOT = ZERO                                  62000000
620100              MOVE '5853-UPDATE-PURCHS-STATUS'                    62010000
620200                               TO DP013-PARAGRAPH                 62020000
620300              MOVE 'GET THE PURCHASE HEADER'                      62030000
620400                               TO DP013-MESSAGE-TEXT (1)          62040000
620500              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        62050000
620600              MOVE SQLCA       TO DP013-SQLCA                     62060000
620700              SET DP013-DB2-ABEND                                 62070000
620800                               TO TRUE                            62080000
620900              PERFORM DP013-0000-PROCESS-ABEND                    62090000
621000     END-EVALUATE.                                                62100000
621100/                                                                 62110000
621200 5854-INSERT-PURCHS.                                              62120000
621300                                                                  62130000
621400     EXEC SQL                                                     62140000
621500          INSERT                                                  62150000
621600           INTO   TPURCHS                                         62160000
621700                 (PO_NBR                                          62170000
621800                , VER_NBR                                         62180000
621900                , VER_STATUS_CDE                                  62190000
622000                , PO_TYP_CDE                                      62200000
622100                , PO_CATEG_CDE                                    62210000
622200                , EDI_IND                                         62220000
622300                , TOT_UNT_QTY                                     62230000
622400                , TOT_VAL_COST_AMT                                62240000
622500                , TOT_VAL_RTL_AMT                                 62250000
622600                , TOT_MU_PCT                                      62260000
622700                , TOT_SKUS_QTY                                    62270000
622800                , IMPRT_AGNT_PO_NBR                               62280000
622900                , IMPRT_ORD_OFF_NAME                              62290000
623000                , IMPRT_VEND_NAME                                 62300000
623100                , IMPRT_FCTRY_NAME                                62310000
623200                , IMPRT_CNTRY_NAME                                62320000
623300                , VEND_CNTRY_NAME                                 62330000
623400                , NEW_STR_PO_IND                                  62340000
623500                , IMPRT_PO_IND                                    62350000
623600                , IMPRT_AGNT_PO_IND                               62360000
623700                , STATUS_TMST                                     62370000
623800                , LAST_UPD_TMST                                   62380000
623900                , EDI_REXMIT_IND                                  62390000
624000                , EDI_REXMIT_TMST                                 62400000
624100                , DIR_STR_IND                                     62410000
624200                , LAST_UPD_BY_UID                                 62420000
624300                , APP_BY_UID                                      62430000
624400                , OTB_PER_NBR                                     62440000
624500                , DEPT_NBR                                        62450000
624600                , ENT_ID                                          62460000
624700                , STATUS_CDE                                      62470000
624800                , CRE_BY_UID                                      62480000
624900                , REJ_CT                                          62490000
625000                , REJ_UID                                         62500000
625100                , ORD_DTE                                         62510000
625200                , REVISION_CT                                     62520000
625300                , ADR_SEQ_NBR                                     62530000
625400                , DEST_KNOWN_IND                                  62540000
625500                , RLSE_IND                                        62550000
625600                , RLSE_DTE                                        62560000
625700                , PLCMNT_CNTRY_CDE                                62570000
625800                , PROD_CNTRY_CDE                                  62580000
625900                , UNT_PER_CBMT_QTY                                62590000
626000                , CRE_TMST                                        62600000
626100                , PRG_LAST_ACTVY_DTE                              62610000
626200                , PKGNG_CDE                                       62620000
626300                , SEASET_YR                                       62630000
626400                , SEASET_SHRT_NM                                  62640000
626500                , QTA_CTG_CDE                                     62650000
626600                , PO_IN_RMS_IND                                   62660000
626700                , RMS_PO_UPD_TMST                                 62670000
626800                , DUP_SKU_IND                                     62680000
626900                , ORIG_PKGNG_CDE                                  62690000
627000                )                                                 62700000
627100         VALUES                                                   62710000
627200                (:PURCHS-PO-NBR                                   62720000
627300                ,:PURCHS-VER-NBR                                  62730000
627400                ,'A'                                              62740000
627500                ,:PURCHS-PO-TYP-CDE                               62750000
627600                ,:PURCHS-PO-CATEG-CDE                             62760000
627700                ,:PURCHS-EDI-IND                                  62770000
627800                ,:PURCHS-TOT-UNT-QTY                              62780000
627900                ,:PURCHS-TOT-VAL-COST-AMT                         62790000
628000                ,:PURCHS-TOT-VAL-RTL-AMT                          62800000
628100                ,:PURCHS-TOT-MU-PCT                               62810000
628200                ,:PURCHS-TOT-SKUS-QTY                             62820000
628300                ,:PURCHS-IMPRT-AGNT-PO-NBR                        62830000
628400                ,:PURCHS-IMPRT-ORD-OFF-NAME                       62840000
628500                ,:PURCHS-IMPRT-VEND-NAME                          62850000
628600                ,:PURCHS-IMPRT-FCTRY-NAME                         62860000
628700                ,:PURCHS-IMPRT-CNTRY-NAME                         62870000
628800                ,:PURCHS-VEND-CNTRY-NAME                          62880000
628900                ,:PURCHS-NEW-STR-PO-IND                           62890000
629000                ,:PURCHS-IMPRT-PO-IND                             62900000
629100                ,:PURCHS-IMPRT-AGNT-PO-IND                        62910000
629200                , CURRENT TIMESTAMP                               62920000
629300                , CURRENT TIMESTAMP                               62930000
629400                ,:PURCHS-EDI-REXMIT-IND                           62940000
629500                ,:PURCHS-EDI-REXMIT-TMST                          62950000
629600                ,:PURCHS-DIR-STR-IND                              62960000
629700                ,:DP020-USERID                                    62970000
629800                ,:PURCHS-APP-BY-UID                               62980000
629900                ,:PURCHS-OTB-PER-NBR                              62990000
630000                ,:PURCHS-DEPT-NBR                                 63000000
630100                ,:PURCHS-ENT-ID                                   63010000
630200                ,'AC'                                             63020000
630300                ,:PURCHS-CRE-BY-UID                               63030000
630400                ,:PURCHS-REJ-CT                                   63040000
630500                ,:PURCHS-REJ-UID                                  63050000
630600                ,:PURCHS-ORD-DTE                                  63060000
630700                ,:PURCHS-REVISION-CT                              63070000
630800                ,:PURCHS-ADR-SEQ-NBR                              63080000
630900                ,:PURCHS-DEST-KNOWN-IND                           63090000
631000                ,:PURCHS-RLSE-IND                                 63100000
631100                ,:PURCHS-RLSE-DTE                                 63110000
631200                ,:PURCHS-PLCMNT-CNTRY-CDE                         63120000
631300                ,:PURCHS-PROD-CNTRY-CDE                           63130000
631400                ,:PURCHS-UNT-PER-CBMT-QTY                         63140000
631500                ,:PURCHS-CRE-TMST                                 63150000
631600                ,:PURCHS-PRG-LAST-ACTVY-DTE                       63160000
631700                ,:PURCHS-PKGNG-CDE                                63170000
631800                ,:PURCHS-SEASET-YR                                63180000
631900                ,:PURCHS-SEASET-SHRT-NM                           63190000
632000                ,:PURCHS-QTA-CTG-CDE                              63200000
632100                ,:PURCHS-PO-IN-RMS-IND                            63210000
632200                ,:PURCHS-RMS-PO-UPD-TMST                          63220000
632300                ,:PURCHS-DUP-SKU-IND                              63230000
632400                ,:PURCHS-ORIG-PKGNG-CDE                           63240000
632500                )                                                 63250000
632600     END-EXEC.                                                    63260000
632700                                                                  63270000
632800     EVALUATE TRUE                                                63280000
632900         WHEN SQLCODE = ZERO                                      63290000
633000              CONTINUE                                            63300000
633100         WHEN SQLCODE = -904                                      63310000
633200         WHEN SQLCODE = -911                                      63320000
633300         WHEN SQLCODE = -913                                      63330000
633400              SET PS-UPDATES-DONE TO TRUE                         63340000
633500              PERFORM 9900-SOFT-ABORT                             63350000
633600         WHEN SQLWARN0 NOT = SPACE                                63360000
633700         WHEN SQLCODE NOT = ZERO                                  63370000
633800              MOVE '5854-INSERT-PURCHS'                           63380000
633900                               TO DP013-PARAGRAPH                 63390000
634000              MOVE 'INSERT PURCHASE HEADER'                       63400000
634100                               TO DP013-MESSAGE-TEXT (1)          63410000
634200              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        63420000
634300              MOVE SQLCA       TO DP013-SQLCA                     63430000
634400              SET DP013-DB2-ABEND                                 63440000
634500                               TO TRUE                            63450000
634600              PERFORM DP013-0000-PROCESS-ABEND                    63460000
634700     END-EVALUATE.                                                63470000
634800/                                                                 63480000
634900*----------------------------------------------------------------*63490000
635000*    CHECK TO SEE IF THIS DEPARTMENT HAS BEEN CONVERTED TO RMS.  *63500000
635100*    IF IT HAS, THE COUNT RETURNED FROM THIS FUNCTION WILL BE    *63510000
635200*    GREATER THAN ZERO AND WE CAN UPDATE TPURITM AND TPURCHS     *63520000
635300*    CORRECTLY.                                                  *63530000
635400*----------------------------------------------------------------*63540000
635500 5855-CHECK-FOR-RMS-PO.                                           63550000
635600                                                                  63560000
635700     INITIALIZE PV-DB2-COUNT.                                     63570000
635800                                                                  63580000
635900     EXEC SQL                                                     63590000
636000          SELECT                                                  63600000
636100                  COUNT(*)                                        63610000
636200           INTO                                                   63620000
636300                  :PV-DB2-COUNT :PV-NULL-IND                      63630000
636400           FROM                                                   63640000
636500                  POT_RMS_RLOUT_CTL                               63650000
636600          WHERE                                                   63660000
636700                  DEPT_NBR            = :PV-DEPT-NBR-KEY          63670000
636800           AND    PO_ENTR_IN_RMS_DTE <=  CURRENT_DATE             63680000
636900     END-EXEC.                                                    63690000
637000                                                                  63700000
637100     EVALUATE TRUE                                                63710000
637200         WHEN SQLCODE = ZERO                                      63720000
637300         WHEN SQLCODE = +100                                      63730000
637400              SET PS-CHECKED-FOR-RMS-PO                           63740000
637500                               TO TRUE                            63750000
637600         WHEN SQLWARN0 NOT = SPACE                                63760000
637700         WHEN SQLCODE = -904                                      63770000
637800         WHEN SQLCODE = -911                                      63780000
637900         WHEN SQLCODE = -913                                      63790000
638000              PERFORM 9900-SOFT-ABORT                             63800000
638100         WHEN SQLCODE NOT = ZERO                                  63810000
638200              MOVE '5855-CHECK-FOR-RMS-PO'                        63820000
638300                               TO DP013-PARAGRAPH                 63830000
638400              MOVE 'CHECK IF DEPT NBR CONVERTED FOR RMS'          63840000
638500                               TO DP013-MESSAGE-TEXT (1)          63850000
638600              STRING 'DEPARTMENT NUMBER: ' DELIMITED BY SIZE      63860000
638700                     PV-DEPT-NBR-X         DELIMITED BY SIZE      63870000
638800                             INTO DP013-MESSAGE-TEXT (2)          63880000
638900              MOVE 'POT_RMS_RLOUT_CTL'                            63890000
639000                               TO DP013-DB2-TABLE-NAME (1)        63900000
639100              MOVE SQLCA       TO DP013-SQLCA                     63910000
639200              SET DP013-DB2-ABEND                                 63920000
639300                               TO TRUE                            63930000
639400              PERFORM DP013-0000-PROCESS-ABEND                    63940000
639500     END-EVALUATE.                                                63950000
639600 5900-PROCESS-TRECDIS.                                            63960000
639700     PERFORM 5910-OPEN-TRECDIS-CURSOR.                            63970000
639800     PERFORM 5930-FETCH-TRECDIS-CSR.                              63980000
639900     PERFORM 5920-PROCESS-TRECDIS-CURSOR                          63990000
640000            UNTIL PS-END-TRECDIS-CSR.                             64000000
640100     PERFORM 5940-CLOSE-TRECDIS-CSR.                              64010000
640200                                                                  64020000
640300 5910-OPEN-TRECDIS-CURSOR.                                        64030000
640400                                                                  64040000
640500     EXEC SQL                                                     64050000
640600          OPEN TRECDIS-CSR                                        64060000
640700     END-EXEC.                                                    64070000
640800                                                                  64080000
640900     EVALUATE TRUE                                                64090000
641000         WHEN SQLCODE = ZERO                                      64100000
641100         WHEN SQLCODE = +100                                      64110000
641200              SET PS-NOT-END-TRECDIS-CSR TO TRUE                  64120000
641300         WHEN SQLCODE = -904                                      64130000
641400         WHEN SQLCODE = -911                                      64140000
641500         WHEN SQLCODE = -913                                      64150000
641600             PERFORM 9900-SOFT-ABORT                              64160000
641700         WHEN SQLWARN0 NOT = SPACES                               64170000
641800         WHEN SQLCODE < ZERO                                      64180000
641900         WHEN SQLCODE > ZERO                                      64190000
642000              MOVE '5910-OPEN-TRECDIS-CURSOR'                     64200000
642100                                   TO  DP013-PARAGRAPH            64210000
642200              MOVE 'OPEN STORE CURSOR - '                         64220000
642300                                   TO  DP013-MESSAGE-TEXT (1)     64230000
642400              MOVE SQLCA           TO  DP013-SQLCA                64240000
642500              MOVE 'TRECDIS '      TO  DP013-DB2-TABLE-NAME (1)   64250000
642600              SET DP013-DB2-ABEND                                 64260000
642700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              64270000
642800                 PERFORM DP013-0000-PROCESS-ABEND                 64280000
642900         END-EVALUATE.                                            64290000
643000                                                                  64300000
643100 5920-PROCESS-TRECDIS-CURSOR.                                     64310000
643200     INITIALIZE RC074-FIELDS                                      64320000
643300     MOVE RECDIS-STR-NBR   TO RC074-STR-NBR.                      64330000
643400     MOVE RECITM-ORD-LNE-NBR TO RC074-LINE-NBR                    64340000
643500     PERFORM 4350-CALL-RCKUT128.                                  64350000
643600     PERFORM 5550-UPDATE-RECDIS-OTBND.                            64360000
643700     PERFORM 5930-FETCH-TRECDIS-CSR.                              64370000
643800                                                                  64380000
643900 5930-FETCH-TRECDIS-CSR.                                          64390000
644000     EXEC SQL                                                     64400000
644100          FETCH                                                   64410000
644200                TRECDIS-CSR                                       64420000
644300          INTO                                                    64430000
644400                :RECDIS-STR-NBR                                   64440000
644500     END-EXEC.                                                    64450000
644600                                                                  64460000
644700     EVALUATE TRUE                                                64470000
644800         WHEN SQLCODE = ZERO                                      64480000
644900              CONTINUE                                            64490000
645000         WHEN SQLCODE = +100                                      64500000
645100              SET PS-END-TRECDIS-CSR   TO TRUE                    64510000
645200         WHEN SQLCODE = -904                                      64520000
645300         WHEN SQLCODE = -911                                      64530000
645400         WHEN SQLCODE = -913                                      64540000
645500             PERFORM 9900-SOFT-ABORT                              64550000
645600         WHEN SQLWARN0 NOT = SPACE                                64560000
645700         WHEN SQLCODE NOT = ZERO                                  64570000
645800              MOVE '5930-FETCH-TRECDIS-CSR'                       64580000
645900                               TO DP013-PARAGRAPH                 64590000
646000              MOVE 'FETCH STORE CURSOR'                           64600000
646100                               TO DP013-MESSAGE-TEXT (1)          64610000
646200              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        64620000
646300              MOVE SQLCA       TO DP013-SQLCA                     64630000
646400              SET DP013-DB2-ABEND                                 64640000
646500                               TO TRUE                            64650000
646600              PERFORM DP013-0000-PROCESS-ABEND                    64660000
646700     END-EVALUATE.                                                64670000
646800                                                                  64680000
646900/                                                                 64690000
647000                                                                  64700000
647100 5940-CLOSE-TRECDIS-CSR.                                          64710000
647200                                                                  64720000
647300     EXEC SQL                                                     64730000
647400          CLOSE TRECDIS-CSR                                       64740000
647500     END-EXEC.                                                    64750000
647600                                                                  64760000
647700     EVALUATE TRUE                                                64770000
647800         WHEN SQLCODE = ZERO                                      64780000
647900             CONTINUE                                             64790000
648000         WHEN SQLWARN0 NOT = SPACES                               64800000
648100         WHEN SQLCODE < ZERO                                      64810000
648200         WHEN SQLCODE > ZERO                                      64820000
648300             MOVE '5940-CLOSE-TRECDIS-CSR'                        64830000
648400                               TO DP013-PARAGRAPH                 64840000
648500             MOVE 'CLOSE STORE CURSOR '                           64850000
648600                               TO DP013-MESSAGE-TEXT (1)          64860000
648700             MOVE SQLCA        TO DP013-SQLCA                     64870000
648800             MOVE 'TRECDIS '   TO  DP013-DB2-TABLE-NAME (1)       64880000
648900             SET DP013-DB2-ABEND                                  64890000
649000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               64900000
649100             PERFORM DP013-0000-PROCESS-ABEND                     64910000
649200     END-EVALUATE.                                                64920000
649300/                                                                 64930000
649400*----------------------------------------------------------------*64940000
649500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *64950000
649600*----------------------------------------------------------------*64960000
649700                                                                  64970000
649800 6010-DELETE-SEL-QUEUE.                                           64980000
649900                                                                  64990000
650000     EXEC CICS                                                    65000000
650100         DELETEQ TS                                               65010000
650200             QUEUE (ASC-SEL-QUEUE-NAME)                           65020000
650300             RESP  (PV-CICS-RESP)                                 65030000
650400     END-EXEC.                                                    65040000
650500                                                                  65050000
650600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      65060000
650700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         65070000
650800         CONTINUE                                                 65080000
650900     ELSE                                                         65090000
651000         SET DP013-CICS-ABEND TO TRUE                             65100000
651100         SET DP013-NO-ROLLBACK TO TRUE                            65110000
651200         MOVE '6010-DELETE-SEL-QUEUE'                             65120000
651300                        TO DP013-PARAGRAPH                        65130000
651400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         65140000
651500                        TO DP013-MESSAGE-TEXT (1)                 65150000
651600         PERFORM DP013-0000-PROCESS-ABEND                         65160000
651700     END-IF.                                                      65170000
651800                                                                  65180000
651900*----------------------------------------------------------------*65190000
652000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *65200000
652100*----------------------------------------------------------------*65210000
652200                                                                  65220000
652300 6111-WRITE-LIST-QUEUE.                                           65230000
652400                                                                  65240000
652500     EXEC CICS                                                    65250000
652600         WRITEQ TS                                                65260000
652700             QUEUE (ASC-LIST-QUEUE-NAME)                          65270000
652800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     65280000
652900             ITEM  (PV-SAVE-ITEM)                                 65290000
653000             REWRITE                                              65300000
653100             RESP  (PV-CICS-RESP)                                 65310000
653200     END-EXEC.                                                    65320000
653300                                                                  65330000
653400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          65340000
653500         CONTINUE                                                 65350000
653600     ELSE                                                         65360000
653700         SET DP013-CICS-ABEND  TO  TRUE                           65370000
653800         SET DP013-NO-ROLLBACK TO  TRUE                           65380000
653900         MOVE '6111-WRITE-LIST-QUEUE'                             65390000
654000                               TO  DP013-PARAGRAPH                65400000
654100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  65410000
654200                               TO  DP013-MESSAGE-TEXT(1)          65420000
654300         PERFORM DP013-0000-PROCESS-ABEND                         65430000
654400     END-IF.                                                      65440000
654500/                                                                 65450000
654600*----------------------------------------------------------------*65460000
654700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*65470000
654800*----------------------------------------------------------------*65480000
654900                                                                  65490000
655000 6112-READ-LIST-QUEUE.                                            65500000
655100                                                                  65510000
655200     EXEC CICS                                                    65520000
655300         READQ TS                                                 65530000
655400             QUEUE (ASC-LIST-QUEUE-NAME)                          65540000
655500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     65550000
655600             ITEM  (PV-ITEM)                                      65560000
655700             RESP  (PV-CICS-RESP)                                 65570000
655800     END-EXEC.                                                    65580000
655900                                                                  65590000
656000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          65600000
656100         CONTINUE                                                 65610000
656200     ELSE                                                         65620000
656300         SET DP013-CICS-ABEND        TO TRUE                      65630000
656400         SET DP013-NO-ROLLBACK       TO TRUE                      65640000
656500         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           65650000
656600         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    65660000
656700                                     TO DP013-MESSAGE-TEXT(1)     65670000
656800         PERFORM DP013-0000-PROCESS-ABEND                         65680000
656900     END-IF.                                                      65690000
657000/                                                                 65700000
657100******************************************************************65710000
657200 7000-CALL-VEM-MODULE.                                            65720000
657300                                                                  65730000
657400     MOVE ASC-PO-NBR               TO RC038-PO-NBR.               65740000
657500     MOVE ASC-REC-SEQ-NBR          TO RC038-REC-SEQ-NBR.          65750000
657600     MOVE LQW-PO-LNE-NBR(LQW-IDX)  TO RC038-PO-LNE-NBR.           65760000
657700     MOVE LQW-PREPK-ID(LQW-IDX)    TO RC038-PREPACK-ID.           65770000
657800     MOVE ASC-OPER-UNT-ID          TO RC038-OPER-UNT-ID.          65780000
657900     MOVE ASC-FCLTY-ID             TO RC038-FCLTY-ID.             65790000
658000     MOVE DP020-USERID             TO RC038-USER-ID.              65800000
658100     IF ASC-NOT-DC-STORE-TYPE                                     65810000
658200         SET RC038-DIRECT-STR      TO TRUE                        65820000
658300     END-IF.                                                      65830000
658400     SET RC038-PROCESS-NO-UPDATE   TO TRUE.                       65840000
658500                                                                  65850000
658600     IF ASC-PACK-BY-STORE                                         65860000
658700        SET RC038-PBS              TO TRUE                        65870000
658800     ELSE                                                         65880000
658900         IF ASC-RECEIV-PKGNG-CDE = 'M' OR 'I'                     65890000
659000            MOVE ASC-RECEIV-PKGNG-CDE                             65900000
659100                                   TO RC038-PKGNG-CDE             65910000
659200         ELSE                                                     65920000
659300            MOVE 'B'               TO RC038-PKGNG-CDE             65930000
659400         END-IF                                                   65940000
659500     END-IF.                                                      65950000
659600                                                                  65960000
659700     MOVE ASC-AUTO-VE-SW           TO RC038-AUTOVE-PO-SW.         65970000
659800                                                                  65980000
659900     MOVE LENGTH OF RC038-FIELDS         TO PV-COMMAREA-LENGTH.   65990000
660000                                                                  66000000
660100     EXEC CICS                                                    66010000
660200         LINK PROGRAM  (PC-RCKUT124)                              66020000
660300              COMMAREA (RC038-FIELDS)                             66030000
660400              LENGTH   (PV-COMMAREA-LENGTH)                       66040000
660500              RESP     (PV-CICS-RESP)                             66050000
660600     END-EXEC.                                                    66060000
660700                                                                  66070000
660800     EVALUATE TRUE                                                66080000
660900         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     66090000
661000             IF  RC038-INVALID-SQL     OR                         66100000
661100                 RC038-DATABASE-BUSY                              66110000
661200                 STRING ' RCKCS220 - '        DELIMITED BY SIZE   66120000
661300                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   66130000
661400                        RC038-SUCCESS-IND     DELIMITED BY SIZE   66140000
661500                                   INTO DP013-MESSAGE-TEXT(1)     66150000
661600                 SET DP013-CICS-ABEND        TO TRUE              66160000
661700                 SET DP013-NO-ROLLBACK       TO TRUE              66170000
661800                 MOVE '7000-CALL-VEM-MODULE' TO DP013-PARAGRAPH   66180000
661900                 PERFORM DP013-0000-PROCESS-ABEND                 66190000
662000             END-IF                                               66200000
662100         WHEN OTHER                                               66210000
662200             MOVE PV-CICS-RESP          TO PV-DISPLAY-CICS-RESP   66220000
662300             STRING ' RCKCS220 (OTHER) -' DELIMITED BY SIZE       66230000
662400                    ' CICS RESP = '       DELIMITED BY SIZE       66240000
662500                    PV-DISPLAY-CICS-RESP  DELIMITED BY SIZE       66250000
662600                               INTO DP013-MESSAGE-TEXT(1)         66260000
662700             SET DP013-CICS-ABEND        TO TRUE                  66270000
662800             SET DP013-NO-ROLLBACK       TO TRUE                  66280000
662900             MOVE '7000-CALL-VEM-MODULE' TO DP013-PARAGRAPH       66290000
663000             PERFORM DP013-0000-PROCESS-ABEND                     66300000
663100                                                                  66310000
663200     END-EVALUATE.                                                66320000
663300                                                                  66330000
663400*----------------------------------------------------------------*66340000
663500*    SELECT THE CURR OPER UNIT FROM TRECEIV                       66350000
663600* IF THE CURR OPER UNIT IS A DC BUT THE OPER-UNT-ID IS A STORE    66360000
663700* THEN WE WANT THE SWITCH TO SAY THAT THIS IS NOT A DC.           66370000
663800* 4/2002 - DEANNA BRANTER                                         66380000
663900*----------------------------------------------------------------*66390000
664000 8000-SELECT-TRECEIV.                                             66400000
664100     EXEC SQL                                                     66410000
664200          SELECT CURR_OPER_UNT_ID                                 66420000
664300           INTO :RECEIV-CURR-OPER-UNT-ID                          66430000
664400          FROM  TRECEIV                                           66440000
664500          WHERE  ORD_NBR          =  :ASC-PO-NBR                  66450000
664600          AND    REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR             66460000
664700          AND    OPER_UNT_ID      =  :ASC-OPER-UNT-ID             66470000
664800          AND    FCLTY_ID         =  :ASC-FCLTY-ID                66480000
664900          AND    VER_STATUS_CDE   =  'A'                          66490000
665000     END-EXEC.                                                    66500000
665100                                                                  66510000
665200     EVALUATE TRUE                                                66520000
665300         WHEN SQLCODE = ZERO                                      66530000
665400              MOVE RECEIV-CURR-OPER-UNT-ID TO PV-OPER-UNT-ID      66540000
665500              PERFORM 8100-CHECK-OPER                             66550000
665600              IF PS-OPER-UNT-IS-DC AND                            66560000
665700                 ASC-OPER-UNT-ID NOT = RECEIV-CURR-OPER-UNT-ID    66570000
665800                    MOVE ASC-OPER-UNT-ID TO PV-OPER-UNT-ID        66580000
665900                    PERFORM 8100-CHECK-OPER                       66590000
666000              END-IF                                              66600000
666100         WHEN SQLCODE = +100                                      66610000
666200              SET PS-OPER-UNT-NOT-DC TO  TRUE                     66620000
666300         WHEN SQLCODE = -904                                      66630000
666400         WHEN SQLCODE = -911                                      66640000
666500         WHEN SQLCODE = -913                                      66650000
666600              PERFORM 9900-SOFT-ABORT                             66660000
666700         WHEN SQLWARN0 NOT = SPACE                                66670000
666800         WHEN SQLCODE NOT = ZERO                                  66680000
666900              MOVE '8000-SELECT-TRECEIV' TO DP013-PARAGRAPH       66690000
667000              MOVE 'SELECT TRECEIV'                               66700000
667100                               TO DP013-MESSAGE-TEXT (1)          66710000
667200              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        66720000
667300              MOVE SQLCA       TO DP013-SQLCA                     66730000
667400              SET DP013-DB2-ABEND                                 66740000
667500                               TO TRUE                            66750000
667600              PERFORM DP013-0000-PROCESS-ABEND                    66760000
667700     END-EVALUATE.                                                66770000
667800                                                                  66780000
667900*----------------------------------------------------------------*66790000
668000*  CHECK RECEIV-CURR-OPER-UNT-ID TO MAKE SURE IT IS A DC.         66800000
668100*  THIS WAS CHANGED TO ALSO CHECK THE OPER-UNT-ID FIELD DUE TO    66810000
668200*  DIRECT TO STORE ORDERS WHICH WE DON'T WANT TO INCLUDE ON THE   66820000
668300*  UNITS WORKED TABLES.                                           66830000
668400*  4/2002 - DEANNA BRANTNER                                       66840000
668500*----------------------------------------------------------------*66850000
668600 8100-CHECK-OPER.                                                 66860000
668700     EXEC SQL                                                     66870000
668800          SELECT LOC_TYP_CDE                                      66880000
668900            INTO :XLT00010-LOC-TYP-CDE                            66890000
669000            FROM XLT_LOC                                          66900000
669100          WHERE LOC_NBR  =  :PV-OPER-UNT-ID                       66910000
669200      END-EXEC.                                                   66920000
669300                                                                  66930000
669400     EVALUATE TRUE                                                66940000
669500         WHEN SQLCODE = ZERO                                      66950000
669600              IF XLT00010-LOC-TYP-CDE = 'DC'                      66960000
669700                  SET PS-OPER-UNT-IS-DC TO TRUE                   66970000
669800              ELSE                                                66980000
669900                  SET PS-OPER-UNT-NOT-DC TO TRUE                  66990000
670000              END-IF                                              67000000
670100         WHEN SQLCODE = +100                                      67010000
670200              SET PS-OPER-UNT-NOT-DC TO TRUE                      67020000
670300         WHEN SQLCODE = -904                                      67030000
670400         WHEN SQLCODE = -911                                      67040000
670500         WHEN SQLCODE = -913                                      67050000
670600              PERFORM 9900-SOFT-ABORT                             67060000
670700         WHEN SQLWARN0 NOT = SPACE                                67070000
670800         WHEN SQLCODE NOT = ZERO                                  67080000
670900              MOVE '8100-CHECK-OPER'  TO DP013-PARAGRAPH          67090000
671000              MOVE 'SELECT XLT_LOC'                               67100000
671100                               TO DP013-MESSAGE-TEXT (1)          67110000
671200              MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)        67120000
671300              MOVE SQLCA       TO DP013-SQLCA                     67130000
671400              SET DP013-DB2-ABEND TO TRUE                         67140000
671500              PERFORM DP013-0000-PROCESS-ABEND                    67150000
671600     END-EVALUATE.                                                67160000
671700                                                                  67170000
671800*----------------------------------------------------------------*67180000
671900*    CALL THE UNITS WORKED UPDATE MODULE PCKCS756                 67190000
672000*----------------------------------------------------------------*67200000
672100 8500-UPDATE-UNITS-WRKD.                                          67210000
672200* THIS WILL CALL PCKCS756 WHICH WILL UPDATE THE TABLES FOR UNITS  67220000
672300* WORKED OR VERIFIED                                              67230000
672400                                                                  67240000
672500     EXEC SQL                                                     67250000
672600         SET :PV-CURRENT-TIMESTAMP =  CURRENT_TIMESTAMP           67260000
672700     END-EXEC.                                                    67270000
672800                                                                  67280000
672900     MOVE PV-CURRENT-TIMESTAMP        TO PC238-WRKD-TMST.         67290000
673000     MOVE RECEIV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.  67300000
673100     MOVE ASC-PO-NBR                  TO PC238-PO-NBR.            67310000
673200     MOVE ASC-REC-SEQ-NBR             TO PC238-RCVR-SEQ-NBR.      67320000
673300     IF PC238-TRANS-TYPE-CDE = 'W'  OR 'Y'                        67330000
673400         MOVE ZEROES                  TO PC238-PO-LNE-NBR         67340000
673500     ELSE                                                         67350000
673600         MOVE RECDIS-ORD-LNE-NBR      TO PC238-PO-LNE-NBR         67360000
673700     END-IF.                                                      67370000
673800     MOVE SPACES                      TO PC238-PRCG-AREA-CDE.     67380000
673900     MOVE 'M'                         TO PC238-VERIFY-TYPE-CDE.   67390000
674000     MOVE LENGTH OF PC238-COMM-AREA   TO PV-COMMAREA-LENGTH.      67400000
674100                                                                  67410000
674200     EXEC CICS                                                    67420000
674300         LINK                                                     67430000
674400             PROGRAM   (PC-UNTS-WRKD-PGRM-NAME)                   67440000
674500             COMMAREA  (PC238-COMM-AREA)                          67450000
674600             LENGTH    (PV-COMMAREA-LENGTH)                       67460000
674700             RESP      (PV-CICS-RESP)                             67470000
674800     END-EXEC.                                                    67480000
674900                                                                  67490000
675000     EVALUATE TRUE                                                67500000
675100         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     67510000
675200              EVALUATE TRUE                                       67520000
675300                  WHEN PC238-MOD-SUCCESSFUL                       67530000
675400                       CONTINUE                                   67540000
675500                 WHEN PC238-MOD-UNSUCCESSFUL                      67550000
675600                     MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER     67560000
675700                     SET DP020-MSG-FATAL TO TRUE                  67570000
675800                     SET PS-ERROR TO TRUE                         67580000
675900                     PERFORM 8600-MOD-UNSUCCESSFUL                67590000
676000             END-EVALUATE                                         67600000
676100         WHEN OTHER                                               67610000
676200             MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER             67620000
676300             SET DP020-MSG-FATAL TO TRUE                          67630000
676400             SET PS-ERROR TO TRUE                                 67640000
676500     END-EVALUATE.                                                67650000
676600                                                                  67660000
676700 8600-MOD-UNSUCCESSFUL.                                           67670000
676800                                                                  67680000
676900     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             67690000
677000     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           67700000
677100     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           67710000
677200     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           67720000
677300     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE        67730000
677400                                       SQLCODE.                   67740000
677500     SET  PS-UNITS-WORKED-ERROR                                   67750000
677600          PS-UPDATES-DONE           TO TRUE.                      67760000
677700                                                                  67770000
677800     IF  PC238-MOD-BAD-TMST                                       67780000
677900         STRING ' RCKCS220 - '      DELIMITED BY SIZE             67790000
678000                ' 8500-UPDATE-UNITS-WRKD '                        67800000
678100                                    DELIMITED BY SIZE             67810000
678200                ' BAD TIMESTAMP '   DELIMITED BY SIZE             67820000
678300                PC238-WRKD-TMST     DELIMITED BY SIZE             67830000
678400                             INTO PV-CICS-MSG-AREA                67840000
678500         MOVE LENGTH OF PV-CICS-MSG-AREA                          67850000
678600                               TO PV-COMMAREA-LENGTH              67860000
678700         PERFORM 9200-WRITE-TO-CICS-LOG                           67870000
678800         STRING ' RCKCS220 - '      DELIMITED BY SIZE             67880000
678900                ' 8500-UPDATE-UNITS-WRKD '                        67890000
679000                                    DELIMITED BY SIZE             67900000
679100                ' KEY INFO - '      DELIMITED BY SIZE             67910000
679200                PC-DISPLAY-PO       DELIMITED BY SIZE             67920000
679300                ' - '               DELIMITED BY SIZE             67930000
679400                PC-DISPLAY-RCVR     DELIMITED BY SIZE             67940000
679500                ' - '               DELIMITED BY SIZE             67950000
679600                PC-DISPLAY-LINE     DELIMITED BY SIZE             67960000
679700                             INTO PV-CICS-MSG-AREA                67970000
679800         MOVE LENGTH OF PV-CICS-MSG-AREA                          67980000
679900                               TO PV-COMMAREA-LENGTH              67990000
680000         PERFORM 9200-WRITE-TO-CICS-LOG                           68000000
680100         PERFORM 9900-SOFT-ABORT                                  68010000
680200     ELSE                                                         68020000
680300     IF  PC238-MOD-BAD-OPER                                       68030000
680400         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68040000
680500                ' 8500-UPDATE-UNITS-WRKD '                        68050000
680600                                    DELIMITED BY SIZE             68060000
680700                ' BAD OPER UNIT '   DELIMITED BY SIZE             68070000
680800                PC-DISPLAY-OPER     DELIMITED BY SIZE             68080000
680900                             INTO PV-CICS-MSG-AREA                68090000
681000         MOVE LENGTH OF PV-CICS-MSG-AREA                          68100000
681100                               TO PV-COMMAREA-LENGTH              68110000
681200         PERFORM 9200-WRITE-TO-CICS-LOG                           68120000
681300         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68130000
681400                ' 8500-UPDATE-UNITS-WRKD '                        68140000
681500                                    DELIMITED BY SIZE             68150000
681600                ' KEY INFO - '      DELIMITED BY SIZE             68160000
681700                PC-DISPLAY-PO       DELIMITED BY SIZE             68170000
681800                ' - '               DELIMITED BY SIZE             68180000
681900                PC-DISPLAY-RCVR     DELIMITED BY SIZE             68190000
682000                ' - '               DELIMITED BY SIZE             68200000
682100                PC-DISPLAY-LINE     DELIMITED BY SIZE             68210000
682200                             INTO PV-CICS-MSG-AREA                68220000
682300         MOVE LENGTH OF PV-CICS-MSG-AREA                          68230000
682400                               TO PV-COMMAREA-LENGTH              68240000
682500         PERFORM 9200-WRITE-TO-CICS-LOG                           68250000
682600         PERFORM 9900-SOFT-ABORT                                  68260000
682700     ELSE                                                         68270000
682800     IF  PC238-MOD-BAD-TRANS-TYPE                                 68280000
682900         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68290000
683000                ' 8500-UPDATE-UNITS-WRKD '                        68300000
683100                                    DELIMITED BY SIZE             68310000
683200                ' BAD TRAN TYPE '   DELIMITED BY SIZE             68320000
683300                PC238-TRANS-TYPE-CDE                              68330000
683400                                    DELIMITED BY SIZE             68340000
683500                             INTO PV-CICS-MSG-AREA                68350000
683600         MOVE LENGTH OF PV-CICS-MSG-AREA                          68360000
683700                               TO PV-COMMAREA-LENGTH              68370000
683800         PERFORM 9200-WRITE-TO-CICS-LOG                           68380000
683900         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68390000
684000                ' 8500-UPDATE-UNITS-WRKD '                        68400000
684100                                    DELIMITED BY SIZE             68410000
684200                ' KEY INFO - '      DELIMITED BY SIZE             68420000
684300                PC-DISPLAY-PO       DELIMITED BY SIZE             68430000
684400                ' - '               DELIMITED BY SIZE             68440000
684500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             68450000
684600                ' - '               DELIMITED BY SIZE             68460000
684700                PC-DISPLAY-LINE     DELIMITED BY SIZE             68470000
684800                             INTO PV-CICS-MSG-AREA                68480000
684900         MOVE LENGTH OF PV-CICS-MSG-AREA                          68490000
685000                               TO PV-COMMAREA-LENGTH              68500000
685100         PERFORM 9200-WRITE-TO-CICS-LOG                           68510000
685200         PERFORM 9900-SOFT-ABORT                                  68520000
685300     ELSE                                                         68530000
685400     IF  PC238-MOD-BAD-PO                                         68540000
685500         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68550000
685600                ' 8500-UPDATE-UNITS-WRKD '                        68560000
685700                                    DELIMITED BY SIZE             68570000
685800                ' BAD PO NUMBER '   DELIMITED BY SIZE             68580000
685900                PC-DISPLAY-PO       DELIMITED BY SIZE             68590000
686000                             INTO PV-CICS-MSG-AREA                68600000
686100         MOVE LENGTH OF PV-CICS-MSG-AREA                          68610000
686200                               TO PV-COMMAREA-LENGTH              68620000
686300         PERFORM 9200-WRITE-TO-CICS-LOG                           68630000
686400         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68640000
686500                ' 8500-UPDATE-UNITS-WRKD '                        68650000
686600                                    DELIMITED BY SIZE             68660000
686700                ' KEY INFO - '      DELIMITED BY SIZE             68670000
686800                PC-DISPLAY-PO       DELIMITED BY SIZE             68680000
686900                ' - '               DELIMITED BY SIZE             68690000
687000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             68700000
687100                ' - '               DELIMITED BY SIZE             68710000
687200                PC-DISPLAY-LINE     DELIMITED BY SIZE             68720000
687300                             INTO PV-CICS-MSG-AREA                68730000
687400         MOVE LENGTH OF PV-CICS-MSG-AREA                          68740000
687500                               TO PV-COMMAREA-LENGTH              68750000
687600         PERFORM 9200-WRITE-TO-CICS-LOG                           68760000
687700         PERFORM 9900-SOFT-ABORT                                  68770000
687800     ELSE                                                         68780000
687900     IF  PC238-MOD-BAD-RCVR                                       68790000
688000         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68800000
688100                ' 8500-UPDATE-UNITS-WRKD '                        68810000
688200                                    DELIMITED BY SIZE             68820000
688300                ' BAD RCVR NBR  '   DELIMITED BY SIZE             68830000
688400                PC-DISPLAY-RCVR     DELIMITED BY SIZE             68840000
688500                             INTO PV-CICS-MSG-AREA                68850000
688600         MOVE LENGTH OF PV-CICS-MSG-AREA                          68860000
688700                               TO PV-COMMAREA-LENGTH              68870000
688800         PERFORM 9200-WRITE-TO-CICS-LOG                           68880000
688900         STRING ' RCKCS220 - '      DELIMITED BY SIZE             68890000
689000                ' 8500-UPDATE-UNITS-WRKD '                        68900000
689100                                    DELIMITED BY SIZE             68910000
689200                ' KEY INFO - '      DELIMITED BY SIZE             68920000
689300                PC-DISPLAY-PO       DELIMITED BY SIZE             68930000
689400                ' - '               DELIMITED BY SIZE             68940000
689500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             68950000
689600                ' - '               DELIMITED BY SIZE             68960000
689700                PC-DISPLAY-LINE     DELIMITED BY SIZE             68970000
689800                             INTO PV-CICS-MSG-AREA                68980000
689900         MOVE LENGTH OF PV-CICS-MSG-AREA                          68990000
690000                               TO PV-COMMAREA-LENGTH              69000000
690100         PERFORM 9200-WRITE-TO-CICS-LOG                           69010000
690200         PERFORM 9900-SOFT-ABORT                                  69020000
690300     ELSE                                                         69030000
690400     IF  PC238-MOD-BAD-LINE                                       69040000
690500         STRING ' RCKCS220 - '      DELIMITED BY SIZE             69050000
690600                ' 8500-UPDATE-UNITS-WRKD '                        69060000
690700                                    DELIMITED BY SIZE             69070000
690800                ' BAD LINE NBR  '   DELIMITED BY SIZE             69080000
690900                PC-DISPLAY-LINE     DELIMITED BY SIZE             69090000
691000                             INTO PV-CICS-MSG-AREA                69100000
691100         MOVE LENGTH OF PV-CICS-MSG-AREA                          69110000
691200                               TO PV-COMMAREA-LENGTH              69120000
691300         PERFORM 9200-WRITE-TO-CICS-LOG                           69130000
691400         STRING ' RCKCS220 - '      DELIMITED BY SIZE             69140000
691500                ' 8500-UPDATE-UNITS-WRKD '                        69150000
691600                                    DELIMITED BY SIZE             69160000
691700                ' KEY INFO - '      DELIMITED BY SIZE             69170000
691800                PC-DISPLAY-PO       DELIMITED BY SIZE             69180000
691900                ' - '               DELIMITED BY SIZE             69190000
692000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             69200000
692100                ' - '               DELIMITED BY SIZE             69210000
692200                PC-DISPLAY-LINE     DELIMITED BY SIZE             69220000
692300                             INTO PV-CICS-MSG-AREA                69230000
692400         MOVE LENGTH OF PV-CICS-MSG-AREA                          69240000
692500                               TO PV-COMMAREA-LENGTH              69250000
692600         PERFORM 9200-WRITE-TO-CICS-LOG                           69260000
692700         PERFORM 9900-SOFT-ABORT                                  69270000
692800     ELSE                                                         69280000
692900     IF  PC238-MOD-BAD-NO-SHIFT                                   69290000
693000         STRING ' RCKCS220 - '      DELIMITED BY SIZE             69300000
693100                ' 8500-UPDATE-UNITS-WRKD '                        69310000
693200                                    DELIMITED BY SIZE             69320000
693300                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             69330000
693400                PC238-WRKD-TMST     DELIMITED BY SIZE             69340000
693500                ' FOR OPER '        DELIMITED BY SIZE             69350000
693600                PC-DISPLAY-OPER     DELIMITED BY SIZE             69360000
693700                             INTO PV-CICS-MSG-AREA                69370000
693800         MOVE LENGTH OF PV-CICS-MSG-AREA                          69380000
693900                               TO PV-COMMAREA-LENGTH              69390000
694000         PERFORM 9200-WRITE-TO-CICS-LOG                           69400000
694100         STRING ' RCKCS220 - '      DELIMITED BY SIZE             69410000
694200                ' 8500-UPDATE-UNITS-WRKD '                        69420000
694300                                    DELIMITED BY SIZE             69430000
694400                ' KEY INFO - '      DELIMITED BY SIZE             69440000
694500                PC-DISPLAY-PO       DELIMITED BY SIZE             69450000
694600                ' - '               DELIMITED BY SIZE             69460000
694700                PC-DISPLAY-RCVR     DELIMITED BY SIZE             69470000
694800                ' - '               DELIMITED BY SIZE             69480000
694900                PC-DISPLAY-LINE     DELIMITED BY SIZE             69490000
695000                             INTO PV-CICS-MSG-AREA                69500000
695100         MOVE LENGTH OF PV-CICS-MSG-AREA                          69510000
695200                               TO PV-COMMAREA-LENGTH              69520000
695300         PERFORM 9200-WRITE-TO-CICS-LOG                           69530000
695400         PERFORM 9900-SOFT-ABORT                                  69540000
695500     ELSE                                                         69550000
695600         STRING ' RCKCS220 - '      DELIMITED BY SIZE             69560000
695700                ' 8500-UPDATE-UNITS-WRKD '                        69570000
695800                                    DELIMITED BY SIZE             69580000
695900                ' DB ERROR - SQL CODE '                           69590000
696000                                    DELIMITED BY SIZE             69600000
696100                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             69610000
696200                ' FUNC: '           DELIMITED BY SIZE             69620000
696300                PC238-BAD-TABLE-FUNCTION                          69630000
696400                                    DELIMITED BY SIZE             69640000
696500                ' TABLE: '          DELIMITED BY SIZE             69650000
696600                PC238-BAD-TABLE-NAME                              69660000
696700                                    DELIMITED BY SIZE             69670000
696800                             INTO PV-CICS-MSG-AREA                69680000
696900         MOVE LENGTH OF PV-CICS-MSG-AREA                          69690000
697000                               TO PV-COMMAREA-LENGTH              69700000
697100         PERFORM 9200-WRITE-TO-CICS-LOG                           69710000
697200         STRING ' RCKCS220 - '      DELIMITED BY SIZE             69720000
697300                ' 8500-UPDATE-UNITS-WRKD '                        69730000
697400                                    DELIMITED BY SIZE             69740000
697500                ' KEY INFO - '      DELIMITED BY SIZE             69750000
697600                PC-DISPLAY-PO       DELIMITED BY SIZE             69760000
697700                ' - '               DELIMITED BY SIZE             69770000
697800                PC-DISPLAY-RCVR     DELIMITED BY SIZE             69780000
697900                ' - '               DELIMITED BY SIZE             69790000
698000                PC-DISPLAY-LINE     DELIMITED BY SIZE             69800000
698100                             INTO PV-CICS-MSG-AREA                69810000
698200         MOVE LENGTH OF PV-CICS-MSG-AREA                          69820000
698300                               TO PV-COMMAREA-LENGTH              69830000
698400         PERFORM 9200-WRITE-TO-CICS-LOG                           69840000
698500         PERFORM 9900-SOFT-ABORT                                  69850000
698600     END-IF                                                       69860000
698700     END-IF                                                       69870000
698800     END-IF                                                       69880000
698900     END-IF                                                       69890000
699000     END-IF                                                       69900000
699100     END-IF                                                       69910000
699200     END-IF.                                                      69920000
699300                                                                  69930000
699400 9000-CALL-PO-RCVR-TRKING-MOD.                                    69940000
699500                                                                  69950000
699600     INITIALIZE RC071-FIELDS.                                     69960000
699700     MOVE ASC-PO-NBR                TO RC071-PO-NBR               69970000
699800     MOVE ASC-REC-SEQ-NBR           TO RC071-PO-RCVR              69980000
699900     MOVE ZERO                      TO RC071-PREPK-ID             69990000
700000*    IF ASC-PACK-BY-STORE                                         70000000
700100*       MOVE ZERO                   TO RC071-PO-LINE              70010000
700200*    ELSE                                                         70020000
700300        MOVE LQW-PO-LNE-NBR(LQW-IDX)   TO RC071-PO-LINE           70030000
700400*    END-IF                                                       70040000
700500     MOVE ASC-OPER-UNT-ID           TO RC071-SIGNON-LOCATION      70050000
700600     MOVE DP020-USERID              TO RC071-USER-ID              70060000
700700     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      70070000
700800     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    70080000
700900         MOVE '17'                      TO RC071-DC-FUNCTION-CODE 70090000
701000     ELSE                                                         70100000
701100         IF ASC-CONFIRM-UNVERIFY                                  70110000
701200             MOVE '19'                  TO RC071-DC-FUNCTION-CODE 70120000
701300         ELSE                                                     70130000
701400             MOVE '18'                  TO RC071-DC-FUNCTION-CODE 70140000
701500         END-IF                                                   70150000
701600     END-IF.                                                      70160000
701700                                                                  70170000
701800     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        70180000
701900                                                                  70190000
702000     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  70200000
702100                                        RC071-COMMAREA            70210000
702200                                        RC071-FIELDS.             70220000
702300                                                                  70230000
702400     IF RC071-SUCCESSFUL                                          70240000
702500         CONTINUE                                                 70250000
702600     ELSE                                                         70260000
702700         MOVE '9000-CALL-PO-RCVR-TRKING-MOD'                      70270000
702800                                 TO DP013-PARAGRAPH               70280000
702900         MOVE ASC-PO-NBR          TO PC-DISPLAY-PO                70290000
703000         MOVE ASC-REC-SEQ-NBR     TO PC-DISPLAY-RCVR              70300000
703100         MOVE ASC-OPER-UNT-ID     TO PC-DISPLAY-OPER              70310000
703200         MOVE RC071-PO-LINE       TO PC-DISPLAY-LINE              70320000
703300         STRING ' RCKCS220-RC137'   DELIMITED BY SIZE             70330000
703400                ' RCVR: '           DELIMITED BY SIZE             70340000
703500                PC-DISPLAY-PO       DELIMITED BY SIZE             70350000
703600                '-'                 DELIMITED BY SIZE             70360000
703700                PC-DISPLAY-RCVR                                   70370000
703800                                    DELIMITED BY SIZE             70380000
703900                '  LINE: '          DELIMITED BY SIZE             70390000
704000                PC-DISPLAY-LINE                                   70400000
704100                                    DELIMITED BY SIZE             70410000
704200                '  FCLTY: '         DELIMITED BY SIZE             70420000
704300                PC-DISPLAY-OPER                                   70430000
704400                                    DELIMITED BY SIZE             70440000
704500                                 INTO PV-CICS-MSG-AREA            70450000
704600         MOVE LENGTH OF PV-CICS-MSG-AREA                          70460000
704700                                   TO PV-COMMAREA-LENGTH          70470000
704800         PERFORM 9200-WRITE-TO-CICS-LOG                           70480000
704900         MOVE 'UNSUCCESSFUL CALL TO TRACKING MOD'                 70490000
705000                                     TO DP013-MESSAGE-TEXT (1)    70500000
705100         MOVE RC071-CRA-RET-MSG      TO DP013-MESSAGE-TEXT (2)    70510000
705200         STRING ' OPER: '            DELIMITED BY SIZE            70520000
705300              PC-DISPLAY-OPER        DELIMITED BY SIZE            70530000
705400                ' RCVR: '            DELIMITED BY SIZE            70540000
705500              PC-DISPLAY-PO          DELIMITED BY SIZE            70550000
705600              '-'                    DELIMITED BY SIZE            70560000
705700              PC-DISPLAY-RCVR        DELIMITED BY SIZE            70570000
705800              ' IND: '               DELIMITED BY SIZE            70580000
705900              RC071-SUCCESS-IND      DELIMITED BY SIZE            70590000
706000                               INTO DP013-MESSAGE-TEXT (3)        70600000
706100         STRING ' LINE: '            DELIMITED BY SIZE            70610000
706200              PC-DISPLAY-LINE        DELIMITED BY SIZE            70620000
706300                               INTO DP013-MESSAGE-TEXT (4)        70630000
706400         MOVE '9000-CALL-PO-RCVR-TRKING-MOD'                      70640000
706500                                   TO DP013-PARAGRAPH             70650000
706600         SET DP013-XCTL-DISPLAY-RESTART                           70660000
706700             DP013-DB2-ABEND     TO TRUE                          70670000
706800         SET PS-ERROR                    TO TRUE                  70680000
706900         PERFORM DP013-0000-PROCESS-ABEND                         70690000
707000                                                                  70700000
707100      END-IF.                                                     70710000
707200                                                                  70720000
707300*----------------------------------------------------------------*70730000
707400 9200-WRITE-TO-CICS-LOG.                                          70740000
707500                                                                  70750000
707510     MOVE LENGTH OF PV-CICS-MSG-AREA                              70751005
707520                               TO PV-COMMAREA-LENGTH.             70752005
707530                                                                  70753005
707600     EXEC CICS                                                    70760000
707700          WRITEQ TD                                               70770000
707800          QUEUE  ('CSSL')                                         70780000
707900          FROM  (PV-CICS-MSG-AREA)                                70790000
708000          LENGTH  (PV-COMMAREA-LENGTH)                            70800000
708100          RESP  (PV-CICS-RESP)                                    70810000
708200     END-EXEC.                                                    70820000
708300                                                                  70830000
708400     MOVE SPACES TO PV-CICS-MSG-AREA.                             70840000
708500                                                                  70850000
708600******************************************************************70860000
708700*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *70870000
708800*    AND THE ERROR SWITCHES.                                     *70880000
708900******************************************************************70890000
709000 9900-SOFT-ABORT.                                                 70900000
709100     SET PS-ERROR         TO TRUE.                                70910000
709200     SET DP020-MSG-FATAL  TO TRUE.                                70920000
709300     IF SQLCODE = -913                                            70930000
709400         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 70940000
709500     END-IF.                                                      70950000
709600     IF PS-NO-NEXT-SCREEN                                         70960000
709700        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     70970000
709800     END-IF.                                                      70980000
709900*    IF PS-UPDATES-DONE AND SQLCODE = -913                        70990000
710000     IF PS-UPDATES-DONE                                           71000000
710100        PERFORM 9901-BACKUP                                       71010000
710200     END-IF.                                                      71020000
710300     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          71030000
710400     PERFORM 0001-CALL-CICS-ARCH-API.                             71040000
710500                                                                  71050000
710600 9901-BACKUP.                                                     71060000
710700     EXEC CICS SYNCPOINT                                          71070000
710800          ROLLBACK                                                71080000
710900     END-EXEC.                                                    71090000
711000                                                                  71100000
711100/                                                                 71110000
711200*----------------------------------------------------------------*71120000
711300*    ABEND PROCESSOR MODULE                                      *71130000
711400*----------------------------------------------------------------*71140000
711500                                                                  71150000
711600     COPY DPPD013.                                                71160000
