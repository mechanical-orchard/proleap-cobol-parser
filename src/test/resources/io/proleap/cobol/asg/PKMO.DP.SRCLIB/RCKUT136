000100******************************************************************00010044
000200 IDENTIFICATION DIVISION.                                         00020044
000300******************************************************************00030044
000400                                                                  00040044
000500 PROGRAM-ID.             RCKUT136.                                00050044
000600 AUTHOR.                 GERMAN BANDA.                            00060044
000700 INSTALLATION.           KOHLS.                                   00070044
000800 DATE-WRITTEN            APRIL, 2004.                             00080044
000900 DATE-COMPILED.                                                   00090044
001000                                                                  00100044
001100******************************************************************00110044
001200* THIS PROGRAM WILL BE CALLED WHEN VERIFYING PURCHASE ORDERS BY   00120044
001300* RECEIVER. THE PROGRAM WILL DETERMINE THE LINES TO PROCESS, AND  00130044
001400* CALL THE CONFIRMATION MODULE(RCKUT125) FOR EACH LINE.           00140044
001500******************************************************************00150044
001600                                                                  00160044
001700******************************************************************00170044
001800 ENVIRONMENT DIVISION.                                            00180044
001900******************************************************************00190044
002000                                                                  00200044
002100******************************************************************00210044
002200 DATA DIVISION.                                                   00220044
002300******************************************************************00230044
002400                                                                  00240044
002500******************************************************************00250044
002600 WORKING-STORAGE SECTION.                                         00260044
002700******************************************************************00270044
002800                                                                  00280044
002900*                                                                 00290044
003000     COPY RCWS041.                                                00300044
003100*---------------------------------------------------------------* 00310044
003200*    LAYOUT FOR THE CALLED DATE ROUTINE - DPKUT500              * 00320044
003300*---------------------------------------------------------------* 00330044
003400     COPY DPWS500.                                                00340044
003500                                                                  00350044
003600 01  DK-DB2-KEYS.                                                 00360044
003700     05  DK-PO-NBR                       PIC S9(09) COMP SYNC.    00370044
003800     05  DK-RCVR-NBR                     PIC S9(09) COMP SYNC.    00380044
003900     05  DK-LINE-NBR                     PIC S9(09) COMP SYNC.    00390044
004000     05  DK-PREPK-ID                     PIC S9(04) COMP SYNC.    00400044
004100     05  DK-AUDIT-LINE                   PIC S9(04) COMP SYNC.    00410044
004200     05  DK-AUDIT-PREPACK                PIC S9(09) COMP SYNC.    00420044
004300     05  DK-OPER-UNT-ID                  PIC S9(04) COMP SYNC.    00430044
004400     05  DK-FCLTY-ID                     PIC S9(04) COMP SYNC.    00440044
004500     05  DK-STR-NBR                      PIC S9(04) COMP.         00450044
004600     05  DK-IN-PROCESS-STR-NBR           PIC S9(04) COMP.         00460044
004700                                                                  00470044
004800 01  PC-PROGRAM-CONSTANTS.                                        00480044
004900     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00490044
005000                     '9999-09-09-09.09.09.999999'.                00500044
005100     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00510044
005200                     '9999-09-09'.                                00520044
005300     05  PC-DEFAULT-TIME              PIC X(26)  VALUE            00530044
005400                     '01.01.01'.                                  00540044
005500     05  PC-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00550044
005600                                                     COMP SYNC.   00560044
005700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'RCKUT136'. 00570044
005800     05  PC-FULLCASE-CONFIRM-PGM      PIC X(08)  VALUE 'RCKUT125'.00580044
005900     05  PC-VERIF-HOT-COMPLETE        PIC X(08)  VALUE 'PCKCS161'.00590044
006000                                                                  00600044
006100 01  PS-PROGRAM-SWITCHES.                                         00610044
006200     05  PS-MORE-STORE-SW               PIC X(01)   VALUE 'N'.    00620044
006300         88  PS-MORE-STORE                          VALUE 'Y'.    00630044
006400         88  PS-NO-MORE-STORE                       VALUE 'N'.    00640044
006500     05  PS-MORE-RECITM-LINES-SW        PIC X(01)   VALUE 'N'.    00650044
006600         88  PS-MORE-RECITM-LINES                   VALUE 'Y'.    00660044
006700         88  PS-NO-MORE-RECITM-LINES                VALUE 'N'.    00670044
006800     05  PS-MORE-RECDIS-LINES-SW        PIC X(01)   VALUE 'N'.    00680044
006900         88  PS-MORE-RECDIS-LINES                   VALUE 'Y'.    00690044
007000         88  PS-NO-MORE-RECDIS-LINES                VALUE 'N'.    00700044
007100     05  PS-MORE-DISTRO-SW              PIC X(01)   VALUE 'N'.    00710044
007200         88  PS-MORE-DISTRO                         VALUE 'Y'.    00720044
007300         88  PS-NO-MORE-DISTRO                      VALUE 'N'.    00730044
007400     05  PS-IN-TROUBLE-SW               PIC X(01)   VALUE 'N'.    00740044
007500         88  PS-IN-TROUBLE                          VALUE 'Y'.    00750044
007600         88  PS-NOT-IN-TROUBLE                      VALUE 'N'.    00760044
007700     05  PS-INVENTORY-CYCLE-SW          PIC X(01)   VALUE 'N'.    00770044
007800         88  PS-INVENTORY-CYCLE                     VALUE 'Y'.    00780044
007900         88  PS-NO-INVENTORY-CYCLE                  VALUE 'N'.    00790044
008000     05  PS-FREIGHT-BILL-FOUND-SW       PIC X(01)   VALUE 'N'.    00800044
008100         88  PS-FREIGHT-BILL-FOUND                  VALUE 'Y'.    00810044
008200         88  PS-NO-FREIGHT-BILL-FOUND               VALUE 'N'.    00820044
008300     05  PS-RECDIS-FOUND-SW             PIC X(01)   VALUE 'N'.    00830044
008400         88  PS-RECDIS-FOUND                        VALUE 'Y'.    00840044
008500         88  PS-NO-RECDIS-FOUND                     VALUE 'N'.    00850044
008600     05  PS-DISTHD-FOUND-SW             PIC X(01)   VALUE 'N'.    00860044
008700         88  PS-DISTHD-FOUND                        VALUE 'Y'.    00870044
008800         88  PS-NO-DISTHD-FOUND                     VALUE 'N'.    00880044
008900     05  PS-MORE-PACKS-SW               PIC X(01)   VALUE 'N'.    00890044
009000         88  PS-MORE-PACKS                          VALUE 'Y'.    00900044
009100         88  PS-NO-MORE-PACKS                       VALUE 'N'.    00910044
009200     05  PS-ACTIVE-RECEIVER-SW          PIC X(01)   VALUE 'N'.    00920044
009300         88  PS-ACTIVE-RECEIVER                     VALUE 'Y'.    00930044
009400         88  PS-NO-ACTIVE-RECEIVER                  VALUE 'N'.    00940044
009500     05  PS-ACTIVE-LINE-SW              PIC X(01)   VALUE 'N'.    00950044
009600         88  PS-ACTIVE-LINE                         VALUE 'Y'.    00960044
009700         88  PS-NO-ACTIVE-LINE                      VALUE 'N'.    00970044
009800     05  PS-OPEN-AUDITS-SW              PIC X(01)   VALUE 'N'.    00980044
009900         88  PS-OPEN-AUDITS                         VALUE 'Y'.    00990044
010000         88  PS-NO-OPEN-AUDITS                      VALUE 'N'.    01000044
010100     05  PS-STR-INV-CYCLE-SW            PIC X(01)   VALUE 'N'.    01010044
010200         88  PS-STR-IN-INV-CYCLE                    VALUE 'Y'.    01020044
010300         88  PS-STR-NOT-IN-INV-CYCLE                VALUE 'N'.    01030044
010400     05  PS-ERROR-SW                    PIC X(01)   VALUE 'Y'.    01040044
010500         88  PS-NO-ERROR                            VALUE 'Y'.    01050044
010600         88  PS-ERROR                               VALUE 'N'.    01060044
010700     05  PS-ARRIVED-SW                  PIC X(01)   VALUE 'Y'.    01070044
010800         88  PS-ARRIVED                             VALUE 'Y'.    01080044
010900         88  PS-NOT-ARRIVED                         VALUE 'N'.    01090044
011000     05  PS-UNITS-WORKED-ERROR-SW       PIC X(01)   VALUE 'N'.    01100044
011100         88  PS-UNITS-WORKED-ERROR                  VALUE 'Y'.    01110044
011200         88  PS-NO-UNITS-WORKED-ERROR               VALUE 'N'.    01120044
011300     05  PS-VERIFY-MODULE-SW            PIC X(01)   VALUE 'N'.    01130044
011400         88  PS-DONT-SUBMIT-E200                    VALUE 'N'.    01140044
011500         88  PS-DO-SUBMIT-E200                      VALUE 'Y'.    01150044
011600     05  PS-MORE-RECITM-SW              PIC X(01)   VALUE 'N'.    01160044
011700         88  PS-MORE-RECITM-YES                     VALUE 'Y'.    01170044
011800         88  PS-MORE-RECITM-NO                      VALUE 'N'.    01180044
011900     05  PS-RECITM-ODD-UNITS-SW         PIC X(01)   VALUE 'N'.    01190044
012000         88  PS-RECITM-ODD-UNITS-YES                VALUE 'Y'.    01200044
012100         88  PS-RECITM-ODD-UNITS-NO                 VALUE 'N'.    01210044
012200     05  PS-DISTDT-ODD-UNITS-SW         PIC X(01)   VALUE 'N'.    01220044
012300         88  PS-DISTDT-ODD-UNITS-YES                VALUE 'Y'.    01230044
012400         88  PS-DISTDT-ODD-UNITS-NO                 VALUE 'N'.    01240044
012500     05  PS-RECDIS-STORE-FOUND-SW       PIC X(01)   VALUE 'N'.    01250044
012600         88  PS-RECDIS-STORE-FOUND-YES              VALUE 'Y'.    01260044
012700         88  PS-RECDIS-STORE-FOUND-NO               VALUE 'N'.    01270044
012800     05  PS-FIRST-PRPK-FETCH-SW         PIC X(01)   VALUE 'Y'.    01280044
012900         88  PS-FIRST-PRPK-FETCH                    VALUE 'Y'.    01290044
013000         88  PS-FIRST-PRPK-FETCH-NO                 VALUE 'N'.    01300044
013100     05  PS-DOWNLOADED-NOT-SCND-SW      PIC X(01)   VALUE 'Y'.    01310052
013200         88  PS-DOWNLOADED-SCN-FOUND                VALUE 'Y'.    01320052
013300         88  PS-DOWNLOADED-NO-SCN-FND               VALUE 'N'.    01330052
013400                                                                  01340044
013500 01  PV-PROGRAM-VARIABLES.                                        01350044
013600     05  PV-PREV-PREPK-ID               PIC  S9(4) COMP.          01360044
013700     05  PV-PRPK-DISTHD-DRVR-LNE        PIC  S9(4) COMP.          01370044
013800     05  PV-PRCG-STAT-CDE               PIC X(01).                01380044
013900     05  PV-DB2-FREIGHT-COUNT           PIC S9(09)  VALUE ZEROS   01390044
014000                                                     COMP-3.      01400044
014100     05  PV-DB2-TROUBLE-COUNT           PIC S9(9)   VALUE +0      01410044
014200                                                    COMP-3.       01420044
014300     05  PV-DB2-COUNT                   PIC S9(9)   VALUE +0      01430044
014400                                                    COMP-3.       01440044
014500     05  PV-DB2-RECDIS-COUNT            PIC S9(09)   VALUE +0     01450044
014600                                                      COMP-3.     01460044
014700     05  PV-DB2-SCANNED-COUNT           PIC S9(09)   VALUE +0     01470047
014800                                                      COMP-3.     01480047
014900     05  PV-OPEN-AUDIT-COUNT            PIC S9(9)   VALUE +0      01490044
015000                                                    COMP-3.       01500044
015100     05  PV-CURRENT-TIMESTAMP           PIC X(26)   VALUE         01510044
015200                                                       SPACES.    01520044
015300     05  PV-HOLD-CURR-TMST.                                       01530044
015400         10  PV-HOLD-CURR-DATE           PIC  X(10).              01540044
015500         10  PV-HOLD-CURR-TIME           PIC  X(16).              01550044
015600     05  PV-WORK-DATE-PLUS-7             PIC  X(10)  VALUE ZEROS. 01560044
015700     05  PV-WORK-DATE                    PIC  X(10)  VALUE ZEROS. 01570044
015800     05  FILLER    REDEFINES PV-WORK-DATE.                        01580044
015900         10  PV-WORK-CC                  PIC  X(02).              01590044
016000         10  PV-WORK-YY                  PIC  X(02).              01600044
016100         10  FILLER                      PIC  X(01).              01610044
016200         10  PV-WORK-MM                  PIC  X(02).              01620044
016300         10  FILLER                      PIC  X(01).              01630044
016400         10  PV-WORK-DD                  PIC  X(02).              01640044
016500     05  PV-HOLD-WORK-DATE.                                       01650044
016600         10  PV-HOLD-WORK-CC             PIC  9(02).              01660044
016700         10  PV-HOLD-WORK-YY             PIC  9(02).              01670044
016800         10  PV-HOLD-WORK-MM             PIC  9(02).              01680044
016900         10  PV-HOLD-WORK-DD             PIC  9(02).              01690044
017000     05  PV-NULL-IND                  PIC S9(04)  VALUE ZEROS     01700044
017100                                                  COMP SYNC.      01710044
017200     05  PV-STR-NULL-IND             PIC S9(04)  VALUE ZERO       01720044
017300                                                  COMP SYNC.      01730044
017400     05  PV-STATUS-COUNTERS.                                      01740044
017500         10 PV-FREIGHT-COUNT          PIC S9(04) VALUE ZERO       01750044
017600                                                    COMP SYNC.    01760044
017700         10 PV-TRBL-RCVR-COUNT        PIC S9(04) VALUE ZERO       01770044
017800                                                    COMP SYNC.    01780044
017900         10 PV-INVENTORY-COUNT        PIC S9(04) VALUE ZERO       01790044
018000                                                    COMP SYNC.    01800044
018100     05  PV-CURRENT-TMST              PIC X(26).                  01810044
018200     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             01820044
018300         10 PV-CURRENT-DATE           PIC X(10).                  01830044
018400         10 FILLER                    PIC X(16).                  01840044
018500     05  PV-TMST                      PIC X(26).                  01850044
018600     05  FILLER REDEFINES PV-TMST.                                01860044
018700         10  PV-CCYY                  PIC X(04).                  01870044
018800         10  FILLER                   PIC X(01).                  01880044
018900         10  PV-MM                    PIC X(02).                  01890044
019000         10  FILLER                   PIC X(01).                  01900044
019100         10  PV-DD                    PIC X(02).                  01910044
019200         10  FILLER                   PIC X(01).                  01920044
019300         10  PV-HH                    PIC X(02).                  01930044
019400         10  FILLER                   PIC X(01).                  01940044
019500         10  PV-MIN                   PIC X(02).                  01950044
019600         10  FILLER                   PIC X(01).                  01960044
019700         10  PV-SEC                   PIC X(02).                  01970044
019800         10  FILLER                   PIC X(01).                  01980044
019900         10  FILLER                   PIC X(06).                  01990044
020000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02000044
020100                                                     COMP SYNC.   02010044
020200     05  PV-CICS-RESP                    PIC S9(09)  VALUE ZEROS  02020044
020300                                                     COMP SYNC.   02030044
020400     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 02040044
020500     05  PV-RCVR-SEQ-NBR                 PIC  S9(9) COMP.         02050044
020600     05  PV-DISPLAY-SQLCODE              PIC -Z(03) VALUE ZEROES. 02060044
020700     05  PV-DISPLAY-SQLCODE-2            PIC -Z(03) VALUE ZEROES. 02070044
020800     05  PV-DISP-PO-NBR                  PIC  9(09).              02080044
020900     05  PV-DISP-RCVR-NBR                PIC  9(04).              02090044
021000     05  PV-DISP-LINE-NBR                PIC  9(04).              02100044
021100     05  PV-DISP-PREPK-ID                PIC  9(04).              02110044
021200     05  PV-DISP-CICS-RESPONSE           PIC  9(09)  VALUE ZEROS. 02120044
021300     05  PV-DISP-OPER-UNT-ID             PIC  Z(04).              02130044
021400     05  PV-DISP-FCLTY-ID                PIC  9(04).              02140044
021500     05  PV-DISP-STR-NBR                 PIC  Z(04).              02150044
021600     05  PV-DISP-SHIPT-UNT-ID            PIC  9(18).              02160044
021700     05  PV-DISP-RCVR-SEQ-NBR            PIC  9(04).              02170044
021800     05  PV-DISP-TRN-TYP-CDE             PIC  X(02).              02180044
021900                                                                  02190044
022000*---------------------------------------------------------------* 02200044
022100*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 02210044
022200*---------------------------------------------------------------* 02220044
022300     EXEC SQL                                                     02230044
022400          INCLUDE TRECDIS                                         02240044
022500     END-EXEC.                                                    02250044
022600*---------------------------------------------------------------* 02260044
022700*    DB2 AREA FOR DISTRIBUTION DETAIL TABLE                     * 02270044
022800*---------------------------------------------------------------* 02280044
022900     EXEC SQL                                                     02290044
023000          INCLUDE TDISTDT                                         02300044
023100     END-EXEC.                                                    02310044
023200*---------------------------------------------------------------* 02320044
023300*    DB2 AREA FOR DISTRIBUTION HEADER TABLE                     * 02330044
023400*---------------------------------------------------------------* 02340044
023500                                                                  02350044
023600     EXEC SQL                                                     02360044
023700          INCLUDE TDISTHD                                         02370044
023800     END-EXEC.                                                    02380044
023900*---------------------------------------------------------------* 02390044
024000*    DB2 AREA FOR RECEIPT DIST ITEM TABLE                       * 02400044
024100*---------------------------------------------------------------* 02410044
024200                                                                  02420044
024300     EXEC SQL                                                     02430044
024400          INCLUDE TRECITM                                         02440044
024500     END-EXEC.                                                    02450044
024600*---------------------------------------------------------------* 02460049
024700*    DB2 AREA FOR THE PACKSLIP TABLE                            * 02470049
024800*---------------------------------------------------------------* 02480049
024900     EXEC SQL                                                     02490049
025000          INCLUDE TPKSLIP                                         02500049
025100     END-EXEC.                                                    02510049
025200*---------------------------------------------------------------* 02520050
025300*    DB2 AREA FOR THE INPKSU TABLE                                02530050
025400*---------------------------------------------------------------* 02540050
025500     EXEC SQL                                                     02550050
025600          INCLUDE TINPKSU                                         02560050
025700     END-EXEC.                                                    02570050
025800*---------------------------------------------------------------* 02580049
025900*    DB2 AREA FOR THE SHIPPING UPC TABLE                        * 02590049
026000*---------------------------------------------------------------* 02600049
026100     EXEC SQL                                                     02610049
026200          INCLUDE TSHUUPC                                         02620049
026300     END-EXEC.                                                    02630049
026400                                                                  02640044
026500                                                                  02650044
026600     EXEC SQL                                                     02660044
026700          INCLUDE TKRPRPM                                         02670044
026800     END-EXEC.                                                    02680044
026900******************************************************************02690044
027000*  COMMUNICATIONS AREA FOR DB2                                    02700044
027100******************************************************************02710044
027200     EXEC SQL                                                     02720044
027300         INCLUDE SQLCA                                            02730044
027400     END-EXEC.                                                    02740044
027500                                                                  02750044
027600     EXEC SQL                                                     02760044
027700          DECLARE RECITM-CSR CURSOR WITH HOLD                     02770044
027800          FOR SELECT DISTINCT                                     02780044
027900                 ORD_LNE_NBR                                      02790044
028000               , PREPK_ID                                         02800044
028100               , PREPK_DRV_LNE_CDE                                02810046
028200          FROM   TRECITM                                          02820044
028300          WHERE ORD_NBR          =  :DK-PO-NBR                    02830044
028400           AND  REC_SEQ_NBR      =  :DK-RCVR-NBR                  02840044
028500           AND  VER_STATUS_CDE   =  'A'                           02850044
028600           AND  STATUS_CDE  NOT IN ('VE','DE')                    02860044
028700     END-EXEC.                                                    02870044
028800                                                                  02880044
028900     EXEC SQL                                                     02890044
029000          DECLARE RECDIS-CSR CURSOR WITH HOLD                     02900044
029100          FOR SELECT STR_NBR                                      02910044
029200           FROM TRECDIS                                           02920044
029300         WHERE  ORD_NBR             = :DK-PO-NBR                  02930044
029400           AND  REC_SEQ_NBR         = :DK-RCVR-NBR                02940044
029500           AND  ORD_LNE_NBR         = :DK-LINE-NBR                02950044
029700         ORDER BY STR_NBR                                         02970044
029800     END-EXEC.                                                    02980044
029900                                                                  02990044
030000                                                                  03000044
030100                                                                  03010044
030200******************************************************************03020044
030300 LINKAGE SECTION.                                                 03030044
030400 01  DFHCOMMAREA.                                                 03040044
030500     05  FILLER                         OCCURS  1 TO 4072 TIMES   03050044
030600                                      DEPENDING ON EIBCALEN.      03060044
030700         10  FILLER                   PIC X.                      03070044
030800******************************************************************03080044
030900 PROCEDURE DIVISION.                                              03090044
031000******************************************************************03100044
031100 0000-PROGRAM-MAINLINE.                                           03110044
031200     INITIALIZE PV-PROGRAM-VARIABLES                              03120044
031300                PS-PROGRAM-SWITCHES                               03130044
031400                RC041-FIELDS.                                     03140044
031500     MOVE DFHCOMMAREA              TO RC041-FIELDS.               03150044
031600     MOVE RC041-PO-NBR             TO DK-PO-NBR.                  03160044
031700     MOVE RC041-REC-SEQ-NBR        TO DK-RCVR-NBR.                03170044
031800     MOVE RC041-OPER-UNT-ID        TO DK-OPER-UNT-ID.             03180044
031900     MOVE RC041-FCLTY-ID           TO DK-FCLTY-ID.                03190044
032000     MOVE RC041-RCVR-OPER-UNT-ID   TO DK-STR-NBR.                 03200044
032100                                                                  03210044
032200     PERFORM 9300-CHECK-LOGGING.                                  03220044
032300******************************************************************03230044
032400***DISPLAY FOR TESTING *******************************************03240044
032500******************************************************************03250044
032600                                                                  03260044
032700     IF KRPRPM-FUNC-TXT = 'Y'                                     03270044
032800         MOVE RC041-PO-NBR             TO PV-DISP-PO-NBR          03280044
032900         MOVE RC041-REC-SEQ-NBR        TO PV-DISP-RCVR-NBR        03290044
033000         MOVE RC041-OPER-UNT-ID        TO PV-DISP-OPER-UNT-ID     03300044
033100             STRING   ' RCKUT136'                                 03310044
033200                      ' CALLED BY-'                               03320044
033300                      RC041-PROGRAM-NAME                          03330044
033400                      ' PO = '                                    03340044
033500                      PV-DISP-OPER-UNT-ID '-'                     03350044
033600                      PV-DISP-PO-NBR '-'                          03360044
033700                      PV-DISP-RCVR-NBR                            03370044
033800                      DELIMITED BY SIZE                           03380044
033900                                      INTO RC041-CRA-RET-MSG      03390044
034000             PERFORM 9999-WRITE-TO-CSSL                           03400044
034100     END-IF.                                                      03410044
034200******************************************************************03420044
034300***DISPLAY FOR TESTING *******************************************03430044
034400******************************************************************03440044
034500     SET PS-NO-ERROR                                              03450044
034600         PS-FIRST-PRPK-FETCH TO TRUE.                             03460044
034700                                                                  03470044
034800     PERFORM 0750-CHECK-RECDIS-EXISTS                             03480044
034900     IF PS-NO-ERROR                                               03490044
035000        PERFORM 1000-PROCESS-RCVR                                 03500044
035100     END-IF                                                       03510044
035200                                                                  03520044
035300     IF  PS-ERROR                                                 03530044
035400         CONTINUE                                                 03540044
035500     ELSE                                                         03550044
035600     MOVE RC041-FIELDS            TO DFHCOMMAREA.                 03560044
035700     GOBACK.                                                      03570044
035800                                                                  03580044
035900                                                                  03590044
036000 0750-CHECK-RECDIS-EXISTS.                                        03600044
036100                                                                  03610044
036200     MOVE ZEROES TO PV-DB2-RECDIS-COUNT.                          03620044
036300                                                                  03630044
036400     EXEC SQL                                                     03640044
036500         SELECT COUNT(*)                                          03650044
036600           INTO :PV-DB2-RECDIS-COUNT                              03660044
036700           FROM TRECDIS                                           03670044
036800          WHERE ORD_NBR           = :DK-PO-NBR                    03680044
036900            AND REC_SEQ_NBR       = :DK-RCVR-NBR                  03690044
037100     END-EXEC.                                                    03710044
037200                                                                  03720044
037300     EVALUATE TRUE                                                03730044
037400         WHEN SQLCODE = ZERO                                      03740044
037500         WHEN SQLCODE = +100                                      03750044
037600              IF PV-DB2-RECDIS-COUNT > 0                          03760044
037700                 CONTINUE                                         03770044
037800              ELSE                                                03780044
037900                 SET PS-ERROR TO TRUE                             03790044
038000              END-IF                                              03800044
038100         WHEN SQLWARN0 NOT = SPACE                                03810044
038200         WHEN SQLCODE NOT = ZERO                                  03820044
038300             SET PS-ERROR                                         03830044
038400                 RC041-INVALID-SQL    TO TRUE                     03840044
038500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       03850044
038600             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      03860044
038700             STRING   ' RCKUT136-0750-'                           03870044
038800                      ' CALLED BY-'                               03880044
038900                      RC041-PROGRAM-NAME                          03890044
039000                      '  SQLCODE='                                03900044
039100                      PV-DISPLAY-SQLCODE                          03910044
039200                      ' OPER = '                                  03920044
039300                      PV-DISP-OPER-UNT-ID                         03930044
039400                      DELIMITED BY SIZE                           03940044
039500                                      INTO RC041-CRA-RET-MSG      03950044
039600             MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA     03960044
039700             PERFORM 9999-WRITE-TO-CSSL                           03970044
039800     END-EVALUATE.                                                03980044
039900                                                                  03990044
040000                                                                  04000044
040100*----------------------------------------------------------------*04010044
040200 1000-PROCESS-RCVR.                                               04020044
040300                                                                  04030044
040400     SET PS-NO-ERROR                                              04040044
040500         PS-RECDIS-STORE-FOUND-NO TO TRUE.                        04050044
040600     MOVE ZEROES TO PV-PREV-PREPK-ID.                             04060044
040700                                                                  04070044
040800     PERFORM 2000-TRECITM-FOR-LINES.                              04080044
040900                                                                  04090044
041000 2000-TRECITM-FOR-LINES.                                          04100044
041100     PERFORM 3000-OPEN-CURSOR.                                    04110044
041200     PERFORM 3100-FETCH-CURSOR UNTIL                              04120044
041300             PS-NO-MORE-RECITM-LINES OR                           04130044
041400             RC041-NOT-SUCCESSFUL OR                              04140044
041500             RC041-INVALID-SQL                                    04150044
041600     PERFORM 3200-CLOSE-CURSOR.                                   04160044
041700                                                                  04170044
041800     IF RC041-PREPACK AND PS-NO-MORE-RECITM-LINES                 04180044
041900        MOVE PV-PREV-PREPK-ID TO RC041-PREPACK-ID                 04190044
042000        PERFORM 3700-SEL-DISTHD-DRVR-LNE                          04200044
042100        MOVE DISTHD-ORD-LNE-NBR  TO RC041-PO-LNE-NBR              04210044
042200        PERFORM 4500-RCKUT125-CONFIRM-MODULE                      04220044
042300     END-IF.                                                      04230044
042400                                                                  04240044
042500 3000-OPEN-CURSOR.                                                04250044
042600     EXEC SQL                                                     04260044
042700         OPEN RECITM-CSR                                          04270044
042800     END-EXEC.                                                    04280044
042900                                                                  04290044
043000     EVALUATE TRUE                                                04300044
043100         WHEN SQLCODE = ZERO                                      04310044
043200             SET PS-MORE-RECITM-LINES TO TRUE                     04320044
043300                                                                  04330044
043400         WHEN SQLWARN0 NOT = SPACE                                04340044
043500         WHEN SQLCODE  NOT = ZERO                                 04350044
043600             SET PS-ERROR                                         04360044
043700                 RC041-INVALID-SQL    TO TRUE                     04370044
043800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       04380044
043900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           04390044
044000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         04400044
044100             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      04410044
044200             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         04420044
044300             STRING   ' RCKUT136-3000-'                           04430044
044400                      ' CALLED BY-'                               04440044
044500                      RC041-PROGRAM-NAME                          04450044
044600                      '  SQLCODE='                                04460044
044700                      PV-DISPLAY-SQLCODE                          04470044
044800                      ' PO = '                                    04480044
044900                      PV-DISP-OPER-UNT-ID '-'                     04490044
045000                      PV-DISP-PO-NBR '-'                          04500044
045100                      PV-DISP-RCVR-NBR                            04510044
045200                      ' PACK  = '                                 04520044
045300                      PV-DISP-PREPK-ID                            04530044
045400                      DELIMITED BY SIZE                           04540044
045500                                      INTO RC041-CRA-RET-MSG      04550044
045600             PERFORM 9999-WRITE-TO-CSSL                           04560044
045700     END-EVALUATE.                                                04570044
045800                                                                  04580044
045900 3100-FETCH-CURSOR.                                               04590044
046000                                                                  04600044
046100     EXEC SQL                                                     04610044
046200         FETCH RECITM-CSR                                         04620044
046300           INTO                                                   04630044
046400            :RECITM-ORD-LNE-NBR                                   04640044
046500          , :RECITM-PREPK-ID                                      04650044
046600          , :RECITM-PREPK-DRV-LNE-CDE                             04660046
046700     END-EXEC.                                                    04670044
046800                                                                  04680044
046900     EVALUATE TRUE                                                04690044
047000         WHEN SQLCODE = ZERO                                      04700044
047100             IF RC041-PREPACK                                     04710044
047200                IF PV-PREV-PREPK-ID = 0                           04720044
047300                   MOVE RECITM-PREPK-ID TO PV-PREV-PREPK-ID       04730044
047400                   MOVE RECITM-ORD-LNE-NBR                        04740044
047500                                        TO PV-PRPK-DISTHD-DRVR-LNE04750044
047600                ELSE                                              04760044
047700                   IF RECITM-PREPK-ID = PV-PREV-PREPK-ID          04770044
047800                       CONTINUE                                   04780044
047900                   ELSE                                           04790044
048000                      SET PS-FIRST-PRPK-FETCH TO TRUE             04800044
048100                   END-IF                                         04810044
048200                END-IF                                            04820044
048300             END-IF                                               04830044
048400             PERFORM 3300-PROCESS-LNE-TO-CONFIRM                  04840044
048500         WHEN SQLCODE = +100                                      04850044
048600             SET PS-NO-MORE-RECITM-LINES TO TRUE                  04860044
048700         WHEN SQLWARN0 NOT = SPACE                                04870044
048800         WHEN SQLCODE  NOT = ZERO                                 04880044
048900             SET PS-ERROR                                         04890044
049000                 RC041-INVALID-SQL    TO TRUE                     04900044
049100             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       04910044
049200             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           04920044
049300             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         04930044
049400             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      04940044
049500             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         04950044
049600             STRING   ' RCKUT136-3100-'                           04960044
049700                      ' CALLED BY-'                               04970044
049800                      RC041-PROGRAM-NAME                          04980044
049900                      '  SQLCODE='                                04990044
050000                      PV-DISPLAY-SQLCODE                          05000044
050100                      ' PO = '                                    05010044
050200                      PV-DISP-OPER-UNT-ID '-'                     05020044
050300                      PV-DISP-PO-NBR '-'                          05030044
050400                      PV-DISP-RCVR-NBR                            05040044
050500                      ' PACK  = '                                 05050044
050600                      PV-DISP-PREPK-ID                            05060044
050700                      DELIMITED BY SIZE                           05070044
050800                                      INTO RC041-CRA-RET-MSG      05080044
050900             PERFORM 9999-WRITE-TO-CSSL                           05090044
051000     END-EVALUATE.                                                05100044
051100 3200-CLOSE-CURSOR.                                               05110044
051200                                                                  05120044
051300     EXEC SQL                                                     05130044
051400         CLOSE RECITM-CSR                                         05140044
051500     END-EXEC.                                                    05150044
051600                                                                  05160044
051700     EVALUATE TRUE                                                05170044
051800         WHEN SQLCODE = ZERO                                      05180044
051900             CONTINUE                                             05190044
052000                                                                  05200044
052100         WHEN SQLWARN0 NOT = SPACE                                05210044
052200         WHEN SQLCODE  NOT = ZERO                                 05220044
052300             SET PS-ERROR                                         05230044
052400                 RC041-INVALID-SQL    TO TRUE                     05240044
052500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       05250044
052600             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           05260044
052700             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         05270044
052800             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      05280044
052900             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         05290044
053000             STRING   ' RCKUT136-3200-'                           05300044
053100                      ' CALLED BY-'                               05310044
053200                      RC041-PROGRAM-NAME                          05320044
053300                      '  SQLCODE='                                05330044
053400                      PV-DISPLAY-SQLCODE                          05340044
053500                      ' PO = '                                    05350044
053600                      PV-DISP-OPER-UNT-ID '-'                     05360044
053700                      PV-DISP-PO-NBR '-'                          05370044
053800                      PV-DISP-RCVR-NBR                            05380044
053900                      ' PACK  = '                                 05390044
054000                      PV-DISP-PREPK-ID                            05400044
054100                      DELIMITED BY SIZE                           05410044
054200                                      INTO RC041-CRA-RET-MSG      05420044
054300             PERFORM 9999-WRITE-TO-CSSL                           05430044
054400     END-EVALUATE.                                                05440044
054500                                                                  05450044
054600 3300-PROCESS-LNE-TO-CONFIRM.                                     05460044
054700                                                                  05470044
054800     MOVE ZEROES TO DISTHD-TOT-CART-CNT.                          05480044
054900     MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                       05490044
055000     PERFORM 3500-SELECT-TDISTHD.                                 05500044
055100                                                                  05510044
055200     IF PS-NO-DISTHD-FOUND                                        05520044
055300                                                                  05530044
055400        IF RC041-SUCCESSFUL                                       05540044
055500           IF RC041-PREPACK                                       05550044
055600              IF PS-FIRST-PRPK-FETCH                              05560044
055700                 MOVE 'D' TO DISTHD-PREPK-LNE-PRC-CDE             05570044
055800                 SET PS-FIRST-PRPK-FETCH-NO TO TRUE               05580044
055900              ELSE                                                05590044
056000                 MOVE 'P' TO DISTHD-PREPK-LNE-PRC-CDE             05600044
056100              END-IF                                              05610044
056200           ELSE                                                   05620044
056300              MOVE 'N' TO DISTHD-PREPK-LNE-PRC-CDE                05630044
056400           END-IF                                                 05640044
056500                                                                  05650044
056600           PERFORM 4100-INSERT-DIST-HEADER                        05660044
056700        END-IF                                                    05670044
056800        IF RC041-SUCCESSFUL                                       05680044
056900           PERFORM 4995-PROCESS-RECDIS-CURSOR                     05690044
057000        END-IF                                                    05700044
057100     END-IF.                                                      05710044
057200                                                                  05720044
057300     IF RC041-SUCCESSFUL                                          05730044
057400        IF RC041-PREPACK                                          05740044
057500           IF RECITM-PREPK-ID = PV-PREV-PREPK-ID                  05750044
057600              CONTINUE                                            05760044
057700           ELSE                                                   05770044
057800              MOVE PV-PREV-PREPK-ID TO RC041-PREPACK-ID           05780044
057900              PERFORM 3700-SEL-DISTHD-DRVR-LNE                    05790044
058000              MOVE DISTHD-ORD-LNE-NBR TO RC041-PO-LNE-NBR         05800044
058100              PERFORM 4500-RCKUT125-CONFIRM-MODULE                05810044
058200              MOVE RECITM-PREPK-ID TO PV-PREV-PREPK-ID            05820044
058300              MOVE RECITM-ORD-LNE-NBR TO                          05830044
058400                                      PV-PRPK-DISTHD-DRVR-LNE     05840044
058500           END-IF                                                 05850044
058600        ELSE                                                      05860044
058700           MOVE RECITM-ORD-LNE-NBR TO RC041-PO-LNE-NBR            05870044
058800           PERFORM 4500-RCKUT125-CONFIRM-MODULE                   05880044
058900        END-IF                                                    05890044
059000     END-IF.                                                      05900044
059100                                                                  05910044
059200 3500-SELECT-TDISTHD.                                             05920044
059300                                                                  05930044
059400                                                                  05940044
059500     EXEC SQL                                                     05950044
059600         SELECT TOT_CART_CNT                                      05960044
059700             ,  UCC128_DAT_USG_CDE                                05970047
059800             ,  P2L_CART_CNT                                      05980052
059900           INTO :DISTHD-TOT-CART-CNT                              05990044
060000               ,:DISTHD-UCC128-DAT-USG-CDE                        06000047
060100               ,:DISTHD-P2L-CART-CNT                              06010052
060200           FROM TDISTHD                                           06020044
060300         WHERE  ORD_NBR             = :DK-PO-NBR                  06030044
060400           AND  RCVR_SEQ_NBR        = :DK-RCVR-NBR                06040044
060500           AND  ORD_LNE_NBR         = :DK-LINE-NBR                06050044
060600     END-EXEC.                                                    06060044
060700                                                                  06070044
060800     EVALUATE TRUE                                                06080044
060900         WHEN SQLCODE = ZERO                                      06090044
061000             IF DISTHD-TOT-CART-CNT > 0                           06100044
061100                SET PS-DISTHD-FOUND                               06110052
061200                    PS-DOWNLOADED-SCN-FOUND TO TRUE               06120052
061300                IF DISTHD-UCC128-DAT-USG-CDE = 'U' AND            06130052
061400                   DISTHD-P2L-CART-CNT >   0                      06140052
061500                   PERFORM 3600-CHECK-P2L-CRTNS-NOT-RCVD          06150052
061600                   IF PS-DOWNLOADED-NO-SCN-FND                    06160052
061700                      PERFORM 3610-UPDATE-P2L-RSLTS               06170052
061800                   END-IF                                         06180052
061900                END-IF                                            06190052
062000             ELSE                                                 06200044
062100                SET PS-NO-DISTHD-FOUND TO TRUE                    06210045
062200                MOVE SPACES      TO DISTHD-PREPK-LNE-PRC-CDE      06220046
062300                IF RC041-PREPACK                                  06230046
062400                   IF RECITM-PREPK-DRV-LNE-CDE = 'A'              06240046
062500                      MOVE 'D' TO DISTHD-PREPK-LNE-PRC-CDE        06250046
062600                   END-IF                                         06260046
062700                END-IF                                            06270046
062800                PERFORM 3530-UPD-CASEPK-DEL-ROW                   06280044
062900             END-IF                                               06290044
063000         WHEN SQLCODE = +100                                      06300044
063100             SET PS-NO-DISTHD-FOUND  TO TRUE                      06310044
063200         WHEN SQLCODE = -305                                      06320044
063300              CONTINUE                                            06330044
063400         WHEN SQLWARN0 NOT = SPACE                                06340044
063500         WHEN SQLCODE NOT = ZERO                                  06350044
063600             SET PS-ERROR                                         06360044
063700                 RC041-INVALID-SQL    TO TRUE                     06370044
063800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       06380044
063900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           06390044
064000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         06400044
064100             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         06410044
064200             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      06420044
064300             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          06430044
064400             STRING   ' RCKUT136-3500-'                           06440044
064500                      ' CALLED BY-'                               06450044
064600                      RC041-PROGRAM-NAME                          06460044
064700                      '  SQLCODE='                                06470044
064800                      PV-DISPLAY-SQLCODE                          06480044
064900                      ' PO = '                                    06490044
065000                      PV-DISP-OPER-UNT-ID '-'                     06500044
065100                      PV-DISP-PO-NBR  '-'                         06510044
065200                      PV-DISP-RCVR-NBR '-'                        06520044
065300                      PV-DISP-LINE-NBR                            06530044
065400                      ' STR  = '                                  06540044
065500                      PV-DISP-STR-NBR                             06550044
065600                      DELIMITED BY SIZE                           06560044
065700                                      INTO RC041-CRA-RET-MSG      06570044
065800             PERFORM 9999-WRITE-TO-CSSL                           06580044
065900     END-EVALUATE.                                                06590044
066000                                                                  06600044
066100 3530-UPD-CASEPK-DEL-ROW.                                         06610044
066200                                                                  06620044
066300     IF RC041-PROGRAM-NAME  = PC-VERIF-HOT-COMPLETE               06630044
066400        MOVE 'HOTCMPLT' TO DISTHD-CRE-USR-ID                      06640044
066500     ELSE                                                         06650044
066600        MOVE 'TRLRUNLD' TO DISTHD-CRE-USR-ID                      06660044
066700     END-IF                                                       06670044
066800                                                                  06680044
066900     EXEC SQL                                                     06690044
067000       UPDATE  TDISTHD                                            06700044
067100         SET  FCSE_CART_CNT      = 1                              06710046
067200            , TOT_CART_CNT       = 1                              06720055
067300            , CRE_USR_ID         = :DISTHD-CRE-USR-ID             06730055
067400            , PREPK_LNE_PRC_CDE  = :DISTHD-PREPK-LNE-PRC-CDE      06740055
067500            , CRE_TMST           = CURRENT TIMESTAMP              06750055
067600       WHERE  ORD_NBR            = :DK-PO-NBR                     06760055
067700         AND  RCVR_SEQ_NBR       = :DK-RCVR-NBR                   06770055
067800         AND  ORD_LNE_NBR        = :DK-LINE-NBR                   06780055
067900     END-EXEC.                                                    06790055
068000                                                                  06800055
068100     EVALUATE TRUE                                                06810055
068200         WHEN SQLCODE = ZERO                                      06820055
068300              CONTINUE                                            06830055
068400         WHEN SQLWARN0 NOT = SPACE                                06840055
068500         WHEN SQLCODE NOT = ZERO                                  06850055
068600             SET PS-ERROR                                         06860055
068700                 RC041-INVALID-SQL    TO TRUE                     06870055
068800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       06880055
068900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           06890055
069000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         06900055
069100             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         06910055
069200             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      06920055
069300             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          06930055
069400             STRING   ' RCKUT136-3530-'                           06940055
069500                      ' CALLED BY-'                               06950055
069600                      RC041-PROGRAM-NAME                          06960055
069700                      '  SQLCODE='                                06970055
069800                      PV-DISPLAY-SQLCODE                          06980055
069900                      ' PO = '                                    06990055
070000                      PV-DISP-OPER-UNT-ID '-'                     07000055
070100                      PV-DISP-PO-NBR  '-'                         07010055
070200                      PV-DISP-RCVR-NBR '-'                        07020055
070300                      PV-DISP-LINE-NBR                            07030055
070400                      ' STR  = '                                  07040055
070500                      PV-DISP-STR-NBR                             07050055
070600                      DELIMITED BY SIZE                           07060055
070700                                      INTO RC041-CRA-RET-MSG      07070055
070800             PERFORM 9999-WRITE-TO-CSSL                           07080055
070900     END-EVALUATE.                                                07090055
071000                                                                  07100055
071100                                                                  07110055
071200 3600-CHECK-P2L-CRTNS-NOT-RCVD.                                   07120055
071300                                                                  07130044
071400     MOVE  ZEROES             TO PV-DB2-SCANNED-COUNT.            07140047
071500                                                                  07150047
071600     EXEC SQL                                                     07160044
071700         SELECT COUNT(*)                                          07170052
071800          INTO  :PV-DB2-SCANNED-COUNT                             07180052
071900          FROM  TINPKSU A                                         07190047
072000              , TPKSLIP B                                         07200047
072100              , TSHUUPC C                                         07210047
072200              , TDISTHD D                                         07220047
072300          WHERE  B.PO_NBR             = :DK-PO-NBR                07230047
072400            AND  A.PO_NBR             =  B.PO_NBR                 07240047
072500            AND  A.SEQ_NBR            = B.SEQ_NBR                 07250047
072600            AND  B.VER_STAT_CDE       = 'A'                       07260047
072700            AND  B.REC_SEQ_NBR        = :DK-RCVR-NBR              07270047
072800            AND  A.SHIPT_UNT_ID       = C.SHIPT_UNT_ID            07280047
072900            AND  B.PO_NBR             = D.ORD_NBR                 07290047
073000            AND  B.REC_SEQ_NBR        = D.RCVR_SEQ_NBR            07300047
073100            AND  C.TRN_LNE_NBR        = D.ORD_LNE_NBR             07310047
073200            AND  D.ORD_LNE_NBR        = :DK-LINE-NBR              07320047
073300            AND  D.UCC128_DAT_USG_CDE = 'U'                       07330047
073400            AND  D.P2L_CART_CNT       >  0                        07340052
073500            AND  A.SHIPT_UNT_ID IN                                07350051
073600                (SELECT  C.SHIPT_UNT_ID                           07360047
073700                 FROM   TSHUNLO C                                 07370048
073800                 WHERE  A.SHIPT_UNT_ID = C.SHIPT_UNT_ID)          07380047
073900     END-EXEC.                                                    07390044
074000                                                                  07400044
074100     EVALUATE TRUE                                                07410044
074200         WHEN SQLCODE = ZERO                                      07420044
074300              IF PV-DB2-SCANNED-COUNT = 0                         07430052
074400                 SET PS-DOWNLOADED-NO-SCN-FND TO TRUE             07440052
074500              END-IF                                              07450052
074600         WHEN SQLWARN0 NOT = SPACE                                07460044
074700         WHEN SQLCODE NOT = ZERO                                  07470044
074800             SET PS-ERROR                                         07480044
074900                 RC041-INVALID-SQL    TO TRUE                     07490044
075000             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       07500044
075100             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           07510044
075200             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         07520044
075300             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         07530044
075400             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      07540044
075500             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          07550044
075600             STRING   ' RCKUT136-3600-'                           07560047
075700                      ' CALLED BY-'                               07570044
075800                      RC041-PROGRAM-NAME                          07580044
075900                      '  SQLCODE='                                07590044
076000                      PV-DISPLAY-SQLCODE                          07600044
076100                      ' PO = '                                    07610044
076200                      PV-DISP-OPER-UNT-ID '-'                     07620044
076300                      PV-DISP-PO-NBR  '-'                         07630044
076400                      PV-DISP-RCVR-NBR '-'                        07640044
076500                      PV-DISP-LINE-NBR                            07650044
076600                      ' STR  = '                                  07660044
076700                      PV-DISP-STR-NBR                             07670044
076800                      DELIMITED BY SIZE                           07680044
076900                                      INTO RC041-CRA-RET-MSG      07690044
077000             PERFORM 9999-WRITE-TO-CSSL                           07700044
077100     END-EVALUATE.                                                07710044
077200                                                                  07720044
077300 3610-UPDATE-P2L-RSLTS.                                           07730047
077400                                                                  07740047
077500     IF RC041-PROGRAM-NAME  = PC-VERIF-HOT-COMPLETE               07750047
077600        MOVE 'HOTCMPLT' TO DISTHD-CRE-USR-ID                      07760047
077700     ELSE                                                         07770047
077800        MOVE 'TRLRUNLD' TO DISTHD-CRE-USR-ID                      07780047
077900     END-IF                                                       07790047
078000                                                                  07800047
078100     EXEC SQL                                                     07810047
078200       UPDATE  TDISTHD                                            07820047
078300         SET  RSLTS_RCVD_TMST    = CURRENT TIMESTAMP              07830047
078400            , CRE_TMST           = CURRENT TIMESTAMP              07840054
078500            , CRE_USR_ID         = :DISTHD-CRE-USR-ID             07850047
078600       WHERE  ORD_NBR            = :DK-PO-NBR                     07860047
078700         AND  RCVR_SEQ_NBR       = :DK-RCVR-NBR                   07870047
078800         AND  ORD_LNE_NBR        = :DK-LINE-NBR                   07880047
078900     END-EXEC.                                                    07890047
079000                                                                  07900047
079100     EVALUATE TRUE                                                07910047
079200         WHEN SQLCODE = ZERO                                      07920047
079300              CONTINUE                                            07930047
079400         WHEN SQLWARN0 NOT = SPACE                                07940047
079500         WHEN SQLCODE NOT = ZERO                                  07950047
079600             SET PS-ERROR                                         07960047
079700                 RC041-INVALID-SQL    TO TRUE                     07970047
079800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       07980047
079900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           07990047
080000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         08000047
080100             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         08010047
080200             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      08020047
080300             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          08030047
080400             STRING   ' RCKUT136-3610-'                           08040047
080500                      ' CALLED BY-'                               08050047
080600                      RC041-PROGRAM-NAME                          08060047
080700                      '  SQLCODE='                                08070047
080800                      PV-DISPLAY-SQLCODE                          08080047
080900                      ' PO = '                                    08090047
081000                      PV-DISP-OPER-UNT-ID '-'                     08100047
081100                      PV-DISP-PO-NBR  '-'                         08110047
081200                      PV-DISP-RCVR-NBR '-'                        08120047
081300                      PV-DISP-LINE-NBR                            08130047
081400                      ' STR  = '                                  08140047
081500                      PV-DISP-STR-NBR                             08150047
081600                      DELIMITED BY SIZE                           08160047
081700                                      INTO RC041-CRA-RET-MSG      08170047
081800             PERFORM 9999-WRITE-TO-CSSL                           08180047
081900     END-EVALUATE.                                                08190047
082000                                                                  08200047
082100 3700-SEL-DISTHD-DRVR-LNE.                                        08210047
082200                                                                  08220047
082300     EXEC SQL                                                     08230047
082400        SELECT DISTINCT(A.ORD_LNE_NBR)                            08240047
082500        INTO  :DISTHD-ORD-LNE-NBR                                 08250047
082600        FROM  TDISTHD A                                           08260047
082700          ,   TRECITM B                                           08270047
082800        WHERE A.ORD_NBR           =  :DK-PO-NBR                   08280047
082900          AND A.ORD_NBR           =  B.ORD_NBR                    08290047
083000          AND A.RCVR_SEQ_NBR      =  :DK-RCVR-NBR                 08300047
083100          AND A.RCVR_SEQ_NBR      =  B.REC_SEQ_NBR                08310047
083200          AND A.ORD_LNE_NBR       =  B.ORD_LNE_NBR                08320047
083300          AND B.PREPK_ID          = :PV-PREV-PREPK-ID             08330047
083400          AND A.PREPK_LNE_PRC_CDE = 'D'                           08340047
083500     END-EXEC.                                                    08350047
083600                                                                  08360047
083700     EVALUATE TRUE                                                08370047
083800         WHEN SQLCODE = ZERO                                      08380047
083900              CONTINUE                                            08390047
084000         WHEN SQLWARN0 NOT = SPACE                                08400047
084100         WHEN SQLCODE NOT = ZERO                                  08410047
084200             SET PS-ERROR                                         08420047
084300                 RC041-INVALID-SQL    TO TRUE                     08430047
084400             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       08440047
084500             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           08450047
084600             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         08460047
084700             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         08470047
084800             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      08480047
084900             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          08490047
085000             STRING   ' RCKUT136-3700-'                           08500047
085100                      ' CALLED BY-'                               08510047
085200                      RC041-PROGRAM-NAME                          08520047
085300                      '  SQLCODE='                                08530047
085400                      PV-DISPLAY-SQLCODE                          08540047
085500                      ' PO = '                                    08550047
085600                      PV-DISP-OPER-UNT-ID '-'                     08560047
085700                      PV-DISP-PO-NBR  '-'                         08570047
085800                      PV-DISP-RCVR-NBR '-'                        08580047
085900                      PV-DISP-LINE-NBR                            08590047
086000                      ' STR  = '                                  08600047
086100                      PV-DISP-STR-NBR                             08610047
086200                      DELIMITED BY SIZE                           08620047
086300                                      INTO RC041-CRA-RET-MSG      08630047
086400             PERFORM 9999-WRITE-TO-CSSL                           08640047
086500     END-EVALUATE.                                                08650047
086600                                                                  08660047
086700                                                                  08670047
086800 4100-INSERT-DIST-HEADER.                                         08680044
086900                                                                  08690044
087000     MOVE  PC-DEFAULT-TMST       TO  DISTHD-RSLTS-RCVD-TMST       08700044
087100                                     DISTHD-VRFD-TMST             08710044
087200                                     DISTHD-FCSE-CNFRMN-TMST      08720044
087300                                     DISTHD-DLT-REQ-TMST.         08730044
087400     IF RC041-PROGRAM-NAME  = PC-VERIF-HOT-COMPLETE               08740044
087500        MOVE 'HOTCMPLT' TO DISTHD-CRE-USR-ID                      08750044
087600     ELSE                                                         08760044
087700        MOVE 'TRLRUNLD' TO DISTHD-CRE-USR-ID                      08770044
087800     END-IF                                                       08780044
087900                                                                  08790044
088000     EXEC SQL                                                     08800044
088100          INSERT INTO TDISTHD                                     08810044
088200           ( ORD_NBR                                              08820044
088300            ,RCVR_SEQ_NBR                                         08830044
088400            ,ORD_LNE_NBR                                          08840044
088500            ,WRK_ORD_SEQ_NBR                                      08850044
088600            ,OPER_UNT_ID                                          08860044
088700            ,DISTRB_PRC_AREA_ID                                   08870044
088800            ,PRCG_STAT_CDE                                        08880044
088900            ,CRE_TMST                                             08890044
089000            ,RSLTS_RCVD_TMST                                      08900044
089100            ,VRFD_TMST                                            08910044
089200            ,PRC_AREA_MODU_ID                                     08920044
089300            ,CRE_USR_ID                                           08930044
089400            ,TOT_CART_CNT                                         08940044
089500            ,CART_DWNLD_DTE                                       08950044
089600            ,CART_DWNLD_TM                                        08960044
089700            ,CART_DWNLD_USR_ID                                    08970044
089800            ,FCSE_CART_CNT                                        08980044
089900            ,FCSE_LBL_TYP_CDE                                     08990044
090000            ,P2L_CART_CNT                                         09000044
090100            ,INPK_CART_CNT                                        09010044
090200            ,INPK_UNT_QTY                                         09020044
090300            ,INPK_CNVYB_IND                                       09030044
090400            ,OTPK_UNT_QTY                                         09040044
090500            ,SYS_CRE_CDE                                          09050044
090600            ,SPC_INSTR_DESC                                       09060044
090700            ,FCSE_CNFRMN_TMST                                     09070044
090800            ,CRE_LBL_OPT_CDE                                      09080044
090900            ,FCSE_FCLTY_AREA_ID                                   09090044
091000            ,ODD_CART_UNT_QTY                                     09100044
091100            ,DLT_REQ_TMST                                         09110044
091200            ,PREPK_LNE_PRC_CDE                                    09120044
091300            ,CAL_UNT_PRCD_QTY                                     09130044
091400            ,UCC128_DAT_USG_CDE                                   09140044
091500            ,P2L_SCN_CART_CNT                                     09150044
091600           )                                                      09160044
091700         VALUES (                                                 09170044
091800             :DK-PO-NBR                                           09180044
091900           , :DK-RCVR-NBR                                         09190044
092000           , :DK-LINE-NBR                                         09200044
092100           , 1                                                    09210044
092200           , :DK-OPER-UNT-ID                                      09220044
092300           , 'P2L'                                                09230044
092400           , 'D'                                                  09240044
092500           ,  CURRENT TIMESTAMP                                   09250044
092600           , :DISTHD-RSLTS-RCVD-TMST                              09260044
092700           , :DISTHD-VRFD-TMST                                    09270044
092800           , ' '                                                  09280044
092900           , :DISTHD-CRE-USR-ID                                   09290044
093000           , 1                                                    09300053
093100           , CURRENT DATE                                         09310044
093200           , CURRENT TIME                                         09320044
093300           , :RC041-USER-ID                                       09330044
093400           , 1                                                    09340044
093500           , 'X'                                                  09350044
093600           , 0                                                    09360044
093700           , 0                                                    09370044
093800           , 1                                                    09380044
093900           , 'N'                                                  09390044
094000           , 1                                                    09400044
094100           , 'F'                                                  09410044
094200           , ' '                                                  09420044
094300           , :DISTHD-FCSE-CNFRMN-TMST                             09430044
094400           , 'C'                                                  09440044
094500           , 'RECV'                                               09450044
094600           , 0                                                    09460044
094700           , :DISTHD-DLT-REQ-TMST                                 09470044
094800           , :DISTHD-PREPK-LNE-PRC-CDE                            09480044
094900           , 0                                                    09490044
095000           , 'N'                                                  09500044
095100           , 0                                                    09510044
095200         )                                                        09520044
095300     END-EXEC.                                                    09530044
095400                                                                  09540044
095500     EVALUATE TRUE                                                09550044
095600         WHEN SQLCODE = ZERO                                      09560044
095700         WHEN SQLCODE = -803                                      09570044
095800              CONTINUE                                            09580044
095900         WHEN SQLWARN0 NOT = SPACE                                09590044
096000         WHEN SQLCODE NOT = ZERO                                  09600044
096100             SET PS-ERROR                                         09610044
096200                 RC041-INVALID-SQL    TO TRUE                     09620044
096300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       09630044
096400             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           09640044
096500             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         09650044
096600             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      09660044
096700             STRING   ' RCKUT136-4100-'                           09670044
096800                      ' CALLED BY-'                               09680044
096900                      RC041-PROGRAM-NAME                          09690044
097000                      '  SQLCODE='                                09700044
097100                      PV-DISPLAY-SQLCODE                          09710044
097200                      ' PO = '                                    09720044
097300                      PV-DISP-OPER-UNT-ID '-'                     09730044
097400                      PV-DISP-PO-NBR '-'                          09740044
097500                      PV-DISP-RCVR-NBR                            09750044
097600                      DELIMITED BY SIZE                           09760044
097700                                      INTO RC041-CRA-RET-MSG      09770044
097800             PERFORM 9999-WRITE-TO-CSSL                           09780044
097900     END-EVALUATE.                                                09790044
098000                                                                  09800044
098100 4200-INSERT-DIST-DETAIL.                                         09810044
098200                                                                  09820044
098300                                                                  09830044
098400     EXEC SQL                                                     09840044
098500          INSERT INTO TDISTDT                                     09850044
098600           ( ORD_NBR                                              09860044
098700            ,RCVR_SEQ_NBR                                         09870044
098800            ,ORD_LNE_NBR                                          09880044
098900            ,WRK_ORD_SEQ_NBR                                      09890044
099000            ,STR_NBR                                              09900044
099100            ,EXPTED_ALLOC_QTY                                     09910044
099200            ,ACTL_ALLOC_QTY                                       09920044
099300            ,RCVG_PSTD_STAT_CDE                                   09930044
099400            ,P2L_SPLT_UNT_QTY                                     09940044
099500            ,FCSE_SPLT_UNT_QTY                                    09950044
099600            ,INPK_SPLT_UNT_QTY                                    09960044
099700            ,FCSE_ACTL_UNT_QTY                                    09970044
099800            ,ODD_CART_IND                                         09980044
099900            ,PREPK_ODD_UNT_QTY                                    09990044
100000           )                                                      10000044
100100         VALUES (                                                 10010044
100200             :DK-PO-NBR                                           10020044
100300           , :DK-RCVR-NBR                                         10030044
100400           , :DK-LINE-NBR                                         10040044
100500           , 1                                                    10050044
100600           , :RECDIS-STR-NBR                                      10060044
100700           , 0                                                    10070044
100800           , 0                                                    10080044
100900           , 'N'                                                  10090044
101000           , 0                                                    10100044
101100           , 0                                                    10110044
101200           , 0                                                    10120044
101300           , 0                                                    10130044
101400           , 'N'                                                  10140044
101500           , 0                                                    10150044
101600         )                                                        10160044
101700     END-EXEC.                                                    10170044
101800                                                                  10180044
101900     EVALUATE TRUE                                                10190044
102000         WHEN SQLCODE = ZERO                                      10200044
102100         WHEN SQLCODE = -803                                      10210044
102200              CONTINUE                                            10220044
102300         WHEN SQLWARN0 NOT = SPACE                                10230044
102400         WHEN SQLCODE NOT = ZERO                                  10240044
102500             SET PS-ERROR                                         10250044
102600                 RC041-INVALID-SQL    TO TRUE                     10260044
102700             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       10270044
102800             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           10280044
102900             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         10290044
103000             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      10300044
103100             STRING   ' RCKUT136-4200-'                           10310044
103200                      ' CALLED BY-'                               10320044
103300                      RC041-PROGRAM-NAME                          10330044
103400                      '  SQLCODE='                                10340044
103500                      PV-DISPLAY-SQLCODE                          10350044
103600                      ' PO = '                                    10360044
103700                      PV-DISP-OPER-UNT-ID '-'                     10370044
103800                      PV-DISP-PO-NBR '-'                          10380044
103900                      PV-DISP-RCVR-NBR                            10390044
104000                      DELIMITED BY SIZE                           10400044
104100                                      INTO RC041-CRA-RET-MSG      10410044
104200             PERFORM 9999-WRITE-TO-CSSL                           10420044
104300     END-EVALUATE.                                                10430044
104400                                                                  10440044
104500 4500-RCKUT125-CONFIRM-MODULE.                                    10450044
104600                                                                  10460044
104700     MOVE LENGTH OF RC041-FIELDS    TO PV-COMMAREA-LENGTH.        10470044
104800                                                                  10480044
104900     EXEC CICS                                                    10490044
105000         LINK PROGRAM  (PC-FULLCASE-CONFIRM-PGM)                  10500044
105100              COMMAREA (RC041-FIELDS)                             10510044
105200              LENGTH   (PV-COMMAREA-LENGTH)                       10520044
105300              RESP     (PV-CICS-RESP)                             10530044
105400     END-EXEC.                                                    10540044
105500                                                                  10550044
105600 4995-PROCESS-RECDIS-CURSOR.                                      10560044
105700                                                                  10570044
105800     SET PS-MORE-RECDIS-LINES TO TRUE                             10580044
105900     PERFORM 5000-OPEN-CURSOR-RECDIS.                             10590044
106000     PERFORM 5100-FETCH-CURSOR-RECDIS UNTIL                       10600044
106100             PS-NO-MORE-RECDIS-LINES OR                           10610044
106200             RC041-NOT-SUCCESSFUL OR                              10620044
106300             RC041-INVALID-SQL.                                   10630044
106400     PERFORM 5200-CLOSE-CURSOR.                                   10640044
106500                                                                  10650044
106600 5000-OPEN-CURSOR-RECDIS.                                         10660044
106700     EXEC SQL                                                     10670044
106800         OPEN RECDIS-CSR                                          10680044
106900     END-EXEC.                                                    10690044
107000                                                                  10700044
107100     EVALUATE TRUE                                                10710044
107200         WHEN SQLCODE = ZERO                                      10720044
107300             SET PS-MORE-RECDIS-LINES TO TRUE                     10730044
107400                                                                  10740044
107500         WHEN SQLWARN0 NOT = SPACE                                10750044
107600         WHEN SQLCODE  NOT = ZERO                                 10760044
107700             SET PS-ERROR                                         10770044
107800                 RC041-INVALID-SQL    TO TRUE                     10780044
107900             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       10790044
108000             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           10800044
108100             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         10810044
108200             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      10820044
108300             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         10830044
108400             STRING   ' RCKUT136-5000-'                           10840044
108500                      ' CALLED BY-'                               10850044
108600                      RC041-PROGRAM-NAME                          10860044
108700                      '  SQLCODE='                                10870044
108800                      PV-DISPLAY-SQLCODE                          10880044
108900                      ' PO = '                                    10890044
109000                      PV-DISP-OPER-UNT-ID '-'                     10900044
109100                      PV-DISP-PO-NBR '-'                          10910044
109200                      PV-DISP-RCVR-NBR                            10920044
109300                      ' PACK  = '                                 10930044
109400                      PV-DISP-PREPK-ID                            10940044
109500                      DELIMITED BY SIZE                           10950044
109600                                      INTO RC041-CRA-RET-MSG      10960044
109700             PERFORM 9999-WRITE-TO-CSSL                           10970044
109800     END-EVALUATE.                                                10980044
109900                                                                  10990044
110000 5100-FETCH-CURSOR-RECDIS.                                        11000044
110100                                                                  11010044
110200     EXEC SQL                                                     11020044
110300         FETCH RECDIS-CSR                                         11030044
110400           INTO                                                   11040044
110500            :RECDIS-STR-NBR                                       11050044
110600     END-EXEC.                                                    11060044
110700                                                                  11070044
110800     EVALUATE TRUE                                                11080044
110900         WHEN SQLCODE = ZERO                                      11090044
111000              PERFORM 4200-INSERT-DIST-DETAIL                     11100044
111100         WHEN SQLCODE = +100                                      11110044
111200             SET PS-NO-MORE-RECDIS-LINES TO TRUE                  11120044
111300         WHEN SQLWARN0 NOT = SPACE                                11130044
111400         WHEN SQLCODE  NOT = ZERO                                 11140044
111500             SET PS-ERROR                                         11150044
111600                 RC041-INVALID-SQL    TO TRUE                     11160044
111700             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       11170044
111800             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           11180044
111900             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         11190044
112000             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      11200044
112100             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         11210044
112200             STRING   ' RCKUT136-5100-'                           11220044
112300                      ' CALLED BY-'                               11230044
112400                      RC041-PROGRAM-NAME                          11240044
112500                      '  SQLCODE='                                11250044
112600                      PV-DISPLAY-SQLCODE                          11260044
112700                      ' PO = '                                    11270044
112800                      PV-DISP-OPER-UNT-ID '-'                     11280044
112900                      PV-DISP-PO-NBR '-'                          11290044
113000                      PV-DISP-RCVR-NBR                            11300044
113100                      ' PACK  = '                                 11310044
113200                      PV-DISP-PREPK-ID                            11320044
113300                      DELIMITED BY SIZE                           11330044
113400                                      INTO RC041-CRA-RET-MSG      11340044
113500             PERFORM 9999-WRITE-TO-CSSL                           11350044
113600     END-EVALUATE.                                                11360044
113700                                                                  11370044
113800 5200-CLOSE-CURSOR.                                               11380044
113900                                                                  11390044
114000     EXEC SQL                                                     11400044
114100         CLOSE RECDIS-CSR                                         11410044
114200     END-EXEC.                                                    11420044
114300                                                                  11430044
114400     EVALUATE TRUE                                                11440044
114500         WHEN SQLCODE = ZERO                                      11450044
114600             CONTINUE                                             11460044
114700                                                                  11470044
114800         WHEN SQLWARN0 NOT = SPACE                                11480044
114900         WHEN SQLCODE  NOT = ZERO                                 11490044
115000             SET PS-ERROR                                         11500044
115100                 RC041-INVALID-SQL    TO TRUE                     11510044
115200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       11520044
115300             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           11530044
115400             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         11540044
115500             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      11550044
115600             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         11560044
115700             STRING   ' RCKUT136-5200-'                           11570044
115800                      ' CALLED BY-'                               11580044
115900                      RC041-PROGRAM-NAME                          11590044
116000                      '  SQLCODE='                                11600044
116100                      PV-DISPLAY-SQLCODE                          11610044
116200                      ' PO = '                                    11620044
116300                      PV-DISP-OPER-UNT-ID '-'                     11630044
116400                      PV-DISP-PO-NBR '-'                          11640044
116500                      PV-DISP-RCVR-NBR                            11650044
116600                      ' PACK  = '                                 11660044
116700                      PV-DISP-PREPK-ID                            11670044
116800                      DELIMITED BY SIZE                           11680044
116900                                      INTO RC041-CRA-RET-MSG      11690044
117000             PERFORM 9999-WRITE-TO-CSSL                           11700044
117100     END-EVALUATE.                                                11710044
117200                                                                  11720044
117300 9300-CHECK-LOGGING.                                              11730044
117400     EXEC SQL                                                     11740044
117500         SELECT FUNC_TXT                                          11750044
117600           INTO :KRPRPM-FUNC-TXT                                  11760044
117700           FROM TKRPRPM                                           11770044
117800          WHERE SYS_PRC_FUNC_CDE  = 'RC136D'                      11780044
117900            AND LOC_ID            = :DK-OPER-UNT-ID               11790044
118000            AND INTFC_SYS_CDE     = 'KHL'                         11800044
118100            AND FUNC_PRC_STAT_CDE = 'AC'                          11810044
118200     END-EXEC.                                                    11820044
118300                                                                  11830044
118400     EVALUATE TRUE                                                11840044
118500         WHEN SQLCODE = ZERO                                      11850044
118600         WHEN SQLCODE = +100                                      11860044
118700              CONTINUE                                            11870044
118800         WHEN SQLWARN0 NOT = SPACE                                11880044
118900         WHEN SQLCODE NOT = ZERO                                  11890044
119000             SET PS-ERROR                                         11900044
119100                 RC041-INVALID-SQL    TO TRUE                     11910044
119200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       11920044
119300             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      11930044
119400             STRING   ' RCKUT136-9300-'                           11940044
119500                      ' CALLED BY-'                               11950044
119600                      RC041-PROGRAM-NAME                          11960044
119700                      '  SQLCODE='                                11970044
119800                      PV-DISPLAY-SQLCODE                          11980044
119900                      ' OPER = '                                  11990044
120000                      PV-DISP-OPER-UNT-ID                         12000044
120100                      DELIMITED BY SIZE                           12010044
120200                                      INTO RC041-CRA-RET-MSG      12020044
120300             MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA     12030044
120400             PERFORM 9999-WRITE-TO-CSSL                           12040044
120500     END-EVALUATE.                                                12050044
120600                                                                  12060044
120700                                                                  12070044
120800                                                                  12080044
120900 9902-SYNCPOINT.                                                  12090044
121000     EXEC CICS                                                    12100044
121100         SYNCPOINT                                                12110044
121200     END-EXEC.                                                    12120044
121300                                                                  12130044
121400                                                                  12140044
121500 9999-WRITE-TO-CSSL.                                              12150044
121600                                                                  12160044
121700     MOVE RC041-CRA-RET-MSG       TO PV-CICS-MSG-AREA.            12170044
121800     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      12180044
121900                                                                  12190044
122000     EXEC CICS                                                    12200044
122100          WRITEQ TD                                               12210044
122200           QUEUE   ('CSSL')                                       12220044
122300            FROM   (PV-CICS-MSG-AREA)                             12230044
122400          LENGTH   (PV-COMMAREA-LENGTH)                           12240044
122500            RESP   (PV-CICS-RESP)                                 12250044
122600     END-EXEC.                                                    12260044
122700                                                                  12270044
