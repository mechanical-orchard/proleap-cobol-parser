000100 IDENTIFICATION DIVISION.                                         00010008
000200 PROGRAM-ID.     DSKUT002.                                        00020008
000300 AUTHOR.         DENNIS STEFFEN.                                  00030008
000400 DATE-WRITTEN.   WINTER 2003.                                     00040008
000500 DATE-COMPILED.                                                   00050008
000600*************************************************************     00060008
000700*                                                           *     00070008
000800*  UNLOAD GROUP 1 DATA                                      *     00080008
000900*                                                           *     00090008
001000*************************************************************     00100008
001100* CHANGE LOG:                                               *     00110008
001200* 8/8/2002 CHANGED CURSORS FOR TABLES TSUAUPC, TSUEXCP AND  *     00120008
001300*          TCTEXCP TO INCLUDE AUD_CNTL_NBR AS PART OF THE   *     00130008
001400*          WHERE CLAUSE. AUD_CNTL_NBR IS OBTAINED FROM      *     00140008
001500*          TSUATRN.  VML                                    *     00150008
001600* 5/2/2003 CHANGES TO ONLY SELECT ACTIVE ROWS FOR TUPC AND  *     00160008
001700*          TUPCPLS. ONLY SELECT THE ACTIVE AND MOST RECENT  *     00170008
001800*          INACTIVE ROW FOR TWEBITM. CORRECTED THE TMDARVS  *     00180008
001900*          CURSOR WHERE CLAUSE AND THE NULL INDICATORS FOR  *     00190008
002000*          TUPCPLS. ONLY SELECT TVNDSTL, TMDSEAR, TMDARVS,  *     00200008
002100*          TSKXREF, AND TWEBITM DATA ONCE FOR A GIVEN       *     00210008
002200*          INTR-UPC-ID.   P.KEBER                           *     00220008
002300*6/16/2003 CHANGES TO SELECT TSKST AND TPPCPRC ROW. P.KEBER *     00230008
002400*1/22/2003 CHANGES FOR NEW TMDARVS FIELDS.          P.KEBER *     00240008
002500* 3/3/2004 FIX THE TWEBITM CURSOR TO ONLY SELECT ONE ROW.   *     00250008
002600*          P.KEBER                                          *     00260008
002700*4/21/2004 CHANGES TO SELECT TVSCHVL FIELDS.        P.KEBER *     00270008
002800*5/11/2004 ADD MAP_UNT_RTL_AMT TO TMDARVS UNLOAD.   P.KEBER *     00280008
002900*7/21/2004 ADD LOC_NBR AND LAST_UPD_TMST TO TSKST.  P.KEBER *     00290008
003000*7/13/2005 REMOVE STORE_NMBR, MDL_STOCK_UNIT_QTY,   P.KEBER *     00300008
003100*          INV_CUTOFF_OH_QTY,POST_FL_AFT_REC FROM TSKST     *     00310008
003200*9/14/2005 ADD C_O_ORGN_CDE TO TMDARVS. ADD TABLE   P.KEBER *     00320008
003300*          IMT_STYL_PRTNR. REMOVE OBSOLETE TSKST OUTPUT     *     00330008
003400*          RECORD COLUMNS.                                  *     00340008
003500*10/4/2005 ADD ORIG_CLR_DTE AND MKDN_CDE TO TUPCPLS(P.KEBER)*     00350008
003600*1/16/2006 ADD PRIC_TIER_SEQ_NBR AND LFSTYL_SEQ_NBR TO      *     00360008
003700*          TMDARVS.  ADD TRNSTN_IND TO TUPC.       (P.KEBER)*     00370008
003800*9/28/2006 P.KEBER  ADD IMT_LBL TABLE SELECTS.              *     00380008
003900*4/30/2007 P.KEBER  ADD CUST_INTFC_DESC TO TMDARVS UNLOAD.  *     00390008
004000*8/02/2007 P.KEBER  ADD NEW TWEBITM COLUMNS.                *     00400008
004100*1/24/08   D.THEEL  ADD NEW PO_SHRT_CYC_IND.                *     00410008
004200*08/15/2010  B.GRAHAM - KFORCE ADD TMDARVS AND TUPC COLUMNS       00420008
004300*                       WR35681, WR37044, WR37184, WR38861        00430008
004400*02/17/2015  C PARMLEY- CHANGE TO ALLOW 8 DIGIT PO TO BE PASSED   00440008
004500*                       TO TASNORD TABLE.                         00450008
004510*05/27/2020  G BANDA  - ADD LOC_NBR TO  ASNDTL_CSR CURSOR         00451009
004520*                       ADD NEW TABLE TASDTPL. LOGIC FOR NEW      00452009
004530*                       CURSOR ASDTPL_CSR                         00453009
004510*03/2021     J KURK   - REMOVE TABLE TPOUPC                       00454010
004510*08/10/2022  J KURK   - RECOMPILE FOR COPYBOOK DSPD002            00455011
004510*04/10/2023  J KURK   - ADD LOC_NBR TO TASNORD TABLE              00456012
004600*************************************************************     00460008
004700                                                                  00470008
004800 ENVIRONMENT DIVISION.                                            00480008
004900                                                                  00490008
005000 INPUT-OUTPUT SECTION.                                            00500008
005100                                                                  00510008
005200 FILE-CONTROL.                                                    00520008
005300                                                                  00530008
005400     SELECT PO-NBR-FILE                                           00540008
005500         ASSIGN         TO UT-S-PO01.                             00550008
005600     SELECT TBLE-FILE                                             00560008
005700         ASSIGN         TO UT-S-TBL01.                            00570008
005800     SELECT CONTROL-FILE                                          00580008
005900         ASSIGN         TO UT-S-CTL01.                            00590008
006000                                                                  00600008
006100 DATA DIVISION.                                                   00610008
006200                                                                  00620008
006300 FILE SECTION.                                                    00630008
006400     COPY DSFD001.                                                00640008
006500/                                                                 00650008
006600 WORKING-STORAGE SECTION.                                         00660008
006700                                                                  00670008
006800     COPY DSRD002.                                                00680008
006900                                                                  00690008
007000     COPY DSWS008.                                                00700008
007100                                                                  00710008
007200     COPY DSWS009.                                                00720008
007300                                                                  00730008
007400     COPY DSWS010.                                                00740008
007500                                                                  00750008
007600     COPY DPWS004.                                                00760008
007700/                                                                 00770008
007800 01  OTHER-CRAPOLA.                                               00780008
007900*CLP 02/17/15 START                                               00790008
008000     05  HOLD-PO-NBR-C8               PIC X(22) VALUE SPACES.     00800008
008100*CLP 02/17/15 END                                                 00810008
008200     05  PV-HOLD-UPC-INTR-UPC-ID      PIC S9(9) COMP VALUE ZERO.  00820008
008300     05  DK-TRIP-NULL-ID              PIC S9(4) COMP VALUE ZERO.  00830008
008300     05  DK-TRN-RLSE-NULL             PIC S9(4) COMP VALUE ZERO.  00831025
008400     05  DK-PRC-CDE-NULL-ID           PIC S9(4) COMP VALUE ZERO.  00840008
008500     05  PV-WRITE-COUNT               PIC S9(9) COMP-3 VALUE      00850008
008600                                                 ZERO.            00860008
008700     05  PV-DISP-NBR                  PIC Z(17)9.                 00870008
008800     05  PV-WHEN-COMPILED.                                        00880008
008900         10  PV-COMPILE-DATE          PIC X(08).                  00890008
009000         10  PV-COMPILE-TIME          PIC X(08).                  00900008
009100     05  PV-HOLD-UPC-NBR              PIC 9(15) VALUE ZERO.       00910008
009200     05  PV-HOLD-UPC-REDEF REDEFINES PV-HOLD-UPC-NBR.             00920008
009300         10  FILLER                   PIC 9(06).                  00930008
009400         10  PV-HOLD-UPC-SKU          PIC 9(08).                  00940008
009500         10  FILLER                   PIC 9(01).                  00950008
009600                                                                  00960008
009700 01  PT-TRIP-TABLE.                                               00970008
009800     05  PT-TRIPS OCCURS 1500 TIMES INDEXED BY PT-TRIP-IDX.       00980008
009900         10  PT-TRIP                  PIC S9(08) COMP.            00990008
010000/                                                                 01000008
010100*                                                                 01010008
010200*  COMMUNICATIONS AREA FOR PROD TO TEST UTILITIES                 01020008
010300*  CONTAINS DCLGENS FOR ALL TABLES INVOLVED                       01030008
010400     COPY DSWS011.                                                01040008
010500*                                                                 01050008
010600*  CURSOR TO PULL BACK TINPKSU DATA                               01060008
010700*                                                                 01070008
010800     EXEC SQL                                                     01080008
010900       DECLARE INPKSU_CSR CURSOR FOR                              01090008
011000         SELECT                                                   01100008
011100             SHIPT_UNT_ID                                         01110008
011200            ,PO_NBR                                               01120008
011300            ,SEQ_NBR                                              01130008
011400         FROM                                                     01140008
011500             TINPKSU                                              01150008
011600         WHERE PO_NBR           = :HOLD-PO-NBR                    01160008
011700         WITH UR                                                  01170008
011800     END-EXEC.                                                    01180008
011900/                                                                 01190008
010600*  CURSOR TO PULL BACK TTRDPRT DATA                               01191019
010700*                                                                 01192019
010800     EXEC SQL                                                     01193019
010900       DECLARE TRDPRT_CSR CURSOR FOR                              01194019
011000         SELECT                                                   01195019
011100             TP_DKEY                                              01196019
011200            ,ENT_ID                                               01197020
011300            ,VEND_INCHG_ID                                        01198020
011300            ,VEND_INCHG_ID_DESC                                   01199020
011300            ,NETWK_ID                                             01199120
011300            ,KOHL_INCHG_ID                                        01199220
011300            ,KOHL_INCHG_ID_DESC                                   01199320
011300            ,SEND_FMT_VER_CDE                                     01199420
011300            ,SEND_FMT_NME                                         01199520
011300            ,LAST_SEND_CNTL_NBR                                   01199620
011300            ,SEND_CNTL_NBR_CDE                                    01199720
011300            ,OVRRD_SND_CNTL_NBR                                   01199820
011300            ,OVRRD_SND_CNTL_ID                                    01199920
011300            ,RECV_FMT_VER_CDE                                     01200020
011300            ,RECV_FMT_NME                                         01200120
011300            ,LAST_RECV_CNTL_NBR                                   01200220
011300            ,RECV_CNTL_NBR_CDE                                    01200320
011300            ,OVRRD_RCV_CNTL_NBR                                   01200420
011300            ,OVRRD_RCV_CNTL_ID                                    01200520
011300            ,SETUP_DTE                                            01200620
011300            ,LAST_CHG_DTE                                         01200720
011300            ,LAST_CHG_UID                                         01200820
011300            ,ACTV_DTE                                             01200920
011300            ,INACTV_DTE                                           01201020
011300            ,SER_LVL_CDE                                          01201120
011300            ,NOTES_TXT                                            01201220
011300            ,LAST_CALL_DTE                                        01201320
011300            ,NEXT_CALL_DTE                                        01201420
011300            ,SEND_AUTH_INFO_ID                                    01201520
011300            ,SEND_AUTH_INF_DESC                                   01201620
011300            ,SEND_SEC_INFO_ID                                     01201720
011300            ,SEND_SEC_INFO_DESC                                   01201820
011300            ,SEND_DATA_ELEM_IND                                   01201920
011300            ,SEND_SEG_TERM_IND                                    01202020
011300            ,SEND_SUB_ELEM_IND                                    01202120
011300            ,SEND_ACK_REQD_IND                                    01202220
011300            ,INTRCONN_NETWK_IND                                   01202320
011300            ,FA_COM_MTHD_CDE                                      01202420
011400         FROM                                                     01203020
011500             TTRDPRT                                              01203120
011600         WHERE ENT_ID           = :HOLD-ENT-ID                    01203220
011700         WITH UR                                                  01203320
011800     END-EXEC.                                                    01203420
011900/                                                                 01203520
012000*                                                                 01204020
012100*  CURSOR TO PULL BACK TSHUUPC DATA                               01210008
012200*                                                                 01220008
012300     EXEC SQL                                                     01230008
012400       DECLARE SHUUPC-CSR CURSOR FOR                              01240008
012500         SELECT                                                   01250008
012600             SHIPT_UNT_ID                                         01260008
012700            ,TRN_NBR                                              01270008
012800            ,TRN_LNE_NBR                                          01280008
012900            ,TRN_TYP_CDE                                          01290008
013000            ,UPC_NBR                                              01300008
013100            ,SHPD_QTY                                             01310008
013200            ,RCVR_SEQ_NBR                                         01320008
013300         FROM                                                     01330008
013400             TSHUUPC                                              01340008
013500         WHERE SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID             01350008
013600         WITH UR                                                  01360008
013700     END-EXEC.                                                    01370008
013800                                                                  01380008
013900/                                                                 01390008
014000*                                                                 01400008
014100*  CURSOR TO PULL BACK TSHPUNT DATA                               01410008
014200*                                                                 01420008
014300     EXEC SQL                                                     01430008
014400       DECLARE SHPUNT_CSR CURSOR FOR                              01440008
014500         SELECT                                                   01450008
014600             SHIPT_UNT_ID                                         01460008
014700            ,ORGN_OPER_UNT_ID                                     01470008
014800            ,ORGN_FCLTY_ID                                        01480008
014900            ,DEST_OPER_UNT_ID                                     01490008
015000            ,DEST_FCLTY_ID                                        01500008
015100            ,SHIPT_UNT_SRC_ID                                     01510008
015200            ,HIER_LVL_CDE                                         01520008
015300            ,NEXT_SHIPT_UNT_ID                                    01530008
015400            ,ORIG_SHIPT_UNT_ID                                    01540008
015500            ,ACTV_IND                                             01550008
015600            ,CRE_DTE                                              01560008
015700            ,CRE_TM                                               01570008
015800            ,CRE_USR_ID                                           01580008
015900            ,CRE_PGM_NM                                           01590008
016000         FROM                                                     01600008
016100             TSHPUNT                                              01610008
016200         WHERE SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID             01620008
016300         WITH UR                                                  01630008
016400     END-EXEC.                                                    01640008
016500                                                                  01650008
016600/                                                                 01660008
016700*                                                                 01670008
016800*  CURSOR TO PULL BACK TSHUNLO DATA                               01680008
016900*                                                                 01690008
017000     EXEC SQL                                                     01700008
017100       DECLARE SHUNLO_CSR CURSOR FOR                              01710008
017200         SELECT                                                   01720008
017300                   SHIPT_UNT_ID                                   01730008
017400                  ,OPER_UNT_ID                                    01740008
017500                  ,FCLTY_ID                                       01750008
017600                  ,SCN_LOC_ID                                     01760008
017700                  ,CRE_USR_ID                                     01770008
017800                  ,CRE_TMST                                       01780008
017900                  ,TRIP_ID                                        01790008
018000                  ,PRTR_TYP_CDE                                   01800008
018100                  ,LBL_PRT_BTCH_ID                                01810008
018200                  ,ACTV_CDE                                       01820008
018300         FROM                                                     01830008
018400             TSHUNLO                                              01840008
018500         WHERE SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID             01850008
018600         WITH UR                                                  01860008
018700     END-EXEC.                                                    01870008
018800/                                                                 01880008
018900*                                                                 01890008
019000*  CURSOR TO PULL BACK TPURCHS DATA                               01900008
019100*                                                                 01910008
019200     EXEC SQL                                                     01920008
019300       DECLARE PURCHS_CSR CURSOR FOR                              01930008
019400         SELECT                                                   01940008
019500                PO_NBR                                            01950008
019600               ,VER_NBR                                           01960008
019700               ,VER_STATUS_CDE                                    01970008
019800               ,PO_TYP_CDE                                        01980008
019900               ,PO_CATEG_CDE                                      01990008
020000               ,EDI_IND                                           02000008
020100               ,TOT_UNT_QTY                                       02010008
020200               ,TOT_VAL_COST_AMT                                  02020008
020300               ,TOT_VAL_RTL_AMT                                   02030008
020400               ,TOT_MU_PCT                                        02040008
020500               ,TOT_SKUS_QTY                                      02050008
020600               ,IMPRT_AGNT_PO_NBR                                 02060008
020700               ,IMPRT_ORD_OFF_NAME                                02070008
020800               ,IMPRT_VEND_NAME                                   02080008
020900               ,IMPRT_FCTRY_NAME                                  02090008
021000               ,IMPRT_CNTRY_NAME                                  02100008
021100               ,VEND_CNTRY_NAME                                   02110008
021200               ,NEW_STR_PO_IND                                    02120008
021300               ,IMPRT_PO_IND                                      02130008
021400               ,IMPRT_AGNT_PO_IND                                 02140008
021500               ,STATUS_TMST                                       02150008
021600               ,LAST_UPD_TMST                                     02160008
021700               ,EDI_REXMIT_IND                                    02170008
021800               ,EDI_REXMIT_TMST                                   02180008
021900               ,DIR_STR_IND                                       02190008
022000               ,LAST_UPD_BY_UID                                   02200008
022100               ,APP_BY_UID                                        02210008
022200               ,OTB_PER_NBR                                       02220008
022300               ,DEPT_NBR                                          02230008
022400               ,ENT_ID                                            02240008
022500               ,STATUS_CDE                                        02250008
022600               ,CRE_BY_UID                                        02260008
022700               ,REJ_CT                                            02270008
022800               ,REJ_UID                                           02280008
022900               ,ORD_DTE                                           02290008
023000               ,REVISION_CT                                       02300008
023100               ,ADR_SEQ_NBR                                       02310008
023200               ,DEST_KNOWN_IND                                    02320008
023300               ,RLSE_IND                                          02330008
023400               ,RLSE_DTE                                          02340008
023500               ,ANLYS_HOLD_IND                                    02350008
023600               ,PLCMNT_CNTRY_CDE                                  02360008
023700               ,PROD_CNTRY_CDE                                    02370008
023800               ,UNT_PER_CBMT_QTY                                  02380008
023900               ,TKT_FMT_NBR                                       02390008
024000               ,TKT_FMT_DESC                                      02400008
024100               ,CRE_TMST                                          02410008
024200               ,PRG_LAST_ACTVY_DTE                                02420008
024300               ,PKGNG_CDE                                         02430008
024400               ,SEASET_YR                                         02440008
024500               ,SEASET_SHRT_NM                                    02450008
024600               ,QTA_CTG_CDE                                       02460008
024700               ,PO_IN_RMS_IND                                     02470008
024800               ,RMS_PO_UPD_TMST                                   02480008
024900               ,DUP_SKU_IND                                       02490008
025000               ,ORIG_PKGNG_CDE                                    02500008
025100               ,IMPRT_VND_ID                                      02510008
025200               ,IMPRT_FCTRY_ID                                    02520008
025300               ,DERVD_LBL_TYP_CDE                                 02530008
025400               ,DELY_ID                                           02540008
025500               ,PO_SHRT_CYC_IND                                   02550008
025600               ,WHSE_RPLNT_IND                                    02560008
025700         FROM                                                     02570008
025800             TPURCHS                                              02580008
025900         WHERE PO_NBR           = :HOLD-PO-NBR                    02590008
026000         WITH UR                                                  02600008
026100     END-EXEC.                                                    02610008
026200/                                                                 02620008
026300*                                                                 02630008
026400*  CURSOR TO PULL BACK TPURITM DATA                               02640008
026500*                                                                 02650008
026600     EXEC SQL                                                     02660008
026700       DECLARE PURITM_CSR CURSOR FOR                              02670008
026800         SELECT                                                   02680008
026900                PO_NBR                                            02690008
027000               ,VER_NBR                                           02700008
027100               ,PO_LNE_NBR                                        02710008
027200               ,VER_STATUS_CDE                                    02720008
027300               ,SKU_SEQ_NBR                                       02730008
027400               ,CL_NBR                                            02740008
027500               ,VEND_STYL_NAME                                    02750008
027600               ,COLOR_DESC                                        02760008
027700               ,SIZE_DESC                                         02770008
027800               ,UM_IND                                            02780008
027900               ,UNT_QTY                                           02790008
028000               ,UNT_RTL_PR_AMT                                    02800008
028100               ,UNT_COST_AMT                                      02810008
028200               ,TOT_VAL_COST_AMT                                  02820008
028300               ,TOT_VAL_RTL_AMT                                   02830008
028400               ,MU_PCT                                            02840008
028500               ,CRE_TMST                                          02850008
028600               ,LAST_UPD_TMST                                     02860008
028700               ,ITM_NBR                                           02870008
028800               ,SKU_DESC                                          02880008
028900               ,COLOR_CDE                                         02890008
029000               ,SIZE_CDE                                          02900008
029100               ,AD_EVNT_DTE                                       02910008
029200               ,STATUS_CDE                                        02920008
029300               ,CRE_BY_UID                                        02930008
029400               ,LAST_UPD_BY_UID                                   02940008
029500               ,GP_RTL_AMT                                        02950008
029600               ,GP_QTY                                            02960008
029700               ,APP_PO_LNE_NBR                                    02970008
029800               ,PIC_ITM_IND                                       02980008
029900               ,PIC_PG_NBR                                        02990008
030000               ,PRD_1ST_COST_AMT                                  03000008
030100               ,STAT_TMST                                         03010008
030200               ,PO_PREPK_ID                                       03020008
030300               ,PREPK_RATO_QTY                                    03030008
030400               ,SHIP_TO_TMP_DC_IND                                03040008
030500               ,RMS_PO_SKU_NBR                                    03050008
030600               ,CNCLD_UNT_QTY                                     03060008
030700               ,INNR_PK_QTY                                       03070008
030800               ,OUTR_PK_QTY                                       03080008
030900         FROM                                                     03090008
031000             TPURITM                                              03100008
031100         WHERE PO_NBR        = :HOLD-PO-NBR                       03110008
031200         WITH UR                                                  03120008
031300     END-EXEC.                                                    03130008
031400                                                                  03140008
031500/                                                                 03150008
031600*                                                                 03160008
031700*  CURSOR TO PULL BACK TPOAGMT DATA                               03170008
031800*                                                                 03180008
031900     EXEC SQL                                                     03190008
032000       DECLARE POAGMT_CSR CURSOR FOR                              03200008
032100         SELECT                                                   03210008
032200                PO_NBR                                            03220008
032300               ,VER_NBR                                           03230008
032400               ,AGRMT_TYP_ID                                      03240008
032500               ,SEQ_NBR                                           03250008
032600               ,VER_STATUS_CDE                                    03260008
032700               ,TYP_CDE                                           03270008
032800               ,TKT_MKR_IND                                       03280008
032900               ,BULK_STK_TKT_IND                                  03290008
033000               ,EDI_PROMO_TXT                                     03300008
033100               ,PO_CAN_DAY_QTY                                    03310008
033200               ,AUTO_PO_CAN_IND                                   03320008
033300               ,DISC_DOL_AMT                                      03330008
033400               ,DISC_PCT                                          03340008
033500               ,DISC_PAY_DAY_QTY                                  03350008
033600               ,LAST_UPD_TMST                                     03360008
033700               ,PAYT_TERM_ID                                      03370008
033800               ,LAST_UPD_BY_UID                                   03380008
033900               ,LEADTIME_DAYS_QTY                                 03390008
034000         FROM                                                     03400008
034100             TPOAGMT                                              03410008
034200         WHERE PO_NBR        = :HOLD-PO-NBR                       03420008
034300         WITH UR                                                  03430008
034400     END-EXEC.                                                    03440008
034500                                                                  03450008
034600/                                                                 03460008
034700*                                                                 03470008
034800*  CURSOR TO PULL BACK TPOINST DATA                               03480008
034900*                                                                 03490008
035000     EXEC SQL                                                     03500008
035100       DECLARE POINST_CSR CURSOR FOR                              03510008
035200         SELECT                                                   03520008
035300                PO_NBR                                            03530008
035400               ,RECIP_CDE                                         03540008
035500               ,INSTR_NBR                                         03550008
035600               ,CRE_BY_UID                                        03560008
035700               ,CRE_TMST                                          03570008
035800         FROM                                                     03580008
035900             TPOINST                                              03590008
036000         WHERE PO_NBR        = :HOLD-PO-NBR                       03600008
036100         WITH UR                                                  03610008
036200     END-EXEC.                                                    03620008
036300                                                                  03630008
036400/                                                                 03640008
036500*                                                                 03650008
036600*  CURSOR TO PULL BACK TIMPORL DATA                               03660008
036700*                                                                 03670008
036800     EXEC SQL                                                     03680008
036900       DECLARE IMPORL_CSR CURSOR FOR                              03690008
037000         SELECT                                                   03700008
037100                PO_NBR                                            03710008
037200               ,VER_NBR                                           03720008
037300               ,VER_STATUS_CDE                                    03730008
037400               ,CONSLR_RLSE_CDE                                   03740008
037500               ,CONSLR_REQR_DTE                                   03750008
037600               ,CONSLR_ACTL_DTE                                   03760008
037700               ,CONSLR_ACTL_TM                                    03770008
037800               ,CSTM_BKR_RLSE_CDE                                 03780008
037900               ,CSTM_BKR_REQR_DTE                                 03790008
038000               ,CSTM_BKR_ACTL_DTE                                 03800008
038100               ,CSTM_BKR_ACTL_TM                                  03810008
038200               ,TKT_PRTR_RLSE_CDE                                 03820008
038300               ,TKT_PRTR_REQR_DTE                                 03830008
038400               ,TKT_PRTR_ACTL_DTE                                 03840008
038500               ,TKT_PRTR_ACTL_TM                                  03850008
038600               ,DCONSLR_RLSE_CDE                                  03860008
038700               ,DCONSLR_REQR_DTE                                  03870008
038800               ,DCONSLR_ACTL_DTE                                  03880008
038900               ,DCONSLR_ACTL_TM                                   03890008
039000               ,LAST_UPD_TMST                                     03900008
039100               ,LAST_UPD_BY_UID                                   03910008
039200               ,DCONSLR_ENT_ID                                    03920008
039300         FROM                                                     03930008
039400             TIMPORL                                              03940008
039500         WHERE PO_NBR        = :HOLD-PO-NBR                       03950008
039600         WITH UR                                                  03960008
039700     END-EXEC.                                                    03970008
039800                                                                  03980008
039900/                                                                 03990008
040000*                                                                 04000008
040100*  CURSOR TO PULL BACK TALLPLN DATA                               04010008
040200*                                                                 04020008
040300     EXEC SQL                                                     04030008
040400       DECLARE ALLPLN_CSR CURSOR FOR                              04040008
040500         SELECT                                                   04050008
040600                PO_NBR                                            04060008
040700               ,PO_LNE_NBR                                        04070008
040800               ,PLAN_NBR                                          04080008
040900               ,CURR_SPLIT_QTY                                    04090008
041000               ,DEST_NBR                                          04100008
041100               ,STATUS_CDE                                        04110008
041200               ,DC_SPLIT_QTY                                      04120008
041300               ,SPLIT_REQ_ID                                      04130008
041400               ,SPLIT_CRE_DATE                                    04140008
041500               ,SPLIT_CRE_ID                                      04150008
041600               ,SPLIT_UPD_DATE                                    04160008
041700               ,SPLIT_UPD_ID                                      04170008
041800               ,DISTRO_REQ_ID                                     04180008
041900               ,DISTRO_CRE_DATE                                   04190008
042000               ,DISTRO_CRE_ID                                     04200008
042100               ,DISTRO_KEY_SEQ_NBR                                04210008
042200               ,SPLIT_KEY_SEQ_NBR                                 04220008
042300               ,ALOC_PACK_QTY                                     04230008
042400               ,PK_SIZE_RND_CDE                                   04240008
042500               ,ALLOC_OUTR_PK_QTY                                 04250008
042600               ,SHTG_PRRT_OPT_CDE                                 04260008
042700               ,OVRG_PRRT_OPT_CDE                                 04270008
042800               ,EXST_SHTG_THRS_IND                                04280008
042900         FROM                                                     04290008
043000             TALLPLN                                              04300008
043100         WHERE PO_NBR        = :HOLD-PO-NBR                       04310008
043200         WITH UR                                                  04320008
043300     END-EXEC.                                                    04330008
043400                                                                  04340008
043500/                                                                 04350008
043600*                                                                 04360008
043700*  CURSOR TO PULL BACK TPLNSHP DATA                               04370008
043800*                                                                 04380008
043900     EXEC SQL                                                     04390008
044000       DECLARE PLNSHP_CSR CURSOR FOR                              04400008
044100         SELECT                                                   04410008
044200                SHIPT_NBR                                         04420008
044300               ,VER_NBR                                           04430008
044400               ,VER_STATUS_CDE                                    04440008
044500               ,SHIPT_TYP_CDE                                     04450008
044600               ,SHIPT_DEST_NBR                                    04460008
044700               ,SHIPT_POINT_TXT                                   04470008
044800               ,FOB_POINT_TXT                                     04480008
044900               ,FRGT_PAYT_CDE                                     04490008
045000               ,VEND_FRGT_PCT                                     04500008
045100               ,KOHLS_FRGT_PCT                                    04510008
045200               ,LATE_SHIPT_IND                                    04520008
045300               ,EARLY_SHIPT_IND                                   04530008
045400               ,PARTIAL_SHIPT_IND                                 04540008
045500               ,BCKORDS_PERMTD_IND                                04550008
045600               ,PORT_ENTR_DESC                                    04560008
045700               ,STRT_FCTRY_DTE                                    04570008
045800               ,LAST_FCTRY_DTE                                    04580008
045900               ,DONT_SHIP_BEF_DTE                                 04590008
046000               ,CAN_IFNOT_SHIP_DTE                                04600008
046100               ,EXT_CAN_DTE                                       04610008
046200               ,LAST_UPD_TMST                                     04620008
046300               ,STATUS_CDE                                        04630008
046400               ,ENT_ID                                            04640008
046500               ,PO_NBR                                            04650008
046600               ,LAST_UPD_BY_UID                                   04660008
046700               ,FOB_CDE                                           04670008
046800               ,POE_CDE                                           04680008
046900         FROM                                                     04690008
047000             TPLNSHP                                              04700008
047100         WHERE PO_NBR        = :HOLD-PO-NBR                       04710008
047200         WITH UR                                                  04720008
047300     END-EXEC.                                                    04730008
047400                                                                  04740008
047500/                                                                 04750008
047600*                                                                 04760008
047700*  CURSOR TO PULL BACK TSK     DATA                               04770008
047800*                                                                 04780008
047900     EXEC SQL                                                     04790008
048000       DECLARE SK_CSR CURSOR FOR                                  04800008
048100         SELECT                                                   04810008
048200           MERCH_DEPT_NMBR                                        04820008
048300          ,MERCH_CLASS_NMBR                                       04830008
048400          ,SEQ_NMBR                                               04840008
048500          ,CUM_SALES_UNIT_QTY                                     04850008
048600          ,RTL_UNIT_RCVD_QTY                                      04860008
048700          ,COST_UNIT_MSRMNT                                       04870008
048800          ,RTL_UNIT_MSRMNT                                        04880008
048900          ,UNIT_COST_AMT                                          04890008
049000          ,CUR_UNIT_RTL_AMT                                       04900008
049100          ,ORIG_UNIT_RTL_AMT                                      04910008
049200          ,VNDR_INNR_PACK_QTY                                     04920008
049300          ,SHPMT_COUNT_QTY                                        04930008
049400          ,VENDOR_STYLE_CODE                                      04940008
049500          ,STAT_CHNGD_DATE                                        04950008
049600          ,STATUS_CODE                                            04960008
049700          ,AUTO_RORD_MTH_CODE                                     04970008
049800          ,RTL_CST_CVRSN_FCTR                                     04980008
049900          ,SETUP_DATE                                             04990008
050000          ,PRICE_CHNG_DATE                                        05000008
050100          ,GROUP_CODE                                             05010008
050200          ,SKU_DESC                                               05020008
050300          ,SIZE_DESC                                              05030008
050400          ,COLOR_DESC                                             05040008
050500          ,REORDER_FRMT_CODE                                      05050008
050600          ,MERCH_DIV_CODE                                         05060008
050700          ,DMM_NMBR                                               05070008
050800          ,BUYER_NMBR                                             05080008
050900          ,VENDOR_NMBR                                            05090008
051000          ,VNDR_IN_HSE_NMBR                                       05100008
051100          ,MKDN_PGM_CODE                                          05110008
051200          ,LOWST_UNIT_RTL_AMT                                     05120008
051300          ,LOW_RTL_PRICE_DATE                                     05130008
051400          ,ITEM_NMBR                                              05140008
051500          ,GP_RTL_AMT                                             05150008
051600          ,ORIG_GP_QTY                                            05160008
051700          ,ORIG_GP_RTL_AMT                                        05170008
051800          ,FS_RPT_IND                                             05180008
051900          ,GP_QTY                                                 05190008
052000          ,MULT_PR_PT_IND                                         05200008
052100          ,PLU_DWNLD_EXCL_IND                                     05210008
052200          ,LAST_PO_REV_DTE                                        05220008
052300          ,PO_REV_DAY_NBR                                         05230008
052400          ,PO_REV_SUN_WK_NBR                                      05240008
052500          ,PO_REV_MON_WK_NBR                                      05250008
052600          ,PO_REV_TUE_WK_NBR                                      05260008
052700          ,PO_REV_WED_WK_NBR                                      05270008
052800          ,PO_REV_THU_WK_NBR                                      05280008
052900          ,PO_REV_FRI_WK_NBR                                      05290008
053000          ,PO_REV_SAT_WK_NBR                                      05300008
053100          ,CENT_STK_CDE                                           05310008
053200          ,MEITGP_NBR                                             05320008
053300          ,SKU_TYP_CDE                                            05330008
053400          ,VEND_OUTR_PACK_QTY                                     05340008
053500          ,LONG_VENDOR_STYLE                                      05350008
053600          ,SIZE_CDE                                               05360008
053700          ,LONG_SIZE_DESC                                         05370008
053800          ,COLOR_CDE                                              05380008
053900          ,LONG_COLOR_DESC                                        05390008
054000          ,STICKER_NBR                                            05400008
054100          ,ENT_ID                                                 05410008
054200          ,TKT_FMT_ID                                             05420008
054300          ,KY_ITM_IND                                             05430008
054400          ,VS_CHARTC_CDE                                          05440008
054500          ,VS_CHARTC_SEQ_NBR                                      05450008
054600          ,UNT_COST_1ST_AMT                                       05460008
054700          ,REGN_PRIC_IND                                          05470008
054800         FROM                                                     05480008
054900             TSK                                                  05490008
055000         WHERE ITEM_NMBR     = :HOLD-ITEM-NBR                     05500008
055100         WITH UR                                                  05510008
055200     END-EXEC.                                                    05520008
055300                                                                  05530008
055400/                                                                 05540008
055500*                                                                 05550008
055600*  CURSOR TO PULL BACK TSKST   DATA                               05560008
055700*                                                                 05570008
055800     EXEC SQL                                                     05580008
055900       DECLARE SKST-CSR CURSOR FOR                                05590008
056000         SELECT                                                   05600008
056100              ITEM_NMBR                                           05610008
056200             ,LOC_NBR                                             05620008
056300             ,LAST_SALE_DATE                                      05630008
056400             ,LAST_RCVD_DATE                                      05640008
056500             ,ONHAND_QTY                                          05650008
056600             ,FIRST_RCVD_DATE                                     05660008
056700             ,FIRST_SALE_DATE                                     05670008
056800             ,YTD_SALES_UNIT_QTY                                  05680008
056900             ,YTD_SALES_AMT                                       05690008
057000             ,LAST_UPD_TMST                                       05700008
057100         FROM                                                     05710008
057200             TSKST                                                05720008
057300         WHERE ITEM_NMBR     = :HOLD-ITEM-NBR                     05730008
057400         WITH UR                                                  05740008
057500     END-EXEC.                                                    05750008
057600                                                                  05760008
057700/                                                                 05770008
057800*                                                                 05780008
057900*  CURSOR TO PULL BACK TPPCPRC DATA                               05790008
058000*                                                                 05800008
058100     EXEC SQL                                                     05810008
058200       DECLARE PPCPRC_CSR CURSOR FOR                              05820008
058300         SELECT                                                   05830008
058400              TSK_ITM_NBR                                         05840008
058500             ,STRT_TMST                                           05850008
058600             ,STR_NBR                                             05860008
058700             ,END_TMST                                            05870008
058800             ,MEITGP_NBR                                          05880008
058900             ,RTL_AMT                                             05890008
059000             ,STATUS_CDE                                          05900008
059100             ,UID_NBR                                             05910008
059200         FROM                                                     05920008
059300             TPPCPRC                                              05930008
059400         WHERE TSK_ITM_NBR   = :HOLD-ITEM-NBR                     05940008
059500         WITH UR                                                  05950008
059600     END-EXEC.                                                    05960008
059700                                                                  05970008
059800/                                                                 05980008
059900*                                                                 05990008
060000*  CURSOR TO PULL BACK TUPCSKU DATA                               06000008
060100*                                                                 06010008
060200     EXEC SQL                                                     06020008
060300       DECLARE UPCSKU_CSR CURSOR FOR                              06030008
060400         SELECT                                                   06040008
060500                UPC_NBR                                           06050008
060600               ,ITEM_NBR                                          06060008
060700               ,EDI_ORD_IND                                       06070008
060800               ,PLU_DWNLD_IND                                     06080008
060900               ,XREF_CRE_DTE                                      06090008
061000               ,UPC_DESC                                          06100008
061100               ,CERT_IND                                          06110008
061200               ,CERT_DTE                                          06120008
061300               ,UPC_SRC_IND                                       06130008
061400               ,UMDCLN_IND                                        06140008
061500         FROM                                                     06150008
061600             TUPCSKU                                              06160008
061700         WHERE ITEM_NBR     = :HOLD-ITEM-NBR                      06170008
061800         WITH UR                                                  06180008
061900     END-EXEC.                                                    06190008
062000                                                                  06200008
062100/                                                                 06210008
062200*                                                                 06220008
062300*  CURSOR TO PULL BACK TUPC DATA                                  06230008
062400*                                                                 06240008
062500     EXEC SQL                                                     06250008
062600       DECLARE UPC-CSR CURSOR FOR                                 06260008
062700         SELECT                                                   06270008
062800                UPC_ID                                            06280008
062900               ,UPC_NBR                                           06290008
063000               ,SUB_CL_MDSEAR_ID                                  06300008
063100               ,VS_ID                                             06310008
063200               ,INTR_UPC_ID                                       06320008
063300               ,EFF_BEG_DTE                                       06330008
063400               ,EFF_END_DTE                                       06340008
063500               ,UPC_TYP_CDE                                       06350008
063600               ,KOHLS_SIZE_CDE                                    06360008
063700               ,NRF_SIZE_IND                                      06370008
063800               ,NRF_CLOR_CDE                                      06380008
063900               ,NRF_CLOR_IND                                      06390008
064000               ,CSTM_CLOR_DESC                                    06400008
064100               ,EDI_ORD_IND                                       06410008
064200               ,PREPK_IND                                         06420008
064300               ,GP_CDE                                            06430008
064400               ,CERTD_IND                                         06440008
064500               ,CERTD_DTE                                         06450008
064600               ,RPLNMT_IND                                        06460008
064700               ,KY_ITM_IND                                        06470008
064800               ,UNT_COST_1ST_AMT                                  06480008
064900               ,UPC_SRC_CDE                                       06490008
065000               ,INNR_PK_QTY                                       06500008
065100               ,OUTR_PK_QTY                                       06510008
065200               ,SEA_SEQ_NBR                                       06520008
065300               ,CRE_BY_USR_ID                                     06530008
065400               ,LAST_UPD_BY_USR_ID                                06540008
065500               ,LAST_UPD_TMST                                     06550008
065600               ,WD_UM_QTY                                         06560008
065700               ,DPTH_UM_QTY                                       06570008
065800               ,HT_UM_QTY                                         06580008
065900               ,SIZE_UM_CDE                                       06590008
066000               ,WT_UM_QTY                                         06600008
066100               ,WT_UM_CDE                                         06610008
066200               ,POG_IND                                           06620008
066300               ,REGN_PRIC_IND                                     06630008
066400               ,TX_PRD_CDE_SEQ_NBR                                06640008
066500               ,CUSTFACG_CLOR_DESC                                06650008
066600               ,INTR_UPC_DESC                                     06660008
066700               ,TRNSTN_IND                                        06670008
066800               ,PO_SHRT_CYC_IND                                   06680008
066900               ,TST_PRD_TYP_SEQ_NBR                               06690008
067000               ,WHSE_RPLNT_IND                                    06700008
067100         FROM                                                     06710008
067200             TUPC                                                 06720008
067300         WHERE UPC_NBR = :HOLD-UPC-NBR                            06730008
067400           AND EFF_END_DTE IS NULL                                06740008
067500         WITH UR                                                  06750008
067600     END-EXEC.                                                    06760008
067700                                                                  06770008
067800/                                                                 06780008
067900*                                                                 06790008
068000*  CURSOR TO PULL BACK TMDSEAR DATA                               06800008
068100*                                                                 06810008
068200     EXEC SQL                                                     06820008
068300       DECLARE MDSEAR_CSR CURSOR FOR                              06830008
068400         SELECT                                                   06840008
068500                OPERCO_NBR                                        06850008
068600               ,GMA_NBR                                           06860008
068700               ,DMA_NBR                                           06870008
068800               ,DEPT_NBR                                          06880008
068900               ,MAJ_CL_NBR                                        06890008
069000               ,SUB_CL_NBR                                        06900008
069100               ,MDSELV_CDE                                        06910008
069200               ,MDSEAR_DKEY                                       06920008
069300               ,CHG_DTE                                           06930008
069400               ,CRE_DTE                                           06940008
069500               ,STRT_DTE                                          06950008
069600               ,END_DTE                                           06960008
069700               ,GEN_MDSE_TYP_CDE                                  06970008
069800               ,MDSEAR_DESC                                       06980008
069900               ,BYR_NBR                                           06990008
070000               ,LIST_SEQ_NBR                                      07000008
070100               ,PHY_INV_OH_VAR_PCT                                07010008
070200               ,PHY_INV_OH_VAR_QTY                                07020008
070300         FROM                                                     07030008
070400             TMDSEAR                                              07040008
070500         WHERE MDSEAR_DKEY  = :HOLD-SUB-CL-MDSEAR-ID              07050008
070600         WITH UR                                                  07060008
070700     END-EXEC.                                                    07070008
070800                                                                  07080008
070900/                                                                 07090008
071000*                                                                 07100008
071100*  CURSOR TO PULL BACK TMDARVS DATA                               07110008
071200*                                                                 07120008
071300     EXEC SQL                                                     07130008
071400       DECLARE MDARVS_CSR CURSOR FOR                              07140008
071500         SELECT                                                   07150008
071600                SUB_CL_MDSEAR_ID                                  07160008
071700               ,VS_ID                                             07170008
071800               ,ACTV_IND                                          07180008
071900               ,VS_DESC                                           07190008
072000               ,STKR_NBR                                          07200008
072100               ,TKT_TYP_SEQ_NBR                                   07210008
072200               ,LBL_SEQ_NBR                                       07220008
072300               ,HNG_FOLD_SEQ_NBR                                  07230008
072400               ,KY_CLSN_SEQ_NBR                                   07240008
072500               ,FBRCN_SEQ_NBR                                     07250008
072600               ,FNSH_SEQ_NBR                                      07260008
072700               ,RMS_STYL_ID                                       07270008
072800               ,STYL_RECLS_IND                                    07280008
072900               ,RTL_CLSN_SEQ_NBR                                  07290008
073000               ,DEPT_NBR                                          07300008
073100               ,MAJ_CL_NBR                                        07310008
073200               ,SUB_CL_NBR                                        07320008
073300               ,ESL_SEQ_NBR                                       07330008
073400               ,RPT_HIER_SEQ_NBR                                  07340008
073500               ,BDY_STYL_SEQ_NBR                                  07350008
073600               ,CONST_SEQ_NBR                                     07360008
073700               ,FUNC_SEQ_NBR                                      07370008
073800               ,GNDR_SEQ_NBR                                      07380008
073900               ,PATRN_SEQ_NBR                                     07390008
074000               ,SLHTT_SEQ_NBR                                     07400008
074100               ,CLLCTN_SEQ_NBR                                    07410008
074200               ,MAP_UNT_RTL_AMT                                   07420008
074300               ,C_O_ORGN_CDE                                      07430008
074400               ,PRIC_TIER_SEQ_NBR                                 07440008
074500               ,LFSTYL_SEQ_NBR                                    07450008
074600               ,CUST_INTFC_DESC                                   07460008
074700               ,FSHN_PYRMD_SEQ_NBR                                07470008
074800               ,PRFL_GP_NM_TXT                                    07480008
074900               ,CTG_SEQ_NBR                                       07490008
075000               ,MAJ_CTG_SEQ_NBR                                   07500008
075100               ,MTRL_SEQ_NBR                                      07510008
075200               ,PRIM_TRND_SEQ_NBR                                 07520008
075300               ,SEC_TRND_SEQ_NBR                                  07530008
075400               ,ATTR_1_SEQ_NBR                                    07540008
075500               ,ATTR_2_SEQ_NBR                                    07550008
075600               ,NW_SLHTT_SEQ_NBR                                  07560008
075700         FROM                                                     07570008
075800             TMDARVS                                              07580008
075900         WHERE SUB_CL_MDSEAR_ID  = :HOLD-SUB-CL-MDSEAR-ID         07590008
076000           AND VS_ID             = :HOLD-VS-ID                    07600008
076100         WITH UR                                                  07610008
076200     END-EXEC.                                                    07620008
076300                                                                  07630008
076400/                                                                 07640008
076500*                                                                 07650008
076600*  CURSOR TO PULL BACK TSKXREF DATA                               07660008
076700*                                                                 07670008
076800     EXEC SQL                                                     07680008
076900       DECLARE SKXREF_CSR CURSOR FOR                              07690008
077000         SELECT                                                   07700008
077100                DEPT_NBR                                          07710008
077200               ,CL_NBR                                            07720008
077300               ,SKU_SEQ_NBR                                       07730008
077400               ,SKU_STAT_CDE                                      07740008
077500               ,ITM_NBR                                           07750008
077600               ,INTR_UPC_ID                                       07760008
077700               ,DEPT                                              07770008
077800               ,CLASS                                             07780008
077900               ,SUBCLASS                                          07790008
078000               ,SKU                                               07800008
078100         FROM                                                     07810008
078200             TSKXREF                                              07820008
078300         WHERE SKU = :HOLD-SKU                                    07830008
078400         WITH UR                                                  07840008
078500     END-EXEC.                                                    07850008
078600                                                                  07860008
078700/                                                                 07870008
078800*                                                                 07880008
078900*  CURSOR TO PULL BACK TUPCPLS DATA                               07890008
079000*                                                                 07900008
079100     EXEC SQL                                                     07910008
079200       DECLARE UPCPLS_CSR CURSOR FOR                              07920008
079300         SELECT                                                   07930008
079400                UPC_ID                                            07940008
079500               ,OPERCO_NBR                                        07950008
079600               ,STR_NBR                                           07960008
079700               ,EFF_BEG_TMST                                      07970008
079800               ,EFF_END_TMST                                      07980008
079900               ,UPC_STAT_CDE                                      07990008
080000               ,UNT_COST_AMT                                      08000008
080100               ,UNT_RTL_AMT                                       08010008
080200               ,MEITGP_NBR                                        08020008
080300               ,CRE_BY_USR_ID                                     08030008
080400               ,CRE_TMST                                          08040008
080500               ,ITM_NBR                                           08050008
080600               ,PLU_IND                                           08060008
080700               ,UPC_STAT_CHG_DTE                                  08070008
080800               ,UNT_RTL_CHG_DTE                                   08080008
080900               ,ORIG_CLR_DTE                                      08090008
081000               ,MKDN_CDE                                          08100008
081100         FROM                                                     08110008
081200             TUPCPLS                                              08120008
081300         WHERE UPC_ID = :HOLD-UPC-ID                              08130008
081400           AND EFF_END_TMST IS NULL                               08140008
081500         WITH UR                                                  08150008
081600     END-EXEC.                                                    08160008
081700                                                                  08170008
081800/                                                                 08180008
081900*                                                                 08190008
082000*  CURSOR TO PULL BACK TVNDSTL DATA                               08200008
082100*                                                                 08210008
082200     EXEC SQL                                                     08220008
082300       DECLARE VNDSTL_CSR CURSOR FOR                              08230008
082400         SELECT                                                   08240008
082500                VS_ID                                             08250008
082600               ,ENT_ID                                            08260008
082700               ,VS_NBR                                            08270008
082800               ,EFF_BEG_DTE                                       08280008
082900               ,EFF_END_DTE                                       08290008
083000               ,COST_UM_CDE                                       08300008
083100               ,RTL_UM_CDE                                        08310008
083200               ,BYP_CAT_IND                                       08320008
083300               ,CRE_BY_USR_ID                                     08330008
083400               ,LAST_UPD_BY_USR_ID                                08340008
083500               ,LAST_UPD_TMST                                     08350008
083600         FROM                                                     08360008
083700             TVNDSTL                                              08370008
083800         WHERE VS_ID         = :HOLD-VS-ID                        08380008
083900         WITH UR                                                  08390008
084000     END-EXEC.                                                    08400008
084100                                                                  08410008
084200*                                                                 08420008
084300     EXEC SQL                                                     08430008
084400       DECLARE XLTSKU-CSR CURSOR FOR                              08440008
084500         SELECT                                                   08450008
084600               INTR_UPC_ID                                        08460008
084700              ,STYL_ID                                            08470008
084800              ,ITM_NBR                                            08480008
084900              ,SKU_NBR                                            08490008
085000              ,SKU_STAT_CDE                                       08500008
085100              ,SKU_STAT_DESC                                      08510008
085200              ,INNR_PK_QTY                                        08520008
085300              ,OUTR_PK_QTY                                        08530008
085400              ,SKU_DESC                                           08540008
085500              ,KOHLS_SIZE_CDE                                     08550008
085600              ,SIZE_DESC                                          08560008
085700              ,NRF_CLOR_CDE                                       08570008
085800              ,SHRT_CLOR_DESC                                     08580008
085900              ,CSTM_CLOR_DESC                                     08590008
086000              ,REGN_PRIC_IND                                      08600008
086100              ,KY_ITM_IND                                         08610008
086200              ,GP_CDE                                             08620008
086300              ,WHSE_RPLNT_IND                                     08630008
086400         FROM                                                     08640008
086500             XLT_SKU                                              08650008
086600         WHERE INTR_UPC_ID   = :HOLD-INTR-UPC-ID                  08660008
086700         WITH UR                                                  08670008
086800     END-EXEC.                                                    08680008
086900/                                                                 08690008
087000*                                                                 08700008
087100     EXEC SQL                                                     08710008
087200       DECLARE XLTUPC-CSR CURSOR FOR                              08720008
087300         SELECT                                                   08730008
087400             UPC_ID                                               08740008
087500            ,INTR_UPC_ID                                          08750008
087600            ,UPC_TYP_CDE                                          08760008
087700            ,EDI_ORD_IND                                          08770008
087800            ,CERTD_IND                                            08780008
087900            ,CERTD_DTE                                            08790008
088000            ,UPC_NBR                                              08800008
088100         FROM XLT_UPC                                             08810008
088200         WHERE INTR_UPC_ID   = :HOLD-INTR-UPC-ID                  08820008
088300         WITH UR                                                  08830008
088400     END-EXEC.                                                    08840008
088500/                                                                 08850008
088600*                                                                 08860008
088700*  CURSOR TO PULL BACK TMESTDS DATA                               08870008
088800*                                                                 08880008
088900     EXEC SQL                                                     08890008
089000       DECLARE MESTDS_CSR CURSOR FOR                              08900008
089100         SELECT                                                   08910008
089200            PO_NBR                                                08920008
089300           ,PO_LNE_NBR                                            08930008
089400           ,PLAN_NBR                                              08940008
089500           ,STR_NBR                                               08950008
089600           ,STR_DISTRO_QTY                                        08960008
089700           ,ALLOC_SEQ_CDE                                         08970008
089800           ,RNK_SEQ_NBR                                           08980008
089900           ,STR_CNSTR_CDE                                         08990008
090000           ,STR_CNSTR_QTY                                         09000008
090100         FROM                                                     09010008
090200             TMESTDS                                              09020008
090300         WHERE PO_NBR          = :HOLD-PO-NBR                     09030008
090400         WITH UR                                                  09040008
090500     END-EXEC.                                                    09050008
090600/                                                                 09060008
090700*                                                                 09070008
090800*  CURSOR TO PULL BACK TEXTENT DATA                               09080008
090900*                                                                 09090008
091000*    EXEC SQL                                                     09100008
091100*      DECLARE EXTENT_CSR CURSOR FOR                              09110008
091200*        SELECT                                                   09120008
091300*            ENT_ID                                               09130008
091400*           ,SCAC_CDE                                             09140008
091500*           ,DUN_NBR                                              09150008
091600*           ,ASN_TRSCP_IND                                        09160008
091700*           ,FED_EXPRESS_NBR                                      09170008
091800*           ,MDSE_VENDOR_IND                                      09180008
091900*           ,CARRIER_IND                                          09190008
092000*           ,STATUS_CDE                                           09200008
092100*           ,CARR_MAN_PRO_IND                                     09210008
092200*           ,EDI214_TEST_IND                                      09220008
092300*           ,IMPRT_IND                                            09230008
092400*           ,SHIP_INSTR_LT_QTY                                    09240008
092500*           ,SHIP_INSTR_REQD                                      09250008
092600*           ,EXP_VEND_IND                                         09260008
092700*           ,NEED_1099_IND                                        09270008
092800*           ,CRE_BY_UID                                           09280008
092900*           ,CRE_TMST                                             09290008
093000*           ,LAST_UPD_BY_UID                                      09300008
093100*           ,LAST_UPD_TMST                                        09310008
093200*           ,CFY_SLSRNK_NBR                                       09320008
093300*           ,PFY_SLSRNK_NBR                                       09330008
093400*           ,CRE_ASN_FCST_IND                                     09340008
093500*           ,CRE_SHIPT_FCST_IND                                   09350008
093600*           ,STR_DISTRO_LT_QTY                                    09360008
093700*           ,VLD_CART_LBL_IND                                     09370008
093800*           ,PRNT_CO_ENT_ID                                       09380008
093900*           ,VND_CLSN_CDE                                         09390008
094000*           ,VND_PRSST_CDE                                        09400008
094100*           ,FED_TX_ID_TYP_CDE                                    09410008
094200*           ,FED_TX_ID_NBR                                        09420008
094300*           ,FCTR_IND                                             09430008
094400*           ,PRNT_CO_IND                                          09440008
094500*           ,CAP_EXP_CDE                                          09450008
094600*           ,HLD_PAYT_IND                                         09460008
094700*           ,PAY_FCTR_VND_IND                                     09470008
094800*           ,SEPR_INVC_PAYT_IND                                   09480008
094900*           ,WHLDG_PAYT_TYP_CDE                                   09490008
095000*           ,PAYT_HNDLG_CDE                                       09500008
095100*        FROM                                                     09510008
095200*            TEXTENT                                              09520008
095300*        WHERE ENT_ID           = :HOLD-ENT-ID                    09530008
095400*        WITH UR                                                  09540008
095500*    END-EXEC.                                                    09550008
095600     EXEC SQL                                                     09560008
095700       DECLARE EXTENT_CSR CURSOR FOR                              09570008
095800         SELECT                                                   09580008
095900             ENT_ID                                               09590008
096000            ,SCAC_CDE                                             09600008
096100            ,DUN_NBR                                              09610008
096200            ,ASN_TRSCP_IND                                        09620008
096300            ,FED_EXPRESS_NBR                                      09630008
096400            ,MDSE_VENDOR_IND                                      09640008
096500            ,CARRIER_IND                                          09650008
096600            ,STATUS_CDE                                           09660008
096700            ,CARR_MAN_PRO_IND                                     09670008
096800            ,EDI214_TEST_IND                                      09680008
096900            ,IMPRT_IND                                            09690008
097000            ,SHIP_INSTR_LT_QTY                                    09700008
097100            ,SHIP_INSTR_REQD                                      09710008
097200            ,EXP_VEND_IND                                         09720008
097300            ,NEED_1099_IND                                        09730008
097400            ,CRE_BY_UID                                           09740008
097500            ,CRE_TMST                                             09750008
097600            ,LAST_UPD_BY_UID                                      09760008
097700            ,LAST_UPD_TMST                                        09770008
097800            ,CFY_SLSRNK_NBR                                       09780008
097900            ,PFY_SLSRNK_NBR                                       09790008
098000            ,CRE_ASN_FCST_IND                                     09800008
098100            ,CRE_SHIPT_FCST_IND                                   09810008
098200            ,STR_DISTRO_LT_QTY                                    09820008
098300            ,VLD_CART_LBL_IND                                     09830008
098400            ,PRNT_CO_ENT_ID                                       09840008
098500            ,VND_CLSN_CDE                                         09850008
098600            ,VND_PRSST_CDE                                        09860008
098700            ,FED_TX_ID_TYP_CDE                                    09870008
098800            ,FED_TX_ID_NBR                                        09880008
098900            ,FCTR_IND                                             09890008
099000            ,PRNT_CO_IND                                          09900008
099100            ,CAP_EXP_CDE                                          09910008
099200            ,HLD_PAYT_IND                                         09920008
099300            ,PAY_FCTR_VND_IND                                     09930008
099400            ,SEPR_INVC_PAYT_IND                                   09940008
099500            ,WHLDG_PAYT_TYP_CDE                                   09950008
099600            ,PAYT_HNDLG_CDE                                       09960008
099700            ,P12MN_SLSRNK_NBR                                     09970008
099800            ,EDI_PO_PREPK_CDE                                     09980008
099900            ,PRIM_TYP_CDE                                         09990008
100000            ,PRTNR_IND                                            10000008
100100            ,PRTNR_TYP_CDE                                        10010008
100200            ,LNE_OF_CR_AMT                                        10020008
100300            ,VND_IN_RMS_IND                                       10030008
100400         FROM                                                     10040008
100500             TEXTENT                                              10050008
100600         WHERE ENT_ID           = :HOLD-ENT-ID                    10060008
100700         WITH UR                                                  10070008
100800     END-EXEC.                                                    10080008
100900/                                                                 10090008
101000*                                                                 10100008
101100*  CURSOR TO PULL BACK TENTNME DATA                               10110008
101200*                                                                 10120008
101300     EXEC SQL                                                     10130008
101400       DECLARE ENTNME_CSR CURSOR FOR                              10140008
101500         SELECT                                                   10150008
101600                   ENT_ID                                         10160008
101700                  ,SEQ_NBR                                        10170008
101800                  ,ENT_NAME_DESC                                  10180008
101900                  ,TYPE_CDE                                       10190008
102000         FROM                                                     10200008
102100             TENTNME                                              10210008
102200         WHERE ENT_ID           = :HOLD-ENT-ID                    10220008
102300         WITH UR                                                  10230008
102400     END-EXEC.                                                    10240008
102500/                                                                 10250008
102600*                                                                 10260008
102700*  CURSOR TO PULL BACK TVNDDPT DATA                               10270008
102800*                                                                 10280008
102900     EXEC SQL                                                     10290008
103000       DECLARE VNDDPT_CSR CURSOR FOR                              10300008
103100         SELECT                                                   10310008
103200                   ENT_ID                                         10320008
103300                  ,DEPT_NBR                                       10330008
103400                  ,INHOUSE_NBR                                    10340008
103500                  ,VEND_TYP_IND                                   10350008
103600                  ,INVC_REQ_PO_IND                                10360008
103700                  ,VND_DEPT_STAT_CD                               10370008
103800         FROM                                                     10380008
103900             TVNDDPT                                              10390008
104000         WHERE ENT_ID           = :HOLD-ENT-ID                    10400008
104100         WITH UR                                                  10410008
104200     END-EXEC.                                                    10420008
104300/                                                                 10430008
104400*                                                                 10440008
104500*  CURSOR TO PULL BACK TINSTCD DATA                               10450008
104600*                                                                 10460008
104700     EXEC SQL                                                     10470008
104800       DECLARE INSTCD_CSR CURSOR FOR                              10480008
104900         SELECT                                                   10490008
105000                   INSTR_NBR                                      10500008
105100                  ,INSTR_DESC                                     10510008
105200                  ,CRE_BY_UID                                     10520008
105300                  ,CRE_DTE                                        10530008
105400         FROM                                                     10540008
105500             TINSTCD                                              10550008
105600         WHERE INSTR_NBR        = :HOLD-INSTR-NBR                 10560008
105700         WITH UR                                                  10570008
105800     END-EXEC.                                                    10580008
105900/                                                                 10590008
106000*                                                                 10600008
106100*  CURSOR TO PULL BACK TSPSTDS DATA   (TABLE IS EMPTY)            10610008
106200*                                                                 10620008
106300*    EXEC SQL                                                     10630008
106400*      DECLARE SPSTDS_CSR CURSOR FOR                              10640008
106500*        SELECT                                                   10650008
106600*                  PO_NBR                                         10660008
106700*                 ,PO_LNE_NBR                                     10670008
106800*                 ,PLAN_NBR                                       10680008
106900*                 ,STR_NBR                                        10690008
107000*                 ,STR_DISTRO_QTY                                 10700008
107100*        FROM                                                     10710008
107200*            TSPSTDS                                              10720008
107300*        WHERE PO_NBR           = :HOLD-PO-NBR                    10730008
107400*        WITH UR                                                  10740008
107500*    END-EXEC.                                                    10750008
107600/                                                                 10760008
107700*                                                                 10770008
107800*  CURSOR TO PULL BACK TTRBNTF DATA                               10780008
107900*                                                                 10790008
108000     EXEC SQL                                                     10800008
108100       DECLARE TRBNTF_CSR CURSOR FOR                              10810008
108200         SELECT                                                   10820008
108300                   NOTIF_NBR                                      10830008
108400                  ,OPER_UNT_ID                                    10840008
108500                  ,FCLTY_ID                                       10850008
108600                  ,DEPT_NBR                                       10860008
108700                  ,ENT_ID                                         10870008
108800                  ,PO_NBR                                         10880008
108900                  ,PO_LNE_NBR                                     10890008
109000                  ,REC_SEQ_NBR                                    10900008
109100                  ,TRBL_RSN_CDE                                   10910008
109200                  ,NOTIF_TMST                                     10920008
109300                  ,NOTIF_UID                                      10930008
109400                  ,RESOLVED_IND                                   10940008
109500                  ,RESOLVED_TMST                                  10950008
109600                  ,RESOLVED_UID                                   10960008
109700                  ,ACKNOWLG_TMST                                  10970008
109800                  ,ACKNOWLG_UID                                   10980008
109900                  ,CNTCT_EXT                                      10990008
110000                  ,FCLTY_AREA_ID                                  11000008
110100                  ,OVER_SHT_PCT                                   11010008
110200                  ,LAST_DTL_CRE_TMST                              11020008
110300                  ,CRE_IND                                        11030008
110400                  ,PRORATE_IND                                    11040008
110500                  ,RTV_IND                                        11050008
110600                  ,RTV_RESPONSE_TMST                              11060008
110700                  ,PO_VER_NBR                                     11070008
110800                  ,PO_LNE_VER_NBR                                 11080008
110900                  ,PLN_SHIP_VER_NBR                               11090008
111000                  ,ERLY_LTE_DAY_QTY                               11100008
111100                  ,INITR_ID                                       11110008
111200                  ,RSPNB_RSLU_ID                                  11120008
111300                  ,PFMC_TRKG_ID                                   11130008
111400                  ,ACTVY_RSLU_CDE                                 11140008
111500                  ,INITR_ENT_ID                                   11150008
111600                  ,FOB_CDE                                        11160008
111700                  ,POE_CDE                                        11170008
111800                  ,PREPK_ID                                       11180008
111900         FROM                                                     11190008
112000             TTRBNTF                                              11200008
112100         WHERE PO_NBR           = :HOLD-PO-NBR                    11210008
112200         WITH UR                                                  11220008
112300     END-EXEC.                                                    11230008
112400/                                                                 11240008
112500*                                                                 11250008
112600*  CURSOR TO PULL BACK TTRBDTL DATA                               11260008
112700*                                                                 11270008
112800     EXEC SQL                                                     11280008
112900       DECLARE TRBDTL_CSR CURSOR FOR                              11290008
113000         SELECT                                                   11300008
113100                   NOTIF_NBR                                      11310008
113200                  ,CRE_TMST                                       11320008
113300                  ,CRE_UID                                        11330008
113400                  ,FREEFORM_TEXT                                  11340008
113500         FROM                                                     11350008
113600             TTRBDTL                                              11360008
113700         WHERE NOTIF_NBR        = :HOLD-NOTIF-NBR                 11370008
113800         WITH UR                                                  11380008
113900     END-EXEC.                                                    11390008
114000/                                                                 11400008
114100*                                                                 11410008
114200*  CURSOR TO PULL BACK TPOUPC DATA                                11420008
114300*                                                                 11430008
114400*    EXEC SQL                                                     11440010
114500*      DECLARE POUPC-CSR CURSOR FOR                               11450010
114600*        SELECT                                                   11460010
114700*                  PO_NBR                                         11470010
114800*                 ,PO_LNE_NBR                                     11480010
114900*                 ,UPC_ID                                         11490010
115000*                 ,UPC_QTY                                        11500010
115100*                 ,UPC_RATO_QTY_NBR                               11510010
115200*                 ,LAST_UPD_TMST                                  11520010
115300*                 ,LAST_UPD_USR_ID                                11530010
115400*        FROM                                                     11540010
115500*            TPOUPC                                               11550010
115600*        WHERE PO_NBR           = :HOLD-PO-NBR                    11560010
115700*        WITH UR                                                  11570010
115800*    END-EXEC.                                                    11580010
115900/                                                                 11590008
116000*                                                                 11600008
116100*  CURSOR TO PULL BACK TALLTMP1 DATA                              11610008
116200*                                                                 11620008
116300     EXEC SQL                                                     11630008
116400       DECLARE ALLTMP_CSR CURSOR FOR                              11640008
116500         SELECT                                                   11650008
116600                   PO_NBR                                         11660008
116700                  ,DEST_NBR                                       11670008
116800                  ,DEST_PCT                                       11680008
116900         FROM                                                     11690008
117000             TALLTMP                                              11700008
117100         WHERE PO_NBR           = :HOLD-PO-NBR                    11710008
117200         WITH UR                                                  11720008
117300     END-EXEC.                                                    11730008
117400/                                                                 11740008
117500*                                                                 11750008
117600*  CURSOR TO PULL BACK TVNDAGR DATA                               11760008
117700*                                                                 11770008
117800     EXEC SQL                                                     11780008
117900       DECLARE VNDAGR_CSR CURSOR FOR                              11790008
118000         SELECT                                                   11800008
118100                                                                  11810008
118200             ENT_ID                                               11820008
118300            ,DEPT_NBR                                             11830008
118400            ,AGRMT_TYP_ID                                         11840008
118500            ,SEQ_NBR                                              11850008
118600            ,TYP_CDE                                              11860008
118700            ,EFFECTIVE_DATE                                       11870008
118800            ,EXPIRATION_DATE                                      11880008
118900            ,PROD_STATUS_IND                                      11890008
119000            ,LEADTIME_DAYS_QTY                                    11900008
119100            ,BULK_STK_TKT_IND                                     11910008
119200            ,TKT_MKR_IND                                          11920008
119300            ,RTV_RA_REQD_IND                                      11930008
119400            ,RTV_NO_RA_REQD_IND                                   11940008
119500            ,DEBIT_DESTROY_IND                                    11950008
119600            ,MARKOUT_IND                                          11960008
119700            ,EARLY_SHIPT_IND                                      11970008
119800            ,LATE_SHIPT_IND                                       11980008
119900            ,PARTIAL_SHIPT_IND                                    11990008
120000            ,FOB_POINT_TXT                                        12000008
120100            ,SHIPT_POINT_TXT                                      12010008
120200            ,DISCOUNT_PCT                                         12020008
120300            ,EXT_PAY_DAYS_QTY                                     12030008
120400            ,PAYT_TERM_ID                                         12040008
120500            ,LAST_UPD_TMST                                        12050008
120600            ,LAST_UPD_ID                                          12060008
120700            ,PARTIAL_IND                                          12070008
120800            ,FRGT_TERM_ID                                         12080008
120900            ,AP_TRN_CDE                                           12090008
121000            ,VND_AUTH_ID                                          12100008
121100            ,PSTG_FRQ_CDE                                         12110008
121200            ,DED_DISC_IND                                         12120008
121300            ,DED_RTV_IND                                          12130008
121400                                                                  12140008
121500                                                                  12150008
121600         FROM                                                     12160008
121700             TVNDAGR                                              12170008
121800         WHERE ENT_ID           = :HOLD-ENT-ID                    12180008
121900         WITH UR                                                  12190008
122000     END-EXEC.                                                    12200008
122100/                                                                 12210008
122200*                                                                 12220008
122300*  CURSOR TO PULL BACK TPAYREQ DATA                               12230008
122400*                                                                 12240008
122500*    EXEC SQL                                                     12250008
122600*      DECLARE PAYREQ_CSR CURSOR FOR                              12260008
122700*        SELECT                                                   12270008
122800*                  PAYT_REQ_SEQ_NBR                               12280008
122900*                 ,PAYT_REQ_TYP_CDE                               12290008
123000*                 ,REMIT_TO_DUN_NBR                               12300008
123100*                 ,ENTR_UID                                       12310008
123200*                 ,ENTR_DTE                                       12320008
123300*                 ,ENTR_TRMNL_ID                                  12330008
123400*                 ,PO_NBR                                         12340008
123500*                 ,VER_NBR                                        12350008
123600*        FROM                                                     12360008
123700*            TPAYREQ                                              12370008
123800*        WHERE PO_NBR           = :HOLD-PO-NBR                    12380008
123900*        WITH UR                                                  12390008
124000*    END-EXEC.                                                    12400008
124100/                                                                 12410008
124200*                                                                 12420008
124300*  CURSOR TO PULL BACK TINVOIC DATA                               12430008
124400*                                                                 12440008
124500     EXEC SQL                                                     12450008
124600       DECLARE INVOIC_CSR CURSOR FOR                              12460008
124700         SELECT                                                   12470008
124800                 PO_NBR                                           12480008
124900                ,INVC_ID                                          12490008
125000                ,PAYT_REQ_SEQ_NBR                                 12500008
125100                ,INVC_TYP_CDE                                     12510008
125200                ,ENTR_MTHD_CDE                                    12520008
125300                ,CRE_BY_USR_ID                                    12530008
125400                ,BAR_CDE                                          12540008
125500                ,SPLIT_TERMS_IND                                  12550008
125600                ,DTL_ENTR_IND                                     12560008
125700                ,INVC_CART_CT                                     12570008
125800                ,CRE_DTE                                          12580008
125900                ,PPD_RVRSL_IND                                    12590008
126000                ,INVC_DTE                                         12600008
126100                ,GRO_COST_AMT                                     12610008
126200                ,INVC_NET_COST_AMT                                12620008
126300                ,RMIT_VND_ID                                      12630008
126400                ,STR_NBR                                          12640008
126500                ,HOLD_IND                                         12650008
126600                ,DUE_DTE_SRC_CDE                                  12660008
126700                ,CALC_DUE_DTE                                     12670008
126800                ,PAYT_DTE                                         12680008
126900                ,AP_PRC_DTE                                       12690008
127000                ,AP_PRC_CDE                                       12700008
127100                ,PAYT_RLSE_TMST                                   12710008
127200                ,STATUS_CDE                                       12720008
127300                ,STATUS_CHG_TMST                                  12730008
127400         FROM                                                     12740008
127500             TINVOIC                                              12750008
127600         WHERE PAYT_REQ_SEQ_NBR = :HOLD-PAYT-REQ-SEQ-NBR          12760008
127700         WITH UR                                                  12770008
127800     END-EXEC.                                                    12780008
127900/                                                                 12790008
128000******************************************************************12800008
128100*  CURSOR TO PULL BACK TALCHRG DATA                               12810008
128200******************************************************************12820008
128300*    EXEC SQL                                                     12830008
128400*      DECLARE ALCHRG_CSR CURSOR FOR                              12840008
128500*        SELECT                                                   12850008
128600*                  PAYT_REQ_SEQ_NBR                               12860008
128700*                 ,ALW_CHRG_SEQ_NBR                               12870008
128800*                 ,ALW_CHRG_TYP_CDE                               12880008
128900*                 ,ALW_CHRG_CDE                                   12890008
129000*                 ,ALW_CHRG_SER_CDE                               12900008
129100*                 ,ALW_CHRG_PCT                                   12910008
129200*                 ,ALW_CHRG_AMT                                   12920008
129300*        FROM                                                     12930008
129400*            TALCHRG                                              12940008
129500*        WHERE PAYT_REQ_SEQ_NBR = :HOLD-PAYT-REQ-SEQ-NBR          12950008
129600*    END-EXEC.                                                    12960008
129700/                                                                 12970008
129800*                                                                 12980008
129900*  CURSOR TO PULL BACK TPREQIT DATA                               12990008
130000*                                                                 13000008
130100     EXEC SQL                                                     13010008
130200       DECLARE PREQIT_CSR CURSOR FOR                              13020008
130300         SELECT                                                   13030008
130400                   PAYT_REQ_SEQ_NBR                               13040008
130500                  ,PAYT_REQ_LNE_NBR                               13050008
130600                  ,PAY_REQ_LNE_QTY                                13060008
130700                  ,QTY_UNT_OF_MSMT                                13070008
130800                  ,UNT_COST_AMT                                   13080008
130900         FROM                                                     13090008
131000             TPREQIT                                              13100008
131100         WHERE PAYT_REQ_SEQ_NBR = :HOLD-PAYT-REQ-SEQ-NBR          13110008
131200         WITH UR                                                  13120008
131300     END-EXEC.                                                    13130008
131400/                                                                 13140008
131500*                                                                 13150008
131600*  CURSOR TO PULL BACK TASNDTL DATA                               13160008
131700*                                                                 13170008
131800     EXEC SQL                                                     13180008
131900       DECLARE ASNDTL_CSR CURSOR FOR                              13190008
132000         SELECT                                                   13200008
132100                   ASNHDR_ID                                      13210008
132200                  ,ASNDTL_NBR                                     13220008
132300                  ,PO_NBR                                         13230008
132400                  ,SELR_INV_NBR                                   13240008
132500                  ,SEQ_NBR                                        13250008
132600                  ,UPC_NBR                                        13260008
132700                  ,ALT_PROD1_CDE                                  13270008
132800                  ,ALT_PROD1_ID                                   13280008
132900                  ,ALT_PROD2_CDE                                  13290008
133000                  ,ALT_PROD2_ID                                   13300008
133100                  ,SHIPT_QTY                                      13310008
133200                  ,SHIPT_DTE_QTY                                  13320008
133300                  ,SHIPT_UM_CDE                                   13330008
133400                  ,ITM_STATUS_CDE                                 13340008
133500                  ,ITM_ERR_CDE                                    13350008
133600                  ,ITM_ERR_QTY                                    13360008
133700                  ,ITM_ERR_QTY_UM_CDE                             13370008
133800                  ,PKG_QTY                                        13380008
133900                  ,PKG_QTY_UM_CDE                                 13390008
134000                  ,VEND_ORD_QTY                                   13400008
134100                  ,ORD_QTY_UM_CDE                                 13410008
134200                  ,WGT_MSMT                                       13420008
134300                  ,VOL_MSMT                                       13430008
134400                  ,VOL_UM_CDE                                     13440008
134500                  ,LEN_MSMT                                       13450008
134600                  ,HT_MSMT                                        13460008
134700                  ,WDTH_MSMT                                      13470008
134800                  ,SIZE_UM_CDE                                    13480008
134900                  ,ITM_SUBST_UPC_NBR                              13490008
135000                  ,TKT_ERR_CDE                                    13500008
135100                  ,WGT_UM_CDE                                     13510008
135200                  ,INPK_EA_QTY                                    13520008
135210                  ,LOC_NBR                                        13521008
135220         FROM                                                     13522008
135230             TASNDTL                                              13523008
135240         WHERE ASNHDR_ID        = :HOLD-ASNHDR-ID                 13524008
135250         WITH UR                                                  13525008
135260     END-EXEC.                                                    13526008
135270/                                                                 13527008
135280*                                                                 13528008
135290*  CURSOR TO PULL BACK TASNORD DATA                               13529008
135300*                                                                 13530008
135400     EXEC SQL                                                     13540008
135500       DECLARE ASNORD_CSR CURSOR FOR                              13550008
135600         SELECT                                                   13560008
135700                   ASNHDR_ID                                      13570008
135800                  ,PO_NBR                                         13580008
135900                  ,SEQ_NBR                                        13590008
136000                  ,SELR_INV_NBR                                   13600008
136100                  ,VEND_ORD_NBR                                   13610008
136200                  ,CUST_NBR                                       13620008
136300                  ,PROMO_NBR                                      13630008
136400                  ,VEND_NBR                                       13640008
136500                  ,MDSEDP_NBR                                     13650008
136600                  ,ORD_STATUS_CDE                                 13660008
136700                  ,CHG_ORD_SEQ_NBR                                13670008
136800                  ,PO_DTE                                         13680008
136900                  ,LTE_CHG_AMT                                    13690008
137000                  ,EXCH_FCTR                                      13700008
137100                  ,SELR_CUR_CDE                                   13710008
137200                  ,MTCH_PO_CDE                                    13720008
137300                  ,EARLY_LTE_CDE                                  13730008
137400                  ,SEQ_NBR_IND                                    13740008
137500                  ,CART_SHIP_QTY                                  13750008
137500                  ,LOC_NBR                                        13751012
137600         FROM                                                     13760008
137700             TASNORD                                              13770008
137800         WHERE PO_NBR  IN (:HOLD-PO-NBR-C6,:HOLD-PO-NBR-C7,       13780008
137900*CLP 02/17/15 START                                               13790008
138000                           :HOLD-PO-NBR-C8)                       13800008
138100*CLP 02/17/15 END                                                 13810008
138200         ORDER BY ASNHDR_ID                                       13820008
138300         WITH UR                                                  13830008
138400     END-EXEC.                                                    13840008
138500/                                                                 13850008
138600*                                                                 13860008
138700*  CURSOR TO PULL BACK TASNHDR DATA                               13870008
138800*                                                                 13880008
138900     EXEC SQL                                                     13890008
139000       DECLARE ASNHDR_CSR CURSOR FOR                              13900008
139100         SELECT                                                   13910008
139200                   OPERCO_NBR                                     13920008
139300                  ,EDI_VEND_ID                                    13930008
139400                  ,ASNHDR_NBR                                     13940008
139500                  ,ASNHDR_ID                                      13950008
139600                  ,ASNHDR_TMST                                    13960008
139700                  ,CRE_DTE                                        13970008
139800                  ,SHIP_DTE                                       13980008
139900                  ,BOL_NBR                                        13990008
140000                  ,PRO_NBR                                        14000008
140100                  ,CART_SHIP_QTY                                  14010008
140200                  ,GRO_WGHT_MSMT                                  14020008
140300                  ,ANTC_DELY_DTE                                  14030008
140400                  ,REC_MTHD_IND                                   14040008
140500                  ,SHIPT_STATUS_CDE                               14050008
140600                  ,CARR_NAME                                      14060008
140700                  ,TRANS_MTHD_CDE                                 14070008
140800                  ,CARR_ID_CDE                                    14080008
140900                  ,CARR_ID_QUAL_CDE                               14090008
141000                  ,RTE_SEQ_CDE                                    14100008
141100                  ,SHPT_VOL_MSMT                                  14110008
141200                  ,EQUIP_INIT_CDE                                 14120008
141300                  ,EQUIP_NBR                                      14130008
141400                  ,SCHD_SHIP_DTE                                  14140008
141500                  ,CRE_TM                                         14150008
141600                  ,REJ_SHIPT_CDE                                  14160008
141700                  ,SHPT_VOL_UM_CDE                                14170008
141800                  ,GRO_WGHT_UM_CDE                                14180008
141900                  ,PRINT_IND                                      14190008
142000                  ,SHIP_PAYT_TERM_CDE                             14200008
142100                  ,RESPBL_LOC_CDE                                 14210008
142200                  ,RESPBL_LOC_DESC                                14220008
142300                  ,DC_PRT_IND                                     14230008
142400                  ,SHIP_TM                                        14240008
142500         FROM                                                     14250008
142600             TASNHDR                                              14260008
142700         WHERE ASNHDR_ID        = :HOLD-ASNHDR-ID                 14270008
142800         WITH UR                                                  14280008
142900     END-EXEC.                                                    14290008
143000/                                                                 14300008
143100*                                                                 14310008
143200*  CURSOR TO PULL BACK TASCRIT DATA                               14320008
143300*                                                                 14330008
143400     EXEC SQL                                                     14340008
143500       DECLARE ASCRIT_CSR CURSOR FOR                              14350008
143600         SELECT                                                   14360008
143700                   ASNHDR_ID                                      14370008
143800                  ,ASNCAR_NBR                                     14380008
143900                  ,ASNDTL_NBR                                     14390008
144000         FROM                                                     14400008
144100             TASCRIT                                              14410008
144200         WHERE ASNHDR_ID        = :HOLD-ASNHDR-ID                 14420008
144300         WITH UR                                                  14430008
144400     END-EXEC.                                                    14440008
144500/                                                                 14450008
144600*                                                                 14460008
144700*  CURSOR TO PULL BACK TASNCAR DATA                               14470008
144800*                                                                 14480008
144900     EXEC SQL                                                     14490008
145000       DECLARE ASNCAR_CSR CURSOR FOR                              14500008
145100         SELECT                                                   14510008
145200                   ASNHDR_ID                                      14520008
145300                  ,ASNCAR_NBR                                     14530008
145400                  ,PO_NBR                                         14540008
145500                  ,SEQ_NBR                                        14550008
145600                  ,SELR_INV_NBR                                   14560008
145700                  ,VOL_MSMT                                       14570008
145800                  ,WGHT_MSMT                                      14580008
145900                  ,NBR_QUAL_CDE                                   14590008
146000                  ,PKG_QTY                                        14600008
146100                  ,PKG_QTY_UM_CDE                                 14610008
146200                  ,WGHT_UM_CDE                                    14620008
146300                  ,VOL_UM_CDE                                     14630008
146400                  ,PKG_CDE                                        14640008
146500                  ,LEN_MSMT                                       14650008
146600                  ,HT_MSMT                                        14660008
146700                  ,WDTH_MSMT                                      14670008
146800                  ,SIZE_UM_CDE                                    14680008
146900                  ,PKG_SIZE_QTY                                   14690008
147000                  ,INPK_EA_QTY                                    14700008
147100         FROM                                                     14710008
147200             TASNCAR                                              14720008
147300         WHERE ASNHDR_ID        = :HOLD-ASNHDR-ID                 14730008
147400         WITH UR                                                  14740008
147500     END-EXEC.                                                    14750008
147600/                                                                 14760008
147700*                                                                 14770008
147800*                                                                 14780008
147900*  CURSOR TO PULL BACK TASDTPL DATA                               14790008
148000*                                                                 14800008
148100     EXEC SQL                                                     14810008
148200       DECLARE ASDTPL_CSR CURSOR FOR                              14820008
148300         SELECT                                                   14830008
148400                   ASNHDR_ID                                      14840008
148500                  ,ASNDTL_NBR                                     14850008
148510                  ,PO_LN_NBR                                      14851008
148520                  ,ASSOC_QTY                                      14852008
148530                  ,ASDTPL_ALLOC_IND                               14853008
148540                  ,SHIPT_VAR_QTY                                  14854008
148550                  ,PR_CHG_EFF_DAY_NBR                             14855008
148560                  ,PR_VAR_IND                                     14856008
148570                  ,PR_DISC_IND                                    14857008
148580                  ,PO_NBR                                         14858008
148590         FROM                                                     14859008
148600             TASDTPL                                              14860008
148601         WHERE ASNHDR_ID        = :HOLD-ASNHDR-ID                 14860108
148602         WITH UR                                                  14860208
148603     END-EXEC.                                                    14860308
148604/                                                                 14860408
148605*                                                                 14860508
148606*  CURSOR TO PULL BACK TSEASET DATA                               14860608
148607*                                                                 14860708
148608     EXEC SQL                                                     14860808
148609       DECLARE SEASET_CSR CURSOR FOR                              14860908
148610         SELECT                                                   14861008
148620                   SEASET_YR                                      14862008
148630                  ,SEASET_SHRT_NM                                 14863008
148640                  ,SEASET_TYP_CDE                                 14864008
148650                  ,SEASET_NM                                      14865008
148660                  ,SEASET_STAT_CDE                                14866008
148670                  ,STR_STUP_BEG_DTE                               14867008
148680                  ,STR_STUP_END_DTE                               14868008
148690                  ,STR_RLSE_BEG_DTE                               14869008
148700                  ,STR_RLSE_END_DTE                               14870008
148800                  ,LAST_UPD_BY_USR_ID                             14880008
148900                  ,LAST_UPD_TMST                                  14890008
149000                  ,DIVERT_PFX_NBR                                 14900008
149100         FROM                                                     14910008
149200             TSEASET                                              14920008
149300         WHERE SEASET_YR        = :HOLD-SEASET-YR                 14930008
149400           AND SEASET_SHRT_NM   = :HOLD-SEASET-SHRT-NM            14940008
149500         WITH UR                                                  14950008
149600     END-EXEC.                                                    14960008
149700/                                                                 14970008
149800*                                                                 14980008
149900*  CURSOR TO PULL BACK TSUNAUD DATA                               14990008
150000*                                                                 15000008
150100     EXEC SQL                                                     15010008
150200       DECLARE SUNAUD_CSR CURSOR FOR                              15020008
150300         SELECT                                                   15030008
150400                   AUD_CNTL_NBR                                   15040008
150500                  ,AUD_STRT_TMST                                  15050008
150600                  ,AUD_STP_TMST                                   15060008
150700                  ,AUD_PSPND_MNIT_QTY                             15070008
150800                  ,AUD_CLO_MNIT_QTY                               15080008
150900                  ,AUD_USR_ID                                     15090008
151000                  ,OPER_UNT_ID                                    15100008
151100                  ,FCLTY_ID                                       15110008
151200                  ,PRC_FCLTY_AREA_ID                              15120008
151300                  ,AUD_STAT_CDE                                   15130008
151400                  ,AUD_TYP_CDE                                    15140008
151500         FROM                                                     15150008
151600             TSUNAUD                                              15160008
151700         WHERE AUD_CNTL_NBR     = :HOLD-AUD-CNTL-NBR              15170008
151800         WITH UR                                                  15180008
151900     END-EXEC.                                                    15190008
152000/                                                                 15200008
152100*                                                                 15210008
152200*  CURSOR TO PULL BACK TSUATRN DATA                               15220008
152300*                                                                 15230008
152400     EXEC SQL                                                     15240008
152500       DECLARE SUATRN_CSR CURSOR FOR                              15250008
152600         SELECT                                                   15260008
152700                   AUD_CNTL_NBR                                   15270008
152800                  ,SHIPT_UNT_ID                                   15280008
152900                  ,UNT_AUD_STRT_TMST                              15290008
153000                  ,UNT_AUD_STP_TMST                               15300008
153100                  ,UNT_PSPND_MNIT_QTY                             15310008
153200                  ,UNT_CLO_MNIT_QTY                               15320008
153300                  ,UNT_AUD_USR_ID                                 15330008
153400                  ,UNT_AUD_STAT_CDE                               15340008
153500                  ,TRN_NBR                                        15350008
153600                  ,REC_SEQ_NBR                                    15360008
153700                  ,DEST_OPER_UNT_ID                               15370008
153800                  ,DEST_FCLTY_ID                                  15380008
153900                  ,UNT_AUD_ERR_IND                                15390008
154000                  ,UNT_RSTRT_MNIT_QTY                             15400008
154100         FROM                                                     15410008
154200             TSUATRN                                              15420008
154300         WHERE SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID             15430008
154400         WITH UR                                                  15440008
154500     END-EXEC.                                                    15450008
154600/                                                                 15460008
154700*                                                                 15470008
154800*  CURSOR TO PULL BACK TSUAUPC DATA                               15480008
154900*                                                                 15490008
155000     EXEC SQL                                                     15500008
155100       DECLARE SUAUPC-CSR CURSOR FOR                              15510008
155200         SELECT                                                   15520008
155300            AUD_CNTL_NBR                                          15530008
155400           ,SHIPT_UNT_ID                                          15540008
155500           ,UPC_NBR                                               15550008
155600           ,SCN_TMST                                              15560008
155700           ,AUD_USR_ID                                            15570008
155800           ,ITM_DESC                                              15580008
155900           ,VND_STYL_DESC                                         15590008
156000           ,UPC_CLOR_DESC                                         15600008
156100           ,UPC_SIZE_DESC                                         15610008
156200           ,UPC_RTL_AMT                                           15620008
156300           ,UPC_CERTD_IND                                         15630008
156400           ,SCND_UNT_QTY                                          15640008
156500           ,SCN_TYP_CDE                                           15650008
156600           ,SKU_NBR                                               15660008
156700           ,DEPT_NBR                                              15670008
156800           ,MAJ_CL_NBR                                            15680008
156900           ,SUB_CL_NBR                                            15690008
157000         FROM                                                     15700008
157100             TSUAUPC                                              15710008
157200         WHERE AUD_CNTL_NBR     = :HOLD-AUD-CNTL-NBR              15720008
157300           AND SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID             15730008
157400         WITH UR                                                  15740008
157500     END-EXEC.                                                    15750008
157600/                                                                 15760008
157700*                                                                 15770008
157800*  CURSOR TO PULL BACK TSUEXCP DATA                               15780008
157900*                                                                 15790008
158000     EXEC SQL                                                     15800008
158100       DECLARE SUEXCP_CSR CURSOR FOR                              15810008
158200         SELECT                                                   15820008
158300                   AUD_CNTL_NBR                                   15830008
158400                  ,SHIPT_UNT_ID                                   15840008
158500                  ,UPC_NBR                                        15850008
158600                  ,SCN_TMST                                       15860008
158700                  ,VILN_GP_CDE                                    15870008
158800                  ,VILN_GP_SEQ_NBR                                15880008
158900                  ,OVRRID_SYS_DAT_TXT                             15890008
159000         FROM                                                     15900008
159100             TSUEXCP                                              15910008
159200         WHERE AUD_CNTL_NBR     = :HOLD-AUD-CNTL-NBR              15920008
159300           AND SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID             15930008
159400         WITH UR                                                  15940008
159500     END-EXEC.                                                    15950008
159600/                                                                 15960008
159700*                                                                 15970008
159800*  CURSOR TO PULL BACK TCTEXCP DATA                               15980008
159900*                                                                 15990008
160000     EXEC SQL                                                     16000008
160100       DECLARE CTEXCP_CSR CURSOR FOR                              16010008
160200         SELECT                                                   16020008
160300                   AUD_CNTL_NBR                                   16030008
160400                  ,SHIPT_UNT_ID                                   16040008
160500                  ,VILN_GP_CDE                                    16050008
160600                  ,VILN_GP_SEQ_NBR                                16060008
160700                  ,OVRRID_SYS_DAT_TXT                             16070008
160800         FROM                                                     16080008
160900             TCTEXCP                                              16090008
161000         WHERE AUD_CNTL_NBR     = :HOLD-AUD-CNTL-NBR              16100008
161100           AND SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID             16110008
161200         WITH UR                                                  16120008
161300     END-EXEC.                                                    16130008
161400/                                                                 16140008
161500*                                                                 16150008
161600*  CURSOR TO PULL BACK TIMTBKY DATA                               16160008
161700*                                                                 16170008
161800     EXEC SQL                                                     16180008
161900       DECLARE IMTBKY_CSR CURSOR FOR                              16190008
162000         SELECT                                                   16200008
162100                   NOTIF_NBR                                      16210008
162200                  ,IMPRT_ID                                       16220008
162300                  ,IMPRT_SEQ_NBR                                  16230008
162400                  ,PRCS_TYP_CDE                                   16240008
162500                  ,CRE_TMST                                       16250008
162600         FROM                                                     16260008
162700             TIMTBKY                                              16270008
162800         WHERE NOTIF_NBR        = :HOLD-NOTIF-NBR                 16280008
162900         WITH UR                                                  16290008
163000     END-EXEC.                                                    16300008
163100/                                                                 16310008
163200*                                                                 16320008
163300*  CURSOR TO PULL BACK TPOPRPK DATA                               16330008
163400*                                                                 16340008
163500     EXEC SQL                                                     16350008
163600       DECLARE POPRPK_CSR CURSOR FOR                              16360008
163700         SELECT                                                   16370008
163800                   PO_NBR                                         16380008
163900                  ,VER_NBR                                        16390008
164000                  ,PO_PREPK_ID                                    16400008
164100                  ,PREPK_TYP_CDE                                  16410008
164200                  ,PREPK_DESC                                     16420008
164300                  ,PREPK_STAT_CDE                                 16430008
164400                  ,PREPK_UPC_NBR                                  16440008
164500                  ,INPK_UNT_QTY                                   16450008
164600                  ,INPK_CNVYB_IND                                 16460008
164700                  ,OTPK_UNT_QTY                                   16470008
164800                  ,OTPK_ORD_QTY                                   16480008
164900                  ,PK_DTL_CHG_TMST                                16490008
165000                  ,PK_SKU_NBR                                     16500008
165100         FROM                                                     16510008
165200             TPOPRPK                                              16520008
165300         WHERE PO_NBR           = :HOLD-PO-NBR                    16530008
165400         WITH UR                                                  16540008
165500     END-EXEC.                                                    16550008
165600/                                                                 16560008
165700     EXEC SQL                                                     16570008
165800       DECLARE XLT-PK-CSR CURSOR FOR                              16580008
165900         SELECT                                                   16590008
166000                   PK_SKU_NBR                                     16600008
166100                  ,PK_DESC                                        16610008
166200                  ,DEPT_NBR                                       16620008
166300                  ,MAJ_CL_NBR                                     16630008
166400                  ,SUB_CL_NBR                                     16640008
166500                  ,DC_ORD_MULT_QTY                                16650008
166600                  ,LAST_UPD_TMST                                  16660008
166700         FROM                                                     16670008
166800             XLT_PK                                               16680008
166900         WHERE PK_SKU_NBR       = :WS-POPRPK-PK-SKU-NBR           16690008
167000         WITH UR                                                  16700008
167100     END-EXEC.                                                    16710008
167200/                                                                 16720008
167300     EXEC SQL                                                     16730008
167400       DECLARE XLT-PK-UPC-CSR CURSOR FOR                          16740008
167500         SELECT                                                   16750008
167600                   PK_SKU_NBR                                     16760008
167700                  ,UPC_NBR                                        16770008
167800                  ,EDI_ORD_IND                                    16780008
167900                  ,LAST_UPD_TMST                                  16790008
168000         FROM                                                     16800008
168100             XLT_PK_UPC                                           16810008
168200         WHERE PK_SKU_NBR       = :WS-POPRPK-PK-SKU-NBR           16820008
168300         WITH UR                                                  16830008
168400     END-EXEC.                                                    16840008
168500/                                                                 16850008
168600     EXEC SQL                                                     16860008
168700       DECLARE XLT-PK-CPT-CSR CURSOR FOR                          16870008
168800         SELECT                                                   16880008
168900                   PK_SKU_NBR                                     16890008
169000                  ,CPT_SKU_NBR                                    16900008
169100                  ,PK_RATIO_UNT_QTY                               16910008
169200                  ,LAST_UPD_TMST                                  16920008
169300         FROM                                                     16930008
169400             XLT_PK_CPT_SKU                                       16940008
169500         WHERE PK_SKU_NBR       = :WS-POPRPK-PK-SKU-NBR           16950008
169600         WITH UR                                                  16960008
169700     END-EXEC.                                                    16970008
169800/                                                                 16980008
169900*                                                                 16990008
170000*  CURSOR TO PULL BACK TSULBXF DATA                               17000008
170100*                                                                 17010008
170200     EXEC SQL                                                     17020008
170300       DECLARE SULBXF_CSR CURSOR FOR                              17030008
170400         SELECT                                                   17040008
170500              SHIPT_UNT_ID                                        17050008
170600             ,BRCDE_NBR                                           17060008
170700             ,CART_LBL_TYP_CDE                                    17070008
170800             ,DEST_OPER_UNT_ID                                    17080008
170900             ,STAT_CDE                                            17090008
171000             ,LAST_STAT_CHG_TMST                                  17100008
171100             ,CRE_TMST                                            17110008
171200         FROM                                                     17120008
171300             TSULBXF                                              17130008
171400         WHERE SHIPT_UNT_ID     = :HOLD-SHIPT-UNT-ID              17140008
171500         WITH UR                                                  17150008
171600     END-EXEC.                                                    17160008
171700/                                                                 17170008
171800*                                                                 17180008
171900*  CURSOR TO PULL BACK TWEBITM DATA                               17190008
172000*                                                                 17200008
172100     EXEC SQL                                                     17210008
172200       DECLARE WEBITM_CSR CURSOR FOR                              17220008
172300         SELECT                                                   17230008
172400             INTR_UPC_ID                                          17240008
172500            ,EFF_BEG_TMST                                         17250008
172600            ,EFF_END_TMST                                         17260008
172700            ,ASRT_BEG_DTE                                         17270008
172800            ,ASRT_END_DTE                                         17280008
172900            ,STRG_AREA_SEQ_NBR                                    17290008
173000            ,SHIP_WD_QTY                                          17300008
173100            ,SHIP_DPTH_QTY                                        17310008
173200            ,SHIP_HT_QTY                                          17320008
173300            ,SHIP_WT_QTY                                          17330008
173400            ,SHIP_DIM_SRC_CDE                                     17340008
173500            ,PKG_SEQ_NBR                                          17350008
173600            ,SHIP_RSTRC_SEQ_NBR                                   17360008
173700            ,GFT_WRAP_AVL_IND                                     17370008
173800            ,PRD_GP_NBR                                           17380008
173900            ,PRD_GP_IND                                           17390008
174000            ,SHIP_SRCHG_FEE_AMT                                   17400008
174100            ,SHIP_SRVC_SEQ_NBR                                    17410008
174200            ,SHIP_GP_SEQ_NBR                                      17420008
174300            ,CRE_BY_USR_ID                                        17430008
174400            ,WEB_ITM_DLTD_IND                                     17440008
174500            ,HAZDS_IND                                            17450008
174600            ,BRKBL_IND                                            17460008
174700            ,GC_IND                                               17470008
174800            ,SHIP_ALN_IND                                         17480008
174900            ,WEB_EXCLV_IND                                        17490008
175000         FROM                                                     17500008
175100             TWEBITM                                              17510008
175200         WHERE INTR_UPC_ID = :HOLD-INTR-UPC-ID                    17520008
175300           AND EFF_BEG_TMST =                                     17530008
175400                   (SELECT MAX(EFF_BEG_TMST)                      17540008
175500                    FROM TWEBITM                                  17550008
175600                    WHERE  INTR_UPC_ID = :HOLD-INTR-UPC-ID)       17560008
175700         WITH UR                                                  17570008
175800     END-EXEC.                                                    17580008
175900/                                                                 17590008
176000*                                                                 17600008
176100*  CURSOR TO PULL BACK TLBVRDA DATA                               17610008
176200*                                                                 17620008
176300     EXEC SQL                                                     17630008
176400       DECLARE LBVRDA_CSR CURSOR FOR                              17640008
176500         SELECT                                                   17650008
176600            PO_NBR                                                17660008
176700           ,RCVR_SEQ_NBR                                          17670008
176800           ,PO_LNE_NBR                                            17680008
176900           ,PREPK_ID                                              17690008
177000           ,OTPK_UNT_QTY                                          17700008
177100           ,LBL_ASG_IND                                           17710008
177200           ,LBL_TYP_CDE                                           17720008
177300           ,LBL_ASG_SEQ_NBR                                       17730008
177400           ,PRNT_CART_SEQ_ID                                      17740008
177500           ,CART_LBL_TYP_CDE                                      17750008
177600           ,PREPK_PRCG_LNE_NBR                                    17760008
177700           ,INPK_UNT_QTY                                          17770008
177800           ,PREPK_RATO_QTY                                        17780008
177900           ,PREPK_UNT_QTY                                         17790008
178000           ,DEST_OPER_UNT_ID                                      17800008
178100           ,CSE_PK_QTY                                            17810008
178200           ,ODD_CART_IND                                          17820008
178300           ,INPK_CNVYB_IND                                        17830008
178400           ,LBL_TYP_LBL_SEQ_ID                                    17840008
178500           ,LBL_TYP_TOT_QTY                                       17850008
178600           ,BRCDE_NBR                                             17860008
178700           ,STR_ZN_ID                                             17870008
178800           ,MODU_DESC                                             17880008
178900           ,ITM_NBR                                               17890008
179000           ,DEPT_DESC                                             17900008
179100           ,MAJ_CL_DESC                                           17910008
179200           ,SEASET_NM                                             17920008
179300           ,FIXT_ID                                               17930008
179400           ,STRG_AREA_CDE                                         17940008
179500         FROM                                                     17950008
179600             TLBVRDA                                              17960008
179700         WHERE PO_NBR           = :HOLD-PO-NBR                    17970008
179800         WITH UR                                                  17980008
179900     END-EXEC.                                                    17990008
180000/                                                                 18000008
180100*                                                                 18010008
180200*  CURSOR TO PULL BACK OTBND_UPC                                  18020008
180300*                                                                 18030008
180400     EXEC SQL                                                     18040008
180500       DECLARE OTBUPC-CSR CURSOR FOR                              18050008
180600         SELECT                                                   18060008
180700             SHIPT_UNT_ID                                         18070008
180800         ,   TRN_NBR                                              18080008
180900         ,   RCVR_SEQ_NBR                                         18090008
181000         ,   TRN_LNE_NBR                                          18100008
181100         ,   TRN_TYP_CDE                                          18110008
181200         ,   UPC_NBR                                              18120008
181300         ,   SHPD_UNT_QTY                                         18130008
181400         FROM                                                     18140008
181500             SUT_OTBND_UPC                                        18150008
181600         WHERE TRN_NBR          = :HOLD-PO-NBR                    18160008
181700         WITH UR                                                  18170008
181800     END-EXEC.                                                    18180008
181900/                                                                 18190008
180200*  CURSOR TO PULL BACK TFGTRST                                    18191014
180300*                                                                 18192014
180400     EXEC SQL                                                     18193014
180500       DECLARE FGTRST-CSR CURSOR FOR                              18194014
180600         SELECT                                                   18195014
                    TP_DKEY                                             18195114
                   ,TP_DKEY_TMST                                        18195214
                   ,FUNC_CDE_SEQ_NBR                                    18195314
                   ,TRN_SET_SEQ_NBR                                     18195414
                   ,TRN_SET_CDE                                         18195514
                   ,FUNC_CDE_CNTL_NBR                                   18195614
                   ,VEND_ACK_IND                                        18195714
                   ,TRN_SET_CNTL_NBR                                    18195814
                   ,TRN_DTL_TXT                                         18195914
                   ,CHARS_XMIT_NBR                                      18196014
                   ,RTE_IND                                             18196114
                   ,TRANSL_ERR_IND                                      18196214
                   ,TRN_RLSE_TMST                                       18196314
                   ,PO_ACKNL_STAT_CDE                                   18196414
181400         FROM                                                     18199414
181500             TFGTRST                                              18199514
181600         WHERE TP_DKEY          = :HOLD-TP-DKEY                   18199614
181700         WITH UR                                                  18199714
181800     END-EXEC.                                                    18199814
181900/                                                                 18199914
180200*  CURSOR TO PULL BACK TINTTRN                                    18200016
180300*                                                                 18200116
180400     EXEC SQL                                                     18200216
180500       DECLARE INTTRN-CSR CURSOR FOR                              18200316
180600         SELECT                                                   18200416
                    TP_DKEY                                             18200516
                   ,TP_DKEY_TMST                                        18200616
                   ,DIR_IND                                             18200716
                   ,INCHG_CNTL_NBR                                      18200816
                   ,CRE_DTE                                             18200916
                   ,CRE_TME                                             18201016
                   ,MAILBOX_REC_DTE                                     18201116
                   ,MAILBOX_REC_TME                                     18201216
                   ,MAILBOX_PU_DTE                                      18201316
                   ,MAILBOX_PU_TME                                      18201416
                   ,ERR_IND                                             18201516
                   ,PROD_TEST_IND                                       18201616
                   ,TRANSL_SESS_ID                                      18201716
                   ,TRN_MANL_FRCD_IND                                   18201816
181400         FROM                                                     18203216
181500             TINTTRN                                              18203316
181600         WHERE TP_DKEY          = :HOLD-TP-DKEY                   18203416
181600         ORDER BY CRE_DTE DESC                                    18203526
181700         WITH UR                                                  18203626
181800     END-EXEC.                                                    18203726
181900/                                                                 18203826
182000*                                                                 18204008
182100*  CURSOR TO PULL BACK OTBND_PKD_UPC                              18210008
182200*                                                                 18220008
182300     EXEC SQL                                                     18230008
182400       DECLARE OTB-PKD-UPC-CSR CURSOR FOR                         18240008
182500         SELECT                                                   18250008
182600           SHIPT_UNT_ID                                           18260008
182700          ,TRN_NBR                                                18270008
182800          ,RCVR_SEQ_NBR                                           18280008
182900          ,TRN_LNE_NBR                                            18290008
183000          ,TRN_TYP_CDE                                            18300008
183100          ,UPC_NBR                                                18310008
183200          ,PKD_BY_USR_ID                                          18320008
183300          ,PKD_TMST                                               18330008
183400          ,PKD_QTY                                                18340008
183500          ,MODU_NBR                                               18350008
183600         FROM                                                     18360008
183700             SUT_OTBND_PKD_UPC                                    18370008
183800         WHERE                                                    18380008
183900             SHIPT_UNT_ID          =   :SUT00028-SHIPT-UNT-ID     18390008
184000         AND TRN_NBR               =   :SUT00028-TRN-NBR          18400008
184100         AND RCVR_SEQ_NBR          =   :SUT00028-RCVR-SEQ-NBR     18410008
184200         AND TRN_LNE_NBR           =   :SUT00028-TRN-LNE-NBR      18420008
184300         AND TRN_TYP_CDE           =   :SUT00028-TRN-TYP-CDE      18430008
184400         AND UPC_NBR               =   :SUT00028-UPC-NBR          18440008
184500         WITH UR                                                  18450008
184600     END-EXEC.                                                    18460008
184700/                                                                 18470008
184800     EXEC SQL                                                     18480008
184900       DECLARE OTBLOC-CSR CURSOR FOR                              18490008
185000         SELECT                                                   18500008
185100             LOC.SHIPT_UNT_ID                                     18510008
185200            ,LOC.CRE_TMST                                         18520008
185300            ,LOC.OTBND_TRIP_ID                                    18530008
185400            ,LOC.LOC_NBR                                          18540008
185500            ,LOC.SCN_CDE                                          18550008
185600            ,LOC.CRE_USR_ID                                       18560008
185700            ,LOC.ACTV_CDE                                         18570008
185800            ,LOC.INBD_TRIP_ID                                     18580008
185900         FROM                                                     18590008
186000             SUT_OTBND_LOC    LOC                                 18600008
186100*        ,   SUT_OTBND_UPC    UPC                                 18610008
186200         WHERE                                                    18620008
186300             LOC.SHIPT_UNT_ID     = :SUT00028-SHIPT-UNT-ID        18630008
186400*        AND LOC.OTBND_TRIP_ID    = :SUOBTR-OTBND-TRIP-ID         18640008
186500*        AND UPC.TRN_NBR          = :HOLD-PO-NBR                  18650008
186600         WITH UR                                                  18660008
186700     END-EXEC.                                                    18670008
186800/                                                                 18680008
186900*                                                                 18690008
187000*  CURSOR FOR ALL STATUSES OF A TRIP                              18700008
187100*                                                                 18710008
187200     EXEC SQL                                                     18720008
187300       DECLARE SUOBTS-CSR CURSOR FOR                              18730008
187400         SELECT                                                   18740008
187500             OTBND_TRIP_ID                                        18750008
187600            ,OTBND_STAT_TMST                                      18760008
187700            ,TRIP_STAT_CDE                                        18770008
187800            ,STAT_OPER_UNT_ID                                     18780008
187900            ,OTBND_STAT_USR_ID                                    18790008
188000            ,DOOR_ID                                              18800008
188100            ,TRLR_SEAL_ID                                         18810008
188200            ,SHIP_SCAC_CDE                                        18820008
188300            ,SHIP_DRV_LAST_NM                                     18830008
188400            ,SHIP_DRV_FRST_NM                                     18840008
188500            ,SHIP_DRV_ID                                          18850008
188600            ,TRLR_PRKG_LOC_DESC                                   18860008
188700            ,TRLR_PRKG_SLOT_NBR                                   18870008
188800            ,FINCL_POST_TMST                                      18880008
188900            ,CPCTY_PCT                                            18890008
189000            ,UNUSD_PLLT_QTY                                       18900008
189100            ,LOD_BR_QTY                                           18910008
189200         FROM                                                     18920008
189300             TSUOBTS                                              18930008
189400         WHERE OTBND_TRIP_ID    = :SUOBTR-OTBND-TRIP-ID           18940008
189500         WITH UR                                                  18950008
189600     END-EXEC.                                                    18960008
189700/                                                                 18970008
189800*  ALL CARTON ADJUSTMENTS                                         18980008
189900*                                                                 18990008
190000     EXEC SQL                                                     19000008
190100       DECLARE SUQADJ-CSR CURSOR FOR                              19010008
190200         SELECT                                                   19020008
190300               SHIPT_UNT_ID                                       19030008
190400             , UPC_NBR                                            19040008
190500             , ADJ_TMST                                           19050008
190600             , OPER_UNT_ID                                        19060008
190700             , ADJ_FUNC_CDE                                       19070008
190800             , ADJ_BEF_QTY                                        19080008
190900             , ADJ_AFT_QTY                                        19090008
191000             , PRC_RSN_CDE                                        19100008
191100             , ADJ_USR_ID                                         19110008
191200         FROM TSUQADJ                                             19120008
191300         WHERE                                                    19130008
191400               SHIPT_UNT_ID     = :SUT00028-SHIPT-UNT-ID          19140008
191500         WITH UR                                                  19150008
191600       END-EXEC.                                                  19160008
191700/                                                                 19170008
193500*  FINANCIAL ADJUSTMENTS                                          19350008
193600*                                                                 19360008
193700     EXEC SQL                                                     19370008
193800       DECLARE FINCL-ADJ-CSR CURSOR FOR                           19380008
193900         SELECT                                                   19390008
194000           FINCL_ADJ_ID                                           19400008
194100          ,ADJ_ERR_CDE                                            19410008
194200          ,PO_NBR                                                 19420008
194300          ,RCVR_LNE_NBR                                           19430008
194400          ,RCVR_SEQ_NBR                                           19440008
194500          ,DEST_LOC_NBR                                           19450008
194600          ,CRE_TMST                                               19460008
194700          ,UPC_NBR                                                19470008
194800          ,SHIPT_UNT_ID                                           19480008
194900          ,PRC_RSN_CDE                                            19490008
195000          ,AUD_CNTL_NBR                                           19500008
195100          ,ORGN_LOC_NBR                                           19510008
195200          ,AUD_ADJ_STAT_CDE                                       19520008
195300          ,AUTO_APL_IND                                           19530008
195400          ,CRE_BY_USR_ID                                          19540008
195500          ,CRE_PGM_NM                                             19550008
195600          ,FINCL_BEF_QTY                                          19560008
195700          ,FINCL_AFT_QTY                                          19570008
195800          ,RSLV_BY_USR_ID                                         19580008
195900          ,RSLV_TMST                                              19590008
196000          ,PROB_RSN_CDE                                           19600008
196100          ,ADJ_QTY                                                19610008
196200          ,RSLV_CMNT_TXT                                          19620008
196300                                                                  19630008
196400         FROM SUT_FINCL_ADJ                                       19640008
196500         WHERE                                                    19650008
196600             SHIPT_UNT_ID     = :HOLD-SHIPT-UNIT-ID               19660008
196700*            PO_NBR           = :HOLD-PO-NBR                      19670008
196800             WITH UR                                              19680008
196900       END-EXEC.                                                  19690008
197000/                                                                 19700008
197100*  PURCHASE ORDER AUDIT REQUEST                                   19710008
197200*                                                                 19720008
197300     EXEC SQL                                                     19730008
197400       DECLARE SUT00015-CSR CURSOR FOR                            19740008
197500         SELECT                                                   19750008
197600           PO_NBR                                                 19760008
197700          ,PO_LNE_NBR                                             19770008
197800          ,PO_PREPK_ID                                            19780008
197900          ,OPER_UNT_ID                                            19790008
198000          ,INBND_TRIP_ID                                          19800008
198100          ,RCVR_SEQ_NBR                                           19810008
198200          ,AUD_CNTL_NBR                                           19820008
198300          ,CART_QTY                                               19830008
198400          ,UNT_QTY                                                19840008
198500          ,AUD_CART_QTY                                           19850008
198600          ,AUD_UNT_QTY                                            19860008
198700          ,AUD_STAT_CDE                                           19870008
198800          ,DFRD_AUD_IND                                           19880008
198900          ,AUD_ERR_PCT                                            19890008
199000          ,CRE_TMST                                               19900008
199100          ,CART_PRMPT_CDE                                         19910008
199200          ,VND_RNKG_CDE                                           19920008
199300          ,PKGNG_TYP_CDE                                          19930008
199400          ,EFF_BEG_TMST                                           19940008
199500          ,ENT_ID                                                 19950008
199600          ,DEPT_NBR                                               19960008
199700          ,AUD_STAT_RSN_CDE                                       19970008
199800          ,MOD_QTY_IND                                            19980008
199900          ,RWRK_AUD_CNTL_NBR                                      19990008
200000                                                                  20000008
200100         FROM SUT_PO_AUD_REQ                                      20010008
200200         WHERE                                                    20020008
200300               PO_NBR           = :HOLD-PO-NBR                    20030008
200400         WITH UR                                                  20040008
200500       END-EXEC.                                                  20050008
200600                                                                  20060008
200700* PO/RCVR TRACKING                                                20070008
200800     EXEC SQL                                                     20080008
200900       DECLARE RCT00017-CSR CURSOR FOR                            20090008
201000         SELECT                                                   20100008
201100             PO_NBR                                               20110008
201200            ,RCVR_SEQ_NBR                                         20120008
201300            ,CRE_BY_USR_ID                                        20130008
201400            ,CRE_TMST                                             20140008
201500            ,DC_FUNC_CDE                                          20150008
201600            ,LOC_NBR                                              20160008
201700            ,PO_LNE_NBR                                           20170008
201800            ,PREPK_ID                                             20180008
201900            ,CRE_BY_PGM_NM                                        20190008
202000            ,QTY_TRKD_NBR                                         20200008
202100            ,LAST_UPD_TMST                                        20210008
202200            ,PKSL_SEQ_NBR                                         20220008
202300            ,DEST_LOC_NBR                                         20230008
202400                                                                  20240008
202500         FROM RCT_PO_RCVR_TRKG                                    20250008
202600         WHERE                                                    20260008
202700               PO_NBR           = :HOLD-PO-NBR                    20270008
202800         WITH UR                                                  20280008
202900       END-EXEC.                                                  20290008
203000                                                                  20300008
203100                                                                  20310008
203200*    ALL THE OTBND_CART ROWS ON THE SAME TRIP                     20320008
203300     EXEC SQL                                                     20330008
203400         DECLARE SUT00024-CSR CURSOR FOR                          20340008
203500     SELECT                                                       20350008
203600         SHIPT_UNT_ID                                             20360008
203700        ,ORGN_LOC_NBR                                             20370008
203800        ,DEST_LOC_NBR                                             20380008
203900        ,CART_SRC_CDE                                             20390008
204000        ,CRE_DTE                                                  20400008
204100        ,CRE_TM                                                   20410008
204200        ,CRE_USR_ID                                               20420008
204300        ,CRE_PGM_NM                                               20430008
204400        ,MSTR_CART_IND                                            20440008
204500        ,PRNT_CART_ID                                             20450008
204600        ,ORIG_CART_ID                                             20460008
204700        ,CART_TYP_CDE                                             20470008
204800        ,LBL_PRT_SEQ_NBR                                          20480008
204900        ,CART_RVSN_NBR                                            20490008
205000        ,OTBND_TRIP_ID                                            20500008
205100        ,ACTV_IND                                                 20510008
205200        ,ODD_UNT_IND                                              20520008
205300         FROM                                                     20530008
205400             SUT_OTBND_CART                                       20540008
205500         WHERE                                                    20550008
205600               OTBND_TRIP_ID = :SUOBTR-OTBND-TRIP-ID              20560008
205700         WITH UR                                                  20570008
205800     END-EXEC.                                                    20580008
205900                                                                  20590008
206000*    ALL THE OTBND_PK ROWS ON THE SAME CARTON                     20600008
206100     EXEC SQL                                                     20610008
206200         DECLARE SUT00041-CSR CURSOR FOR                          20620008
206300     SELECT                                                       20630008
206400         SHIPT_UNT_ID                                             20640008
206500        ,TRN_NBR                                                  20650008
206600        ,RCVR_SEQ_NBR                                             20660008
206700        ,TRN_TYP_CDE                                              20670008
206800        ,PK_SKU_NBR                                               20680008
206900        ,SHPD_PK_QTY                                              20690008
207000         FROM                                                     20700008
207100             SUT_OTBND_PK                                         20710008
207200         WHERE                                                    20720008
207300               SHIPT_UNT_ID  = :SUT00024-SHIPT-UNT-ID             20730008
207400         WITH UR                                                  20740008
207500     END-EXEC.                                                    20750008
207600/                                                                 20760008
207700     EXEC SQL                                                     20770008
207800       DECLARE IMT_STYL_PRTNR_CSR CURSOR FOR                      20780008
207900         SELECT                                                   20790008
208000                SUB_CL_MDSEAR_ID                                  20800008
208100               ,VS_ID                                             20810008
208200               ,BUS_PRTNR_ROL_CDE                                 20820008
208300               ,ENT_ID                                            20830008
208400         FROM                                                     20840008
208500             IMT_STYL_PRTNR                                       20850008
208600         WHERE SUB_CL_MDSEAR_ID  = :HOLD-SUB-CL-MDSEAR-ID         20860008
208700           AND VS_ID             = :HOLD-VS-ID                    20870008
208800         WITH UR                                                  20880008
208900     END-EXEC.                                                    20890008
209000                                                                  20900008
209100                                                                  20910008
209200                                                                  20920008
209300     EXEC SQL                                                     20930008
209400       DECLARE WST-SHIPMT-DTL-CSR CURSOR FOR                      20940008
209500            SELECT                                                20950008
209600               EXT_SHP_ID                                         20960008
209700              ,PO_NBR                                             20970008
209800              ,PO_LNE_NBR                                         20980008
209900              ,RCVR_SEQ_NBR                                       20990008
210000              ,PREPK_ID                                           21000008
210100              ,ASN_LVL_CDE                                        21010008
210200              ,CRE_USR_ID                                         21020008
210300              ,CRE_TMST                                           21030008
210400              ,DWNLD_CDE                                          21040008
210500              ,ACTV_CDE                                           21050008
210600              ,CRE_PGM_CDE                                        21060008
210700             FROM WST_SHPMT_XREF_DTL                              21070008
210800             WHERE PO_NBR = :HOLD-PO-NBR                          21080008
210900         WITH UR                                                  21090008
211000     END-EXEC.                                                    21100008
211100                                                                  21110008
211200/                                                                 21120008
211300 PROCEDURE DIVISION.                                              21130008
211400                                                                  21140008
211500 A100-MAINLINE.                                                   21150008
211600                                                                  21160008
211700     INITIALIZE PV-WRITE-COUNT                                    21170008
211800                PT-TRIP-TABLE                                     21180008
211900                                                                  21190008
212000     MOVE WHEN-COMPILED TO PV-WHEN-COMPILED                       21200008
212100     DISPLAY SPACES                                               21210008
212200     DISPLAY ' *** DSKUT002 VERSION 3 ***'                        21220008
212300     DISPLAY 'COMPILE DATE: ' PV-COMPILE-DATE                     21230008
212400             ' ' PV-COMPILE-TIME                                  21240008
212500                                                                  21250008
212600     SET DS009-S-PGM TO TRUE.                                     21260008
212700     PERFORM DS002-INITIAL-PROCESSING.                            21270008
212800     PERFORM B100-FETCH-PROCESSING                                21280008
212900         VARYING DS009-PO-SUB FROM 1 BY 1                         21290008
213000         UNTIL DS009-PO-SUB > DS009-PO-SUB-MAX.                   21300008
213100                                                                  21310008
213200     DISPLAY '  ****  UNLOAD TOTALS  ****'                        21320008
213300                                                                  21330008
213400     PERFORM VARYING CNTL-I FROM 1 BY 1 UNTIL                     21340008
213500         CNTL-I > CNTL-SUB-MAX OR CNTL-I > 200                    21350008
213600         IF CNTL-TABLE(CNTL-I) NOT = SPACES                       21360008
213700             IF DS009-GROUP-NBR(CNTL-I) = '1'                     21370008
213800                 MOVE DS009-READ-COUNT (CNTL-I) TO DS009-DISP-NBR 21380008
213900                 DISPLAY 'TABLE = ' CNTL-TABLE(CNTL-I)            21390008
214000                      DS009-DISP-NBR                              21400008
214100             END-IF                                               21410008
214200         END-IF                                                   21420008
214300     END-PERFORM                                                  21430008
214400                                                                  21440008
214500     MOVE PV-WRITE-COUNT            TO DS009-DISP-NBR             21450008
214600     DISPLAY '*** TOTAL UNLOADS WRITTEN = '  DS009-DISP-NBR       21460008
214700                                                                  21470008
214800     PERFORM DS002-END-OF-JOB.                                    21480008
214900                                                                  21490008
215000     GOBACK.                                                      21500008
215100/                                                                 21510008
215200***************************************************************** 21520008
215300*     FOR EACH TABLE IN THE CONTROL FILE PROCESS THE FETCH      * 21530008
215400***************************************************************** 21540008
215500 B100-FETCH-PROCESSING.                                           21550008
215600*                                                                 21560008
215700     IF DS009-PO-NBR (DS009-PO-SUB) NUMERIC                       21570008
215800         IF DS009-PO-NBR (DS009-PO-SUB) > ZERO                    21580008
215900             MOVE DS009-PO-NBR (DS009-PO-SUB)                     21590008
216000                                        TO PV-DISP-NBR            21600008
216100             DISPLAY 'NOW PROCESSING PO = '  PV-DISP-NBR          21610008
216200                                                                  21620008
216300               PERFORM WITH TEST BEFORE                           21630008
216400                   VARYING DS009-CNTL-J FROM 1 BY 1               21640008
216500                     UNTIL DS009-CNTL-J > CNTL-SUB-MAX            21650008
216600                     IF CNTL-SEL (DS009-CNTL-J) = 'Y'             21660008
216700                        MOVE CNTL-TABLE (DS009-CNTL-J)            21670008
216800                                     TO DS009-PROCESS-TABLE       21680008
216900                        PERFORM DS002-DO-PROCESS                  21690008
217000                        IF DS009-DO-PROCESS                       21700008
217100                          MOVE DS009-PO-NBR (DS009-PO-SUB)        21710008
217200                                        TO HOLD-PO-NBR            21720008
217300                                           PV-DISP-NBR            21730008
217400                          PERFORM B100-TABLE-FETCH                21740008
217500                        END-IF                                    21750008
217600                     END-IF                                       21760008
217700               END-PERFORM                                        21770008
217800                                                                  21780008
217900         END-IF                                                   21790008
218000     END-IF.                                                      21800008
218100/                                                                 21810008
218200***************************************************************** 21820008
218300* PROCESS THE TABLES                                              21830008
218400***************************************************************** 21840008
218500 B100-TABLE-FETCH.                                                21850008
218600                                                                  21860008
218700        EVALUATE TRUE                                             21870008
218800        WHEN DS009-PROCESS-TABLE = 'TPURCHS'                      21880008
218900             PERFORM Y100-OPEN-CURSOR                             21890008
219000             SET MORE-PURCHS-DATA TO TRUE                         21900008
219100              PERFORM R100-FETCH-PURCHS                           21910008
219200                 UNTIL NO-MORE-PURCHS-DATA                        21920008
219300             MOVE 'TPURCHS' TO DS009-PROCESS-TABLE                21930008
219400             PERFORM Z100-CLOSE-CURSOR                            21940008
219500        WHEN DS009-PROCESS-TABLE = 'TPOAGMT'                      21950008
219600             PERFORM Y100-OPEN-CURSOR                             21960008
219700             SET MORE-POAGMT-DATA TO TRUE                         21970008
219800             PERFORM R100-FETCH-POAGMT                            21980008
219900                UNTIL NO-MORE-POAGMT-DATA                         21990008
220000             MOVE 'TPOAGMT' TO DS009-PROCESS-TABLE                22000008
220100             PERFORM Z100-CLOSE-CURSOR                            22010008
220200        WHEN DS009-PROCESS-TABLE = 'TPOINST'                      22020008
220300             PERFORM Y100-OPEN-CURSOR                             22030008
220400             SET MORE-POINST-DATA TO TRUE                         22040008
220500             PERFORM R100-FETCH-POINST                            22050008
220600                UNTIL NO-MORE-POINST-DATA                         22060008
220700             MOVE 'TPOINST' TO DS009-PROCESS-TABLE                22070008
220800             PERFORM Z100-CLOSE-CURSOR                            22080008
220900        WHEN DS009-PROCESS-TABLE = 'TIMPORL'                      22090008
221000             PERFORM Y100-OPEN-CURSOR                             22100008
221100             SET MORE-IMPORL-DATA TO TRUE                         22110008
221200             PERFORM R100-FETCH-IMPORL                            22120008
221300                UNTIL NO-MORE-IMPORL-DATA                         22130008
221400             MOVE 'TIMPORL' TO DS009-PROCESS-TABLE                22140008
221500             PERFORM Z100-CLOSE-CURSOR                            22150008
221600        WHEN DS009-PROCESS-TABLE = 'TALLPLN'                      22160008
221700             PERFORM Y100-OPEN-CURSOR                             22170008
221800             SET MORE-ALLPLN-DATA TO TRUE                         22180008
221900             PERFORM R100-FETCH-ALLPLN                            22190008
222000                UNTIL NO-MORE-ALLPLN-DATA                         22200008
222100             MOVE 'TALLPLN' TO DS009-PROCESS-TABLE                22210008
222200             PERFORM Z100-CLOSE-CURSOR                            22220008
222300        WHEN DS009-PROCESS-TABLE = 'TPLNSHP'                      22230008
222400             PERFORM Y100-OPEN-CURSOR                             22240008
222500             SET MORE-PLNSHP-DATA TO TRUE                         22250008
222600             PERFORM R100-FETCH-PLNSHP                            22260008
222700                UNTIL NO-MORE-PLNSHP-DATA                         22270008
222800             MOVE 'TPLNSHP' TO DS009-PROCESS-TABLE                22280008
222900             PERFORM Z100-CLOSE-CURSOR                            22290008
223000        WHEN DS009-PROCESS-TABLE = 'TPURITM'                      22300008
223100             PERFORM Y100-OPEN-CURSOR                             22310008
223200             SET MORE-PURITM-DATA TO TRUE                         22320008
223300             PERFORM R100-FETCH-PURITM                            22330008
223400                UNTIL NO-MORE-PURITM-DATA                         22340008
223500             MOVE 'TPURITM' TO DS009-PROCESS-TABLE                22350008
223600             PERFORM Z100-CLOSE-CURSOR                            22360008
223700        WHEN DS009-PROCESS-TABLE = 'TINPKSU'                      22370008
223800             PERFORM Y100-OPEN-CURSOR                             22380008
223900             SET MORE-INPKSU-DATA TO TRUE                         22390008
224000             PERFORM R100-FETCH-INPKSU                            22400008
224100                UNTIL NO-MORE-INPKSU-DATA                         22410008
224200             MOVE 'TINPKSU' TO DS009-PROCESS-TABLE                22420008
224300             PERFORM Z100-CLOSE-CURSOR                            22430008
224400        WHEN DS009-PROCESS-TABLE = 'TMESTDS'                      22440008
224500             PERFORM Y100-OPEN-CURSOR                             22450008
224600             SET MORE-MESTDS-DATA TO TRUE                         22460008
224700             PERFORM R100-FETCH-MESTDS                            22470008
224800                UNTIL NO-MORE-MESTDS-DATA                         22480008
224900             MOVE 'TMESTDS' TO DS009-PROCESS-TABLE                22490008
225000             PERFORM Z100-CLOSE-CURSOR                            22500008
225100*       WHEN DS009-PROCESS-TABLE = 'TSPSTDS'                      22510008
225200*            PERFORM Y100-OPEN-CURSOR                             22520008
225300*            SET MORE-SPSTDS-DATA TO TRUE                         22530008
225400*            PERFORM R100-FETCH-SPSTDS                            22540008
225500*               UNTIL NO-MORE-SPSTDS-DATA                         22550008
225600*            MOVE 'TSPSTDS' TO DS009-PROCESS-TABLE                22560008
225700*            PERFORM Z100-CLOSE-CURSOR                            22570008
225800        WHEN DS009-PROCESS-TABLE = 'TTRBNTF'                      22580008
225900             PERFORM Y100-OPEN-CURSOR                             22590008
226000             SET MORE-TRBNTF-DATA TO TRUE                         22600008
226100             PERFORM R100-FETCH-TRBNTF                            22610008
226200                UNTIL NO-MORE-TRBNTF-DATA                         22620008
226300             MOVE 'TTRBNTF' TO DS009-PROCESS-TABLE                22630008
226400             PERFORM Z100-CLOSE-CURSOR                            22640008
226500*       WHEN DS009-PROCESS-TABLE = 'TPOUPC'                       22650010
226600*            PERFORM Y100-OPEN-CURSOR                             22660010
226700*            SET MORE-POUPC-DATA TO TRUE                          22670010
226800*            PERFORM R100-FETCH-POUPC                             22680010
226900*               UNTIL NO-MORE-POUPC-DATA                          22690010
227000*            MOVE 'TPOUPC' TO DS009-PROCESS-TABLE                 22700010
227100*            PERFORM Z100-CLOSE-CURSOR                            22710010
227200        WHEN DS009-PROCESS-TABLE = 'TALLTMP'                      22720008
227300             PERFORM Y100-OPEN-CURSOR                             22730008
227400             SET MORE-ALLTMP-DATA TO TRUE                         22740008
227500             PERFORM R100-FETCH-ALLTMP                            22750008
227600                UNTIL NO-MORE-ALLTMP-DATA                         22760008
227700             MOVE 'TALLTMP' TO DS009-PROCESS-TABLE                22770008
227800             PERFORM Z100-CLOSE-CURSOR                            22780008
227900*       WHEN DS009-PROCESS-TABLE = 'TPAYREQ'                      22790008
228000*            PERFORM Y100-OPEN-CURSOR                             22800008
228100*            SET MORE-PAYREQ-DATA TO TRUE                         22810008
228200*            PERFORM R100-FETCH-PAYREQ                            22820008
228300*               UNTIL NO-MORE-PAYREQ-DATA                         22830008
228400*            MOVE 'TPAYREQ' TO DS009-PROCESS-TABLE                22840008
228500*            PERFORM Z100-CLOSE-CURSOR                            22850008
228600        WHEN DS009-PROCESS-TABLE = 'TASNORD'                      22860008
228700             MOVE ZEROES          TO HOLD-PO-NBR-NUM              22870008
228800             MOVE SPACES          TO HOLD-PO-NBR-C6               22880008
228900                                     HOLD-PO-NBR-C7               22890008
229000             MOVE HOLD-PO-NBR     TO HOLD-PO-NBR-NUM              22900008
229100*CLP 02/17/15 START                                               22910008
229200             DISPLAY 'HOLD-PO-NBR-NUM = ' HOLD-PO-NBR-NUM         22920008
229300             ' *** '                                              22930008
229400*CODE BEFORE 8 DIGIT PO BELOW                                     22940008
229500*            IF HOLD-PO-NBR-NUM(4:1) = 0                          22950008
229600*               MOVE HOLD-PO-NBR-NUM(4:7) TO HOLD-PO-NBR-C7       22960008
229700*               MOVE HOLD-PO-NBR-NUM(5:6) TO HOLD-PO-NBR-C6       22970008
229800*            ELSE                                                 22980008
229900*               MOVE HOLD-PO-NBR-NUM(4:7) TO HOLD-PO-NBR-C7       22990008
230000*               MOVE HOLD-PO-NBR-NUM(4:7) TO HOLD-PO-NBR-C6       23000008
230100*            END-IF                                               23010008
230200                                                                  23020008
230300             IF HOLD-PO-NBR-NUM(3:1) > 0                          23030008
230400*               8 DIGIT PO                                        23040008
230500                MOVE HOLD-PO-NBR-NUM(3:8) TO HOLD-PO-NBR-C8       23050008
230600                                             HOLD-PO-NBR-C7       23060008
230700                                             HOLD-PO-NBR-C6       23070008
230800                DISPLAY HOLD-PO-NBR-C8 ' ' HOLD-PO-NBR-C7 ' '     23080008
230900                        HOLD-PO-NBR-C6                            23090008
231000             ELSE                                                 23100008
231100*               6 DIGIT PO                                        23110008
231200                IF HOLD-PO-NBR-NUM(4:1) = 0                       23120008
231300                   MOVE HOLD-PO-NBR-NUM(4:7) TO HOLD-PO-NBR-C7    23130008
231400                   MOVE HOLD-PO-NBR-NUM(3:8) TO HOLD-PO-NBR-C8    23140008
231500                   MOVE HOLD-PO-NBR-NUM(5:6) TO HOLD-PO-NBR-C6    23150008
231600                   DISPLAY '6 DIGIT'                              23160008
231700                   DISPLAY 'HOLD-PO-NBR-C7 = ' HOLD-PO-NBR-C7 '*' 23170008
231800                   DISPLAY 'HOLD-PO-NBR-C6 = ' HOLD-PO-NBR-C6 '*' 23180008
231900                   DISPLAY 'HOLD-PO-NBR-C8 = ' HOLD-PO-NBR-C8 '*' 23190008
232000                ELSE                                              23200008
232100                   MOVE HOLD-PO-NBR-NUM(4:7) TO HOLD-PO-NBR-C7    23210008
232200                   MOVE HOLD-PO-NBR-NUM(4:7) TO HOLD-PO-NBR-C6    23220008
232300                   MOVE HOLD-PO-NBR-NUM(3:8) TO HOLD-PO-NBR-C8    23230008
232400                   DISPLAY 'HOLD-PO-NBR-C8 = ' HOLD-PO-NBR-C8 '*' 23240008
232500                   DISPLAY 'HOLD-PO-NBR-C7 = ' HOLD-PO-NBR-C7 '*' 23250008
232600                   DISPLAY 'HOLD-PO-NBR-C6 = ' HOLD-PO-NBR-C6 '*' 23260008
232700                END-IF                                            23270008
232800             END-IF                                               23280008
232900*CLP 02/17/15 END                                                 23290008
233000             PERFORM Y100-OPEN-CURSOR                             23300008
233100             SET MORE-ASNORD-DATA TO TRUE                         23310008
233200             PERFORM R100-FETCH-ASNORD                            23320008
233300                UNTIL NO-MORE-ASNORD-DATA                         23330008
233400             MOVE 'TASNORD' TO DS009-PROCESS-TABLE                23340008
233500             PERFORM Z100-CLOSE-CURSOR                            23350008
233600        WHEN DS009-PROCESS-TABLE = 'TPOPRPK'                      23360008
233700             PERFORM Y100-OPEN-CURSOR                             23370008
233800             SET MORE-POPRPK-DATA TO TRUE                         23380008
233900             PERFORM R100-FETCH-POPRPK                            23390008
234000                UNTIL NO-MORE-POPRPK-DATA                         23400008
234100             MOVE 'TPOPRPK' TO DS009-PROCESS-TABLE                23410008
234200             PERFORM Z100-CLOSE-CURSOR                            23420008
234300                                                                  23430008
234400        WHEN DS009-PROCESS-TABLE = 'RCT_PO_RCVR_TRKG'             23440008
234500             PERFORM Y100-OPEN-CURSOR                             23450008
234600             SET DS010-END-RCT00017-NO TO TRUE                    23460008
234700             PERFORM R100-FETCH-PORCVR-TRKG                       23470008
234800                UNTIL DS010-END-RCT00017-YES                      23480008
234900             MOVE 'RCT_PO_RCVR_TRKG' TO DS009-PROCESS-TABLE       23490008
235000             PERFORM Z100-CLOSE-CURSOR                            23500008
235100                                                                  23510008
235200                                                                  23520008
236100        WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_UPC'                23610008
236200             PERFORM Y100-OPEN-CURSOR                             23620008
236300             SET MORE-OTBUPC-DATA TO TRUE                         23630008
236400                                                                  23640008
236500*            THIS ALSO GENERATES UNLOADS FOR SUT_OTBND_CART       23650008
236600*            TSUOBTR, TSUOBTS, SUT_OTBND_PKD_UPC                  23660008
236700*            SUT_OTBND_PKD_LOC, TSUQADJ                           23670038
236800*            SUT_OTBND_PK                                         23680008
236900*            SUT_FINCL_ADJ                                        23690008
237000                                                                  23700008
237100             INITIALIZE PT-TRIP-TABLE                             23710008
237200             PERFORM B150-PROCESS-CARTONS                         23720008
237300                 UNTIL NO-MORE-OTBUPC-DATA                        23730008
237400             MOVE 'SUT_OTBND_UPC' TO DS009-PROCESS-TABLE          23740008
237500             PERFORM Z100-CLOSE-CURSOR                            23750008
237600                                                                  23760008
237700*       WHEN DS009-PROCESS-TABLE = 'SUT_FINCL_ADJ'                23770008
237800*            MOVE 'SUT_FINCL_ADJ'     TO DS009-PROCESS-TABLE      23780008
237900*            MOVE WS-INPKSU-SHIPT-UNT-ID                          23790008
238000*                                       TO HOLD-SHIPT-UNIT-ID     23800008
238100*            PERFORM Y100-OPEN-CURSOR                             23810008
238200*            SET MORE-FINCL-ADJ-DATA TO TRUE                      23820008
238300*            PERFORM R100-FETCH-FINCL-ADJ                         23830008
238400*               UNTIL NO-MORE-FINCL-ADJ-DATA                      23840008
238500*            PERFORM Z100-CLOSE-CURSOR                            23850008
238600                                                                  23860008
238700        WHEN DS009-PROCESS-TABLE = 'SUT_PO_AUD_REQ'               23870008
238800             MOVE 'SUT_PO_AUD_REQ'    TO DS009-PROCESS-TABLE      23880008
238900             PERFORM Y100-OPEN-CURSOR                             23890008
239000             SET MORE-SUT00015-DATA TO TRUE                       23900008
239100             PERFORM R100-FETCH-SUT00015                          23910008
239200                UNTIL NO-MORE-SUT00015-DATA                       23920008
239300             MOVE 'SUT_PO_AUD_REQ' TO DS009-PROCESS-TABLE         23930008
239400             PERFORM Z100-CLOSE-CURSOR                            23940008
239500                                                                  23950008
239600        WHEN DS009-PROCESS-TABLE = 'WST_SHPMT_XREF_DTL'           23960008
239700             MOVE 'WST_SHPMT_XREF_DTL' TO DS009-PROCESS-TABLE     23970008
239800*            DISPLAY DS009-PROCESS-TABLE                          23980008
239900             PERFORM Y100-OPEN-CURSOR                             23990008
240000             SET DS010-END-WST00002-NO TO TRUE                    24000008
240100             PERFORM R100-FETCH-WST00002                          24010008
240200                UNTIL DS010-END-WST00002-YES                      24020008
240300             MOVE 'WST_SHPMT_XREF_DTL' TO DS009-PROCESS-TABLE     24030008
240400             PERFORM Z100-CLOSE-CURSOR                            24040008
240500                                                                  24050008
240600*       WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_PKD_UPC'            24060008
240700*            PERFORM Y100-OPEN-CURSOR                             24070008
240800*            SET MORE-OTBPKD-DATA TO TRUE                         24080008
240900*            PERFORM R100-FETCH-OTBND-PKD-UPC                     24090008
241000*               UNTIL NO-MORE-OTBPKD-DATA                         24100008
241100*            MOVE 'SUT_OTBND_PKD_UPC' TO DS009-PROCESS-TABLE      24110008
241200*            PERFORM Z100-CLOSE-CURSOR                            24120008
241300                                                                  24130008
241400*       WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_LOC'                24140008
241500*            PERFORM Y100-OPEN-CURSOR                             24150008
241600*            SET MORE-OTBLOC-DATA TO TRUE                         24160008
241700*            PERFORM R100-FETCH-OTBND-LOC                         24170008
241800*               UNTIL NO-MORE-OTBLOC-DATA                         24180008
241900*            MOVE 'SUT_OTBND_LOC' TO DS009-PROCESS-TABLE          24190008
242000*            PERFORM Z100-CLOSE-CURSOR                            24200008
242100                                                                  24210008
242200*       WHEN DS009-PROCESS-TABLE = 'TSUQADJ'                      24220008
242300*            PERFORM Y100-OPEN-CURSOR                             24230008
242400*            SET MORE-SUQADJ-DATA TO TRUE                         24240008
242500*            PERFORM R100-FETCH-OTBND-LOC                         24250008
242600*               UNTIL NO-MORE-OTBLOC-DATA                         24260008
242700*            MOVE 'TSUQADJ'       TO DS009-PROCESS-TABLE          24270008
242800*            PERFORM Z100-CLOSE-CURSOR                            24280008
242900                                                                  24290008
243000*MAM    WHEN DS009-PROCESS-TABLE = 'TSKXREF'                      24300008
243100*MAM         PERFORM Y100-OPEN-CURSOR                             24310008
243200*MAM         SET MORE-SKXREF-DATA TO TRUE                         24320008
243300*MAM         PERFORM R100-FETCH-SKXREF                            24330008
243400*MAM            UNTIL NO-MORE-SKXREF-DATA                         24340008
243500*MAM         MOVE 'TSKXREF' TO DS009-PROCESS-TABLE                24350008
243600*MAM         PERFORM Z100-CLOSE-CURSOR                            24360008
243700*MAM    WHEN DS009-PROCESS-TABLE = 'TUPCPLS'                      24370008
243800*MAM         PERFORM Y100-OPEN-CURSOR                             24380008
243900*MAM         SET MORE-UPCPLS-DATA TO TRUE                         24390008
244000*MAM         PERFORM R100-FETCH-UPCPLS                            24400008
244100*MAM            UNTIL NO-MORE-UPCPLS-DATA                         24410008
244200*MAM         MOVE 'TUPCPLS' TO DS009-PROCESS-TABLE                24420008
244300*MAM         PERFORM Z100-CLOSE-CURSOR                            24430008
244400*MAM    WHEN DS009-PROCESS-TABLE = 'TMDARVS'                      24440008
244500*MAM         PERFORM Y100-OPEN-CURSOR                             24450008
244600*MAM         SET MORE-MDARVS-DATA TO TRUE                         24460008
244700*MAM         PERFORM R100-FETCH-MDARVS                            24470008
244800*MAM            UNTIL NO-MORE-MDARVS-DATA                         24480008
244900*MAM         MOVE 'TMDARVS' TO DS009-PROCESS-TABLE                24490008
245000*MAM         PERFORM Z100-CLOSE-CURSOR                            24500008
245100        END-EVALUATE.                                             24510008
245200*                                                                 24520008
245300 B150-PROCESS-CARTONS.                                            24530008
245400*    DISPLAY 'B150-PROCESS-CARTONS'                               24540008
245500                                                                  24550008
245600*    FETCH AND WRITE AN OTBND-UPC ROW                             24560008
245700     PERFORM R100-FETCH-OTBND-UPC                                 24570008
245800                                                                  24580008
245900     IF MORE-OTBUPC-DATA                                          24590008
246000*        PROCESS ALL OTBND_CART ROWS FOR THIS CARTON              24600008
246100         MOVE 'SUT_OTBND_CART'     TO DS002-NAME                  24610008
246200         PERFORM DS002-DO-PROCESS                                 24620008
246300         IF DS009-DO-PROCESS                                      24630008
246400*            WRITE TO UNLOAD FILE IF FOUND                        24640008
246500             PERFORM S100-SELECT-OTBND-CART                       24650008
246600                                                                  24660008
246700             IF DK-TRIP-NULL-ID > -1                              24670008
246800                 MOVE 'TSUOBTR' TO DS009-PROCESS-TABLE            24680008
246900                 PERFORM DS002-DO-PROCESS                         24690008
247000                 IF DS009-DO-PROCESS                              24700008
247100*                    WRITE A TSUOBTR UNLOAD RECORD                24710008
247200                     PERFORM S100-SELECT-TSUOBTR                  24720008
247300                                                                  24730008
247400                     IF SQLCODE = ZERO                            24740008
247500                         MOVE 'TSUOBTS'                           24750008
247600                                     TO DS009-PROCESS-TABLE       24760008
247700                         PERFORM Y100-OPEN-CURSOR                 24770008
247800                         SET MORE-SUOBTS-DATA TO TRUE             24780008
247900*                        WRITE ALL TSUOBTS ROW FOR THIS TRIP      24790008
248000                         PERFORM R100-FETCH-SUOBTS                24800008
248100                                     UNTIL NO-MORE-SUOBTS-DATA    24810008
248200                         PERFORM Z100-CLOSE-CURSOR                24820008
248300                                                                  24830008
248400*                        GET THE REST OF THE CARTONS ON THE TRIP  24840008
248500*                        ANY DUPLICATES WILL BE SORTED AWAY LATER 24850008
248600*                        (SUT_OTBND_CART)                         24860008
248700*                        BUT FIRST CHECK IF THIS TRIP HAS ALREADY 24870008
248800*                        BEEN PROCESSED.                          24880008
248900                                                                  24890008
249000                         SET PT-TRIP-IDX TO 1                     24900008
249100                         SEARCH PT-TRIPS                          24910008
249200                         AT END                                   24920008
249300                             CONTINUE                             24930008
249400                         WHEN PT-TRIP(PT-TRIP-IDX) =              24940008
249500                                  SUOBTR-OTBND-TRIP-ID            24950008
249600                             CONTINUE                             24960008
249700                         WHEN PT-TRIP(PT-TRIP-IDX) = ZERO         24970008
249800*            MOVE SUOBTR-OTBND-TRIP-ID TO PV-DISP-NBR             24980008
249900*            DISPLAY 'SUOBTR-TRIP-ID = ' PV-DISP-NBR              24990008
250000                             MOVE SUOBTR-OTBND-TRIP-ID            25000008
250100                                      TO PT-TRIP(PT-TRIP-IDX)     25010008
250200                             MOVE 'SUT_OTBND_CART'                25020008
250300                                     TO DS009-PROCESS-TABLE       25030008
250400                             PERFORM Y100-OPEN-CURSOR             25040008
250500                             SET MORE-SUT00024-DATA TO TRUE       25050008
250600*                        WRITE EM ALL OUT                         25060008
250700                             PERFORM R100-FETCH-SUT00024          25070008
250800                                     UNTIL NO-MORE-SUT00024-DATA  25080008
250900                             PERFORM Z100-CLOSE-CURSOR            25090008
251000                         MOVE 'TSUOBTS'                           25100008
251100                                     TO DS009-PROCESS-TABLE       25110008
251200                     END-SEARCH                                   25120008
251300                                                                  25130008
251400                     END-IF                                       25140008
251500                 END-IF                                           25150008
251600                                                                  25160008
251700                                                                  25170008
251800             ELSE                                                 25180008
251900*                THERE ARE NO TRIPS ATTACHED TO THIS CARTON       25190008
252000                 MOVE ZERO TO SUT00024-OTBND-TRIP-ID              25200008
252100             END-IF                                               25210008
252200                                                                  25220008
252300             MOVE 'SUT_OTBND_VND'      TO DS002-NAME              25230008
252400                                      DS009-PROCESS-TABLE         25240008
252500             PERFORM DS002-DO-PROCESS                             25250008
252600             IF DS009-DO-PROCESS                                  25260008
252700                 PERFORM S100-SELECT-OTBND-VND                    25270008
252800             END-IF                                               25280008
252900                                                                  25290008
253000             MOVE 'SUT_OTBND_LOC' TO DS002-NAME                   25300008
253100                                         DS009-PROCESS-TABLE      25310008
253200             PERFORM Y100-OPEN-CURSOR                             25320008
253300             SET MORE-OTBLOC-DATA TO TRUE                         25330008
253400             PERFORM R100-FETCH-OTBND-LOC                         25340008
253500                     UNTIL NO-MORE-OTBLOC-DATA                    25350008
253600             PERFORM Z100-CLOSE-CURSOR                            25360008
253700                                                                  25370008
253800             MOVE 'TSUQADJ'       TO DS002-NAME                   25380008
253900                                         DS009-PROCESS-TABLE      25390008
254000             PERFORM Y100-OPEN-CURSOR                             25400008
254100             SET MORE-SUQADJ-DATA TO TRUE                         25410008
254200             PERFORM R100-FETCH-SUQADJ                            25420008
254300                   UNTIL NO-MORE-SUQADJ-DATA                      25430008
254400             PERFORM Z100-CLOSE-CURSOR                            25440008
254500                                                                  25450008
255500             MOVE 'SUT_OTBND_PKD_UPC'  TO DS002-NAME              25550008
255600                                      DS009-PROCESS-TABLE         25560008
255700             PERFORM Y100-OPEN-CURSOR                             25570008
255800             SET MORE-OTBPKD-DATA TO TRUE                         25580008
255900             PERFORM R100-FETCH-OTBND-PKD-UPC                     25590008
256000                    UNTIL NO-MORE-OTBPKD-DATA                     25600008
256100             PERFORM Z100-CLOSE-CURSOR                            25610008
256200                                                                  25620008
256300                                                                  25630008
256400             MOVE 'SUT_OTBND_PK'       TO DS002-NAME              25640008
256500                                      DS009-PROCESS-TABLE         25650008
256600             PERFORM Y100-OPEN-CURSOR                             25660008
256700             SET DS010-END-OTBND-PK-NO TO TRUE                    25670008
256800             PERFORM R100-FETCH-OTBND-PK                          25680008
256900                    UNTIL DS010-END-OTBND-PK-YES                  25690008
257000             PERFORM Z100-CLOSE-CURSOR                            25700008
257100                                                                  25710008
257200*  7/15/2005  SUT_FINCL_ADJ                                       25720008
257300             MOVE 'SUT_FINCL_ADJ'     TO DS009-PROCESS-TABLE      25730008
257400             MOVE SUT00028-SHIPT-UNT-ID                           25740008
257500                                        TO HOLD-SHIPT-UNIT-ID     25750008
257600             PERFORM Y100-OPEN-CURSOR                             25760008
257700             SET MORE-FINCL-ADJ-DATA TO TRUE                      25770008
257800             PERFORM R100-FETCH-FINCL-ADJ                         25780008
257900                UNTIL NO-MORE-FINCL-ADJ-DATA                      25790008
258000             PERFORM Z100-CLOSE-CURSOR                            25800008
258100                                                                  25810008
258200         END-IF.                                                  25820008
258300                                                                  25830008
258400/                                                                 25840008
258500 R100-FETCH-PURCHS.                                               25850008
258600*    DISPLAY 'R100-FETCH-PURCHS'.                                 25860008
258700*                                                                 25870008
258800     MOVE 'TPURCHS' TO DS009-PROCESS-TABLE.                       25880008
258900     PERFORM WITH TEST AFTER                                      25890008
259000        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   25900008
259100        UNTIL   DS009-RETRY-COUNTER > 3 OR                        25910008
259200                SQLCODE = ZERO OR                                 25920008
259300                SQLCODE = +100                                    25930008
259400        EXEC SQL                                                  25940008
259500            FETCH PURCHS_CSR                                      25950008
259600            INTO                                                  25960008
259700              :WS-PURCHS-PO-NBR                                   25970008
259800             ,:WS-PURCHS-VER-NBR                                  25980008
259900             ,:WS-PURCHS-VER-STATUS-CDE                           25990008
260000             ,:WS-PURCHS-PO-TYP-CDE                               26000008
260100             ,:WS-PURCHS-PO-CATEG-CDE                             26010008
260200             ,:WS-PURCHS-EDI-IND                                  26020008
260300             ,:WS-PURCHS-TOT-UNT-QTY                              26030008
260400             ,:WS-PURCHS-TOT-VAL-COST-AMT                         26040008
260500             ,:WS-PURCHS-TOT-VAL-RTL-AMT                          26050008
260600             ,:WS-PURCHS-TOT-MU-PCT                               26060008
260700             ,:WS-PURCHS-TOT-SKUS-QTY                             26070008
260800             ,:WS-PURCHS-IMPRT-AGNT-PO-NBR                        26080008
260900             ,:WS-PURCHS-IMPRT-ORD-OFF-NAME                       26090008
261000             ,:WS-PURCHS-IMPRT-VEND-NAME                          26100008
261100             ,:WS-PURCHS-IMPRT-FCTRY-NAME                         26110008
261200             ,:WS-PURCHS-IMPRT-CNTRY-NAME                         26120008
261300             ,:WS-PURCHS-VEND-CNTRY-NAME                          26130008
261400             ,:WS-PURCHS-NEW-STR-PO-IND                           26140008
261500             ,:WS-PURCHS-IMPRT-PO-IND                             26150008
261600             ,:WS-PURCHS-IMPRT-AGNT-PO-IND                        26160008
261700             ,:WS-PURCHS-STATUS-TMST                              26170008
261800             ,:WS-PURCHS-LAST-UPD-TMST                            26180008
261900             ,:WS-PURCHS-EDI-REXMIT-IND                           26190008
262000             ,:WS-PURCHS-EDI-REXMIT-TMST                          26200008
262100             ,:WS-PURCHS-DIR-STR-IND                              26210008
262200             ,:WS-PURCHS-LAST-UPD-BY-UID                          26220008
262300             ,:WS-PURCHS-APP-BY-UID                               26230008
262400             ,:WS-PURCHS-OTB-PER-NBR                              26240008
262500             ,:WS-PURCHS-DEPT-NBR                                 26250008
262600             ,:WS-PURCHS-ENT-ID                                   26260008
262700             ,:WS-PURCHS-STATUS-CDE                               26270008
262800             ,:WS-PURCHS-CRE-BY-UID                               26280008
262900             ,:WS-PURCHS-REJ-CT                                   26290008
263000             ,:WS-PURCHS-REJ-UID                                  26300008
263100             ,:WS-PURCHS-ORD-DTE                                  26310008
263200             ,:WS-PURCHS-REVISION-CT                              26320008
263300             ,:WS-PURCHS-ADR-SEQ-NBR                              26330008
263400             ,:WS-PURCHS-DEST-KNOWN-IND                           26340008
263500             ,:WS-PURCHS-RLSE-IND                                 26350008
263600             ,:WS-PURCHS-RLSE-DTE                                 26360008
263700             ,:WS-PURCHS-ANLYS-HOLD-IND                           26370008
263800             ,:WS-PURCHS-PLCMNT-CNTRY-CDE                         26380008
263900             ,:WS-PURCHS-PROD-CNTRY-CDE                           26390008
264000             ,:WS-PURCHS-UNT-PER-CBMT-QTY                         26400008
264100             ,:WS-PURCHS-TKT-FMT-NBR                              26410008
264200             ,:WS-PURCHS-TKT-FMT-DESC                             26420008
264300             ,:WS-PURCHS-CRE-TMST                                 26430008
264400             ,:WS-PURCHS-PRG-LAST-ACTVY-DTE                       26440008
264500             ,:WS-PURCHS-PKGNG-CDE                                26450008
264600             ,:WS-PURCHS-SEASET-YR                                26460008
264700             ,:WS-PURCHS-SEASET-SHRT-NM                           26470008
264800             ,:WS-PURCHS-QTA-CTG-CDE                              26480008
264900            , :WS-PURCHS-PO-IN-RMS-IND                            26490008
265000            , :WS-PURCHS-RMS-PO-UPD-TMST                          26500008
265100            , :WS-PURCHS-DUP-SKU-IND                              26510008
265200            , :WS-PURCHS-ORIG-PKGNG-CDE                           26520008
265300            , :WS-PURCHS-IMPRT-VND-ID                             26530008
265400            , :WS-PURCHS-IMPRT-FCTRY-ID                           26540008
265500            , :WS-PURCHS-DERVD-LBL-TYP-CDE                        26550008
265600            , :WS-PURCHS-DELY-ID                                  26560008
265700                        :WS-PURCHS-DELY-ID-NULL                   26570008
265800            , :WS-PURCHS-PO-SHRT-CYC-IND                          26580008
265900            , :WS-PURCHS-WHSE-RPLNT-IND                           26590008
266000        END-EXEC                                                  26600008
266100                                                                  26610008
266200        EVALUATE TRUE                                             26620008
266300            WHEN SQLCODE = ZERO OR -305                           26630008
266400                 MOVE LENGTH OF WS-PURCHS TO DS009-TBLE-DATA-SIZE 26640008
266500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 26650008
266600                                           + DS009-RECORD-FILLER  26660008
266700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     26670008
266800                 MOVE 'TPURCHS'           TO DS002-NAME           26680008
266900                 PERFORM DS002-FIND-SEQUENCE                      26690008
267000                 MOVE WS-PURCHS           TO DS002-DATA-ITEM      26700008
267100                 INITIALIZE DS009-PKYS                            26710008
267200                 PERFORM DS002-PROCESS-KEYS                       26720008
267300                 MOVE WS-PURCHS-KEYS TO DS009-PKYS                26730008
267400                 MOVE DS009-PKYS  TO DS002-KEYS                   26740008
267500                 PERFORM 8000-WRITE-UNLOAD                        26750008
267600                                                                  26760008
267700                 IF WS-PURCHS-VER-STATUS-CDE = 'A'                26770008
267800                   MOVE WS-PURCHS-ENT-ID TO HOLD-ENT-ID           26780008
267900                   MOVE 'TEXTENT' TO DS009-PROCESS-TABLE          26790008
268000                   PERFORM DS002-DO-PROCESS                       26800008
268100                   IF DS009-DO-PROCESS                            26810008
268200                      SET MORE-EXTENT-DATA TO TRUE                26820008
268300                      PERFORM Y100-OPEN-CURSOR                    26830008
268400                      PERFORM R100-FETCH-EXTENT                   26840008
268500                          UNTIL NO-MORE-EXTENT-DATA               26850008
268600                      MOVE 'TEXTENT' TO DS009-PROCESS-TABLE       26860008
268700                      PERFORM Z100-CLOSE-CURSOR                   26870008
268800                   END-IF                                         26880008
268900                                                                  26890008
269000                   MOVE WS-PURCHS-ENT-ID TO HOLD-ENT-ID           26900008
269100                   MOVE 'TENTNME' TO DS009-PROCESS-TABLE          26910008
269200                   PERFORM DS002-DO-PROCESS                       26920008
269300                   IF DS009-DO-PROCESS                            26930008
269400                      SET MORE-ENTNME-DATA TO TRUE                26940008
269500                      PERFORM Y100-OPEN-CURSOR                    26950008
269600                      PERFORM R100-FETCH-ENTNME                   26960008
269700                          UNTIL NO-MORE-ENTNME-DATA               26970008
269800                      MOVE 'TENTNME' TO DS009-PROCESS-TABLE       26980008
269900                      PERFORM Z100-CLOSE-CURSOR                   26990008
270000                   END-IF                                         27000008
270100                                                                  27010008
270200                   MOVE WS-PURCHS-ENT-ID TO HOLD-ENT-ID           27020008
270300                   MOVE 'TVNDDPT' TO DS009-PROCESS-TABLE          27030008
270400                   PERFORM DS002-DO-PROCESS                       27040008
270500                   IF DS009-DO-PROCESS                            27050008
270600                      SET MORE-VNDDPT-DATA TO TRUE                27060008
270700                      PERFORM Y100-OPEN-CURSOR                    27070008
270800                      PERFORM R100-FETCH-VNDDPT                   27080008
270900                          UNTIL NO-MORE-VNDDPT-DATA               27090008
271000                      MOVE 'TVNDDPT' TO DS009-PROCESS-TABLE       27100008
271100                      PERFORM Z100-CLOSE-CURSOR                   27110008
271200                   END-IF                                         27120008
271300                                                                  27130008
271400                   MOVE WS-PURCHS-ENT-ID  TO HOLD-ENT-ID          27140008
271500                   MOVE 'TVNDAGR'   TO DS009-PROCESS-TABLE        27150008
271600                   PERFORM DS002-DO-PROCESS                       27160008
271700                   IF DS009-DO-PROCESS                            27170008
271800                      SET MORE-VNDAGR-DATA TO TRUE                27180008
271900                      PERFORM Y100-OPEN-CURSOR                    27190008
272000                      PERFORM R100-FETCH-VNDAGR                   27200008
272100                          UNTIL NO-MORE-VNDAGR-DATA               27210008
272200                      MOVE 'TVNDAGR' TO DS009-PROCESS-TABLE       27220008
272300                      PERFORM Z100-CLOSE-CURSOR                   27230008
272400                   END-IF                                         27240008
271300                                                                  27241013
271400                   MOVE WS-PURCHS-ENT-ID  TO HOLD-ENT-ID          27242013
271500                   MOVE 'TTRDPRT'   TO DS009-PROCESS-TABLE        27243013
271600                   PERFORM DS002-DO-PROCESS                       27244013
271700                   IF DS009-DO-PROCESS                            27245014
271800                      SET MORE-TRDPRT-DATA TO TRUE                27246018
271900                      PERFORM Y100-OPEN-CURSOR                    27247014
272000                      PERFORM R100-FETCH-TRDPRT                   27248018
272100                          UNTIL NO-MORE-TRDPRT-DATA               27249018
272200                      MOVE 'TTRDPRT' TO DS009-PROCESS-TABLE       27249118
272300                      PERFORM Z100-CLOSE-CURSOR                   27249214
272400                   END-IF                                         27249314
272500                 END-IF                                           27250008
272600                                                                  27260008
272700                 IF  WS-PURCHS-SEASET-YR      > SPACES            27270008
272800                 AND WS-PURCHS-SEASET-SHRT-NM > SPACES            27280008
272900                   MOVE WS-PURCHS-SEASET-YR                       27290008
273000                                  TO HOLD-SEASET-YR               27300008
273100                   MOVE WS-PURCHS-SEASET-SHRT-NM                  27310008
273200                                  TO HOLD-SEASET-SHRT-NM          27320008
273300                   MOVE 'TSEASET' TO DS009-PROCESS-TABLE          27330008
273400                   PERFORM DS002-DO-PROCESS                       27340008
273500                   IF DS009-DO-PROCESS                            27350008
273600                      SET MORE-SEASET-DATA TO TRUE                27360008
273700                      PERFORM Y100-OPEN-CURSOR                    27370008
273800                      PERFORM R100-FETCH-SEASET                   27380008
273900                          UNTIL NO-MORE-SEASET-DATA               27390008
274000                      MOVE 'TSEASET' TO DS009-PROCESS-TABLE       27400008
274100                      PERFORM Z100-CLOSE-CURSOR                   27410008
274200                   END-IF                                         27420008
274300                 END-IF                                           27430008
274400                                                                  27440008
274500            WHEN SQLCODE = +100                                   27450008
274600                 SET NO-MORE-PURCHS-DATA  TO TRUE                 27460008
274700            WHEN SQLCODE = -904                                   27470008
274800            WHEN SQLCODE = -913                                   27480008
274900              CONTINUE                                            27490008
275000           END-EVALUATE                                           27500008
275100         END-PERFORM.                                             27510008
275200*                                                                 27520008
275300     PERFORM DS002-SQL-ABEND-FETCH.                               27530008
275400/                                                                 27540008
275500 R100-FETCH-POAGMT.                                               27550008
275600*    DISPLAY 'R100-FETCH-POAGMT'.                                 27560008
275700*                                                                 27570008
275800     MOVE 'TPOAGMT' TO DS009-PROCESS-TABLE.                       27580008
275900     PERFORM WITH TEST AFTER                                      27590008
276000        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   27600008
276100        UNTIL   DS009-RETRY-COUNTER > 3 OR                        27610008
276200                SQLCODE = ZERO OR                                 27620008
276300                SQLCODE = +100                                    27630008
276400        EXEC SQL                                                  27640008
276500            FETCH POAGMT_CSR                                      27650008
276600            INTO                                                  27660008
276700               :WS-POAGMT-PO-NBR                                  27670008
276800              ,:WS-POAGMT-VER-NBR                                 27680008
276900              ,:WS-POAGMT-AGRMT-TYP-ID                            27690008
277000              ,:WS-POAGMT-SEQ-NBR                                 27700008
277100              ,:WS-POAGMT-VER-STATUS-CDE                          27710008
277200              ,:WS-POAGMT-TYP-CDE                                 27720008
277300              ,:WS-POAGMT-TKT-MKR-IND                             27730008
277400              ,:WS-POAGMT-BULK-STK-TKT-IND                        27740008
277500              ,:WS-POAGMT-EDI-PROMO-TXT                           27750008
277600              ,:WS-POAGMT-PO-CAN-DAY-QTY                          27760008
277700              ,:WS-POAGMT-AUTO-PO-CAN-IND                         27770008
277800              ,:WS-POAGMT-DISC-DOL-AMT                            27780008
277900              ,:WS-POAGMT-DISC-PCT                                27790008
278000              ,:WS-POAGMT-DISC-PAY-DAY-QTY                        27800008
278100              ,:WS-POAGMT-LAST-UPD-TMST                           27810008
278200              ,:WS-POAGMT-PAYT-TERM-ID                            27820008
278300              ,:WS-POAGMT-LAST-UPD-BY-UID                         27830008
278400              ,:WS-POAGMT-LEADTIME-DAYS-QTY                       27840008
278500        END-EXEC                                                  27850008
278600                                                                  27860008
278700        EVALUATE TRUE                                             27870008
278800            WHEN SQLCODE = ZERO OR -305                           27880008
278900                 MOVE LENGTH OF WS-POAGMT TO DS009-TBLE-DATA-SIZE 27890008
279000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 27900008
279100                                           + DS009-RECORD-FILLER  27910008
279200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     27920008
279300                 MOVE 'TPOAGMT'           TO DS002-NAME           27930008
279400                 PERFORM DS002-FIND-SEQUENCE                      27940008
279500                 MOVE WS-POAGMT           TO DS002-DATA-ITEM      27950008
279600                 INITIALIZE DS009-PKYS                            27960008
279700                 PERFORM DS002-PROCESS-KEYS                       27970008
279800                 MOVE WS-POAGMT-KEYS TO DS009-PKYS                27980008
279900                 MOVE DS009-PKYS  TO DS002-KEYS                   27990008
280000                 PERFORM 8000-WRITE-UNLOAD                        28000008
280100            WHEN SQLCODE = +100                                   28010008
280200                 SET NO-MORE-POAGMT-DATA  TO TRUE                 28020008
280300            WHEN SQLCODE = -904                                   28030008
280400            WHEN SQLCODE = -913                                   28040008
280500              CONTINUE                                            28050008
280600           END-EVALUATE                                           28060008
280700         END-PERFORM.                                             28070008
280800*                                                                 28080008
280900     PERFORM DS002-SQL-ABEND-FETCH.                               28090008
281000/                                                                 28100008
281100 R100-FETCH-POINST.                                               28110008
281200*    DISPLAY 'R100-FETCH-POINST'.                                 28120008
281300*                                                                 28130008
281400     MOVE 'TPOINST' TO DS009-PROCESS-TABLE.                       28140008
281500     PERFORM WITH TEST AFTER                                      28150008
281600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   28160008
281700        UNTIL   DS009-RETRY-COUNTER > 3 OR                        28170008
281800                SQLCODE = ZERO OR                                 28180008
281900                SQLCODE = +100                                    28190008
282000        EXEC SQL                                                  28200008
282100            FETCH POINST_CSR                                      28210008
282200            INTO                                                  28220008
282300               :WS-POINST-PO-NBR                                  28230008
282400              ,:WS-POINST-RECIP-CDE                               28240008
282500              ,:WS-POINST-INSTR-NBR                               28250008
282600              ,:WS-POINST-CRE-BY-UID                              28260008
282700              ,:WS-POINST-CRE-TMST                                28270008
282800        END-EXEC                                                  28280008
282900                                                                  28290008
283000        EVALUATE TRUE                                             28300008
283100            WHEN SQLCODE = ZERO OR -305                           28310008
283200                 MOVE LENGTH OF WS-POINST TO DS009-TBLE-DATA-SIZE 28320008
283300                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 28330008
283400                                           + DS009-RECORD-FILLER  28340008
283500                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     28350008
283600                 MOVE 'TPOINST'           TO DS002-NAME           28360008
283700                 PERFORM DS002-FIND-SEQUENCE                      28370008
283800                 MOVE WS-POINST           TO DS002-DATA-ITEM      28380008
283900                 INITIALIZE DS009-PKYS                            28390008
284000                 PERFORM DS002-PROCESS-KEYS                       28400008
284100                 MOVE WS-POINST-KEYS TO DS009-PKYS                28410008
284200                 MOVE DS009-PKYS      TO DS002-KEYS               28420008
284300                 PERFORM 8000-WRITE-UNLOAD                        28430008
284400                                                                  28440008
284500                 MOVE WS-POINST-INSTR-NBR TO HOLD-INSTR-NBR       28450008
284600                 MOVE 'TINSTCD' TO DS009-PROCESS-TABLE            28460008
284700                 PERFORM DS002-DO-PROCESS                         28470008
284800                 IF DS009-DO-PROCESS                              28480008
284900                    SET MORE-INSTCD-DATA TO TRUE                  28490008
285000                    PERFORM Y100-OPEN-CURSOR                      28500008
285100                    PERFORM R100-FETCH-INSTCD                     28510008
285200                        UNTIL NO-MORE-INSTCD-DATA                 28520008
285300                    MOVE 'TINSTCD' TO DS009-PROCESS-TABLE         28530008
285400                    PERFORM Z100-CLOSE-CURSOR                     28540008
285500                 END-IF                                           28550008
285600                                                                  28560008
285700            WHEN SQLCODE = +100                                   28570008
285800                 SET NO-MORE-POINST-DATA  TO TRUE                 28580008
285900            WHEN SQLCODE = -904                                   28590008
286000            WHEN SQLCODE = -913                                   28600008
286100              CONTINUE                                            28610008
286200           END-EVALUATE                                           28620008
286300         END-PERFORM.                                             28630008
286400*                                                                 28640008
286500     PERFORM DS002-SQL-ABEND-FETCH.                               28650008
286600/                                                                 28660008
286700 R100-FETCH-IMPORL.                                               28670008
286800*     DISPLAY 'R100-FETCH-IMPORL'.                                28680008
286900*                                                                 28690008
287000     MOVE 'TIMPORL' TO DS009-PROCESS-TABLE.                       28700008
287100     PERFORM WITH TEST AFTER                                      28710008
287200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   28720008
287300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        28730008
287400                SQLCODE = ZERO OR                                 28740008
287500                SQLCODE = +100                                    28750008
287600        EXEC SQL                                                  28760008
287700            FETCH IMPORL_CSR                                      28770008
287800            INTO                                                  28780008
287900                :WS-IMPORL-PO-NBR                                 28790008
288000               ,:WS-IMPORL-VER-NBR                                28800008
288100               ,:WS-IMPORL-VER-STATUS-CDE                         28810008
288200               ,:WS-IMPORL-CONSLR-RLSE-CDE                        28820008
288300               ,:WS-IMPORL-CONSLR-REQR-DTE                        28830008
288400               ,:WS-IMPORL-CONSLR-ACTL-DTE                        28840008
288500               ,:WS-IMPORL-CONSLR-ACTL-TM                         28850008
288600               ,:WS-IMPORL-CSTM-BKR-RLSE-CDE                      28860008
288700               ,:WS-IMPORL-CSTM-BKR-REQR-DTE                      28870008
288800               ,:WS-IMPORL-CSTM-BKR-ACTL-DTE                      28880008
288900               ,:WS-IMPORL-CSTM-BKR-ACTL-TM                       28890008
289000               ,:WS-IMPORL-TKT-PRTR-RLSE-CDE                      28900008
289100               ,:WS-IMPORL-TKT-PRTR-REQR-DTE                      28910008
289200               ,:WS-IMPORL-TKT-PRTR-ACTL-DTE                      28920008
289300               ,:WS-IMPORL-TKT-PRTR-ACTL-TM                       28930008
289400               ,:WS-IMPORL-DCONSLR-RLSE-CDE                       28940008
289500               ,:WS-IMPORL-DCONSLR-REQR-DTE                       28950008
289600               ,:WS-IMPORL-DCONSLR-ACTL-DTE                       28960008
289700               ,:WS-IMPORL-DCONSLR-ACTL-TM                        28970008
289800               ,:WS-IMPORL-LAST-UPD-TMST                          28980008
289900               ,:WS-IMPORL-LAST-UPD-BY-UID                        28990008
290000               ,:WS-IMPORL-DCONSLR-ENT-ID                         29000008
290100        END-EXEC                                                  29010008
290200                                                                  29020008
290300        EVALUATE TRUE                                             29030008
290400            WHEN SQLCODE = ZERO OR -305                           29040008
290500                 MOVE LENGTH OF WS-IMPORL TO DS009-TBLE-DATA-SIZE 29050008
290600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 29060008
290700                                           + DS009-RECORD-FILLER  29070008
290800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     29080008
290900                 MOVE 'TIMPORL'           TO DS002-NAME           29090008
291000                 PERFORM DS002-FIND-SEQUENCE                      29100008
291100                 MOVE WS-IMPORL           TO DS002-DATA-ITEM      29110008
291200                 INITIALIZE DS009-PKYS                            29120008
291300                 PERFORM DS002-PROCESS-KEYS                       29130008
291400                 MOVE WS-IMPORL-KEYS TO DS009-PKYS                29140008
291500                 MOVE DS009-PKYS      TO DS002-KEYS               29150008
291600                 PERFORM 8000-WRITE-UNLOAD                        29160008
291700            WHEN SQLCODE = +100                                   29170008
291800                 SET NO-MORE-IMPORL-DATA  TO TRUE                 29180008
291900            WHEN SQLCODE = -904                                   29190008
292000            WHEN SQLCODE = -913                                   29200008
292100              CONTINUE                                            29210008
292200           END-EVALUATE                                           29220008
292300         END-PERFORM.                                             29230008
292400*                                                                 29240008
292500     PERFORM DS002-SQL-ABEND-FETCH.                               29250008
292600/                                                                 29260008
292700 R100-FETCH-ALLPLN.                                               29270008
292800*    DISPLAY 'R100-FETCH-ALLPLN'.                                 29280008
292900*                                                                 29290008
293000     MOVE 'TALLPLN' TO DS009-PROCESS-TABLE.                       29300008
293100     PERFORM WITH TEST AFTER                                      29310008
293200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   29320008
293300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        29330008
293400                SQLCODE = ZERO OR                                 29340008
293500                SQLCODE = +100                                    29350008
293600        EXEC SQL                                                  29360008
293700            FETCH ALLPLN_CSR                                      29370008
293800            INTO                                                  29380008
293900                :WS-ALLPLN-PO-NBR                                 29390008
294000               ,:WS-ALLPLN-PO-LNE-NBR                             29400008
294100               ,:WS-ALLPLN-PLAN-NBR                               29410008
294200               ,:WS-ALLPLN-CURR-SPLIT-QTY                         29420008
294300               ,:WS-ALLPLN-DEST-NBR                               29430008
294400               ,:WS-ALLPLN-STATUS-CDE                             29440008
294500               ,:WS-ALLPLN-DC-SPLIT-QTY                           29450008
294600               ,:WS-ALLPLN-SPLIT-REQ-ID                           29460008
294700               ,:WS-ALLPLN-SPLIT-CRE-DATE                         29470008
294800               ,:WS-ALLPLN-SPLIT-CRE-ID                           29480008
294900               ,:WS-ALLPLN-SPLIT-UPD-DATE                         29490008
295000               ,:WS-ALLPLN-SPLIT-UPD-ID                           29500008
295100               ,:WS-ALLPLN-DISTRO-REQ-ID                          29510008
295200               ,:WS-ALLPLN-DISTRO-CRE-DATE                        29520008
295300               ,:WS-ALLPLN-DISTRO-CRE-ID                          29530008
295400               ,:WS-ALLPLN-DISTRO-KEY-SEQ-NBR                     29540008
295500               ,:WS-ALLPLN-SPLIT-KEY-SEQ-NBR                      29550008
295600               ,:WS-ALLPLN-ALOC-PACK-QTY                          29560008
295700               ,:WS-ALLPLN-PK-SIZE-RND-CDE                        29570008
295800               ,:WS-ALLPLN-ALLOC-OUTR-PK-QTY                      29580008
295900               ,:WS-ALLPLN-SHTG-PRRT-OPT-CDE                      29590008
296000               ,:WS-ALLPLN-OVRG-PRRT-OPT-CDE                      29600008
296100               ,:WS-ALLPLN-EXST-SHTG-THRS-IND                     29610008
296200        END-EXEC                                                  29620008
296300                                                                  29630008
296400        EVALUATE TRUE                                             29640008
296500            WHEN SQLCODE = ZERO OR -305                           29650008
296600                 MOVE LENGTH OF WS-ALLPLN TO DS009-TBLE-DATA-SIZE 29660008
296700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 29670008
296800                                           + DS009-RECORD-FILLER  29680008
296900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     29690008
297000                 MOVE 'TALLPLN'           TO DS002-NAME           29700008
297100                 PERFORM DS002-FIND-SEQUENCE                      29710008
297200                 MOVE WS-ALLPLN           TO DS002-DATA-ITEM      29720008
297300                 INITIALIZE DS009-PKYS                            29730008
297400                 PERFORM DS002-PROCESS-KEYS                       29740008
297500                 MOVE WS-ALLPLN-KEYS TO DS009-PKYS                29750008
297600                 MOVE DS009-PKYS      TO DS002-KEYS               29760008
297700                 PERFORM 8000-WRITE-UNLOAD                        29770008
297800            WHEN SQLCODE = +100                                   29780008
297900                 SET NO-MORE-ALLPLN-DATA  TO TRUE                 29790008
298000            WHEN SQLCODE = -904                                   29800008
298100            WHEN SQLCODE = -913                                   29810008
298200              CONTINUE                                            29820008
298300           END-EVALUATE                                           29830008
298400         END-PERFORM.                                             29840008
298500*                                                                 29850008
298600     PERFORM DS002-SQL-ABEND-FETCH.                               29860008
298700/                                                                 29870008
298800 R100-FETCH-PLNSHP.                                               29880008
298900*    DISPLAY 'R100-FETCH-PLNSHP'.                                 29890008
299000*                                                                 29900008
299100     MOVE 'TPLNSHP' TO DS009-PROCESS-TABLE.                       29910008
299200     PERFORM WITH TEST AFTER                                      29920008
299300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   29930008
299400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        29940008
299500                SQLCODE = ZERO OR                                 29950008
299600                SQLCODE = +100                                    29960008
299700        EXEC SQL                                                  29970008
299800            FETCH PLNSHP_CSR                                      29980008
299900            INTO                                                  29990008
300000                :WS-PLNSHP-SHIPT-NBR                              30000008
300100               ,:WS-PLNSHP-VER-NBR                                30010008
300200               ,:WS-PLNSHP-VER-STATUS-CDE                         30020008
300300               ,:WS-PLNSHP-SHIPT-TYP-CDE                          30030008
300400               ,:WS-PLNSHP-SHIPT-DEST-NBR                         30040008
300500               ,:WS-PLNSHP-SHIPT-POINT-TXT                        30050008
300600               ,:WS-PLNSHP-FOB-POINT-TXT                          30060008
300700               ,:WS-PLNSHP-FRGT-PAYT-CDE                          30070008
300800               ,:WS-PLNSHP-VEND-FRGT-PCT                          30080008
300900               ,:WS-PLNSHP-KOHLS-FRGT-PCT                         30090008
301000               ,:WS-PLNSHP-LATE-SHIPT-IND                         30100008
301100               ,:WS-PLNSHP-EARLY-SHIPT-IND                        30110008
301200               ,:WS-PLNSHP-PARTIAL-SHIPT-IND                      30120008
301300               ,:WS-PLNSHP-BCKORDS-PERMTD-IND                     30130008
301400               ,:WS-PLNSHP-PORT-ENTR-DESC                         30140008
301500               ,:WS-PLNSHP-STRT-FCTRY-DTE                         30150008
301600               ,:WS-PLNSHP-LAST-FCTRY-DTE                         30160008
301700               ,:WS-PLNSHP-DONT-SHIP-BEF-DTE                      30170008
301800               ,:WS-PLNSHP-CAN-IFNOT-SHIP-DTE                     30180008
301900               ,:WS-PLNSHP-EXT-CAN-DTE                            30190008
302000               ,:WS-PLNSHP-LAST-UPD-TMST                          30200008
302100               ,:WS-PLNSHP-STATUS-CDE                             30210008
302200               ,:WS-PLNSHP-ENT-ID                                 30220008
302300               ,:WS-PLNSHP-PO-NBR                                 30230008
302400               ,:WS-PLNSHP-LAST-UPD-BY-UID                        30240008
302500               ,:WS-PLNSHP-FOB-CDE                                30250008
302600               ,:WS-PLNSHP-POE-CDE                                30260008
302700        END-EXEC                                                  30270008
302800                                                                  30280008
302900        EVALUATE TRUE                                             30290008
303000            WHEN SQLCODE = ZERO OR -305                           30300008
303100                 MOVE LENGTH OF WS-PLNSHP TO DS009-TBLE-DATA-SIZE 30310008
303200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 30320008
303300                                           + DS009-RECORD-FILLER  30330008
303400                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     30340008
303500                 MOVE 'TPLNSHP'           TO DS002-NAME           30350008
303600                 PERFORM DS002-FIND-SEQUENCE                      30360008
303700                 MOVE WS-PLNSHP           TO DS002-DATA-ITEM      30370008
303800                 INITIALIZE DS009-PKYS                            30380008
303900                 PERFORM DS002-PROCESS-KEYS                       30390008
304000                 MOVE WS-PLNSHP-KEYS TO DS009-PKYS                30400008
304100                 MOVE DS009-PKYS      TO DS002-KEYS               30410008
304200                 PERFORM 8000-WRITE-UNLOAD                        30420008
304300            WHEN SQLCODE = +100                                   30430008
304400                 SET NO-MORE-PLNSHP-DATA  TO TRUE                 30440008
304500            WHEN SQLCODE = -904                                   30450008
304600            WHEN SQLCODE = -913                                   30460008
304700              CONTINUE                                            30470008
304800           END-EVALUATE                                           30480008
304900         END-PERFORM.                                             30490008
305000*                                                                 30500008
305100     PERFORM DS002-SQL-ABEND-FETCH.                               30510008
305200/                                                                 30520008
305300 R100-FETCH-PURITM.                                               30530008
305400*    DISPLAY 'R100-FETCH-PURITM'.                                 30540008
305500*                                                                 30550008
305600     MOVE 'TPURITM' TO DS009-PROCESS-TABLE.                       30560008
305700     PERFORM WITH TEST AFTER                                      30570008
305800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   30580008
305900        UNTIL   DS009-RETRY-COUNTER > 3 OR                        30590008
306000                SQLCODE = ZERO OR                                 30600008
306100                SQLCODE = +100                                    30610008
306200        EXEC SQL                                                  30620008
306300            FETCH PURITM_CSR                                      30630008
306400            INTO                                                  30640008
306500               :WS-PURITM-PO-NBR                                  30650008
306600              ,:WS-PURITM-VER-NBR                                 30660008
306700              ,:WS-PURITM-PO-LNE-NBR                              30670008
306800              ,:WS-PURITM-VER-STATUS-CDE                          30680008
306900              ,:WS-PURITM-SKU-SEQ-NBR                             30690008
307000              ,:WS-PURITM-CL-NBR                                  30700008
307100              ,:WS-PURITM-VEND-STYL-NAME                          30710008
307200              ,:WS-PURITM-COLOR-DESC                              30720008
307300              ,:WS-PURITM-SIZE-DESC                               30730008
307400              ,:WS-PURITM-UM-IND                                  30740008
307500              ,:WS-PURITM-UNT-QTY                                 30750008
307600              ,:WS-PURITM-UNT-RTL-PR-AMT                          30760008
307700              ,:WS-PURITM-UNT-COST-AMT                            30770008
307800              ,:WS-PURITM-TOT-VAL-COST-AMT                        30780008
307900              ,:WS-PURITM-TOT-VAL-RTL-AMT                         30790008
308000              ,:WS-PURITM-MU-PCT                                  30800008
308100              ,:WS-PURITM-CRE-TMST                                30810008
308200              ,:WS-PURITM-LAST-UPD-TMST                           30820008
308300              ,:WS-PURITM-ITM-NBR                                 30830008
308400              ,:WS-PURITM-SKU-DESC                                30840008
308500              ,:WS-PURITM-COLOR-CDE                               30850008
308600              ,:WS-PURITM-SIZE-CDE                                30860008
308700              ,:WS-PURITM-AD-EVNT-DTE                             30870008
308800              ,:WS-PURITM-STATUS-CDE                              30880008
308900              ,:WS-PURITM-CRE-BY-UID                              30890008
309000              ,:WS-PURITM-LAST-UPD-BY-UID                         30900008
309100              ,:WS-PURITM-GP-RTL-AMT                              30910008
309200              ,:WS-PURITM-GP-QTY                                  30920008
309300              ,:WS-PURITM-APP-PO-LNE-NBR                          30930008
309400              ,:WS-PURITM-PIC-ITM-IND                             30940008
309500              ,:WS-PURITM-PIC-PG-NBR                              30950008
309600              ,:WS-PURITM-PRD-1ST-COST-AMT                        30960008
309700              ,:WS-PURITM-STAT-TMST                               30970008
309800              ,:WS-02-PURITM-PO-PREPK-ID                          30980008
309900              ,:WS-02-PURITM-PREPK-RATO-QTY                       30990008
310000              ,:WS-PURITM-SHIP-TO-TMP-DC-IND                      31000008
310100              ,:WS-PURITM-RMS-PO-SKU-NBR                          31010008
310200              ,:WS-PURITM-CNCLD-UNT-QTY                           31020008
310300              ,:WS-PURITM-INNR-PK-QTY                             31030008
310400              ,:WS-PURITM-OUTR-PK-QTY                             31040008
310500        END-EXEC                                                  31050008
310600                                                                  31060008
310700        EVALUATE TRUE                                             31070008
310800            WHEN SQLCODE = ZERO OR -305                           31080008
310900                 MOVE LENGTH OF WS-PURITM TO DS009-TBLE-DATA-SIZE 31090008
311000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 31100008
311100                                           + DS009-RECORD-FILLER  31110008
311200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     31120008
311300                 MOVE 'TPURITM'           TO DS002-NAME           31130008
311400                 PERFORM DS002-FIND-SEQUENCE                      31140008
311500                 MOVE WS-PURITM           TO DS002-DATA-ITEM      31150008
311600                 INITIALIZE DS009-PKYS                            31160008
311700                 PERFORM DS002-PROCESS-KEYS                       31170008
311800                 MOVE WS-PURITM-KEYS TO DS009-PKYS                31180008
311900                 MOVE DS009-PKYS      TO DS002-KEYS               31190008
312000                 PERFORM 8000-WRITE-UNLOAD                        31200008
312100                                                                  31210008
312200                 MOVE WS-PURITM-ITM-NBR TO HOLD-ITEM-NBR          31220008
312300                 MOVE 'TSK    ' TO DS009-PROCESS-TABLE            31230008
312400                 PERFORM DS002-DO-PROCESS                         31240008
312500                 IF DS009-DO-PROCESS                              31250008
312600                    SET MORE-SK-DATA TO TRUE                      31260008
312700                    PERFORM Y100-OPEN-CURSOR                      31270008
312800                    PERFORM R100-FETCH-SK                         31280008
312900                           UNTIL NO-MORE-SK-DATA                  31290008
313000                    MOVE 'TSK    ' TO DS009-PROCESS-TABLE         31300008
313100                    PERFORM Z100-CLOSE-CURSOR                     31310008
313200                 END-IF                                           31320008
313300                                                                  31330008
313400                 MOVE WS-PURITM-ITM-NBR TO HOLD-ITEM-NBR          31340008
313500                 MOVE 'TSKST  ' TO DS009-PROCESS-TABLE            31350008
313600                 PERFORM DS002-DO-PROCESS                         31360008
313700                 IF DS009-DO-PROCESS                              31370008
313800                    SET MORE-SKST-DATA TO TRUE                    31380008
313900                    PERFORM Y100-OPEN-CURSOR                      31390008
314000                    PERFORM R100-FETCH-SKST                       31400008
314100                           UNTIL NO-MORE-SKST-DATA                31410008
314200                    MOVE 'TSKST  ' TO DS009-PROCESS-TABLE         31420008
314300                    PERFORM Z100-CLOSE-CURSOR                     31430008
314400                 END-IF                                           31440008
314500                                                                  31450008
314600                 MOVE WS-PURITM-ITM-NBR TO HOLD-ITEM-NBR          31460008
314700                 MOVE 'TPPCPRC' TO DS009-PROCESS-TABLE            31470008
314800                 PERFORM DS002-DO-PROCESS                         31480008
314900                 IF DS009-DO-PROCESS                              31490008
315000                    SET MORE-PPCPRC-DATA TO TRUE                  31500008
315100                    PERFORM Y100-OPEN-CURSOR                      31510008
315200                    PERFORM R100-FETCH-PPCPRC                     31520008
315300                           UNTIL NO-MORE-PPCPRC-DATA              31530008
315400                    MOVE 'TPPCPRC' TO DS009-PROCESS-TABLE         31540008
315500                    PERFORM Z100-CLOSE-CURSOR                     31550008
315600                 END-IF                                           31560008
315700                                                                  31570008
315800                 MOVE WS-PURITM-ITM-NBR TO HOLD-ITEM-NBR          31580008
315900                 MOVE 'TUPCSKU' TO DS009-PROCESS-TABLE            31590008
316000                 PERFORM DS002-DO-PROCESS                         31600008
316100                 IF DS009-DO-PROCESS                              31610008
316200                    SET MORE-UPCSKU-DATA TO TRUE                  31620008
316300                    MOVE ZERO TO PV-HOLD-UPC-INTR-UPC-ID          31630008
316400                    PERFORM Y100-OPEN-CURSOR                      31640008
316500                    PERFORM R100-FETCH-UPCSKU                     31650008
316600                        UNTIL NO-MORE-UPCSKU-DATA                 31660008
316700                    MOVE 'TUPCSKU' TO DS009-PROCESS-TABLE         31670008
316800                    PERFORM Z100-CLOSE-CURSOR                     31680008
316900                 END-IF                                           31690008
317000                                                                  31700008
317100            WHEN SQLCODE = +100                                   31710008
317200                 SET NO-MORE-PURITM-DATA  TO TRUE                 31720008
317300            WHEN SQLCODE = -904                                   31730008
317400            WHEN SQLCODE = -913                                   31740008
317500              CONTINUE                                            31750008
317600           END-EVALUATE                                           31760008
317700         END-PERFORM.                                             31770008
317800*                                                                 31780008
317900     PERFORM DS002-SQL-ABEND-FETCH.                               31790008
318000/                                                                 31800008
318100 R100-FETCH-SK.                                                   31810008
318200*    DISPLAY 'R100-FETCH-SK'.                                     31820008
318300*                                                                 31830008
318400     MOVE 'TSK' TO DS009-PROCESS-TABLE.                           31840008
318500     PERFORM WITH TEST AFTER                                      31850008
318600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   31860008
318700        UNTIL   DS009-RETRY-COUNTER > 3 OR                        31870008
318800                SQLCODE = ZERO OR                                 31880008
318900                SQLCODE = +100                                    31890008
319000        EXEC SQL                                                  31900008
319100            FETCH SK_CSR                                          31910008
319200            INTO                                                  31920008
319300                :WS-TSK-MERCH-DEPT-NMBR                           31930008
319400               ,:WS-TSK-MERCH-CLASS-NMBR                          31940008
319500               ,:WS-TSK-SEQ-NMBR                                  31950008
319600               ,:WS-TSK-CUM-SALES-UNIT-QTY                        31960008
319700               ,:WS-TSK-RTL-UNIT-RCVD-QTY                         31970008
319800               ,:WS-TSK-COST-UNIT-MSRMNT                          31980008
319900               ,:WS-TSK-RTL-UNIT-MSRMNT                           31990008
320000               ,:WS-TSK-UNIT-COST-AMT                             32000008
320100               ,:WS-TSK-CUR-UNIT-RTL-AMT                          32010008
320200               ,:WS-TSK-ORIG-UNIT-RTL-AMT                         32020008
320300               ,:WS-TSK-VNDR-INNR-PACK-QTY                        32030008
320400               ,:WS-TSK-SHPMT-COUNT-QTY                           32040008
320500               ,:WS-TSK-VENDOR-STYLE-CODE                         32050008
320600               ,:WS-TSK-STAT-CHNGD-DATE                           32060008
320700               ,:WS-TSK-STATUS-CODE                               32070008
320800               ,:WS-TSK-AUTO-RORD-MTH-CODE                        32080008
320900               ,:WS-TSK-RTL-CST-CVRSN-FCTR                        32090008
321000               ,:WS-TSK-SETUP-DATE                                32100008
321100               ,:WS-TSK-PRICE-CHNG-DATE                           32110008
321200               ,:WS-TSK-GROUP-CODE                                32120008
321300               ,:WS-TSK-SKU-DESC                                  32130008
321400               ,:WS-TSK-SIZE-DESC                                 32140008
321500               ,:WS-TSK-COLOR-DESC                                32150008
321600               ,:WS-TSK-REORDER-FRMT-CODE                         32160008
321700               ,:WS-TSK-MERCH-DIV-CODE                            32170008
321800               ,:WS-TSK-DMM-NMBR                                  32180008
321900               ,:WS-TSK-BUYER-NMBR                                32190008
322000               ,:WS-TSK-VENDOR-NMBR                               32200008
322100               ,:WS-TSK-VNDR-IN-HSE-NMBR                          32210008
322200               ,:WS-TSK-MKDN-PGM-CODE                             32220008
322300               ,:WS-TSK-LOWST-UNIT-RTL-AMT                        32230008
322400               ,:WS-TSK-LOW-RTL-PRICE-DATE                        32240008
322500               ,:WS-TSK-ITEM-NMBR                                 32250008
322600               ,:WS-TSK-GP-RTL-AMT                                32260008
322700               ,:WS-TSK-ORIG-GP-QTY                               32270008
322800               ,:WS-TSK-ORIG-GP-RTL-AMT                           32280008
322900               ,:WS-TSK-FS-RPT-IND                                32290008
323000               ,:WS-TSK-GP-QTY                                    32300008
323100               ,:WS-TSK-MULT-PR-PT-IND                            32310008
323200               ,:WS-TSK-PLU-DWNLD-EXCL-IND                        32320008
323300               ,:WS-TSK-LAST-PO-REV-DTE                           32330008
323400               ,:WS-TSK-PO-REV-DAY-NBR                            32340008
323500               ,:WS-TSK-PO-REV-SUN-WK-NBR                         32350008
323600               ,:WS-TSK-PO-REV-MON-WK-NBR                         32360008
323700               ,:WS-TSK-PO-REV-TUE-WK-NBR                         32370008
323800               ,:WS-TSK-PO-REV-WED-WK-NBR                         32380008
323900               ,:WS-TSK-PO-REV-THU-WK-NBR                         32390008
324000               ,:WS-TSK-PO-REV-FRI-WK-NBR                         32400008
324100               ,:WS-TSK-PO-REV-SAT-WK-NBR                         32410008
324200               ,:WS-TSK-CENT-STK-CDE                              32420008
324300               ,:WS-TSK-MEITGP-NBR                                32430008
324400               ,:WS-TSK-SKU-TYP-CDE                               32440008
324500               ,:WS-TSK-VEND-OUTR-PACK-QTY                        32450008
324600               ,:WS-TSK-LONG-VENDOR-STYLE                         32460008
324700               ,:WS-TSK-SIZE-CDE                                  32470008
324800               ,:WS-TSK-LONG-SIZE-DESC                            32480008
324900               ,:WS-TSK-COLOR-CDE                                 32490008
325000               ,:WS-TSK-LONG-COLOR-DESC                           32500008
325100               ,:WS-TSK-STICKER-NBR                               32510008
325200               ,:WS-TSK-ENT-ID                                    32520008
325300               ,:WS-TSK-TKT-FMT-ID                                32530008
325400               ,:WS-TSK-KY-ITM-IND                                32540008
325500               ,:WS-TSK-VS-CHARTC-CDE                             32550008
325600               ,:WS-TSK-VS-CHARTC-SEQ-NBR                         32560008
325700               ,:WS-TSK-UNT-COST-1ST-AMT                          32570008
325800               ,:WS-TSK-REGN-PRIC-IND                             32580008
325900        END-EXEC                                                  32590008
326000                                                                  32600008
326100        EVALUATE TRUE                                             32610008
326200            WHEN SQLCODE = ZERO OR -305                           32620008
326300                 MOVE LENGTH OF WS-SK TO DS009-TBLE-DATA-SIZE     32630008
326400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 32640008
326500                                           + DS009-RECORD-FILLER  32650008
326600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     32660008
326700                 MOVE 'TSK'               TO DS002-NAME           32670008
326800                 PERFORM DS002-FIND-SEQUENCE                      32680008
326900                 MOVE WS-SK               TO DS002-DATA-ITEM      32690008
327000                 INITIALIZE DS009-PKYS                            32700008
327100                 PERFORM DS002-PROCESS-KEYS                       32710008
327200                 MOVE WS-SK-KEYS      TO DS009-PKYS               32720008
327300                 MOVE DS009-PKYS      TO DS002-KEYS               32730008
327400                 PERFORM 8000-WRITE-UNLOAD                        32740008
327500                                                                  32750008
327600            WHEN SQLCODE = +100                                   32760008
327700                 SET NO-MORE-SK-DATA  TO TRUE                     32770008
327800            WHEN SQLCODE = -904                                   32780008
327900            WHEN SQLCODE = -913                                   32790008
328000              CONTINUE                                            32800008
328100           END-EVALUATE                                           32810008
328200         END-PERFORM.                                             32820008
328300*                                                                 32830008
328400     PERFORM DS002-SQL-ABEND-FETCH.                               32840008
328500/                                                                 32850008
328600 R100-FETCH-SKST.                                                 32860008
328700*    DISPLAY 'R100-FETCH-SKST'.                                   32870008
328800*                                                                 32880008
328900     MOVE 'TSKST' TO DS009-PROCESS-TABLE.                         32890008
329000     PERFORM WITH TEST AFTER                                      32900008
329100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   32910008
329200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        32920008
329300                SQLCODE = ZERO OR                                 32930008
329400                SQLCODE = +100                                    32940008
329500        EXEC SQL                                                  32950008
329600            FETCH SKST-CSR                                        32960008
329700            INTO                                                  32970008
329800                :WS-SKST-ITEM-NMBR                                32980008
329900               ,:WS-SKST-LOC-NBR                                  32990008
330000               ,:WS-SKST-LAST-SALE-DATE                           33000008
330100               ,:WS-SKST-LAST-RCVD-DATE                           33010008
330200               ,:WS-SKST-ONHAND-QTY                               33020008
330300               ,:WS-SKST-FIRST-RCVD-DATE                          33030008
330400               ,:WS-SKST-FIRST-SALE-DATE                          33040008
330500               ,:WS-SKST-YTD-SALES-UNIT-QTY                       33050008
330600               ,:WS-SKST-YTD-SALES-AMT                            33060008
330700               ,:WS-SKST-LAST-UPD-TMST                            33070008
330800        END-EXEC                                                  33080008
330900                                                                  33090008
331000        EVALUATE TRUE                                             33100008
331100            WHEN SQLCODE = ZERO OR -305                           33110008
331200                 MOVE LENGTH OF WS-SKST TO DS009-TBLE-DATA-SIZE   33120008
331300                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 33130008
331400                                           + DS009-RECORD-FILLER  33140008
331500                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     33150008
331600                 MOVE 'TSKST'             TO DS002-NAME           33160008
331700                 PERFORM DS002-FIND-SEQUENCE                      33170008
331800                 MOVE WS-SKST             TO DS002-DATA-ITEM      33180008
331900                 INITIALIZE DS009-PKYS                            33190008
332000                 PERFORM DS002-PROCESS-KEYS                       33200008
332100                 MOVE WS-SKST-KEYS    TO DS009-PKYS               33210008
332200                 MOVE DS009-PKYS      TO DS002-KEYS               33220008
332300                 PERFORM 8000-WRITE-UNLOAD                        33230008
332400                                                                  33240008
332500            WHEN SQLCODE = +100                                   33250008
332600                 SET NO-MORE-SKST-DATA TO TRUE                    33260008
332700            WHEN SQLCODE = -904                                   33270008
332800            WHEN SQLCODE = -913                                   33280008
332900              CONTINUE                                            33290008
333000           END-EVALUATE                                           33300008
333100         END-PERFORM.                                             33310008
333200*                                                                 33320008
333300     PERFORM DS002-SQL-ABEND-FETCH.                               33330008
333400/                                                                 33340008
333500 R100-FETCH-PPCPRC.                                               33350008
333600*     DISPLAY 'R100-FETCH-PPCPRC'.                                33360008
333700*                                                                 33370008
333800     MOVE 'TPPCPRC' TO DS009-PROCESS-TABLE.                       33380008
333900     PERFORM WITH TEST AFTER                                      33390008
334000        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   33400008
334100        UNTIL   DS009-RETRY-COUNTER > 3 OR                        33410008
334200                SQLCODE = ZERO OR                                 33420008
334300                SQLCODE = +100                                    33430008
334400        EXEC SQL                                                  33440008
334500            FETCH PPCPRC_CSR                                      33450008
334600            INTO                                                  33460008
334700                :WS-PPCPRC-TSK-ITM-NBR                            33470008
334800               ,:WS-PPCPRC-STRT-TMST                              33480008
334900               ,:WS-PPCPRC-STR-NBR                                33490008
335000               ,:WS-PPCPRC-END-TMST                               33500008
335100               ,:WS-PPCPRC-MEITGP-NBR                             33510008
335200               ,:WS-PPCPRC-RTL-AMT                                33520008
335300               ,:WS-PPCPRC-STATUS-CDE                             33530008
335400               ,:WS-PPCPRC-UID-NBR                                33540008
335500        END-EXEC                                                  33550008
335600                                                                  33560008
335700        EVALUATE TRUE                                             33570008
335800            WHEN SQLCODE = ZERO OR -305                           33580008
335900                 MOVE LENGTH OF WS-PPCPRC TO DS009-TBLE-DATA-SIZE 33590008
336000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 33600008
336100                                           + DS009-RECORD-FILLER  33610008
336200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     33620008
336300                 MOVE 'TPPCPRC'           TO DS002-NAME           33630008
336400                 PERFORM DS002-FIND-SEQUENCE                      33640008
336500                 MOVE WS-PPCPRC           TO DS002-DATA-ITEM      33650008
336600                 INITIALIZE DS009-PKYS                            33660008
336700                 PERFORM DS002-PROCESS-KEYS                       33670008
336800                 MOVE WS-PPCPRC-KEYS  TO DS009-PKYS               33680008
336900                 MOVE DS009-PKYS      TO DS002-KEYS               33690008
337000                 PERFORM 8000-WRITE-UNLOAD                        33700008
337100                                                                  33710008
337200            WHEN SQLCODE = +100                                   33720008
337300                 SET NO-MORE-PPCPRC-DATA TO TRUE                  33730008
337400            WHEN SQLCODE = -904                                   33740008
337500            WHEN SQLCODE = -913                                   33750008
337600              CONTINUE                                            33760008
337700           END-EVALUATE                                           33770008
337800         END-PERFORM.                                             33780008
337900*                                                                 33790008
338000     PERFORM DS002-SQL-ABEND-FETCH.                               33800008
338100/                                                                 33810008
338200 R100-FETCH-UPCSKU.                                               33820008
338300*    DISPLAY 'R100-FETCH-UPCSKU'.                                 33830008
338400*                                                                 33840008
338500     MOVE 'TUPCSKU' TO DS009-PROCESS-TABLE.                       33850008
338600     PERFORM WITH TEST AFTER                                      33860008
338700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   33870008
338800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        33880008
338900                SQLCODE = ZERO OR                                 33890008
339000                SQLCODE = +100                                    33900008
339100        EXEC SQL                                                  33910008
339200            FETCH UPCSKU_CSR                                      33920008
339300            INTO                                                  33930008
339400                :WS-TUPCSKU-UPC-NBR                               33940008
339500               ,:WS-TUPCSKU-ITEM-NBR                              33950008
339600               ,:WS-TUPCSKU-EDI-ORD-IND                           33960008
339700               ,:WS-TUPCSKU-PLU-DWNLD-IND                         33970008
339800               ,:WS-TUPCSKU-XREF-CRE-DTE                          33980008
339900               ,:WS-TUPCSKU-UPC-DESC                              33990008
340000               ,:WS-TUPCSKU-CERT-IND                              34000008
340100               ,:WS-TUPCSKU-CERT-DTE                              34010008
340200               ,:WS-TUPCSKU-UPC-SRC-IND                           34020008
340300               ,:WS-TUPCSKU-UMDCLN-IND                            34030008
340400        END-EXEC                                                  34040008
340500                                                                  34050008
340600        EVALUATE TRUE                                             34060008
340700            WHEN SQLCODE = ZERO OR -305                           34070008
340800                 MOVE LENGTH OF WS-UPCSKU TO DS009-TBLE-DATA-SIZE 34080008
340900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 34090008
341000                                           + DS009-RECORD-FILLER  34100008
341100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     34110008
341200                 MOVE 'TUPCSKU'           TO DS002-NAME           34120008
341300                 PERFORM DS002-FIND-SEQUENCE                      34130008
341400                 MOVE WS-UPCSKU           TO DS002-DATA-ITEM      34140008
341500                 INITIALIZE DS009-PKYS                            34150008
341600                 PERFORM DS002-PROCESS-KEYS                       34160008
341700                 MOVE WS-UPCSKU-KEYS  TO DS009-PKYS               34170008
341800                 MOVE DS009-PKYS      TO DS002-KEYS               34180008
341900                 PERFORM 8000-WRITE-UNLOAD                        34190008
342000                                                                  34200008
342100                 MOVE WS-TUPCSKU-UPC-NBR TO HOLD-UPC-NBR          34210008
342200                 MOVE 'TUPC   ' TO DS009-PROCESS-TABLE            34220008
342300                 PERFORM DS002-DO-PROCESS                         34230008
342400                 IF DS009-DO-PROCESS                              34240008
342500                     SET MORE-UPC-DATA TO TRUE                    34250008
342600                     PERFORM Y100-OPEN-CURSOR                     34260008
342700                     PERFORM R100-FETCH-UPC                       34270008
342800                         UNTIL NO-MORE-UPC-DATA                   34280008
342900                     MOVE 'TUPC   ' TO DS009-PROCESS-TABLE        34290008
343000                     PERFORM Z100-CLOSE-CURSOR                    34300008
343100                 END-IF                                           34310008
343200                                                                  34320008
343300            WHEN SQLCODE = +100                                   34330008
343400                 SET NO-MORE-UPCSKU-DATA  TO TRUE                 34340008
343500            WHEN SQLCODE = -904                                   34350008
343600            WHEN SQLCODE = -913                                   34360008
343700              CONTINUE                                            34370008
343800           END-EVALUATE                                           34380008
343900         END-PERFORM.                                             34390008
344000*                                                                 34400008
344100     PERFORM DS002-SQL-ABEND-FETCH.                               34410008
344200/                                                                 34420008
344300 R100-FETCH-UPC.                                                  34430008
344400*    DISPLAY 'R100-FETCH-UPC'.                                    34440008
344500*                                                                 34450008
344600     INITIALIZE     WS-UPC.                                       34460008
344700     MOVE 'TUPC' TO DS009-PROCESS-TABLE.                          34470008
344800     PERFORM WITH TEST AFTER                                      34480008
344900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   34490008
345000        UNTIL   DS009-RETRY-COUNTER > 3 OR                        34500008
345100                SQLCODE = ZERO OR                                 34510008
345200                SQLCODE = +100                                    34520008
345300        EXEC SQL                                                  34530008
345400            FETCH UPC-CSR                                         34540008
345500            INTO                                                  34550008
345600                :WS-UPC-UPC-ID                                    34560008
345700               ,:WS-UPC-UPC-NBR                                   34570008
345800               ,:WS-UPC-SUB-CL-MDSEAR-ID                          34580008
345900               ,:WS-UPC-VS-ID                                     34590008
346000               ,:WS-UPC-INTR-UPC-ID                               34600008
346100               ,:WS-UPC-EFF-BEG-DTE                               34610008
346200               ,:WS-UPC-EFF-END-DTE:WS-UPC-EFF-END-DTE-NN         34620008
346300               ,:WS-UPC-UPC-TYP-CDE                               34630008
346400               ,:WS-UPC-KOHLS-SIZE-CDE                            34640008
346500               ,:WS-UPC-NRF-SIZE-IND                              34650008
346600               ,:WS-UPC-NRF-CLOR-CDE                              34660008
346700               ,:WS-UPC-NRF-CLOR-IND                              34670008
346800               ,:WS-UPC-CSTM-CLOR-DESC                            34680008
346900               ,:WS-UPC-EDI-ORD-IND                               34690008
347000               ,:WS-UPC-PREPK-IND                                 34700008
347100               ,:WS-UPC-GP-CDE                                    34710008
347200               ,:WS-UPC-CERTD-IND                                 34720008
347300               ,:WS-UPC-CERTD-DTE                                 34730008
347400               ,:WS-UPC-RPLNMT-IND                                34740008
347500               ,:WS-UPC-KY-ITM-IND                                34750008
347600               ,:WS-UPC-UNT-COST-1ST-AMT                          34760008
347700               ,:WS-UPC-UPC-SRC-CDE                               34770008
347800               ,:WS-UPC-INNR-PK-QTY                               34780008
347900               ,:WS-UPC-OUTR-PK-QTY                               34790008
348000               ,:WS-UPC-SEA-SEQ-NBR                               34800008
348100               ,:WS-UPC-CRE-BY-USR-ID                             34810008
348200               ,:WS-UPC-LAST-UPD-BY-USR-ID                        34820008
348300               ,:WS-UPC-LAST-UPD-TMST                             34830008
348400               ,:WS-UPC-WD-UM-QTY                                 34840008
348500               ,:WS-UPC-DPTH-UM-QTY                               34850008
348600               ,:WS-UPC-HT-UM-QTY                                 34860008
348700               ,:WS-UPC-SIZE-UM-CDE                               34870008
348800               ,:WS-UPC-WT-UM-QTY                                 34880008
348900               ,:WS-UPC-WT-UM-CDE                                 34890008
349000               ,:WS-UPC-POG-IND                                   34900008
349100               ,:WS-UPC-REGN-PRIC-IND                             34910008
349200               ,:WS-UPC-TX-PRD-CDE-SEQ-NBR                        34920008
349300               ,:WS-UPC-CUSTFACG-CLOR-DESC                        34930008
349400               ,:WS-UPC-INTR-UPC-DESC                             34940008
349500               ,:WS-UPC-TRNSTN-IND                                34950008
349600               ,:WS-UPC-PO-SHRT-CYC-IND                           34960008
349700               ,:WS-UPC-TST-PRD-TYP-SEQ-NBR                       34970008
349800               ,:WS-UPC-WHSE-RPLNT-IND                            34980008
349900        END-EXEC                                                  34990008
350000                                                                  35000008
350100        EVALUATE TRUE                                             35010008
350200            WHEN SQLCODE = ZERO OR -305                           35020008
350300                 MOVE LENGTH OF WS-UPC TO DS009-TBLE-DATA-SIZE    35030008
350400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 35040008
350500                                           + DS009-RECORD-FILLER  35050008
350600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     35060008
350700                 MOVE 'TUPC'            TO DS002-NAME             35070008
350800                 PERFORM DS002-FIND-SEQUENCE                      35080008
350900                 MOVE WS-UPC            TO DS002-DATA-ITEM        35090008
351000                 INITIALIZE DS009-PKYS                            35100008
351100                 PERFORM DS002-PROCESS-KEYS                       35110008
351200                 MOVE WS-UPC-KEYS     TO DS009-PKYS               35120008
351300                 MOVE DS009-PKYS      TO DS002-KEYS               35130008
351400                 PERFORM 8000-WRITE-UNLOAD                        35140008
351500                                                                  35150008
351600*                ONLY GET STYLE LEVEL VSM DATA ONCE PER INTERNAL  35160008
351700*                UPC ID (ONCE FOR EACH PROCESS OF THE TUPCSKU     35170008
351800*                CURSOR WHICH IS DRIVEN BY ITEM NUMBER)           35180008
351900                 IF WS-UPC-INTR-UPC-ID NOT =                      35190008
352000                       PV-HOLD-UPC-INTR-UPC-ID                    35200008
352100                     MOVE WS-UPC-INTR-UPC-ID                      35210008
352200                           TO PV-HOLD-UPC-INTR-UPC-ID             35220008
352300                                                                  35230008
352400                     MOVE WS-UPC-VS-ID TO HOLD-VS-ID              35240008
352500                     MOVE 'TVNDSTL' TO DS009-PROCESS-TABLE        35250008
352600                     PERFORM DS002-DO-PROCESS                     35260008
352700                     IF DS009-DO-PROCESS                          35270008
352800                         SET MORE-VNDSTL-DATA TO TRUE             35280008
352900                         PERFORM Y100-OPEN-CURSOR                 35290008
353000                         PERFORM R100-FETCH-VNDSTL                35300008
353100                             UNTIL NO-MORE-VNDSTL-DATA            35310008
353200                         PERFORM Z100-CLOSE-CURSOR                35320008
353300                     END-IF                                       35330008
353400                                                                  35340008
353500                     MOVE WS-UPC-SUB-CL-MDSEAR-ID TO              35350008
353600                          HOLD-SUB-CL-MDSEAR-ID                   35360008
353700                     MOVE WS-UPC-VS-ID TO HOLD-VS-ID              35370008
353800                     MOVE 'TMDSEAR' TO DS009-PROCESS-TABLE        35380008
353900                     PERFORM DS002-DO-PROCESS                     35390008
354000                     IF DS009-DO-PROCESS                          35400008
354100                         SET MORE-MDSEAR-DATA TO TRUE             35410008
354200                         PERFORM Y100-OPEN-CURSOR                 35420008
354300                         PERFORM R100-FETCH-MDSEAR                35430008
354400                             UNTIL NO-MORE-MDSEAR-DATA            35440008
354500                         PERFORM Z100-CLOSE-CURSOR                35450008
354600                     END-IF                                       35460008
354700                                                                  35470008
354800                     MOVE 'TMDARVS' TO DS009-PROCESS-TABLE        35480008
354900                     PERFORM DS002-DO-PROCESS                     35490008
355000                     IF DS009-DO-PROCESS                          35500008
355100                         SET MORE-MDARVS-DATA TO TRUE             35510008
355200                         PERFORM Y100-OPEN-CURSOR                 35520008
355300                         PERFORM R100-FETCH-MDARVS                35530008
355400                             UNTIL NO-MORE-MDARVS-DATA            35540008
355500                         PERFORM Z100-CLOSE-CURSOR                35550008
355600                     END-IF                                       35560008
355700                                                                  35570008
355800                     MOVE 'IMT_STYL_PRTNR' TO DS009-PROCESS-TABLE 35580008
355900                     PERFORM DS002-DO-PROCESS                     35590008
356000                     IF DS009-DO-PROCESS                          35600008
356100                         SET DS010-END-IMT00016-NO TO TRUE        35610008
356200                         PERFORM Y100-OPEN-CURSOR                 35620008
356300                         PERFORM R100-FETCH-IMT-STYL-PRTNR        35630008
356400                             UNTIL DS010-END-IMT00016-YES         35640008
356500                         PERFORM Z100-CLOSE-CURSOR                35650008
356600                     END-IF                                       35660008
356700                                                                  35670008
356800                     MOVE WS-UPC-INTR-UPC-ID TO HOLD-INTR-UPC-ID  35680008
356900                     MOVE 'TWEBITM' TO DS009-PROCESS-TABLE        35690008
357000                     PERFORM DS002-DO-PROCESS                     35700008
357100                     IF DS009-DO-PROCESS                          35710008
357200                        SET MORE-WEBITM-DATA TO TRUE              35720008
357300                        PERFORM Y100-OPEN-CURSOR                  35730008
357400                        PERFORM R100-FETCH-WEBITM                 35740008
357500                            UNTIL NO-MORE-WEBITM-DATA             35750008
357600                        MOVE 'TWEBITM' TO DS009-PROCESS-TABLE     35760008
357700                        PERFORM Z100-CLOSE-CURSOR                 35770008
357800                     END-IF                                       35780008
357900                 END-IF                                           35790008
358000                                                                  35800008
358100                 IF WS-UPC-UPC-TYP-CDE = 'I'                      35810008
358200                     IF WS-UPC-TX-PRD-CDE-SEQ-NBR > ZERO          35820008
358300                         MOVE 'TVSCHVL' TO DS009-PROCESS-TABLE    35830008
358400                         PERFORM DS002-DO-PROCESS                 35840008
358500                         IF DS009-DO-PROCESS                      35850008
358600                             MOVE PC-TX-PRD-CD-CHARTC-CDE         35860008
358700                                  TO HOLD-CHARTC-CDE              35870008
358800                             MOVE WS-UPC-TX-PRD-CDE-SEQ-NBR       35880008
358900                                  TO HOLD-CHARTC-SEQ-NBR          35890008
359000                             PERFORM S110-SELECT-VSCHVL           35900008
359100                         END-IF                                   35910008
359200                     END-IF                                       35920008
359300                 END-IF                                           35930008
359400                                                                  35940008
359500                 IF WS-UPC-UPC-TYP-CDE = 'I'                      35950008
359600                     IF WS-UPC-TST-PRD-TYP-SEQ-NBR > ZERO         35960008
359700                         MOVE 'TVSCHVL' TO DS009-PROCESS-TABLE    35970008
359800                         PERFORM DS002-DO-PROCESS                 35980008
359900                         IF DS009-DO-PROCESS                      35990008
360000                             MOVE PC-UPC-TST-PRD-TYP              36000008
360100                                  TO HOLD-CHARTC-CDE              36010008
360200                             MOVE WS-UPC-TST-PRD-TYP-SEQ-NBR      36020008
360300                                  TO HOLD-CHARTC-SEQ-NBR          36030008
360400                             PERFORM S110-SELECT-VSCHVL           36040008
360500                         END-IF                                   36050008
360600                     END-IF                                       36060008
360700                 END-IF                                           36070008
360800                                                                  36080008
360900                 IF WS-UPC-UPC-TYP-CDE = 'I' OR 'R'               36090008
361000                     MOVE WS-UPC-UPC-ID TO HOLD-UPC-ID            36100008
361100                     MOVE 'TUPCPLS' TO DS009-PROCESS-TABLE        36110008
361200                     PERFORM DS002-DO-PROCESS                     36120008
361300                     IF DS009-DO-PROCESS                          36130008
361400                         SET MORE-UPCPLS-DATA TO TRUE             36140008
361500                         PERFORM Y100-OPEN-CURSOR                 36150008
361600                         PERFORM R100-FETCH-UPCPLS                36160008
361700                             UNTIL NO-MORE-UPCPLS-DATA            36170008
361800                         PERFORM Z100-CLOSE-CURSOR                36180008
361900                     END-IF                                       36190008
362000                                                                  36200008
362100                     MOVE WS-UPC-UPC-NBR  TO PV-HOLD-UPC-NBR      36210008
362200                     MOVE PV-HOLD-UPC-SKU TO HOLD-SKU             36220008
362300                     MOVE 'TSKXREF' TO DS009-PROCESS-TABLE        36230008
362400                     PERFORM DS002-DO-PROCESS                     36240008
362500                     IF DS009-DO-PROCESS                          36250008
362600                        SET MORE-SKXREF-DATA TO TRUE              36260008
362700                        PERFORM Y100-OPEN-CURSOR                  36270008
362800                        PERFORM R100-FETCH-SKXREF                 36280008
362900                            UNTIL NO-MORE-SKXREF-DATA             36290008
363000                        PERFORM Z100-CLOSE-CURSOR                 36300008
363100                        MOVE 'TSKXREF' TO DS009-PROCESS-TABLE     36310008
363200                     END-IF                                       36320008
363300                 END-IF                                           36330008
363400                                                                  36340008
363500*  XLT_SKU                                                        36350008
363600                 MOVE WS-UPC-INTR-UPC-ID TO HOLD-INTR-UPC-ID      36360008
363700                 MOVE 'XLT_SKU' TO DS009-PROCESS-TABLE            36370008
363800                 PERFORM DS002-DO-PROCESS                         36380008
363900                 IF DS009-DO-PROCESS                              36390008
364000                    SET MORE-XLTSKU-DATA TO TRUE                  36400008
364100                    PERFORM Y100-OPEN-CURSOR                      36410008
364200                    PERFORM R100-FETCH-XLTSKU                     36420008
364300                        UNTIL NO-MORE-XLTSKU-DATA                 36430008
364400                    MOVE 'XLT_SKU' TO DS009-PROCESS-TABLE         36440008
364500                    PERFORM Z100-CLOSE-CURSOR                     36450008
364600                 END-IF                                           36460008
364700                                                                  36470008
364800*  XLT_UPC                                                        36480008
364900                 MOVE WS-UPC-INTR-UPC-ID TO HOLD-INTR-UPC-ID      36490008
365000                 MOVE 'XLT_UPC' TO DS009-PROCESS-TABLE            36500008
365100                 PERFORM DS002-DO-PROCESS                         36510008
365200                 IF DS009-DO-PROCESS                              36520008
365300                    SET MORE-XLTUPC-DATA TO TRUE                  36530008
365400                    PERFORM Y100-OPEN-CURSOR                      36540008
365500                    PERFORM R100-FETCH-XLTUPC                     36550008
365600                        UNTIL NO-MORE-XLTUPC-DATA                 36560008
365700                    MOVE 'XLT_UPC' TO DS009-PROCESS-TABLE         36570008
365800                    PERFORM Z100-CLOSE-CURSOR                     36580008
365900                 END-IF                                           36590008
366000                                                                  36600008
366100            WHEN SQLCODE = +100                                   36610008
366200                 SET NO-MORE-UPC-DATA  TO TRUE                    36620008
366300            WHEN SQLCODE = -904                                   36630008
366400            WHEN SQLCODE = -913                                   36640008
366500              CONTINUE                                            36650008
366600           END-EVALUATE                                           36660008
366700         END-PERFORM.                                             36670008
366800*                                                                 36680008
366900     PERFORM DS002-SQL-ABEND-FETCH.                               36690008
367000/                                                                 36700008
367100 R100-FETCH-VNDSTL.                                               36710008
367200*    DISPLAY 'R100-FETCH-VNDSTL'.                                 36720008
367300*                                                                 36730008
367400     INITIALIZE     WS-VNDSTL.                                    36740008
367500     MOVE 'TVNDSTL' TO DS009-PROCESS-TABLE.                       36750008
367600     PERFORM WITH TEST AFTER                                      36760008
367700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   36770008
367800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        36780008
367900                SQLCODE = ZERO OR                                 36790008
368000                SQLCODE = +100                                    36800008
368100        EXEC SQL                                                  36810008
368200            FETCH VNDSTL_CSR                                      36820008
368300            INTO                                                  36830008
368400             :WS-VNDSTL-VS-ID                                     36840008
368500            ,:WS-VNDSTL-ENT-ID                                    36850008
368600            ,:WS-VNDSTL-VS-NBR                                    36860008
368700            ,:WS-VNDSTL-EFF-BEG-DTE:WS-VNDSTL-EFF-BEG-DTE-NN      36870008
368800            ,:WS-VNDSTL-EFF-END-DTE:WS-VNDSTL-EFF-END-DTE-NN      36880008
368900            ,:WS-VNDSTL-COST-UM-CDE                               36890008
369000            ,:WS-VNDSTL-RTL-UM-CDE                                36900008
369100            ,:WS-VNDSTL-BYP-CAT-IND                               36910008
369200            ,:WS-VNDSTL-CRE-BY-USR-ID                             36920008
369300            ,:WS-VNDSTL-LAST-UPD-BY-USR-ID                        36930008
369400            ,:WS-VNDSTL-LAST-UPD-TMST                             36940008
369500        END-EXEC                                                  36950008
369600                                                                  36960008
369700        EVALUATE TRUE                                             36970008
369800            WHEN SQLCODE = ZERO OR -305                           36980008
369900                 MOVE LENGTH OF WS-VNDSTL TO DS009-TBLE-DATA-SIZE 36990008
370000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 37000008
370100                                           + DS009-RECORD-FILLER  37010008
370200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     37020008
370300                 MOVE 'TVNDSTL'           TO DS002-NAME           37030008
370400                 PERFORM DS002-FIND-SEQUENCE                      37040008
370500                 MOVE WS-VNDSTL           TO DS002-DATA-ITEM      37050008
370600                 INITIALIZE DS009-PKYS                            37060008
370700                 PERFORM DS002-PROCESS-KEYS                       37070008
370800                 MOVE WS-VNDSTL-KEYS  TO DS009-PKYS               37080008
370900                 MOVE DS009-PKYS      TO DS002-KEYS               37090008
371000                 PERFORM 8000-WRITE-UNLOAD                        37100008
371100            WHEN SQLCODE = +100                                   37110008
371200                 SET NO-MORE-VNDSTL-DATA  TO TRUE                 37120008
371300            WHEN SQLCODE = -904                                   37130008
371400            WHEN SQLCODE = -913                                   37140008
371500              CONTINUE                                            37150008
371600           END-EVALUATE                                           37160008
371700         END-PERFORM.                                             37170008
371800*                                                                 37180008
371900     PERFORM DS002-SQL-ABEND-FETCH.                               37190008
372000/                                                                 37200008
372100 R100-FETCH-XLTSKU.                                               37210008
372200*    DISPLAY 'R100-FETCH-XLTSKU'.                                 37220008
372300     INITIALIZE     DCLXLT00003.                                  37230008
372400     MOVE 'XLT_SKU' TO DS009-PROCESS-TABLE.                       37240008
372500     PERFORM WITH TEST AFTER                                      37250008
372600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   37260008
372700        UNTIL   DS009-RETRY-COUNTER > 3 OR                        37270008
372800                SQLCODE = ZERO OR                                 37280008
372900                SQLCODE = +100                                    37290008
373000        EXEC SQL                                                  37300008
373100            FETCH XLTSKU-CSR                                      37310008
373200            INTO                                                  37320008
373300               :XLT00003-INTR-UPC-ID                              37330008
373400             , :XLT00003-STYL-ID                                  37340008
373500             , :XLT00003-ITM-NBR                                  37350008
373600             , :XLT00003-SKU-NBR                                  37360008
373700             , :XLT00003-SKU-STAT-CDE                             37370008
373800             , :XLT00003-SKU-STAT-DESC                            37380008
373900             , :XLT00003-INNR-PK-QTY                              37390008
374000             , :XLT00003-OUTR-PK-QTY                              37400008
374100             , :XLT00003-SKU-DESC                                 37410008
374200             , :XLT00003-KOHLS-SIZE-CDE                           37420008
374300             , :XLT00003-SIZE-DESC                                37430008
374400             , :XLT00003-NRF-CLOR-CDE                             37440008
374500             , :XLT00003-SHRT-CLOR-DESC                           37450008
374600             , :XLT00003-CSTM-CLOR-DESC                           37460008
374700             , :XLT00003-REGN-PRIC-IND                            37470008
374800             , :XLT00003-KY-ITM-IND                               37480008
374900             , :XLT00003-GP-CDE                                   37490008
375000             , :XLT00003-WHSE-RPLNT-IND                           37500008
375100         END-EXEC                                                 37510008
375200                                                                  37520008
375300        EVALUATE TRUE                                             37530008
375400            WHEN SQLCODE = ZERO OR -305                           37540008
375500                 MOVE LENGTH OF DCLXLT00003                       37550008
375600                                         TO DS009-TBLE-DATA-SIZE  37560008
375700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 37570008
375800                                           + DS009-RECORD-FILLER  37580008
375900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     37590008
376000                 MOVE 'XLT_SKU'           TO DS002-NAME           37600008
376100                 PERFORM DS002-FIND-SEQUENCE                      37610008
376200                 MOVE DCLXLT00003         TO DS002-DATA-ITEM      37620008
376300                 INITIALIZE DS009-PKYS                            37630008
376400                 PERFORM DS002-PROCESS-KEYS                       37640008
376500                 MOVE DS008-XLTSKU-KEYS TO DS009-PKYS             37650008
376600                 MOVE DS009-PKYS      TO DS002-KEYS               37660008
376700                 PERFORM 8000-WRITE-UNLOAD                        37670008
376800                                                                  37680008
376900                 PERFORM S100-SELECT-XLT-VND-STYL                 37690008
377000                                                                  37700008
377100            WHEN SQLCODE = +100                                   37710008
377200                 SET NO-MORE-XLTSKU-DATA  TO TRUE                 37720008
377300            WHEN SQLCODE = -904                                   37730008
377400            WHEN SQLCODE = -913                                   37740008
377500              CONTINUE                                            37750008
377600           END-EVALUATE                                           37760008
377700         END-PERFORM.                                             37770008
377800*                                                                 37780008
377900     PERFORM DS002-SQL-ABEND-FETCH.                               37790008
378000/                                                                 37800008
378100 R100-FETCH-XLTUPC.                                               37810008
378200     INITIALIZE     DCLXLT00006.                                  37820008
378300     MOVE 'XLT_UPC' TO DS009-PROCESS-TABLE.                       37830008
378400     PERFORM WITH TEST AFTER                                      37840008
378500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   37850008
378600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        37860008
378700                SQLCODE = ZERO OR                                 37870008
378800                SQLCODE = +100                                    37880008
378900        EXEC SQL                                                  37890008
379000            FETCH XLTUPC-CSR                                      37900008
379100            INTO                                                  37910008
379200              :XLT00006-UPC-ID                                    37920008
379300           ,  :XLT00006-INTR-UPC-ID                               37930008
379400           ,  :XLT00006-UPC-TYP-CDE                               37940008
379500           ,  :XLT00006-EDI-ORD-IND                               37950008
379600           ,  :XLT00006-CERTD-IND                                 37960008
379700           ,  :XLT00006-CERTD-DTE                                 37970008
379800           ,  :XLT00006-UPC-NBR                                   37980008
379900         END-EXEC                                                 37990008
380000                                                                  38000008
380100        EVALUATE TRUE                                             38010008
380200            WHEN SQLCODE = ZERO OR -305                           38020008
380300                 MOVE LENGTH OF DCLXLT00006                       38030008
380400                                         TO DS009-TBLE-DATA-SIZE  38040008
380500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 38050008
380600                                           + DS009-RECORD-FILLER  38060008
380700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     38070008
380800                 MOVE 'XLT_UPC'           TO DS002-NAME           38080008
380900                 PERFORM DS002-FIND-SEQUENCE                      38090008
381000                 MOVE DCLXLT00006         TO DS002-DATA-ITEM      38100008
381100                 INITIALIZE DS009-PKYS                            38110008
381200                 PERFORM DS002-PROCESS-KEYS                       38120008
381300                 MOVE DS008-XLTUPC-KEYS TO DS009-PKYS             38130008
381400                 MOVE DS009-PKYS      TO DS002-KEYS               38140008
381500                 PERFORM 8000-WRITE-UNLOAD                        38150008
381600                                                                  38160008
381700            WHEN SQLCODE = +100                                   38170008
381800                 SET NO-MORE-XLTUPC-DATA  TO TRUE                 38180008
381900            WHEN SQLCODE = -904                                   38190008
382000            WHEN SQLCODE = -913                                   38200008
382100              CONTINUE                                            38210008
382200           END-EVALUATE                                           38220008
382300         END-PERFORM.                                             38230008
382400*                                                                 38240008
382500     PERFORM DS002-SQL-ABEND-FETCH.                               38250008
382600/                                                                 38260008
382700 R100-FETCH-UPCPLS.                                               38270008
382800*                                                                 38280008
382900     INITIALIZE     WS-UPCPLS.                                    38290008
383000     MOVE 'TUPCPLS' TO DS009-PROCESS-TABLE.                       38300008
383100     PERFORM WITH TEST AFTER                                      38310008
383200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   38320008
383300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        38330008
383400                SQLCODE = ZERO OR                                 38340008
383500                SQLCODE = +100                                    38350008
383600        EXEC SQL                                                  38360008
383700            FETCH UPCPLS_CSR                                      38370008
383800            INTO                                                  38380008
383900             :WS-UPCPLS-UPC-ID                                    38390008
384000            ,:WS-UPCPLS-OPERCO-NBR                                38400008
384100            ,:WS-UPCPLS-STR-NBR                                   38410008
384200            ,:WS-UPCPLS-EFF-BEG-TMST                              38420008
384300            ,:WS-UPCPLS-EFF-END-TMST:WS-UPCPLS-EFF-END-TMST-NN    38430008
384400            ,:WS-UPCPLS-UPC-STAT-CDE:WS-UPCPLS-UPC-STAT-CDE-NN    38440008
384500            ,:WS-UPCPLS-UNT-COST-AMT:WS-UPCPLS-UNT-COST-AMT-NN    38450008
384600            ,:WS-UPCPLS-UNT-RTL-AMT:WS-UPCPLS-UNT-RTL-AMT-NN      38460008
384700            ,:WS-UPCPLS-MEITGP-NBR:WS-UPCPLS-MEITGP-NBR-NN        38470008
384800            ,:WS-UPCPLS-CRE-BY-USR-ID                             38480008
384900            ,:WS-UPCPLS-CRE-TMST                                  38490008
385000            ,:WS-UPCPLS-ITM-NBR                                   38500008
385100            ,:WS-UPCPLS-PLU-IND                                   38510008
385200            ,:WS-UPCPLS-UPC-STAT-CHG-DTE                          38520008
385300            ,:WS-UPCPLS-UNT-RTL-CHG-DTE                           38530008
385400            ,:WS-UPCPLS-ORIG-CLR-DTE :WS-UPCPLS-ORIG-CLR-DTE-NN   38540008
385500            ,:WS-UPCPLS-MKDN-CDE :WS-UPCPLS-MKDN-CDE-NN           38550008
385600        END-EXEC                                                  38560008
385700                                                                  38570008
385800        EVALUATE TRUE                                             38580008
385900            WHEN SQLCODE = ZERO OR -305                           38590008
386000                 MOVE LENGTH OF WS-UPCPLS TO DS009-TBLE-DATA-SIZE 38600008
386100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 38610008
386200                                           + DS009-RECORD-FILLER  38620008
386300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     38630008
386400                 MOVE 'TUPCPLS'           TO DS002-NAME           38640008
386500                 PERFORM DS002-FIND-SEQUENCE                      38650008
386600                 MOVE WS-UPCPLS           TO DS002-DATA-ITEM      38660008
386700                 INITIALIZE DS009-PKYS                            38670008
386800                 PERFORM DS002-PROCESS-KEYS                       38680008
386900                 MOVE WS-UPCPLS-KEYS  TO DS009-PKYS               38690008
387000                 MOVE DS009-PKYS      TO DS002-KEYS               38700008
387100                 PERFORM 8000-WRITE-UNLOAD                        38710008
387200            WHEN SQLCODE = +100                                   38720008
387300                 SET NO-MORE-UPCPLS-DATA  TO TRUE                 38730008
387400            WHEN SQLCODE = -904                                   38740008
387500            WHEN SQLCODE = -913                                   38750008
387600              CONTINUE                                            38760008
387700           END-EVALUATE                                           38770008
387800         END-PERFORM.                                             38780008
387900*                                                                 38790008
388000     PERFORM DS002-SQL-ABEND-FETCH.                               38800008
388100/                                                                 38810008
388200 R100-FETCH-MDSEAR.                                               38820008
388300*                                                                 38830008
388400     INITIALIZE     WS-MDSEAR.                                    38840008
388500     MOVE 'TMDSEAR' TO DS009-PROCESS-TABLE.                       38850008
388600     PERFORM WITH TEST AFTER                                      38860008
388700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   38870008
388800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        38880008
388900                SQLCODE = ZERO OR                                 38890008
389000                SQLCODE = +100                                    38900008
389100        EXEC SQL                                                  38910008
389200         FETCH MDSEAR_CSR                                         38920008
389300            INTO                                                  38930008
389400               :WS-MDSEAR-OPERCO-NBR                              38940008
389500              ,:WS-MDSEAR-GMA-NBR                                 38950008
389600              ,:WS-MDSEAR-DMA-NBR                                 38960008
389700              ,:WS-MDSEAR-DEPT-NBR                                38970008
389800              ,:WS-MDSEAR-MAJ-CL-NBR                              38980008
389900              ,:WS-MDSEAR-SUB-CL-NBR                              38990008
390000              ,:WS-MDSEAR-MDSELV-CDE                              39000008
390100              ,:WS-MDSEAR-MDSEAR-DKEY                             39010008
390200              ,:WS-MDSEAR-CHG-DTE                                 39020008
390300              ,:WS-MDSEAR-CRE-DTE                                 39030008
390400              ,:WS-MDSEAR-STRT-DTE                                39040008
390500              ,:WS-MDSEAR-END-DTE                                 39050008
390600              ,:WS-MDSEAR-GEN-MDSE-TYP-CDE                        39060008
390700              ,:WS-MDSEAR-DESC                                    39070008
390800              ,:WS-MDSEAR-BYR-NBR                                 39080008
390900              ,:WS-MDSEAR-LIST-SEQ-NBR                            39090008
391000              ,:WS-MDSEAR-PHY-INV-OH-VAR-PCT                      39100008
391100                 :WS-MDSEAR-PHY-INV-OH-VAR-PCT-N                  39110008
391200              ,:WS-MDSEAR-PHY-INV-OH-VAR-QTY                      39120008
391300                 :WS-MDSEAR-PHY-INV-OH-VAR-QTY-N                  39130008
391400        END-EXEC                                                  39140008
391500                                                                  39150008
391600        EVALUATE TRUE                                             39160008
391700            WHEN SQLCODE = ZERO OR -305                           39170008
391800                 MOVE LENGTH OF WS-MDSEAR TO DS009-TBLE-DATA-SIZE 39180008
391900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 39190008
392000                                           + DS009-RECORD-FILLER  39200008
392100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     39210008
392200                 MOVE 'TMDSEAR'           TO DS002-NAME           39220008
392300                 PERFORM DS002-FIND-SEQUENCE                      39230008
392400                 MOVE WS-MDSEAR           TO DS002-DATA-ITEM      39240008
392500                 INITIALIZE DS009-PKYS                            39250008
392600                 PERFORM DS002-PROCESS-KEYS                       39260008
392700                 MOVE WS-MDSEAR-KEYS      TO DS009-PKYS           39270008
392800                 MOVE DS009-PKYS          TO DS002-KEYS           39280008
392900                 PERFORM 8000-WRITE-UNLOAD                        39290008
393000            WHEN SQLCODE = +100                                   39300008
393100                 SET NO-MORE-MDSEAR-DATA  TO TRUE                 39310008
393200            WHEN SQLCODE = -904                                   39320008
393300            WHEN SQLCODE = -913                                   39330008
393400              CONTINUE                                            39340008
393500           END-EVALUATE                                           39350008
393600         END-PERFORM.                                             39360008
393700*                                                                 39370008
393800     PERFORM DS002-SQL-ABEND-FETCH.                               39380008
393900/                                                                 39390008
394000 R100-FETCH-MDARVS.                                               39400008
394100*                                                                 39410008
394200     INITIALIZE     WS-MDARVS.                                    39420008
394300     MOVE 'TMDARVS' TO DS009-PROCESS-TABLE.                       39430008
394400     PERFORM WITH TEST AFTER                                      39440008
394500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   39450008
394600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        39460008
394700                SQLCODE = ZERO OR                                 39470008
394800                SQLCODE = +100                                    39480008
394900        EXEC SQL                                                  39490008
395000            FETCH MDARVS_CSR                                      39500008
395100            INTO                                                  39510008
395200             :WS-MDARVS-SUB-CL-MDSEAR-ID                          39520008
395300            ,:WS-MDARVS-VS-ID                                     39530008
395400            ,:WS-MDARVS-ACTV-IND                                  39540008
395500            ,:WS-MDARVS-VS-DESC                                   39550008
395600            ,:WS-MDARVS-STKR-NBR                                  39560008
395700            ,:WS-MDARVS-TKT-TYP-SEQ-NBR                           39570008
395800            ,:WS-MDARVS-LBL-SEQ-NBR                               39580008
395900            ,:WS-MDARVS-HNG-FOLD-SEQ-NBR                          39590008
396000            ,:WS-MDARVS-KY-CLSN-SEQ-NBR                           39600008
396100            ,:WS-MDARVS-FBRCN-SEQ-NBR                             39610008
396200            ,:WS-MDARVS-FNSH-SEQ-NBR                              39620008
396300            ,:WS-MDARVS-RMS-STYL-ID                               39630008
396400            ,:WS-MDARVS-STYL-RECLS-IND                            39640008
396500            ,:WS-MDARVS-RTL-CLSN-SEQ-NBR                          39650008
396600            ,:WS-MDARVS-DEPT-NBR                                  39660008
396700            ,:WS-MDARVS-MAJ-CL-NBR                                39670008
396800            ,:WS-MDARVS-SUB-CL-NBR                                39680008
396900            ,:WS-MDARVS-ESL-SEQ-NBR                               39690008
397000            ,:WS-MDARVS-RPT-HIER-SEQ-NBR                          39700008
397100            ,:WS-MDARVS-BDY-STYL-SEQ-NBR                          39710008
397200            ,:WS-MDARVS-CONST-SEQ-NBR                             39720008
397300            ,:WS-MDARVS-FUNC-SEQ-NBR                              39730008
397400            ,:WS-MDARVS-GNDR-SEQ-NBR                              39740008
397500            ,:WS-MDARVS-PATRN-SEQ-NBR                             39750008
397600            ,:WS-MDARVS-SLHTT-SEQ-NBR                             39760008
397700            ,:WS-MDARVS-CLLCTN-SEQ-NBR                            39770008
397800            ,:WS-MDARVS-MAP-UNT-RTL-AMT                           39780008
397900            ,:WS-MDARVS-C-O-ORGN-CDE                              39790008
398000            ,:WS-MDARVS-PRIC-TIER-SEQ-NBR                         39800008
398100            ,:WS-MDARVS-LFSTYL-SEQ-NBR                            39810008
398200            ,:WS-MDARVS-CUST-INTFC-DESC                           39820008
398300            ,:WS-MDARVS-FSHN-PYRMD-SEQ-NBR                        39830008
398400            ,:WS-MDARVS-PRFL-GP-NM-TXT                            39840008
398500            ,:WS-MDARVS-CTG-SEQ-NBR                               39850008
398600            ,:WS-MDARVS-MAJ-CTG-SEQ-NBR                           39860008
398700            ,:WS-MDARVS-MTRL-SEQ-NBR                              39870008
398800            ,:WS-MDARVS-PRIM-TRND-SEQ-NBR                         39880008
398900            ,:WS-MDARVS-SEC-TRND-SEQ-NBR                          39890008
399000            ,:WS-MDARVS-ATTR-1-SEQ-NBR                            39900008
399100            ,:WS-MDARVS-ATTR-2-SEQ-NBR                            39910008
399200            ,:WS-MDARVS-NW-SLHTT-SEQ-NBR                          39920008
399300        END-EXEC                                                  39930008
399400                                                                  39940008
399500        EVALUATE TRUE                                             39950008
399600            WHEN SQLCODE = ZERO OR -305                           39960008
399700                 MOVE LENGTH OF WS-MDARVS TO DS009-TBLE-DATA-SIZE 39970008
399800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 39980008
399900                                           + DS009-RECORD-FILLER  39990008
400000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     40000008
400100                 MOVE 'TMDARVS'           TO DS002-NAME           40010008
400200                 PERFORM DS002-FIND-SEQUENCE                      40020008
400300                 MOVE WS-MDARVS           TO DS002-DATA-ITEM      40030008
400400                 INITIALIZE DS009-PKYS                            40040008
400500                 PERFORM DS002-PROCESS-KEYS                       40050008
400600                 MOVE WS-MDARVS-KEYS  TO DS009-PKYS               40060008
400700                 MOVE DS009-PKYS      TO DS002-KEYS               40070008
400800                 PERFORM 8000-WRITE-UNLOAD                        40080008
400900                                                                  40090008
401000                 MOVE 'TVSCHVL' TO DS009-PROCESS-TABLE            40100008
401100                 PERFORM DS002-DO-PROCESS                         40110008
401200                 IF DS009-DO-PROCESS                              40120008
401300                     IF WS-MDARVS-TKT-TYP-SEQ-NBR > ZERO          40130008
401400                         MOVE PC-TKT-TYP-CHARTC-CDE               40140008
401500                                           TO HOLD-CHARTC-CDE     40150008
401600                         MOVE WS-MDARVS-TKT-TYP-SEQ-NBR           40160008
401700                                           TO HOLD-CHARTC-SEQ-NBR 40170008
401800                         PERFORM S110-SELECT-VSCHVL               40180008
401900                     END-IF                                       40190008
402000                     IF WS-MDARVS-LBL-SEQ-NBR > ZERO              40200008
402100                         MOVE PC-LBL-CHARTC-CDE                   40210008
402200                                           TO HOLD-CHARTC-CDE     40220008
402300                         MOVE WS-MDARVS-LBL-SEQ-NBR               40230008
402400                                           TO HOLD-CHARTC-SEQ-NBR 40240008
402500                         PERFORM S110-SELECT-VSCHVL               40250008
402600                     END-IF                                       40260008
402700                     IF WS-MDARVS-HNG-FOLD-SEQ-NBR > ZERO         40270008
402800                         MOVE PC-HNG-FLD-CHARTC-CDE               40280008
402900                                           TO HOLD-CHARTC-CDE     40290008
403000                         MOVE WS-MDARVS-HNG-FOLD-SEQ-NBR          40300008
403100                                           TO HOLD-CHARTC-SEQ-NBR 40310008
403200                         PERFORM S110-SELECT-VSCHVL               40320008
403300                     END-IF                                       40330008
403400                     IF WS-MDARVS-KY-CLSN-SEQ-NBR > ZERO          40340008
403500                         MOVE PC-KY-CLSN-CHARTC-CDE               40350008
403600                                           TO HOLD-CHARTC-CDE     40360008
403700                         MOVE WS-MDARVS-KY-CLSN-SEQ-NBR           40370008
403800                                           TO HOLD-CHARTC-SEQ-NBR 40380008
403900                         PERFORM S110-SELECT-VSCHVL               40390008
404000                     END-IF                                       40400008
404100                     IF WS-MDARVS-FBRCN-SEQ-NBR > ZERO            40410008
404200                         MOVE PC-FBRCN-CHARTC-CDE                 40420008
404300                                           TO HOLD-CHARTC-CDE     40430008
404400                         MOVE WS-MDARVS-FBRCN-SEQ-NBR             40440008
404500                                           TO HOLD-CHARTC-SEQ-NBR 40450008
404600                         PERFORM S110-SELECT-VSCHVL               40460008
404700                     END-IF                                       40470008
404800                     IF WS-MDARVS-FNSH-SEQ-NBR > ZERO             40480008
404900                         MOVE PC-FNSH-CHARTC-CDE                  40490008
405000                                           TO HOLD-CHARTC-CDE     40500008
405100                         MOVE WS-MDARVS-FNSH-SEQ-NBR              40510008
405200                                           TO HOLD-CHARTC-SEQ-NBR 40520008
405300                         PERFORM S110-SELECT-VSCHVL               40530008
405400                     END-IF                                       40540008
405500                     IF WS-MDARVS-RTL-CLSN-SEQ-NBR > ZERO         40550008
405600                         MOVE PC-RTL-CLSN-CHARTC-CDE              40560008
405700                                           TO HOLD-CHARTC-CDE     40570008
405800                         MOVE WS-MDARVS-RTL-CLSN-SEQ-NBR          40580008
405900                                           TO HOLD-CHARTC-SEQ-NBR 40590008
406000                         PERFORM S110-SELECT-VSCHVL               40600008
406100                     END-IF                                       40610008
406200                     IF WS-MDARVS-ESL-SEQ-NBR > ZERO              40620008
406300                         MOVE PC-ESL-CHARTC-CDE                   40630008
406400                                           TO HOLD-CHARTC-CDE     40640008
406500                         MOVE WS-MDARVS-ESL-SEQ-NBR               40650008
406600                                           TO HOLD-CHARTC-SEQ-NBR 40660008
406700                         PERFORM S110-SELECT-VSCHVL               40670008
406800                     END-IF                                       40680008
406900                     IF WS-MDARVS-RPT-HIER-SEQ-NBR > ZERO         40690008
407000                         MOVE PC-RPT-HIER-CHARTC-CDE              40700008
407100                                           TO HOLD-CHARTC-CDE     40710008
407200                         MOVE WS-MDARVS-RPT-HIER-SEQ-NBR          40720008
407300                                           TO HOLD-CHARTC-SEQ-NBR 40730008
407400                         PERFORM S110-SELECT-VSCHVL               40740008
407500                     END-IF                                       40750008
407600                     IF WS-MDARVS-BDY-STYL-SEQ-NBR > ZERO         40760008
407700                         MOVE PC-BDY-STYL-CHARTC-CDE              40770008
407800                                           TO HOLD-CHARTC-CDE     40780008
407900                         MOVE WS-MDARVS-BDY-STYL-SEQ-NBR          40790008
408000                                           TO HOLD-CHARTC-SEQ-NBR 40800008
408100                         PERFORM S110-SELECT-VSCHVL               40810008
408200                     END-IF                                       40820008
408300                     IF WS-MDARVS-CONST-SEQ-NBR > ZERO            40830008
408400                         MOVE PC-CONST-CHARTC-CDE                 40840008
408500                                           TO HOLD-CHARTC-CDE     40850008
408600                         MOVE WS-MDARVS-CONST-SEQ-NBR             40860008
408700                                           TO HOLD-CHARTC-SEQ-NBR 40870008
408800                         PERFORM S110-SELECT-VSCHVL               40880008
408900                     END-IF                                       40890008
409000                     IF WS-MDARVS-FUNC-SEQ-NBR > ZERO             40900008
409100                         MOVE PC-FUNC-CHARTC-CDE                  40910008
409200                                           TO HOLD-CHARTC-CDE     40920008
409300                         MOVE WS-MDARVS-FUNC-SEQ-NBR              40930008
409400                                           TO HOLD-CHARTC-SEQ-NBR 40940008
409500                         PERFORM S110-SELECT-VSCHVL               40950008
409600                     END-IF                                       40960008
409700                     IF WS-MDARVS-GNDR-SEQ-NBR > ZERO             40970008
409800                         MOVE PC-GNDR-CHARTC-CDE                  40980008
409900                                           TO HOLD-CHARTC-CDE     40990008
410000                         MOVE WS-MDARVS-GNDR-SEQ-NBR              41000008
410100                                           TO HOLD-CHARTC-SEQ-NBR 41010008
410200                         PERFORM S110-SELECT-VSCHVL               41020008
410300                     END-IF                                       41030008
410400                     IF WS-MDARVS-PATRN-SEQ-NBR > ZERO            41040008
410500                         MOVE PC-PATRN-CHARTC-CDE                 41050008
410600                                           TO HOLD-CHARTC-CDE     41060008
410700                         MOVE WS-MDARVS-PATRN-SEQ-NBR             41070008
410800                                           TO HOLD-CHARTC-SEQ-NBR 41080008
410900                         PERFORM S110-SELECT-VSCHVL               41090008
411000                     END-IF                                       41100008
411100                     IF WS-MDARVS-SLHTT-SEQ-NBR > ZERO            41110008
411200                         MOVE PC-SLHTT-CHARTC-CDE                 41120008
411300                                           TO HOLD-CHARTC-CDE     41130008
411400                         MOVE WS-MDARVS-SLHTT-SEQ-NBR             41140008
411500                                           TO HOLD-CHARTC-SEQ-NBR 41150008
411600                         PERFORM S110-SELECT-VSCHVL               41160008
411700                     END-IF                                       41170008
411800                     IF WS-MDARVS-CLLCTN-SEQ-NBR > ZERO           41180008
411900                         MOVE PC-CLLCTN-CHARTC-CDE                41190008
412000                                           TO HOLD-CHARTC-CDE     41200008
412100                         MOVE WS-MDARVS-CLLCTN-SEQ-NBR            41210008
412200                                           TO HOLD-CHARTC-SEQ-NBR 41220008
412300                         PERFORM S110-SELECT-VSCHVL               41230008
412400                     END-IF                                       41240008
412500                     IF WS-MDARVS-FSHN-PYRMD-SEQ-NBR > ZEROS      41250008
412600                         MOVE PC-FSHN-PYRMD-CHARTC-CDE            41260008
412700                                           TO HOLD-CHARTC-CDE     41270008
412800                         MOVE WS-MDARVS-FSHN-PYRMD-SEQ-NBR        41280008
412900                                           TO HOLD-CHARTC-SEQ-NBR 41290008
413000                         PERFORM S110-SELECT-VSCHVL               41300008
413100                     END-IF                                       41310008
413200                     IF WS-MDARVS-CTG-SEQ-NBR > ZEROS             41320008
413300                         MOVE PC-CTG-CHARTC-CDE                   41330008
413400                                           TO HOLD-CHARTC-CDE     41340008
413500                         MOVE WS-MDARVS-CTG-SEQ-NBR               41350008
413600                                           TO HOLD-CHARTC-SEQ-NBR 41360008
413700                         PERFORM S110-SELECT-VSCHVL               41370008
413800                     END-IF                                       41380008
413900                     IF WS-MDARVS-MAJ-CTG-SEQ-NBR  > ZEROS        41390008
414000                         MOVE PC-MAJ-CTG-CHARTC-CDE               41400008
414100                                           TO HOLD-CHARTC-CDE     41410008
414200                         MOVE WS-MDARVS-MAJ-CTG-SEQ-NBR           41420008
414300                                           TO HOLD-CHARTC-SEQ-NBR 41430008
414400                         PERFORM S110-SELECT-VSCHVL               41440008
414500                     END-IF                                       41450008
414600                     IF WS-MDARVS-MTRL-SEQ-NBR  > ZEROS           41460008
414700                         MOVE PC-MTRL-CHARTC-CDE                  41470008
414800                                           TO HOLD-CHARTC-CDE     41480008
414900                         MOVE WS-MDARVS-MTRL-SEQ-NBR              41490008
415000                                           TO HOLD-CHARTC-SEQ-NBR 41500008
415100                         PERFORM S110-SELECT-VSCHVL               41510008
415200                     END-IF                                       41520008
415300                     IF WS-MDARVS-PRIM-TRND-SEQ-NBR > ZEROS       41530008
415400                         MOVE PC-PRIM-TRND-CHARTC-CDE             41540008
415500                                           TO HOLD-CHARTC-CDE     41550008
415600                         MOVE WS-MDARVS-PRIM-TRND-SEQ-NBR         41560008
415700                                           TO HOLD-CHARTC-SEQ-NBR 41570008
415800                         PERFORM S110-SELECT-VSCHVL               41580008
415900                     END-IF                                       41590008
416000                     IF WS-MDARVS-SEC-TRND-SEQ-NBR > ZEROS        41600008
416100                         MOVE PC-SEC-TRND-CHARTC-CDE              41610008
416200                                           TO HOLD-CHARTC-CDE     41620008
416300                         MOVE WS-MDARVS-SEC-TRND-SEQ-NBR          41630008
416400                                           TO HOLD-CHARTC-SEQ-NBR 41640008
416500                         PERFORM S110-SELECT-VSCHVL               41650008
416600                     END-IF                                       41660008
416700                     IF WS-MDARVS-ATTR-1-SEQ-NBR > ZEROS          41670008
416800                         MOVE PC-ATTR-1-CHARTC-CDE                41680008
416900                                           TO HOLD-CHARTC-CDE     41690008
417000                         MOVE WS-MDARVS-ATTR-1-SEQ-NBR            41700008
417100                                           TO HOLD-CHARTC-SEQ-NBR 41710008
417200                         PERFORM S110-SELECT-VSCHVL               41720008
417300                     END-IF                                       41730008
417400                     IF WS-MDARVS-ATTR-2-SEQ-NBR > ZEROS          41740008
417500                         MOVE PC-ATTR-2-CHARTC-CDE                41750008
417600                                           TO HOLD-CHARTC-CDE     41760008
417700                         MOVE WS-MDARVS-ATTR-2-SEQ-NBR            41770008
417800                                           TO HOLD-CHARTC-SEQ-NBR 41780008
417900                         PERFORM S110-SELECT-VSCHVL               41790008
418000                     END-IF                                       41800008
418100                     IF WS-MDARVS-NW-SLHTT-SEQ-NBR >  ZEROS       41810008
418200                         MOVE PC-NW-SLHTT-CHARTC-CDE              41820008
418300                                           TO HOLD-CHARTC-CDE     41830008
418400                         MOVE WS-MDARVS-NW-SLHTT-SEQ-NBR          41840008
418500                                           TO HOLD-CHARTC-SEQ-NBR 41850008
418600                         PERFORM S110-SELECT-VSCHVL               41860008
418700                     END-IF                                       41870008
418800                 END-IF                                           41880008
418900                 MOVE 'IMT_LBL' TO DS009-PROCESS-TABLE            41890008
419000                 PERFORM DS002-DO-PROCESS                         41900008
419100                 IF DS009-DO-PROCESS                              41910008
419200                     IF WS-MDARVS-LBL-SEQ-NBR > ZERO              41920008
419300                         MOVE WS-MDARVS-LBL-SEQ-NBR               41930008
419400                               TO DS010-LBL-SEQ-NBR               41940008
419500                         PERFORM S120-SELECT-IMT-LBL              41950008
419600                     END-IF                                       41960008
419700                 END-IF                                           41970008
419800                                                                  41980008
419900                                                                  41990008
420000            WHEN SQLCODE = +100                                   42000008
420100                 SET NO-MORE-MDARVS-DATA  TO TRUE                 42010008
420200            WHEN SQLCODE = -904                                   42020008
420300            WHEN SQLCODE = -913                                   42030008
420400              CONTINUE                                            42040008
420500           END-EVALUATE                                           42050008
420600         END-PERFORM.                                             42060008
420700*                                                                 42070008
420800     PERFORM DS002-SQL-ABEND-FETCH.                               42080008
420900/                                                                 42090008
421000 R100-FETCH-SKXREF.                                               42100008
421100*                                                                 42110008
421200     INITIALIZE     WS-SKXREF.                                    42120008
421300     MOVE 'TSKXREF' TO DS009-PROCESS-TABLE.                       42130008
421400     PERFORM WITH TEST AFTER                                      42140008
421500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   42150008
421600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        42160008
421700                SQLCODE = ZERO OR                                 42170008
421800                SQLCODE = +100                                    42180008
421900        EXEC SQL                                                  42190008
422000            FETCH SKXREF_CSR                                      42200008
422100            INTO                                                  42210008
422200             :WS-SKXREF-DEPT-NBR                                  42220008
422300            ,:WS-SKXREF-CL-NBR                                    42230008
422400            ,:WS-SKXREF-SKU-SEQ-NBR                               42240008
422500            ,:WS-SKXREF-SKU-STAT-CDE                              42250008
422600            ,:WS-SKXREF-ITM-NBR                                   42260008
422700            ,:WS-SKXREF-INTR-UPC-ID                               42270008
422800            ,:WS-SKXREF-DEPT                                      42280008
422900            ,:WS-SKXREF-CLASS                                     42290008
423000            ,:WS-SKXREF-SUBCLASS                                  42300008
423100            ,:WS-SKXREF-SKU                                       42310008
423200        END-EXEC                                                  42320008
423300                                                                  42330008
423400        EVALUATE TRUE                                             42340008
423500            WHEN SQLCODE = ZERO OR -305                           42350008
423600                 MOVE LENGTH OF WS-SKXREF TO DS009-TBLE-DATA-SIZE 42360008
423700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 42370008
423800                                           + DS009-RECORD-FILLER  42380008
423900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     42390008
424000                 MOVE 'TSKXREF'           TO DS002-NAME           42400008
424100                 PERFORM DS002-FIND-SEQUENCE                      42410008
424200                 MOVE WS-SKXREF           TO DS002-DATA-ITEM      42420008
424300                 INITIALIZE DS009-PKYS                            42430008
424400                 PERFORM DS002-PROCESS-KEYS                       42440008
424500                 MOVE WS-SKXREF-KEYS  TO DS009-PKYS               42450008
424600                 MOVE DS009-PKYS      TO DS002-KEYS               42460008
424700                 PERFORM 8000-WRITE-UNLOAD                        42470008
424800            WHEN SQLCODE = +100                                   42480008
424900                 SET NO-MORE-SKXREF-DATA  TO TRUE                 42490008
425000            WHEN SQLCODE = -904                                   42500008
425100            WHEN SQLCODE = -913                                   42510008
425200              CONTINUE                                            42520008
425300           END-EVALUATE                                           42530008
425400         END-PERFORM.                                             42540008
425500*                                                                 42550008
425600     PERFORM DS002-SQL-ABEND-FETCH.                               42560008
425700/                                                                 42570008
425800 R100-FETCH-MESTDS.                                               42580008
425900*                                                                 42590008
426000     MOVE 'TMESTDS' TO DS009-PROCESS-TABLE.                       42600008
426100     PERFORM WITH TEST AFTER                                      42610008
426200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   42620008
426300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        42630008
426400                SQLCODE = ZERO OR                                 42640008
426500                SQLCODE = +100                                    42650008
426600        EXEC SQL                                                  42660008
426700            FETCH MESTDS_CSR                                      42670008
426800            INTO                                                  42680008
426900                 :WS-MESTDS                                       42690008
427000        END-EXEC                                                  42700008
427100                                                                  42710008
427200        EVALUATE TRUE                                             42720008
427300            WHEN SQLCODE = ZERO OR -305                           42730008
427400                 MOVE LENGTH OF WS-MESTDS TO DS009-TBLE-DATA-SIZE 42740008
427500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 42750008
427600                                        + DS009-RECORD-FILLER     42760008
427700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     42770008
427800                 MOVE 'TMESTDS'            TO DS002-NAME          42780008
427900                 PERFORM DS002-FIND-SEQUENCE                      42790008
428000                 MOVE WS-MESTDS            TO DS002-DATA-ITEM     42800008
428100                 INITIALIZE DS009-PKYS                            42810008
428200                 PERFORM DS002-PROCESS-KEYS                       42820008
428300                 MOVE WS-MESTDS-KEYS TO DS009-PKYS                42830008
428400                 MOVE DS009-PKYS  TO DS002-KEYS                   42840008
428500                 PERFORM 8000-WRITE-UNLOAD                        42850008
428600                                                                  42860008
428700            WHEN SQLCODE = +100                                   42870008
428800                 SET NO-MORE-MESTDS-DATA  TO TRUE                 42880008
428900            WHEN SQLCODE = -904                                   42890008
429000            WHEN SQLCODE = -913                                   42900008
429100              CONTINUE                                            42910008
429200           END-EVALUATE                                           42920008
429300         END-PERFORM.                                             42930008
429400*                                                                 42940008
429500     PERFORM DS002-SQL-ABEND-FETCH.                               42950008
429600/                                                                 42960008
429700 R100-FETCH-EXTENT.                                               42970008
429800*                                                                 42980008
429900     MOVE 'TEXTENT' TO DS009-PROCESS-TABLE.                       42990008
430000     PERFORM WITH TEST AFTER                                      43000008
430100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   43010008
430200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        43020008
430300                SQLCODE = ZERO OR                                 43030008
430400                SQLCODE = +100                                    43040008
430500        EXEC SQL                                                  43050008
430600            FETCH EXTENT_CSR                                      43060008
430700            INTO                                                  43070008
430800                :WS-EXTENT                                        43080008
430900        END-EXEC                                                  43090008
431000*                                                                 43100008
431100*       EXEC SQL                                                  43110008
431200*           FETCH EXTENT_CSR                                      43120008
431300*           INTO                                                  43130008
431400*               :WS-EXTENT-ENT-ID                                 43140008
431500*              ,:WS-EXTENT-SCAC-CDE                               43150008
431600*              ,:WS-EXTENT-DUN-NBR                                43160008
431700*              ,:WS-EXTENT-ASN-TRSCP-IND                          43170008
431800*JS            ,:WS-EXTENT-CONSDT-PKSL-IND                        43180008
431900*JS            ,:WS-EXTENT-ASN-PO-RU-IND                          43190008
432000*              ,:WS-EXTENT-FED-EXPRESS-NBR                        43200008
432100*              ,:WS-EXTENT-MDSE-VENDOR-IND                        43210008
432200*              ,:WS-EXTENT-CARRIER-IND                            43220008
432300*              ,:WS-EXTENT-STATUS-CDE                             43230008
432400*              ,:WS-EXTENT-CARR-MAN-PRO-IND                       43240008
432500*              ,:WS-EXTENT-EDI214-TEST-IND                        43250008
432600*              ,:WS-EXTENT-IMPRT-IND                              43260008
432700*              ,:WS-EXTENT-SHIP-INSTR-LT-QTY                      43270008
432800*              ,:WS-EXTENT-SHIP-INSTR-REQD                        43280008
432900*              ,:WS-EXTENT-EXP-VEND-IND                           43290008
433000*              ,:WS-EXTENT-NEED-1099-IND                          43300008
433100*              ,:WS-EXTENT-CRE-BY-UID                             43310008
433200*              ,:WS-EXTENT-CRE-TMST                               43320008
433300*              ,:WS-EXTENT-LAST-UPD-BY-UID                        43330008
433400*              ,:WS-EXTENT-LAST-UPD-TMST                          43340008
433500*              ,:WS-EXTENT-CFY-SLSRNK-NBR                         43350008
433600*              ,:WS-EXTENT-PFY-SLSRNK-NBR                         43360008
433700*              ,:WS-EXTENT-CRE-ASN-FCST-IND                       43370008
433800*              ,:WS-EXTENT-CRE-SHIPT-FCST-IND                     43380008
433900*              ,:WS-EXTENT-STR-DISTRO-LT-QTY                      43390008
434000*              ,:WS-EXTENT-VLD-CART-LBL-IND                       43400008
434100*              ,:WS-EXTENT-PRNT-CO-ENT-ID                         43410008
434200*              ,:WS-EXTENT-VND-CLSN-CDE                           43420008
434300*              ,:WS-EXTENT-VND-PRSST-CDE                          43430008
434400*              ,:WS-EXTENT-FED-TX-ID-TYP-CDE                      43440008
434500*              ,:WS-EXTENT-FED-TX-ID-NBR                          43450008
434600*              ,:WS-EXTENT-FCTR-IND                               43460008
434700*              ,:WS-EXTENT-PRNT-CO-IND                            43470008
434800*              ,:WS-EXTENT-CAP-EXP-CDE                            43480008
434900*              ,:WS-EXTENT-HLD-PAYT-IND                           43490008
435000*              ,:WS-EXTENT-PAY-FCTR-VND-IND                       43500008
435100*              ,:WS-EXTENT-SEPR-INVC-PAYT-IND                     43510008
435200*              ,:WS-EXTENT-WHLDG-PAYT-TYP-CDE                     43520008
435300*              ,:WS-EXTENT-PAYT-HNDLG-CDE                         43530008
435400*       END-EXEC                                                  43540008
435500                                                                  43550008
435600        EVALUATE TRUE                                             43560008
435700            WHEN SQLCODE = ZERO OR -305                           43570008
435800                 MOVE LENGTH OF WS-EXTENT TO DS009-TBLE-DATA-SIZE 43580008
435900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 43590008
436000                                        + DS009-RECORD-FILLER     43600008
436100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     43610008
436200                 MOVE 'TEXTENT'            TO DS002-NAME          43620008
436300                 PERFORM DS002-FIND-SEQUENCE                      43630008
436400                 MOVE WS-EXTENT            TO DS002-DATA-ITEM     43640008
436500                 INITIALIZE DS009-PKYS                            43650008
436600                 PERFORM DS002-PROCESS-KEYS                       43660008
436700                 MOVE WS-EXTENT-KEYS      TO DS009-PKYS           43670008
436800                 MOVE DS009-PKYS          TO DS002-KEYS           43680008
436900                 PERFORM 8000-WRITE-UNLOAD                        43690008
437000                                                                  43700008
437100            WHEN SQLCODE = +100                                   43710008
437200                 SET NO-MORE-EXTENT-DATA  TO TRUE                 43720008
437300            WHEN SQLCODE = -904                                   43730008
437400            WHEN SQLCODE = -913                                   43740008
437500              CONTINUE                                            43750008
437600           END-EVALUATE                                           43760008
437700         END-PERFORM.                                             43770008
437800*                                                                 43780008
437900     PERFORM DS002-SQL-ABEND-FETCH.                               43790008
438000/                                                                 43800008
438100 R100-FETCH-ENTNME.                                               43810008
438200*                                                                 43820008
438300     MOVE 'TENTNME' TO DS009-PROCESS-TABLE.                       43830008
438400     PERFORM WITH TEST AFTER                                      43840008
438500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   43850008
438600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        43860008
438700                SQLCODE = ZERO OR                                 43870008
438800                SQLCODE = +100                                    43880008
438900        EXEC SQL                                                  43890008
439000            FETCH ENTNME_CSR                                      43900008
439100            INTO                                                  43910008
439200                 :WS-ENTNME                                       43920008
439300        END-EXEC                                                  43930008
439400                                                                  43940008
439500        EVALUATE TRUE                                             43950008
439600            WHEN SQLCODE = ZERO OR -305                           43960008
439700                 MOVE LENGTH OF WS-ENTNME TO DS009-TBLE-DATA-SIZE 43970008
439800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 43980008
439900                                        + DS009-RECORD-FILLER     43990008
440000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     44000008
440100                 MOVE 'TENTNME'            TO DS002-NAME          44010008
440200                 PERFORM DS002-FIND-SEQUENCE                      44020008
440300                 MOVE WS-ENTNME            TO DS002-DATA-ITEM     44030008
440400                 INITIALIZE DS009-PKYS                            44040008
440500                 PERFORM DS002-PROCESS-KEYS                       44050008
440600                 MOVE WS-ENTNME-KEYS      TO DS009-PKYS           44060008
440700                 MOVE DS009-PKYS          TO DS002-KEYS           44070008
440800                 PERFORM 8000-WRITE-UNLOAD                        44080008
440900                                                                  44090008
441000            WHEN SQLCODE = +100                                   44100008
441100                 SET NO-MORE-ENTNME-DATA  TO TRUE                 44110008
441200            WHEN SQLCODE = -904                                   44120008
441300            WHEN SQLCODE = -913                                   44130008
441400              CONTINUE                                            44140008
441500           END-EVALUATE                                           44150008
441600         END-PERFORM.                                             44160008
441700*                                                                 44170008
441800     PERFORM DS002-SQL-ABEND-FETCH.                               44180008
441900/                                                                 44190008
442000 R100-FETCH-VNDDPT.                                               44200008
442100*                                                                 44210008
442200     MOVE 'TVNDDPT' TO DS009-PROCESS-TABLE.                       44220008
442300     PERFORM WITH TEST AFTER                                      44230008
442400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   44240008
442500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        44250008
442600                SQLCODE = ZERO OR                                 44260008
442700                SQLCODE = +100                                    44270008
442800        EXEC SQL                                                  44280008
442900            FETCH VNDDPT_CSR                                      44290008
443000            INTO                                                  44300008
443100                 :WS-VNDDPT                                       44310008
443200        END-EXEC                                                  44320008
443300                                                                  44330008
443400        EVALUATE TRUE                                             44340008
443500            WHEN SQLCODE = ZERO OR -305                           44350008
443600                 MOVE LENGTH OF WS-VNDDPT TO DS009-TBLE-DATA-SIZE 44360008
443700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 44370008
443800                                        + DS009-RECORD-FILLER     44380008
443900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     44390008
444000                 MOVE 'TVNDDPT'            TO DS002-NAME          44400008
444100                 PERFORM DS002-FIND-SEQUENCE                      44410008
444200                 MOVE WS-VNDDPT            TO DS002-DATA-ITEM     44420008
444300                 INITIALIZE DS009-PKYS                            44430008
444400                 PERFORM DS002-PROCESS-KEYS                       44440008
444500                 MOVE WS-VNDDPT-KEYS      TO DS009-PKYS           44450008
444600                 MOVE DS009-PKYS          TO DS002-KEYS           44460008
444700                 PERFORM 8000-WRITE-UNLOAD                        44470008
444800                                                                  44480008
444900            WHEN SQLCODE = +100                                   44490008
445000                 SET NO-MORE-VNDDPT-DATA  TO TRUE                 44500008
445100            WHEN SQLCODE = -904                                   44510008
445200            WHEN SQLCODE = -913                                   44520008
445300              CONTINUE                                            44530008
445400           END-EVALUATE                                           44540008
445500         END-PERFORM.                                             44550008
445600*                                                                 44560008
445700     PERFORM DS002-SQL-ABEND-FETCH.                               44570008
445800/                                                                 44580008
445900 R100-FETCH-INSTCD.                                               44590008
446000*                                                                 44600008
446100     MOVE 'TINSTCD' TO DS009-PROCESS-TABLE.                       44610008
446200     PERFORM WITH TEST AFTER                                      44620008
446300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   44630008
446400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        44640008
446500                SQLCODE = ZERO OR                                 44650008
446600                SQLCODE = +100                                    44660008
446700        EXEC SQL                                                  44670008
446800            FETCH INSTCD_CSR                                      44680008
446900            INTO                                                  44690008
447000                 :WS-INSTCD                                       44700008
447100        END-EXEC                                                  44710008
447200                                                                  44720008
447300        EVALUATE TRUE                                             44730008
447400            WHEN SQLCODE = ZERO OR -305                           44740008
447500                 MOVE LENGTH OF WS-INSTCD TO DS009-TBLE-DATA-SIZE 44750008
447600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 44760008
447700                                        + DS009-RECORD-FILLER     44770008
447800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     44780008
447900                 MOVE 'TINSTCD'            TO DS002-NAME          44790008
448000                 PERFORM DS002-FIND-SEQUENCE                      44800008
448100                 MOVE WS-INSTCD            TO DS002-DATA-ITEM     44810008
448200                 INITIALIZE DS009-PKYS                            44820008
448300                 PERFORM DS002-PROCESS-KEYS                       44830008
448400                 MOVE WS-INSTCD-KEYS      TO DS009-PKYS           44840008
448500                 MOVE DS009-PKYS          TO DS002-KEYS           44850008
448600                 PERFORM 8000-WRITE-UNLOAD                        44860008
448700                                                                  44870008
448800            WHEN SQLCODE = +100                                   44880008
448900                 SET NO-MORE-INSTCD-DATA  TO TRUE                 44890008
449000            WHEN SQLCODE = -904                                   44900008
449100            WHEN SQLCODE = -913                                   44910008
449200              CONTINUE                                            44920008
449300           END-EVALUATE                                           44930008
449400         END-PERFORM.                                             44940008
449500*                                                                 44950008
449600     PERFORM DS002-SQL-ABEND-FETCH.                               44960008
449700/                                                                 44970008
449800*R100-FETCH-SPSTDS.                                               44980008
449900*                                                                 44990008
450000*    MOVE 'TSPSTDS' TO DS009-PROCESS-TABLE.                       45000008
450100*    PERFORM WITH TEST AFTER                                      45010008
450200*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   45020008
450300*       UNTIL   DS009-RETRY-COUNTER > 3 OR                        45030008
450400*               SQLCODE = ZERO OR                                 45040008
450500*               SQLCODE = +100                                    45050008
450600*       EXEC SQL                                                  45060008
450700*           FETCH SPSTDS_CSR                                      45070008
450800*           INTO                                                  45080008
450900*                :WS-SPSTDS                                       45090008
451000*       END-EXEC                                                  45100008
451100*                                                                 45110008
451200*       EVALUATE TRUE                                             45120008
451300*           WHEN SQLCODE = ZERO OR -305                           45130008
451400*                MOVE LENGTH OF WS-SPSTDS TO DS009-TBLE-DATA-SIZE 45140008
451500*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 45150008
451600*                                       + DS009-RECORD-FILLER     45160008
451700*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     45170008
451800*                MOVE 'TSPSTDS'            TO DS002-NAME          45180008
451900*                MOVE WS-SPSTDS            TO DS002-DATA-ITEM     45190008
452000*                INITIALIZE DS009-PKYS                            45200008
452100*                PERFORM DS002-PROCESS-KEYS                       45210008
452200*                MOVE WS-SPSTDS-KEYS      TO DS009-PKYS           45220008
452300*                MOVE DS009-PKYS          TO DS002-KEYS           45230008
452400*                PERFORM 8000-WRITE-UNLOAD                        45240008
452500*                                                                 45250008
452600*           WHEN SQLCODE = +100                                   45260008
452700*                SET NO-MORE-SPSTDS-DATA  TO TRUE                 45270008
452800*           WHEN SQLCODE = -904                                   45280008
452900*           WHEN SQLCODE = -913                                   45290008
453000*             CONTINUE                                            45300008
453100*          END-EVALUATE                                           45310008
453200*        END-PERFORM.                                             45320008
453300*                                                                 45330008
453400*    PERFORM DS002-SQL-ABEND-FETCH.                               45340008
453500/                                                                 45350008
453600 R100-FETCH-TRBNTF.                                               45360008
453700*                                                                 45370008
453800     MOVE 'TTRBNTF' TO DS009-PROCESS-TABLE.                       45380008
453900     PERFORM WITH TEST AFTER                                      45390008
454000        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   45400008
454100        UNTIL   DS009-RETRY-COUNTER > 3 OR                        45410008
454200                SQLCODE = ZERO OR                                 45420008
454300                SQLCODE = +100                                    45430008
454400        EXEC SQL                                                  45440008
454500            FETCH TRBNTF_CSR                                      45450008
454600            INTO                                                  45460008
454700                 :WS-TRBNTF-NOTIF-NBR                             45470008
454800                ,:WS-TRBNTF-OPER-UNT-ID                           45480008
454900                ,:WS-TRBNTF-FCLTY-ID                              45490008
455000                ,:WS-TRBNTF-DEPT-NBR                              45500008
455100                ,:WS-TRBNTF-ENT-ID                                45510008
455200                ,:WS-TRBNTF-PO-NBR                                45520008
455300                ,:WS-TRBNTF-PO-LNE-NBR                            45530008
455400                ,:WS-TRBNTF-REC-SEQ-NBR                           45540008
455500                ,:WS-TRBNTF-TRBL-RSN-CDE                          45550008
455600                ,:WS-TRBNTF-NOTIF-TMST                            45560008
455700                ,:WS-TRBNTF-NOTIF-UID                             45570008
455800                ,:WS-TRBNTF-RESOLVED-IND                          45580008
455900                ,:WS-TRBNTF-RESOLVED-TMST                         45590008
456000                ,:WS-TRBNTF-RESOLVED-UID                          45600008
456100                ,:WS-TRBNTF-ACKNOWLG-TMST                         45610008
456200                ,:WS-TRBNTF-ACKNOWLG-UID                          45620008
456300                ,:WS-TRBNTF-CNTCT-EXT                             45630008
456400                ,:WS-TRBNTF-FCLTY-AREA-ID                         45640008
456500                ,:WS-TRBNTF-OVER-SHT-PCT                          45650008
456600                ,:WS-TRBNTF-LAST-DTL-CRE-TMST                     45660008
456700                ,:WS-TRBNTF-CRE-IND                               45670008
456800                ,:WS-TRBNTF-PRORATE-IND                           45680008
456900                ,:WS-TRBNTF-RTV-IND                               45690008
457000                ,:WS-TRBNTF-RTV-RESPONSE-TMST                     45700008
457100                ,:WS-TRBNTF-PO-VER-NBR                            45710008
457200                ,:WS-TRBNTF-PO-LNE-VER-NBR                        45720008
457300                ,:WS-TRBNTF-PLN-SHIP-VER-NBR                      45730008
457400                ,:WS-TRBNTF-ERLY-LTE-DAY-QTY                      45740008
457500                ,:WS-TRBNTF-INITR-ID                              45750008
457600                ,:WS-TRBNTF-RSPNB-RSLU-ID                         45760008
457700                ,:WS-TRBNTF-PFMC-TRKG-ID                          45770008
457800                ,:WS-TRBNTF-ACTVY-RSLU-CDE                        45780008
457900                ,:WS-TRBNTF-INITR-ENT-ID                          45790008
458000                ,:WS-02-TRBNTF-FOB-CDE                            45800008
458100                ,:WS-02-TRBNTF-POE-CDE                            45810008
458200                ,:WS-02-TRBNTF-PREPK-ID                           45820008
458300        END-EXEC                                                  45830008
458400                                                                  45840008
458500        EVALUATE TRUE                                             45850008
458600            WHEN SQLCODE = ZERO OR -305                           45860008
458700                 MOVE LENGTH OF WS-TRBNTF TO DS009-TBLE-DATA-SIZE 45870008
458800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 45880008
458900                                        + DS009-RECORD-FILLER     45890008
459000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     45900008
459100                 MOVE 'TTRBNTF'            TO DS002-NAME          45910008
459200                 PERFORM DS002-FIND-SEQUENCE                      45920008
459300                 MOVE WS-TRBNTF            TO DS002-DATA-ITEM     45930008
459400                 INITIALIZE DS009-PKYS                            45940008
459500                 PERFORM DS002-PROCESS-KEYS                       45950008
459600                 MOVE WS-TRBNTF-KEYS      TO DS009-PKYS           45960008
459700                 MOVE DS009-PKYS          TO DS002-KEYS           45970008
459800                 PERFORM 8000-WRITE-UNLOAD                        45980008
459900                                                                  45990008
460000                 MOVE WS-TRBNTF-NOTIF-NBR TO HOLD-NOTIF-NBR       46000008
460100                 MOVE 'TTRBDTL' TO DS009-PROCESS-TABLE            46010008
460200                 PERFORM DS002-DO-PROCESS                         46020008
460300                 IF DS009-DO-PROCESS                              46030008
460400                    SET MORE-TRBDTL-DATA TO TRUE                  46040008
460500                    PERFORM Y100-OPEN-CURSOR                      46050008
460600                    PERFORM R100-FETCH-TRBDTL                     46060008
460700                        UNTIL NO-MORE-TRBDTL-DATA                 46070008
460800                    MOVE 'TTRBDTL' TO DS009-PROCESS-TABLE         46080008
460900                    PERFORM Z100-CLOSE-CURSOR                     46090008
461000                 END-IF                                           46100008
461100                                                                  46110008
461200                 MOVE WS-TRBNTF-NOTIF-NBR TO HOLD-NOTIF-NBR       46120008
461300                 MOVE 'TIMTBKY' TO DS009-PROCESS-TABLE            46130008
461400                 PERFORM DS002-DO-PROCESS                         46140008
461500                 IF DS009-DO-PROCESS                              46150008
461600                    SET MORE-IMTBKY-DATA TO TRUE                  46160008
461700                    PERFORM Y100-OPEN-CURSOR                      46170008
461800                    PERFORM R100-FETCH-IMTBKY                     46180008
461900                        UNTIL NO-MORE-IMTBKY-DATA                 46190008
462000                    MOVE 'TIMTBKY' TO DS009-PROCESS-TABLE         46200008
462100                    PERFORM Z100-CLOSE-CURSOR                     46210008
462200                 END-IF                                           46220008
462300                                                                  46230008
462400            WHEN SQLCODE = +100                                   46240008
462500                 SET NO-MORE-TRBNTF-DATA  TO TRUE                 46250008
462600            WHEN SQLCODE = -904                                   46260008
462700            WHEN SQLCODE = -913                                   46270008
462800              CONTINUE                                            46280008
462900           END-EVALUATE                                           46290008
463000         END-PERFORM.                                             46300008
463100*                                                                 46310008
463200     PERFORM DS002-SQL-ABEND-FETCH.                               46320008
463300/                                                                 46330008
463400 R100-FETCH-TRBDTL.                                               46340008
463500*                                                                 46350008
463600     MOVE 'TTRBDTL' TO DS009-PROCESS-TABLE.                       46360008
463700     PERFORM WITH TEST AFTER                                      46370008
463800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   46380008
463900        UNTIL   DS009-RETRY-COUNTER > 3 OR                        46390008
464000                SQLCODE = ZERO OR                                 46400008
464100                SQLCODE = +100                                    46410008
464200        EXEC SQL                                                  46420008
464300            FETCH TRBDTL_CSR                                      46430008
464400            INTO                                                  46440008
464500                :WS-TRBDTL-NOTIF-NBR                              46450008
464600               ,:WS-TRBDTL-CRE-TMST                               46460008
464700               ,:WS-TRBDTL-CRE-UID                                46470008
464800               ,:WS-TRBDTL-FREEFORM-TEXT                          46480008
464900        END-EXEC                                                  46490008
465000                                                                  46500008
465100        EVALUATE TRUE                                             46510008
465200            WHEN SQLCODE = ZERO OR -305                           46520008
465300                 MOVE LENGTH OF WS-TRBDTL TO DS009-TBLE-DATA-SIZE 46530008
465400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 46540008
465500                                        + DS009-RECORD-FILLER     46550008
465600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     46560008
465700                 MOVE 'TTRBDTL'            TO DS002-NAME          46570008
465800                 PERFORM DS002-FIND-SEQUENCE                      46580008
465900                 MOVE WS-TRBDTL            TO DS002-DATA-ITEM     46590008
466000                 INITIALIZE DS009-PKYS                            46600008
466100                 PERFORM DS002-PROCESS-KEYS                       46610008
466200                 MOVE WS-TRBDTL-KEYS      TO DS009-PKYS           46620008
466300                 MOVE DS009-PKYS          TO DS002-KEYS           46630008
466400                 PERFORM 8000-WRITE-UNLOAD                        46640008
466500                                                                  46650008
466600            WHEN SQLCODE = +100                                   46660008
466700                 SET NO-MORE-TRBDTL-DATA  TO TRUE                 46670008
466800            WHEN SQLCODE = -904                                   46680008
466900            WHEN SQLCODE = -913                                   46690008
467000              CONTINUE                                            46700008
467100           END-EVALUATE                                           46710008
467200         END-PERFORM.                                             46720008
467300*                                                                 46730008
467400     PERFORM DS002-SQL-ABEND-FETCH.                               46740008
467500/                                                                 46750008
467600*R100-FETCH-POUPC.                                                46760010
467700*                                                                 46770008
467800*    MOVE  'TPOUPC'   TO DS009-PROCESS-TABLE.                     46780010
467900*    PERFORM WITH TEST AFTER                                      46790010
468000*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   46800010
468100*       UNTIL   DS009-RETRY-COUNTER > 3 OR                        46810010
468200*               SQLCODE = ZERO OR                                 46820010
468300*               SQLCODE = +100                                    46830010
468400*       EXEC SQL                                                  46840010
468500*           FETCH POUPC-CSR                                       46850010
468600*           INTO                                                  46860010
468700*                :WS-POUPC                                        46870010
468800*       END-EXEC                                                  46880010
468900*                                                                 46890010
469000*       EVALUATE TRUE                                             46900010
469100*           WHEN SQLCODE = ZERO OR -305                           46910010
469200*                MOVE LENGTH OF WS-POUPC TO DS009-TBLE-DATA-SIZE  46920010
469300*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 46930010
469400*                                       + DS009-RECORD-FILLER     46940010
469500*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     46950010
469600*                MOVE 'TPOUPC'             TO DS002-NAME          46960010
469700*                PERFORM DS002-FIND-SEQUENCE                      46970010
469800*                MOVE WS-POUPC             TO DS002-DATA-ITEM     46980010
469900*                INITIALIZE DS009-PKYS                            46990010
470000*                PERFORM DS002-PROCESS-KEYS                       47000010
470100*                MOVE WS-POUPC-KEYS       TO DS009-PKYS           47010010
470200*                MOVE DS009-PKYS          TO DS002-KEYS           47020010
470300*                PERFORM 8000-WRITE-UNLOAD                        47030010
470400*                                                                 47040010
470500*           WHEN SQLCODE = +100                                   47050010
470600*                SET NO-MORE-POUPC-DATA   TO TRUE                 47060010
470700*           WHEN SQLCODE = -904                                   47070010
470800*           WHEN SQLCODE = -913                                   47080010
470900*             CONTINUE                                            47090010
471000*          END-EVALUATE                                           47100010
471100*        END-PERFORM.                                             47110010
471200*                                                                 47120008
471300*    PERFORM DS002-SQL-ABEND-FETCH.                               47130010
471400/                                                                 47140008
471500 R100-FETCH-ALLTMP.                                               47150008
471600*                                                                 47160008
471700     MOVE  'TALLTMP'  TO DS009-PROCESS-TABLE.                     47170008
471800     PERFORM WITH TEST AFTER                                      47180008
471900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   47190008
472000        UNTIL   DS009-RETRY-COUNTER > 3 OR                        47200008
472100                SQLCODE = ZERO OR                                 47210008
472200                SQLCODE = +100                                    47220008
472300        EXEC SQL                                                  47230008
472400            FETCH ALLTMP_CSR                                      47240008
472500            INTO                                                  47250008
472600                 :WS-ALLTMP                                       47260008
472700        END-EXEC                                                  47270008
472800                                                                  47280008
472900        EVALUATE TRUE                                             47290008
473000            WHEN SQLCODE = ZERO OR -305                           47300008
473100                 MOVE LENGTH OF WS-ALLTMP TO DS009-TBLE-DATA-SIZE 47310008
473200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 47320008
473300                                        + DS009-RECORD-FILLER     47330008
473400                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     47340008
473500                 MOVE 'TALLTMP'            TO DS002-NAME          47350008
473600                 PERFORM DS002-FIND-SEQUENCE                      47360008
473700                 MOVE WS-ALLTMP            TO DS002-DATA-ITEM     47370008
473800                 INITIALIZE DS009-PKYS                            47380008
473900                 PERFORM DS002-PROCESS-KEYS                       47390008
474000                 MOVE WS-ALLTMP-KEYS      TO DS009-PKYS           47400008
474100                 MOVE DS009-PKYS          TO DS002-KEYS           47410008
474200                 PERFORM 8000-WRITE-UNLOAD                        47420008
474300                                                                  47430008
474400            WHEN SQLCODE = +100                                   47440008
474500                 SET NO-MORE-ALLTMP-DATA  TO TRUE                 47450008
474600            WHEN SQLCODE = -904                                   47460008
474700            WHEN SQLCODE = -913                                   47470008
474800              CONTINUE                                            47480008
474900           END-EVALUATE                                           47490008
475000         END-PERFORM.                                             47500008
475100*                                                                 47510008
475200     PERFORM DS002-SQL-ABEND-FETCH.                               47520008
475300/                                                                 47530008
475400 R100-FETCH-VNDAGR.                                               47540008
475500*                                                                 47550008
475600     MOVE  'TVNDAGR'  TO DS009-PROCESS-TABLE.                     47560008
475700     PERFORM WITH TEST AFTER                                      47570008
475800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   47580008
475900        UNTIL   DS009-RETRY-COUNTER > 3 OR                        47590008
476000                SQLCODE = ZERO OR                                 47600008
476100                SQLCODE = +100                                    47610008
476200        EXEC SQL                                                  47620008
476300            FETCH VNDAGR_CSR                                      47630008
476400            INTO                                                  47640008
476500                 :WS-VNDAGR-DATA                                  47650008
476600                 :WS-VNDAGR-NULLS                                 47660008
476700        END-EXEC                                                  47670008
476800                                                                  47680008
476900        EVALUATE TRUE                                             47690008
477000            WHEN SQLCODE = ZERO OR -305                           47700008
477100                 MOVE LENGTH OF WS-VNDAGR TO DS009-TBLE-DATA-SIZE 47710008
477200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 47720008
477300                                        + DS009-RECORD-FILLER     47730008
477400                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     47740008
477500                 MOVE 'TVNDAGR'            TO DS002-NAME          47750008
477600                 PERFORM DS002-FIND-SEQUENCE                      47760008
477700                 MOVE WS-VNDAGR            TO DS002-DATA-ITEM     47770008
477800                 INITIALIZE DS009-PKYS                            47780008
477900                 PERFORM DS002-PROCESS-KEYS                       47790008
478000                 MOVE WS-VNDAGR-KEYS      TO DS009-PKYS           47800008
478100                 MOVE DS009-PKYS          TO DS002-KEYS           47810008
478200                 PERFORM 8000-WRITE-UNLOAD                        47820008
478300                                                                  47830008
478400            WHEN SQLCODE = +100                                   47840008
478500                 SET NO-MORE-VNDAGR-DATA  TO TRUE                 47850008
478600            WHEN SQLCODE = -904                                   47860008
478700            WHEN SQLCODE = -913                                   47870008
478800              CONTINUE                                            47880008
478900           END-EVALUATE                                           47890008
479000         END-PERFORM.                                             47900008
479100*                                                                 47910008
479200     PERFORM DS002-SQL-ABEND-FETCH.                               47920008
475300/                                                                 47921018
475400 R100-FETCH-TRDPRT.                                               47922018
475500*                                                                 47923018
475600     MOVE  'TTRDPRT'  TO DS009-PROCESS-TABLE.                     47924018
475700     PERFORM WITH TEST AFTER                                      47925018
475800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   47926018
475900        UNTIL   DS009-RETRY-COUNTER > 3 OR                        47927018
476000                SQLCODE = ZERO OR                                 47928018
476100                SQLCODE = +100                                    47929018
476200        EXEC SQL                                                  47929118
476300            FETCH TRDPRT_CSR                                      47929218
476400            INTO                                                  47929318
476500                 :WS-TRDPRT-DATA                                  47929418
476700        END-EXEC                                                  47929618
476800                                                                  47929718
476900        EVALUATE TRUE                                             47929818
477000            WHEN SQLCODE = ZERO OR -305                           47929918
477100                 MOVE LENGTH OF WS-TRDPRT TO DS009-TBLE-DATA-SIZE 47930018
477200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 47930118
477300                                        + DS009-RECORD-FILLER     47930218
477400                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     47930318
477500                 MOVE 'TTRDPRT'            TO DS002-NAME          47930418
477600                 PERFORM DS002-FIND-SEQUENCE                      47930518
477700                 MOVE WS-TRDPRT            TO DS002-DATA-ITEM     47930618
477800                 INITIALIZE DS009-PKYS                            47930718
477900                 PERFORM DS002-PROCESS-KEYS                       47930818
478000                 MOVE WS-TRDPRT-KEYS      TO DS009-PKYS           47930918
478100                 MOVE DS009-PKYS          TO DS002-KEYS           47931018
478200                 PERFORM 8000-WRITE-UNLOAD                        47931118
459900                                                                  47931223
460000                 MOVE WS-TRDPRT-TP-DKEY TO HOLD-TP-DKEY           47931423
460100                 MOVE 'TFGTRST' TO DS009-PROCESS-TABLE            47931623
460200                 PERFORM DS002-DO-PROCESS                         47931723
460300                 IF DS009-DO-PROCESS                              47931823
460400                    SET MORE-FGTRST-DATA TO TRUE                  47932023
460500                    PERFORM Y100-OPEN-CURSOR                      47932123
460600                    PERFORM R100-FETCH-FGTRST                     47932223
460700                        UNTIL NO-MORE-FGTRST-DATA                 47932323
460800                    MOVE 'TFGTRST' TO DS009-PROCESS-TABLE         47932523
460900                    PERFORM Z100-CLOSE-CURSOR                     47932623
461000                 END-IF                                           47932823
478300                                                                  47932918
460000                 MOVE WS-TRDPRT-TP-DKEY TO HOLD-TP-DKEY           47933023
460100                 MOVE 'TINTTRN' TO DS009-PROCESS-TABLE            47933123
460200                 PERFORM DS002-DO-PROCESS                         47933223
460300                 IF DS009-DO-PROCESS                              47933323
460400                    SET MORE-INTTRN-DATA TO TRUE                  47933423
460500                    PERFORM Y100-OPEN-CURSOR                      47933523
460600                    PERFORM R100-FETCH-INTTRN                     47933623
460700                        UNTIL NO-MORE-INTTRN-DATA                 47933723
460800                    MOVE 'TINTTRN' TO DS009-PROCESS-TABLE         47933823
460900                    PERFORM Z100-CLOSE-CURSOR                     47933923
461000                 END-IF                                           47934123
478300                                                                  47934223
478400            WHEN SQLCODE = +100                                   47934318
478500                 SET NO-MORE-TRDPRT-DATA  TO TRUE                 47934418
478600            WHEN SQLCODE = -904                                   47934518
478700            WHEN SQLCODE = -913                                   47934618
478800              CONTINUE                                            47934718
478900           END-EVALUATE                                           47934818
479000         END-PERFORM.                                             47934918
479100*                                                                 47935018
479200     PERFORM DS002-SQL-ABEND-FETCH.                               47935118
479300/                                                                 47936008
479400*R100-FETCH-PAYREQ.                                               47940008
479500*                                                                 47950008
479600*    MOVE  'TPAYREQ'  TO DS009-PROCESS-TABLE.                     47960008
479700*    PERFORM WITH TEST AFTER                                      47970008
479800*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   47980008
479900*       UNTIL   DS009-RETRY-COUNTER > 3 OR                        47990008
480000*               SQLCODE = ZERO OR                                 48000008
480100*               SQLCODE = +100                                    48010008
480200*       EXEC SQL                                                  48020008
480300*           FETCH PAYREQ_CSR                                      48030008
480400*           INTO                                                  48040008
480500*                :WS-PAYREQ-DATA                                  48050008
480600*                :WS-PAYREQ-NULLS                                 48060008
480700*       END-EXEC                                                  48070008
480800*                                                                 48080008
480900*       EVALUATE TRUE                                             48090008
481000*           WHEN SQLCODE = ZERO OR -305                           48100008
481100*                MOVE LENGTH OF WS-PAYREQ TO DS009-TBLE-DATA-SIZE 48110008
481200*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 48120008
481300*                                       + DS009-RECORD-FILLER     48130008
481400*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     48140008
481500*                MOVE 'TPAYREQ'            TO DS002-NAME          48150008
481600*                PERFORM DS002-FIND-SEQUENCE                      48160008
481700*                MOVE WS-PAYREQ            TO DS002-DATA-ITEM     48170008
481800*                INITIALIZE DS009-PKYS                            48180008
481900*                PERFORM DS002-PROCESS-KEYS                       48190008
482000*                MOVE WS-PAYREQ-KEYS      TO DS009-PKYS           48200008
482100*                MOVE DS009-PKYS          TO DS002-KEYS           48210008
482200*                PERFORM 8000-WRITE-UNLOAD                        48220008
482300*                                                                 48230008
482400*               MOVE WS-PAYREQ-PAYT-REQ-SEQ-NBR                   48240008
482500*                              TO HOLD-PAYT-REQ-SEQ-NBR           48250008
482600*               MOVE 'TINVOIC'   TO DS009-PROCESS-TABLE           48260008
482700*               PERFORM DS002-DO-PROCESS                          48270008
482800*               IF DS009-DO-PROCESS                               48280008
482900*                     SET MORE-INVOIC-DATA TO TRUE                48290008
483000*                     PERFORM Y100-OPEN-CURSOR                    48300008
483100*                     PERFORM R100-FETCH-INVOIC                   48310008
483200*                         UNTIL NO-MORE-INVOIC-DATA               48320008
483300*                     MOVE 'TINVOIC' TO DS009-PROCESS-TABLE       48330008
483400*                     PERFORM Z100-CLOSE-CURSOR                   48340008
483500*               END-IF                                            48350008
483600*                                                                 48360008
483700*               MOVE WS-PAYREQ-PAYT-REQ-SEQ-NBR                   48370008
483800*                              TO HOLD-PAYT-REQ-SEQ-NBR           48380008
483900*               MOVE 'TALCHRG'   TO DS009-PROCESS-TABLE           48390008
484000*               PERFORM DS002-DO-PROCESS                          48400008
484100*               IF DS009-DO-PROCESS                               48410008
484200*                     SET MORE-ALCHRG-DATA TO TRUE                48420008
484300*                     PERFORM Y100-OPEN-CURSOR                    48430008
484400*                     PERFORM R100-FETCH-ALCHRG                   48440008
484500*                         UNTIL NO-MORE-ALCHRG-DATA               48450008
484600*                     MOVE 'TALCHRG' TO DS009-PROCESS-TABLE       48460008
484700*                     PERFORM Z100-CLOSE-CURSOR                   48470008
484800*               END-IF                                            48480008
484900*                                                                 48490008
485000*               MOVE WS-PAYREQ-PAYT-REQ-SEQ-NBR                   48500008
485100*                              TO HOLD-PAYT-REQ-SEQ-NBR           48510008
485200*               MOVE 'TPREQIT'   TO DS009-PROCESS-TABLE           48520008
485300*               PERFORM DS002-DO-PROCESS                          48530008
485400*               IF DS009-DO-PROCESS                               48540008
485500*                     SET MORE-PREQIT-DATA TO TRUE                48550008
485600*                     PERFORM Y100-OPEN-CURSOR                    48560008
485700*                     PERFORM R100-FETCH-PREQIT                   48570008
485800*                         UNTIL NO-MORE-PREQIT-DATA               48580008
485900*                     MOVE 'TPREQIT' TO DS009-PROCESS-TABLE       48590008
486000*                     PERFORM Z100-CLOSE-CURSOR                   48600008
486100*               END-IF                                            48610008
486200*                                                                 48620008
486300*           WHEN SQLCODE = +100                                   48630008
486400*                SET NO-MORE-PAYREQ-DATA  TO TRUE                 48640008
486500*           WHEN SQLCODE = -904                                   48650008
486600*           WHEN SQLCODE = -913                                   48660008
486700*             CONTINUE                                            48670008
486800*          END-EVALUATE                                           48680008
486900*        END-PERFORM.                                             48690008
487000*                                                                 48700008
487100*    PERFORM DS002-SQL-ABEND-FETCH.                               48710008
487200/                                                                 48720008
487300 R100-FETCH-INVOIC.                                               48730008
487400*                                                                 48740008
487500     MOVE  'TINVOIC' TO DS009-PROCESS-TABLE.                      48750008
487600     PERFORM WITH TEST AFTER                                      48760008
487700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   48770008
487800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        48780008
487900                SQLCODE = ZERO OR                                 48790008
488000                SQLCODE = +100                                    48800008
488100        EXEC SQL                                                  48810008
488200            FETCH INVOIC_CSR                                      48820008
488300            INTO                                                  48830008
488400                 :WS-INVOIC-DATA                                  48840008
488500                 :WS-INVOIC-NULLS                                 48850008
488600        END-EXEC                                                  48860008
488700                                                                  48870008
488800        EVALUATE TRUE                                             48880008
488900            WHEN SQLCODE = ZERO OR -305                           48890008
489000                 MOVE LENGTH OF WS-INVOIC TO DS009-TBLE-DATA-SIZE 48900008
489100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 48910008
489200                                        + DS009-RECORD-FILLER     48920008
489300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     48930008
489400                 MOVE 'TINVOIC'            TO DS002-NAME          48940008
489500                 PERFORM DS002-FIND-SEQUENCE                      48950008
489600                 MOVE WS-INVOIC            TO DS002-DATA-ITEM     48960008
489700                 INITIALIZE DS009-PKYS                            48970008
489800                 PERFORM DS002-PROCESS-KEYS                       48980008
489900                 MOVE WS-INVOIC-KEYS      TO DS009-PKYS           48990008
490000                 MOVE DS009-PKYS          TO DS002-KEYS           49000008
490100                 PERFORM 8000-WRITE-UNLOAD                        49010008
490200                                                                  49020008
490300            WHEN SQLCODE = +100                                   49030008
490400                 SET NO-MORE-INVOIC-DATA  TO TRUE                 49040008
490500            WHEN SQLCODE = -904                                   49050008
490600            WHEN SQLCODE = -913                                   49060008
490700              CONTINUE                                            49070008
490800           END-EVALUATE                                           49080008
490900         END-PERFORM.                                             49090008
491000*                                                                 49100008
491100     PERFORM DS002-SQL-ABEND-FETCH.                               49110008
491200/                                                                 49120008
491300*R100-FETCH-ALCHRG.                                               49130008
491400*                                                                 49140008
491500*    MOVE  'TALCHRG'  TO DS009-PROCESS-TABLE.                     49150008
491600*    PERFORM WITH TEST AFTER                                      49160008
491700*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   49170008
491800*       UNTIL   DS009-RETRY-COUNTER > 3 OR                        49180008
491900*               SQLCODE = ZERO OR                                 49190008
492000*               SQLCODE = +100                                    49200008
492100*       EXEC SQL                                                  49210008
492200*           FETCH ALCHRG_CSR                                      49220008
492300*           INTO                                                  49230008
492400*                :WS-ALCHRG                                       49240008
492500*       END-EXEC                                                  49250008
492600*                                                                 49260008
492700*       EVALUATE TRUE                                             49270008
492800*           WHEN SQLCODE = ZERO OR -305                           49280008
492900*                MOVE LENGTH OF WS-ALCHRG TO DS009-TBLE-DATA-SIZE 49290008
493000*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 49300008
493100*                                       + DS009-RECORD-FILLER     49310008
493200*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     49320008
493300*                MOVE 'TALCHRG'            TO DS002-NAME          49330008
493400*                MOVE WS-ALCHRG            TO DS002-DATA-ITEM     49340008
493500*                INITIALIZE DS009-PKYS                            49350008
493600*                PERFORM DS002-PROCESS-KEYS                       49360008
493700*                MOVE WS-ALCHRG-KEYS      TO DS009-PKYS           49370008
493800*                MOVE DS009-PKYS          TO DS002-KEYS           49380008
493900*                PERFORM 8000-WRITE-UNLOAD                        49390008
494000*                                                                 49400008
494100*           WHEN SQLCODE = +100                                   49410008
494200*                SET NO-MORE-ALCHRG-DATA  TO TRUE                 49420008
494300*           WHEN SQLCODE = -904                                   49430008
494400*           WHEN SQLCODE = -913                                   49440008
494500*             CONTINUE                                            49450008
494600*          END-EVALUATE                                           49460008
494700*        END-PERFORM.                                             49470008
494800*                                                                 49480008
494900*    PERFORM DS002-SQL-ABEND-FETCH.                               49490008
495000                                                                  49500008
495100 R100-FETCH-PREQIT.                                               49510008
495200*                                                                 49520008
495300     MOVE  'TPREQIT'  TO DS009-PROCESS-TABLE.                     49530008
495400     PERFORM WITH TEST AFTER                                      49540008
495500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   49550008
495600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        49560008
495700                SQLCODE = ZERO OR                                 49570008
495800                SQLCODE = +100                                    49580008
495900        EXEC SQL                                                  49590008
496000            FETCH PREQIT_CSR                                      49600008
496100            INTO                                                  49610008
496200                 :WS-PREQIT                                       49620008
496300        END-EXEC                                                  49630008
496400                                                                  49640008
496500        EVALUATE TRUE                                             49650008
496600            WHEN SQLCODE = ZERO OR -305                           49660008
496700                 MOVE LENGTH OF WS-PREQIT TO DS009-TBLE-DATA-SIZE 49670008
496800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 49680008
496900                                        + DS009-RECORD-FILLER     49690008
497000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     49700008
497100                 MOVE 'TPREQIT'            TO DS002-NAME          49710008
497200                 PERFORM DS002-FIND-SEQUENCE                      49720008
497300                 MOVE WS-PREQIT            TO DS002-DATA-ITEM     49730008
497400                 INITIALIZE DS009-PKYS                            49740008
497500                 PERFORM DS002-PROCESS-KEYS                       49750008
497600                 MOVE WS-PREQIT-KEYS      TO DS009-PKYS           49760008
497700                 MOVE DS009-PKYS          TO DS002-KEYS           49770008
497800                 PERFORM 8000-WRITE-UNLOAD                        49780008
497900                                                                  49790008
498000            WHEN SQLCODE = +100                                   49800008
498100                 SET NO-MORE-PREQIT-DATA  TO TRUE                 49810008
498200            WHEN SQLCODE = -904                                   49820008
498300            WHEN SQLCODE = -913                                   49830008
498400              CONTINUE                                            49840008
498500           END-EVALUATE                                           49850008
498600         END-PERFORM.                                             49860008
498700*                                                                 49870008
498800     PERFORM DS002-SQL-ABEND-FETCH.                               49880008
498900/                                                                 49890008
499000 R100-FETCH-ASNDTL.                                               49900008
499100*                                                                 49910008
499200     MOVE  'TASNDTL'  TO DS009-PROCESS-TABLE.                     49920008
499300     PERFORM WITH TEST AFTER                                      49930008
499400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   49940008
499500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        49950008
499600                SQLCODE = ZERO OR                                 49960008
499700                SQLCODE = +100                                    49970008
499800        EXEC SQL                                                  49980008
499900            FETCH ASNDTL_CSR                                      49990008
500000            INTO                                                  50000008
500100                 :WS-ASNDTL-DATA                                  50010008
500200                 :WS-ASNDTL-NULLS                                 50020008
500300        END-EXEC                                                  50030008
500400                                                                  50040008
500500        EVALUATE TRUE                                             50050008
500600            WHEN SQLCODE = ZERO OR -305                           50060008
500700                 MOVE LENGTH OF WS-ASNDTL TO DS009-TBLE-DATA-SIZE 50070008
500800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 50080008
500900                                        + DS009-RECORD-FILLER     50090008
501000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     50100008
501100                 MOVE 'TASNDTL'            TO DS002-NAME          50110008
501200                 PERFORM DS002-FIND-SEQUENCE                      50120008
501300                 MOVE WS-ASNDTL            TO DS002-DATA-ITEM     50130008
501400                 INITIALIZE DS009-PKYS                            50140008
501500                 PERFORM DS002-PROCESS-KEYS                       50150008
501600                 MOVE WS-ASNDTL-KEYS      TO DS009-PKYS           50160008
501700                 MOVE DS009-PKYS          TO DS002-KEYS           50170008
501800                 PERFORM 8000-WRITE-UNLOAD                        50180008
501900                                                                  50190008
502000            WHEN SQLCODE = +100                                   50200008
502100                 SET NO-MORE-ASNDTL-DATA  TO TRUE                 50210008
502200            WHEN SQLCODE = -904                                   50220008
502300            WHEN SQLCODE = -913                                   50230008
502400              CONTINUE                                            50240008
502500           END-EVALUATE                                           50250008
502600         END-PERFORM.                                             50260008
502700*                                                                 50270008
502800     PERFORM DS002-SQL-ABEND-FETCH.                               50280008
502900/                                                                 50290008
503000 R100-FETCH-ASNORD.                                               50300008
503100*                                                                 50310008
503200     MOVE  'TASNORD'  TO DS009-PROCESS-TABLE.                     50320008
503300     PERFORM WITH TEST AFTER                                      50330008
503400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   50340008
503500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        50350008
503600                SQLCODE = ZERO OR                                 50360008
503700                SQLCODE = +100                                    50370008
503800        EXEC SQL                                                  50380008
503900            FETCH ASNORD_CSR                                      50390008
504000            INTO                                                  50400008
504100                 :WS-ASNORD-DATA                                  50410008
504200                 :WS-ASNORD-NULLS                                 50420008
504300        END-EXEC                                                  50430008
504400                                                                  50440008
504500        EVALUATE TRUE                                             50450008
504600            WHEN SQLCODE = ZERO OR -305                           50460008
504700                 MOVE LENGTH OF WS-ASNORD TO DS009-TBLE-DATA-SIZE 50470008
504800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 50480008
504900                                        + DS009-RECORD-FILLER     50490008
505000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     50500008
505100                 MOVE 'TASNORD'            TO DS002-NAME          50510008
505200                 PERFORM DS002-FIND-SEQUENCE                      50520008
505300                 MOVE WS-ASNORD            TO DS002-DATA-ITEM     50530008
505400                 INITIALIZE DS009-PKYS                            50540008
505500                 PERFORM DS002-PROCESS-KEYS                       50550008
505600                 MOVE WS-ASNORD-KEYS      TO DS009-PKYS           50560008
505700                 MOVE DS009-PKYS          TO DS002-KEYS           50570008
505800                 PERFORM 8000-WRITE-UNLOAD                        50580008
505900                                                                  50590008
506000                 IF WS-ASNORD-ASNHDR-ID NOT =                     50600008
506100                                         HOLD-ASNHDR-ID           50610008
506200                   MOVE WS-ASNORD-ASNHDR-ID TO HOLD-ASNHDR-ID     50620008
506300                   MOVE 'TASNDTL'  TO DS009-PROCESS-TABLE         50630008
506400                   PERFORM DS002-DO-PROCESS                       50640008
506500                   IF DS009-DO-PROCESS                            50650008
506600                      SET MORE-ASNDTL-DATA TO TRUE                50660008
506700                      PERFORM Y100-OPEN-CURSOR                    50670008
506800                      PERFORM R100-FETCH-ASNDTL                   50680008
506900                          UNTIL NO-MORE-ASNDTL-DATA               50690008
507000                      MOVE 'TASNDTL' TO DS009-PROCESS-TABLE       50700008
507100                      PERFORM Z100-CLOSE-CURSOR                   50710008
507200                   END-IF                                         50720008
507300                                                                  50730008
507400                   MOVE WS-ASNORD-ASNHDR-ID TO HOLD-ASNHDR-ID     50740008
507500                   MOVE 'TASNHDR'  TO DS009-PROCESS-TABLE         50750008
507600                   PERFORM DS002-DO-PROCESS                       50760008
507700                   IF DS009-DO-PROCESS                            50770008
507800                      SET MORE-ASNHDR-DATA TO TRUE                50780008
507900                      PERFORM Y100-OPEN-CURSOR                    50790008
508000                      PERFORM R100-FETCH-ASNHDR                   50800008
508100                          UNTIL NO-MORE-ASNHDR-DATA               50810008
508200                      MOVE 'TASNHDR' TO DS009-PROCESS-TABLE       50820008
508300                      PERFORM Z100-CLOSE-CURSOR                   50830008
508400                   END-IF                                         50840008
508500                                                                  50850008
508600                   MOVE WS-ASNORD-ASNHDR-ID TO HOLD-ASNHDR-ID     50860008
508700                   MOVE 'TASCRIT'  TO DS009-PROCESS-TABLE         50870008
508800                   PERFORM DS002-DO-PROCESS                       50880008
508900                   IF DS009-DO-PROCESS                            50890008
509000                      SET MORE-ASCRIT-DATA TO TRUE                50900008
509100                      PERFORM Y100-OPEN-CURSOR                    50910008
509200                      PERFORM R100-FETCH-ASCRIT                   50920008
509300                          UNTIL NO-MORE-ASCRIT-DATA               50930008
509400                      MOVE 'TASCRIT' TO DS009-PROCESS-TABLE       50940008
509500                      PERFORM Z100-CLOSE-CURSOR                   50950008
509600                   END-IF                                         50960008
509700                                                                  50970008
509800                   MOVE WS-ASNORD-ASNHDR-ID TO HOLD-ASNHDR-ID     50980008
509900                   MOVE 'TASNCAR'  TO DS009-PROCESS-TABLE         50990008
510000                   PERFORM DS002-DO-PROCESS                       51000008
510100                   IF DS009-DO-PROCESS                            51010008
510200                      SET MORE-ASNCAR-DATA TO TRUE                51020008
510300                      PERFORM Y100-OPEN-CURSOR                    51030008
510400                      PERFORM R100-FETCH-ASNCAR                   51040008
510500                          UNTIL NO-MORE-ASNCAR-DATA               51050008
510600                      MOVE 'TASNCAR' TO DS009-PROCESS-TABLE       51060008
510700                      PERFORM Z100-CLOSE-CURSOR                   51070008
510800                   END-IF                                         51080008
510900                                                                  51090008
511000                   MOVE WS-ASNORD-ASNHDR-ID TO HOLD-ASNHDR-ID     51100008
511100                   MOVE 'TASDTPL'  TO DS009-PROCESS-TABLE         51110008
511200                   PERFORM DS002-DO-PROCESS                       51120008
511300                   IF DS009-DO-PROCESS                            51130008
511400                      SET DS010-END-ASDTPL-NO TO TRUE             51140008
511500                      PERFORM Y100-OPEN-CURSOR                    51150008
511600                      PERFORM R100-FETCH-ASDTPL                   51160008
511700                          UNTIL DS010-END-ASDTPL-YES              51170008
511800                      MOVE 'TASDTPL' TO DS009-PROCESS-TABLE       51180008
511900                      PERFORM Z100-CLOSE-CURSOR                   51190008
512000                   END-IF                                         51200008
512100                END-IF                                            51210008
512200                                                                  51220008
512300            WHEN SQLCODE = +100                                   51230008
512400                 SET NO-MORE-ASNORD-DATA  TO TRUE                 51240008
512500            WHEN SQLCODE = -904                                   51250008
512600            WHEN SQLCODE = -913                                   51260008
512700              CONTINUE                                            51270008
512800           END-EVALUATE                                           51280008
512900         END-PERFORM.                                             51290008
513000*                                                                 51300008
513100     PERFORM DS002-SQL-ABEND-FETCH.                               51310008
513200/                                                                 51320008
513300 R100-FETCH-ASNHDR.                                               51330008
513400*                                                                 51340008
513500     MOVE  'TASNHDR'  TO DS009-PROCESS-TABLE.                     51350008
513600     PERFORM WITH TEST AFTER                                      51360008
513700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   51370008
513800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        51380008
513900                SQLCODE = ZERO OR                                 51390008
514000                SQLCODE = +100                                    51400008
514100        EXEC SQL                                                  51410008
514200            FETCH ASNHDR_CSR                                      51420008
514300            INTO                                                  51430008
514400                 :WS-ASNHDR-DATA                                  51440008
514500                 :WS-ASNHDR-NULLS                                 51450008
514600        END-EXEC                                                  51460008
514700                                                                  51470008
514800        EVALUATE TRUE                                             51480008
514900            WHEN SQLCODE = ZERO OR -305                           51490008
515000                 MOVE LENGTH OF WS-ASNHDR TO DS009-TBLE-DATA-SIZE 51500008
515100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 51510008
515200                                        + DS009-RECORD-FILLER     51520008
515300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     51530008
515400                 MOVE 'TASNHDR'            TO DS002-NAME          51540008
515500                 PERFORM DS002-FIND-SEQUENCE                      51550008
515600                 MOVE WS-ASNHDR            TO DS002-DATA-ITEM     51560008
515700                 INITIALIZE DS009-PKYS                            51570008
515800                 PERFORM DS002-PROCESS-KEYS                       51580008
515900                 MOVE WS-ASNHDR-KEYS      TO DS009-PKYS           51590008
516000                 MOVE DS009-PKYS          TO DS002-KEYS           51600008
516100                 PERFORM 8000-WRITE-UNLOAD                        51610008
516200                                                                  51620008
516300            WHEN SQLCODE = +100                                   51630008
516400                 SET NO-MORE-ASNHDR-DATA  TO TRUE                 51640008
516500            WHEN SQLCODE = -904                                   51650008
516600            WHEN SQLCODE = -913                                   51660008
516700              CONTINUE                                            51670008
516800           END-EVALUATE                                           51680008
516900         END-PERFORM.                                             51690008
517000*                                                                 51700008
517100     PERFORM DS002-SQL-ABEND-FETCH.                               51710008
517200/                                                                 51720008
517300 R100-FETCH-ASCRIT.                                               51730008
517400*                                                                 51740008
517500     MOVE  'TASCRIT'  TO DS009-PROCESS-TABLE.                     51750008
517600     PERFORM WITH TEST AFTER                                      51760008
517700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   51770008
517800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        51780008
517900                SQLCODE = ZERO OR                                 51790008
518000                SQLCODE = +100                                    51800008
518100        EXEC SQL                                                  51810008
518200            FETCH ASCRIT_CSR                                      51820008
518300            INTO                                                  51830008
518400                 :WS-ASCRIT                                       51840008
518500        END-EXEC                                                  51850008
518600                                                                  51860008
518700        EVALUATE TRUE                                             51870008
518800            WHEN SQLCODE = ZERO OR -305                           51880008
518900                 MOVE LENGTH OF WS-ASCRIT TO DS009-TBLE-DATA-SIZE 51890008
519000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 51900008
519100                                        + DS009-RECORD-FILLER     51910008
519200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     51920008
519300                 MOVE 'TASCRIT'            TO DS002-NAME          51930008
519400                 PERFORM DS002-FIND-SEQUENCE                      51940008
519500                 MOVE WS-ASCRIT            TO DS002-DATA-ITEM     51950008
519600                 INITIALIZE DS009-PKYS                            51960008
519700                 PERFORM DS002-PROCESS-KEYS                       51970008
519800                 MOVE WS-ASCRIT-KEYS      TO DS009-PKYS           51980008
519900                 MOVE DS009-PKYS          TO DS002-KEYS           51990008
520000                 PERFORM 8000-WRITE-UNLOAD                        52000008
520100                                                                  52010008
520200            WHEN SQLCODE = +100                                   52020008
520300                 SET NO-MORE-ASCRIT-DATA  TO TRUE                 52030008
520400            WHEN SQLCODE = -904                                   52040008
520500            WHEN SQLCODE = -913                                   52050008
520600              CONTINUE                                            52060008
520700           END-EVALUATE                                           52070008
520800         END-PERFORM.                                             52080008
520900*                                                                 52090008
521000     PERFORM DS002-SQL-ABEND-FETCH.                               52100008
521100/                                                                 52110008
521200 R100-FETCH-ASNCAR.                                               52120008
521300*                                                                 52130008
521400     MOVE  'TASNCAR'  TO DS009-PROCESS-TABLE.                     52140008
521500     PERFORM WITH TEST AFTER                                      52150008
521600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   52160008
521700        UNTIL   DS009-RETRY-COUNTER > 3 OR                        52170008
521800                SQLCODE = ZERO OR                                 52180008
521900                SQLCODE = +100                                    52190008
522000        EXEC SQL                                                  52200008
522100            FETCH ASNCAR_CSR                                      52210008
522200            INTO                                                  52220008
522300                 :WS-ASNCAR-DATA                                  52230008
522400                 :WS-ASNCAR-NULLS                                 52240008
522500        END-EXEC                                                  52250008
522600                                                                  52260008
522700        EVALUATE TRUE                                             52270008
522800            WHEN SQLCODE = ZERO OR -305                           52280008
522900                 MOVE LENGTH OF WS-ASNCAR TO DS009-TBLE-DATA-SIZE 52290008
523000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 52300008
523100                                        + DS009-RECORD-FILLER     52310008
523200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     52320008
523300                 MOVE 'TASNCAR'            TO DS002-NAME          52330008
523400                 PERFORM DS002-FIND-SEQUENCE                      52340008
523500                 MOVE WS-ASNCAR            TO DS002-DATA-ITEM     52350008
523600                 INITIALIZE DS009-PKYS                            52360008
523700                 PERFORM DS002-PROCESS-KEYS                       52370008
523800                 MOVE WS-ASNCAR-KEYS      TO DS009-PKYS           52380008
523900                 MOVE DS009-PKYS          TO DS002-KEYS           52390008
524000                 PERFORM 8000-WRITE-UNLOAD                        52400008
524100                                                                  52410008
524200            WHEN SQLCODE = +100                                   52420008
524300                 SET NO-MORE-ASNCAR-DATA  TO TRUE                 52430008
524400            WHEN SQLCODE = -904                                   52440008
524500            WHEN SQLCODE = -913                                   52450008
524600              CONTINUE                                            52460008
524700           END-EVALUATE                                           52470008
524800         END-PERFORM.                                             52480008
524900*                                                                 52490008
525000     PERFORM DS002-SQL-ABEND-FETCH.                               52500008
525100/                                                                 52510008
525110/                                                                 52511008
525120 R100-FETCH-ASDTPL.                                               52512008
525130*                                                                 52513008
525140     MOVE  'TASDTPL'  TO DS009-PROCESS-TABLE.                     52514008
525150     PERFORM WITH TEST AFTER                                      52515008
525160        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   52516008
525170        UNTIL   DS009-RETRY-COUNTER > 3 OR                        52517008
525180                SQLCODE = ZERO OR                                 52518008
525190                SQLCODE = +100                                    52519008
525191        EXEC SQL                                                  52519108
525192            FETCH ASDTPL_CSR                                      52519208
525193            INTO                                                  52519308
525195                 :WS-ASDTPL-ASNHDR-ID                             52519508
525196                ,:WS-ASDTPL-ASNDTL-NBR                            52519608
525197                ,:WS-ASDTPL-PO-LN-NBR                             52519708
525198                ,:WS-ASDTPL-ASSOC-QTY                             52519808
525199                ,:WS-ASDTPL-ASDTPL-ALLOC-IND                      52519908
525200                ,:WS-ASDTPL-SHIPT-VAR-QTY                         52520008
525201                ,:WS-ASDTPL-PR-CHG-EFF-DAY-NBR                    52520108
525202                ,:WS-ASDTPL-PR-VAR-IND                            52520208
525203                ,:WS-ASDTPL-PR-DISC-IND                           52520308
525204                ,:WS-ASDTPL-PO-NBR                                52520408
525205                ,:WS-ASDTPL-NULLS                                 52520508
525206        END-EXEC                                                  52520608
525207                                                                  52520708
525208        EVALUATE TRUE                                             52520808
525209            WHEN SQLCODE = ZERO OR -305                           52520908
525210                 MOVE LENGTH OF WS-ASDTPL TO DS009-TBLE-DATA-SIZE 52521008
525211                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 52521108
525212                                        + DS009-RECORD-FILLER     52521208
525213                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     52521308
525214                 MOVE 'TASDTPL'            TO DS002-NAME          52521408
525215                 PERFORM DS002-FIND-SEQUENCE                      52521508
525216                 MOVE WS-ASDTPL            TO DS002-DATA-ITEM     52521608
525217                 INITIALIZE DS009-PKYS                            52521708
525218                 PERFORM DS002-PROCESS-KEYS                       52521808
525219                 MOVE WS-ASDTPL-KEYS      TO DS009-PKYS           52521908
525220                 MOVE DS009-PKYS          TO DS002-KEYS           52522008
525221                 PERFORM 8000-WRITE-UNLOAD                        52522108
525222                                                                  52522208
525223            WHEN SQLCODE = +100                                   52522308
525224                 SET DS010-END-ASDTPL-YES  TO TRUE                52522408
525225            WHEN SQLCODE = -904                                   52522508
525226            WHEN SQLCODE = -913                                   52522608
525227              CONTINUE                                            52522708
525228           END-EVALUATE                                           52522808
525229         END-PERFORM.                                             52522908
525230*                                                                 52523008
525231     PERFORM DS002-SQL-ABEND-FETCH.                               52523108
525232/                                                                 52523208
525233 R100-FETCH-SEASET.                                               52523308
525234*                                                                 52523408
525235     MOVE  'TSEASET'  TO DS009-PROCESS-TABLE.                     52523508
525236     PERFORM WITH TEST AFTER                                      52523608
525237        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   52523708
525238        UNTIL   DS009-RETRY-COUNTER > 3 OR                        52523808
525239                SQLCODE = ZERO OR                                 52523908
525240                SQLCODE = +100                                    52524008
525250        EXEC SQL                                                  52525008
525260            FETCH SEASET_CSR                                      52526008
525270            INTO                                                  52527008
525280                 :WS-SEASET                                       52528008
525290        END-EXEC                                                  52529008
525300                                                                  52530008
525400        EVALUATE TRUE                                             52540008
525500            WHEN SQLCODE = ZERO OR -305                           52550008
525600                 MOVE LENGTH OF WS-SEASET TO DS009-TBLE-DATA-SIZE 52560008
525700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 52570008
525800                                        + DS009-RECORD-FILLER     52580008
525900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     52590008
526000                 MOVE 'TSEASET'            TO DS002-NAME          52600008
526100                 PERFORM DS002-FIND-SEQUENCE                      52610008
526200                 MOVE WS-SEASET            TO DS002-DATA-ITEM     52620008
526300                 INITIALIZE DS009-PKYS                            52630008
526400                 PERFORM DS002-PROCESS-KEYS                       52640008
526500                 MOVE WS-SEASET-KEYS      TO DS009-PKYS           52650008
526600                 MOVE DS009-PKYS          TO DS002-KEYS           52660008
526700                 PERFORM 8000-WRITE-UNLOAD                        52670008
526800                                                                  52680008
526900            WHEN SQLCODE = +100                                   52690008
527000                 SET NO-MORE-SEASET-DATA  TO TRUE                 52700008
527100            WHEN SQLCODE = -904                                   52710008
527200            WHEN SQLCODE = -913                                   52720008
527300              CONTINUE                                            52730008
527400           END-EVALUATE                                           52740008
527500         END-PERFORM.                                             52750008
527600*                                                                 52760008
527700     PERFORM DS002-SQL-ABEND-FETCH.                               52770008
527800/                                                                 52780008
527900 R100-FETCH-SUNAUD.                                               52790008
528000*                                                                 52800008
528100*    DISPLAY ' R100-FETCH-SUNAUD '  HOLD-SHIPT-UNIT-ID            52810008
528200*                        '/' HOLD-AUD-CNTL-NBR                    52820008
528300                                                                  52830008
528400     MOVE  'TSUNAUD'  TO DS009-PROCESS-TABLE.                     52840008
528500     PERFORM WITH TEST AFTER                                      52850008
528600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   52860008
528700        UNTIL   DS009-RETRY-COUNTER > 3 OR                        52870008
528800                SQLCODE = ZERO OR                                 52880008
528900                SQLCODE = +100                                    52890008
529000        EXEC SQL                                                  52900008
529100            FETCH SUNAUD_CSR                                      52910008
529200            INTO                                                  52920008
529300                 :WS-SUNAUD                                       52930008
529400        END-EXEC                                                  52940008
529500                                                                  52950008
529600        EVALUATE TRUE                                             52960008
529700            WHEN SQLCODE = ZERO OR -305                           52970008
529800*              DISPLAY ' R100-FETCH-SUNAUD ' HOLD-AUD-CNTL-NBR    52980008
529900                 MOVE LENGTH OF WS-SUNAUD TO DS009-TBLE-DATA-SIZE 52990008
530000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 53000008
530100                                        + DS009-RECORD-FILLER     53010008
530200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     53020008
530300                 MOVE 'TSUNAUD'            TO DS002-NAME          53030008
530400                 PERFORM DS002-FIND-SEQUENCE                      53040008
530500                 MOVE WS-SUNAUD            TO DS002-DATA-ITEM     53050008
530600                 INITIALIZE DS009-PKYS                            53060008
530700                 PERFORM DS002-PROCESS-KEYS                       53070008
530800                 MOVE WS-SUNAUD-KEYS      TO DS009-PKYS           53080008
530900                 MOVE DS009-PKYS          TO DS002-KEYS           53090008
531000                 PERFORM 8000-WRITE-UNLOAD                        53100008
531100                                                                  53110008
531200            WHEN SQLCODE = +100                                   53120008
531300                 SET NO-MORE-SUNAUD-DATA  TO TRUE                 53130008
531400            WHEN SQLCODE = -904                                   53140008
531500            WHEN SQLCODE = -913                                   53150008
531600              CONTINUE                                            53160008
531700           END-EVALUATE                                           53170008
531800         END-PERFORM.                                             53180008
531900*                                                                 53190008
532000     PERFORM DS002-SQL-ABEND-FETCH.                               53200008
532100/                                                                 53210008
532200 R100-FETCH-SUT00015.                                             53220008
532300*     DISPLAY 'R100-FETCH-SUT00015'.                              53230008
532400*                                                                 53240008
532500     MOVE  'SUT_PO_AUD_REQ'  TO DS009-PROCESS-TABLE.              53250008
532600     PERFORM WITH TEST AFTER                                      53260008
532700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   53270008
532800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        53280008
532900                SQLCODE = ZERO OR                                 53290008
533000                SQLCODE = +100                                    53300008
533100        EXEC SQL                                                  53310008
533200            FETCH SUT00015-CSR                                    53320008
533300            INTO                                                  53330008
533400                :DS008-SUT00015-DATA                              53340008
533500                :DS008-SUT00015-NULLS                             53350008
533600        END-EXEC                                                  53360008
533700                                                                  53370008
533800        EVALUATE TRUE                                             53380008
533900            WHEN SQLCODE = ZERO OR -305                           53390008
534000                 MOVE LENGTH OF DS008-DCLSUT00015                 53400008
534100                              TO DS009-TBLE-DATA-SIZE             53410008
534200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 53420008
534300                                        + DS009-RECORD-FILLER     53430008
534400                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     53440008
534500                 MOVE 'SUT_PO_AUD_REQ'     TO DS002-NAME          53450008
534600                 PERFORM DS002-FIND-SEQUENCE                      53460008
534700                 MOVE DS008-DCLSUT00015    TO DS002-DATA-ITEM     53470008
534800                 INITIALIZE DS009-PKYS                            53480008
534900                 PERFORM DS002-PROCESS-KEYS                       53490008
535000                 MOVE DS008-SUT00015-KEYS TO DS009-PKYS           53500008
535100                 MOVE DS009-PKYS          TO DS002-KEYS           53510008
535200                 PERFORM 8000-WRITE-UNLOAD                        53520008
535300                                                                  53530008
535400            WHEN SQLCODE = +100                                   53540008
535500                 SET NO-MORE-SUT00015-DATA TO TRUE                53550008
535600            WHEN SQLCODE = -904                                   53560008
535700            WHEN SQLCODE = -913                                   53570008
535800              CONTINUE                                            53580008
535900           END-EVALUATE                                           53590008
536000     END-PERFORM.                                                 53600008
536100*                                                                 53610008
536200     PERFORM DS002-SQL-ABEND-FETCH.                               53620008
536300/                                                                 53630008
536400 R100-FETCH-SUATRN.                                               53640008
536500*    DISPLAY 'R100-FETCH-SUATRN'.                                 53650008
536600*                                                                 53660008
536700     MOVE  'TSUATRN'  TO DS009-PROCESS-TABLE.                     53670008
536800*    DISPLAY ' R100-FETCH-SUATRN '  HOLD-SHIPT-UNIT-ID            53680008
536900*                        '/' HOLD-AUD-CNTL-NBR                    53690008
537000     PERFORM WITH TEST AFTER                                      53700008
537100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   53710008
537200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        53720008
537300                SQLCODE = ZERO OR                                 53730008
537400                SQLCODE = +100                                    53740008
537500        EXEC SQL                                                  53750008
537600            FETCH SUATRN_CSR                                      53760008
537700            INTO                                                  53770008
537800                 :WS-SUATRN                                       53780008
537900        END-EXEC                                                  53790008
538000                                                                  53800008
538100        EVALUATE TRUE                                             53810008
538200            WHEN SQLCODE = ZERO OR -305                           53820008
538300*    DISPLAY ' R100-FETCH-SUATRN '  HOLD-SHIPT-UNIT-ID            53830008
538400                 MOVE LENGTH OF WS-SUATRN TO DS009-TBLE-DATA-SIZE 53840008
538500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 53850008
538600                                        + DS009-RECORD-FILLER     53860008
538700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     53870008
538800                 MOVE 'TSUATRN'            TO DS002-NAME          53880008
538900                 PERFORM DS002-FIND-SEQUENCE                      53890008
539000                 MOVE WS-SUATRN            TO DS002-DATA-ITEM     53900008
539100                 INITIALIZE DS009-PKYS                            53910008
539200                 PERFORM DS002-PROCESS-KEYS                       53920008
539300                 MOVE WS-SUATRN-KEYS      TO DS009-PKYS           53930008
539400                 MOVE DS009-PKYS          TO DS002-KEYS           53940008
539500                 PERFORM 8000-WRITE-UNLOAD                        53950008
539600                                                                  53960008
539700                 MOVE WS-SUATRN-AUD-CNTL-NBR                      53970008
539800                                TO HOLD-AUD-CNTL-NBR              53980008
539900                 MOVE 'TSUNAUD' TO DS009-PROCESS-TABLE            53990008
540000                 PERFORM DS002-DO-PROCESS                         54000008
540100                 IF DS009-DO-PROCESS                              54010008
540200                     SET MORE-SUNAUD-DATA TO TRUE                 54020008
540300                     PERFORM Y100-OPEN-CURSOR                     54030008
540400                     PERFORM R100-FETCH-SUNAUD                    54040008
540500                         UNTIL NO-MORE-SUNAUD-DATA                54050008
540600                     MOVE 'TSUNAUD' TO DS009-PROCESS-TABLE        54060008
540700                     PERFORM Z100-CLOSE-CURSOR                    54070008
540800                 END-IF                                           54080008
540900                                                                  54090008
541000            WHEN SQLCODE = +100                                   54100008
541100                 SET NO-MORE-SUATRN-DATA  TO TRUE                 54110008
541200            WHEN SQLCODE = -904                                   54120008
541300            WHEN SQLCODE = -913                                   54130008
541400              CONTINUE                                            54140008
541500           END-EVALUATE                                           54150008
541600         END-PERFORM.                                             54160008
541700*                                                                 54170008
541800     PERFORM DS002-SQL-ABEND-FETCH.                               54180008
541900/                                                                 54190008
542000 R100-FETCH-SUAUPC.                                               54200008
542100*                                                                 54210008
542200     MOVE  'TSUAUPC'  TO DS009-PROCESS-TABLE.                     54220008
542300     PERFORM WITH TEST AFTER                                      54230008
542400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   54240008
542500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        54250008
542600                SQLCODE = ZERO OR                                 54260008
542700                SQLCODE = +100                                    54270008
542800        EXEC SQL                                                  54280008
542900            FETCH SUAUPC-CSR                                      54290008
543000            INTO                                                  54300008
543100                 :WS-SUAUPC                                       54310008
543200        END-EXEC                                                  54320008
543300                                                                  54330008
543400        EVALUATE TRUE                                             54340008
543500            WHEN SQLCODE = ZERO OR -305                           54350008
543600                 MOVE LENGTH OF WS-SUAUPC TO DS009-TBLE-DATA-SIZE 54360008
543700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 54370008
543800                                        + DS009-RECORD-FILLER     54380008
543900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     54390008
544000                 MOVE 'TSUAUPC'            TO DS002-NAME          54400008
544100                 PERFORM DS002-FIND-SEQUENCE                      54410008
544200                 MOVE WS-SUAUPC            TO DS002-DATA-ITEM     54420008
544300                 INITIALIZE DS009-PKYS                            54430008
544400                 PERFORM DS002-PROCESS-KEYS                       54440008
544500                 MOVE WS-SUAUPC-KEYS      TO DS009-PKYS           54450008
544600                 MOVE DS009-PKYS          TO DS002-KEYS           54460008
544700                 PERFORM 8000-WRITE-UNLOAD                        54470008
544800                                                                  54480008
544900            WHEN SQLCODE = +100                                   54490008
545000                 SET NO-MORE-SUAUPC-DATA  TO TRUE                 54500008
545100            WHEN SQLCODE = -904                                   54510008
545200            WHEN SQLCODE = -913                                   54520008
545300              CONTINUE                                            54530008
545400           END-EVALUATE                                           54540008
545500         END-PERFORM.                                             54550008
545600*                                                                 54560008
545700     PERFORM DS002-SQL-ABEND-FETCH.                               54570008
545800/                                                                 54580008
545900 R100-FETCH-SUEXCP.                                               54590008
546000*                                                                 54600008
546100     MOVE  'TSUEXCP'  TO DS009-PROCESS-TABLE.                     54610008
546200     PERFORM WITH TEST AFTER                                      54620008
546300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   54630008
546400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        54640008
546500                SQLCODE = ZERO OR                                 54650008
546600                SQLCODE = +100                                    54660008
546700        EXEC SQL                                                  54670008
546800            FETCH SUEXCP_CSR                                      54680008
546900            INTO                                                  54690008
547000                 :WS-SUEXCP                                       54700008
547100        END-EXEC                                                  54710008
547200                                                                  54720008
547300        EVALUATE TRUE                                             54730008
547400            WHEN SQLCODE = ZERO OR -305                           54740008
547500                 MOVE LENGTH OF WS-SUEXCP TO DS009-TBLE-DATA-SIZE 54750008
547600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 54760008
547700                                        + DS009-RECORD-FILLER     54770008
547800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     54780008
547900                 MOVE 'TSUEXCP'            TO DS002-NAME          54790008
548000                 PERFORM DS002-FIND-SEQUENCE                      54800008
548100                 MOVE WS-SUEXCP            TO DS002-DATA-ITEM     54810008
548200                 INITIALIZE DS009-PKYS                            54820008
548300                 PERFORM DS002-PROCESS-KEYS                       54830008
548400                 MOVE WS-SUEXCP-KEYS      TO DS009-PKYS           54840008
548500                 MOVE DS009-PKYS          TO DS002-KEYS           54850008
548600                 PERFORM 8000-WRITE-UNLOAD                        54860008
548700                                                                  54870008
548800            WHEN SQLCODE = +100                                   54880008
548900                 SET NO-MORE-SUEXCP-DATA  TO TRUE                 54890008
549000            WHEN SQLCODE = -904                                   54900008
549100            WHEN SQLCODE = -913                                   54910008
549200              CONTINUE                                            54920008
549300           END-EVALUATE                                           54930008
549400         END-PERFORM.                                             54940008
549500*                                                                 54950008
549600     PERFORM DS002-SQL-ABEND-FETCH.                               54960008
549700/                                                                 54970008
549800 R100-FETCH-CTEXCP.                                               54980008
549900*                                                                 54990008
550000     MOVE  'TCTEXCP'  TO DS009-PROCESS-TABLE.                     55000008
550100     PERFORM WITH TEST AFTER                                      55010008
550200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   55020008
550300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        55030008
550400                SQLCODE = ZERO OR                                 55040008
550500                SQLCODE = +100                                    55050008
550600        EXEC SQL                                                  55060008
550700            FETCH CTEXCP_CSR                                      55070008
550800            INTO                                                  55080008
550900                 :WS-CTEXCP                                       55090008
551000        END-EXEC                                                  55100008
551100                                                                  55110008
551200        EVALUATE TRUE                                             55120008
551300            WHEN SQLCODE = ZERO OR -305                           55130008
551400                 MOVE LENGTH OF WS-CTEXCP TO DS009-TBLE-DATA-SIZE 55140008
551500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 55150008
551600                                        + DS009-RECORD-FILLER     55160008
551700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     55170008
551800                 MOVE 'TCTEXCP'            TO DS002-NAME          55180008
551900                 PERFORM DS002-FIND-SEQUENCE                      55190008
552000                 MOVE WS-CTEXCP            TO DS002-DATA-ITEM     55200008
552100                 INITIALIZE DS009-PKYS                            55210008
552200                 PERFORM DS002-PROCESS-KEYS                       55220008
552300                 MOVE WS-CTEXCP-KEYS      TO DS009-PKYS           55230008
552400                 MOVE DS009-PKYS          TO DS002-KEYS           55240008
552500                 PERFORM 8000-WRITE-UNLOAD                        55250008
552600                                                                  55260008
552700            WHEN SQLCODE = +100                                   55270008
552800                 SET NO-MORE-CTEXCP-DATA  TO TRUE                 55280008
552900            WHEN SQLCODE = -904                                   55290008
553000            WHEN SQLCODE = -913                                   55300008
553100              CONTINUE                                            55310008
553200           END-EVALUATE                                           55320008
553300         END-PERFORM.                                             55330008
553400*                                                                 55340008
553500     PERFORM DS002-SQL-ABEND-FETCH.                               55350008
553600/                                                                 55360008
553700 R100-FETCH-IMTBKY.                                               55370008
553800*                                                                 55380008
553900     MOVE  'TIMTBKY'  TO DS009-PROCESS-TABLE.                     55390008
554000     PERFORM WITH TEST AFTER                                      55400008
554100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   55410008
554200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        55420008
554300                SQLCODE = ZERO OR                                 55430008
554400                SQLCODE = +100                                    55440008
554500        EXEC SQL                                                  55450008
554600            FETCH IMTBKY_CSR                                      55460008
554700            INTO                                                  55470008
554800                 :WS-IMTBKY                                       55480008
554900        END-EXEC                                                  55490008
555000                                                                  55500008
555100        EVALUATE TRUE                                             55510008
555200            WHEN SQLCODE = ZERO OR -305                           55520008
555300                 MOVE LENGTH OF WS-IMTBKY TO DS009-TBLE-DATA-SIZE 55530008
555400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 55540008
555500                                        + DS009-RECORD-FILLER     55550008
555600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     55560008
555700                 MOVE 'TIMTBKY'            TO DS002-NAME          55570008
555800                 PERFORM DS002-FIND-SEQUENCE                      55580008
555900                 MOVE WS-IMTBKY            TO DS002-DATA-ITEM     55590008
556000                 INITIALIZE DS009-PKYS                            55600008
556100                 PERFORM DS002-PROCESS-KEYS                       55610008
556200                 MOVE WS-IMTBKY-KEYS      TO DS009-PKYS           55620008
556300                 MOVE DS009-PKYS          TO DS002-KEYS           55630008
556400                 PERFORM 8000-WRITE-UNLOAD                        55640008
556500                                                                  55650008
556600            WHEN SQLCODE = +100                                   55660008
556700                 SET NO-MORE-IMTBKY-DATA  TO TRUE                 55670008
556800            WHEN SQLCODE = -904                                   55680008
556900            WHEN SQLCODE = -913                                   55690008
557000              CONTINUE                                            55700008
557100           END-EVALUATE                                           55710008
557200         END-PERFORM.                                             55720008
557300*                                                                 55730008
557400     PERFORM DS002-SQL-ABEND-FETCH.                               55740008
557500/                                                                 55750008
557600 R100-FETCH-POPRPK.                                               55760008
557700*                                                                 55770008
557800     MOVE  'TPOPRPK'  TO DS009-PROCESS-TABLE.                     55780008
557900     PERFORM WITH TEST AFTER                                      55790008
558000        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   55800008
558100        UNTIL   DS009-RETRY-COUNTER > 3 OR                        55810008
558200                SQLCODE = ZERO OR                                 55820008
558300                SQLCODE = +100                                    55830008
558400        EXEC SQL                                                  55840008
558500            FETCH POPRPK_CSR                                      55850008
558600            INTO                                                  55860008
558700                 :WS-POPRPK                                       55870008
558800        END-EXEC                                                  55880008
558900                                                                  55890008
559000        EVALUATE TRUE                                             55900008
559100            WHEN SQLCODE = ZERO OR -305                           55910008
559200                                                                  55920008
559300*                FETCH AND UNLOAD TPOPRPK                         55930008
559400                 MOVE LENGTH OF WS-POPRPK TO DS009-TBLE-DATA-SIZE 55940008
559500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 55950008
559600                                        + DS009-RECORD-FILLER     55960008
559700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     55970008
559800                 MOVE 'TPOPRPK'            TO DS002-NAME          55980008
559900                 PERFORM DS002-FIND-SEQUENCE                      55990008
560000                 MOVE WS-POPRPK            TO DS002-DATA-ITEM     56000008
560100                 INITIALIZE DS009-PKYS                            56010008
560200                 PERFORM DS002-PROCESS-KEYS                       56020008
560300                 MOVE WS-POPRPK-KEYS      TO DS009-PKYS           56030008
560400                 MOVE DS009-PKYS          TO DS002-KEYS           56040008
560500                 PERFORM 8000-WRITE-UNLOAD                        56050008
560600                                                                  56060008
560700*                FETCH AND UNLOAD XLT_PK                          56070008
560800                                                                  56080008
560900                 SET DS010-END-XLT-PK-NO TO TRUE                  56090008
561000                 MOVE 'XLT_PK' TO DS009-PROCESS-TABLE             56100008
561100                 PERFORM DS002-DO-PROCESS                         56110008
561200                 IF DS009-DO-PROCESS                              56120008
561300                     SET DS010-END-XLT-PK-NO  TO TRUE             56130008
561400                     PERFORM Y100-OPEN-CURSOR                     56140008
561500                     PERFORM R100-FETCH-XLT-PK                    56150008
561600                         UNTIL DS010-END-XLT-PK-YES               56160008
561700                     MOVE 'XLT_PK' TO DS009-PROCESS-TABLE         56170008
561800                     PERFORM Z100-CLOSE-CURSOR                    56180008
561900                 END-IF                                           56190008
562000                                                                  56200008
562100*                FETCH AND UNLOAD XLT_PK_CPT_SKU                  56210008
562200                                                                  56220008
562300                 SET DS010-END-XLT-PK-CPT-NO TO TRUE              56230008
562400                 MOVE 'XLT_PK_CPT_SKU' TO DS009-PROCESS-TABLE     56240008
562500                 PERFORM DS002-DO-PROCESS                         56250008
562600                 IF DS009-DO-PROCESS                              56260008
562700                     SET DS010-END-XLT-PK-CPT-NO  TO TRUE         56270008
562800                     PERFORM Y100-OPEN-CURSOR                     56280008
562900                     PERFORM R100-FETCH-XLT-PK-CPT                56290008
563000                         UNTIL DS010-END-XLT-PK-CPT-YES           56300008
563100                     MOVE 'XLT_PK_CPT_SKU' TO DS009-PROCESS-TABLE 56310008
563200                     PERFORM Z100-CLOSE-CURSOR                    56320008
563300                 END-IF                                           56330008
563400                                                                  56340008
563500*                FETCH AND UNLOAD XLT_PK_UPC                      56350008
563600                                                                  56360008
563700                 SET DS010-END-XLT-PK-UPC-NO TO TRUE              56370008
563800                 MOVE 'XLT_PK_UPC' TO DS009-PROCESS-TABLE         56380008
563900                 PERFORM DS002-DO-PROCESS                         56390008
564000                 IF DS009-DO-PROCESS                              56400008
564100                     SET DS010-END-XLT-PK-UPC-NO  TO TRUE         56410008
564200                     PERFORM Y100-OPEN-CURSOR                     56420008
564300                     PERFORM R100-FETCH-XLT-PK-UPC                56430008
564400                         UNTIL DS010-END-XLT-PK-UPC-YES           56440008
564500                     MOVE 'XLT_PK_UPC'     TO DS009-PROCESS-TABLE 56450008
564600                     PERFORM Z100-CLOSE-CURSOR                    56460008
564700                 END-IF                                           56470008
564800                                                                  56480008
564900            WHEN SQLCODE = +100                                   56490008
565000                 SET NO-MORE-POPRPK-DATA  TO TRUE                 56500008
565100            WHEN SQLCODE = -904                                   56510008
565200            WHEN SQLCODE = -913                                   56520008
565300              CONTINUE                                            56530008
565400           END-EVALUATE                                           56540008
565500         END-PERFORM.                                             56550008
565600*                                                                 56560008
565700     PERFORM DS002-SQL-ABEND-FETCH.                               56570008
565800*                                                                 56580008
565900/                                                                 56590008
566000 R100-FETCH-XLT-PK.                                               56600008
566100*                                                                 56610008
566200     MOVE  'XLT_PK'   TO DS009-PROCESS-TABLE.                     56620008
566300     PERFORM WITH TEST AFTER                                      56630008
566400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   56640008
566500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        56650008
566600                SQLCODE = ZERO OR                                 56660008
566700                SQLCODE = +100                                    56670008
566800        EXEC SQL                                                  56680008
566900            FETCH XLT-PK-CSR                                      56690008
567000            INTO                                                  56700008
567100           :XLT00007-PK-SKU-NBR                                   56710008
567200         , :XLT00007-PK-DESC                                      56720008
567300         , :XLT00007-DEPT-NBR                                     56730008
567400         , :XLT00007-MAJ-CL-NBR                                   56740008
567500         , :XLT00007-SUB-CL-NBR                                   56750008
567600         , :XLT00007-DC-ORD-MULT-QTY                              56760008
567700         , :XLT00007-LAST-UPD-TMST                                56770008
567800        END-EXEC                                                  56780008
567900                                                                  56790008
568000        EVALUATE TRUE                                             56800008
568100            WHEN SQLCODE = ZERO OR -305                           56810008
568200                                                                  56820008
568300*                FETCH AND UNLOAD XLT_PK                          56830008
568400                 MOVE LENGTH OF DCLXLT00007                       56840008
568500                                           TO DS009-TBLE-DATA-SIZE56850008
568600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 56860008
568700                                        + DS009-RECORD-FILLER     56870008
568800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     56880008
568900                 MOVE 'XLT_PK'             TO DS002-NAME          56890008
569000                 PERFORM DS002-FIND-SEQUENCE                      56900008
569100                 MOVE DCLXLT00007          TO DS002-DATA-ITEM     56910008
569200                 INITIALIZE DS009-PKYS                            56920008
569300                 PERFORM DS002-PROCESS-KEYS                       56930008
569400                 MOVE DS008-XLT00007-KEYS TO DS009-PKYS           56940008
569500                 MOVE DS009-PKYS          TO DS002-KEYS           56950008
569600                 PERFORM 8000-WRITE-UNLOAD                        56960008
569700                                                                  56970008
569800            WHEN SQLCODE = +100                                   56980008
569900                 SET DS010-END-XLT-PK-YES    TO TRUE              56990008
570000            WHEN SQLCODE = -904                                   57000008
570100            WHEN SQLCODE = -911                                   57010008
570200            WHEN SQLCODE = -913                                   57020008
570300              CONTINUE                                            57030008
570400           END-EVALUATE                                           57040008
570500         END-PERFORM.                                             57050008
570600*                                                                 57060008
570700     PERFORM DS002-SQL-ABEND-FETCH.                               57070008
570800/                                                                 57080008
570900 R100-FETCH-XLT-PK-CPT.                                           57090008
571000*                                                                 57100008
571100     MOVE  'XLT_PK_CPT_SKU'   TO DS009-PROCESS-TABLE.             57110008
571200     PERFORM WITH TEST AFTER                                      57120008
571300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   57130008
571400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        57140008
571500                SQLCODE = ZERO OR                                 57150008
571600                SQLCODE = +100                                    57160008
571700        EXEC SQL                                                  57170008
571800            FETCH XLT-PK-CPT-CSR                                  57180008
571900            INTO                                                  57190008
572000           :XLT00008-PK-SKU-NBR                                   57200008
572100         , :XLT00008-CPT-SKU-NBR                                  57210008
572200         , :XLT00008-PK-RATIO-UNT-QTY                             57220008
572300         , :XLT00008-LAST-UPD-TMST                                57230008
572400        END-EXEC                                                  57240008
572500                                                                  57250008
572600        EVALUATE TRUE                                             57260008
572700            WHEN SQLCODE = ZERO OR -305                           57270008
572800                                                                  57280008
572900*                FETCH AND UNLOAD XLT_PK_CPT_SKU                  57290008
573000                 MOVE LENGTH OF DCLXLT00008                       57300008
573100                                           TO DS009-TBLE-DATA-SIZE57310008
573200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 57320008
573300                                        + DS009-RECORD-FILLER     57330008
573400                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     57340008
573500                 MOVE 'XLT_PK_CPT_SKU'     TO DS002-NAME          57350008
573600                 PERFORM DS002-FIND-SEQUENCE                      57360008
573700                 MOVE DCLXLT00008          TO DS002-DATA-ITEM     57370008
573800                 INITIALIZE DS009-PKYS                            57380008
573900                 PERFORM DS002-PROCESS-KEYS                       57390008
574000                 MOVE DS008-XLT00008-KEYS TO DS009-PKYS           57400008
574100                 MOVE DS009-PKYS          TO DS002-KEYS           57410008
574200                 PERFORM 8000-WRITE-UNLOAD                        57420008
574300                                                                  57430008
574400            WHEN SQLCODE = +100                                   57440008
574500                 SET DS010-END-XLT-PK-CPT-YES    TO TRUE          57450008
574600            WHEN SQLCODE = -904                                   57460008
574700            WHEN SQLCODE = -911                                   57470008
574800            WHEN SQLCODE = -913                                   57480008
574900              CONTINUE                                            57490008
575000           END-EVALUATE                                           57500008
575100         END-PERFORM.                                             57510008
575200*                                                                 57520008
575300     PERFORM DS002-SQL-ABEND-FETCH.                               57530008
575400/                                                                 57540008
575500 R100-FETCH-XLT-PK-UPC.                                           57550008
575600*                                                                 57560008
575700     MOVE  'XLT_PK_UPC'       TO DS009-PROCESS-TABLE.             57570008
575800     PERFORM WITH TEST AFTER                                      57580008
575900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   57590008
576000        UNTIL   DS009-RETRY-COUNTER > 3 OR                        57600008
576100                SQLCODE = ZERO OR                                 57610008
576200                SQLCODE = +100                                    57620008
576300        EXEC SQL                                                  57630008
576400            FETCH XLT-PK-UPC-CSR                                  57640008
576500            INTO                                                  57650008
576600           :XLT00009-PK-SKU-NBR                                   57660008
576700         , :XLT00009-UPC-NBR                                      57670008
576800         , :XLT00009-EDI-ORD-IND                                  57680008
576900         , :XLT00009-LAST-UPD-TMST                                57690008
577000        END-EXEC                                                  57700008
577100                                                                  57710008
577200        EVALUATE TRUE                                             57720008
577300            WHEN SQLCODE = ZERO OR -305                           57730008
577400                                                                  57740008
577500*                FETCH AND UNLOAD XLT_PK_UPC                      57750008
577600                 MOVE LENGTH OF DCLXLT00009                       57760008
577700                                           TO DS009-TBLE-DATA-SIZE57770008
577800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 57780008
577900                                        + DS009-RECORD-FILLER     57790008
578000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     57800008
578100                 MOVE 'XLT_PK_UPC'         TO DS002-NAME          57810008
578200                 PERFORM DS002-FIND-SEQUENCE                      57820008
578300                 MOVE DCLXLT00009          TO DS002-DATA-ITEM     57830008
578400                 INITIALIZE DS009-PKYS                            57840008
578500                 PERFORM DS002-PROCESS-KEYS                       57850008
578600                 MOVE DS008-XLT00009-KEYS TO DS009-PKYS           57860008
578700                 MOVE DS009-PKYS          TO DS002-KEYS           57870008
578800                 PERFORM 8000-WRITE-UNLOAD                        57880008
578900                                                                  57890008
579000            WHEN SQLCODE = +100                                   57900008
579100                 SET DS010-END-XLT-PK-UPC-YES    TO TRUE          57910008
579200            WHEN SQLCODE = -904                                   57920008
579300            WHEN SQLCODE = -911                                   57930008
579400            WHEN SQLCODE = -913                                   57940008
579500              CONTINUE                                            57950008
579600           END-EVALUATE                                           57960008
579700         END-PERFORM.                                             57970008
579800*                                                                 57980008
579900     PERFORM DS002-SQL-ABEND-FETCH.                               57990008
580000*                                                                 58000008
580100/                                                                 58010008
580200 R100-FETCH-INPKSU.                                               58020008
580300*                                                                 58030008
580400     MOVE 'TINPKSU' TO DS009-PROCESS-TABLE.                       58040008
580500     PERFORM WITH TEST AFTER                                      58050008
580600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   58060008
580700        UNTIL   DS009-RETRY-COUNTER > 3 OR                        58070008
580800                SQLCODE = ZERO OR                                 58080008
580900                SQLCODE = +100                                    58090008
581000        EXEC SQL                                                  58100008
581100            FETCH INPKSU_CSR                                      58110008
581200            INTO                                                  58120008
581300               :WS-INPKSU                                         58130008
581400        END-EXEC                                                  58140008
581500                                                                  58150008
581600         IF WS-INPKSU-SHIPT-UNT-ID NOT NUMERIC                    58160008
581700             MOVE ZEROES          TO WS-INPKSU-SHIPT-UNT-ID       58170008
581800         END-IF                                                   58180008
581900                                                                  58190008
582000        EVALUATE TRUE                                             58200008
582100            WHEN SQLCODE = ZERO OR -305                           58210008
582200*                DISPLAY ' R100-FETCH-INPKSU '                    58220008
582300                 MOVE LENGTH OF WS-INPKSU TO DS009-TBLE-DATA-SIZE 58230008
582400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 58240008
582500                                           + DS009-RECORD-FILLER  58250008
582600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     58260008
582700                 MOVE 'TINPKSU'           TO DS002-NAME           58270008
582800                 PERFORM DS002-FIND-SEQUENCE                      58280008
582900                 MOVE WS-INPKSU           TO DS002-DATA-ITEM      58290008
583000                 INITIALIZE DS009-PKYS                            58300008
583100                 PERFORM DS002-PROCESS-KEYS                       58310008
583200                 MOVE WS-INPKSU-KEYS  TO DS009-PKYS               58320008
583300                 MOVE DS009-PKYS      TO DS002-KEYS               58330008
583400                 PERFORM 8000-WRITE-UNLOAD                        58340008
583500                                                                  58350008
583600                 SET MORE-SHUUPC-DATA TO TRUE                     58360008
583700                 MOVE WS-INPKSU-SHIPT-UNT-ID                      58370008
583800                                        TO HOLD-SHIPT-UNIT-ID     58380008
583900                 MOVE   'TSHUUPC' TO DS009-PROCESS-TABLE          58390008
584000                 PERFORM DS002-DO-PROCESS                         58400008
584100                 IF DS009-DO-PROCESS                              58410008
584200                     SET MORE-SHUUPC-DATA TO TRUE                 58420008
584300                     PERFORM Y100-OPEN-CURSOR                     58430008
584400                     PERFORM R100-FETCH-SHUUPC                    58440008
584500                         UNTIL NO-MORE-SHUUPC-DATA                58450008
584600                     MOVE 'TSHUUPC' TO DS009-PROCESS-TABLE        58460008
584700                     PERFORM Z100-CLOSE-CURSOR                    58470008
584800                 END-IF                                           58480008
584900                                                                  58490008
585000                 SET MORE-SHPUNT-DATA TO TRUE                     58500008
585100                 MOVE WS-INPKSU-SHIPT-UNT-ID                      58510008
585200                                        TO HOLD-SHIPT-UNIT-ID     58520008
585300                 MOVE   'TSHPUNT' TO DS009-PROCESS-TABLE          58530008
585400                 PERFORM DS002-DO-PROCESS                         58540008
585500                 IF DS009-DO-PROCESS                              58550008
585600                     SET MORE-SHPUNT-DATA TO TRUE                 58560008
585700                     PERFORM Y100-OPEN-CURSOR                     58570008
585800                     PERFORM R100-FETCH-SHPUNT                    58580008
585900                         UNTIL NO-MORE-SHPUNT-DATA                58590008
586000                     MOVE 'TSHPUNT' TO DS009-PROCESS-TABLE        58600008
586100                     PERFORM Z100-CLOSE-CURSOR                    58610008
586200                 END-IF                                           58620008
586300                                                                  58630008
586400                 SET MORE-SHUNLO-DATA TO TRUE                     58640008
586500                 MOVE WS-INPKSU-SHIPT-UNT-ID                      58650008
586600                                        TO HOLD-SHIPT-UNIT-ID     58660008
586700                 MOVE   'TSHUNLO' TO DS009-PROCESS-TABLE          58670008
586800                 PERFORM DS002-DO-PROCESS                         58680008
586900                 IF DS009-DO-PROCESS                              58690008
587000                     SET MORE-SHUNLO-DATA TO TRUE                 58700008
587100                     PERFORM Y100-OPEN-CURSOR                     58710008
587200                     PERFORM R100-FETCH-SHUNLO                    58720008
587300                         UNTIL NO-MORE-SHUNLO-DATA                58730008
587400                     MOVE 'TSHUNLO' TO DS009-PROCESS-TABLE        58740008
587500                     PERFORM Z100-CLOSE-CURSOR                    58750008
587600                 END-IF                                           58760008
587700                                                                  58770008
587800                 SET MORE-SUATRN-DATA TO TRUE                     58780008
587900                 MOVE WS-INPKSU-SHIPT-UNT-ID                      58790008
588000                                TO HOLD-SHIPT-UNIT-ID             58800008
588100                 MOVE 'TSUATRN' TO DS009-PROCESS-TABLE            58810008
588200                 PERFORM DS002-DO-PROCESS                         58820008
588300                 IF DS009-DO-PROCESS                              58830008
588400                     SET MORE-SUATRN-DATA TO TRUE                 58840008
588500                     PERFORM Y100-OPEN-CURSOR                     58850008
588600                     PERFORM R100-FETCH-SUATRN                    58860008
588700                         UNTIL NO-MORE-SUATRN-DATA                58870008
588800                     MOVE 'TSUATRN' TO DS009-PROCESS-TABLE        58880008
588900                     PERFORM Z100-CLOSE-CURSOR                    58890008
589000                 END-IF                                           58900008
589100                                                                  58910008
589200                 SET MORE-SUAUPC-DATA TO TRUE                     58920008
589300                 MOVE WS-INPKSU-SHIPT-UNT-ID                      58930008
589400                                TO HOLD-SHIPT-UNIT-ID             58940008
589500                 MOVE WS-SUATRN-AUD-CNTL-NBR                      58950008
589600                                TO HOLD-AUD-CNTL-NBR              58960008
589700                 MOVE 'TSUAUPC' TO DS009-PROCESS-TABLE            58970008
589800                 PERFORM DS002-DO-PROCESS                         58980008
589900                 IF DS009-DO-PROCESS                              58990008
590000                     SET MORE-SUAUPC-DATA TO TRUE                 59000008
590100                     PERFORM Y100-OPEN-CURSOR                     59010008
590200                     PERFORM R100-FETCH-SUAUPC                    59020008
590300                         UNTIL NO-MORE-SUAUPC-DATA                59030008
590400                     MOVE 'TSUAUPC' TO DS009-PROCESS-TABLE        59040008
590500                     PERFORM Z100-CLOSE-CURSOR                    59050008
590600                 END-IF                                           59060008
590700                                                                  59070008
590800                 SET MORE-SUEXCP-DATA TO TRUE                     59080008
590900                 MOVE WS-INPKSU-SHIPT-UNT-ID                      59090008
591000                                TO HOLD-SHIPT-UNIT-ID             59100008
591100                 MOVE WS-SUATRN-AUD-CNTL-NBR                      59110008
591200                                TO HOLD-AUD-CNTL-NBR              59120008
591300                 MOVE 'TSUEXCP' TO DS009-PROCESS-TABLE            59130008
591400                 PERFORM DS002-DO-PROCESS                         59140008
591500                 IF DS009-DO-PROCESS                              59150008
591600                     SET MORE-SUEXCP-DATA TO TRUE                 59160008
591700                     PERFORM Y100-OPEN-CURSOR                     59170008
591800                     PERFORM R100-FETCH-SUEXCP                    59180008
591900                         UNTIL NO-MORE-SUEXCP-DATA                59190008
592000                     MOVE 'TSUEXCP' TO DS009-PROCESS-TABLE        59200008
592100                     PERFORM Z100-CLOSE-CURSOR                    59210008
592200                 END-IF                                           59220008
592300                                                                  59230008
592400                 SET MORE-CTEXCP-DATA TO TRUE                     59240008
592500                 MOVE WS-INPKSU-SHIPT-UNT-ID                      59250008
592600                                TO HOLD-SHIPT-UNIT-ID             59260008
592700                 MOVE WS-SUATRN-AUD-CNTL-NBR                      59270008
592800                                TO HOLD-AUD-CNTL-NBR              59280008
592900                 MOVE 'TCTEXCP' TO DS009-PROCESS-TABLE            59290008
593000                 PERFORM DS002-DO-PROCESS                         59300008
593100                 IF DS009-DO-PROCESS                              59310008
593200                     SET MORE-CTEXCP-DATA TO TRUE                 59320008
593300                     PERFORM Y100-OPEN-CURSOR                     59330008
593400                     PERFORM R100-FETCH-CTEXCP                    59340008
593500                         UNTIL NO-MORE-CTEXCP-DATA                59350008
593600                     MOVE 'TCTEXCP' TO DS009-PROCESS-TABLE        59360008
593700                     PERFORM Z100-CLOSE-CURSOR                    59370008
593800                 END-IF                                           59380008
593900                                                                  59390008
594000                SET MORE-SULBXF-DATA TO TRUE                      59400008
594100                MOVE WS-INPKSU-SHIPT-UNT-ID                       59410008
594200                                TO HOLD-SHIPT-UNT-ID              59420008
594300                MOVE 'TSULBXF'  TO DS009-PROCESS-TABLE            59430008
594400                PERFORM DS002-DO-PROCESS                          59440008
594500                IF DS009-DO-PROCESS                               59450008
594600                   SET MORE-SULBXF-DATA TO TRUE                   59460008
594700                   PERFORM Y100-OPEN-CURSOR                       59470008
594800                   PERFORM R100-FETCH-SULBXF                      59480008
594900                       UNTIL NO-MORE-SULBXF-DATA                  59490008
595000                   MOVE 'TSULBXF' TO DS009-PROCESS-TABLE          59500008
595100                   PERFORM Z100-CLOSE-CURSOR                      59510008
595200                END-IF                                            59520008
595300                                                                  59530008
595400            WHEN SQLCODE = +100                                   59540008
595500                 SET NO-MORE-INPKSU-DATA  TO TRUE                 59550008
595600            WHEN SQLCODE = -904                                   59560008
595700            WHEN SQLCODE = -913                                   59570008
595800              CONTINUE                                            59580008
595900           END-EVALUATE                                           59590008
596000         END-PERFORM.                                             59600008
596100*                                                                 59610008
596200     PERFORM DS002-SQL-ABEND-FETCH.                               59620008
596300/                                                                 59630008
596400 R100-FETCH-SHUUPC.                                               59640008
596500*                                                                 59650008
596600     MOVE 'TSHUUPC' TO DS009-PROCESS-TABLE.                       59660008
596700     PERFORM WITH TEST AFTER                                      59670008
596800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   59680008
596900        UNTIL   DS009-RETRY-COUNTER > 3 OR                        59690008
597000                SQLCODE = ZERO OR                                 59700008
597100                SQLCODE = +100                                    59710008
597200        EXEC SQL                                                  59720008
597300            FETCH SHUUPC-CSR                                      59730008
597400            INTO                                                  59740008
597500               :WS-SHUUPC                                         59750008
597600        END-EXEC                                                  59760008
597700                                                                  59770008
597800        EVALUATE TRUE                                             59780008
597900            WHEN SQLCODE = ZERO OR -305                           59790008
598000                 MOVE LENGTH OF WS-SHUUPC TO DS009-TBLE-DATA-SIZE 59800008
598100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 59810008
598200                                           + DS009-RECORD-FILLER  59820008
598300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     59830008
598400                 MOVE 'TSHUUPC'           TO DS002-NAME           59840008
598500                 PERFORM DS002-FIND-SEQUENCE                      59850008
598600                 MOVE WS-SHUUPC           TO DS002-DATA-ITEM      59860008
598700                 INITIALIZE DS009-PKYS                            59870008
598800                 PERFORM DS002-PROCESS-KEYS                       59880008
598900                 MOVE WS-SHUUPC-KEYS  TO DS009-PKYS               59890008
599000                 MOVE DS009-PKYS      TO DS002-KEYS               59900008
599100                 PERFORM 8000-WRITE-UNLOAD                        59910008
599200            WHEN SQLCODE = +100                                   59920008
599300                 SET NO-MORE-SHUUPC-DATA  TO TRUE                 59930008
599400            WHEN SQLCODE = -904                                   59940008
599500            WHEN SQLCODE = -913                                   59950008
599600              CONTINUE                                            59960008
599700           END-EVALUATE                                           59970008
599800         END-PERFORM.                                             59980008
599900*                                                                 59990008
600000     PERFORM DS002-SQL-ABEND-FETCH.                               60000008
600100*                                                                 60010008
600200/                                                                 60020008
600300 R100-FETCH-SHPUNT.                                               60030008
600400*                                                                 60040008
600500     MOVE 'TSHPUNT' TO DS009-PROCESS-TABLE.                       60050008
600600     PERFORM WITH TEST AFTER                                      60060008
600700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   60070008
600800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        60080008
600900                SQLCODE = ZERO OR                                 60090008
601000                SQLCODE = +100                                    60100008
601100        EXEC SQL                                                  60110008
601200            FETCH SHPUNT_CSR                                      60120008
601300            INTO                                                  60130008
601400               :WS-SHPUNT                                         60140008
601500        END-EXEC                                                  60150008
601600                                                                  60160008
601700        EVALUATE TRUE                                             60170008
601800            WHEN SQLCODE = ZERO OR -305                           60180008
601900                 MOVE LENGTH OF WS-SHPUNT TO DS009-TBLE-DATA-SIZE 60190008
602000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 60200008
602100                                           + DS009-RECORD-FILLER  60210008
602200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     60220008
602300                 MOVE 'TSHPUNT'           TO DS002-NAME           60230008
602400                 PERFORM DS002-FIND-SEQUENCE                      60240008
602500                 MOVE WS-SHPUNT           TO DS002-DATA-ITEM      60250008
602600                 INITIALIZE DS009-PKYS                            60260008
602700                 PERFORM DS002-PROCESS-KEYS                       60270008
602800                 MOVE WS-SHPUNT-KEYS  TO DS009-PKYS               60280008
602900                 MOVE DS009-PKYS      TO DS002-KEYS               60290008
603000                 PERFORM 8000-WRITE-UNLOAD                        60300008
603100            WHEN SQLCODE = +100                                   60310008
603200                 SET NO-MORE-SHPUNT-DATA  TO TRUE                 60320008
603300            WHEN SQLCODE = -904                                   60330008
603400            WHEN SQLCODE = -913                                   60340008
603500              CONTINUE                                            60350008
603600           END-EVALUATE                                           60360008
603700         END-PERFORM.                                             60370008
603800*                                                                 60380008
603900     PERFORM DS002-SQL-ABEND-FETCH.                               60390008
604000/                                                                 60400008
604100 R100-FETCH-SHUNLO.                                               60410008
604200*                                                                 60420008
604300     MOVE 'TSHUNLO' TO DS009-PROCESS-TABLE.                       60430008
604400     PERFORM WITH TEST AFTER                                      60440008
604500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   60450008
604600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        60460008
604700                SQLCODE = ZERO OR                                 60470008
604800                SQLCODE = +100                                    60480008
604900        EXEC SQL                                                  60490008
605000            FETCH SHUNLO_CSR                                      60500008
605100            INTO                                                  60510008
605200               :WS-SHUNLO                                         60520008
605300        END-EXEC                                                  60530008
605400                                                                  60540008
605500        EVALUATE TRUE                                             60550008
605600            WHEN SQLCODE = ZERO OR -305                           60560008
605700                 MOVE LENGTH OF WS-SHUNLO TO DS009-TBLE-DATA-SIZE 60570008
605800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 60580008
605900                                           + DS009-RECORD-FILLER  60590008
606000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     60600008
606100                 MOVE 'TSHUNLO'           TO DS002-NAME           60610008
606200                 PERFORM DS002-FIND-SEQUENCE                      60620008
606300                 MOVE WS-SHUNLO           TO DS002-DATA-ITEM      60630008
606400                 INITIALIZE DS009-PKYS                            60640008
606500                 PERFORM DS002-PROCESS-KEYS                       60650008
606600                 MOVE WS-SHUNLO-KEYS  TO DS009-PKYS               60660008
606700                 MOVE DS009-PKYS      TO DS002-KEYS               60670008
606800                 PERFORM 8000-WRITE-UNLOAD                        60680008
606900                                                                  60690008
607000            WHEN SQLCODE = +100                                   60700008
607100                 SET NO-MORE-SHUNLO-DATA  TO TRUE                 60710008
607200            WHEN SQLCODE = -904                                   60720008
607300            WHEN SQLCODE = -913                                   60730008
607400              CONTINUE                                            60740008
607500           END-EVALUATE                                           60750008
607600         END-PERFORM.                                             60760008
607700                                                                  60770008
607800     PERFORM DS002-SQL-ABEND-FETCH.                               60780008
607900/                                                                 60790008
608000 R100-FETCH-SULBXF.                                               60800008
608100*                                                                 60810008
608200     MOVE  'TSULBXF'  TO DS009-PROCESS-TABLE.                     60820008
608300     PERFORM WITH TEST AFTER                                      60830008
608400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   60840008
608500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        60850008
608600                SQLCODE = ZERO OR                                 60860008
608700                SQLCODE = +100                                    60870008
608800        EXEC SQL                                                  60880008
608900            FETCH SULBXF_CSR                                      60890008
609000            INTO                                                  60900008
609100                 :WS-SULBXF                                       60910008
609200        END-EXEC                                                  60920008
609300                                                                  60930008
609400        EVALUATE TRUE                                             60940008
609500            WHEN SQLCODE = ZERO OR -305                           60950008
609600                 MOVE LENGTH OF WS-SULBXF TO DS009-TBLE-DATA-SIZE 60960008
609700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 60970008
609800                                        + DS009-RECORD-FILLER     60980008
609900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     60990008
610000                 MOVE 'TSULBXF'            TO DS002-NAME          61000008
610100                 PERFORM DS002-FIND-SEQUENCE                      61010008
610200                 MOVE WS-SULBXF            TO DS002-DATA-ITEM     61020008
610300                 INITIALIZE DS009-PKYS                            61030008
610400                 PERFORM DS002-PROCESS-KEYS                       61040008
610500                 MOVE WS-SULBXF-KEYS      TO DS009-PKYS           61050008
610600                 MOVE DS009-PKYS          TO DS002-KEYS           61060008
610700                 PERFORM 8000-WRITE-UNLOAD                        61070008
610800                                                                  61080008
610900            WHEN SQLCODE = +100                                   61090008
611000                 SET NO-MORE-SULBXF-DATA  TO TRUE                 61100008
611100            WHEN SQLCODE = -904                                   61110008
611200            WHEN SQLCODE = -913                                   61120008
611300              CONTINUE                                            61130008
611400           END-EVALUATE                                           61140008
611500         END-PERFORM.                                             61150008
611600                                                                  61160008
611700     PERFORM DS002-SQL-ABEND-FETCH.                               61170008
611800                                                                  61180008
611900/                                                                 61190008
612000 R100-FETCH-WEBITM.                                               61200008
612100*                                                                 61210008
612200     MOVE  'TWEBITM'  TO DS009-PROCESS-TABLE.                     61220008
612300     MOVE  LOW-VALUES TO WS-WEBITM-EFF-END-TMST.                  61230008
612400     PERFORM WITH TEST AFTER                                      61240008
612500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   61250008
612600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        61260008
612700                SQLCODE = ZERO OR                                 61270008
612800                SQLCODE = +100                                    61280008
612900        EXEC SQL                                                  61290008
613000            FETCH WEBITM_CSR                                      61300008
613100            INTO                                                  61310008
613200                     :WS-WEBITM-INTR-UPC-ID                       61320008
613300                    ,:WS-WEBITM-EFF-BEG-TMST                      61330008
613400                    ,:WS-WEBITM-EFF-END-TMST                      61340008
613500                     :WS-WEBITM-EFF-END-TMST-NN                   61350008
613600                    ,:WS-WEBITM-ASRT-BEG-DTE                      61360008
613700                    ,:WS-WEBITM-ASRT-END-DTE                      61370008
613800                    ,:WS-WEBITM-STRG-AREA-SEQ-NBR                 61380008
613900                    ,:WS-WEBITM-SHIP-WD-QTY                       61390008
614000                    ,:WS-WEBITM-SHIP-DPTH-QTY                     61400008
614100                    ,:WS-WEBITM-SHIP-HT-QTY                       61410008
614200                    ,:WS-WEBITM-SHIP-WT-QTY                       61420008
614300                    ,:WS-WEBITM-SHIP-DIM-SRC-CDE                  61430008
614400                    ,:WS-WEBITM-PKG-SEQ-NBR                       61440008
614500                    ,:WS-WEBITM-SHIP-RSTRC-SEQ-NBR                61450008
614600                    ,:WS-WEBITM-GFT-WRAP-AVL-IND                  61460008
614700                    ,:WS-WEBITM-PRD-GP-NBR                        61470008
614800                    ,:WS-WEBITM-PRD-GP-IND                        61480008
614900                    ,:WS-WEBITM-SHIP-SRCHG-FEE-AMT                61490008
615000                    ,:WS-WEBITM-SHIP-SRVC-SEQ-NBR                 61500008
615100                    ,:WS-WEBITM-SHIP-GP-SEQ-NBR                   61510008
615200                    ,:WS-WEBITM-CRE-BY-USR-ID                     61520008
615300                    ,:WS-WEBITM-WEB-ITM-DLTD-IND                  61530008
615400                    ,:WS-WEBITM-HAZDS-IND                         61540008
615500                    ,:WS-WEBITM-BRKBL-IND                         61550008
615600                    ,:WS-WEBITM-GC-IND                            61560008
615700                    ,:WS-WEBITM-SHIP-ALN-IND                      61570008
615800                    , :WS-WEBITM-WEB-EXCLV-IND                    61580008
615900        END-EXEC                                                  61590008
616000                                                                  61600008
616100        EVALUATE TRUE                                             61610008
616200            WHEN SQLCODE = ZERO OR -305                           61620008
616300                 MOVE LENGTH OF WS-WEBITM TO DS009-TBLE-DATA-SIZE 61630008
616400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 61640008
616500                                        + DS009-RECORD-FILLER     61650008
616600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     61660008
616700                 MOVE 'TWEBITM'            TO DS002-NAME          61670008
616800                 PERFORM DS002-FIND-SEQUENCE                      61680008
616900                 MOVE WS-WEBITM            TO DS002-DATA-ITEM     61690008
617000                 INITIALIZE DS009-PKYS                            61700008
617100                 PERFORM DS002-PROCESS-KEYS                       61710008
617200                 MOVE WS-WEBITM-KEYS      TO DS009-PKYS           61720008
617300                 MOVE DS009-PKYS          TO DS002-KEYS           61730008
617400                 PERFORM 8000-WRITE-UNLOAD                        61740008
617500                                                                  61750008
617600            WHEN SQLCODE = +100                                   61760008
617700                 SET NO-MORE-WEBITM-DATA  TO TRUE                 61770008
617800            WHEN SQLCODE = -904                                   61780008
617900            WHEN SQLCODE = -913                                   61790008
618000              CONTINUE                                            61800008
618100           END-EVALUATE                                           61810008
618200         END-PERFORM.                                             61820008
618300*                                                                 61830008
618400     PERFORM DS002-SQL-ABEND-FETCH.                               61840008
618500/                                                                 61850008
618600 R100-FETCH-OTBND-UPC.                                            61860008
618700*    DISPLAY 'R100-FETCH-OTBND-UPC'.                              61870008
618800*                                                                 61880008
618900     MOVE  'SUT_OTBND_UPC'  TO DS009-PROCESS-TABLE.               61890008
619000*    DISPLAY 'R100-FETCH-OTBND-UPC' ' / ' HOLD-PO-NBR             61900008
619100                                                                  61910008
619200     PERFORM WITH TEST AFTER                                      61920008
619300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   61930008
619400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        61940008
619500                SQLCODE = ZERO OR                                 61950008
619600                SQLCODE = +100                                    61960008
619700        EXEC SQL                                                  61970008
619800            FETCH OTBUPC-CSR                                      61980008
619900            INTO                                                  61990008
620000                :SUT00028-SHIPT-UNT-ID                            62000008
620100             ,  :SUT00028-TRN-NBR                                 62010008
620200             ,  :SUT00028-RCVR-SEQ-NBR                            62020008
620300             ,  :SUT00028-TRN-LNE-NBR                             62030008
620400             ,  :SUT00028-TRN-TYP-CDE                             62040008
620500             ,  :SUT00028-UPC-NBR                                 62050008
620600             ,  :SUT00028-SHPD-UNT-QTY                            62060008
620700        END-EXEC                                                  62070008
620800                                                                  62080008
620900        EVALUATE TRUE                                             62090008
621000            WHEN SQLCODE = ZERO OR -305                           62100008
621100             MOVE SUT00028-SHIPT-UNT-ID TO PV-DISP-NBR            62110008
621200*            DISPLAY SPACES                                       62120008
621300*            DISPLAY 'OTBND-UPC-SHIPT-UNT-ID = ' PV-DISP-NBR      62130008
621400                 MOVE LENGTH OF DCLSUT00028                       62140008
621500                              TO DS009-TBLE-DATA-SIZE             62150008
621600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 62160008
621700                                        + DS009-RECORD-FILLER     62170008
621800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     62180008
621900                 MOVE 'SUT_OTBND_UPC'      TO DS002-NAME          62190008
622000                 PERFORM DS002-FIND-SEQUENCE                      62200008
622100                 MOVE DCLSUT00028          TO DS002-DATA-ITEM     62210008
622200                 INITIALIZE DS009-PKYS                            62220008
622300                 PERFORM DS002-PROCESS-KEYS                       62230008
622400                 MOVE WS-OTBUPC-KEYS      TO DS009-PKYS           62240008
622500                 MOVE DS009-PKYS          TO DS002-KEYS           62250008
622600                 PERFORM 8000-WRITE-UNLOAD                        62260008
622700            WHEN SQLCODE = +100                                   62270008
622800                 SET NO-MORE-OTBUPC-DATA  TO TRUE                 62280008
622900            WHEN SQLCODE = -904                                   62290008
623000            WHEN SQLCODE = -913                                   62300008
623100              CONTINUE                                            62310008
623200           END-EVALUATE                                           62320008
623300     END-PERFORM.                                                 62330008
623400*                                                                 62340008
623500     PERFORM DS002-SQL-ABEND-FETCH.                               62350008
623600/                                                                 62360008
623700 R100-FETCH-OTBND-PKD-UPC.                                        62370008
623800*    DISPLAY 'R100-FETCH-OTBND-PKD-UPC'.                          62380008
623900*                                                                 62390008
624000     MOVE  'SUT_OTBND_PKD_UPC'  TO DS009-PROCESS-TABLE.           62400008
624100     PERFORM WITH TEST AFTER                                      62410008
624200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   62420008
624300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        62430008
624400                SQLCODE = ZERO OR                                 62440008
624500                SQLCODE = +100                                    62450008
624600        EXEC SQL                                                  62460008
624700            FETCH OTB-PKD-UPC-CSR                                 62470008
624800            INTO                                                  62480008
624900                :SUT00025-SHIPT-UNT-ID                            62490008
625000             ,  :SUT00025-TRN-NBR                                 62500008
625100             ,  :SUT00025-RCVR-SEQ-NBR                            62510008
625200             ,  :SUT00025-TRN-LNE-NBR                             62520008
625300             ,  :SUT00025-TRN-TYP-CDE                             62530008
625400             ,  :SUT00025-UPC-NBR                                 62540008
625500             ,  :SUT00025-PKD-BY-USR-ID                           62550008
625600             ,  :SUT00025-PKD-TMST                                62560008
625700             ,  :SUT00025-PKD-QTY                                 62570008
625800             ,  :SUT00025-MODU-NBR                                62580008
625900        END-EXEC                                                  62590008
626000                                                                  62600008
626100        EVALUATE TRUE                                             62610008
626200            WHEN SQLCODE = ZERO OR -305                           62620008
626300                 MOVE LENGTH OF DCLSUT00025                       62630008
626400                              TO DS009-TBLE-DATA-SIZE             62640008
626500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 62650008
626600                                        + DS009-RECORD-FILLER     62660008
626700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     62670008
626800                 MOVE 'SUT_OTBND_PKD_UPC'  TO DS002-NAME          62680008
626900                 PERFORM DS002-FIND-SEQUENCE                      62690008
627000                 MOVE DCLSUT00025          TO DS002-DATA-ITEM     62700008
627100                 INITIALIZE DS009-PKYS                            62710008
627200                 PERFORM DS002-PROCESS-KEYS                       62720008
627300                 MOVE DS008-OTBPKD-KEYS   TO DS009-PKYS           62730008
627400                 MOVE DS009-PKYS          TO DS002-KEYS           62740008
627500                 PERFORM 8000-WRITE-UNLOAD                        62750008
627600            WHEN SQLCODE = +100                                   62760008
627700                 SET NO-MORE-OTBPKD-DATA  TO TRUE                 62770008
627800            WHEN SQLCODE = -904                                   62780008
627900            WHEN SQLCODE = -913                                   62790008
628000              CONTINUE                                            62800008
628100            END-EVALUATE                                          62810008
628200     END-PERFORM.                                                 62820008
628300                                                                  62830008
628400     PERFORM DS002-SQL-ABEND-FETCH.                               62840008
628500                                                                  62850008
628600 R100-FETCH-OTBND-LOC.                                            62860008
628700*    DISPLAY 'R100-FETCH-OTBND-LOC'.                              62870008
628800*                                                                 62880008
628900     MOVE  'SUT_OTBND_LOC'  TO DS009-PROCESS-TABLE.               62890008
629000     PERFORM WITH TEST AFTER                                      62900008
629100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   62910008
629200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        62920008
629300                SQLCODE = ZERO OR +100 OR -305                    62930008
629400        EXEC SQL                                                  62940008
629500            FETCH OTBLOC-CSR                                      62950008
629600            INTO                                                  62960008
629700                :DS008-OTBLOC-SHIPT-UNT-ID                        62970008
629800             ,  :DS008-OTBLOC-CRE-TMST                            62980008
629900             ,  :DS008-OTBLOC-OTBND-TRIP-ID                       62990008
630000                    :DS008-OTBLOC-OTBND-TRIP-ID-N                 63000008
630100             ,  :DS008-OTBLOC-LOC-NBR                             63010008
630200             ,  :DS008-OTBLOC-SCN-CDE                             63020008
630300             ,  :DS008-OTBLOC-CRE-USR-ID                          63030008
630400             ,  :DS008-OTBLOC-ACTV-CDE                            63040008
630500             ,  :DS008-OTBLOC-INBD-TRIP-ID                        63050008
630600        END-EXEC                                                  63060008
630700                                                                  63070008
630800        EVALUATE TRUE                                             63080008
630900            WHEN SQLCODE = ZERO OR -305                           63090008
631000                 MOVE LENGTH OF DS008-SUT-OTBND-LOC               63100008
631100                              TO DS009-TBLE-DATA-SIZE             63110008
631200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 63120008
631300                                        + DS009-RECORD-FILLER     63130008
631400                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     63140008
631500                 MOVE 'SUT_OTBND_LOC'      TO DS002-NAME          63150008
631600                 PERFORM DS002-FIND-SEQUENCE                      63160008
631700                 MOVE DS008-SUT-OTBND-LOC  TO DS002-DATA-ITEM     63170008
631800                 INITIALIZE DS009-PKYS                            63180008
631900                 PERFORM DS002-PROCESS-KEYS                       63190008
632000                 MOVE DS008-OTBLOC-KEYS   TO DS009-PKYS           63200008
632100                 MOVE DS009-PKYS          TO DS002-KEYS           63210008
632200                 PERFORM 8000-WRITE-UNLOAD                        63220008
632300                                                                  63230008
632400            WHEN SQLCODE = +100                                   63240008
632500                 SET NO-MORE-OTBLOC-DATA  TO TRUE                 63250008
632600            WHEN SQLCODE = -904                                   63260008
632700            WHEN SQLCODE = -913                                   63270008
632800              CONTINUE                                            63280008
632900           END-EVALUATE                                           63290008
633000     END-PERFORM.                                                 63300008
633100*                                                                 63310008
633200     PERFORM DS002-SQL-ABEND-FETCH.                               63320008
633300                                                                  63330008
633400 R100-FETCH-SUQADJ.                                               63340008
633500*    DISPLAY 'R100-FETCH-SUQADJ'.                                 63350008
633600*                                                                 63360008
633700     MOVE  'TSUQADJ'  TO DS009-PROCESS-TABLE.                     63370008
633800     PERFORM WITH TEST AFTER                                      63380008
633900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   63390008
634000        UNTIL   DS009-RETRY-COUNTER > 3 OR                        63400008
634100                SQLCODE = ZERO OR +100 OR -305                    63410008
634200        EXEC SQL                                                  63420008
634300            FETCH SUQADJ-CSR                                      63430008
634400            INTO                                                  63440008
634500               :SUQADJ-SHIPT-UNT-ID                               63450008
634600             , :SUQADJ-UPC-NBR                                    63460008
634700             , :SUQADJ-ADJ-TMST                                   63470008
634800             , :SUQADJ-OPER-UNT-ID                                63480008
634900             , :SUQADJ-ADJ-FUNC-CDE                               63490008
635000             , :SUQADJ-ADJ-BEF-QTY                                63500008
635100             , :SUQADJ-ADJ-AFT-QTY                                63510008
635200             , :SUQADJ-PRC-RSN-CDE                                63520008
635300             , :SUQADJ-ADJ-USR-ID                                 63530008
635400        END-EXEC                                                  63540008
635500                                                                  63550008
635600        EVALUATE TRUE                                             63560008
635700            WHEN SQLCODE = ZERO OR -305                           63570008
635800*            DISPLAY ' R100-FETCH-SUQADJ ' SUT00028-SHIPT-UNT-ID  63580008
635900                 MOVE LENGTH OF DCLTSUQADJ                        63590008
636000                              TO DS009-TBLE-DATA-SIZE             63600008
636100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 63610008
636200                                        + DS009-RECORD-FILLER     63620008
636300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     63630008
636400                 MOVE 'TSUQADJ'            TO DS002-NAME          63640008
636500                 PERFORM DS002-FIND-SEQUENCE                      63650008
636600                 MOVE DCLTSUQADJ           TO DS002-DATA-ITEM     63660008
636700                 INITIALIZE DS009-PKYS                            63670008
636800                 PERFORM DS002-PROCESS-KEYS                       63680008
636900                 MOVE DS008-SUQADJ-KEYS   TO DS009-PKYS           63690008
637000                 MOVE DS009-PKYS          TO DS002-KEYS           63700008
637100                 PERFORM 8000-WRITE-UNLOAD                        63710008
637200                                                                  63720008
637300            WHEN SQLCODE = +100                                   63730008
637400                 SET NO-MORE-SUQADJ-DATA  TO TRUE                 63740008
637500            WHEN SQLCODE = -904                                   63750008
637600            WHEN SQLCODE = -913                                   63760008
637700              CONTINUE                                            63770008
637800           END-EVALUATE                                           63780008
637900     END-PERFORM.                                                 63790008
638000*                                                                 63800008
638100     PERFORM DS002-SQL-ABEND-FETCH.                               63810008
638200                                                                  63820008
642800 R100-FETCH-SUOBTS.                                               64280008
642900*    DISPLAY 'R100-FETCH-SUOBTS'.                                 64290008
643000     MOVE  'TSUOBTS'  TO DS009-PROCESS-TABLE.                     64300008
643100     PERFORM WITH TEST AFTER                                      64310008
643200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   64320008
643300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        64330008
643400                SQLCODE = ZERO OR                                 64340008
643500                SQLCODE = +100                                    64350008
643600        EXEC SQL                                                  64360008
643700            FETCH SUOBTS-CSR                                      64370008
643800            INTO                                                  64380008
643900              :SUOBTS-OTBND-TRIP-ID                               64390008
644000           ,  :SUOBTS-OTBND-STAT-TMST                             64400008
644100           ,  :SUOBTS-TRIP-STAT-CDE                               64410008
644200           ,  :SUOBTS-STAT-OPER-UNT-ID                            64420008
644300           ,  :SUOBTS-OTBND-STAT-USR-ID                           64430008
644400           ,  :SUOBTS-DOOR-ID                                     64440008
644500           ,  :SUOBTS-TRLR-SEAL-ID                                64450008
644600           ,  :SUOBTS-SHIP-SCAC-CDE                               64460008
644700           ,  :SUOBTS-SHIP-DRV-LAST-NM                            64470008
644800           ,  :SUOBTS-SHIP-DRV-FRST-NM                            64480008
644900           ,  :SUOBTS-SHIP-DRV-ID                                 64490008
645000           ,  :SUOBTS-TRLR-PRKG-LOC-DESC                          64500008
645100           ,  :SUOBTS-TRLR-PRKG-SLOT-NBR                          64510008
645200           ,  :SUOBTS-FINCL-POST-TMST                             64520008
645300           ,  :SUOBTS-CPCTY-PCT                                   64530008
645400           ,  :SUOBTS-UNUSD-PLLT-QTY                              64540008
645500           ,  :SUOBTS-LOD-BR-QTY                                  64550008
645600                                                                  64560008
645700         END-EXEC                                                 64570008
645800                                                                  64580008
645900        EVALUATE TRUE                                             64590008
646000            WHEN SQLCODE = ZERO OR -305                           64600008
646100                 MOVE LENGTH OF DCLTSUOBTS                        64610008
646200                              TO DS009-TBLE-DATA-SIZE             64620008
646300                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 64630008
646400                                        + DS009-RECORD-FILLER     64640008
646500                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     64650008
646600                 MOVE 'TSUOBTS'            TO DS002-NAME          64660008
646700                 PERFORM DS002-FIND-SEQUENCE                      64670008
646800                 MOVE DCLTSUOBTS           TO DS002-DATA-ITEM     64680008
646900                 INITIALIZE DS009-PKYS                            64690008
647000                 PERFORM DS002-PROCESS-KEYS                       64700008
647100                 MOVE WS-TSUOBTS-KEYS     TO DS009-PKYS           64710008
647200                 MOVE DS009-PKYS          TO DS002-KEYS           64720008
647300                 PERFORM 8000-WRITE-UNLOAD                        64730008
647400                                                                  64740008
647500            WHEN SQLCODE = +100                                   64750008
647600                 SET NO-MORE-SUOBTS-DATA  TO TRUE                 64760008
647700            WHEN SQLCODE = -904                                   64770008
647800            WHEN SQLCODE = -913                                   64780008
647900              CONTINUE                                            64790008
648000           END-EVALUATE                                           64800008
648100     END-PERFORM.                                                 64810008
648200*                                                                 64820008
648300     PERFORM DS002-SQL-ABEND-FETCH.                               64830008
648400/                                                                 64840008
648500 R100-FETCH-FINCL-ADJ.                                            64850008
648600*    DISPLAY ' R100-FETCH-FINCL-ADJ '  HOLD-PO-NBR ' / '          64860008
648700*                                      HOLD-SHIPT-UNIT-ID         64870008
648800*                                                                 64880008
648900     MOVE  'SUT_FINCL_ADJ'  TO DS009-PROCESS-TABLE.               64890008
649000     PERFORM WITH TEST AFTER                                      64900008
649100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   64910008
649200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        64920008
649300                SQLCODE = ZERO OR +100 OR -305                    64930008
649400        EXEC SQL                                                  64940008
649500            FETCH FINCL-ADJ-CSR                                   64950008
649600            INTO                                                  64960008
649700                :DS008-SUT00030-DATA                              64970008
649800                :DS008-SUT00030-NULLS                             64980008
649900        END-EXEC                                                  64990008
650000                                                                  65000008
650100        EVALUATE TRUE                                             65010008
650200            WHEN SQLCODE = ZERO OR -305                           65020008
650300*    DISPLAY ' R100-FETCH-FINCL-ADJ '  HOLD-PO-NBR                65030008
650400                 MOVE LENGTH OF DS008-DCLSUT00030                 65040008
650500                              TO DS009-TBLE-DATA-SIZE             65050008
650600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 65060008
650700                                        + DS009-RECORD-FILLER     65070008
650800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     65080008
650900                 MOVE 'SUT_FINCL_ADJ'      TO DS002-NAME          65090008
651000                 PERFORM DS002-FIND-SEQUENCE                      65100008
651100                 MOVE DS008-DCLSUT00030    TO DS002-DATA-ITEM     65110008
651200                 INITIALIZE DS009-PKYS                            65120008
651300                 PERFORM DS002-PROCESS-KEYS                       65130008
651400                 MOVE DS008-FINCL-ADJ-KEYS TO DS009-PKYS          65140008
651500                 MOVE DS009-PKYS          TO DS002-KEYS           65150008
651600                 PERFORM 8000-WRITE-UNLOAD                        65160008
651700                                                                  65170008
651800            WHEN SQLCODE = +100                                   65180008
651900*    DISPLAY ' R100-FETCH-FINCL-ADJ SQLCODE=+100 '  HOLD-PO-NBR   65190008
652000                 SET NO-MORE-FINCL-ADJ-DATA TO TRUE               65200008
652100            WHEN SQLCODE = -904                                   65210008
652200            WHEN SQLCODE = -913                                   65220008
652300              CONTINUE                                            65230008
652400           END-EVALUATE                                           65240008
652500     END-PERFORM.                                                 65250008
652600*                                                                 65260008
652700     PERFORM DS002-SQL-ABEND-FETCH.                               65270008
652800/                                                                 65280008
652900 R100-FETCH-SUT00024.                                             65290008
653000*    DISPLAY 'R100-FETCH-SUT00024'.                               65300008
653100*                                                                 65310008
653200     MOVE  'SUT_OTBND_CART'  TO DS009-PROCESS-TABLE.              65320008
653300     PERFORM WITH TEST AFTER                                      65330008
653400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   65340008
653500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        65350008
653600                SQLCODE = ZERO OR +100 OR -305                    65360008
653700        EXEC SQL                                                  65370008
653800            FETCH SUT00024-CSR                                    65380008
653900            INTO                                                  65390008
654000                :DS008-SUT00024-DATA                              65400008
654100                :DS008-SUT00024-NULLS                             65410008
654200        END-EXEC                                                  65420008
654300                                                                  65430008
654400        EVALUATE TRUE                                             65440008
654500            WHEN SQLCODE = ZERO OR -305                           65450008
654600                 MOVE LENGTH OF DS008-DCLSUT00024                 65460008
654700                              TO DS009-TBLE-DATA-SIZE             65470008
654800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 65480008
654900                                        + DS009-RECORD-FILLER     65490008
655000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     65500008
655100                 MOVE 'SUT_OTBND_CART'     TO DS002-NAME          65510008
655200                 PERFORM DS002-FIND-SEQUENCE                      65520008
655300                 MOVE DS008-DCLSUT00024    TO DS002-DATA-ITEM     65530008
655400                 INITIALIZE DS009-PKYS                            65540008
655500                 PERFORM DS002-PROCESS-KEYS                       65550008
655600                 MOVE DS008-SUT00024-KEYS  TO DS009-PKYS          65560008
655700                 MOVE DS009-PKYS          TO DS002-KEYS           65570008
655800                 PERFORM 8000-WRITE-UNLOAD                        65580008
655900                                                                  65590008
656000            WHEN SQLCODE = +100                                   65600008
656100                 SET NO-MORE-SUT00024-DATA TO TRUE                65610008
656200            WHEN SQLCODE = -904                                   65620008
656300            WHEN SQLCODE = -913                                   65630008
656400              CONTINUE                                            65640008
656500           END-EVALUATE                                           65650008
656600     END-PERFORM.                                                 65660008
656700*                                                                 65670008
656800     PERFORM DS002-SQL-ABEND-FETCH.                               65680008
656900                                                                  65690008
657000 R100-FETCH-OTBND-PK.                                             65700008
657100*    DISPLAY 'R100-FETCH-OTBND-PK'.                               65710008
657200*                                                                 65720008
657300     MOVE  'SUT_OTBND_PK'    TO DS009-PROCESS-TABLE.              65730008
657400     PERFORM WITH TEST AFTER                                      65740008
657500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   65750008
657600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        65760008
657700                SQLCODE = ZERO OR +100 OR -305                    65770008
657800        EXEC SQL                                                  65780008
657900            FETCH SUT00041-CSR                                    65790008
658000            INTO                                                  65800008
658100                :DS008-SUT00041-DATA                              65810008
658200        END-EXEC                                                  65820008
658300                                                                  65830008
658400        EVALUATE TRUE                                             65840008
658500            WHEN SQLCODE = ZERO OR -305                           65850008
658600                 MOVE LENGTH OF DS008-DCLSUT00041                 65860008
658700                              TO DS009-TBLE-DATA-SIZE             65870008
658800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 65880008
658900                                        + DS009-RECORD-FILLER     65890008
659000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     65900008
659100                 MOVE 'SUT_OTBND_PK'       TO DS002-NAME          65910008
659200                 PERFORM DS002-FIND-SEQUENCE                      65920008
659300                 MOVE DS008-DCLSUT00041    TO DS002-DATA-ITEM     65930008
659400                 INITIALIZE DS009-PKYS                            65940008
659500                 PERFORM DS002-PROCESS-KEYS                       65950008
659600                 MOVE DS008K-SUT00041-KEYS  TO DS009-PKYS         65960008
659700                 MOVE DS009-PKYS          TO DS002-KEYS           65970008
659800                 PERFORM 8000-WRITE-UNLOAD                        65980008
659900                                                                  65990008
660000            WHEN SQLCODE = +100                                   66000008
660100                 SET DS010-END-OTBND-PK-YES TO TRUE               66010008
660200            WHEN SQLCODE = -904                                   66020008
660300            WHEN SQLCODE = -913                                   66030008
660400              CONTINUE                                            66040008
660500           END-EVALUATE                                           66050008
660600     END-PERFORM.                                                 66060008
660700*                                                                 66070008
660800     PERFORM DS002-SQL-ABEND-FETCH.                               66080008
660900/                                                                 66090008
661000 R100-FETCH-PORCVR-TRKG.                                          66100008
661100     MOVE  'RCT_PO_RCVR_TRKG' TO DS009-PROCESS-TABLE.             66110008
661200     PERFORM WITH TEST AFTER                                      66120008
661300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   66130008
661400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        66140008
661500                SQLCODE = ZERO OR +100 OR -305                    66150008
661600        EXEC SQL                                                  66160008
661700            FETCH RCT00017-CSR                                    66170008
661800            INTO                                                  66180008
661900              :RCT00017-PO-NBR                                    66190008
662000           ,  :RCT00017-RCVR-SEQ-NBR                              66200008
662100           ,  :RCT00017-CRE-BY-USR-ID                             66210008
662200           ,  :RCT00017-CRE-TMST                                  66220008
662300           ,  :RCT00017-DC-FUNC-CDE                               66230008
662400           ,  :RCT00017-LOC-NBR                                   66240008
662500           ,  :RCT00017-PO-LNE-NBR:DS010-NULL-1                   66250008
662600           ,  :RCT00017-PREPK-ID:DS010-NULL-2                     66260008
662700           ,  :RCT00017-CRE-BY-PGM-NM                             66270008
662800           ,  :RCT00017-QTY-TRKD-NBR                              66280008
662900           ,  :RCT00017-LAST-UPD-TMST                             66290008
663000           ,  :RCT00017-PKSL-SEQ-NBR:DS010-NULL-3                 66300008
663100           ,  :RCT00017-DEST-LOC-NBR:DS010-NULL-4                 66310008
663200                                                                  66320008
663300        END-EXEC                                                  66330008
663400                                                                  66340008
663500        EVALUATE TRUE                                             66350008
663600            WHEN SQLCODE = ZERO OR -305                           66360008
663700                 MOVE LENGTH OF DCLRCT00017                       66370008
663800                              TO DS009-TBLE-DATA-SIZE             66380008
663900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 66390008
664000                                        + DS009-RECORD-FILLER     66400008
664100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     66410008
664200                 MOVE 'RCT_PO_RCVR_TRKG'   TO DS002-NAME          66420008
664300                 PERFORM DS002-FIND-SEQUENCE                      66430008
664400                 MOVE DCLRCT00017          TO DS002-DATA-ITEM     66440008
664500                 INITIALIZE DS009-PKYS                            66450008
664600                 PERFORM DS002-PROCESS-KEYS                       66460008
664700                 MOVE DS008-RCT00017-KEYS  TO DS009-PKYS          66470008
664800                 MOVE DS009-PKYS          TO DS002-KEYS           66480008
664900                 PERFORM 8000-WRITE-UNLOAD                        66490008
665000                                                                  66500008
665100            WHEN SQLCODE = +100                                   66510008
665200                 SET DS010-END-RCT00017-YES TO TRUE               66520008
665300            WHEN SQLCODE = -904                                   66530008
665400            WHEN SQLCODE = -913                                   66540008
665500              CONTINUE                                            66550008
665600           END-EVALUATE                                           66560008
665700     END-PERFORM.                                                 66570008
665800*                                                                 66580008
665900     PERFORM DS002-SQL-ABEND-FETCH.                               66590008
666000                                                                  66600008
666100/                                                                 66610008
666200 R100-FETCH-IMT-STYL-PRTNR.                                       66620008
666300*                                                                 66630008
666400     MOVE  'IMT_STYL_PRTNR'  TO DS009-PROCESS-TABLE.              66640008
666500     PERFORM WITH TEST AFTER                                      66650008
666600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   66660008
666700        UNTIL   DS009-RETRY-COUNTER > 3 OR                        66670008
666800                SQLCODE = ZERO OR                                 66680008
666900                SQLCODE = +100                                    66690008
667000        EXEC SQL                                                  66700008
667100            FETCH IMT_STYL_PRTNR_CSR                              66710008
667200            INTO                                                  66720008
667300                  :DS008-IMT16-SUB-CL-MDSEAR-ID                   66730008
667400                 ,:DS008-IMT16-VS-ID                              66740008
667500                 ,:DS008-IMT16-BUS-PRTNR-ROL-CDE                  66750008
667600                 ,:DS008-IMT16-ENT-ID                             66760008
667700        END-EXEC                                                  66770008
667800                                                                  66780008
667900        EVALUATE TRUE                                             66790008
668000            WHEN SQLCODE = ZERO OR -305                           66800008
668100                 MOVE LENGTH OF DS008-IMT00016-DATA               66810008
668200                                          TO DS009-TBLE-DATA-SIZE 66820008
668300                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 66830008
668400                                        + DS009-RECORD-FILLER     66840008
668500                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     66850008
668600                 MOVE 'IMT_STYL_PRTNR'     TO DS002-NAME          66860008
668700                 PERFORM DS002-FIND-SEQUENCE                      66870008
668800                 MOVE DS008-IMT00016-DATA  TO DS002-DATA-ITEM     66880008
668900                 INITIALIZE DS009-PKYS                            66890008
669000                 PERFORM DS002-PROCESS-KEYS                       66900008
669100                 MOVE DS008-IMT00016-KEYS TO DS009-PKYS           66910008
669200                 MOVE DS009-PKYS          TO DS002-KEYS           66920008
669300                 PERFORM 8000-WRITE-UNLOAD                        66930008
669400                                                                  66940008
669500            WHEN SQLCODE = +100                                   66950008
669600                 SET DS010-END-IMT00016-YES TO TRUE               66960008
669700            WHEN SQLCODE = -904                                   66970008
669800            WHEN SQLCODE = -913                                   66980008
669900              CONTINUE                                            66990008
670000           END-EVALUATE                                           67000008
670100         END-PERFORM.                                             67010008
670200*                                                                 67020008
670300     PERFORM DS002-SQL-ABEND-FETCH.                               67030008
670400/                                                                 67040008
670500 R100-FETCH-WST00002.                                             67050008
670600*                                                                 67060008
670700     INITIALIZE DCLWST00002                                       67070008
670800                                                                  67080008
670900     MOVE  'WST_SHPMT_XREF_DTL'    TO DS009-PROCESS-TABLE.        67090008
671000     PERFORM WITH TEST AFTER                                      67100008
671100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   67110008
671200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        67120008
671300                SQLCODE = ZERO OR                                 67130008
671400                SQLCODE = +100                                    67140008
671500        EXEC SQL                                                  67150008
671600            FETCH WST-SHIPMT-DTL-CSR                              67160008
671700            INTO                                                  67170008
671800              :WST00002-EXT-SHP-ID                                67180008
671900            , :WST00002-PO-NBR                                    67190008
672000            , :WST00002-PO-LNE-NBR                                67200008
672100            , :WST00002-RCVR-SEQ-NBR                              67210008
672200            , :WST00002-PREPK-ID                                  67220008
672300            , :WST00002-ASN-LVL-CDE                               67230008
672400            , :WST00002-CRE-USR-ID                                67240008
672500            , :WST00002-CRE-TMST                                  67250008
672600            , :WST00002-DWNLD-CDE                                 67260008
672700            , :WST00002-ACTV-CDE                                  67270008
672800            , :WST00002-CRE-PGM-CDE                               67280008
672900        END-EXEC                                                  67290008
673000                                                                  67300008
673100        EVALUATE TRUE                                             67310008
673200            WHEN SQLCODE = ZERO OR -305                           67320008
673300                 MOVE LENGTH OF DCLWST00002                       67330008
673400                                          TO DS009-TBLE-DATA-SIZE 67340008
673500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 67350008
673600                                        + DS009-RECORD-FILLER     67360008
673700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     67370008
673800                 MOVE 'WST_SHPMT_XREF_DTL' TO DS002-NAME          67380008
673900                 PERFORM DS002-FIND-SEQUENCE                      67390008
674000                 MOVE DCLWST00002          TO DS002-DATA-ITEM     67400008
674100                 INITIALIZE DS009-PKYS                            67410008
674200                 PERFORM DS002-PROCESS-KEYS                       67420008
674300                 MOVE DS008-WST00002-KEYS TO DS009-PKYS           67430008
674400                 MOVE DS009-PKYS          TO DS002-KEYS           67440008
674500                 PERFORM 8000-WRITE-UNLOAD                        67450008
674600                                                                  67460008
674700*                GET THE ONE AND ONLY HEADER FOR THIS DETAIL CSR  67470008
674800                 MOVE WST00002-EXT-SHP-ID TO DS010-EXT-SHP-ID     67480008
674900                 PERFORM R101-SELECT-WST00001                     67490008
675000                                                                  67500008
675100            WHEN SQLCODE = +100                                   67510008
675200                 SET DS010-END-WST00002-YES TO TRUE               67520008
675300            WHEN SQLCODE = -904                                   67530008
675400            WHEN SQLCODE = -913                                   67540008
675500              CONTINUE                                            67550008
675600           END-EVALUATE                                           67560008
675700         END-PERFORM.                                             67570008
675800*                                                                 67580008
675900     PERFORM DS002-SQL-ABEND-FETCH.                               67590008
676000                                                                  67600008
676100 R101-SELECT-WST00001.                                            67610008
676200     INITIALIZE DS008-DCLWST00001                                 67620008
676300                                                                  67630008
676400     EXEC SQL                                                     67640008
676500         SELECT                                                   67650008
676600             EXT_SHP_ID                                           67660008
676700            ,INTR_TRIP_ID                                         67670008
676800            ,SOR_CDE                                              67680008
676900            ,DMY_SEQ_NBR                                          67690008
677000            ,DEST_LOC_NBR                                         67700008
677100            ,DWNLD_CDE                                            67710008
677200            ,RCPT_TMST                                            67720008
677300            ,CRE_USR_ID                                           67730008
677400            ,CRE_TMST                                             67740008
677500            ,DWNLD_TMST                                           67750008
677600            ,LAST_PRCG_TMST                                       67760008
677700            ,PRC_CDE                                              67770008
677800            ,VER_NBR                                              67780008
677900            ,CRE_PGM_CDE                                          67790008
678000                                                                  67800008
678100             INTO                                                 67810008
678200             :DS008-DCLWST00001-DATA                              67820008
678300             :DS008-DST00001-NULLS                                67830008
678400*             :DS008-EXT-SHP-ID                                   67840008
678500*          ,  :DS008-INTR-TRIP-ID                                 67850008
678600*          ,  :DS008-SOR-CDE                                      67860008
678700*          ,  :DS008-DMY-SEQ-NBR                                  67870008
678800*          ,  :DS008-DEST-LOC-NBR                                 67880008
678900*          ,  :DS008-DWNLD-CDE                                    67890008
679000*          ,  :DS008-RCPT-TMST                                    67900008
679100*          ,  :DS008-CRE-USR-ID                                   67910008
679200*          ,  :DS008-CRE-TMST                                     67920008
679300*          ,  :DS008-DWNLD-TMST                                   67930008
679400*          ,  :DS008-LAST-PRCG-TMST                               67940008
679500*          ,  :DS008-PRC-CDE                                      67950008
679600*          ,  :DS008-VER-NBR                                      67960008
679700*          ,  :DS008-CRE-PGM-CDE                                  67970008
679800                                                                  67980008
679900         FROM WST_SHPMT_XREF_HDR                                  67990008
680000         WHERE EXT_SHP_ID = :DS010-EXT-SHP-ID                     68000008
680100         WITH UR                                                  68010008
680200     END-EXEC.                                                    68020008
680300                                                                  68030008
680400     EVALUATE TRUE                                                68040008
680500         WHEN SQLCODE = ZERO                                      68050008
680600             MOVE 'WST_SHPMT_XREF_HDR' TO DS009-PROCESS-TABLE     68060008
680700             MOVE LENGTH OF DCLWST00001                           68070008
680800                              TO DS009-TBLE-DATA-SIZE             68080008
680900             COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE     68090008
681000                                        + DS009-RECORD-FILLER     68100008
681100             MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE         68110008
681200             MOVE 'WST_SHPMT_XREF_HDR' TO DS002-NAME              68120008
681300             PERFORM DS002-FIND-SEQUENCE                          68130008
681400             MOVE DS008-DCLWST00001          TO DS002-DATA-ITEM   68140008
681500             INITIALIZE DS009-PKYS                                68150008
681600             PERFORM DS002-PROCESS-KEYS                           68160008
681700             MOVE DS008-WST00001-KEYS  TO DS009-PKYS              68170008
681800             MOVE DS009-PKYS           TO DS002-KEYS              68180008
681900             PERFORM 8000-WRITE-UNLOAD                            68190008
682000                                                                  68200008
682100            WHEN SQLCODE = +100                                   68210008
682200                 CONTINUE                                         68220008
682300            WHEN SQLCODE = -904                                   68230008
682400            WHEN SQLCODE = -913                                   68240008
682500              CONTINUE                                            68250008
682600     END-EVALUATE.                                                68260008
682700/                                                                 68270008
292700 R100-FETCH-FGTRST.                                               68271014
292800*    DISPLAY 'R100-FETCH-FGTRST'.                                 68272014
292900*                                                                 68273014
293000     MOVE 'TFGTRST' TO DS009-PROCESS-TABLE.                       68274024
293100     PERFORM WITH TEST AFTER                                      68275014
293200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   68276014
293300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        68277014
293400                SQLCODE = ZERO OR                                 68278014
293500                SQLCODE = +100                                    68279014
293600        EXEC SQL                                                  68279114
293700            FETCH FGTRST-CSR                                      68279217
293800            INTO                                                  68279314
293900                :WS-FGTRST-TP-DKEY                                68279414
294000               ,:WS-FGTRST-TP-DKEY-TMST                           68279514
294100               ,:WS-FGTRST-FUNC-CDE-SEQ-NBR                       68279614
294200               ,:WS-FGTRST-TRN-SET-SEQ-NBR                        68279714
294300               ,:WS-FGTRST-TRN-SET-CDE                            68279814
294400               ,:WS-FGTRST-FUNC-CDE-CNTL-NBR                      68279914
294500               ,:WS-FGTRST-VEND-ACK-IND                           68280014
294600               ,:WS-FGTRST-TRN-SET-CNTL-NBR                       68280114
294700               ,:WS-FGTRST-TRN-DTL-TXT                            68280214
294800               ,:WS-FGTRST-CHARS-XMIT-NBR                         68280314
294900               ,:WS-FGTRST-RTE-IND                                68280414
295000               ,:WS-FGTRST-TRANSL-ERR-IND                         68280514
295100               ,:WS-FGTRST-TRN-RLSE-TMST :DK-TRN-RLSE-NULL        68280625
295200               ,:WS-FGTRST-PO-ACKNL-STAT-CDE                      68280714
296200        END-EXEC                                                  68281714
296300                                                                  68281814
296400        EVALUATE TRUE                                             68281914
296500            WHEN SQLCODE = ZERO OR -305                           68282014
296600                 MOVE LENGTH OF WS-FGTRST TO DS009-TBLE-DATA-SIZE 68282114
296700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 68282214
296800                                           + DS009-RECORD-FILLER  68282314
296900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     68282414
297000                 MOVE 'TFGTRST'           TO DS002-NAME           68282514
297100                 PERFORM DS002-FIND-SEQUENCE                      68282614
297200                 MOVE WS-FGTRST           TO DS002-DATA-ITEM      68282714
297300                 INITIALIZE DS009-PKYS                            68282814
297400                 PERFORM DS002-PROCESS-KEYS                       68282914
297500                 MOVE WS-FGTRST-KEYS TO DS009-PKYS                68283014
297600                 MOVE DS009-PKYS      TO DS002-KEYS               68283114
297700                 PERFORM 8000-WRITE-UNLOAD                        68283214
297800            WHEN SQLCODE = +100                                   68283314
297900                 SET NO-MORE-FGTRST-DATA  TO TRUE                 68283414
298000            WHEN SQLCODE = -904                                   68283514
298100            WHEN SQLCODE = -913                                   68283614
298200              CONTINUE                                            68283714
298300           END-EVALUATE                                           68283814
298400         END-PERFORM.                                             68283914
298500*                                                                 68284014
298600     PERFORM DS002-SQL-ABEND-FETCH.                               68284114
298700/                                                                 68284214
292700 R100-FETCH-INTTRN.                                               68284324
292800*    DISPLAY 'R100-FETCH-INTTRN'.                                 68284424
292900*                                                                 68284524
293000     MOVE 'TINTTRN' TO DS009-PROCESS-TABLE.                       68284624
293100     PERFORM WITH TEST AFTER                                      68284724
293200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   68284824
293300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        68284924
293400                SQLCODE = ZERO OR                                 68285024
293500                SQLCODE = +100                                    68285124
293600        EXEC SQL                                                  68285224
293700            FETCH INTTRN-CSR                                      68285324
293800            INTO                                                  68285424
293900                :WS-INTTRN-TP-DKEY                                68285524
294000               ,:WS-INTTRN-TP-DKEY-TMST                           68285624
294100               ,:WS-INTTRN-DIR-IND                                68285724
294200               ,:WS-INTTRN-INCHG-CNTL-NBR                         68285824
294300               ,:WS-INTTRN-CRE-DTE                                68285924
294300               ,:WS-INTTRN-CRE-TME                                68286029
294400               ,:WS-INTTRN-MAILBOX-REC-DTE                        68286129
294500               ,:WS-INTTRN-MAILBOX-REC-TME                        68286229
294600               ,:WS-INTTRN-MAILBOX-PU-DTE                         68286329
294700               ,:WS-INTTRN-MAILBOX-PU-TME                         68286429
294800               ,:WS-INTTRN-ERR-IND                                68286529
294900               ,:WS-INTTRN-PROD-TEST-IND                          68286629
295000               ,:WS-INTTRN-TRANSL-SESS-ID                         68286729
295100               ,:WS-INTTRN-TRN-MANL-FRCD-IND                      68286829
296200        END-EXEC                                                  68286924
296300                                                                  68287024
296400        EVALUATE TRUE                                             68287124
296500            WHEN SQLCODE = ZERO OR -305                           68287224
296600                 MOVE LENGTH OF WS-INTTRN TO DS009-TBLE-DATA-SIZE 68287527
296700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 68287627
296800                                           + DS009-RECORD-FILLER  68287727
296900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     68287827
297000                 MOVE 'TINTTRN'           TO DS002-NAME           68287927
297100                 PERFORM DS002-FIND-SEQUENCE                      68288027
297200                 MOVE WS-INTTRN           TO DS002-DATA-ITEM      68288127
297300                 INITIALIZE DS009-PKYS                            68288227
297400                 PERFORM DS002-PROCESS-KEYS                       68288327
297500                 MOVE WS-INTTRN-KEYS TO DS009-PKYS                68288427
297600                 MOVE DS009-PKYS      TO DS002-KEYS               68288527
297700                 PERFORM 8000-WRITE-UNLOAD                        68288627
297800            WHEN SQLCODE = +100                                   68288727
297900                 SET NO-MORE-INTTRN-DATA  TO TRUE                 68288827
298000            WHEN SQLCODE = -904                                   68288927
298100            WHEN SQLCODE = -913                                   68289027
298200              CONTINUE                                            68289127
298300           END-EVALUATE                                           68289227
298400         END-PERFORM.                                             68289327
298500*                                                                 68289427
298600     PERFORM DS002-SQL-ABEND-FETCH.                               68289527
298700/                                                                 68289627
682800 S100-SELECT-OTBND-CART.                                          68289727
682900*    DISPLAY 'S100-SELECT-OTBND-CART'.                            68290008
683000     INITIALIZE DCLSUT00024                                       68300008
683100     EXEC SQL                                                     68310008
683200     SELECT                                                       68320008
683300         SHIPT_UNT_ID                                             68330008
683400        ,ORGN_LOC_NBR                                             68340008
683500        ,DEST_LOC_NBR                                             68350008
683600        ,CART_SRC_CDE                                             68360008
683700        ,CRE_DTE                                                  68370008
683800        ,CRE_TM                                                   68380008
683900        ,CRE_USR_ID                                               68390008
684000        ,CRE_PGM_NM                                               68400008
684100        ,MSTR_CART_IND                                            68410008
684200        ,PRNT_CART_ID                                             68420008
684300        ,ORIG_CART_ID                                             68430008
684400        ,CART_TYP_CDE                                             68440008
684500        ,LBL_PRT_SEQ_NBR                                          68450008
684600        ,CART_RVSN_NBR                                            68460008
684700        ,OTBND_TRIP_ID                                            68470008
684800        ,ACTV_IND                                                 68480008
684900        ,ODD_UNT_IND                                              68490008
685000     INTO                                                         68500008
685100       :SUT00024-SHIPT-UNT-ID                                     68510008
685200     , :SUT00024-ORGN-LOC-NBR                                     68520008
685300     , :SUT00024-DEST-LOC-NBR                                     68530008
685400     , :SUT00024-CART-SRC-CDE                                     68540008
685500     , :SUT00024-CRE-DTE                                          68550008
685600     , :SUT00024-CRE-TM                                           68560008
685700     , :SUT00024-CRE-USR-ID                                       68570008
685800     , :SUT00024-CRE-PGM-NM                                       68580008
685900     , :SUT00024-MSTR-CART-IND                                    68590008
686000     , :SUT00024-PRNT-CART-ID                                     68600008
686100     , :SUT00024-ORIG-CART-ID                                     68610008
686200     , :SUT00024-CART-TYP-CDE                                     68620008
686300     , :SUT00024-LBL-PRT-SEQ-NBR                                  68630008
686400     , :SUT00024-CART-RVSN-NBR                                    68640008
686500     , :SUT00024-OTBND-TRIP-ID:DK-TRIP-NULL-ID                    68650008
686600     , :SUT00024-ACTV-IND                                         68660008
686700     , :SUT00024-ODD-UNT-IND                                      68670008
686800         FROM                                                     68680008
686900             SUT_OTBND_CART                                       68690008
687000         WHERE                                                    68700008
687100               SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID              68710008
687200         WITH UR                                                  68720008
687300     END-EXEC.                                                    68730008
687400                                                                  68740008
687500     EVALUATE TRUE                                                68750008
687600         WHEN SQLCODE = ZERO                                      68760008
687700*            MOVE SUT00028-SHIPT-UNT-ID TO PV-DISP-NBR            68770008
687800*            DISPLAY 'OTBND-CART-SHIPT-UNT-ID = '                 68780008
687900*                PV-DISP-NBR                                      68790008
688000             MOVE 'SUT_OTBND_CART' TO DS009-PROCESS-TABLE         68800008
688100             MOVE LENGTH OF DCLSUT00024                           68810008
688200                              TO DS009-TBLE-DATA-SIZE             68820008
688300             COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE     68830008
688400                                        + DS009-RECORD-FILLER     68840008
688500             MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE         68850008
688600             MOVE 'SUT_OTBND_CART'     TO DS002-NAME              68860008
688700                 PERFORM DS002-FIND-SEQUENCE                      68870008
688800             MOVE DCLSUT00024          TO DS002-DATA-ITEM         68880008
688900             INITIALIZE DS009-PKYS                                68890008
689000             PERFORM DS002-PROCESS-KEYS                           68900008
689100             MOVE WS-OTBCART-KEYS      TO DS009-PKYS              68910008
689200             MOVE DS009-PKYS           TO DS002-KEYS              68920008
689300             PERFORM 8000-WRITE-UNLOAD                            68930008
689400                                                                  68940008
689500            WHEN SQLCODE = +100                                   68950008
689600             MOVE SUT00028-SHIPT-UNT-ID TO PV-DISP-NBR            68960008
689700*            DISPLAY 'CART NOT FOUND -  '                         68970008
689800*                PV-DISP-NBR                                      68980008
689900                 CONTINUE                                         68990008
690000            WHEN SQLCODE = -904                                   69000008
690100            WHEN SQLCODE = -913                                   69010008
690200              CONTINUE                                            69020008
690300     END-EVALUATE.                                                69030008
690400/                                                                 69040008
690500*  SELECT OUTBOUND TRIP ATTACHED TO OUTBOUND CTNS                 69050008
690600 S100-SELECT-TSUOBTR.                                             69060008
690700*    DISPLAY 'S100-SELECT-TSUOBTR'.                               69070008
690800     PERFORM WITH TEST AFTER                                      69080008
690900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   69090008
691000        UNTIL   DS009-RETRY-COUNTER > 3 OR                        69100008
691100                SQLCODE = ZERO OR                                 69110008
691200                SQLCODE = +100                                    69120008
691300         EXEC SQL                                                 69130008
691400         SELECT                                                   69140008
691500             OTBND_TRIP_ID                                        69150008
691600            ,ORGN_OPER_UNT_ID                                     69160008
691700            ,DEST_OPER_UNT_ID                                     69170008
691800            ,TRLR_SRL_NBR                                         69180008
691900            ,BOL_ID                                               69190008
692000            ,EST_ARRVL_TMST                                       69200008
692100            ,TRIP_ACTV_CDE                                        69210008
692200            ,DOOR_TYP_CDE                                         69220008
692300         INTO                                                     69230008
692400             :SUOBTR-OTBND-TRIP-ID                                69240008
692500           , :SUOBTR-ORGN-OPER-UNT-ID                             69250008
692600           , :SUOBTR-DEST-OPER-UNT-ID                             69260008
692700           , :SUOBTR-TRLR-SRL-NBR                                 69270008
692800           , :SUOBTR-BOL-ID                                       69280008
692900           , :SUOBTR-EST-ARRVL-TMST                               69290008
693000           , :SUOBTR-TRIP-ACTV-CDE                                69300008
693100           , :SUOBTR-DOOR-TYP-CDE                                 69310008
693200         FROM                                                     69320008
693300             TSUOBTR                                              69330008
693400         WHERE OTBND_TRIP_ID    = :SUT00024-OTBND-TRIP-ID         69340008
693500         WITH UR                                                  69350008
693600         END-EXEC                                                 69360008
693700     END-PERFORM.                                                 69370008
693800*                                                                 69380008
693900     EVALUATE TRUE                                                69390008
694000         WHEN SQLCODE = ZERO                                      69400008
694100             MOVE 'TSUOBTR' TO DS009-PROCESS-TABLE                69410008
694200                               DS002-NAME                         69420008
694300                 PERFORM DS002-FIND-SEQUENCE                      69430008
694400             MOVE LENGTH OF DCLTSUOBTR                            69440008
694500                              TO DS009-TBLE-DATA-SIZE             69450008
694600             COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE     69460008
694700                                        + DS009-RECORD-FILLER     69470008
694800             MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE         69480008
694900             MOVE DCLTSUOBTR           TO DS002-DATA-ITEM         69490008
695000             INITIALIZE DS009-PKYS                                69500008
695100             PERFORM DS002-PROCESS-KEYS                           69510008
695200             MOVE WS-TSUOBTR-KEYS      TO DS009-PKYS              69520008
695300             MOVE DS009-PKYS           TO DS002-KEYS              69530008
695400             PERFORM 8000-WRITE-UNLOAD                            69540008
695500                                                                  69550008
695600            WHEN SQLCODE = +100                                   69560008
695700                 CONTINUE                                         69570008
695800            WHEN SQLCODE = -904                                   69580008
695900            WHEN SQLCODE = -913                                   69590008
696000              CONTINUE                                            69600008
696100     END-EVALUATE.                                                69610008
696200/                                                                 69620008
696300 S100-SELECT-OTBND-VND.                                           69630008
696400*    DISPLAY 'S100-SELECT-OTBND-VND'.                             69640008
696500     INITIALIZE DCLSUT00026                                       69650008
696600     EXEC SQL                                                     69660008
696700     SELECT                                                       69670008
696800         SHIPT_UNT_ID                                             69680008
696900     ,   PO_NBR                                                   69690008
697000     ,   PKSL_SEQ_NBR                                             69700008
697100     INTO                                                         69710008
697200        :SUT00026-SHIPT-UNT-ID                                    69720008
697300     ,  :SUT00026-PO-NBR                                          69730008
697400     ,  :SUT00026-PKSL-SEQ-NBR                                    69740008
697500     FROM                                                         69750008
697600         SUT_OTBND_VND                                            69760008
697700     WHERE                                                        69770008
697800         SHIPT_UNT_ID = :SUT00028-SHIPT-UNT-ID                    69780008
697900     WITH UR                                                      69790008
698000     END-EXEC.                                                    69800008
698100                                                                  69810008
698200     EVALUATE TRUE                                                69820008
698300         WHEN SQLCODE = ZERO                                      69830008
698400             MOVE 'SUT_OTBND_VND' TO DS009-PROCESS-TABLE          69840008
698500             MOVE LENGTH OF DCLSUT00026                           69850008
698600                              TO DS009-TBLE-DATA-SIZE             69860008
698700             COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE     69870008
698800                                        + DS009-RECORD-FILLER     69880008
698900             MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE         69890008
699000             MOVE 'SUT_OTBND_VND'      TO DS002-NAME              69900008
699100                 PERFORM DS002-FIND-SEQUENCE                      69910008
699200             MOVE DCLSUT00026          TO DS002-DATA-ITEM         69920008
699300             INITIALIZE DS009-PKYS                                69930008
699400             PERFORM DS002-PROCESS-KEYS                           69940008
699500             MOVE DS008K-OTBVND-SHIPT-UNT-ID TO DS009-PKYS        69950008
699600             MOVE DS009-PKYS                 TO DS002-KEYS        69960008
699700             PERFORM 8000-WRITE-UNLOAD                            69970008
699800                                                                  69980008
699900            WHEN SQLCODE = +100                                   69990008
700000                 CONTINUE                                         70000008
700100*            MOVE SUT00028-SHIPT-UNT-ID TO PV-DISP-NBR            70010008
700200*            DISPLAY 'VND NOT FOUND -  '                          70020008
700300*                PV-DISP-NBR                                      70030008
700400            WHEN SQLCODE = -904                                   70040008
700500            WHEN SQLCODE = -913                                   70050008
700600              CONTINUE                                            70060008
700700     END-EVALUATE.                                                70070008
700800/                                                                 70080008
700900 S100-SELECT-XLT-VND-STYL.                                        70090008
701000*    DISPLAY 'S100-SELECT-XLT-VND-STYL'                           70100008
701100     INITIALIZE DCLXLT00004                                       70110008
701200     EXEC SQL                                                     70120008
701300     SELECT                                                       70130008
701400       STYL_ID                                                    70140008
701500      ,DEPT_NBR                                                   70150008
701600      ,MAJ_CL_NBR                                                 70160008
701700      ,SUB_CL_NBR                                                 70170008
701800      ,VS_ID                                                      70180008
701900      ,VS_NBR                                                     70190008
702000      ,ENT_ID                                                     70200008
702100      ,STKR_NBR                                                   70210008
702200      ,TKT_TYP_DESC                                               70220008
702300      ,HNG_FOLD_DESC                                              70230008
702400****CLP 08/04/2015 - INCLUDE BRND_ID ONCE COLUMN IN PROD          70240008
702500      ,BRND_ID                                                    70250008
702600       INTO                                                       70260008
702700          :XLT00004-STYL-ID                                       70270008
702800     ,    :XLT00004-DEPT-NBR                                      70280008
702900     ,    :XLT00004-MAJ-CL-NBR                                    70290008
703000     ,    :XLT00004-SUB-CL-NBR                                    70300008
703100     ,    :XLT00004-VS-ID                                         70310008
703200     ,    :XLT00004-VS-NBR                                        70320008
703300     ,    :XLT00004-ENT-ID                                        70330008
703400     ,    :XLT00004-STKR-NBR                                      70340008
703500     ,    :XLT00004-TKT-TYP-DESC                                  70350008
703600     ,    :XLT00004-HNG-FOLD-DESC                                 70360008
703700****CLP 08/04/2015 - INCLUDE BRND_ID ONCE COLUMN IN PROD          70370008
703800     ,    :XLT00004-BRND-ID                                       70380008
703900     FROM                                                         70390008
704000         XLT_VND_STYL                                             70400008
704100     WHERE                                                        70410008
704200         STYL_ID      = :XLT00003-STYL-ID                         70420008
704300     WITH UR                                                      70430008
704400     END-EXEC.                                                    70440008
704500                                                                  70450008
704600     EVALUATE TRUE                                                70460008
704700         WHEN SQLCODE = ZERO                                      70470008
704800             MOVE 'XLT_VND_STYL' TO DS009-PROCESS-TABLE           70480008
704900             MOVE LENGTH OF DCLXLT00004                           70490008
705000                              TO DS009-TBLE-DATA-SIZE             70500008
705100             COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE     70510008
705200                                        + DS009-RECORD-FILLER     70520008
705300             MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE         70530008
705400             MOVE 'XLT_VND_STYL'       TO DS002-NAME              70540008
705500                 PERFORM DS002-FIND-SEQUENCE                      70550008
705600             MOVE DCLXLT00004          TO DS002-DATA-ITEM         70560008
705700             INITIALIZE DS009-PKYS                                70570008
705800             PERFORM DS002-PROCESS-KEYS                           70580008
705900             MOVE DS008-XLTVNDSTYL-KEYS      TO DS009-PKYS        70590008
706000             MOVE DS009-PKYS                 TO DS002-KEYS        70600008
706100             PERFORM 8000-WRITE-UNLOAD                            70610008
706200                                                                  70620008
706300            WHEN SQLCODE = +100                                   70630008
706400                 CONTINUE                                         70640008
706500            WHEN SQLCODE = -904                                   70650008
706600            WHEN SQLCODE = -913                                   70660008
706700              CONTINUE                                            70670008
706800     END-EVALUATE.                                                70680008
706900/                                                                 70690008
707000 S110-SELECT-VSCHVL.                                              70700008
707100     PERFORM WITH TEST AFTER                                      70710008
707200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   70720008
707300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        70730008
707400                SQLCODE = ZERO OR                                 70740008
707500                SQLCODE = +100                                    70750008
707600        EXEC SQL                                                  70760008
707700            SELECT                                                70770008
707800                   CHARTC_CDE                                     70780008
707900                  ,CHARTC_SEQ_NBR                                 70790008
708000                  ,CHARTC_VAL_DESC                                70800008
708100                  ,STAT_CDE                                       70810008
708200              INTO                                                70820008
708300                   :WS-VSCHVL-CHARTC-CDE                          70830008
708400                  ,:WS-VSCHVL-CHARTC-SEQ-NBR                      70840008
708500                  ,:WS-VSCHVL-CHARTC-VAL-DESC                     70850008
708600                  ,:WS-VSCHVL-STAT-CDE                            70860008
708700              FROM                                                70870008
708800                   TVSCHVL                                        70880008
708900             WHERE CHARTC_CDE     = :HOLD-CHARTC-CDE              70890008
709000               AND CHARTC_SEQ_NBR = :HOLD-CHARTC-SEQ-NBR          70900008
709100              WITH UR                                             70910008
709200        END-EXEC                                                  70920008
709300                                                                  70930008
709400        EVALUATE TRUE                                             70940008
709500            WHEN SQLCODE = ZERO                                   70950008
709600                 MOVE LENGTH OF WS-VSCHVL TO DS009-TBLE-DATA-SIZE 70960008
709700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 70970008
709800                                        + DS009-RECORD-FILLER     70980008
709900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     70990008
710000                 MOVE 'TVSCHVL'            TO DS002-NAME          71000008
710100                 PERFORM DS002-FIND-SEQUENCE                      71010008
710200                 MOVE WS-VSCHVL            TO DS002-DATA-ITEM     71020008
710300                 INITIALIZE DS009-PKYS                            71030008
710400                 PERFORM DS002-PROCESS-KEYS                       71040008
710500                 MOVE WS-VSCHVL-KEYS      TO DS009-PKYS           71050008
710600                 MOVE DS009-PKYS          TO DS002-KEYS           71060008
710700                 PERFORM 8000-WRITE-UNLOAD                        71070008
710800                                                                  71080008
710900            WHEN SQLCODE = +100                                   71090008
711000            WHEN SQLCODE = -904                                   71100008
711100            WHEN SQLCODE = -913                                   71110008
711200              CONTINUE                                            71120008
711300           END-EVALUATE                                           71130008
711400     END-PERFORM.                                                 71140008
711500*                                                                 71150008
711600     PERFORM DS002-SQL-ABEND-FETCH.                               71160008
711700/                                                                 71170008
711800 S120-SELECT-IMT-LBL.                                             71180008
711900     PERFORM WITH TEST AFTER                                      71190008
712000        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   71200008
712100        UNTIL   DS009-RETRY-COUNTER > 3 OR                        71210008
712200                SQLCODE = ZERO OR                                 71220008
712300                SQLCODE = +100                                    71230008
712400        EXEC SQL                                                  71240008
712500            SELECT                                                71250008
712600                   LBL_SEQ_NBR                                    71260008
712700                  ,LBL_TYP_CDE                                    71270008
712800                  ,LBL_ABBR_NM                                    71280008
712900                  ,PRIC_TIER_SEQ_NBR                              71290008
713000                  ,LFSTYL_SEQ_NBR                                 71300008
713100              INTO                                                71310008
713200                   :DS008-IMT00-LBL-SEQ-NBR                       71320008
713300                  ,:DS008-IMT00-LBL-TYP-CDE                       71330008
713400                  ,:DS008-IMT00-LBL-ABBR-NM                       71340008
713500                  ,:DS008-IMT00-PRIC-TIER-SEQ-NBR                 71350008
713600                  ,:DS008-IMT00-LFSTYL-SEQ-NBR                    71360008
713700              FROM                                                71370008
713800                   IMT_LBL                                        71380008
713900             WHERE LBL_SEQ_NBR = :DS010-LBL-SEQ-NBR               71390008
714000              WITH UR                                             71400008
714100        END-EXEC                                                  71410008
714200                                                                  71420008
714300        EVALUATE TRUE                                             71430008
714400            WHEN SQLCODE = ZERO                                   71440008
714500                 MOVE LENGTH OF DS008-DCLIMT00000                 71450008
714600                                          TO DS009-TBLE-DATA-SIZE 71460008
714700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 71470008
714800                                        + DS009-RECORD-FILLER     71480008
714900                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE     71490008
715000                 MOVE 'IMT_LBL'            TO DS002-NAME          71500008
715100                 PERFORM DS002-FIND-SEQUENCE                      71510008
715200                 MOVE DS008-DCLIMT00000    TO DS002-DATA-ITEM     71520008
715300                 INITIALIZE DS009-PKYS                            71530008
715400                 PERFORM DS002-PROCESS-KEYS                       71540008
715500                 MOVE DS008-IMT00000-KEYS TO DS009-PKYS           71550008
715600                 MOVE DS009-PKYS          TO DS002-KEYS           71560008
715700                 PERFORM 8000-WRITE-UNLOAD                        71570008
715800                                                                  71580008
715900            WHEN SQLCODE = +100                                   71590008
716000            WHEN SQLCODE = -904                                   71600008
716100            WHEN SQLCODE = -913                                   71610008
716200              CONTINUE                                            71620008
716300           END-EVALUATE                                           71630008
716400     END-PERFORM.                                                 71640008
716500*                                                                 71650008
716600     PERFORM DS002-SQL-ABEND-FETCH.                               71660008
716700/                                                                 71670008
716800 Y100-OPEN-CURSOR.                                                71680008
716900                                                                  71690008
717000*    DISPLAY 'Y100-OPEN-CURSOR ' DS009-PROCESS-TABLE              71700008
717100                                                                  71710008
717200     PERFORM WITH TEST AFTER                                      71720008
717300             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              71730008
717400             UNTIL   DS009-RETRY-COUNTER > 3 OR                   71740008
717500                     SQLCODE = ZERO OR -310                       71750008
717600                                                                  71760008
717700             EVALUATE TRUE                                        71770008
717800             WHEN DS009-PROCESS-TABLE = 'TPURCHS'                 71780008
717900               EXEC SQL                                           71790008
718000                  OPEN PURCHS_CSR                                 71800008
718100               END-EXEC                                           71810008
718200             WHEN DS009-PROCESS-TABLE = 'TPOAGMT'                 71820008
718300               EXEC SQL                                           71830008
718400                  OPEN POAGMT_CSR                                 71840008
718500               END-EXEC                                           71850008
718600             WHEN DS009-PROCESS-TABLE = 'TPOINST'                 71860008
718700               EXEC SQL                                           71870008
718800                  OPEN POINST_CSR                                 71880008
718900               END-EXEC                                           71890008
719000             WHEN DS009-PROCESS-TABLE = 'TIMPORL'                 71900008
719100               EXEC SQL                                           71910008
719200                  OPEN IMPORL_CSR                                 71920008
719300               END-EXEC                                           71930008
719400             WHEN DS009-PROCESS-TABLE = 'TALLPLN'                 71940008
719500               EXEC SQL                                           71950008
719600                  OPEN ALLPLN_CSR                                 71960008
719700               END-EXEC                                           71970008
719800             WHEN DS009-PROCESS-TABLE = 'TPLNSHP'                 71980008
719900               EXEC SQL                                           71990008
720000                  OPEN PLNSHP_CSR                                 72000008
720100               END-EXEC                                           72010008
720200             WHEN DS009-PROCESS-TABLE = 'TSK'                     72020008
720300               EXEC SQL                                           72030008
720400                  OPEN SK_CSR                                     72040008
720500               END-EXEC                                           72050008
720600             WHEN DS009-PROCESS-TABLE = 'TSKST'                   72060008
720700               EXEC SQL                                           72070008
720800                  OPEN SKST-CSR                                   72080008
720900               END-EXEC                                           72090008
721000             WHEN DS009-PROCESS-TABLE = 'TPPCPRC'                 72100008
721100               EXEC SQL                                           72110008
721200                  OPEN PPCPRC_CSR                                 72120008
721300               END-EXEC                                           72130008
721400             WHEN DS009-PROCESS-TABLE = 'TUPC'                    72140008
721500               EXEC SQL                                           72150008
721600                  OPEN UPC-CSR                                    72160008
721700               END-EXEC                                           72170008
721800             WHEN DS009-PROCESS-TABLE = 'TUPCSKU'                 72180008
721900               EXEC SQL                                           72190008
722000                  OPEN UPCSKU_CSR                                 72200008
722100               END-EXEC                                           72210008
722200             WHEN DS009-PROCESS-TABLE = 'TSKXREF'                 72220008
722300               EXEC SQL                                           72230008
722400                  OPEN SKXREF_CSR                                 72240008
722500               END-EXEC                                           72250008
722600             WHEN DS009-PROCESS-TABLE = 'TUPCPLS'                 72260008
722700               EXEC SQL                                           72270008
722800                  OPEN UPCPLS_CSR                                 72280008
722900               END-EXEC                                           72290008
723000             WHEN DS009-PROCESS-TABLE = 'TMDSEAR'                 72300008
723100               EXEC SQL                                           72310008
723200                  OPEN MDSEAR_CSR                                 72320008
723300               END-EXEC                                           72330008
723400             WHEN DS009-PROCESS-TABLE = 'TMDARVS'                 72340008
723500               EXEC SQL                                           72350008
723600                  OPEN MDARVS_CSR                                 72360008
723700               END-EXEC                                           72370008
723800             WHEN DS009-PROCESS-TABLE = 'TVNDSTL'                 72380008
723900               EXEC SQL                                           72390008
724000                  OPEN VNDSTL_CSR                                 72400008
724100               END-EXEC                                           72410008
724200             WHEN DS009-PROCESS-TABLE = 'XLT_SKU'                 72420008
724300               EXEC SQL                                           72430008
724400                  OPEN XLTSKU-CSR                                 72440008
724500               END-EXEC                                           72450008
724600             WHEN DS009-PROCESS-TABLE = 'XLT_UPC'                 72460008
724700*              MOVE HOLD-INTR-UPC-ID  TO PV-DISP-NBR              72470008
724800*              DISPLAY 'HOLD-INTR-UPC-ID = ' PV-DISP-NBR          72480008
724900               EXEC SQL                                           72490008
725000                  OPEN XLTUPC-CSR                                 72500008
725100               END-EXEC                                           72510008
725200             WHEN DS009-PROCESS-TABLE = 'TPURITM'                 72520008
725300               EXEC SQL                                           72530008
725400                  OPEN PURITM_CSR                                 72540008
725500               END-EXEC                                           72550008
725600             WHEN DS009-PROCESS-TABLE = 'TMESTDS'                 72560008
725700               EXEC SQL                                           72570008
725800                  OPEN  MESTDS_CSR                                72580008
725900               END-EXEC                                           72590008
726000             WHEN DS009-PROCESS-TABLE = 'TEXTENT'                 72600008
726100               EXEC SQL                                           72610008
726200                  OPEN  EXTENT_CSR                                72620008
726300               END-EXEC                                           72630008
726400             WHEN DS009-PROCESS-TABLE = 'TENTNME'                 72640008
726500               EXEC SQL                                           72650008
726600                  OPEN  ENTNME_CSR                                72660008
726700               END-EXEC                                           72670008
726800             WHEN DS009-PROCESS-TABLE = 'TVNDDPT'                 72680008
726900               EXEC SQL                                           72690008
727000                  OPEN  VNDDPT_CSR                                72700008
727100               END-EXEC                                           72710008
727200             WHEN DS009-PROCESS-TABLE = 'TINSTCD'                 72720008
727300               EXEC SQL                                           72730008
727400                  OPEN  INSTCD_CSR                                72740008
727500               END-EXEC                                           72750008
727600*            WHEN DS009-PROCESS-TABLE = 'TSPSTDS'                 72760008
727700*              EXEC SQL                                           72770008
727800*                 OPEN  SPSTDS_CSR                                72780008
727900*              END-EXEC                                           72790008
728000             WHEN DS009-PROCESS-TABLE = 'TTRBNTF'                 72800008
728100               EXEC SQL                                           72810008
728200                  OPEN  TRBNTF_CSR                                72820008
728300               END-EXEC                                           72830008
728400             WHEN DS009-PROCESS-TABLE = 'TTRBDTL'                 72840008
728500               EXEC SQL                                           72850008
728600                  OPEN  TRBDTL_CSR                                72860008
728700               END-EXEC                                           72870008
728800*            WHEN DS009-PROCESS-TABLE = 'TPOUPC'                  72880010
728900*              EXEC SQL                                           72890010
729000*                 OPEN  POUPC-CSR                                 72900010
729100*              END-EXEC                                           72910010
729200             WHEN DS009-PROCESS-TABLE = 'TALLTMP'                 72920008
729300               EXEC SQL                                           72930008
729400                  OPEN  ALLTMP_CSR                                72940008
729500               END-EXEC                                           72950008
729600             WHEN DS009-PROCESS-TABLE = 'TVNDAGR'                 72960008
729700               EXEC SQL                                           72970008
729800                  OPEN  VNDAGR_CSR                                72980008
729900               END-EXEC                                           72990008
730000*            WHEN DS009-PROCESS-TABLE = 'TPAYREQ'                 73000008
730100*              EXEC SQL                                           73010008
730200*                 OPEN  PAYREQ_CSR                                73020008
730300*              END-EXEC                                           73030008
730400             WHEN DS009-PROCESS-TABLE = 'TINVOIC'                 73040008
730500               EXEC SQL                                           73050008
730600                  OPEN  INVOIC_CSR                                73060008
730700               END-EXEC                                           73070008
730800*            WHEN DS009-PROCESS-TABLE = 'TALCHRG'                 73080008
730900*              CONTINUE                                           73090008
731000*              EXEC SQL                                           73100008
731100*                 OPEN  ALCHRG_CSR                                73110008
731200*              END-EXEC                                           73120008
731300             WHEN DS009-PROCESS-TABLE = 'TPREQIT'                 73130008
731400               EXEC SQL                                           73140008
731500                  OPEN  PREQIT_CSR                                73150008
731600               END-EXEC                                           73160008
731700             WHEN DS009-PROCESS-TABLE = 'TASNDTL'                 73170008
731800               EXEC SQL                                           73180008
731900                  OPEN  ASNDTL_CSR                                73190008
732000               END-EXEC                                           73200008
732100             WHEN DS009-PROCESS-TABLE = 'TASNORD'                 73210008
732200               EXEC SQL                                           73220008
732300                  OPEN  ASNORD_CSR                                73230008
732400               END-EXEC                                           73240008
732500             WHEN DS009-PROCESS-TABLE = 'TASNHDR'                 73250008
732600               EXEC SQL                                           73260008
732700                  OPEN  ASNHDR_CSR                                73270008
732800               END-EXEC                                           73280008
732900             WHEN DS009-PROCESS-TABLE = 'TASCRIT'                 73290008
733000               EXEC SQL                                           73300008
733100                  OPEN  ASCRIT_CSR                                73310008
733200               END-EXEC                                           73320008
733300             WHEN DS009-PROCESS-TABLE = 'TASNCAR'                 73330008
733400               EXEC SQL                                           73340008
733500                  OPEN  ASNCAR_CSR                                73350008
733600               END-EXEC                                           73360008
733700             WHEN DS009-PROCESS-TABLE = 'TASDTPL'                 73370008
733800               EXEC SQL                                           73380008
733900                  OPEN  ASDTPL_CSR                                73390008
734000               END-EXEC                                           73400008
734100             WHEN DS009-PROCESS-TABLE = 'TSEASET'                 73410008
734200               EXEC SQL                                           73420008
734300                  OPEN  SEASET_CSR                                73430008
734400               END-EXEC                                           73440008
734500             WHEN DS009-PROCESS-TABLE = 'TSUNAUD'                 73450008
734600               EXEC SQL                                           73460008
734700                  OPEN  SUNAUD_CSR                                73470008
734800               END-EXEC                                           73480008
734900             WHEN DS009-PROCESS-TABLE = 'SUT_PO_AUD_REQ'          73490008
735000               EXEC SQL                                           73500008
735100                  OPEN  SUT00015-CSR                              73510008
735200               END-EXEC                                           73520008
735300             WHEN DS009-PROCESS-TABLE = 'TSUATRN'                 73530008
735400               EXEC SQL                                           73540008
735500                  OPEN  SUATRN_CSR                                73550008
735600               END-EXEC                                           73560008
735700             WHEN DS009-PROCESS-TABLE = 'TSUAUPC'                 73570008
735800               EXEC SQL                                           73580008
735900                  OPEN  SUAUPC-CSR                                73590008
736000               END-EXEC                                           73600008
736100             WHEN DS009-PROCESS-TABLE = 'TSUEXCP'                 73610008
736200               EXEC SQL                                           73620008
736300                  OPEN  SUEXCP_CSR                                73630008
736400               END-EXEC                                           73640008
736500             WHEN DS009-PROCESS-TABLE = 'TCTEXCP'                 73650008
736600               EXEC SQL                                           73660008
736700                  OPEN  CTEXCP_CSR                                73670008
736800               END-EXEC                                           73680008
736900             WHEN DS009-PROCESS-TABLE = 'TIMTBKY'                 73690008
737000               EXEC SQL                                           73700008
737100                  OPEN  IMTBKY_CSR                                73710008
737200               END-EXEC                                           73720008
737300             WHEN DS009-PROCESS-TABLE = 'TPOPRPK'                 73730008
737400               EXEC SQL                                           73740008
737500                  OPEN  POPRPK_CSR                                73750008
737600               END-EXEC                                           73760008
737700             WHEN DS009-PROCESS-TABLE = 'XLT_PK'                  73770008
737800               EXEC SQL                                           73780008
737900                  OPEN  XLT-PK-CSR                                73790008
738000               END-EXEC                                           73800008
738100             WHEN DS009-PROCESS-TABLE = 'XLT_PK_CPT_SKU'          73810008
738200               EXEC SQL                                           73820008
738300                  OPEN  XLT-PK-CPT-CSR                            73830008
738400               END-EXEC                                           73840008
738500             WHEN DS009-PROCESS-TABLE = 'XLT_PK_UPC'              73850008
738600               EXEC SQL                                           73860008
738700                  OPEN  XLT-PK-UPC-CSR                            73870008
738800               END-EXEC                                           73880008
738900              WHEN DS009-PROCESS-TABLE = 'TINPKSU'                73890008
739000               EXEC SQL                                           73900008
739100                  OPEN INPKSU_CSR                                 73910008
739200               END-EXEC                                           73920008
739300              WHEN DS009-PROCESS-TABLE = 'TSHUUPC'                73930008
739400               EXEC SQL                                           73940008
739500                  OPEN SHUUPC-CSR                                 73950008
739600               END-EXEC                                           73960008
739700              WHEN DS009-PROCESS-TABLE = 'TSHPUNT'                73970008
739800               EXEC SQL                                           73980008
739900                  OPEN SHPUNT_CSR                                 73990008
740000               END-EXEC                                           74000008
740100              WHEN DS009-PROCESS-TABLE = 'TSHUNLO'                74010008
740200               EXEC SQL                                           74020008
740300                  OPEN SHUNLO_CSR                                 74030008
740400               END-EXEC                                           74040008
740500             WHEN DS009-PROCESS-TABLE = 'TSULBXF'                 74050008
740600               EXEC SQL                                           74060008
740700                  OPEN  SULBXF_CSR                                74070008
740800               END-EXEC                                           74080008
740900             WHEN DS009-PROCESS-TABLE = 'TWEBITM'                 74090008
741000               EXEC SQL                                           74100008
741100                  OPEN  WEBITM_CSR                                74110008
741200               END-EXEC                                           74120008
741300             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_UPC'           74130008
741400               EXEC SQL                                           74140008
741500                  OPEN  OTBUPC-CSR                                74150008
741600               END-EXEC                                           74160008
741700             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_PKD_UPC'       74170008
741800               EXEC SQL                                           74180008
741900                  OPEN  OTB-PKD-UPC-CSR                           74190008
742000               END-EXEC                                           74200008
742100             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_LOC'           74210008
742200               EXEC SQL                                           74220008
742300                  OPEN  OTBLOC-CSR                                74230008
742400               END-EXEC                                           74240008
742500             WHEN DS009-PROCESS-TABLE = 'TSUQADJ'                 74250008
742600               EXEC SQL                                           74260008
742700                  OPEN  SUQADJ-CSR                                74270008
742800               END-EXEC                                           74280008
742900             WHEN DS009-PROCESS-TABLE = 'SUT_FINCL_ADJ'           74290008
743000               EXEC SQL                                           74300008
743100                  OPEN  FINCL-ADJ-CSR                             74310008
743200               END-EXEC                                           74320008
743700             WHEN DS009-PROCESS-TABLE = 'TSUOBTS'                 74370008
743800               EXEC SQL                                           74380008
743900                  OPEN  SUOBTS-CSR                                74390008
744000               END-EXEC                                           74400008
744100             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_CART'          74410008
744200               EXEC SQL                                           74420008
744300                  OPEN  SUT00024-CSR                              74430008
744400               END-EXEC                                           74440008
744500             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_PK'            74450008
744600               EXEC SQL                                           74460008
744700                  OPEN  SUT00041-CSR                              74470008
744800               END-EXEC                                           74480008
744900             WHEN DS009-PROCESS-TABLE = 'RCT_PO_RCVR_TRKG'        74490008
745000               EXEC SQL                                           74500008
745100                  OPEN  RCT00017-CSR                              74510008
745200               END-EXEC                                           74520008
745300             WHEN DS009-PROCESS-TABLE = 'IMT_STYL_PRTNR'          74530008
745400               EXEC SQL                                           74540008
745500                  OPEN IMT_STYL_PRTNR_CSR                         74550008
745600               END-EXEC                                           74560008
745700             WHEN DS009-PROCESS-TABLE = 'WST_SHPMT_XREF_DTL'      74570008
745800               EXEC SQL                                           74580008
745900                  OPEN WST-SHIPMT-DTL-CSR                         74590008
746000               END-EXEC                                           74600008
745700             WHEN DS009-PROCESS-TABLE = 'TTRDPRT'                 74601021
745800               EXEC SQL                                           74602014
745900                  OPEN TRDPRT_CSR                                 74603022
746000               END-EXEC                                           74604014
745700             WHEN DS009-PROCESS-TABLE = 'TFGTRST'                 74604121
745800               EXEC SQL                                           74604221
745900                  OPEN FGTRST-CSR                                 74604321
746000               END-EXEC                                           74604421
745700             WHEN DS009-PROCESS-TABLE = 'TINTTRN'                 74605014
745800               EXEC SQL                                           74606014
745900                  OPEN INTTRN-CSR                                 74607014
746000               END-EXEC                                           74608014
746100                                                                  74610008
746200             END-EVALUATE                                         74620008
746300                                                                  74630008
746400             EVALUATE TRUE                                        74640008
746500               WHEN SQLCODE = ZERO                                74650008
746600               WHEN SQLCODE = -904                                74660008
746700               WHEN SQLCODE = -913                                74670008
746800               WHEN SQLCODE = -310                                74680008
746900                  CONTINUE                                        74690008
747000             END-EVALUATE                                         74700008
747100         END-PERFORM.                                             74710008
747200*                                                                 74720008
747300     PERFORM DS002-SQL-ABEND-OPEN-CSR.                            74730008
747400*                                                                 74740008
747500/                                                                 74750008
747600 Z100-CLOSE-CURSOR.                                               74760008
747700     PERFORM WITH TEST AFTER                                      74770008
747800             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              74780008
747900             UNTIL   DS009-RETRY-COUNTER > 3 OR                   74790008
748000                     SQLCODE = ZERO                               74800008
748100                                                                  74810008
748200             EVALUATE TRUE                                        74820008
748300             WHEN DS009-PROCESS-TABLE = 'TPURCHS'                 74830008
748400               EXEC SQL                                           74840008
748500                 CLOSE PURCHS_CSR                                 74850008
748600               END-EXEC                                           74860008
748700             WHEN DS009-PROCESS-TABLE = 'TPOAGMT'                 74870008
748800               EXEC SQL                                           74880008
748900                  CLOSE POAGMT_CSR                                74890008
749000               END-EXEC                                           74900008
749100             WHEN DS009-PROCESS-TABLE = 'TPOINST'                 74910008
749200               EXEC SQL                                           74920008
749300                  CLOSE POINST_CSR                                74930008
749400               END-EXEC                                           74940008
749500             WHEN DS009-PROCESS-TABLE = 'TIMPORL'                 74950008
749600               EXEC SQL                                           74960008
749700                  CLOSE IMPORL_CSR                                74970008
749800               END-EXEC                                           74980008
749900             WHEN DS009-PROCESS-TABLE = 'TALLPLN'                 74990008
750000               EXEC SQL                                           75000008
750100                  CLOSE ALLPLN_CSR                                75010008
750200               END-EXEC                                           75020008
750300             WHEN DS009-PROCESS-TABLE = 'TPLNSHP'                 75030008
750400               EXEC SQL                                           75040008
750500                  CLOSE PLNSHP_CSR                                75050008
750600               END-EXEC                                           75060008
750700             WHEN DS009-PROCESS-TABLE = 'TSK'                     75070008
750800               EXEC SQL                                           75080008
750900                  CLOSE SK_CSR                                    75090008
751000               END-EXEC                                           75100008
751100             WHEN DS009-PROCESS-TABLE = 'TSKST'                   75110008
751200               EXEC SQL                                           75120008
751300                  CLOSE SKST-CSR                                  75130008
751400               END-EXEC                                           75140008
751500             WHEN DS009-PROCESS-TABLE = 'TPPCPRC'                 75150008
751600               EXEC SQL                                           75160008
751700                  CLOSE PPCPRC_CSR                                75170008
751800               END-EXEC                                           75180008
751900             WHEN DS009-PROCESS-TABLE = 'TUPC'                    75190008
752000               EXEC SQL                                           75200008
752100                  CLOSE UPC-CSR                                   75210008
752200               END-EXEC                                           75220008
752300             WHEN DS009-PROCESS-TABLE = 'TUPCSKU'                 75230008
752400               EXEC SQL                                           75240008
752500                  CLOSE UPCSKU_CSR                                75250008
752600               END-EXEC                                           75260008
752700             WHEN DS009-PROCESS-TABLE = 'TSKXREF'                 75270008
752800               EXEC SQL                                           75280008
752900                  CLOSE SKXREF_CSR                                75290008
753000               END-EXEC                                           75300008
753100             WHEN DS009-PROCESS-TABLE = 'TUPCPLS'                 75310008
753200               EXEC SQL                                           75320008
753300                  CLOSE UPCPLS_CSR                                75330008
753400               END-EXEC                                           75340008
753500             WHEN DS009-PROCESS-TABLE = 'TMDSEAR'                 75350008
753600               EXEC SQL                                           75360008
753700                  CLOSE MDSEAR_CSR                                75370008
753800               END-EXEC                                           75380008
753900             WHEN DS009-PROCESS-TABLE = 'TMDARVS'                 75390008
754000               EXEC SQL                                           75400008
754100                  CLOSE MDARVS_CSR                                75410008
754200               END-EXEC                                           75420008
754300             WHEN DS009-PROCESS-TABLE = 'TVNDSTL'                 75430008
754400               EXEC SQL                                           75440008
754500                  CLOSE VNDSTL_CSR                                75450008
754600               END-EXEC                                           75460008
754700             WHEN DS009-PROCESS-TABLE = 'XLT_SKU'                 75470008
754800               EXEC SQL                                           75480008
754900                  CLOSE XLTSKU-CSR                                75490008
755000               END-EXEC                                           75500008
755100             WHEN DS009-PROCESS-TABLE = 'XLT_UPC'                 75510008
755200               EXEC SQL                                           75520008
755300                  CLOSE XLTUPC-CSR                                75530008
755400               END-EXEC                                           75540008
755500             WHEN DS009-PROCESS-TABLE = 'TPURITM'                 75550008
755600               EXEC SQL                                           75560008
755700                  CLOSE PURITM_CSR                                75570008
755800               END-EXEC                                           75580008
755900             WHEN DS009-PROCESS-TABLE = 'TMESTDS'                 75590008
756000               EXEC SQL                                           75600008
756100                  CLOSE MESTDS_CSR                                75610008
756200               END-EXEC                                           75620008
756300             WHEN DS009-PROCESS-TABLE = 'TEXTENT'                 75630008
756400               EXEC SQL                                           75640008
756500                  CLOSE EXTENT_CSR                                75650008
756600               END-EXEC                                           75660008
756700             WHEN DS009-PROCESS-TABLE = 'TENTNME'                 75670008
756800               EXEC SQL                                           75680008
756900                  CLOSE ENTNME_CSR                                75690008
757000               END-EXEC                                           75700008
757100             WHEN DS009-PROCESS-TABLE = 'TVNDDPT'                 75710008
757200               EXEC SQL                                           75720008
757300                  CLOSE VNDDPT_CSR                                75730008
757400               END-EXEC                                           75740008
757500             WHEN DS009-PROCESS-TABLE = 'TINSTCD'                 75750008
757600               EXEC SQL                                           75760008
757700                  CLOSE INSTCD_CSR                                75770008
757800               END-EXEC                                           75780008
757900*            WHEN DS009-PROCESS-TABLE = 'TSPSTDS'                 75790008
758000*              EXEC SQL                                           75800008
758100*                 CLOSE SPSTDS_CSR                                75810008
758200*              END-EXEC                                           75820008
758300             WHEN DS009-PROCESS-TABLE = 'TTRBNTF'                 75830008
758400               EXEC SQL                                           75840008
758500                  CLOSE TRBNTF_CSR                                75850008
758600               END-EXEC                                           75860008
758700             WHEN DS009-PROCESS-TABLE = 'TTRBDTL'                 75870008
758800               EXEC SQL                                           75880008
758900                  CLOSE TRBDTL_CSR                                75890008
759000               END-EXEC                                           75900008
759100*            WHEN DS009-PROCESS-TABLE = 'TPOUPC'                  75910010
759200*              EXEC SQL                                           75920010
759300*                 CLOSE                                           75930010
759400*              END-EXEC                                           75940010
759500             WHEN DS009-PROCESS-TABLE = 'TALLTMP'                 75950008
759600               EXEC SQL                                           75960008
759700                  CLOSE ALLTMP_CSR                                75970008
759800               END-EXEC                                           75980008
759900             WHEN DS009-PROCESS-TABLE = 'TVNDAGR'                 75990008
760000               EXEC SQL                                           76000008
760100                  CLOSE VNDAGR_CSR                                76010008
760200               END-EXEC                                           76020008
760300*            WHEN DS009-PROCESS-TABLE = 'TPAYREQ'                 76030008
760400*              EXEC SQL                                           76040008
760500*                 CLOSE PAYREQ_CSR                                76050008
760600*              END-EXEC                                           76060008
760700             WHEN DS009-PROCESS-TABLE = 'TINVOIC'                 76070008
760800               EXEC SQL                                           76080008
760900                  CLOSE INVOIC_CSR                                76090008
761000               END-EXEC                                           76100008
761100*            WHEN DS009-PROCESS-TABLE = 'TALCHRG'                 76110008
761200*              CONTINUE                                           76120008
761300*              EXEC SQL                                           76130008
761400*                 CLOSE ALCHRG_CSR                                76140008
761500*              END-EXEC                                           76150008
761600             WHEN DS009-PROCESS-TABLE = 'TPREQIT'                 76160008
761700               EXEC SQL                                           76170008
761800                  CLOSE PREQIT_CSR                                76180008
761900               END-EXEC                                           76190008
762000             WHEN DS009-PROCESS-TABLE = 'TASNDTL'                 76200008
762100               EXEC SQL                                           76210008
762200                  CLOSE ASNDTL_CSR                                76220008
762300               END-EXEC                                           76230008
762400             WHEN DS009-PROCESS-TABLE = 'TASNORD'                 76240008
762500               EXEC SQL                                           76250008
762600                  CLOSE ASNORD_CSR                                76260008
762700               END-EXEC                                           76270008
762800             WHEN DS009-PROCESS-TABLE = 'TASNHDR'                 76280008
762900               EXEC SQL                                           76290008
763000                  CLOSE ASNHDR_CSR                                76300008
763100               END-EXEC                                           76310008
763200             WHEN DS009-PROCESS-TABLE = 'TASCRIT'                 76320008
763300               EXEC SQL                                           76330008
763400                  CLOSE ASCRIT_CSR                                76340008
763500               END-EXEC                                           76350008
763600             WHEN DS009-PROCESS-TABLE = 'TASNCAR'                 76360008
763700               EXEC SQL                                           76370008
763800                  CLOSE ASNCAR_CSR                                76380008
763900               END-EXEC                                           76390008
764000             WHEN DS009-PROCESS-TABLE = 'TASDTPL'                 76400008
764100               EXEC SQL                                           76410008
764200                  CLOSE ASDTPL_CSR                                76420008
764300               END-EXEC                                           76430008
764400             WHEN DS009-PROCESS-TABLE = 'TSEASET'                 76440008
764500               EXEC SQL                                           76450008
764600                  CLOSE SEASET_CSR                                76460008
764700               END-EXEC                                           76470008
764800             WHEN DS009-PROCESS-TABLE = 'TSUNAUD'                 76480008
764900               EXEC SQL                                           76490008
765000                  CLOSE SUNAUD_CSR                                76500008
765100               END-EXEC                                           76510008
765200             WHEN DS009-PROCESS-TABLE = 'SUT_PO_AUD_REQ'          76520008
765300               EXEC SQL                                           76530008
765400                  CLOSE SUT00015-CSR                              76540008
765500               END-EXEC                                           76550008
765600             WHEN DS009-PROCESS-TABLE = 'TSUATRN'                 76560008
765700               EXEC SQL                                           76570008
765800                  CLOSE SUATRN_CSR                                76580008
765900               END-EXEC                                           76590008
766000             WHEN DS009-PROCESS-TABLE = 'TSUAUPC'                 76600008
766100               EXEC SQL                                           76610008
766200                  CLOSE SUAUPC-CSR                                76620008
766300               END-EXEC                                           76630008
766400             WHEN DS009-PROCESS-TABLE = 'TSUEXCP'                 76640008
766500               EXEC SQL                                           76650008
766600                  CLOSE SUEXCP_CSR                                76660008
766700               END-EXEC                                           76670008
766800             WHEN DS009-PROCESS-TABLE = 'TCTEXCP'                 76680008
766900               EXEC SQL                                           76690008
767000                  CLOSE CTEXCP_CSR                                76700008
767100               END-EXEC                                           76710008
767200             WHEN DS009-PROCESS-TABLE = 'TIMTBKY'                 76720008
767300               EXEC SQL                                           76730008
767400                  CLOSE IMTBKY_CSR                                76740008
767500               END-EXEC                                           76750008
767600             WHEN DS009-PROCESS-TABLE = 'TPOPRPK'                 76760008
767700               EXEC SQL                                           76770008
767800                  CLOSE POPRPK_CSR                                76780008
767900               END-EXEC                                           76790008
768000             WHEN DS009-PROCESS-TABLE = 'XLT_PK'                  76800008
768100               EXEC SQL                                           76810008
768200                  CLOSE XLT-PK-CSR                                76820008
768300               END-EXEC                                           76830008
768400             WHEN DS009-PROCESS-TABLE = 'XLT_PK_CPT_SKU'          76840008
768500               EXEC SQL                                           76850008
768600                  CLOSE XLT-PK-CPT-CSR                            76860008
768700               END-EXEC                                           76870008
768800             WHEN DS009-PROCESS-TABLE = 'XLT_PK_UPC'              76880008
768900               EXEC SQL                                           76890008
769000                  CLOSE XLT-PK-UPC-CSR                            76900008
769100               END-EXEC                                           76910008
769200              WHEN DS009-PROCESS-TABLE = 'TINPKSU'                76920008
769300               EXEC SQL                                           76930008
769400                  CLOSE INPKSU_CSR                                76940008
769500               END-EXEC                                           76950008
769600              WHEN DS009-PROCESS-TABLE = 'TSHUUPC'                76960008
769700               EXEC SQL                                           76970008
769800                  CLOSE SHUUPC-CSR                                76980008
769900               END-EXEC                                           76990008
770000              WHEN DS009-PROCESS-TABLE = 'TSHPUNT'                77000008
770100               EXEC SQL                                           77010008
770200                  CLOSE SHPUNT_CSR                                77020008
770300               END-EXEC                                           77030008
770400              WHEN DS009-PROCESS-TABLE = 'TSHUNLO'                77040008
770500               EXEC SQL                                           77050008
770600                  CLOSE SHUNLO_CSR                                77060008
770700               END-EXEC                                           77070008
770800             WHEN DS009-PROCESS-TABLE = 'TSULBXF'                 77080008
770900               EXEC SQL                                           77090008
771000                  CLOSE SULBXF_CSR                                77100008
771100               END-EXEC                                           77110008
771200             WHEN DS009-PROCESS-TABLE = 'TWEBITM'                 77120008
771300               EXEC SQL                                           77130008
771400                  CLOSE WEBITM_CSR                                77140008
771500               END-EXEC                                           77150008
771600             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_UPC'           77160008
771700               EXEC SQL                                           77170008
771800                  CLOSE OTBUPC-CSR                                77180008
771900               END-EXEC                                           77190008
772000             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_PKD_UPC'       77200008
772100               EXEC SQL                                           77210008
772200                  CLOSE OTB-PKD-UPC-CSR                           77220008
772300               END-EXEC                                           77230008
772400             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_LOC'           77240008
772500               EXEC SQL                                           77250008
772600                  CLOSE OTBLOC-CSR                                77260008
772700               END-EXEC                                           77270008
772800             WHEN DS009-PROCESS-TABLE = 'SUT_FINCL_ADJ'           77280008
772900               EXEC SQL                                           77290008
773000                  CLOSE FINCL-ADJ-CSR                             77300008
773100               END-EXEC                                           77310008
773200             WHEN DS009-PROCESS-TABLE = 'TSUOBTS'                 77320008
773300               EXEC SQL                                           77330008
773400                  CLOSE SUOBTS-CSR                                77340008
773500               END-EXEC                                           77350008
774000             WHEN DS009-PROCESS-TABLE = 'TSUQADJ'                 77400008
774100               EXEC SQL                                           77410008
774200                  CLOSE SUQADJ-CSR                                77420008
774300               END-EXEC                                           77430008
774400             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_CART'          77440008
774500               EXEC SQL                                           77450008
774600                  CLOSE SUT00024-CSR                              77460008
774700               END-EXEC                                           77470008
774800             WHEN DS009-PROCESS-TABLE = 'SUT_OTBND_PK'            77480008
774900               EXEC SQL                                           77490008
775000                  CLOSE SUT00041-CSR                              77500008
775100               END-EXEC                                           77510008
775200             WHEN DS009-PROCESS-TABLE = 'RCT_PO_RCVR_TRKG'        77520008
775300               EXEC SQL                                           77530008
775400                  CLOSE RCT00017-CSR                              77540008
775500               END-EXEC                                           77550008
775600             WHEN DS009-PROCESS-TABLE = 'IMT_STYL_PRTNR'          77560008
775700               EXEC SQL                                           77570008
775800                  CLOSE IMT_STYL_PRTNR_CSR                        77580008
775900               END-EXEC                                           77590008
776000                                                                  77600008
776100             WHEN DS009-PROCESS-TABLE = 'WST_SHPMT_XREF_DTL'      77610008
776200               EXEC SQL                                           77620008
776300                  CLOSE WST-SHIPMT-DTL-CSR                        77630008
776400               END-EXEC                                           77640008
776100             WHEN DS009-PROCESS-TABLE = 'TTRDPRT'                 77641021
776200               EXEC SQL                                           77642014
776300                  CLOSE TRDPRT_CSR                                77643022
776400               END-EXEC                                           77644014
776100             WHEN DS009-PROCESS-TABLE = 'TFGTRST'                 77644121
776200               EXEC SQL                                           77644221
776300                  CLOSE FGTRST-CSR                                77644321
776400               END-EXEC                                           77644421
776100             WHEN DS009-PROCESS-TABLE = 'TINTTRN'                 77645014
776200               EXEC SQL                                           77646014
776300                  CLOSE INTTRN-CSR                                77647014
776400               END-EXEC                                           77648014
776500                                                                  77650008
776600             END-EVALUATE                                         77660008
776700                                                                  77670008
776800             EVALUATE TRUE                                        77680008
776900               WHEN SQLCODE = ZERO                                77690008
777000               WHEN SQLCODE = -904                                77700008
777100               WHEN SQLCODE = -913                                77710008
777200                  CONTINUE                                        77720008
777300             END-EVALUATE                                         77730008
777400         END-PERFORM.                                             77740008
777500*                                                                 77750008
777600     PERFORM DS002-SQL-ABEND-CLOSE-CSR.                           77760008
777700/                                                                 77770008
777800 8000-WRITE-UNLOAD.                                               77780008
777900                                                                  77790008
778000     SET DS009-SRCH-IDX TO +1.                                    77800008
778100     SEARCH DS009-CNTL-RECORDS                                    77810008
778200             VARYING DS009-SRCH-IDX                               77820008
778300         AT END                                                   77830008
778400             CONTINUE                                             77840008
778500         WHEN CNTL-TABLE (DS009-SRCH-IDX) = DS002-NAME            77850008
778600             ADD 1 TO DS009-READ-COUNT (DS009-SRCH-IDX)           77860008
778700     END-SEARCH.                                                  77870008
778800                                                                  77880008
778900*    DISPLAY 'DS009-PROCESS-TABLE = ' DS009-PROCESS-TABLE         77890009
779000*            ' DS009-TBLE-DATA-SIZE = ' DS009-TBLE-DATA-SIZE      77900009
779100*            ' DS009-RECORD-SIZE = ' DS009-RECORD-SIZE            77910009
779200                                                                  77920008
779300                                                                  77930008
779400     WRITE TBLE-RECORD FROM DS002-RECORD                          77940008
779500     ADD 1 TO PV-WRITE-COUNT.                                     77950008
779600 9000-DUMP-COUNT-TABLE.                                           77960008
779700     CONTINUE.                                                    77970008
779800/                                                                 77980008
779900     COPY DSPD002.                                                77990008
