       IDENTIFICATION DIVISION.                                         00010007
       PROGRAM-ID.    MLKUT110.                                         00020007
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00030007
       DATE-WRITTEN.  02-08-2010.                                       00040007
       DATE-COMPILED.                                                   00050007
                                                                        00060007
      ******************************************************************00070007
      *   THIS IS A CLONE OF MLKUT001 WITH CHANGES FOR BRAND VENDOR             
      *                                                                         
X28582*PURPOSE:   THE PROGRAM IS DESIGNED TO PRORATE UNKNOWN VEND/BRAND 00080007
      *         DOLLARS AT A DETAIL LEDGER WEEKLY CONDENSED FILE        00090007
      *         TRANSACTION LEVEL. SEE THE FLOW SECTION REGARDING HOW   00100007
      *         THIS MODULE WORKS. (VERSION 3)                          00110007
      *                                                                 00120007
      *CHANGE HISTORY:                                                  00130007
      * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00140007
      * ------- ---------- ----------- -------------------------------- 00150007
      * WR37965 02-16-2010 SURENDAR B  BRAND VENDOR TRANSACTION AND             
W37965*                                EXCEPTION MANAGEMENT                     
W37965*                                PROGRAM CHANGED TO WRITE DETAIL          
W37965*                                AUDIT FILE FOR PURCHASE                  
W37965*                                ADJUSTMENTS, SALES AND PRICE             
W37965*                                CHANGES.                                 
RONNA *         04-01-2019 R.MCDONALD  INC7599777 AND INC7665315        00412014
RONNA *                                CHANGING THE PRORATION LOGIC     00413014
RONNA *                                FOR SALES TRANSACTIONS TO USE    00413014
RONNA *                                THE TOTAL SALES INSTEAD OF               
RONNA *                                EACH INDIVIDUAL SALES FIELD.             
RONNA *                                THE REASON FOR THIS IS THAT              
RONNA *                                IF THERE IS NOT A LOT OF ACTIVITY        
RONNA *                                FOR THE WEEK FOR A SALES BUCKET          
RONNA *                                AND THERE ARE A MIX OF POSITIVE          
RONNA *                                AND NEGATIVE NUMBERS, A LARGE            
RONNA *                                NEGATIVE NUMBER COULD RESULT IN          
RONNA *                                SOME SKEWED AMOUNTS.  THIS               
RONNA *                                HAPPENED FOR COLUMBIA                    
RONNA *                                DEPT 41 FOR SEASONAL ITEMS               
RONNA *                                WHERE IT LOOKS LIKE A LOT OF             
RONNA *                                RETURNS FOR COLUMBIA AND LOW             
RONNA *                                ACTIVITY IN THE SALES REGULAR            
RONNA *                                BUCKET.  THAT IS WHY THIS                
RONNA *                                IS BEING CHANGED.                        
RONNA2*         12-05-2019 R.MCDONALD  PRB0074992                       00412014
RONNA2*                                FOR CHANGING THE PRICE CHANGE    00413014
RONNA2*                                PRORATION, HOWEVER IT WAS        00413014
RONNA2*                                NOTICED THAT THIS CODE WAS       00413014
RONNA2*                                CHANGED BY MISTAKE DURING THE    00413014
RONNA2*                                LAST CHANGE.  THIS WAS NOT       00413014
RONNA2*                                NOTICED BECAUSE THE INPUT FILE   00413014
RONNA2*                                DOESN'T HAVE ANY VALUES IN THIS  00413014
RONNA2*                                FIELD.  THE PRORATION ONLY       00413014
RONNA2*                                HAPPENS ON THE FIELD             00413014
RONNA2*                                ML254-MKDN-RTL-AMT BECAUSE THAT  00413014
RONNA2*                                IS THE ONLY ONE WITH A VALUE     00413014
RONNA2*                                AND THIS WILL REVERT THE CODE    00413014
RONNA2*                                BACK FOR THIS FIELD.             00413014
0422RM*         04-15-2022 B.MCASEY    ADD AN OUTPUT FILE FOR LOGGING OF        
0422RM*                                RECORDS READ TO AID IN QUICK             
0422RM*                                DETERMINATION OF LAST INPUT REC          
0422RM*                                READ.                                    
W37965******************************************************************00420007
                                                                        00430007
       ENVIRONMENT DIVISION.                                            00440007
       CONFIGURATION SECTION.                                           00450007
       SOURCE-COMPUTER.        IBM-3090.                                00460007
       OBJECT-COMPUTER.        IBM-3090.                                00470007
       INPUT-OUTPUT SECTION.                                            00480007
       FILE-CONTROL.                                                    00490007
                                                                        00500007
           SELECT DTL-LDGR-UNKNOWN-DTL-IN                               00510007
               ASSIGN TO INP03.                                         00520007
                                                                        00530007
           SELECT DTL-LDGR-DBV-SUM-IN                                   00540007
               ASSIGN TO INP02.                                         00550007
                                                                        00560007
           SELECT DTL-LDGR-DPT-TOT-IN                                   00570007
               ASSIGN TO INP01.                                         00580007
                                                                        00590007
           SELECT CONTROL-CARD-IN                                       00600007
               ASSIGN TO INP04.                                         00610007
                                                                        00620007
           SELECT CNTL-DATE-FILE                                        00600007
               ASSIGN TO INP05.                                         00610007
                                                                        00620007
           SELECT DTL-LDGR-FILE-OUT                                     00630007
               ASSIGN TO OUT01.                                         00640007
                                                                        00650007
W37965     SELECT DTL-AUDIT-FILE-OUT                                    00630007
W37965         ASSIGN TO OUT02.                                         00640007
                                                                                
0422RM     SELECT DTL-AUDIT-LOG-FILE-OUT                                        
0422RM         ASSIGN TO OUT03.                                         00640007
                                                                        00650007
           SELECT DTL-LDGR-PRORATE-RPT                                  00660007
               ASSIGN TO RPT01.                                         00670007
                                                                        00680007
       DATA DIVISION.                                                   00690007
       FILE SECTION.                                                    00700007
                                                                        00710007
       FD  DTL-LDGR-UNKNOWN-DTL-IN                                      00720007
           LABEL RECORDS ARE OMITTED                                    00730007
           RECORDING MODE IS F                                          00740007
           BLOCK CONTAINS 0 RECORDS.                                    00750007
           COPY MLRD254 REPLACING ML254 BY UDTLI.                       00760007
                                                                        00770007
       FD  DTL-LDGR-DBV-SUM-IN                                          00780007
           LABEL RECORDS ARE OMITTED                                    00790007
           RECORDING MODE IS F                                          00800007
           BLOCK CONTAINS 0 RECORDS.                                    00810007
           COPY MLRD254 REPLACING ML254 BY UDBVI.                       00820007
                                                                        00830007
       FD  DTL-LDGR-DPT-TOT-IN                                          00840007
           LABEL RECORDS ARE OMITTED                                    00850007
           RECORDING MODE IS F                                          00860007
           BLOCK CONTAINS 0 RECORDS.                                    00870007
           COPY MLRD254 REPLACING ML254 BY UDPTI.                       00880007
                                                                        00890007
       FD  DTL-LDGR-FILE-OUT                                            00900007
           LABEL RECORDS ARE OMITTED                                    00910007
           RECORDING MODE IS F                                          00920007
           BLOCK CONTAINS 0 RECORDS.                                    00930007
           COPY MLRD254 REPLACING ML254 BY OUTPT.                       00940007
                                                                        00950007
       FD  CONTROL-CARD-IN                                              00960007
           LABEL RECORDS ARE OMITTED                                    00970007
           RECORDING MODE IS F                                          00980007
           BLOCK CONTAINS 0 RECORDS.                                    00990007
       01  CONTROL-CARD-RECORD      PIC X(080).                         01000007
                                                                        01010007
       FD  CNTL-DATE-FILE                                               00960007
           RECORDING MODE IS F                                          00970007
           LABEL RECORDS ARE STANDARD                                   00980007
           BLOCK CONTAINS 0 RECORDS.                                    00990007
       01  CNTL-DATE-REC.                                               01000007
           05  FILLER                  PIC X(03).                       01010007
           05  CC-PROC-DATE-ISO        PIC X(10).                               
           05  CC-PROC-DATE-RDF  REDEFINES                                      
               CC-PROC-DATE-ISO.                                                
               10  CC-PROC-DATE-CC     PIC X(02).                               
               10  CC-PROC-DATE-YY     PIC X(02).                               
               10  FILLER              PIC X(01).                               
               10  CC-PROC-DATE-MM     PIC X(02).                               
               10  FILLER              PIC X(01).                               
               10  CC-PROC-DATE-DD     PIC X(02).                               
           05  FILLER                  PIC X(67).                               
                                                                                
0422RM FD  DTL-AUDIT-LOG-FILE-OUT                                               
0422RM     RECORDING  MODE IS F                                                 
0422RM     BLOCK CONTAINS 0 RECORDS.                                            
0422RM 01  DTL-AUDIT-LOG-RECORD        PIC X(453).                              
                                                                                
W37965 FD  DTL-AUDIT-FILE-OUT                                           00900007
W37965     LABEL RECORDS ARE OMITTED                                    00910007
W37965     RECORD CONTAINS 200 CHARACTERS                                       
W37965     RECORDING MODE IS F                                          00920007
W37965     DATA RECORD IS DTL-AUDIT-OUT-RECORD.                         00940007
W37965 01  DTL-AUDIT-OUT-RECORD    PIC X(200).                          00940007
                                                                                
       FD  DTL-LDGR-PRORATE-RPT                                         01020007
           LABEL RECORDS ARE OMITTED                                    01030007
           RECORD CONTAINS 250 CHARACTERS                               01040007
           RECORDING MODE IS F                                          01050007
           DATA RECORD IS DTL-LDGR-RPT-RECORD.                          01060007
       01  DTL-LDGR-RPT-RECORD      PIC X(250).                         01070007
                                                                        01080007
      /*****************************************************************01090007
       WORKING-STORAGE SECTION.                                         01100007
      ******************************************************************01110007
                                                                        01120007
       01  CC-CONTROL-CARD.                                             01130007
           05  CC-PROCESSING-MODE              PIC X(10).               01140007
               88  CC-MODE-KNOWN-UNKNOWN       VALUE 'KU        '.      01150007
               88  CC-MODE-UNKNOWN-UNKNOWN     VALUE 'UU        '.      01160007
               88  CC-VALID-MODE               VALUES 'UU        ',     01170007
                                                      'KU        '.     01180007
           05  FILLER                          PIC X(05).               01190007
           05  CC-DESCRIPTION                  PIC X(65).               01200007
                                                                        01210007
       01  ABEND-CODE                     PIC S9(04) COMP VALUE ZEROS.  01220007
           88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 01230007
           88  ABEND-4002-READ-ERROR                       VALUE +4002. 01240007
           88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 01250007
           88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 01260007
           88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 01270007
           88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 01280007
           88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 01290007
           88  ABEND-4008-DATA-ERROR                       VALUE +4008. 01300007
           88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. 01310007
           88  ABEND-4013-DB2-ERROR                        VALUE +4013. 01320007
           88  ABEND-4019-DATE-ROUTINE-ERROR               VALUE +4019. 01330007
           88  ABEND-4444-FORCED-ABEND                     VALUE +4444. 01340007
                                                                        01350007
       01  PC-PROGRAM-CONSTANTS.                                        01360007
           05  PC-PROGRAM-NAME         PIC X(20)  VALUE 'MLKUT110'.     01370007
           05  PC-MAX-LINES            PIC 9(02)  VALUE 70.             01380007
           05  PC-MAX-DBV-ROWS         PIC S9(09) COMP-3 VALUE 20000.   01390007
           05  PC-MAX-DPT-ROWS         PIC S9(09) COMP-3 VALUE 20000.   01400007
                                                                        01410007
       01  PV-PROGRAM-VARIABLES.                                        01420007
           05  DBVI                    PIC S9(09) COMP-3 VALUE ZEROS.   01430007
           05  DPTI                    PIC S9(09) COMP-3 VALUE ZEROS.   01440007
           05  PV-LINE-COUNTER         PIC S9(15) COMP-3 VALUE 76.      01450007
           05  PV-PAGE-COUNTER         PIC S9(05) COMP-3 VALUE ZEROS.   01460007
           05  PV-DTL-LDGR-READ        PIC S9(15) COMP-3 VALUE ZEROS.   01470007
           05  PV-DBV-READ-COUNT       PIC S9(15) COMP-3 VALUE ZEROS.   01480007
           05  PV-DPT-READ-COUNT       PIC S9(15) COMP-3 VALUE ZEROS.   01490007
           05  PV-DBV-COUNT            PIC S9(15) COMP-3 VALUE ZEROS.   01500007
           05  PV-DPT-COUNT            PIC S9(15) COMP-3 VALUE ZEROS.   01510007
           05  PV-WRITE-RECS           PIC S9(15) COMP-3 VALUE ZEROS.   01520007
0422RM     05  PV-LOG-COUNT            PIC S9(15) COMP-3 VALUE ZEROS.           
W37965     05  PV-AUDIT-RECS           PIC S9(15) COMP-3 VALUE ZEROS.   01520007
           05  PV-PRORATE-WRITTEN      PIC S9(15) COMP-3 VALUE ZEROS.   01530007
           05  PV-DISPLAY-AMOUNT  PIC ZZZZZZZZZZZZZZZZZ9    VALUE ZEROS.01540007
           05  PV-DISPLAY-AMOUNT2 PIC ZZZZZZZZZZZZZZZZZ9.99 VALUE ZEROS.01550007
                                                                        01560007
           05  PV-WORK-AMOUNT          PIC S9(11)V99 COMP-3 VALUE ZERO. 01570007
           05  PV-WORK-AMOUNT2         PIC S9(11)V99 COMP-3 VALUE ZERO. 01580007
RONNA      05  PV-ALL-SLS-MLDBV        PIC S9(11)V99 COMP-3 VALUE ZERO. 01580007
RONNA      05  PV-ALL-SLS-MLDPT        PIC S9(11)V99 COMP-3 VALUE ZERO. 01580007
           05  PV-SLS-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO. 01590007
           05  PV-MKDN-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01600007
           05  PV-MKUP-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01610007
           05  PV-XFER-IN-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO. 01620007
           05  PV-XFER-OUT-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO. 01630007
           05  PV-RCPT-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01640007
           05  PV-RCPT-NET-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO. 01650007
           05  PV-PADJ-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01660007
           05  PV-PADJ-NET-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO. 01670007
           05  PV-INV-ADJ-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO. 01680007
           05  PV-RCPT-FRGT-COST       PIC S9(13)V99 COMP-3 VALUE ZERO. 01690007
           05  PV-PADJ-FRGT-COST       PIC S9(13)V99 COMP-3 VALUE ZERO. 01700007
           05  PV-GRO-COST-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01710007
           05  PV-ONORD-RTL-AMT        PIC S9(13)V99 COMP-3 VALUE ZERO. 01720007
           05  PV-ONORD-COST-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO. 01730007
           05  PV-SLS-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO. 01740007
           05  PV-MKDN-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 01750007
           05  PV-MKUP-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 01760007
           05  PV-XFER-IN-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO. 01770007
           05  PV-XFER-OUT-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO. 01780007
           05  PV-RCPT-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 01790007
           05  PV-RCPT-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.01800007
           05  PV-PADJ-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 01810007
           05  PV-PADJ-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.01820007
           05  PV-INV-ADJ-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO. 01830007
           05  PV-RCPT-FRGT-COST-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO. 01840007
           05  PV-PADJ-FRGT-COST-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO. 01850007
           05  PV-GRO-COST-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 01860007
           05  PV-ONORD-RTL-AMT-PRO    PIC S9(13)V99 COMP-3 VALUE ZERO. 01870007
           05  PV-ONORD-COST-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO. 01880007
           05  TV-SLS-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO. 01890007
           05  TV-MKDN-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01900007
           05  TV-MKUP-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01910007
           05  TV-XFER-IN-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO. 01920007
           05  TV-XFER-OUT-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO. 01930007
           05  TV-RCPT-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01940007
           05  TV-RCPT-NET-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO. 01950007
           05  TV-PADJ-RTL-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 01960007
           05  TV-PADJ-NET-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO. 01970007
           05  TV-INV-ADJ-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO. 01980007
           05  TV-RCPT-FRGT-COST       PIC S9(13)V99 COMP-3 VALUE ZERO. 01990007
           05  TV-PADJ-FRGT-COST       PIC S9(13)V99 COMP-3 VALUE ZERO. 02000007
           05  TV-GRO-COST-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO. 02010007
           05  TV-ONORD-RTL-AMT        PIC S9(13)V99 COMP-3 VALUE ZERO. 02020007
           05  TV-ONORD-COST-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO. 02030007
           05  TV-SLS-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO. 02040007
           05  TV-MKDN-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 02050007
           05  TV-MKUP-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 02060007
           05  TV-XFER-IN-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO. 02070007
           05  TV-XFER-OUT-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO. 02080007
           05  TV-RCPT-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 02090007
           05  TV-RCPT-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.02100007
           05  TV-PADJ-RTL-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 02110007
           05  TV-PADJ-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.02120007
           05  TV-INV-ADJ-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO. 02130007
           05  TV-RCPT-FRGT-COST-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO. 02140007
           05  TV-PADJ-FRGT-COST-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO. 02150007
           05  TV-GRO-COST-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO. 02160007
           05  TV-ONORD-RTL-AMT-PRO    PIC S9(13)V99 COMP-3 VALUE ZERO. 02170007
           05  TV-ONORD-COST-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO. 02180007
           05  PV-ENTID-PERCENT        PIC S9(04)V9(07)                 02190007
                                                     COMP-3 VALUE ZERO. 02200007
           05  PV-PRORATE-MKDN-AMOUNT  PIC S9(15)V99 COMP-3 VALUE ZERO. 02210007
           05  PV-PRORATE-MKUP-AMOUNT  PIC S9(15)V99 COMP-3 VALUE ZERO. 02220007
W37965     05  PV-SKU-NBR              PIC 9(08) VALUE ZEROES.                  
           05  PV-FISC-DATE-ISO.                                                
               10  PV-FISC-DATE-MM     PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  PV-FISC-DATE-DD     PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  PV-FISC-DATE-CC     PIC X(02) VALUE SPACES.                  
               10  PV-FISC-DATE-YY     PIC X(02) VALUE SPACES.                  
                                                                        02230007
       01  PV-W1-SAVE-RECORD.                                           02240007
           05 PV-W1-DATE-KEY.                                           02250007
               10 PV-W1-FSCL-MN-NBR     PIC X(2).                       02260007
               10 PV-W1-FSCL-MN-END-DTE PIC X(10).                      02270007
               10 PV-W1-FSCL-WK-NBR     PIC X(2).                       02280007
               10 PV-W1-FSCL-WK-END-DTE PIC X(10).                      02290007
           05 PV-W1-WORK-RECORD.                                        02300007
               10 PV-W1-DEPT-NBR     PIC S9(4)V COMP-3.                 02310007
               10 PV-W1-MAJ-CL-NBR   PIC S9(4)V COMP-3.                 02320007
               10 PV-W1-SUB-CL-NBR   PIC S9(4)V COMP-3.                 02330007
               10 PV-W1-LOC-NBR      PIC S9(4) COMP.                    02340007
               10 PV-W1-ENT-ID       PIC S9(9) COMP.                    02350007
               10 PV-W1-LBL-SEQ-NBR  PIC S9(9) COMP VALUE ZEROS.        02360007
               10 PV-W1-ML-LWST-ID   PIC S9(9) COMP VALUE ZEROS.        02370007
               10 PV-W1-SKU-NBR      PIC S9(8)V COMP-3.                 02380007
               10 PV-W1-FIN-LIAB-DTE PIC X(10)   VALUE SPACES.          02390007
               10 PV-W1-TRN-TYP-CDE  PIC X(02)   VALUE SPACES.          02400007
W37965         10 PV-W1-AP-TRANS-CDE PIC X(02)   VALUE SPACES.          02400007
W37965         10 PV-W1-PRCHG-RSN-CDE PIC X(04)  VALUE SPACES.          02400007
W37965         10 PV-W1-PRCHG-CTG-CDE PIC X(02)  VALUE SPACES.          02400007
                                                                        02410007
       01  PV-S1-WORK-RECORD.                                           02420007
           05 PV-S1-DATE-KEY.                                           02430007
               10 PV-S1-FSCL-MN-NBR     PIC X(2).                       02440007
               10 PV-S1-FSCL-MN-END-DTE PIC X(10).                      02450007
               10 PV-S1-FSCL-WK-NBR     PIC X(2).                       02460007
               10 PV-S1-FSCL-WK-END-DTE PIC X(10).                      02470007
           05 PV-S1-SAVE-RECORD.                                        02480007
               10 PV-S1-DEPT-NBR     PIC S9(4)V COMP-3.                 02490007
               10 PV-S1-MAJ-CL-NBR   PIC S9(4)V COMP-3.                 02500007
               10 PV-S1-SUB-CL-NBR   PIC S9(4)V COMP-3.                 02510007
               10 PV-S1-LOC-NBR      PIC S9(4) COMP.                    02520007
               10 PV-S1-ENT-ID       PIC S9(9) COMP.                    02530007
               10 PV-S1-LBL-SEQ-NBR  PIC S9(9) COMP VALUE ZEROS.        02540007
               10 PV-S1-ML-LWST-ID   PIC S9(9) COMP VALUE ZEROS.        02550007
               10 PV-S1-SKU-NBR      PIC S9(8)V COMP-3.                 02560007
               10 PV-S1-FIN-LIAB-DTE PIC X(10)   VALUE SPACES.          02570007
               10 PV-S1-TRN-TYP-CDE  PIC X(02)   VALUE SPACES.          02580007
W37965         10 PV-S1-AP-TRANS-CDE PIC X(02)   VALUE SPACES.          02400007
W37965         10 PV-S1-PRCHG-RSN-CDE PIC X(04)  VALUE SPACES.          02400007
W37965         10 PV-S1-PRCHG-CTG-CDE PIC X(02)  VALUE SPACES.          02400007
                                                                        02590007
       01  PV-W2-SAVE-RECORD.                                           02600007
           05 PV-W2-DEPT-NBR     PIC S9(4)V COMP-3.                     02610007
           05 PV-W2-ENT-ID       PIC S9(9) COMP.                        02620007
           05 PV-W2-LBL-SEQ-NBR  PIC S9(9) COMP VALUE ZEROS.            02630007
           05 PV-W2-ML-LWST-ID   PIC S9(9) COMP VALUE ZEROS.            02640007
                                                                        02650007
       01  PV-S2-WORK-RECORD.                                           02660007
           05 PV-S2-DEPT-NBR     PIC S9(4)V COMP-3.                     02670007
           05 PV-S2-ENT-ID       PIC S9(9) COMP.                        02680007
           05 PV-S2-LBL-SEQ-NBR  PIC S9(9) COMP VALUE ZEROS.            02690007
           05 PV-S2-ML-LWST-ID   PIC S9(9) COMP VALUE ZEROS.            02700007
                                                                                
       01  PT-DBV-SUM-TABLE.                                            02720007
           05 PT-DBV-SUM-TBL-ELE       OCCURS 20000 TIMES.              02730007
              10 P-DBV-DEPT-NBR           PIC  S9(4)V COMP-3.           02740007
              10 P-DBV-ENT-ID             PIC  S9(9) COMP.              02750007
              10 P-DBV-LBL-SEQ-NBR        PIC  S9(9) COMP VALUE ZEROS.  02760007
              10 P-DBV-ML-LWST-ID         PIC  S9(9) COMP VALUE ZEROS.  02770007
              10 P-DBV-SLS-REG-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      02780007
              10 P-DBV-SLS-PROMO-RTL-AMT  PIC  S9(11)V9(2) COMP-3.      02790007
              10 P-DBV-SLS-PROCLR-RTL-AMT PIC  S9(11)V9(2) COMP-3.      02800007
              10 P-DBV-SLS-CLR-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      02810007
              10 P-DBV-SLS-OTH-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      02820007
              10 P-DBV-MKDN-PLU-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      02830007
              10 P-DBV-MKDN-PROMO-RTL-AMT PIC  S9(11)V9(2) COMP-3.      02840007
              10 P-DBV-MKDN-RGST-RTL-AMT  PIC  S9(11)V9(2) COMP-3.      02850007
              10 P-DBV-MKDN-GLDST-RTL-AMT PIC  S9(11)V9(2) COMP-3.      02860007
              10 P-DBV-MKDN-UMTCH-RTL-AMT PIC  S9(11)V9(2) COMP-3.      02870007
              10 P-DBV-MKDN-BYR-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      02880007
              10 P-DBV-MKDN-STR-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      02890007
              10 P-DBV-MKDN-PRPT-RTL-AMT  PIC  S9(11)V9(2) COMP-3.      02900007
              10 P-DBV-MKDN-OTH-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      02910007
              10 P-DBV-MKDN-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      02920007
              10 P-DBV-MKUP-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      02930007
              10 P-DBV-XFER-IN-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      02940007
              10 P-DBV-XFER-OUT-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      02950007
              10 P-DBV-RCPT-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      02960007
              10 P-DBV-RCPT-NET-COST-AMT  PIC  S9(11)V9(2) COMP-3.      02970007
              10 P-DBV-RCPT-GRO-COST-AMT  PIC  S9(11)V9(2) COMP-3.      02980007
              10 P-DBV-RCPT-FRGT-COST-AMT PIC  S9(11)V9(2) COMP-3.      02990007
              10 P-DBV-PADJ-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      03000007
              10 P-DBV-PADJ-FRGT-COST-AMT PIC  S9(11)V9(2) COMP-3.      03010007
              10 P-DBV-PADJ-DISC-COST-AMT PIC  S9(11)V9(2) COMP-3.      03020007
              10 P-DBV-PADJ-RTV-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03030007
              10 P-DBV-PADJ-RTV-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03040007
              10 P-DBV-PADJ-DA-COST-AMT   PIC  S9(11)V9(2) COMP-3.      03050007
              10 P-DBV-PADJ-DA-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03060007
              10 P-DBV-PADJ-NET-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03070007
              10 P-DBV-PADJ-OTH-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03080007
              10 P-DBV-PADJ-OTH-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03090007
              10 P-DBV-PADJ-GRO-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03100007
              10 P-DBV-DR-ALW-RTL-AMT     PIC  S9(11)V9(2) COMP-3.      03110007
              10 P-DBV-RTV-RTL-AMT        PIC  S9(11)V9(2) COMP-3.      03120007
              10 P-DBV-MKUP-INIT-AMT      PIC  S9(11)V9(2) COMP-3.      03130007
              10 P-DBV-MKUP-NET-AMT       PIC  S9(11)V9(2) COMP-3.      03140007
              10 P-DBV-INV-ADJ-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03150007
              10 P-DBV-ONORD-RTL-AMT      PIC  S9(11)V9(2) COMP-3.      03160007
              10 P-DBV-ONORD-COST-AMT     PIC  S9(11)V9(2) COMP-3.      03170007
              10 P-DBV-SHNK-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      03180007
              10 P-DBV-END-INV-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03190007
              10 P-DBV-END-INV-COST-AMT   PIC  S9(11)V9(2) COMP-3.      03200007
              10 P-DBV-GRO-MRGN-AMT       PIC  S9(11)V9(2) COMP-3.      03210007
              10 P-DBV-IN-TRNST-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03220007
              10 P-DBV-RCPT-DISC-COST-AMT PIC  S9(11)V9(2) COMP-3.      03230007
              10 P-DBV-STR-EXPTED-RTL-AMT PIC  S9(11)V9(2) COMP-3.      03240007
                                                                        03250007
       01  PT-DPT-SUM-TABLE.                                            03260007
           05 PT-DPT-SUM-TBL-ELE       OCCURS 20000 TIMES.              03270007
              10 P-DPT-DEPT-NBR           PIC  S9(4)V COMP-3.           03280007
              10 P-DPT-ENT-ID             PIC  S9(9) COMP.              03290007
              10 P-DPT-SLS-REG-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03300007
              10 P-DPT-SLS-PROMO-RTL-AMT  PIC  S9(11)V9(2) COMP-3.      03310007
              10 P-DPT-SLS-PROCLR-RTL-AMT PIC  S9(11)V9(2) COMP-3.      03320007
              10 P-DPT-SLS-CLR-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03330007
              10 P-DPT-SLS-OTH-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03340007
              10 P-DPT-MKDN-PLU-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03350007
              10 P-DPT-MKDN-PROMO-RTL-AMT PIC  S9(11)V9(2) COMP-3.      03360007
              10 P-DPT-MKDN-RGST-RTL-AMT  PIC  S9(11)V9(2) COMP-3.      03370007
              10 P-DPT-MKDN-GLDST-RTL-AMT PIC  S9(11)V9(2) COMP-3.      03380007
              10 P-DPT-MKDN-UMTCH-RTL-AMT PIC  S9(11)V9(2) COMP-3.      03390007
              10 P-DPT-MKDN-BYR-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03400007
              10 P-DPT-MKDN-STR-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03410007
              10 P-DPT-MKDN-PRPT-RTL-AMT  PIC  S9(11)V9(2) COMP-3.      03420007
              10 P-DPT-MKDN-OTH-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03430007
              10 P-DPT-MKDN-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      03440007
              10 P-DPT-MKUP-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      03450007
              10 P-DPT-XFER-IN-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03460007
              10 P-DPT-XFER-OUT-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03470007
              10 P-DPT-RCPT-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      03480007
              10 P-DPT-RCPT-NET-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03490007
              10 P-DPT-RCPT-GRO-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03500007
              10 P-DPT-RCPT-FRGT-COST-AMT PIC  S9(11)V9(2) COMP-3.      03510007
              10 P-DPT-PADJ-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      03520007
              10 P-DPT-PADJ-FRGT-COST-AMT PIC  S9(11)V9(2) COMP-3.      03530007
              10 P-DPT-PADJ-DISC-COST-AMT PIC  S9(11)V9(2) COMP-3.      03540007
              10 P-DPT-PADJ-RTV-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03550007
              10 P-DPT-PADJ-RTV-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03560007
              10 P-DPT-PADJ-DA-COST-AMT   PIC  S9(11)V9(2) COMP-3.      03570007
              10 P-DPT-PADJ-DA-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03580007
              10 P-DPT-PADJ-NET-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03590007
              10 P-DPT-PADJ-OTH-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03600007
              10 P-DPT-PADJ-OTH-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03610007
              10 P-DPT-PADJ-GRO-COST-AMT  PIC  S9(11)V9(2) COMP-3.      03620007
              10 P-DPT-DR-ALW-RTL-AMT     PIC  S9(11)V9(2) COMP-3.      03630007
              10 P-DPT-RTV-RTL-AMT        PIC  S9(11)V9(2) COMP-3.      03640007
              10 P-DPT-MKUP-INIT-AMT      PIC  S9(11)V9(2) COMP-3.      03650007
              10 P-DPT-MKUP-NET-AMT       PIC  S9(11)V9(2) COMP-3.      03660007
              10 P-DPT-INV-ADJ-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03670007
              10 P-DPT-ONORD-RTL-AMT      PIC  S9(11)V9(2) COMP-3.      03680007
              10 P-DPT-ONORD-COST-AMT     PIC  S9(11)V9(2) COMP-3.      03690007
              10 P-DPT-SHNK-RTL-AMT       PIC  S9(11)V9(2) COMP-3.      03700007
              10 P-DPT-END-INV-RTL-AMT    PIC  S9(11)V9(2) COMP-3.      03710007
              10 P-DPT-END-INV-COST-AMT   PIC  S9(11)V9(2) COMP-3.      03720007
              10 P-DPT-GRO-MRGN-AMT       PIC  S9(11)V9(2) COMP-3.      03730007
              10 P-DPT-IN-TRNST-RTL-AMT   PIC  S9(11)V9(2) COMP-3.      03740007
              10 P-DPT-RCPT-DISC-COST-AMT PIC  S9(11)V9(2) COMP-3.      03750007
              10 P-DPT-STR-EXPTED-RTL-AMT PIC  S9(11)V9(2) COMP-3.      03760007
                                                                        03770007
       01  PS-PROGRAM-SWITCHES.                                         03780007
           05  PS-PROCESS-COMPLETE-SW    PIC X(01)   VALUE 'N'.         03790007
               88  PS-PROCESS-COMPLETE               VALUE 'Y'.         03800007
           05  PS-INP02-COMPLETE-SW      PIC X(01)   VALUE 'N'.         03810007
               88  PS-INP02-COMPLETE                 VALUE 'Y'.         03820007
           05  PS-INP03-COMPLETE-SW      PIC X(01)   VALUE 'N'.         03830007
               88  PS-INP03-COMPLETE                 VALUE 'Y'.         03840007
           05  PS-INP04-COMPLETE-SW      PIC X(01)   VALUE 'N'.         03850007
               88  PS-INP04-COMPLETE                 VALUE 'Y'.         03860007
           05  PS-INP05-COMPLETE-SW      PIC X(01)   VALUE 'N'.         03850007
               88  PS-INP05-COMPLETE                 VALUE 'Y'.         03860007
           05  PS-WRITE-ADJUST-SW        PIC X(01)   VALUE 'N'.         03870007
               88  PS-WRITE-ADJUSTMENT               VALUE 'Y'.         03880007
           05  PS-DBV-SUM-LOADED-SW      PIC X(01)   VALUE 'N'.         03890007
               88  PS-DBV-SUM-LOADED                 VALUE 'Y'.         03900007
           05  PS-DBV-TBL-FOUND-SW       PIC X(01)   VALUE 'N'.         03910007
               88  PS-DBV-TBL-FOUND                  VALUE 'Y'.         03920007
           05  PS-DPT-TBL-FOUND-SW       PIC X(01)   VALUE 'N'.         03930007
               88  PS-DPT-TBL-FOUND                  VALUE 'Y'.         03940007
                                                                        03950007
0422RM 01  DETAIL-LOG-RECORD.                                                   
0422RM     05  DET-LOG-REC-TYPE    PIC X(03).                                   
0422RM     05  DET-REC             PIC X(450).                                  
      /*****************************************************************03960007
      * COPYBOOK - DETAILED MERCH LEDGER SAVE AREA(S)                   03970007
      ******************************************************************03980007
           COPY MLRD254 REPLACING ML254 BY MLSVE.                       03990007
           COPY MLRD254 REPLACING ML254 BY PSAVE.                       04000007
           COPY MLRD254 REPLACING ML254 BY MLDBV.                       04010007
           COPY MLRD254 REPLACING ML254 BY MLDPT.                       04020007
                                                                        04030007
      /**************************************************************** 04040007
      * COPYBOOK - KOHL'S STANDARD 100 BYTE REPORT TITLE COPYBOOK       04050007
      ***************************************************************** 04060007
           COPY DPWS250O.                                               04070007
                                                                        04080007
W37965/**************************************************************** 04040007
W37965* COPYBOOK - AUDIT DETAIL RECORD LAYOUT                           04050007
W37965***************************************************************** 04060007
W37965     COPY MLRD090.                                                00940007
                                                                                
       01  REPORT-TITLE-LINE.                                           04090007
           05  FILLER                     PIC X(87)   VALUE SPACES.     04100007
           05  RTL-DESCRIPTION            PIC X(40)   VALUE SPACES.     04110007
           05  RPT-FISCAL-DESC            PIC X(22)   VALUE                     
                                          'FOR FISCAL WEEK DATE: '.             
           05  RPT-FISCAL-DATE            PIC X(10)   VALUE SPACES.             
                                                                        04120007
       01  REPORT-HEADING-LINE.                                         04130007
           05  FILLER                     PIC X(03) VALUE 'DPT'.        04140007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04150007
           05  FILLER                     PIC X(03) VALUE 'SCL'.        04160007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04170007
           05  FILLER                     PIC X(04) VALUE 'LOC'.        04180007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04190007
           05  FILLER                     PIC X(02) VALUE 'TR'.         04200007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04210007
           05  FILLER                     PIC X(08) VALUE 'ENT ID'.     04220007
           05  FILLER                     PIC X(02)   VALUE SPACES.     04230007
           05  FILLER                     PIC X(05) VALUE 'LABEL'.      04240007
           05  FILLER                     PIC X(05)   VALUE SPACES.     04250007
           05  FILLER                     PIC X(05) VALUE 'DKEY '.      04260007
           05  FILLER                     PIC X(05)   VALUE SPACES.     04270007
           05  FILLER                     PIC X(15) VALUE 'SALES'.      04280007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04290007
           05  FILLER                     PIC X(15) VALUE 'MK DWNS'.    04300007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04310007
           05  FILLER                     PIC X(15) VALUE 'MK UPS'.     04320007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04330007
           05  FILLER                     PIC X(15) VALUE 'XFER IN'.    04340007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04350007
           05  FILLER                     PIC X(15) VALUE 'XFER OUT'.   04360007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04370007
           05  FILLER                     PIC X(15) VALUE 'RCPT RTL'.   04380007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04390007
           05  FILLER                     PIC X(15) VALUE 'RCPT NET'.   04400007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04410007
           05  FILLER                     PIC X(15) VALUE 'PADJ RTL'.   04420007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04430007
           05  FILLER                     PIC X(15) VALUE 'PADJ NET'.   04440007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04450007
           05  FILLER                     PIC X(15) VALUE 'INVADJ RTL'. 04460007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04470007
           05  FILLER                     PIC X(13) VALUE 'RCPT FRGT '. 04480007
           05  FILLER                     PIC X(02)   VALUE SPACES.     04490007
           05  FILLER                     PIC X(13) VALUE 'PADJ FRGT '. 04500007
           05  FILLER                     PIC X(03)   VALUE SPACES.     04510007
           05  FILLER                     PIC X(10) VALUE 'GRO COST'.   04520007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04530007
                                                                        04540007
       01  REPORT-HEADING-LINE2.                                        04550007
           05  FILLER             PIC X(26) VALUE SPACES.               04560007
           05  FILLER             PIC X(05) VALUE 'SEQ #'.              04570007
           05  FILLER             PIC X(09) VALUE SPACES.               04580007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04590007
           05  FILLER             PIC X(01)   VALUE SPACES.             04600007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04610007
           05  FILLER             PIC X(01)   VALUE SPACES.             04620007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04630007
           05  FILLER             PIC X(01)   VALUE SPACES.             04640007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04650007
           05  FILLER             PIC X(01)   VALUE SPACES.             04660007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04670007
           05  FILLER             PIC X(01)   VALUE SPACES.             04680007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04690007
           05  FILLER             PIC X(01)   VALUE SPACES.             04700007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04710007
           05  FILLER             PIC X(01)   VALUE SPACES.             04720007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04730007
           05  FILLER             PIC X(01)   VALUE SPACES.             04740007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04750007
           05  FILLER             PIC X(01)   VALUE SPACES.             04760007
           05  FILLER             PIC X(15) VALUE '      >>PRORTE'.     04770007
           05  FILLER             PIC X(03)   VALUE SPACES.             04780007
           05  FILLER             PIC X(13) VALUE '    >>PRORTE'.       04790007
           05  FILLER             PIC X(02)   VALUE SPACES.             04800007
           05  FILLER             PIC X(13) VALUE '    >>PRORTE'.       04810007
           05  FILLER             PIC X(03)   VALUE SPACES.             04820007
           05  FILLER             PIC X(13) VALUE '    >>PRORTE'.       04830007
                                                                        04840007
       01  REPORT-DETAIL-LINE.                                          04850007
           05  DL-KEY.                                                  04860007
               10  DL-DEPT-NBR            PIC Z(03).                    04870007
               10  FILLER                 PIC X(01)   VALUE SPACES.     04880007
               10  DL-SUB-CL-NBR          PIC Z(03).                    04890007
               10  FILLER                 PIC X(01)   VALUE SPACES.     04900007
               10  DL-LOC-NBR             PIC Z(04).                    04910007
               10  FILLER                 PIC X(01)   VALUE SPACES.     04920007
               10  DL-TRN-TYP-CDE         PIC X(02).                    04930007
           05  DL-VERBIAGE REDEFINES DL-KEY.                            04940007
               10  FILLER                 PIC X(02).                    04950007
               10  DL-PRO-VERBIAGE        PIC X(13).                    04960007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04970007
           05  DL-ENT-ID                  PIC Z(08).                    04980007
           05  FILLER                     PIC X(01)   VALUE SPACES.     04990007
           05  DL-LBL-SEQ-NBR             PIC Z(09).                    05000007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05010007
           05  DL-DKEY                    PIC Z(09).                    05020007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05030007
           05  DL-SLS-RTL-AMT             PIC ZZZ,ZZZ,ZZ9.99-.          05040007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05050007
           05  DL-MKDN-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05060007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05070007
           05  DL-MKUP-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05080007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05090007
           05  DL-XFER-IN-RTL-AMT         PIC ZZZ,ZZZ,ZZ9.99-.          05100007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05110007
           05  DL-XFER-OUT-RTL-AMT        PIC ZZZ,ZZZ,ZZ9.99-.          05120007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05130007
           05  DL-RCPT-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05140007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05150007
           05  DL-RCPT-NET-COST-AMT       PIC ZZZ,ZZZ,ZZ9.99-.          05160007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05170007
           05  DL-PADJ-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05180007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05190007
           05  DL-PADJ-NET-COST-AMT       PIC ZZZ,ZZZ,ZZ9.99-.          05200007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05210007
           05  DL-INV-ADJ-RTL-AMT         PIC ZZZ,ZZZ,ZZ9.99-.          05220007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05230007
           05  DL-RCPT-FRGT-COST-AMT      PIC ZZ,ZZZ,ZZ9.99-.           05240007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05250007
           05  DL-PADJ-FRGT-COST-AMT      PIC ZZ,ZZZ,ZZ9.99-.           05260007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05270007
           05  DL-GRO-COST-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05280007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05290007
                                                                        05300007
       01  REPORT-UL-LINE.                                              05310007
           05  FILLER                     PIC X(03) VALUE ALL '-'.      05320007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05330007
           05  FILLER                     PIC X(03) VALUE ALL '-'.      05340007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05350007
           05  FILLER                     PIC X(04) VALUE ALL '-'.      05360007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05370007
           05  FILLER                     PIC X(02) VALUE ALL '-'.      05380007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05390007
           05  FILLER                     PIC X(09) VALUE ALL '-'.      05400007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05410007
           05  FILLER                     PIC X(09) VALUE ALL '-'.      05420007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05430007
           05  FILLER                     PIC X(09) VALUE ALL '-'.      05440007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05450007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05460007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05470007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05480007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05490007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05500007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05510007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05520007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05530007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05540007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05550007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05560007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05570007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05580007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05590007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05600007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05610007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05620007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05630007
           05  FILLER                     PIC X(14) VALUE ALL '-'.      05640007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05650007
           05  FILLER                     PIC X(12) VALUE ALL '-'.      05660007
           05  FILLER                     PIC X(03)   VALUE SPACES.     05670007
           05  FILLER                     PIC X(12) VALUE ALL '-'.      05680007
           05  FILLER                     PIC X(04)   VALUE SPACES.     05690007
           05  FILLER                     PIC X(12) VALUE ALL '-'.      05700007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05710007
                                                                        05720007
       01  REPORT-TOTAL-LINE.                                           05730007
           05  TL-VERBIAGE                PIC X(19).                    05740007
           05  FILLER                     PIC X(02)   VALUE SPACES.     05750007
           05  TL-ENT-ID                  PIC X(08).                    05760007
           05  TL-ENT-ID-R REDEFINES TL-ENT-ID.                         05770007
               10  TL-ENT-ID-9            PIC Z(08).                    05780007
           05  FILLER                     PIC X(16)   VALUE SPACES.     05790007
           05  TL-SLS-RTL-AMT             PIC ZZZ,ZZZ,ZZ9.99-.          05800007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05810007
           05  TL-MKDN-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05820007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05830007
           05  TL-MKUP-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05840007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05850007
           05  TL-XFER-IN-RTL-AMT         PIC ZZZ,ZZZ,ZZ9.99-.          05860007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05870007
           05  TL-XFER-OUT-RTL-AMT        PIC ZZZ,ZZZ,ZZ9.99-.          05880007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05890007
           05  TL-RCPT-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05900007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05910007
           05  TL-RCPT-NET-COST-AMT       PIC ZZZ,ZZZ,ZZ9.99-.          05920007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05930007
           05  TL-PADJ-RTL-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          05940007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05950007
           05  TL-PADJ-NET-COST-AMT       PIC ZZZ,ZZZ,ZZ9.99-.          05960007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05970007
           05  TL-INV-ADJ-RTL-AMT         PIC ZZZ,ZZZ,ZZ9.99-.          05980007
           05  FILLER                     PIC X(01)   VALUE SPACES.     05990007
           05  TL-RCPT-FRGT-COST-AMT      PIC ZZ,ZZZ,ZZ9.99-.           06000007
           05  FILLER                     PIC X(01)   VALUE SPACES.     06010007
           05  TL-PADJ-FRGT-COST-AMT      PIC ZZ,ZZZ,ZZ9.99-.           06020007
           05  FILLER                     PIC X(01)   VALUE SPACES.     06030007
           05  TL-GRO-COST-AMT            PIC ZZZ,ZZZ,ZZ9.99-.          06040007
           05  FILLER                     PIC X(01)   VALUE SPACES.     06050007
                                                                        06060007
      /*****************************************************************06070007
      *FLOW:    THE PROGRAM RUNS BOTH IN MERCH LEDGER AND INVENTORY     06080007
      *         LEDGER SCHEDULES. THE PROGRAM IS DESIGNED TO PRORATE    06090007
X28582*         UNKNOWN VENDOR AND UNKNOWN BRAND DOLLARS ACROSS ALL     06100007
X28582*         REGULAR VENDORS AT A DEPARTMENT/BRAND/VENDOR            06110007
X28582*         TRANSACTION LEVEL.                                      06120007
      *                                                                 06130007
X28582*         THE PROGRAM CAN BE RUN TWO DIFFERENT WAYS BASED ON THE  06140007
X28582*         PASSED VARIABLE FROM INP04.                             06150007
X28582*         1. CC-MODE-KNOWN-UNKNOWN (MLCCRJ02)                     06160007
X28582*            'KU             KNOWN/UNKNOWN ACTUALS PRORATION'     06170007
X28582*         2. CC-MODE-UNKNOWN-UNKNOWN (MLCCRJ03)                   06180007
X28582*            'UU             UNKNOWN/UNKNOWN ACTUALS PRORATION'   06190007
X28582*                                                                 06200007
X28582*         DBV LVL AND DEPT LEVEL INFO. THESE SUMMARY ROWS ARE     06210007
X28582*         USED TO DETERMINE THE DISTRIBUTION PERCENTAGE EACH DBV  06220007
X28582*         COMBINATION WILL GET FOR UNKNOWN VENDOR AND UNKNOWN     06230007
X28582*         BRAND DOLLARS.                                          06240007
X28582*                                                                 06250007
W28582*         INPUT DATA USES THE RECORD FORMAT MLRD254 AND BREAKS    06260007
W28582*         OCCUR ON 1ST 64 BYTES. SUMMARY RECORDS EXIST AT THE DBV 06270007
X28582*         LEVEL AND THE DEPARTMENT LEVEL. THE SUMMARY ROWS ARE    06280007
X28582*         USED TO DETERMINE THE DISTRIBUTION PERCENTAGE EACH DBV  06290007
X28582*         COMBINATION WILL GET OF HE UNKNOWN VENDOR AND UNKNOWN   06300007
X28582*         BRAND DOLLARS.                                          06310007
X28582*                                                                 06320007
X28582*         STORE THE DBV LEVEL AND DEPT LEVEL SUMMARIES TO         06330007
X28582*         WORKING STORAGE TABLES. THE DBV LEVEL SUMMARY TABLE IS  06340007
X28582*         RELOADED AT A DBV LEVEL BREAK. THE DEPT LEVEL SUMMARY   06350007
X28582*         TABLE IS LOADED FULLY DURING INITIALIZATION.            06360007
X28582*                                                                 06370007
X28582*         READ THE UNKNOWN INPUT DETAIL - INP03 AND PRORATE ITS   06380007
X28582*         DOLLARS AMOUNG THE VALID DBV COMBINATIONS. INP03 IS AT  06390007
X28582*         A DETAIL LEVEL. EACH VALID DBV COMBO FOR                06400007
X28582*         IS BUILT USING THE DBV COMBO AND THE DTL LVL ATTRIBUTES.06410007
      *                                                                 06420007
      *         THE FORMULA:                                            06430007
X28582*        *PRORATE PERCENT = DBV LVL VEND DLRS (EXCLUDING UNKNOWN) 06440007
X28582*                         / DPT LVL DLRS (EXCLUDING UNKNOWN)      06450007
      *        *TRANS LVL PRORATED VENDOR DOLLARS = (UNKNWN VEND DLRS   06460007
      *                                        * PRORATE PERCENT)       06470007
      *                                        + TRANS LVL VEND DLRS    06480007
X28582*        *IF A REMAINDER EXISTS AT A TRANS LVL BREAK, APPLY THE   06490007
X28582*         ADJUSTMENT TO THE LAST DEPT/VENDOR/BRAND COMBINATION.   06500007
      *                                                                 06510007
      *         IT IS POSSIBLE TO HAVE TRUE UNKNOWN VENDOR DOLLARS.     06520007
      *                                                                 06530007
      *         A DETAILED PRORATION REPORT IS CREATED. TRANSACTION     06540007
      *         LEVEL TOTALS AND A GRAND TOTALS ARE CREATED.            06550007
      *                                                                 06560007
W28582*         COPYBOOK MLRD254 IS USED TO DESCRIBE THE FOLLOWING      06570007
W28582*         WORKING STORAGE FIELDS. (ML254-UPDATE-REC)              06580007
X28582*         1.  UDPTI- REPRESENTS THE SUMM'D DPT LEVEL RECORD.      06590007
X28582*         2.  UDBVI- REPRESENTS THE SUMM'D DBV LEVEL RECORD.      06600007
X28582*         3.  UDTLI- REPRESENTS THE READ INPUT RECORD. (INP03)    06610007
      *         4.  MLSVE- CONTAINS WHAT THE TRANS LVL PRORATE DOLLARS. 06620007
      *                    THE VALUES ARE COMPARED TO THE VENDOR SUMM   06630007
      *                    FOR ANY REMAINDER ADJUSTMENTS NECESSARY.     06640007
X28582*         5.  MLDPT- REPRESENTS THE DPT LVL TABLE WORK RECORD.    06650007
X28582*         6.  MLDBV- REPRESENTS THE DBV LVL TABLE WORK RECORD.    06660007
X28582*         7.  PSAVE- REPRESENTS A SAVE OF THE READ INPUT RECORD.  06670007
X28582*                    (INP03)                                      06680007
      *                                                                 06690007
      *         INPUTS:                                                 06700007
X28582*           INP01 (ML) PKMT.ML.DTLDGR.PRCH.WKLY.DPTSUMP1          06710007
X28582*                 (ML) PKMT.ML.DTLDGR.SALE.WKLY.DPTSUMP1          06720007
X28582*                 (ML) PKMT.ML.DTLDGR.PCHG.WKLY.DPTSUMP1          06730007
X28582*                 (IN) PKMT.IN.DTLDGR.WKLY.DPTSUMP1               06740007
X28582*           INP02 (ML) PKMT.ML.DTLDGR.PRCH.WKLY.DBVSUMP1          06750007
X28582*                 (ML) PKMT.ML.DTLDGR.SALE.WKLY.DBVSUMP1          06760007
X28582*                 (ML) PKMT.ML.DTLDGR.PCHG.WKLY.DBVSUMP1          06770007
X28582*                 (IN) PKMT.IN.DTLDGR.WKLY.DBVSUMP1               06780007
X28582*           INP03 (ML) PKMT.ML.DTLDGR.PRCH.WKLY.UKSRTP1           06790007
X28582*                 (ML) PKMT.ML.DTLDGR.SALE.WKLY.UKSRTP1           06800007
X28582*                 (ML) PKMT.ML.DTLDGR.PCHG.WKLY.UKSRTP1           06810007
X28582*                 (IN) PKMT.ML.DTLDGR.WKLY.UKSRTP1                06820007
X28582*           INP04 (ML) PKMO.CONTROL(MLCCRJ02)                     06830007
X28582*                 (ML) PKMO.CONTROL(MLCCRJ03)                     06840007
X28582*                 (IN) PKMO.CONTROL(MLCCRJ02)                     06850007
X28582*                 (IN) PKMO.CONTROL(MLCCRJ03)                     06860007
X28582*           OUT01 (ML) PKMT.ML.DTLDGR.PRCH.WKLY.PRORATE.P1        06870007
X28582*                 (ML) PKMT.ML.DTLDGR.SALE.WKLY.PRORATE.P1        06880007
X28582*                 (ML) PKMT.ML.DTLDGR.PCHG.WKLY.PRORATE.P1        06890007
X28582*                 (IN) PKMO.IN.CONSOLID.UPDATE.FILE(+1)           06900007
X28582*           RPT01 (ML) PKMO.ML.MLK221.MLKUT001.RPT01              06910007
X28582*                 (ML) PKMO.ML.MLK222.MLKUT001.RPT01              06920007
X28582*                 (ML) PKMO.ML.MLK223.MLKUT001.RPT01              06930007
X28582*                 (IN) PKMO.IN.INK161.MLKUT001.RPT01(+1)          06940007
      *                                                                 06950007
      ******************************************************************06960007
      ******************************************************************06970007
       PROCEDURE DIVISION.                                              06980007
      ******************************************************************06990007
                                                                        07000007
       0000-MAINLINE-MLKUT110.                                          07010007
                                                                        07020007
           PERFORM 1000-INITIALIZATION.                                 07030007
                                                                        07040007
           PERFORM 2000-PRORATION-MAIN-LOOP                             07050007
               UNTIL PS-INP03-COMPLETE.                                 07060007
                                                                        07070007
           PERFORM 9000-END-OF-JOB-TASKS.                               07080007
                                                                        07090007
       9999-EXIT-PROGRAM.                                               07100007
           STOP RUN.                                                    07110007
                                                                        07120007
      /*****************************************************************07130007
      * 1000-INITIALIZATION.                                            07140007
      ******************************************************************07150007
       1000-INITIALIZATION.                                             07160007
                                                                        07170007
           DISPLAY '******************************************'.        07180007
           DISPLAY '*  START OF ', PC-PROGRAM-NAME                      07190007
           DISPLAY '******************************************'.        07200007
           DISPLAY ' '.                                                 07210007
                                                                        07220007
           OPEN INPUT  DTL-LDGR-DPT-TOT-IN                              07230007
                INPUT  DTL-LDGR-DBV-SUM-IN                              07240007
                INPUT  DTL-LDGR-UNKNOWN-DTL-IN                          07250007
                INPUT  CONTROL-CARD-IN                                  07260007
                INPUT  CNTL-DATE-FILE                                   07260007
                OUTPUT DTL-LDGR-FILE-OUT                                07270007
0422RM          OUTPUT DTL-AUDIT-LOG-FILE-OUT                                   
W37965          OUTPUT DTL-AUDIT-FILE-OUT                               07270007
                OUTPUT DTL-LDGR-PRORATE-RPT.                            07280007
                                                                        07290007
           INITIALIZE UDPTI-UPDATE-REC.                                 07300007
           INITIALIZE UDBVI-UPDATE-REC.                                 07310007
           INITIALIZE UDTLI-UPDATE-REC.                                 07320007
           INITIALIZE MLSVE-UPDATE-REC.                                 07330007
           INITIALIZE MLDPT-UPDATE-REC.                                 07340007
           INITIALIZE MLDBV-UPDATE-REC.                                 07350007
           INITIALIZE PSAVE-UPDATE-REC.                                 07360007
                                                                        07370007
           MOVE 'N'                 TO PS-PROCESS-COMPLETE-SW.          07380007
           MOVE 'N'                 TO PS-INP02-COMPLETE-SW.            07390007
           MOVE 'N'                 TO PS-INP03-COMPLETE-SW.            07400007
           MOVE 'N'                 TO PS-WRITE-ADJUST-SW.              07410007
                                                                        07420007
                                                                                
           PERFORM 7400-READ-CONTROL-CARD.                              07430007
           IF PS-INP04-COMPLETE                                         07440007
               DISPLAY '*******************************************'    07450007
               DISPLAY '*** ABEND - MISSING CONTROL CARD INFORMATION'   07460007
               DISPLAY '*** 1000-INITIALIZATION '                       07470007
               DISPLAY '*******************************************'    07480007
               SET ABEND-4002-READ-ERROR  TO TRUE                       07490007
               PERFORM 9500-ABEND                                       07500007
           ELSE                                                         07510007
           IF (NOT CC-VALID-MODE)                                       07520007
               DISPLAY '*******************************************'    07530007
               DISPLAY '*** ABEND - INVALID CONTROL CARD INFORMATION'   07540007
               DISPLAY '*** 1000-INITIALIZATION '                       07550007
               DISPLAY '*******************************************'    07560007
               SET ABEND-4002-READ-ERROR  TO TRUE                       07570007
               PERFORM 9500-ABEND                                       07580007
           ELSE                                                         07590007
               DISPLAY '*******************************************'    07600007
               DISPLAY '* TYPE: ', CC-DESCRIPTION                       07610007
               DISPLAY '*******************************************'    07620007
               DISPLAY ' '                                              07630007
           END-IF.                                                      07640007
                                                                        07650007
           PERFORM 7500-READ-CNTL-DATE                                          
           IF PS-INP05-COMPLETE                                                 
               DISPLAY '*******************************************'            
               DISPLAY '*** ABEND - MISSING CNTL-DATE    INFORMATION'           
               DISPLAY '*** 1000-INITIALIZATION '                               
               DISPLAY '*******************************************'            
               SET ABEND-4002-READ-ERROR  TO TRUE                               
               PERFORM 9500-ABEND                                               
           ELSE                                                                 
           IF CNTL-DATE-REC = SPACES                                            
               DISPLAY '*******************************************'    07530007
               DISPLAY '*** ABEND - INVALID CNTL-DATE    INFORMATION'   07540007
               DISPLAY '*** 1000-INITIALIZATION '                       07550007
               DISPLAY '*******************************************'    07560007
               SET ABEND-4002-READ-ERROR  TO TRUE                       07570007
               PERFORM 9500-ABEND                                       07580007
           ELSE                                                                 
               DISPLAY 'DATE READ FROM CONTROL FILE: ' CC-PROC-DATE-ISO         
               MOVE CC-PROC-DATE-MM  TO PV-FISC-DATE-MM                         
               MOVE CC-PROC-DATE-DD  TO PV-FISC-DATE-DD                         
               MOVE CC-PROC-DATE-CC  TO PV-FISC-DATE-CC                         
               MOVE CC-PROC-DATE-YY  TO PV-FISC-DATE-YY                         
               MOVE PV-FISC-DATE-ISO TO RPT-FISCAL-DATE                         
           END-IF.                                                              
                                                                                
           PERFORM 7300-READ-UNKNOWN-DTL-IN.                            07660007
           IF PS-INP03-COMPLETE                                         07670007
               DISPLAY '*******************************************'    07680007
               DISPLAY '*** ' PC-PROGRAM-NAME ' - NOTHING TO PRORATE'   07690007
               DISPLAY '*******************************************'    07700007
               DISPLAY ' '                                              07710007
           ELSE                                                         07720007
               MOVE UDTLI-UPDATE-REC  TO PSAVE-UPDATE-REC               07730007
                                                                        07740007
               MOVE PSAVE-FSCL-MN-NBR     TO PV-S1-FSCL-MN-NBR          07750007
               MOVE PSAVE-FSCL-MN-END-DTE TO PV-S1-FSCL-MN-END-DTE      07760007
               MOVE PSAVE-FSCL-WK-NBR     TO PV-S1-FSCL-WK-NBR          07770007
               MOVE PSAVE-FSCL-WK-END-DTE TO PV-S1-FSCL-WK-END-DTE      07780007
               MOVE PSAVE-DEPT-NBR        TO PV-S1-DEPT-NBR             07790007
               MOVE PSAVE-MAJ-CL-NBR      TO PV-S1-MAJ-CL-NBR           07800007
               MOVE PSAVE-SUB-CL-NBR      TO PV-S1-SUB-CL-NBR           07810007
               MOVE PSAVE-LOC-NBR         TO PV-S1-LOC-NBR              07820007
               MOVE PSAVE-ENT-ID          TO PV-S1-ENT-ID               07830007
               MOVE PSAVE-LBL-SEQ-NBR     TO PV-S1-LBL-SEQ-NBR          07840007
               MOVE PSAVE-ML-LWST-ID      TO PV-S1-ML-LWST-ID           07850007
               MOVE PSAVE-SKU-NBR         TO PV-S1-SKU-NBR              07860007
               MOVE PSAVE-FIN-LIAB-DTE    TO PV-S1-FIN-LIAB-DTE         07870007
               MOVE PSAVE-TRN-TYP-CDE     TO PV-S1-TRN-TYP-CDE          07880007
W37965         MOVE PSAVE-AP-TRANS-CDE    TO PV-S1-AP-TRANS-CDE         07880007
W37965         MOVE PSAVE-PRCHG-RSN-CDE   TO PV-S1-PRCHG-RSN-CDE        07880007
W37965         MOVE PSAVE-PRCHG-CTG-CDE   TO PV-S1-PRCHG-CTG-CDE        07880007
                                                                        07890007
               INITIALIZE PT-DBV-SUM-TABLE                              07900007
               INITIALIZE PV-S2-WORK-RECORD                             07910007
               MOVE 'N'            TO PS-DBV-SUM-LOADED-SW              07920007
               MOVE 1              TO PV-DBV-COUNT                      07930007
               MOVE 1              TO DBVI                              07940007
               PERFORM 7200-READ-DBV-SUM-IN                             07950007
               PERFORM 6200-PROCESS-DBV-SUM                             07960007
                  UNTIL PS-INP02-COMPLETE                               07970007
                     OR PS-DBV-SUM-LOADED                               07980007
                                                                        07990007
               INITIALIZE PT-DPT-SUM-TABLE                              08000007
               MOVE 1              TO PV-DPT-COUNT                      08010007
               MOVE 1              TO DPTI                              08020007
               PERFORM 7000-READ-DPT-TOT-IN                             08030007
               PERFORM 6300-LOAD-DPT-TOT                                08040007
                  VARYING DPTI FROM 1 BY 1                              08050007
                  UNTIL PS-PROCESS-COMPLETE                             08060007
                     OR DPTI GREATER PC-MAX-DPT-ROWS                    08070007
                                                                        08080007
           END-IF.                                                      08090007
                                                                        08100007
           MOVE FUNCTION CURRENT-DATE (3:2)  TO DP250O-RUN-YEAR.        08110007
           MOVE FUNCTION CURRENT-DATE (5:2)  TO DP250O-RUN-MONTH.       08120007
           MOVE FUNCTION CURRENT-DATE (7:2)  TO DP250O-RUN-DAY.         08130007
           MOVE FUNCTION CURRENT-DATE (9:2)  TO DP250O-RUN-HOUR.        08140007
           MOVE FUNCTION CURRENT-DATE (11:2) TO DP250O-RUN-MINUTE.      08150007
           MOVE PC-PROGRAM-NAME              TO DP250O-PROGRAM-NAME.    08160007
                                                                        08170007
           IF CC-MODE-KNOWN-UNKNOWN                                     08180007
               MOVE 'DETAIL LEDGER DETAILED K/U PRORATE RPT '           08190007
                                             TO RTL-DESCRIPTION         08200007
               MOVE 1                        TO DP250O-REPORT-NUMBER    08210007
           ELSE                                                         08220007
               MOVE 'DETAIL LEDGER DETAILED U/U PRORATE RPT '           08230007
                                             TO RTL-DESCRIPTION         08240007
               MOVE 2                        TO DP250O-REPORT-NUMBER    08250007
           END-IF.                                                      08260007
                                                                        08270007
      /*****************************************************************08280007
      * 2000-PRORATION-MAIN-LOOP.                                       08290007
      ******************************************************************08300007
       2000-PRORATION-MAIN-LOOP.                                        08310007
                                                                        08320007
           MOVE UDTLI-FSCL-MN-NBR     TO PV-W1-FSCL-MN-NBR.             08330007
           MOVE UDTLI-FSCL-MN-END-DTE TO PV-W1-FSCL-MN-END-DTE.         08340007
           MOVE UDTLI-FSCL-WK-NBR     TO PV-W1-FSCL-WK-NBR.             08350007
           MOVE UDTLI-FSCL-WK-END-DTE TO PV-W1-FSCL-WK-END-DTE.         08360007
           MOVE UDTLI-DEPT-NBR        TO PV-W1-DEPT-NBR.                08370007
           MOVE UDTLI-MAJ-CL-NBR      TO PV-W1-MAJ-CL-NBR.              08380007
           MOVE UDTLI-SUB-CL-NBR      TO PV-W1-SUB-CL-NBR.              08390007
           MOVE UDTLI-LOC-NBR         TO PV-W1-LOC-NBR.                 08400007
           MOVE UDTLI-ENT-ID          TO PV-W1-ENT-ID.                  08410007
           MOVE UDTLI-LBL-SEQ-NBR     TO PV-W1-LBL-SEQ-NBR.             08420007
           MOVE UDTLI-ML-LWST-ID      TO PV-W1-ML-LWST-ID.              08430007
           MOVE UDTLI-SKU-NBR         TO PV-W1-SKU-NBR.                 08440007
           MOVE UDTLI-FIN-LIAB-DTE    TO PV-W1-FIN-LIAB-DTE.            08450007
           MOVE UDTLI-TRN-TYP-CDE     TO PV-W1-TRN-TYP-CDE.             08460007
W37965     MOVE UDTLI-AP-TRANS-CDE    TO PV-W1-AP-TRANS-CDE.            08460007
W37965     MOVE UDTLI-PRCHG-RSN-CDE   TO PV-W1-PRCHG-RSN-CDE.           08460007
W37965     MOVE UDTLI-PRCHG-CTG-CDE   TO PV-W1-PRCHG-CTG-CDE.           08460007
                                                                        08470007
           IF PV-W1-DATE-KEY EQUAL PV-S1-DATE-KEY                       08480007
               IF PV-W1-WORK-RECORD EQUAL PV-S1-SAVE-RECORD             08490007
                   PERFORM 3000-APPLY-DBV-DOLLARS                       08500007
               ELSE                                                     08510007
                   PERFORM 3100-PRORATION-BREAK                         08520007
                   PERFORM 3000-APPLY-DBV-DOLLARS                       08530007
               END-IF                                                   08540007
           ELSE                                                         08550007
               PERFORM 3100-PRORATION-BREAK                             08560007
               PERFORM 3000-APPLY-DBV-DOLLARS                           08570007
           END-IF.                                                      08580007
                                                                        08590007
           PERFORM 7300-READ-UNKNOWN-DTL-IN.                            08600010
                                                                        08610007
      /**************************************************************** 08620007
      * 3000-APPLY-DBV-DOLLARS.                                         08630007
      ***************************************************************** 08640007
       3000-APPLY-DBV-DOLLARS.                                          08650007
                                                                        08660007
           PERFORM 4200-BUILD-REPORT-BEFORE                             08670007
                                                                        08680007
           MOVE 'N'            TO PS-DPT-TBL-FOUND-SW.                  08690007
           PERFORM 6400-GET-DPT-TOT                                     08700007
               VARYING DPTI FROM 1 BY 1                                 08710007
               UNTIL DPTI GREATER PV-DPT-COUNT                          08720007
                  OR DPTI GREATER PC-MAX-DPT-ROWS                       08730007
                  OR PS-DPT-TBL-FOUND.                                  08740007
                                                                        08750007
           PERFORM 4000-PRORATE-VEND-DOLLARS                            08760007
               VARYING DBVI FROM 1 BY 1                                 08770007
               UNTIL DBVI GREATER PV-DBV-COUNT                          08780007
                  OR DBVI GREATER PC-MAX-DBV-ROWS.                      08790007
                                                                        08800007
           ADD UDTLI-MKDN-RTL-AMT   TO PV-PRORATE-MKDN-AMOUNT.          08810007
           ADD UDTLI-MKUP-RTL-AMT   TO PV-PRORATE-MKUP-AMOUNT.          08820007
                                                                        08830007
      ***************************************************************** 08840007
      * 3100-PRORATION-BREAK.                                           08850007
      ***************************************************************** 08860007
       3100-PRORATION-BREAK.                                            08870007
                                                                        08880007
           PERFORM 5000-APPLY-ANY-REMAINDERS.                           08960007
                                                                        08970007
           PERFORM 6100-DBV-SUMMARY-RECORD.                             08980007
                                                                        08990007
           MOVE UDTLI-UPDATE-REC  TO PSAVE-UPDATE-REC.                  09000007
           MOVE PSAVE-FSCL-MN-NBR     TO PV-S1-FSCL-MN-NBR.             09010007
           MOVE PSAVE-FSCL-MN-END-DTE TO PV-S1-FSCL-MN-END-DTE.         09020007
           MOVE PSAVE-FSCL-WK-NBR     TO PV-S1-FSCL-WK-NBR.             09030007
           MOVE PSAVE-FSCL-WK-END-DTE TO PV-S1-FSCL-WK-END-DTE.         09040007
           MOVE PSAVE-DEPT-NBR    TO PV-S1-DEPT-NBR.                    09050007
           MOVE PSAVE-MAJ-CL-NBR  TO PV-S1-MAJ-CL-NBR.                  09060007
           MOVE PSAVE-SUB-CL-NBR  TO PV-S1-SUB-CL-NBR.                  09070007
           MOVE PSAVE-LOC-NBR     TO PV-S1-LOC-NBR.                     09080007
           MOVE PSAVE-ENT-ID      TO PV-S1-ENT-ID.                      09090007
           MOVE PSAVE-LBL-SEQ-NBR TO PV-S1-LBL-SEQ-NBR.                 09100007
           MOVE PSAVE-ML-LWST-ID  TO PV-S1-ML-LWST-ID.                  09110007
           MOVE PSAVE-SKU-NBR         TO PV-S1-SKU-NBR.                 09120007
           MOVE PSAVE-FIN-LIAB-DTE    TO PV-S1-FIN-LIAB-DTE.            09130007
           MOVE PSAVE-TRN-TYP-CDE     TO PV-S1-TRN-TYP-CDE.             09140007
W37965     MOVE PSAVE-AP-TRANS-CDE    TO PV-S1-AP-TRANS-CDE.            09140007
W37965     MOVE PSAVE-PRCHG-RSN-CDE   TO PV-S1-PRCHG-RSN-CDE.           09140007
W37965     MOVE PSAVE-PRCHG-CTG-CDE   TO PV-S1-PRCHG-CTG-CDE.           09140007
                                                                        09150007
      ***************************************************************** 09160007
      * 4000-PRORATE-VEND-DOLLARS.                                      09170007
      ***************************************************************** 09180007
       4000-PRORATE-VEND-DOLLARS.                                       09190007
                                                                        09200007
           IF P-DBV-DEPT-NBR (DBVI) EQUAL ZEROS    AND                  09210007
              P-DBV-ENT-ID (DBVI) EQUAL ZEROS AND                       09220007
              P-DBV-LBL-SEQ-NBR (DBVI) EQUAL ZEROS AND                  09230007
              P-DBV-ML-LWST-ID (DBVI) EQUAL ZEROS                       09240007
               MOVE 9999999    TO DBVI                                  09250007
           ELSE                                                         09260007
           IF CC-MODE-KNOWN-UNKNOWN                  AND                09270007
              P-DBV-DEPT-NBR (DBVI) = UDTLI-DEPT-NBR AND                09280007
              P-DBV-ENT-ID (DBVI) = UDTLI-ENT-ID                        09290007
               PERFORM 4100-PRORATION                                   09300007
           ELSE                                                         09310007
           IF CC-MODE-UNKNOWN-UNKNOWN   AND                             09320007
              P-DBV-DEPT-NBR (DBVI) = UDTLI-DEPT-NBR                    09330007
               PERFORM 4100-PRORATION                                   09340007
           ELSE                                                         09350007
               INITIALIZE MLDBV-UPDATE-REC                              09360007
           END-IF.                                                      09370007
                                                                        09380007
      ***************************************************************** 09390007
      * 4100-PRORATION.                                                 09400007
      ***************************************************************** 09410007
       4100-PRORATION.                                                  09420007
                                                                        09430007
           MOVE 'N'               TO PS-WRITE-ADJUST-SW.                09440007
                                                                        09450007
           INITIALIZE MLDBV-UPDATE-REC                                  09460007
                                                                        09470007
           MOVE P-DBV-DEPT-NBR (DBVI)    TO MLDBV-DEPT-NBR              09480007
           MOVE P-DBV-ENT-ID (DBVI)      TO MLDBV-ENT-ID                09490007
           MOVE P-DBV-LBL-SEQ-NBR (DBVI) TO MLDBV-LBL-SEQ-NBR           09500007
           MOVE P-DBV-ML-LWST-ID (DBVI)  TO MLDBV-ML-LWST-ID            09510007
           MOVE P-DBV-SLS-REG-RTL-AMT (DBVI)                            09520007
                               TO MLDBV-SLS-REG-RTL-AMT                 09530007
           MOVE P-DBV-SLS-PROMO-RTL-AMT (DBVI)                          09540007
                               TO MLDBV-SLS-PROMO-RTL-AMT               09550007
           MOVE P-DBV-SLS-PROCLR-RTL-AMT (DBVI)                         09560007
                               TO MLDBV-SLS-PROCLR-RTL-AMT              09570007
           MOVE P-DBV-SLS-CLR-RTL-AMT (DBVI)                            09580007
                               TO MLDBV-SLS-CLR-RTL-AMT                 09590007
           MOVE P-DBV-SLS-OTH-RTL-AMT (DBVI)                            09600007
                               TO MLDBV-SLS-OTH-RTL-AMT                 09610007
           MOVE P-DBV-MKDN-PLU-RTL-AMT (DBVI)                           09620007
                               TO MLDBV-MKDN-PLU-RTL-AMT                09630007
           MOVE P-DBV-MKDN-PROMO-RTL-AMT (DBVI)                         09640007
                               TO MLDBV-MKDN-PROMO-RTL-AMT              09650007
           MOVE P-DBV-MKDN-RGST-RTL-AMT (DBVI)                          09660007
                               TO MLDBV-MKDN-RGST-RTL-AMT               09670007
           MOVE P-DBV-MKDN-GLDST-RTL-AMT (DBVI)                         09680007
                               TO MLDBV-MKDN-GLDST-RTL-AMT              09690007
           MOVE P-DBV-MKDN-UMTCH-RTL-AMT (DBVI)                         09700007
                               TO MLDBV-MKDN-UMTCH-RTL-AMT              09710007
           MOVE P-DBV-MKDN-BYR-RTL-AMT (DBVI)                           09720007
                               TO MLDBV-MKDN-BYR-RTL-AMT                09730007
           MOVE P-DBV-MKDN-STR-RTL-AMT (DBVI)                           09740007
                               TO MLDBV-MKDN-STR-RTL-AMT                09750007
           MOVE P-DBV-MKDN-PRPT-RTL-AMT (DBVI)                          09760007
                               TO MLDBV-MKDN-PRPT-RTL-AMT               09770007
           MOVE P-DBV-MKDN-OTH-RTL-AMT (DBVI)                           09780007
                               TO MLDBV-MKDN-OTH-RTL-AMT                09790007
           MOVE P-DBV-MKDN-RTL-AMT (DBVI)                               09800007
                               TO MLDBV-MKDN-RTL-AMT                    09810007
           MOVE P-DBV-MKUP-RTL-AMT (DBVI)                               09820007
                          TO MLDBV-MKUP-RTL-AMT                         09830007
           MOVE P-DBV-XFER-IN-RTL-AMT (DBVI)                            09840007
                          TO MLDBV-XFER-IN-RTL-AMT                      09850007
           MOVE P-DBV-XFER-OUT-RTL-AMT (DBVI)                           09860007
                          TO MLDBV-XFER-OUT-RTL-AMT                     09870007
           MOVE P-DBV-RCPT-RTL-AMT (DBVI)                               09880007
                          TO MLDBV-RCPT-RTL-AMT                         09890007
           MOVE P-DBV-RCPT-NET-COST-AMT (DBVI)                          09900007
                          TO MLDBV-RCPT-NET-COST-AMT                    09910007
           MOVE P-DBV-RCPT-GRO-COST-AMT (DBVI)                          09920007
                          TO MLDBV-RCPT-GRO-COST-AMT                    09930007
           MOVE P-DBV-RCPT-FRGT-COST-AMT (DBVI)                         09940007
                          TO MLDBV-RCPT-FRGT-COST-AMT                   09950007
           MOVE P-DBV-PADJ-RTL-AMT (DBVI)                               09960007
                          TO MLDBV-PADJ-RTL-AMT                         09970007
           MOVE P-DBV-PADJ-FRGT-COST-AMT (DBVI)                         09980007
                          TO MLDBV-PADJ-FRGT-COST-AMT                   09990007
           MOVE P-DBV-PADJ-DISC-COST-AMT (DBVI)                         10000007
                          TO MLDBV-PADJ-DISC-COST-AMT                   10010007
           MOVE P-DBV-PADJ-RTV-COST-AMT (DBVI)                          10020007
                               TO MLDBV-PADJ-RTV-COST-AMT               10030007
           MOVE P-DBV-PADJ-RTV-RTL-AMT (DBVI)                           10040007
                               TO MLDBV-PADJ-RTV-RTL-AMT                10050007
           MOVE P-DBV-PADJ-DA-COST-AMT (DBVI)                           10060007
                               TO MLDBV-PADJ-DA-COST-AMT                10070007
           MOVE P-DBV-PADJ-DA-RTL-AMT (DBVI)                            10080007
                               TO MLDBV-PADJ-DA-RTL-AMT                 10090007
           MOVE P-DBV-PADJ-NET-COST-AMT (DBVI)                          10100007
                               TO MLDBV-PADJ-NET-COST-AMT               10110007
           MOVE P-DBV-PADJ-OTH-COST-AMT (DBVI)                          10120007
                               TO MLDBV-PADJ-OTH-COST-AMT               10130007
           MOVE P-DBV-PADJ-OTH-RTL-AMT (DBVI)                           10140007
                               TO MLDBV-PADJ-OTH-RTL-AMT                10150007
           MOVE P-DBV-PADJ-GRO-COST-AMT (DBVI)                          10160007
                               TO MLDBV-PADJ-GRO-COST-AMT               10170007
           MOVE P-DBV-DR-ALW-RTL-AMT (DBVI)                             10180007
                               TO MLDBV-DR-ALW-RTL-AMT                  10190007
           MOVE P-DBV-RTV-RTL-AMT (DBVI)                                10200007
                               TO MLDBV-RTV-RTL-AMT                     10210007
           MOVE P-DBV-MKUP-INIT-AMT (DBVI)                              10220007
                               TO MLDBV-MKUP-INIT-AMT                   10230007
           MOVE P-DBV-MKUP-NET-AMT (DBVI)                               10240007
                               TO MLDBV-MKUP-NET-AMT                    10250007
           MOVE P-DBV-INV-ADJ-RTL-AMT (DBVI)                            10260007
                               TO MLDBV-INV-ADJ-RTL-AMT                 10270007
           MOVE P-DBV-ONORD-RTL-AMT (DBVI)                              10280007
                               TO MLDBV-ONORD-RTL-AMT                   10290007
           MOVE P-DBV-ONORD-COST-AMT (DBVI)                             10300007
                               TO MLDBV-ONORD-COST-AMT                  10310007
           MOVE P-DBV-SHNK-RTL-AMT (DBVI)                               10320007
                               TO MLDBV-SHNK-RTL-AMT                    10330007
           MOVE P-DBV-END-INV-RTL-AMT (DBVI)                            10340007
                               TO MLDBV-END-INV-RTL-AMT                 10350007
           MOVE P-DBV-END-INV-COST-AMT (DBVI)                           10360007
                               TO MLDBV-END-INV-COST-AMT                10370007
           MOVE P-DBV-GRO-MRGN-AMT (DBVI)                               10380007
                               TO MLDBV-GRO-MRGN-AMT                    10390007
           MOVE P-DBV-IN-TRNST-RTL-AMT (DBVI)                           10400007
                               TO MLDBV-IN-TRNST-RTL-AMT                10410007
           MOVE P-DBV-RCPT-DISC-COST-AMT (DBVI)                         10420007
                               TO MLDBV-RCPT-DISC-COST-AMT              10430007
           MOVE P-DBV-STR-EXPTED-RTL-AMT (DBVI)                         10440007
                               TO MLDBV-STR-EXPTED-RTL-AMT              10450007
                                                                        10460007
           MOVE UDTLI-UPDATE-REC         TO OUTPT-UPDATE-REC            10470007
                                                                        10480007
           MOVE P-DBV-ENT-ID (DBVI)      TO OUTPT-ENT-ID                10490007
           MOVE P-DBV-LBL-SEQ-NBR (DBVI) TO OUTPT-LBL-SEQ-NBR           10500007
           MOVE P-DBV-ML-LWST-ID (DBVI)  TO OUTPT-ML-LWST-ID            10510007
                                                                                
RONNA** ADD UP ALL THE SALES TO GET A TOTAL SALES                       10530007
RONNA** FOR ALL OF THE SALES BUCKETS TO USE FOR SALES TRANSACTIONS      10530007
RONNA      COMPUTE PV-ALL-SLS-MLDBV = MLDBV-SLS-REG-RTL-AMT                     
RONNA                               + MLDBV-SLS-PROMO-RTL-AMT                   
RONNA                               + MLDBV-SLS-PROCLR-RTL-AMT                  
RONNA                               + MLDBV-SLS-CLR-RTL-AMT                     
RONNA                               + MLDBV-SLS-OTH-RTL-AMT                     
RONNA                                                                           
RONNA      COMPUTE PV-ALL-SLS-MLDPT = MLDPT-SLS-REG-RTL-AMT                     
RONNA                               + MLDPT-SLS-PROMO-RTL-AMT                   
RONNA                               + MLDPT-SLS-PROCLR-RTL-AMT                  
RONNA                               + MLDPT-SLS-CLR-RTL-AMT                     
RONNA                               + MLDPT-SLS-OTH-RTL-AMT                     
                                                                        10520007
    *** PRORATE ML254-SLS-REG-RTL-AMT...                                10530007
           IF UDTLI-SLS-REG-RTL-AMT EQUAL ZEROS OR                      10540007
              MLDPT-SLS-REG-RTL-AMT EQUAL ZEROS                         10550007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   10560007
           ELSE                                                         10570007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         10580007
RONNA                             = PV-ALL-SLS-MLDBV                    10590007
RONNA                             / PV-ALL-SLS-MLDPT                    10600007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 10610007
           END-IF                                                       10620007
                                                                        10630007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               10640007
                                  = PV-ENTID-PERCENT                    10650007
                                  * UDTLI-SLS-REG-RTL-AMT               10660007
           MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-REG-RTL-AMT              10670007
           ADD PV-WORK-AMOUNT     TO MLSVE-SLS-REG-RTL-AMT              10680007
                                                                        10690007
    *** PRORATE ML254-PROMO-REG-RTL-AMT...                              10700007
           IF UDTLI-SLS-PROMO-RTL-AMT EQUAL ZEROS OR                    10710007
              MLDPT-SLS-PROMO-RTL-AMT EQUAL ZEROS                       10720007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   10730007
           ELSE                                                         10740007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         10750007
RONNA                             = PV-ALL-SLS-MLDBV                    10590007
RONNA                             / PV-ALL-SLS-MLDPT                    10600007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 10780007
           END-IF                                                       10790007
                                                                        10800007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               10810007
                                  = PV-ENTID-PERCENT                    10820007
                                  * UDTLI-SLS-PROMO-RTL-AMT             10830007
           MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-PROMO-RTL-AMT            10840007
           ADD PV-WORK-AMOUNT     TO MLSVE-SLS-PROMO-RTL-AMT            10850007
                                                                        10860007
    *** PRORATE ML254-SLS-PROCLR-RTL-AMT...                             10870007
           IF UDTLI-SLS-PROCLR-RTL-AMT EQUAL ZEROS OR                   10880007
              MLDPT-SLS-PROCLR-RTL-AMT EQUAL ZEROS                      10890007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   10900007
           ELSE                                                         10910007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         10920007
RONNA                             = PV-ALL-SLS-MLDBV                    10590007
RONNA                             / PV-ALL-SLS-MLDPT                    10600007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 10950007
           END-IF                                                       10960007
                                                                        10970007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               10980007
                                  = PV-ENTID-PERCENT                    10990007
                                  * UDTLI-SLS-PROCLR-RTL-AMT            11000007
           MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-PROCLR-RTL-AMT           11010007
           ADD PV-WORK-AMOUNT     TO MLSVE-SLS-PROCLR-RTL-AMT           11020007
                                                                        11030007
    *** PRORATE ML254-SLS-CLR-RTL-AMT...                                11040007
           IF UDTLI-SLS-CLR-RTL-AMT EQUAL ZEROS OR                      11050007
            MLDPT-SLS-CLR-RTL-AMT EQUAL ZEROS                           11060007
             MOVE ZEROS         TO PV-ENTID-PERCENT                     11070007
           ELSE                                                         11080007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         11090007
RONNA                             = PV-ALL-SLS-MLDBV                    10590007
RONNA                             / PV-ALL-SLS-MLDPT                    10600007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 11120007
           END-IF                                                       11130007
                                                                        11140007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               11150007
                                  = PV-ENTID-PERCENT                    11160007
                                  * UDTLI-SLS-CLR-RTL-AMT               11170007
           MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-CLR-RTL-AMT              11180007
           ADD PV-WORK-AMOUNT     TO MLSVE-SLS-CLR-RTL-AMT              11190007
                                                                        11200007
    *** PRORATE ML254-SLS-OTH-RTL-AMT...                                11210007
           IF UDTLI-SLS-OTH-RTL-AMT EQUAL ZEROS OR                      11220007
              MLDPT-SLS-OTH-RTL-AMT EQUAL ZEROS                         11230007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   11240007
           ELSE                                                         11250007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         11260007
RONNA                             = PV-ALL-SLS-MLDBV                    10590007
RONNA                             / PV-ALL-SLS-MLDPT                    10600007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 11290007
           END-IF                                                       11300007
                                                                        11310007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               11320007
                                  = PV-ENTID-PERCENT                    11330007
                                  * UDTLI-SLS-OTH-RTL-AMT               11340007
           MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-OTH-RTL-AMT              11350007
           ADD PV-WORK-AMOUNT     TO MLSVE-SLS-OTH-RTL-AMT              11360007
                                                                        11370007
    ***  PRORATE ML254-MKDN-PLU-RTL-AMT                                 11380007
           IF UDTLI-MKDN-PLU-RTL-AMT EQUAL ZEROS OR                     11390007
              MLDPT-MKDN-PLU-RTL-AMT EQUAL ZEROS                        11400007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   11410007
           ELSE                                                         11420007
               COMPUTE PV-ENTID-PERCENT ROUNDED                                 
                                  = MLDBV-MKDN-PLU-RTL-AMT                      
RONNA2                            / MLDPT-MKDN-PLU-RTL-AMT                      
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                         
           END-IF                                                       11470007
                                                                        11480007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               11490007
                                  = PV-ENTID-PERCENT                    11500007
                                  * UDTLI-MKDN-PLU-RTL-AMT              11510007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-PLU-RTL-AMT             11520007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-PLU-RTL-AMT             11530007
                                                                        11540007
    ***  PRORATE ML254-MKDN-PROMO-RTL-AMT                               11550007
           IF UDTLI-MKDN-PROMO-RTL-AMT EQUAL ZEROS OR                   11560007
              MLDPT-MKDN-PROMO-RTL-AMT EQUAL ZEROS                      11570007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   11580007
           ELSE                                                         11590007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         11600007
                                  = MLDBV-MKDN-PROMO-RTL-AMT            11610007
                                  / MLDPT-MKDN-PROMO-RTL-AMT            11620007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 11630007
           END-IF                                                       11640007
                                                                        11650007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               11660007
                                  = PV-ENTID-PERCENT                    11670007
                                  * UDTLI-MKDN-PROMO-RTL-AMT            11680007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-PROMO-RTL-AMT           11690007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-PROMO-RTL-AMT           11700007
                                                                        11710007
    ***  PRORATE ML254-MKDN-RGST-RTL-AMT                                11720007
           IF UDTLI-MKDN-RGST-RTL-AMT EQUAL ZEROS OR                    11730007
              MLDPT-MKDN-RGST-RTL-AMT EQUAL ZEROS                       11740007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   11750007
           ELSE                                                         11760007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         11770007
                                  = MLDBV-MKDN-RGST-RTL-AMT             11780007
                                  / MLDPT-MKDN-RGST-RTL-AMT             11790007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 11800007
           END-IF                                                       11810007
                                                                        11820007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               11830007
                                  = PV-ENTID-PERCENT                    11840007
                                  * UDTLI-MKDN-RGST-RTL-AMT             11850007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-RGST-RTL-AMT            11860007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-RGST-RTL-AMT            11870007
                                                                        11880007
    ***  PRORATE ML254-MKDN-GLDST-RTL-AMT                               11890007
           IF UDTLI-MKDN-GLDST-RTL-AMT EQUAL ZEROS OR                   11900007
              MLDPT-MKDN-GLDST-RTL-AMT EQUAL ZEROS                      11910007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   11920007
           ELSE                                                         11930007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         11940007
                                  = MLDBV-MKDN-GLDST-RTL-AMT            11950007
                                  / MLDPT-MKDN-GLDST-RTL-AMT            11960007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 11970007
           END-IF                                                       11980007
                                                                        11990007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               12000007
                                  = PV-ENTID-PERCENT                    12010007
                                  * UDTLI-MKDN-GLDST-RTL-AMT            12020007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-GLDST-RTL-AMT           12030007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-GLDST-RTL-AMT           12040007
                                                                        12050007
    ***  PRORATE ML254-MKDN-UMTCH-RTL-AMT                               12060007
           IF UDTLI-MKDN-UMTCH-RTL-AMT EQUAL ZEROS OR                   12070007
              MLDPT-MKDN-UMTCH-RTL-AMT EQUAL ZEROS                      12080007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   12090007
           ELSE                                                         12100007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         12110007
                                  = MLDBV-MKDN-UMTCH-RTL-AMT            12120007
                                  / MLDPT-MKDN-UMTCH-RTL-AMT            12130007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 12140007
           END-IF                                                       12150007
                                                                        12160007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               12170007
                                  = PV-ENTID-PERCENT                    12180007
                                  * UDTLI-MKDN-UMTCH-RTL-AMT            12190007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-UMTCH-RTL-AMT           12200007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-UMTCH-RTL-AMT           12210007
                                                                        12220007
    ***  PRORATE ML254-MKDN-BYR-RTL-AMT                                 12230007
           IF UDTLI-MKDN-BYR-RTL-AMT EQUAL ZEROS OR                     12240007
              MLDPT-MKDN-BYR-RTL-AMT EQUAL ZEROS                        12250007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   12260007
           ELSE                                                         12270007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         12280007
                                  = MLDBV-MKDN-BYR-RTL-AMT              12290007
                                  / MLDPT-MKDN-BYR-RTL-AMT              12300007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 12310007
           END-IF                                                       12320007
                                                                        12330007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               12340007
                                  = PV-ENTID-PERCENT                    12350007
                                  * UDTLI-MKDN-BYR-RTL-AMT              12360007
           MOVE PV-WORK-AMOUNT     TO OUTPT-MKDN-BYR-RTL-AMT            12370007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-BYR-RTL-AMT             12380007
                                                                        12390007
    ***  PRORATE ML254-MKDN-STR-RTL-AMT                                 12400007
           IF UDTLI-MKDN-STR-RTL-AMT EQUAL ZEROS OR                     12410007
              MLDPT-MKDN-STR-RTL-AMT EQUAL ZEROS                        12420007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   12430007
           ELSE                                                         12440007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         12450007
                                  = MLDBV-MKDN-STR-RTL-AMT              12460007
                                  / MLDPT-MKDN-STR-RTL-AMT              12470007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 12480007
           END-IF                                                       12490007
                                                                        12500007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               12510007
                                  = PV-ENTID-PERCENT                    12520007
                                  * UDTLI-MKDN-STR-RTL-AMT              12530007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-STR-RTL-AMT             12540007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-STR-RTL-AMT             12550007
                                                                        12560007
    ***  PRORATE ML254-MKDN-PRPT-RTL-AMT                                12570007
           IF UDTLI-MKDN-PRPT-RTL-AMT EQUAL ZEROS OR                    12580007
              MLDPT-MKDN-PRPT-RTL-AMT EQUAL ZEROS                       12590007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   12600007
           ELSE                                                         12610007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         12620007
                                  = MLDBV-MKDN-PRPT-RTL-AMT             12630007
                                  / MLDPT-MKDN-PRPT-RTL-AMT             12640007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 12650007
           END-IF                                                       12660007
                                                                        12670007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               12680007
                                  = PV-ENTID-PERCENT                    12690007
                                  * UDTLI-MKDN-PRPT-RTL-AMT             12700007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-PRPT-RTL-AMT            12710007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-PRPT-RTL-AMT            12720007
                                                                        12730007
    ***  PRORATE ML254-MKDN-OTH-RTL-AMT                                 12740007
           IF UDTLI-MKDN-OTH-RTL-AMT EQUAL ZEROS OR                     12750007
              MLDPT-MKDN-OTH-RTL-AMT EQUAL ZEROS                        12760007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   12770007
           ELSE                                                         12780007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         12790007
                                  = MLDBV-MKDN-OTH-RTL-AMT              12800007
                                  / MLDPT-MKDN-OTH-RTL-AMT              12810007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 12820007
           END-IF                                                       12830007
                                                                        12840007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               12850007
                                  = PV-ENTID-PERCENT                    12860007
                                  * UDTLI-MKDN-OTH-RTL-AMT              12870007
           MOVE PV-WORK-AMOUNT     TO OUTPT-MKDN-OTH-RTL-AMT            12880007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-OTH-RTL-AMT             12890007
                                                                        12900007
    ***  PRORATE ML254-MKDN-RTL-AMT                                     12910007
           IF UDTLI-MKDN-RTL-AMT EQUAL ZEROS OR                         12920007
              MLDPT-MKDN-RTL-AMT EQUAL ZEROS                            12930007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   12940007
           ELSE                                                         12950007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         12960007
                                  = MLDBV-MKDN-RTL-AMT                  12970007
                                  / MLDPT-MKDN-RTL-AMT                  12980007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 12990007
           END-IF                                                       13000007
                                                                        13010007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               13020007
                                  = PV-ENTID-PERCENT                    13030007
                                  * UDTLI-MKDN-RTL-AMT                  13040007
           MOVE PV-WORK-AMOUNT     TO OUTPT-MKDN-RTL-AMT                13050007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKDN-RTL-AMT                 13060007
                                                                        13070007
    ***  PRORATE ML254-MKUP-RTL-AMT                                     13080007
           IF UDTLI-MKUP-RTL-AMT EQUAL ZEROS OR                         13090007
              MLDPT-MKUP-RTL-AMT EQUAL ZEROS                            13100007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   13110007
           ELSE                                                         13120007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         13130007
                                  = MLDBV-MKUP-RTL-AMT                  13140007
                                  / MLDPT-MKUP-RTL-AMT                  13150007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 13160007
           END-IF                                                       13170007
                                                                        13180007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               13190007
                                  = PV-ENTID-PERCENT                    13200007
                                  * UDTLI-MKUP-RTL-AMT                  13210007
           MOVE PV-WORK-AMOUNT     TO OUTPT-MKUP-RTL-AMT                13220007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKUP-RTL-AMT                 13230007
                                                                        13240007
    *** PRORATE ML254-XFER-IN-RTL-AMT...                                13250007
           IF UDTLI-XFER-IN-RTL-AMT EQUAL ZEROS OR                      13260007
              MLDPT-XFER-IN-RTL-AMT EQUAL ZEROS                         13270007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   13280007
           ELSE                                                         13290007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         13300007
                                  = MLDBV-XFER-IN-RTL-AMT               13310007
                                  / MLDPT-XFER-IN-RTL-AMT               13320007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 13330007
           END-IF                                                       13340007
                                                                        13350007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               13360007
                                  = PV-ENTID-PERCENT                    13370007
                                  * UDTLI-XFER-IN-RTL-AMT               13380007
           MOVE PV-WORK-AMOUNT     TO OUTPT-XFER-IN-RTL-AMT             13390007
           ADD PV-WORK-AMOUNT     TO MLSVE-XFER-IN-RTL-AMT              13400007
                                                                        13410007
    *** PRORATE ML254-XFER-OUT-RTL-AMT...                               13420007
           IF UDTLI-XFER-OUT-RTL-AMT EQUAL ZEROS OR                     13430007
              MLDPT-XFER-OUT-RTL-AMT EQUAL ZEROS                        13440007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   13450007
           ELSE                                                         13460007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         13470007
                                  = MLDBV-XFER-OUT-RTL-AMT              13480007
                                  / MLDPT-XFER-OUT-RTL-AMT              13490007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 13500007
           END-IF                                                       13510007
                                                                        13520007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               13530007
                                  = PV-ENTID-PERCENT                    13540007
                                  * UDTLI-XFER-OUT-RTL-AMT              13550007
           MOVE PV-WORK-AMOUNT     TO OUTPT-XFER-OUT-RTL-AMT            13560007
           ADD PV-WORK-AMOUNT     TO MLSVE-XFER-OUT-RTL-AMT             13570007
                                                                        13580007
    ***  PRORATE ML254-RCPT-RTL-AMT                                     13590007
           IF UDTLI-RCPT-RTL-AMT EQUAL ZEROS OR                         13600007
              MLDPT-RCPT-RTL-AMT EQUAL ZEROS                            13610007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   13620007
           ELSE                                                         13630007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         13640007
                                  = MLDBV-RCPT-RTL-AMT                  13650007
                                  / MLDPT-RCPT-RTL-AMT                  13660007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 13670007
           END-IF                                                       13680007
                                                                        13690007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               13700007
                                  = PV-ENTID-PERCENT                    13710007
                                  * UDTLI-RCPT-RTL-AMT                  13720007
           MOVE PV-WORK-AMOUNT     TO OUTPT-RCPT-RTL-AMT                13730007
           ADD PV-WORK-AMOUNT     TO MLSVE-RCPT-RTL-AMT                 13740007
                                                                        13750007
    ***  PRORATE ML254-RCPT-NET-COST-AMT                                13760007
           IF UDTLI-RCPT-NET-COST-AMT EQUAL ZEROS OR                    13770007
              MLDPT-RCPT-NET-COST-AMT EQUAL ZEROS                       13780007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   13790007
           ELSE                                                         13800007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         13810007
                                  = MLDBV-RCPT-NET-COST-AMT             13820007
                                  / MLDPT-RCPT-NET-COST-AMT             13830007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 13840007
           END-IF                                                       13850007
                                                                        13860007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               13870007
                                  = PV-ENTID-PERCENT                    13880007
                                  * UDTLI-RCPT-NET-COST-AMT             13890007
           MOVE PV-WORK-AMOUNT     TO OUTPT-RCPT-NET-COST-AMT           13900007
           ADD PV-WORK-AMOUNT     TO MLSVE-RCPT-NET-COST-AMT            13910007
                                                                        13920007
    ***  PRORATE ML254-RCPT-GRO-COST-AMT                                13930007
           IF UDTLI-RCPT-GRO-COST-AMT EQUAL ZEROS OR                    13940007
              MLDPT-RCPT-GRO-COST-AMT EQUAL ZEROS                       13950007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   13960007
           ELSE                                                         13970007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         13980007
                                  = MLDBV-RCPT-GRO-COST-AMT             13990007
                                  / MLDPT-RCPT-GRO-COST-AMT             14000007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 14010007
           END-IF                                                       14020007
                                                                        14030007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               14040007
                                  = PV-ENTID-PERCENT                    14050007
                                  * UDTLI-RCPT-GRO-COST-AMT             14060007
           MOVE PV-WORK-AMOUNT     TO OUTPT-RCPT-GRO-COST-AMT           14070007
           ADD PV-WORK-AMOUNT     TO MLSVE-RCPT-GRO-COST-AMT            14080007
                                                                        14090007
    ***  PRORATE ML254-RCPT-FRGT-COST-AMT                               14100007
           IF UDTLI-RCPT-FRGT-COST-AMT EQUAL ZEROS OR                   14110007
              MLDPT-RCPT-FRGT-COST-AMT EQUAL ZEROS                      14120007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   14130007
           ELSE                                                         14140007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         14150007
                                  = MLDBV-RCPT-FRGT-COST-AMT            14160007
                                  / MLDPT-RCPT-FRGT-COST-AMT            14170007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 14180007
           END-IF                                                       14190007
                                                                        14200007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               14210007
                                  = PV-ENTID-PERCENT                    14220007
                                  * UDTLI-RCPT-FRGT-COST-AMT            14230007
           MOVE PV-WORK-AMOUNT     TO OUTPT-RCPT-FRGT-COST-AMT          14240007
           ADD PV-WORK-AMOUNT     TO MLSVE-RCPT-FRGT-COST-AMT           14250007
                                                                        14260007
    ***  PRORATE ML254-PADJ-RTL-AMT                                     14270007
           IF UDTLI-PADJ-RTL-AMT EQUAL ZEROS OR                         14280007
              MLDPT-PADJ-RTL-AMT EQUAL ZEROS                            14290007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   14300007
           ELSE                                                         14310007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         14320007
                                  = MLDBV-PADJ-RTL-AMT                  14330007
                                  / MLDPT-PADJ-RTL-AMT                  14340007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 14350007
           END-IF                                                       14360007
                                                                        14370007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               14380007
                                  = PV-ENTID-PERCENT                    14390007
                                  * UDTLI-PADJ-RTL-AMT                  14400007
           MOVE PV-WORK-AMOUNT     TO OUTPT-PADJ-RTL-AMT                14410007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-RTL-AMT                 14420007
                                                                        14430007
    ***  PRORATE ML254-PADJ-FRGT-COST-AMT                               14440007
           IF UDTLI-PADJ-FRGT-COST-AMT EQUAL ZEROS OR                   14450007
              MLDPT-PADJ-FRGT-COST-AMT EQUAL ZEROS                      14460007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   14470007
           ELSE                                                         14480007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         14490007
                                  = MLDBV-PADJ-FRGT-COST-AMT            14500007
                                  / MLDPT-PADJ-FRGT-COST-AMT            14510007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 14520007
           END-IF                                                       14530007
                                                                        14540007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               14550007
                                  = PV-ENTID-PERCENT                    14560007
                                  * UDTLI-PADJ-FRGT-COST-AMT            14570007
           MOVE PV-WORK-AMOUNT     TO OUTPT-PADJ-FRGT-COST-AMT          14580007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-FRGT-COST-AMT           14590007
                                                                        14600007
    ***  PRORATE ML254-PADJ-DISC-COST-AMT                               14610007
           IF UDTLI-PADJ-DISC-COST-AMT EQUAL ZEROS OR                   14620007
              MLDPT-PADJ-DISC-COST-AMT EQUAL ZEROS                      14630007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   14640007
           ELSE                                                         14650007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         14660007
                                  = MLDBV-PADJ-DISC-COST-AMT            14670007
                                  / MLDPT-PADJ-DISC-COST-AMT            14680007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 14690007
           END-IF                                                       14700007
                                                                        14710007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               14720007
                                  = PV-ENTID-PERCENT                    14730007
                                  * UDTLI-PADJ-DISC-COST-AMT            14740007
           MOVE PV-WORK-AMOUNT     TO OUTPT-PADJ-DISC-COST-AMT          14750007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-DISC-COST-AMT           14760007
                                                                        14770007
    ***  PRORATE ML254-PADJ-RTV-COST-AMT                                14780007
           IF UDTLI-PADJ-RTV-COST-AMT EQUAL ZEROS OR                    14790007
              MLDPT-PADJ-RTV-COST-AMT EQUAL ZEROS                       14800007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   14810007
           ELSE                                                         14820007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         14830007
                                  = MLDBV-PADJ-RTV-COST-AMT             14840007
                                  / MLDPT-PADJ-RTV-COST-AMT             14850007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 14860007
           END-IF                                                       14870007
                                                                        14880007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               14890007
                                  = PV-ENTID-PERCENT                    14900007
                                  * UDTLI-PADJ-RTV-COST-AMT             14910007
           MOVE PV-WORK-AMOUNT     TO OUTPT-PADJ-RTV-COST-AMT           14920007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-RTV-COST-AMT            14930007
                                                                        14940007
    ***  PRORATE ML254-PADJ-RTV-RTL-AMT                                 14950007
           IF UDTLI-PADJ-RTV-RTL-AMT EQUAL ZEROS OR                     14960007
              MLDPT-PADJ-RTV-RTL-AMT EQUAL ZEROS                        14970007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   14980007
           ELSE                                                         14990007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         15000007
                                  = MLDBV-PADJ-RTV-RTL-AMT              15010007
                                  / MLDPT-PADJ-RTV-RTL-AMT              15020007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 15030007
           END-IF                                                       15040007
                                                                        15050007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               15060007
                                  = PV-ENTID-PERCENT                    15070007
                                  * UDTLI-PADJ-RTV-RTL-AMT              15080007
           MOVE PV-WORK-AMOUNT     TO OUTPT-PADJ-RTV-RTL-AMT            15090007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-RTV-RTL-AMT             15100007
                                                                        15110007
    ***  PRORATE ML254-PADJ-DA-COST-AMT                                 15120007
           IF UDTLI-PADJ-DA-COST-AMT EQUAL ZEROS OR                     15130007
              MLDPT-PADJ-DA-COST-AMT EQUAL ZEROS                        15140007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   15150007
           ELSE                                                         15160007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         15170007
                                  = MLDBV-PADJ-DA-COST-AMT              15180007
                                  / MLDPT-PADJ-DA-COST-AMT              15190007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 15200007
           END-IF                                                       15210007
                                                                        15220007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               15230007
                                  = PV-ENTID-PERCENT                    15240007
                                  * UDTLI-PADJ-DA-COST-AMT              15250007
           MOVE PV-WORK-AMOUNT     TO OUTPT-PADJ-DA-COST-AMT            15260007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-DA-COST-AMT             15270007
                                                                        15280007
    ***  PRORATE ML254-PADJ-DA-RTL-AMT                                  15290007
           IF UDTLI-PADJ-DA-RTL-AMT EQUAL ZEROS OR                      15300007
              MLDPT-PADJ-DA-RTL-AMT EQUAL ZEROS                         15310007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   15320007
           ELSE                                                         15330007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         15340007
                                  = MLDBV-PADJ-DA-RTL-AMT               15350007
                                  / MLDPT-PADJ-DA-RTL-AMT               15360007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 15370007
           END-IF                                                       15380007
                                                                        15390007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               15400007
                                  = PV-ENTID-PERCENT                    15410007
                                  * UDTLI-PADJ-DA-RTL-AMT               15420007
           MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-DA-RTL-AMT              15430007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-DA-RTL-AMT              15440007
                                                                        15450007
    ***  PRORATE ML254-PADJ-NET-COST-AMT                                15460007
           IF UDTLI-PADJ-NET-COST-AMT EQUAL ZEROS OR                    15470007
              MLDPT-PADJ-NET-COST-AMT EQUAL ZEROS                       15480007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   15490007
           ELSE                                                         15500007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         15510007
                                  = MLDBV-PADJ-NET-COST-AMT             15520007
                                  / MLDPT-PADJ-NET-COST-AMT             15530007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 15540007
           END-IF                                                       15550007
                                                                        15560007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               15570007
                                  = PV-ENTID-PERCENT                    15580007
                                  * UDTLI-PADJ-NET-COST-AMT             15590007
           MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-NET-COST-AMT            15600007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-NET-COST-AMT            15610007
                                                                        15620007
    ***  PRORATE ML254-PADJ-OTH-COST-AMT                                15630007
           IF UDTLI-PADJ-OTH-COST-AMT EQUAL ZEROS OR                    15640007
              MLDPT-PADJ-OTH-COST-AMT EQUAL ZEROS                       15650007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   15660007
           ELSE                                                         15670007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         15680007
                                  = MLDBV-PADJ-OTH-COST-AMT             15690007
                                  / MLDPT-PADJ-OTH-COST-AMT             15700007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 15710007
           END-IF                                                       15720007
                                                                        15730007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               15740007
                                  = PV-ENTID-PERCENT                    15750007
                                  * UDTLI-PADJ-OTH-COST-AMT             15760007
           MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-OTH-COST-AMT            15770007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-OTH-COST-AMT            15780007
                                                                        15790007
    ***  PRORATE ML254-PADJ-OTH-RTL-AMT                                 15800007
           IF UDTLI-PADJ-OTH-RTL-AMT EQUAL ZEROS OR                     15810007
              MLDPT-PADJ-OTH-RTL-AMT EQUAL ZEROS                        15820007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   15830007
           ELSE                                                         15840007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         15850007
                                  = MLDBV-PADJ-OTH-RTL-AMT              15860007
                                  / MLDPT-PADJ-OTH-RTL-AMT              15870007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 15880007
           END-IF                                                       15890007
                                                                        15900007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               15910007
                                  = PV-ENTID-PERCENT                    15920007
                                  * UDTLI-PADJ-OTH-RTL-AMT              15930007
           MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-OTH-RTL-AMT             15940007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-OTH-RTL-AMT             15950007
                                                                        15960007
    ***  PRORATE ML254-PADJ-GRO-COST-AMT                                15970007
           IF UDTLI-PADJ-GRO-COST-AMT EQUAL ZEROS OR                    15980007
              MLDPT-PADJ-GRO-COST-AMT EQUAL ZEROS                       15990007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   16000007
           ELSE                                                         16010007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         16020007
                                  = MLDBV-PADJ-GRO-COST-AMT             16030007
                                  / MLDPT-PADJ-GRO-COST-AMT             16040007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 16050007
           END-IF                                                       16060007
                                                                        16070007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               16080007
                                  = PV-ENTID-PERCENT                    16090007
                                  * UDTLI-PADJ-GRO-COST-AMT             16100007
           MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-GRO-COST-AMT            16110007
           ADD PV-WORK-AMOUNT     TO MLSVE-PADJ-GRO-COST-AMT            16120007
                                                                        16130007
    ***  PRORATE ML254-DR-ALW-RTL-AMT                                   16140007
           IF UDTLI-DR-ALW-RTL-AMT EQUAL ZEROS OR                       16150007
              MLDPT-DR-ALW-RTL-AMT EQUAL ZEROS                          16160007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   16170007
           ELSE                                                         16180007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         16190007
                                  = MLDBV-DR-ALW-RTL-AMT                16200007
                                  / MLDPT-DR-ALW-RTL-AMT                16210007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 16220007
           END-IF                                                       16230007
                                                                        16240007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               16250007
                                  = PV-ENTID-PERCENT                    16260007
                                  * UDTLI-DR-ALW-RTL-AMT                16270007
           MOVE PV-WORK-AMOUNT     TO OUTPT-DR-ALW-RTL-AMT              16280007
           ADD PV-WORK-AMOUNT     TO MLSVE-DR-ALW-RTL-AMT               16290007
                                                                        16300007
    ***  PRORATE ML254-RTV-RTL-AMT                                      16310007
           IF UDTLI-RTV-RTL-AMT EQUAL ZEROS OR                          16320007
              MLDPT-RTV-RTL-AMT EQUAL ZEROS                             16330007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   16340007
           ELSE                                                         16350007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         16360007
                                  = MLDBV-RTV-RTL-AMT                   16370007
                                  / MLDPT-RTV-RTL-AMT                   16380007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 16390007
           END-IF                                                       16400007
                                                                        16410007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               16420007
                                  = PV-ENTID-PERCENT                    16430007
                                  * UDTLI-RTV-RTL-AMT                   16440007
           MOVE PV-WORK-AMOUNT     TO OUTPT-RTV-RTL-AMT                 16450007
           ADD PV-WORK-AMOUNT     TO MLSVE-RTV-RTL-AMT                  16460007
                                                                        16470007
    ***  PRORATE ML254-MKUP-INIT-AMT                                    16480007
           IF UDTLI-MKUP-INIT-AMT EQUAL ZEROS OR                        16490007
              MLDPT-MKUP-INIT-AMT EQUAL ZEROS                           16500007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   16510007
           ELSE                                                         16520007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         16530007
                                  = MLDBV-MKUP-INIT-AMT                 16540007
                                  / MLDPT-MKUP-INIT-AMT                 16550007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 16560007
           END-IF                                                       16570007
                                                                        16580007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               16590007
                                  = PV-ENTID-PERCENT                    16600007
                                  * UDTLI-MKUP-INIT-AMT                 16610007
           MOVE PV-WORK-AMOUNT    TO OUTPT-MKUP-INIT-AMT                16620007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKUP-INIT-AMT                16630007
                                                                        16640007
    ***  PRORATE ML254-MKUP-NET-AMT                                     16650007
           IF UDTLI-MKUP-NET-AMT EQUAL ZEROS OR                         16660007
              MLDPT-MKUP-NET-AMT EQUAL ZEROS                            16670007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   16680007
           ELSE                                                         16690007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         16700007
                                  = MLDBV-MKUP-NET-AMT                  16710007
                                  / MLDPT-MKUP-NET-AMT                  16720007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 16730007
           END-IF                                                       16740007
                                                                        16750007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               16760007
                                  = PV-ENTID-PERCENT                    16770007
                                  * UDTLI-MKUP-NET-AMT                  16780007
           MOVE PV-WORK-AMOUNT     TO OUTPT-MKUP-NET-AMT                16790007
           ADD PV-WORK-AMOUNT     TO MLSVE-MKUP-NET-AMT                 16800007
                                                                        16810007
    ***  PRORATE ML254-INV-ADJ-RTL-AMT                                  16820007
           IF UDTLI-INV-ADJ-RTL-AMT EQUAL ZEROS OR                      16830007
              MLDPT-INV-ADJ-RTL-AMT EQUAL ZEROS                         16840007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   16850007
           ELSE                                                         16860007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         16870007
                                  = MLDBV-INV-ADJ-RTL-AMT               16880007
                                  / MLDPT-INV-ADJ-RTL-AMT               16890007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 16900007
           END-IF                                                       16910007
                                                                        16920007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               16930007
                                  = PV-ENTID-PERCENT                    16940007
                                  * UDTLI-INV-ADJ-RTL-AMT               16950007
           MOVE PV-WORK-AMOUNT     TO OUTPT-INV-ADJ-RTL-AMT             16960007
           ADD PV-WORK-AMOUNT     TO MLSVE-INV-ADJ-RTL-AMT              16970007
                                                                        16980007
    ***  PRORATE ML254-ONORD-RTL-AMT                                    16990007
           IF UDTLI-ONORD-RTL-AMT EQUAL ZEROS OR                        17000007
              MLDPT-ONORD-RTL-AMT EQUAL ZEROS                           17010007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   17020007
           ELSE                                                         17030007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         17040007
                                  = MLDBV-ONORD-RTL-AMT                 17050007
                                  / MLDPT-ONORD-RTL-AMT                 17060007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 17070007
           END-IF                                                       17080007
                                                                        17090007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               17100007
                                  = PV-ENTID-PERCENT                    17110007
                                  * UDTLI-ONORD-RTL-AMT                 17120007
           MOVE PV-WORK-AMOUNT     TO OUTPT-ONORD-RTL-AMT               17130007
           ADD PV-WORK-AMOUNT     TO MLSVE-ONORD-RTL-AMT                17140007
                                                                        17150007
    ***  PRORATE ML254-ONORD-COST-AMT                                   17160007
           IF UDTLI-ONORD-COST-AMT EQUAL ZEROS OR                       17170007
              MLDPT-ONORD-COST-AMT EQUAL ZEROS                          17180007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   17190007
           ELSE                                                         17200007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         17210007
                                  = MLDBV-ONORD-COST-AMT                17220007
                                  / MLDPT-ONORD-COST-AMT                17230007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 17240007
           END-IF                                                       17250007
                                                                        17260007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               17270007
                                  = PV-ENTID-PERCENT                    17280007
                                  * UDTLI-ONORD-COST-AMT                17290007
           MOVE PV-WORK-AMOUNT     TO OUTPT-ONORD-COST-AMT              17300007
           ADD PV-WORK-AMOUNT     TO MLSVE-ONORD-COST-AMT               17310007
                                                                        17320007
    ***  PRORATE ML254-SHNK-RTL-AMT                                     17330007
           IF UDTLI-SHNK-RTL-AMT EQUAL ZEROS OR                         17340007
              MLDPT-SHNK-RTL-AMT EQUAL ZEROS                            17350007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   17360007
           ELSE                                                         17370007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         17380007
                                  = MLDBV-SHNK-RTL-AMT                  17390007
                                  / MLDPT-SHNK-RTL-AMT                  17400007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 17410007
           END-IF                                                       17420007
                                                                        17430007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               17440007
                                  = PV-ENTID-PERCENT                    17450007
                                  * UDTLI-SHNK-RTL-AMT                  17460007
           MOVE PV-WORK-AMOUNT     TO OUTPT-SHNK-RTL-AMT                17470007
           ADD PV-WORK-AMOUNT     TO MLSVE-SHNK-RTL-AMT                 17480007
                                                                        17490007
    ***  PRORATE ML254-IN-TRNST-RTL-AMT                                 17500007
           IF UDTLI-IN-TRNST-RTL-AMT EQUAL ZEROS OR                     17510007
              MLDPT-IN-TRNST-RTL-AMT EQUAL ZEROS                        17520007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   17530007
           ELSE                                                         17540007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         17550007
                                  = MLDBV-IN-TRNST-RTL-AMT              17560007
                                  / MLDPT-IN-TRNST-RTL-AMT              17570007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 17580007
           END-IF                                                       17590007
                                                                        17600007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               17610007
                                  = PV-ENTID-PERCENT                    17620007
                                  * UDTLI-IN-TRNST-RTL-AMT              17630007
           MOVE PV-WORK-AMOUNT     TO OUTPT-IN-TRNST-RTL-AMT            17640007
           ADD PV-WORK-AMOUNT     TO MLSVE-IN-TRNST-RTL-AMT             17650007
                                                                        17660007
    ***  PRORATE ML254-RCPT-DISC-COST-AMT                               17670007
           IF UDTLI-RCPT-DISC-COST-AMT EQUAL ZEROS OR                   17680007
              MLDPT-RCPT-DISC-COST-AMT EQUAL ZEROS                      17690007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   17700007
           ELSE                                                         17710007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         17720007
                                  = MLDBV-RCPT-DISC-COST-AMT            17730007
                                  / MLDPT-RCPT-DISC-COST-AMT            17740007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 17750007
           END-IF                                                       17760007
                                                                        17770007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               17780007
                                  = PV-ENTID-PERCENT                    17790007
                                  * UDTLI-RCPT-DISC-COST-AMT            17800007
           MOVE PV-WORK-AMOUNT     TO OUTPT-RCPT-DISC-COST-AMT          17810007
           ADD PV-WORK-AMOUNT     TO MLSVE-RCPT-DISC-COST-AMT           17820007
                                                                        17830007
    ***  PRORATE ML254-END-INV-RTL-AMT                                  17840007
           IF UDTLI-END-INV-RTL-AMT EQUAL ZEROS OR                      17850007
              MLDPT-END-INV-RTL-AMT EQUAL ZEROS                         17860007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   17870007
           ELSE                                                         17880007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         17890007
                                  = MLDBV-END-INV-RTL-AMT               17900007
                                  / MLDPT-END-INV-RTL-AMT               17910007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 17920007
           END-IF                                                       17930007
                                                                        17940007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               17950007
                                  = PV-ENTID-PERCENT                    17960007
                                  * UDTLI-END-INV-RTL-AMT               17970007
           MOVE PV-WORK-AMOUNT     TO OUTPT-END-INV-RTL-AMT             17980007
           ADD PV-WORK-AMOUNT     TO MLSVE-END-INV-RTL-AMT              17990007
                                                                        18000007
    ***  PRORATE ML254-END-INV-COST-AMT                                 18010007
           IF UDTLI-END-INV-COST-AMT EQUAL ZEROS OR                     18020007
              MLDPT-END-INV-COST-AMT EQUAL ZEROS                        18030007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   18040007
           ELSE                                                         18050007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         18060007
                                  = MLDBV-END-INV-COST-AMT              18070007
                                  / MLDPT-END-INV-COST-AMT              18080007
           END-IF                                                       18090007
                                                                        18100007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               18110007
                                  = PV-ENTID-PERCENT                    18120007
                                  * UDTLI-END-INV-COST-AMT              18130007
           MOVE PV-WORK-AMOUNT     TO OUTPT-END-INV-COST-AMT            18140007
           ADD PV-WORK-AMOUNT     TO MLSVE-END-INV-COST-AMT             18150007
                                                                        18160007
    ***  PRORATE  ML254-GRO-MRGN-AMT                                    18170007
           IF UDTLI-GRO-MRGN-AMT EQUAL ZEROS OR                         18180007
              MLDPT-GRO-MRGN-AMT EQUAL ZEROS                            18190007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   18200007
           ELSE                                                         18210007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         18220007
                                  = MLDBV-GRO-MRGN-AMT                  18230007
                                  / MLDPT-GRO-MRGN-AMT                  18240007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 18250007
           END-IF                                                       18260007
                                                                        18270007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               18280007
                                  = PV-ENTID-PERCENT                    18290007
                                  * UDTLI-GRO-MRGN-AMT                  18300007
           MOVE PV-WORK-AMOUNT     TO OUTPT-GRO-MRGN-AMT                18310007
           ADD PV-WORK-AMOUNT     TO MLSVE-GRO-MRGN-AMT                 18320007
                                                                        18330007
    ***   PRORATE ML254-STR-EXPTED-RTL-AMT                              18340007
           IF UDTLI-STR-EXPTED-RTL-AMT EQUAL ZEROS OR                   18350007
              MLDPT-STR-EXPTED-RTL-AMT EQUAL ZEROS                      18360007
               MOVE ZEROS         TO PV-ENTID-PERCENT                   18370007
           ELSE                                                         18380007
               COMPUTE PV-ENTID-PERCENT ROUNDED                         18390007
                                  = MLDBV-STR-EXPTED-RTL-AMT            18400007
                                  / MLDPT-STR-EXPTED-RTL-AMT            18410007
               MOVE 'Y'           TO PS-WRITE-ADJUST-SW                 18420007
           END-IF                                                       18430007
                                                                        18440007
           COMPUTE PV-WORK-AMOUNT ROUNDED                               18450007
                                  = PV-ENTID-PERCENT                    18460007
                                  * UDTLI-STR-EXPTED-RTL-AMT            18470007
           MOVE PV-WORK-AMOUNT    TO OUTPT-STR-EXPTED-RTL-AMT           18480007
           ADD PV-WORK-AMOUNT     TO MLSVE-STR-EXPTED-RTL-AMT.          18490007
                                                                        18500007
           IF PS-WRITE-ADJUSTMENT                                       18510007
               INITIALIZE DL-KEY                                        18520007
               INITIALIZE DL-VERBIAGE                                   18530007
               MOVE '  >>PRORATED:'   TO DL-PRO-VERBIAGE                18540015
               PERFORM 4300-BUILD-REPORT-PRORTED                        18550007
               PERFORM 7100-WRITE-EXTRACT-REC                           18560007
               ADD 1              TO PV-PRORATE-WRITTEN                 18570007
           END-IF.                                                      18580007
                                                                        18590007
      ***************************************************************** 18600007
      * 4200-BUILD-REPORT-BEFORE.                                       18610007
      * BUILD THE BEFORE PRORATION REPORT COLUMNS AT A KEY LEVEL.       18620007
      ***************************************************************** 18630007
       4200-BUILD-REPORT-BEFORE.                                        18640007
                                                                        18650007
           INITIALIZE DL-KEY.                                           18660007
           INITIALIZE DL-VERBIAGE.                                      18670007
                                                                        18680007
           MOVE UDTLI-DEPT-NBR      TO DL-DEPT-NBR.                     18690007
           MOVE UDTLI-SUB-CL-NBR    TO DL-SUB-CL-NBR.                   18700007
           MOVE UDTLI-LOC-NBR       TO DL-LOC-NBR.                      18710007
           MOVE UDTLI-TRN-TYP-CDE   TO DL-TRN-TYP-CDE.                  18720007
           MOVE UDTLI-ENT-ID        TO DL-ENT-ID.                       18730007
           MOVE UDTLI-LBL-SEQ-NBR   TO DL-LBL-SEQ-NBR.                  18740007
           MOVE UDTLI-ML-LWST-ID    TO DL-DKEY.                         18750007
                                                                        18760007
           COMPUTE PV-WORK-AMOUNT2  = UDTLI-SLS-REG-RTL-AMT             18770007
                                    + UDTLI-SLS-PROMO-RTL-AMT           18780007
                                    + UDTLI-SLS-PROCLR-RTL-AMT          18790007
                                    + UDTLI-SLS-CLR-RTL-AMT             18800007
                                    + UDTLI-SLS-OTH-RTL-AMT.            18810007
           MOVE PV-WORK-AMOUNT2     TO DL-SLS-RTL-AMT.                  18820007
                                                                        18830007
           MOVE UDTLI-MKDN-RTL-AMT       TO DL-MKDN-RTL-AMT.            18840007
           MOVE UDTLI-MKUP-RTL-AMT       TO DL-MKUP-RTL-AMT.            18850007
           MOVE UDTLI-XFER-IN-RTL-AMT    TO DL-XFER-IN-RTL-AMT.         18860007
           MOVE UDTLI-XFER-OUT-RTL-AMT   TO DL-XFER-OUT-RTL-AMT.        18870007
           MOVE UDTLI-RCPT-RTL-AMT       TO DL-RCPT-RTL-AMT.            18880007
           MOVE UDTLI-RCPT-NET-COST-AMT  TO DL-RCPT-NET-COST-AMT.       18890007
           MOVE UDTLI-PADJ-RTL-AMT       TO DL-PADJ-RTL-AMT.            18900007
           MOVE UDTLI-PADJ-NET-COST-AMT  TO DL-PADJ-NET-COST-AMT.       18910007
           MOVE UDTLI-INV-ADJ-RTL-AMT    TO DL-INV-ADJ-RTL-AMT.         18920007
           MOVE UDTLI-RCPT-FRGT-COST-AMT TO DL-RCPT-FRGT-COST-AMT.      18930007
           MOVE UDTLI-PADJ-FRGT-COST-AMT TO DL-PADJ-FRGT-COST-AMT.      18940007
           MOVE UDTLI-PADJ-GRO-COST-AMT  TO DL-GRO-COST-AMT.            18950007
                                                                        18960007
           PERFORM 5100-PRINT-DETAIL-LINE.                              18970007
                                                                        18980007
           ADD PV-WORK-AMOUNT2          TO PV-SLS-RTL-AMT.              18990007
           ADD UDTLI-MKDN-RTL-AMT       TO PV-MKDN-RTL-AMT.             19000007
           ADD UDTLI-MKUP-RTL-AMT       TO PV-MKUP-RTL-AMT.             19010007
           ADD UDTLI-XFER-IN-RTL-AMT    TO PV-XFER-IN-RTL-AMT.          19020007
           ADD UDTLI-XFER-OUT-RTL-AMT   TO PV-XFER-OUT-RTL-AMT.         19030007
           ADD UDTLI-RCPT-RTL-AMT       TO PV-RCPT-RTL-AMT.             19040007
           ADD UDTLI-RCPT-NET-COST-AMT  TO PV-RCPT-NET-COST-AMT.        19050007
           ADD UDTLI-PADJ-RTL-AMT       TO PV-PADJ-RTL-AMT.             19060007
           ADD UDTLI-PADJ-NET-COST-AMT  TO PV-PADJ-NET-COST-AMT.        19070007
           ADD UDTLI-INV-ADJ-RTL-AMT    TO PV-INV-ADJ-RTL-AMT.          19080007
           ADD UDTLI-RCPT-FRGT-COST-AMT TO PV-RCPT-FRGT-COST.           19090007
           ADD UDTLI-PADJ-FRGT-COST-AMT TO PV-PADJ-FRGT-COST.           19100007
           ADD UDTLI-PADJ-GRO-COST-AMT  TO PV-GRO-COST-AMT.             19110007
           ADD UDTLI-ONORD-RTL-AMT      TO PV-ONORD-RTL-AMT.            19120007
           ADD UDTLI-ONORD-COST-AMT     TO PV-ONORD-COST-AMT.           19130007
                                                                        19140007
           ADD PV-WORK-AMOUNT2          TO TV-SLS-RTL-AMT.              19150007
           ADD UDTLI-MKDN-RTL-AMT       TO TV-MKDN-RTL-AMT.             19160007
           ADD UDTLI-MKUP-RTL-AMT       TO TV-MKUP-RTL-AMT.             19170007
           ADD UDTLI-XFER-IN-RTL-AMT    TO TV-XFER-IN-RTL-AMT.          19180007
           ADD UDTLI-XFER-OUT-RTL-AMT   TO TV-XFER-OUT-RTL-AMT.         19190007
           ADD UDTLI-RCPT-RTL-AMT       TO TV-RCPT-RTL-AMT.             19200007
           ADD UDTLI-RCPT-NET-COST-AMT  TO TV-RCPT-NET-COST-AMT.        19210007
           ADD UDTLI-PADJ-RTL-AMT       TO TV-PADJ-RTL-AMT.             19220007
           ADD UDTLI-PADJ-NET-COST-AMT  TO TV-PADJ-NET-COST-AMT.        19230007
           ADD UDTLI-INV-ADJ-RTL-AMT    TO TV-INV-ADJ-RTL-AMT.          19240007
           ADD UDTLI-RCPT-FRGT-COST-AMT TO TV-RCPT-FRGT-COST.           19250007
           ADD UDTLI-PADJ-FRGT-COST-AMT TO TV-PADJ-FRGT-COST.           19260007
           ADD UDTLI-PADJ-GRO-COST-AMT  TO TV-GRO-COST-AMT.             19270007
           ADD UDTLI-ONORD-RTL-AMT      TO TV-ONORD-RTL-AMT.            19280007
           ADD UDTLI-ONORD-COST-AMT     TO TV-ONORD-COST-AMT.           19290007
                                                                        19300007
      ***************************************************************** 19310007
      * 4300-BUILD-REPORT-PRORTED.                                      19320007
      * BUILD THE PRORATED REPORT COLUMNS AT A KEY LEVEL.               19330007
      ***************************************************************** 19340007
       4300-BUILD-REPORT-PRORTED.                                       19350007
                                                                        19360007
           MOVE OUTPT-ENT-ID            TO DL-ENT-ID.                   19370007
           MOVE OUTPT-LBL-SEQ-NBR       TO DL-LBL-SEQ-NBR.              19380007
           MOVE OUTPT-ML-LWST-ID        TO DL-DKEY.                     19390007
                                                                        19400007
           COMPUTE PV-WORK-AMOUNT2      = OUTPT-SLS-REG-RTL-AMT         19410007
                                        + OUTPT-SLS-PROMO-RTL-AMT       19420007
                                        + OUTPT-SLS-PROCLR-RTL-AMT      19430007
                                        + OUTPT-SLS-CLR-RTL-AMT         19440007
                                        + OUTPT-SLS-OTH-RTL-AMT.        19450007
           MOVE PV-WORK-AMOUNT2         TO DL-SLS-RTL-AMT.              19460007
                                                                        19470007
           MOVE OUTPT-MKDN-RTL-AMT          TO DL-MKDN-RTL-AMT.         19480007
           MOVE OUTPT-MKUP-RTL-AMT          TO DL-MKUP-RTL-AMT.         19490007
           MOVE OUTPT-XFER-IN-RTL-AMT       TO DL-XFER-IN-RTL-AMT.      19500007
           MOVE OUTPT-XFER-OUT-RTL-AMT      TO DL-XFER-OUT-RTL-AMT.     19510007
           MOVE OUTPT-RCPT-RTL-AMT          TO DL-RCPT-RTL-AMT.         19520007
           MOVE OUTPT-RCPT-NET-COST-AMT     TO DL-RCPT-NET-COST-AMT.    19530007
           MOVE OUTPT-PADJ-RTL-AMT          TO DL-PADJ-RTL-AMT.         19540007
           MOVE OUTPT-PADJ-NET-COST-AMT     TO DL-PADJ-NET-COST-AMT.    19550007
           MOVE OUTPT-INV-ADJ-RTL-AMT       TO DL-INV-ADJ-RTL-AMT.      19560007
           MOVE OUTPT-RCPT-FRGT-COST-AMT    TO DL-RCPT-FRGT-COST-AMT.   19570007
           MOVE OUTPT-PADJ-FRGT-COST-AMT    TO DL-PADJ-FRGT-COST-AMT.   19580007
           MOVE OUTPT-PADJ-GRO-COST-AMT     TO DL-GRO-COST-AMT.         19590007
                                                                        19600007
           PERFORM 5100-PRINT-DETAIL-LINE.                              19610007
W37965     PERFORM 4310-WRITE-AUDIT-DTL.                                19610007
                                                                        19620007
           ADD PV-WORK-AMOUNT2          TO PV-SLS-RTL-AMT-PRO.          19630007
           ADD OUTPT-MKDN-RTL-AMT       TO PV-MKDN-RTL-AMT-PRO.         19640007
           ADD OUTPT-MKUP-RTL-AMT       TO PV-MKUP-RTL-AMT-PRO.         19650007
           ADD OUTPT-XFER-IN-RTL-AMT    TO PV-XFER-IN-RTL-AMT-PRO.      19660007
           ADD OUTPT-XFER-OUT-RTL-AMT   TO PV-XFER-OUT-RTL-AMT-PRO.     19670007
           ADD OUTPT-RCPT-RTL-AMT       TO PV-RCPT-RTL-AMT-PRO.         19680007
           ADD OUTPT-RCPT-NET-COST-AMT  TO PV-RCPT-NET-COST-AMT-PRO.    19690007
           ADD OUTPT-PADJ-RTL-AMT       TO PV-PADJ-RTL-AMT-PRO.         19700007
           ADD OUTPT-PADJ-NET-COST-AMT  TO PV-PADJ-NET-COST-AMT-PRO.    19710007
           ADD OUTPT-INV-ADJ-RTL-AMT    TO PV-INV-ADJ-RTL-AMT-PRO.      19720007
           ADD OUTPT-RCPT-FRGT-COST-AMT TO PV-RCPT-FRGT-COST-PRO.       19730007
           ADD OUTPT-PADJ-FRGT-COST-AMT TO PV-PADJ-FRGT-COST-PRO.       19740007
           ADD OUTPT-PADJ-GRO-COST-AMT  TO PV-GRO-COST-AMT-PRO.         19750007
           ADD OUTPT-ONORD-RTL-AMT      TO PV-ONORD-RTL-AMT-PRO.        19760007
           ADD OUTPT-ONORD-COST-AMT     TO PV-ONORD-COST-AMT-PRO.       19770007
                                                                        19780007
           ADD PV-WORK-AMOUNT2          TO TV-SLS-RTL-AMT-PRO.          19790007
           ADD OUTPT-MKDN-RTL-AMT       TO TV-MKDN-RTL-AMT-PRO.         19800007
           ADD OUTPT-MKUP-RTL-AMT       TO TV-MKUP-RTL-AMT-PRO.         19810007
           ADD OUTPT-XFER-IN-RTL-AMT    TO TV-XFER-IN-RTL-AMT-PRO.      19820007
           ADD OUTPT-XFER-OUT-RTL-AMT   TO TV-XFER-OUT-RTL-AMT-PRO.     19830007
           ADD OUTPT-RCPT-RTL-AMT       TO TV-RCPT-RTL-AMT-PRO.         19840007
           ADD OUTPT-RCPT-NET-COST-AMT  TO TV-RCPT-NET-COST-AMT-PRO.    19850007
           ADD OUTPT-PADJ-RTL-AMT       TO TV-PADJ-RTL-AMT-PRO.         19860007
           ADD OUTPT-PADJ-NET-COST-AMT  TO TV-PADJ-NET-COST-AMT-PRO.    19870007
           ADD OUTPT-INV-ADJ-RTL-AMT    TO TV-INV-ADJ-RTL-AMT-PRO.      19880007
           ADD OUTPT-RCPT-FRGT-COST-AMT TO TV-RCPT-FRGT-COST-PRO.       19890007
           ADD OUTPT-PADJ-FRGT-COST-AMT TO TV-PADJ-FRGT-COST-PRO.       19900007
           ADD OUTPT-PADJ-GRO-COST-AMT  TO TV-GRO-COST-AMT-PRO.         19910007
           ADD OUTPT-ONORD-RTL-AMT      TO TV-ONORD-RTL-AMT-PRO.        19920007
           ADD OUTPT-ONORD-COST-AMT     TO TV-ONORD-COST-AMT-PRO.       19930007
                                                                        19940007
W37965***************************************************************** 19950007
W37965* 4310-WRITE-AUDIT-DTL.                                           19960007
W37965***************************************************************** 19970007
W37965 4310-WRITE-AUDIT-DTL.                                            19980007
W37965     INITIALIZE ML090-AUDIT-REC                                           
W37965     MOVE CC-PROC-DATE-ISO            TO ML090-FSCL-WK-END-DTE            
W37965     MOVE CC-PROC-DATE-ISO            TO ML090-PRCG-DTE                   
W37965     MOVE 'BVUNKN'                    TO ML090-FINCL-PRC-GP-CDE           
W37965     MOVE '9'                         TO ML090-SRC-SYS-ID                 
W37965     MOVE OUTPT-DEPT-NBR              TO ML090-DEPT-NBR                   
W37965     MOVE OUTPT-MAJ-CL-NBR            TO ML090-MAJ-CL-NBR                 
W37965     MOVE OUTPT-SUB-CL-NBR            TO ML090-SUB-CL-NBR                 
W37965     MOVE OUTPT-LOC-NBR               TO ML090-LOC-NBR                    
W37965     MOVE UDTLI-ENT-ID                TO ML090-ORIG-ENT-ID                
W37965     MOVE UDTLI-LBL-SEQ-NBR           TO ML090-ORIG-LBL-SEQ-NBR           
W37965     MOVE 0                           TO ML090-TRN-TYP-CDE(1:1)           
W37965     MOVE OUTPT-PRCHG-RSN-CDE         TO ML090-PRCHG-RSN-CDE              
W37965     MOVE OUTPT-PRCHG-CTG-CDE         TO ML090-PRCHG-CTG-CDE              
W37965     MOVE '0'                         TO ML090-TRN-TYP-CDE(1:1)           
W37965     MOVE OUTPT-TRN-TYP-CDE           TO ML090-TRN-TYP-CDE(2:2)           
W37965     MOVE OUTPT-AP-TRANS-CDE          TO ML090-AP-TRN-CDE                 
W37965     MOVE '01'                        TO ML090-DR-CR-CDE                  
W37965     MOVE OUTPT-SLS-TYP-CDE           TO ML090-SLS-TYP-CDE                
W37965     IF OUTPT-PADJ-NET-COST-AMT NOT = ZERO OR                             
W37965        OUTPT-PADJ-GRO-COST-AMT NOT = ZERO OR                             
W37965        OUTPT-PADJ-RTL-AMT      NOT = ZERO                                
W37965            MOVE '15'                 TO ML090-TRN-TYP-CDE(2:2)           
W37965     END-IF                                                               
W37965     MOVE OUTPT-SKU-NBR TO PV-SKU-NBR                                     
W37965     IF PV-SKU-NBR = ZEROES OR                                            
W37965        PV-SKU-NBR = SPACES OR                                            
W37965        PV-SKU-NBR (6:3) = 000 OR                                         
W37965        PV-SKU-NBR (6:3) = 999                                            
W37965            MOVE 'Y'  TO ML090-DUMMY-SKU-IND                              
W37965     ELSE                                                                 
W37965            MOVE 'N'  TO ML090-DUMMY-SKU-IND                              
W37965     END-IF                                                               
W37965     MOVE OUTPT-ENT-ID                TO ML090-ENT-ID                     
W37965     MOVE OUTPT-LBL-SEQ-NBR           TO ML090-LBL-SEQ-NBR                
W37965     MOVE OUTPT-ML-LWST-ID            TO ML090-ML-LO-MDSE-LVL-ID          
W37965     MOVE OUTPT-PADJ-NET-COST-AMT     TO ML090-PADJ-NET-COST-AMT          
W37965     MOVE OUTPT-PADJ-GRO-COST-AMT     TO ML090-PADJ-GRO-COST-AMT          
W37965     MOVE OUTPT-PADJ-DISC-COST-AMT    TO ML090-PADJ-DISC-COST-AMT         
W37965     MOVE OUTPT-PADJ-RTL-AMT          TO ML090-PADJ-RTL-AMT               
W37965     MOVE PV-WORK-AMOUNT2             TO ML090-SLS-RTL-AMT                
W37965*    IF OUTPT-MKDN-RTL-AMT NOT = ZERO                                     
W37965*           MOVE OUTPT-MKDN-RTL-AMT   TO ML090-PRCHG-RTL-AMT              
W37965*    ELSE                                                                 
W37965*           MOVE OUTPT-MKUP-RTL-AMT   TO ML090-PRCHG-RTL-AMT              
W37965*    END-IF                                                               
W37965*    WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC                      
W37965*    ADD 1                      TO PV-AUDIT-RECS.                         
W37965     IF OUTPT-SLS-REG-RTL-AMT     NOT = ZERO                              
W37965         MOVE OUTPT-SLS-REG-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'R'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC                  
W37965         ADD 1                            TO PV-AUDIT-RECS                
W37965     END-IF.                                                              
W37965     IF OUTPT-SLS-PROMO-RTL-AMT NOT = ZERO                                
W37965         MOVE OUTPT-SLS-PROMO-RTL-AMT     TO ML090-SLS-RTL-AMT            
W37965         MOVE 'P'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC                  
W37965         ADD 1                            TO PV-AUDIT-RECS                
W37965     END-IF.                                                              
W37965     IF OUTPT-SLS-PROCLR-RTL-AMT NOT = ZERO                               
W37965         MOVE OUTPT-SLS-PROCLR-RTL-AMT    TO ML090-SLS-RTL-AMT            
W37965         MOVE 'G'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC                  
W37965         ADD 1                            TO PV-AUDIT-RECS                
W37965     END-IF.                                                              
W37965     IF OUTPT-SLS-CLR-RTL-AMT NOT = ZERO                                  
W37965         MOVE OUTPT-SLS-CLR-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'C'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC                  
W37965         ADD 1                            TO PV-AUDIT-RECS                
W37965     END-IF.                                                              
W37965     IF OUTPT-SLS-OTH-RTL-AMT NOT = ZERO                                  
W37965         MOVE OUTPT-SLS-OTH-RTL-AMT       TO ML090-SLS-RTL-AMT            
W37965         MOVE 'N'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC                  
W37965         ADD 1                            TO PV-AUDIT-RECS                
W37965     END-IF.                                                              
W37965     IF OUTPT-MKDN-RTL-AMT  NOT = ZERO                            02026900
W37965         MOVE OUTPT-MKDN-RTL-AMT          TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC          02027300
W37965         ADD 1                            TO PV-AUDIT-RECS        02027400
W37965     END-IF.                                                      02027500
W37965     IF OUTPT-MKUP-RTL-AMT  NOT = ZERO                            02026900
W37965         MOVE OUTPT-MKUP-RTL-AMT          TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC          02027300
W37965         ADD 1                            TO PV-AUDIT-RECS        02027400
W37965     END-IF.                                                      02027500
W37965     IF OUTPT-SLS-REG-RTL-AMT     = ZERO AND                              
W37965        OUTPT-SLS-PROMO-RTL-AMT   = ZERO AND                              
W37965        OUTPT-SLS-PROCLR-RTL-AMT  = ZERO AND                              
W37965        OUTPT-SLS-CLR-RTL-AMT     = ZERO AND                              
W37965        OUTPT-SLS-OTH-RTL-AMT     = ZERO AND                              
W37965        OUTPT-MKDN-RTL-AMT        = ZERO AND                              
W37965        OUTPT-MKUP-RTL-AMT        = ZERO                                  
W37965         WRITE DTL-AUDIT-OUT-RECORD FROM ML090-AUDIT-REC                  
W37965         ADD 1                            TO PV-AUDIT-RECS                
W37965     END-IF.                                                              
W37965                                                                          
      ***************************************************************** 19950007
      * 4400-BUILD-REPORT-TOTALS.                                       19960007
      ***************************************************************** 19970007
       4400-BUILD-REPORT-TOTALS.                                        19980007
                                                                        19990007
           IF PV-LINE-COUNTER > (PC-MAX-LINES + 4)                      20000007
               PERFORM 5200-PRINT-HEADINGS                              20010007
           END-IF.                                                      20020007
                                                                        20030007
           WRITE DTL-LDGR-RPT-RECORD                                    20040007
               FROM REPORT-UL-LINE AFTER ADVANCING 1 LINES.             20050007
                                                                        20060007
           MOVE ' BEFORE TOTAL      ' TO TL-VERBIAGE.                   20070007
           MOVE PV-SLS-RTL-AMT        TO TL-SLS-RTL-AMT.                20080007
           MOVE PV-MKDN-RTL-AMT       TO TL-MKDN-RTL-AMT.               20090007
           MOVE PV-MKUP-RTL-AMT       TO TL-MKUP-RTL-AMT.               20100007
           MOVE PV-XFER-IN-RTL-AMT    TO TL-XFER-IN-RTL-AMT.            20110007
           MOVE PV-XFER-OUT-RTL-AMT   TO TL-XFER-OUT-RTL-AMT.           20120007
           MOVE PV-RCPT-RTL-AMT       TO TL-RCPT-RTL-AMT.               20130007
           MOVE PV-RCPT-NET-COST-AMT  TO TL-RCPT-NET-COST-AMT.          20140007
           MOVE PV-PADJ-RTL-AMT       TO TL-PADJ-RTL-AMT.               20150007
           MOVE PV-PADJ-NET-COST-AMT  TO TL-PADJ-NET-COST-AMT.          20160007
           MOVE PV-INV-ADJ-RTL-AMT    TO TL-INV-ADJ-RTL-AMT.            20170007
           MOVE PV-RCPT-FRGT-COST     TO TL-RCPT-FRGT-COST-AMT.         20180007
           MOVE PV-PADJ-FRGT-COST     TO TL-PADJ-FRGT-COST-AMT.         20190007
           MOVE PV-GRO-COST-AMT       TO TL-GRO-COST-AMT.               20200007
                                                                        20210007
           WRITE DTL-LDGR-RPT-RECORD                                    20220007
               FROM REPORT-TOTAL-LINE    AFTER ADVANCING 1 LINES.       20230007
                                                                        20240007
           MOVE '    PRORATED TOTAL:'    TO TL-VERBIAGE.                20250007
           MOVE PV-SLS-RTL-AMT-PRO       TO TL-SLS-RTL-AMT.             20260007
           MOVE PV-MKDN-RTL-AMT-PRO      TO TL-MKDN-RTL-AMT.            20270007
           MOVE PV-MKUP-RTL-AMT-PRO      TO TL-MKUP-RTL-AMT.            20280007
           MOVE PV-XFER-IN-RTL-AMT-PRO   TO TL-XFER-IN-RTL-AMT.         20290007
           MOVE PV-XFER-OUT-RTL-AMT-PRO  TO TL-XFER-OUT-RTL-AMT.        20300007
           MOVE PV-RCPT-RTL-AMT-PRO      TO TL-RCPT-RTL-AMT.            20310007
           MOVE PV-RCPT-NET-COST-AMT-PRO TO TL-RCPT-NET-COST-AMT.       20320007
           MOVE PV-PADJ-RTL-AMT-PRO      TO TL-PADJ-RTL-AMT.            20330007
           MOVE PV-PADJ-NET-COST-AMT-PRO TO TL-PADJ-NET-COST-AMT.       20340007
           MOVE PV-INV-ADJ-RTL-AMT-PRO   TO TL-INV-ADJ-RTL-AMT.         20350007
           MOVE PV-RCPT-FRGT-COST-PRO    TO TL-RCPT-FRGT-COST-AMT.      20360007
           MOVE PV-PADJ-FRGT-COST-PRO    TO TL-PADJ-FRGT-COST-AMT.      20370007
           MOVE PV-GRO-COST-AMT-PRO      TO TL-GRO-COST-AMT.            20380007
                                                                        20390007
           WRITE DTL-LDGR-RPT-RECORD                                    20400007
               FROM REPORT-TOTAL-LINE    AFTER ADVANCING 1 LINES.       20410007
                                                                        20420007
           MOVE SPACES                   TO DTL-LDGR-RPT-RECORD.        20430007
           WRITE DTL-LDGR-RPT-RECORD     AFTER ADVANCING 1 LINES.       20440007
                                                                        20450007
           ADD 4                        TO PV-LINE-COUNTER.             20460007
                                                                        20470007
           MOVE ZEROS                   TO PV-SLS-RTL-AMT.              20480007
           MOVE ZEROS                   TO PV-MKDN-RTL-AMT.             20490007
           MOVE ZEROS                   TO PV-MKUP-RTL-AMT.             20500007
           MOVE ZEROS                   TO PV-XFER-IN-RTL-AMT.          20510007
           MOVE ZEROS                   TO PV-XFER-OUT-RTL-AMT.         20520007
           MOVE ZEROS                   TO PV-RCPT-RTL-AMT.             20530007
           MOVE ZEROS                   TO PV-RCPT-NET-COST-AMT.        20540007
           MOVE ZEROS                   TO PV-PADJ-RTL-AMT.             20550007
           MOVE ZEROS                   TO PV-PADJ-NET-COST-AMT.        20560007
           MOVE ZEROS                   TO PV-INV-ADJ-RTL-AMT.          20570007
           MOVE ZEROS                   TO PV-RCPT-FRGT-COST.           20580007
           MOVE ZEROS                   TO PV-PADJ-FRGT-COST.           20590007
           MOVE ZEROS                   TO PV-GRO-COST-AMT.             20600007
           MOVE ZEROS                   TO PV-ONORD-RTL-AMT.            20610007
           MOVE ZEROS                   TO PV-ONORD-COST-AMT.           20620007
           MOVE ZEROS                   TO PV-SLS-RTL-AMT-PRO.          20630007
           MOVE ZEROS                   TO PV-MKDN-RTL-AMT-PRO.         20640007
           MOVE ZEROS                   TO PV-MKUP-RTL-AMT-PRO.         20650007
           MOVE ZEROS                   TO PV-XFER-IN-RTL-AMT-PRO.      20660007
           MOVE ZEROS                   TO PV-XFER-OUT-RTL-AMT-PRO.     20670007
           MOVE ZEROS                   TO PV-RCPT-RTL-AMT-PRO.         20680007
           MOVE ZEROS                   TO PV-RCPT-NET-COST-AMT-PRO.    20690007
           MOVE ZEROS                   TO PV-PADJ-RTL-AMT-PRO.         20700007
           MOVE ZEROS                   TO PV-PADJ-NET-COST-AMT-PRO.    20710007
           MOVE ZEROS                   TO PV-INV-ADJ-RTL-AMT-PRO.      20720007
           MOVE ZEROS                   TO PV-RCPT-FRGT-COST-PRO.       20730007
           MOVE ZEROS                   TO PV-PADJ-FRGT-COST-PRO.       20740007
           MOVE ZEROS                   TO PV-GRO-COST-AMT-PRO.         20750007
           MOVE ZEROS                   TO PV-ONORD-RTL-AMT-PRO.        20760007
           MOVE ZEROS                   TO PV-ONORD-COST-AMT-PRO.       20770007
                                                                        20780007
      ***************************************************************** 20790007
      * 4600-BUILD-GRAND-TOTALS.                                        20800007
      ***************************************************************** 20810007
       4600-BUILD-GRAND-TOTALS.                                         20820007
                                                                        20830007
           IF PV-LINE-COUNTER > (PC-MAX-LINES + 4)                      20840007
               PERFORM 5200-PRINT-HEADINGS                              20850007
           END-IF.                                                      20860007
                                                                        20870007
           WRITE DTL-LDGR-RPT-RECORD                                    20880007
               FROM REPORT-UL-LINE AFTER ADVANCING 1 LINES.             20890007
                                                                        20900007
           MOVE ' BEFORE GR TOTAL   ' TO TL-VERBIAGE.                   20910007
           MOVE TV-SLS-RTL-AMT        TO TL-SLS-RTL-AMT.                20920007
           MOVE TV-MKDN-RTL-AMT       TO TL-MKDN-RTL-AMT.               20930007
           MOVE TV-MKUP-RTL-AMT       TO TL-MKUP-RTL-AMT.               20940007
           MOVE TV-XFER-IN-RTL-AMT    TO TL-XFER-IN-RTL-AMT.            20950007
           MOVE TV-XFER-OUT-RTL-AMT   TO TL-XFER-OUT-RTL-AMT.           20960007
           MOVE TV-RCPT-RTL-AMT       TO TL-RCPT-RTL-AMT.               20970007
           MOVE TV-RCPT-NET-COST-AMT  TO TL-RCPT-NET-COST-AMT.          20980007
           MOVE TV-PADJ-RTL-AMT       TO TL-PADJ-RTL-AMT.               20990007
           MOVE TV-PADJ-NET-COST-AMT  TO TL-PADJ-NET-COST-AMT.          21000007
           MOVE TV-INV-ADJ-RTL-AMT    TO TL-INV-ADJ-RTL-AMT.            21010007
           MOVE TV-RCPT-FRGT-COST     TO TL-RCPT-FRGT-COST-AMT.         21020007
           MOVE TV-PADJ-FRGT-COST     TO TL-PADJ-FRGT-COST-AMT.         21030007
           MOVE TV-GRO-COST-AMT       TO TL-GRO-COST-AMT.               21040007
                                                                        21050007
           WRITE DTL-LDGR-RPT-RECORD                                    21060007
               FROM REPORT-TOTAL-LINE    AFTER ADVANCING 1 LINES.       21070007
                                                                        21080007
           MOVE '    PRORTED GR TOT:'    TO TL-VERBIAGE.                21090007
           MOVE TV-SLS-RTL-AMT-PRO       TO TL-SLS-RTL-AMT.             21100007
           MOVE TV-MKDN-RTL-AMT-PRO      TO TL-MKDN-RTL-AMT.            21110007
           MOVE TV-MKUP-RTL-AMT-PRO      TO TL-MKUP-RTL-AMT.            21120007
           MOVE TV-XFER-IN-RTL-AMT-PRO   TO TL-XFER-IN-RTL-AMT.         21130007
           MOVE TV-XFER-OUT-RTL-AMT-PRO  TO TL-XFER-OUT-RTL-AMT.        21140007
           MOVE TV-RCPT-RTL-AMT-PRO      TO TL-RCPT-RTL-AMT.            21150007
           MOVE TV-RCPT-NET-COST-AMT-PRO TO TL-RCPT-NET-COST-AMT.       21160007
           MOVE TV-PADJ-RTL-AMT-PRO      TO TL-PADJ-RTL-AMT.            21170007
           MOVE TV-PADJ-NET-COST-AMT-PRO TO TL-PADJ-NET-COST-AMT.       21180007
           MOVE TV-INV-ADJ-RTL-AMT-PRO   TO TL-INV-ADJ-RTL-AMT.         21190007
           MOVE TV-RCPT-FRGT-COST-PRO    TO TL-RCPT-FRGT-COST-AMT.      21200007
           MOVE TV-PADJ-FRGT-COST-PRO    TO TL-PADJ-FRGT-COST-AMT.      21210007
           MOVE TV-GRO-COST-AMT-PRO      TO TL-GRO-COST-AMT.            21220007
                                                                        21230007
           WRITE DTL-LDGR-RPT-RECORD                                    21240007
               FROM REPORT-TOTAL-LINE    AFTER ADVANCING 1 LINES.       21250007
                                                                        21260007
           MOVE SPACES                   TO DTL-LDGR-RPT-RECORD.        21270007
           WRITE DTL-LDGR-RPT-RECORD     AFTER ADVANCING 1 LINES.       21280007
                                                                        21290007
           ADD 4                        TO PV-LINE-COUNTER.             21300007
                                                                        21310007
      /*****************************************************************21320007
      * 5000-APPLY-ANY-REMAINDERS.                                      21330007
      ***************************************************************** 21340007
       5000-APPLY-ANY-REMAINDERS.                                       21350007
                                                                        21360007
           PERFORM 6000-APPLY-REMAINDER.                                21370007
                                                                        21380007
           PERFORM 4400-BUILD-REPORT-TOTALS.                            21390007
                                                                        21400007
           INITIALIZE MLSVE-UPDATE-REC.                                 21410007
                                                                        21420007
      ******************************************************************21430007
      * 5100-PRINT-DETAIL-LINE.                                         21440007
      ***************************************************************** 21450007
       5100-PRINT-DETAIL-LINE.                                          21460007
                                                                        21470007
           IF PV-LINE-COUNTER > PC-MAX-LINES                            21480007
               PERFORM 5200-PRINT-HEADINGS                              21490007
           END-IF.                                                      21500007
                                                                        21510007
           WRITE DTL-LDGR-RPT-RECORD                                    21520007
               FROM REPORT-DETAIL-LINE   AFTER ADVANCING 1 LINES        21530007
           ADD 1                         TO PV-LINE-COUNTER.            21540007
                                                                        21550007
      ******************************************************************21560007
      * 5200-PRINT-HEADINGS.                                            21570007
      ***************************************************************** 21580007
       5200-PRINT-HEADINGS.                                             21590007
                                                                        21600007
           ADD 1                     TO PV-PAGE-COUNTER.                21610007
           MOVE PV-PAGE-COUNTER      TO DP250O-PAGE-NUMBER.             21620007
           WRITE DTL-LDGR-RPT-RECORD                                    21630007
             FROM DP250O-STANDRD-HEADER-250-COLS                        21640007
                                     AFTER ADVANCING PAGE.              21650007
                                                                        21660007
           WRITE DTL-LDGR-RPT-RECORD                                    21670007
             FROM REPORT-TITLE-LINE  AFTER ADVANCING 1 LINE.            21680007
                                                                        21690007
           WRITE DTL-LDGR-RPT-RECORD                                    21700007
             FROM REPORT-HEADING-LINE  AFTER ADVANCING 2 LINES.         21710007
                                                                        21720007
           WRITE DTL-LDGR-RPT-RECORD                                    21730007
             FROM REPORT-HEADING-LINE2 AFTER ADVANCING 1 LINES.         21740007
                                                                        21750007
           WRITE DTL-LDGR-RPT-RECORD                                    21760007
             FROM REPORT-UL-LINE                                        21770007
                                     AFTER ADVANCING 2 LINES.           21780007
           MOVE 5                    TO PV-LINE-COUNTER.                21790007
                                                                        21800007
      /*****************************************************************21810007
      * 6000-APPLY-REMAINDER.                                           21820007
      ***************************************************************** 21830007
       6000-APPLY-REMAINDER.                                            21840007
                                                                        21850007
           MOVE 'N'               TO PS-WRITE-ADJUST-SW.                21860007
                                                                        21870007
           MOVE PSAVE-UPDATE-REC  TO OUTPT-UPDATE-REC.                  21880007
                                                                        21890007
           IF MLDBV-DEPT-NBR EQUAL ZEROS    AND                         21910007
              MLDBV-ENT-ID EQUAL ZEROS AND                              21920007
              MLDBV-LBL-SEQ-NBR EQUAL ZEROS AND                         21930007
              MLDBV-ML-LWST-ID EQUAL ZEROS                              21940007
               NEXT SENTENCE                                            21950007
I49370     ELSE                                                         21950114
I49370     IF MLDBV-DEPT-NBR EQUAL OUTPT-DEPT-NBR                       21950214
I49370         MOVE MLDBV-ENT-ID      TO OUTPT-ENT-ID                   21980014
I49370         MOVE MLDBV-LBL-SEQ-NBR TO OUTPT-LBL-SEQ-NBR              21990014
I49370         MOVE MLDBV-ML-LWST-ID  TO OUTPT-ML-LWST-ID               22000014
           END-IF.                                                      22020007
                                                                        22030007
      *** APPLY ANY REMAINING ML254-SLS-REG-RTL-AMT.....                22040007
           IF MLSVE-SLS-REG-RTL-AMT EQUAL PSAVE-SLS-REG-RTL-AMT         22050007
               MOVE ZEROS             TO OUTPT-SLS-REG-RTL-AMT          22060007
           ELSE                                                         22070007
               COMPUTE PV-WORK-AMOUNT = PSAVE-SLS-REG-RTL-AMT           22080007
                                      - MLSVE-SLS-REG-RTL-AMT           22090007
               MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-REG-RTL-AMT          22100007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22110007
           END-IF.                                                      22120007
                                                                        22130007
      *** APPLY ANY REMAINING ML254-SLS-PROMO-RTL-AMT...                22140007
           IF MLSVE-SLS-PROMO-RTL-AMT EQUAL PSAVE-SLS-PROMO-RTL-AMT     22150007
               MOVE ZEROS             TO OUTPT-SLS-PROMO-RTL-AMT        22160007
           ELSE                                                         22170007
               COMPUTE PV-WORK-AMOUNT = PSAVE-SLS-PROMO-RTL-AMT         22180007
                                      - MLSVE-SLS-PROMO-RTL-AMT         22190007
               MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-PROMO-RTL-AMT        22200007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22210007
           END-IF.                                                      22220007
                                                                        22230007
      *** APPLY ANY REMAINING ML254-SLS-PROCLR-RTL-AMT.....             22240007
           IF MLSVE-SLS-PROCLR-RTL-AMT EQUAL PSAVE-SLS-PROCLR-RTL-AMT   22250007
               MOVE ZEROS             TO OUTPT-SLS-PROCLR-RTL-AMT       22260007
           ELSE                                                         22270007
               COMPUTE PV-WORK-AMOUNT = PSAVE-SLS-PROCLR-RTL-AMT        22280007
                                      - MLSVE-SLS-PROCLR-RTL-AMT        22290007
               MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-PROCLR-RTL-AMT       22300007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22310007
           END-IF.                                                      22320007
                                                                        22330007
      *** APPLY ANY REMAINING ML254-SLS-CLR-RTL-AMT.....                22340007
           IF MLSVE-SLS-CLR-RTL-AMT EQUAL PSAVE-SLS-CLR-RTL-AMT         22350007
               MOVE ZEROS             TO OUTPT-SLS-CLR-RTL-AMT          22360007
           ELSE                                                         22370007
               COMPUTE PV-WORK-AMOUNT = PSAVE-SLS-CLR-RTL-AMT           22380007
                                      - MLSVE-SLS-CLR-RTL-AMT           22390007
               MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-CLR-RTL-AMT          22400007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22410007
           END-IF.                                                      22420007
                                                                        22430007
      *** APPLY ANY REMAINING ML254-SLS-OTH-RTL-AMT.....                22440007
           IF MLSVE-SLS-OTH-RTL-AMT EQUAL PSAVE-SLS-OTH-RTL-AMT         22450007
               MOVE ZEROS             TO OUTPT-SLS-OTH-RTL-AMT          22460007
           ELSE                                                         22470007
               COMPUTE PV-WORK-AMOUNT = PSAVE-SLS-OTH-RTL-AMT           22480007
                                      - MLSVE-SLS-OTH-RTL-AMT           22490007
               MOVE PV-WORK-AMOUNT    TO OUTPT-SLS-OTH-RTL-AMT          22500007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22510007
           END-IF.                                                      22520007
                                                                        22530007
      *** APPLY ANY REMAINING ML254-MKDN-PLU-RTL-AMT                    22540007
           IF MLSVE-MKDN-PLU-RTL-AMT EQUAL PSAVE-MKDN-PLU-RTL-AMT       22550007
               MOVE ZEROS             TO OUTPT-MKDN-PLU-RTL-AMT         22560007
           ELSE                                                         22570007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-PLU-RTL-AMT          22580007
                                      - MLSVE-MKDN-PLU-RTL-AMT          22590007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-PLU-RTL-AMT         22600007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22610007
           END-IF.                                                      22620007
                                                                        22630007
      *** APPLY ANY REMAINING ML254-MKDN-PROMO-RTL-AMT                  22640007
           IF MLSVE-MKDN-PROMO-RTL-AMT EQUAL PSAVE-MKDN-PROMO-RTL-AMT   22650007
               MOVE ZEROS             TO OUTPT-MKDN-PROMO-RTL-AMT       22660007
           ELSE                                                         22670007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-PROMO-RTL-AMT        22680007
                                      - MLSVE-MKDN-PROMO-RTL-AMT        22690007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-PROMO-RTL-AMT       22700007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22710007
           END-IF.                                                      22720007
                                                                        22730007
      *** APPLY ANY REMAINING ML254-MKDN-RGST-RTL-AMT                   22740007
           IF MLSVE-MKDN-RGST-RTL-AMT EQUAL PSAVE-MKDN-RGST-RTL-AMT     22750007
               MOVE ZEROS             TO OUTPT-MKDN-RGST-RTL-AMT        22760007
           ELSE                                                         22770007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-RGST-RTL-AMT         22780007
                                      - MLSVE-MKDN-RGST-RTL-AMT         22790007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-RGST-RTL-AMT        22800007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22810007
           END-IF.                                                      22820007
                                                                        22830007
      *** APPLY ANY REMAINING ML254-MKDN-GLDST-RTL-AMT                  22840007
           IF MLSVE-MKDN-GLDST-RTL-AMT EQUAL PSAVE-MKDN-GLDST-RTL-AMT   22850007
               MOVE ZEROS             TO OUTPT-MKDN-GLDST-RTL-AMT       22860007
           ELSE                                                         22870007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-GLDST-RTL-AMT        22880007
                                      - MLSVE-MKDN-GLDST-RTL-AMT        22890007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-GLDST-RTL-AMT       22900007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             22910007
           END-IF.                                                      22920007
                                                                        22930007
      *** APPLY ANY REMAINING ML254-MKDN-UMTCH-RTL-AMT                  22940007
           IF MLSVE-MKDN-UMTCH-RTL-AMT EQUAL PSAVE-MKDN-UMTCH-RTL-AMT   22950007
               MOVE ZEROS             TO OUTPT-MKDN-UMTCH-RTL-AMT       22960007
           ELSE                                                         22970007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-UMTCH-RTL-AMT        22980007
                                      - MLSVE-MKDN-UMTCH-RTL-AMT        22990007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-UMTCH-RTL-AMT       23000007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23010007
           END-IF.                                                      23020007
                                                                        23030007
      *** APPLY ANY REMAINING ML254-MKDN-BYR-RTL-AMT                    23040007
           IF MLSVE-MKDN-BYR-RTL-AMT EQUAL PSAVE-MKDN-BYR-RTL-AMT       23050007
               MOVE ZEROS             TO OUTPT-MKDN-BYR-RTL-AMT         23060007
           ELSE                                                         23070007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-BYR-RTL-AMT          23080007
                                      - MLSVE-MKDN-BYR-RTL-AMT          23090007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-BYR-RTL-AMT         23100007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23110007
           END-IF.                                                      23120007
                                                                        23130007
      *** APPLY ANY REMAINING ML254-MKDN-STR-RTL-AMT                    23140007
           IF MLSVE-MKDN-STR-RTL-AMT EQUAL PSAVE-MKDN-STR-RTL-AMT       23150007
               MOVE ZEROS             TO OUTPT-MKDN-STR-RTL-AMT         23160007
           ELSE                                                         23170007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-STR-RTL-AMT          23180007
                                      - MLSVE-MKDN-STR-RTL-AMT          23190007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-STR-RTL-AMT         23200007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23210007
           END-IF.                                                      23220007
                                                                        23230007
      *** APPLY ANY REMAINING ML254-MKDN-PRPT-RTL-AMT                   23240007
           IF MLSVE-MKDN-PRPT-RTL-AMT EQUAL PSAVE-MKDN-PRPT-RTL-AMT     23250007
               MOVE ZEROS             TO OUTPT-MKDN-PRPT-RTL-AMT        23260007
           ELSE                                                         23270007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-PRPT-RTL-AMT         23280007
                                      - MLSVE-MKDN-PRPT-RTL-AMT         23290007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-PRPT-RTL-AMT        23300007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23310007
           END-IF.                                                      23320007
                                                                        23330007
      *** APPLY ANY REMAINING ML254-MKDN-OTH-RTL-AMT                    23340007
           IF MLSVE-MKDN-OTH-RTL-AMT EQUAL PSAVE-MKDN-OTH-RTL-AMT       23350007
               MOVE ZEROS             TO OUTPT-MKDN-OTH-RTL-AMT         23360007
           ELSE                                                         23370007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-OTH-RTL-AMT          23380007
                                      - MLSVE-MKDN-OTH-RTL-AMT          23390007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-OTH-RTL-AMT         23400007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23410007
           END-IF.                                                      23420007
                                                                        23430007
      *** APPLY ANY REMAINING ML254-MKDN-RTL-AMT                        23440007
           IF MLSVE-MKDN-RTL-AMT EQUAL PSAVE-MKDN-RTL-AMT               23450007
               MOVE ZEROS             TO OUTPT-MKDN-RTL-AMT             23460007
           ELSE                                                         23470007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKDN-RTL-AMT              23480007
                                      - MLSVE-MKDN-RTL-AMT              23490007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKDN-RTL-AMT             23500007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23510007
           END-IF.                                                      23520007
                                                                        23530007
      *** APPLY ANY REMAINING ML254-MKUP-RTL-AMT                        23540007
           IF MLSVE-MKUP-RTL-AMT EQUAL PSAVE-MKUP-RTL-AMT               23550007
               MOVE ZEROS             TO OUTPT-MKUP-RTL-AMT             23560007
           ELSE                                                         23570007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKUP-RTL-AMT              23580007
                                      - MLSVE-MKUP-RTL-AMT              23590007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKUP-RTL-AMT             23600007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23610007
           END-IF.                                                      23620007
                                                                        23630007
      *** APPLY ANY REMAINING ML254-XFER-IN-RTL-AMT.....                23640007
           IF MLSVE-XFER-IN-RTL-AMT EQUAL PSAVE-XFER-IN-RTL-AMT         23650007
               MOVE ZEROS             TO OUTPT-XFER-IN-RTL-AMT          23660007
           ELSE                                                         23670007
               COMPUTE PV-WORK-AMOUNT = PSAVE-XFER-IN-RTL-AMT           23680007
                                      - MLSVE-XFER-IN-RTL-AMT           23690007
               MOVE PV-WORK-AMOUNT    TO OUTPT-XFER-IN-RTL-AMT          23700007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23710007
           END-IF.                                                      23720007
                                                                        23730007
      *** APPLY ANY REMAINING ML254-XFER-OUT-RTL-AMT.....               23740007
           IF MLSVE-XFER-OUT-RTL-AMT EQUAL PSAVE-XFER-OUT-RTL-AMT       23750007
               MOVE ZEROS             TO OUTPT-XFER-OUT-RTL-AMT         23760007
           ELSE                                                         23770007
               COMPUTE PV-WORK-AMOUNT = PSAVE-XFER-OUT-RTL-AMT          23780007
                                      - MLSVE-XFER-OUT-RTL-AMT          23790007
               MOVE PV-WORK-AMOUNT    TO OUTPT-XFER-OUT-RTL-AMT         23800007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23810007
           END-IF.                                                      23820007
                                                                        23830007
      *** APPLY ANY REMAINING ML254-RCPT-RTL-AMT                        23840007
           IF MLSVE-RCPT-RTL-AMT EQUAL PSAVE-RCPT-RTL-AMT               23850007
               MOVE ZEROS             TO OUTPT-RCPT-RTL-AMT             23860007
           ELSE                                                         23870007
               COMPUTE PV-WORK-AMOUNT = PSAVE-RCPT-RTL-AMT              23880007
                                      - MLSVE-RCPT-RTL-AMT              23890007
               MOVE PV-WORK-AMOUNT    TO OUTPT-RCPT-RTL-AMT             23900007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             23910007
           END-IF.                                                      23920007
                                                                        23930007
      *** APPLY ANY REMAINING ML254-RCPT-NET-COST-AMT                   23940007
           IF MLSVE-RCPT-NET-COST-AMT EQUAL PSAVE-RCPT-NET-COST-AMT     23950007
               MOVE ZEROS             TO OUTPT-RCPT-NET-COST-AMT        23960007
           ELSE                                                         23970007
               COMPUTE PV-WORK-AMOUNT = PSAVE-RCPT-NET-COST-AMT         23980007
                                      - MLSVE-RCPT-NET-COST-AMT         23990007
               MOVE PV-WORK-AMOUNT    TO OUTPT-RCPT-NET-COST-AMT        24000007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24010007
           END-IF.                                                      24020007
                                                                        24030007
      *** APPLY ANY REMAINING ML254-RCPT-GRO-COST-AMT                   24040007
           IF MLSVE-RCPT-GRO-COST-AMT EQUAL PSAVE-RCPT-GRO-COST-AMT     24050007
               MOVE ZEROS             TO OUTPT-RCPT-GRO-COST-AMT        24060007
           ELSE                                                         24070007
               COMPUTE PV-WORK-AMOUNT = PSAVE-RCPT-GRO-COST-AMT         24080007
                                      - MLSVE-RCPT-GRO-COST-AMT         24090007
               MOVE PV-WORK-AMOUNT    TO OUTPT-RCPT-GRO-COST-AMT        24100007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24110007
           END-IF.                                                      24120007
                                                                        24130007
      *** APPLY ANY REMAINING ML254-RCPT-FRGT-COST-AMT                  24140007
           IF MLSVE-RCPT-FRGT-COST-AMT EQUAL PSAVE-RCPT-FRGT-COST-AMT   24150007
               MOVE ZEROS             TO OUTPT-RCPT-FRGT-COST-AMT       24160007
           ELSE                                                         24170007
               COMPUTE PV-WORK-AMOUNT = PSAVE-RCPT-FRGT-COST-AMT        24180007
                                      - MLSVE-RCPT-FRGT-COST-AMT        24190007
               MOVE PV-WORK-AMOUNT    TO OUTPT-RCPT-FRGT-COST-AMT       24200007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24210007
           END-IF.                                                      24220007
                                                                        24230007
      *** APPLY ANY REMAINING ML254-PADJ-RTL-AMT                        24240007
           IF MLSVE-PADJ-RTL-AMT EQUAL PSAVE-PADJ-RTL-AMT               24250007
               MOVE ZEROS             TO OUTPT-PADJ-RTL-AMT             24260007
           ELSE                                                         24270007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-RTL-AMT              24280007
                                      - MLSVE-PADJ-RTL-AMT              24290007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-RTL-AMT             24300007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24310007
           END-IF.                                                      24320007
                                                                        24330007
      *** APPLY ANY REMAINING ML254-PADJ-FRGT-COST-AMT                  24340007
           IF MLSVE-PADJ-FRGT-COST-AMT EQUAL PSAVE-PADJ-FRGT-COST-AMT   24350007
               MOVE ZEROS             TO OUTPT-PADJ-FRGT-COST-AMT       24360007
           ELSE                                                         24370007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-FRGT-COST-AMT        24380007
                                      - MLSVE-PADJ-FRGT-COST-AMT        24390007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-FRGT-COST-AMT       24400007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24410007
           END-IF.                                                      24420007
                                                                        24430007
      *** APPLY ANY REMAINING ML254-PADJ-DISC-COST-AMT                  24440007
           IF MLSVE-PADJ-DISC-COST-AMT EQUAL PSAVE-PADJ-DISC-COST-AMT   24450007
               MOVE ZEROS             TO OUTPT-PADJ-DISC-COST-AMT       24460007
           ELSE                                                         24470007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-DISC-COST-AMT        24480007
                                      - MLSVE-PADJ-DISC-COST-AMT        24490007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-DISC-COST-AMT       24500007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24510007
           END-IF.                                                      24520007
                                                                        24530007
      *** APPLY ANY REMAINING ML254-PADJ-RTV-COST-AMT                   24540007
           IF MLSVE-PADJ-RTV-COST-AMT EQUAL PSAVE-PADJ-RTV-COST-AMT     24550007
               MOVE ZEROS             TO OUTPT-PADJ-RTV-COST-AMT        24560007
           ELSE                                                         24570007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-RTV-COST-AMT         24580007
                                      - MLSVE-PADJ-RTV-COST-AMT         24590007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-RTV-COST-AMT        24600007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24610007
           END-IF.                                                      24620007
                                                                        24630007
      *** APPLY ANY REMAINING ML254-PADJ-RTV-RTL-AMT                    24640007
           IF MLSVE-PADJ-RTV-RTL-AMT EQUAL PSAVE-PADJ-RTV-RTL-AMT       24650007
               MOVE ZEROS             TO OUTPT-PADJ-RTV-RTL-AMT         24660007
           ELSE                                                         24670007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-RTV-RTL-AMT          24680007
                                      - MLSVE-PADJ-RTV-RTL-AMT          24690007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-RTV-RTL-AMT         24700007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24710007
           END-IF.                                                      24720007
                                                                        24730007
      *** APPLY ANY REMAINING ML254-PADJ-DA-COST-AMT                    24740007
           IF MLSVE-PADJ-DA-COST-AMT EQUAL PSAVE-PADJ-DA-COST-AMT       24750007
               MOVE ZEROS             TO OUTPT-PADJ-DA-COST-AMT         24760007
           ELSE                                                         24770007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-DA-COST-AMT          24780007
                                      - MLSVE-PADJ-DA-COST-AMT          24790007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-DA-COST-AMT         24800007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24810007
           END-IF.                                                      24820007
                                                                        24830007
      *** APPLY ANY REMAINING ML254-PADJ-DA-RTL-AMT                     24840007
           IF MLSVE-PADJ-DA-RTL-AMT EQUAL PSAVE-PADJ-DA-RTL-AMT         24850007
               MOVE ZEROS             TO OUTPT-PADJ-DA-RTL-AMT          24860007
           ELSE                                                         24870007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-DA-RTL-AMT           24880007
                                      - MLSVE-PADJ-DA-RTL-AMT           24890007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-DA-RTL-AMT          24900007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             24910007
           END-IF.                                                      24920007
                                                                        24930007
      *** APPLY ANY REMAINING ML254-PADJ-NET-COST-AMT                   24940007
           IF MLSVE-PADJ-NET-COST-AMT EQUAL PSAVE-PADJ-NET-COST-AMT     24950007
               MOVE ZEROS             TO OUTPT-PADJ-NET-COST-AMT        24960007
           ELSE                                                         24970007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-NET-COST-AMT         24980007
                                      - MLSVE-PADJ-NET-COST-AMT         24990007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-NET-COST-AMT        25000007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25010007
           END-IF.                                                      25020007
                                                                        25030007
      *** APPLY ANY REMAINING ML254-PADJ-OTH-COST-AMT                   25040007
           IF MLSVE-PADJ-OTH-COST-AMT EQUAL PSAVE-PADJ-OTH-COST-AMT     25050007
               MOVE ZEROS             TO OUTPT-PADJ-OTH-COST-AMT        25060007
           ELSE                                                         25070007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-OTH-COST-AMT         25080007
                                      - MLSVE-PADJ-OTH-COST-AMT         25090007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-OTH-COST-AMT        25100007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25110007
           END-IF.                                                      25120007
                                                                        25130007
      *** APPLY ANY REMAINING ML254-PADJ-OTH-RTL-AMT                    25140007
           IF MLSVE-PADJ-OTH-RTL-AMT EQUAL PSAVE-PADJ-OTH-RTL-AMT       25150007
               MOVE ZEROS             TO OUTPT-PADJ-OTH-RTL-AMT         25160007
           ELSE                                                         25170007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-OTH-RTL-AMT          25180007
                                      - MLSVE-PADJ-OTH-RTL-AMT          25190007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-OTH-RTL-AMT         25200007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25210007
           END-IF.                                                      25220007
                                                                        25230007
      *** APPLY ANY REMAINING ML254-PADJ-GRO-COST-AMT                   25240007
           IF MLSVE-PADJ-GRO-COST-AMT EQUAL PSAVE-PADJ-GRO-COST-AMT     25250007
               MOVE ZEROS             TO OUTPT-PADJ-GRO-COST-AMT        25260007
           ELSE                                                         25270007
               COMPUTE PV-WORK-AMOUNT = PSAVE-PADJ-GRO-COST-AMT         25280007
                                      - MLSVE-PADJ-GRO-COST-AMT         25290007
               MOVE PV-WORK-AMOUNT    TO OUTPT-PADJ-GRO-COST-AMT        25300007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25310007
           END-IF.                                                      25320007
                                                                        25330007
      *** APPLY ANY REMAINING ML254-DR-ALW-RTL-AMT                      25340007
           IF MLSVE-DR-ALW-RTL-AMT EQUAL PSAVE-DR-ALW-RTL-AMT           25350007
               MOVE ZEROS             TO OUTPT-DR-ALW-RTL-AMT           25360007
           ELSE                                                         25370007
               COMPUTE PV-WORK-AMOUNT = PSAVE-DR-ALW-RTL-AMT            25380007
                                      - MLSVE-DR-ALW-RTL-AMT            25390007
               MOVE PV-WORK-AMOUNT    TO OUTPT-DR-ALW-RTL-AMT           25400007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25410007
           END-IF.                                                      25420007
                                                                        25430007
      *** APPLY ANY REMAINING ML254-RTV-RTL-AMT                         25440007
           IF MLSVE-RTV-RTL-AMT EQUAL PSAVE-RTV-RTL-AMT                 25450007
               MOVE ZEROS             TO OUTPT-RTV-RTL-AMT              25460007
           ELSE                                                         25470007
               COMPUTE PV-WORK-AMOUNT = PSAVE-RTV-RTL-AMT               25480007
                                      - MLSVE-RTV-RTL-AMT               25490007
               MOVE PV-WORK-AMOUNT    TO OUTPT-RTV-RTL-AMT              25500007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25510007
           END-IF.                                                      25520007
                                                                        25530007
      *** APPLY ANY REMAINING ML254-MKUP-INIT-AMT                       25540007
           IF MLSVE-MKUP-INIT-AMT EQUAL PSAVE-MKUP-INIT-AMT             25550007
               MOVE ZEROS             TO OUTPT-MKUP-INIT-AMT            25560007
           ELSE                                                         25570007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKUP-INIT-AMT             25580007
                                      - MLSVE-MKUP-INIT-AMT             25590007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKUP-INIT-AMT            25600007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25610007
           END-IF.                                                      25620007
                                                                        25630007
      *** APPLY ANY REMAINING ML254-MKUP-NET-AMT                        25640007
           IF MLSVE-MKUP-NET-AMT EQUAL PSAVE-MKUP-NET-AMT               25650007
               MOVE ZEROS             TO OUTPT-MKUP-NET-AMT             25660007
           ELSE                                                         25670007
               COMPUTE PV-WORK-AMOUNT = PSAVE-MKUP-NET-AMT              25680007
                                      - MLSVE-MKUP-NET-AMT              25690007
               MOVE PV-WORK-AMOUNT    TO OUTPT-MKUP-NET-AMT             25700007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25710007
           END-IF.                                                      25720007
                                                                        25730007
      *** APPLY ANY REMAINING ML254-INV-ADJ-RTL-AMT                     25740007
           IF MLSVE-INV-ADJ-RTL-AMT EQUAL PSAVE-INV-ADJ-RTL-AMT         25750007
               MOVE ZEROS             TO OUTPT-INV-ADJ-RTL-AMT          25760007
           ELSE                                                         25770007
               COMPUTE PV-WORK-AMOUNT = PSAVE-INV-ADJ-RTL-AMT           25780007
                                      - MLSVE-INV-ADJ-RTL-AMT           25790007
               MOVE PV-WORK-AMOUNT    TO OUTPT-INV-ADJ-RTL-AMT          25800007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25810007
           END-IF.                                                      25820007
                                                                        25830007
      *** APPLY ANY REMAINING ML254-ONORD-RTL-AMT                       25840007
           IF MLSVE-ONORD-RTL-AMT EQUAL PSAVE-ONORD-RTL-AMT             25850007
               MOVE ZEROS             TO OUTPT-ONORD-RTL-AMT            25860007
           ELSE                                                         25870007
               COMPUTE PV-WORK-AMOUNT = PSAVE-ONORD-RTL-AMT             25880007
                                      - MLSVE-ONORD-RTL-AMT             25890007
               MOVE PV-WORK-AMOUNT    TO OUTPT-ONORD-RTL-AMT            25900007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             25910007
           END-IF.                                                      25920007
                                                                        25930007
      *** APPLY ANY REMAINING ML254-ONORD-COST-AMT                      25940007
           IF MLSVE-ONORD-COST-AMT EQUAL PSAVE-ONORD-COST-AMT           25950007
               MOVE ZEROS             TO OUTPT-ONORD-COST-AMT           25960007
           ELSE                                                         25970007
               COMPUTE PV-WORK-AMOUNT = PSAVE-ONORD-COST-AMT            25980007
                                      - MLSVE-ONORD-COST-AMT            25990007
               MOVE PV-WORK-AMOUNT    TO OUTPT-ONORD-COST-AMT           26000007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26010007
           END-IF.                                                      26020007
                                                                        26030007
      *** APPLY ANY REMAINING ML254-SHNK-RTL-AMT                        26040007
           IF MLSVE-SHNK-RTL-AMT EQUAL PSAVE-SHNK-RTL-AMT               26050007
               MOVE ZEROS             TO OUTPT-SHNK-RTL-AMT             26060007
           ELSE                                                         26070007
               COMPUTE PV-WORK-AMOUNT = PSAVE-SHNK-RTL-AMT              26080007
                                      - MLSVE-SHNK-RTL-AMT              26090007
               MOVE PV-WORK-AMOUNT    TO OUTPT-SHNK-RTL-AMT             26100007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26110007
           END-IF.                                                      26120007
                                                                        26130007
      *** APPLY ANY REMAINING ML254-IN-TRNST-RTL-AMT                    26140007
           IF MLSVE-IN-TRNST-RTL-AMT EQUAL PSAVE-IN-TRNST-RTL-AMT       26150007
               MOVE ZEROS             TO OUTPT-IN-TRNST-RTL-AMT         26160007
           ELSE                                                         26170007
               COMPUTE PV-WORK-AMOUNT = PSAVE-IN-TRNST-RTL-AMT          26180007
                                      - MLSVE-IN-TRNST-RTL-AMT          26190007
               MOVE PV-WORK-AMOUNT    TO OUTPT-IN-TRNST-RTL-AMT         26200007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26210007
           END-IF.                                                      26220007
                                                                        26230007
      *** APPLY ANY REMAINING ML254-END-INV-RTL-AMT                     26240007
           IF MLSVE-END-INV-RTL-AMT EQUAL PSAVE-END-INV-RTL-AMT         26250007
               MOVE ZEROS             TO OUTPT-END-INV-RTL-AMT          26260007
           ELSE                                                         26270007
               COMPUTE PV-WORK-AMOUNT = PSAVE-END-INV-RTL-AMT           26280007
                                      - MLSVE-END-INV-RTL-AMT           26290007
               MOVE PV-WORK-AMOUNT    TO OUTPT-END-INV-RTL-AMT          26300007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26310007
           END-IF.                                                      26320007
                                                                        26330007
      *** APPLY ANY REMAINING ML254-END-INV-COST-AMT                    26340007
           IF MLSVE-END-INV-COST-AMT EQUAL PSAVE-END-INV-COST-AMT       26350007
               MOVE ZEROS             TO OUTPT-END-INV-COST-AMT         26360007
           ELSE                                                         26370007
               COMPUTE PV-WORK-AMOUNT = PSAVE-END-INV-COST-AMT          26380007
                                      - MLSVE-END-INV-COST-AMT          26390007
               MOVE PV-WORK-AMOUNT    TO OUTPT-END-INV-COST-AMT         26400007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26410007
           END-IF.                                                      26420007
                                                                        26430007
      *** APPLY ANY REMAINING ML254-GRO-MRGN-AMT                        26440007
           IF MLSVE-GRO-MRGN-AMT EQUAL PSAVE-GRO-MRGN-AMT               26450007
               MOVE ZEROS             TO OUTPT-GRO-MRGN-AMT             26460007
           ELSE                                                         26470007
               COMPUTE PV-WORK-AMOUNT = PSAVE-GRO-MRGN-AMT              26480007
                                      - MLSVE-GRO-MRGN-AMT              26490007
               MOVE PV-WORK-AMOUNT    TO OUTPT-GRO-MRGN-AMT             26500007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26510007
           END-IF.                                                      26520007
                                                                        26530007
      *** APPLY ANY REMAINING ML254-RCPT-DISC-COST-AMT                  26540007
           IF MLSVE-RCPT-DISC-COST-AMT EQUAL PSAVE-RCPT-DISC-COST-AMT   26550007
               MOVE ZEROS             TO OUTPT-RCPT-DISC-COST-AMT       26560007
           ELSE                                                         26570007
               COMPUTE PV-WORK-AMOUNT = PSAVE-RCPT-DISC-COST-AMT        26580007
                                      - MLSVE-RCPT-DISC-COST-AMT        26590007
               MOVE PV-WORK-AMOUNT    TO OUTPT-RCPT-DISC-COST-AMT       26600007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26610007
           END-IF.                                                      26620007
                                                                        26630007
      *** APPLY ANY REMAINING ML254-STR-EXPTED-RTL-AMT                  26640007
           IF MLSVE-STR-EXPTED-RTL-AMT EQUAL PSAVE-STR-EXPTED-RTL-AMT   26650007
               MOVE ZEROS             TO OUTPT-STR-EXPTED-RTL-AMT       26660007
           ELSE                                                         26670007
               COMPUTE PV-WORK-AMOUNT = PSAVE-STR-EXPTED-RTL-AMT        26680007
                                      - MLSVE-STR-EXPTED-RTL-AMT        26690007
               MOVE PV-WORK-AMOUNT    TO OUTPT-STR-EXPTED-RTL-AMT       26700007
               MOVE 'Y'               TO PS-WRITE-ADJUST-SW             26710007
           END-IF.                                                      26720007
                                                                        26730007
      *** WRITE THE PRORATE RECORD...                                   26740007
           IF PS-WRITE-ADJUSTMENT                                       26750007
               INITIALIZE DL-KEY                                        26760007
               INITIALIZE DL-VERBIAGE                                   26770007
               MOVE '  >>REMAINDR:' TO DL-PRO-VERBIAGE                  26780015
               PERFORM 4300-BUILD-REPORT-PRORTED                        26790007
               PERFORM 7100-WRITE-EXTRACT-REC                           26800007
               ADD 1                TO PV-PRORATE-WRITTEN               26810007
           END-IF.                                                      26820007
                                                                        26830007
      ******************************************************************26840007
      * 6100-DBV-SUMMARY-RECORD.                                        26850007
      ******************************************************************26860007
       6100-DBV-SUMMARY-RECORD.                                         26870007
                                                                        26880007
           IF (NOT PS-INP02-COMPLETE)                                   26890007
               MOVE UDTLI-DEPT-NBR    TO PV-W2-DEPT-NBR                 26900007
               MOVE UDTLI-ENT-ID      TO PV-W2-ENT-ID                   26910007
               MOVE UDTLI-LBL-SEQ-NBR TO PV-W2-LBL-SEQ-NBR              26920007
               MOVE UDTLI-ML-LWST-ID  TO PV-W2-ML-LWST-ID               26930007
I49370         IF PV-W2-DEPT-NBR > PV-S2-DEPT-NBR  OR                   26940014
I49370            PV-W2-DEPT-NBR = PV-S2-DEPT-NBR                       26950014
I49370*****    IF PV-W2-SAVE-RECORD > PV-S2-WORK-RECORD OR              26951015
I49370*****       PV-W2-SAVE-RECORD = PV-S2-WORK-RECORD                 26952015
                   INITIALIZE PT-DBV-SUM-TABLE                          26960007
                   INITIALIZE PV-S2-WORK-RECORD                         26970007
                   MOVE 'N'            TO PS-DBV-SUM-LOADED-SW          26980007
                   MOVE 1              TO PV-DBV-COUNT                  26990007
                   MOVE 1              TO DBVI                          27000007
                   PERFORM 6200-PROCESS-DBV-SUM                         27010007
                      UNTIL PS-INP02-COMPLETE                           27020007
                         OR PS-DBV-SUM-LOADED                           27030007
               END-IF                                                   27040007
           END-IF.                                                      27050007
                                                                        27060007
      ******************************************************************27070007
      * 6200-PROCESS-DBV-SUM                                            27080007
      ******************************************************************27090007
       6200-PROCESS-DBV-SUM.                                            27100007
                                                                        27110007
           IF DBVI IS GREATER THAN PC-MAX-DBV-ROWS                      27120007
               DISPLAY '** ABEND ******************'                    27130007
               DISPLAY '*  6200-PROCESS-DBV-SUM '                       27140007
               DISPLAY '*  ROWS EXCEEDED MAX OF    ', PC-MAX-DBV-ROWS   27150007
               DISPLAY '***************************'                    27160007
               SET ABEND-4008-DATA-ERROR TO TRUE                        27170007
               PERFORM 9500-ABEND                                       27180007
           END-IF.                                                      27190007
                                                                        27200007
           IF UDBVI-DEPT-NBR = UDTLI-DEPT-NBR                           27210007
             IF P-DBV-DEPT-NBR (DBVI) EQUAL ZEROS    AND                27220007
                P-DBV-ENT-ID (DBVI) EQUAL ZEROS      AND                27230007
                P-DBV-LBL-SEQ-NBR (DBVI) EQUAL ZEROS AND                27240007
                P-DBV-ML-LWST-ID (DBVI) EQUAL ZEROS                     27250007
               MOVE UDBVI-DEPT-NBR    TO P-DBV-DEPT-NBR (DBVI)          27260007
               MOVE UDBVI-ENT-ID      TO P-DBV-ENT-ID (DBVI)            27270007
               MOVE UDBVI-LBL-SEQ-NBR TO P-DBV-LBL-SEQ-NBR (DBVI)       27280007
               MOVE UDBVI-ML-LWST-ID  TO P-DBV-ML-LWST-ID (DBVI)        27290007
               MOVE UDBVI-SLS-REG-RTL-AMT                               27300007
                               TO P-DBV-SLS-REG-RTL-AMT (DBVI)          27310007
               MOVE UDBVI-SLS-PROMO-RTL-AMT                             27320007
                               TO P-DBV-SLS-PROMO-RTL-AMT (DBVI)        27330007
               MOVE UDBVI-SLS-PROCLR-RTL-AMT                            27340007
                               TO P-DBV-SLS-PROCLR-RTL-AMT (DBVI)       27350007
               MOVE UDBVI-SLS-CLR-RTL-AMT                               27360007
                               TO P-DBV-SLS-CLR-RTL-AMT (DBVI)          27370007
               MOVE UDBVI-SLS-OTH-RTL-AMT                               27380007
                               TO P-DBV-SLS-OTH-RTL-AMT (DBVI)          27390007
               MOVE UDBVI-MKDN-PLU-RTL-AMT                              27400007
                               TO P-DBV-MKDN-PLU-RTL-AMT (DBVI)         27410007
               MOVE UDBVI-MKDN-PROMO-RTL-AMT                            27420007
                               TO P-DBV-MKDN-PROMO-RTL-AMT (DBVI)       27430007
               MOVE UDBVI-MKDN-RGST-RTL-AMT                             27440007
                               TO P-DBV-MKDN-RGST-RTL-AMT (DBVI)        27450007
               MOVE UDBVI-MKDN-GLDST-RTL-AMT                            27460007
                               TO P-DBV-MKDN-GLDST-RTL-AMT (DBVI)       27470007
               MOVE UDBVI-MKDN-UMTCH-RTL-AMT                            27480007
                               TO P-DBV-MKDN-UMTCH-RTL-AMT (DBVI)       27490007
               MOVE UDBVI-MKDN-BYR-RTL-AMT                              27500007
                               TO P-DBV-MKDN-BYR-RTL-AMT (DBVI)         27510007
               MOVE UDBVI-MKDN-STR-RTL-AMT                              27520007
                               TO P-DBV-MKDN-STR-RTL-AMT (DBVI)         27530007
               MOVE UDBVI-MKDN-PRPT-RTL-AMT                             27540007
                               TO P-DBV-MKDN-PRPT-RTL-AMT (DBVI)        27550007
               MOVE UDBVI-MKDN-OTH-RTL-AMT                              27560007
                               TO P-DBV-MKDN-OTH-RTL-AMT (DBVI)         27570007
               MOVE UDBVI-MKDN-RTL-AMT                                  27580007
                               TO P-DBV-MKDN-RTL-AMT (DBVI)             27590007
               MOVE UDBVI-MKUP-RTL-AMT                                  27600007
                               TO P-DBV-MKUP-RTL-AMT (DBVI)             27610007
               MOVE UDBVI-XFER-IN-RTL-AMT                               27620007
                               TO P-DBV-XFER-IN-RTL-AMT (DBVI)          27630007
               MOVE UDBVI-XFER-OUT-RTL-AMT                              27640007
                               TO P-DBV-XFER-OUT-RTL-AMT (DBVI)         27650007
               MOVE UDBVI-RCPT-RTL-AMT                                  27660007
                               TO P-DBV-RCPT-RTL-AMT (DBVI)             27670007
               MOVE UDBVI-RCPT-NET-COST-AMT                             27680007
                               TO P-DBV-RCPT-NET-COST-AMT (DBVI)        27690007
               MOVE UDBVI-RCPT-GRO-COST-AMT                             27700007
                               TO P-DBV-RCPT-GRO-COST-AMT (DBVI)        27710007
               MOVE UDBVI-RCPT-FRGT-COST-AMT                            27720007
                               TO P-DBV-RCPT-FRGT-COST-AMT (DBVI)       27730007
               MOVE UDBVI-PADJ-RTL-AMT                                  27740007
                               TO P-DBV-PADJ-RTL-AMT (DBVI)             27750007
               MOVE UDBVI-PADJ-FRGT-COST-AMT                            27760007
                               TO P-DBV-PADJ-FRGT-COST-AMT (DBVI)       27770007
               MOVE UDBVI-PADJ-DISC-COST-AMT                            27780007
                               TO P-DBV-PADJ-DISC-COST-AMT (DBVI)       27790007
               MOVE UDBVI-PADJ-RTV-COST-AMT                             27800007
                               TO P-DBV-PADJ-RTV-COST-AMT (DBVI)        27810007
               MOVE UDBVI-PADJ-RTV-RTL-AMT                              27820007
                               TO P-DBV-PADJ-RTV-RTL-AMT (DBVI)         27830007
               MOVE UDBVI-PADJ-DA-COST-AMT                              27840007
                               TO P-DBV-PADJ-DA-COST-AMT (DBVI)         27850007
               MOVE UDBVI-PADJ-DA-RTL-AMT                               27860007
                               TO P-DBV-PADJ-DA-RTL-AMT (DBVI)          27870007
               MOVE UDBVI-PADJ-NET-COST-AMT                             27880007
                               TO P-DBV-PADJ-NET-COST-AMT (DBVI)        27890007
               MOVE UDBVI-PADJ-OTH-COST-AMT                             27900007
                               TO P-DBV-PADJ-OTH-COST-AMT (DBVI)        27910007
               MOVE UDBVI-PADJ-OTH-RTL-AMT                              27920007
                               TO P-DBV-PADJ-OTH-RTL-AMT (DBVI)         27930007
               MOVE UDBVI-PADJ-GRO-COST-AMT                             27940007
                               TO P-DBV-PADJ-GRO-COST-AMT (DBVI)        27950007
               MOVE UDBVI-DR-ALW-RTL-AMT                                27960007
                               TO P-DBV-DR-ALW-RTL-AMT (DBVI)           27970007
               MOVE UDBVI-RTV-RTL-AMT                                   27980007
                               TO P-DBV-RTV-RTL-AMT (DBVI)              27990007
               MOVE UDBVI-MKUP-INIT-AMT                                 28000007
                               TO P-DBV-MKUP-INIT-AMT (DBVI)            28010007
               MOVE UDBVI-MKUP-NET-AMT                                  28020007
                               TO P-DBV-MKUP-NET-AMT (DBVI)             28030007
               MOVE UDBVI-INV-ADJ-RTL-AMT                               28040007
                               TO P-DBV-INV-ADJ-RTL-AMT (DBVI)          28050007
               MOVE UDBVI-ONORD-RTL-AMT                                 28060007
                               TO P-DBV-ONORD-RTL-AMT (DBVI)            28070007
               MOVE UDBVI-ONORD-COST-AMT                                28080007
                               TO P-DBV-ONORD-COST-AMT (DBVI)           28090007
               MOVE UDBVI-SHNK-RTL-AMT                                  28100007
                               TO P-DBV-SHNK-RTL-AMT (DBVI)             28110007
               MOVE UDBVI-END-INV-RTL-AMT                               28120007
                               TO P-DBV-END-INV-RTL-AMT (DBVI)          28130007
               MOVE UDBVI-END-INV-COST-AMT                              28140007
                               TO P-DBV-END-INV-COST-AMT (DBVI)         28150007
               MOVE UDBVI-GRO-MRGN-AMT                                  28160007
                               TO P-DBV-GRO-MRGN-AMT (DBVI)             28170007
               MOVE UDBVI-IN-TRNST-RTL-AMT                              28180007
                               TO P-DBV-IN-TRNST-RTL-AMT (DBVI)         28190007
               MOVE UDBVI-RCPT-DISC-COST-AMT                            28200007
                               TO P-DBV-RCPT-DISC-COST-AMT (DBVI)       28210007
               MOVE UDBVI-STR-EXPTED-RTL-AMT                            28220007
                               TO P-DBV-STR-EXPTED-RTL-AMT (DBVI)       28230007
               PERFORM 7200-READ-DBV-SUM-IN                             28240007
               ADD 1           TO PV-DBV-COUNT                          28250007
             ELSE                                                       28260007
               ADD 1           TO DBVI                                  28270007
               GO TO 6200-PROCESS-DBV-SUM                               28280007
             END-IF                                                     28290007
           ELSE                                                         28300007
           IF UDBVI-DEPT-NBR > UDTLI-DEPT-NBR                           28310007
               MOVE UDBVI-DEPT-NBR    TO PV-S2-DEPT-NBR                 28320007
               MOVE UDBVI-ENT-ID      TO PV-S2-ENT-ID                   28330007
               MOVE UDBVI-LBL-SEQ-NBR TO PV-S2-LBL-SEQ-NBR              28340007
               MOVE UDBVI-ML-LWST-ID  TO PV-S2-ML-LWST-ID               28350007
               MOVE 'Y'        TO PS-DBV-SUM-LOADED-SW                  28360007
               ADD 1           TO PV-DBV-COUNT                          28370007
           ELSE                                                         28380007
               PERFORM 7200-READ-DBV-SUM-IN                             28390007
           END-IF.                                                      28400007
                                                                        28410007
      ******************************************************************28420007
      * 6300-LOAD-DPT-TOT                                               28430007
      ******************************************************************28440007
       6300-LOAD-DPT-TOT.                                               28450007
                                                                        28460007
           IF DPTI IS GREATER THAN PC-MAX-DPT-ROWS                      28470007
               DISPLAY '** ABEND ******************'                    28480007
               DISPLAY '*  6300-LOAD-DPT-TOT    '                       28490007
               DISPLAY '*  ROWS EXCEEDED MAX OF    ', PC-MAX-DPT-ROWS   28500007
               DISPLAY '***************************'                    28510007
               SET ABEND-4008-DATA-ERROR TO TRUE                        28520007
               PERFORM 9500-ABEND                                       28530007
           END-IF.                                                      28540007
                                                                        28550007
           MOVE UDPTI-DEPT-NBR        TO P-DPT-DEPT-NBR (DPTI)          28560007
           MOVE UDPTI-ENT-ID          TO P-DPT-ENT-ID   (DPTI)          28570007
           MOVE UDPTI-SLS-REG-RTL-AMT TO P-DPT-SLS-REG-RTL-AMT (DPTI)   28580007
           MOVE UDPTI-SLS-PROMO-RTL-AMT                                 28590007
                           TO P-DPT-SLS-PROMO-RTL-AMT (DPTI)            28600007
           MOVE UDPTI-SLS-PROCLR-RTL-AMT                                28610007
                           TO P-DPT-SLS-PROCLR-RTL-AMT (DPTI)           28620007
           MOVE UDPTI-SLS-CLR-RTL-AMT                                   28630007
                           TO P-DPT-SLS-CLR-RTL-AMT (DPTI)              28640007
           MOVE UDPTI-SLS-OTH-RTL-AMT                                   28650007
                        TO P-DPT-SLS-OTH-RTL-AMT (DPTI)                 28660007
           MOVE UDPTI-MKDN-PLU-RTL-AMT                                  28670007
                        TO P-DPT-MKDN-PLU-RTL-AMT (DPTI)                28680007
           MOVE UDPTI-MKDN-PROMO-RTL-AMT                                28690007
                        TO P-DPT-MKDN-PROMO-RTL-AMT (DPTI)              28700007
           MOVE UDPTI-MKDN-RGST-RTL-AMT                                 28710007
                        TO P-DPT-MKDN-RGST-RTL-AMT (DPTI)               28720007
           MOVE UDPTI-MKDN-GLDST-RTL-AMT                                28730007
                        TO P-DPT-MKDN-GLDST-RTL-AMT (DPTI)              28740007
           MOVE UDPTI-MKDN-UMTCH-RTL-AMT                                28750007
                        TO P-DPT-MKDN-UMTCH-RTL-AMT (DPTI)              28760007
           MOVE UDPTI-MKDN-BYR-RTL-AMT                                  28770007
                        TO P-DPT-MKDN-BYR-RTL-AMT (DPTI)                28780007
           MOVE UDPTI-MKDN-STR-RTL-AMT                                  28790007
                        TO P-DPT-MKDN-STR-RTL-AMT (DPTI)                28800007
           MOVE UDPTI-MKDN-PRPT-RTL-AMT                                 28810007
                        TO P-DPT-MKDN-PRPT-RTL-AMT (DPTI)               28820007
           MOVE UDPTI-MKDN-OTH-RTL-AMT                                  28830007
                        TO P-DPT-MKDN-OTH-RTL-AMT (DPTI)                28840007
           MOVE UDPTI-MKDN-RTL-AMT                                      28850007
                               TO P-DPT-MKDN-RTL-AMT (DPTI)             28860007
           MOVE UDPTI-MKUP-RTL-AMT                                      28870007
                               TO P-DPT-MKUP-RTL-AMT (DPTI)             28880007
           MOVE UDPTI-XFER-IN-RTL-AMT                                   28890007
                               TO P-DPT-XFER-IN-RTL-AMT (DPTI)          28900007
           MOVE UDPTI-XFER-OUT-RTL-AMT                                  28910007
                               TO P-DPT-XFER-OUT-RTL-AMT (DPTI)         28920007
           MOVE UDPTI-RCPT-RTL-AMT                                      28930007
                               TO P-DPT-RCPT-RTL-AMT (DPTI)             28940007
           MOVE UDPTI-RCPT-NET-COST-AMT                                 28950007
                               TO P-DPT-RCPT-NET-COST-AMT (DPTI)        28960007
           MOVE UDPTI-RCPT-GRO-COST-AMT                                 28970007
                               TO P-DPT-RCPT-GRO-COST-AMT (DPTI)        28980007
           MOVE UDPTI-RCPT-FRGT-COST-AMT                                28990007
                               TO P-DPT-RCPT-FRGT-COST-AMT (DPTI)       29000007
           MOVE UDPTI-PADJ-RTL-AMT TO P-DPT-PADJ-RTL-AMT (DPTI)         29010007
                                                                        29020007
           MOVE UDPTI-PADJ-FRGT-COST-AMT                                29030007
                               TO P-DPT-PADJ-FRGT-COST-AMT (DPTI)       29040007
           MOVE UDPTI-PADJ-DISC-COST-AMT                                29050007
                               TO P-DPT-PADJ-DISC-COST-AMT (DPTI)       29060007
           MOVE UDPTI-PADJ-RTV-COST-AMT                                 29070007
                               TO P-DPT-PADJ-RTV-COST-AMT (DPTI)        29080007
           MOVE UDPTI-PADJ-RTV-RTL-AMT                                  29090007
                               TO P-DPT-PADJ-RTV-RTL-AMT (DPTI)         29100007
           MOVE UDPTI-PADJ-DA-COST-AMT                                  29110007
                               TO P-DPT-PADJ-DA-COST-AMT (DPTI)         29120007
           MOVE UDPTI-PADJ-DA-RTL-AMT                                   29130007
                               TO P-DPT-PADJ-DA-RTL-AMT (DPTI)          29140007
           MOVE UDPTI-PADJ-NET-COST-AMT                                 29150007
                               TO P-DPT-PADJ-NET-COST-AMT (DPTI)        29160007
           MOVE UDPTI-PADJ-OTH-COST-AMT                                 29170007
                               TO P-DPT-PADJ-OTH-COST-AMT (DPTI)        29180007
           MOVE UDPTI-PADJ-OTH-RTL-AMT                                  29190007
                               TO P-DPT-PADJ-OTH-RTL-AMT (DPTI)         29200007
           MOVE UDPTI-PADJ-GRO-COST-AMT                                 29210007
                               TO P-DPT-PADJ-GRO-COST-AMT (DPTI)        29220007
           MOVE UDPTI-DR-ALW-RTL-AMT                                    29230007
                               TO P-DPT-DR-ALW-RTL-AMT (DPTI)           29240007
           MOVE UDPTI-RTV-RTL-AMT                                       29250007
                               TO P-DPT-RTV-RTL-AMT (DPTI)              29260007
           MOVE UDPTI-MKUP-INIT-AMT                                     29270007
                               TO P-DPT-MKUP-INIT-AMT (DPTI)            29280007
           MOVE UDPTI-MKUP-NET-AMT                                      29290007
                               TO P-DPT-MKUP-NET-AMT (DPTI)             29300007
           MOVE UDPTI-INV-ADJ-RTL-AMT                                   29310007
                               TO P-DPT-INV-ADJ-RTL-AMT (DPTI)          29320007
           MOVE UDPTI-ONORD-RTL-AMT                                     29330007
                               TO P-DPT-ONORD-RTL-AMT (DPTI)            29340007
           MOVE UDPTI-ONORD-COST-AMT                                    29350007
                               TO P-DPT-ONORD-COST-AMT (DPTI)           29360007
           MOVE UDPTI-SHNK-RTL-AMT                                      29370007
                               TO P-DPT-SHNK-RTL-AMT (DPTI)             29380007
           MOVE UDPTI-END-INV-RTL-AMT                                   29390007
                               TO P-DPT-END-INV-RTL-AMT (DPTI)          29400007
           MOVE UDPTI-END-INV-COST-AMT                                  29410007
                               TO P-DPT-END-INV-COST-AMT (DPTI)         29420007
           MOVE UDPTI-GRO-MRGN-AMT                                      29430007
                               TO P-DPT-GRO-MRGN-AMT (DPTI)             29440007
           MOVE UDPTI-IN-TRNST-RTL-AMT                                  29450007
                               TO P-DPT-IN-TRNST-RTL-AMT (DPTI)         29460007
           MOVE UDPTI-RCPT-DISC-COST-AMT                                29470007
                               TO P-DPT-RCPT-DISC-COST-AMT (DPTI)       29480007
           MOVE UDPTI-STR-EXPTED-RTL-AMT                                29490007
                               TO P-DPT-STR-EXPTED-RTL-AMT (DPTI)       29500007
                                                                        29510007
           PERFORM 7000-READ-DPT-TOT-IN.                                29520007
                                                                        29530007
           ADD 1                    TO PV-DPT-COUNT.                    29540007
                                                                        29550007
      ******************************************************************29560007
      * 6400-GET-DPT-TOT.                                               29570007
      ******************************************************************29580007
        6400-GET-DPT-TOT.                                               29590007
                                                                        29600007
           IF P-DPT-DEPT-NBR (DPTI) EQUAL ZEROS AND                     29610007
              P-DPT-ENT-ID (DPTI) EQUAL ZEROS                           29620007
               MOVE 'N'        TO PS-DPT-TBL-FOUND-SW                   29630007
               MOVE 9999999    TO DPTI                                  29640007
           ELSE                                                         29650007
           IF CC-MODE-KNOWN-UNKNOWN                      AND            29660007
              P-DPT-DEPT-NBR (DPTI) EQUAL UDTLI-DEPT-NBR AND            29670007
              P-DPT-ENT-ID (DPTI) EQUAL UDTLI-ENT-ID                    29680007
               INITIALIZE MLDPT-UPDATE-REC                              29690007
               MOVE P-DPT-DEPT-NBR (DPTI)                               29700007
                        TO   MLDPT-DEPT-NBR                             29710007
               MOVE P-DPT-ENT-ID (DPTI)                                 29720007
                        TO   MLDPT-ENT-ID                               29730007
               MOVE P-DPT-SLS-REG-RTL-AMT (DPTI)                        29740007
                         TO   MLDPT-SLS-REG-RTL-AMT                     29750007
               MOVE P-DPT-SLS-PROMO-RTL-AMT (DPTI)                      29760007
                         TO   MLDPT-SLS-PROMO-RTL-AMT                   29770007
               MOVE P-DPT-SLS-PROCLR-RTL-AMT (DPTI)                     29780007
                         TO   MLDPT-SLS-PROCLR-RTL-AMT                  29790007
               MOVE P-DPT-SLS-CLR-RTL-AMT (DPTI)                        29800007
                         TO   MLDPT-SLS-CLR-RTL-AMT                     29810007
               MOVE P-DPT-SLS-OTH-RTL-AMT (DPTI)                        29820007
                         TO   MLDPT-SLS-OTH-RTL-AMT                     29830007
               MOVE P-DPT-MKDN-PLU-RTL-AMT (DPTI)                       29840007
                         TO   MLDPT-MKDN-PLU-RTL-AMT                    29850007
               MOVE P-DPT-MKDN-PROMO-RTL-AMT (DPTI)                     29860007
                         TO   MLDPT-MKDN-PROMO-RTL-AMT                  29870007
               MOVE P-DPT-MKDN-RGST-RTL-AMT (DPTI)                      29880007
                         TO   MLDPT-MKDN-RGST-RTL-AMT                   29890007
               MOVE P-DPT-MKDN-GLDST-RTL-AMT (DPTI)                     29900007
                         TO   MLDPT-MKDN-GLDST-RTL-AMT                  29910007
               MOVE P-DPT-MKDN-UMTCH-RTL-AMT (DPTI)                     29920007
                         TO   MLDPT-MKDN-UMTCH-RTL-AMT                  29930007
               MOVE P-DPT-MKDN-BYR-RTL-AMT (DPTI)                       29940007
                         TO   MLDPT-MKDN-BYR-RTL-AMT                    29950007
               MOVE P-DPT-MKDN-STR-RTL-AMT (DPTI)                       29960007
                         TO   MLDPT-MKDN-STR-RTL-AMT                    29970007
               MOVE P-DPT-MKDN-PRPT-RTL-AMT (DPTI)                      29980007
                         TO   MLDPT-MKDN-PRPT-RTL-AMT                   29990007
               MOVE P-DPT-MKDN-OTH-RTL-AMT (DPTI)                       30000007
                         TO   MLDPT-MKDN-OTH-RTL-AMT                    30010007
               MOVE P-DPT-MKDN-RTL-AMT (DPTI)                           30020007
                         TO   MLDPT-MKDN-RTL-AMT                        30030007
               MOVE P-DPT-MKUP-RTL-AMT (DPTI)                           30040007
                         TO   MLDPT-MKUP-RTL-AMT                        30050007
               MOVE P-DPT-XFER-IN-RTL-AMT (DPTI)                        30060007
                         TO   MLDPT-XFER-IN-RTL-AMT                     30070007
               MOVE P-DPT-XFER-OUT-RTL-AMT (DPTI)                       30080007
                         TO   MLDPT-XFER-OUT-RTL-AMT                    30090007
               MOVE P-DPT-RCPT-RTL-AMT (DPTI)                           30100007
                         TO   MLDPT-RCPT-RTL-AMT                        30110007
               MOVE P-DPT-RCPT-NET-COST-AMT (DPTI)                      30120007
                         TO   MLDPT-RCPT-NET-COST-AMT                   30130007
               MOVE P-DPT-RCPT-GRO-COST-AMT (DPTI)                      30140007
                         TO   MLDPT-RCPT-GRO-COST-AMT                   30150007
               MOVE P-DPT-RCPT-FRGT-COST-AMT (DPTI)                     30160007
                         TO   MLDPT-RCPT-FRGT-COST-AMT                  30170007
               MOVE P-DPT-PADJ-RTL-AMT (DPTI)                           30180007
                         TO   MLDPT-PADJ-RTL-AMT                        30190007
               MOVE P-DPT-PADJ-FRGT-COST-AMT (DPTI)                     30200007
                         TO   MLDPT-PADJ-FRGT-COST-AMT                  30210007
               MOVE P-DPT-PADJ-DISC-COST-AMT (DPTI)                     30220007
                         TO   MLDPT-PADJ-DISC-COST-AMT                  30230007
               MOVE P-DPT-PADJ-RTV-COST-AMT (DPTI)                      30240007
                         TO   MLDPT-PADJ-RTV-COST-AMT                   30250007
               MOVE P-DPT-PADJ-RTV-RTL-AMT (DPTI)                       30260007
                         TO   MLDPT-PADJ-RTV-RTL-AMT                    30270007
               MOVE P-DPT-PADJ-DA-COST-AMT (DPTI)                       30280007
                         TO   MLDPT-PADJ-DA-COST-AMT                    30290007
               MOVE P-DPT-PADJ-DA-RTL-AMT (DPTI)                        30300007
                         TO   MLDPT-PADJ-DA-RTL-AMT                     30310007
               MOVE P-DPT-PADJ-NET-COST-AMT (DPTI)                      30320007
                         TO   MLDPT-PADJ-NET-COST-AMT                   30330007
               MOVE P-DPT-PADJ-OTH-COST-AMT (DPTI)                      30340007
                         TO   MLDPT-PADJ-OTH-COST-AMT                   30350007
               MOVE P-DPT-PADJ-OTH-RTL-AMT (DPTI)                       30360007
                         TO   MLDPT-PADJ-OTH-RTL-AMT                    30370007
               MOVE P-DPT-PADJ-GRO-COST-AMT (DPTI)                      30380007
                         TO   MLDPT-PADJ-GRO-COST-AMT                   30390007
               MOVE P-DPT-DR-ALW-RTL-AMT (DPTI)                         30400007
                         TO   MLDPT-DR-ALW-RTL-AMT                      30410007
               MOVE P-DPT-RTV-RTL-AMT (DPTI)                            30420007
                         TO   MLDPT-RTV-RTL-AMT                         30430007
               MOVE P-DPT-MKUP-INIT-AMT (DPTI)                          30440007
                         TO   MLDPT-MKUP-INIT-AMT                       30450007
               MOVE P-DPT-MKUP-NET-AMT (DPTI)                           30460007
                         TO   MLDPT-MKUP-NET-AMT                        30470007
               MOVE P-DPT-INV-ADJ-RTL-AMT (DPTI)                        30480007
                         TO   MLDPT-INV-ADJ-RTL-AMT                     30490007
               MOVE P-DPT-ONORD-RTL-AMT (DPTI)                          30500007
                         TO   MLDPT-ONORD-RTL-AMT                       30510007
               MOVE P-DPT-ONORD-COST-AMT (DPTI)                         30520007
                         TO   MLDPT-ONORD-COST-AMT                      30530007
               MOVE P-DPT-SHNK-RTL-AMT (DPTI)                           30540007
                         TO   MLDPT-SHNK-RTL-AMT                        30550007
               MOVE P-DPT-END-INV-RTL-AMT (DPTI)                        30560007
                         TO   MLDPT-END-INV-RTL-AMT                     30570007
               MOVE P-DPT-END-INV-COST-AMT (DPTI)                       30580007
                         TO   MLDPT-END-INV-COST-AMT                    30590007
               MOVE P-DPT-GRO-MRGN-AMT (DPTI)                           30600007
                         TO   MLDPT-GRO-MRGN-AMT                        30610007
               MOVE P-DPT-IN-TRNST-RTL-AMT (DPTI)                       30620007
                         TO   MLDPT-IN-TRNST-RTL-AMT                    30630007
               MOVE P-DPT-RCPT-DISC-COST-AMT (DPTI)                     30640007
                         TO   MLDPT-RCPT-DISC-COST-AMT                  30650007
               MOVE P-DPT-STR-EXPTED-RTL-AMT (DPTI)                     30660007
                         TO   MLDPT-STR-EXPTED-RTL-AMT                  30670007
               MOVE 'Y'        TO PS-DPT-TBL-FOUND-SW                   30680007
           ELSE                                                         30690007
           IF CC-MODE-UNKNOWN-UNKNOWN  AND                              30700007
              P-DPT-DEPT-NBR (DPTI) EQUAL UDTLI-DEPT-NBR                30710007
               INITIALIZE MLDPT-UPDATE-REC                              30720007
               MOVE P-DPT-DEPT-NBR (DPTI)                               30730007
                          TO MLDPT-DEPT-NBR                             30740007
               MOVE ZEROS TO MLDPT-ENT-ID                               30750007
               MOVE P-DPT-SLS-REG-RTL-AMT (DPTI)                        30760007
                         TO   MLDPT-SLS-REG-RTL-AMT                     30770007
               MOVE P-DPT-SLS-PROMO-RTL-AMT (DPTI)                      30780007
                         TO   MLDPT-SLS-PROMO-RTL-AMT                   30790007
               MOVE P-DPT-SLS-PROCLR-RTL-AMT (DPTI)                     30800007
                         TO   MLDPT-SLS-PROCLR-RTL-AMT                  30810007
               MOVE P-DPT-SLS-CLR-RTL-AMT (DPTI)                        30820007
                         TO   MLDPT-SLS-CLR-RTL-AMT                     30830007
               MOVE P-DPT-SLS-OTH-RTL-AMT (DPTI)                        30840007
                         TO   MLDPT-SLS-OTH-RTL-AMT                     30850007
               MOVE P-DPT-MKDN-PLU-RTL-AMT (DPTI)                       30860007
                         TO   MLDPT-MKDN-PLU-RTL-AMT                    30870007
               MOVE P-DPT-MKDN-PROMO-RTL-AMT (DPTI)                     30880007
                         TO   MLDPT-MKDN-PROMO-RTL-AMT                  30890007
               MOVE P-DPT-MKDN-RGST-RTL-AMT (DPTI)                      30900007
                         TO   MLDPT-MKDN-RGST-RTL-AMT                   30910007
               MOVE P-DPT-MKDN-GLDST-RTL-AMT (DPTI)                     30920007
                         TO   MLDPT-MKDN-GLDST-RTL-AMT                  30930007
               MOVE P-DPT-MKDN-UMTCH-RTL-AMT (DPTI)                     30940007
                         TO   MLDPT-MKDN-UMTCH-RTL-AMT                  30950007
               MOVE P-DPT-MKDN-BYR-RTL-AMT (DPTI)                       30960007
                         TO   MLDPT-MKDN-BYR-RTL-AMT                    30970007
               MOVE P-DPT-MKDN-STR-RTL-AMT (DPTI)                       30980007
                         TO   MLDPT-MKDN-STR-RTL-AMT                    30990007
               MOVE P-DPT-MKDN-PRPT-RTL-AMT (DPTI)                      31000007
                         TO   MLDPT-MKDN-PRPT-RTL-AMT                   31010007
               MOVE P-DPT-MKDN-OTH-RTL-AMT (DPTI)                       31020007
                         TO   MLDPT-MKDN-OTH-RTL-AMT                    31030007
               MOVE P-DPT-MKDN-RTL-AMT (DPTI)                           31040007
                         TO   MLDPT-MKDN-RTL-AMT                        31050007
               MOVE P-DPT-MKUP-RTL-AMT (DPTI)                           31060007
                         TO   MLDPT-MKUP-RTL-AMT                        31070007
               MOVE P-DPT-XFER-IN-RTL-AMT (DPTI)                        31080007
                         TO   MLDPT-XFER-IN-RTL-AMT                     31090007
               MOVE P-DPT-XFER-OUT-RTL-AMT (DPTI)                       31100007
                         TO   MLDPT-XFER-OUT-RTL-AMT                    31110007
               MOVE P-DPT-RCPT-RTL-AMT (DPTI)                           31120007
                         TO   MLDPT-RCPT-RTL-AMT                        31130007
               MOVE P-DPT-RCPT-NET-COST-AMT (DPTI)                      31140007
                         TO   MLDPT-RCPT-NET-COST-AMT                   31150007
               MOVE P-DPT-RCPT-GRO-COST-AMT (DPTI)                      31160007
                         TO   MLDPT-RCPT-GRO-COST-AMT                   31170007
               MOVE P-DPT-RCPT-FRGT-COST-AMT (DPTI)                     31180007
                         TO   MLDPT-RCPT-FRGT-COST-AMT                  31190007
               MOVE P-DPT-PADJ-RTL-AMT (DPTI)                           31200007
                         TO   MLDPT-PADJ-RTL-AMT                        31210007
               MOVE P-DPT-PADJ-FRGT-COST-AMT (DPTI)                     31220007
                         TO   MLDPT-PADJ-FRGT-COST-AMT                  31230007
               MOVE P-DPT-PADJ-DISC-COST-AMT (DPTI)                     31240007
                         TO   MLDPT-PADJ-DISC-COST-AMT                  31250007
               MOVE P-DPT-PADJ-RTV-COST-AMT (DPTI)                      31260007
                         TO   MLDPT-PADJ-RTV-COST-AMT                   31270007
               MOVE P-DPT-PADJ-RTV-RTL-AMT (DPTI)                       31280007
                         TO   MLDPT-PADJ-RTV-RTL-AMT                    31290007
               MOVE P-DPT-PADJ-DA-COST-AMT (DPTI)                       31300007
                         TO   MLDPT-PADJ-DA-COST-AMT                    31310007
               MOVE P-DPT-PADJ-DA-RTL-AMT (DPTI)                        31320007
                         TO   MLDPT-PADJ-DA-RTL-AMT                     31330007
               MOVE P-DPT-PADJ-NET-COST-AMT (DPTI)                      31340007
                         TO   MLDPT-PADJ-NET-COST-AMT                   31350007
               MOVE P-DPT-PADJ-OTH-COST-AMT (DPTI)                      31360007
                         TO   MLDPT-PADJ-OTH-COST-AMT                   31370007
               MOVE P-DPT-PADJ-OTH-RTL-AMT (DPTI)                       31380007
                         TO   MLDPT-PADJ-OTH-RTL-AMT                    31390007
               MOVE P-DPT-PADJ-GRO-COST-AMT (DPTI)                      31400007
                         TO   MLDPT-PADJ-GRO-COST-AMT                   31410007
               MOVE P-DPT-DR-ALW-RTL-AMT (DPTI)                         31420007
                         TO   MLDPT-DR-ALW-RTL-AMT                      31430007
               MOVE P-DPT-RTV-RTL-AMT (DPTI)                            31440007
                         TO   MLDPT-RTV-RTL-AMT                         31450007
               MOVE P-DPT-MKUP-INIT-AMT (DPTI)                          31460007
                         TO   MLDPT-MKUP-INIT-AMT                       31470007
               MOVE P-DPT-MKUP-NET-AMT (DPTI)                           31480007
                         TO   MLDPT-MKUP-NET-AMT                        31490007
               MOVE P-DPT-INV-ADJ-RTL-AMT (DPTI)                        31500007
                         TO   MLDPT-INV-ADJ-RTL-AMT                     31510007
               MOVE P-DPT-ONORD-RTL-AMT (DPTI)                          31520007
                         TO   MLDPT-ONORD-RTL-AMT                       31530007
               MOVE P-DPT-ONORD-COST-AMT (DPTI)                         31540007
                         TO   MLDPT-ONORD-COST-AMT                      31550007
               MOVE P-DPT-SHNK-RTL-AMT (DPTI)                           31560007
                         TO   MLDPT-SHNK-RTL-AMT                        31570007
               MOVE P-DPT-END-INV-RTL-AMT (DPTI)                        31580007
                         TO   MLDPT-END-INV-RTL-AMT                     31590007
               MOVE P-DPT-END-INV-COST-AMT (DPTI)                       31600007
                         TO   MLDPT-END-INV-COST-AMT                    31610007
               MOVE P-DPT-GRO-MRGN-AMT (DPTI)                           31620007
                         TO   MLDPT-GRO-MRGN-AMT                        31630007
               MOVE P-DPT-IN-TRNST-RTL-AMT (DPTI)                       31640007
                         TO   MLDPT-IN-TRNST-RTL-AMT                    31650007
               MOVE P-DPT-RCPT-DISC-COST-AMT (DPTI)                     31660007
                         TO   MLDPT-RCPT-DISC-COST-AMT                  31670007
               MOVE P-DPT-STR-EXPTED-RTL-AMT (DPTI)                     31680007
                         TO   MLDPT-STR-EXPTED-RTL-AMT                  31690007
               MOVE 'Y'        TO PS-DPT-TBL-FOUND-SW                   31700007
           END-IF.                                                      31710007
                                                                        31720007
      ***************************************************************** 31930007
      * 7000-READ-DPT-TOT-IN                                            31940007
      ***************************************************************** 31950007
       7000-READ-DPT-TOT-IN.                                            31960007
                                                                        31970007
           READ DTL-LDGR-DPT-TOT-IN NEXT                                31980007
               AT END      MOVE 'Y' TO PS-PROCESS-COMPLETE-SW           31990007
               NOT AT END  ADD 1 TO PV-DPT-READ-COUNT                   32000007
0422RM                     MOVE 'DPT'            TO DET-LOG-REC-TYPE            
0422RM                     MOVE UDPTI-UPDATE-REC TO DET-REC                     
0422RM                     PERFORM 7150-WRITE-LOG-REC                           
           END-READ.                                                    32010007
                                                                        32020007
      ******************************************************************32030007
      * 7100-WRITE-EXTRACT-REC.                                         32040007
      ******************************************************************32050007
       7100-WRITE-EXTRACT-REC.                                          32060007
                                                                        32070007
           WRITE OUTPT-UPDATE-REC.                                      32080007
           ADD 1                      TO PV-WRITE-RECS.                 32090007
                                                                        32100007
0422RM******************************************************************32030007
0422RM* 7150-WRITE-LOG-REC.                                             32040007
0422RM******************************************************************32050007
0422RM 7150-WRITE-LOG-REC.                                                      
0422RM                                                                  32070007
0422RM     WRITE DTL-AUDIT-LOG-RECORD  FROM DETAIL-LOG-RECORD.                  
0422RM     ADD 1                       TO PV-LOG-COUNT.                 32090007
      ***************************************************************** 32110007
      * 7200-READ-DBV-SUM-IN.                                           32120007
      ***************************************************************** 32130007
       7200-READ-DBV-SUM-IN.                                            32140007
                                                                        32150007
           READ DTL-LDGR-DBV-SUM-IN NEXT                                32160007
               AT END      MOVE 'Y' TO PS-INP02-COMPLETE-SW             32170007
               NOT AT END  ADD 1 TO PV-DBV-READ-COUNT                   32180007
0422RM                     MOVE 'DBV'            TO DET-LOG-REC-TYPE            
0422RM                     MOVE UDBVI-UPDATE-REC TO DET-REC                     
0422RM                     PERFORM 7150-WRITE-LOG-REC                           
           END-READ.                                                    32190007
                                                                        32200007
      ***************************************************************** 32210007
      * 7300-READ-UNKNOWN-DTL-IN.                                       32220007
      ***************************************************************** 32230007
       7300-READ-UNKNOWN-DTL-IN.                                        32240007
                                                                        32250007
           READ DTL-LDGR-UNKNOWN-DTL-IN NEXT                            32260007
               AT END      MOVE 'Y' TO PS-INP03-COMPLETE-SW             32270007
               NOT AT END  ADD 1 TO PV-DTL-LDGR-READ                    32280007
0422RM                     MOVE 'UKN'            TO DET-LOG-REC-TYPE            
0422RM                     MOVE UDTLI-UPDATE-REC TO DET-REC                     
0422RM                     PERFORM 7150-WRITE-LOG-REC                           
           END-READ.                                                    32290007
                                                                        32300007
      ***************************************************************** 32310007
      * 7400-READ-CONTROL-CARD.                                         32320007
      ***************************************************************** 32330007
       7400-READ-CONTROL-CARD.                                          32340007
                                                                        32350007
           READ CONTROL-CARD-IN NEXT                                    32360007
               INTO CC-CONTROL-CARD                                     32370007
               AT END      MOVE 'Y' TO PS-INP04-COMPLETE-SW             32380007
           END-READ.                                                    32390007
                                                                        32400007
      ******************************************************************        
      * 7500-READ-CNTL-DATE.                                                    
      ******************************************************************        
       7500-READ-CNTL-DATE.                                                     
                                                                                
           READ CNTL-DATE-FILE                                                  
               AT END                                                           
               MOVE 'Y' TO PS-INP05-COMPLETE-SW                                 
           END-READ.                                                            
                                                                                
      /*****************************************************************32410007
      * 9000-END-OF-JOB-TASKS. FINAL PROCESSING FOR THE PROGRAM.        32420007
      ******************************************************************32430007
       9000-END-OF-JOB-TASKS.                                           32440007
                                                                        32450007
           IF PV-DTL-LDGR-READ IS GREATER THAN ZEROS                    32460007
               PERFORM 5000-APPLY-ANY-REMAINDERS                        32470007
           END-IF.                                                      32480007
                                                                        32490007
           PERFORM 4600-BUILD-GRAND-TOTALS.                             32500007
                                                                        32510007
           DISPLAY '******************************************'.        32520007
           DISPLAY '** RECORD COUNT SUMMARY **'.                        32530007
                                                                        32540007
           MOVE PV-DTL-LDGR-READ        TO PV-DISPLAY-AMOUNT.           32550007
           DISPLAY '* READ - DETAIL LEDGER RECORDS : '                  32560007
                                           PV-DISPLAY-AMOUNT.           32570007
           MOVE PV-DBV-READ-COUNT       TO PV-DISPLAY-AMOUNT.           32580007
           DISPLAY '*        DBV LEVEL SUM RECORDS : '                  32590007
                                           PV-DISPLAY-AMOUNT.           32600007
           MOVE PV-DPT-READ-COUNT       TO PV-DISPLAY-AMOUNT.           32610007
           DISPLAY '*        DPT LEVEL SUM RECORDS : '                  32620007
                                           PV-DISPLAY-AMOUNT.           32630007
           MOVE PV-WRITE-RECS           TO PV-DISPLAY-AMOUNT.           32640007
           DISPLAY '* WRITE - TOTAL RECORDS WRITTEN: '                  32650007
                                           PV-DISPLAY-AMOUNT.           32660007
           MOVE PV-PRORATE-WRITTEN      TO PV-DISPLAY-AMOUNT.           32670007
           DISPLAY '*       - PRORATE RECS WRITTEN : '                  32680007
                                           PV-DISPLAY-AMOUNT.           32690007
           DISPLAY '******************************************'.        32700007
           MOVE PV-PRORATE-MKDN-AMOUNT  TO PV-DISPLAY-AMOUNT2.          32710007
           DISPLAY '* CNTL  - PRORATED MARKDOWNS $ : '                  32720007
                                           PV-DISPLAY-AMOUNT2.          32730007
           MOVE PV-PRORATE-MKUP-AMOUNT  TO PV-DISPLAY-AMOUNT2.          32740007
           DISPLAY '*       - PRORATED MARKUPS $   : '                  32750007
                                           PV-DISPLAY-AMOUNT2.          32760007
           DISPLAY '******************************************'.        32770007
0422RM     MOVE PV-LOG-COUNT            TO PV-DISPLAY-AMOUNT.                   
0422RM     DISPLAY '* WRITE - TOTAL LOG RECS WRITTEN : '                        
0422RM                                     PV-DISPLAY-AMOUNT.           32690007
                                                                        32780007
           DISPLAY ' '.                                                 32790007
W37965     DISPLAY '******************************************'.        32700007
W37965     DISPLAY 'NUMBER OF AUDIT RECORDS WRITTEN: '                  32720007
W37965                                     PV-AUDIT-RECS.               32730007
W37965     DISPLAY '******************************************'.        32770007
W37965     DISPLAY ' '.                                                 32790007
           DISPLAY '******************************************'.        32800007
           DISPLAY '*  END OF ' PC-PROGRAM-NAME                         32810007
           DISPLAY '******************************************'.        32820007
                                                                        32830007
           CLOSE DTL-LDGR-DPT-TOT-IN                                    32840007
                 DTL-LDGR-DBV-SUM-IN                                    32850007
                 DTL-LDGR-UNKNOWN-DTL-IN                                32860007
                 CONTROL-CARD-IN                                        32870007
                 DTL-LDGR-FILE-OUT                                      32880007
0422RM           DTL-AUDIT-LOG-FILE-OUT                                         
W37965           DTL-AUDIT-FILE-OUT                                     32880007
                 DTL-LDGR-PRORATE-RPT.                                  32890007
                                                                        32900007
      ******************************************************************32910007
      *  THIS ROUTINE FORCES AN ABEND                                   32920007
      ******************************************************************32930007
       9500-ABEND.                                                      32940007
                                                                        32950007
           CALL 'ILBOABN0'           USING ABEND-CODE.                  32960007
                                                                        32970007
