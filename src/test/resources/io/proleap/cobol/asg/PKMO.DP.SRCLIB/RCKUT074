000100*----------------------------*                                    00010003
000200 IDENTIFICATION DIVISION.                                         00020000
000210*----------------------------*                                    00021003
000400                                                                  00040000
000500 PROGRAM-ID.    RCKUT074.                                         00050000
000510                                                                  00051000
000600 AUTHOR.        JOHN HUTCHINSON.                                  00060000
000610                                                                  00061000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000710                                                                  00071000
000800 DATE-WRITTEN   4-23-2003.                                        00080000
000810                                                                  00081000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*--------------------------------------------------------------*  00110000
001200*  THIS PROGRAM WILL UPDATE THE EXTRACT FILE CREATED BY        *  00120000
001300*  RCKUT073, WITH THE DIVISION NUMBER & NAME, THE BUYER NUMBER *  00130013
001310*  AND NAME AND  FROM THE MBS TABLES.                          *  00131013
001321*--------------------------------------------------------------*  00132100
001330                                                                  00133000
001331                                                                  00133111
001332*----------------------------*                                    00133211
001350 ENVIRONMENT DIVISION.                                            00135000
001351*----------------------------*                                    00135103
001370                                                                  00137000
001380 CONFIGURATION SECTION.                                           00138000
001390                                                                  00139000
001400 SOURCE-COMPUTER.        IBM-3090.                                00140000
001500 OBJECT-COMPUTER.        IBM-3090.                                00150000
001600                                                                  00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800                                                                  00180000
001810                                                                  00181011
001900 FILE-CONTROL.                                                    00190000
002000                                                                  00200000
002100      SELECT EXTRACT-FILE-IN        ASSIGN TO INP01.              00210000
002101                                                                  00210100
002110      SELECT EXTRACT-FILE-OUT       ASSIGN TO OUT01.              00211000
002200                                                                  00220000
002201                                                                  00220100
002202*----------------------------*                                    00220203
002400 DATA DIVISION.                                                   00240000
002401*----------------------------*                                    00240103
002600                                                                  00260000
002700 FILE SECTION.                                                    00270000
002710                                                                  00271000
002800 FD  EXTRACT-FILE-IN                                              00280000
002900     LABEL RECORDS ARE STANDARD                                   00290000
003000     BLOCK CONTAINS 0 RECORDS                                     00300000
003100     RECORDING MODE IS F                                          00310000
003200     RECORD CONTAINS 400 CHARACTERS.                              00320017
003400                                                                  00340000
003500 01  EXTRACT-IN-RECORD           PIC  X(400).                     00350017
003600                                                                  00360000
003601                                                                  00360109
003610*-----------------------------------------------*                 00361009
003700                                                                  00370000
003701                                                                  00370109
003702 FD  EXTRACT-FILE-OUT                                             00370209
003703     LABEL RECORDS ARE STANDARD                                   00370309
003704     BLOCK CONTAINS 0 RECORDS                                     00370409
003705     RECORDING MODE IS F                                          00370509
003706     RECORD CONTAINS 400 CHARACTERS.                              00370618
003707                                                                  00370700
003708 01  EXTRACT-OUT-RECORD          PIC  X(400).                     00370818
003709                                                                  00370900
003710                                                                  00371000
003711*----------------------------*                                    00371103
003720 WORKING-STORAGE SECTION.                                         00372000
003721*----------------------------*                                    00372103
003740                                                                  00374000
003900 01  PC-PROGRAM-CONSTANTS.                                        00390019
004000     05  PC-SYSTEM-DATE            PIC  9(06)  VALUE ZERO.        00400023
004010     05  PC-01                     PIC  X(02)  VALUE '01'.        00401023
004020     05  PC-OPERCO-CDE             PIC  X(02)  VALUE '03'.        00402023
004100     05  PC-DPT                    PIC  X(03)  VALUE 'DPT'.       00410019
004200     05  PC-DMA                    PIC  X(03)  VALUE 'DMA'.       00420019
004300     05  PC-ANM                    PIC  X(03)  VALUE 'ANM'.       00430019
004400     05  PC-ANL                    PIC  X(03)  VALUE 'ANL'.       00440019
004501     05  PC-PROGRAM-NAME           PIC  X(08)  VALUE 'RCKUT074'.  00450123
004510     05  PC-NOT-FOUND              PIC  X(15)  VALUE              00451019
004520                                               '** NOT FOUND **'. 00452019
004530                                                                  00453000
004600 01  PV-PROGRAM-VARIABLES.                                        00460016
004601     05  PV-ABEND-CODE             PIC  9(04)  VALUE 0.           00460123
004610     05  PV-EXTENT-CFY-SLSRNK-NBR  PIC S9(04)  VALUE +0 COMP.     00461023
004620     05  PV-SQLCODE                PIC  Z(8)9-.                   00462023
004630     05  PV-DEPT                   PIC  X(03).                    00463023
006204     05  PV-CURRENT-DB2-DATE       PIC  X(10)  VALUE SPACE.       00620423
006205     05  PV-CURRENT-DB2-DATE-ONE   PIC  X(10)  VALUE SPACE.       00620523
006206     05  PV-DB2-TABLE-NAME         PIC  X(12)  VALUE SPACE.       00620623
006207     05  PV-ABEND-PARA-NAME        PIC  X(30)  VALUE SPACE.       00620723
006208     05  PV-ENTNME-ENT-NAME-DESC   PIC  X(30)  VALUE SPACE.       00620823
006209     05  PV-DB2-OPERATION-MSG-1    PIC  X(40)  VALUE SPACE.       00620923
006210                                                                  00621001
006211     05  PV-CURR-DATE-X.                                          00621119
006212         10  PV-CURRENT-DB2-CC     PIC  9(02)  VALUE 0.           00621219
006213         10  PV-CURRENT-DB2-YY     PIC  9(02)  VALUE 0.           00621319
006214         10  FILLER                PIC  X(01)  VALUE '-'.         00621419
006215         10  PV-CURRENT-DB2-MM     PIC  9(02)  VALUE 0.           00621519
006216         10  FILLER                PIC  X(01)  VALUE '-'.         00621619
006217         10  PV-CURRENT-DB2-DD     PIC  9(02)  VALUE 0.           00621719
006218                                                                  00621802
006219     05  PV-CURR-DATE              REDEFINES                      00621919
006220         PV-CURR-DATE-X            PIC  X(10).                    00622019
006221                                                                  00622101
006222     05  PV-CURRENT-DATE.                                         00622219
006223         10  PV-CURRENT-CC         PIC  9(02)  VALUE 0.           00622319
006224         10  PV-CURRENT-YY         PIC  9(02)  VALUE 0.           00622419
006225         10  PV-CURRENT-MM         PIC  9(02)  VALUE 0.           00622519
006226         10  PV-CURRENT-DD         PIC  9(02)  VALUE 0.           00622619
006229                                                                  00622900
006230     05  PV-DPT-NAME-SAVE          PIC  X(25)  VALUE SPACE.       00623019
006231     05  PV-GMM-SAVE               PIC  X(02)  VALUE SPACE.       00623119
006232     05  PV-GMM-NAME-SAVE          PIC  X(30)  VALUE SPACE.       00623219
006233     05  PV-DMM-SAVE               PIC  X(02)  VALUE SPACE.       00623319
006234     05  PV-DMM-NAME-SAVE          PIC  X(30)  VALUE SPACE.       00623419
006235     05  PV-BYR-SAVE               PIC  X(03)  VALUE SPACE.       00623519
006240     05  PV-BYR-NAME-SAVE          PIC  X(30)  VALUE SPACE.       00624019
006610                                                                  00661000
006700     05  PV-FIRST-NAME.                                           00670019
006800         10  PV-FIRST-NAME-BYTE    OCCURS 12 TIMES                00680019
006810                                   INDEXED BY FIRST-NAME-IDX      00681023
006900                                   PIC  X(01).                    00690019
006910                                                                  00691000
007000     05  PV-LAST-NAME.                                            00700019
007100         10  PV-LAST-NAME-BYTE     OCCURS 18 TIMES                00710019
007110                                   INDEXED BY LAST-NAME-IDX       00711023
007200                                   PIC  X(01).                    00720019
007210                                                                  00721000
007300     05  PV-NAME.                                                 00730019
007400         10  PV-NAME-BYTE          OCCURS 30 TIMES                00740019
007410                                   INDEXED BY FULL-NAME-IDX       00741023
007500                                   PIC  X(01).                    00750019
007510                                                                  00751000
008502 01  DK-DB-KEYS.                                                  00850211
008503     05  DK-DPT-NBR               PIC  X(03)  VALUE SPACE.        00850311
008504                                                                  00850400
008505 01  PS-PROGRAM-SWITCHES.                                         00850511
008513                                                                  00851300
008514     05  PS-END-OF-FILE-SW        PIC  X(01)  VALUE 'N'.          00851420
008515         88  PS-INPUT-EOF-YES                 VALUE 'Y'.          00851520
008516         88  PS-INPUT-EOF-NO                  VALUE 'N'.          00851620
008517                                                                  00851700
008518     05  PS-DPT-FOUND-SW          PIC  X(01)  VALUE SPACE.        00851820
008519         88  PS-DPT-FOUND-YES                 VALUE 'Y'.          00851920
008520         88  PS-DPT-FOUND-NO                  VALUE 'N'.          00852020
008524                                                                  00852400
008525 01  WS-CACL-FIELDS.                                              00852511
008540     05  WS-RECORDS-READS         PIC S9(07)  VALUE +0 COMP-3.    00854011
008560     05  WS-RECORDS-WRITTEN       PIC S9(07)  VALUE +0 COMP-3.    00856011
008570                                                                  00857001
008571                                                                  00857103
008572* -------------------------------------------------------------- *00857203
008573*    INPUT RECORD COPYBOOK.                                       00857303
008574* -------------------------------------------------------------- *00857403
008575                                                                  00857503
008576     COPY RCRD065.                                                00857614
008577                                                                  00857700
008578                                                                  00857810
008579* -------------------------------------------------------------- *00857910
008580*    DB2 MESSAGE AREAS                                            00858010
008581* -------------------------------------------------------------- *00858110
008582                                                                  00858210
008583     COPY DPWS004.                                                00858314
008584                                                                  00858410
008585                                                                  00858510
008586     EXEC SQL                                                     00858610
008587          INCLUDE SQLCA                                           00858710
008588     END-EXEC.                                                    00858810
008589                                                                  00858922
008590                                                                  00859022
008591* -------------------------------------------------------------- *00859122
008592*    DB2 DCLGEN FOR MERCHANDISE TABLE                            *00859222
008593* -------------------------------------------------------------- *00859322
008595                                                                  00859510
008596     EXEC SQL                                                     00859610
008597          INCLUDE TMDSEAR                                         00859710
008598     END-EXEC.                                                    00859810
008599                                                                  00859922
008600                                                                  00860022
008601* -------------------------------------------------------------- *00860122
008602*    DB2 DCLGEN FOR MERCHANDISE RESPONSIBILITY TABLE             *00860222
008603* -------------------------------------------------------------- *00860322
008605                                                                  00860510
008606     EXEC SQL                                                     00860610
008610          INCLUDE TRSPBAR                                         00861000
008700     END-EXEC.                                                    00870000
008710                                                                  00871002
008711                                                                  00871122
008712* -------------------------------------------------------------- *00871222
008713*    DB2 DCLGEN FOR COMPANY CONTROL TABLE                        *00871322
008714* -------------------------------------------------------------- *00871422
008715                                                                  00871503
008720     EXEC SQL                                                     00872002
008730          INCLUDE TCOCNTL                                         00873002
008740     END-EXEC.                                                    00874002
008750                                                                  00875015
008760                                                                  00876015
008770* -------------------------------------------------------------- *00877015
008780*    DB2 DCLGEN FOR TENTNME TABLE                                *00878015
008790* -------------------------------------------------------------- *00879015
008791                                                                  00879115
008792     EXEC SQL                                                     00879215
008793          INCLUDE TENTNME                                         00879315
008794     END-EXEC.                                                    00879415
008795                                                                  00879515
008796                                                                  00879615
008797* -------------------------------------------------------------- *00879715
008798*    DB2 DCLGEN FOR TEXTENT TABLE                                *00879815
008799* -------------------------------------------------------------- *00879915
008800                                                                  00880015
008810     EXEC SQL                                                     00881015
008820          INCLUDE TEXTENT                                         00882015
008830     END-EXEC.                                                    00883015
008900                                                                  00890000
010700                                                                  01070000
010800*------------------------*                                        01080002
010900 PROCEDURE DIVISION.                                              01090000
010910*------------------------*                                        01091002
011010                                                                  01101000
011100 0000-MAIN.                                                       01110000
011110                                                                  01111000
011200     PERFORM 1000-INITIALIZATION.                                 01120002
011210                                                                  01121000
011300     PERFORM 2000-PROCESS-INPUT-FILE                              01130000
011400       UNTIL PS-INPUT-EOF-YES.                                    01140020
011700                                                                  01170000
011800     CLOSE EXTRACT-FILE-IN                                        01180000
011900           EXTRACT-FILE-OUT.                                      01190000
012000                                                                  01200000
012200     DISPLAY 'NBR OF RECORDS READ    : ' WS-RECORDS-READS.        01220011
012210                                                                  01221000
012301     DISPLAY 'NBR OF RECORDS WRITTEN : ' WS-RECORDS-WRITTEN.      01230111
012302                                                                  01230200
012303                                                                  01230303
012304 PROGRAM-EXIT.                                                    01230403
012305                                                                  01230503
012306     GOBACK.                                                      01230603
012307                                                                  01230703
012308                                                                  01230803
012309* ------------------------------------------------------------- * 01230910
012310* ------------------------------------------------------------- * 01231010
012311                                                                  01231110
012312 1000-INITIALIZATION.                                             01231210
012313                                                                  01231310
012314     MOVE '1000-INITIALIZATION' TO PV-ABEND-PARA-NAME.            01231424
012315                                                                  01231524
012316     OPEN INPUT  EXTRACT-FILE-IN                                  01231610
012317          OUTPUT EXTRACT-FILE-OUT.                                01231710
012318                                                                  01231810
012319     ACCEPT PC-SYSTEM-DATE FROM DATE.                             01231910
012320                                                                  01232010
012321     EXEC SQL                                                     01232110
012322                                                                  01232210
012323         SELECT (CURRENT DATE - 1 DAY)                            01232310
012324               , CURRENT DATE                                     01232410
012325                                                                  01232510
012326           INTO  :PV-CURRENT-DB2-DATE-ONE                         01232610
012327               , :PV-CURRENT-DB2-DATE                             01232710
012328                                                                  01232810
012329         FROM  TCOCNTL                                            01232910
012330                                                                  01233010
012331         WHERE  OPER_UNT_ID = 90                                  01233110
012332                                                                  01233210
012333     END-EXEC.                                                    01233310
012334                                                                  01233410
012335                                                                  01233510
012336     EVALUATE SQLCODE                                             01233611
012337                                                                  01233710
012338       WHEN +0                                                    01233811
012339           MOVE PV-CURRENT-DB2-DATE  TO PV-CURR-DATE              01233910
012340           MOVE PV-CURRENT-DB2-CC    TO PV-CURRENT-CC             01234010
012341           MOVE PV-CURRENT-DB2-YY    TO PV-CURRENT-YY             01234110
012342           MOVE PV-CURRENT-DB2-MM    TO PV-CURRENT-MM             01234210
012343           MOVE PV-CURRENT-DB2-DD    TO PV-CURRENT-DD             01234310
012344                                                                  01234410
012345       WHEN OTHER                                                 01234510
012346           MOVE 'SET DATE   ' TO PV-DB2-OPERATION-MSG-1           01234624
012347           MOVE 'TCOCNTL'     TO PV-DB2-TABLE-NAME                01234724
012348           PERFORM 9998-SQL-ABEND                                 01234810
012349                                                                  01234910
012350     END-EVALUATE.                                                01235011
012360                                                                  01236000
014005                                                                  01400500
014006* ------------------------------------------------------------- * 01400612
014007* ------------------------------------------------------------- * 01400712
014009                                                                  01400900
014010 2000-PROCESS-INPUT-FILE.                                         01401000
014011                                                                  01401100
014012     INITIALIZE RC065-RCVR-EXTRACT-RECORD.                        01401200
014013                                                                  01401300
014014     READ EXTRACT-FILE-IN  INTO   RC065-RCVR-EXTRACT-RECORD       01401400
014015                                                                  01401500
014016        AT END                                                    01401600
014017           SET PS-INPUT-EOF-YES TO TRUE                           01401720
014018                                                                  01401800
014019        NOT AT END                                                01401900
014020          ADD  +1  TO WS-RECORDS-READS                            01402010
014021          PERFORM 2100-UPDATE-INPUT-FILE                          01402100
014022                                                                  01402200
014030     END-READ.                                                    01403000
014200                                                                  01420000
014210                                                                  01421000
014220* ------------------------------------------------------------- * 01422010
014230* ------------------------------------------------------------- * 01423010
014240                                                                  01424010
014300 2100-UPDATE-INPUT-FILE.                                          01430000
014351                                                                  01435101
014400     IF RC065-DEPT-NBR NOT = DK-DPT-NBR                           01440000
014500         MOVE RC065-DEPT-NBR TO DK-DPT-NBR                        01450000
014600         PERFORM 3100-GET-TMDSEAR-ROW                             01460010
014610         PERFORM 3000-EVALUATE-DEPT                               01461010
017700     ELSE                                                         01770009
017800         MOVE PV-GMM-SAVE       TO  RC065-GMM-NMBR                01780009
017900         MOVE PV-DMM-SAVE       TO  RC065-DMM-NMBR                01790009
018000         MOVE PV-BYR-SAVE       TO  RC065-BYR-NMBR                01800009
018100         MOVE PV-DPT-NAME-SAVE  TO  RC065-DEPT-DESC               01810009
018900         MOVE PV-GMM-NAME-SAVE  TO  RC065-GMM-NAME                01890009
019100         MOVE PV-DMM-NAME-SAVE  TO  RC065-DMM-NAME                01910009
019300         MOVE PV-BYR-NAME-SAVE  TO  RC065-BYR-NAME                01930009
019400     END-IF.                                                      01940009
019410                                                                  01941015
019420     PERFORM 3600-TENTNME-INFO.                                   01942015
019421                                                                  01942116
019430     PERFORM 3700-TEXTENT-INFO.                                   01943015
019440                                                                  01944015
019450     MOVE PV-ENTNME-ENT-NAME-DESC   TO  RC065-VEND-DESC.          01945015
019460     MOVE PV-EXTENT-CFY-SLSRNK-NBR  TO  RC065-CFY-SLSRNK-NBR.     01946015
019500                                                                  01950000
020300     WRITE EXTRACT-OUT-RECORD  FROM  RC065-RCVR-EXTRACT-RECORD.   02030009
020400                                                                  02040000
020500     ADD  +1  TO WS-RECORDS-WRITTEN.                              02050010
020510                                                                  02051010
020520                                                                  02052010
020530* ------------------------------------------------------------- * 02053010
020540* ------------------------------------------------------------- * 02054010
020550                                                                  02055010
020600 3000-EVALUATE-DEPT.                                              02060010
020601                                                                  02060110
020602     EVALUATE TRUE                                                02060210
020603                                                                  02060310
020604       WHEN PS-DPT-FOUND-YES                                      02060420
020605           MOVE MDSEAR-GMA-NBR  TO  RC065-GMM-NMBR                02060511
020606                                    PV-GMM-SAVE                   02060611
020607           MOVE MDSEAR-DMA-NBR  TO  RC065-DMM-NMBR                02060711
020608                                    PV-DMM-SAVE                   02060811
020609           MOVE MDSEAR-BYR-NBR  TO  RC065-BYR-NMBR                02060911
020610                                    PV-BYR-SAVE                   02061011
020611           MOVE MDSEAR-DESC     TO  RC065-DEPT-DESC               02061111
020612                                    PV-DPT-NAME-SAVE              02061211
020613           PERFORM 3200-GET-GMM-NAME                              02061310
020614           PERFORM 3300-GET-DMM-NAME                              02061410
020615           PERFORM 3400-GET-BYR-NAME                              02061510
020616                                                                  02061610
020617       WHEN PS-DPT-FOUND-NO                                       02061720
020618           MOVE ZEROS         TO  RC065-GMM-NMBR                  02061811
020619                                  RC065-DMM-NMBR                  02061911
020620                                  RC065-BYR-NMBR                  02062011
020621                                  PV-GMM-SAVE                     02062111
020622                                  PV-DMM-SAVE                     02062211
020623                                  PV-BYR-SAVE                     02062311
020624           MOVE PC-NOT-FOUND  TO  RC065-GMM-NAME                  02062411
020625                                  RC065-DMM-NAME                  02062511
020626                                  RC065-BYR-NAME                  02062611
020627                                  RC065-DEPT-DESC                 02062711
020628                                  PV-GMM-NAME-SAVE                02062811
020629                                  PV-DMM-NAME-SAVE                02062911
020630                                  PV-BYR-NAME-SAVE                02063011
020631                                  PV-DPT-NAME-SAVE                02063111
020632     END-EVALUATE.                                                02063210
020633                                                                  02063300
020634                                                                  02063400
020635* ------------------------------------------------------------- * 02063510
020636* ------------------------------------------------------------- * 02063610
020640                                                                  02064010
020700 3100-GET-TMDSEAR-ROW.                                            02070010
020710                                                                  02071000
020720     MOVE '3100-GET-TMDSEAR-ROW' TO PV-ABEND-PARA-NAME.           02072024
020730                                                                  02073024
020800     EXEC SQL                                                     02080000
020810                                                                  02081000
021000         SELECT  GMA_NBR                                          02100008
021100               , DMA_NBR                                          02110008
021200               , BYR_NBR                                          02120008
021300               , DEPT_NBR                                         02130008
021400               , MDSEAR_DESC                                      02140008
021410                                                                  02141000
021500           INTO  :MDSEAR-GMA-NBR                                  02150000
021600               , :MDSEAR-DMA-NBR                                  02160008
021700               , :MDSEAR-BYR-NBR                                  02170008
021800               , :MDSEAR-DEPT-NBR                                 02180008
021900               , :MDSEAR-DESC                                     02190008
021910                                                                  02191000
022000         FROM TMDSEAR                                             02200000
022010                                                                  02201000
022100         WHERE   DEPT_NBR    =  :DK-DPT-NBR                       02210008
022200            AND  OPERCO_NBR  =  :PC-OPERCO-CDE                    02220008
022300            AND  MDSELV_CDE  =  :PC-DPT                           02230008
022400            AND  STRT_DTE   <=  :PV-CURR-DATE                     02240008
022600            AND  END_DTE     >  :PV-CURR-DATE                     02260008
022610                                                                  02261000
022700     END-EXEC.                                                    02270000
022710                                                                  02271000
022711                                                                  02271103
022720     EVALUATE SQLCODE                                             02272009
022721                                                                  02272100
022730       WHEN +0                                                    02273009
022740           SET PS-DPT-FOUND-YES  TO TRUE                          02274020
022741                                                                  02274100
022750       WHEN +100                                                  02275009
022760           SET PS-DPT-FOUND-NO   TO TRUE                          02276020
022761                                                                  02276100
022770       WHEN OTHER                                                 02277000
022800           MOVE 'SELECT TMDSEAR ROW'     TO PV-DB2-OPERATION-MSG-102280000
022801           MOVE 'TMDSEAR'                TO PV-DB2-TABLE-NAME     02280100
022802           PERFORM 9998-SQL-ABEND                                 02280200
022803                                                                  02280300
022804     END-EVALUATE.                                                02280400
022948                                                                  02294800
023160                                                                  02316000
023161* ------------------------------------------------------------- * 02316110
023162* ------------------------------------------------------------- * 02316210
023163                                                                  02316310
023170 3200-GET-GMM-NAME.                                               02317010
023171                                                                  02317100
023172     MOVE '3200-GET-GMM-NAME' TO PV-ABEND-PARA-NAME.              02317224
023173                                                                  02317324
023180     EXEC SQL                                                     02318000
023181                                                                  02318100
023190         SELECT B.WORKER_FIR_NAME                                 02319000
023200              , B.WORKER_LAST_NAME                                02320000
023210                                                                  02321000
023300           INTO :RSPBAR-WORKER-FIR-NAME                           02330000
023400              , :RSPBAR-WORKER-LAST-NAME                          02340001
023410                                                                  02341000
023500         FROM TMDSEAR A                                           02350000
023600            , TRSPBAR B                                           02360011
023610                                                                  02361000
023700         WHERE A.OPERCO_NBR       = '03'                          02370000
023701           AND A.MDSELV_CDE       = 'GMA'                         02370100
023702           AND A.GMA_NBR          = :RC065-GMM-NMBR               02370200
023703           AND A.STRT_DTE        <= :PV-CURR-DATE                 02370302
023704           AND A.END_DTE          > :PV-CURR-DATE                 02370402
023705           AND A.MDSEAR_DKEY      = B.MDSEAR_DKEY                 02370500
023706           AND B.RSPLVL_CDE       = 'GMM'                         02370600
023707           AND B.WORKER_STRT_DTE <= :PV-CURR-DATE                 02370711
023708           AND B.WORKER_END_DTE   > :PV-CURR-DATE                 02370811
023709                                                                  02370900
023710     END-EXEC.                                                    02371000
023711                                                                  02371100
023712                                                                  02371200
023713     EVALUATE SQLCODE                                             02371309
023714                                                                  02371400
023720       WHEN +0                                                    02372009
023730           PERFORM 3500-STRING-RSPBAR-NAME                        02373010
023740           MOVE PV-NAME TO RC065-GMM-NAME                         02374013
023750                           PV-GMM-NAME-SAVE                       02375013
023751                                                                  02375100
023760       WHEN +100                                                  02376009
023770           MOVE SPACE   TO RC065-GMM-NAME                         02377013
023780                           PV-GMM-NAME-SAVE                       02378013
023781                                                                  02378100
023790       WHEN OTHER                                                 02379000
023803           MOVE 'SELECT TRSPBAR ROW'  TO PV-DB2-OPERATION-MSG-1   02380300
023804           MOVE 'TRSPBAR'             TO PV-DB2-TABLE-NAME        02380400
023805           PERFORM 9998-SQL-ABEND                                 02380500
023806                                                                  02380600
023807     END-EVALUATE.                                                02380700
023808                                                                  02380800
023810                                                                  02381000
023811* ------------------------------------------------------------- * 02381110
023812* ------------------------------------------------------------- * 02381210
023813                                                                  02381310
023814 3300-GET-DMM-NAME.                                               02381410
023815                                                                  02381500
023816     MOVE '3300-GET-DMM-NAME' TO PV-ABEND-PARA-NAME.              02381624
023817                                                                  02381724
023818     EXEC SQL                                                     02381800
023819                                                                  02381900
023820         SELECT B.WORKER_FIR_NAME                                 02382000
023821              , B.WORKER_LAST_NAME                                02382100
023822                                                                  02382200
023823           INTO :RSPBAR-WORKER-FIR-NAME                           02382300
023824              , :RSPBAR-WORKER-LAST-NAME                          02382400
023825                                                                  02382500
023826         FROM TMDSEAR A                                           02382600
023827            , TRSPBAR B                                           02382711
023828                                                                  02382800
023829         WHERE A.OPERCO_NBR        = '03'                         02382900
023830           AND A.MDSELV_CDE        = 'DMA'                        02383000
023831           AND A.DMA_NBR           = :RC065-DMM-NMBR              02383100
023832           AND A.STRT_DTE         <= :PV-CURR-DATE                02383202
023833           AND A.END_DTE           > :PV-CURR-DATE                02383302
023834           AND A.MDSEAR_DKEY       = B.MDSEAR_DKEY                02383400
023835           AND B.RSPLVL_CDE        = 'DMM'                        02383500
023836           AND B.WORKER_STRT_DTE  <= :PV-CURR-DATE                02383611
023837           AND B.WORKER_END_DTE    > :PV-CURR-DATE                02383711
023838     END-EXEC.                                                    02383800
023839                                                                  02383900
023840                                                                  02384000
023841     EVALUATE SQLCODE                                             02384109
023842                                                                  02384200
023843       WHEN +0                                                    02384309
023844           PERFORM 3500-STRING-RSPBAR-NAME                        02384410
023845           MOVE PV-NAME   TO RC065-DMM-NAME                       02384500
023846                             PV-DMM-NAME-SAVE                     02384600
023847                                                                  02384700
023848       WHEN +100                                                  02384809
023849           MOVE SPACE     TO RC065-DMM-NAME                       02384900
023850                             PV-DMM-NAME-SAVE                     02385000
023851                                                                  02385100
023852       WHEN OTHER                                                 02385200
023853           MOVE 'SELECT TRSPBAR ROW'  TO PV-DB2-OPERATION-MSG-1   02385300
023854           MOVE 'TRSPBAR'             TO PV-DB2-TABLE-NAME        02385400
023855           PERFORM 9998-SQL-ABEND                                 02385500
023856                                                                  02385600
023857     END-EVALUATE.                                                02385700
023858                                                                  02385800
023859                                                                  02385900
023860* ------------------------------------------------------------- * 02386010
023861* ------------------------------------------------------------- * 02386110
023862                                                                  02386210
023863 3400-GET-BYR-NAME.                                               02386310
023864                                                                  02386400
023865     MOVE '3400-GET-BYR-NAME '  TO PV-ABEND-PARA-NAME.            02386524
023866                                                                  02386624
023867     EXEC SQL                                                     02386700
023868                                                                  02386800
023869         SELECT B.WORKER_FIR_NAME                                 02386900
023870              , B.WORKER_LAST_NAME                                02387000
023871                                                                  02387100
023872           INTO :RSPBAR-WORKER-FIR-NAME                           02387200
023873              , :RSPBAR-WORKER-LAST-NAME                          02387300
023874                                                                  02387400
023875         FROM TMDSEAR A                                           02387500
023876            , TRSPBAR B                                           02387611
023877                                                                  02387700
023878         WHERE A.OPERCO_NBR        = '03'                         02387802
023879           AND A.MDSELV_CDE        = 'DPT'                        02387902
023880           AND A.DEPT_NBR          = :MDSEAR-DEPT-NBR             02388002
023881           AND A.STRT_DTE         <= :PV-CURR-DATE                02388102
023882           AND A.END_DTE          >= :PV-CURR-DATE                02388202
023883           AND A.MDSEAR_DKEY       =  B.MDSEAR_DKEY               02388311
023884           AND B.RSPLVL_CDE        = 'BYR'                        02388402
023885           AND B.WORKER_STRT_DTE  <= :PV-CURR-DATE                02388511
023886           AND B.WORKER_END_DTE    > :PV-CURR-DATE                02388611
023887                                                                  02388700
023888     END-EXEC.                                                    02388800
023889                                                                  02388900
023890                                                                  02389000
023891     EVALUATE SQLCODE                                             02389109
023892                                                                  02389200
023893       WHEN +0                                                    02389309
023894           PERFORM 3500-STRING-RSPBAR-NAME                        02389410
023895           MOVE PV-NAME  TO RC065-BYR-NAME                        02389519
023896                            PV-BYR-NAME-SAVE                      02389619
023897                                                                  02389700
023898       WHEN +100                                                  02389809
023899           MOVE SPACE    TO RC065-BYR-NAME                        02389919
023900                            PV-BYR-NAME-SAVE                      02390019
023901                                                                  02390100
023902       WHEN OTHER                                                 02390200
023903           MOVE 'SELECT TRSPBAR ROW'  TO PV-DB2-OPERATION-MSG-1   02390300
023904           MOVE 'TRSPBAR'             TO PV-DB2-TABLE-NAME        02390400
023905           PERFORM 9998-SQL-ABEND                                 02390500
023906                                                                  02390600
023907     END-EVALUATE.                                                02390700
026600                                                                  02660000
026601                                                                  02660100
026602* ------------------------------------------------------------- * 02660210
026603* ------------------------------------------------------------- * 02660310
026604                                                                  02660410
026605 3500-STRING-RSPBAR-NAME.                                         02660510
026606                                                                  02660600
026607     MOVE RSPBAR-WORKER-FIR-NAME  TO PV-FIRST-NAME.               02660700
026608     MOVE RSPBAR-WORKER-LAST-NAME TO PV-LAST-NAME.                02660800
026609                                                                  02660900
026610     INITIALIZE PV-NAME.                                          02661000
026611                                                                  02661100
026612     SET FULL-NAME-IDX TO 1.                                      02661223
026613                                                                  02661300
026614     PERFORM                                                      02661400
026615       VARYING FIRST-NAME-IDX FROM 1 BY 1                         02661523
026616         UNTIL FIRST-NAME-IDX > 12                                02661623
026617                                                                  02661711
026618         IF PV-FIRST-NAME-BYTE (FIRST-NAME-IDX) = SPACE           02661823
026619             SET FULL-NAME-IDX UP BY 1                            02661923
026620             SET FIRST-NAME-IDX TO 12                             02662023
026621         ELSE                                                     02662100
026623             MOVE PV-FIRST-NAME-BYTE (FIRST-NAME-IDX)             02662323
026624               TO PV-NAME-BYTE       (FULL-NAME-IDX)              02662423
026625             SET FULL-NAME-IDX UP BY 1                            02662523
026626         END-IF                                                   02662600
026627                                                                  02662711
026628     END-PERFORM.                                                 02662800
026629                                                                  02662900
026630     PERFORM                                                      02663000
026631       VARYING LAST-NAME-IDX FROM 1 BY 1                          02663123
026632         UNTIL LAST-NAME-IDX > 18                                 02663223
026633                                                                  02663311
026634         IF PV-LAST-NAME-BYTE (LAST-NAME-IDX) = SPACE             02663423
026635             SET LAST-NAME-IDX TO 18                              02663523
026636         ELSE                                                     02663600
026637             MOVE PV-LAST-NAME-BYTE (LAST-NAME-IDX)               02663723
026638               TO PV-NAME-BYTE      (FULL-NAME-IDX)               02663823
026639             SET FULL-NAME-IDX UP BY 1                            02663923
026640         END-IF                                                   02664000
026641                                                                  02664111
026642     END-PERFORM.                                                 02664200
026643                                                                  02664315
026644                                                                  02664415
026645*-----------------------------------------------------------------02664515
026646*    GET VENDOR DESCRIPTION FROM ENTITY NAME TABLE (TENTNME)      02664615
026647*-----------------------------------------------------------------02664715
026648                                                                  02664815
026649 3600-TENTNME-INFO.                                               02664915
026650                                                                  02665015
026651     MOVE '3600-TENTNME-INFO' TO PV-ABEND-PARA-NAME.              02665124
026652                                                                  02665215
026653     EXEC SQL                                                     02665315
026654                                                                  02665415
026655          SELECT ENT_ID                                           02665515
026656               , ENT_NAME_DESC                                    02665615
026657                                                                  02665715
026658          INTO :ENTNME-ENT-ID                                     02665815
026659             , :ENTNME-ENT-NAME-DESC                              02665915
026660                                                                  02666015
026661            FROM TENTNME                                          02666115
026662                                                                  02666215
026663          WHERE ENT_ID    =  :RC065-ENT-ID                        02666315
026664            AND TYPE_CDE  =  :PC-01                               02666415
026665                                                                  02666515
026666     END-EXEC.                                                    02666615
026667                                                                  02666715
026668                                                                  02666815
026669     EVALUATE SQLCODE                                             02666915
026670                                                                  02667015
026671       WHEN +0                                                    02667115
026672           MOVE ENTNME-ENT-NAME-DESC TO PV-ENTNME-ENT-NAME-DESC   02667215
026673                                                                  02667315
026674       WHEN +100                                                  02667415
026675           MOVE SPACES  TO PV-ENTNME-ENT-NAME-DESC                02667515
026676                                                                  02667615
026677       WHEN OTHER                                                 02667715
026679           MOVE 'SELECT TENTNME   ' TO PV-DB2-OPERATION-MSG-1     02667915
026680           MOVE 'TENTNME'           TO PV-DB2-TABLE-NAME          02668015
026681           PERFORM 9998-SQL-ABEND                                 02668115
026686                                                                  02668615
026687     END-EVALUATE.                                                02668715
026688                                                                  02668815
026689                                                                  02668915
026690*-----------------------------------------------------------------02669015
026691*    GET CFY SALES RANK NUMBER FROM TABLE (TEXTENT)               02669115
026692*-----------------------------------------------------------------02669215
026693                                                                  02669315
026694 3700-TEXTENT-INFO.                                               02669415
026695                                                                  02669515
026696     MOVE '3700-TEXTENT-INFO' TO PV-ABEND-PARA-NAME.              02669624
026697                                                                  02669715
026698     EXEC SQL                                                     02669815
026699                                                                  02669915
026700          SELECT ENT_ID                                           02670015
026701               , CFY_SLSRNK_NBR                                   02670115
026702                                                                  02670215
026703            INTO :EXTENT-ENT-ID                                   02670315
026704               , :EXTENT-CFY-SLSRNK-NBR                           02670415
026705                                                                  02670515
026706          FROM TEXTENT                                            02670615
026707                                                                  02670715
026708          WHERE ENT_ID  =  :RC065-ENT-ID                          02670815
026709                                                                  02670915
026710     END-EXEC.                                                    02671015
026711                                                                  02671115
026712                                                                  02671215
026713     EVALUATE SQLCODE                                             02671315
026714                                                                  02671415
026715       WHEN +0                                                    02671515
026716           MOVE EXTENT-CFY-SLSRNK-NBR TO PV-EXTENT-CFY-SLSRNK-NBR 02671615
026717                                                                  02671715
026718       WHEN +100                                                  02671815
026719           MOVE ZEROS TO PV-EXTENT-CFY-SLSRNK-NBR                 02671915
026720                                                                  02672015
026721       WHEN OTHER                                                 02672115
026727           MOVE 'SELECT TEXTENT   ' TO PV-DB2-OPERATION-MSG-1     02672715
026728           MOVE 'TEXTENT'           TO PV-DB2-TABLE-NAME          02672815
026730           PERFORM 9998-SQL-ABEND                                 02673015
026735                                                                  02673515
026736     END-EVALUATE.                                                02673615
026737                                                                  02673700
026738                                                                  02673800
026739* ------------------------------------------------------------- * 02673910
026740* ------------------------------------------------------------- * 02674010
026741                                                                  02674110
026742 9998-SQL-ABEND.                                                  02674200
026743                                                                  02674300
026744     MOVE SQLCODE TO PV-SQLCODE.                                  02674403
026745                                                                  02674500
026746     DISPLAY '** ABEND           ** = SQLABEND'.                  02674600
026747     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          02674700
026748     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME.       02674800
026749     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        02674900
026750     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   02675000
026751     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               02675100
026752                                                                  02675200
026753                                                                  02675311
026754     COPY DPPD004.                                                02675411
026755                                                                  02675511
026756     MOVE +4013 TO PV-ABEND-CODE.                                 02675611
026757                                                                  02675711
026758     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       02675811
026759                                                                  02675911
026760                                                                  02676011
026770* ----------------------------------------------------------------02677011
026800* ----------------------------------------------------------------02680003
