000010 IDENTIFICATION DIVISION.                                                 
000030 PROGRAM-ID.    MLKRP022.                                                 
000040 AUTHOR.        TESS BESTE.                                               
000050 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000060 DATE-WRITTEN.  04-18-94.                                                 
000070 DATE-COMPILED.                                                           
000080                                                                          
000090******************************************************************        
000100*           MLKRP022 - ACCUM SALES                                        
000110*                                                                         
000120* THIS PROGRAM ACCUMULATES THE SALES FROM A FILE OF SALES                 
000130* TRANSACTIONS IN THE MLRD022 FORMAT. THE TOTAL SALES IS                  
000140* DISPLAYED.                                                              
000150******************************************************************        
000160                                                                 *        
000170                                                                          
000180 ENVIRONMENT DIVISION.                                                    
000190                                                                          
000200 CONFIGURATION SECTION.                                                   
000210                                                                          
000220 SOURCE-COMPUTER.    IBM-3090.                                            
000230 OBJECT-COMPUTER.    IBM-3090.                                            
000240                                                                          
000250                                                                          
000260 INPUT-OUTPUT SECTION.                                                    
000270                                                                          
000280 FILE-CONTROL.                                                            
000290     SELECT SALES-FILE                                                    
000300         ASSIGN TO INP01.                                                 
000310                                                                          
000340 DATA DIVISION.                                                           
000350                                                                          
000360 FILE SECTION.                                                            
000370                                                                          
000380 FD  SALES-FILE                                                           
000390     LABEL RECORDS ARE STANDARD                                           
000400     BLOCK CONTAINS 0 RECORDS                                             
000410     RECORDING  MODE IS F.                                                
000420     COPY MLRD022.                                                        
000430                                                                          
000440 WORKING-STORAGE SECTION.                                                 
000450                                                                          
000460******************************************************************        
000470* SALE RECORD LAYOUT                                                      
000480******************************************************************        
000510                                                                          
000520 01  PS-PROGRAM-SWITCHES.                                                 
000530     05  PS-END-OF-SALES-FILE-SW      PIC X         VALUE 'N'.            
000540         88  PS-END-OF-SALES-FILE                   VALUE 'Y'.            
000550         88  PS-NOT-END-OF-SALES-FILE               VALUE 'N'.            
000560                                                                          
000570 01  PV-PROGRAM-VARIABLES.                                                
000580     05  PV-DISPLAY-SALES             PIC ZZZ,ZZZ,ZZZ,ZZZ.99-.            
000590     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZZ,ZZZ.                
000600     05  PV-ACCUM-SALES               PIC S9(13)V99 VALUE +0              
000610                                                    COMP-3.               
000620     05  PV-RECORD-COUNT              PIC S9(13)V99 VALUE +0              
000630                                                    COMP-3.               
000640 EJECT                                                                    
000650 PROCEDURE DIVISION.                                                      
000660                                                                          
000670                                                                          
000680 A100-PROGRAM-MAINLINE.                                                   
000690                                                                          
000700     OPEN INPUT SALES-FILE.                                               
000710     READ SALES-FILE NEXT                                                 
000720         AT END SET PS-END-OF-SALES-FILE TO TRUE.                         
000730                                                                          
000740     PERFORM UNTIL PS-END-OF-SALES-FILE                                   
000750         ADD +1 TO PV-RECORD-COUNT                                        
000760         ADD ML022-SALE-EXTD-RTL-AMT TO PV-ACCUM-SALES                    
000770         READ SALES-FILE NEXT                                             
000780             AT END SET PS-END-OF-SALES-FILE TO TRUE                      
000790         END-READ                                                         
000800     END-PERFORM.                                                         
000810                                                                          
000820     MOVE PV-RECORD-COUNT TO PV-DISPLAY-COUNT.                            
000830     MOVE PV-ACCUM-SALES  TO PV-DISPLAY-SALES.                            
000840     DISPLAY 'TRANSACTION COUNT: ' PV-DISPLAY-COUNT                       
000850             ' TOTAL SALES: ' PV-DISPLAY-SALES.                           
000860     CLOSE SALES-FILE.                                                    
000870                                                                          
000880     STOP RUN.                                                            
