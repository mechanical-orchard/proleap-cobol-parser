       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.    SDKUT171.                                         00030000
       AUTHOR.        KOHLS DEPARTMENT STORES.                          00040000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
       DATE-WRITTEN.  10/02/12.                                         00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ******************************************************************00090000
      *  EXTRACT OF DB2 TABLE SDT_WKLY_STR_ADJ FOR EDW                  00090106
      *     PAYROLL WEEKLY ADJUSTMENTS FOR 3 FISCAL MONTH WINDOW        00090233
      ******************************************************************00251000
                                                                        00260000
       ENVIRONMENT DIVISION.                                            00270000
       CONFIGURATION SECTION.                                           00280000
                                                                        00290000
       SOURCE-COMPUTER.  IBM-3090.                                      00300000
       OBJECT-COMPUTER.  IBM-3090.                                      00310000
                                                                        00320000
       INPUT-OUTPUT SECTION.                                            00330000
       FILE-CONTROL.                                                    00340000
                                                                        00350000
           SELECT EXTRACT-FILE ASSIGN TO OUT01.                         00360001
                                                                        00372013
       DATA DIVISION.                                                   00380000
       FILE SECTION.                                                    00390000
                                                                        00400000
       FD  EXTRACT-FILE                                                 00410001
           RECORDING MODE IS F                                          00420000
           LABEL RECORDS ARE STANDARD                                   00430000
           RECORD CONTAINS 80 CHARACTERS                                00442001
           BLOCK CONTAINS 0 RECORDS                                     00450000
           DATA RECORD IS EXTRACT-RECORD.                               00460001
                                                                        00470000
       01  EXTRACT-RECORD                      PIC X(80).               00482033
                                                                        00482113
      ******************************************************************00500000
      *                     WORKING STORAGE                             00510000
      ******************************************************************00520000
       WORKING-STORAGE SECTION.                                         00530000
                                                                        00540000
      ******************************************************************00580000
      * PS - PROGRAM SWITCHES                                           00590002
      ******************************************************************00600000
       01  PS-PROGRAM-SWITCHES.                                         00610002
           05  PS-END-OF-CSR-SW                PIC X  VALUE SPACE.      00620033
               88  PS-END-OF-CSR                      VALUE 'Y'.        00630033
               88  PS-NOT-END-OF-CSR                  VALUE 'N'.        00640033
           05  PS-VALID-WEEK-END-DTE-SW        PIC X  VALUE SPACE.      00641033
               88  PS-VALID-WEEK-END-DTE              VALUE 'Y'.        00642033
               88  PS-INVALID-WEEK-END-DTE            VALUE 'N'.        00643033
           05  PS-FOUND-ALL-VALID-WK-ENDS-SW   PIC X  VALUE SPACE.      00644033
               88  PS-FOUND-ALL-VALID-WK-ENDS         VALUE 'Y'.        00645033
               88  PS-PROCESSING-VALID-WK-ENDS        VALUE 'N'.        00646033
                                                                        00650000
      ******************************************************************00660000
      * PC - PROGRAM CONSTANTS                                          00670002
      ******************************************************************00680000
       01  PC-PROGRAM-CONSTANTS.                                        00690000
           05  PC-PROGRAM-NAME              PIC X(08) VALUE 'SDKUT171'. 00700033
           05  PC-FIELD-DELIMITER           PIC X(01) VALUE '|'.        00820033
                                                                        00830000
      ******************************************************************00840000
      * PV - PROGRAM VARIABLES                                          00850002
      ******************************************************************00860000
       01  PV-PROGRAM-VARIABLES.                                        00870000
           05  PV-CURRENT-DATE              PIC X(10) VALUE SPACES.     02090033
                                                                        02091006
         05  PV-ABEND-VARIABLES.                                        02100006
           10  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     02110033
           10  PV-OPERATION-MSG             PIC X(40) VALUE SPACES.     02120033
           10  PV-MSG-TEXT                  PIC X(40) VALUE SPACES.     02130033
           10  PV-DB2-OPERATION             PIC X(30) VALUE SPACES.     02140033
                                                                        02290000
      ******************************************************************02300006
      * PA - PROGRAM ACCUMULATORS (COUNTERS)                            02310006
      ******************************************************************02320006
       01  PA-PROGRAM-ACCUMULATORS.                                     02330006
           05  PA-FETCH-COUNT               PIC 9(07) VALUE ZEROES.     02340033
           05  PA-WRITE-COUNT               PIC 9(07) VALUE ZEROES.     02341033
           05  PA-SKIP-COUNT                PIC 9(07) VALUE ZEROES.     02342033
                                                                        02350006
      ******************************************************************02360021
      *               SYSTEM TIME AND DATE VARIABLES                    02370021
      ******************************************************************02380021
       01  SYS-DATE-TIME.                                               02390021
           05  SYS-DATE                     PIC X(08) VALUE SPACES.     02400033
           05  SYS-TIME                     PIC X(08) VALUE SPACES.     02410033
                                                                        02420021
       01  ST-BEG-TIME.                                                 02430021
           05  ST-BEG-HR                    PIC 9(02) VALUE ZEROS.      02440033
           05  FILLER                       PIC X(01) VALUE ':'.        02450033
           05  ST-BEG-MN                    PIC 9(02) VALUE ZEROS.      02460033
                                                                        02470021
       01  ST-END-TIME.                                                 02480021
           05  ST-END-HR                    PIC 9(02) VALUE ZEROS.      02490033
           05  FILLER                       PIC X(01) VALUE ':'.        02500033
           05  ST-END-MN                    PIC 9(02) VALUE ZEROS.      02510033
                                                                        02520021
       01  SD-EDIT-DATE.                                                02530021
           05  SD-MONTH                     PIC 9(02) VALUE ZEROS.      02540033
           05  FILLER                       PIC X(01) VALUE '/'.        02550033
           05  SD-DAY                       PIC 9(02) VALUE ZEROS.      02560033
           05  FILLER                       PIC X(01) VALUE '/'.        02570033
           05  SD-CENT                      PIC 9(02) VALUE ZEROS.      02580033
           05  SD-YEAR                      PIC 9(02) VALUE ZEROS.      02590033
                                                                        02591021
       01  PV-FISCAL-PERIOD-DATES.                                      02592033
           05  PV-CUR-FP-1ST-DTE            PIC X(10) VALUE SPACES.     02720033
           05  PV-CUR-FP-LAST-DTE           PIC X(10) VALUE SPACES.     02721033
           05  PV-PRV-FP-1ST-DTE            PIC X(10) VALUE SPACES.     02722033
           05  PV-PRV-FP-LAST-DTE           PIC X(10) VALUE SPACES.     02723033
           05  PV-NXT-FP-1ST-DTE            PIC X(10) VALUE SPACES.     02724033
           05  PV-NXT-FP-LAST-DTE           PIC X(10) VALUE SPACES.     02725033
           05  PV-WK1-END-DTE               PIC X(10) VALUE SPACES.     02726033
           05  PV-WK2-END-DTE               PIC X(10) VALUE SPACES.     02727033
           05  PV-WK3-END-DTE               PIC X(10) VALUE SPACES.     02728033
           05  PV-WK4-END-DTE               PIC X(10) VALUE SPACES.     02729033
           05  PV-WK5-END-DTE               PIC X(10) VALUE SPACES.     02730033
           05  PV-WK6-END-DTE               PIC X(10) VALUE SPACES.     02730133
           05  PV-WK7-END-DTE               PIC X(10) VALUE SPACES.     02730233
           05  PV-WK8-END-DTE               PIC X(10) VALUE SPACES.     02730333
           05  PV-WK9-END-DTE               PIC X(10) VALUE SPACES.     02730433
           05  PV-WK10-END-DTE              PIC X(10) VALUE SPACES.     02730533
           05  PV-WK11-END-DTE              PIC X(10) VALUE SPACES.     02730633
           05  PV-WK12-END-DTE              PIC X(10) VALUE SPACES.     02730733
           05  PV-WK13-END-DTE              PIC X(10) VALUE SPACES.     02730833
           05  PV-WK14-END-DTE              PIC X(10) VALUE SPACES.     02730933
           05  PV-WK15-END-DTE              PIC X(10) VALUE SPACES.     02731033
                                                                        02790021
      ******************************************************************02910000
      * AC - ABEND ERROR CODES                                          02920006
      ******************************************************************02930000
       01  ABEND-CODE                       PIC S9(4) VALUE +0          02940033
                                                      COMP SYNC.        02941033
           88  ABEND-4013-DB2-ERROR                   VALUE +4013.      02950033
           88  AC-DATE-ROUTINE-ERROR                  VALUE +4019.      02960033
                                                                        02990000
      ******************************************************************02991021
      * PARAMETER LIST FOR THE CALENDAR ROUTINE                         02992021
      ******************************************************************02993021
           COPY DPWS500.                                                02994021
                                                                        02995021
      ******************************************************************03000000
      * EXTRACT RECORD LAYOUT                                           03010001
      ******************************************************************03020000
           COPY SDRD171.                                                03030001
                                                                        03109000
      ******************************************************************03110000
      * VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         03120000
      ******************************************************************03130000
           COPY DPWS004.                                                03140000
                                                                        03150000
      ******************************************************************03160000
      * DB2 MESSAGE AREA                                                03170000
      ******************************************************************03180000
           COPY SQLCA2.                                                 03190000
                                                                        03200000
      ******************************************************************03210000
      * STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                 03220000
      ******************************************************************03230000
           EXEC SQL                                                     03240000
               INCLUDE SQLCA                                            03250000
           END-EXEC.                                                    03260000
                                                                        03270000
      ******************************************************************03310000
      * DB2 TABLE SDT_WKLY_STR_ADJ                                      03320001
      ******************************************************************03330000
           EXEC SQL                                                     03340000
               INCLUDE SDT00034                                         03350001
           END-EXEC.                                                    03360000
                                                                        03560000
      ******************************************************************03570000
      * SDT_WKLY_STR_ADJ CURSOR - PULL WHERE WEEK END DATE BETWEEN      03580019
      *                           START OF LAST FISCAL MONTH AND THE    03581019
      *                           START OF NEXT FISCAL MONTH DATE.      03582019
      ******************************************************************03590000
           EXEC SQL                                                     03600000
             DECLARE WKLY-STR-ADJ-CSR CURSOR FOR                        03610002
               SELECT STR_NBR                                           03630001
                     ,WK_END_DTE                                        03640001
                     ,PYRL_ADJ_AMT                                      03650001
                     ,PYRL_ADJ_HR_QTY                                   03651003
                 FROM SDT_WKLY_STR_ADJ                                  03670001
                WHERE WK_END_DTE BETWEEN :PV-PRV-FP-1ST-DTE             03680021
                                     AND :PV-NXT-FP-LAST-DTE            03690021
               ORDER BY STR_NBR, WK_END_DTE                             03700001
               FOR FETCH ONLY                                           03710001
               WITH UR                                                  03770001
           END-EXEC.                                                    03780000
                                                                        03809900
      ******************************************************************03810001
       PROCEDURE DIVISION.                                              03811000
      ******************************************************************03820000
      * MAIN DRIVER                                                     03830000
      ******************************************************************03840000
       0000-MAINLINE.                                                   03850001
                                                                        03860000
           PERFORM 1000-INITIALIZATION.                                 03870001
                                                                        03871002
           PERFORM 2000-EXTRACT-PROCESSING                              03880005
                   UNTIL PS-END-OF-CSR.                                 03881005
                                                                        03881106
           PERFORM 3000-WRAP-UP.                                        03881306
                                                                        03882002
           PERFORM 9999-SUMMARY.                                        03890006
                                                                        03900000
           GOBACK.                                                      03910001
                                                                        03930000
      ******************************************************************03941002
      * 1000-INITIALIZATION                                             03942002
      ******************************************************************03945002
       1000-INITIALIZATION.                                             03946002
                                                                        03947002
           DISPLAY '*************************************'.             03948002
           DISPLAY '* SDKUT171 - SDT_WKLY_STR_ADJ       *'.             03949002
           DISPLAY '*            DB2 TABLE EXTRACT      *'.             03949102
           DISPLAY '*************************************'.             03949202
           DISPLAY '* PAYROLL WEEKLY STORE ADJUSTMENTS  *'.             03949333
           DISPLAY '*************************************'.             03949433
           DISPLAY '*'.                                                 03949533
           DISPLAY '* - PROCESSING...'.                                 03949633
                                                                        03949733
           OPEN OUTPUT EXTRACT-FILE.                                    03950302
                                                                        03950421
           MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 03950521
                                                                        03950621
           MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            03950721
           MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            03950821
                                                                        03950921
           MOVE SYS-DATE (1:2) TO SD-CENT.                              03951021
           MOVE SYS-DATE (3:2) TO SD-YEAR.                              03951121
           MOVE SYS-DATE (5:2) TO SD-MONTH.                             03951221
           MOVE SYS-DATE (7:2) TO SD-DAY.                               03951321
                                                                        03951421
           PERFORM 1100-DETERMINE-DATES.                                03951521
                                                                        03951621
           PERFORM 2300-OPEN-WKLY-STR-ADJ-CSR.                          03951806
           PERFORM 2400-FETCH-WKLY-STR-ADJ-CSR.                         03951906
                                                                        03952005
      ******************************************************************03952121
      * DETERMINE FISCAL MONTH START / END DATES                        03952221
      ******************************************************************03952321
       1100-DETERMINE-DATES.                                            03952421
                                                                        03952521
           MOVE '1100-DETERMINE-DATES' TO PV-PARAGRAPH-NAME.            03952621
           DISPLAY 'SYSTEM DATE: ' SD-EDIT-DATE.                        03952721
                                                                        03952821
      ***GET START/END DATES OF CURRENT FISCAL MONTH                    03952921
                                                                        03953021
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03953121
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03953221
           SET DPG52-LK-DTE-GREG-CC-FMT  TO TRUE.                       03953321
           MOVE SD-EDIT-DATE             TO DPG52-GREG-CC-DATE-FMT.     03953421
                                                                        03953521
           DISPLAY 'DPG52-GREG-CC-DATE = ' DPG52-GREG-CC-DATE-FMT.      03953621
                                                                        03953721
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03953821
                                                   DPG52                03953921
                                                   DPG53                03954021
                                                   DPG54                03954121
                                                   DPG55                03954221
                                                   DPG56.               03954321
                                                                        03954421
           EVALUATE TRUE                                                03954521
               WHEN DPG54-NO-ERROR                                      03954621
                   MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-CUR-FP-1ST-DTE 03954721
                   MOVE DPG56-LAST-FP-DB2-ISO-FMT TO PV-CUR-FP-LAST-DTE 03954821
               WHEN OTHER                                               03954921
                   DISPLAY 'ERROR GETTING FISCAL MONTH START DATE'      03955021
                   PERFORM Z5000-ERROR-ROUTINE                          03955121
           END-EVALUATE.                                                03955221
                                                                        03955321
      ***GET START/END DATES OF PREVIOUS FISCAL MONTH                   03955421
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03955521
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03955621
           SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       03955721
           MOVE PV-CUR-FP-1ST-DTE        TO DPG52-DB2-ISO-DATE-FMT.     03955821
           SET DPG51-DECREMENT-DATE      TO TRUE.                       03955921
           MOVE 1                        TO DPG51-INCR-DECR-DAYS-9.     03956021
                                                                        03956121
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03956221
                                                   DPG52                03956321
                                                   DPG53                03956421
                                                   DPG54                03956521
                                                   DPG55                03956621
                                                   DPG56.               03956721
                                                                        03956821
           EVALUATE TRUE                                                03956921
               WHEN DPG54-NO-ERROR                                      03957021
                   MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-PRV-FP-1ST-DTE 03957121
                   MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO PV-PRV-FP-LAST-DTE03957221
               WHEN OTHER                                               03957321
                   DISPLAY 'ERROR GETTING PREV FISCAL MONTH DATES'      03957421
                   PERFORM Z5000-ERROR-ROUTINE                          03957521
           END-EVALUATE.                                                03957621
                                                                        03957721
      ***GET START/END DATES OF NEXT FISCAL MONTH                       03957821
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03957921
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03958021
           SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       03958121
           MOVE PV-CUR-FP-LAST-DTE       TO DPG52-DB2-ISO-DATE-FMT.     03958221
           SET DPG51-INCREMENT-DATE      TO TRUE.                       03958321
           MOVE 1                        TO DPG51-INCR-DECR-DAYS-9.     03958421
                                                                        03958521
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03958621
                                                   DPG52                03958721
                                                   DPG53                03958821
                                                   DPG54                03958921
                                                   DPG55                03959021
                                                   DPG56.               03959121
                                                                        03959221
           EVALUATE TRUE                                                03959321
               WHEN DPG54-NO-ERROR                                      03959421
                   MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-NXT-FP-1ST-DTE 03959521
                   MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO PV-NXT-FP-LAST-DTE03959621
               WHEN OTHER                                               03959721
                   DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'      03959821
                   PERFORM Z5000-ERROR-ROUTINE                          03959921
           END-EVALUATE.                                                03960021
                                                                        03960121
           DISPLAY 'PREV FISCAL MONTH START DATE: ' PV-PRV-FP-1ST-DTE.  03960221
           DISPLAY 'PREV FISCAL MONTH END DATE..: ' PV-PRV-FP-LAST-DTE. 03960321
           DISPLAY 'CURR FISCAL MONTH START DATE: ' PV-CUR-FP-1ST-DTE.  03960421
           DISPLAY 'CURR FISCAL MONTH END DATE..: ' PV-CUR-FP-LAST-DTE. 03960521
           DISPLAY 'NEXT FISCAL MONTH START DATE: ' PV-NXT-FP-1ST-DTE.  03960621
           DISPLAY 'NEXT FISCAL MONTH END DATE..: ' PV-NXT-FP-LAST-DTE. 03960721
           DISPLAY '...'.                                               03960821
                                                                        03960921
           DISPLAY 'PAYROLL WKLY ADJ BEGIN DATE: ' PV-PRV-FP-1ST-DTE.   03961021
           DISPLAY '........THROUGH ENDING DATE: ' PV-NXT-FP-LAST-DTE.  03961121
           DISPLAY '...'.                                               03961228
                                                                        03961322
                                                                        03961422
      ******************************************************************03961522
      * GET WEEK ENDING DATES, DAY OF WEEK                              03961622
      ******************************************************************03961722
      *--> NOW, GET ALL THE SATURDAY WEEK END DATES FOR VALIDATION      03961922
           DISPLAY 'ONLY FISCAL WEEK END DATES ARE VALID, BUT THE TABLE'03962028
           DISPLAY 'MIGHT HAVE INVALID WEEK END DATES. DO NOT WRITE OUT'03962128
           DISPLAY 'RECORDS THAT DO NOT MATCH A VALID WEEK END DATE'    03962228
           DISPLAY '...'.                                               03962328
           SET PS-PROCESSING-VALID-WK-ENDS TO TRUE.                     03962428
                                                                        03963022
      *-----------------------------------------------------------------03966422
      * GET WEEK 1 WEEK ENDING DATE                                     03966522
      *-----------------------------------------------------------------03966622
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03966722
                                                                        03966822
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03966922
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03967022
           SET DPG51-INCREMENT-DATE TO TRUE.                            03967122
                                                                        03967222
           MOVE 06 TO DPG51-INCR-DECR-DAYS-9.                           03967322
           MOVE PV-PRV-FP-1ST-DTE TO DPG52-DB2-ISO-DATE-FMT.            03967422
                                                                        03967522
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03967725
                                                   DPG52                03967825
                                                   DPG53                03967925
                                                   DPG54                03968025
                                                   DPG55                03968125
                                                   DPG56.               03968225
                                                                        03968322
           EVALUATE TRUE                                                03968422
             WHEN DPG54-NO-ERROR                                        03968522
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK1-END-DTE            03968624
               DISPLAY '...' PV-WK1-END-DTE   ' PV-WK1-END-DTE '        03968728
                                                                        03968822
             WHEN OTHER                                                 03968922
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03969025
               PERFORM Z5000-ERROR-ROUTINE                              03969125
                                                                        03969222
           END-EVALUATE.                                                03970022
                                                                        03971222
      *-----------------------------------------------------------------03971422
      * GET WEEK 2 WEEK ENDING DATE                                     03971522
      *-----------------------------------------------------------------03971622
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03971722
                                                                        03971822
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03971922
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03972022
           SET DPG51-INCREMENT-DATE TO TRUE.                            03972122
                                                                        03972222
           MOVE 13 TO DPG51-INCR-DECR-DAYS-9.                           03972322
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03972422
                                                                        03972522
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03972725
                                                   DPG52                03972825
                                                   DPG53                03972925
                                                   DPG54                03973025
                                                   DPG55                03973125
                                                   DPG56.               03973225
                                                                        03973322
           EVALUATE TRUE                                                03973422
             WHEN DPG54-NO-ERROR                                        03973522
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK2-END-DTE            03973624
               DISPLAY '...' PV-WK2-END-DTE   ' PV-WK2-END-DTE '        03973728
                                                                        03973822
             WHEN OTHER                                                 03973922
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03974025
               PERFORM Z5000-ERROR-ROUTINE                              03974125
                                                                        03974222
           END-EVALUATE.                                                03974322
                                                                        03974422
      *-----------------------------------------------------------------03974525
      * GET WEEK 3 WEEK ENDING DATE                                     03974625
      *-----------------------------------------------------------------03974725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03974825
                                                                        03974925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03975025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03975125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03975225
                                                                        03975325
           MOVE 20 TO DPG51-INCR-DECR-DAYS-9.                           03975425
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03975525
                                                                        03975625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03975725
                                                   DPG52                03975825
                                                   DPG53                03975925
                                                   DPG54                03976025
                                                   DPG55                03976125
                                                   DPG56.               03976225
                                                                        03976325
           EVALUATE TRUE                                                03976425
             WHEN DPG54-NO-ERROR                                        03976525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK3-END-DTE            03976625
               DISPLAY '...' PV-WK3-END-DTE   ' PV-WK3-END-DTE '        03976729
                                                                        03976825
             WHEN OTHER                                                 03976925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03977025
               PERFORM Z5000-ERROR-ROUTINE                              03977125
                                                                        03977225
           END-EVALUATE.                                                03977325
                                                                        03977425
      *-----------------------------------------------------------------03977525
      * GET WEEK 4 WEEK ENDING DATE                                     03977625
      *-----------------------------------------------------------------03977725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03977825
                                                                        03977925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03978025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03978125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03978225
                                                                        03978325
           MOVE 27 TO DPG51-INCR-DECR-DAYS-9.                           03978425
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03978525
                                                                        03978625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03978725
                                                   DPG52                03978825
                                                   DPG53                03978925
                                                   DPG54                03979025
                                                   DPG55                03979125
                                                   DPG56.               03979225
                                                                        03979325
           EVALUATE TRUE                                                03979425
             WHEN DPG54-NO-ERROR                                        03979525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK4-END-DTE            03979625
               DISPLAY '...' PV-WK4-END-DTE   ' PV-WK4-END-DTE '        03979728
                                                                        03979825
             WHEN OTHER                                                 03979925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03980025
               PERFORM Z5000-ERROR-ROUTINE                              03980125
                                                                        03980225
           END-EVALUATE.                                                03980325
                                                                        03980425
      *-----------------------------------------------------------------03980525
      * GET WEEK 5 WEEK ENDING DATE                                     03980625
      *-----------------------------------------------------------------03980725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03980825
                                                                        03980925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03981025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03981125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03981225
                                                                        03981325
           MOVE 34 TO DPG51-INCR-DECR-DAYS-9.                           03981425
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03981525
                                                                        03981625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03981725
                                                   DPG52                03981825
                                                   DPG53                03981925
                                                   DPG54                03982025
                                                   DPG55                03982125
                                                   DPG56.               03982225
                                                                        03982325
           EVALUATE TRUE                                                03982425
             WHEN DPG54-NO-ERROR                                        03982525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK5-END-DTE            03982625
               DISPLAY '...' PV-WK5-END-DTE   ' PV-WK5-END-DTE '        03982728
                                                                        03982825
             WHEN OTHER                                                 03982925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03983025
               PERFORM Z5000-ERROR-ROUTINE                              03983125
                                                                        03983225
           END-EVALUATE.                                                03983325
                                                                        03983422
      *-----------------------------------------------------------------03983525
      * GET WEEK 6 WEEK ENDING DATE                                     03983625
      *-----------------------------------------------------------------03983725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03983825
                                                                        03983925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03984025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03984125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03984225
                                                                        03984325
           MOVE 41 TO DPG51-INCR-DECR-DAYS-9.                           03984427
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03984525
                                                                        03984625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03984725
                                                   DPG52                03984825
                                                   DPG53                03984925
                                                   DPG54                03985025
                                                   DPG55                03985125
                                                   DPG56.               03985225
                                                                        03985325
           EVALUATE TRUE                                                03985425
             WHEN DPG54-NO-ERROR                                        03985525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK6-END-DTE            03985625
               DISPLAY '...' PV-WK6-END-DTE   ' PV-WK6-END-DTE '        03985728
                                                                        03985825
             WHEN OTHER                                                 03985925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03986025
               PERFORM Z5000-ERROR-ROUTINE                              03986125
                                                                        03986225
           END-EVALUATE.                                                03986325
                                                                        03986425
      *-----------------------------------------------------------------03986525
      * GET WEEK 7 WEEK ENDING DATE                                     03986625
      *-----------------------------------------------------------------03986725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03986825
                                                                        03986925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03987025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03987125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03987225
                                                                        03987325
           MOVE 48 TO DPG51-INCR-DECR-DAYS-9.                           03987427
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03987525
                                                                        03987625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03987725
                                                   DPG52                03987825
                                                   DPG53                03987925
                                                   DPG54                03988025
                                                   DPG55                03988125
                                                   DPG56.               03988225
                                                                        03988325
           EVALUATE TRUE                                                03988425
             WHEN DPG54-NO-ERROR                                        03988525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK7-END-DTE            03988625
               DISPLAY '...' PV-WK7-END-DTE   ' PV-WK7-END-DTE '        03988728
                                                                        03988825
             WHEN OTHER                                                 03988925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03989025
               PERFORM Z5000-ERROR-ROUTINE                              03989125
                                                                        03989225
           END-EVALUATE.                                                03989325
                                                                        03989425
      *-----------------------------------------------------------------03989525
      * GET WEEK 8 WEEK ENDING DATE                                     03989625
      *-----------------------------------------------------------------03989725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03989825
                                                                        03989925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03990025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03990125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03990225
                                                                        03990325
           MOVE 55 TO DPG51-INCR-DECR-DAYS-9.                           03990427
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03990525
                                                                        03990625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03990725
                                                   DPG52                03990825
                                                   DPG53                03990925
                                                   DPG54                03991025
                                                   DPG55                03991125
                                                   DPG56.               03991225
                                                                        03991325
           EVALUATE TRUE                                                03991425
             WHEN DPG54-NO-ERROR                                        03991525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK8-END-DTE            03991625
               DISPLAY '...' PV-WK8-END-DTE   ' PV-WK8-END-DTE '        03991728
                                                                        03991825
             WHEN OTHER                                                 03991925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03992025
               PERFORM Z5000-ERROR-ROUTINE                              03992125
                                                                        03992225
           END-EVALUATE.                                                03992325
                                                                        03992425
      *-----------------------------------------------------------------03992525
      * GET WEEK 9 WEEK ENDING DATE                                     03992625
      *-----------------------------------------------------------------03992725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03992825
                                                                        03992925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03993025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03993125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03993225
                                                                        03993325
           MOVE 62 TO DPG51-INCR-DECR-DAYS-9.                           03993427
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03993525
                                                                        03993625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03993725
                                                   DPG52                03993825
                                                   DPG53                03993925
                                                   DPG54                03994025
                                                   DPG55                03994125
                                                   DPG56.               03994225
                                                                        03994325
           EVALUATE TRUE                                                03994425
             WHEN DPG54-NO-ERROR                                        03994525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK9-END-DTE            03994625
               DISPLAY '...' PV-WK9-END-DTE   ' PV-WK9-END-DTE '        03994728
                                                                        03994825
             WHEN OTHER                                                 03994925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03995025
               PERFORM Z5000-ERROR-ROUTINE                              03995125
                                                                        03995225
           END-EVALUATE.                                                03995325
                                                                        03995425
      *-----------------------------------------------------------------03995525
      * GET WEEK 10 WEEK ENDING DATE                                    03995625
      *-----------------------------------------------------------------03995725
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03995825
                                                                        03995925
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03996025
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03996125
           SET DPG51-INCREMENT-DATE TO TRUE.                            03996225
                                                                        03996325
           MOVE 69 TO DPG51-INCR-DECR-DAYS-9.                           03996427
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03996525
                                                                        03996625
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03996725
                                                   DPG52                03996825
                                                   DPG53                03996925
                                                   DPG54                03997025
                                                   DPG55                03997125
                                                   DPG56.               03997225
                                                                        03997325
           EVALUATE TRUE                                                03997425
             WHEN DPG54-NO-ERROR                                        03997525
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK10-END-DTE           03997625
               DISPLAY '...' PV-WK10-END-DTE   ' PV-WK10-END-DTE '      03997728
                                                                        03997825
             WHEN OTHER                                                 03997925
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          03998025
               PERFORM Z5000-ERROR-ROUTINE                              03998125
                                                                        03998225
           END-EVALUATE.                                                03998325
                                                                        03998425
      *-----------------------------------------------------------------03998526
      * GET WEEK 11 WEEK ENDING DATE                                    03998626
      *-----------------------------------------------------------------03998726
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03998826
                                                                        03998926
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       03999026
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            03999126
           SET DPG51-INCREMENT-DATE TO TRUE.                            03999226
                                                                        03999326
           MOVE 76 TO DPG51-INCR-DECR-DAYS-9.                           03999427
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       03999526
                                                                        03999626
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                03999726
                                                   DPG52                03999826
                                                   DPG53                03999926
                                                   DPG54                04000026
                                                   DPG55                04000126
                                                   DPG56.               04000226
                                                                        04000326
           EVALUATE TRUE                                                04000426
             WHEN DPG54-NO-ERROR                                        04000526
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK11-END-DTE           04000626
               DISPLAY '...' PV-WK11-END-DTE   ' PV-WK11-END-DTE '      04000728
                                                                        04000826
             WHEN OTHER                                                 04000926
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          04001026
               PERFORM Z5000-ERROR-ROUTINE                              04001126
                                                                        04001226
           END-EVALUATE.                                                04001326
                                                                        04001426
      *-----------------------------------------------------------------04001526
      * GET WEEK 12 WEEK ENDING DATE                                    04001626
      *-----------------------------------------------------------------04001726
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04001826
                                                                        04001926
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       04002026
           SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            04002126
           SET DPG51-INCREMENT-DATE TO TRUE.                            04002226
                                                                        04002326
           MOVE 83 TO DPG51-INCR-DECR-DAYS-9.                           04002427
           MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT.       04002526
                                                                        04002626
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                04002726
                                                   DPG52                04002826
                                                   DPG53                04002926
                                                   DPG54                04003026
                                                   DPG55                04003126
                                                   DPG56.               04003226
                                                                        04003326
           EVALUATE TRUE                                                04003426
             WHEN DPG54-NO-ERROR                                        04003526
               MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK12-END-DTE           04003626
               DISPLAY '...' PV-WK12-END-DTE   ' PV-WK12-END-DTE '      04003728
               IF PV-WK12-END-DTE = PV-NXT-FP-LAST-DTE                  04003826
                  SET PS-FOUND-ALL-VALID-WK-ENDS TO TRUE                04003926
               END-IF                                                   04004026
                                                                        04004126
             WHEN OTHER                                                 04004226
               DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'          04004326
               PERFORM Z5000-ERROR-ROUTINE                              04004426
                                                                        04004526
           END-EVALUATE.                                                04004626
                                                                        04004726
      *-----------------------------------------------------------------04004826
      * GET WEEK 13 WEEK ENDING DATE                                    04004926
      *-----------------------------------------------------------------04005026
           IF PS-PROCESSING-VALID-WK-ENDS                               04005126
                                                                        04005226
              INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            04005326
                                                                        04005426
              SET DPG51-FISCAL-454-CALENDAR TO TRUE                     04005526
              SET DPG52-LK-DTE-ISO-FMT TO TRUE                          04005626
              SET DPG51-INCREMENT-DATE TO TRUE                          04005726
                                                                        04005826
              MOVE 90 TO DPG51-INCR-DECR-DAYS-9                         04005927
              MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT     04006026
                                                                        04006126
              CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51             04006226
                                                      DPG52             04006326
                                                      DPG53             04006426
                                                      DPG54             04006526
                                                      DPG55             04006626
                                                      DPG56             04006726
                                                                        04006826
              EVALUATE TRUE                                             04006926
                WHEN DPG54-NO-ERROR                                     04007026
                  MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK13-END-DTE        04007126
                  DISPLAY '...' PV-WK13-END-DTE   ' PV-WK13-END-DTE '   04007228
                  IF PV-WK13-END-DTE = PV-NXT-FP-LAST-DTE               04007326
                     SET PS-FOUND-ALL-VALID-WK-ENDS TO TRUE             04007426
                  END-IF                                                04007526
                                                                        04007626
                WHEN OTHER                                              04007726
                  DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'       04007826
                  PERFORM Z5000-ERROR-ROUTINE                           04007926
                                                                        04008026
              END-EVALUATE                                              04008126
           END-IF.                                                      04008226
                                                                        04008326
      *-----------------------------------------------------------------04008426
      * GET WEEK 14 WEEK ENDING DATE                                    04008526
      *-----------------------------------------------------------------04008626
           IF PS-PROCESSING-VALID-WK-ENDS                               04008726
                                                                        04008826
              INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            04008926
                                                                        04009026
              SET DPG51-FISCAL-454-CALENDAR TO TRUE                     04009126
              SET DPG52-LK-DTE-ISO-FMT TO TRUE                          04009226
              SET DPG51-INCREMENT-DATE TO TRUE                          04009326
                                                                        04009426
              MOVE 97 TO DPG51-INCR-DECR-DAYS-9                         04009527
              MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT     04009626
                                                                        04009726
              CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51             04009826
                                                      DPG52             04009926
                                                      DPG53             04010026
                                                      DPG54             04010126
                                                      DPG55             04010226
                                                      DPG56             04010326
                                                                        04010426
              EVALUATE TRUE                                             04010526
                WHEN DPG54-NO-ERROR                                     04010626
                  MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK14-END-DTE        04010726
                  DISPLAY '...' PV-WK14-END-DTE   ' PV-WK14-END-DTE '   04010828
                  IF PV-WK14-END-DTE = PV-NXT-FP-LAST-DTE               04010926
                     SET PS-FOUND-ALL-VALID-WK-ENDS TO TRUE             04011026
                  END-IF                                                04011126
                                                                        04011226
                WHEN OTHER                                              04011326
                  DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'       04011426
                  PERFORM Z5000-ERROR-ROUTINE                           04011526
                                                                        04011626
              END-EVALUATE                                              04011726
           END-IF.                                                      04011826
                                                                        04011926
      *-----------------------------------------------------------------04012026
      * GET WEEK 15 WEEK ENDING DATE                                    04012126
      *-----------------------------------------------------------------04012226
           IF PS-PROCESSING-VALID-WK-ENDS                               04012326
                                                                        04012426
              INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            04012526
                                                                        04012626
              SET DPG51-FISCAL-454-CALENDAR TO TRUE                     04012726
              SET DPG52-LK-DTE-ISO-FMT TO TRUE                          04012826
              SET DPG51-INCREMENT-DATE TO TRUE                          04012926
                                                                        04013026
              MOVE 104 TO DPG51-INCR-DECR-DAYS-9                        04013127
              MOVE PV-PRV-FP-1ST-DTE      TO DPG52-DB2-ISO-DATE-FMT     04013226
                                                                        04013326
              CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51             04013426
                                                      DPG52             04013526
                                                      DPG53             04013626
                                                      DPG54             04013726
                                                      DPG55             04013826
                                                      DPG56             04013926
                                                                        04014026
              EVALUATE TRUE                                             04014126
                WHEN DPG54-NO-ERROR                                     04014226
                  MOVE DPG55-DB2-ISO-DATE-FMT TO PV-WK15-END-DTE        04014326
                  DISPLAY '...' PV-WK15-END-DTE   ' PV-WK15-END-DTE '   04014428
                  IF PV-WK15-END-DTE = PV-NXT-FP-LAST-DTE               04014526
                     SET PS-FOUND-ALL-VALID-WK-ENDS TO TRUE             04014626
                  END-IF                                                04014726
                                                                        04014826
                WHEN OTHER                                              04014926
                  DISPLAY 'ERROR GETTING NEXT FISCAL MONTH DATES'       04015026
                  PERFORM Z5000-ERROR-ROUTINE                           04015126
                                                                        04015226
              END-EVALUATE                                              04015326
           END-IF.                                                      04015426
                                                                        04015526
      ******************************************************************04017221
      * 2000-EXTRACT-PROCESSING                                         04017321
      ******************************************************************04017421
       2000-EXTRACT-PROCESSING.                                         04017521
                                                                        04017622
      *--> DEFAULT TO VALID ROW                                         04017722
           SET PS-VALID-WEEK-END-DTE TO TRUE.                           04017822
                                                                        04017922
      *--> MAKE SURE THE WEEK END IS A VALID SATURDAY IN THE DATE RANGE 04018022
           PERFORM 2000-VERIFY-WEEK-END-DTE.                            04018122
                                                                        04018221
           IF PS-VALID-WEEK-END-DTE                                     04018322
              PERFORM 2100-MOVE-TO-LAYOUT                               04018422
              PERFORM 2200-WRITE-EXTRACT-RECORD                         04018522
           END-IF.                                                      04018622
                                                                        04018721
           PERFORM 2400-FETCH-WKLY-STR-ADJ-CSR.                         04018821
                                                                        04018922
      ******************************************************************04019022
      * 2000-VERIFY-WEEK-END-DTE                                        04019122
      ******************************************************************04019222
       2000-VERIFY-WEEK-END-DTE.                                        04019322
                                                                        04019422
           EVALUATE SDT00034-WK-END-DTE                                 04019522
              WHEN PV-WK1-END-DTE                                       04019623
              WHEN PV-WK2-END-DTE                                       04019723
              WHEN PV-WK3-END-DTE                                       04019823
              WHEN PV-WK4-END-DTE                                       04019923
              WHEN PV-WK5-END-DTE                                       04020023
              WHEN PV-WK6-END-DTE                                       04020123
              WHEN PV-WK7-END-DTE                                       04020223
              WHEN PV-WK8-END-DTE                                       04020323
              WHEN PV-WK9-END-DTE                                       04020423
              WHEN PV-WK10-END-DTE                                      04020523
              WHEN PV-WK11-END-DTE                                      04020623
              WHEN PV-WK12-END-DTE                                      04020723
              WHEN PV-WK13-END-DTE                                      04020823
              WHEN PV-WK14-END-DTE                                      04020923
              WHEN PV-WK15-END-DTE                                      04021023
                 SET PS-VALID-WEEK-END-DTE TO TRUE                      04021122
              WHEN OTHER                                                04021222
                 SET PS-INVALID-WEEK-END-DTE TO TRUE                    04021322
                 DISPLAY 'INVALID DB2 TABLE RECORD - SKIPPING; STORE: ' 04021429
                         SDT00034-STR-NBR ' WK-END-DTE: '               04021529
                         SDT00034-WK-END-DTE                            04021629
                 ADD +1 TO PA-SKIP-COUNT                                04021729
           END-EVALUATE.                                                04021829
                                                                        04021929
      ******************************************************************04022022
      * 2100-MOVE-TO-LAYOUT.                                            04022122
      ******************************************************************04022222
       2100-MOVE-TO-LAYOUT.                                             04022322
                                                                        04022422
           MOVE SDT00034-STR-NBR         TO SDRD171-STR-NBR.            04022531
           MOVE PC-FIELD-DELIMITER       TO SDRD171-DELIMITER-1.        04022631
           MOVE SDT00034-WK-END-DTE      TO SDRD171-WK-END-DTE.         04022731
           MOVE PC-FIELD-DELIMITER       TO SDRD171-DELIMITER-2.        04022831
           MOVE SDT00034-PYRL-ADJ-AMT    TO SDRD171-PYRL-ADJ-AMT.       04022931
           MOVE PC-FIELD-DELIMITER       TO SDRD171-DELIMITER-3.        04023031
           MOVE SDT00034-PYRL-ADJ-HR-QTY TO SDRD171-PYRL-ADJ-HR-QTY.    04023131
           MOVE PC-FIELD-DELIMITER       TO SDRD171-DELIMITER-4.        04023231
           MOVE SPACES                   TO SDRD171-CHANGE-ACTN-CDE.    04023331
                                                                        04023502
      ******************************************************************04023605
      * 2200-WRITE-EXTRACT-RECORD.                                      04023705
      ******************************************************************04023805
       2200-WRITE-EXTRACT-RECORD.                                       04023905
                                                                        04024005
           WRITE EXTRACT-RECORD                                         04024106
               FROM SDRD171-EXTRACT-RECORD.                             04024231
                                                                        04024306
           ADD +1 TO PA-WRITE-COUNT.                                    04024406
                                                                        04024506
      ******************************************************************04024606
      * 2300-OPEN-WKLY-STR-ADJ-CSR.                                     04024706
      ******************************************************************04024806
       2300-OPEN-WKLY-STR-ADJ-CSR.                                      04024906
                                                                        04025006
           EXEC SQL                                                     04025106
             OPEN WKLY-STR-ADJ-CSR                                      04025206
           END-EXEC.                                                    04025306
                                                                        04025406
           EVALUATE TRUE                                                04025506
             WHEN SQLCODE = +0                                          04025606
               CONTINUE                                                 04025706
                                                                        04025806
             WHEN OTHER                                                 04025906
               MOVE 'OPENING SQL CURSOR    ' TO PV-DB2-OPERATION        04026006
               MOVE '2300-OPEN-WKLY-STR-ADJ' TO PV-PARAGRAPH-NAME       04026106
               PERFORM 9020-SQL-ABEND-ROUTINE                           04026206
           END-EVALUATE.                                                04026306
                                                                        04026406
      ******************************************************************04026506
      * 2400-FETCH-WKLY-STR-ADJ-CSR.                                    04026606
      ******************************************************************04026706
       2400-FETCH-WKLY-STR-ADJ-CSR.                                     04026806
                                                                        04026905
           INITIALIZE DCLSDT00034.                                      04027005
                                                                        04027106
           EXEC SQL                                                     04027206
             FETCH WKLY-STR-ADJ-CSR                                     04027306
               INTO :SDT00034-STR-NBR                                   04027406
                  , :SDT00034-WK-END-DTE                                04027506
                  , :SDT00034-PYRL-ADJ-AMT                              04027606
                  , :SDT00034-PYRL-ADJ-HR-QTY                           04027706
           END-EXEC                                                     04027806
                                                                        04027906
           EVALUATE TRUE                                                04028006
             WHEN SQLCODE = +0                                          04028106
               ADD +1 TO PA-FETCH-COUNT                                 04028206
               SET PS-NOT-END-OF-CSR TO TRUE                            04028307
                                                                        04028406
             WHEN SQLCODE = +100                                        04028506
               SET PS-END-OF-CSR TO TRUE                                04028606
                                                                        04028706
             WHEN OTHER                                                 04028806
               MOVE 'FETCHING CSR         ' TO PV-DB2-OPERATION         04028906
               MOVE '2400-                ' TO PV-PARAGRAPH-NAME        04029006
               PERFORM 9020-SQL-ABEND-ROUTINE                           04029106
           END-EVALUATE.                                                04029206
                                                                        04029305
      ******************************************************************04029406
      * 3000-WRAP-UP                                                    04029506
      ******************************************************************04029606
       3000-WRAP-UP.                                                    04029706
                                                                        04029806
           CLOSE EXTRACT-FILE.                                          04029906
           PERFORM 3100-CLOSE-WKLY-STR-ADJ-CSR.                         04030006
                                                                        04030113
           DISPLAY '*'.                                                 04030230
           DISPLAY '* - WKLY STR PYRL ADJ EXTR COMPLETED'.              04030330
                                                                        04030430
      ******************************************************************04030530
      * 3100-CLOSE-WKLY-STR-ADJ-CSR                                     04030630
      ******************************************************************04030730
       3100-CLOSE-WKLY-STR-ADJ-CSR.                                     04030830
                                                                        04030930
           EXEC SQL                                                     04031030
             CLOSE WKLY-STR-ADJ-CSR                                     04031130
           END-EXEC.                                                    04031230
                                                                        04031330
           EVALUATE TRUE                                                04031430
             WHEN SQLCODE = +0                                          04031530
               CONTINUE                                                 04031630
                                                                        04031730
             WHEN OTHER                                                 04031830
               MOVE 'CLOSING CSR           '  TO PV-DB2-OPERATION       04031930
               MOVE '3100-CLOSE-CSR         ' TO PV-PARAGRAPH-NAME      04032030
               PERFORM 9020-SQL-ABEND-ROUTINE                           04032130
           END-EVALUATE.                                                04032230
                                                                        04032330
      ******************************************************************04032430
      * 9020-SQL-ABEND-ROUTINE                                          04032530
      ******************************************************************04032630
       9020-SQL-ABEND-ROUTINE.                                          04032730
                                                                        04032830
           PERFORM 9999-SUMMARY.                                        04032930
                                                                        04033030
           DISPLAY '*'.                                                 04033130
           DISPLAY '** ABEND     **'.                                   04033230
           DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                04033330
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04033430
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               04033530
                                                                        04033630
           COPY DPPD004.                                                04033730
           SET ABEND-4013-DB2-ERROR TO TRUE.                            04033830
           CALL 'ILBOABN0' USING ABEND-CODE.                            04033930
                                                                        04034030
      ******************************************************************04034130
      * DATE-ERROR-ROUTINE.                                             04034230
      ******************************************************************04034330
       Z5000-ERROR-ROUTINE.                                             04034430
                                                                        04034530
           PERFORM 9999-SUMMARY.                                        04034630
                                                                        04034730
           DISPLAY 'PARAGRAPH: ' PV-PARAGRAPH-NAME                      04034830
           DISPLAY 'ERROR: ' PV-OPERATION-MSG                           04034930
                                                                        04035230
           CALL 'ILBOABN0' USING ABEND-CODE.                            04035330
                                                                        04035430
      ******************************************************************04035530
      * 9999-SUMMARY.                                                   04035630
      ******************************************************************04035730
       9999-SUMMARY.                                                    04035830
                                                                        04035930
           DISPLAY '*'.                                                 04036030
           DISPLAY '*************************************'.             04036130
           DISPLAY '* PROGRAM SUMMARY - SDKUT171        *'.             04036233
           DISPLAY '*************************************'.             04036330
           DISPLAY '* - ROWS EXTRACTED      : ' PA-FETCH-COUNT '   *'.  04036430
           DISPLAY '* - ROWS FILTERED OUT   : ' PA-SKIP-COUNT  '   *'.  04036530
           DISPLAY '* - ROWS WRITTEN TO FILE: ' PA-WRITE-COUNT '   *'.  04036630
           DISPLAY '*************************************'.             04036730
                                                                        04036830
           MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04036930
                                                                        04037030
           MOVE SYS-TIME (1:2) TO ST-END-HR.                            04037130
           MOVE SYS-TIME (3:2) TO ST-END-MN.                            04037230
                                                                        04037330
           DISPLAY '                    '.                              04037430
           DISPLAY '**********************'.                            04037530
           DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04037630
           DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04037730
           DISPLAY 'END TIME  = ' ST-END-TIME.                          04037830
           DISPLAY '======================'.                            04037930
           DISPLAY '                    '.                              04038021
      ******************************************************************04040002
