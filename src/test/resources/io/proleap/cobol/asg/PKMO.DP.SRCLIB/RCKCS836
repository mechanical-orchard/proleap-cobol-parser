000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    RCKCS836.                                         00040001
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  MAY, 2004.                                        00070001
000800 DATE-COMPILED.                                                   00080001
000900*----------------------------------------------------------------*00090001
001000*    E836 - RECEIVING TRACKING CRITERIA SPECIFICATION            *00100001
001100*                                                                *00110001
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120001
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST.                       *00130001
001400*----------------------------------------------------------------*00140001
001410* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00141028
001420* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00142029
001430* MAKING THE CALL DYNAMIC VS STATIC.                              00143029
001440*---------------------------------------------------------------* 00144029
001500                                                                  00150001
001600                                                                  00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800                                                                  00180001
001900 DATA DIVISION.                                                   00190001
002000                                                                  00200001
002100 WORKING-STORAGE SECTION.                                         00210001
002200*                                                                 00220001
002300 01  PC-PROGRAM-CONSTANTS.                                        00230001
002400     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +14     00240001
002500                                                    COMP SYNC.    00250001
002600     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00260001
002700     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00270001
002800     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00280001
002900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'RC836A  '. 00290001
003000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'RCKM836 '. 00300001
003100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'RCKCS836'. 00310001
003200     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE  'DPKUT500'. 00320001
003300     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00330014
003400     05  PC-MAX-DATE               PIC  X(10)  VALUE '9999-09-09'.00340001
003500     05  PC-ALL-DISTRIB-CNTRS      PIC  X(30)  VALUE              00350001
003600                   'ALL DISTRIBUTION CENTERS'.                    00360001
003700     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00370001
003800     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00380001
003900     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00390001
004000     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00400001
004100     05  PC-DFLT-PKG-TYPE               PIC  X(02)  VALUE 'AL'.   00410001
004200     05  PC-DFLT-PROC-STAT              PIC  X(01)  VALUE 'A'.    00420001
004300****************************************************************  00430001
004400* MESSAGES                                                     *  00440001
004500****************************************************************  00450001
004600* 00005 - INVALID VALUE                                        *  00460001
004700* 00007 - REQUIRED ENTRY                                          00470001
004800* 00008 - MUST BE NUMERIC                                         00480001
004900* 00009 - INVALID DATE                                            00490001
005000* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          00500001
005100* 00069 - TOP OF LIST                                             00510001
005200* 00070 - BOTTOM OF LIST                                          00520001
005300* 00588 - INVALID DEPARTMENT NUMBER                               00530001
005400* 02221 - PULL CREATE -FROM DATE- MUST BE PRIOR TO THE -TO DATE-  00540001
005500* 01202 - THE HIGHLIGHTED FIELDS ARE MUTUALLY EXCLUSIVE (ENTER ON 00550001
005600* 02572 - INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATION      00560001
005700* 02850 - INVALID VENDOR ID                                       00570001
005800* 02858 - INVALID PURCHASE ORDER NUMBER                           00580001
005900* 02912 - ONE OF THE FOUR AUDIT LIST CRITERIA MUST BE SPECIFIED*  00590001
006000* 03274 - PO NUMBER OR USER ID IS REQUIRED                     *  00600027
006100****************************************************************  00610001
006200*                                                                 00620001
006300     05  PC-TSYMSG-NUMBERS.                                       00630001
006400         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00640001
006500         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00650001
006600         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00660001
006700         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00670001
006800         10  PC-TSYMSG-00057       PIC  9(05)  VALUE  00057.      00680001
006900         10  PC-TSYMSG-00069       PIC  9(05)  VALUE  00069.      00690001
007000         10  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.      00700001
007100         10  PC-TSYMSG-00588       PIC  9(05)  VALUE  00588.      00710001
007200         10  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.      00720001
007300         10  PC-TSYMSG-01202       PIC  9(05)  VALUE  01202.      00730001
007400         10  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.      00740001
007500         10  PC-TSYMSG-02850       PIC  9(05)  VALUE  02850.      00750001
007600         10  PC-TSYMSG-02858       PIC  9(05)  VALUE  02858.      00760001
007700         10  PC-TSYMSG-02912       PIC  9(05)  VALUE  02912.      00770001
007800         10  PC-TSYMSG-03274       PIC  9(05)  VALUE  03274.      00780006
007900*                                                                 00790001
008000/                                                                 00800001
008100 01  DK-DB2-KEYS.                                                 00810001
008200     05  DK-ENT-ID                    PIC S9(09) COMP VALUE +0.   00820001
008300     05  DK-ENT-NAME-DESC             PIC  X(30) VALUE SPACES.    00830001
008400     05  DK-DEPT                      PIC  X(03) VALUE SPACES.    00840001
008500     05  DK-OPER-UNIT                 PIC S9(04) COMP VALUE +0.   00850001
008600     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   00860001
008700     05  DK-REC-SEQ-NBR               PIC S9(09) COMP VALUE +0.   00870001
008800                                                                  00880001
008900*----------------------------------------------------------------*00890001
009000*   PROGRAM VARIABLES                                            *00900001
009100*----------------------------------------------------------------*00910001
009200 01  PV-PROGRAM-VARIABLES.                                        00920001
009300                                                                  00930001
009400     05  PV-SUB                         PIC S9(04)  VALUE +0      00940001
009500                                                    COMP SYNC.    00950001
009600     05  PV-CHECK-SUB                   PIC S9(04)  VALUE +0      00960001
009700                                                    COMP SYNC.    00970001
009800     05  PV-LOCATION.                                             00980003
009900         10  PV-DP020-LOCATION       PIC  9(04)  VALUE ZERO.      00990015
010000     05  PV-FCLTY-NME                PIC  X(24)  VALUE SPACES.    01000013
010100                                                                  01010003
010200     05  PV-FROM-DATE-HOLD.                                       01020001
010300         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      01030001
010400         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      01040001
010500         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      01050001
010600                                                                  01060001
010700     05  PV-TO-DATE-HOLD.                                         01070001
010800         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      01080001
010900         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      01090001
011000         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      01100001
011100                                                                  01110001
011200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01120001
011300                                                    COMP SYNC.    01130001
011400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01140001
011500                                                    COMP-3.       01150001
011600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01160001
011700                                                    COMP-3.       01170001
011800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01180001
011900                                                    COMP-3.       01190001
012000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01200001
012100                                                    COMP-3.       01210001
012200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01220001
012300                                                    COMP-3.       01230001
012400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01240001
012500                                                    COMP SYNC.    01250001
012600     05  PV-ITEM                        PIC S9(04)  VALUE +0      01260001
012700                                                    COMP SYNC.    01270001
012800     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01280001
012900                                                    COMP SYNC.    01290001
013000     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01300001
013100                                                    COMP SYNC.    01310001
013200     05  PV-DB2-CURRENT-TMST            PIC  X(26).               01320006
013300     05  FILLER REDEFINES PV-DB2-CURRENT-TMST.                    01330006
013400         10  PV-DB2-CURRENT-CCYY        PIC X(04).                01340006
013500         10  FILLER                     PIC X(01).                01350006
013600         10  PV-DB2-CURRENT-MM          PIC X(02).                01360006
013700         10  FILLER                     PIC X(01).                01370006
013800         10  PV-DB2-CURRENT-DD          PIC X(02).                01380006
013900         10  FILLER                     PIC X(16).                01390006
014000     05  PV-OPER-UNT-ID                 PIC X(04)  VALUE SPACES.  01400023
014100     05  PV-OPER-UNT-ID-R REDEFINES PV-OPER-UNT-ID.               01410023
014200         10  PV-OPER-UNT-ID-N           PIC 9(04).                01420023
014300                                                                  01430006
014400******************************************************************01440001
014500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01450001
014600**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01460001
014700**  APPLICATION-SPECIFIC COMMAREA.                              **01470001
014800******************************************************************01480001
014900 01  LQW-LIST-QUEUE-WORK-AREA.                                    01490001
015000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01500001
015100     05  LQW-ITEM-ENTRIES               OCCURS 14 TIMES           01510001
015200                                        INDEXED BY LQW-IDX.       01520001
015300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01530001
015400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01540001
015500         10  LQW-SELECTED-SW            PIC  X(01).               01550001
015600             88  LQW-SELECT                         VALUE 'S'.    01560001
015700             88  LQW-DESELECT                       VALUE ' '.    01570001
015800         10  LQW-ACTION                 PIC  X(03).               01580001
015900         10  LQW-LINE-ENT-ID            PIC S9(09)  COMP.         01590001
016000         10  LQW-VENDOR-NAME            PIC  X(30).               01600001
016100*----------------------------------------------------------------*01610001
016200*   SWITCHES                                                     *01620001
016300*----------------------------------------------------------------*01630001
016400 01  PS-PROGRAM-SWITCHES.                                         01640001
016500     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01650001
016600         88  PS-ERROR                          VALUE  'Y'.        01660001
016700         88  PS-NO-ERROR                       VALUE  'N'.        01670001
016800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01680001
016900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01690001
017000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01700001
017100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01710001
017200         88  PS-LIST-END                            VALUE 'Y'.    01720001
017300         88  PS-NO-LIST-END                         VALUE 'N'.    01730001
017400     05  PS-DATE-ERROR-SW          PIC  X(01)  VALUE  'N'.        01740001
017500         88  PS-DATE-ERROR                     VALUE  'Y'.        01750001
017600         88  PS-NO-DATE-ERROR                  VALUE  'N'.        01760001
017700     05  PS-NUM-ERROR-SW           PIC  X(01)  VALUE  'N'.        01770001
017800         88  PS-NUM-ERROR                      VALUE  'Y'.        01780001
017900         88  PS-NO-NUM-ERROR                   VALUE  'N'.        01790001
018000     05  PS-ENT-ID-FOUND-SW        PIC  X(01)  VALUE  'N'.        01800001
018100         88  PS-ENT-ID-FOUND                   VALUE  'Y'.        01810001
018200         88  PS-NO-ENT-ID-FOUND                VALUE  'N'.        01820001
018300     05  PS-PO-FOUND-SW            PIC  X(01)  VALUE  'N'.        01830001
018400         88  PS-PO-FOUND                       VALUE  'Y'.        01840001
018500         88  PS-NO-PO-FOUND                    VALUE  'N'.        01850001
018600     05  PS-DEPT-FOUND-SW          PIC  X(01)  VALUE  'N'.        01860001
018700         88  PS-DEPT-FOUND                     VALUE  'Y'.        01870001
018800         88  PS-NO-DEPT-FOUND                  VALUE  'N'.        01880001
018900     05  PS-ACCESS-SW              PIC  X(01)  VALUE  'N'.        01890001
019000         88  PS-ACCESS-ALLOWED                 VALUE  'Y'.        01900001
019100         88  PS-ACCESS-NOT-ALLOWED             VALUE  'N'.        01910001
019200     05  PS-OPER-UNIT-FOUND-SW     PIC  X(01)  VALUE  'N'.        01920001
019300         88  PS-OPER-UNIT-FOUND                VALUE  'Y'.        01930001
019400         88  PS-OPER-UNIT-NOT-FOUND            VALUE  'N'.        01940001
019500                                                                  01950001
019600 01  PM-PROGRAM-MESSAGES.                                         01960001
019700     05  PM-ABEND-INFO-A.                                         01970001
019800         10  FILLER                PIC X(15)   VALUE              01980001
019900                                   'DP020-SRC-AID: '.             01990001
020000         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      02000001
020100         10  FILLER                PIC X(19)   VALUE              02010001
020200                                   '. DP020-FK-ACTION: '.         02020001
020300         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      02030001
020400         10  FILLER                PIC X(22)   VALUE              02040001
020500                                   '. DP020-FK-DISPN-IND: '.      02050001
020600         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      02060001
020700         10  FILLER                PIC X(01)   VALUE '.'.         02070001
020800         10  FILLER                PIC X(19)   VALUE SPACE.       02080001
020900                                                                  02090001
021000                                                                  02100001
021100*---------------------------------------------------------------* 02110001
021200* SELECTON QUEUE LAYOUT                                         * 02120001
021300*---------------------------------------------------------------* 02130001
021400     COPY SUWS019.                                                02140001
021500                                                                  02150001
021600*----------------------------------------------------------------*02160013
021700*    COPYBOOK FOR LOCATION CALL MODULE.                          *02170013
021800*----------------------------------------------------------------*02180013
021900     COPY XLWS071.                                                02190013
022000                                                                  02200013
022100*----------------------------------------------------------------*02210001
022200*    MAP LAYOUT                                                  *02220001
022300*----------------------------------------------------------------*02230001
022400                                                                  02240001
022500     COPY RCKM836.                                                02250001
022600     EJECT                                                        02260001
022700*----------------------------------------------------------------*02270001
022800*    CALENDAR ROUTINE                                            *02280001
022900*----------------------------------------------------------------*02290001
023000     COPY DPWS500.                                                02300001
023100                                                                  02310001
023200*----------------------------------------------------------------*02320001
023300*    ATTRIBUTE SETTINGS COPYBOOK.                                *02330001
023400*----------------------------------------------------------------*02340001
023500                                                                  02350001
023600     COPY DPWS015.                                                02360001
023700                                                                  02370001
023800*----------------------------------------------------------------*02380001
023900*    FUNCTION KEYS COPYBOOK                                      *02390001
024000*----------------------------------------------------------------*02400001
024100                                                                  02410001
024200     COPY DPWS016.                                                02420001
024300                                                                  02430001
024400*----------------------------------------------------------------*02440001
024500**  SECURITY SUBROUTINE PARAMETERS                                02450001
024600*----------------------------------------------------------------*02460001
024700     COPY DPWS008.                                                02470001
024800                                                                  02480001
024900*---------------------------------------------------------------* 02490001
025000*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 02500001
025100*---------------------------------------------------------------* 02510001
025200     EXEC SQL                                                     02520001
025300          INCLUDE TPURCHS                                         02530001
025400     END-EXEC.                                                    02540001
025500                                                                  02550001
025600*---------------------------------------------------------------* 02560017
025700*    DB2 AREA FOR THE RECEIVER TABLE                            * 02570017
025800*---------------------------------------------------------------* 02580017
025900     EXEC SQL                                                     02590017
026000          INCLUDE TRECEIV                                         02600017
026100     END-EXEC.                                                    02610017
026200                                                                  02620017
026300*----------------------------------------------------------------*02630001
026400*    DB2 SQL COMMUNICATION AREA                                   02640001
026500*----------------------------------------------------------------*02650001
026600     EXEC SQL                                                     02660001
026700          INCLUDE SQLCA                                           02670001
026800     END-EXEC.                                                    02680001
026900                                                                  02690001
027000******************************************************************02700001
027100** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02710001
027200** SUB-ROUTINE (DPKUT100).                                      **02720001
027300******************************************************************02730001
027400     COPY DPWS010I.                                               02740001
027500 EJECT                                                            02750001
027600******************************************************************02760001
027700** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **02770029
027800** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02780001
027900******************************************************************02790001
028000     COPY DPWS030.                                                02800001
028010     COPY DPWS930.                                                02801029
028100 EJECT                                                            02810001
028200***************************************************************** 02820001
028300*    STANDARD COMMAREA.                                           02830001
028400***************************************************************** 02840001
028500                                                                  02850001
028600     COPY DPWS020.                                                02860001
028700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02870001
028800                                                                  02880001
028900*---------------------------------------------------------------* 02890001
029000* INTER-APPLICATION COMMAREA.                                   * 02900001
029100*   SUWS017 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02910001
029200*             THIS LIST PROGRAMMING FOR LOCAL-FUNC-01(SUKCS579).* 02920001
029300*   SUWS018 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02930001
029400*             THIS LIST PROGRAMMING FOR                        .* 02940001
029500*   SUWS023 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02950001
029600*             THIS LIST PROGRAMMING FOR LOCAL-FUNC-03(SUKCS589).* 02960001
029700*---------------------------------------------------------------* 02970001
029800                                                                  02980001
029900         10  INTER-APPL-COMM-AREA PIC X(200).                     02990001
030000     COPY RCWS836.                                                03000001
030100                                                                  03010001
030200***************************************************************** 03020001
030300*    SPECIFIC COMMMAREA FOR RCKCS836.                             03030001
030400***************************************************************** 03040001
030500         10  ASC-SPECIFIC-COMMAREA.                               03050001
030600             15  ASC-OPER-UNIT-ID.                                03060001
030700                 20  ASC-OPER-UNIT-ID-N          PIC  Z(04).      03070003
030800             15  ASC-FROM-REQ-DTE-MM.                             03080001
030900                 20  ASC-FROM-REQ-DTE-MM-N       PIC  9(02).      03090001
031000             15  ASC-FROM-REQ-DTE-DD.                             03100001
031100                 20  ASC-FROM-REQ-DTE-DD-N       PIC  9(02).      03110001
031200             15  ASC-FROM-REQ-DTE-YY.                             03120001
031300                 20  ASC-FROM-REQ-DTE-YY-N       PIC  9(04).      03130001
031400             15  ASC-TO-REQ-DTE-MM.                               03140001
031500                 20  ASC-TO-REQ-DTE-MM-N         PIC  9(02).      03150001
031600             15  ASC-TO-REQ-DTE-DD.                               03160001
031700                 20  ASC-TO-REQ-DTE-DD-N         PIC  9(02).      03170001
031800             15  ASC-TO-REQ-DTE-YY.                               03180001
031900                 20  ASC-TO-REQ-DTE-YY-N         PIC  9(04).      03190001
032000             15  ASC-PO.                                          03200001
032100                 20  ASC-PO-N                    PIC  Z(09).      03210001
032200             15  ASC-RECVR-SEQ-NBR.                               03220001
032300                 20  ASC-RECVR-SEQ-NBR-N         PIC  Z(03).      03230001
032400             15  ASC-LINE-NBR.                                    03240001
032500                 20  ASC-LINE-NBR-N              PIC  Z(04).      03250001
032600             15  ASC-PACK-NBR.                                    03260001
032700                 20  ASC-PACK-NBR-N              PIC  Z(04).      03270001
032800             15  ASC-USER-ID                     PIC  X(08).      03280001
032900*                                                                 03290001
033000*-----------------------------------------------------------------03300001
033100             15  ASC-LIST-QUEUE-NAME.                             03310001
033200                 20  ASC-LIST-TERM-ID         PIC  X(04).         03320001
033300                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  03330001
033400                 20  ASC-LIST-SEQ             PIC  9(01).         03340001
033500             15  ASC-START-ITEM-REQUEST.                          03350001
033600                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         03360001
033700                                                                  03370001
033800             15  ASC-SEL-SUB                  PIC S9(4) COMP.     03380001
033900             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     03390001
034000             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          03400001
034100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03410001
034200             15  ASC-SEL-QUEUE-NAME.                              03420001
034300                 20  ASC-SEL-TERM-ID          PIC  X(04).         03430001
034400                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  03440001
034500                 20  ASC-SEL-SEQ              PIC  9(01).         03450001
034600             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  03460001
034700             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03470001
034800                                                          COMP-3. 03480001
034900             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03490001
035000                                                          COMP-3. 03500001
035100             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03510001
035200                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03520001
035300                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03530001
035400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03540001
035500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03550001
035600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03560001
035700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03570001
035800             15  FILLER                              PIC  X(2679).03580001
035900                                                                  03590001
036000     EJECT                                                        03600001
036100*----------------------------------------------------------------*03610001
036200*    ABEND PROCESSING COPYBOOK.                                  *03620001
036300*----------------------------------------------------------------*03630001
036400                                                                  03640001
036500     COPY DPWS013.                                                03650001
036600                                                                  03660001
036700                                                                  03670001
036800 EJECT                                                            03680001
036900 LINKAGE SECTION.                                                 03690001
037000                                                                  03700001
037100 01  DFHCOMMAREA.                                                 03710001
037200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03720001
037300                                        DEPENDING ON EIBCALEN.    03730001
037400         10  FILLER                     PIC X.                    03740001
037500                                                                  03750001
037600                                                                  03760001
037700 PROCEDURE DIVISION.                                              03770001
037800***************************************************************** 03780001
037900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03790001
038000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03800001
038100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03810001
038200**                                                             ** 03820001
038300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03830001
038400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03840001
038500***************************************************************** 03850001
038600 0000-MAIN-MODULE.                                                03860001
038700     INITIALIZE DP030-CICS-API-FIELDS.                            03870001
038800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03880001
038900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03890001
039000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03900001
039100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03910001
039200     MOVE LENGTH OF RC836AI        TO DP030-MAP-LENGTH (1).       03920001
039300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03930001
039400     PERFORM 0001-CALL-CICS-ARCH-API.                             03940001
039500*                                                                 03950001
039600     PERFORM 1000-CONTROL-PROCESSING                              03960001
039700*                                                                 03970001
039800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03980001
039900     PERFORM 0001-CALL-CICS-ARCH-API.                             03990001
040000                                                                  04000001
040100 0001-CALL-CICS-ARCH-API.                                         04010001
040210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04021029
040300                                    DFHCOMMAREA                   04030029
040400                                    DP030-CICS-API-FIELDS         04040029
040500                                    DP020-STANDARD-COMMAREA       04050029
040600                                    RC836AI.                      04060029
040700*                                                                 04070001
040800     IF  DP030-RC-CALL-SUCCESSFUL                                 04080001
040900         CONTINUE                                                 04090001
041000     ELSE                                                         04100001
041100         SET DP013-NO-ROLLBACK                                    04110001
041200             DP013-XCTL-DISPLAY-RESTART                           04120001
041300             DP013-CICS-ABEND      TO TRUE                        04130001
041400         MOVE 'BEFORE 0000-MAIN-MODULE'                           04140001
041500                                   TO DP013-PARAGRAPH             04150001
041520         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O04152029
041530-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04153029
041800         MOVE DP030-RETURN-CODE                                   04180001
041900                                   TO DP013-MESSAGE-TEXT (3)      04190001
042000         PERFORM DP013-0000-PROCESS-ABEND                         04200001
042100     END-IF.                                                      04210001
042200 EJECT                                                            04220001
042300*----------------------------------------------------------------*04230001
042400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04240001
042500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04250001
042600*----------------------------------------------------------------*04260001
042700                                                                  04270001
042800 1000-CONTROL-PROCESSING.                                         04280001
042900                                                                  04290001
043000     EVALUATE TRUE                                                04300001
043100         WHEN DP020-NEXT-ACT-INITIAL                              04310001
043200             INITIALIZE ASC-SPECIFIC-COMMAREA                     04320001
043300             MOVE DP020-LOCATION-NBR  TO PV-DP020-LOCATION        04330015
043400             IF  DP020-LOCATION-TYPE = 'DC'                       04340003
043500                 MOVE PV-LOCATION TO ASC-OPER-UNIT-ID             04350003
043600             ELSE                                                 04360003
043700                 MOVE SPACES      TO ASC-OPER-UNIT-ID             04370003
043800             END-IF                                               04380003
043900             EXEC SQL                                             04390006
044000                 SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP     04400006
044100             END-EXEC                                             04410006
044200             MOVE PV-DB2-CURRENT-CCYY   TO ASC-FROM-REQ-DTE-YY    04420006
044300             MOVE PV-DB2-CURRENT-MM     TO ASC-FROM-REQ-DTE-MM    04430006
044400             MOVE PV-DB2-CURRENT-DD     TO ASC-FROM-REQ-DTE-DD    04440006
044500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            04450001
044600                                      ASC-SEL-TERM-ID             04460001
044700             MOVE DP020-SRC-TASK-NUMBER                           04470001
044800                                   TO ASC-LIST-TASK-NUMBER        04480001
044900                                      ASC-SEL-TASK-NUMBER         04490001
045000             MOVE PC-LIST-QUEUE-SEQ                               04500001
045100                                   TO ASC-LIST-SEQ                04510001
045200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 04520001
045300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04530001
045400***-----$TEMPLATE NOTE$-------------------------------------------04540001
045500*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,04550001
045600*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  04560001
045700*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.04570001
045800***---------------------------------------------------------------04580001
045900             IF  PS-COMMAREA-NOT-VALID                            04590001
046000                 SET DP020-NEXT-ACT-APPL-ERROR                    04600001
046100                                   TO TRUE                        04610001
046200             ELSE                                                 04620001
046300                 PERFORM 4000-BUILD-INITIAL-PANEL                 04630001
046400                 PERFORM 3200-RESET-ATTRIBUTES                    04640001
046500             END-IF                                               04650001
046600                                                                  04660001
046700         WHEN DP020-NEXT-ACT-READ-MAP                             04670001
046800             PERFORM 2000-FKEY-PROCESSING                         04680001
046900                                                                  04690001
047000         WHEN DP020-NEXT-ACT-RETURN                               04700001
047100             INITIALIZE ASC-SPECIFIC-COMMAREA                     04710001
047200             MOVE DP020-LOCATION-NBR  TO PV-DP020-LOCATION        04720015
047300             IF  DP020-LOCATION-TYPE = 'DC'                       04730005
047400                 MOVE PV-LOCATION TO ASC-OPER-UNIT-ID             04740005
047500             ELSE                                                 04750005
047600                 MOVE SPACES      TO ASC-OPER-UNIT-ID             04760005
047700             END-IF                                               04770005
047800             EXEC SQL                                             04780006
047900                 SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP     04790006
048000             END-EXEC                                             04800006
048100             MOVE PV-DB2-CURRENT-CCYY   TO ASC-FROM-REQ-DTE-YY    04810006
048200             MOVE PV-DB2-CURRENT-MM     TO ASC-FROM-REQ-DTE-MM    04820006
048300             MOVE PV-DB2-CURRENT-DD     TO ASC-FROM-REQ-DTE-DD    04830006
048400             PERFORM 4000-BUILD-INITIAL-PANEL                     04840001
048500             PERFORM 3200-RESET-ATTRIBUTES                        04850001
048600                                                                  04860001
048700         WHEN OTHER                                               04870001
048800             SET DP013-LOGIC-ABEND                                04880001
048900                 DP013-NO-ROLLBACK TO TRUE                        04890001
049000             MOVE '1000-CONTROL-PROCESSING'                       04900001
049100                                   TO  DP013-PARAGRAPH            04910001
049200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04920001
049300                                   TO  DP013-MESSAGE-TEXT(1)      04930001
049400             MOVE DP020-NEXT-APPL-ACTIVITY                        04940001
049500                                   TO DP013-MESSAGE-TEXT(2)       04950001
049600             PERFORM DP013-0000-PROCESS-ABEND                     04960001
049700     END-EVALUATE.                                                04970001
049800                                                                  04980001
049900 1100-PROCESS-INTER-APPL-COMM.                                    04990001
050000                                                                  05000001
050100     SET PS-COMMAREA-VALID         TO TRUE.                       05010001
050200     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     05020001
050300                                                                  05030001
050400                                                                  05040001
050500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05050001
050600*1120-PREPARE-LIST-ENTRY.                                         05060001
050700*                                                                 05070001
050800*    MOVE SU019-MAX-ITEMS          TO ASC-SEL-SUB.                05080001
050900*    MOVE ZERO                     TO ASC-SEL-ITEM.               05090001
051000*    PERFORM 1130-GET-NEXT-RECORD.                                05100001
051100                                                                  05110001
051200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05120001
051300*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*05130001
051400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05140001
051500*1130-GET-NEXT-RECORD.                                            05150001
051600*                                                                 05160001
051700*    ADD +1                       TO ASC-SEL-ITEM.                05170001
051800*    MOVE +1                      TO ASC-SEL-SUB.                 05180001
051900*                                                                 05190001
052000*    PERFORM 9100-READ-SEL-QUEUE.                                 05200001
052100                                                                  05210001
052200                                                                  05220001
052300*----------------------------------------------------------------*05230001
052400* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*05240001
052500* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*05250001
052600* EDITS.                                                         *05260001
052700*----------------------------------------------------------------*05270001
052800                                                                  05280001
052900 2000-FKEY-PROCESSING.                                            05290001
053000                                                                  05300001
053100     EVALUATE TRUE                                                05310001
053200                                                                  05320001
053300         WHEN DP020-SRC-AID = DP016-CLEAR                         05330001
053400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05340001
053500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05350001
053600*F5 - REFRESH                                                     05360001
053700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05370001
053800             INITIALIZE ASC-SPECIFIC-COMMAREA                     05380001
053900             MOVE DP020-LOCATION-NBR  TO PV-DP020-LOCATION        05390015
054000             IF  DP020-LOCATION-TYPE = 'DC'                       05400005
054100                 MOVE PV-LOCATION TO ASC-OPER-UNIT-ID             05410005
054200             ELSE                                                 05420005
054300                 MOVE SPACES      TO ASC-OPER-UNIT-ID             05430005
054400             END-IF                                               05440005
054500             EXEC SQL                                             05450006
054600                 SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP     05460006
054700             END-EXEC                                             05470006
054800             MOVE PV-DB2-CURRENT-CCYY   TO ASC-FROM-REQ-DTE-YY    05480006
054900             MOVE PV-DB2-CURRENT-MM     TO ASC-FROM-REQ-DTE-MM    05490006
055000             MOVE PV-DB2-CURRENT-DD     TO ASC-FROM-REQ-DTE-DD    05500006
055100             PERFORM 4000-BUILD-INITIAL-PANEL                     05510001
055200             PERFORM 3200-RESET-ATTRIBUTES                        05520001
055300                                                                  05530001
055400         WHEN OTHER                                               05540001
055500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05550001
055600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05560001
055700             IF  PS-NO-ERROR                                      05570001
055800                 SET DP030-CONTINUE-GO TO TRUE                    05580001
055900                 PERFORM 2100-CHECK-FUNCTION-KEY                  05590001
056000             ELSE                                                 05600001
056100                 SET DP030-OVERRIDE-GO TO TRUE                    05610001
056200             END-IF                                               05620001
056300     END-EVALUATE.                                                05630001
056400******************************************************************05640001
056500** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **05650001
056600** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **05660001
056700** FROM THE CICS ARCHITECTURE API.                              **05670001
056800******************************************************************05680001
056900 2100-CHECK-FUNCTION-KEY.                                         05690001
057000     EVALUATE TRUE                                                05700001
057100         WHEN DP020-SRC-AID = DP016-ENTER                         05710001
057200             CONTINUE                                             05720001
057300                                                                  05730001
057400                                                                  05740001
057500* F23 - TRACKING LIST  (LOCAL-FUNC-01) (RCKCS837)                 05750001
057600*                                                                 05760001
057700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05770001
057800                                                                  05780001
057900             IF (ASC-OPER-UNIT-ID-N = ZEROES          OR          05790001
058000                 ASC-OPER-UNIT-ID = SPACES)           AND         05800001
058100                 (ASC-PO-N             = ZEROES  OR               05810001
058200                  ASC-PO               = SPACES)                  05820002
058300                 SET  PS-ERROR                                    05830001
058400                      DP020-MSG-FATAL TO TRUE                     05840001
058500                 MOVE PC-TSYMSG-02912                             05850001
058600                              TO DP020-MSG-NUMBER                 05860001
058700                 MOVE DP015-UNP-ALP-BRT-OFF                       05870001
058800                                       TO AOPRUNTA                05880001
058900                 MOVE DP015-RED        TO AOPRUNTC                05890001
059000                 MOVE DP015-REVERSE    TO AOPRUNTH                05900001
059100                                                                  05910001
059200                 MOVE DP015-UNP-ALP-BRT-OFF                       05920001
059300                                       TO APOA                    05930001
059400                 MOVE DP015-RED        TO APOC                    05940001
059500                 MOVE DP015-REVERSE    TO APOH                    05950001
059600                                                                  05960001
059700                 MOVE -1               TO AOPRUNTL                05970001
059800                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             05980001
059900                 SET  DP030-OVERRIDE-GO       TO TRUE             05990001
060000             ELSE                                                 06000001
060100                 PERFORM 2110-PREPARE-INTER-APPL-COMM             06010001
060200             END-IF                                               06020001
060300                                                                  06030001
060400         WHEN OTHER                                               06040001
060500             SET DP013-NO-ROLLBACK                                06050001
060600                 DP013-XCTL-DISPLAY-RESTART                       06060001
060700                 DP013-CICS-ABEND  TO TRUE                        06070001
060800             MOVE '2100-CHECK-FUNCTION-KEY'                       06080001
060900                                   TO DP013-PARAGRAPH             06090001
061000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06100001
061100                                   TO DP013-MESSAGE-TEXT (1)      06110001
061200             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 06120001
061300                                   TO DP013-MESSAGE-TEXT (2)      06130001
061400             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                06140001
061500             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 06150001
061600                                   TO PM-A-FK-ACTION              06160001
061700             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              06170001
061800                                   TO PM-A-FK-DISPN               06180001
061900             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      06190001
062000             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        06200001
062100                                   TO DP013-MESSAGE-TEXT (4)      06210001
062200             PERFORM DP013-0000-PROCESS-ABEND                     06220001
062300     END-EVALUATE.                                                06230001
062400                                                                  06240001
062500*----------------------------------------------------------------*06250001
062600* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     06260001
062700*----------------------------------------------------------------*06270001
062800 2105-RACF-ACCESS.                                                06280001
062900                                                                  06290001
063000      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  06300001
063100      SET DP008-ACCESS-TYPE-USE          TO TRUE                  06310001
063200                                                                  06320001
063300      EXEC CICS                                                   06330001
063400         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 06340001
063500              COMMAREA (DP008-SECURITY-COMMAREA)                  06350001
063600              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             06360001
063700      END-EXEC                                                    06370001
063800                                                                  06380001
063900      IF DP008-CALL-SUCCESSFUL                                    06390001
064000         IF DP008-ACCESS-ALLOWED                                  06400001
064100             SET PS-ACCESS-ALLOWED TO TRUE                        06410001
064200         ELSE                                                     06420001
064300             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    06430001
064400         END-IF                                                   06440001
064500     ELSE                                                         06450001
064600         MOVE '2105-RACF-ACCESS'                                  06460001
064700                               TO DP013-PARAGRAPH                 06470001
064800          MOVE 'UNABLE TO ACCESS CICS'                            06480001
064900                               TO DP013-MESSAGE-TEXT (1)          06490001
065000          MOVE SQLCA                 TO DP013-SQLCA               06500001
065100          SET DP013-DB2-ABEND                                     06510001
065200              DP013-XCTL-DISPLAY-RESTART                          06520001
065300                               TO TRUE                            06530001
065400          PERFORM DP013-0000-PROCESS-ABEND                        06540001
065500      END-IF.                                                     06550001
065600                                                                  06560001
065700******************************************************************06570001
065800** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06580001
065900** INTER-APPLICATION COMMAREA.                                  **06590001
066000******************************************************************06600001
066100 2110-PREPARE-INTER-APPL-COMM.                                    06610001
066200                                                                  06620016
066300     EVALUATE TRUE                                                06630001
066400                                                                  06640001
066500*WHEN F23 PRESSED                                                 06650001
066600       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                06660004
066700         INITIALIZE RC836-INTER-APPL-COMMAREA                     06670001
066800                                                                  06680001
066900         EVALUATE TRUE                                            06690001
067000           WHEN ASC-OPER-UNIT-ID NOT = SPACES                     06700001
067100              MOVE ASC-OPER-UNIT-ID     TO RC836-OPER-UNIT-ID-N   06710021
067200           WHEN ASC-OPER-UNIT-ID     = SPACES                     06720021
067300              PERFORM 2120-GET-CURR-OPER-UNT-ID                   06730022
067400              MOVE PV-OPER-UNT-ID-N     TO RC836-OPER-UNIT-ID-N   06740023
067500         END-EVALUATE                                             06750001
067600         MOVE ASC-PO-N                 TO RC836-PO                06760001
067700         MOVE ASC-RECVR-SEQ-NBR-N      TO RC836-RECEIVER-SEQ      06770001
067800         MOVE ASC-LINE-NBR-N           TO RC836-LINE-NBR          06780001
067900         MOVE ASC-PACK-NBR-N           TO RC836-PACK-NBR          06790001
068000         MOVE ASC-USER-ID              TO RC836-USER-ID           06800001
068100                                                                  06810001
068200         MOVE ASC-FROM-REQ-DTE-MM-N     TO RC836-FROM-DATE-MM     06820001
068300         MOVE ASC-FROM-REQ-DTE-DD-N     TO RC836-FROM-DATE-DD     06830001
068400         MOVE ASC-FROM-REQ-DTE-YY-N     TO RC836-FROM-DATE-YY     06840001
068500         IF ASC-TO-REQ-DTE-MM = SPACES AND                        06850009
068600            ASC-TO-REQ-DTE-DD = SPACES AND                        06860009
068700            ASC-TO-REQ-DTE-YY = SPACES                            06870009
068800             MOVE ASC-FROM-REQ-DTE-MM-N TO RC836-TO-DATE-MM       06880009
068900             MOVE ASC-FROM-REQ-DTE-DD-N TO RC836-TO-DATE-DD       06890009
069000             MOVE ASC-FROM-REQ-DTE-YY-N TO RC836-TO-DATE-YY       06900009
069100         ELSE                                                     06910009
069200             MOVE ASC-TO-REQ-DTE-MM-N   TO RC836-TO-DATE-MM       06920009
069300             MOVE ASC-TO-REQ-DTE-DD-N   TO RC836-TO-DATE-DD       06930009
069400             MOVE ASC-TO-REQ-DTE-YY-N   TO RC836-TO-DATE-YY       06940009
069500         END-IF                                                   06950010
069600                                                                  06960001
069700     END-EVALUATE.                                                06970001
069800 EJECT                                                            06980001
069900                                                                  06990016
070000 2120-GET-CURR-OPER-UNT-ID.                                       07000016
070100     EXEC SQL                                                     07010016
070200        SELECT CURR_OPER_UNT_ID                                   07020016
070300         INTO :RECEIV-CURR-OPER-UNT-ID                            07030016
070400         FROM TRECEIV                                             07040016
070500        WHERE ORD_NBR          = :DK-PO-NBR                       07050016
070600          AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR                  07060016
070700          AND VER_STATUS_CDE   = 'A'                              07070016
070800     END-EXEC.                                                    07080016
070900                                                                  07090016
071000     EVALUATE TRUE                                                07100016
071100         WHEN SQLCODE = +0                                        07110016
071200             MOVE RECEIV-CURR-OPER-UNT-ID TO PV-OPER-UNT-ID       07120023
071300         WHEN SQLCODE = +100                                      07130016
071400             CONTINUE                                             07140016
071500         WHEN SQLWARN0 NOT = SPACE                                07150016
071600         WHEN SQLCODE < +0                                        07160016
071700         WHEN SQLCODE > +0                                        07170016
071800             MOVE '2120-GET-CURR-OPER-UNT-ID'                     07180016
071900                             TO DP013-PARAGRAPH                   07190016
072000             MOVE 'GET CURR OPER UNT ID'                          07200016
072100                             TO DP013-MESSAGE-TEXT (1)            07210016
072200             MOVE SQLCA      TO DP013-SQLCA                       07220016
072300             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)          07230016
072400             SET DP013-DB2-ABEND                                  07240016
072500                             TO TRUE                              07250016
072600             SET DP013-XCTL-DISPLAY-RESTART                       07260016
072700                             TO TRUE                              07270016
072800             PERFORM DP013-0000-PROCESS-ABEND                     07280016
072900     END-EVALUATE.                                                07290016
073000                                                                  07300016
073100                                                                  07310016
073200*----------------------------------------------------------------*07320001
073300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*07330001
073400* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *07340001
073500* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *07350001
073600*----------------------------------------------------------------*07360001
073700                                                                  07370001
073800 2200-MOVE-SCREEN-TO-COMMAREA.                                    07380001
073900                                                                  07390001
074000     IF  AOPRUNTL > ZERO                                          07400001
074100         MOVE AOPRUNTI             TO ASC-OPER-UNIT-ID            07410001
074200     ELSE                                                         07420001
074300         IF  AOPRUNTF = DP015-ERASE-EOF                           07430001
074400             MOVE SPACE            TO ASC-OPER-UNIT-ID            07440001
074500                                      AOPRDSCO                    07450001
074600         ELSE                                                     07460001
074700             IF ASC-OPER-UNIT-ID = SPACES                         07470001
074800                 MOVE SPACE       TO  AOPRDSCO                    07480001
074900             END-IF                                               07490001
075000         END-IF                                                   07500001
075100     END-IF.                                                      07510001
075200                                                                  07520001
075300     IF  AREQFMML > ZERO                                          07530001
075400         MOVE AREQFMMI             TO ASC-FROM-REQ-DTE-MM         07540001
075500     ELSE                                                         07550001
075600         IF  AREQFMMF = DP015-ERASE-EOF                           07560001
075700             MOVE SPACE            TO ASC-FROM-REQ-DTE-MM         07570001
075800         END-IF                                                   07580001
075900     END-IF.                                                      07590001
076000                                                                  07600001
076100     IF  AREQFDDL > ZERO                                          07610001
076200         MOVE AREQFDDI             TO ASC-FROM-REQ-DTE-DD         07620001
076300     ELSE                                                         07630001
076400         IF  AREQFDDF = DP015-ERASE-EOF                           07640001
076500             MOVE SPACE            TO ASC-FROM-REQ-DTE-DD         07650001
076600         END-IF                                                   07660001
076700     END-IF.                                                      07670001
076800                                                                  07680001
076900     IF  AREQFYYL > ZERO                                          07690001
077000         MOVE AREQFYYI             TO ASC-FROM-REQ-DTE-YY         07700001
077100     ELSE                                                         07710001
077200         IF  AREQFYYF = DP015-ERASE-EOF                           07720001
077300             MOVE SPACE            TO ASC-FROM-REQ-DTE-YY         07730001
077400         END-IF                                                   07740001
077500     END-IF.                                                      07750001
077600                                                                  07760001
077700     IF  AREQTMML > ZERO                                          07770001
077800         MOVE AREQTMMI             TO ASC-TO-REQ-DTE-MM           07780001
077900     ELSE                                                         07790001
078000         IF  AREQTMMF = DP015-ERASE-EOF                           07800001
078100             MOVE SPACE            TO ASC-TO-REQ-DTE-MM           07810001
078200         END-IF                                                   07820001
078300     END-IF.                                                      07830001
078400                                                                  07840001
078500     IF  AREQTDDL > ZERO                                          07850001
078600         MOVE AREQTDDI             TO ASC-TO-REQ-DTE-DD           07860001
078700     ELSE                                                         07870001
078800         IF  AREQTDDF = DP015-ERASE-EOF                           07880001
078900             MOVE SPACE            TO ASC-TO-REQ-DTE-DD           07890001
079000         END-IF                                                   07900001
079100     END-IF.                                                      07910001
079200                                                                  07920001
079300     IF  AREQTYYL > ZERO                                          07930001
079400         MOVE AREQTYYI             TO ASC-TO-REQ-DTE-YY           07940001
079500     ELSE                                                         07950001
079600         IF  AREQTYYF = DP015-ERASE-EOF                           07960001
079700             MOVE SPACE            TO ASC-TO-REQ-DTE-YY           07970001
079800         END-IF                                                   07980001
079900     END-IF.                                                      07990001
080000                                                                  08000001
080100     IF  APOL     > ZERO                                          08010001
080200         MOVE APOI                 TO ASC-PO                      08020001
080300     ELSE                                                         08030001
080400         IF  APOF     = DP015-ERASE-EOF                           08040001
080500             MOVE SPACE            TO ASC-PO                      08050001
080600         END-IF                                                   08060001
080700     END-IF.                                                      08070001
080800                                                                  08080001
080900     IF  ARECSEQL > ZERO                                          08090001
081000         MOVE ARECSEQI             TO ASC-RECVR-SEQ-NBR           08100001
081100     ELSE                                                         08110001
081200         IF  ARECSEQF = DP015-ERASE-EOF                           08120001
081300             MOVE SPACE            TO ASC-RECVR-SEQ-NBR           08130001
081400         END-IF                                                   08140001
081500     END-IF.                                                      08150001
081600                                                                  08160001
081700     IF  ALINNBRL > ZERO                                          08170001
081800         MOVE ALINNBRI             TO ASC-LINE-NBR                08180001
081900     ELSE                                                         08190001
082000         IF  ALINNBRF = DP015-ERASE-EOF                           08200001
082100             MOVE SPACE            TO ASC-LINE-NBR                08210001
082200         END-IF                                                   08220001
082300     END-IF.                                                      08230001
082400                                                                  08240001
082500     IF  APAKNBRL > ZERO                                          08250001
082600         MOVE APAKNBRI             TO ASC-PACK-NBR                08260001
082700     ELSE                                                         08270001
082800         IF  APAKNBRF = DP015-ERASE-EOF                           08280001
082900             MOVE SPACE            TO ASC-PACK-NBR                08290001
083000         END-IF                                                   08300001
083100     END-IF.                                                      08310001
083200                                                                  08320001
083300     IF  AUSERIDL > ZERO                                          08330001
083400         MOVE AUSERIDI             TO ASC-USER-ID                 08340001
083500     ELSE                                                         08350001
083600         IF  AUSERIDF = DP015-ERASE-EOF                           08360001
083700             MOVE SPACE            TO ASC-USER-ID                 08370001
083800         END-IF                                                   08380001
083900     END-IF.                                                      08390001
084000                                                                  08400001
084100                                                                  08410001
084200*----------------------------------------------------------------*08420001
084300* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *08430001
084400* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *08440001
084500* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*08450001
084600* IN THE DESTINATION PROGRAM, NOT HERE.                          *08460001
084700*----------------------------------------------------------------*08470001
084800                                                                  08480001
084900 3000-EDIT-DATA-IN-COMMAREA.                                      08490001
085000                                                                  08500001
085100     PERFORM 3200-RESET-ATTRIBUTES.                               08510001
085200                                                                  08520001
085300     IF  ASC-TO-REQ-DTE-YY > SPACE                                08530001
085400         MOVE ASC-TO-REQ-DTE-YY TO DP010I-UNEDITED-FIELD          08540001
085500         MOVE LENGTH OF ASC-TO-REQ-DTE-YY                         08550001
085600                                   TO DP010I-MAXIMUM-DIGITS       08560001
085700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08570001
085800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08580001
085900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08590029
085910              USING DP010I-NUMERIC-EDIT-AREA                      08591029
086000         IF  DP010I-ERROR-DETECTED                                08600001
086100             SET PS-ERROR                                         08610001
086200                 PS-NUM-ERROR                                     08620001
086300                 DP020-MSG-FATAL   TO TRUE                        08630001
086400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08640001
086500             MOVE DP015-UNP-ALP-BRT-OFF                           08650001
086600                                   TO AREQTYYA                    08660001
086700             MOVE DP015-RED        TO AREQTYYC                    08670001
086800             MOVE DP015-REVERSE    TO AREQTYYH                    08680001
086900             MOVE -1               TO AREQTYYL                    08690001
087000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08700001
087100         ELSE                                                     08710001
087200             MOVE DP010I-NUMERIC-FIELD                            08720001
087300                                   TO ASC-TO-REQ-DTE-YY-N         08730001
087400             MOVE ASC-TO-REQ-DTE-YY TO AREQTYYO                   08740001
087500         END-IF                                                   08750001
087600     END-IF.                                                      08760001
087700*                                                                 08770001
087800     IF  ASC-TO-REQ-DTE-DD > SPACE                                08780001
087900         MOVE ASC-TO-REQ-DTE-DD TO DP010I-UNEDITED-FIELD          08790001
088000         MOVE LENGTH OF ASC-TO-REQ-DTE-DD                         08800001
088100                                   TO DP010I-MAXIMUM-DIGITS       08810001
088200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08820001
088300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08830001
088400         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08840029
088410              USING DP010I-NUMERIC-EDIT-AREA                      08841029
088500         IF  DP010I-ERROR-DETECTED                                08850001
088600             SET PS-ERROR                                         08860001
088700                 PS-NUM-ERROR                                     08870001
088800                 DP020-MSG-FATAL   TO TRUE                        08880001
088900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08890001
089000             MOVE DP015-UNP-ALP-BRT-OFF                           08900001
089100                                   TO AREQTDDA                    08910001
089200             MOVE DP015-RED        TO AREQTDDC                    08920001
089300             MOVE DP015-REVERSE    TO AREQTDDH                    08930001
089400             MOVE -1               TO AREQTDDL                    08940001
089500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08950001
089600         ELSE                                                     08960001
089700             MOVE DP010I-NUMERIC-FIELD                            08970001
089800                                   TO ASC-TO-REQ-DTE-DD-N         08980001
089900             MOVE ASC-TO-REQ-DTE-DD TO AREQTDDO                   08990001
090000         END-IF                                                   09000001
090100     END-IF.                                                      09010001
090200*                                                                 09020001
090300     IF  ASC-TO-REQ-DTE-MM > SPACE                                09030001
090400         MOVE ASC-TO-REQ-DTE-MM TO DP010I-UNEDITED-FIELD          09040001
090500         MOVE LENGTH OF ASC-TO-REQ-DTE-MM                         09050001
090600                                   TO DP010I-MAXIMUM-DIGITS       09060001
090700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09070001
090800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09080001
090900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09090029
090910              USING DP010I-NUMERIC-EDIT-AREA                      09091029
091000         IF  DP010I-ERROR-DETECTED                                09100001
091100             SET PS-ERROR                                         09110001
091200                 PS-NUM-ERROR                                     09120001
091300                 DP020-MSG-FATAL   TO TRUE                        09130001
091400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09140001
091500             MOVE DP015-UNP-ALP-BRT-OFF                           09150001
091600                                   TO AREQTMMA                    09160001
091700             MOVE DP015-RED        TO AREQTMMC                    09170001
091800             MOVE DP015-REVERSE    TO AREQTMMH                    09180001
091900             MOVE -1               TO AREQTMML                    09190001
092000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09200001
092100         ELSE                                                     09210001
092200             MOVE DP010I-NUMERIC-FIELD                            09220001
092300                                   TO ASC-TO-REQ-DTE-MM-N         09230001
092400             MOVE ASC-TO-REQ-DTE-MM TO AREQTMMO                   09240001
092500         END-IF                                                   09250001
092600     END-IF.                                                      09260001
092700*                                                                 09270001
092800     IF  ASC-FROM-REQ-DTE-YY > SPACE                              09280001
092900         MOVE ASC-FROM-REQ-DTE-YY TO         DP010I-UNEDITED-FIELD09290001
093000         MOVE LENGTH OF ASC-FROM-REQ-DTE-YY                       09300001
093100                                   TO DP010I-MAXIMUM-DIGITS       09310001
093200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09320001
093300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09330001
093400         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09340029
093410              USING DP010I-NUMERIC-EDIT-AREA                      09341029
093500         IF  DP010I-ERROR-DETECTED                                09350001
093600             SET PS-ERROR                                         09360001
093700                 PS-NUM-ERROR                                     09370001
093800                 DP020-MSG-FATAL   TO TRUE                        09380001
093900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09390001
094000             MOVE DP015-UNP-ALP-BRT-OFF                           09400001
094100                                   TO AREQFYYA                    09410001
094200             MOVE DP015-RED        TO AREQFYYC                    09420001
094300             MOVE DP015-REVERSE    TO AREQFYYH                    09430001
094400             MOVE -1               TO AREQFYYL                    09440001
094500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09450001
094600         ELSE                                                     09460001
094700             MOVE DP010I-NUMERIC-FIELD                            09470001
094800                               TO ASC-FROM-REQ-DTE-YY-N           09480001
094900             MOVE ASC-FROM-REQ-DTE-YY TO AREQFYYO                 09490001
095000         END-IF                                                   09500001
095100     END-IF.                                                      09510001
095200*                                                                 09520001
095300     IF  ASC-FROM-REQ-DTE-DD > SPACE                              09530001
095400         MOVE ASC-FROM-REQ-DTE-DD TO         DP010I-UNEDITED-FIELD09540001
095500         MOVE LENGTH OF ASC-FROM-REQ-DTE-DD                       09550001
095600                                   TO DP010I-MAXIMUM-DIGITS       09560001
095700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09570001
095800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09580001
095900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09590029
095910              USING DP010I-NUMERIC-EDIT-AREA                      09591029
096000         IF  DP010I-ERROR-DETECTED                                09600001
096100             SET PS-ERROR                                         09610001
096200                 PS-NUM-ERROR                                     09620001
096300                 DP020-MSG-FATAL   TO TRUE                        09630001
096400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09640001
096500             MOVE DP015-UNP-ALP-BRT-OFF                           09650001
096600                                   TO AREQFDDA                    09660001
096700             MOVE DP015-RED        TO AREQFDDC                    09670001
096800             MOVE DP015-REVERSE    TO AREQFDDH                    09680001
096900             MOVE -1               TO AREQFDDL                    09690001
097000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09700001
097100         ELSE                                                     09710001
097200             MOVE DP010I-NUMERIC-FIELD                            09720001
097300                                 TO ASC-FROM-REQ-DTE-DD-N         09730001
097400             MOVE ASC-FROM-REQ-DTE-DD TO AREQFDDO                 09740001
097500         END-IF                                                   09750001
097600     END-IF.                                                      09760001
097700*                                                                 09770001
097800     IF  ASC-FROM-REQ-DTE-MM > SPACE                              09780001
097900         MOVE ASC-FROM-REQ-DTE-MM TO         DP010I-UNEDITED-FIELD09790001
098000         MOVE LENGTH OF ASC-FROM-REQ-DTE-MM                       09800001
098100                                   TO DP010I-MAXIMUM-DIGITS       09810001
098200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09820001
098300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09830001
098400         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09840029
098410              USING DP010I-NUMERIC-EDIT-AREA                      09841029
098500         IF  DP010I-ERROR-DETECTED                                09850001
098600             SET PS-ERROR                                         09860001
098700                 PS-NUM-ERROR                                     09870001
098800                 DP020-MSG-FATAL   TO TRUE                        09880001
098900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09890001
099000             MOVE DP015-UNP-ALP-BRT-OFF                           09900001
099100                                   TO AREQFMMA                    09910001
099200             MOVE DP015-RED        TO AREQFMMC                    09920001
099300             MOVE DP015-REVERSE    TO AREQFMMH                    09930001
099400             MOVE -1               TO AREQFMML                    09940001
099500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09950001
099600         ELSE                                                     09960001
099700             MOVE DP010I-NUMERIC-FIELD                            09970001
099800                               TO ASC-FROM-REQ-DTE-MM-N           09980001
099900             MOVE ASC-FROM-REQ-DTE-MM TO AREQFMMO                 09990001
100000         END-IF                                                   10000001
100100     END-IF.                                                      10010001
100200                                                                  10020001
100300     IF  ASC-FROM-REQ-DTE-MM = SPACE AND                          10030001
100400        (ASC-FROM-REQ-DTE-DD > SPACE OR                           10040001
100500         ASC-FROM-REQ-DTE-YY > SPACE)                             10050001
100600         SET PS-ERROR                                             10060001
100700             DP020-MSG-FATAL   TO TRUE                            10070001
100800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10080001
100900         MOVE DP015-UNP-ALP-BRT-OFF                               10090001
101000                               TO AREQFMMA                        10100001
101100         MOVE DP015-RED        TO AREQFMMC                        10110001
101200         MOVE DP015-REVERSE    TO AREQFMMH                        10120001
101300         MOVE -1               TO AREQFMML                        10130001
101400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10140001
101500     END-IF.                                                      10150001
101600                                                                  10160001
101700     IF  ASC-FROM-REQ-DTE-DD = SPACE AND                          10170001
101800        (ASC-FROM-REQ-DTE-MM > SPACE OR                           10180001
101900         ASC-FROM-REQ-DTE-YY > SPACE)                             10190001
102000         SET PS-ERROR                                             10200001
102100             DP020-MSG-FATAL   TO TRUE                            10210001
102200         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10220001
102300         MOVE DP015-UNP-ALP-BRT-OFF                               10230001
102400                               TO AREQFDDA                        10240001
102500         MOVE DP015-RED        TO AREQFDDC                        10250001
102600         MOVE DP015-REVERSE    TO AREQFDDH                        10260001
102700         MOVE -1               TO AREQFDDL                        10270001
102800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10280001
102900     END-IF.                                                      10290001
103000                                                                  10300001
103100     IF  ASC-FROM-REQ-DTE-YY = SPACE AND                          10310001
103200        (ASC-FROM-REQ-DTE-DD > SPACE OR                           10320001
103300         ASC-FROM-REQ-DTE-MM > SPACE)                             10330001
103400         SET PS-ERROR                                             10340001
103500             DP020-MSG-FATAL   TO TRUE                            10350001
103600         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10360001
103700         MOVE DP015-UNP-ALP-BRT-OFF                               10370001
103800                               TO AREQFYYA                        10380001
103900         MOVE DP015-RED        TO AREQFYYC                        10390001
104000         MOVE DP015-REVERSE    TO AREQFYYH                        10400001
104100         MOVE -1               TO AREQFYYL                        10410001
104200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10420001
104300     END-IF.                                                      10430001
104400                                                                  10440001
104500     IF  ASC-TO-REQ-DTE-MM = SPACE AND                            10450001
104600        (ASC-TO-REQ-DTE-DD > SPACE OR                             10460001
104700         ASC-TO-REQ-DTE-YY > SPACE)                               10470001
104800         SET PS-ERROR                                             10480001
104900             DP020-MSG-FATAL   TO TRUE                            10490001
105000         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10500001
105100         MOVE DP015-UNP-ALP-BRT-OFF                               10510001
105200                               TO AREQTMMA                        10520001
105300         MOVE DP015-RED        TO AREQTMMC                        10530001
105400         MOVE DP015-REVERSE    TO AREQTMMH                        10540001
105500         MOVE -1               TO AREQTMML                        10550001
105600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10560001
105700     END-IF.                                                      10570001
105800                                                                  10580001
105900     IF  ASC-TO-REQ-DTE-DD = SPACE AND                            10590001
106000        (ASC-TO-REQ-DTE-MM > SPACE OR                             10600001
106100         ASC-TO-REQ-DTE-YY > SPACE)                               10610001
106200         SET PS-ERROR                                             10620001
106300             DP020-MSG-FATAL   TO TRUE                            10630001
106400         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10640001
106500         MOVE DP015-UNP-ALP-BRT-OFF                               10650001
106600                               TO AREQTDDA                        10660001
106700         MOVE DP015-RED        TO AREQTDDC                        10670001
106800         MOVE DP015-REVERSE    TO AREQTDDH                        10680001
106900         MOVE -1               TO AREQTDDL                        10690001
107000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10700001
107100     END-IF.                                                      10710001
107200                                                                  10720001
107300     IF  ASC-TO-REQ-DTE-YY = SPACE AND                            10730001
107400        (ASC-TO-REQ-DTE-DD > SPACE OR                             10740001
107500         ASC-TO-REQ-DTE-MM > SPACE)                               10750001
107600         SET PS-ERROR                                             10760001
107700             DP020-MSG-FATAL   TO TRUE                            10770001
107800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                10780001
107900         MOVE DP015-UNP-ALP-BRT-OFF                               10790001
108000                               TO AREQTYYA                        10800001
108100         MOVE DP015-RED        TO AREQTYYC                        10810001
108200         MOVE DP015-REVERSE    TO AREQTYYH                        10820001
108300         MOVE -1               TO AREQTYYL                        10830001
108400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10840001
108500     END-IF.                                                      10850001
108600                                                                  10860001
108700     IF (ASC-TO-REQ-DTE-MM > SPACE AND                            10870001
108800         ASC-TO-REQ-DTE-DD > SPACE AND                            10880001
108900         ASC-TO-REQ-DTE-YY > SPACE) AND                           10890001
109000        (ASC-FROM-REQ-DTE-YY = SPACE AND                          10900001
109100         ASC-FROM-REQ-DTE-DD = SPACE AND                          10910001
109200         ASC-FROM-REQ-DTE-MM = SPACE)                             10920001
109300         SET PS-ERROR                                             10930001
109400             DP020-MSG-FATAL   TO TRUE                            10940001
109500         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                10950001
109600         MOVE DP015-UNP-ALP-BRT-OFF                               10960001
109700                               TO AREQFMMA                        10970001
109800         MOVE DP015-RED        TO AREQFMMC                        10980001
109900         MOVE DP015-REVERSE    TO AREQFMMH                        10990001
110000         MOVE DP015-UNP-ALP-BRT-OFF                               11000001
110100                               TO AREQFDDA                        11010001
110200         MOVE DP015-RED        TO AREQFDDC                        11020001
110300         MOVE DP015-REVERSE    TO AREQFDDH                        11030001
110400         MOVE DP015-UNP-ALP-BRT-OFF                               11040001
110500                               TO AREQFYYA                        11050001
110600         MOVE DP015-RED        TO AREQFYYC                        11060001
110700         MOVE DP015-REVERSE    TO AREQFYYH                        11070001
110800         MOVE -1               TO AREQFMML                        11080001
110900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      11090001
111000     END-IF.                                                      11100001
111100                                                                  11110001
111200     IF  ASC-FROM-REQ-DTE-MM > SPACE AND                          11120001
111300         ASC-FROM-REQ-DTE-DD > SPACE AND                          11130001
111400         ASC-FROM-REQ-DTE-YY > SPACE AND                          11140001
111500         ASC-TO-REQ-DTE-MM > SPACE AND                            11150001
111600         ASC-TO-REQ-DTE-DD > SPACE AND                            11160001
111700         ASC-TO-REQ-DTE-YY > SPACE                                11170001
111800         MOVE ASC-FROM-REQ-DTE-MM      TO  PV-FROM-MM             11180001
111900         MOVE ASC-FROM-REQ-DTE-DD      TO  PV-FROM-DD             11190001
112000         MOVE ASC-FROM-REQ-DTE-YY      TO  PV-FROM-YY             11200001
112100         MOVE ASC-TO-REQ-DTE-MM        TO  PV-TO-MM               11210001
112200         MOVE ASC-TO-REQ-DTE-DD        TO  PV-TO-DD               11220001
112300         MOVE ASC-TO-REQ-DTE-YY        TO  PV-TO-YY               11230001
112400         SET PS-NO-DATE-ERROR TO TRUE                             11240001
112500         PERFORM 3140-VALIDATE-FROM-TO                            11250001
112600         IF PS-DATE-ERROR                                         11260001
112700             MOVE DP015-UNP-ALP-BRT-OFF  TO AREQFMMA              11270001
112800                                            AREQFDDA              11280001
112900                                            AREQFYYA              11290001
113000                                            AREQTMMA              11300001
113100                                            AREQTDDA              11310001
113200                                            AREQTYYA              11320001
113300             MOVE DP015-RED              TO AREQFMMC              11330001
113400                                            AREQFDDC              11340001
113500                                            AREQFYYC              11350001
113600                                            AREQTMMC              11360001
113700                                            AREQTDDC              11370001
113800                                            AREQTYYC              11380001
113900             MOVE DP015-REVERSE          TO AREQFMMH              11390001
114000                                            AREQFDDH              11400001
114100                                            AREQFYYH              11410001
114200                                            AREQTMMH              11420001
114300                                            AREQTDDH              11430001
114400                                            AREQTYYH              11440001
114500             MOVE -1                     TO AREQFMML              11450001
114600         END-IF                                                   11460001
114700     END-IF.                                                      11470001
114800                                                                  11480001
114900     IF  ASC-PACK-NBR > SPACE                                     11490001
115000         MOVE ASC-PACK-NBR         TO DP010I-UNEDITED-FIELD       11500001
115100         MOVE LENGTH OF ASC-PACK-NBR TO      DP010I-MAXIMUM-DIGITS11510001
115200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11520001
115300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11530001
115400         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11540029
115410              USING DP010I-NUMERIC-EDIT-AREA                      11541029
115500         IF  DP010I-ERROR-DETECTED                                11550001
115600             SET PS-ERROR                                         11560001
115700                 DP020-MSG-FATAL   TO TRUE                        11570001
115800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11580001
115900             MOVE DP015-UNP-ALP-BRT-OFF                           11590001
116000                                   TO APAKNBRA                    11600001
116100             MOVE DP015-RED        TO APAKNBRC                    11610001
116200             MOVE DP015-REVERSE    TO APAKNBRH                    11620001
116300             MOVE -1               TO APAKNBRL                    11630001
116400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11640001
116500         ELSE                                                     11650001
116600             MOVE DP010I-NUMERIC-FIELD                            11660001
116700                                   TO ASC-PACK-NBR-N              11670001
116800             MOVE ASC-PACK-NBR     TO APAKNBRO                    11680001
116900         END-IF                                                   11690001
117000     END-IF.                                                      11700001
117100                                                                  11710001
117200     IF  ASC-LINE-NBR > SPACE                                     11720001
117300         MOVE ASC-LINE-NBR         TO DP010I-UNEDITED-FIELD       11730001
117400         MOVE LENGTH OF ASC-LINE-NBR TO      DP010I-MAXIMUM-DIGITS11740001
117500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11750001
117600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11760001
117700         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11770029
117710              USING DP010I-NUMERIC-EDIT-AREA                      11771029
117800         IF  DP010I-ERROR-DETECTED                                11780001
117900             SET PS-ERROR                                         11790001
118000                 DP020-MSG-FATAL   TO TRUE                        11800001
118100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11810001
118200             MOVE DP015-UNP-ALP-BRT-OFF                           11820001
118300                                   TO ALINNBRA                    11830001
118400             MOVE DP015-RED        TO ALINNBRC                    11840001
118500             MOVE DP015-REVERSE    TO ALINNBRH                    11850001
118600             MOVE -1               TO ALINNBRL                    11860001
118700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11870001
118800         ELSE                                                     11880001
118900             MOVE DP010I-NUMERIC-FIELD                            11890001
119000                                   TO ASC-LINE-NBR-N              11900001
119100             MOVE ASC-LINE-NBR     TO ALINNBRO                    11910001
119200         END-IF                                                   11920001
119300     END-IF.                                                      11930001
119400                                                                  11940001
119500     IF  ASC-RECVR-SEQ-NBR > SPACE                                11950001
119600         MOVE ASC-RECVR-SEQ-NBR    TO DP010I-UNEDITED-FIELD       11960001
119700         MOVE LENGTH OF ASC-RECVR-SEQ-NBR TO DP010I-MAXIMUM-DIGITS11970001
119800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     11980001
119900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11990001
120000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12000029
120010              USING DP010I-NUMERIC-EDIT-AREA                      12001029
120100         IF  DP010I-ERROR-DETECTED                                12010001
120200             SET PS-ERROR                                         12020001
120300                 DP020-MSG-FATAL   TO TRUE                        12030001
120400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12040001
120500             MOVE DP015-UNP-ALP-BRT-OFF                           12050001
120600                                   TO ARECSEQA                    12060001
120700             MOVE DP015-RED        TO ARECSEQC                    12070001
120800             MOVE DP015-REVERSE    TO ARECSEQH                    12080001
120900             MOVE -1               TO ARECSEQL                    12090001
121000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12100001
121100         ELSE                                                     12110001
121200             MOVE DP010I-NUMERIC-FIELD                            12120001
121300                                   TO ASC-RECVR-SEQ-NBR-N         12130001
121400                                      DK-REC-SEQ-NBR              12140001
121500             MOVE ASC-RECVR-SEQ-NBR TO ARECSEQO                   12150001
121600         END-IF                                                   12160001
121700     END-IF.                                                      12170001
121800                                                                  12180001
121900     IF  ASC-PO > SPACE                                           12190001
122000*IF ENTER PO MUST ENTER OPER ID AS WELL                           12200027
122100         IF ASC-OPER-UNIT-ID = SPACE                              12210024
122200             AND ASC-RECVR-SEQ-NBR = SPACE                        12220026
122300             AND ASC-LINE-NBR      = SPACE                        12230026
122400             AND ASC-PACK-NBR      = SPACE                        12240026
122500             AND ASC-USER-ID       = SPACE                        12250026
122600             SET PS-ERROR                                         12260024
122700                 DP020-MSG-FATAL   TO TRUE                        12270024
122800             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            12280024
122900             MOVE DP015-UNP-ALP-BRT-OFF                           12290024
123000                                   TO AOPRUNTA                    12300025
123100             MOVE DP015-RED        TO AOPRUNTC                    12310025
123200             MOVE DP015-REVERSE    TO AOPRUNTH                    12320025
123300             MOVE -1               TO AOPRUNTL                    12330025
123400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12340024
123500         ELSE                                                     12350024
123600             MOVE ASC-PO               TO DP010I-UNEDITED-FIELD   12360024
123700             MOVE LENGTH OF ASC-PO TO DP010I-MAXIMUM-DIGITS       12370024
123800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 12380024
123900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              12390024
124000             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12400029
124010                  USING DP010I-NUMERIC-EDIT-AREA                  12401029
124100             IF  DP010I-ERROR-DETECTED                            12410024
124200                 SET PS-ERROR                                     12420024
124300                     DP020-MSG-FATAL   TO TRUE                    12430024
124400                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        12440024
124500                 MOVE DP015-UNP-ALP-BRT-OFF                       12450024
124600                                       TO APOA                    12460024
124700                 MOVE DP015-RED        TO APOC                    12470024
124800                 MOVE DP015-REVERSE    TO APOH                    12480024
124900                 MOVE -1               TO APOL                    12490024
125000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12500024
125100             ELSE                                                 12510024
125200                 MOVE DP010I-NUMERIC-FIELD                        12520024
125300                                       TO ASC-PO-N                12530024
125400                                          DK-PO-NBR               12540024
125500                 MOVE ASC-PO           TO APOO                    12550024
125600                 PERFORM 3130-VALIDATE-PO                         12560024
125700                 IF PS-NO-PO-FOUND                                12570024
125800                     SET PS-ERROR                                 12580024
125900                         DP020-MSG-FATAL   TO TRUE                12590024
126000                     MOVE PC-TSYMSG-02858  TO DP020-MSG-NUMBER    12600024
126100                     MOVE DP015-UNP-ALP-BRT-OFF                   12610024
126200                                           TO APOA                12620024
126300                     MOVE DP015-RED        TO APOC                12630024
126400                     MOVE DP015-REVERSE    TO APOH                12640024
126500                     MOVE -1               TO APOL                12650024
126600                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          12660024
126700                 END-IF                                           12670024
126800             END-IF                                               12680024
126900         END-IF                                                   12690024
127000     END-IF.                                                      12700001
127100                                                                  12710012
127200     PERFORM 4100-PROCESS-OPER-UNIT.                              12720012
127300*                                                                 12730001
127400     IF  ASC-PACK-NBR > SPACE AND                                 12740003
127500         ASC-LINE-NBR > SPACE                                     12750003
127600          SET PS-ERROR                                            12760001
127700              DP020-MSG-FATAL   TO TRUE                           12770001
127800          MOVE PC-TSYMSG-01202  TO DP020-MSG-NUMBER               12780001
127900          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     12790001
128000     END-IF.                                                      12800001
128100*                                                                 12810001
128200     IF  ASC-PO = SPACE AND                                       12820005
128300         ASC-USER-ID = SPACES                                     12830005
128400          SET PS-ERROR                                            12840005
128500              DP020-MSG-FATAL   TO TRUE                           12850005
128600          MOVE PC-TSYMSG-03274  TO DP020-MSG-NUMBER               12860006
128700          MOVE DP015-UNP-ALP-BRT-OFF                              12870005
128800                                TO APOA                           12880005
128900          MOVE DP015-RED        TO APOC                           12890005
129000          MOVE DP015-REVERSE    TO APOH                           12900005
129100          MOVE -1               TO APOL                           12910005
129200          MOVE DP015-UNP-ALP-BRT-OFF                              12920005
129300                                TO AUSERIDA                       12930005
129400          MOVE DP015-RED        TO AUSERIDC                       12940005
129500          MOVE DP015-REVERSE    TO AUSERIDH                       12950005
129600          MOVE -1               TO AUSERIDL                       12960005
129700          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     12970005
129800     END-IF.                                                      12980005
129900*                                                                 12990005
130000     IF  PS-NO-ERROR                                              13000001
130100         MOVE -1                   TO APOL                        13010001
130200         SET DP030-SET-CURSOR-APPL-1                              13020001
130300                                   TO TRUE                        13030001
130400     END-IF.                                                      13040001
130500                                                                  13050001
130600*----------------------------------------------------------------*13060001
130700* CHECK IF OPER UNIT IS VALID                                    *13070001
130800*----------------------------------------------------------------*13080001
130900 3100-VALIDATE-OPER-UNIT.                                         13090001
131000                                                                  13100001
131100     INITIALIZE XL071-COMMAREA-REC.                               13110013
131200     MOVE DK-OPER-UNIT    TO XL071-LOCATION-NUMBER.               13120014
131300                                                                  13130013
131400     CALL PC-LOCATION-MODULE  USING                               13140013
131500                                    DFHEIBLK                      13150013
131600                                    XL071-COMMAREA                13160013
131700                                    XL071-COMMAREA-REC.           13170013
131800                                                                  13180013
131900     IF XL071-NO-ERRORS                                           13190013
132000         IF XL071-LOC-TYP-CDE = 'DC'                              13200013
132100             MOVE XL071-LOC-NM  TO  PV-FCLTY-NME                  13210013
132200             SET PS-OPER-UNIT-FOUND  TO TRUE                      13220013
132300         ELSE                                                     13230013
132400             SET PS-OPER-UNIT-NOT-FOUND TO TRUE                   13240013
132500         END-IF                                                   13250013
132600     ELSE                                                         13260013
132700         SET PS-OPER-UNIT-NOT-FOUND TO TRUE                       13270013
132800         MOVE SPACES        TO  PV-FCLTY-NME                      13280013
132900     END-IF.                                                      13290013
133000                                                                  13300013
133100 3130-VALIDATE-PO.                                                13310001
133200                                                                  13320001
133300     EXEC SQL                                                     13330001
133400        SELECT PO_NBR                                             13340001
133500            ,  VER_NBR                                            13350001
133600            ,  VER_STATUS_CDE                                     13360001
133700            ,  PO_TYP_CDE                                         13370001
133800            ,  PKGNG_CDE                                          13380001
133900         INTO :PURCHS-PO-NBR                                      13390001
134000            , :PURCHS-VER-NBR                                     13400001
134100            , :PURCHS-VER-STATUS-CDE                              13410001
134200            , :PURCHS-PO-TYP-CDE                                  13420001
134300            , :PURCHS-PKGNG-CDE                                   13430001
134400         FROM TPURCHS                                             13440001
134500        WHERE PO_NBR           = :DK-PO-NBR                       13450001
134600          AND VER_STATUS_CDE   = 'A'                              13460001
134700     END-EXEC.                                                    13470001
134800                                                                  13480001
134900     EVALUATE TRUE                                                13490001
135000         WHEN SQLCODE = +0                                        13500001
135100             SET PS-PO-FOUND TO TRUE                              13510001
135200                                                                  13520001
135300         WHEN SQLCODE = +100                                      13530001
135400             SET PS-NO-PO-FOUND TO TRUE                           13540001
135500                                                                  13550001
135600         WHEN SQLWARN0 NOT = SPACE                                13560001
135700         WHEN SQLCODE < +0                                        13570001
135800         WHEN SQLCODE > +0                                        13580001
135900             MOVE '3130-VALIDATE-PO'                              13590001
136000                             TO DP013-PARAGRAPH                   13600001
136100             MOVE 'VALIDATE THE PO NUMBER'                        13610001
136200                             TO DP013-MESSAGE-TEXT (1)            13620001
136300             MOVE SQLCA      TO DP013-SQLCA                       13630001
136400             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)          13640001
136500             SET DP013-DB2-ABEND                                  13650001
136600                             TO TRUE                              13660001
136700             SET DP013-XCTL-DISPLAY-RESTART                       13670001
136800                             TO TRUE                              13680001
136900             PERFORM DP013-0000-PROCESS-ABEND                     13690001
137000     END-EVALUATE.                                                13700001
137100                                                                  13710001
137200*-----------------------------------------------------------------13720001
137300*  VALIDATE CREATE FROM AND TO DATES                              13730001
137400*-----------------------------------------------------------------13740001
137500 3140-VALIDATE-FROM-TO.                                           13750001
137600                                                                  13760001
137700     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   13770001
137800         CONTINUE                                                 13780001
137900     ELSE                                                         13790001
138000         IF PS-NUM-ERROR                                          13800001
138100             CONTINUE                                             13810001
138200         ELSE                                                     13820001
138300             SET PS-ERROR                                         13830001
138400                 PS-DATE-ERROR                                    13840001
138500                 DP020-MSG-FATAL         TO TRUE                  13850001
138600             MOVE PC-TSYMSG-02221        TO DP020-MSG-NUMBER      13860001
138700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13870001
138800         END-IF                                                   13880001
138900     END-IF.                                                      13890001
139000                                                                  13900001
139100     IF  PS-NO-ERROR                                              13910001
139200         INITIALIZE DPG51 DPG52 DPG53                             13920001
139300                    DPG54 DPG55 DPG56                             13930001
139400         SET  DPG51-ACTUAL-CALENDAR-ONLY                          13940001
139500              DPG51-DO-NOT-INCR-DECR-DATE                         13950001
139600                                    TO TRUE                       13960001
139700*            'CCYYMMDD'                                           13970001
139800         SET  DPG52-LK-DTE-ISO                                    13980001
139900                                    TO TRUE                       13990001
140000         MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT        14000001
140100         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          14010001
140200                                       DPG54 DPG55 DPG56          14020001
140300         IF (DPG54-DATE-INVALID  OR                               14030001
140400             DPG54-SEVERE-ERROR)                                  14040001
140500             SET PS-ERROR                                         14050001
140600                 PS-DATE-ERROR                                    14060001
140700                 DP020-MSG-FATAL       TO TRUE                    14070001
140800             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        14080001
140900             SET DP030-SET-CURSOR-APPL-1                          14090001
141000                                       TO TRUE                    14100001
141100         END-IF                                                   14110001
141200                                                                  14120001
141300         INITIALIZE DPG51 DPG52 DPG53                             14130001
141400                    DPG54 DPG55 DPG56                             14140001
141500         SET  DPG51-ACTUAL-CALENDAR-ONLY                          14150001
141600              DPG51-DO-NOT-INCR-DECR-DATE                         14160001
141700                                    TO TRUE                       14170001
141800*            'CCYYMMDD'                                           14180001
141900             SET  DPG52-LK-DTE-ISO                                14190001
142000                                    TO TRUE                       14200001
142100         MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT        14210001
142200         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          14220001
142300                                       DPG54 DPG55 DPG56          14230001
142400         IF (DPG54-DATE-INVALID                                   14240001
142500         OR  DPG54-SEVERE-ERROR)                                  14250001
142600             SET PS-ERROR                                         14260001
142700                 PS-DATE-ERROR                                    14270001
142800                 DP020-MSG-FATAL       TO TRUE                    14280001
142900             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        14290001
143000             SET DP030-SET-CURSOR-APPL-1                          14300001
143100                                       TO TRUE                    14310001
143200         END-IF                                                   14320001
143300     END-IF.                                                      14330001
143400                                                                  14340001
143500                                                                  14350001
143600******************************************************************14360001
143700** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **14370001
143800** MAP.                                                         **14380001
143900******************************************************************14390001
144000 3200-RESET-ATTRIBUTES.                                           14400001
144100     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPRUNTA                    14410001
144200                                      APOA                        14420002
144300                                      ARECSEQA                    14430002
144400                                      ALINNBRA                    14440002
144500                                      APAKNBRA                    14450002
144600                                      AUSERIDA                    14460002
144700                                      AREQFMMA                    14470001
144800                                      AREQFDDA                    14480001
144900                                      AREQFYYA                    14490001
145000                                      AREQTMMA                    14500001
145100                                      AREQTDDA                    14510001
145200                                      AREQTYYA.                   14520002
145300     MOVE DP015-GREEN              TO AOPRUNTC                    14530002
145400                                      APOC                        14540002
145500                                      ARECSEQC                    14550002
145600                                      ALINNBRC                    14560002
145700                                      APAKNBRC                    14570002
145800                                      AUSERIDC                    14580002
145900                                      AREQFMMC                    14590001
146000                                      AREQFDDC                    14600001
146100                                      AREQFYYC                    14610001
146200                                      AREQTMMC                    14620001
146300                                      AREQTDDC                    14630001
146400                                      AREQTYYC.                   14640002
146500     MOVE DP015-UNDERLINE          TO AOPRUNTH                    14650002
146600                                      APOH                        14660002
146700                                      ARECSEQH                    14670002
146800                                      ALINNBRH                    14680002
146900                                      APAKNBRH                    14690002
147000                                      AUSERIDH                    14700002
147100                                      AREQFMMH                    14710001
147200                                      AREQFDDH                    14720001
147300                                      AREQFYYH                    14730001
147400                                      AREQTMMH                    14740001
147500                                      AREQTDDH                    14750001
147600                                      AREQTYYH.                   14760002
147700*                                                                 14770001
147800*----------------------------------------------------------------*14780001
147900*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *14790001
148000*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *14800001
148100*  IT HERE.                                                      *14810001
148200*----------------------------------------------------------------*14820001
148300 4000-BUILD-INITIAL-PANEL.                                        14830001
148400     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        14840001
148500     MOVE -1                       TO APOL.                       14850001
148600     MOVE SPACES                   TO ASC-PO                      14860003
148700                                      ASC-RECVR-SEQ-NBR           14870001
148800                                      ASC-LINE-NBR                14880001
148900                                      ASC-PACK-NBR                14890001
149000                                      ASC-USER-ID                 14900001
149100                                      ASC-TO-REQ-DTE-MM           14910001
149200                                      ASC-TO-REQ-DTE-DD           14920001
149300                                      ASC-TO-REQ-DTE-YY.          14930001
149400                                                                  14940001
149500     MOVE ASC-OPER-UNIT-ID         TO AOPRUNTO.                   14950005
149600     MOVE ASC-FROM-REQ-DTE-YY      TO AREQFYYO.                   14960006
149700     MOVE ASC-FROM-REQ-DTE-MM      TO AREQFMMO.                   14970006
149800     MOVE ASC-FROM-REQ-DTE-DD      TO AREQFDDO.                   14980006
149900                                                                  14990011
150000     PERFORM 4100-PROCESS-OPER-UNIT.                              15000012
150100*                                                                 15010001
150200 4100-PROCESS-OPER-UNIT.                                          15020012
150300     IF  ASC-OPER-UNIT-ID NOT EQUAL SPACE                         15030012
150400         MOVE ASC-OPER-UNIT-ID TO DP010I-UNEDITED-FIELD           15040012
150500         MOVE LENGTH OF ASC-OPER-UNIT-ID                          15050012
150600                                   TO DP010I-MAXIMUM-DIGITS       15060012
150700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     15070012
150800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15080012
150900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15090029
150910              USING DP010I-NUMERIC-EDIT-AREA                      15091029
151000         IF  DP010I-ERROR-DETECTED                                15100012
151100             SET PS-ERROR                                         15110012
151200                 DP020-MSG-FATAL   TO TRUE                        15120012
151300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15130012
151400             MOVE DP015-UNP-ALP-BRT-OFF                           15140012
151500                                   TO AOPRUNTA                    15150012
151600             MOVE DP015-RED        TO AOPRUNTC                    15160012
151700             MOVE DP015-REVERSE    TO AOPRUNTH                    15170012
151800             MOVE -1               TO AOPRUNTL                    15180012
151900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15190012
152000         ELSE                                                     15200012
152100             MOVE DP010I-NUMERIC-FIELD                            15210012
152200                                   TO ASC-OPER-UNIT-ID-N          15220012
152300                                      DK-OPER-UNIT                15230012
152400             MOVE ASC-OPER-UNIT-ID TO AOPRUNTO                    15240012
152500             SET PS-OPER-UNIT-NOT-FOUND TO TRUE                   15250012
152600             PERFORM 3100-VALIDATE-OPER-UNIT                      15260012
152700             IF PS-OPER-UNIT-NOT-FOUND                            15270012
152800                 SET PS-ERROR                                     15280012
152900                     DP020-MSG-FATAL   TO TRUE                    15290012
153000                 MOVE PC-TSYMSG-02572  TO DP020-MSG-NUMBER        15300012
153100                 MOVE DP015-UNP-ALP-BRT-OFF                       15310012
153200                                       TO AOPRUNTA                15320012
153300                 MOVE DP015-RED        TO AOPRUNTC                15330012
153400                 MOVE DP015-REVERSE    TO AOPRUNTH                15340012
153500                 MOVE -1               TO AOPRUNTL                15350012
153600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15360012
153700             ELSE                                                 15370012
153800                 MOVE PV-FCLTY-NME        TO AOPRDSCO             15380013
153900             END-IF                                               15390012
154000         END-IF                                                   15400012
154100     END-IF.                                                      15410012
154200                                                                  15420012
154300*----------------------------------------------------------------*15430001
154400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *15440001
154500*----------------------------------------------------------------*15450001
154600 4400-MOVE-COMMAREA-TO-SCREEN.                                    15460001
154700     EVALUATE TRUE                                                15470001
154800         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     15480001
154900                                                                  15490001
155000            INITIALIZE ASC-OPER-UNIT-ID                           15500001
155100            MOVE ASC-OPER-UNIT-ID         TO AOPRUNTO             15510001
155200                                                                  15520001
155300            INITIALIZE ASC-FROM-REQ-DTE-MM                        15530001
155400            MOVE ASC-FROM-REQ-DTE-MM      TO AREQFMMO             15540001
155500                                                                  15550001
155600            INITIALIZE ASC-FROM-REQ-DTE-DD                        15560001
155700            MOVE ASC-FROM-REQ-DTE-DD      TO AREQFDDO             15570001
155800                                                                  15580001
155900            INITIALIZE ASC-FROM-REQ-DTE-YY                        15590001
156000            MOVE ASC-FROM-REQ-DTE-YY      TO AREQFYYO             15600001
156100                                                                  15610001
156200            INITIALIZE  ASC-TO-REQ-DTE-MM                         15620001
156300            MOVE  ASC-TO-REQ-DTE-MM       TO AREQTMMO             15630001
156400                                                                  15640001
156500            INITIALIZE  ASC-TO-REQ-DTE-DD                         15650001
156600            MOVE  ASC-TO-REQ-DTE-DD       TO AREQTDDO             15660001
156700                                                                  15670001
156800            INITIALIZE  ASC-TO-REQ-DTE-YY                         15680001
156900            MOVE  ASC-TO-REQ-DTE-YY       TO AREQTYYO             15690001
157000                                                                  15700001
157100            INITIALIZE  ASC-PO                                    15710001
157200            MOVE  ASC-PO                  TO APOO                 15720001
157300                                                                  15730001
157400            INITIALIZE  ASC-RECVR-SEQ-NBR                         15740001
157500            MOVE  ASC-RECVR-SEQ-NBR       TO ARECSEQO             15750001
157600                                                                  15760001
157700            INITIALIZE  ASC-LINE-NBR                              15770001
157800            MOVE  ASC-LINE-NBR            TO ALINNBRO             15780001
157900                                                                  15790001
158000            INITIALIZE  ASC-PACK-NBR                              15800001
158100            MOVE  ASC-PACK-NBR            TO APAKNBRO             15810001
158200                                                                  15820001
158300            INITIALIZE  ASC-USER-ID                               15830001
158400            MOVE  ASC-USER-ID             TO AUSERIDO             15840001
158500                                                                  15850001
158600     END-EVALUATE.                                                15860001
158700                                                                  15870001
158800*                                                                 15880001
158900*5000-PREPARE-SEL-QUEUE.                                          15890001
159000*                                                                 15900001
159100*                                                                 15910001
159200*    PERFORM 6010-DELETE-SEL-QUEUE.                               15920001
159300*                                                                 15930001
159400*    PERFORM 5205-WRITE-SEL-QUEUE.                                15940001
159500*                                                                 15950001
159600*                                                                 15960001
159700*5205-WRITE-SEL-QUEUE.                                            15970001
159800*                                                                 15980001
159900*    EXEC CICS                                                    15990001
160000*         WRITEQ TS                                               16000001
160100*             QUEUE (ASC-SEL-QUEUE-NAME)                          16010001
160200*             FROM  (SU017-INTER-APPL-COMMAREA)                   16020001
160300*             ITEM  (PV-SEL-QUEUE-ITEM)                           16030001
160400*             RESP  (PV-CICS-RESP)                                16040001
160500*    END-EXEC.                                                    16050001
160600*                                                                 16060001
160700*    IF  PV-CICS-RESP = DFHRESP (NORMAL)                          16070001
160800*        CONTINUE                                                 16080001
160900*    ELSE                                                         16090001
161000*        SET DP013-CICS-ABEND      TO TRUE                        16100001
161100*        SET DP013-NO-ROLLBACK     TO TRUE                        16110001
161200*        MOVE '5205-WRITE-SEL-QUEUE'                              16120001
161300*                                  TO DP013-PARAGRAPH             16130001
161400*        MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          16140001
161500*                                  TO DP013-MESSAGE-TEXT(1)       16150001
161600*        PERFORM DP013-0000-PROCESS-ABEND                         16160001
161700*    END-IF.                                                      16170001
161800                                                                  16180001
161900                                                                  16190001
162000******************************************************************16200001
162100** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **16210001
162200** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **16220001
162300** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **16230001
162400** THE USER.                                                    **16240001
162500******************************************************************16250001
162600*                                                                 16260001
162700*6000-REFRESH-PANEL-FROM-TEMP.                                    16270001
162800*    IF  ASC-UPDATE-TSQ                                           16280001
162900*        SET ASC-NO-TSQ-UPDATE TO TRUE                            16290001
163000*        MOVE ZERO                 TO PV-SAVE-ITEM                16300001
163100*                                     PV-SEL-QUEUE-ITEM           16310001
163200*        MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        16320001
163300*                                  TO PV-HOLD-SELECTED-ITEMS      16330001
163400*        MOVE +1                   TO PV-ITEMS-PROCESSED          16340001
163500*        PERFORM 6100-UPDATE-TSQ                                  16350001
163600*            UNTIL PV-ITEMS-PROCESSED >                           16360001
163700*                                    PV-HOLD-SELECTED-ITEMS       16370001
163800*        PERFORM 6010-DELETE-SEL-QUEUE                            16380001
163900*        INITIALIZE ASC-BLOCK-ENTRIES (1)                         16390001
164000*                   ASC-BLOCK-ENTRIES (2)                         16400001
164100*    END-IF.                                                      16410001
164200*                                                                 16420001
164300*                                                                 16430001
164400*----------------------------------------------------------------*16440001
164500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *16450001
164600*----------------------------------------------------------------*16460001
164700*6010-DELETE-SEL-QUEUE.                                           16470001
164800*                                                                 16480001
164900*    EXEC CICS                                                    16490001
165000*        DELETEQ TS                                               16500001
165100*            QUEUE (ASC-SEL-QUEUE-NAME)                           16510001
165200*            RESP  (PV-CICS-RESP)                                 16520001
165300*    END-EXEC.                                                    16530001
165400*                                                                 16540001
165500*    IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      16550001
165600*       (PV-CICS-RESP = DFHRESP(QIDERR)))                         16560001
165700*        CONTINUE                                                 16570001
165800*    ELSE                                                         16580001
165900*        SET DP013-CICS-ABEND TO TRUE                             16590001
166000*        SET DP013-NO-ROLLBACK TO TRUE                            16600001
166100*        MOVE '6010-DELETE-SEL-QUEUE'                             16610001
166200*                       TO DP013-PARAGRAPH                        16620001
166300*        MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         16630001
166400*                       TO DP013-MESSAGE-TEXT (1)                 16640001
166500*        PERFORM DP013-0000-PROCESS-ABEND                         16650001
166600*    END-IF.                                                      16660001
166700*                                                                 16670001
166800*----------------------------------------------------------------*16680001
166900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *16690001
167000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *16700001
167100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *16710001
167200*    THE TEMP QUEUE.                                             *16720001
167300*----------------------------------------------------------------*16730001
167400*                                                                 16740001
167500*6100-UPDATE-TSQ.                                                 16750001
167600*                                                                 16760001
167700*    ADD 1                     TO  PV-SEL-QUEUE-ITEM.             16770001
167800*    PERFORM 6105-READ-SEL-QUEUE.                                 16780001
167900*                                                                 16790001
168000*                                                                 16800001
168100*----------------------------------------------------------------*16810001
168200*    READ THE LIST QUEUE RECORD.                                 *16820001
168300*----------------------------------------------------------------*16830001
168400*                                                                 16840001
168500*6105-READ-SEL-QUEUE.                                             16850001
168600*                                                                 16860001
168700*    EXEC CICS                                                    16870001
168800*         READQ TS                                                16880001
168900*             QUEUE (ASC-SEL-QUEUE-NAME)                          16890001
169000*             INTO  (SU019-SELECT-RECORD)                         16900001
169100*             ITEM  (PV-SEL-QUEUE-ITEM)                           16910001
169200*             RESP  (PV-CICS-RESP)                                16920001
169300*    END-EXEC.                                                    16930001
169400*                                                                 16940001
169500*    IF  PV-CICS-RESP = DFHRESP (NORMAL)                          16950001
169600*        CONTINUE                                                 16960001
169700*    ELSE                                                         16970001
169800*        SET DP013-CICS-ABEND      TO  TRUE                       16980001
169900*        SET DP013-NO-ROLLBACK     TO  TRUE                       16990001
170000*        MOVE '6105-READ-SEL-QUEUE'                               17000001
170100*                                  TO  DP013-PARAGRAPH            17010001
170200*        MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           17020001
170300*                                  TO  DP013-MESSAGE-TEXT(1)      17030001
170400*        PERFORM DP013-0000-PROCESS-ABEND                         17040001
170500*    END-IF.                                                      17050001
170600/                                                                 17060001
170700                                                                  17070001
170800*----------------------------------------------------------------*17080001
170900*    ABEND PROCESSOR MODULE                                      *17090001
171000*----------------------------------------------------------------*17100001
171100                                                                  17110001
171200     COPY DPPD013.                                                17120001
