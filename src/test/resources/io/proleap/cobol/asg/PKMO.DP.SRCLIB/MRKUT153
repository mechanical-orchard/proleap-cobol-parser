      ******************************************************************        
       IDENTIFICATION DIVISION.                                                 
      ******************************************************************        
                                                                                
       PROGRAM-ID.     MRKUT153.                                                
       AUTHOR.         MARK A FRAMNESS.                                         
       INSTALLATION.   KOHLS DEPARTMENT STORES.                                 
       DATE-WRITTEN.   02/28/11.                                                
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *  STORE COMMON EXTRACT PROGRAM                                           
      *  (STORE HISTORY PROGRAM)                                                
      *  THIS PROGRAM CREATES A CHANGE EXTRACT FILE BY COMPARING                
      *  TWO GENERATIONS OF AN TMRITST SORTED UNLOAD FILE.                      
      ******************************************************************        
TD0804*    CHANGED: 08/20/04    BY: THOMAS DUFFY                                
TD0804*      LOCATION DIMENSION - CHANGE LRECL FOR INPUT RECORDS                
TD0804*               FROM 687 TO 900, AND OUTPUT RECORD FROM                   
TD0804*               688 TO 905 TO USE V3 OF LOCATION EXTRACTS.                
TD0804*               ADDRESS OUTPUT DECREASED TO 97.                           
39512 *    CHANGED: 04/21/2011  BY: MARK A FRAMNESS                             
39512 *               PROGRAM CLONED FROM CWKUT010 AND ALTERED TO               
39512 *               GENERATE DELTA DATASETS IN THE FORM OF:                   
39512 *                ONE INSERT DATASET -- NEW RECORDS & NEW VERSIONS         
39512 *                   OF EXISTING RECORDS                                   
39512 *                ONE DELETE DATASET -- PURGED RECORDS & OLD               
39512 *                   VERSIONS OF EXISTING RECORDS                          
39512 *                ONE COUNT DATASET -- CONTAINING TOTAL RECORDS            
39512 *                   WRITTEN OUT                                           
39512 *                RECORD FORMAT CONFORMS TO LAYOUT ESTABLISHED BY          
39512 *                   EARLIER DESIGN                                        
39512 ******************************************************************        
                                                                                
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
      ******************************************************************        
                                                                                
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
                                                                                
       INPUT-OUTPUT SECTION.                                                    
                                                                                
       FILE-CONTROL.                                                            
                                                                                
           SELECT CW-CURRENT-FILE                                               
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT CW-PREVIOUS-FILE                                              
               ASSIGN TO INP02.                                                 
                                                                                
           SELECT CW-INSERT-FILE                                                
               ASSIGN TO OUT01.                                                 
                                                                                
           SELECT CW-DELETE-FILE                                                
               ASSIGN TO OUT02.                                                 
                                                                                
           SELECT CW-COUNT-FILE                                                 
               ASSIGN TO OUT03.                                                 
                                                                                
      ******************************************************************        
       DATA DIVISION.                                                           
      ******************************************************************        
                                                                                
       FILE SECTION.                                                            
                                                                                
       FD  CW-CURRENT-FILE                                                      
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CW-CURRENT-RECORD                  PIC X(233).                       
                                                                                
       FD  CW-PREVIOUS-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CW-PREVIOUS-RECORD                 PIC X(233).                       
                                                                                
       FD  CW-INSERT-FILE                                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CW-INSERT-RECORD                   PIC   X(481).                     
                                                                                
       FD  CW-DELETE-FILE                                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CW-DELETE-RECORD                   PIC   X(481).                     
                                                                                
       FD  CW-COUNT-FILE                                                        
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CW-COUNT-RECORD                   PIC   X(15).                       
                                                                                
       WORKING-STORAGE SECTION.                                                 
       01 DEBUG-STUFF-HEAD.                                                     
           05  FILLER                         PIC   X(35)                       
           VALUE '*** WORKING-STORAGE STARTS HERE ***'.                         
                                                                                
       01  CURRENT-REC.                                                         
           05  CR-CURR-KEY                    PIC   X(11).                      
           05  CR-CURR-DATA                   PIC   X(222).                     
                                                                                
       01  PREVIOUS-REC.                                                        
           05  PR-PREV-KEY                    PIC   X(11).                      
           05  PR-PREV-DATA                   PIC   X(222).                     
                                                                                
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PROGRAM-NAME           PIC X(08) VALUE 'MRKUT153'.            
           05  PC-OPERCO                 PIC X(02) VALUE '03'.                  
                                                                                
       01  PV-NUMERIC-UNPCK-FLDS.                                               
           05  PF-S91V92-UNPACK          PIC  S9(1)V9(2) VALUE ZEROS.           
           05  PF-S97-UNPACK             PIC  S9(7)V9(1) VALUE ZEROS.           
           05  PF-S915-UNPACK            PIC  S9(15)     VALUE ZEROS.           
           05  PF-S904-UNPACK            PIC  S9(04)     VALUE ZEROS.           
           05  PF-S93V1-UNPACK           PIC  S9(3)V9(1) VALUE ZEROS.           
           05  PF-S93V-UNPACK            PIC  S9(3)     VALUE ZEROS.            
           05  PF-S9V1-UNPACK            PIC  S9(9)V9(1) VALUE ZEROS.           
           05  PF-S96V1-UNPACK           PIC  S9(6)V9(1) VALUE ZEROS.           
           05  PF-SV95-UNPACK            PIC  S9(1)V9(5) VALUE ZEROS.           
           05  PF-S96V2-UNPACK           PIC  S9(6)V9(2) VALUE ZEROS.           
           05  PF-S99-UNPACK             PIC  S9(9)      VALUE ZEROS.           
           05  PF-S910-COMP              PIC  S9(10) COMP VALUE ZEROS.          
           05  PF-S910-UNPACK            PIC  S9(10)     VALUE ZEROS.           
           05  PF-S905-COMP              PIC  S9(05) COMP VALUE ZEROS.          
           05  PF-S905-UNPACK            PIC  S9(05)     VALUE ZEROS.           
                                                                                
       01  PA-PROGRAM-ACCUMULATORS.                                             
           05  PA-INPUT-RECORDS          PIC  9(15)       VALUE ZERO.           
           05  PA-INPUT-PRE-RECORDS      PIC  9(15)       VALUE ZERO.           
           05  PA-INPUT-CUR-RECORDS      PIC  9(15)       VALUE ZERO.           
           05  PA-OUTPUT-RECORDS         PIC  9(15)       VALUE ZERO.           
           05  PA-INSERT-RECORDS         PIC  9(15)       VALUE ZERO.           
           05  PA-UPDATE-RECORDS         PIC  9(15)       VALUE ZERO.           
           05  PA-DELETE-RECORDS         PIC  9(15)       VALUE ZERO.           
           05  PA-NO-CHANGE-RECORDS      PIC  9(15)       VALUE ZERO.           
      ******************************************************************        
      * OUTPUT LAYOUT FOR COUNT FILE                                            
       01 COUNT-RECORD.                                                         
           05 COUNT-REC-9          PIC ZZZZZZZZZZZZZZ9.                         
      ******************************************************************        
      ******************************************************************        
      * COBOL DECLARATION FOR TABLE TMRITST -- FROM DCLGEN                      
      ******************************************************************        
       01  IN-MRKUT153.                                                         
           10 MRITST-ITEM-NBR               PIC  S9(15)V COMP-3.                
           10 MRITST-STR-NBR                PIC  S9(4) COMP.                    
           10 MRITST-COMSTK-QTY             PIC  S9(7)V COMP-3.                 
           10 MRITST-SPOQSW-CDE             PIC   X(1).                         
           10 MRITST-SPOQ-QTY               PIC  S9(7)V COMP-3.                 
           10 MRITST-FT-CDE                 PIC   X(1).                         
           10 MRITST-OSTRAT-QTY             PIC  S9(3)V9(1) COMP-3.             
           10 MRITST-CSTOCK-QTY             PIC  S9(9)V COMP-3.                 
           10 MRITST-MINOUTL-QTY            PIC  S9(7)V COMP-3.                 
           10 MRITST-MAXOUTL-QTY            PIC  S9(7)V COMP-3.                 
           10 MRITST-FOQ-QTY                PIC  S9(7)V COMP-3.                 
           10 MRITST-TMIN-QTY               PIC  S9(3)V COMP-3.                 
           10 MRITST-USERMIN-QTY            PIC  S9(7)V COMP-3.                 
           10 MRITST-USERMAX-QTY            PIC  S9(7)V COMP-3.                 
           10 MRITST-DD-FCTR                PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-DDI-FCTR               PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-LPP-QTY                PIC  S9(3)V COMP-3.                 
           10 MRITST-MADSS-QTY              PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-FWMAD-QTY              PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-TRNDP-PCT              PIC  SV9(5) COMP-3.                 
           10 MRITST-MSDTS-QTY              PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-MADTS-QTY              PIC  S9(7)V COMP-3.                 
           10 MRITST-LTVFACT-FCTR           PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-PCTZ-PCT               PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-MADSTAT-CDE            PIC   X(1).                         
           10 MRITST-DFLREG-CDE             PIC   X(13).                        
           10 MRITST-TSREG-CDE              PIC   X(13).                        
           10 MRITST-DIREG-CDE              PIC   X(13).                        
           10 MRITST-BYPREG-CDE             PIC   X(13).                        
           10 MRITST-LDD-FCTR               PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-LDDI-FCTR              PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-LMADSS-QTY             PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-LFWMAD-QTY             PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-LCPS-QTY               PIC  S9(7)V COMP-3.                 
           10 MRITST-OUTSTAT-CDE            PIC   X(1).                         
           10 MRITST-LRTFCST-NBR            PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-ORDSTAT-CDE            PIC   X(1).                         
           10 MRITST-PTAG-ID                PIC   X(7).                         
           10 MRITST-MINDD-QTY              PIC  S9(6)V9(1) COMP-3.             
           10 MRITST-ON-ORDER-QTY           PIC  S9(7)V COMP-3.                 
           10 MRITST-MAXOQP-PCT             PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-OUTL-QTY               PIC  S9(9) COMP.                    
           10 MRITST-OP-QTY                 PIC  S9(9) COMP.                    
           10 MRITST-FTJOPF-CDE             PIC   X(1).                         
           10 MRITST-CSTKMINT1-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMINT2-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMINT3-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMINT4-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMINT5-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMINT6-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMAXT1-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMAXT2-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMAXT3-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMAXT4-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMAXT5-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-CSTKMAXT6-PCT          PIC  S9(1)V9(2) COMP-3.             
           10 MRITST-SSTOCK-QTY             PIC  S9(6)V9(2) COMP-3.             
           10 MRITST-PTAG-LAST-UPD-DTE      PIC   X(10).                        
           10 MRITST-STAT-CDE               PIC   X(1).                         
           10 MRITST-CHAR-STR-NBR           PIC   X(5).                         
                                                                                
      ******************************************************************        
      * OUTPUT LAYOUT FOR DELTA FILES -- BOTH DELETE & INSERT                   
      ******************************************************************        
       01  DLTA-RECORD.                                                         
           10 DELTA-ITEM-NBR                PIC 999999999999999                 
                                                       VALUE ZEROS.             
           10 FILLER                        PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-STR-NBR                 PIC  99999 VALUE ZEROS.             
           10 FILLER                        PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-COMSTK-QTY              PIC  9999999 VALUE ZEROS.           
           10 DELTA-COMSTK-QTY-SGN          PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-SPOQSW-CDE              PIC   X(1).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-SPOQ-QTY                PIC  9999999 VALUE ZEROS.           
           10 DELTA-SPOQ-QTY-SGN            PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-FT-CDE                  PIC   X(1).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-OSTRAT-QTY              PIC  999.9 VALUE ZEROS.             
           10 DELTA-OSTRAT-QTY-SGN          PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTOCK-QTY              PIC  999999999 VALUE ZEROS.         
           10 DELTA-CSTOCK-QTY-SGN          PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MINOUTL-QTY             PIC  9999999 VALUE ZEROS.           
           10 DELTA-MINOUTL-QTY-SGN         PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MAXOUTL-QTY             PIC  9999999 VALUE ZEROES.          
           10 DELTA-MAXOUTL-QTY-SGN         PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-FOQ-QTY                 PIC  9999999 VALUE ZEROES.          
           10 DELTA-FOQ-QTY-SGN             PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-TMIN-QTY                PIC  999 VALUE ZEROS.               
           10 DELTA-TMIN-QTY-SGN            PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-USERMIN-QTY             PIC  9999999 VALUE ZEROS.           
           10 DELTA-USERMIN-QTY-SGN         PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-USERMAX-QTY             PIC  9999999 VALUE ZEROS.           
           10 DELTA-USERMAX-QTY-SGN         PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-DD-FCTR                 PIC  999999.9 VALUE ZEROS.          
           10 DELTA-DD-FCTR-SGN             PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-DDI-FCTR                PIC  999999.9 VALUE ZEROS.          
           10 DELTA-DDI-FCTR-SGN            PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LPP-QTY                 PIC  999 VALUE ZEROS.               
           10 DELTA-LPP-QTY-SGN             PIC  X(1) VALUE '+'.                
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MADSS-QTY               PIC  999999.9 VALUE ZEROS.          
           10 DELTA-MADSS-QTY-SGN           PIC   X(1)    VALUE '+'.            
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-FWMAD-QTY               PIC  999999.9 VALUE ZEROS.          
           10 DELTA-FWMAD-QTY-SGN           PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-TRNDP-PCT               PIC  9.99999 VALUE ZEROS.           
           10 DELTA-TRNDP-PCT-SGN           PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MSDTS-QTY               PIC  999999.9 VALUE ZEROS.          
           10 DELTA-MSDTS-QTY-SGN           PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MADTS-QTY               PIC  9999999 VALUE ZEROS.           
           10 DELTA-MADTS-QTY-SGN           PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LTVFACT-FCTR            PIC   9.99 VALUE ZEROS.             
           10 DELTA-LTVFACT-FCTR-SGN        PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-PCTZ-PCT                PIC   9.99 VALUE ZEROS.             
           10 DELTA-PCTZ-PCT-SGN            PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MADSTAT-CDE             PIC   X(1).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-DFLREG-CDE              PIC   X(13).                        
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-TSREG-CDE               PIC   X(13).                        
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-DIREG-CDE               PIC   X(13).                        
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-BYPREG-CDE              PIC   X(13).                        
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LDD-FCTR                PIC  999999.9 VALUE ZEROS.          
           10 DELTA-LDD-FCTR-SGN            PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LDDI-FCTR               PIC  999999.9 VALUE ZEROS.          
           10 DELTA-LDDI-FCTR-SGN           PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LMADSS-QTY              PIC  999999.9 VALUE ZEROS.          
           10 DELTA-LMADSS-QTY-SGN          PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LFWMAD-QTY              PIC  999999.9 VALUE ZEROS.          
           10 DELTA-LFWMAD-QTY-SGN          PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LCPS-QTY                PIC  9999999 VALUE ZEROS.           
           10 DELTA-LCPS-QTY-SGN            PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-OUTSTAT-CDE             PIC   X(1).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-LRTFCST-NBR             PIC  999999.9 VALUE ZEROS.          
           10 DELTA-LRTFCST-NBR-SGN         PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-ORDSTAT-CDE             PIC   X(1).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-PTAG-ID                 PIC   X(7).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MINDD-QTY               PIC  999999.9 VALUE ZEROS.          
           10 DELTA-MINDD-QTY-SGN           PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-ON-ORDER-QTY            PIC  9999999 VALUE ZEROS.           
           10 DELTA-ON-ORDER-QTY-SGN        PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-MAXOQP-PCT              PIC  9.99 VALUE ZEROS.              
           10 DELTA-MAXOQP-PCT-SGN          PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-OUTL-QTY                PIC  9999999999 VALUE ZEROS.        
           10 DELTA-OUTL-QTY-SGN            PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-OP-QTY                  PIC  9999999999 VALUE ZEROS.        
           10 DELTA-OP-QTY-SGN              PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-FTJOPF-CDE              PIC   X(1).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMINT1-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMINT1-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMINT2-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMINT2-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMINT3-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMINT3-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMINT4-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMINT4-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMINT5-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMINT5-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMINT6-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMINT6-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMAXT1-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMAXT1-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMAXT2-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMAXT2-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMAXT3-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMAXT3-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMAXT4-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMAXT4-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMAXT5-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMAXT5-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CSTKMAXT6-PCT           PIC  9.99 VALUE ZEROS.              
           10 DELTA-CSTKMAXT6-PCT-SGN       PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-SSTOCK-QTY              PIC  999999.99 VALUE ZEROS.         
           10 DELTA-SSTOCK-QTY-SGN          PIC   X(1) VALUE '+'.               
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-PTAG-LAST-UPD-DTE       PIC   X(10).                        
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-STAT-CDE                PIC   X(1).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
           10 DELTA-CHAR-STR-NBR            PIC   X(5).                         
           10 FILLER                        PIC   X(1) VALUE '|'.               
                                                                                
      *****************************************************                     
                                                                                
       01 DEBUG-STUFF-HEAD.                                                     
           05  FILLER                         PIC   X(35)                       
           VALUE '*** WORKING-STORAGE ENDS   HERE ***'.                         
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
                                                                                
       0000-MAINLINE.                                                           
                                                                                
           PERFORM 1000-INITIALIZE.                                             
                                                                                
           PERFORM 2000-MAIN-ROUTINE                                            
               UNTIL CR-CURR-KEY = HIGH-VALUES                                  
                     AND                                                        
                     PR-PREV-KEY = HIGH-VALUES.                                 
                                                                                
           PERFORM 9000-EOJ-ROUTINE.                                            
                                                                                
           GOBACK.                                                              
                                                                                
      ******************************************************************        
      *  INITIALIZE                                                             
      ******************************************************************        
                                                                                
       1000-INITIALIZE.                                                         
                                                                                
           OPEN INPUT  CW-CURRENT-FILE                                          
                       CW-PREVIOUS-FILE                                         
                OUTPUT CW-INSERT-FILE                                           
                       CW-DELETE-FILE.                                          
                                                                                
           DISPLAY '   '.                                                       
           DISPLAY '** PROGRAM: ' PC-PROGRAM-NAME.                              
                                                                                
           PERFORM 8000-READ-CURRENT.                                           
           PERFORM 8100-READ-PREVIOUS.                                          
                                                                                
                                                                                
      ******************************************************************        
      * MAIN PROCESSING.                                                        
      ******************************************************************        
       2000-MAIN-ROUTINE.                                                       
                                                                                
           IF CR-CURR-KEY  =  PR-PREV-KEY                                       
              PERFORM 2100-CHECK-EQUALITY                                       
           ELSE                                                                 
               IF CR-CURR-KEY  <  PR-PREV-KEY                                   
      *            INSERT RECORD                                                
      *            WRITE RECORD FROM NEW FILE                                   
                   INITIALIZE            IN-MRKUT153                            
                   MOVE CURRENT-REC   TO IN-MRKUT153                            
                   PERFORM 3000-PREPARE-OUTPUT                                  
                   PERFORM 7100-WRITE-ISRT                                      
                   ADD +1             TO PA-INSERT-RECORDS                      
                   PERFORM 8000-READ-CURRENT                                    
               ELSE                                                             
      *            DELETE RECORD                                                
      *            FORMAT & WRITE PREV RECORD TO DELETE FILE                    
                   INITIALIZE            IN-MRKUT153                            
                   MOVE PREVIOUS-REC  TO IN-MRKUT153                            
                   PERFORM 3000-PREPARE-OUTPUT                                  
                   PERFORM 7200-WRITE-DEL                                       
                   ADD +1             TO PA-DELETE-RECORDS                      
                   PERFORM 8100-READ-PREVIOUS                                   
               END-IF                                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *  CHECKS RECORD FOR EQUALITY                                             
      *  IF DATA IS NOT EQUAL, THEN RECORD IS AN UPDATE                         
      ******************************************************************        
       2100-CHECK-EQUALITY.                                                     
           IF CR-CURR-DATA  =  PR-PREV-DATA                                     
      *       RECORDS IDENTICAL BYPASS                                          
               ADD +1                 TO PA-NO-CHANGE-RECORDS                   
               PERFORM 8000-READ-CURRENT                                        
               PERFORM 8100-READ-PREVIOUS                                       
           ELSE                                                                 
      *        UPDATE RECORD                                                    
      *        WRITE OLD RECORD TO DELETE FILE                                  
      *        FIRST WRITE OLD REC TO DEL DATASET                               
               INITIALIZE            IN-MRKUT153                                
               MOVE PREVIOUS-REC  TO IN-MRKUT153                                
               PERFORM 3000-PREPARE-OUTPUT                                      
               PERFORM 7200-WRITE-DEL                                           
               ADD +1              TO PA-DELETE-RECORDS                         
      *        NOW WRITE OUT NEW REC TO INSERT DATASET                          
               INITIALIZE            IN-MRKUT153                                
               MOVE CURRENT-REC   TO IN-MRKUT153                                
               PERFORM 3000-PREPARE-OUTPUT                                      
               PERFORM 7100-WRITE-ISRT                                          
               ADD +1              TO PA-INSERT-RECORDS                         
               ADD +1              TO PA-UPDATE-RECORDS                         
                                                                                
      *        READ IN NEXT CURRENT & NEXT PREVIOUS RECORDS                     
               PERFORM 8000-READ-CURRENT                                        
               PERFORM 8100-READ-PREVIOUS                                       
           END-IF.                                                              
                                                                                
                                                                                
      ******************************************************************        
      *  UNPACK NUMERICS AND MOVE ALL FIELDS TO OUTPUT RECORD                   
      ******************************************************************        
       3000-PREPARE-OUTPUT.                                                     
      *REQUIRES DLTA-RECORD RECORD TO BE LOADED                                 
      *PROMISES TO UNPACK NUMERICS,  AND PREPARE SIGNS                          
      * FOR WRITING TO DELETE & INSERT DATASETS                                 
                                                                                
      * FIRST TRANSFER TEXT FIELDS TO OUTPUT RECORD                             
      * SECOND UNPACK NUMERICS AND IF APPROPRIATE CHECK SIGN & SET              
      *TEXT/CHAR FIELDS                                                         
      ************************************************************              
                                                                                
           INITIALIZE DLTA-RECORD                                               
                                                                                
           MOVE MRITST-SPOQSW-CDE        TO DELTA-SPOQSW-CDE                    
           MOVE MRITST-FT-CDE            TO DELTA-FT-CDE                        
           MOVE MRITST-MADSTAT-CDE       TO DELTA-MADSTAT-CDE                   
           MOVE MRITST-DFLREG-CDE        TO DELTA-DFLREG-CDE                    
           MOVE MRITST-TSREG-CDE         TO DELTA-TSREG-CDE                     
           MOVE MRITST-DIREG-CDE         TO DELTA-DIREG-CDE                     
           MOVE MRITST-BYPREG-CDE        TO DELTA-BYPREG-CDE                    
           MOVE MRITST-OUTSTAT-CDE       TO DELTA-OUTSTAT-CDE                   
           MOVE MRITST-ORDSTAT-CDE       TO DELTA-ORDSTAT-CDE                   
           MOVE MRITST-PTAG-ID           TO DELTA-PTAG-ID                       
           MOVE MRITST-FTJOPF-CDE        TO DELTA-FTJOPF-CDE                    
           MOVE MRITST-PTAG-LAST-UPD-DTE TO DELTA-PTAG-LAST-UPD-DTE             
           MOVE MRITST-STAT-CDE          TO DELTA-STAT-CDE                      
           MOVE MRITST-CHAR-STR-NBR      TO DELTA-CHAR-STR-NBR                  
      ************************************************************              
      *NUMERIC FIELDS - UNPACK & THEN CHECK SIGN IF NEGATIVE                    
      *                 OVERLAY EXISTING + SIGN WITH -                          
      ************************************************************              
           MOVE MRITST-ITEM-NBR          TO PF-S915-UNPACK                      
           MOVE PF-S915-UNPACK           TO DELTA-ITEM-NBR                      
                                                                                
           MOVE MRITST-STR-NBR           TO PF-S905-COMP                        
           MOVE PF-S905-COMP             TO PF-S905-UNPACK                      
           MOVE PF-S905-UNPACK           TO DELTA-STR-NBR                       
                                                                                
           MOVE MRITST-COMSTK-QTY        TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-COMSTK-QTY                    
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-COMSTK-QTY-SGN                
           ELSE                                                                 
               MOVE '-'                  TO DELTA-COMSTK-QTY-SGN                
           END-IF                                                               
                                                                                
           MOVE MRITST-SPOQ-QTY          TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-SPOQ-QTY                      
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-SPOQ-QTY-SGN                  
           ELSE                                                                 
               MOVE '-'                  TO DELTA-SPOQ-QTY-SGN                  
           END-IF                                                               
                                                                                
           MOVE MRITST-OSTRAT-QTY        TO PF-S93V1-UNPACK                     
           MOVE PF-S93V1-UNPACK          TO DELTA-OSTRAT-QTY                    
           IF PF-S93V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-OSTRAT-QTY-SGN                
           ELSE                                                                 
               MOVE '-'                  TO DELTA-OSTRAT-QTY-SGN                
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTOCK-QTY        TO PF-S99-UNPACK                       
           MOVE PF-S99-UNPACK            TO DELTA-CSTOCK-QTY                    
           IF PF-S99-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-CSTOCK-QTY-SGN                
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTOCK-QTY-SGN                
           END-IF                                                               
                                                                                
           MOVE MRITST-MINOUTL-QTY       TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-MINOUTL-QTY                   
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-MINOUTL-QTY-SGN               
           ELSE                                                                 
               MOVE '-'                  TO DELTA-MINOUTL-QTY-SGN               
           END-IF                                                               
                                                                                
           MOVE MRITST-MAXOUTL-QTY       TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-MAXOUTL-QTY                   
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-MAXOUTL-QTY-SGN               
           ELSE                                                                 
               MOVE '-'                  TO DELTA-MAXOUTL-QTY-SGN               
           END-IF                                                               
                                                                                
           MOVE MRITST-FOQ-QTY           TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-FOQ-QTY                       
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-FOQ-QTY-SGN                   
           ELSE                                                                 
               MOVE '-'                  TO DELTA-FOQ-QTY-SGN                   
           END-IF                                                               
                                                                                
           MOVE MRITST-TMIN-QTY          TO PF-S93V-UNPACK                      
           MOVE PF-S93V-UNPACK           TO DELTA-TMIN-QTY                      
           IF PF-S93V-UNPACK > 0 OR = 0                                         
               MOVE '+'                  TO DELTA-TMIN-QTY-SGN                  
           ELSE                                                                 
               MOVE '-'                  TO DELTA-TMIN-QTY-SGN                  
           END-IF                                                               
                                                                                
           MOVE MRITST-USERMIN-QTY       TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-USERMIN-QTY                   
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-USERMIN-QTY-SGN               
           ELSE                                                                 
               MOVE '-'                  TO DELTA-USERMIN-QTY-SGN               
           END-IF                                                               
                                                                                
           MOVE MRITST-USERMAX-QTY       TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-USERMAX-QTY                   
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-USERMAX-QTY-SGN               
           ELSE                                                                 
               MOVE '-'                  TO DELTA-USERMAX-QTY-SGN               
           END-IF                                                               
                                                                                
           MOVE MRITST-DD-FCTR           TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-DD-FCTR                       
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-DD-FCTR-SGN                   
           ELSE                                                                 
               MOVE '-'                  TO DELTA-DD-FCTR-SGN                   
           END-IF                                                               
                                                                                
           MOVE MRITST-DDI-FCTR          TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-DDI-FCTR                      
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-DDI-FCTR-SGN                  
           ELSE                                                                 
               MOVE '-'                  TO DELTA-DDI-FCTR-SGN                  
           END-IF                                                               
                                                                                
           MOVE MRITST-LPP-QTY           TO PF-S93V-UNPACK                      
           MOVE PF-S93V-UNPACK           TO DELTA-LPP-QTY                       
           IF PF-S93V-UNPACK > 0 OR = 0                                         
               MOVE '+'                  TO DELTA-LPP-QTY-SGN                   
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LPP-QTY-SGN                   
           END-IF                                                               
                                                                                
           MOVE MRITST-MADSS-QTY         TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-MADSS-QTY                     
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-MADSS-QTY-SGN                 
           ELSE                                                                 
               MOVE '-'                  TO DELTA-MADSS-QTY-SGN                 
           END-IF                                                               
                                                                                
           MOVE MRITST-FWMAD-QTY         TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-FWMAD-QTY                     
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-FWMAD-QTY-SGN                 
           ELSE                                                                 
               MOVE '-'                  TO DELTA-FWMAD-QTY-SGN                 
           END-IF                                                               
                                                                                
           MOVE MRITST-TRNDP-PCT         TO PF-SV95-UNPACK                      
           MOVE PF-SV95-UNPACK           TO DELTA-TRNDP-PCT                     
           IF PF-SV95-UNPACK > 0 OR = 0                                         
               MOVE '+'                  TO DELTA-TRNDP-PCT-SGN                 
           ELSE                                                                 
               MOVE '-'                  TO DELTA-TRNDP-PCT-SGN                 
           END-IF                                                               
                                                                                
           MOVE MRITST-MSDTS-QTY         TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-MSDTS-QTY                     
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-MSDTS-QTY-SGN                 
           ELSE                                                                 
               MOVE '-'                  TO DELTA-MSDTS-QTY-SGN                 
           END-IF                                                               
                                                                                
           MOVE MRITST-MADTS-QTY         TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-MADTS-QTY                     
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-MADTS-QTY-SGN                 
           ELSE                                                                 
               MOVE '-'                  TO DELTA-MADTS-QTY-SGN                 
           END-IF                                                               
                                                                                
           MOVE MRITST-LTVFACT-FCTR      TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-LTVFACT-FCTR                  
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-LTVFACT-FCTR-SGN              
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LTVFACT-FCTR-SGN              
           END-IF                                                               
                                                                                
           MOVE MRITST-PCTZ-PCT          TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-PCTZ-PCT                      
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-PCTZ-PCT-SGN                  
           ELSE                                                                 
               MOVE '-'                  TO DELTA-PCTZ-PCT-SGN                  
           END-IF                                                               
                                                                                
           MOVE MRITST-LDD-FCTR          TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-LDD-FCTR                      
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-LDD-FCTR-SGN                  
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LDD-FCTR-SGN                  
           END-IF                                                               
                                                                                
           MOVE MRITST-LDDI-FCTR         TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-LDDI-FCTR                     
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-LDDI-FCTR-SGN                 
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LDDI-FCTR-SGN                 
           END-IF                                                               
                                                                                
           MOVE MRITST-LMADSS-QTY        TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-LMADSS-QTY                    
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-LMADSS-QTY-SGN                
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LMADSS-QTY-SGN                
           END-IF                                                               
                                                                                
           MOVE MRITST-LFWMAD-QTY        TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-LFWMAD-QTY                    
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-LFWMAD-QTY-SGN                
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LFWMAD-QTY-SGN                
           END-IF                                                               
                                                                                
           MOVE MRITST-LCPS-QTY          TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-LCPS-QTY                      
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-LCPS-QTY-SGN                  
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LCPS-QTY-SGN                  
           END-IF                                                               
                                                                                
           MOVE MRITST-LRTFCST-NBR       TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-LRTFCST-NBR                   
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-LRTFCST-NBR-SGN               
           ELSE                                                                 
               MOVE '-'                  TO DELTA-LRTFCST-NBR-SGN               
           END-IF                                                               
                                                                                
           MOVE MRITST-MINDD-QTY         TO PF-S96V1-UNPACK                     
           MOVE PF-S96V1-UNPACK          TO DELTA-MINDD-QTY                     
           IF PF-S96V1-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-MINDD-QTY-SGN                 
           ELSE                                                                 
               MOVE '-'                  TO DELTA-MINDD-QTY-SGN                 
           END-IF                                                               
                                                                                
           MOVE MRITST-ON-ORDER-QTY      TO PF-S97-UNPACK                       
           MOVE PF-S97-UNPACK            TO DELTA-ON-ORDER-QTY                  
           IF PF-S97-UNPACK > 0 OR = 0                                          
               MOVE '+'                  TO DELTA-ON-ORDER-QTY-SGN              
           ELSE                                                                 
               MOVE '-'                  TO DELTA-ON-ORDER-QTY-SGN              
           END-IF                                                               
                                                                                
           MOVE MRITST-MAXOQP-PCT        TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-MAXOQP-PCT                    
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-MAXOQP-PCT-SGN                
           ELSE                                                                 
               MOVE '-'                  TO DELTA-MAXOQP-PCT-SGN                
           END-IF                                                               
                                                                                
           MOVE MRITST-OUTL-QTY           TO PF-S910-COMP                       
           MOVE PF-S910-COMP              TO PF-S910-UNPACK                     
           MOVE PF-S910-UNPACK            TO DELTA-OUTL-QTY                     
           IF PF-S910-UNPACK > 0 OR = 0                                         
               MOVE '+'                  TO DELTA-OUTL-QTY-SGN                  
           ELSE                                                                 
               MOVE '-'                  TO DELTA-OUTL-QTY-SGN                  
           END-IF                                                               
                                                                                
           MOVE MRITST-OP-QTY            TO PF-S910-COMP                        
           MOVE PF-S910-COMP             TO PF-S910-UNPACK                      
           MOVE PF-S910-UNPACK           TO DELTA-OP-QTY                        
           IF PF-S910-UNPACK > 0 OR = 0                                         
               MOVE '+'                  TO DELTA-OP-QTY-SGN                    
           ELSE                                                                 
               MOVE '-'                  TO DELTA-OP-QTY-SGN                    
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMINT1-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMINT1-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMINT1-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMINT1-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMINT2-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMINT2-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMINT2-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMINT2-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMINT3-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMINT3-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMINT3-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMINT3-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMINT4-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMINT4-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMINT4-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMINT4-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMINT5-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMINT5-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMINT5-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMINT5-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMINT6-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMINT6-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMINT6-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMINT6-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMAXT1-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMAXT1-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMAXT1-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMAXT1-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMAXT2-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMAXT2-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMAXT2-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMAXT2-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMAXT3-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMAXT3-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMAXT3-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMAXT3-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMAXT4-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMAXT4-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMAXT4-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMAXT4-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMAXT5-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMAXT5-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMAXT5-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMAXT5-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-CSTKMAXT6-PCT     TO PF-S91V92-UNPACK                    
           MOVE PF-S91V92-UNPACK         TO DELTA-CSTKMAXT6-PCT                 
           IF PF-S91V92-UNPACK > 0 OR = 0                                       
               MOVE '+'                  TO DELTA-CSTKMAXT6-PCT-SGN             
           ELSE                                                                 
               MOVE '-'                  TO DELTA-CSTKMAXT6-PCT-SGN             
           END-IF                                                               
                                                                                
           MOVE MRITST-SSTOCK-QTY        TO PF-S96V2-UNPACK                     
           MOVE PF-S96V2-UNPACK          TO DELTA-SSTOCK-QTY                    
           IF PF-S96V2-UNPACK > 0 OR = 0                                        
               MOVE '+'                  TO DELTA-SSTOCK-QTY-SGN                
           ELSE                                                                 
               MOVE '-'                  TO DELTA-SSTOCK-QTY-SGN                
           END-IF                                                               
      ************************************************************              
           .                                                                    
      ******************************************************************        
      *  WRITE THE INSERT RECORD                                                
      ******************************************************************        
       7100-WRITE-ISRT.                                                         
           WRITE  CW-INSERT-RECORD FROM DLTA-RECORD.                            
           ADD +1 TO PA-OUTPUT-RECORDS.                                         
                                                                                
      ******************************************************************        
      *  WRITE THE DELETE RECORD                                                
      ******************************************************************        
       7200-WRITE-DEL.                                                          
           WRITE  CW-DELETE-RECORD FROM DLTA-RECORD.                            
           ADD +1 TO PA-OUTPUT-RECORDS.                                         
                                                                                
      ******************************************************************        
      *  WRITE THE COUNT FILE                                                   
      ******************************************************************        
       7300-WRITE-COUNT.                                                        
           WRITE  CW-COUNT-RECORD FROM COUNT-RECORD.                            
                                                                                
      ******************************************************************        
      *  READ THE CURRENT FILE.                                        *        
      ******************************************************************        
       8000-READ-CURRENT.                                                       
           READ CW-CURRENT-FILE                                                 
               INTO CURRENT-REC                                                 
               AT END                                                           
                   MOVE HIGH-VALUES  TO  CR-CURR-KEY                            
               NOT AT END                                                       
                   ADD 1           TO  PA-INPUT-RECORDS                         
                   ADD 1           TO  PA-INPUT-CUR-RECORDS                     
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *  READ THE PREVIOUS FILE.                                                
      ******************************************************************        
       8100-READ-PREVIOUS.                                                      
           READ CW-PREVIOUS-FILE                                                
               INTO PREVIOUS-REC                                                
               AT END                                                           
                   MOVE HIGH-VALUES  TO  PR-PREV-KEY                            
               NOT AT END                                                       
                   ADD 1           TO  PA-INPUT-RECORDS                         
                   ADD 1           TO  PA-INPUT-PRE-RECORDS                     
           END-READ.                                                            
                                                                                
      ******************************************************************        
       9000-EOJ-ROUTINE.                                                        
                                                                                
           DISPLAY '   '.                                                       
           DISPLAY '** RECORDS COUNTS FOR PROGRAM: ' PC-PROGRAM-NAME.           
           DISPLAY '   '.                                                       
                                                                                
           DISPLAY 'INPUT RECS READ    : ' PA-INPUT-RECORDS.                    
           DISPLAY 'INPUT PREVIOUS RECS: ' PA-INPUT-PRE-RECORDS.                
           DISPLAY 'INPUT CURRENT RECS : ' PA-INPUT-CUR-RECORDS.                
           DISPLAY '   '.                                                       
           DISPLAY 'OUTPUT RECS WRITTEN: ' PA-OUTPUT-RECORDS.                   
           DISPLAY 'INSERT RECS WRITTEN: ' PA-INSERT-RECORDS.                   
           DISPLAY 'UPDATE RECS WRITTEN: ' PA-UPDATE-RECORDS.                   
           DISPLAY 'DELETE RECS WRITTEN: ' PA-DELETE-RECORDS.                   
           DISPLAY 'NO CHANGE RECORDS  : ' PA-NO-CHANGE-RECORDS.                
           DISPLAY '   '.                                                       
                                                                                
           OPEN OUTPUT CW-COUNT-FILE.                                           
           MOVE PA-OUTPUT-RECORDS TO COUNT-REC-9.                               
           PERFORM 7300-WRITE-COUNT.                                            
           CLOSE CW-CURRENT-FILE                                                
                 CW-PREVIOUS-FILE                                               
                 CW-INSERT-FILE                                                 
                 CW-DELETE-FILE                                                 
                 CW-COUNT-FILE.                                                 
      ******************************************************************        
      ******************************************************************        
