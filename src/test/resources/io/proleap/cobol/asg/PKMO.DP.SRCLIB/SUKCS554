000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS554.                                         00040000
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  04-14-2000.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S554 - PO/RCVR CARTON DETAIL LIST                          * 00110000
001200*                                                               * 00120000
001300*---------------------------------------------------------------* 00130000
001310*    CHANGES                                                     *00131009
001320*    MADE BY: CHERI PARMLEY                                      *00132010
001330*    DATE:    09/24/2014                                         *00133010
001340*                                                                *00134010
001350*    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00135010
001360*    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/24/2014      *00136010
001370*                                                                *00137010
001380*----------------------------------------------------------------*00138010
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00139120
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00139220
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00139320
001130*                                                                 00139421
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00139521
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00139621
263968*---------------------------------------------------------------* 00139720
001400 EJECT                                                            00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600                                                                  00160000
001700 DATA DIVISION.                                                   00170000
001800                                                                  00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100 01  DK-DB2-KEYS.                                                 00210000
002200     15  DK-SHIPT-UNT-ID                 PIC S9(18)V COMP-3.      00220000
002300                                                                  00230000
002400     15  DK-SCAC-ID                      PIC  X(04) VALUE SPACES. 00240000
002500                                                                  00250000
002600     15  DK-TRLR-NBR                     PIC  X(11) VALUE SPACES. 00260000
002700                                                                  00270000
002800     15  DK-TRIP-ID                      PIC S9(09) VALUE ZERO    00280000
002900                                                    COMP.         00290000
003000     15  DK-PO-NBR                       PIC S9(09) VALUE ZERO    00300000
003100                                                    COMP.         00310000
003200     15  DK-REC-SEQ-NBR                  PIC S9(09) VALUE ZERO    00320000
003300                                                    COMP.         00330000
003310     15  DK-LNE-NBR                      PIC S9(04) VALUE ZERO    00331000
003311                                                    COMP.         00331100
003312     15  DK-PREPK-ID                     PIC S9(04) VALUE ZERO    00331200
003313                                                    COMP.         00331300
003314                                                                  00331400
003315                                                                  00331500
003316                                                                  00331600
003317 01  PC-PROGRAM-CONSTANTS.                                        00331700
003318     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SUK554  '.  00331800
003319     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM554 '.  00331900
003320     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS554'.  00332000
003340     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00334000
003350     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00335000
003360     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00336000
003370     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00337000
003380     05  PC-LIST-FORMAT-3          PIC  X(01)  VALUE '3'.         00338000
003390     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +09          00339000
003400                                               COMP SYNC.         00340000
003500     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00350000
003600                                               COMP SYNC.         00360000
003700     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00370000
003800                                               COMP-3.            00380000
003900     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00390000
004000                                               COMP SYNC.         00400000
004100     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00410000
004200                                               COMP-3.            00420000
004300     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00430000
004400     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00440000
004500     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00450000
004600     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00460000
004700     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00470000
004800     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00480000
004900     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00490000
005000                                               COMP.              00500000
005100     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00510000
005200     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00520000
005300     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00530000
005400     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00540000
005500     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00550000
005600     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00560000
005700     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00570000
005800     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00580000
005900     05  PC-01                     PIC  X(02)  VALUE '01'.        00590000
006000     05  PC-MULT                   PIC  X(08)  VALUE 'MULTIPLE'.  00600000
006100*                                                                 00610000
006200                                                                  00620000
006300*                                                                 00630000
006400*----------------------------------------------------------------*00640000
006500*  DESCRIPTION CONSTANTS                                         *00650000
006600*----------------------------------------------------------------*00660000
006700     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  00670000
006800     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  00680000
006900     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  00690000
007000     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  00700000
007100     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  00710000
007200     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  00720000
007300     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  00730000
007400     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  00740000
007500     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  00750000
007600     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  00760000
007700     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.00770000
007800     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.00780000
007900     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     00790000
008000                                           VALUE '** UNKNOWN **'. 00800000
008100     05  PC-UNKNWN-VENDOR           PIC X(16)                     00810000
008200                                         VALUE ' UNKNOWN VENDOR '.00820000
008300*                                                                 00830000
008400*----------------------------------------------------------------*00840000
008500*  SYSTEM MESSAGES                                               *00850000
008600*----------------------------------------------------------------*00860000
008700*   00005 = INVALID VALUE                                        *00870000
008800*   00008 = MUST BE NUMERIC                                      *00880000
008900*   00045 = INVALID FUNCTION KEY                                 *00890000
009000*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00900000
009100*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00910000
009200*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00920000
009300*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00930000
009400*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00940000
009500*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00950000
009600*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00960000
009700*   00069 - TOP OF LIST                                          *00970000
009800*   00070 - BOTTOM OF LIST                                       *00980000
009900*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00990000
010000*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01000000
010100*   00279 - MORE ITEMS TO DISPLAY                                *01010000
010200*   00746 = INVALID PRINTER DESTINATION                          *01020000
010300*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01030000
010400*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01040000
010500*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01050000
010600*   02225 = CANNOT CONFIRM DISTRIBUTION - PULL CANCELLED          01060000
010700*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01070000
010800*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01080000
010900*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01090000
011000*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01100000
011100*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01110000
011200*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01120000
011300*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01130000
011400*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                01140000
011500*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              01150000
011600*   02258 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM PULL DI01160000
011700*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01170000
011800*   02260 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM LINE IT01180000
011900*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01190000
012000*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01200000
012100*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01210000
012200*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01220000
012300*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01230000
012400*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01240000
012500*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01250000
012600*   02268 - CANNOT CANCEL/UNCANCEL - LINE(S) ALREADY POSTED/DISTRB01260000
012700*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01270000
012800*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01280000
012900*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01290000
013000*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01300000
013100*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01310000
013200*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01320000
013300*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01330000
013400*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01340000
013500*   02278 = ALL SELECTED LINES MUST HAVE THE SAME STATUS TO PER  *01350000
013600*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01360000
013700*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01370000
013800*   02289 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS DISTRIBTD01380000
013900*   02290 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS POSTED   01390000
014000*   02291 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS CANCELLED01400000
014100*   02296 - PRINT PULL FAILED - NO LINE(S) FOR REQUESTED PULL     01410000
014200*   02297 - PRINT PULL FAILED - LINE(S) MISSING DISTRIBUTION INFOR01420000
014300*   02306 - YOU DO NOT HAVE AUTHORITY TO PRINT                    01430000
014400*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01440000
014500*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01450000
014600*   02317 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS NEW         01460000
014700*   02324 - PRINT REQUEST FAILED - LINE STATUS IS POSTED OR DISTRI01470000
014800*   02325 - PRINT REQUEST FAILED - LINE STATUS IS CANCELLED       01480000
014900*   02328 - YOU DO NOT HAVE AUTHORITY TO ADD NEW LINE ITEMS       01490000
015000*   02332 - CANNOT ADD LINE ITEMS - PULL STATUS IS POSTED/DISTRIBU01500000
015100*   02339 - CANNOT CONFIRM DISTRIBUTION - PULL LINE STATUS NEW    01510000
015200*   99901 = INVALID COMMAND WAS ENTERED                          *01520000
015300*----------------------------------------------------------------*01530000
015400     05  PC-TSYMSG-NUMBERS.                                       01540000
015500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01550000
015600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01560000
015700         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01570000
015800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01580000
015900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01590000
016000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01600000
016100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01610000
016200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01620000
016300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01630000
016400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01640000
016500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01650000
016600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01660000
016700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01670000
016800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01680000
016900         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01690000
017000         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01700000
017100         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01710000
017200         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01720000
017300         10  PC-TSYMSG-02224            PIC  9(05)  VALUE 02224.  01730000
017400         10  PC-TSYMSG-02225            PIC  9(05)  VALUE 02225.  01740000
017500         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01750000
017600         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01760000
017700         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01770000
017800         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01780000
017900         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01790000
018000         10  PC-TSYMSG-02254            PIC  9(05)  VALUE 02254.  01800000
018100         10  PC-TSYMSG-02255            PIC  9(05)  VALUE 02255.  01810000
018200         10  PC-TSYMSG-02256            PIC  9(05)  VALUE 02256.  01820000
018300         10  PC-TSYMSG-02257            PIC  9(05)  VALUE 02257.  01830000
018400         10  PC-TSYMSG-02258            PIC  9(05)  VALUE 02258.  01840000
018500         10  PC-TSYMSG-02259            PIC  9(05)  VALUE 02259.  01850000
018600         10  PC-TSYMSG-02260            PIC  9(05)  VALUE 02260.  01860000
018700         10  PC-TSYMSG-02261            PIC  9(05)  VALUE 02261.  01870000
018800         10  PC-TSYMSG-02262            PIC  9(05)  VALUE 02262.  01880000
018900         10  PC-TSYMSG-02263            PIC  9(05)  VALUE 02263.  01890000
019000         10  PC-TSYMSG-02264            PIC  9(05)  VALUE 02264.  01900000
019100         10  PC-TSYMSG-02265            PIC  9(05)  VALUE 02265.  01910000
019200         10  PC-TSYMSG-02266            PIC  9(05)  VALUE 02266.  01920000
019300         10  PC-TSYMSG-02267            PIC  9(05)  VALUE 02267.  01930000
019400         10  PC-TSYMSG-02268            PIC  9(05)  VALUE 02268.  01940000
019500         10  PC-TSYMSG-02269            PIC  9(05)  VALUE 02269.  01950000
019600         10  PC-TSYMSG-02270            PIC  9(05)  VALUE 02270.  01960000
019700         10  PC-TSYMSG-02271            PIC  9(05)  VALUE 02271.  01970000
019800         10  PC-TSYMSG-02272            PIC  9(05)  VALUE 02272.  01980000
019900         10  PC-TSYMSG-02273            PIC  9(05)  VALUE 02273.  01990000
020000         10  PC-TSYMSG-02274            PIC  9(05)  VALUE 02274.  02000000
020100         10  PC-TSYMSG-02275            PIC  9(05)  VALUE 02275.  02010000
020200         10  PC-TSYMSG-02276            PIC  9(05)  VALUE 02276.  02020000
020300         10  PC-TSYMSG-02278            PIC  9(05)  VALUE 02278.  02030000
020400         10  PC-TSYMSG-02287            PIC  9(05)  VALUE 02287.  02040000
020500         10  PC-TSYMSG-02288            PIC  9(05)  VALUE 02288.  02050000
020600         10  PC-TSYMSG-02289            PIC  9(05)  VALUE 02289.  02060000
020700         10  PC-TSYMSG-02290            PIC  9(05)  VALUE 02290.  02070000
020800         10  PC-TSYMSG-02291            PIC  9(05)  VALUE 02291.  02080000
020900         10  PC-TSYMSG-02296            PIC  9(05)  VALUE 02296.  02090000
021000         10  PC-TSYMSG-02297            PIC  9(05)  VALUE 02297.  02100000
021100         10  PC-TSYMSG-02306            PIC  9(05)  VALUE 02306.  02110000
021200         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  02120000
021300         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  02130000
021400         10  PC-TSYMSG-02317            PIC  9(05)  VALUE 02317.  02140000
021500         10  PC-TSYMSG-02324            PIC  9(05)  VALUE 02324.  02150000
021600         10  PC-TSYMSG-02325            PIC  9(05)  VALUE 02325.  02160000
021700         10  PC-TSYMSG-02328            PIC  9(05)  VALUE 02328.  02170000
021800         10  PC-TSYMSG-02332            PIC  9(05)  VALUE 02332.  02180000
021900         10  PC-TSYMSG-02339            PIC  9(05)  VALUE 02339.  02190000
022000         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02200000
022100*                                                                 02210000
022200 01  PS-PROGRAM-SWITCHES.                                         02220000
022300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02230000
022400         88  PS-NO-ERROR                            VALUE 'Y'.    02240000
022500         88  PS-ERROR                               VALUE 'N'.    02250000
022600     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    02260000
022700         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02270000
022800         88  PS-BLOCK-ERROR                         VALUE 'N'.    02280000
022900     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   02290000
023000         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   02300000
023100         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   02310000
023200     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02320000
023300         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02330000
023400         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02340000
023500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02350000
023600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02360000
023700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02370000
023800     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02380000
023900         88  PS-DONE                                VALUE 'Y'.    02390000
024000         88  PS-NOT-DONE                            VALUE 'N'.    02400000
024100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02410000
024200         88  PS-LIST-END                            VALUE 'Y'.    02420000
024300         88  PS-NO-LIST-END                         VALUE 'N'.    02430000
024400     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   02440000
024500         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   02450000
024600         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   02460000
024700     05  PS-FIRST-FETCH-SW              PIC  X(01)  VALUE  'N'.   02470000
024800         88  PS-FIRST-FETCH                         VALUE  'Y'.   02480000
024900         88  PS-NOT-FIRST-FETCH                     VALUE  'N'.   02490000
025000     05  PS-EO-CTN-CONTENT-CSR-SW       PIC  X(01)  VALUE  'N'.   02500000
025100         88  PS-EO-CTN-CONTENT                      VALUE  'Y'.   02510000
025200         88  PS-NOT-EO-CTN-CONTENT                  VALUE  'N'.   02520000
025300     05  PS-EO-CTN2-CONTENT-CSR-SW      PIC  X(01)  VALUE  'N'.   02530000
025400         88  PS-EO-CTN2-CONTENT                     VALUE  'Y'.   02540000
025500         88  PS-NOT-EO-CTN2-CONTENT                 VALUE  'N'.   02550000
025600     05  PS-PREPACK-SW                  PIC  X(01)  VALUE  'N'.   02560000
025700         88  PS-PREPACK-ORDER                       VALUE  'Y'.   02570000
025800         88  PS-NOT-PREPACK-ORDER                   VALUE  'N'.   02580000
025900     05  PS-XL-SKU-SELECT-NOT-FND-SW    PIC  X(01)  VALUE  'Y'.   02590000
026000         88  PS-XL-SKU-SELECT-FND                   VALUE  'Y'.   02600000
026100         88  PS-XL-SKU-SELECT-NOT-FND               VALUE  'N'.   02610000
026200*                                                                 02620000
026300 01  PV-PROGRAM-VARIABLES.                                        02630000
026400     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02640000
026500                                        COMP SYNC.                02650000
026600     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 02660000
026700                                                                  02670000
026800     05  PV-DISPLAY-LINE                PIC  9(04)  VALUE ZEROES. 02680002
026801     05  PV-DISPLAY-PREPK-2             PIC  9(04)  VALUE ZEROES. 02680102
026802     05  PV-DISPLAY-PREPK               PIC  9(04)  VALUE ZEROES. 02680202
026810     05  PV-DISPLAY-PO                  PIC  9(09)  VALUE ZEROES. 02681002
026900     05  PV-DISPLAY-RCVR                PIC  9(04)  VALUE ZEROES. 02690000
027000     05  PV-DISPLAY-TRIP                PIC  9(09)  VALUE ZEROES. 02700000
027100     05  PV-DISPLAY-CRTN                PIC  9(18)  VALUE ZEROES. 02710000
027101                                                                  02710113
027110     05  PV-DISP-SSCC                   PIC  9(18)  VALUE ZEROES. 02711013
027120     05  PV-DISP-PO                     PIC  9(09)  VALUE ZEROES. 02712013
027130     05  PV-DISP-REC                    PIC  9(04)  VALUE ZEROES. 02713013
027140     05  PV-DISP-TRIP                   PIC  9(09)  VALUE ZEROES. 02714013
027200                                                                  02720000
027300     05  PV-SUB                         PIC S9(04)  VALUE +0      02730000
027400                                                    COMP SYNC.    02740000
027500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02750000
027600                                                    COMP SYNC.    02760000
027700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02770000
027800                                                    COMP-3.       02780000
027900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02790000
028000                                                    COMP-3.       02800000
028100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02810000
028200                                                    COMP-3.       02820000
028300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02830000
028400                                                    COMP-3.       02840000
028500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02850000
028600                                                    COMP-3.       02860000
028700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02870000
028800                                                    COMP-3.       02880000
028900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02890000
029000                                                    COMP-3.       02900000
029100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02910000
029200                                                    COMP SYNC.    02920000
029300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02930000
029400                                                    COMP SYNC.    02940000
029500     05  PV-ITEM                        PIC S9(04)  VALUE +0      02950000
029600                                                    COMP SYNC.    02960000
029700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02970000
029800                                                    COMP SYNC.    02980000
029900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02990000
030000                                                    COMP SYNC.    03000000
030100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03010000
030200                                                    COMP SYNC.    03020000
030300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03030000
030400                                                    COMP SYNC.    03040000
030500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03050000
030600                                                    COMP SYNC.    03060000
030700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03070000
030800                                                    COMP SYNC.    03080000
030900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03090000
031000                                                    COMP SYNC.    03100000
031100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03110000
031200                                                    COMP SYNC.    03120000
031300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03130000
031400                                                    COMP SYNC.    03140000
031500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03150000
031600                                                    COMP SYNC.    03160000
031700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03170000
031800                                                    COMP SYNC.    03180000
031900     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03190000
032000                                                    COMP SYNC.    03200000
032100     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03210000
032200                                                    COMP SYNC.    03220000
032300     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      03230000
032400                                                    COMP.         03240000
032500     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      03250000
032600                                                    COMP.         03260000
032700     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      03270000
032800                                                    COMP.         03280000
032900     05  PV-SOFT-ABORT-MSG.                                       03290000
033000         10  FILLER            PIC X(12) VALUE ' SUKCS554 - '.    03300000
033100         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       03310000
033200         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    03320000
033300         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    03330000
033400         10  PV-SOFT-PARAGRAPH PIC X(30).                         03340000
033500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03350000
033600                                                     COMP SYNC.   03360000
033700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03370000
033800     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03380000
033900     05  PV-CICS-MSG-HOLD.                                        03390000
034000         10  FILLER                      PIC  X(01)  VALUE SPACE. 03400000
034100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 03410000
034200     05  PV-CICS-MSG-HOLD2.                                       03420000
034300         10  FILLER                      PIC  X(01)  VALUE SPACE. 03430000
034400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 03440000
034500                                                                  03450000
034600     05  PV-SHIPT-UNT-ID                 PIC S9(18)  VALUE ZEROES 03460000
034700                                                     COMP.        03470000
034800     05  PV-PO-RECEIVER.                                          03480000
034810*CLP 09/24/2014                                                   03481010
034900         10  PV-PO-NBR                  PIC  9(08).               03490008
035000         10  FILLER                     PIC  X(01)   VALUE '-'.   03500000
035100         10  PV-RECEIVER                PIC  9(03).               03510009
035200                                                                  03520000
035300     05  PV-REC-SEQ-NBR                 PIC S9(09)  VALUE +0      03530000
035400                                                    COMP SYNC.    03540000
035500                                                                  03550000
035600                                                                  03560000
035700     05  PV-VENDOR-NAME                  PIC  X(30) VALUE SPACES. 03570000
035800                                                                  03580000
035900     05  PV-SCAC                         PIC  X(04) VALUE SPACES. 03590000
036000                                                                  03600000
036100     05  PV-TRLR-NBR                     PIC  X(11) VALUE SPACES. 03610000
036200                                                                  03620000
036300     05  PV-TRIP-ID                      PIC S9(09) VALUE ZEROES  03630000
036400                                                    COMP.         03640000
036500     05  PV-PO-LINE-NBR                  PIC S9(04) VALUE ZEROES  03650000
036600                                                    COMP.         03660000
036700     05  PV-UPC-NBR                      PIC S9(15) VALUE ZEROES  03670000
036800                                                    COMP.         03680000
036900     05  PV-SHIPD-QTY                    PIC S9(04) VALUE ZEROES  03690000
037000                                                    COMP.         03700000
037100     05  PV-DISPLAY-UPC                  PIC  9(15) VALUE ZEROES. 03710000
037200                                                                  03720000
037300     05  PV-PREPK-RATIO                  PIC S9(09) VALUE ZEROES  03730000
037400                                                    COMP.         03740000
037500     05  PV-SKU-NMBR.                                             03750000
037600         10  PV-SKU-DEPT                 PIC  X(03) VALUE SPACES. 03760000
037700         10  FILLER                      PIC  X(01) VALUE SPACES. 03770000
037800         10  PV-SKU-CLASS                PIC  X(02) VALUE SPACES. 03780000
037900         10  FILLER                      PIC  X(01) VALUE SPACES. 03790000
038000         10  PV-SKU-NBR                  PIC  9(08) VALUE ZEROES. 03800000
038100         10  PV-SKU-NBR-X REDEFINES PV-SKU-NBR                    03810000
038200                                         PIC  X(08).              03820000
038300     05  PV-SKU-DESC                     PIC  X(15) VALUE SPACES. 03830000
038400     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 03840000
038500     05  PV-LINE-STATUS-DESC             PIC  X(09) VALUE SPACES. 03850000
038600                                                                  03860000
038700     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     03870000
038800                                                     COMP SYNC.   03880000
038900     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      03890000
039000     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      03900000
039100     05  PV-PREPK-ID                     PIC ZZZ9.                03910000
039200     05  PV-SQL-LETTER                   PIC X(01) VALUE SPACE.   03920000
039300*                                                                 03930000
039400     05  PV-DTE-TME.                                              03940000
039500         10  PV-DTE                     PIC  X(10)  VALUE SPACES. 03950000
039600         10  FILLER                     PIC  X(01)  VALUE SPACES. 03960000
039700         10  PV-TME                     PIC  X(07)  VALUE SPACES. 03970000
039800                                                                  03980000
039900     05  PV-CREATE-DTE                   PIC  X(10) VALUE SPACES. 03990000
040000     05  PV-REFORMAT-DATE.                                        04000000
040100         10  PV-REFORMAT-DTE.                                     04010000
040200             15  PV-REFORMAT-YYYY         PIC X(04)  VALUE SPACES.04020000
040300             15  FILLER                   PIC X(01)  VALUE SPACES.04030000
040400             15  PV-REFORMAT-MM           PIC X(02)  VALUE SPACES.04040000
040500             15  FILLER                   PIC X(01)  VALUE SPACES.04050000
040600             15  PV-REFORMAT-DD           PIC X(02)  VALUE SPACES.04060000
040700     05  PV-FORMAT-DATE.                                          04070000
040800         10  PV-FORMAT-DTE.                                       04080000
040900             15  PV-FORMAT-MM             PIC X(02)  VALUE SPACES.04090000
041000             15  FILLER                   PIC X(01)  VALUE '/'.   04100000
041100             15  PV-FORMAT-DD             PIC X(02)  VALUE SPACES.04110000
041200             15  FILLER                   PIC X(01)  VALUE '/'.   04120000
041300             15  PV-FORMAT-YYYY           PIC X(04)  VALUE SPACES.04130000
041400                                                                  04140000
041500     05  PV-CREATE-TME                   PIC  X(08) VALUE SPACES. 04150000
041600     05  PV-FORMAT-TIME.                                          04160000
041700         10  PV-FORMAT-TME.                                       04170000
041800             15  PV-FORMAT-HH             PIC X(02)  VALUE SPACES.04180000
041900             15  FILLER                   PIC X(01)  VALUE ':'.   04190000
042000             15  PV-FORMAT-MIN            PIC X(02)  VALUE SPACES.04200000
042100             15  FILLER                   PIC X(01)  VALUE ':'.   04210000
042200             15  PV-FORMAT-SS             PIC X(02)  VALUE SPACES.04220000
042300                                                                  04230000
042400                                                                  04240000
042500 01  DN-DB2-NULL-INDICATORS.                                      04250000
042600     05  DN-VEH-NBR                PIC S9(04) COMP VALUE ZEROES.  04260000
042700*                                                                 04270000
042800     COPY PCWS046.                                                04280000
042900******************************************************************04290000
043000**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **04300000
043100**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **04310000
043200**  APPLICATION-SPECIFIC COMMAREA.                              **04320000
043300******************************************************************04330000
043400 01  LQW-LIST-QUEUE-WORK-AREA.                                    04340000
043500     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04350000
043600     05  LQW-ITEM-ENTRIES               OCCURS 09 TIMES           04360000
043700                                        INDEXED BY LQW-IDX.       04370000
043800         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04380000
043900         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04390000
044000         10  LQW-SELECTED-SW            PIC  X(01).               04400000
044100             88  LQW-SELECT                         VALUE 'S'.    04410000
044200             88  LQW-DESELECT                       VALUE ' '.    04420000
044300         10  LQW-ACTION                 PIC  X(03).               04430000
044400             88  LQW-DEL                            VALUE 'DEL'.  04440000
044500             88  LQW-INQ                            VALUE 'INQ'.  04450000
044600             88  LQW-UPD                            VALUE 'UPD'.  04460000
044700             88  LQW-ERR                            VALUE 'ERR'.  04470000
044800             88  LQW-PRT                            VALUE 'PRT'.  04480000
044900         10  LQW-PO-LINE                PIC  9(04).               04490000
045000         10  LQW-MERCH-CLASS            PIC  X(02).               04500000
045100         10  LQW-SEQUENCE               PIC  9(08).               04510000
045200         10  LQW-SKU-DESC               PIC  X(20).               04520000
045300         10  LQW-UPC                    PIC  9(15).               04530000
045400         10  LQW-SHIPD-QTY              PIC  Z(05).               04540000
045500                                                                  04550000
045600         10  LQW-PREPK-RATIO            PIC  Z(05).               04560000
045700         10  LQW-RECITM-VER-STATUS      PIC  X(01).               04570000
045800         10  LQW-LNE-UPC-ERROR-SW       PIC  X(01).               04580000
045900             88  LQW-LNE-UPC-ERROR-YES  VALUE 'Y'.                04590000
046000             88  LQW-LNE-UPC-ERROR-NO   VALUE 'N'.                04600000
046100*                                                                 04610000
046200                                                                  04620000
046300*---------------------------------------------------------------* 04630000
046400* SELECTON QUEUE LAYOUT                                         * 04640000
046500*---------------------------------------------------------------* 04650000
046600     COPY SUWS004.                                                04660000
046700                                                                  04670000
046800                                                                  04680000
046900*---------------------------------------------------------------* 04690000
047000*    MAP LAYOUT                                                 * 04700000
047100*---------------------------------------------------------------* 04710000
047200                                                                  04720000
047300     COPY SUKM554.                                                04730000
047400*                                                                 04740000
047500 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK554O.       04750000
047600     05  FILLER                         PIC X(474).               04760000
047700     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          04770000
047800         10  MR-SELECTL                 PIC S9(04) COMP.          04780000
047900         10  MR-SELECTA                 PIC  X(01).               04790000
048000         10  MR-SELECTC                 PIC  X(01).               04800000
048100         10  MR-SELECTH                 PIC  X(01).               04810000
048200         10  MR-SELECTI                 PIC  X(01).               04820000
048300                                                                  04830000
048400         10  MR-ACTIONL                 PIC S9(04) COMP.          04840000
048500         10  MR-ACTIONA                 PIC  X(01).               04850000
048600         10  MR-ACTIONC                 PIC  X(01).               04860000
048700         10  MR-ACTIONH                 PIC  X(01).               04870000
048800         10  MR-ACTION                  PIC  X(01).               04880000
048900                                                                  04890000
049000         10  MR-PO-LINEL                PIC S9(04) COMP.          04900000
049100         10  MR-PO-LINEA                PIC  X(01).               04910000
049200         10  MR-PO-LINEC                PIC  X(01).               04920000
049300         10  MR-PO-LINEH                PIC  X(01).               04930000
049400         10  MR-PO-LINE-X.                                        04940000
049500             15  MR-PO-LINE             PIC  ZZ99.                04950000
049600                                                                  04960000
049700         10  MR-DP-CL-SKUL              PIC S9(04) COMP.          04970000
049800         10  MR-DP-CL-SKUA              PIC  X(01).               04980000
049900         10  MR-DP-CL-SKUC              PIC  X(01).               04990000
050000         10  MR-DP-CL-SKUH              PIC  X(01).               05000000
050100         10  MR-DP-CL-SKU               PIC  X(15).               05010000
050200                                                                  05020000
050300         10  MR-SKU-DESCL               PIC S9(04) COMP.          05030000
050400         10  MR-SKU-DESCA               PIC  X(01).               05040000
050500         10  MR-SKU-DESCC               PIC  X(01).               05050000
050600         10  MR-SKU-DESCH               PIC  X(01).               05060000
050700         10  MR-SKU-DESC                PIC  X(20).               05070000
050800                                                                  05080000
050900         10  MR-UPCL                    PIC S9(04) COMP.          05090000
051000         10  MR-UPCA                    PIC  X(01).               05100000
051100         10  MR-UPCC                    PIC  X(01).               05110000
051200         10  MR-UPCH                    PIC  X(01).               05120000
051300         10  MR-UPC-X.                                            05130000
051400             15  MR-UPC                 PIC  9(15).               05140000
051500                                                                  05150000
051600         10  MR-SHIPD-QTYL              PIC S9(04) COMP.          05160000
051700         10  MR-SHIPD-QTYA              PIC  X(01).               05170000
051800         10  MR-SHIPD-QTYC              PIC  X(01).               05180000
051900         10  MR-SHIPD-QTYH              PIC  X(01).               05190000
052000         10  MR-SHIPD-QTY-X.                                      05200000
052100*            15  MR-SHIPD-QTY           PIC  Z(05).               05210000
052200             15  MR-SHIPD-QTY           PIC  ZZZZ9.               05220000
052300                                                                  05230000
052400         10  MR-PREPACK-RATIOL          PIC S9(04) COMP.          05240000
052500         10  MR-PREPACK-RATIOA          PIC  X(01).               05250000
052600         10  MR-PREPACK-RATIOC          PIC  X(01).               05260000
052700         10  MR-PREPACK-RATIOH          PIC  X(01).               05270000
052800         10  MR-PREPACK-RATIO-X.                                  05280000
052900             15  MR-PREPACK-RATIO       PIC  Z(05).               05290000
053000                                                                  05300000
053100*    05  FILLER                         PIC  X(12).               05310000
053200                                                                  05320000
053300                                                                  05330000
053400*----------------------------------------------------------------*05340000
053500*  SENDING/RECEIVING AREA FOR THE                                *05350000
053600*  PRINTER VALIDATION ROUTING (DPKCS060)                         *05360000
053700*----------------------------------------------------------------*05370000
053800     COPY DPWS072.                                                05380000
053900                                                                  05390000
054000                                                                  05400000
054100*----------------------------------------------------------------*05410000
054200**  SECURITY SUBROUTINE PARAMETERS                                05420000
054300*----------------------------------------------------------------*05430000
054400     COPY DPWS008.                                                05440000
054500                                                                  05450000
054600                                                                  05460000
054700*---------------------------------------------------------------* 05470000
054800*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05480000
054900*---------------------------------------------------------------* 05490000
055000                                                                  05500000
055100     COPY DPWS015.                                                05510000
055200                                                                  05520000
055300*---------------------------------------------------------------* 05530000
055400*    FUNCTION KEYS COPYBOOK.                                    * 05540000
055500*---------------------------------------------------------------* 05550000
055600                                                                  05560000
055700     COPY DPWS016.                                                05570000
055800                                                                  05580000
055900*---------------------------------------------------------------* 05590000
056000*    NUMERIC EDIT LAYOUT.                                       * 05600000
056100*---------------------------------------------------------------* 05610000
056200                                                                  05620000
056300     COPY DPWS010I.                                               05630000
056400 EJECT                                                            05640000
056500*---------------------------------------------------------------* 05650000
056600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 05660021
056700*---------------------------------------------------------------* 05670000
056800                                                                  05680000
056900     COPY DPWS030.                                                05690000
056900     COPY DPWS930.                                                05691021
057000 EJECT                                                            05700000
057100*---------------------------------------------------------------* 05710000
057200*    STANDARD COMMAREA.                                         * 05720000
057300*---------------------------------------------------------------* 05730000
057400                                                                  05740000
057500     COPY DPWS020.                                                05750000
057600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05760000
057700                                                                  05770000
057800*---------------------------------------------------------------* 05780000
057900* INTER-APPLICATION COMMAREA.                                   * 05790000
058000*   SUWS002 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05800000
058100*             SPEC SCREEN.                                      * 05810000
058200*   SUWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05820000
058300*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05830000
058310*   SUWS046 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05831017
058320*             THIS LIST TO PACKSLIP LIST SCREEN F17             * 05832017
058400*---------------------------------------------------------------* 05840000
058500                                                                  05850000
058600         10  INTER-APPL-COMM-AREA       PIC X(200).               05860000
058700     COPY SUWS002.                                                05870000
058800     COPY SUWS003.                                                05880000
058810     COPY SUWS046.                                                05881017
058900*---------------------------------------------------------------* 05890000
059000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05900000
059100*---------------------------------------------------------------* 05910000
059200         10  ASC-SPECIFIC-COMMAREA.                               05920000
059300             15  ASC-SHIPT-UNT-ID            PIC  S9(18)V COMP-3. 05930000
059400*            15  ASC-DEST-OPER-UNT-ID        PIC  9(3).           05940000
059500             15  ASC-DEST-OPER-UNT-ID        PIC  X(08).          05950000
059600             15  ASC-PO-NUMBER               PIC  X(09).          05960000
059610*CLP 09/24/2014                                                   05961010
059700             15  ASC-PO-RECEIVER.                                 05970000
059800               20 ASC-PO-NBR                 PIC  9(08).          05980008
059900               20 FILLER                     PIC  9(01).          05990000
060000               20 ASC-RECEIVER               PIC  9(03).          06000009
060100             15  ASC-MERCH-DEPT              PIC  X(03).          06010000
060200             15  ASC-VENDOR-NME              PIC  X(30).          06020000
060300             15  ASC-SCAC                    PIC  X(04).          06030000
060400             15  ASC-TRLR-NBR                PIC  X(11).          06040000
060500             15  ASC-TRIP-ID                 PIC  9(09).          06050000
060600             15  ASC-TOTAL-QTY               PIC S9(05) COMP.     06060000
060700             15  ASC-CRE-SOURCE              PIC  X(22).          06070000
060800             15  ASC-CREATE-DTE              PIC  X(10).          06080000
060900             15  ASC-CREATE-TME              PIC  X(08).          06090000
061000             15  ASC-PREPK-ID                PIC  9(04).          06100000
061100             15  ASC-FROM-PGM-PREPK-ID       PIC  9(04).          06110000
061200             15  ASC-USR-ID                  PIC  X(08).          06120000
061300             15  FILLER                      PIC  X(112).         06130000
061400*-----------------------------------------------------------------06140000
061500             15  ASC-BLK-SUB                  PIC S9(04) COMP     06150000
061600                                                         SYNC.    06160000
061700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     06170000
061800                                                         SYNC.    06180000
061900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  06190000
062000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  06200000
062100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  06210000
062200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  06220000
062300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  06230000
062400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     06240000
062500                                                         SYNC.    06250000
062600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  06260000
062700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  06270000
062800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         06280000
062900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06290000
063000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06300000
063100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         06310000
063200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     06320000
063300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     06330000
063400             15  ASC-LIST-QUEUE-NAME.                             06340000
063500                 20  ASC-LIST-TERM-ID         PIC  X(04).         06350000
063600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  06360000
063700                 20  ASC-LIST-SEQ             PIC  9(01).         06370000
063800                                                                  06380000
063900             15  ASC-START-ITEM-REQUEST.                          06390000
064000                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         06400000
064100                                                                  06410000
064200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06420000
064300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06430000
064400             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06440000
064500                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06450000
064600             15  ASC-SEL-QUEUE-NAME.                              06460000
064700                 20  ASC-SEL-TERM-ID          PIC  X(04).         06470000
064800                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  06480000
064900                 20  ASC-SEL-SEQ              PIC  9(01).         06490000
065000             15  ASC-SEL-QUEUE-NAME-2.                            06500000
065100                 20  ASC-SEL-TERM-ID-2        PIC  X(04).         06510000
065200                 20  ASC-SEL-TASK-NUMBER-2    PIC S9(05) COMP-3.  06520000
065300                 20  ASC-SEL-SEQ-2            PIC  9(01).         06530000
065400             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06540000
065500             15  ASC-SMOOTHING-FLAG           PIC  X(1).          06550000
065600                 88  ASC-SMOOTHING-SCREEN-NO  VALUE 'N'.          06560000
065700                 88  ASC-SMOOTHING-SCREEN-YES VALUE 'Y'.          06570000
065800             15  ASC-MLTPL-CRTN-CHECK-SW      PIC  X(1).          06580000
065900                 88  ASC-MLTPL-CRTN-CHECK-NO  VALUE 'N'.          06590000
066000                 88  ASC-MLTPL-CRTN-CHECK-YES VALUE 'Y'.          06600000
066100                                                                  06610000
066200*-----------------------------------------------------------------06620000
066300                                                                  06630000
066400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06640000
066500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06650000
066600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06660000
066700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06670000
066800                                                                  06680000
066900                 20  ASC-ITEM-ARRAY.                              06690000
067000                     25  ASC-ITEM-ENTRIES OCCURS 09 TIMES.        06700000
067100                         30  ASC-LIST-ITEM-NUMBER                 06710000
067200                                                     PIC S9(09)   06720000
067300                                                     COMP-3.      06730000
067400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06740000
067500                             88  ASC-VALID-SELECT    VALUE ' '    06750000
067600                                                           'S'    06760000
067700                                                           'B'    06770000
067800                                                           'E'.   06780000
067900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06790000
068000                             88  ASC-TEMP-SELECT     VALUE 'S'.   06800000
068100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06810000
068200                             88  ASC-TEMP-END        VALUE 'E'.   06820000
068300                         30  ASC-SELECTED-SW         PIC  X(01).  06830000
068400                             88  ASC-NO-SELECT       VALUE ' '.   06840000
068500                             88  ASC-SELECT          VALUE 'S'.   06850000
068600                             88  ASC-BEGIN           VALUE 'B'.   06860000
068700                             88  ASC-END             VALUE 'E'.   06870000
068800                         30  ASC-ACTION              PIC  X(03).  06880000
068900                         30  ASC-PO-LINE             PIC  9(04).  06890000
069000                         30  ASC-DP-CL-SKU           PIC  X(15).  06900000
069100                         30  ASC-SKU-DESC            PIC  X(20).  06910000
069200                         30  ASC-UPC                 PIC  9(15).  06920000
069300                         30  ASC-SHIPD-QTY           PIC  Z(05).  06930000
069400                         30  ASC-PREPACK-RATIO       PIC  Z(05).  06940000
069500                         30  ASC-RECITM-VER-STATUS   PIC  X(01).  06950000
069600                         30  ASC-LNE-UPC-ERROR-SW    PIC  X(01).  06960000
069700                             88  ASC-LNE-UPC-ERROR-YES            06970000
069800                                                     VALUE 'Y'.   06980000
069900                             88  ASC-LNE-UPC-ERROR-NO             06990000
070000                                                     VALUE 'N'.   07000000
070100                         30  ASC-NOT-ON-PACK-SW      PIC  X(01).  07010000
070200                             88  ASC-NOT-ON-PACK-YES VALUE 'Y'.   07020000
070300                             88  ASC-NOT-ON-PACK-NO  VALUE 'N'.   07030000
070400*                                                                 07040000
070500     EJECT                                                        07050000
070600*---------------------------------------------------------------* 07060000
070700*    ABEND PROCESSING COPYBOOK.                                 * 07070000
070800*---------------------------------------------------------------* 07080000
070900                                                                  07090000
071000     COPY DPWS013.                                                07100000
071100                                                                  07110000
071200 EJECT                                                            07120000
071300*---------------------------------------------------------------* 07130000
071400* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 07140000
071500*---------------------------------------------------------------* 07150000
071600     COPY XLWS001.                                                07160000
071700                                                                  07170000
071800*---------------------------------------------------------------* 07180000
071900*    TSHUUPC -                                                    07190000
072000*---------------------------------------------------------------* 07200000
072100     EXEC SQL                                                     07210000
072200          INCLUDE TSHUUPC                                         07220000
072300     END-EXEC.                                                    07230000
072400*---------------------------------------------------------------* 07240000
072500*    TINPKSU -                                                    07250000
072600*---------------------------------------------------------------* 07260000
072700     EXEC SQL                                                     07270000
072800          INCLUDE TINPKSU                                         07280000
072900     END-EXEC.                                                    07290000
073000*---------------------------------------------------------------* 07300000
073100*    TENTNME -                                                    07310000
073200*---------------------------------------------------------------* 07320000
073300     EXEC SQL                                                     07330000
073400          INCLUDE TENTNME                                         07340000
073500     END-EXEC.                                                    07350000
073600*---------------------------------------------------------------* 07360000
073700*    TVHTRIP -                                                    07370000
073800*---------------------------------------------------------------* 07380000
073900     EXEC SQL                                                     07390000
074000          INCLUDE TVHTRIP                                         07400000
074100     END-EXEC.                                                    07410000
074200*---------------------------------------------------------------* 07420000
074300*    TTRIPST -                                                    07430000
074400*---------------------------------------------------------------* 07440000
074500     EXEC SQL                                                     07450000
074600          INCLUDE TTRIPST                                         07460000
074700     END-EXEC.                                                    07470000
074800*---------------------------------------------------------------* 07480000
074900*    TSHPTPO -                                                    07490000
075000*---------------------------------------------------------------* 07500000
075100     EXEC SQL                                                     07510000
075200          INCLUDE TSHPTPO                                         07520000
075300     END-EXEC.                                                    07530000
075400*---------------------------------------------------------------* 07540000
075500*    TSHIPMT -                                                    07550000
075600*---------------------------------------------------------------* 07560000
075700     EXEC SQL                                                     07570000
075800          INCLUDE TSHIPMT                                         07580000
075900     END-EXEC.                                                    07590000
076000*---------------------------------------------------------------* 07600000
076100*    TVEHICL -                                                    07610000
076200*---------------------------------------------------------------* 07620000
076300     EXEC SQL                                                     07630000
076400          INCLUDE TVEHICL                                         07640000
076500     END-EXEC.                                                    07650000
076600*---------------------------------------------------------------* 07660000
076700*    TTRSTYP -                                                    07670000
076800*---------------------------------------------------------------* 07680000
076900     EXEC SQL                                                     07690000
077000          INCLUDE TTRSTYP                                         07700000
077100     END-EXEC.                                                    07710000
077200*---------------------------------------------------------------* 07720000
077300*    TPKSLIP -                                                    07730000
077400*---------------------------------------------------------------* 07740000
077500     EXEC SQL                                                     07750000
077600          INCLUDE TPKSLIP                                         07760000
077700     END-EXEC.                                                    07770000
077800*---------------------------------------------------------------* 07780000
077900*    TRECITM -                                                    07790000
078000*---------------------------------------------------------------* 07800000
078100     EXEC SQL                                                     07810000
078200          INCLUDE TRECITM                                         07820000
078300     END-EXEC.                                                    07830000
078400*---------------------------------------------------------------* 07840000
078500*    TPURITM -                                                    07850000
078600*---------------------------------------------------------------* 07860000
078700     EXEC SQL                                                     07870000
078800          INCLUDE TPURITM                                         07880000
078900     END-EXEC.                                                    07890000
079000*---------------------------------------------------------------* 07900000
079100*    TPURCHS -                                                    07910000
079200*---------------------------------------------------------------* 07920000
079300     EXEC SQL                                                     07930000
079400          INCLUDE TPURCHS                                         07940000
079500     END-EXEC.                                                    07950000
079600*---------------------------------------------------------------* 07960000
079700*    TUPC -                                                       07970000
079800*---------------------------------------------------------------* 07980000
079900     EXEC SQL                                                     07990000
080000          INCLUDE TUPC                                            08000000
080100     END-EXEC.                                                    08010000
080200*---------------------------------------------------------------* 08020000
080300*    TSHPUNT                                                      08030000
080400*---------------------------------------------------------------* 08040000
080500     EXEC SQL                                                     08050000
080600          INCLUDE TSHPUNT                                         08060000
080700     END-EXEC.                                                    08070000
080800*---------------------------------------------------------------* 08080000
080900*    TSHUNLO                                                      08090000
081000*---------------------------------------------------------------* 08100000
081100     EXEC SQL                                                     08110000
081200          INCLUDE TSHUNLO                                         08120000
081300     END-EXEC.                                                    08130000
081400*---------------------------------------------------------------* 08140000
081500*    TSULBXF - SU CROSS REFERENCE                                 08150000
081600*---------------------------------------------------------------* 08160000
081700     EXEC SQL                                                     08170000
081800          INCLUDE TSULBXF                                         08180000
081900     END-EXEC.                                                    08190000
082000*---------------------------------------------------------------* 08200000
082100*    TRECEIV - RC RECEIVER                                        08210000
082200*---------------------------------------------------------------* 08220000
082300     EXEC SQL                                                     08230000
082400          INCLUDE TRECEIV                                         08240000
082500     END-EXEC.                                                    08250000
082600*---------------------------------------------------------------* 08260000
082700*    DB2 AREA FOR COMMUNICATIONS                                * 08270000
082800*---------------------------------------------------------------* 08280000
082900     EXEC SQL                                                     08290000
083000          INCLUDE SQLCA                                           08300000
083100     END-EXEC.                                                    08310000
083200                                                                  08320000
083300*---------------------------------------------------------------* 08330000
083400*    CARTON CONTENTS CURSOR                                     * 08340000
083500*---------------------------------------------------------------* 08350000
083600                                                                  08360000
083700     EXEC SQL                                                     08370000
083800         DECLARE CTN2-CONTENTS-CSR CURSOR FOR                     08380000
083900                 SELECT  A.TRN_NBR                                08390000
084000                     ,   A.TRN_LNE_NBR                            08400000
084100                     ,   A.UPC_NBR                                08410000
084200                     ,   A.SHPD_QTY                               08420000
084300                     ,   F.DEST_OPER_UNT_ID                       08430000
084400                     ,   F.CRE_DTE                                08440000
084500                     ,   F.CRE_TM                                 08450000
084600                     ,   F.SHIPT_UNT_SRC_ID                       08460000
084700                    FROM   TSHUUPC A,                             08470000
084800                           TSHPUNT F                              08480000
084900                    WHERE   A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID 08490000
085000                      AND   A.SHIPT_UNT_ID     = F.SHIPT_UNT_ID   08500000
085100                 ORDER BY 8, 1, 2, 3                              08510000
085200     END-EXEC.                                                    08520000
085300                                                                  08530000
085400                                                                  08540000
085500 LINKAGE SECTION.                                                 08550000
085600                                                                  08560000
085700 01  DFHCOMMAREA.                                                 08570000
085800     05  FILLER                         OCCURS  1 TO 4072 TIMES   08580000
085900                                        DEPENDING ON EIBCALEN.    08590000
086000         10  FILLER                     PIC X.                    08600000
086100                                                                  08610000
086200 EJECT                                                            08620000
086300 PROCEDURE DIVISION.                                              08630000
086400******************************************************************08640000
086500**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **08650000
086600**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **08660000
086700**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **08670000
086800******************************************************************08680000
086900 0000-MAIN-MODULE.                                                08690000
087000     INITIALIZE DP030-CICS-API-FIELDS.                            08700000
087100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08710000
087200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08720000
087300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08730000
087400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08740000
087500     MOVE LENGTH OF SUK554I        TO DP030-MAP-LENGTH (1).       08750000
087600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08760000
087700     PERFORM 0001-CALL-CICS-ARCH-API.                             08770000
087800*                                                                 08780000
087900     PERFORM 1000-CONTROL-PROCESSING                              08790000
088000*                                                                 08800000
088100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08810000
088200     PERFORM 0001-CALL-CICS-ARCH-API.                             08820000
088300                                                                  08830000
088400******************************************************************08840000
088500**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08850000
088600**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08860000
088700******************************************************************08870000
088800 0001-CALL-CICS-ARCH-API.                                         08880000
088900*    CALL 'DPKCS030' USING DFHEIBLK                               08890021
088900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08891021
089000                           DFHCOMMAREA                            08900000
089100                           DP030-CICS-API-FIELDS                  08910000
089200                           DP020-STANDARD-COMMAREA                08920000
089300                           SUK554I.                               08930000
089400*                                                                 08940000
089500     IF  DP030-RC-CALL-SUCCESSFUL                                 08950000
089600         CONTINUE                                                 08960000
089700     ELSE                                                         08970000
089800         SET DP013-NO-ROLLBACK                                    08980000
089900             DP013-XCTL-DISPLAY-RESTART                           08990000
090000             DP013-CICS-ABEND      TO TRUE                        09000000
090100         MOVE '0001-CALL-CICS-ARCH-API'                           09010000
090200                                   TO DP013-PARAGRAPH             09020000
090300*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX09030021
090400*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      09040021
090300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O09041021
090400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09042021
090500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09050000
090600         PERFORM DP013-0000-PROCESS-ABEND                         09060000
090700     END-IF.                                                      09070000
090800*----------------------------------------------------------------*09080000
090900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09090000
091000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09100000
091100*                                                                *09110000
091200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09120000
091300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09130000
091400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09140000
091500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09150000
091600*----------------------------------------------------------------*09160000
091700                                                                  09170000
091800 1000-CONTROL-PROCESSING.                                         09180000
091900                                                                  09190000
092000     EVALUATE TRUE                                                09200000
092100         WHEN DP020-NEXT-ACT-INITIAL                              09210000
092200             INITIALIZE ASC-SPECIFIC-COMMAREA                     09220000
092300             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09230000
092400                                      ASC-SEL-TERM-ID             09240000
092500                                      ASC-SEL-TERM-ID-2           09250000
092600             MOVE DP020-SRC-TASK-NUMBER                           09260000
092700                                   TO ASC-LIST-TASK-NUMBER        09270000
092800                                      ASC-SEL-TASK-NUMBER         09280000
092900                                      ASC-SEL-TASK-NUMBER-2       09290000
093000             MOVE PC-LIST-QUEUE-SEQ                               09300000
093100                                   TO ASC-LIST-SEQ                09310000
093200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09320000
093300                                      ASC-SEL-SEQ-2               09330000
093400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09340000
093500***-----$TEMPLATE NOTE$-------------------------------------------09350000
093600*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,09360000
093700*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  09370000
093800*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.09380000
093900***---------------------------------------------------------------09390000
094000             IF  PS-COMMAREA-NOT-VALID                            09400000
094100                 SET DP020-NEXT-ACT-APPL-ERROR                    09410000
094200                                   TO TRUE                        09420000
094300             ELSE                                                 09430000
094400                 PERFORM 4000-BUILD-INITIAL-PANEL                 09440000
094500             END-IF                                               09450000
094600                                                                  09460000
094700         WHEN DP020-NEXT-ACT-READ-MAP                             09470000
094800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09480000
094900                                   TO PV-TOP-ITEM                 09490000
095000             PERFORM 2000-PROCESS-PANEL                           09500000
095100                                                                  09510000
095200         WHEN DP020-NEXT-ACT-RETURN                               09520000
095300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09530000
095400                                   TO PV-TOP-ITEM                 09540000
095500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09550000
095600                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             09560000
095700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09570000
095800                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               09580000
095900                                                                  09590000
096000         WHEN OTHER                                               09600000
096100             SET DP013-LOGIC-ABEND TO TRUE                        09610000
096200             SET DP013-NO-ROLLBACK TO TRUE                        09620000
096300             MOVE '1000-CONTROL-PROCESSING'                       09630000
096400                                   TO DP013-PARAGRAPH             09640000
096500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09650000
096600                                   TO DP013-MESSAGE-TEXT(1)       09660000
096700             PERFORM DP013-0000-PROCESS-ABEND                     09670000
096800     END-EVALUATE.                                                09680000
096900                                                                  09690000
097000 EJECT                                                            09700000
097100*----------------------------------------------------------------*09710000
097200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *09720000
097300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *09730000
097400*----------------------------------------------------------------*09740000
097500                                                                  09750000
097600 1100-PROCESS-INTER-APPL-COMM.                                    09760000
097700                                                                  09770000
097800     SET PS-COMMAREA-VALID         TO TRUE.                       09780000
097900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09790000
098000                                                                  09800000
098100     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          09810000
098200         SET  ASC-SMOOTHING-SCREEN-NO TO TRUE                     09820000
098300         MOVE SU002-SHIPT-UNT-ID      TO ASC-SHIPT-UNT-ID         09830000
098400         MOVE SU002-SCAC              TO ASC-SCAC                 09840000
098500         MOVE SU002-TRLR-NBR          TO ASC-TRLR-NBR             09850000
098600         MOVE SU002-TRIP-ID           TO ASC-TRIP-ID              09860000
098700         IF SU002-TRIP-ID = ZERO AND SU002-SHIPT-UNT-ID > ZERO    09870000
098800             PERFORM 1101-GET-CARTON-INFO                         09880000
098900         END-IF                                                   09890000
099000     END-IF.                                                      09900000
099100                                                                  09910000
099200     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              09920000
099300       IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                      09930000
099400         SET ASC-SMOOTHING-SCREEN-NO  TO TRUE                     09940000
099500         MOVE SU003-SHIPT-UNT-ID      TO ASC-SHIPT-UNT-ID         09950000
099600         MOVE SU003-PO-NBR            TO ASC-PO-NBR               09960000
099700                                         PV-PO-NBR                09970000
099800                                         ASC-PO-NUMBER            09980000
099900         MOVE SU003-REC-SEQ-NBR       TO ASC-RECEIVER             09990000
100000                                         PV-REC-SEQ-NBR           10000000
100100         MOVE SU003-SCAC-CDE          TO ASC-SCAC                 10010000
100200         MOVE SU003-TRLR-NBR          TO ASC-TRLR-NBR             10020000
100300         MOVE SU003-TRIP-ID           TO ASC-TRIP-ID              10030000
100400                                                                  10040000
100500         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    10050000
100600         MOVE SU003-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  10060000
100700         MOVE SU003-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      10070000
100800         PERFORM 1120-PREPARE-LIST-ENTRY                          10080000
100900       ELSE                                                       10090000
101000           MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER         10100000
101100           SET  PS-COMMAREA-NOT-VALID TO TRUE                     10110000
101200       END-IF                                                     10120000
101300     END-IF.                                                      10130000
101400                                                                  10140000
101500       IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT-3          10150000
101600         IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                    10160000
101700           SET ASC-SMOOTHING-SCREEN-YES TO TRUE                   10170000
101800           MOVE SU003-SHIPT-UNT-ID      TO ASC-SHIPT-UNT-ID       10180000
101900           MOVE SU003-PO-NBR            TO ASC-PO-NBR             10190000
102000                                           PV-PO-NBR              10200000
102100                                           ASC-PO-NUMBER          10210000
102200           MOVE SU003-REC-SEQ-NBR       TO ASC-RECEIVER           10220000
102300                                           PV-REC-SEQ-NBR         10230000
102400                                           PV-RECEIVER            10240000
102500           SET ASC-USE-SELECTION-QUEUE   TO TRUE                  10250000
102600           MOVE SU003-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS10260000
102700           MOVE SU003-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME    10270000
102800           PERFORM 1120-PREPARE-LIST-ENTRY                        10280000
102900         ELSE                                                     10290000
103000           MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER         10300000
103100           SET  PS-COMMAREA-NOT-VALID TO TRUE                     10310000
103200         END-IF                                                   10320000
103300       END-IF.                                                    10330000
103301                                                                  10330117
103400                                                                  10340000
103410*----------------------------------------------------------------*10341015
103420* CALL PCKUT713 TO RETRIEVE PO, RCVR, DEST-OPER-UNT-ID, ETC.      10342015
103430*----------------------------------------------------------------*10343015
103500 1101-GET-CARTON-INFO.                                            10350000
103600     INITIALIZE  PC046-COMMAREA-REC.                              10360000
103700     MOVE SU002-SHIPT-UNT-ID   TO  PC046-CARTON-ID.               10370000
103800                                                                  10380000
103810     CALL PC046-CARTON-STATUS-MODULE                              10381014
103820             USING DFHEIBLK                                       10382014
103830             PC046-COMMAREA                                       10383014
103840             PC046-COMMAREA-REC                                   10384014
103850     END-CALL                                                     10385014
103860                                                                  10386014
104700     PERFORM 1101A-VALIDATE-STATUS-CALL.                          10470014
105100                                                                  10510000
105200*----------------------------------------------------------------*10520000
105300* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*10530000
105400*----------------------------------------------------------------*10540000
105500 1101A-VALIDATE-STATUS-CALL.                                      10550000
105600                                                                  10560000
105700     IF  PC046-SUCCESSFUL                                         10570000
105800         MOVE  PC046-OTBD-TRIP-ID      TO  ASC-TRIP-ID            10580000
105900         MOVE  PC046-SCAC              TO  ASC-SCAC               10590000
106000         MOVE  PC046-TRLR-SRL          TO  ASC-TRLR-NBR           10600000
106100         MOVE  PC046-RCVR-NBR          TO  ASC-RECEIVER           10610000
106200     ELSE                                                         10620000
106300         SET  PS-ERROR       TO  TRUE                             10630000
106400     END-IF.                                                      10640000
106500                                                                  10650000
106600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10660000
106700 1120-PREPARE-LIST-ENTRY.                                         10670000
106800                                                                  10680000
106900     MOVE SU004-MAX-ITEMS          TO ASC-SEL-SUB.                10690000
107000     MOVE ZERO                     TO ASC-SEL-ITEM.               10700000
107100     PERFORM 1130-GET-NEXT-RECORD.                                10710000
107200                                                                  10720000
107300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10730000
107400*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*10740000
107500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10750000
107600 1130-GET-NEXT-RECORD.                                            10760000
107700                                                                  10770000
107800     ADD +1                       TO ASC-SEL-SUB.                 10780000
107900                                                                  10790000
108000     IF  ASC-SEL-SUB > SU004-MAX-ITEMS                            10800000
108100         ADD +1                   TO ASC-SEL-ITEM                 10810000
108200         MOVE +1                  TO ASC-SEL-SUB                  10820000
108300     END-IF.                                                      10830000
108400                                                                  10840000
108500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10850000
108600         PERFORM 9100-READ-SEL-QUEUE                              10860000
108700         IF  SU004-ITEM (ASC-SEL-SUB) > ZERO                      10870000
108800*                                                                 10880000
108900             MOVE ZEROS TO ASC-TOTAL-QTY                          10890000
109000             MOVE SU004-SHIPT-UNT-ID  (ASC-SEL-SUB)               10900000
109100                                          TO ASC-SHIPT-UNT-ID     10910000
109200*                                            PV-SHIPT-UNT-ID      10920000
109300             MOVE SU004-PREPK-ID (ASC-SEL-SUB)                    10930000
109400                                          TO ASC-FROM-PGM-PREPK-ID10940000
109401             IF ASC-TRIP-ID >  ZEROES                             10940101
109402                CONTINUE                                          10940200
109403             ELSE                                                 10940300
109404                MOVE SU004-TRIP-ID  (ASC-SEL-SUB)                 10940400
109405                                          TO ASC-TRIP-ID          10940500
109406             END-IF                                               10940600
109407             SET SU004-INQ (ASC-SEL-SUB)                          10940700
109408                                  TO TRUE                         10940800
109409             PERFORM 9200-REWRITE-SEL-QUEUE                       10940900
109410         ELSE                                                     10941000
109420             SUBTRACT +1 FROM ASC-SEL-SUB                         10942000
109430             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             10943000
109440             SET DP020-MSG-INFORMATIONAL                          10944000
109450                 PS-LIST-END             TO TRUE                  10945000
109460         END-IF                                                   10946000
109470     ELSE                                                         10947000
109480         SUBTRACT +1 FROM ASC-SEL-ITEM                            10948000
109490         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  10949000
109500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             10950000
109600         SET DP020-MSG-INFORMATIONAL                              10960000
109700             PS-LIST-END             TO TRUE                      10970000
109800     END-IF.                                                      10980000
109900                                                                  10990000
110000/                                                                 11000000
110100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11010000
110200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *11020000
110300*    PROCESSED.                                                  *11030000
110400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11040000
110500                                                                  11050000
110600 1140-GET-PREV-RECORD.                                            11060000
110700                                                                  11070000
110800     SUBTRACT +1 FROM ASC-SEL-SUB.                                11080000
110900                                                                  11090000
111000     IF  ASC-SEL-SUB < +1                                         11100000
111100         SUBTRACT +1 FROM ASC-SEL-ITEM                            11110000
111200         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  11120000
111300     END-IF.                                                      11130000
111400                                                                  11140000
111500     IF  ASC-SEL-ITEM > ZERO                                      11150000
111600         PERFORM 9100-READ-SEL-QUEUE                              11160000
111700*                                                                 11170000
111800             MOVE ZEROS TO ASC-TOTAL-QTY                          11180000
111900             MOVE SU004-SHIPT-UNT-ID (ASC-SEL-SUB)                11190000
112000                                  TO ASC-SHIPT-UNT-ID             11200000
112100                                     PV-SHIPT-UNT-ID              11210000
112200         SET SU004-INQ (ASC-SEL-SUB)                              11220000
112300                                  TO TRUE                         11230000
112400         PERFORM 9200-REWRITE-SEL-QUEUE                           11240000
112500     ELSE                                                         11250000
112600         MOVE +1                  TO ASC-SEL-ITEM                 11260000
112700                                     ASC-SEL-SUB                  11270000
112800         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11280000
112900         SET DP020-MSG-INFORMATIONAL                              11290000
113000             PS-LIST-END             TO TRUE                      11300000
113100     END-IF.                                                      11310000
113200                                                                  11320000
113300                                                                  11330000
113400                                                                  11340000
113500                                                                  11350000
113600*----------------------------------------------------------------*11360000
113700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11370000
113800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11380000
113900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11390000
114000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11400000
114100* FUNCTION KEYS CAN GET THIS FAR.                                *11410000
114200*----------------------------------------------------------------*11420000
114300                                                                  11430000
114400 2000-PROCESS-PANEL.                                              11440000
114500     EVALUATE TRUE                                                11450000
114600         WHEN DP020-SRC-AID = DP016-CLEAR                         11460000
114700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11470000
114800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11480000
114900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11490000
115000                                                                  11500000
115100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11510000
115200             PERFORM 2050-DELETE-LIST-QUEUE                       11520000
115300             MOVE ZEROS TO ASC-TOTAL-QTY                          11530000
115400             PERFORM 4000-BUILD-INITIAL-PANEL                     11540000
115500                                                                  11550000
115600         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11560000
115700             PERFORM 2140-DESELECT-ALL-ITEMS                      11570000
115800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11580000
115900                                                                  11590000
116000         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11600000
116100             PERFORM 2150-SELECT-ALL-ITEMS                        11610000
116200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11620000
116300                                                                  11630000
116400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11640000
116500             IF  ASC-USE-SELECTION-QUEUE                          11650000
116600                 PERFORM 1130-GET-NEXT-RECORD                     11660000
116700                 IF PS-LIST-END                                   11670000
116800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11680000
116900                     SET PS-NO-LIST-END TO TRUE                   11690000
117000                 ELSE                                             11700000
117100                     PERFORM 2050-DELETE-LIST-QUEUE               11710000
117200                     PERFORM 3200-RESET-ATTRIBUTES                11720000
117300                     PERFORM 3205-RESET-ATTRIBUTES-2              11730000
117400                     PERFORM 4000-BUILD-INITIAL-PANEL             11740000
117500                 END-IF                                           11750000
117600              ELSE                                                11760000
117700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11770000
117800*                --- BOTTOM OF LIST ---                           11780000
117900                 MOVE PC-TSYMSG-00070                             11790000
118000                                   TO DP020-MSG-NUMBER            11800000
118100                 SET DP020-MSG-INFORMATIONAL                      11810000
118200                                   TO TRUE                        11820000
118300             END-IF                                               11830000
118400                                                                  11840000
118500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11850000
118600             IF  ASC-USE-SELECTION-QUEUE                          11860000
118700                 PERFORM 1140-GET-PREV-RECORD                     11870000
118800                 IF PS-LIST-END                                   11880000
118900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11890000
119000                     SET PS-NO-LIST-END                           11900000
119100                                   TO TRUE                        11910000
119200                 ELSE                                             11920000
119300**GB 12/28/2000 **BEGIN                                           11930000
119400                     PERFORM 2050-DELETE-LIST-QUEUE               11940000
119500* END                                                             11950000
119600                     PERFORM 3200-RESET-ATTRIBUTES                11960000
119700                     PERFORM 3205-RESET-ATTRIBUTES-2              11970000
119800                     PERFORM 4000-BUILD-INITIAL-PANEL             11980000
119900                 END-IF                                           11990000
120000             ELSE                                                 12000000
120100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12010000
120200                 MOVE PC-TSYMSG-00069                             12020000
120300                                   TO DP020-MSG-NUMBER            12030000
120400                 SET DP020-MSG-INFORMATIONAL                      12040000
120500                                   TO TRUE                        12050000
120600             END-IF                                               12060000
120700                                                                  12070000
120800         WHEN OTHER                                               12080000
120900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12090000
121000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12100000
121100                                                                  12110000
121200                                                                  12120000
121300             IF  PS-NO-ERROR                                      12130000
121400                 SET DP030-CONTINUE-GO                            12140000
121500                                 TO TRUE                          12150000
121600                 PERFORM 2100-CHECK-FUNCTION-KEY                  12160000
121700             ELSE                                                 12170000
121800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12180000
121900                 SET DP030-OVERRIDE-GO                            12190000
122000                                 TO TRUE                          12200000
122100             END-IF                                               12210000
122200     END-EVALUATE.                                                12220000
122300 EJECT                                                            12230000
122400*----------------------------------------------------------------*12240000
122500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12250000
122600*----------------------------------------------------------------*12260000
122700 2050-DELETE-LIST-QUEUE.                                          12270000
122800                                                                  12280000
122900     EXEC CICS                                                    12290000
123000         DELETEQ TS                                               12300000
123100             QUEUE (ASC-LIST-QUEUE-NAME)                          12310000
123200             RESP  (PV-CICS-RESP)                                 12320000
123300     END-EXEC.                                                    12330000
123400                                                                  12340000
123500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12350000
123600        (PV-CICS-RESP = DFHRESP(QIDERR))                          12360000
123700         CONTINUE                                                 12370000
123800     ELSE                                                         12380000
123900         SET DP013-CICS-ABEND      TO TRUE                        12390000
124000         SET DP013-NO-ROLLBACK     TO TRUE                        12400000
124100                                                                  12410000
124200         MOVE '2050-DELETE-LIST-QUEUE'                            12420000
124300                                   TO DP013-PARAGRAPH             12430000
124400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12440000
124500                                   TO DP013-MESSAGE-TEXT (1)      12450000
124600         PERFORM DP013-0000-PROCESS-ABEND                         12460000
124700     END-IF.                                                      12470000
124800                                                                  12480000
124900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12490000
125000 EJECT                                                            12500000
125100*----------------------------------------------------------------*12510000
125200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12520000
125300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12530000
125400* CICS ARCHITECTURE API.                                         *12540000
125500*----------------------------------------------------------------*12550000
125600 2100-CHECK-FUNCTION-KEY.                                         12560000
125700                                                                  12570000
125800     EVALUATE TRUE                                                12580000
125900*                                                                 12590000
126000* F14 - CANCEL/UNCANCEL   (LOCAL-FUNC-02)                         12600000
126100* F16 - CONFIRM/UNCONFIRM (LOCAL-FUNC-04)                         12610000
126200* F18 - UNCONFIRM DISTR   (LOCAL-FUNC-06)                         12620000
126300* F24 - CONFIRM DISTR     (LOCAL-FUNC-09)                         12630000
126400*                                                                 12640000
126500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12650000
126600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              12660000
126700         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              12670000
126800         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              12680000
126900                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          12690000
127000                     CONTINUE                                     12700000
127100                 ELSE                                             12710000
127200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12720000
127300                     SET DP030-OVERRIDE-GO TO TRUE                12730000
127400                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    12740000
127500                     SET DP020-MSG-WARNING  TO TRUE               12750000
127600                 END-IF                                           12760000
127601*                                                                 12760116
127610******************                                                12761016
127620*F17 PKSLPLST - -SERIAL-SHIP CDE REQUIRED                         12762016
127630*PACKSLIP LIST SCREEN (RCKCS213)                                  12763016
127640******************                                                12764016
127650*                                                                 12765016
127660         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12766016
127670             IF ASC-SHIPT-UNT-ID       > 0                        12767019
127680                 MOVE ASC-SHIPT-UNT-ID  TO SU046-SHIPT-UNT-ID     12768019
127699             END-IF                                               12769916
127710*                                                                 12771000
127800* F6 - FIRST PAGE                                                 12780000
127900*                                                                 12790000
128000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  12800000
128100             MOVE +1               TO PV-TOP-ITEM                 12810000
128200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12820000
128300*                                                                 12830000
128400* F7 - PREVIOUS PAGE                                              12840000
128500*                                                                 12850000
128600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12860000
128700             PERFORM 2110-BROWSE-BACKWARD                         12870000
128800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12880000
128900*                                                                 12890000
129000* F8 - NEXT PAGE                                                  12900000
129100*                                                                 12910000
129200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12920000
129300             PERFORM 2120-BROWSE-FORWARD                          12930000
129400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12940000
129500*                                                                 12950000
129600* ENTER KEY                                                       12960000
129700*                                                                 12970000
129800         WHEN DP020-SRC-AID = DP016-ENTER                         12980000
129900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12990000
130000             IF  PS-ERROR                                         13000000
130100                 CONTINUE                                         13010000
130200             ELSE                                                 13020000
130300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13030000
130400             END-IF                                               13040000
130500                                                                  13050000
130600         WHEN OTHER                                               13060000
130700             SET DP013-NO-ROLLBACK                                13070000
130800                 DP013-XCTL-DISPLAY-RESTART                       13080000
130900                 DP013-CICS-ABEND  TO TRUE                        13090000
131000             MOVE '2100-CHECK-FUNCTION-KEY'                       13100000
131100                                   TO DP013-PARAGRAPH             13110000
131200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13120000
131300                                   TO DP013-MESSAGE-TEXT (1)      13130000
131400             PERFORM DP013-0000-PROCESS-ABEND                     13140000
131500     END-EVALUATE.                                                13150000
131600                                                                  13160000
131700                                                                  13170000
131800*----------------------------------------------------------------*13180000
131900*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13190000
132000*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13200000
132100*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13210000
132200*    MESSAGE.                                                    *13220000
132300*----------------------------------------------------------------*13230000
132400                                                                  13240000
132500 2110-BROWSE-BACKWARD.                                            13250000
132600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13260000
132700         GIVING PV-TOP-ITEM.                                      13270000
132800*                                                                 13280000
132900     IF  ((PV-TOP-ITEM < +1)                                      13290000
133000       OR (PV-TOP-ITEM = +1))                                     13300000
133100         MOVE +1                   TO PV-TOP-ITEM                 13310000
133200*        -- TOP OF LIST --                                        13320000
133300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13330000
133400         SET DP020-MSG-INFORMATIONAL TO TRUE                      13340000
133500     END-IF.                                                      13350000
133600                                                                  13360000
133700 EJECT                                                            13370000
133800*----------------------------------------------------------------*13380000
133900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13390000
134000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13400000
134100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13410000
134200*----------------------------------------------------------------*13420000
134300                                                                  13430000
134400 2120-BROWSE-FORWARD.                                             13440000
134500                                                                  13450000
134600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13460000
134700         GIVING PV-TOP-ITEM.                                      13470000
134800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13480000
134900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13490000
135000                                   TO PV-TOP-ITEM                 13500000
135100*        -- BOTTOM OF LIST --                                     13510000
135200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13520000
135300         SET DP020-MSG-INFORMATIONAL                              13530000
135400                                   TO TRUE                        13540000
135500     ELSE                                                         13550000
135600         COMPUTE PV-BOTTOM-ITEM =                                 13560000
135700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13570000
135800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13580000
135900*            -- BOTTOM OF LIST --                                 13590000
136000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13600000
136100             SET DP020-MSG-INFORMATIONAL                          13610000
136200                                   TO TRUE                        13620000
136300         END-IF                                                   13630000
136400     END-IF.                                                      13640000
136500 EJECT                                                            13650000
136600*----------------------------------------------------------------*13660000
136700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13670000
136800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13680000
136900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13690000
137000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13700000
137100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13710000
137200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13720000
137300*----------------------------------------------------------------*13730000
137400                                                                  13740000
137500 2130-CHECK-FOR-JUMP-BROWSE.                                      13750000
137600     SET PS-NO-ERROR               TO TRUE.                       13760000
137700     IF (ASC-START-ITEM-REQUEST = SPACE)                          13770000
137800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13780000
137900                                   TO PV-TOP-ITEM                 13790000
138000     ELSE                                                         13800000
138100         MOVE ASC-START-ITEM-REQUEST                              13810000
138200                                   TO DP010I-UNEDITED-FIELD       13820000
138300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13830000
138400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13840000
138500         SET DP010I-NEGATIVE-NOT-ALLOWED                          13850000
138600                                   TO TRUE                        13860000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13871020
263968              USING DP010I-NUMERIC-EDIT-AREA                      13872020
138800                                                                  13880000
138900         IF  NOT DP010I-ERROR-DETECTED                            13890000
139000             MOVE DP010I-NUMERIC-FIELD                            13900000
139100                                   TO  ASC-START-ITEM-REQUEST-N   13910000
139200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13920000
139300                 IF  ASC-START-ITEM-REQUEST-N >                   13930000
139400                                          ASC-NUMBER-OF-ITEMS-READ13940000
139500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13950000
139600                     COMPUTE PV-TOP-ITEM =                        13960000
139700                             ASC-NUMBER-OF-ITEMS-READ             13970000
139800                             - PC-ITEMS-PER-PANEL + 1             13980000
139900                     IF  PV-TOP-ITEM < +1                         13990000
140000                         MOVE +1   TO PV-TOP-ITEM                 14000000
140100                         MOVE PC-TSYMSG-00070                     14010000
140200                                   TO DP020-MSG-NUMBER            14020000
140300                         SET DP020-MSG-INFORMATIONAL              14030000
140400                                   TO TRUE                        14040000
140500                     END-IF                                       14050000
140600                 ELSE                                             14060000
140700                     MOVE ASC-START-ITEM-REQUEST-N                14070000
140800                                   TO PV-TOP-ITEM                 14080000
140900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14090000
141000                     COMPUTE PV-BOTTOM-ITEM =                     14100000
141100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     14110000
141200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ14120000
141300*                        -- BOTTOM OF LIST --                     14130000
141400                         MOVE PC-TSYMSG-00070                     14140000
141500                                   TO DP020-MSG-NUMBER            14150000
141600                         SET DP020-MSG-INFORMATIONAL              14160000
141700                                   TO TRUE                        14170000
141800                     END-IF                                       14180000
141900                 END-IF                                           14190000
142000             ELSE                                                 14200000
142100*                --- VALUE OUT OF RANGE ----                      14210000
142200                 MOVE PC-TSYMSG-00101                             14220000
142300                                   TO DP020-MSG-NUMBER            14230000
142400                 MOVE -1           TO ASTRTITL                    14240000
142500                 SET DP030-SET-CURSOR-APPL-1                      14250000
142600                                   TO TRUE                        14260000
142700                 MOVE DP015-REVERSE                               14270000
142800                                   TO ASTRTITH                    14280000
142900                 MOVE DP015-RED    TO ASTRTITC                    14290000
143000                 MOVE DP015-UNP-NUM-BRT-MDT                       14300000
143100                                   TO ASTRTITA                    14310000
143200                 SET DP020-MSG-FATAL                              14320000
143300                                   TO TRUE                        14330000
143400                 SET PS-ERROR      TO TRUE                        14340000
143500             END-IF                                               14350000
143600                                                                  14360000
143700         ELSE                                                     14370000
143800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14380000
143900             MOVE -1               TO ASTRTITL                    14390000
144000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14400000
144100             MOVE DP015-REVERSE    TO ASTRTITH                    14410000
144200             MOVE DP015-RED        TO ASTRTITC                    14420000
144300             MOVE DP015-UNP-NUM-BRT-MDT                           14430000
144400                                   TO ASTRTITA                    14440000
144500             SET DP020-MSG-FATAL   TO TRUE                        14450000
144600             SET PS-ERROR          TO TRUE                        14460000
144700         END-IF                                                   14470000
144800     END-IF.                                                      14480000
144900 EJECT                                                            14490000
145000*----------------------------------------------------------------*14500000
145100*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14510000
145200*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14520000
145300*----------------------------------------------------------------*14530000
145400 2140-DESELECT-ALL-ITEMS.                                         14540000
145500     MOVE +1                       TO ASC-BLK-SUB.                14550000
145600                                                                  14560000
145700     PERFORM 2141-CLEAR-SELECTED-INDS                             14570000
145800         VARYING ASC-ITEM-SUB                                     14580000
145900         FROM 1 BY 1                                              14590000
146000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14600000
146100                                                                  14610000
146200     ADD +1                        TO ASC-BLK-SUB.                14620000
146300                                                                  14630000
146400     PERFORM 2141-CLEAR-SELECTED-INDS                             14640000
146500         VARYING ASC-ITEM-SUB                                     14650000
146600         FROM 1 BY 1                                              14660000
146700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14670000
146800                                                                  14680000
146900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14690000
147000                                   TO PV-LIST-ITEM-NUMBER.        14700000
147100                                                                  14710000
147200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14720000
147300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14730000
147400                                                                  14740000
147500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14750000
147600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      14760000
147700         MOVE +1                   TO ASC-BLK-SUB                 14770000
147800                                                                  14780000
147900         PERFORM 5100-WRITE-TEMP-STORAGE                          14790000
148000                                                                  14800000
148100         MOVE +1                   TO PV-BLOCK-NUMBER             14810000
148200                                                                  14820000
148300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14830000
148400             PV-FIRST-BLOCK-IN-ARRAY - 1                          14840000
148500                                                                  14850000
148600         PERFORM                                                  14860000
148700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14870000
148800                                                                  14880000
148900             PERFORM 4410-READ-TEMP-STORAGE                       14890000
149000                                                                  14900000
149100             PERFORM 2141-CLEAR-SELECTED-INDS                     14910000
149200                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 14920000
149300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14930000
149400                                                                  14940000
149500             PERFORM 5100-WRITE-TEMP-STORAGE                      14950000
149600                                                                  14960000
149700             ADD +1                TO PV-BLOCK-NUMBER             14970000
149800                                                                  14980000
149900         END-PERFORM                                              14990000
150000                                                                  15000000
150100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15010000
150200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15020000
150300                                                                  15030000
150400         PERFORM                                                  15040000
150500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15050000
150600                   ASC-HIGHEST-BLOCK-WRITTEN                      15060000
150700                                                                  15070000
150800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15080000
150900                                   TO PV-BLOCK-NUMBER             15090000
151000                                                                  15100000
151100             PERFORM 4410-READ-TEMP-STORAGE                       15110000
151200                                                                  15120000
151300             PERFORM 2141-CLEAR-SELECTED-INDS                     15130000
151400                 VARYING ASC-ITEM-SUB                             15140000
151500                 FROM 1 BY 1                                      15150000
151600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15160000
151700                                                                  15170000
151800             PERFORM 5100-WRITE-TEMP-STORAGE                      15180000
151900                                                                  15190000
152000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15200000
152100                                                                  15210000
152200         END-PERFORM                                              15220000
152300                                                                  15230000
152400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15240000
152500                                   TO PV-BLOCK-NUMBER             15250000
152600                                                                  15260000
152700         PERFORM 4410-READ-TEMP-STORAGE                           15270000
152800     END-IF.                                                      15280000
152900                                                                  15290000
153000                                                                  15300000
153100     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 15310000
153200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15320000
153300     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15330000
153400                                                                  15340000
153500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15350000
153600                                                                  15360000
153700 EJECT                                                            15370000
153800*----------------------------------------------------------------*15380000
153900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15390000
154000*----------------------------------------------------------------*15400000
154100                                                                  15410000
154200 2141-CLEAR-SELECTED-INDS.                                        15420000
154300                                                                  15430000
154400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15440000
154500             NOT EQUAL ZERO                                       15450000
154600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15460000
154700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15470000
154800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15480000
154900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15490000
155000                                   TO TRUE                        15500000
155100         END-IF                                                   15510000
155200     END-IF.                                                      15520000
155300                                                                  15530000
155400 EJECT                                                            15540000
155500*----------------------------------------------------------------*15550000
155600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15560000
155700*  FOR ALL ITEMS.                                                *15570000
155800*----------------------------------------------------------------*15580000
155900                                                                  15590000
156000 2150-SELECT-ALL-ITEMS.                                           15600000
156100                                                                  15610000
156200     MOVE +1                       TO ASC-BLK-SUB.                15620000
156300                                                                  15630000
156400     PERFORM 2151-SET-SELECTED-INDS                               15640000
156500         VARYING ASC-ITEM-SUB                                     15650000
156600         FROM 1 BY 1                                              15660000
156700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15670000
156800                                                                  15680000
156900     ADD +1                        TO ASC-BLK-SUB.                15690000
157000                                                                  15700000
157100     PERFORM 2151-SET-SELECTED-INDS                               15710000
157200         VARYING ASC-ITEM-SUB                                     15720000
157300         FROM 1 BY 1                                              15730000
157400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15740000
157500                                                                  15750000
157600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15760000
157700                                   TO PV-LIST-ITEM-NUMBER.        15770000
157800                                                                  15780000
157900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15790000
158000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15800000
158100                                                                  15810000
158200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15820000
158300        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15830000
158400         MOVE +1                   TO ASC-BLK-SUB                 15840000
158500                                                                  15850000
158600         PERFORM 5100-WRITE-TEMP-STORAGE                          15860000
158700                                                                  15870000
158800         MOVE +1                   TO PV-BLOCK-NUMBER             15880000
158900                                                                  15890000
159000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15900000
159100             PV-FIRST-BLOCK-IN-ARRAY - 1                          15910000
159200                                                                  15920000
159300         PERFORM                                                  15930000
159400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15940000
159500                                                                  15950000
159600             PERFORM 4410-READ-TEMP-STORAGE                       15960000
159700                                                                  15970000
159800             PERFORM 2151-SET-SELECTED-INDS                       15980000
159900                 VARYING ASC-ITEM-SUB                             15990000
160000                 FROM 1 BY 1                                      16000000
160100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16010000
160200                                                                  16020000
160300             PERFORM 5100-WRITE-TEMP-STORAGE                      16030000
160400                                                                  16040000
160500             ADD +1                TO PV-BLOCK-NUMBER             16050000
160600                                                                  16060000
160700         END-PERFORM                                              16070000
160800                                                                  16080000
160900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16090000
161000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16100000
161100                                                                  16110000
161200         PERFORM                                                  16120000
161300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16130000
161400                   ASC-HIGHEST-BLOCK-WRITTEN                      16140000
161500                                                                  16150000
161600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16160000
161700                                   TO PV-BLOCK-NUMBER             16170000
161800                                                                  16180000
161900             PERFORM 4410-READ-TEMP-STORAGE                       16190000
162000                                                                  16200000
162100             PERFORM 2151-SET-SELECTED-INDS                       16210000
162200                 VARYING ASC-ITEM-SUB                             16220000
162300                 FROM 1 BY 1                                      16230000
162400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16240000
162500                                                                  16250000
162600             PERFORM 5100-WRITE-TEMP-STORAGE                      16260000
162700                                                                  16270000
162800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16280000
162900                                                                  16290000
163000         END-PERFORM                                              16300000
163100                                                                  16310000
163200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16320000
163300                                   TO PV-BLOCK-NUMBER             16330000
163400                                                                  16340000
163500         PERFORM 4410-READ-TEMP-STORAGE                           16350000
163600     END-IF.                                                      16360000
163700                                                                  16370000
163800                                                                  16380000
163900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16390000
164000                       ASC-NUMBER-OF-SELECTED-ITEMS.              16400000
164100                                                                  16410000
164200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16420000
164300                                                                  16430000
164400 EJECT                                                            16440000
164500*----------------------------------------------------------------*16450000
164600*    MARK EACH ITEM AS BEING SELECTED.                           *16460000
164700*----------------------------------------------------------------*16470000
164800                                                                  16480000
164900 2151-SET-SELECTED-INDS.                                          16490000
165000                                                                  16500000
165100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16510000
165200             NOT EQUAL ZERO                                       16520000
165300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16530000
165400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16540000
165500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16550000
165600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16560000
165700                               TO  TRUE                           16570000
165800         END-IF                                                   16580000
165900     END-IF.                                                      16590000
166000******************************************************************16600000
166100** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **16610000
166200** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **16620000
166300******************************************************************16630000
166400 2200-MOVE-SCREEN-TO-COMMAREA.                                    16640000
166500                                                                  16650000
166600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16660000
166700     MOVE +1                       TO PV-SUB.                     16670000
166800*                                                                 16680000
166900     PERFORM 3100-SET-SUBSCRIPTS.                                 16690000
167000     IF  ASTRTITL > ZERO                                          16700000
167100         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          16710000
167200     ELSE                                                         16720000
167300         IF  ASTRTITF = DP015-ERASE-EOF                           16730000
167400             INITIALIZE ASC-START-ITEM-REQUEST                    16740000
167500         END-IF                                                   16750000
167600     END-IF.                                                      16760000
167700                                                                  16770000
167800                                                                  16780000
167900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16790000
168000         VARYING PV-SUB                                           16800000
168100         FROM 1 BY 1                                              16810000
168200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16820000
168300******************************************************************16830000
168400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**16840000
168500******************************************************************16850000
168600 2210-MOVE-LINES-TO-COMMAREA.                                     16860000
168700     IF  MR-SELECTL (PV-SUB) > ZERO                               16870000
168800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16880000
168900         MOVE MR-SELECTI (PV-SUB)                                 16890000
169000                                   TO ASC-TEMP-SELECTED-SW        16900000
169100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16910000
169200     ELSE                                                         16920000
169300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                16930000
169400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     16940000
169500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        16950000
169600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16960000
169700         END-IF                                                   16970000
169800     END-IF.                                                      16980000
169900                                                                  16990000
170000                                                                  17000000
170100     ADD +1                        TO ASC-ITEM-SUB.               17010000
170200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17020000
170300         ADD +1                    TO ASC-BLK-SUB                 17030000
170400         MOVE +1                   TO ASC-ITEM-SUB                17040000
170500     END-IF.                                                      17050000
170600******************************************************************17060000
170700** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **17070000
170800** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **17080000
170900******************************************************************17090000
171000 3000-EDIT-DATA-IN-COMMAREA.                                      17100000
171100     SET PS-NO-ERROR               TO TRUE.                       17110000
171200     PERFORM 3200-RESET-ATTRIBUTES.                               17120000
171300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17130000
171400                                                                  17140000
171500*-----------------------------------------------------------------17150000
171600* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17160000
171700* EDITTING IS DONE FROM THE BOTTOM UP.                            17170000
171800**                                                                17180000
171900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17190000
172000         ASC-ITEMS-DISPLAYED - 1.                                 17200000
172100     PERFORM 3100-SET-SUBSCRIPTS.                                 17210000
172200                                                                  17220000
172300      IF  PS-NO-ERROR                                             17230000
172400          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       17240000
172500      END-IF.                                                     17250000
172600*                                                                 17260000
172700     IF  PS-NO-ERROR                                              17270000
172800         PERFORM 3400-CHECK-RANGE-SEQUENCE                        17280000
172900     END-IF.                                                      17290000
173000*                                                                 17300000
173100     IF  ((PS-NO-ERROR)                                           17310000
173200       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   17320000
173300       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    17330000
173400             PERFORM 3500-MARK-RANGE-AS-SELECTED                  17340000
173500     END-IF.                                                      17350000
173600                                                                  17360000
173700                                                                  17370000
173800*----------------------------------------------------------------*17380000
173900* 3005-EDIT-COMMAREA-BLOCKS                                      *17390000
174000*----------------------------------------------------------------*17400000
174100 3005-EDIT-COMMAREA-BLOCKS.                                       17410000
174200     MOVE +1                       TO PV-BLOCK-NUMBER.            17420000
174300     MOVE +1                       TO ASC-BLK-SUB.                17430000
174400     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               17440000
174500                                                                  17450000
174600     COMPUTE PV-BLOCK-NUMBER  =                                   17460000
174700             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            17470000
174800             PC-ITEMS-PER-PANEL.                                  17480000
174900                                                                  17490000
175000     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          17500000
175100                                                                  17510000
175200     PERFORM                                                      17520000
175300        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         17530000
175400           OR PS-ERROR                                            17540000
175500           OR PS-BLOCK-ERROR                                      17550000
175600                                                                  17560000
175700              COMPUTE PV-ITEMS-HOLD  =                            17570000
175800                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       17580000
175900                      PC-ITEMS-PER-PANEL - 1                      17590000
176000                                                                  17600000
176100               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     17610000
176200                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             17620000
176300                       FROM  PV-ITEMS-HOLD                        17630000
176400                     GIVING  PV-ITEMS-DIFF                        17640000
176500                   SUBTRACT  PV-ITEMS-DIFF                        17650000
176600                       FROM  PC-ITEMS-PER-PANEL                   17660000
176700                     GIVING  PV-ITEMS-HOLD                        17670000
176800                       MOVE  PV-ITEMS-HOLD TO PV-SUB              17680000
176900                                              ASC-ITEM-SUB        17690000
177000                                              ASC-ITEMS-DISPLAYED 17700000
177100                                                                  17710000
177200               ELSE                                               17720000
177300                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            17730000
177400                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      17740000
177500               END-IF                                             17750000
177600                                                                  17760000
177700               PERFORM 3300-EDIT-SELECTIONS                       17770000
177800                       VARYING PV-SUB                             17780000
177900                          FROM PV-SUB BY -1                       17790000
178000                          UNTIL PV-SUB < +1                       17800000
178100                                                                  17810000
178200                                                                  17820000
178300               MOVE +1               TO ASC-BLK-SUB               17830000
178400                                                                  17840000
178500               PERFORM 5105-REWRITE-ASC-LISTQ                     17850000
178600                                                                  17860000
178700               MOVE +1                TO ASC-BLK-SUB              17870000
178800                                                                  17880000
178900               IF  PS-BLOCK-ERROR                                 17890000
179000                   SET  PS-ERROR     TO TRUE                      17900000
179100                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      17910000
179200                                     TO PV-TOP-ITEM               17920000
179300               ELSE                                               17930000
179400                   ADD  +1           TO PV-BLOCK-NUMBER           17940000
179500                   IF  PV-BLOCK-NUMBER >                          17950000
179600                       ASC-HIGHEST-BLOCK-WRITTEN                  17960000
179700                       MOVE +2       TO ASC-BLK-SUB               17970000
179800                       PERFORM 4410-READ-TEMP-STORAGE             17980000
179900                       MOVE +1       TO ASC-BLK-SUB               17990000
180000                   ELSE                                           18000000
180100                       PERFORM 4410-READ-TEMP-STORAGE             18010000
180200                       ADD  +1        TO PV-BLOCK-NUMBER          18020000
180300                       MOVE +2        TO ASC-BLK-SUB              18030000
180400                       PERFORM 4410-READ-TEMP-STORAGE             18040000
180500                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          18050000
180600                       MOVE +1        TO ASC-BLK-SUB              18060000
180700               END-IF                                             18070000
180800           END-IF                                                 18080000
180900     END-PERFORM.                                                 18090000
181000                                                                  18100000
181100     IF  PV-ORIGINAL-BLOCK  = +1    OR                            18110000
181200         PS-ERROR                   OR                            18120000
181300         PS-BLOCK-ERROR                                           18130000
181400             CONTINUE                                             18140000
181500     ELSE                                                         18150000
181600         MOVE +1                 TO PV-BLOCK-NUMBER               18160000
181700         MOVE +1                 TO ASC-BLK-SUB                   18170000
181800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  18180000
181900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           18190000
182000         PERFORM 4410-READ-TEMP-STORAGE                           18200000
182100                                                                  18210000
182200         PERFORM                                                  18220000
182300            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             18230000
182400               OR PS-ERROR                                        18240000
182500               OR PS-BLOCK-ERROR                                  18250000
182600                                                                  18260000
182700                  COMPUTE PV-ITEMS-HOLD  =                        18270000
182800                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   18280000
182900                          PC-ITEMS-PER-PANEL - 1                  18290000
183000                                                                  18300000
183100                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    18310000
183200                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          18320000
183300                          FROM  PV-ITEMS-HOLD                     18330000
183400                        GIVING  PV-ITEMS-DIFF                     18340000
183500                      SUBTRACT  PV-ITEMS-DIFF                     18350000
183600                          FROM  PC-ITEMS-PER-PANEL                18360000
183700                        GIVING  PV-ITEMS-HOLD                     18370000
183800                          MOVE  PV-ITEMS-HOLD TO PV-SUB           18380000
183900                                                 ASC-ITEM-SUB     18390000
184000                                              ASC-ITEMS-DISPLAYED 18400000
184100                  ELSE                                            18410000
184200                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         18420000
184300                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   18430000
184400                  END-IF                                          18440000
184500                                                                  18450000
184600                  PERFORM 3300-EDIT-SELECTIONS                    18460000
184700                          VARYING PV-SUB                          18470000
184800                             FROM PV-SUB BY -1                    18480000
184900                            UNTIL PV-SUB < +1                     18490000
185000                                                                  18500000
185100                                                                  18510000
185200                  MOVE +1               TO ASC-BLK-SUB            18520000
185300                                                                  18530000
185400                  PERFORM 5105-REWRITE-ASC-LISTQ                  18540000
185500                                                                  18550000
185600                  MOVE +1                TO ASC-BLK-SUB           18560000
185700                                                                  18570000
185800                  IF  PS-BLOCK-ERROR                              18580000
185900                      SET  PS-ERROR     TO TRUE                   18590000
186000                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   18600000
186100                                        TO PV-TOP-ITEM            18610000
186200                  ELSE                                            18620000
186300                      ADD  +1            TO PV-BLOCK-NUMBER       18630000
186400                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     18640000
186500                          MOVE +2        TO ASC-BLK-SUB           18650000
186600                          PERFORM 4410-READ-TEMP-STORAGE          18660000
186700                          MOVE +1        TO ASC-BLK-SUB           18670000
186800                      ELSE                                        18680000
186900                          PERFORM 4410-READ-TEMP-STORAGE          18690000
187000                          ADD  +1        TO PV-BLOCK-NUMBER       18700000
187100                          MOVE +2        TO ASC-BLK-SUB           18710000
187200                          PERFORM 4410-READ-TEMP-STORAGE          18720000
187300                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       18730000
187400                          MOVE +1        TO ASC-BLK-SUB           18740000
187500                      END-IF                                      18750000
187600                  END-IF                                          18760000
187700     END-PERFORM.                                                 18770000
187800                                                                  18780000
187900                                                                  18790000
188000*----------------------------------------------------------------*18800000
188100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18810000
188200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18820000
188300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18830000
188400*                                                                *18840000
188500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18850000
188600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18860000
188700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18870000
188800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18880000
188900*----------------------------------------------------------------*18890000
189000                                                                  18900000
189100 3100-SET-SUBSCRIPTS.                                             18910000
189200                                                                  18920000
189300     COMPUTE ASC-ITEM-SUB =                                       18930000
189400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18940000
189500                                                                  18950000
189600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18960000
189700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18970000
189800                                                                  18980000
189900         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               18990000
190000     ELSE                                                         19000000
190100         MOVE +1                     TO ASC-BLK-SUB               19010000
190200     END-IF.                                                      19020000
190300******************************************************************19030000
190400** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **19040000
190500******************************************************************19050000
190600                                                                  19060000
190700 3200-RESET-ATTRIBUTES.                                           19070000
190800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   19080000
190900     MOVE DP015-GREEN              TO ASTRTITC.                   19090000
191000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   19100000
191100*                                                                 19110000
191200     PERFORM                                                      19120000
191300         VARYING PV-SUB                                           19130000
191400         FROM 1 BY 1                                              19140000
191500         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        19150000
191600*        MOVE DP015-UNP-ALP-NOR-OFF                               19160000
191700*                                  TO MR-SELECTA (PV-SUB)         19170000
191800*        MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         19180000
191900*        MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         19190000
192000     END-PERFORM.                                                 19200000
192100 3205-RESET-ATTRIBUTES-2.                                         19210000
192200*                                                                 19220000
192300     PERFORM                                                      19230000
192400         VARYING PV-SUB                                           19240000
192500         FROM 1 BY 1                                              19250000
192600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        19260000
192700             MOVE DP015-BLUE    TO MR-PO-LINEC (PV-SUB)           19270000
192800                                   MR-DP-CL-SKUC (PV-SUB)         19280000
192900                                   MR-SKU-DESCC (PV-SUB)          19290000
193000                                   MR-UPCC (PV-SUB)               19300000
193100                                   MR-SHIPD-QTYC (PV-SUB)         19310000
193200                                   MR-PREPACK-RATIOC (PV-SUB)     19320000
193300     END-PERFORM.                                                 19330000
193400******************************************************************19340000
193500** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **19350000
193600** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **19360000
193700** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **19370000
193800** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **19380000
193900******************************************************************19390000
194000 3300-EDIT-SELECTIONS.                                            19400000
194100     EVALUATE TRUE                                                19410000
194200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19420000
194300             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         19430000
194400                 CONTINUE                                         19440000
194500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         19450000
194600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19460000
194700                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   19470000
194800                 MOVE ASC-TEMP-SELECTED-SW                        19480000
194900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19490000
195000                                TO ASC-SELECTED-SW                19500000
195100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19510000
195200             END-IF                                               19520000
195300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19530000
195400                 = SPACE                                          19540000
195500             EVALUATE TRUE                                        19550000
195600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19560000
195700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19570000
195800                     MOVE SPACE TO ASC-SELECTED-SW                19580000
195900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19590000
196000                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19600000
196100                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    19610000
196200                     MOVE SPACE TO ASC-SELECTED-SW                19620000
196300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19630000
196400                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19640000
196500                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      19650000
196600                     MOVE SPACE TO ASC-SELECTED-SW                19660000
196700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19670000
196800             END-EVALUATE                                         19680000
196900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19690000
197000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19700000
197100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19710000
197200             END-IF                                               19720000
197300             PERFORM 3310-EDIT-RANGE                              19730000
197400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19740000
197500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19750000
197600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19760000
197700             END-IF                                               19770000
197800             PERFORM 3310-EDIT-RANGE                              19780000
197900         WHEN OTHER                                               19790000
198000             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           19800000
198100             SET DP020-MSG-FATAL    TO TRUE                       19810000
198200*            MOVE -1                TO MR-SELECTL (PV-SUB)        19820000
198300             MOVE -1                TO ASTRTITL                   19830000
198400             SET DP030-SET-CURSOR-APPL-1                          19840000
198500                                    TO TRUE                       19850000
198600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        19860000
198700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        19870000
198800             SET PS-ERROR TO TRUE                                 19880000
198900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19890000
199000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19900000
199100                 MOVE SPACE         TO ASC-SELECTED-SW            19910000
199200                                        (ASC-BLK-SUB ASC-ITEM-SUB)19920000
199300             END-IF                                               19930000
199400     END-EVALUATE.                                                19940000
199500                                                                  19950000
199600     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 19960000
199700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19970000
199800     IF  ASC-ITEM-SUB < 1                                         19980000
199900         SUBTRACT +1 FROM ASC-BLK-SUB                             19990000
200000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                20000000
200100     END-IF.                                                      20010000
200200                                                                  20020000
200300                                                                  20030000
200400******************************************************************20040000
200500** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20050000
200600** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20060000
200700** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20070000
200800** THE ENDING.                                                  **20080000
200900******************************************************************20090000
201000 3310-EDIT-RANGE.                                                 20100000
201100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20110000
201200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20120000
201300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20130000
201400                                   TO ASC-SELECTED-SW             20140000
201500                                        (ASC-BLK-SUB ASC-ITEM-SUB)20150000
201600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20160000
201700         ELSE                                                     20170000
201800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20180000
201900                 CONTINUE                                         20190000
202000             ELSE                                                 20200000
202100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20210000
202200                 MOVE PC-TSYMSG-00054                             20220000
202300                                   TO DP020-MSG-NUMBER            20230000
202400                 SET DP020-MSG-FATAL                              20240000
202500                                   TO TRUE                        20250000
202600*                MOVE -1           TO MR-SELECTL (PV-SUB)         20260000
202700                 MOVE -1           TO ASTRTITL                    20270000
202800                 SET DP030-SET-CURSOR-APPL-1                      20280000
202900                                   TO TRUE                        20290000
203000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20300000
203100                 MOVE DP015-UNDERLINE                             20310000
203200                                   TO MR-SELECTH (PV-SUB)         20320000
203300                 SET PS-ERROR      TO TRUE                        20330000
203400             END-IF                                               20340000
203500         END-IF                                                   20350000
203600     ELSE                                                         20360000
203700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20370000
203800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20380000
203900                                   TO ASC-SELECTED-SW             20390000
204000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20400000
204100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20410000
204200         ELSE                                                     20420000
204300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20430000
204400                 CONTINUE                                         20440000
204500             ELSE                                                 20450000
204600*                -- ONLY ONE END-OF-RANGE ALLOWED --              20460000
204700                 MOVE PC-TSYMSG-00055                             20470000
204800                                   TO DP020-MSG-NUMBER            20480000
204900                 SET DP020-MSG-FATAL                              20490000
205000                                   TO TRUE                        20500000
205100*                MOVE -1           TO MR-SELECTL (PV-SUB)         20510000
205200                 MOVE -1           TO ASTRTITL                    20520000
205300                 SET DP030-SET-CURSOR-APPL-1                      20530000
205400                                   TO TRUE                        20540000
205500                 SET PS-ERROR      TO TRUE                        20550000
205600             END-IF                                               20560000
205700         END-IF                                                   20570000
205800     END-IF.                                                      20580000
205900*                                                                 20590000
206000******************************************************************20600000
206100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20610000
206200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20620000
206300******************************************************************20630000
206400 3400-CHECK-RANGE-SEQUENCE.                                       20640000
206500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20650000
206600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20660000
206700       AND  ASC-START-OF-SELECTED-RANGE >                         20670000
206800                                         ASC-END-OF-SELECTED-RANGE20680000
206900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20690000
207000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20700000
207100         SET DP020-MSG-FATAL TO TRUE                              20710000
207200         SET PS-ERROR TO TRUE                                     20720000
207300         PERFORM 3410-POSITION-AT-ERROR                           20730000
207400     END-IF.                                                      20740000
207500******************************************************************20750000
207600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20760000
207700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20770000
207800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20780000
207900******************************************************************20790000
208000 3410-POSITION-AT-ERROR.                                          20800000
208100     SET DP030-SET-CURSOR-APPL-1                                  20810000
208200                                   TO TRUE.                       20820000
208300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20830000
208400                    - PV-TOP-ITEM + 1.                            20840000
208500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20850000
208600         CONTINUE                                                 20860000
208700     ELSE                                                         20870000
208800*        MOVE -1                   TO MR-SELECTL (PV-SUB)         20880000
208900         MOVE -1                   TO ASTRTITL                    20890000
209000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20900000
209100         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20910000
209200     END-IF.                                                      20920000
209300*                                                                 20930000
209400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20940000
209500                    - PV-TOP-ITEM + 1.                            20950000
209600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20960000
209700         CONTINUE                                                 20970000
209800     ELSE                                                         20980000
209900*        MOVE -1                   TO MR-SELECTL (PV-SUB)         20990000
210000         MOVE -1                   TO ASTRTITL                    21000000
210100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         21010000
210200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         21020000
210300     END-IF.                                                      21030000
210400 EJECT                                                            21040000
210500*----------------------------------------------------------------*21050000
210600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21060000
210700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21070000
210800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21080000
210900*----------------------------------------------------------------*21090000
211000                                                                  21100000
211100 3500-MARK-RANGE-AS-SELECTED.                                     21110000
211200     MOVE +1                       TO  ASC-BLK-SUB.               21120000
211300     PERFORM 3510-MARK-SELECTED-INDS                              21130000
211400         VARYING ASC-ITEM-SUB                                     21140000
211500         FROM 1 BY 1                                              21150000
211600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21160000
211700                                                                  21170000
211800     ADD +1                        TO ASC-BLK-SUB.                21180000
211900     PERFORM 3510-MARK-SELECTED-INDS                              21190000
212000         VARYING ASC-ITEM-SUB                                     21200000
212100         FROM 1 BY 1                                              21210000
212200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21220000
212300                                                                  21230000
212400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21240000
212500                                   TO  PV-LIST-ITEM-NUMBER.       21250000
212600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21260000
212700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21270000
212800               PC-ITEMS-PER-PANEL).                               21280000
212900                                                                  21290000
213000     MOVE ASC-START-OF-SELECTED-RANGE                             21300000
213100                                   TO PV-START-OF-SELECTED-RANGE. 21310000
213200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21320000
213300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21330000
213400               PC-ITEMS-PER-PANEL).                               21340000
213500                                                                  21350000
213600     MOVE ASC-END-OF-SELECTED-RANGE                               21360000
213700                                   TO  PV-END-OF-SELECTED-RANGE.  21370000
213800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21380000
213900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21390000
214000               PC-ITEMS-PER-PANEL).                               21400000
214100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21410000
214200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21420000
214300                                                                  21430000
214400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21440000
214500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21450000
214600         MOVE +1                   TO ASC-BLK-SUB                 21460000
214700         PERFORM 5100-WRITE-TEMP-STORAGE                          21470000
214800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21480000
214900             PV-FIRST-BLOCK-IN-ARRAY - 1                          21490000
215000                                                                  21500000
215100         PERFORM                                                  21510000
215200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21520000
215300                   PV-PREV-BLOCK-IN-ARRAY                         21530000
215400             MOVE PV-FIRST-BLOCK-IN-RANGE                         21540000
215500                                   TO PV-BLOCK-NUMBER             21550000
215600             PERFORM 4410-READ-TEMP-STORAGE                       21560000
215700             PERFORM 3510-MARK-SELECTED-INDS                      21570000
215800                 VARYING ASC-ITEM-SUB                             21580000
215900                 FROM 1 BY 1                                      21590000
216000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21600000
216100             PERFORM 5100-WRITE-TEMP-STORAGE                      21610000
216200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21620000
216300         END-PERFORM                                              21630000
216400                                                                  21640000
216500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21650000
216600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21660000
216700         PERFORM                                                  21670000
216800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21680000
216900                   PV-LAST-BLOCK-IN-RANGE                         21690000
217000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21700000
217100                                   TO PV-BLOCK-NUMBER             21710000
217200             PERFORM 4410-READ-TEMP-STORAGE                       21720000
217300             PERFORM 3510-MARK-SELECTED-INDS                      21730000
217400                 VARYING ASC-ITEM-SUB                             21740000
217500                 FROM 1 BY 1                                      21750000
217600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21760000
217700             PERFORM 5100-WRITE-TEMP-STORAGE                      21770000
217800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21780000
217900         END-PERFORM                                              21790000
218000                                                                  21800000
218100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21810000
218200                                   TO PV-BLOCK-NUMBER             21820000
218300         PERFORM 4410-READ-TEMP-STORAGE                           21830000
218400     END-IF.                                                      21840000
218500                                                                  21850000
218600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21860000
218700                                      ASC-END-OF-SELECTED-RANGE.  21870000
218800                                                                  21880000
218900 EJECT                                                            21890000
219000*----------------------------------------------------------------*21900000
219100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21910000
219200*----------------------------------------------------------------*21920000
219300                                                                  21930000
219400 3510-MARK-SELECTED-INDS.                                         21940000
219500                                                                  21950000
219600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21960000
219700                                ASC-ITEM-SUB) >                   21970000
219800         ASC-START-OF-SELECTED-RANGE)                             21980000
219900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21990000
220000                                ASC-ITEM-SUB) =                   22000000
220100         ASC-START-OF-SELECTED-RANGE)                             22010000
220200                                                                  22020000
220300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22030000
220400                                    ASC-ITEM-SUB) <               22040000
220500             ASC-END-OF-SELECTED-RANGE)                           22050000
220600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22060000
220700                                    ASC-ITEM-SUB) =               22070000
220800             ASC-END-OF-SELECTED-RANGE)                           22080000
220900                                                                  22090000
221000             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22100000
221100                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   22110000
221200                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   22120000
221300                               TO TRUE                            22130000
221400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22140000
221500                               TO TRUE                            22150000
221600                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    22160000
221700             END-IF                                               22170000
221800         END-IF                                                   22180000
221900     END-IF.                                                      22190000
222000                                                                  22200000
222100                                                                  22210000
222200*----------------------------------------------------------------*22220000
222300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22230000
222400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22240000
222500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22250000
222600*    DISPLAY THE PANEL TO USER.                                  *22260000
222700*----------------------------------------------------------------*22270000
222800                                                                  22280000
222900 4000-BUILD-INITIAL-PANEL.                                        22290000
223000                                                                  22300000
223100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            22310000
223200                                 ASC-BLOCK-ENTRIES (2).           22320000
223300     MOVE +1                 TO ASC-BLK-SUB.                      22330000
223400     SET ASC-ITEMS-LEFT-ON-DB                                     22340000
223500                             TO TRUE.                             22350000
223600                                                                  22360000
223700     MOVE +0                 TO ASC-ITEM-SUB                      22370000
223800                                ASC-NUMBER-OF-ITEMS-READ          22380000
223900                                ASC-NUMBER-OF-SELECTED-ITEMS      22390000
224000                                ASC-HIGHEST-BLOCK-WRITTEN         22400000
224100                                ASC-START-OF-SELECTED-RANGE       22410000
224200                                ASC-END-OF-SELECTED-RANGE         22420000
224300                                ASC-ITEM-AT-TOP-OF-PANEL.         22430000
224400                                                                  22440000
224500                                                                  22450000
224600     INITIALIZE  SULBXF-DEST-OPER-UNT-ID.                         22460000
224700     INITIALIZE  SHPUNT-DEST-OPER-UNT-ID.                         22470000
224800                                                                  22480000
224900     PERFORM 4100-PREPARE-CURSOR.                                 22490000
225000     PERFORM 4330-GET-SULBXF-DEST-STORE.                          22500000
225100                                                                  22510000
225200     PERFORM 4350-OPEN-CTN2-CURSOR                                22520000
225300                                                                  22530000
225400     SET PS-FIRST-FETCH TO TRUE.                                  22540000
225500     PERFORM 4300-READ-ITEMS-FROM-DB.                             22550000
225600                                                                  22560000
225700     PERFORM 4370-CLOSE-CTN2-CURSOR                               22570000
225800                                                                  22580000
225900     MOVE +1                   TO  PV-TOP-ITEM.                   22590000
226000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          22600000
226100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    22610000
226200         SET DP020-MSG-FATAL   TO  TRUE                           22620000
226300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               22630000
226400     ELSE                                                         22640000
226500*        MOVE -1               TO MR-SELECTL (1)                  22650000
226600         MOVE -1               TO ASTRTITL                        22660000
226700         SET DP030-SET-CURSOR-APPL-1                              22670000
226800                               TO TRUE                            22680000
226900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22690000
227000     END-IF.                                                      22700000
227100 EJECT                                                            22710000
227200*----------------------------------------------------------------*22720000
227300*    SET UP THE HOST VARIABLES.                                  *22730000
227400*----------------------------------------------------------------*22740000
227500                                                                  22750000
227600 4100-PREPARE-CURSOR.                                             22760000
227700                                                                  22770000
227800     MOVE ASC-SHIPT-UNT-ID     TO DK-SHIPT-UNT-ID                 22780000
227900                                  PV-SHIPT-UNT-ID.                22790000
228000     MOVE ASC-PO-NUMBER        TO  DK-PO-NBR.                     22800000
228100     MOVE ASC-RECEIVER         TO  DK-REC-SEQ-NBR.                22810000
228200     MOVE ASC-TRIP-ID          TO  DK-TRIP-ID.                    22820000
228300                                                                  22830000
228400*----------------------------------------------------------------*22840000
228500*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *22850000
228600*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *22860000
228700*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *22870000
228800*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *22880000
228900*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *22890000
229000*                                                                *22900000
229100*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *22910000
229200*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *22920000
229300*    UPON INITIALIZATION.                                        *22930000
229400*----------------------------------------------------------------*22940000
229500 4300-READ-ITEMS-FROM-DB.                                         22950000
229600                                                                  22960000
229700     PERFORM                                                      22970000
229800         VARYING PV-READ-COUNT                                    22980000
229900         FROM 1 BY 1                                              22990000
230000         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    23000000
230100            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         23010000
230200                                                                  23020000
230300         PERFORM 4360-FETCH                                       23030000
230400                                                                  23040000
230500         IF  ASC-ITEMS-LEFT-ON-DB                                 23050000
230600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                23060000
230700                 ADD +1            TO ASC-ITEM-SUB                23070000
230800             ELSE                                                 23080000
230900                 ADD +1            TO ASC-BLK-SUB                 23090000
231000                 MOVE +1           TO ASC-ITEM-SUB                23100000
231100                                                                  23110000
231200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         23120000
231300                     MOVE +1       TO ASC-BLK-SUB                 23130000
231400                     SET ASC-BLOCK-MODIFIED (1)                   23140000
231500                                   TO TRUE                        23150000
231600                     PERFORM 5100-WRITE-TEMP-STORAGE              23160000
231700                     MOVE ASC-BLOCK-ENTRIES                       23170000
231800                               (PC-MAX-BLOCKS-IN-ARRAY)           23180000
231900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 23190000
232000                     ADD +1        TO ASC-BLK-SUB                 23200000
232100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   23210000
232200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      23220000
232300                                   TO TRUE                        23230000
232400                 END-IF                                           23240000
232500             END-IF                                               23250000
232600                                                                  23260000
232700             PERFORM 4320-GET-VENDOR-NAME                         23270000
232800*                                                                 23280000
232900*                                                                 23290000
233000             IF ASC-SMOOTHING-SCREEN-NO                           23300000
233100               PERFORM 4340-GET-SCAC-TRLR-TRIP                    23310000
233200                                                                  23320000
233300               PERFORM 4390-CHECK-IF-PREPACK                      23330000
233400                  IF PS-PREPACK-ORDER                             23340000
233500                     MOVE 'PREPK'                 TO APPKO        23350000
233600                     MOVE 'RATIO'                 TO ARATOO       23360000
233700                     MOVE DP015-PRO-BRT-OFF       TO APKMSGA      23370000
233800                  ELSE                                            23380000
233900                     MOVE SPACES                  TO APPKO        23390000
234000                                                     ARATOO       23400000
234100                     MOVE DP015-PRO-DRK-OFF       TO APKMSGA      23410000
234200             ELSE                                                 23420000
234300                  MOVE DP015-PRO-DRK-OFF       TO APPKA           23430000
234400                                                  ARATOA          23440000
234500                                                  APKMSGA         23450000
234600             END-IF                                               23460000
234700*                                                                 23470000
234800*                                                                 23480000
234900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    23490000
235000             MOVE ASC-NUMBER-OF-ITEMS-READ                        23500000
235100                                   TO ASC-LIST-ITEM-NUMBER        23510000
235200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23520000
235300                                                                  23530000
235400             MOVE PV-PO-LINE-NBR                                  23540000
235500                              TO  ASC-PO-LINE                     23550000
235600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23560000
235700             IF PS-XL-SKU-SELECT-NOT-FND OR                       23570000
235800                (SHUUPC-TRN-LNE-NBR = 0)                          23580000
235900                   SET ASC-LNE-UPC-ERROR-YES                      23590000
236000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23600000
236100                                        TO TRUE                   23610000
236200             ELSE                                                 23620000
236300                   SET ASC-LNE-UPC-ERROR-NO                       23630000
236400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23640000
236500                                        TO TRUE                   23650000
236600             END-IF                                               23660000
236700             MOVE PV-SKU-NMBR                                     23670000
236800                              TO  ASC-DP-CL-SKU                   23680000
236900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23690000
237000             MOVE PV-SKU-DESC                                     23700000
237100                              TO  ASC-SKU-DESC                    23710000
237200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23720000
237300             MOVE  PV-UPC-NBR                                     23730000
237400                              TO  ASC-UPC                         23740000
237500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23750000
237600             MOVE  PV-SHIPD-QTY                                   23760000
237700                               TO ASC-SHIPD-QTY                   23770000
237800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23780000
237900             ADD   PV-SHIPD-QTY                                   23790000
238000                                   TO ASC-TOTAL-QTY               23800000
238100             MOVE  RECITM-VER-STATUS-CDE                          23810000
238200                               TO ASC-RECITM-VER-STATUS           23820000
238300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23830000
238400*                                                                 23840000
238500             EVALUATE TRUE                                        23850000
238600                   WHEN PS-PREPACK-ORDER                          23860000
238700                        MOVE  PV-PREPK-RATIO                      23870000
238800                                       TO ASC-PREPACK-RATIO       23880000
238900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23890000
239000                        PERFORM 4392-CK-ON-PREPK                  23900000
239100             END-EVALUATE                                         23910000
239200*                                                                 23920000
239300         END-IF                                                   23930000
239400     END-PERFORM.                                                 23940000
239500                                                                  23950000
239600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          23960000
239700         MOVE +1               TO ASC-BLK-SUB                     23970000
239800         PERFORM 5100-WRITE-TEMP-STORAGE                          23980000
239900         ADD +1                TO ASC-BLK-SUB                     23990000
240000         PERFORM 5100-WRITE-TEMP-STORAGE                          24000000
240100                                                                  24010000
240200         MOVE 1                TO ASC-BLK-SUB                     24020000
240300                                  PV-BLOCK-NUMBER                 24030000
240400         PERFORM 4410-READ-TEMP-STORAGE                           24040000
240500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             24050000
240600             MOVE 2            TO ASC-BLK-SUB                     24060000
240700                                  PV-BLOCK-NUMBER                 24070000
240800             PERFORM 4410-READ-TEMP-STORAGE                       24080000
240900         END-IF                                                   24090000
241000     END-IF.                                                      24100000
241100 EJECT                                                            24110000
241200                                                                  24120000
241300*----------------------------------------------------------------*24130000
241400* GET VENDOR NAME.                                               *24140000
241500*----------------------------------------------------------------*24150000
241600 4320-GET-VENDOR-NAME.                                            24160000
241700                                                                  24170000
241800     INITIALIZE  ENTNME-ENT-NAME-DESC.                            24180000
241900                                                                  24190000
242000     EXEC SQL                                                     24200000
242100         SELECT  B.ENT_NAME_DESC                                  24210000
242200           INTO  :ENTNME-ENT-NAME-DESC                            24220000
242300           FROM  TPURCHS A                                        24230000
242400               , TENTNME B                                        24240000
242500          WHERE  A.PO_NBR          =  :DK-PO-NBR                  24250000
242600            AND  A.VER_STATUS_CDE  =  'A'                         24260000
242700            AND  B.TYPE_CDE        =  '01'                        24270000
242800            AND  A.ENT_ID          =  B.ENT_ID                    24280000
242900     END-EXEC                                                     24290000
243000                                                                  24300000
243100     EVALUATE TRUE                                                24310000
243200         WHEN SQLCODE = +0                                        24320000
243300              MOVE ENTNME-ENT-NAME-DESC TO PV-VENDOR-NAME         24330000
243400                                           ASC-VENDOR-NME         24340000
243500         WHEN SQLCODE = +100                                      24350000
243600               MOVE SPACES TO PV-VENDOR-NAME                      24360000
243700               MOVE PC-UNKNWN-VENDOR  TO PV-VENDOR-NAME           24370000
243800         WHEN SQLCODE = -904                                      24380000
243900         WHEN SQLCODE = -911                                      24390000
244000         WHEN SQLCODE = -913                                      24400000
244100             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    24410000
244200             MOVE '4320-GET-VENDOR-NAME'    TO PV-SOFT-PARAGRAPH  24420000
244300             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  24430000
244400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24440000
244500               TO PV-COMMAREA-LENGTH                              24450000
244600             EXEC CICS                                            24460000
244700                  WRITEQ TD                                       24470000
244800                   QUEUE  ('CSSL')                                24480000
244900                    FROM  (PV-CICS-MSG-AREA2)                     24490000
245000                  LENGTH  (PV-COMMAREA-LENGTH)                    24500000
245100                    RESP  (PV-CICS-RESP)                          24510000
245200             END-EXEC                                             24520000
245300             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24530000
245400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24540000
245500             PERFORM 9900-SOFT-ABORT                              24550000
245600         WHEN OTHER                                               24560000
245700              MOVE '4320-GET-VENDOR-NAME'                         24570000
245800                               TO DP013-PARAGRAPH                 24580000
245900              MOVE 'GET VENDOR NAME     '                         24590000
246000                               TO DP013-MESSAGE-TEXT (1)          24600000
246100              MOVE SQLCA       TO DP013-SQLCA                     24610000
246200              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        24620000
246300              SET DP013-DB2-ABEND                                 24630000
246400                  DP013-XCTL-DISPLAY-RESTART                      24640000
246500                                   TO TRUE                        24650000
246600                  PERFORM DP013-0000-PROCESS-ABEND                24660000
246700     END-EVALUATE.                                                24670000
246800                                                                  24680000
246900*----------------------------------------------------------------*24690000
247000* GET DEST OPER UNIT FROM TSULBXF TABLE                          *24700000
247100*----------------------------------------------------------------*24710000
247200 4330-GET-SULBXF-DEST-STORE.                                      24720000
247300                                                                  24730000
247400     EXEC SQL                                                     24740000
247500         SELECT  DISTINCT (DEST_OPER_UNT_ID)                      24750000
247600           INTO  :SULBXF-DEST-OPER-UNT-ID                         24760000
247700           FROM  TSULBXF                                          24770000
247800          WHERE  SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID              24780000
247900            AND  STAT_CDE         = 'A'                           24790000
248000     END-EXEC                                                     24800000
248100                                                                  24810000
248200     EVALUATE TRUE                                                24820000
248300         WHEN SQLCODE = +0                                        24830000
248400              MOVE SULBXF-DEST-OPER-UNT-ID                        24840000
248500                               TO ASC-DEST-OPER-UNT-ID            24850000
248600         WHEN SQLCODE = +100                                      24860000
248700              PERFORM 4335-GET-SHPUNT-DEST-STORE                  24870000
248800         WHEN SQLCODE = -811                                      24880000
248900              MOVE PC-MULT     TO ASC-DEST-OPER-UNT-ID            24890000
249000         WHEN SQLCODE = -904                                      24900000
249100         WHEN SQLCODE = -911                                      24910000
249200         WHEN SQLCODE = -913                                      24920000
249300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    24930000
249400             MOVE '4330-GET-SULBXF-DEST-STORE '                   24940000
249500                                       TO PV-SOFT-PARAGRAPH       24950000
249600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  24960000
249700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24970000
249800               TO PV-COMMAREA-LENGTH                              24980000
249900             EXEC CICS                                            24990000
250000                  WRITEQ TD                                       25000000
250100                   QUEUE  ('CSSL')                                25010000
250200                    FROM  (PV-CICS-MSG-AREA2)                     25020000
250300                  LENGTH  (PV-COMMAREA-LENGTH)                    25030000
250400                    RESP  (PV-CICS-RESP)                          25040000
250500             END-EXEC                                             25050000
250600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25060000
250700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              25070000
250800             PERFORM 9900-SOFT-ABORT                              25080000
250900         WHEN OTHER                                               25090000
251000              MOVE '4330-GET-SULBXF-DEST-STORE '                  25100000
251100                               TO DP013-PARAGRAPH                 25110000
251200              MOVE 'GET DEST STR   '                              25120000
251300                               TO DP013-MESSAGE-TEXT (1)          25130000
251400              MOVE SQLCA       TO DP013-SQLCA                     25140000
251500              MOVE 'TSULBXF '  TO DP013-DB2-TABLE-NAME (1)        25150000
251600              SET DP013-DB2-ABEND                                 25160000
251700                  DP013-XCTL-DISPLAY-RESTART                      25170000
251800                                   TO TRUE                        25180000
251900                  PERFORM DP013-0000-PROCESS-ABEND                25190000
252000     END-EVALUATE.                                                25200000
252100*                                                                 25210000
252200*                                                                 25220000
252300*----------------------------------------------------------------*25230000
252400* GET DEST OPER UNIT FROM TSHPUNT TABLE                          *25240000
252500*----------------------------------------------------------------*25250000
252600 4335-GET-SHPUNT-DEST-STORE.                                      25260000
252700                                                                  25270000
252800     EXEC SQL                                                     25280000
252900         SELECT  DEST_OPER_UNT_ID                                 25290000
253000           INTO  :SHPUNT-DEST-OPER-UNT-ID                         25300000
253100           FROM  TSHPUNT                                          25310000
253200          WHERE  SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID              25320000
253300     END-EXEC                                                     25330000
253400                                                                  25340000
253500     EVALUATE TRUE                                                25350000
253600         WHEN SQLCODE = +0                                        25360000
253700              MOVE  SHPUNT-DEST-OPER-UNT-ID  TO                   25370000
253800                                  ASC-DEST-OPER-UNT-ID            25380000
253900         WHEN SQLCODE = +100                                      25390000
254000              CONTINUE                                            25400000
254100         WHEN SQLCODE = -811                                      25410000
254200              MOVE PC-MULT     TO ASC-DEST-OPER-UNT-ID            25420000
254300         WHEN SQLCODE = -904                                      25430000
254400         WHEN SQLCODE = -911                                      25440000
254500         WHEN SQLCODE = -913                                      25450000
254600             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    25460000
254700             MOVE '4335-GET-SHPUNT-DEST-STORE '                   25470000
254800                                     TO PV-SOFT-PARAGRAPH         25480000
254900             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  25490000
255000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25500000
255100               TO PV-COMMAREA-LENGTH                              25510000
255200             EXEC CICS                                            25520000
255300                  WRITEQ TD                                       25530000
255400                   QUEUE  ('CSSL')                                25540000
255500                    FROM  (PV-CICS-MSG-AREA2)                     25550000
255600                  LENGTH  (PV-COMMAREA-LENGTH)                    25560000
255700                    RESP  (PV-CICS-RESP)                          25570000
255800             END-EXEC                                             25580000
255900             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25590000
256000             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              25600000
256100             PERFORM 9900-SOFT-ABORT                              25610000
256200         WHEN OTHER                                               25620000
256300              MOVE '4335-GET-SHPUNT-DEST-STORE '                  25630000
256400                               TO DP013-PARAGRAPH                 25640000
256500              MOVE 'GET DEST STR   '                              25650000
256600                               TO DP013-MESSAGE-TEXT (1)          25660000
256700              MOVE SQLCA       TO DP013-SQLCA                     25670000
256800              MOVE 'TSHPUNT '  TO DP013-DB2-TABLE-NAME (1)        25680000
256900              SET DP013-DB2-ABEND                                 25690000
257000                  DP013-XCTL-DISPLAY-RESTART                      25700000
257100                                   TO TRUE                        25710000
257200                  PERFORM DP013-0000-PROCESS-ABEND                25720000
257300     END-EVALUATE.                                                25730000
257400*                                                                 25740000
257500*                                                                 25750000
257600*----------------------------------------------------------------*25760000
257700* GET CURRENT SCAC/TRLR TRIP                                     *25770000
257800*----------------------------------------------------------------*25780000
257900 4340-GET-SCAC-TRLR-TRIP.                                         25790000
258000                                                                  25800000
258100     EXEC SQL                                                     25810000
258200         SELECT  DISTINCT                                         25820000
258300                 A.TRIP_ID                                        25830000
258400                ,A.OWNER_SCAC_ID                                  25840000
258500                ,A.VEH_NBR                                        25850000
258600                ,G.CRE_USR_ID                                     25860000
258700          INTO  :DK-TRIP-ID                                       25870000
258800               ,:DK-SCAC-ID                                       25880000
258900               ,:DK-TRLR-NBR :DN-VEH-NBR                          25890000
259000               ,:SHUNLO-CRE-USR-ID                                25900000
259100           FROM TVHTRIP A                                         25910000
259200               ,TTRIPST B                                         25920000
259300               ,TTRSTYP C                                         25930000
259400               ,TSHIPMT E                                         25940000
259500               ,TSHPTPO F                                         25950000
259600               ,TSHUNLO G                                         25960000
259700          WHERE G.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             25970000
259800            AND G.TRIP_ID          = A.TRIP_ID                    25980000
259900            AND G.SCN_LOC_ID       = 'RECV'                       25990000
260000            AND G.ACTV_CDE         = 'A'                          26000000
260100            AND A.TRIP_ID          = B.TRIP_ID                    26010000
260200            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            26020000
260300            AND A.TRIP_ID          = E.TRIP_ID                    26030000
260400            AND E.SHIPT_ID         = F.SHIPT_ID                   26040000
260500            AND F.PRIM_SHIPT_IND   = 'Y'                          26050000
260600            AND C.PRTY_CDE         =                              26060000
260700              (SELECT MAX(E.PRTY_CDE)                             26070000
260800                FROM TTRIPST D                                    26080000
260900                    ,TTRSTYP E                                    26090000
261000               WHERE D.TRIP_ID         = A.TRIP_ID                26100000
261100                 AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)       26110000
261200     END-EXEC                                                     26120000
261300     EVALUATE TRUE                                                26130000
261400         WHEN SQLCODE = +0                                        26140000
261500              MOVE DK-TRIP-ID      TO   PV-TRIP-ID                26150000
261600                                        ASC-TRIP-ID               26160000
261700              MOVE DK-SCAC-ID      TO   PV-SCAC                   26170000
261800                                        ASC-SCAC                  26180000
261900              MOVE SHUNLO-CRE-USR-ID TO ASC-USR-ID                26190000
262000              IF DN-VEH-NBR = -1                                  26200000
262100                  MOVE SPACES          TO   PV-TRLR-NBR           26210000
262200                                            ASC-TRLR-NBR          26220000
262300              ELSE                                                26230000
262400                  MOVE DK-TRLR-NBR     TO   PV-TRLR-NBR           26240000
262500                                            ASC-TRLR-NBR          26250000
262600              END-IF                                              26260000
262700         WHEN SQLCODE = +100                                      26270000
262800              PERFORM 4345-GET-SCAC-TRLR-TRIP-2                   26280000
262900         WHEN SQLCODE = -811                                      26290000
263000              SET ASC-MLTPL-CRTN-CHECK-YES    TO TRUE             26300000
263100         WHEN SQLCODE = -904                                      26310000
263200         WHEN SQLCODE = -911                                      26320000
263300         WHEN SQLCODE = -913                                      26330000
263400             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    26340000
263500             MOVE '4340-GET-SCAC-TRLR-TRIP' TO PV-SOFT-PARAGRAPH  26350000
263600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  26360000
263700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     26370000
263800               TO PV-COMMAREA-LENGTH                              26380000
263900             EXEC CICS                                            26390000
264000                  WRITEQ TD                                       26400000
264100                   QUEUE  ('CSSL')                                26410000
264200                    FROM  (PV-CICS-MSG-AREA2)                     26420000
264300                  LENGTH  (PV-COMMAREA-LENGTH)                    26430000
264400                    RESP  (PV-CICS-RESP)                          26440000
264500             END-EXEC                                             26450000
264600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          26460000
264700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              26470000
264800             PERFORM 9900-SOFT-ABORT                              26480000
264900         WHEN OTHER                                               26490000
264910             MOVE DK-SHIPT-UNT-ID           TO PV-DISP-SSCC       26491011
265000              MOVE '4340-GET-SCAC-TRLR-TRIP'                      26500000
265100                               TO DP013-PARAGRAPH                 26510000
265200              MOVE 'GET LINE DISTRIBTION     '                    26520000
265300                               TO DP013-MESSAGE-TEXT (1)          26530000
265310              STRING' SSCC:'  PV-DISP-SSCC                        26531011
265320                                  DELIMITED BY SIZE               26532011
265330                             INTO DP013-MESSAGE-TEXT (2)          26533011
265400              MOVE SQLCA       TO DP013-SQLCA                     26540000
265500              MOVE 'TVHTRIP '  TO DP013-DB2-TABLE-NAME (1)        26550011
265510              MOVE 'TTRIPST '  TO DP013-DB2-TABLE-NAME (2)        26551011
265520              MOVE 'TTRSTYP '  TO DP013-DB2-TABLE-NAME (3)        26552011
265600              SET DP013-DB2-ABEND                                 26560000
265700                  DP013-XCTL-DISPLAY-RESTART                      26570000
265800                                   TO TRUE                        26580000
265900                  PERFORM DP013-0000-PROCESS-ABEND                26590000
266000     END-EVALUATE.                                                26600000
266100*----------------------------------------------------------------*26610000
266200* GET SCAC/TRLR TRIP IF CARTON NOT CHECKED IN                    *26620000
266300*----------------------------------------------------------------*26630000
266400 4345-GET-SCAC-TRLR-TRIP-2.                                       26640000
266500                                                                  26650000
266510     IF  DK-REC-SEQ-NBR  =  0                                     26651007
266520         MOVE  ASC-RECEIVER  TO  DK-REC-SEQ-NBR                   26652007
266530     END-IF.                                                      26653007
266600                                                                  26660000
266700     EXEC SQL                                                     26670000
266800         SELECT  A.TRIP_ID                                        26680000
266900                ,A.OWNER_SCAC_ID                                  26690000
267000                ,A.VEH_NBR                                        26700000
267100          INTO  :DK-TRIP-ID                                       26710000
267200               ,:DK-SCAC-ID                                       26720000
267300               ,:DK-TRLR-NBR :DN-VEH-NBR                          26730000
267400           FROM TVHTRIP A                                         26740000
267500               ,TTRIPST B                                         26750000
267600               ,TTRSTYP C                                         26760000
267700               ,TSHIPMT E                                         26770000
267800               ,TSHPTPO F                                         26780000
267900          WHERE F.PO_NBR           = :DK-PO-NBR                   26790000
268000            AND F.REC_SEQ_NBR      = :DK-REC-SEQ-NBR              26800000
268100            AND A.TRIP_ID          = :DK-TRIP-ID                  26810000
268200            AND A.TRIP_ID          = B.TRIP_ID                    26820000
268300            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            26830000
268400            AND A.TRIP_ID          = E.TRIP_ID                    26840000
268500            AND E.SHIPT_ID         = F.SHIPT_ID                   26850000
268600            AND F.PRIM_SHIPT_IND   = 'Y'                          26860000
268700            AND C.PRTY_CDE         =                              26870000
268800              (SELECT MAX(E.PRTY_CDE)                             26880000
268900                FROM TTRIPST D                                    26890000
269000                    ,TTRSTYP E                                    26900000
269100               WHERE D.TRIP_ID         = A.TRIP_ID                26910000
269200                 AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)       26920000
269300     END-EXEC                                                     26930000
269400                                                                  26940000
269500     EVALUATE TRUE                                                26950000
269600         WHEN SQLCODE = +0                                        26960000
269700              MOVE DK-TRIP-ID      TO   PV-TRIP-ID                26970000
269800                                        ASC-TRIP-ID               26980000
269900              MOVE DK-SCAC-ID      TO   PV-SCAC                   26990000
270000                                        ASC-SCAC                  27000000
270100              IF DN-VEH-NBR = -1                                  27010000
270200                  MOVE SPACES          TO   PV-TRLR-NBR           27020000
270300                                            ASC-TRLR-NBR          27030000
270400              ELSE                                                27040000
270500                  MOVE DK-TRLR-NBR     TO   PV-TRLR-NBR           27050000
270600                                            ASC-TRLR-NBR          27060000
270700              END-IF                                              27070000
270800         WHEN SQLCODE = +100                                      27080000
270900              MOVE ASC-TRIP-ID TO DK-TRIP-ID                      27090000
271000              MOVE SPACES      TO DK-SCAC-ID                      27100000
271100                                  DK-TRLR-NBR                     27110000
271110         WHEN SQLCODE = -811                                      27111011
271120              PERFORM 4347-GET-SCAC-TRLR-TRIP-3                   27112011
271200         WHEN SQLCODE = -904                                      27120000
271300         WHEN SQLCODE = -911                                      27130000
271400         WHEN SQLCODE = -913                                      27140000
271500             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    27150000
271600             MOVE '4345-GET-SCAC-TRLR-TR-2' TO PV-SOFT-PARAGRAPH  27160000
271700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  27170000
271800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27180000
271900               TO PV-COMMAREA-LENGTH                              27190000
272000             EXEC CICS                                            27200000
272100                  WRITEQ TD                                       27210000
272200                   QUEUE  ('CSSL')                                27220000
272300                    FROM  (PV-CICS-MSG-AREA2)                     27230000
272400                  LENGTH  (PV-COMMAREA-LENGTH)                    27240000
272500                    RESP  (PV-CICS-RESP)                          27250000
272600             END-EXEC                                             27260000
272700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          27270000
272800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              27280000
272900             PERFORM 9900-SOFT-ABORT                              27290000
273000         WHEN OTHER                                               27300000
273010             MOVE DK-PO-NBR                 TO PV-DISP-PO         27301011
273011             MOVE DK-REC-SEQ-NBR            TO PV-DISP-REC        27301111
273020             MOVE DK-TRIP-ID                TO PV-DISP-TRIP       27302011
273100              MOVE '4345-GET-SCAC-TRLR-TRIP-2'                    27310000
273200                               TO DP013-PARAGRAPH                 27320000
273300              MOVE 'GET LINE DISTRIBTION     '                    27330000
273400                               TO DP013-MESSAGE-TEXT (1)          27340000
273410              STRING PV-DISP-PO   '-'                             27341011
273420                     PV-DISP-REC  '  TRIP:'                       27342013
273430                     PV-DISP-TRIP DELIMITED BY SIZE               27343011
273440                             INTO DP013-MESSAGE-TEXT (2)          27344011
273500              MOVE SQLCA       TO DP013-SQLCA                     27350000
273600              MOVE 'TVHTRIP '  TO DP013-DB2-TABLE-NAME (1)        27360011
273610              MOVE 'TTRIPST '  TO DP013-DB2-TABLE-NAME (2)        27361011
273620              MOVE 'TTRSTYP '  TO DP013-DB2-TABLE-NAME (3)        27362011
273700              SET DP013-DB2-ABEND                                 27370000
273800                  DP013-XCTL-DISPLAY-RESTART                      27380000
273900                                   TO TRUE                        27390000
274000                  PERFORM DP013-0000-PROCESS-ABEND                27400000
274100     END-EVALUATE.                                                27410000
274110*----------------------------------------------------------------*27411011
274120* GET SCAC/TRLR TRIP IF CARTON NOT CHECKED IN                    *27412011
274121* MAX PRIM SHIPMENT                                              *27412111
274122* DMH 6/21/17                                                    *27412211
274130*----------------------------------------------------------------*27413011
274140 4347-GET-SCAC-TRLR-TRIP-3.                                       27414011
274150                                                                  27415011
274190                                                                  27419011
274191     EXEC SQL                                                     27419111
274192         SELECT  A.TRIP_ID                                        27419211
274193                ,A.OWNER_SCAC_ID                                  27419311
274194                ,A.VEH_NBR                                        27419411
274195          INTO  :DK-TRIP-ID                                       27419511
274196               ,:DK-SCAC-ID                                       27419611
274197               ,:DK-TRLR-NBR :DN-VEH-NBR                          27419711
274198           FROM TVHTRIP A                                         27419811
274199               ,TTRIPST B                                         27419911
274200               ,TTRSTYP C                                         27420011
274201               ,TSHIPMT E                                         27420111
274202               ,TSHPTPO F                                         27420211
274203          WHERE F.PO_NBR           = :DK-PO-NBR                   27420311
274204            AND F.REC_SEQ_NBR      = :DK-REC-SEQ-NBR              27420411
274205            AND A.TRIP_ID          = :DK-TRIP-ID                  27420511
274206            AND A.TRIP_ID          = B.TRIP_ID                    27420611
274207            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            27420711
274208            AND A.TRIP_ID          = E.TRIP_ID                    27420811
274209            AND E.SHIPT_ID         = F.SHIPT_ID                   27420911
274210            AND F.PRIM_SHIPT_IND   = 'Y'                          27421011
274212            AND C.PRTY_CDE         =                              27421211
274213              (SELECT MAX(G.PRTY_CDE)                             27421312
274214                FROM TTRIPST D                                    27421411
274215                    ,TTRSTYP G                                    27421512
274216               WHERE D.TRIP_ID         = A.TRIP_ID                27421611
274217                 AND D.TRIP_STATUS_CDE = G.TRIP_STATUS_CDE)       27421712
274218            AND F.CRE_TMST IN                                     27421812
274219                    (SELECT MAX(FF.CRE_TMST)                      27421912
274220                       FROM TSHPTPO FF                            27422012
274221                          , TSHIPMT EE                            27422112
274222                      WHERE F.PO_NBR      = FF.PO_NBR             27422212
274223                        AND F.REC_SEQ_NBR = FF.REC_SEQ_NBR        27422312
274224                        AND FF.SHIPT_ID   = EE.SHIPT_ID           27422412
274225                        AND FF.PRIM_SHIPT_IND = 'Y'               27422512
274226                        AND A.TRIP_ID     = EE.TRIP_ID            27422612
274227                    )                                             27422712
274228     END-EXEC                                                     27422812
274229                                                                  27422912
274230     EVALUATE TRUE                                                27423012
274231         WHEN SQLCODE = +0                                        27423112
274232              MOVE DK-TRIP-ID      TO   PV-TRIP-ID                27423212
274233                                        ASC-TRIP-ID               27423312
274234              MOVE DK-SCAC-ID      TO   PV-SCAC                   27423412
274235                                        ASC-SCAC                  27423512
274236              IF DN-VEH-NBR = -1                                  27423612
274237                  MOVE SPACES          TO   PV-TRLR-NBR           27423712
274238                                            ASC-TRLR-NBR          27423812
274239              ELSE                                                27423912
274240                  MOVE DK-TRLR-NBR     TO   PV-TRLR-NBR           27424012
274241                                            ASC-TRLR-NBR          27424112
274242              END-IF                                              27424212
274243         WHEN SQLCODE = +100                                      27424312
274244              MOVE ASC-TRIP-ID TO DK-TRIP-ID                      27424412
274245              MOVE SPACES      TO DK-SCAC-ID                      27424512
274246                                  DK-TRLR-NBR                     27424612
274247         WHEN SQLCODE = -904                                      27424712
274248         WHEN SQLCODE = -911                                      27424812
274249         WHEN SQLCODE = -913                                      27424912
274250             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    27425012
274251             MOVE '4347-GET-SCAC-TRLR-TRIP-3'                     27425112
274252                                            TO PV-SOFT-PARAGRAPH  27425212
274253             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  27425312
274254             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27425412
274255               TO PV-COMMAREA-LENGTH                              27425512
274256             EXEC CICS                                            27425612
274257                  WRITEQ TD                                       27425712
274258                   QUEUE  ('CSSL')                                27425812
274259                    FROM  (PV-CICS-MSG-AREA2)                     27425912
274260                  LENGTH  (PV-COMMAREA-LENGTH)                    27426012
274261                    RESP  (PV-CICS-RESP)                          27426112
274262             END-EXEC                                             27426212
274263             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          27426312
274264             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              27426412
274265             PERFORM 9900-SOFT-ABORT                              27426512
274266         WHEN OTHER                                               27426612
274267             MOVE DK-PO-NBR                 TO PV-DISP-PO         27426712
274268             MOVE DK-REC-SEQ-NBR            TO PV-DISP-REC        27426812
274269             MOVE DK-TRIP-ID                TO PV-DISP-TRIP       27426912
274270              MOVE '4347-GET-SCAC-TRLR-TRIP-3'                    27427012
274271                               TO DP013-PARAGRAPH                 27427112
274272              MOVE 'GET LINE DISTRIBTION     '                    27427212
274273                               TO DP013-MESSAGE-TEXT (1)          27427312
274274              STRING PV-DISP-PO   '-'                             27427412
274275                     PV-DISP-REC  '  TRIP:'                       27427513
274276                     PV-DISP-TRIP DELIMITED BY SIZE               27427612
274277                             INTO DP013-MESSAGE-TEXT (2)          27427712
274278              MOVE SQLCA       TO DP013-SQLCA                     27427812
274279              MOVE 'TVHTRIP '  TO DP013-DB2-TABLE-NAME (1)        27427912
274280              MOVE 'TTRIPST '  TO DP013-DB2-TABLE-NAME (2)        27428012
274281              MOVE 'TTRSTYP '  TO DP013-DB2-TABLE-NAME (3)        27428112
274282              SET DP013-DB2-ABEND                                 27428212
274283                  DP013-XCTL-DISPLAY-RESTART                      27428312
274284                                   TO TRUE                        27428412
274285                  PERFORM DP013-0000-PROCESS-ABEND                27428512
274286     END-EVALUATE.                                                27428612
274290*----------------------------------------------------------------*27429012
274300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *27430012
274400*----------------------------------------------------------------*27440012
274500                                                                  27450012
274600 4350-OPEN-CTN2-CURSOR.                                           27460012
274700     PERFORM                                                      27470012
274800         WITH TEST AFTER                                          27480012
274900         VARYING PV-RETRY-COUNTER                                 27490012
275000         FROM 1 BY 1                                              27500012
275100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27510012
275200                   OR (SQLCODE = ZERO))                           27520012
275300                                                                  27530012
275400         MOVE 'CURSOR:  CTN2-CONTENTS-CSR'                        27540012
275500                              TO DP013-MESSAGE-TEXT (2)           27550012
275600         EXEC SQL                                                 27560012
275700              OPEN CTN2-CONTENTS-CSR                              27570012
275800         END-EXEC                                                 27580012
275900                                                                  27590012
276000                                                                  27600012
276100         EVALUATE TRUE                                            27610012
276200             WHEN SQLCODE = ZERO                                  27620012
276300             WHEN SQLCODE = -904                                  27630012
276400             WHEN SQLCODE = -913                                  27640012
276500                 CONTINUE                                         27650012
276600             WHEN SQLWARN0 NOT = SPACES                           27660012
276700             WHEN SQLCODE < ZERO                                  27670012
276800             WHEN SQLCODE > ZERO                                  27680012
276900                 MOVE '4350-OPEN-CTN2-CURSOR'                     27690012
277000                                   TO DP013-PARAGRAPH             27700012
277100                 MOVE 'OPEN SYSTEM MESSAGE CURSOR - '             27710012
277200                                   TO DP013-MESSAGE-TEXT (1)      27720012
277300                 MOVE SQLCA        TO DP013-SQLCA                 27730012
277400                 MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)    27740012
277500                 SET DP013-DB2-ABEND                              27750012
277600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           27760012
277700                 PERFORM DP013-0000-PROCESS-ABEND                 27770012
277800         END-EVALUATE                                             27780012
277900     END-PERFORM                                                  27790012
278000*                                                                 27800012
278100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27810012
278200         MOVE '4350-OPEN-CTN2-CURSOR'   TO DP013-PARAGRAPH        27820012
278300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   27830012
278400                                   TO DP013-MESSAGE-TEXT (1)      27840012
278500         MOVE SQLCA                TO DP013-SQLCA                 27850012
278600         MOVE 'TSHUNLO '           TO DP013-DB2-TABLE-NAME (1)    27860012
278700         SET DP013-DB2-ABEND                                      27870012
278800             DP013-XCTL-DISPLAY-RESTART                           27880012
278900                                   TO TRUE                        27890012
279000         PERFORM DP013-0000-PROCESS-ABEND                         27900012
279100     END-IF.                                                      27910012
279200                                                                  27920012
279300 EJECT                                                            27930012
279400 4360-FETCH.                                                      27940012
279500                                                                  27950012
279600     EXEC SQL                                                     27960012
279700          FETCH CTN2-CONTENTS-CSR                                 27970012
279800           INTO  :SHUUPC-TRN-NBR                                  27980012
279900               , :SHUUPC-TRN-LNE-NBR                              27990012
280000               , :SHUUPC-UPC-NBR                                  28000012
280100               , :SHUUPC-SHPD-QTY                                 28010012
280200               , :SHPUNT-DEST-OPER-UNT-ID                         28020012
280300               , :SHPUNT-CRE-DTE                                  28030012
280400               , :SHPUNT-CRE-TM                                   28040012
280500               , :SHPUNT-SHIPT-UNT-SRC-ID                         28050012
280600     END-EXEC.                                                    28060012
280700                                                                  28070012
280800     EVALUATE TRUE                                                28080012
280900         WHEN SQLCODE = ZERO                                      28090012
281000              PERFORM 4500-CALL-XLKUT-DOMAIN                      28100012
281100                                                                  28110012
281200              MOVE  SHUUPC-TRN-NBR       TO  DK-PO-NBR            28120012
281300                                             PV-PO-NBR            28130012
281400              MOVE  SHUUPC-TRN-LNE-NBR   TO  PV-PO-LINE-NBR       28140012
281500              MOVE  SHUUPC-UPC-NBR       TO  PV-UPC-NBR           28150012
281600              MOVE  SHUUPC-SHPD-QTY      TO  PV-SHIPD-QTY         28160012
281700                                                                  28170012
281800              IF PS-XL-SKU-SELECT-NOT-FND                         28180012
281900                 MOVE  '*ITEM UNKNOWN*'     TO  PV-SKU-DESC       28190012
282000              ELSE                                                28200012
282100                 IF SHUUPC-TRN-LNE-NBR   = 0                      28210012
282200                    MOVE  XL001-SKU-DESC       TO  PV-SKU-DESC    28220012
282300                 ELSE                                             28230012
282400                    MOVE  XL001-SKU-DESC       TO  PV-SKU-DESC    28240012
282500                    PERFORM 4365-GET-PREPK-INFO                   28250012
282600                 END-IF                                           28260012
282700              END-IF                                              28270012
282800                                                                  28280012
282900              MOVE  RECITM-PREPK-RATO-QTY    TO  PV-PREPK-RATIO   28290012
283000              MOVE  RECITM-REC-SEQ-NBR   TO  DK-REC-SEQ-NBR       28300012
283100                                             PV-RECEIVER          28310012
283200              PERFORM 4395-FORMAT-DTE-TME-SRCE                    28320012
283300                                                                  28330012
283400              IF ASC-MERCH-DEPT = SPACES                          28340012
283500                 PERFORM 4380-GET-DEPT                            28350012
283600                 MOVE PURCHS-DEPT-NBR TO ASC-MERCH-DEPT           28360012
283700              END-IF                                              28370012
283800         WHEN SQLCODE = +100                                      28380012
283900              SET PS-EO-CTN2-CONTENT TO TRUE                      28390012
284000              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 28400012
284100                                                                  28410012
284200         WHEN SQLWARN0 NOT = SPACE                                28420012
284300         WHEN SQLCODE NOT = ZERO                                  28430012
284400              MOVE '4360-FETCH-CURSOR'                            28440012
284500                               TO DP013-PARAGRAPH                 28450012
284600              MOVE 'FETCH MESSAGE CURSOR'                         28460012
284700                               TO DP013-MESSAGE-TEXT (1)          28470012
284800              MOVE SQLCA       TO DP013-SQLCA                     28480012
284900              SET DP013-DB2-ABEND                                 28490012
285000                               TO TRUE                            28500012
285100              PERFORM DP013-0000-PROCESS-ABEND                    28510012
285200     END-EVALUATE.                                                28520012
285300 4365-GET-PREPK-INFO.                                             28530012
285400                                                                  28540012
285500     EXEC SQL                                                     28550012
285600             SELECT  DISTINCT                                     28560012
285700                     D.REC_SEQ_NBR,                               28570012
285800                     D.PREPK_RATO_QTY,                            28580012
285900                     D.VER_STATUS_CDE,                            28590012
286000                     D.PREPK_ID                                   28600012
286100              INTO   :RECITM-REC-SEQ-NBR                          28610012
286200                    ,:RECITM-PREPK-RATO-QTY                       28620012
286300                    ,:RECITM-VER-STATUS-CDE                       28630012
286400                    ,:RECITM-PREPK-ID                             28640012
286500              FROM   TSHUUPC A,                                   28650012
286600                     TINPKSU B,                                   28660012
286700                     TPKSLIP C,                                   28670012
286800                     TRECITM D,                                   28680012
286900                     TPURITM E,                                   28690012
287000                     TSHPUNT F                                    28700012
287100              WHERE   A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID       28710012
287200                AND   A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID        28720012
287300                AND   A.SHIPT_UNT_ID     = F.SHIPT_UNT_ID         28730012
287400                AND   A.TRN_NBR          = :SHUUPC-TRN-NBR        28740012
287500                AND   A.TRN_LNE_NBR      = :SHUUPC-TRN-LNE-NBR    28750012
287600                AND   A.TRN_NBR          = B.PO_NBR               28760012
287700                AND   B.PO_NBR           = C.PO_NBR               28770012
287800                AND   B.SEQ_NBR          = C.SEQ_NBR              28780012
287900                AND   C.VER_STAT_CDE     = 'A'                    28790012
288000                AND   C.PO_NBR           = D.ORD_NBR              28800012
288100                AND   C.REC_SEQ_NBR      = D.REC_SEQ_NBR          28810012
288200                AND   A.TRN_LNE_NBR      = D.ORD_LNE_NBR          28820012
288300                AND   D.ORD_NBR          = E.PO_NBR               28830012
288400                AND   D.ORD_LNE_NBR      = E.APP_PO_LNE_NBR       28840012
288500                AND   D.PO_VER_NBR       = E.VER_NBR              28850012
288600     END-EXEC.                                                    28860012
288700                                                                  28870012
288800*                                                                 28880012
288900     EVALUATE TRUE                                                28890012
289000         WHEN SQLCODE = ZERO                                      28900012
289010*            IF  ASC-PREPK-ID  =  0                               28901012
289100                 MOVE RECITM-PREPK-ID  TO ASC-PREPK-ID            28910012
289110*            END-IF                                               28911012
289200         WHEN SQLCODE = +100                                      28920012
289300             MOVE ZEROES   TO   RECITM-REC-SEQ-NBR                28930012
289400                                RECITM-PREPK-RATO-QTY             28940012
289600             MOVE 'I'      TO   RECITM-VER-STATUS-CDE             28960012
289700         WHEN SQLWARN0 NOT = SPACES                               28970012
289800         WHEN SQLCODE < ZERO                                      28980012
289900         WHEN SQLCODE > ZERO                                      28990012
290000             MOVE '4365-GET-PREPK-INFO   '                        29000012
290100                               TO DP013-PARAGRAPH                 29010012
290200              MOVE 'ERROR GETTING PREPK INFO'                     29020012
290300                               TO DP013-MESSAGE-TEXT (1)          29030012
290400             MOVE SQLCA        TO DP013-SQLCA                     29040012
290500             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        29050012
290600             SET DP013-DB2-ABEND                                  29060012
290700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29070012
290800             PERFORM DP013-0000-PROCESS-ABEND                     29080012
290900     END-EVALUATE.                                                29090012
291000                                                                  29100012
291100*----------------------------------------------------------------*29110012
291200* CLOSE THE CARTON CONTENTS CURSOR                               *29120012
291300*----------------------------------------------------------------*29130012
291400                                                                  29140012
291500 4370-CLOSE-CTN2-CURSOR.                                          29150012
291600                                                                  29160012
291700     EXEC SQL                                                     29170012
291800          CLOSE CTN2-CONTENTS-CSR                                 29180012
291900     END-EXEC.                                                    29190012
292000                                                                  29200012
292100*                                                                 29210012
292200     EVALUATE TRUE                                                29220012
292300         WHEN SQLCODE = ZERO                                      29230012
292400             CONTINUE                                             29240012
292500         WHEN SQLWARN0 NOT = SPACES                               29250012
292600         WHEN SQLCODE < ZERO                                      29260012
292700         WHEN SQLCODE > ZERO                                      29270012
292800             MOVE '4370-CLOSE-CTN2-CURSOR'                        29280012
292900                               TO DP013-PARAGRAPH                 29290012
293000             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  29300012
293100                               TO DP013-MESSAGE-TEXT (1)          29310012
293200             MOVE SQLCA        TO DP013-SQLCA                     29320012
293300             MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)        29330012
293400             SET DP013-DB2-ABEND                                  29340012
293500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29350012
293600             PERFORM DP013-0000-PROCESS-ABEND                     29360012
293700     END-EVALUATE.                                                29370012
293800                                                                  29380012
293900*----------------------------------------------------------------*29390012
294000* GET DEPT NUMBER FROM PO TABLE                                  *29400012
294100*----------------------------------------------------------------*29410012
294200                                                                  29420012
294300 4380-GET-DEPT.                                                   29430012
294400                                                                  29440012
294500     EXEC SQL                                                     29450012
294600          SELECT DEPT_NBR                                         29460012
294700            INTO :PURCHS-DEPT-NBR                                 29470012
294800           FROM  TPURCHS                                          29480012
294900           WHERE PO_NBR = :DK-PO-NBR                              29490012
295000           AND   VER_STATUS_CDE = 'A'                             29500012
295100     END-EXEC.                                                    29510012
295200                                                                  29520012
295300*                                                                 29530012
295400     EVALUATE TRUE                                                29540012
295500         WHEN SQLCODE = ZERO                                      29550012
295600             CONTINUE                                             29560012
295700         WHEN SQLCODE = +100                                      29570012
295800             MOVE SPACES TO PURCHS-DEPT-NBR                       29580012
295900         WHEN SQLWARN0 NOT = SPACES                               29590012
296000         WHEN SQLCODE < ZERO                                      29600012
296100         WHEN SQLCODE > ZERO                                      29610012
296200             MOVE '4380-GET-DEPT'                                 29620012
296300                               TO DP013-PARAGRAPH                 29630012
296400             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  29640012
296500                               TO DP013-MESSAGE-TEXT (1)          29650012
296600             MOVE SQLCA        TO DP013-SQLCA                     29660012
296700             MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)        29670012
296800             SET DP013-DB2-ABEND                                  29680012
296900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29690012
297000             PERFORM DP013-0000-PROCESS-ABEND                     29700012
297100     END-EVALUATE.                                                29710012
297200                                                                  29720012
297300*                                                                 29730012
297400*----------------------------------------------------------------*29740012
297500* CHECK TO SEE IF PREPACK ORDER                                  *29750012
297600*----------------------------------------------------------------*29760012
297700 4390-CHECK-IF-PREPACK.                                           29770012
297800     EXEC SQL                                                     29780012
297900          SELECT PKGNG_CDE                                        29790012
298000            INTO :RECEIV-PKGNG-CDE                                29800012
298100            FROM TRECEIV                                          29810012
298200           WHERE ORD_NBR     = :DK-PO-NBR                         29820012
298300             AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                    29830012
298400     END-EXEC.                                                    29840012
298500                                                                  29850012
298600     EVALUATE TRUE                                                29860012
298700         WHEN SQLCODE = ZERO                                      29870012
298800             IF RECEIV-PKGNG-CDE = 'M' OR 'I'                     29880012
298900                SET PS-PREPACK-ORDER TO TRUE                      29890012
299000             ELSE                                                 29900012
299100                SET PS-NOT-PREPACK-ORDER TO TRUE                  29910012
299200             END-IF                                               29920012
299300         WHEN SQLCODE = +100                                      29930012
299400             CONTINUE                                             29940012
299500         WHEN SQLWARN0 NOT = SPACES                               29950012
299600         WHEN SQLCODE < ZERO                                      29960012
299700         WHEN SQLCODE > ZERO                                      29970012
299800             MOVE '4390-CHECK-IF-PREPACK'                         29980012
299900                               TO DP013-PARAGRAPH                 29990012
300000             MOVE 'CHECK IF PREPACK ORDER '                       30000012
300100                               TO DP013-MESSAGE-TEXT (1)          30010012
300200             MOVE SQLCA        TO DP013-SQLCA                     30020012
300300             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        30030012
300400             SET DP013-DB2-ABEND                                  30040012
300500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30050012
300600             PERFORM DP013-0000-PROCESS-ABEND                     30060012
300700     END-EVALUATE.                                                30070012
300800                                                                  30080012
300900                                                                  30090012
301000*----------------------------------------------------------------*30100012
301100* CHECK TO SEE IF LINE IS PART OF THE PREPACK                    *30110012
301200*----------------------------------------------------------------*30120012
301300 4392-CK-ON-PREPK.                                                30130012
301400     MOVE  PV-PO-LINE-NBR        TO  DK-LNE-NBR.                  30140012
301500     IF ASC-FROM-PGM-PREPK-ID > 0                                 30150012
301600        MOVE  ASC-FROM-PGM-PREPK-ID TO  DK-PREPK-ID               30160012
301700     ELSE                                                         30170012
301800        MOVE  ASC-PREPK-ID          TO  DK-PREPK-ID               30180012
301810     END-IF                                                       30181012
301820                                                                  30182012
301830     EXEC SQL                                                     30183012
301840          SELECT PREPK_ID                                         30184012
301841            INTO :RECITM-PREPK-ID                                 30184112
301842            FROM TRECITM                                          30184212
301843           WHERE ORD_NBR     = :DK-PO-NBR                         30184312
301844             AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                    30184412
301845             AND ORD_LNE_NBR = :DK-LNE-NBR                        30184512
301846             AND PREPK_ID    = :DK-PREPK-ID                       30184612
301847     END-EXEC.                                                    30184712
301848                                                                  30184812
301849     EVALUATE TRUE                                                30184912
301850         WHEN SQLCODE = ZERO                                      30185012
301883              CONTINUE                                            30188312
301884         WHEN SQLCODE = +100                                      30188412
301912                                                                  30191212
301913              SET  ASC-NOT-ON-PACK-YES                            30191312
301914                   (ASC-BLK-SUB,ASC-ITEM-SUB)  TO  TRUE           30191412
301915             CONTINUE                                             30191512
301916         WHEN SQLWARN0 NOT = SPACES                               30191612
301917         WHEN SQLCODE < ZERO                                      30191712
301918         WHEN SQLCODE > ZERO                                      30191812
301919             MOVE '4392-CK-IF-ON-PREPK  '                         30191912
301920                               TO DP013-PARAGRAPH                 30192012
301921             MOVE 'CHECK IF LINE IN PREPACK'                      30192112
301922                               TO DP013-MESSAGE-TEXT (1)          30192212
301923             MOVE SQLCA        TO DP013-SQLCA                     30192312
301924             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        30192412
301925             SET DP013-DB2-ABEND                                  30192512
301926                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30192612
301927             PERFORM DP013-0000-PROCESS-ABEND                     30192712
301928     END-EVALUATE.                                                30192812
301929*                                                                 30192912
301930 4395-FORMAT-DTE-TME-SRCE.                                        30193012
301931                                                                  30193112
301932      MOVE SHPUNT-CRE-DTE     TO PV-REFORMAT-DATE                 30193212
301933      MOVE PV-REFORMAT-YYYY   TO PV-FORMAT-YYYY                   30193312
301934      MOVE PV-REFORMAT-MM     TO PV-FORMAT-MM                     30193412
301935      MOVE PV-REFORMAT-DD     TO PV-FORMAT-DD                     30193512
301936      MOVE PV-FORMAT-DATE     TO ASC-CREATE-DTE                   30193612
301940*                                                                 30194012
301950      MOVE SHPUNT-CRE-TM      TO PV-FORMAT-TIME                   30195012
301960      MOVE PV-FORMAT-TIME     TO ASC-CREATE-TME                   30196012
301970                                                                  30197012
301980      EVALUATE SHPUNT-SHIPT-UNT-SRC-ID                            30198012
301990        WHEN 'ASN'                                                30199012
302000             MOVE  'CREATED BY ASN'                               30200012
302100                         TO  ASC-CRE-SOURCE                       30210012
302200        WHEN 'RDM'                                                30220012
302300             MOVE  'CREATED BY RDM'                               30230012
302400                         TO  ASC-CRE-SOURCE                       30240012
302500        WHEN 'CPS'                                                30250012
302600             MOVE  'CREATED BY CASEPACK SPLIT'                    30260012
302700                         TO  ASC-CRE-SOURCE                       30270012
302800        WHEN 'FXR'                                                30280012
302900             MOVE  'CREATED BY FAST TRANSFER'                     30290012
303000                         TO  ASC-CRE-SOURCE                       30300012
303100        WHEN 'P2L'                                                30310012
303200             MOVE  'CREATED BY P2L'                               30320012
303300                         TO  ASC-CRE-SOURCE                       30330012
303400        WHEN 'RCV'                                                30340012
303500             MOVE  'CREATED BY RECEIVING'                         30350012
303600                         TO  ASC-CRE-SOURCE                       30360012
303700        WHEN 'SMO'                                                30370012
303800             MOVE  'CREATED BY SMOOTHING'                         30380012
303900                         TO  ASC-CRE-SOURCE                       30390012
304000        WHEN 'MSC'                                                30400012
304100             MOVE  'CREATED BY CARTON BUILD'                      30410012
304200                         TO  ASC-CRE-SOURCE                       30420012
304300        WHEN 'MST'                                                30430012
304400             MOVE  'CREATED BY MASTER CONT'                       30440012
304500                         TO  ASC-CRE-SOURCE                       30450012
304600        WHEN 'JWL'                                                30460012
304700             MOVE  'CREATED BY JEWELRY    '                       30470012
304800                         TO  ASC-CRE-SOURCE                       30480012
304900        WHEN 'DMG'                                                30490012
305000             MOVE  'DMG BY CRTN ADJUST    '                       30500012
305100                         TO  ASC-CRE-SOURCE                       30510012
305200      END-EVALUATE.                                               30520012
305300                                                                  30530012
305400 4400-MOVE-COMMAREA-TO-SCREEN.                                    30540012
305500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             30550012
305600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          30560012
305700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          30570012
305800             MOVE +1    TO ASC-BLK-SUB                            30580012
305900             PERFORM 5100-WRITE-TEMP-STORAGE                      30590012
306000             ADD +1     TO ASC-BLK-SUB                            30600012
306100             PERFORM 5100-WRITE-TEMP-STORAGE                      30610012
306200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             30620012
306300                 GIVING PV-BLOCK-NUMBER                           30630012
306400                 REMAINDER PV-REMAINDER                           30640012
306500             IF  PV-REMAINDER > ZERO                              30650012
306600                 ADD +1 TO PV-BLOCK-NUMBER                        30660012
306700             END-IF                                               30670012
306800             MOVE +1    TO ASC-BLK-SUB                            30680012
306900             PERFORM 4410-READ-TEMP-STORAGE                       30690012
307000             ADD +1     TO ASC-BLK-SUB                            30700012
307100                           PV-BLOCK-NUMBER                        30710012
307200             PERFORM 4410-READ-TEMP-STORAGE                       30720012
307300     END-IF.                                                      30730012
307400     MOVE +1            TO ASC-BLK-SUB.                           30740012
307500     COMPUTE ASC-ITEM-SUB =                                       30750012
307600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              30760012
307700         + PC-ITEMS-PER-PANEL).                                   30770012
307800*                                                                 30780012
307900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30790012
308000         ADD +1         TO ASC-BLK-SUB                            30800012
308100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30810012
308200     END-IF.                                                      30820012
308300*                                                                 30830012
308400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           30840012
308500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                30850012
308600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        30860012
308700     PERFORM 4420-FORMAT-LIST-LINES                               30870012
308800         VARYING PV-SUB                                           30880012
308900         FROM PC-ITEMS-PER-PANEL BY -1                            30890012
309000         UNTIL PV-SUB < +1.                                       30900012
309100*                                                                 30910012
309200     COMPUTE ASC-ITEMS-DISPLAYED =                                30920012
309300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          30930012
309400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    30940012
309500                                      ASTRTITO.                   30950012
309600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    30960012
309700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    30970012
309800                                                                  30980012
309900*    MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30990012
310000*                                  TO ASELITO.                    31000012
310100                                                                  31010012
310200     MOVE ASC-SHIPT-UNT-ID           TO ASERSHO.                  31020012
310300     MOVE ASC-DEST-OPER-UNT-ID       TO ADESTO.                   31030012
310400     MOVE ASC-RECEIVER               TO PV-RECEIVER.              31040012
310500     MOVE PV-PO-RECEIVER             TO APORCVO.                  31050012
310600     MOVE ASC-MERCH-DEPT             TO ADEPTO.                   31060012
310700     MOVE ASC-VENDOR-NME             TO AVNMEO.                   31070012
310800     IF ASC-SMOOTHING-SCREEN-YES                                  31080012
310900         MOVE DP015-PRO-DRK-OFF      TO ASCACA                    31090012
311000                                        ASCACHA                   31100012
311100                                        ATRLRA                    31110012
311200                                        ATRLRHA                   31120012
311300                                        ATRIPHA                   31130012
311400                                        ATRIPA                    31140012
311500                                        ATRIPA                    31150012
311600                                        APKIDA                    31160012
311700                                        APKIDDA                   31170012
311800     ELSE                                                         31180012
311900         MOVE ASC-SCAC               TO ASCACO                    31190012
312000         MOVE ASC-TRLR-NBR           TO ATRLRO                    31200012
312100         MOVE ASC-TRIP-ID            TO ATRIPO                    31210012
312200         PERFORM 4440-CHECK-FOR-PRE-PACK                          31220012
312300         IF  ASC-PREPK-ID   > 0                                   31230012
312400             MOVE ASC-PREPK-ID           TO APKIDO                31240012
312500             MOVE 'PRE-PACK ID...:'      TO APKIDDO               31250012
312600         ELSE                                                     31260012
312700             MOVE SPACES                 TO APKIDO                31270012
312800             MOVE SPACES                 TO APKIDDO               31280012
312900         END-IF                                                   31290012
313000     END-IF.                                                      31300012
313100     MOVE ASC-TOTAL-QTY              TO ATOTQTO.                  31310012
313200     MOVE ASC-CRE-SOURCE             TO ACRESRCO.                 31320012
313300     MOVE ASC-CREATE-DTE             TO ACREDTEO.                 31330012
313400     MOVE ASC-CREATE-TME             TO ACRETMEO.                 31340012
313500     MOVE ASC-USR-ID                 TO AUSRIDO.                  31350012
313600     IF  ASC-MLTPL-CRTN-CHECK-YES                                 31360012
313700         MOVE 'CARTON CHECKED IN MULTIPLE TIMES'                  31370012
313800                                     TO AMLTCTO                   31380012
313900     ELSE                                                         31390012
314000         MOVE SPACES                 TO AMLTCTO                   31400012
314100     END-IF.                                                      31410012
314200*                                                                 31420012
314300     IF  DP020-MSG-NUMBER-X = SPACE                               31430012
314400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  31440012
314500*            --- MORE ITEMS TO DISPLAY ----                       31450012
314600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            31460012
314700             SET DP020-MSG-INFORMATIONAL TO TRUE                  31470012
314800         END-IF                                                   31480012
314900     END-IF.                                                      31490012
315000*----------------------------------------------------------------*31500012
315100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *31510012
315200*----------------------------------------------------------------*31520012
315300                                                                  31530012
315400 4410-READ-TEMP-STORAGE.                                          31540012
315500                                                                  31550012
315600     EXEC CICS                                                    31560012
315700         READQ TS                                                 31570012
315800             QUEUE (ASC-LIST-QUEUE-NAME)                          31580012
315900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               31590012
316000             ITEM  (PV-BLOCK-NUMBER)                              31600012
316100             RESP  (PV-CICS-RESP)                                 31610012
316200     END-EXEC.                                                    31620012
316300                                                                  31630012
316400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       31640012
316500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     31650012
316600         CONTINUE                                                 31660012
316700     ELSE                                                         31670012
316800         SET DP013-CICS-ABEND     TO TRUE                         31680012
316900         SET DP013-NO-ROLLBACK    TO TRUE                         31690012
317000         MOVE '4410-READ-TEMP-STORAGE'                            31700012
317100                                  TO DP013-PARAGRAPH              31710012
317200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      31720012
317300                                  TO DP013-MESSAGE-TEXT(1)        31730012
317400         PERFORM DP013-0000-PROCESS-ABEND                         31740012
317500     END-IF.                                                      31750012
317600                                                                  31760012
317700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             31770012
317800*                                                                 31780012
317900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         31790012
318000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               31800012
318100     END-IF.                                                      31810012
318200 EJECT                                                            31820012
318300*----------------------------------------------------------------*31830012
318400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *31840012
318500*----------------------------------------------------------------*31850012
318600                                                                  31860012
318700 4420-FORMAT-LIST-LINES.                                          31870012
318800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      31880012
318900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                31890012
319000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           31900012
319100         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           31910012
319200         MOVE SPACES             TO MR-SELECTI (PV-SUB)           31920012
319300                                    MR-ACTION (PV-SUB)            31930012
319400                                    MR-SKU-DESC (PV-SUB)          31940012
319500                                    MR-PO-LINE-X (PV-SUB)         31950012
319600                                    MR-DP-CL-SKU (PV-SUB)         31960012
319700                                    MR-UPC-X (PV-SUB)             31970012
319800                                    MR-SHIPD-QTY-X (PV-SUB)       31980012
319900*GB 12/28/00                                                      31990012
320000                                    MR-PREPACK-RATIO-X (PV-SUB)   32000012
320100     ELSE                                                         32010012
320200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32020012
320300                                                   > SPACE        32030012
320400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32040012
320500                                 TO MR-SELECTI (PV-SUB)           32050012
320600         ELSE                                                     32060012
320700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32070012
320800                                 TO MR-SELECTI (PV-SUB)           32080012
320900         END-IF                                                   32090012
321000*                                                                 32100012
321100         IF  DP030-SET-CURSOR-TRAILER                             32110012
321200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)32120012
321300                 > SPACE)                                         32130012
321400               OR (PV-SUB = 1))                                   32140012
321500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               32150012
321600*               MOVE -1          TO MR-SELECTL (PV-SUB)           32160012
321700                MOVE -1          TO ASTRTITL                      32170012
321800             END-IF                                               32180012
321900         END-IF                                                   32190012
322000*                                                                 32200012
322100*                                                                 32210012
322200         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               32220012
322300                                 TO MR-ACTION (PV-SUB)            32230012
322400         MOVE ASC-PO-LINE   (ASC-BLK-SUB ASC-ITEM-SUB)            32240012
322500                                 TO MR-PO-LINE (PV-SUB)           32250012
322600         MOVE ASC-DP-CL-SKU  (ASC-BLK-SUB ASC-ITEM-SUB)           32260012
322700                                 TO MR-DP-CL-SKU (PV-SUB)         32270012
322800         MOVE ASC-SKU-DESC        (ASC-BLK-SUB ASC-ITEM-SUB)      32280012
322900                                 TO MR-SKU-DESC (PV-SUB)          32290012
323000         MOVE ASC-UPC              (ASC-BLK-SUB ASC-ITEM-SUB)     32300012
323100                                 TO MR-UPC (PV-SUB)               32310012
323200         MOVE ASC-SHIPD-QTY  (ASC-BLK-SUB ASC-ITEM-SUB)           32320012
323300                                 TO MR-SHIPD-QTY (PV-SUB)         32330012
323400*                                                                 32340012
323500         MOVE ASC-PREPACK-RATIO (ASC-BLK-SUB ASC-ITEM-SUB)        32350012
323600                                 TO MR-PREPACK-RATIO (PV-SUB)     32360012
323700*                                                                 32370012
323800         IF ASC-LNE-UPC-ERROR-YES (ASC-BLK-SUB ASC-ITEM-SUB)      32380012
323900             MOVE DP015-YELLOW  TO MR-PO-LINEC (PV-SUB)           32390012
324000                                   MR-DP-CL-SKUC (PV-SUB)         32400012
324100                                   MR-SKU-DESCC (PV-SUB)          32410012
324200                                   MR-UPCC (PV-SUB)               32420012
324300                                   MR-SHIPD-QTYC (PV-SUB)         32430012
324400                                   MR-PREPACK-RATIOC (PV-SUB)     32440012
324500         ELSE                                                     32450012
324600             IF ASC-RECITM-VER-STATUS                             32460012
324700                             (ASC-BLK-SUB ASC-ITEM-SUB) = 'I'     32470012
324800                 MOVE DP015-RED     TO MR-PO-LINEC (PV-SUB)       32480012
324900                                       MR-DP-CL-SKUC (PV-SUB)     32490012
325000                                       MR-SKU-DESCC (PV-SUB)      32500012
325100                                       MR-UPCC (PV-SUB)           32510012
325200                                       MR-SHIPD-QTYC (PV-SUB)     32520012
325300                                       MR-PREPACK-RATIOC (PV-SUB) 32530012
325400             ELSE                                                 32540012
325500                 MOVE DP015-BLUE    TO MR-PO-LINEC (PV-SUB)       32550012
325600                                       MR-DP-CL-SKUC (PV-SUB)     32560012
325700                                       MR-SKU-DESCC (PV-SUB)      32570012
325800                                       MR-UPCC (PV-SUB)           32580012
325900                                       MR-SHIPD-QTYC (PV-SUB)     32590012
326000                                       MR-PREPACK-RATIOC (PV-SUB) 32600012
326100             END-IF                                               32610012
326200         END-IF                                                   32620012
326300     END-IF.                                                      32630012
326400                                                                  32640012
326500     IF ASC-NOT-ON-PACK-YES(ASC-BLK-SUB ASC-ITEM-SUB)             32650012
326600         MOVE DP015-YELLOW  TO MR-DP-CL-SKUC (PV-SUB)             32660012
326700     END-IF.                                                      32670012
326800                                                                  32680012
326900                                                                  32690012
327000     SUBTRACT +1 FROM ASC-ITEM-SUB                                32700012
327100     IF  ASC-ITEM-SUB < + 1                                       32710012
327200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  32720012
327300         MOVE +1                 TO ASC-BLK-SUB                   32730012
327400     END-IF.                                                      32740012
327500******************************************************************32750012
327600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **32760012
327700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **32770012
327800** ISSUE A WARNING.                                             **32780012
327900******************************************************************32790012
328000 4430-CHECK-FOR-BEGIN-AND-END.                                    32800012
328100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       32810012
328200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     32820012
328300*            -- NO END-OF-RANGE SPECFIED ---                      32830012
328400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            32840012
328500             SET DP020-MSG-WARNING TO TRUE                        32850012
328600             PERFORM 4431-POSITION-AT-WARNING                     32860012
328700         END-IF                                                   32870012
328800     ELSE                                                         32880012
328900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     32890012
329000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                32900012
329100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            32910012
329200             SET DP020-MSG-WARNING TO TRUE                        32920012
329300             PERFORM 4431-POSITION-AT-WARNING                     32930012
329400         END-IF                                                   32940012
329500     END-IF.                                                      32950012
329600******************************************************************32960012
329700** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **32970012
329800** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **32980012
329900** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **32990012
330000** POSITION THE CURSOR THERE.                                   **33000012
330100******************************************************************33010012
330200 4431-POSITION-AT-WARNING.                                        33020012
330300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 33030012
330400                    - PV-TOP-ITEM + 1.                            33040012
330500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      33050012
330600         CONTINUE                                                 33060012
330700     ELSE                                                         33070012
330800         SET DP030-SET-CURSOR-APPL-1                              33080012
330900                                   TO TRUE                        33090012
331000*        MOVE -1                   TO MR-SELECTL (PV-SUB)         33100012
331100         MOVE -1                   TO ASTRTITL                    33110012
331200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         33120012
331300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         33130012
331400     END-IF.                                                      33140012
331500*                                                                 33150012
331600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   33160012
331700                    - PV-TOP-ITEM + 1.                            33170012
331800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      33180012
331900         CONTINUE                                                 33190012
332000     ELSE                                                         33200012
332100         SET DP030-SET-CURSOR-APPL-1                              33210012
332200                                   TO TRUE                        33220012
332300*        MOVE -1                   TO MR-SELECTL (PV-SUB)         33230012
332400         MOVE -1                   TO ASTRTITL                    33240012
332500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         33250012
332600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         33260012
332700     END-IF.                                                      33270012
332800                                                                  33280012
332900                                                                  33290012
333000*----------------------------------------------------------------*33300012
333100* GET PRE PACK ID.                                               *33310012
333200*----------------------------------------------------------------*33320012
333300 4440-CHECK-FOR-PRE-PACK.                                         33330012
333400                                                                  33340012
333500     EXEC SQL                                                     33350012
333600         SELECT  DISTINCT                                         33360012
333700                 PREPK_ID                                         33370012
333800           INTO  :RECITM-PREPK-ID                                 33380012
333900           FROM  TRECITM                                          33390012
334000          WHERE  ORD_NBR           =  :DK-PO-NBR                  33400012
334100            AND  ORD_LNE_NBR       =  :SHUUPC-TRN-LNE-NBR         33410012
334200            AND  REC_SEQ_NBR       =  :DK-REC-SEQ-NBR             33420012
334300     END-EXEC                                                     33430012
334400                                                                  33440012
334500     EVALUATE TRUE                                                33450012
334600         WHEN SQLCODE = +0                                        33460012
334700              CONTINUE                                            33470012
334800         WHEN SQLCODE = +100                                      33480012
334900               MOVE ZERO TO RECITM-PREPK-ID                       33490012
335000         WHEN SQLCODE = -904                                      33500012
335100         WHEN SQLCODE = -911                                      33510012
335200         WHEN SQLCODE = -913                                      33520012
335300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    33530012
335400             MOVE '4440-CHECK-FOR-PRE-PACK' TO PV-SOFT-PARAGRAPH  33540012
335500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  33550012
335600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33560012
335700               TO PV-COMMAREA-LENGTH                              33570012
335800             EXEC CICS                                            33580012
335900                  WRITEQ TD                                       33590012
336000                   QUEUE  ('CSSL')                                33600012
336100                    FROM  (PV-CICS-MSG-AREA2)                     33610012
336200                  LENGTH  (PV-COMMAREA-LENGTH)                    33620012
336300                    RESP  (PV-CICS-RESP)                          33630012
336400             END-EXEC                                             33640012
336500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          33650012
336600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              33660012
336700             PERFORM 9900-SOFT-ABORT                              33670012
336800         WHEN OTHER                                               33680012
336900              MOVE '4440-CHECK-FOR-PRE-PACK'                      33690012
337000                               TO DP013-PARAGRAPH                 33700012
337100              MOVE 'GET PREPACK ID      '                         33710012
337200                               TO DP013-MESSAGE-TEXT (1)          33720012
337300              MOVE SQLCA       TO DP013-SQLCA                     33730012
337400              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        33740012
337500              SET DP013-DB2-ABEND                                 33750012
337600                  DP013-XCTL-DISPLAY-RESTART                      33760012
337700                                   TO TRUE                        33770012
337800                  PERFORM DP013-0000-PROCESS-ABEND                33780012
337900     END-EVALUATE.                                                33790012
338000                                                                  33800012
338100 4500-CALL-XLKUT-DOMAIN.                                          33810012
338200     INITIALIZE XL001-ITEM-COMMAREA.                              33820012
338300     INITIALIZE PV-SKU-NBR.                                       33830012
338400                                                                  33840012
338500     MOVE SHUUPC-UPC-NBR        TO XL001-KEY-UPC-NBR.             33850012
338600                                                                  33860012
338700     SET  XL001-BY-UPC-NBR                                        33870012
338800          XL001-SELECT-SKU                                        33880012
338900          XL001-SELECT-VND-STYL TO TRUE.                          33890012
339000                                                                  33900012
339100     CALL XL001-VSM-PGM USING  DFHEIBLK                           33910012
339200                               XL001-COMMAREA                     33920012
339300                               XL001-ITEM-COMMAREA.               33930012
339400     EVALUATE TRUE                                                33940012
339500                                                                  33950012
339600         WHEN XL001-SKU-SQLCODE = +0                              33960012
339700             IF XL001-DEPT-NBR > 0                                33970012
339800                 MOVE XL001-DEPT-NBR-3CH     TO  PV-SKU-DEPT      33980012
339900                                                 ASC-MERCH-DEPT   33990012
340000                 MOVE XL001-SUB-CL-NBR-2CH   TO  PV-SKU-CLASS     34000012
340100                 MOVE XL001-SKU-NBR          TO  PV-SKU-NBR       34010012
340200             ELSE                                                 34020012
340300                 MOVE SPACES                 TO  PV-SKU-DEPT      34030012
340400                                                 ASC-MERCH-DEPT   34040012
340500                                                 PV-SKU-CLASS     34050012
340600*LMM             MOVE ZEROES                 TO  PV-SKU-NBR       34060012
340700                 MOVE SPACES                 TO  PV-SKU-NBR-X     34070012
340800             END-IF                                               34080012
340900             SET PS-XL-SKU-SELECT-FND    TO TRUE                  34090012
341000                                                                  34100012
341100         WHEN XL001-SKU-SQLCODE = +100                            34110012
341200             SET PS-XL-SKU-SELECT-NOT-FND  TO TRUE                34120012
341300             MOVE SPACES                 TO  PV-SKU-DEPT          34130012
341400                                             ASC-MERCH-DEPT       34140012
341500                                             PV-SKU-CLASS         34150012
341600*LMM         MOVE ZEROES                 TO  PV-SKU-NBR           34160012
341700             MOVE SPACES                 TO  PV-SKU-NBR-X         34170012
341800                                                                  34180012
341900         WHEN XL001-SKU-SQLCODE = -904                            34190012
342000         WHEN XL001-SKU-SQLCODE = -911                            34200012
342100         WHEN XL001-SKU-SQLCODE = -913                            34210012
342200             PERFORM 9900-SOFT-ABORT                              34220012
342300                                                                  34230012
342400         WHEN XL001-INVALID-ACCESS                                34240012
342500             MOVE '4500-CALL-XLKUT-DOMAIN'                        34250012
342600                             TO DP013-PARAGRAPH                   34260012
342700             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            34270012
342800                             TO DP013-MESSAGE-TEXT (1)            34280012
342900             MOVE SHUUPC-UPC-NBR                                  34290012
343000                             TO PV-DISPLAY-UPC                    34300012
343100             MOVE PV-DISPLAY-UPC                                  34310012
343200                             TO DP013-MESSAGE-TEXT (2)            34320012
343300             MOVE SQLCA      TO DP013-SQLCA                       34330012
343400             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          34340012
343500             SET DP013-DB2-ABEND                                  34350012
343600                 DP013-XCTL-DISPLAY-RESTART                       34360012
343700                             TO TRUE                              34370012
343800             PERFORM DP013-0000-PROCESS-ABEND                     34380012
343900                                                                  34390012
344000         WHEN OTHER                                               34400012
344100             MOVE '4500-CALL-XLKUT-DOMAIN'                        34410012
344200                             TO DP013-PARAGRAPH                   34420012
344300             MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'                34430012
344400                             TO DP013-MESSAGE-TEXT (1)            34440012
344500             MOVE SHUUPC-UPC-NBR                                  34450012
344600                             TO PV-DISPLAY-UPC                    34460012
344700             MOVE PV-DISPLAY-UPC                                  34470012
344800                             TO DP013-MESSAGE-TEXT (2)            34480012
344900             MOVE XL001-SKU-SQLCODE                               34490012
345000                             TO SQLCODE                           34500012
345100             MOVE SQLCA      TO DP013-SQLCA                       34510012
345200             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          34520012
345300             SET DP013-DB2-ABEND                                  34530012
345400                 DP013-XCTL-DISPLAY-RESTART                       34540012
345500                             TO TRUE                              34550012
345600             PERFORM DP013-0000-PROCESS-ABEND                     34560012
345700     END-EVALUATE.                                                34570012
345800*----------------------------------------------------------------*34580012
345900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34590012
346000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34600012
346100* FOR THE SELECTED ITEMS QUEUE.                                  *34610012
346200*                                                                *34620012
346300* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *34630012
346400* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *34640012
346500* THE ARRAY IS FULL.                                             *34650012
346600*----------------------------------------------------------------*34660012
346700                                                                  34670012
346800 5000-PREPARE-SEL-QUEUE.                                          34680012
346900                                                                  34690012
347000     MOVE +1                   TO  ASC-BLK-SUB.                   34700012
347100     PERFORM 5100-WRITE-TEMP-STORAGE.                             34710012
347200     ADD +1                    TO  ASC-BLK-SUB.                   34720012
347300     PERFORM 5100-WRITE-TEMP-STORAGE.                             34730012
347400                                                                  34740012
347500     MOVE ASC-SEL-QUEUE-NAME-2 TO  ASC-SEL-QUEUE-NAME.            34750012
347600     MOVE ASC-SEL-QUEUE-NAME   TO  SU003-SEL-QUEUE-NAME.          34760012
347700     PERFORM 6010-DELETE-SEL-QUEUE.                               34770012
347800                                                                  34780012
347900     SET ASC-UPDATE-TSQ        TO  TRUE.                          34790012
348000                                                                  34800012
348100     SET SU004-IDX             TO  1.                             34810012
348200     MOVE ZERO                 TO SU003-NUMBER-OF-TS-ITEMS.       34820012
348300     INITIALIZE SU004-SELECTED-ITEM-ARRAY.                        34830012
348400                                                                  34840012
348500     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           34850012
348600             VARYING PV-ITEM                                      34860012
348700             FROM 1 BY 1                                          34870012
348800             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     34880012
348900                                                                  34890012
349000     IF  SU004-IDX > 1                                            34900012
349100         PERFORM 5205-WRITE-SEL-QUEUE                             34910012
349200         ADD +1                TO SU003-NUMBER-OF-TS-ITEMS        34920012
349300     END-IF.                                                      34930012
349400 EJECT                                                            34940012
349500*----------------------------------------------------------------*34950012
349600*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *34960012
349700*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *34970012
349800*----------------------------------------------------------------*34980012
349900                                                                  34990012
350000 5100-WRITE-TEMP-STORAGE.                                         35000012
350100     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35010012
350200                                   TO PV-LIST-ITEM-NUMBER.        35020012
350300     COMPUTE PV-BLOCK-NUMBER =                                    35030012
350400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35040012
350500                                                                  35050012
350600     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35060012
350700     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35070012
350800         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35080012
350900             PERFORM 5105-REWRITE-ASC-LISTQ                       35090012
351000         END-IF                                                   35100012
351100     ELSE                                                         35110012
351200         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35120012
351300         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35130012
351400         PERFORM 5110-WRITE-ASC-LISTQ                             35140012
351500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35150012
351600     END-IF.                                                      35160012
351700                                                                  35170012
351800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35180012
351900******************************************************************35190012
352000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **35200012
352100** SPECIFIC COMMAREA.                                           **35210012
352200******************************************************************35220012
352300 5105-REWRITE-ASC-LISTQ.                                          35230012
352400     EXEC CICS                                                    35240012
352500         WRITEQ TS                                                35250012
352600             QUEUE (ASC-LIST-QUEUE-NAME)                          35260012
352700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35270012
352800             ITEM  (PV-BLOCK-NUMBER)                              35280012
352900             REWRITE                                              35290012
353000             RESP  (PV-CICS-RESP)                                 35300012
353100     END-EXEC.                                                    35310012
353200                                                                  35320012
353300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35330012
353400         CONTINUE                                                 35340012
353500     ELSE                                                         35350012
353600         SET DP013-CICS-ABEND            TO TRUE                  35360012
353700         SET DP013-NO-ROLLBACK           TO TRUE                  35370012
353800         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       35380012
353900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35390012
354000                                         TO DP013-MESSAGE-TEXT(1) 35400012
354100         PERFORM DP013-0000-PROCESS-ABEND                         35410012
354200     END-IF.                                                      35420012
354300                                                                  35430012
354400******************************************************************35440012
354500** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **35450012
354600** SPECIFIC COMMAREA.                                           **35460012
354700******************************************************************35470012
354800 5110-WRITE-ASC-LISTQ.                                            35480012
354900     EXEC CICS                                                    35490012
355000         WRITEQ TS                                                35500012
355100             QUEUE (ASC-LIST-QUEUE-NAME)                          35510012
355200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35520012
355300             ITEM  (PV-BLOCK-NUMBER)                              35530012
355400             RESP  (PV-CICS-RESP)                                 35540012
355500     END-EXEC.                                                    35550012
355600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      35560012
355700         SET DP013-CICS-ABEND      TO TRUE                        35570012
355800         SET DP013-NO-ROLLBACK     TO TRUE                        35580012
355900         MOVE '5110-WRITE-ASC-LISTQ'                              35590012
356000                                   TO DP013-PARAGRAPH             35600012
356100         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           35610012
356200                                   TO DP013-MESSAGE-TEXT(1)       35620012
356300         PERFORM DP013-0000-PROCESS-ABEND                         35630012
356400     END-IF.                                                      35640012
356500 EJECT                                                            35650012
356600*----------------------------------------------------------------*35660012
356700* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *35670012
356800* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *35680012
356900*----------------------------------------------------------------*35690012
357000                                                                  35700012
357100 5200-FILL-SEL-QUEUE-RECORD.                                      35710012
357200                                                                  35720012
357300     PERFORM 6112-READ-LIST-QUEUE.                                35730012
357400                                                                  35740012
357500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       35750012
357600         PERFORM                                                  35760012
357700         VARYING LQW-IDX                                          35770012
357800         FROM 1 BY 1                                              35780012
357900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            35790012
358000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          35800012
358100                                                                  35810012
358200             IF  LQW-SELECT (LQW-IDX)                             35820012
358300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              35830012
358400                                   TO SU004-ITEM (SU004-IDX)      35840012
358500                 MOVE SPACE        TO SU004-ACTION-SW (SU004-IDX) 35850012
358600                                                                  35860012
358700                                                                  35870012
358800                 SET SU004-IDX UP BY 1                            35880012
358900                 IF  SU004-IDX > SU004-MAX-ITEMS                  35890012
359000                     PERFORM 5205-WRITE-SEL-QUEUE                 35900012
359100                     ADD +1        TO SU003-NUMBER-OF-TS-ITEMS    35910012
359200                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         35920012
359300                     SET SU004-IDX TO  1                          35930012
359400                 END-IF                                           35940012
359500             END-IF                                               35950012
359600         END-PERFORM                                              35960012
359700     END-IF.                                                      35970012
359800                                                                  35980012
359900*----------------------------------------------------------------*35990012
360000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *36000012
360100*----------------------------------------------------------------*36010012
360200                                                                  36020012
360300 5205-WRITE-SEL-QUEUE.                                            36030012
360400                                                                  36040012
360500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36050012
360600                                   TO SU004-SELECTED-ITEMS.       36060012
360700                                                                  36070012
360800     EXEC CICS                                                    36080012
360900          WRITEQ TS                                               36090012
361000              QUEUE (ASC-SEL-QUEUE-NAME)                          36100012
361100              FROM  (SU004-DC-SELECT-RECORD)                      36110012
361200              ITEM  (PV-SEL-QUEUE-ITEM)                           36120012
361300              RESP  (PV-CICS-RESP)                                36130012
361400     END-EXEC.                                                    36140012
361500                                                                  36150012
361600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36160012
361700         CONTINUE                                                 36170012
361800     ELSE                                                         36180012
361900         SET DP013-CICS-ABEND      TO TRUE                        36190012
362000         SET DP013-NO-ROLLBACK     TO TRUE                        36200012
362100         MOVE '5205-WRITE-SEL-QUEUE'                              36210012
362200                                   TO DP013-PARAGRAPH             36220012
362300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36230012
362400                                   TO DP013-MESSAGE-TEXT(1)       36240012
362500         PERFORM DP013-0000-PROCESS-ABEND                         36250012
362600     END-IF.                                                      36260012
362700 EJECT                                                            36270012
362800******************************************************************36280012
362900** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **36290012
363000** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **36300012
363100** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **36310012
363200** THE USER.                                                    **36320012
363300******************************************************************36330012
363400 6000-REFRESH-PANEL-FROM-TEMP.                                    36340012
363500     IF  ASC-UPDATE-TSQ                                           36350012
363600         SET ASC-NO-TSQ-UPDATE TO TRUE                            36360012
363700         MOVE ZERO                 TO PV-SAVE-ITEM                36370012
363800                                      PV-SEL-QUEUE-ITEM           36380012
363900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        36390012
364000                                   TO PV-HOLD-SELECTED-ITEMS      36400012
364100         MOVE +1                   TO PV-ITEMS-PROCESSED          36410012
364200         PERFORM 6100-UPDATE-TSQ                                  36420012
364300             UNTIL PV-ITEMS-PROCESSED >                           36430012
364400                                     PV-HOLD-SELECTED-ITEMS       36440012
364500         INITIALIZE ASC-BLOCK-ENTRIES (1)                         36450012
364600                    ASC-BLOCK-ENTRIES (2)                         36460012
364700     END-IF.                                                      36470012
364800                                                                  36480012
364900*----------------------------------------------------------------*36490012
365000*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *36500012
365100*----------------------------------------------------------------*36510012
365200 6010-DELETE-SEL-QUEUE.                                           36520012
365300                                                                  36530012
365400     EXEC CICS                                                    36540012
365500         DELETEQ TS                                               36550012
365600             QUEUE (ASC-SEL-QUEUE-NAME)                           36560012
365700             RESP  (PV-CICS-RESP)                                 36570012
365800     END-EXEC.                                                    36580012
365900*                                                                 36590012
366000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      36600012
366100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         36610012
366200         CONTINUE                                                 36620012
366300     ELSE                                                         36630012
366400         SET DP013-CICS-ABEND TO TRUE                             36640012
366500         SET DP013-NO-ROLLBACK TO TRUE                            36650012
366600         MOVE '6010-DELETE-SEL-QUEUE'                             36660012
366700                        TO DP013-PARAGRAPH                        36670012
366800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         36680012
366900                        TO DP013-MESSAGE-TEXT (1)                 36690012
367000         PERFORM DP013-0000-PROCESS-ABEND                         36700012
367100     END-IF.                                                      36710012
367200                                                                  36720012
367300*----------------------------------------------------------------*36730012
367400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *36740012
367500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *36750012
367600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *36760012
367700*    THE TEMP QUEUE.                                             *36770012
367800*----------------------------------------------------------------*36780012
367900                                                                  36790012
368000 6100-UPDATE-TSQ.                                                 36800012
368100                                                                  36810012
368200     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             36820012
368300     PERFORM 6105-READ-SEL-QUEUE.                                 36830012
368400     PERFORM                                                      36840012
368500         VARYING SU004-IDX                                        36850012
368600         FROM 1 BY 1                                              36860012
368700         UNTIL ((PV-ITEMS-PROCESSED >                             36870012
368800                              PV-HOLD-SELECTED-ITEMS)             36880012
368900         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             36890012
369000         IF  SU004-ACTION-SW (SU004-IDX) > SPACE                  36900012
369100             PERFORM 6110-PROCESS-ITEMS                           36910012
369200         END-IF                                                   36920012
369300         ADD +1                TO PV-ITEMS-PROCESSED              36930012
369400     END-PERFORM.                                                 36940012
369500     PERFORM 6111-WRITE-LIST-QUEUE.                               36950012
369600*----------------------------------------------------------------*36960012
369700*    READ THE LIST QUEUE RECORD.                                 *36970012
369800*----------------------------------------------------------------*36980012
369900                                                                  36990012
370000 6105-READ-SEL-QUEUE.                                             37000012
370100                                                                  37010012
370200     EXEC CICS                                                    37020012
370300          READQ TS                                                37030012
370400              QUEUE (ASC-SEL-QUEUE-NAME)                          37040012
370500              INTO  (SU004-DC-SELECT-RECORD)                      37050012
370600              ITEM  (PV-SEL-QUEUE-ITEM)                           37060012
370700              RESP  (PV-CICS-RESP)                                37070012
370800     END-EXEC.                                                    37080012
370900*                                                                 37090012
371000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37100012
371100         CONTINUE                                                 37110012
371200     ELSE                                                         37120012
371300         SET DP013-CICS-ABEND      TO  TRUE                       37130012
371400         SET DP013-NO-ROLLBACK     TO  TRUE                       37140012
371500         MOVE '6105-READ-SEL-QUEUE'                               37150012
371600                                   TO  DP013-PARAGRAPH            37160012
371700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           37170012
371800                                   TO  DP013-MESSAGE-TEXT(1)      37180012
371900         PERFORM DP013-0000-PROCESS-ABEND                         37190012
372000     END-IF.                                                      37200012
372100 EJECT                                                            37210012
372200*----------------------------------------------------------------*37220012
372300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*37230012
372400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*37240012
372500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *37250012
372600*----------------------------------------------------------------*37260012
372700                                                                  37270012
372800 6110-PROCESS-ITEMS.                                              37280012
372900                                                                  37290012
373000     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          37300012
373100                     / PC-ITEMS-PER-PANEL).                       37310012
373200                                                                  37320012
373300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           37330012
373400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          37340012
373500             PERFORM 6111-WRITE-LIST-QUEUE                        37350012
373600         END-IF                                                   37360012
373700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    37370012
373800                                                                  37380012
373900         PERFORM 6112-READ-LIST-QUEUE                             37390012
374000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               37400012
374100             CONTINUE                                             37410012
374200         END-IF                                                   37420012
374300     END-IF.                                                      37430012
374400                                                                  37440012
374500     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     37450012
374600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              37460012
374700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         37470012
374800     MOVE LQW-SELECTED-SW (PV-SUB)                                37480012
374900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  37490012
375000     EVALUATE TRUE                                                37500012
375100         WHEN SU004-INQ (SU004-IDX)                               37510012
375200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             37520012
375300                                                                  37530012
375400         WHEN SU004-UPD (SU004-IDX)                               37540012
375500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             37550012
375600                                                                  37560012
375700         WHEN SU004-DEL (SU004-IDX)                               37570012
375800              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             37580012
375900                                                                  37590012
376000         WHEN SU004-ERR (SU004-IDX)                               37600012
376100              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             37610012
376200     END-EVALUATE.                                                37620012
376300                                                                  37630012
376400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                37640012
376500                                                                  37650012
376600*----------------------------------------------------------------*37660012
376700*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *37670012
376800*----------------------------------------------------------------*37680012
376900                                                                  37690012
377000 6111-WRITE-LIST-QUEUE.                                           37700012
377100                                                                  37710012
377200     EXEC CICS                                                    37720012
377300         WRITEQ TS                                                37730012
377400             QUEUE (ASC-LIST-QUEUE-NAME)                          37740012
377500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     37750012
377600             ITEM  (PV-SAVE-ITEM)                                 37760012
377700             REWRITE                                              37770012
377800             RESP  (PV-CICS-RESP)                                 37780012
377900     END-EXEC.                                                    37790012
378000*                                                                 37800012
378100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37810012
378200         CONTINUE                                                 37820012
378300     ELSE                                                         37830012
378400         SET DP013-CICS-ABEND  TO  TRUE                           37840012
378500         SET DP013-NO-ROLLBACK TO  TRUE                           37850012
378600         MOVE '6111-WRITE-LIST-QUEUE'                             37860012
378700                               TO  DP013-PARAGRAPH                37870012
378800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  37880012
378900                               TO  DP013-MESSAGE-TEXT(1)          37890012
379000         PERFORM DP013-0000-PROCESS-ABEND                         37900012
379100     END-IF.                                                      37910012
379200                                                                  37920012
379300 EJECT                                                            37930012
379400*----------------------------------------------------------------*37940012
379500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*37950012
379600*----------------------------------------------------------------*37960012
379700                                                                  37970012
379800 6112-READ-LIST-QUEUE.                                            37980012
379900                                                                  37990012
380000     EXEC CICS                                                    38000012
380100         READQ TS                                                 38010012
380200             QUEUE (ASC-LIST-QUEUE-NAME)                          38020012
380300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     38030012
380400             ITEM  (PV-ITEM)                                      38040012
380500             RESP  (PV-CICS-RESP)                                 38050012
380600     END-EXEC.                                                    38060012
380700*                                                                 38070012
380800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38080012
380900         CONTINUE                                                 38090012
381000     ELSE                                                         38100012
381100         SET DP013-CICS-ABEND        TO TRUE                      38110012
381200         SET DP013-NO-ROLLBACK       TO TRUE                      38120012
381300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           38130012
381400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    38140012
381500                                     TO DP013-MESSAGE-TEXT(1)     38150012
381600         PERFORM DP013-0000-PROCESS-ABEND                         38160012
381700     END-IF.                                                      38170012
381800                                                                  38180012
381900                                                                  38190012
382000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 38200012
382100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *38210012
382200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 38220012
382300 9100-READ-SEL-QUEUE.                                             38230012
382400     EXEC CICS                                                    38240012
382500         READQ TS                                                 38250012
382600             QUEUE (ASC-SEL-QUEUE-NAME)                           38260012
382700             INTO  (SU004-DC-SELECT-RECORD)                       38270012
382800             ITEM  (ASC-SEL-ITEM)                                 38280012
382900             RESP  (PV-CICS-RESP)                                 38290012
383000     END-EXEC.                                                    38300012
383100     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        38310012
383200         CONTINUE                                                 38320012
383300     ELSE                                                         38330012
383400         SET DP013-LOGIC-ABEND                                    38340012
383500             DP013-NO-ROLLBACK   TO   TRUE                        38350012
383600         MOVE '9100-READ-SEL-QUEUE'                               38360012
383700                                 TO   DP013-PARAGRAPH             38370012
383800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   38380012
383900                                 TO   DP013-MESSAGE-TEXT (1)      38390012
384000         PERFORM DP013-0000-PROCESS-ABEND                         38400012
384100     END-IF.                                                      38410012
384200                                                                  38420012
384300                                                                  38430012
384400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*38440012
384500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *38450012
384600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 38460012
384700 9200-REWRITE-SEL-QUEUE.                                          38470012
384800                                                                  38480012
384900     EXEC CICS                                                    38490012
385000          WRITEQ TS                                               38500012
385100              QUEUE  (ASC-SEL-QUEUE-NAME)                         38510012
385200              FROM   (SU004-DC-SELECT-RECORD)                     38520012
385300              ITEM   (ASC-SEL-ITEM)                               38530012
385400              RESP   (PV-CICS-RESP)                               38540012
385500              REWRITE                                             38550012
385600     END-EXEC.                                                    38560012
385700                                                                  38570012
385800     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   38580012
385900         SET DP013-CICS-ABEND                                     38590012
386000             DP013-NO-ROLLBACK     TO TRUE                        38600012
386100         MOVE '9200-REWRITE-SEL-QUEUE'                            38610012
386200                                   TO DP013-PARAGRAPH             38620012
386300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   38630012
386400                                   TO DP013-MESSAGE-TEXT (1)      38640012
386500         PERFORM DP013-0000-PROCESS-ABEND                         38650012
386600     END-IF.                                                      38660012
386700                                                                  38670012
386800                                                                  38680012
386900*----------------------------------------------------------------*38690012
387000*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *38700012
387100*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *38710012
387200*----------------------------------------------------------------*38720012
387300 9900-SOFT-ABORT.                                                 38730012
387400                                                                  38740012
387500     EXEC CICS SYNCPOINT                                          38750012
387600          ROLLBACK                                                38760012
387700     END-EXEC.                                                    38770012
387800                                                                  38780012
387900     SET  PS-ERROR                                                38790012
388000          PS-SOFT-ABORT-ERROR                                     38800012
388100          DP020-MSG-FATAL       TO  TRUE.                         38810012
388200                                                                  38820012
388300                                                                  38830012
388400*----------------------------------------------------------------*38840012
388500*    ABEND PROCESSOR MODULE                                      *38850012
388600*----------------------------------------------------------------*38860012
388700                                                                  38870012
388800     COPY DPPD013.                                                38880012
