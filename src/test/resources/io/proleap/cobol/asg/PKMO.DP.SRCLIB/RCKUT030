000100 IDENTIFICATION DIVISION.                                         00010023
000200 PROGRAM-ID.    RCKUT030.                                         00020024
000300 AUTHOR.        BETH A. BILSKI.                                   00030024
000400 DATE-WRITTEN.  11/95.                                            00040024
000500****************************************************************  00050024
000600*   THIS PROGRAM WILL CREATE A FILE OF ALL VERIFIED PACK BY    *  00060024
000700*   STORE PO'S, BY LINE AND CONTAIN THE VERIFIED COUNTS ALONG  *  00070024
000800*   WITH THE ORDERED COUNTS.                                   *  00080024
000900****************************************************************  00090024
001000 ENVIRONMENT DIVISION.                                            00100024
001100 INPUT-OUTPUT SECTION.                                            00110024
001200                                                                  00120024
001300 FILE-CONTROL.                                                    00130024
001400     SELECT PBS-VE-FILE    ASSIGN TO UT-S-OUT01.                  00140024
001500     SELECT ERROR-FILE     ASSIGN TO UT-S-OUT02.                  00150024
001600                                                                  00160024
001700 DATA DIVISION.                                                   00170024
001800                                                                  00180024
001900 FILE SECTION.                                                    00190024
002000*                                                                 00200024
002100 FD  PBS-VE-FILE                                                  00210024
002200     RECORDING MODE IS F                                          00220024
002300     LABEL RECORDS ARE STANDARD                                   00230024
002400     RECORD CONTAINS 80                                           00240024
002500     BLOCK CONTAINS 0 RECORDS                                     00250024
002600     DATA RECORD IS PBS-VE-RECORD.                                00260024
002700 01  PBS-VE-RECORD               PIC X(80).                       00270024
002800*                                                                 00280024
002900 FD  ERROR-FILE                                                   00290024
003000     RECORDING MODE IS F                                          00300024
003100     LABEL RECORDS ARE STANDARD                                   00310024
003200     RECORD CONTAINS 80                                           00320024
003300     BLOCK CONTAINS 0 RECORDS                                     00330024
003400     DATA RECORD IS ERROR-RECORD.                                 00340024
003500 01  ERROR-RECORD                PIC X(80).                       00350024
003600*                                                                 00360024
003700/                                                                 00370024
003800 WORKING-STORAGE SECTION.                                         00380024
003900                                                                  00390024
004000 01  PV-ABEND-CODE                    PIC S9(04)   VALUE +0       00400024
004100                                                   COMP SYNC.     00410024
004200*                                                                 00420024
004300 01  CC-REQ-CONTROL-CARD.                                         00430024
004400     05  CC-DATE-1ONE.                                            00440024
004500         10  CC-YEAR-1                   PIC  X(04).              00450024
004600         10  CC-DASH1-1                  PIC  X(01).              00460024
004700         10  CC-MONTH-1                  PIC  X(02).              00470024
004800         10  CC-DASH2-1                  PIC  X(01).              00480024
004900         10  CC-DAY-1                    PIC  X(02).              00490024
005000     05  CC-DATE-ONE REDEFINES CC-DATE-1ONE                       00500024
005100                                         PIC  X(10).              00510024
005200     05  FILLER                          PIC  X(01).              00520024
005300     05  CC-DATE-2TWO.                                            00530024
005400         10  CC-YEAR-2                   PIC  X(04).              00540024
005500         10  CC-DASH1-2                  PIC  X(01).              00550024
005600         10  CC-MONTH-2                  PIC  X(02).              00560024
005700         10  CC-DASH2-2                  PIC  X(01).              00570024
005800         10  CC-DAY-2                    PIC  X(02).              00580024
005900     05  CC-DATE-TWO REDEFINES CC-DATE-2TWO                       00590024
006000                                         PIC  X(10).              00600024
006100                                                                  00610024
006200*                                                                 00620024
006300 01  PS-PROGRAM-SWITCHES.                                         00630024
006400     05  PS-TRECEIV-CURSOR-SW         PIC X(01)  VALUE 'N'.       00640024
006500         88  PS-EOF-TRECEIV-CSR                  VALUE 'Y'.       00650024
006600     05  PS-TRECDIS-CSR-SW            PIC X(01)  VALUE 'N'.       00660024
006700         88  PS-EOF-TRECDIS-CSR                  VALUE 'Y'.       00670024
006800     05  PS-XLT00010-CSR-SW           PIC X(01)  VALUE 'N'.       00680024
006900         88  PS-EOF-XLT00010-CSR                 VALUE 'Y'.       00690024
007000     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00700024
007100         88  PS-ERROR                            VALUE 'Y'.       00710024
007200     05  PS-PBS-DC-SW                 PIC X(01)  VALUE 'N'.       00720024
007300         88  PS-PBS-DC                           VALUE 'Y'.       00730024
007400     05  PS-NO-PBS-DC-SW              PIC X(01)  VALUE 'N'.       00740024
007500         88  PS-NO-PBS-DC                        VALUE 'Y'.       00750024
007600                                                                  00760024
007700 01  PV-PROGRAM-VARIABLES.                                        00770024
007800     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE +0        00780024
007900                                                  COMP SYNC.      00790024
008000     05  PV-RETRY-COUNT               PIC S9(04)  VALUE +0        00800024
008100                                                  COMP SYNC.      00810024
008200     05  PV-ORD-NBR                   PIC S9(09)  COMP.           00820024
008300     05  PV-REC-SEQ-NBR               PIC S9(09)  COMP.           00830024
008400     05  PV-OPER-UNT-ID               PIC S9(04)  COMP.           00840024
008500     05  PV-LNE-NBR                   PIC S9(09)  COMP.           00850024
008600     05  PV-LNE-CNT                   PIC S9(09)  COMP VALUE +0.  00860024
008700     05  PV-LNE-AMT                   PIC S9(08)V9(02) VALUE +0.  00870024
008800     05  PV-REC-SEQ-LNE-CNT           PIC S9(09)  COMP VALUE +0.  00880024
008900     05  PV-REC-SEQ-AMT               PIC S9(08)V9(02) VALUE +0.  00890024
009000                                                                  00900024
009100     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACES.   00910024
009200     05  PV-ERROR-MESSAGE-1           PIC  X(60)  VALUE SPACES.   00920024
009300     05  PV-ERROR-MESSAGE-2           PIC  X(60)  VALUE SPACES.   00930024
009400     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.       00940024
009500                                                                  00950024
009600 01  PV-ERROR-RECORD.                                             00960024
009700     05  PV-ERROR-PO                  PIC S9(09) COMP             00970024
009800                                                 VALUE ZEROES.    00980024
009900     05  FILLER                       PIC X(76)  VALUE SPACES.    00990024
010000                                                                  01000024
010100 01  PC-PROGRAM-CONSTANTS.                                        01010024
010200     05  PC-PROGRAM-NAME             PIC X(08)  VALUE 'RCKUT030'. 01020024
010300     05  PC-MAX-RETRIES              PIC S9(04) VALUE +3          01030024
010400                                                COMP SYNC.        01040024
010500     05  PC-DEFAULT-DATE             PIC X(26)   VALUE            01050024
010600                                   '9999-09-09-09.09.09.999999'.  01060024
010700     05  PC-DEFAULT-MESSAGE          PIC  X(50)    VALUE          01070024
010800         'RECEIV-VERFYD-TMST = 9999-09-09-09.09.09.999999 '.      01080024
010900                                                                  01090024
011000 01  PV-ABEND-FIELDS.                                             01100024
011100     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'RCKUT030'.01110024
011200     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01120024
011300     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01130024
011400     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01140024
011500     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01150024
011600     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01160024
011700     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    01170024
011800     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01180024
011900     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01190024
012000     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01200024
012100     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01210024
012200                                                                  01220024
012300 01  STORE-TABLE.                                                 01230024
012400     05  STR-TABLE       OCCURS 50 TIMES                          01240024
012500                         INDEXED BY STR-IDX.                      01250024
012600         10 STR-NMBR                  PIC  9(04).                 01260024
012700                                                                  01270024
012800*                                                                 01280024
012900     COPY RCRD050.                                                01290024
013000*                                                                 01300024
013100                                                                  01310024
013200******************************************************************01320024
013300*  USED FOR DB2 ERROR MESSAGE BUILDING                            01330024
013400******************************************************************01340024
013500     COPY DPWS004.                                                01350024
013600*                                                                 01360024
013700/                                                                 01370024
013800******************************************************************01380024
013900*   DB2 SQL COMMUNICATION AREA                                    01390024
014000******************************************************************01400024
014100     EXEC SQL                                                     01410024
014200          INCLUDE SQLCA                                           01420024
014300     END-EXEC.                                                    01430024
014400                                                                  01440024
014500******************************************************************01450024
014600*   DB2 DCLGEN FOR RECEIVER TABLE                                 01460024
014700******************************************************************01470024
014800     EXEC SQL                                                     01480024
014900          INCLUDE TRECEIV                                         01490024
015000     END-EXEC.                                                    01500024
015100                                                                  01510024
015200******************************************************************01520024
015300*   DB2 DCLGEN FOR RECEIVER ITEM TABLE                            01530024
015400******************************************************************01540024
015500     EXEC SQL                                                     01550024
015600          INCLUDE TRECITM                                         01560024
015700     END-EXEC.                                                    01570024
015800                                                                  01580024
015900******************************************************************01590024
016000*   DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                    01600024
016100******************************************************************01610024
016200     EXEC SQL                                                     01620024
016300          INCLUDE TRECDIS                                         01630024
016400     END-EXEC.                                                    01640024
016500                                                                  01650024
016600******************************************************************01660024
016700*  DCLGEN FOR THE DB2 PURCHASE ORDER LINE ITEM TABLE              01670024
016800******************************************************************01680024
016900     EXEC SQL                                                     01690024
017000         INCLUDE TPURITM                                          01700024
017100     END-EXEC.                                                    01710024
017200                                                                  01720024
017300                                                                  01730024
017400******************************************************************01740024
017500*  DCLGEN FOR THE DB2 LOCATION TABLE - XLT_LOC                    01750024
017600******************************************************************01760024
017700     EXEC SQL                                                     01770024
017800         INCLUDE XLT00010                                         01780024
017900     END-EXEC.                                                    01790024
018000                                                                  01800024
018100******************************************************************01810024
018200*  XLT00010 CURSOR                                                01820024
018300******************************************************************01830024
018400     EXEC SQL                                                     01840024
018500          DECLARE XLT00010-CSR CURSOR WITH HOLD FOR               01850024
018600           SELECT LOC_NBR                                         01860024
018700           FROM   XLT_LOC                                         01870024
018800          WHERE LOC_TYP_CDE = 'DC'                                01880024
018900     END-EXEC.                                                    01890024
019000                                                                  01900024
019100******************************************************************01910024
019200* TRECEIV CURSOR                                                 *01920024
019300******************************************************************01930024
019400     EXEC SQL                                                     01940024
019500          DECLARE TRECEIV-CSR CURSOR WITH HOLD FOR                01950024
019600           SELECT A.ORD_NBR                                       01960024
019700                 ,A.REC_SEQ_NBR                                   01970024
019800                 ,A.OPER_UNT_ID                                   01980024
019900                 ,A.PACK_BY_ST_IND                                01990024
020000                 ,A.VERFYD_TMST                                   02000024
020100                 ,A.CRE_OPER_UNT_ID                               02010024
020200           FROM   TRECEIV A                                       02020024
020300                 ,XLT_LOC C                                       02030024
020400           WHERE  A.STATUS_CDE       = 'VE'                       02040024
020500           AND  (DATE(A.VERFYD_TMST) BETWEEN                      02050024
020600                                    DATE(:CC-DATE-ONE)            02060024
020700                               AND  DATE(:CC-DATE-TWO))           02070024
020800           AND  A.VER_STATUS_CDE     = 'A'                        02080024
020900           AND  A.CRE_OPER_UNT_ID   = C.LOC_NBR                   02090024
021000           AND  C.LOC_TYP_CDE        =  'DC'                      02100024
021100           AND EXISTS                                             02110024
021200              (SELECT 1                                           02120024
021300               FROM   TRECEIV B                                   02130024
021400              WHERE  A.ORD_NBR = B.ORD_NBR                        02140024
021500                AND  B.PACK_BY_ST_IND     = 'Y')                  02150024
021600           ORDER BY ORD_NBR                                       02160024
021700                   ,REC_SEQ_NBR                                   02170024
021800                   ,CRE_OPER_UNT_ID                               02180024
021900     END-EXEC.                                                    02190024
022000                                                                  02200024
022100*                                                                 02210024
022200******************************************************************02220024
022300*  TRECITM CURSOR                                                *02230024
022400******************************************************************02240024
022500     EXEC SQL                                                     02250024
022600          DECLARE TRECDIS-CSR CURSOR WITH HOLD FOR                02260024
022700           SELECT ORD_NBR                                         02270024
022800                 ,ORD_LNE_NBR                                     02280024
022900                 ,REC_SEQ_NBR                                     02290024
023000                 ,OPER_UNT_ID                                     02300024
023100                 ,AP_VERIFY_ITM_QTY                               02310024
023200           FROM   TRECDIS                                         02320024
023300           WHERE  ORD_NBR            = :PV-ORD-NBR                02330024
023400              AND REC_SEQ_NBR        = :PV-REC-SEQ-NBR            02340024
023600              AND OPER_UNT_ID        = :PV-OPER-UNT-ID            02360024
023700           ORDER BY REC_SEQ_NBR                                   02370024
023800                   ,ORD_LNE_NBR                                   02380024
023900     END-EXEC.                                                    02390024
024000                                                                  02400024
024100*                                                                 02410024
024200***********************************************************       02420024
024300*  INCLUDE BOOK USED BY MBS SYSTEM                        *       02430024
024400***********************************************************       02440024
024500     COPY DPWS003.                                                02450024
024600*                                                                 02460024
024700/                                                                 02470024
024800 PROCEDURE DIVISION.                                              02480024
024900                                                                  02490024
025000     OPEN OUTPUT PBS-VE-FILE                                      02500024
025100                 ERROR-FILE.                                      02510024
025200                                                                  02520024
025300     ACCEPT CC-REQ-CONTROL-CARD.                                  02530024
025400     IF  CC-YEAR-1   NOT NUMERIC                                  02540024
025500      OR CC-MONTH-1  NOT NUMERIC                                  02550024
025600      OR CC-DAY-1    NOT NUMERIC                                  02560024
025700      OR CC-YEAR-2   NOT NUMERIC                                  02570024
025800      OR CC-MONTH-2  NOT NUMERIC                                  02580024
025900      OR CC-DAY-2    NOT NUMERIC                                  02590024
026000         MOVE 'RUN DATES NOT NUMERIC:'                            02600024
026100                                TO PV-ERROR-MESSAGE-1             02610024
026200         MOVE CC-REQ-CONTROL-CARD                                 02620024
026300                                TO PV-ERROR-MESSAGE-2             02630024
026400         PERFORM 9200-ABEND                                       02640024
026500     ELSE                                                         02650024
026600         MOVE '-'                TO CC-DASH1-1                    02660024
026700                                    CC-DASH2-1                    02670024
026800                                    CC-DASH1-2                    02680024
026900                                    CC-DASH2-2                    02690024
027000     END-IF.                                                      02700024
027100                                                                  02710024
027200     INITIALIZE STORE-TABLE.                                      02720024
027300     PERFORM 7600-OPEN-XLT00010-CSR.                              02730024
027400     PERFORM 7610-FETCH-XLT00010-CSR.                             02740024
027500     PERFORM 0100-PROCESS-STR-TABLE                               02750024
027600        VARYING STR-IDX FROM 1 BY 1                               02760024
027700         UNTIL PS-EOF-XLT00010-CSR                                02770024
027800            OR STR-IDX > 50.                                      02780024
027900     PERFORM 7620-CLOSE-XLT00010-CSR.                             02790024
028000                                                                  02800024
028100     PERFORM 7000-OPEN-TRECEIV-CURSOR.                            02810024
028200     SET STR-IDX TO 1.                                            02820024
028300     PERFORM 7100-FETCH-TRECEIV-CSR                               02830024
028400         UNTIL PS-PBS-DC                                          02840024
028500            OR PS-EOF-TRECEIV-CSR.                                02850024
028600     MOVE 'N' TO PS-PBS-DC-SW.                                    02860024
028700                                                                  02870024
028800     PERFORM 1000-PROCESS-EXTRACTS                                02880024
028900         UNTIL PS-EOF-TRECEIV-CSR.                                02890024
029000                                                                  02900024
029100     PERFORM 7200-CLOSE-TRECEIV-CSR.                              02910024
029200                                                                  02920024
029300     CLOSE PBS-VE-FILE                                            02930024
029400           ERROR-FILE.                                            02940024
029500                                                                  02950024
029600     GOBACK.                                                      02960024
029700                                                                  02970024
029800/                                                                 02980024
029900 0100-PROCESS-STR-TABLE.                                          02990024
030000     MOVE XLT00010-LOC-NBR    TO STR-NMBR (STR-IDX).              03000024
030100     PERFORM 7610-FETCH-XLT00010-CSR.                             03010024
030200/                                                                 03020024
030300 1000-PROCESS-EXTRACTS.                                           03030024
030400                                                                  03040024
030500     INITIALIZE RC050-RECORD.                                     03050024
030600     MOVE RECEIV-ORD-NBR      TO RC050-PO-NBR                     03060024
030700                                 PV-ORD-NBR.                      03070024
030800     MOVE RECEIV-REC-SEQ-NBR  TO RC050-REC-SEQ-NBR                03080024
030900                                 PV-REC-SEQ-NBR.                  03090024
031000     MOVE PV-OPER-UNT-ID      TO RC050-OPER-ID.                   03100024
031100                                                                  03110024
031200     PERFORM 7500-OPEN-TRECDIS-CSR.                               03120024
031300     PERFORM 7510-FETCH-TRECDIS-CSR.                              03130024
031400     MOVE +0 TO PV-REC-SEQ-LNE-CNT                                03140024
031500                PV-REC-SEQ-AMT.                                   03150024
031600                                                                  03160024
031700     IF  PS-EOF-TRECDIS-CSR                                       03170024
031800         MOVE 'N' TO  PS-TRECDIS-CSR-SW                           03180024
031900         PERFORM 7520-CLOSE-TRECDIS-CSR                           03190024
032000     ELSE                                                         03200024
032100         MOVE RECDIS-ORD-LNE-NBR TO PV-LNE-NBR                    03210024
032200         PERFORM 2000-TRECDIS                                     03220024
032300             UNTIL  PS-EOF-TRECDIS-CSR                            03230024
032400         PERFORM 3000-TRECITM-GET                                 03240024
032500         IF  PS-ERROR                                             03250024
032600             MOVE 'N' TO PS-ERROR-SW                              03260024
032700             MOVE PV-ORD-NBR TO PV-ERROR-PO                       03270024
032800             PERFORM 5600-WRITE-ERROR                             03280024
032900             MOVE PV-REC-SEQ-LNE-CNT TO RC050-TRECDIS-QTY         03290024
033000             MOVE PV-REC-SEQ-AMT     TO RC050-TRECDIS-AMT         03300024
033100             PERFORM 5400-WRITE-PBS                               03310024
033200             MOVE 'N' TO  PS-TRECDIS-CSR-SW                       03320024
033300             PERFORM 7520-CLOSE-TRECDIS-CSR                       03330024
033400         ELSE                                                     03340024
033500             PERFORM 4000-GET-TPURITM                             03350024
033600             MOVE PV-REC-SEQ-LNE-CNT TO RC050-TRECDIS-QTY         03360024
033700             MOVE PV-REC-SEQ-AMT     TO RC050-TRECDIS-AMT         03370024
033800             PERFORM 5400-WRITE-PBS                               03380024
033900             MOVE 'N' TO  PS-TRECDIS-CSR-SW                       03390024
034000             PERFORM 7520-CLOSE-TRECDIS-CSR                       03400024
034100         END-IF                                                   03410024
034200     END-IF.                                                      03420024
034300                                                                  03430024
034400     MOVE 'N' TO PS-PBS-DC-SW.                                    03440024
034500     SET STR-IDX TO 1.                                            03450024
034600     PERFORM 7100-FETCH-TRECEIV-CSR                               03460024
034700         UNTIL PS-PBS-DC                                          03470024
034800            OR PS-EOF-TRECEIV-CSR.                                03480024
034900                                                                  03490024
035000**                                                                03500024
035100/                                                                 03510024
035200 2000-TRECDIS.                                                    03520024
035300     IF  RECDIS-ORD-LNE-NBR = PV-LNE-NBR                          03530024
035400         ADD RECDIS-AP-VERIFY-ITM-QTY TO PV-LNE-CNT               03540024
035500                                         PV-REC-SEQ-LNE-CNT       03550024
035600         PERFORM 7510-FETCH-TRECDIS-CSR                           03560024
035700     ELSE                                                         03570024
035800         PERFORM 3000-TRECITM-GET                                 03580024
035900         IF  PS-ERROR                                             03590024
036000             MOVE 'N' TO PS-ERROR-SW                              03600024
036100             MOVE PV-ORD-NBR TO PV-ERROR-PO                       03610024
036200             PERFORM 5600-WRITE-ERROR                             03620024
036300             MOVE RECDIS-ORD-LNE-NBR TO PV-LNE-NBR                03630024
036400         ELSE                                                     03640024
036500             PERFORM 4000-GET-TPURITM                             03650024
036600             MOVE RECDIS-ORD-LNE-NBR TO PV-LNE-NBR                03660024
036700         END-IF                                                   03670024
036800     END-IF.                                                      03680024
036900                                                                  03690024
037000/                                                                 03700024
037100 3000-TRECITM-GET.                                                03710024
037200     PERFORM                                                      03720024
037300         WITH TEST AFTER                                          03730024
037400         VARYING PV-RETRY-COUNT                                   03740024
037500         FROM 1 BY 1                                              03750024
037600         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 03760024
037700             OR (SQLCODE = +0)                                    03770024
037800             OR (SQLCODE = +100))                                 03780024
037900                                                                  03790024
038000**                                                                03800024
038100         EXEC SQL                                                 03810024
038200              SELECT PO_VER_NBR                                   03820024
038300              INTO   :RECITM-PO-VER-NBR                           03830024
038400                                                                  03840024
038500              FROM  TRECITM                                       03850024
038600              WHERE ORD_NBR        = :PV-ORD-NBR                  03860024
038700                AND ORD_LNE_NBR    = :PV-LNE-NBR                  03870024
038800                AND REC_SEQ_NBR    = :PV-REC-SEQ-NBR              03880024
038900                AND VER_STATUS_CDE = 'A'                          03890024
039000                AND OPER_UNT_ID    = :PV-OPER-UNT-ID              03900024
039100         END-EXEC                                                 03910024
039200                                                                  03920024
039300         EVALUATE TRUE                                            03930024
039400             WHEN SQLCODE = ZERO                                  03940024
039500                 CONTINUE                                         03950024
039600             WHEN SQLCODE = +100                                  03960024
039700                  SET PS-ERROR TO TRUE                            03970024
039800                  DISPLAY 'PO          = ' PV-ORD-NBR             03980024
039900                  DISPLAY 'REC-SEQ-NBR = ' PV-REC-SEQ-NBR         03990024
040000                  DISPLAY 'LEN-NBR     = ' PV-LNE-NBR             04000024
040100             WHEN OTHER                                           04010024
040200                  MOVE '3000-TRECITM-GET'                         04020024
040300                               TO PV-ABEND-PARAGRAPH              04030024
040400                  MOVE 'SELECT TRECITM CURSOR'                    04040024
040500                               TO PV-ABEND-OPERATION              04050024
040600                  MOVE 'TRECITM'   TO PV-ABEND-STRUCTURE-1        04060024
040700                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        04070024
040800*                 MOVE 'CURRENT PO BEING PROCESSED ID:         '  04080024
040900*                                TO PV-DB2-OPERATION-MESSAGE-1    04090024
041000                  MOVE PV-ORD-NBR                                 04100024
041100                                 TO PV-DB2-OPERATION-MESSAGE-1    04110024
041200                  MOVE PV-REC-SEQ-NBR                             04120024
041300                                   TO PV-DB2-OPERATION-MESSAGE-2  04130024
041400                  MOVE PV-LNE-NBR                                 04140024
041500                                   TO PV-DB2-OPERATION-MESSAGE-3  04150024
041600                  PERFORM 9900-DB2-ABEND                          04160024
041700         END-EVALUATE                                             04170024
041800     END-PERFORM.                                                 04180024
041900                                                                  04190024
042000     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          04200024
042100         MOVE '3000-RECITM-GET'                                   04210024
042200                                 TO PV-ABEND-PARAGRAPH            04220024
042300         MOVE 'MAX RETRIES EXCEEDED'                              04230024
042400                                 TO PV-ABEND-OPERATION            04240024
042500         PERFORM 9900-DB2-ABEND                                   04250024
042600     END-IF.                                                      04260024
042700                                                                  04270024
042800/                                                                 04280024
042900 4000-GET-TPURITM.                                                04290024
043000     PERFORM                                                      04300024
043100         WITH TEST AFTER                                          04310024
043200         VARYING PV-RETRY-COUNT                                   04320024
043300         FROM 1 BY 1                                              04330024
043400         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 04340024
043500             OR (SQLCODE = +0)                                    04350024
043600             OR (SQLCODE = +100))                                 04360024
043700                                                                  04370024
043800**                                                                04380024
043900         EXEC SQL                                                 04390024
044000              SELECT UNT_RTL_PR_AMT                               04400024
044100              INTO   :PURITM-UNT-RTL-PR-AMT                       04410024
044200                                                                  04420024
044300              FROM  TPURITM                                       04430024
044400              WHERE PO_NBR         = :PV-ORD-NBR                  04440024
044500                AND VER_NBR        = :RECITM-PO-VER-NBR           04450024
044600                AND APP_PO_LNE_NBR = :PV-LNE-NBR                  04460024
044700         END-EXEC                                                 04470024
044800                                                                  04480024
044900         EVALUATE TRUE                                            04490024
045000             WHEN SQLCODE = ZERO                                  04500024
045100                 COMPUTE PV-LNE-AMT = PURITM-UNT-RTL-PR-AMT *     04510024
045200                                      PV-LNE-CNT                  04520024
045300                 ADD PV-LNE-AMT TO PV-REC-SEQ-AMT                 04530024
045400                 MOVE ZEROES TO PV-LNE-AMT                        04540024
045500                                PV-LNE-CNT                        04550024
045600             WHEN SQLCODE = +100                                  04560024
045700                 MOVE ZEROES TO PV-LNE-AMT                        04570024
045800                                PV-LNE-CNT                        04580024
045900             WHEN OTHER                                           04590024
046000                  MOVE '4000-GET-TPURITM'                         04600024
046100                               TO PV-ABEND-PARAGRAPH              04610024
046200                  MOVE 'SELECT TPURITM'                           04620024
046300                               TO PV-ABEND-OPERATION              04630024
046400                  MOVE 'TPURITM'   TO PV-ABEND-STRUCTURE-1        04640024
046500                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        04650024
046600                  MOVE 'CURRENT PO BEING PROCESSED ID:         '  04660024
046700                                 TO PV-DB2-OPERATION-MESSAGE-1    04670024
046800                  MOVE PV-ORD-NBR                                 04680024
046900                                   TO PV-DB2-OPERATION-MESSAGE-2  04690024
047000                  PERFORM 9900-DB2-ABEND                          04700024
047100         END-EVALUATE                                             04710024
047200     END-PERFORM.                                                 04720024
047300                                                                  04730024
047400     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          04740024
047500         MOVE '4000-GET-TPURITM'                                  04750024
047600                                 TO PV-ABEND-PARAGRAPH            04760024
047700         MOVE 'MAX RETRIES EXCEEDED'                              04770024
047800                                 TO PV-ABEND-OPERATION            04780024
047900         PERFORM 9900-DB2-ABEND                                   04790024
048000     END-IF.                                                      04800024
048100                                                                  04810024
048200/                                                                 04820024
048300/                                                                 04830024
048400 5400-WRITE-PBS.                                                  04840024
048500      WRITE PBS-VE-RECORD   FROM RC050-RECORD.                    04850024
048600 5600-WRITE-ERROR.                                                04860024
048700      WRITE ERROR-RECORD    FROM PV-ERROR-RECORD.                 04870024
048800/                                                                 04880024
048900                                                                  04890024
049000 7000-OPEN-TRECEIV-CURSOR.                                        04900024
049100     PERFORM                                                      04910024
049200         WITH TEST AFTER                                          04920024
049300         VARYING PV-RETRY-COUNT                                   04930024
049400         FROM 1 BY 1                                              04940024
049500         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 04950024
049600            OR  (SQLCODE = +0))                                   04960024
049700                                                                  04970024
049800         EXEC SQL                                                 04980024
049900             OPEN TRECEIV-CSR                                     04990024
050000         END-EXEC                                                 05000024
050100                                                                  05010024
050200         EVALUATE TRUE                                            05020024
050300             WHEN SQLCODE = +0                                    05030024
050400             WHEN SQLCODE = -904                                  05040024
050500             WHEN SQLCODE = -913                                  05050024
050600                  CONTINUE                                        05060024
050700             WHEN SQLWARN0 NOT = SPACE                            05070024
050800             WHEN SQLCODE  NOT = +0                               05080024
050900                  MOVE '7000-OPEN-TRECEIV-CURSOR'                 05090024
051000                                 TO PV-ABEND-PARAGRAPH            05100024
051100                  MOVE 'OPEN TRECEIV CURSOR'                      05110024
051200                                 TO PV-ABEND-OPERATION            05120024
051300                  MOVE 'TRECIEV'   TO PV-ABEND-STRUCTURE-1        05130024
051400                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        05140024
051500                  PERFORM 9900-DB2-ABEND                          05150024
051600         END-EVALUATE                                             05160024
051700     END-PERFORM.                                                 05170024
051800                                                                  05180024
051900     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          05190024
052000         MOVE '7000-OPEN-TRECEIV-CURSOR'                          05200024
052100                                 TO PV-ABEND-PARAGRAPH            05210024
052200         MOVE 'MAX RETRIES EXCEEDED'                              05220024
052300                                 TO PV-ABEND-OPERATION            05230024
052400         PERFORM 9900-DB2-ABEND                                   05240024
052500     END-IF.                                                      05250024
052600                                                                  05260024
052700 7100-FETCH-TRECEIV-CSR.                                          05270024
052800                                                                  05280024
052900     EXEC SQL                                                     05290024
053000          FETCH TRECEIV-CSR                                       05300024
053100           INTO   :RECEIV-ORD-NBR                                 05310024
053200                 ,:RECEIV-REC-SEQ-NBR                             05320024
053300                 ,:PV-OPER-UNT-ID                                 05330024
053400                 ,:RECEIV-PACK-BY-ST-IND                          05340024
053500                 ,:RECEIV-VERFYD-TMST                             05350024
053600                 ,:RECEIV-CRE-OPER-UNT-ID                         05360024
053700     END-EXEC.                                                    05370024
053800                                                                  05380024
053900     EVALUATE TRUE                                                05390024
054000         WHEN SQLCODE = +0                                        05400024
054100              SET STR-IDX TO 1                                    05410024
054200              PERFORM 7999-SEARCH-STORE-TABLE                     05420024
054300         WHEN SQLCODE = +100                                      05430024
054400              SET PS-EOF-TRECEIV-CSR TO TRUE                      05440024
054500         WHEN SQLWARN0 NOT = SPACE                                05450024
054600         WHEN SQLCODE  NOT = +0                                   05460024
054700              MOVE '7100-FETCH-TRECEIV-CSR'                       05470024
054800                                   TO PV-ABEND-PARAGRAPH          05480024
054900              MOVE 'FETCH TRECEIV CURSOR'                         05490024
055000                                   TO PV-ABEND-OPERATION          05500024
055100              MOVE 'TRECEIV'       TO PV-ABEND-STRUCTURE-1        05510024
055200              MOVE SPACES          TO PV-ABEND-STRUCTURE-2        05520024
055300              PERFORM 9900-DB2-ABEND                              05530024
055400     END-EVALUATE.                                                05540024
055500                                                                  05550024
055600 7200-CLOSE-TRECEIV-CSR.                                          05560024
055700                                                                  05570024
055800     PERFORM                                                      05580024
055900         WITH TEST AFTER                                          05590024
056000         VARYING PV-RETRY-COUNT                                   05600024
056100         FROM 1 BY 1                                              05610024
056200         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 05620024
056300            OR  (SQLCODE = +0))                                   05630024
056400                                                                  05640024
056500            EXEC SQL                                              05650024
056600                CLOSE TRECEIV-CSR                                 05660024
056700            END-EXEC                                              05670024
056800                                                                  05680024
056900            EVALUATE TRUE                                         05690024
057000                WHEN SQLCODE = 0                                  05700024
057100                    CONTINUE                                      05710024
057200                WHEN SQLCODE = -911                               05720024
057300                WHEN SQLCODE = -904                               05730024
057400                    CONTINUE                                      05740024
057500                WHEN SQLCODE  NOT = +0                            05750024
057600                     MOVE '7200-CLOSE-TRECEIV-CSR'                05760024
057700                                  TO PV-ABEND-PARAGRAPH           05770024
057800                     MOVE 'CLOSE TRECEIV CURSOR'                  05780024
057900                                  TO PV-ABEND-OPERATION           05790024
058000                     MOVE 'TRECIEV'   TO PV-ABEND-STRUCTURE-1     05800024
058100                     MOVE SPACES      TO PV-ABEND-STRUCTURE-2     05810024
058200                     PERFORM 9900-DB2-ABEND                       05820024
058300            END-EVALUATE                                          05830024
058400                                                                  05840024
058500     END-PERFORM.                                                 05850024
058600                                                                  05860024
058700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          05870024
058800         MOVE '7200-CLOSE-TRECEIV-CSR'                            05880024
058900                                 TO PV-ABEND-PARAGRAPH            05890024
059000         MOVE 'MAX RETRIES EXCEEDED'                              05900024
059100                                 TO PV-ABEND-OPERATION            05910024
059200         PERFORM 9900-DB2-ABEND                                   05920024
059300     END-IF.                                                      05930024
059400                                                                  05940024
059500 7500-OPEN-TRECDIS-CSR.                                           05950024
059600     PERFORM                                                      05960024
059700         WITH TEST AFTER                                          05970024
059800         VARYING PV-RETRY-COUNT                                   05980024
059900         FROM 1 BY 1                                              05990024
060000         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 06000024
060100            OR  (SQLCODE = +0))                                   06010024
060200                                                                  06020024
060300         EXEC SQL                                                 06030024
060400             OPEN TRECDIS-CSR                                     06040024
060500         END-EXEC                                                 06050024
060600                                                                  06060024
060700         EVALUATE TRUE                                            06070024
060800             WHEN SQLCODE = +0                                    06080024
060900             WHEN SQLCODE = -904                                  06090024
061000             WHEN SQLCODE = -913                                  06100024
061100                  CONTINUE                                        06110024
061200             WHEN SQLWARN0 NOT = SPACE                            06120024
061300             WHEN SQLCODE  NOT = +0                               06130024
061400                  MOVE '7500-OPEN-TRECDIS-CURSOR'                 06140024
061500                                 TO PV-ABEND-PARAGRAPH            06150024
061600                  MOVE 'OPEN TRECDIS CURSOR'                      06160024
061700                                 TO PV-ABEND-OPERATION            06170024
061800                  MOVE 'TRECDIS'   TO PV-ABEND-STRUCTURE-1        06180024
061900                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        06190024
062000                  PERFORM 9900-DB2-ABEND                          06200024
062100         END-EVALUATE                                             06210024
062200     END-PERFORM.                                                 06220024
062300                                                                  06230024
062400     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          06240024
062500         MOVE '7500-OPEN-TRECDIS-CURSOR'                          06250024
062600                                 TO PV-ABEND-PARAGRAPH            06260024
062700         MOVE 'MAX RETRIES EXCEEDED'                              06270024
062800                                 TO PV-ABEND-OPERATION            06280024
062900         PERFORM 9900-DB2-ABEND                                   06290024
063000     END-IF.                                                      06300024
063100                                                                  06310024
063200 7510-FETCH-TRECDIS-CSR.                                          06320024
063300                                                                  06330024
063400     EXEC SQL                                                     06340024
063500          FETCH TRECDIS-CSR                                       06350024
063600           INTO   :RECDIS-ORD-NBR                                 06360024
063700                 ,:RECDIS-ORD-LNE-NBR                             06370024
063800                 ,:RECDIS-REC-SEQ-NBR                             06380024
063900                 ,:RECDIS-OPER-UNT-ID                             06390024
064000                 ,:RECDIS-AP-VERIFY-ITM-QTY                       06400024
064100     END-EXEC.                                                    06410024
064200                                                                  06420024
064300     EVALUATE TRUE                                                06430024
064400         WHEN SQLCODE = +0                                        06440024
064500              CONTINUE                                            06450024
064600         WHEN SQLCODE = +100                                      06460024
064700              SET  PS-EOF-TRECDIS-CSR TO TRUE                     06470024
064800         WHEN SQLWARN0 NOT = SPACE                                06480024
064900         WHEN SQLCODE  NOT = +0                                   06490024
065000              MOVE '7510-FETCH-TRECDIS-CSR'                       06500024
065100                                   TO PV-ABEND-PARAGRAPH          06510024
065200              MOVE 'FETCH TRECDIS CURSOR'                         06520024
065300                                   TO PV-ABEND-OPERATION          06530024
065400              MOVE 'TRECDIS'       TO PV-ABEND-STRUCTURE-1        06540024
065500              MOVE SPACES          TO PV-ABEND-STRUCTURE-2        06550024
065600              PERFORM 9900-DB2-ABEND                              06560024
065700     END-EVALUATE.                                                06570024
065800                                                                  06580024
065900 7520-CLOSE-TRECDIS-CSR.                                          06590024
066000                                                                  06600024
066100     PERFORM                                                      06610024
066200         WITH TEST AFTER                                          06620024
066300         VARYING PV-RETRY-COUNT                                   06630024
066400         FROM 1 BY 1                                              06640024
066500         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 06650024
066600            OR  (SQLCODE = +0))                                   06660024
066700                                                                  06670024
066800            EXEC SQL                                              06680024
066900                CLOSE TRECDIS-CSR                                 06690024
067000            END-EXEC                                              06700024
067100                                                                  06710024
067200            EVALUATE TRUE                                         06720024
067300                WHEN SQLCODE = 0                                  06730024
067400                    CONTINUE                                      06740024
067500                WHEN SQLCODE = -911                               06750024
067600                WHEN SQLCODE = -904                               06760024
067700                    CONTINUE                                      06770024
067800                WHEN SQLCODE  NOT = +0                            06780024
067900                     MOVE '7520-CLOSE-TRECDIS-CSR'                06790024
068000                                  TO PV-ABEND-PARAGRAPH           06800024
068100                     MOVE 'CLOSE TRECDIS CURSOR'                  06810024
068200                                  TO PV-ABEND-OPERATION           06820024
068300                     MOVE 'TRECDIS'   TO PV-ABEND-STRUCTURE-1     06830024
068400                     MOVE SPACES      TO PV-ABEND-STRUCTURE-2     06840024
068500                     PERFORM 9900-DB2-ABEND                       06850024
068600            END-EVALUATE                                          06860024
068700                                                                  06870024
068800     END-PERFORM.                                                 06880024
068900                                                                  06890024
069000     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          06900024
069100         MOVE '7520-CLOSE-TRECDIS-CSR'                            06910024
069200                                 TO PV-ABEND-PARAGRAPH            06920024
069300         MOVE 'MAX RETRIES EXCEEDED'                              06930024
069400                                 TO PV-ABEND-OPERATION            06940024
069500         PERFORM 9900-DB2-ABEND                                   06950024
069600     END-IF.                                                      06960024
069700                                                                  06970024
069800 7600-OPEN-XLT00010-CSR.                                          06980024
069900     PERFORM                                                      06990024
070000         WITH TEST AFTER                                          07000024
070100         VARYING PV-RETRY-COUNT                                   07010024
070200         FROM 1 BY 1                                              07020024
070300         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 07030024
070400            OR  (SQLCODE = +0))                                   07040024
070500                                                                  07050024
070600         EXEC SQL                                                 07060024
070700             OPEN XLT00010-CSR                                    07070024
070800         END-EXEC                                                 07080024
070900                                                                  07090024
071000         EVALUATE TRUE                                            07100024
071100             WHEN SQLCODE = +0                                    07110024
071200             WHEN SQLCODE = -904                                  07120024
071300             WHEN SQLCODE = -913                                  07130024
071400                  CONTINUE                                        07140024
071500             WHEN SQLWARN0 NOT = SPACE                            07150024
071600             WHEN SQLCODE  NOT = +0                               07160024
071700                  MOVE '7600-OPEN-XLT00010-CURSOR'                07170024
071800                                 TO PV-ABEND-PARAGRAPH            07180024
071900                  MOVE 'OPEN XLT00010 CURSOR'                     07190024
072000                                 TO PV-ABEND-OPERATION            07200024
072100                  MOVE 'XLT_LOC '  TO PV-ABEND-STRUCTURE-1        07210024
072200                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        07220024
072300                  PERFORM 9900-DB2-ABEND                          07230024
072400         END-EVALUATE                                             07240024
072500     END-PERFORM.                                                 07250024
072600                                                                  07260024
072700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          07270024
072800         MOVE '7600-OPEN-XLT00010-CURSOR'                         07280024
072900                                 TO PV-ABEND-PARAGRAPH            07290024
073000         MOVE 'MAX RETRIES EXCEEDED'                              07300024
073100                                 TO PV-ABEND-OPERATION            07310024
073200         PERFORM 9900-DB2-ABEND                                   07320024
073300     END-IF.                                                      07330024
073400                                                                  07340024
073500 7610-FETCH-XLT00010-CSR.                                         07350024
073600                                                                  07360024
073700     EXEC SQL                                                     07370024
073800          FETCH XLT00010-CSR                                      07380024
073900           INTO   :XLT00010-LOC-NBR                               07390024
074000     END-EXEC.                                                    07400024
074100                                                                  07410024
074200     EVALUATE TRUE                                                07420024
074300         WHEN SQLCODE = +0                                        07430024
074400              CONTINUE                                            07440024
074500         WHEN SQLCODE = +100                                      07450024
074600              SET  PS-EOF-XLT00010-CSR TO TRUE                    07460024
074700         WHEN SQLWARN0 NOT = SPACE                                07470024
074800         WHEN SQLCODE  NOT = +0                                   07480024
074900              MOVE '7610-FETCH-XLT00010-CSR'                      07490024
075000                                   TO PV-ABEND-PARAGRAPH          07500024
075100              MOVE 'FETCH XLT00010 CURSOR'                        07510024
075200                                   TO PV-ABEND-OPERATION          07520024
075300              MOVE 'XLT_LOC '      TO PV-ABEND-STRUCTURE-1        07530024
075400              MOVE SPACES          TO PV-ABEND-STRUCTURE-2        07540024
075500              PERFORM 9900-DB2-ABEND                              07550024
075600     END-EVALUATE.                                                07560024
075700                                                                  07570024
075800 7620-CLOSE-XLT00010-CSR.                                         07580024
075900                                                                  07590024
076000     PERFORM                                                      07600024
076100         WITH TEST AFTER                                          07610024
076200         VARYING PV-RETRY-COUNT                                   07620024
076300         FROM 1 BY 1                                              07630024
076400         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 07640024
076500            OR  (SQLCODE = +0))                                   07650024
076600                                                                  07660024
076700            EXEC SQL                                              07670024
076800                CLOSE XLT00010-CSR                                07680024
076900            END-EXEC                                              07690024
077000                                                                  07700024
077100            EVALUATE TRUE                                         07710024
077200                WHEN SQLCODE = 0                                  07720024
077300                    CONTINUE                                      07730024
077400                WHEN SQLCODE = -911                               07740024
077500                WHEN SQLCODE = -904                               07750024
077600                    CONTINUE                                      07760024
077700                WHEN SQLCODE  NOT = +0                            07770024
077800                     MOVE '7620-CLOSE-XLT00010-CSR'               07780024
077900                                  TO PV-ABEND-PARAGRAPH           07790024
078000                     MOVE 'CLOSE XLT00010 CURSOR'                 07800024
078100                                  TO PV-ABEND-OPERATION           07810024
078200                     MOVE 'XLT_LOC '  TO PV-ABEND-STRUCTURE-1     07820024
078300                     MOVE SPACES      TO PV-ABEND-STRUCTURE-2     07830024
078400                     PERFORM 9900-DB2-ABEND                       07840024
078500            END-EVALUATE                                          07850024
078600                                                                  07860024
078700     END-PERFORM.                                                 07870024
078800                                                                  07880024
078900     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          07890024
079000         MOVE '7620-CLOSE-XLT00010-CSR'                           07900024
079100                                 TO PV-ABEND-PARAGRAPH            07910024
079200         MOVE 'MAX RETRIES EXCEEDED'                              07920024
079300                                 TO PV-ABEND-OPERATION            07930024
079400         PERFORM 9900-DB2-ABEND                                   07940024
079500     END-IF.                                                      07950024
079600                                                                  07960024
079700                                                                  07970024
079800 7999-SEARCH-STORE-TABLE.                                         07980024
079900     SEARCH STR-TABLE                                             07990024
080000       VARYING STR-IDX                                            08000024
080100         AT END                                                   08010024
080200             CONTINUE                                             08020024
080300         WHEN STR-NMBR (STR-IDX) = RECEIV-CRE-OPER-UNT-ID         08030024
080400             SET PS-PBS-DC            TO TRUE                     08040024
080500     END-SEARCH.                                                  08050024
080600                                                                  08060024
080700                                                                  08070024
080800 9900-DB2-ABEND.                                                  08080024
080900                                                                  08090024
081000     MOVE SQLCODE TO PV-SQLCODE.                                  08100024
081100     DISPLAY '*** DB2 ERROR '.                                    08110024
081200     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       08120024
081300     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 08130024
081400     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               08140024
081500     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               08150024
081600     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       08160024
081700     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       08170024
081800     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       08180024
081900     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             08190024
082000                                                                  08200024
082100     IF PV-ABEND-STRUCTURE-2 > SPACES                             08210024
082200         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          08220024
082300     END-IF.                                                      08230024
082400                                                                  08240024
082500                                                                  08250024
082600     COPY DPPD004.                                                08260024
082700                                                                  08270024
082800     IF SQLCODE NOT = -911                                        08280024
082900         EXEC SQL                                                 08290024
083000              ROLLBACK                                            08300024
083100         END-EXEC                                                 08310024
083200     END-IF.                                                      08320024
083300                                                                  08330024
083400     MOVE +4013                  TO PV-ABEND-CODE.                08340024
083500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08350024
083600*                                                                 08360024
083700 9200-ABEND.                                                      08370024
083800******************************************************************08380024
083900*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       08390024
084000******************************************************************08400024
084100     DISPLAY '***************************'.                       08410024
084200     DISPLAY '**       ABEND           **'.                       08420024
084300     DISPLAY '**  IN PROGRAM RCKUT030  **'.                       08430024
084400     DISPLAY '***************************'.                       08440024
084500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        08450024
084600     DISPLAY '**   ERROR         ** = ' DP003-RETURN-MSG.         08460024
084700     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       08470024
084800     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       08480024
084900                                                                  08490024
085000     MOVE +4014                  TO PV-ABEND-CODE.                08500024
085100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08510024
085200*                                                                 08520024
