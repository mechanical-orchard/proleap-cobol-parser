000100*-----------------------*                                         00010062
000200 IDENTIFICATION DIVISION.                                         00020062
000300*-----------------------*                                         00030062
000400 PROGRAM-ID.    CEKCS601.                                         00040062
000500 AUTHOR.        DENISE HAHN.                                      00050062
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060062
000700 DATE-WRITTEN.  12-07-1999.                                       00070062
000800 DATE-COMPILED.                                                   00080062
000900                                                                  00090062
001000*---------------------------------------------------------------* 00100062
001100*    S601 - CENTRAL STOCK INTERFACE - PULL LIST                 * 00110062
001200*                                                               * 00120062
001300*---------------------------------------------------------------* 00130062
001400*----------------------------------------------------------------*00140062
001500* 04/28/2010 - DJK - CHANGES MADE FOR EFC2 WR 38216              *00150062
001600*----------------------------------------------------------------*00160062
001700***************************************************************** 00170062
001800* CHANGE DESCRIPTION                                              00180062
001900***************************************************************** 00190062
002000* DATE  08/02/2010                                                00200062
002100*  CHANGE MADE: CHANGED TO DISPLAY STATUS DATE ALWAYS ON          00210062
002200*  CE-CENTRAL STOCK PULL LIST SCREEN.                             00220062
002300*  MADE BY: TOYAM SAIKH     TKID:TKMAX89                          00230062
002400*  CHANGES ARE TAGGED AS TS 08/02/2010                            00240062
002401*                                                                 00240162
002402* DATE  08/02/2010                                                00240262
002403*  CHANGE MADE: CHANGED TO CALL THE NEW SCREEN ON PF KEY 18       00240362
002404*  CE-CENTRAL STOCK PULL DC LIST SCREEN.                          00240462
002405*  MADE BY: EKTA AGRAWAL    TKID:TKMAV49                          00240562
002406*  CHANGES ARE TAGGED AS EA 08/02/2010                            00240662
263455*                                                                 00240772
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00240872
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00240972
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00241072
263455*                                                                 00241173
CICS  * CHANGED 10/19/2022    BY JIM HUNTER      WR: CHG0276924         00241274
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00241373
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00241473
002407***************************************************************** 00241671
002408 EJECT                                                            00241771
002409 ENVIRONMENT DIVISION.                                            00241871
002410                                                                  00241971
002420 DATA DIVISION.                                                   00242062
002430                                                                  00243062
002440 WORKING-STORAGE SECTION.                                         00244062
002450                                                                  00245062
002460 01  DK-DB2-KEYS.                                                 00246062
002470     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00247062
002480                                                    COMP.         00248062
002490     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00249062
002500                                                    COMP.         00250062
002600     15  DK-DEPT-NUMBER                 PIC  S9(4)V VALUE ZERO    00260062
002700                                               COMP-3.            00270062
002800     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00280062
002900     15  DK-LOC-ID                      PIC S9(04)  COMP.         00290062
003000     15  DK-FROM-TMST                   PIC  X(26)  VALUE SPACES. 00300062
003100     15  DK-TO-TMST                     PIC  X(26)  VALUE SPACES. 00310062
003200     15  DK-DUMMY-FIELD                 PIC S9(01)  VALUE ZERO    00320062
003300                                                    COMP.         00330062
003400     15  DK-RDM-PULL-NUMBER             PIC S9(09)  VALUE ZERO    00340062
003500                                                    COMP.         00350062
003600*TS 08/02/2010 BEG                                                00360062
003700     15  DK-MAJ-CL-NBR                  PIC  S9(4)V VALUE ZERO    00370062
003800                                               COMP-3.            00380062
003900     15  DK-SUB-CL-NBR                  PIC  S9(4)V VALUE ZERO    00390062
004000                                               COMP-3.            00400062
004100*TS 08/02/2010 END                                                00410062
004200                                                                  00420062
004300 01  PC-PROGRAM-CONSTANTS.                                        00430062
004400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE601A  '.  00440062
004500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM601 '.  00450062
004600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS601'.  00460062
004700     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00470062
004800     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'CEKCS609'.  00480062
004900     05  PC-PRINT-PROGRAM          PIC  X(08)  VALUE 'CEKCS609'.  00490062
005000     05  PC-CONFIRM-MODULE         PIC  X(08)  VALUE 'CEKCS610'.  00500062
005100     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00510062
005200     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00520062
005300     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00530062
005400     05  PC-RESEND-FORMAT          PIC  X(01)  VALUE '2'.         00540062
005500     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +11          00550062
005600                                               COMP SYNC.         00560062
005700     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00570062
005800                                               COMP SYNC.         00580062
005900     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00590062
006000                                               COMP-3.            00600062
006100     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00610062
006200                                               COMP SYNC.         00620062
006300     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00630062
006400                                               COMP-3.            00640062
006500     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00650062
006600     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00660062
006700     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00670062
006800     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00680062
006900     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00690062
007000     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00700062
007100     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00710062
007200                                               COMP.              00720062
007300     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00730062
007400     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00740062
007500     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00750062
007600     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00760062
007700     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00770062
007800     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00780062
007900     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00790062
008000     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00800062
008100     05  PC-01                     PIC  X(02)  VALUE '01'.        00810062
008200     05  PC-000                    PIC  X(03)  VALUE '000'.       00820062
008300     05  PC-RDM                    PIC  X(03)  VALUE 'RDM'.       00830062
008400     05  PC-AC                     PIC  X(02)  VALUE 'AC'.        00840062
008500     05  PC-Y                      PIC  X(25)  VALUE              00850062
008600                                     'Y                        '. 00860062
008700     05  PC-0001                   PIC  9(04)  VALUE 0001.        00870062
008800     05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00880062
008900                                                                  00890062
009000     05  PC-RQSTD-REF             PIC  X(23)                      00900062
009100                                  VALUE 'REQUESTED REF NBR.....:'.00910062
009200     05  PC-RQSTD-REF-DEPT        PIC  X(23)                      00920062
009300                                  VALUE 'REQUESTED DEPT/REF NBR:'.00930062
009400     05  PC-RQSTD-DEPT            PIC  X(23)                      00940062
009500                                  VALUE 'REQUESTED DEPT NBR....:'.00950062
009600*TS 08/02/2010 BEG                                                00960062
009700     05  PC-RQSTD-DEPT-MJ-SUB     PIC  X(23)                      00970062
009800                                  VALUE 'DEPT/MJ-CL/SUB-CL.....:'.00980062
009900     05  PC-RQSTD-DEPT-MJ         PIC  X(23)                      00990062
010000                                  VALUE 'DEPT NBR/MJ-CL........:'.01000062
010100*TS 08/02/2010 END                                                01010062
010200*----------------------------------------------------------------*01020062
010300*  DESCRIPTION CONSTANTS                                         *01030062
010400*----------------------------------------------------------------*01040062
010500     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  01050062
010600     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  01060062
010700     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  01070062
010800     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  01080062
010900     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  01090062
011000     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  01100062
011100     05  PC-NEW-INPROC-DESC         PIC X(08)  VALUE 'NW/INPRC'.  01110062
011200     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.01120062
011300     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.01130062
011400*TS 08/02/2010 BEG                                                01140062
011500*    05  PC-ADAM-DESC               PIC X(04)  VALUE 'ADAM'.      01150062
011600     05  PC-ALOC-DESC               PIC X(04)  VALUE 'ALOC'.      01160062
011700*    05  PC-INFOREM-DESC            PIC X(04)  VALUE 'INFM'.      01170062
011800     05  PC-REPL-DESC               PIC X(04)  VALUE 'REPL'.      01180062
011900*TS 08/02/2010 END                                                01190062
012000     05  PC-MANUAL-DESC             PIC X(04)  VALUE 'MANL'.      01200062
012100**DJK - 05/04/10 - ADDED DESCRIPTION BELOW TO ACCOMADATE EFC2     01210062
012200     05  PC-XFER-DESC               PIC X(04)  VALUE 'XFER'.      01220062
012300     05  PC-UNKNOWN-DESC            PIC X(04)  VALUE 'UNKN'.      01230062
012400*                                                                 01240062
012500*----------------------------------------------------------------*01250062
012600*  SYSTEM MESSAGES                                               *01260062
012700*----------------------------------------------------------------*01270062
012800*   00005 = INVALID VALUE                                        *01280062
012900*   00008 = MUST BE NUMERIC                                      *01290062
013000*   00045 = INVALID FUNCTION KEY                                  01300062
013100*   00047 = ONLY ONE ITEM MAY BE SELECTED                         01310062
013200*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01320062
013300*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01330062
013400*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01340062
013500*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01350062
013600*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01360062
013700*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01370062
013800*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01380062
013900*   00069 - TOP OF LIST                                          *01390062
014000*   00070 - BOTTOM OF LIST                                       *01400062
014100*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01410062
014200*   00279 - MORE ITEMS TO DISPLAY                                *01420062
014300*   00746 = INVALID PRINTER DESTINATION                          *01430062
014400*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01440062
014500*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01450062
014600*   02214 = PULL NUMBER NOT FOUND                                 01460062
014700*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01470062
014800*   02225 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL CANCELLED        01480062
014900*   02226 = CANNOT PRINT PULL - PULL STATUS IS CANCELLED          01490062
015000*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01500062
015100*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S)*01510062
015200*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01520062
015300*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01530062
015400*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01540062
015500*   02258 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM PULL DI01550062
015600*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01560062
015700*   02260 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM LINE IT01570062
015800*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01580062
015900*   02268 - CANNOT CNCL/UNCNCL-LINE(S) POSTED,DISTRBTD, WORKED RDM01590062
016000*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01600062
016100*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01610062
016200*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01620062
016300*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01630062
016400*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01640062
016500*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01650062
016600*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01660062
016700*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01670062
016800*   02278 = ALL SELECTED LINES MUST HAVE THE SAME STATUS TO PER  *01680062
016900*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01690062
017000*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01700062
017100*   02296 - PRINT PULL FAILED - NO LINE(S) FOR REQUESTED PULL     01710062
017200*   02297 - PRINT PULL FAILED - LINE(S) MISSING DISTRIBUTION INFOR01720062
017300*   02306 - YOU DO NOT HAVE AUTHORITY TO PRINT                    01730062
017400*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01740062
017500*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01750062
017600*   02317 - CANNOT CONFIRM/UNCONFIRM DISTRO - PULL STATUS NEW     01760062
017700*   02322 - MULTIPLE LINE ITEMS EXIST - F2 TO CONFIRM PULL DISTRIB01770062
017800*   02323 - PRINT REQUEST FAILED - PULL STATUS IS POSTED OR DISTRI01780062
017900*   02354 - CANNOT CONFIRM DISTRIBUTION - NOT ALL LINES ARE IN PRO01790062
018000*   02516 - DC REQUESTING ACCESS IS NOT CURRENTLY USING THE RDM   01800062
018100*           APPLICATION.                                          01810062
018200*   02677 - COMMUNICATION ERROR - CANNOT ACCESS WEB INVENTORY     01820062
018300*   02879 - CANNOT UN-CANCEL PULL - MUST USE THE LINE LIST SCREEN 01830062
018400*           TO UN-CANCEL                                          01840062
018500*   02880 - NO AUTHORITY TO CANCEL PULL SENT TO RDM - CENTRAL STK 01850062
018600*           SITE MUST CANCEL                                      01860062
018700*   99901 = INVALID COMMAND WAS ENTERED                          *01870062
018800*----------------------------------------------------------------*01880062
018900     05  PC-TSYMSG-NUMBERS.                                       01890062
019000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01900062
019100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01910062
019200         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01920062
019300         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01930062
019400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01940062
019500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01950062
019600         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01960062
019700         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01970062
019800         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01980062
019900         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01990062
020000         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  02000062
020100         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  02010062
020200         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  02020062
020300         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  02030062
020400         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  02040062
020500         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  02050062
020600         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  02060062
020700         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  02070062
020800         10  PC-TSYMSG-02214            PIC  9(05)  VALUE 02214.  02080062
020900         10  PC-TSYMSG-02224            PIC  9(05)  VALUE 02224.  02090062
021000         10  PC-TSYMSG-02225            PIC  9(05)  VALUE 02225.  02100062
021100         10  PC-TSYMSG-02226            PIC  9(05)  VALUE 02226.  02110062
021200         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  02120062
021300         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  02130062
021400         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  02140062
021500         10  PC-TSYMSG-02254            PIC  9(05)  VALUE 02254.  02150062
021600         10  PC-TSYMSG-02255            PIC  9(05)  VALUE 02255.  02160062
021700         10  PC-TSYMSG-02258            PIC  9(05)  VALUE 02258.  02170062
021800         10  PC-TSYMSG-02259            PIC  9(05)  VALUE 02259.  02180062
021900         10  PC-TSYMSG-02260            PIC  9(05)  VALUE 02260.  02190062
022000         10  PC-TSYMSG-02267            PIC  9(05)  VALUE 02267.  02200062
022100         10  PC-TSYMSG-02268            PIC  9(05)  VALUE 02268.  02210062
022200         10  PC-TSYMSG-02269            PIC  9(05)  VALUE 02269.  02220062
022300         10  PC-TSYMSG-02270            PIC  9(05)  VALUE 02270.  02230062
022400         10  PC-TSYMSG-02271            PIC  9(05)  VALUE 02271.  02240062
022500         10  PC-TSYMSG-02272            PIC  9(05)  VALUE 02272.  02250062
022600         10  PC-TSYMSG-02273            PIC  9(05)  VALUE 02273.  02260062
022700         10  PC-TSYMSG-02274            PIC  9(05)  VALUE 02274.  02270062
022800         10  PC-TSYMSG-02275            PIC  9(05)  VALUE 02275.  02280062
022900         10  PC-TSYMSG-02276            PIC  9(05)  VALUE 02276.  02290062
023000         10  PC-TSYMSG-02278            PIC  9(05)  VALUE 02278.  02300062
023100         10  PC-TSYMSG-02287            PIC  9(05)  VALUE 02287.  02310062
023200         10  PC-TSYMSG-02288            PIC  9(05)  VALUE 02288.  02320062
023300         10  PC-TSYMSG-02296            PIC  9(05)  VALUE 02296.  02330062
023400         10  PC-TSYMSG-02297            PIC  9(05)  VALUE 02297.  02340062
023500         10  PC-TSYMSG-02306            PIC  9(05)  VALUE 02306.  02350062
023600         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  02360062
023700         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  02370062
023800         10  PC-TSYMSG-02317            PIC  9(05)  VALUE 02317.  02380062
023900         10  PC-TSYMSG-02322            PIC  9(05)  VALUE 02322.  02390062
024000         10  PC-TSYMSG-02323            PIC  9(05)  VALUE 02323.  02400062
024100         10  PC-TSYMSG-02354            PIC  9(05)  VALUE 02354.  02410062
024200         10  PC-TSYMSG-02495            PIC  9(05)  VALUE 02495.  02420062
024300         10  PC-TSYMSG-02516            PIC  9(05)  VALUE 02516.  02430062
024400         10  PC-TSYMSG-02677            PIC  9(05)  VALUE 02677.  02440062
024500         10  PC-TSYMSG-02879            PIC  9(05)  VALUE 02879.  02450062
024600         10  PC-TSYMSG-02880            PIC  9(05)  VALUE 02880.  02460062
024700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02470062
024800*                                                                 02480062
024900 01  PS-PROGRAM-SWITCHES.                                         02490062
025000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02500062
025100         88  PS-NO-ERROR                            VALUE 'Y'.    02510062
025200         88  PS-ERROR                               VALUE 'N'.    02520062
025300     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    02530062
025400         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02540062
025500         88  PS-BLOCK-ERROR                         VALUE 'N'.    02550062
025600     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE 'N'.    02560062
025700         88  PS-CONFIRM-PROCESSING                  VALUE 'Y'.    02570062
025800         88  PS-NOT-CONFIRM-PROCESSING              VALUE 'N'.    02580062
025900     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02590062
026000         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02600062
026100         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02610062
026200     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02620062
026300         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02630062
026400         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02640062
026500     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02650062
026600         88  PS-DONE                                VALUE 'Y'.    02660062
026700         88  PS-NOT-DONE                            VALUE 'N'.    02670062
026800     05  PS-EOF-CNFM-LNE-CSR-SW         PIC  X(01)  VALUE  'N'.   02680062
026900         88  PS-EOF-CNFM-LNE-CSR                    VALUE  'Y'.   02690062
027000         88  PS-NOT-EOF-CNFM-LNE-CSR                VALUE  'N'.   02700062
027100     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   02710062
027200         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   02720062
027300         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   02730062
027400     05  PS-VALID-RDM-FACILITY-SW       PIC  X(01)  VALUE  'N'.   02740062
027500         88  PS-VALID-RDM-FACILITY                  VALUE  'Y'.   02750062
027600         88  PS-VALID-RDM-FACILITY-NO               VALUE  'N'.   02760062
027700*                                                                 02770062
027800 01  PV-PROGRAM-VARIABLES.                                        02780062
027900     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02790062
028000                                        COMP SYNC.                02800062
028100     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 02810062
028200     05  PV-SUB                         PIC S9(04)  VALUE +0      02820062
028300                                                    COMP SYNC.    02830062
028400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02840062
028500                                                    COMP SYNC.    02850062
028600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02860062
028700                                                    COMP-3.       02870062
028800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02880062
028900                                                    COMP-3.       02890062
029000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02900062
029100                                                    COMP-3.       02910062
029200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02920062
029300                                                    COMP-3.       02930062
029400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02940062
029500                                                    COMP-3.       02950062
029600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02960062
029700                                                    COMP-3.       02970062
029800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02980062
029900                                                    COMP-3.       02990062
030000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03000062
030100                                                    COMP SYNC.    03010062
030200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03020062
030300                                                    COMP SYNC.    03030062
030400     05  PV-ITEM                        PIC S9(04)  VALUE +0      03040062
030500                                                    COMP SYNC.    03050062
030600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03060062
030700                                                    COMP SYNC.    03070062
030800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03080062
030900                                                    COMP SYNC.    03090062
031000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03100062
031100                                                    COMP SYNC.    03110062
031200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03120062
031300                                                    COMP SYNC.    03130062
031400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03140062
031500                                                    COMP SYNC.    03150062
031600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03160062
031700                                                    COMP SYNC.    03170062
031800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03180062
031900                                                    COMP SYNC.    03190062
032000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03200062
032100                                                    COMP SYNC.    03210062
032200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03220062
032300                                                    COMP SYNC.    03230062
032400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03240062
032500                                                    COMP SYNC.    03250062
032600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03260062
032700                                                    COMP SYNC.    03270062
032800     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03280062
032900                                                    COMP SYNC.    03290062
033000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03300062
033100                                                    COMP SYNC.    03310062
033200     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      03320062
033300                                                    COMP.         03330062
033400     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      03340062
033500                                                    COMP.         03350062
033600     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      03360062
033700                                                    COMP.         03370062
033800     05  PV-SOFT-ABORT-MSG.                                       03380062
033900         10  FILLER            PIC X(12) VALUE ' CEKCS601 - '.    03390062
034000         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       03400062
034100         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    03410062
034200         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    03420062
034300         10  PV-SOFT-PARAGRAPH PIC X(30).                         03430062
034400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03440062
034500                                                     COMP SYNC.   03450062
034600     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03460062
034700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03470062
034800     05  PV-CICS-MSG-HOLD.                                        03480062
034900         10  FILLER                      PIC  X(01)  VALUE SPACE. 03490062
035000         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 03500062
035100     05  PV-CICS-MSG-HOLD2.                                       03510062
035200         10  FILLER                      PIC  X(01)  VALUE SPACE. 03520062
035300         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 03530062
035400                                                                  03540062
035500                                                                  03550062
035600     05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 03560062
035700     05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              03570062
035800         10   PV-CREATE-CC              PIC X(02).                03580062
035900         10   PV-CREATE-YY              PIC X(02).                03590062
036000         10   FILLER                    PIC X(01).                03600062
036100         10   PV-CREATE-MM              PIC X(02).                03610062
036200         10   FILLER                    PIC X(01).                03620062
036300         10   PV-CREATE-DD              PIC X(02).                03630062
036400         10   FILLER                    PIC X(16).                03640062
036500     05  PV-CREATE-MMDDYY.                                        03650062
036600         10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 03660062
036700         10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 03670062
036800         10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 03680062
036900         10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 03690062
037000         10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 03700062
037100     05  PV-STATUS-MMDDYY.                                        03710062
037200         10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 03720062
037300         10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 03730062
037400         10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 03740062
037500         10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 03750062
037600         10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 03760062
037700     05  PV-SELECT-FROM-DATE.                                     03770062
037800         10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 03780062
037900         10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 03790062
038000         10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 03800062
038100         10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 03810062
038200         10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 03820062
038300     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 03830062
038400*TS 08/02/2010 BEG                                                03840062
038500*        88   PV-SOURCE-ADAM                        VALUE 'MA'.   03850062
038600         88   PV-SOURCE-ALOC                        VALUE 'MA'.   03860062
038700*        88   PV-SOURCE-INFOREM                     VALUE 'MR'.   03870062
038800         88   PV-SOURCE-REPL                        VALUE 'MR'.   03880062
038900*TS 08/02/2010 END                                                03890062
039000         88   PV-SOURCE-MANUAL                      VALUE 'UC'.   03900062
039100**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      03910062
039200         88   PV-SOURCE-XFER                        VALUE 'XF'.   03920062
039300         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 03930062
039400     05  PV-PULL-STATUS                 PIC X(02)   VALUE SPACES. 03940062
039500         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   03950062
039600         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   03960062
039700         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   03970062
039800         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   03980062
039900         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   03990062
040000     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  04000062
040100                                                    COMP.         04010062
040200     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  04020062
040300                                                    COMP.         04030062
040400     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  04040062
040500                                                    COMP.         04050062
040600     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  04060062
040700                                                    COMP.         04070062
040800     05  PV-CEPLMF-MANIF-QTY             PIC S9(09) VALUE ZEROES  04080062
040900                                                    COMP.         04090062
041000     05  PV-CEPLAU-ADJUST-QTY            PIC S9(09) VALUE ZEROES  04100062
041100                                                    COMP.         04110062
041200     05  PV-COMPUTE-DISTRB-QTY           PIC S9(09) VALUE ZEROES  04120062
041300                                                    COMP.         04130062
041400                                                                  04140062
041500     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 04150062
041600*TS 08/02/2010 BEG                                                04160062
041700*        88   PV-TYPE-1-ADAM                        VALUE 'MA'.   04170062
041800         88   PV-TYPE-1-ALOC                        VALUE 'MA'.   04180062
041900*        88   PV-TYPE-1-INFOREM                     VALUE 'MR'.   04190062
042000         88   PV-TYPE-1-REPL                        VALUE 'MR'.   04200062
042100*TS 08/02/2010 END                                                04210062
042200         88   PV-TYPE-1-MANUAL                      VALUE 'UC'.   04220062
042300**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      04230062
042400         88   PV-TYPE-1-XFER                        VALUE 'XF'.   04240062
042500     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 04250062
042600*TS 08/02/2010 BEG                                                04260062
042700*        88   PV-TYPE-2-ADAM                        VALUE 'MA'.   04270062
042800         88   PV-TYPE-2-ALOC                        VALUE 'MA'.   04280062
042900*        88   PV-TYPE-2-INFOREM                     VALUE 'MR'.   04290062
043000         88   PV-TYPE-2-REPL                        VALUE 'MR'.   04300062
043100*TS 08/02/2010 END                                                04310062
043200         88   PV-TYPE-2-MANUAL                      VALUE 'UC'.   04320062
043300**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      04330062
043400         88   PV-TYPE-2-XFER                        VALUE 'XF'.   04340062
043500     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 04350062
043600*TS 08/02/2010 BEG                                                04360062
043700*        88   PV-TYPE-3-ADAM                        VALUE 'MA'.   04370062
043800         88   PV-TYPE-3-ALOC                        VALUE 'MA'.   04380062
043900*        88   PV-TYPE-3-INFOREM                     VALUE 'MR'.   04390062
044000         88   PV-TYPE-3-REPL                        VALUE 'MR'.   04400062
044100*TS 08/02/2010 END                                                04410062
044200         88   PV-TYPE-3-MANUAL                      VALUE 'UC'.   04420062
044300**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      04430062
044400         88   PV-TYPE-3-XFER                        VALUE 'XF'.   04440062
044500     05  PV-TYPE-4                       PIC X(02)  VALUE SPACES. 04450062
044600*TS 08/02/2010 BEG                                                04460062
044700*        88   PV-TYPE-4-ADAM                        VALUE 'MA'.   04470062
044800         88   PV-TYPE-4-ALOC                        VALUE 'MA'.   04480062
044900*        88   PV-TYPE-4-INFOREM                     VALUE 'MR'.   04490062
045000         88   PV-TYPE-4-REPL                        VALUE 'MR'.   04500062
045100*TS 08/02/2010 END                                                04510062
045200         88   PV-TYPE-4-MANUAL                      VALUE 'UC'.   04520062
045300**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      04530062
045400         88   PV-TYPE-4-XFER                        VALUE 'XF'.   04540062
045500                                                                  04550062
045600     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 04560062
045700         88   PV-STATUS-1-NEW                       VALUE 'NW'.   04570062
045800         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   04580062
045900         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   04590062
046000         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   04600062
046100         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   04610062
046200     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 04620062
046300         88   PV-STATUS-2-NEW                       VALUE 'NW'.   04630062
046400         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   04640062
046500         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   04650062
046600         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   04660062
046700         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   04670062
046800     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 04680062
046900         88   PV-STATUS-3-NEW                       VALUE 'NW'.   04690062
047000         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   04700062
047100         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   04710062
047200         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   04720062
047300         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   04730062
047400     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 04740062
047500         88   PV-STATUS-4-NEW                       VALUE 'NW'.   04750062
047600         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   04760062
047700         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   04770062
047800         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   04780062
047900         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   04790062
048000     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 04800062
048100         88   PV-STATUS-5-NEW                       VALUE 'NW'.   04810062
048200         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   04820062
048300         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   04830062
048400         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   04840062
048500         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   04850062
048600                                                                  04860062
048700     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 04870062
048800     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 04880062
048900     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 04890062
049000     05  PV-DC-NBR-SIGNED                PIC S9(04)  COMP.        04900062
049100     05  PV-CS-LOC-SIGNED                PIC S9(04)  COMP.        04910062
049200     05  PV-PULL-NBR-SIGNED              PIC S9(09)  COMP.        04920062
049300     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 04930062
049400     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 04940062
049500     05  PV-PULL-STATUS-DESC             PIC  X(09) VALUE SPACES. 04950062
049600     05  PV-STATUS-DATE                  PIC  X(08) VALUE SPACES. 04960062
049700     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 04970062
049800     05  PV-PULL-SOURCE-DESC             PIC  X(04) VALUE SPACES. 04980062
049900     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 04990062
050000     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05000062
050100     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05010062
050200     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 05020062
050300                                                                  05030062
050400     05  PV-SEL-TERM-ID                  PIC  X(04).              05040062
050500     05  PV-SEL-TASK-NUMBER              PIC  9(05).              05050062
050600     05  PV-SEL-SEQ                      PIC  9(01).              05060062
050700                                                                  05070062
050800     05  PV-LINES-POSTED-DISTRB          PIC S9(09)  COMP.        05080062
050900     05  PV-TCEPLMF-COUNT                PIC S9(09)  COMP.        05090062
051000     05  PV-TCEPLAU-COUNT   PIC S9(09)    VALUE ZEROES            05100062
051100                                          COMP.                   05110062
051200     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     05120062
051300                                                     COMP SYNC.   05130062
051400     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      05140062
051500     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      05150062
051600     05  PV-SEL-CNCL-CNT                 PIC S9(09)  COMP-3       05160062
051700                                                     VALUE ZEROES.05170062
051800     05  PV-SEL-UNCNCL-CNT               PIC S9(09)  COMP-3       05180062
051900                                                     VALUE ZEROES.05190062
052000     05  PV-CEPLDS-COUNT                 PIC S9(09)  VALUE ZEROES 05200062
052100                                                     COMP.        05210062
052200     05  PV-CEPLIT-COUNT                 PIC S9(09)  VALUE ZEROES 05220062
052300                                                     COMP.        05230062
052400     05  PV-LINES-NEW                    PIC S9(09)  VALUE ZEROES 05240062
052500                                                     COMP.        05250062
052600     05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.05260062
052700                                                                  05270062
052800     05  PV-RACF-ERROR-CODE              PIC  9(04)  VALUE ZEROES.05280062
052900     05  PV-FROM-TMST.                                            05290062
053000         10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              05300062
053100         10   FILLER        PIC X(01)  VALUE '-'.                 05310062
053200         10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              05320062
053300         10   FILLER        PIC X(01)  VALUE '-'.                 05330062
053400         10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              05340062
053500         10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  05350062
053600     05  PV-TO-TMST.                                              05360062
053700         10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              05370062
053800         10   FILLER        PIC X(01)  VALUE '-'.                 05380062
053900         10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              05390062
054000         10   FILLER        PIC X(01)  VALUE '-'.                 05400062
054100         10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              05410062
054200         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  05420062
054300     05  PV-REF-DEPT-HOLD.                                        05430062
054400         10  PV-DEPT-HOLD   PIC X(03)  VALUE SPACE.               05440062
054500         10  FILLER         PIC X(01)  VALUE '/'.                 05450062
054600         10  PV-REF-HOLD    PIC X(15)  VALUE SPACE.               05460062
054700     05  PV-NUMERIC-DISTRB-QTY                                    05470062
054800                            PIC Z(05)9-   VALUE ZEROES.           05480062
054900     05  PV-DISPLAY-DISTRB-QTY                                    05490062
055000                            PIC X(07)     VALUE SPACES.           05500062
055100*TS 08/02/2010 BEG                                                05510062
055200     05  PV-DEPT-MAJ-SUB-HOLD.                                    05520062
055300         10  PV-DEPT-HOLD3  PIC X(03)  VALUE SPACE.               05530062
055400         10  FILLER         PIC X(01)  VALUE '/'.                 05540062
055500         10  PV-MAJ-HOLD3   PIC X(02)  VALUE SPACE.               05550062
055600         10  FILLER         PIC X(01)  VALUE '/'.                 05560062
055700         10  PV-SUB-HOLD3   PIC X(02)  VALUE SPACE.               05570062
055800     05  PV-DEPT-MAJ-HOLD.                                        05580062
055900         10  PV-DEPT-HOLD4  PIC X(03)  VALUE SPACE.               05590062
056000         10  FILLER         PIC X(01)  VALUE '/'.                 05600062
056100         10  PV-MAJ-HOLD4   PIC X(02)  VALUE SPACE.               05610062
056200*TS 08/02/2010 END                                                05620062
056300******************************************************************05630062
056400**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **05640062
056500**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **05650062
056600**  APPLICATION-SPECIFIC COMMAREA.                              **05660062
056700******************************************************************05670062
056800 01  LQW-LIST-QUEUE-WORK-AREA.                                    05680062
056900     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  05690062
057000     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           05700062
057100                                        INDEXED BY LQW-IDX.       05710062
057200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       05720062
057300         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               05730062
057400         10  LQW-SELECTED-SW            PIC  X(01).               05740062
057500             88  LQW-SELECT                         VALUE 'S'.    05750062
057600             88  LQW-DESELECT                       VALUE ' '.    05760062
057700         10  LQW-ACTION                 PIC  X(03).               05770062
057800             88  LQW-DEL                            VALUE 'DEL'.  05780062
057900             88  LQW-INQ                            VALUE 'INQ'.  05790062
058000             88  LQW-UPD                            VALUE 'UPD'.  05800062
058100             88  LQW-ERR                            VALUE 'ERR'.  05810062
058200             88  LQW-PRT                            VALUE 'PRT'.  05820062
058300         10  LQW-PULL-NUMBER            PIC  Z(08).               05830062
058400         10  LQW-REF-NUMBER             PIC  X(15).               05840062
058500         10  LQW-CS-LOCATION            PIC  Z(04).               05850062
058600         10  LQW-CREATE-DATE            PIC  X(08).               05860062
058700         10  LQW-PULL-STATUS-CDE        PIC  X(02).               05870062
058800         10  LQW-PULL-STATUS-DESC       PIC  X(09).               05880062
058900         10  LQW-STATUS-DATE            PIC  X(08).               05890062
059000         10  LQW-PULL-SOURCE-CDE        PIC  X(02).               05900062
059100         10  LQW-PULL-SOURCE-DESC       PIC  X(04).               05910062
059200         10  LQW-NBR-ITEMS              PIC  Z(05).               05920062
059300         10  LQW-REQ-PULL-UNITS         PIC  Z(06).               05930062
059400         10  LQW-ACT-PULL-UNITS         PIC  Z(06).               05940062
059500         10  LQW-DISTRBUTED-UNITS       PIC  X(07).               05950062
059600         10  LQW-DISTRB-UNTS-NUM        PIC S9(06).               05960062
059700         10  LQW-VARIANCE-UNITS         PIC S9(05).               05970062
059800         10  LQW-IN-TCEPLMF             PIC  X(01).               05980062
059900             88  LQW-IN-TCEPLMF-YES                 VALUE 'Y'.    05990062
060000             88  LQW-IN-TCEPLMF-NO                  VALUE 'N'.    06000062
060100                                                                  06010062
060200                                                                  06020062
060300*---------------------------------------------------------------* 06030062
060400* SELECTON QUEUE LAYOUT                                         * 06040062
060500*---------------------------------------------------------------* 06050062
060600     COPY CEWS003.                                                06060062
060700                                                                  06070062
060800                                                                  06080062
060900*---------------------------------------------------------------* 06090062
061000* COMMUNICATION AREA FOR PRINT MODULE (CEKCS609)                * 06100062
061100*---------------------------------------------------------------* 06110062
061200     COPY CEWS004.                                                06120062
061300                                                                  06130062
061400                                                                  06140062
061500*---------------------------------------------------------------* 06150062
061600*  SENDING/RECEIVING AREA FOR THE CONFIRMATION ROUTINE          * 06160062
061700*  (CEKCS610)                                                   * 06170062
061800*---------------------------------------------------------------* 06180062
061900     COPY CEWS005.                                                06190062
062000                                                                  06200062
062100*---------------------------------------------------------------* 06210062
062200*  COMMAREA FOR THE LOCATION DOMAIN MODULE (XLKUT071)           * 06220062
062300*---------------------------------------------------------------* 06230062
062400     COPY XLWS071.                                                06240062
062500                                                                  06250062
062600*---------------------------------------------------------------* 06260062
062700*    MAP LAYOUT                                                 * 06270062
062800*---------------------------------------------------------------* 06280062
062900                                                                  06290062
063000     COPY CEKM601.                                                06300062
063100*                                                                 06310062
063200 01  MR-OCCURS-LAYOUT                   REDEFINES  CE601AO.       06320062
063300     05  FILLER                         PIC X(190).               06330062
063400     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          06340062
063500         10  MR-SELECTL                 PIC S9(04) COMP.          06350062
063600         10  MR-SELECTA                 PIC  X(01).               06360062
063700         10  MR-SELECTC                 PIC  X(01).               06370062
063800         10  MR-SELECTH                 PIC  X(01).               06380062
063900         10  MR-SELECTI                 PIC  X(01).               06390062
064000                                                                  06400062
064100         10  MR-ACTIONL                 PIC S9(04) COMP.          06410062
064200         10  MR-ACTIONA                 PIC  X(01).               06420062
064300         10  MR-ACTIONC                 PIC  X(01).               06430062
064400         10  MR-ACTIONH                 PIC  X(01).               06440062
064500         10  MR-ACTION                  PIC  X(03).               06450062
064600                                                                  06460062
064700         10  MR-PULL-NUMBERL            PIC S9(04) COMP.          06470062
064800         10  MR-PULL-NUMBERA            PIC  X(01).               06480062
064900         10  MR-PULL-NUMBERC            PIC  X(01).               06490062
065000         10  MR-PULL-NUMBERH            PIC  X(01).               06500062
065100         10  MR-PULL-NUMBER-X.                                    06510062
065200             15  MR-PULL-NUMBER         PIC  Z(08).               06520062
065300                                                                  06530062
065400         10  MR-CS-LOCATIONL            PIC S9(04) COMP.          06540062
065500         10  MR-CS-LOCATIONA            PIC  X(01).               06550062
065600         10  MR-CS-LOCATIONC            PIC  X(01).               06560062
065700         10  MR-CS-LOCATIONH            PIC  X(01).               06570062
065800         10  MR-CS-LOCATION             PIC  Z(04).               06580062
065900                                                                  06590062
066000         10  MR-CREATE-DATEL            PIC S9(04) COMP.          06600062
066100         10  MR-CREATE-DATEA            PIC  X(01).               06610062
066200         10  MR-CREATE-DATEC            PIC  X(01).               06620062
066300         10  MR-CREATE-DATEH            PIC  X(01).               06630062
066400         10  MR-CREATE-DATE             PIC  X(08).               06640062
066500                                                                  06650062
066600         10  MR-PULL-STATUSL            PIC S9(04) COMP.          06660062
066700         10  MR-PULL-STATUSA            PIC  X(01).               06670062
066800         10  MR-PULL-STATUSC            PIC  X(01).               06680062
066900         10  MR-PULL-STATUSH            PIC  X(01).               06690062
067000         10  MR-PULL-STATUS             PIC  X(08).               06700062
067100                                                                  06710062
067200         10  MR-STATUS-DATEL            PIC S9(04) COMP.          06720062
067300         10  MR-STATUS-DATEA            PIC  X(01).               06730062
067400         10  MR-STATUS-DATEC            PIC  X(01).               06740062
067500         10  MR-STATUS-DATEH            PIC  X(01).               06750062
067600         10  MR-STATUS-DATE             PIC  X(08).               06760062
067700                                                                  06770062
067800         10  MR-PULL-SOURCEL            PIC S9(04) COMP.          06780062
067900         10  MR-PULL-SOURCEA            PIC  X(01).               06790062
068000         10  MR-PULL-SOURCEC            PIC  X(01).               06800062
068100         10  MR-PULL-SOURCEH            PIC  X(01).               06810062
068200         10  MR-PULL-SOURCE             PIC  X(04).               06820062
068300                                                                  06830062
068400         10  MR-NBR-ITEMSL              PIC S9(04) COMP.          06840062
068500         10  MR-NBR-ITEMSA              PIC  X(01).               06850062
068600         10  MR-NBR-ITEMSC              PIC  X(01).               06860062
068700         10  MR-NBR-ITEMSH              PIC  X(01).               06870062
068800         10  MR-NBR-ITEMS               PIC  Z(05).               06880062
068900                                                                  06890062
069000         10  MR-REQ-PULL-UNITSL         PIC S9(04) COMP.          06900062
069100         10  MR-REQ-PULL-UNITSA         PIC  X(01).               06910062
069200         10  MR-REQ-PULL-UNITSC         PIC  X(01).               06920062
069300         10  MR-REQ-PULL-UNITSH         PIC  X(01).               06930062
069400         10  MR-REQ-PULL-UNITS          PIC  Z(06).               06940062
069500                                                                  06950062
069600         10  MR-DISTRBUTED-UNITSL       PIC S9(04) COMP.          06960062
069700         10  MR-DISTRBUTED-UNITSA       PIC  X(01).               06970062
069800         10  MR-DISTRBUTED-UNITSC       PIC  X(01).               06980062
069900         10  MR-DISTRBUTED-UNITSH       PIC  X(01).               06990062
070000         10  MR-DISTRBUTED-UNITS        PIC  X(07).               07000062
070100                                                                  07010062
070200         10  MR-VARIANCE-UNITSL         PIC S9(04) COMP.          07020062
070300         10  MR-VARIANCE-UNITSA         PIC  X(01).               07030062
070400         10  MR-VARIANCE-UNITSC         PIC  X(01).               07040062
070500         10  MR-VARIANCE-UNITSH         PIC  X(01).               07050062
070600         10  MR-VARIANCE-UNITS          PIC  Z(05)-.              07060062
070700                                                                  07070062
070800     05  FILLER                         PIC  X(12).               07080062
070900                                                                  07090062
071000                                                                  07100062
071100*----------------------------------------------------------------*07110062
071200*  SENDING/RECEIVING AREA FOR THE                                *07120062
071300*  PRINTER VALIDATION ROUTING (DPKCS060)                         *07130062
071400*----------------------------------------------------------------*07140062
071500     COPY DPWS072.                                                07150062
071600                                                                  07160062
071700                                                                  07170062
071800*----------------------------------------------------------------*07180062
071900**  SECURITY SUBROUTINE PARAMETERS                                07190062
072000*----------------------------------------------------------------*07200062
072100     COPY DPWS008.                                                07210062
072200                                                                  07220062
072300                                                                  07230062
072400*---------------------------------------------------------------* 07240062
072500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 07250062
072600*---------------------------------------------------------------* 07260062
072700                                                                  07270062
072800     COPY DPWS015.                                                07280062
072900                                                                  07290062
073000*---------------------------------------------------------------* 07300062
073100*    FUNCTION KEYS COPYBOOK.                                    * 07310062
073200*---------------------------------------------------------------* 07320062
073300                                                                  07330062
073400     COPY DPWS016.                                                07340062
073500                                                                  07350062
073600*---------------------------------------------------------------* 07360062
073700*    NUMERIC EDIT LAYOUT.                                       * 07370062
073800*---------------------------------------------------------------* 07380062
073900                                                                  07390062
074000     COPY DPWS010I.                                               07400062
074100 EJECT                                                            07410062
074200*---------------------------------------------------------------* 07420062
074300*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 07430073
074400*---------------------------------------------------------------* 07440062
074500                                                                  07450062
074600     COPY DPWS030.                                                07460062
CICS       COPY DPWS930.                                                07461073
074700 EJECT                                                            07470062
074800*---------------------------------------------------------------* 07480062
074900*    STANDARD COMMAREA.                                         * 07490062
075000*---------------------------------------------------------------* 07500062
075100                                                                  07510062
075200     COPY DPWS020.                                                07520062
075300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07530062
075400                                                                  07540062
075500*---------------------------------------------------------------* 07550062
075600* INTER-APPLICATION COMMAREA.                                   * 07560062
075700*   CEWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07570062
075800*             SPEC SCREEN.                                      * 07580062
075900*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07590062
076000*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 07600062
076100*---------------------------------------------------------------* 07610062
076200                                                                  07620062
076300         10  INTER-APPL-COMM-AREA       PIC X(200).               07630062
076400     COPY CEWS001.                                                07640062
076500     COPY CEWS002.                                                07650062
076600*---------------------------------------------------------------* 07660062
076700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07670062
076800*---------------------------------------------------------------* 07680062
076900         10  ASC-SPECIFIC-COMMAREA.                               07690062
077000             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          07700062
077100             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 07710062
077200                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          07720062
077300             15  ASC-CURR-FCLTY-ID           PIC  X(04).          07730062
077400             15  ASC-CURR-FCLTY-ID-N REDEFINES                    07740062
077500                     ASC-CURR-FCLTY-ID       PIC  9(04).          07750062
077600             15  ASC-CS-LOC                  PIC  X(04).          07760062
077700             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               07770062
077800                 20  ASC-CS-LOC-N            PIC  9(04).          07780062
077900             15  ASC-CS-LOCATION-DESC        PIC  X(25).          07790062
078000             15  ASC-CS-PRINTER-ID           PIC  X(08).          07800062
078100             15  ASC-PULL-NBR                PIC  X(09).          07810062
078200             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           07820062
078300                 20  ASC-PULL-NBR-N          PIC  9(09).          07830062
078400             15  ASC-REF-NBR                 PIC  X(15).          07840062
078500             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          07850062
078600                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    07860062
078700                                                   'I' 'N' 'P'    07870062
078800                                                   ' '.           07880062
078900                 88  ASC-PULL-STATUS-ENTERED VALUE 'A' 'C' 'D'    07890062
079000                                                   'I' 'N' 'P'.   07900062
079100                 88  ASC-SELECT-ALL               VALUE 'A'.      07910062
079200                 88  ASC-SELECT-CNCLD             VALUE 'C'.      07920062
079300                 88  ASC-SELECT-DSTRB             VALUE 'D'.      07930062
079400                 88  ASC-SELECT-INPROC            VALUE 'I'.      07940062
079500                 88  ASC-SELECT-NEW               VALUE 'N'.      07950062
079600                 88  ASC-SELECT-POSTD             VALUE 'P'.      07960062
079700                 88  ASC-SELECT-NEW-INPROC        VALUE 'Z'.      07970062
079800             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          07980062
079900**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      07990062
080000                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    08000062
080100                                                   'M' ' ' 'X'.   08010062
080200**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      08020062
080300                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    08030062
080400                                                   'M' 'X'.       08040062
080500                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      08050062
080600*TS 08/02/2010 BEG                                                08060062
080700*                88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      08070062
080800                 88  ASC-SELECT-SRC-ALOC          VALUE 'D'.      08080062
080900*                88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      08090062
081000                 88  ASC-SELECT-SRC-REPL          VALUE 'I'.      08100062
081100*TS 08/02/2010 END                                                08110062
081200                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      08120062
081300**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      08130062
081400                 88  ASC-SELECT-SRC-XFER          VALUE 'X'.      08140062
081500             15  ASC-PULL-SELECT-DATE-FROM.                       08150062
081600                 20  ASC-FROM-MM             PIC  9(02).          08160062
081700                 20  ASC-FROM-DD             PIC  9(02).          08170062
081800                 20  ASC-FROM-YY             PIC  9(04).          08180062
081900             15  ASC-PULL-SELECT-DATE-TO.                         08190062
082000                 20  ASC-TO-MM               PIC  9(02).          08200062
082100                 20  ASC-TO-DD               PIC  9(02).          08210062
082200                 20  ASC-TO-YY               PIC  9(04).          08220062
082300             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          08230062
082400                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   08240062
082500                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       08250062
082600                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      08260062
082700                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      08270062
082800             15  ASC-CURR-PULL-STATUS        PIC  X(02).          08280062
082900                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     08290062
083000                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     08300062
083100                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     08310062
083200                 88  ASC-PULL-NEW                 VALUE 'NW'.     08320062
083300                 88  ASC-PULL-POSTED              VALUE 'PD'.     08330062
083400             15  ASC-CURR-PULL-TYPE          PIC  X(02).          08340062
083500*TS 08/02/2010 BEG                                                08350062
083600*                88  ASC-PULL-SRC-ADAM            VALUE 'MA'.     08360062
083700                 88  ASC-PULL-SRC-ALOC            VALUE 'MA'.     08370062
083800*                88  ASC-PULL-SRC-INFOREM         VALUE 'MR'.     08380062
083900                 88  ASC-PULL-SRC-REPL            VALUE 'MR'.     08390062
084000*TS 08/02/2010 END                                                08400062
084100                 88  ASC-PULL-SRC-MANUAL          VALUE 'UC'.     08410062
084200**DJK - 05/04/10 - ADDED FLAG BELOW FOR EFC2                      08420062
084300                 88  ASC-PULL-SRC-XFER            VALUE 'XF'.     08430062
084400             15  ASC-CONFIRM-TYPE-IND        PIC  X(01).          08440062
084500                 88  ASC-CONFIRM-TYPE-NONE              VALUE 'N'.08450062
084600                 88  ASC-CONFIRM-CNCL-PULL              VALUE 'A'.08460062
084700                 88  ASC-CONFIRM-UNCNCL-PULL            VALUE 'B'.08470062
084800                 88  ASC-CONFIRM-CONF-DIST              VALUE 'C'.08480062
084900                 88  ASC-CONFIRM-UNCONF-DIST            VALUE 'D'.08490062
085000                 88  ASC-CONFIRM-CONF-PULL              VALUE 'E'.08500062
085100                 88  ASC-CONFIRM-UNCONF-PULL            VALUE 'F'.08510062
085200             15  ASC-DEPT-NBR                PIC  X(03).          08520062
085300             15  ASC-DEPT-NBR-R REDEFINES ASC-DEPT-NBR.           08530062
085400                 20  ASC-DEPT-NBR-N          PIC  9(03).          08540062
085500*TS 08/02/2010 BEG                                                08550062
085600             15  ASC-MAJ-CLASS               PIC  X(02).          08560062
085700             15  ASC-SUB-CLASS               PIC  X(02).          08570062
085800*TS 08/02/2010 END                                                08580062
085900                                                                  08590062
086000                                                                  08600062
086100             15  FILLER                      PIC  X(120).         08610062
086200*-----------------------------------------------------------------08620062
086300             15  ASC-BLK-SUB                         PIC S9(04)   08630062
086400                                                          COMP    08640062
086500                                                          SYNC.   08650062
086600             15  ASC-ITEM-SUB                        PIC S9(04)   08660062
086700                                                          COMP    08670062
086800                                                          SYNC.   08680062
086900             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   08690062
087000                                                          COMP-3. 08700062
087100             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   08710062
087200                                                          COMP-3. 08720062
087300             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   08730062
087400                                                          COMP-3. 08740062
087500             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   08750062
087600                                                          COMP-3. 08760062
087700             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   08770062
087800                                                          COMP-3. 08780062
087900             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   08790062
088000                                                          COMP    08800062
088100                                                          SYNC.   08810062
088200             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   08820062
088300                                                          COMP-3. 08830062
088400             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   08840062
088500                                                          COMP-3. 08850062
088600             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  08860062
088700                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   08870062
088800                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   08880062
088900             15  ASC-XCNTL-TO-RESEND-SW              PIC  X(01).  08890062
089000                 88  ASC-XCNTL-TO-RESEND             VALUE 'Y'.   08900062
089100                 88  ASC-XCNTL-TO-RESEND-NO          VALUE 'N'.   08910062
089200             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  08920062
089300                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   08930062
089400                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   08940062
089500             15  ASC-LIST-QUEUE-NAME.                             08950062
089600                 20  ASC-LIST-TERM-ID                PIC  X(04).  08960062
089700                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   08970062
089800                                                          COMP-3. 08980062
089900                 20  ASC-LIST-SEQ                    PIC  9(01).  08990062
090000             15  ASC-SEL-QUEUE-NAME.                              09000062
090100                 20  ASC-SEL-TERM-ID                 PIC  X(04).  09010062
090200                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   09020062
090300                                                          COMP-3. 09030062
090400                 20  ASC-SEL-SEQ                     PIC  9(01).  09040062
090500                                                                  09050062
090600             15  ASC-START-ITEM-REQUEST.                          09060062
090700                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  09070062
090800             15  ASC-CURSOR-SW                       PIC  X(02).  09080062
090900                 88  ASC-NO-CURSOR                   VALUE 'Z '.  09090062
091000                 88  ASC-PULL-REF-NBR-CURSOR         VALUE 'A '.  09100062
091100                 88  ASC-PULL-REF-NBR-DEPT-CURSOR    VALUE 'A2'.  09110062
091200                 88  ASC-PULL-REFNBR-AL-CSR          VALUE 'B '.  09120062
091300                 88  ASC-PULL-REFNBR-AL-DEPT-CSR     VALUE 'B2'.  09130062
091400                 88  ASC-PULL-NUMBER-CURSOR          VALUE 'C '.  09140062
091500                 88  ASC-PULL-NUMBER-DEPT-CURSOR      VALUE 'C2'. 09150062
091600                 88  ASC-PULL-NBR-ALL-CURSOR         VALUE 'D '.  09160062
091700                 88  ASC-PULL-NBR-ALL-DEPT-CURSOR    VALUE 'D2'.  09170062
091800                 88  ASC-REF-NBR-PULL-CURSOR         VALUE 'E '.  09180062
091900                 88  ASC-REF-NBR-DEPT-PULL-CURSOR    VALUE 'E2'.  09190062
092000                 88  ASC-REF-NBR-ALL-PULL-CSR        VALUE 'F '.  09200062
092100                 88  ASC-REF-NBR-ALL-DEPT-PULL-CSR   VALUE 'F2'.  09210062
092200                 88  ASC-REF-NBR-DATE-CURSOR         VALUE 'G '.  09220062
092300                 88  ASC-REF-NBR-DEPT-DATE-CURSOR    VALUE 'G2'.  09230062
092400                 88  ASC-REF-NBR-ALL-DATE-CSR        VALUE 'H '.  09240062
092500                 88  ASC-REF-NBR-ALL-DEPT-DATE-CSR   VALUE 'H2'.  09250062
092600                 88  ASC-NO-NBR-PULL-CURSOR          VALUE 'I '.  09260062
092700                 88  ASC-NO-NBR-DEPT-PULL-CURSOR     VALUE 'I2'.  09270062
092800                 88  ASC-NO-NBR-ALL-PULL-CSR         VALUE 'J '.  09280062
092900                 88  ASC-NO-NBR-ALL-DEPT-PULL-CSR    VALUE 'J2'.  09290062
093000                 88  ASC-NO-NBR-DATE-CURSOR          VALUE 'K '.  09300062
093100                 88  ASC-NO-NBR-DEPT-DATE-CURSOR     VALUE 'K2'.  09310062
093200                 88  ASC-NO-NBR-ALL-DATE-CSR         VALUE 'L '.  09320062
093300                 88  ASC-NO-NBR-ALL-DEPT-DATE-CSR    VALUE 'L2'.  09330062
093400*TS 08/02/2010 BEG                                                09340062
093500                 88  ASC-PULL-REFNBR-AL-MAJCL-CSR    VALUE 'B3'.  09350062
093600                 88  ASC-PULL-REFNBR-AL-SUBCL-CSR    VALUE 'B4'.  09360062
093700                 88  ASC-PULL-REF-NBR-MAJCL-CURSOR   VALUE 'A3'.  09370062
093800                 88  ASC-PULL-REF-NBR-SUBCL-CURSOR   VALUE 'A4'.  09380062
093900                 88  ASC-PULL-NBR-ALL-MAJCL-CURSOR   VALUE 'D3'.  09390062
094000                 88  ASC-PULL-NBR-ALL-SUBCL-CURSOR   VALUE 'D4'.  09400062
094100                 88  ASC-PULL-NUMBER-MAJCL-CURSOR    VALUE 'C3'.  09410062
094200                 88  ASC-PULL-NUMBER-SUBCL-CURSOR    VALUE 'C4'.  09420062
094300                 88  ASC-REF-NBR-ALL-MAJCL-PULL-CSR  VALUE 'F3'.  09430062
094400                 88  ASC-REF-NBR-ALL-SUBCL-PULL-CSR  VALUE 'F4'.  09440062
094500                 88  ASC-REF-NBR-MAJCL-PULL-CURSOR   VALUE 'E3'.  09450062
094600                 88  ASC-REF-NBR-SUBCL-PULL-CURSOR   VALUE 'E4'.  09460062
094700                 88  ASC-REF-NBR-ALL-MAJCL-DATE-CSR  VALUE 'H3'.  09470062
094800                 88  ASC-REF-NBR-ALL-SUBCL-DATE-CSR  VALUE 'H4'.  09480062
094900                 88  ASC-REF-NBR-MAJCL-DATE-CURSOR   VALUE 'G3'.  09490062
095000                 88  ASC-REF-NBR-SUBCL-DATE-CURSOR   VALUE 'G4'.  09500062
095100                 88  ASC-NBR-ALL-MAJCL-PULL-CSR      VALUE 'J3'.  09510062
095200                 88  ASC-NBR-ALL-SUBCL-PULL-CSR      VALUE 'J4'.  09520062
095300                 88  ASC-NO-NBR-MAJCL-PULL-CURSOR    VALUE 'I3'.  09530062
095400                 88  ASC-NO-NBR-SUBCL-PULL-CURSOR    VALUE 'I4'.  09540062
095500                 88  ASC-NBR-ALL-MAJCL-DATE-CSR      VALUE 'L3'.  09550062
095600                 88  ASC-NBR-ALL-SUBCL-DATE-CSR      VALUE 'L4'.  09560062
095700                 88  ASC-NO-NBR-MAJCL-DATE-CURSOR    VALUE 'K3'.  09570062
095800                 88  ASC-NO-NBR-SUBCL-DATE-CURSOR    VALUE 'K4'.  09580062
095900*TS 08/02/2010 END                                                09590062
096000                                                                  09600062
096100*-----------------------------------------------------------------09610062
096200*            15  ASC-LIST-KEYS.                                   09620062
096300*                20  ASC-KEY-MESSAGE-NUMBER          PIC S9(05)   09630062
096400*                                                    COMP-3.      09640062
096500*                20  ASC-KEY-SYSTEM-ID               PIC  X(02).  09650062
096600*                20  ASC-KEY-MESSAGE-TEXT            PIC  X(30).  09660062
096700*                20  ASC-KEY-REVIEW-IND              PIC  X(01).  09670062
096800*-----------------------------------------------------------------09680062
096900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                09690062
097000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  09700062
097100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   09710062
097200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   09720062
097300                                                                  09730062
097400                 20  ASC-ITEM-ARRAY.                              09740062
097500                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        09750062
097600                         30  ASC-LIST-ITEM-NUMBER                 09760062
097700                                                     PIC S9(09)   09770062
097800                                                     COMP-3.      09780062
097900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  09790062
098000                             88  ASC-VALID-SELECT    VALUE ' '    09800062
098100                                                           'S'    09810062
098200                                                           'B'    09820062
098300                                                           'E'.   09830062
098400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   09840062
098500                             88  ASC-TEMP-SELECT     VALUE 'S'.   09850062
098600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   09860062
098700                             88  ASC-TEMP-END        VALUE 'E'.   09870062
098800                         30  ASC-SELECTED-SW         PIC  X(01).  09880062
098900                             88  ASC-NO-SELECT       VALUE ' '.   09890062
099000                             88  ASC-SELECT          VALUE 'S'.   09900062
099100                             88  ASC-BEGIN           VALUE 'B'.   09910062
099200                             88  ASC-END             VALUE 'E'.   09920062
099300                         30  ASC-ACTION              PIC  X(03).  09930062
099400                         30  ASC-PULL-NUMBER         PIC  Z(08).  09940062
099500                         30  ASC-REF-NUMBER          PIC  X(15).  09950062
099600                         30  ASC-CS-LOCATION         PIC  Z(04).  09960062
099700                         30  ASC-CREATE-DATE         PIC  X(08).  09970062
099800                         30  ASC-PULL-STATUS-CDE     PIC  X(02).  09980062
099900                         30  ASC-PULL-STATUS-DESC    PIC  X(09).  09990062
100000                         30  ASC-STATUS-DATE         PIC  X(08).  10000062
100100                         30  ASC-PULL-SOURCE-CDE     PIC  X(02).  10010062
100200                         30  ASC-PULL-SOURCE-DESC    PIC  X(04).  10020062
100300                         30  ASC-NBR-ITEMS           PIC  Z(05).  10030062
100400                         30  ASC-REQ-PULL-UNITS      PIC  Z(06).  10040062
100500                         30  ASC-ACT-PULL-UNITS      PIC  Z(06).  10050062
100600                         30  ASC-DISTRBUTED-UNITS    PIC  X(07).  10060062
100700                         30  ASC-DISTRB-UNTS-NUM     PIC S9(06).  10070062
100800                         30  ASC-VARIANCE-UNITS      PIC S9(05).  10080062
100900                         30  ASC-IN-TCEPLMF          PIC  X(01).  10090062
101000                                                                  10100062
101100     EJECT                                                        10110062
101200*---------------------------------------------------------------* 10120062
101300*    ABEND PROCESSING COPYBOOK.                                 * 10130062
101400*---------------------------------------------------------------* 10140062
101500                                                                  10150062
101600     COPY DPWS013.                                                10160062
101700                                                                  10170062
101800 EJECT                                                            10180062
101900*---------------------------------------------------------------* 10190062
102000*    TKRPRPM - KOHLS/RETEK PARAMETERS                           * 10200062
102100*---------------------------------------------------------------* 10210062
102200     EXEC SQL                                                     10220062
102300          INCLUDE TKRPRPM                                         10230062
102400     END-EXEC.                                                    10240062
102500*---------------------------------------------------------------* 10250062
102600*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 10260062
102700*---------------------------------------------------------------* 10270062
102800     EXEC SQL                                                     10280062
102900          INCLUDE TCEPLRQ                                         10290062
103000     END-EXEC.                                                    10300062
103100*---------------------------------------------------------------* 10310062
103200*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 10320062
103300*---------------------------------------------------------------* 10330062
103400     EXEC SQL                                                     10340062
103500          INCLUDE TCEPLDS                                         10350062
103600     END-EXEC.                                                    10360062
103700*---------------------------------------------------------------* 10370062
103800*    TCEPLMF - CENTRAL STOCK PULL MANIFESTED UNITS              * 10380062
103900*---------------------------------------------------------------* 10390062
104000     EXEC SQL                                                     10400062
104100          INCLUDE TCEPLMF                                         10410062
104200     END-EXEC.                                                    10420062
104300*---------------------------------------------------------------* 10430062
104400*    TCEPLAU - CENTRAL STOCK PULL ADJUSTED UNITS                * 10440062
104500*---------------------------------------------------------------* 10450062
104600     EXEC SQL                                                     10460062
104700          INCLUDE TCEPLAU                                         10470062
104800     END-EXEC.                                                    10480062
104900*---------------------------------------------------------------* 10490062
105000*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 10500062
105100*---------------------------------------------------------------* 10510062
105200     EXEC SQL                                                     10520062
105300          INCLUDE TCEPLIT                                         10530062
105400     END-EXEC.                                                    10540062
105500*---------------------------------------------------------------* 10550062
105600*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 10560062
105700*---------------------------------------------------------------* 10570062
105800     EXEC SQL                                                     10580062
105900          INCLUDE TCEPLST                                         10590062
106000     END-EXEC.                                                    10600062
106100                                                                  10610062
106200*---------------------------------------------------------------* 10620062
106300*    XLV00000               XLV_SKU VIEW          WR/IR# 230ZZ  * 10630062
106400*---------------------------------------------------------------* 10640062
106500     EXEC SQL                                                     10650062
106600          INCLUDE XLV00000                                        10660062
106700     END-EXEC.                                                    10670062
106800                                                                  10680062
106900*---------------------------------------------------------------* 10690062
107000*    XLV00001              XLV_VND_STYL VIEW      WR/IR# 230ZZ  * 10700062
107100*---------------------------------------------------------------* 10710062
107200     EXEC SQL                                                     10720062
107300          INCLUDE XLV00001                                        10730062
107400     END-EXEC.                                                    10740062
107500                                                                  10750062
107600*---------------------------------------------------------------* 10760062
107700*DJK - 05/04/10 NOTE FOR THE QUEUES BELOW   :PV-TYPE-4)           10770062
107800*  ADDED PV-TYPE-4 IN THE WHERE'S CLAUSE TO ACCOMIDATE            10780062
107900*  THE ADDITION OF EFC2                                           10790062
108000*---------------------------------------------------------------* 10800062
108100                                                                  10810062
108200*---------------------------------------------------------------* 10820062
108300*    PULL/REFERENCE NUMBER CURSOR - ALL DC'S & DEPARTMENTS      * 10830062
108400*---------------------------------------------------------------* 10840062
108500     EXEC SQL                                                     10850062
108600          DECLARE PULL-REFNBR-AL-CSR CURSOR FOR                   10860062
108700              SELECT  A.CNSTK_REQ_PL_NBR                          10870062
108800                     ,A.CNSTK_LOC_ID                              10880062
108900                     ,A.SRC_REF_NBR                               10890062
109000                     ,A.SRC_TYP_CDE                               10900062
109100                     ,A.STAT_CDE                                  10910062
109200                FROM  TCEPLRQ A                                   10920062
109300                     ,TCEPLST B                                   10930062
109400               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       10940062
109500                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        10950062
109600                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           10960062
109700                                            :PV-TYPE-2,           10970062
109800                                            :PV-TYPE-3,           10980062
109900                                            :PV-TYPE-4)           10990062
110000                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         11000062
110100                                            :PV-STATUS-2,         11010062
110200                                            :PV-STATUS-3,         11020062
110300                                            :PV-STATUS-4,         11030062
110400                                            :PV-STATUS-5)         11040062
110500                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   11050062
110600                 AND  B.STAT_CDE         =  'NW'                  11060062
110700                 AND  B.PL_LNE_NBR       =  :PC-ZERO              11070062
110800                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         11080062
110900                 AND  B.CRE_TMST        <=  :DK-TO-TMST           11090062
111000            ORDER BY  A.CNSTK_REQ_PL_NBR                          11100062
111100     END-EXEC.                                                    11110062
111200                                                                  11120062
111300*---------------------------------------------------------------* 11130062
111400*    PULL/REF/DEPT NUMBER CURSOR - ALL DC'S & 1 DEPARTMENT      * 11140062
111500*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 11150062
111600*---------------------------------------------------------------* 11160062
111700     EXEC SQL                                                     11170062
111800          DECLARE PUL-REF-DPT-AL-CSR CURSOR FOR                   11180062
111900              SELECT  DISTINCT                                    11190062
112000                      A.CNSTK_REQ_PL_NBR                          11200062
112100                     ,A.CNSTK_LOC_ID                              11210062
112200                     ,A.SRC_REF_NBR                               11220062
112300                     ,A.SRC_TYP_CDE                               11230062
112400                     ,A.STAT_CDE                                  11240062
112500                FROM  TCEPLRQ      A                              11250062
112600                     ,TCEPLST      B                              11260062
112700                     ,TCEPLIT      C                              11270062
112800                     ,XLV_SKU      D                              11280062
112900                     ,XLV_VND_STYL E                              11290062
113000               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       11300062
113100                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        11310062
113200                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           11320062
113300                                            :PV-TYPE-2,           11330062
113400                                            :PV-TYPE-3,           11340062
113500                                            :PV-TYPE-4)           11350062
113600                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         11360062
113700                                            :PV-STATUS-2,         11370062
113800                                            :PV-STATUS-3,         11380062
113900                                            :PV-STATUS-4,         11390062
114000                                            :PV-STATUS-5)         11400062
114100                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   11410062
114200                 AND  B.STAT_CDE         =  'NW'                  11420062
114300                 AND  B.PL_LNE_NBR       =  :PC-ZERO              11430062
114400                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         11440062
114500                 AND  B.CRE_TMST        <=  :DK-TO-TMST           11450062
114600                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   11460062
114700                 AND  C.ITM_NBR          =   D.ITM_NBR            11470062
114800                 AND  D.STYL_ID          =   E.STYL_ID            11480062
114900                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       11490062
115000            ORDER BY  A.CNSTK_REQ_PL_NBR                          11500062
115100     END-EXEC.                                                    11510062
115200                                                                  11520062
115300*TS 08/02/2010 BEG                                                11530062
115400*---------------------------------------------------------------* 11540062
115500     EXEC SQL                                                     11550062
115600          DECLARE PUL-REF-DPT-MAJ-AL-CSR CURSOR FOR               11560062
115700              SELECT  DISTINCT                                    11570062
115800                      A.CNSTK_REQ_PL_NBR                          11580062
115900                     ,A.CNSTK_LOC_ID                              11590062
116000                     ,A.SRC_REF_NBR                               11600062
116100                     ,A.SRC_TYP_CDE                               11610062
116200                     ,A.STAT_CDE                                  11620062
116300                FROM  TCEPLRQ      A                              11630062
116400                     ,TCEPLST      B                              11640062
116500                     ,TCEPLIT      C                              11650062
116600                     ,XLV_SKU      D                              11660062
116700                     ,XLV_VND_STYL E                              11670062
116800               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       11680062
116900                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        11690062
117000                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           11700062
117100                                            :PV-TYPE-2,           11710062
117200                                            :PV-TYPE-3,           11720062
117300                                            :PV-TYPE-4)           11730062
117400                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         11740062
117500                                            :PV-STATUS-2,         11750062
117600                                            :PV-STATUS-3,         11760062
117700                                            :PV-STATUS-4,         11770062
117800                                            :PV-STATUS-5)         11780062
117900                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   11790062
118000                 AND  B.STAT_CDE         =  'NW'                  11800062
118100                 AND  B.PL_LNE_NBR       =  :PC-ZERO              11810062
118200                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         11820062
118300                 AND  B.CRE_TMST        <=  :DK-TO-TMST           11830062
118400                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   11840062
118500                 AND  C.ITM_NBR          =   D.ITM_NBR            11850062
118600                 AND  D.STYL_ID          =   E.STYL_ID            11860062
118700                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       11870062
118800                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        11880062
118900            ORDER BY  A.CNSTK_REQ_PL_NBR                          11890062
119000     END-EXEC.                                                    11900062
119100                                                                  11910062
119200*---------------------------------------------------------------* 11920062
119300     EXEC SQL                                                     11930062
119400          DECLARE PUL-REF-DPT-MAJ-SUB-AL-CSR CURSOR FOR           11940062
119500              SELECT  DISTINCT                                    11950062
119600                      A.CNSTK_REQ_PL_NBR                          11960062
119700                     ,A.CNSTK_LOC_ID                              11970062
119800                     ,A.SRC_REF_NBR                               11980062
119900                     ,A.SRC_TYP_CDE                               11990062
120000                     ,A.STAT_CDE                                  12000062
120100                FROM  TCEPLRQ      A                              12010062
120200                     ,TCEPLST      B                              12020062
120300                     ,TCEPLIT      C                              12030062
120400                     ,XLV_SKU      D                              12040062
120500                     ,XLV_VND_STYL E                              12050062
120600               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       12060062
120700                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        12070062
120800                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           12080062
120900                                            :PV-TYPE-2,           12090062
121000                                            :PV-TYPE-3,           12100062
121100                                            :PV-TYPE-4)           12110062
121200                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         12120062
121300                                            :PV-STATUS-2,         12130062
121400                                            :PV-STATUS-3,         12140062
121500                                            :PV-STATUS-4,         12150062
121600                                            :PV-STATUS-5)         12160062
121700                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   12170062
121800                 AND  B.STAT_CDE         =  'NW'                  12180062
121900                 AND  B.PL_LNE_NBR       =  :PC-ZERO              12190062
122000                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         12200062
122100                 AND  B.CRE_TMST        <=  :DK-TO-TMST           12210062
122200                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   12220062
122300                 AND  C.ITM_NBR          =   D.ITM_NBR            12230062
122400                 AND  D.STYL_ID          =   E.STYL_ID            12240062
122500                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       12250062
122600                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        12260062
122700                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        12270062
122800            ORDER BY  A.CNSTK_REQ_PL_NBR                          12280062
122900     END-EXEC.                                                    12290062
123000                                                                  12300062
123100*TS 08/02/2010 END                                                12310062
123200*---------------------------------------------------------------* 12320062
123300*    PULL/REFERENCE NUMBER CURSOR - 1 DC - ALL DEPARTMENTS      * 12330062
123400*---------------------------------------------------------------* 12340062
123500     EXEC SQL                                                     12350062
123600          DECLARE PULL-REF-NBR-CSR CURSOR FOR                     12360062
123700              SELECT  A.CNSTK_REQ_PL_NBR                          12370062
123800                     ,A.CNSTK_LOC_ID                              12380062
123900                     ,A.SRC_REF_NBR                               12390062
124000                     ,A.SRC_TYP_CDE                               12400062
124100                     ,A.STAT_CDE                                  12410062
124200                FROM  TCEPLRQ A                                   12420062
124300                     ,TCEPLST B                                   12430062
124400               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       12440062
124500                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        12450062
124600                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            12460062
124700                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           12470062
124800                                            :PV-TYPE-2,           12480062
124900                                            :PV-TYPE-3,           12490062
125000                                            :PV-TYPE-4)           12500062
125100                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         12510062
125200                                            :PV-STATUS-2,         12520062
125300                                            :PV-STATUS-3,         12530062
125400                                            :PV-STATUS-4,         12540062
125500                                            :PV-STATUS-5)         12550062
125600                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   12560062
125700                 AND  B.STAT_CDE         =  'NW'                  12570062
125800                 AND  B.PL_LNE_NBR       =  :PC-ZERO              12580062
125900                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         12590062
126000                 AND  B.CRE_TMST        <=  :DK-TO-TMST           12600062
126100            ORDER BY  A.CNSTK_REQ_PL_NBR                          12610062
126200     END-EXEC.                                                    12620062
126300                                                                  12630062
126400*---------------------------------------------------------------* 12640062
126500*    PULL/REFERENCE NUMBER CURSOR - 1 DC - 1 DEPARTMENT         * 12650062
126600*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 12660062
126700*---------------------------------------------------------------* 12670062
126800     EXEC SQL                                                     12680062
126900          DECLARE PULL-REF-DEPT-CSR CURSOR FOR                    12690062
127000              SELECT  DISTINCT                                    12700062
127100                      A.CNSTK_REQ_PL_NBR                          12710062
127200                     ,A.CNSTK_LOC_ID                              12720062
127300                     ,A.SRC_REF_NBR                               12730062
127400                     ,A.SRC_TYP_CDE                               12740062
127500                     ,A.STAT_CDE                                  12750062
127600                FROM  TCEPLRQ      A                              12760062
127700                     ,TCEPLST      B                              12770062
127800                     ,TCEPLIT      C                              12780062
127900                     ,XLV_SKU      D                              12790062
128000                     ,XLV_VND_STYL E                              12800062
128100               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       12810062
128200                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        12820062
128300                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            12830062
128400                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           12840062
128500                                            :PV-TYPE-2,           12850062
128600                                            :PV-TYPE-3,           12860062
128700                                            :PV-TYPE-4)           12870062
128800                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         12880062
128900                                            :PV-STATUS-2,         12890062
129000                                            :PV-STATUS-3,         12900062
129100                                            :PV-STATUS-4,         12910062
129200                                            :PV-STATUS-5)         12920062
129300                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   12930062
129400                 AND  B.STAT_CDE         =  'NW'                  12940062
129500                 AND  B.PL_LNE_NBR       =  :PC-ZERO              12950062
129600                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         12960062
129700                 AND  B.CRE_TMST        <=  :DK-TO-TMST           12970062
129800                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   12980062
129900                 AND  C.ITM_NBR          =   D.ITM_NBR            12990062
130000                 AND  D.STYL_ID          =   E.STYL_ID            13000062
130100                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       13010062
130200            ORDER BY  A.CNSTK_REQ_PL_NBR                          13020062
130300     END-EXEC.                                                    13030062
130400                                                                  13040062
130500*TS 08/02/2010 BEG                                                13050062
130600*---------------------------------------------------------------* 13060062
130700     EXEC SQL                                                     13070062
130800          DECLARE PULL-REF-DEPT-MAJ-CSR CURSOR FOR                13080062
130900              SELECT  DISTINCT                                    13090062
131000                      A.CNSTK_REQ_PL_NBR                          13100062
131100                     ,A.CNSTK_LOC_ID                              13110062
131200                     ,A.SRC_REF_NBR                               13120062
131300                     ,A.SRC_TYP_CDE                               13130062
131400                     ,A.STAT_CDE                                  13140062
131500                FROM  TCEPLRQ      A                              13150062
131600                     ,TCEPLST      B                              13160062
131700                     ,TCEPLIT      C                              13170062
131800                     ,XLV_SKU      D                              13180062
131900                     ,XLV_VND_STYL E                              13190062
132000               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       13200062
132100                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        13210062
132200                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            13220062
132300                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           13230062
132400                                            :PV-TYPE-2,           13240062
132500                                            :PV-TYPE-3,           13250062
132600                                            :PV-TYPE-4)           13260062
132700                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         13270062
132800                                            :PV-STATUS-2,         13280062
132900                                            :PV-STATUS-3,         13290062
133000                                            :PV-STATUS-4,         13300062
133100                                            :PV-STATUS-5)         13310062
133200                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   13320062
133300                 AND  B.STAT_CDE         =  'NW'                  13330062
133400                 AND  B.PL_LNE_NBR       =  :PC-ZERO              13340062
133500                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         13350062
133600                 AND  B.CRE_TMST        <=  :DK-TO-TMST           13360062
133700                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   13370062
133800                 AND  C.ITM_NBR          =   D.ITM_NBR            13380062
133900                 AND  D.STYL_ID          =   E.STYL_ID            13390062
134000                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       13400062
134100                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        13410062
134200            ORDER BY  A.CNSTK_REQ_PL_NBR                          13420062
134300     END-EXEC.                                                    13430062
134400                                                                  13440062
134500*---------------------------------------------------------------* 13450062
134600     EXEC SQL                                                     13460062
134700          DECLARE PULL-REF-DEPT-MAJ-SUB-CSR CURSOR FOR            13470062
134800              SELECT  DISTINCT                                    13480062
134900                      A.CNSTK_REQ_PL_NBR                          13490062
135000                     ,A.CNSTK_LOC_ID                              13500062
135100                     ,A.SRC_REF_NBR                               13510062
135200                     ,A.SRC_TYP_CDE                               13520062
135300                     ,A.STAT_CDE                                  13530062
135400                FROM  TCEPLRQ      A                              13540062
135500                     ,TCEPLST      B                              13550062
135600                     ,TCEPLIT      C                              13560062
135700                     ,XLV_SKU      D                              13570062
135800                     ,XLV_VND_STYL E                              13580062
135900               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       13590062
136000                 AND  A.SRC_REF_NBR      =  :DK-REF-NUMBER        13600062
136100                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            13610062
136200                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           13620062
136300                                            :PV-TYPE-2,           13630062
136400                                            :PV-TYPE-3,           13640062
136500                                            :PV-TYPE-4)           13650062
136600                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         13660062
136700                                            :PV-STATUS-2,         13670062
136800                                            :PV-STATUS-3,         13680062
136900                                            :PV-STATUS-4,         13690062
137000                                            :PV-STATUS-5)         13700062
137100                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   13710062
137200                 AND  B.STAT_CDE         =  'NW'                  13720062
137300                 AND  B.PL_LNE_NBR       =  :PC-ZERO              13730062
137400                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         13740062
137500                 AND  B.CRE_TMST        <=  :DK-TO-TMST           13750062
137600                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   13760062
137700                 AND  C.ITM_NBR          =   D.ITM_NBR            13770062
137800                 AND  D.STYL_ID          =   E.STYL_ID            13780062
137900                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       13790062
138000                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        13800062
138100                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        13810062
138200            ORDER BY  A.CNSTK_REQ_PL_NBR                          13820062
138300     END-EXEC.                                                    13830062
138400                                                                  13840062
138500*TS 08/02/2010 END                                                13850062
138600                                                                  13860062
138700*---------------------------------------------------------------* 13870062
138800*    PULL NUMBER CURSOR - ALL DC'S - ALL DEPARTMENTS            * 13880062
138900*---------------------------------------------------------------* 13890062
139000     EXEC SQL                                                     13900062
139100          DECLARE PULL-NBR-ALL-CSR CURSOR FOR                     13910062
139200              SELECT  A.CNSTK_REQ_PL_NBR                          13920062
139300                     ,A.CNSTK_LOC_ID                              13930062
139400                     ,A.SRC_REF_NBR                               13940062
139500                     ,A.SRC_TYP_CDE                               13950062
139600                     ,A.STAT_CDE                                  13960062
139700                FROM  TCEPLRQ A                                   13970062
139800                     ,TCEPLST B                                   13980062
139900               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       13990062
140000                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           14000062
140100                                            :PV-TYPE-2,           14010062
140200                                            :PV-TYPE-3,           14020062
140300                                            :PV-TYPE-4)           14030062
140400                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         14040062
140500                                            :PV-STATUS-2,         14050062
140600                                            :PV-STATUS-3,         14060062
140700                                            :PV-STATUS-4,         14070062
140800                                            :PV-STATUS-5)         14080062
140900                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   14090062
141000                 AND  B.STAT_CDE         =  'NW'                  14100062
141100                 AND  B.PL_LNE_NBR       =  :PC-ZERO              14110062
141200                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         14120062
141300                 AND  B.CRE_TMST        <=  :DK-TO-TMST           14130062
141400            ORDER BY  A.CNSTK_REQ_PL_NBR                          14140062
141500     END-EXEC.                                                    14150062
141600                                                                  14160062
141700                                                                  14170062
141800*---------------------------------------------------------------* 14180062
141900*    PULL NUMBER CURSOR - ALL DC'S - 1 DEPARTMENT               * 14190062
142000*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 14200062
142100*---------------------------------------------------------------* 14210062
142200     EXEC SQL                                                     14220062
142300          DECLARE PUL-NBR-DPT-AL-CSR CURSOR FOR                   14230062
142400              SELECT  DISTINCT                                    14240062
142500                      A.CNSTK_REQ_PL_NBR                          14250062
142600                     ,A.CNSTK_LOC_ID                              14260062
142700                     ,A.SRC_REF_NBR                               14270062
142800                     ,A.SRC_TYP_CDE                               14280062
142900                     ,A.STAT_CDE                                  14290062
143000                FROM  TCEPLRQ      A                              14300062
143100                     ,TCEPLST      B                              14310062
143200                     ,TCEPLIT      C                              14320062
143300                     ,XLV_SKU      D                              14330062
143400                     ,XLV_VND_STYL E                              14340062
143500               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       14350062
143600                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           14360062
143700                                            :PV-TYPE-2,           14370062
143800                                            :PV-TYPE-3,           14380062
143900                                            :PV-TYPE-4)           14390062
144000                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         14400062
144100                                            :PV-STATUS-2,         14410062
144200                                            :PV-STATUS-3,         14420062
144300                                            :PV-STATUS-4,         14430062
144400                                            :PV-STATUS-5)         14440062
144500                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   14450062
144600                 AND  B.STAT_CDE         =  'NW'                  14460062
144700                 AND  B.PL_LNE_NBR       =  :PC-ZERO              14470062
144800                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         14480062
144900                 AND  B.CRE_TMST        <=  :DK-TO-TMST           14490062
145000                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   14500062
145100*                AND  C.ITM_NBR          =   D.ITEM_NMBR          14510062
145200                 AND  C.ITM_NBR          =   D.ITM_NBR            14520062
145300                 AND  D.STYL_ID          =   E.STYL_ID            14530062
145400                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       14540062
145500            ORDER BY  A.CNSTK_REQ_PL_NBR                          14550062
145600     END-EXEC.                                                    14560062
145700                                                                  14570062
145800*TS 08/02/2010 BEG                                                14580062
145900*---------------------------------------------------------------* 14590062
146000     EXEC SQL                                                     14600062
146100          DECLARE PUL-NBR-DPT-MAJ-AL-CSR CURSOR FOR               14610062
146200              SELECT  DISTINCT                                    14620062
146300                      A.CNSTK_REQ_PL_NBR                          14630062
146400                     ,A.CNSTK_LOC_ID                              14640062
146500                     ,A.SRC_REF_NBR                               14650062
146600                     ,A.SRC_TYP_CDE                               14660062
146700                     ,A.STAT_CDE                                  14670062
146800                FROM  TCEPLRQ      A                              14680062
146900                     ,TCEPLST      B                              14690062
147000                     ,TCEPLIT      C                              14700062
147100                     ,XLV_SKU      D                              14710062
147200                     ,XLV_VND_STYL E                              14720062
147300               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       14730062
147400                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           14740062
147500                                            :PV-TYPE-2,           14750062
147600                                            :PV-TYPE-3,           14760062
147700                                            :PV-TYPE-4)           14770062
147800                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         14780062
147900                                            :PV-STATUS-2,         14790062
148000                                            :PV-STATUS-3,         14800062
148100                                            :PV-STATUS-4,         14810062
148200                                            :PV-STATUS-5)         14820062
148300                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   14830062
148400                 AND  B.STAT_CDE         =  'NW'                  14840062
148500                 AND  B.PL_LNE_NBR       =  :PC-ZERO              14850062
148600                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         14860062
148700                 AND  B.CRE_TMST        <=  :DK-TO-TMST           14870062
148800                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   14880062
148900                 AND  C.ITM_NBR          =   D.ITM_NBR            14890062
149000                 AND  D.STYL_ID          =   E.STYL_ID            14900062
149100                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       14910062
149200                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        14920062
149300            ORDER BY  A.CNSTK_REQ_PL_NBR                          14930062
149400     END-EXEC.                                                    14940062
149500                                                                  14950062
149600*---------------------------------------------------------------* 14960062
149700     EXEC SQL                                                     14970062
149800          DECLARE PUL-NBR-DPT-MAJ-SUB-AL-CSR CURSOR FOR           14980062
149900              SELECT  DISTINCT                                    14990062
150000                      A.CNSTK_REQ_PL_NBR                          15000062
150100                     ,A.CNSTK_LOC_ID                              15010062
150200                     ,A.SRC_REF_NBR                               15020062
150300                     ,A.SRC_TYP_CDE                               15030062
150400                     ,A.STAT_CDE                                  15040062
150500                FROM  TCEPLRQ      A                              15050062
150600                     ,TCEPLST      B                              15060062
150700                     ,TCEPLIT      C                              15070062
150800                     ,XLV_SKU      D                              15080062
150900                     ,XLV_VND_STYL E                              15090062
151000               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       15100062
151100                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           15110062
151200                                            :PV-TYPE-2,           15120062
151300                                            :PV-TYPE-3,           15130062
151400                                            :PV-TYPE-4)           15140062
151500                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         15150062
151600                                            :PV-STATUS-2,         15160062
151700                                            :PV-STATUS-3,         15170062
151800                                            :PV-STATUS-4,         15180062
151900                                            :PV-STATUS-5)         15190062
152000                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   15200062
152100                 AND  B.STAT_CDE         =  'NW'                  15210062
152200                 AND  B.PL_LNE_NBR       =  :PC-ZERO              15220062
152300                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         15230062
152400                 AND  B.CRE_TMST        <=  :DK-TO-TMST           15240062
152500                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   15250062
152600                 AND  C.ITM_NBR          =   D.ITM_NBR            15260062
152700                 AND  D.STYL_ID          =   E.STYL_ID            15270062
152800                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       15280062
152900                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        15290062
153000                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        15300062
153100            ORDER BY  A.CNSTK_REQ_PL_NBR                          15310062
153200     END-EXEC.                                                    15320062
153300                                                                  15330062
153400*TS 08/02/2010 END                                                15340062
153500                                                                  15350062
153600*---------------------------------------------------------------* 15360062
153700*    PULL NUMBER CURSOR - 1 DC - ALL DEPARTMENTS                * 15370062
153800*---------------------------------------------------------------* 15380062
153900     EXEC SQL                                                     15390062
154000          DECLARE PULL-NBR-CSR CURSOR FOR                         15400062
154100              SELECT  A.CNSTK_REQ_PL_NBR                          15410062
154200                     ,A.CNSTK_LOC_ID                              15420062
154300                     ,A.SRC_REF_NBR                               15430062
154400                     ,A.SRC_TYP_CDE                               15440062
154500                     ,A.STAT_CDE                                  15450062
154600                FROM  TCEPLRQ A                                   15460062
154700                     ,TCEPLST B                                   15470062
154800               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       15480062
154900                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            15490062
155000                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           15500062
155100                                            :PV-TYPE-2,           15510062
155200                                            :PV-TYPE-3,           15520062
155300                                            :PV-TYPE-4)           15530062
155400                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         15540062
155500                                            :PV-STATUS-2,         15550062
155600                                            :PV-STATUS-3,         15560062
155700                                            :PV-STATUS-4,         15570062
155800                                            :PV-STATUS-5)         15580062
155900                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   15590062
156000                 AND  B.STAT_CDE         =  'NW'                  15600062
156100                 AND  B.PL_LNE_NBR       =  :PC-ZERO              15610062
156200                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         15620062
156300                 AND  B.CRE_TMST        <=  :DK-TO-TMST           15630062
156400            ORDER BY  A.CNSTK_REQ_PL_NBR                          15640062
156500     END-EXEC.                                                    15650062
156600                                                                  15660062
156700*---------------------------------------------------------------* 15670062
156800*    PULL NUMBER CURSOR - 1 DC - 1 DEPARTMENT                  * 15680062
156900*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 15690062
157000*---------------------------------------------------------------* 15700062
157100     EXEC SQL                                                     15710062
157200          DECLARE PULL-NBR-DEPT-CSR CURSOR FOR                    15720062
157300              SELECT  DISTINCT                                    15730062
157400                      A.CNSTK_REQ_PL_NBR                          15740062
157500                     ,A.CNSTK_LOC_ID                              15750062
157600                     ,A.SRC_REF_NBR                               15760062
157700                     ,A.SRC_TYP_CDE                               15770062
157800                     ,A.STAT_CDE                                  15780062
157900                FROM  TCEPLRQ      A                              15790062
158000                     ,TCEPLST      B                              15800062
158100                     ,TCEPLIT      C                              15810062
158200                     ,XLV_SKU      D                              15820062
158300                     ,XLV_VND_STYL E                              15830062
158400               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       15840062
158500                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            15850062
158600                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           15860062
158700                                            :PV-TYPE-2,           15870062
158800                                            :PV-TYPE-3,           15880062
158900                                            :PV-TYPE-4)           15890062
159000                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         15900062
159100                                            :PV-STATUS-2,         15910062
159200                                            :PV-STATUS-3,         15920062
159300                                            :PV-STATUS-4,         15930062
159400                                            :PV-STATUS-5)         15940062
159500                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   15950062
159600                 AND  B.STAT_CDE         =  'NW'                  15960062
159700                 AND  B.PL_LNE_NBR       =  :PC-ZERO              15970062
159800                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         15980062
159900                 AND  B.CRE_TMST        <=  :DK-TO-TMST           15990062
160000                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   16000062
160100                 AND  C.ITM_NBR          =   D.ITM_NBR            16010062
160200                 AND  D.STYL_ID          =   E.STYL_ID            16020062
160300                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       16030062
160400            ORDER BY  A.CNSTK_REQ_PL_NBR                          16040062
160500     END-EXEC.                                                    16050062
160600                                                                  16060062
160700*TS 08/02/2010 BEG                                                16070062
160800*---------------------------------------------------------------* 16080062
160900     EXEC SQL                                                     16090062
161000          DECLARE PULL-NBR-DEPT-MAJ-CSR CURSOR FOR                16100062
161100              SELECT  DISTINCT                                    16110062
161200                      A.CNSTK_REQ_PL_NBR                          16120062
161300                     ,A.CNSTK_LOC_ID                              16130062
161400                     ,A.SRC_REF_NBR                               16140062
161500                     ,A.SRC_TYP_CDE                               16150062
161600                     ,A.STAT_CDE                                  16160062
161700                FROM  TCEPLRQ      A                              16170062
161800                     ,TCEPLST      B                              16180062
161900                     ,TCEPLIT      C                              16190062
162000                     ,XLV_SKU      D                              16200062
162100                     ,XLV_VND_STYL E                              16210062
162200               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       16220062
162300                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            16230062
162400                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           16240062
162500                                            :PV-TYPE-2,           16250062
162600                                            :PV-TYPE-3,           16260062
162700                                            :PV-TYPE-4)           16270062
162800                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         16280062
162900                                            :PV-STATUS-2,         16290062
163000                                            :PV-STATUS-3,         16300062
163100                                            :PV-STATUS-4,         16310062
163200                                            :PV-STATUS-5)         16320062
163300                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   16330062
163400                 AND  B.STAT_CDE         =  'NW'                  16340062
163500                 AND  B.PL_LNE_NBR       =  :PC-ZERO              16350062
163600                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         16360062
163700                 AND  B.CRE_TMST        <=  :DK-TO-TMST           16370062
163800                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   16380062
163900                 AND  C.ITM_NBR          =   D.ITM_NBR            16390062
164000                 AND  D.STYL_ID          =   E.STYL_ID            16400062
164100                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       16410062
164200                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        16420062
164300            ORDER BY  A.CNSTK_REQ_PL_NBR                          16430062
164400     END-EXEC.                                                    16440062
164500                                                                  16450062
164600*---------------------------------------------------------------* 16460062
164700     EXEC SQL                                                     16470062
164800          DECLARE PULL-NBR-DEPT-MAJ-SUB-CSR CURSOR FOR            16480062
164900              SELECT  DISTINCT                                    16490062
165000                      A.CNSTK_REQ_PL_NBR                          16500062
165100                     ,A.CNSTK_LOC_ID                              16510062
165200                     ,A.SRC_REF_NBR                               16520062
165300                     ,A.SRC_TYP_CDE                               16530062
165400                     ,A.STAT_CDE                                  16540062
165500                FROM  TCEPLRQ      A                              16550062
165600                     ,TCEPLST      B                              16560062
165700                     ,TCEPLIT      C                              16570062
165800                     ,XLV_SKU      D                              16580062
165900                     ,XLV_VND_STYL E                              16590062
166000               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       16600062
166100                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            16610062
166200                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           16620062
166300                                            :PV-TYPE-2,           16630062
166400                                            :PV-TYPE-3,           16640062
166500                                            :PV-TYPE-4)           16650062
166600                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         16660062
166700                                            :PV-STATUS-2,         16670062
166800                                            :PV-STATUS-3,         16680062
166900                                            :PV-STATUS-4,         16690062
167000                                            :PV-STATUS-5)         16700062
167100                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   16710062
167200                 AND  B.STAT_CDE         =  'NW'                  16720062
167300                 AND  B.PL_LNE_NBR       =  :PC-ZERO              16730062
167400                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         16740062
167500                 AND  B.CRE_TMST        <=  :DK-TO-TMST           16750062
167600                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   16760062
167700                 AND  C.ITM_NBR          =   D.ITM_NBR            16770062
167800                 AND  D.STYL_ID          =   E.STYL_ID            16780062
167900                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       16790062
168000                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        16800062
168100                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        16810062
168200            ORDER BY  A.CNSTK_REQ_PL_NBR                          16820062
168300     END-EXEC.                                                    16830062
168400                                                                  16840062
168500*TS 08/02/2010 END                                                16850062
168600                                                                  16860062
168700*---------------------------------------------------------------* 16870062
168800*    REF NBR CSR - PULL NUMBER ORDER - ALL DC'S - ALL DEPT.     * 16880062
168900*---------------------------------------------------------------* 16890062
169000     EXEC SQL                                                     16900062
169100          DECLARE REF-NBR-ALL-PL-CSR CURSOR FOR                   16910062
169200              SELECT  A.CNSTK_REQ_PL_NBR                          16920062
169300                     ,A.CNSTK_LOC_ID                              16930062
169400                     ,A.SRC_REF_NBR                               16940062
169500                     ,A.SRC_TYP_CDE                               16950062
169600                     ,A.STAT_CDE                                  16960062
169700                FROM  TCEPLRQ A                                   16970062
169800                     ,TCEPLST B                                   16980062
169900               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        16990062
170000                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           17000062
170100                                            :PV-TYPE-2,           17010062
170200                                            :PV-TYPE-3,           17020062
170300                                            :PV-TYPE-4)           17030062
170400                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         17040062
170500                                            :PV-STATUS-2,         17050062
170600                                            :PV-STATUS-3,         17060062
170700                                            :PV-STATUS-4,         17070062
170800                                            :PV-STATUS-5)         17080062
170900                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   17090062
171000                 AND  B.STAT_CDE         =  'NW'                  17100062
171100                 AND  B.PL_LNE_NBR       =  :PC-ZERO              17110062
171200                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         17120062
171300                 AND  B.CRE_TMST        <=  :DK-TO-TMST           17130062
171400            ORDER BY  A.CNSTK_REQ_PL_NBR                          17140062
171500     END-EXEC.                                                    17150062
171600                                                                  17160062
171700*---------------------------------------------------------------* 17170062
171800*    REF NBR CSR - PULL NUMBER ORDER - ALL DC'S - 1 DEPARTMENT  * 17180062
171900*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 17190062
172000*---------------------------------------------------------------* 17200062
172100     EXEC SQL                                                     17210062
172200          DECLARE REF-ALL-DPT-PL-CSR CURSOR FOR                   17220062
172300              SELECT  DISTINCT                                    17230062
172400                      A.CNSTK_REQ_PL_NBR                          17240062
172500                     ,A.CNSTK_LOC_ID                              17250062
172600                     ,A.SRC_REF_NBR                               17260062
172700                     ,A.SRC_TYP_CDE                               17270062
172800                     ,A.STAT_CDE                                  17280062
172900                FROM  TCEPLRQ      A                              17290062
173000                     ,TCEPLST      B                              17300062
173100                     ,TCEPLIT      C                              17310062
173200                     ,XLV_SKU      D                              17320062
173300                     ,XLV_VND_STYL E                              17330062
173400               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        17340062
173500                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           17350062
173600                                            :PV-TYPE-2,           17360062
173700                                            :PV-TYPE-3,           17370062
173800                                            :PV-TYPE-4)           17380062
173900                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         17390062
174000                                            :PV-STATUS-2,         17400062
174100                                            :PV-STATUS-3,         17410062
174200                                            :PV-STATUS-4,         17420062
174300                                            :PV-STATUS-5)         17430062
174400                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   17440062
174500                 AND  B.STAT_CDE         =  'NW'                  17450062
174600                 AND  B.PL_LNE_NBR       =  :PC-ZERO              17460062
174700                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         17470062
174800                 AND  B.CRE_TMST        <=  :DK-TO-TMST           17480062
174900                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   17490062
175000                 AND  C.ITM_NBR          =   D.ITM_NBR            17500062
175100                 AND  D.STYL_ID          =   E.STYL_ID            17510062
175200                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       17520062
175300            ORDER BY  A.CNSTK_REQ_PL_NBR                          17530062
175400     END-EXEC.                                                    17540062
175500                                                                  17550062
175600*TS 08/02/2010 BEG                                                17560062
175700*---------------------------------------------------------------* 17570062
175800     EXEC SQL                                                     17580062
175900          DECLARE REF-ALL-DPT-MAJ-PL-CSR CURSOR FOR               17590062
176000              SELECT  DISTINCT                                    17600062
176100                      A.CNSTK_REQ_PL_NBR                          17610062
176200                     ,A.CNSTK_LOC_ID                              17620062
176300                     ,A.SRC_REF_NBR                               17630062
176400                     ,A.SRC_TYP_CDE                               17640062
176500                     ,A.STAT_CDE                                  17650062
176600                FROM  TCEPLRQ      A                              17660062
176700                     ,TCEPLST      B                              17670062
176800                     ,TCEPLIT      C                              17680062
176900                     ,XLV_SKU      D                              17690062
177000                     ,XLV_VND_STYL E                              17700062
177100               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        17710062
177200                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           17720062
177300                                            :PV-TYPE-2,           17730062
177400                                            :PV-TYPE-3,           17740062
177500                                            :PV-TYPE-4)           17750062
177600                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         17760062
177700                                            :PV-STATUS-2,         17770062
177800                                            :PV-STATUS-3,         17780062
177900                                            :PV-STATUS-4,         17790062
178000                                            :PV-STATUS-5)         17800062
178100                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   17810062
178200                 AND  B.STAT_CDE         =  'NW'                  17820062
178300                 AND  B.PL_LNE_NBR       =  :PC-ZERO              17830062
178400                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         17840062
178500                 AND  B.CRE_TMST        <=  :DK-TO-TMST           17850062
178600                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   17860062
178700                 AND  C.ITM_NBR          =   D.ITM_NBR            17870062
178800                 AND  D.STYL_ID          =   E.STYL_ID            17880062
178900                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       17890062
179000                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        17900062
179100            ORDER BY  A.CNSTK_REQ_PL_NBR                          17910062
179200     END-EXEC.                                                    17920062
179300                                                                  17930062
179400*---------------------------------------------------------------* 17940062
179500     EXEC SQL                                                     17950062
179600          DECLARE REF-ALL-DPT-MAJ-SUB-PL-CSR CURSOR FOR           17960062
179700              SELECT  DISTINCT                                    17970062
179800                      A.CNSTK_REQ_PL_NBR                          17980062
179900                     ,A.CNSTK_LOC_ID                              17990062
180000                     ,A.SRC_REF_NBR                               18000062
180100                     ,A.SRC_TYP_CDE                               18010062
180200                     ,A.STAT_CDE                                  18020062
180300                FROM  TCEPLRQ      A                              18030062
180400                     ,TCEPLST      B                              18040062
180500                     ,TCEPLIT      C                              18050062
180600                     ,XLV_SKU      D                              18060062
180700                     ,XLV_VND_STYL E                              18070062
180800               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        18080062
180900                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           18090062
181000                                            :PV-TYPE-2,           18100062
181100                                            :PV-TYPE-3,           18110062
181200                                            :PV-TYPE-4)           18120062
181300                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         18130062
181400                                            :PV-STATUS-2,         18140062
181500                                            :PV-STATUS-3,         18150062
181600                                            :PV-STATUS-4,         18160062
181700                                            :PV-STATUS-5)         18170062
181800                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   18180062
181900                 AND  B.STAT_CDE         =  'NW'                  18190062
182000                 AND  B.PL_LNE_NBR       =  :PC-ZERO              18200062
182100                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         18210062
182200                 AND  B.CRE_TMST        <=  :DK-TO-TMST           18220062
182300                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   18230062
182400                 AND  C.ITM_NBR          =   D.ITM_NBR            18240062
182500                 AND  D.STYL_ID          =   E.STYL_ID            18250062
182600                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       18260062
182700                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        18270062
182800                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        18280062
182900            ORDER BY  A.CNSTK_REQ_PL_NBR                          18290062
183000     END-EXEC.                                                    18300062
183100                                                                  18310062
183200*TS 08/02/2010 END                                                18320062
183300                                                                  18330062
183400*---------------------------------------------------------------* 18340062
183500*    REF NBR CSR - PULL NUMBER ORDER - 1 DC - ALL DEPARTMENTS   * 18350062
183600*---------------------------------------------------------------* 18360062
183700     EXEC SQL                                                     18370062
183800          DECLARE REF-NBR-PUL-SQ-CSR CURSOR FOR                   18380062
183900              SELECT  A.CNSTK_REQ_PL_NBR                          18390062
184000                     ,A.CNSTK_LOC_ID                              18400062
184100                     ,A.SRC_REF_NBR                               18410062
184200                     ,A.SRC_TYP_CDE                               18420062
184300                     ,A.STAT_CDE                                  18430062
184400                FROM  TCEPLRQ A                                   18440062
184500                     ,TCEPLST B                                   18450062
184600               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        18460062
184700                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            18470062
184800                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           18480062
184900                                            :PV-TYPE-2,           18490062
185000                                            :PV-TYPE-3,           18500062
185100                                            :PV-TYPE-4)           18510062
185200                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         18520062
185300                                            :PV-STATUS-2,         18530062
185400                                            :PV-STATUS-3,         18540062
185500                                            :PV-STATUS-4,         18550062
185600                                            :PV-STATUS-5)         18560062
185700                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   18570062
185800                 AND  B.STAT_CDE         =  'NW'                  18580062
185900                 AND  B.PL_LNE_NBR       =  :PC-ZERO              18590062
186000                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         18600062
186100                 AND  B.CRE_TMST        <=  :DK-TO-TMST           18610062
186200            ORDER BY  A.CNSTK_REQ_PL_NBR                          18620062
186300     END-EXEC.                                                    18630062
186400                                                                  18640062
186500                                                                  18650062
186600*---------------------------------------------------------------* 18660062
186700*    REF NBR CSR - PULL NUMBER ORDER - 1 DC - 1 DEPARTMENT      * 18670062
186800*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 18680062
186900*---------------------------------------------------------------* 18690062
187000     EXEC SQL                                                     18700062
187100          DECLARE REF-NBR-DPT-PL-CSR CURSOR FOR                   18710062
187200              SELECT  DISTINCT                                    18720062
187300                      A.CNSTK_REQ_PL_NBR                          18730062
187400                     ,A.CNSTK_LOC_ID                              18740062
187500                     ,A.SRC_REF_NBR                               18750062
187600                     ,A.SRC_TYP_CDE                               18760062
187700                     ,A.STAT_CDE                                  18770062
187800                FROM  TCEPLRQ      A                              18780062
187900                     ,TCEPLST      B                              18790062
188000                     ,TCEPLIT      C                              18800062
188100                     ,XLV_SKU      D                              18810062
188200                     ,XLV_VND_STYL E                              18820062
188300               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        18830062
188400                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            18840062
188500                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           18850062
188600                                            :PV-TYPE-2,           18860062
188700                                            :PV-TYPE-3,           18870062
188800                                            :PV-TYPE-4)           18880062
188900                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         18890062
189000                                            :PV-STATUS-2,         18900062
189100                                            :PV-STATUS-3,         18910062
189200                                            :PV-STATUS-4,         18920062
189300                                            :PV-STATUS-5)         18930062
189400                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   18940062
189500                 AND  B.STAT_CDE         =  'NW'                  18950062
189600                 AND  B.PL_LNE_NBR       =  :PC-ZERO              18960062
189700                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         18970062
189800                 AND  B.CRE_TMST        <=  :DK-TO-TMST           18980062
189900                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   18990062
190000                 AND  C.ITM_NBR          =   D.ITM_NBR            19000062
190100                 AND  D.STYL_ID          =   E.STYL_ID            19010062
190200                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       19020062
190300            ORDER BY  A.CNSTK_REQ_PL_NBR                          19030062
190400     END-EXEC.                                                    19040062
190500                                                                  19050062
190600*TS 08/02/2010 BEG                                                19060062
190700*---------------------------------------------------------------* 19070062
190800     EXEC SQL                                                     19080062
190900          DECLARE REF-NBR-DPT-MAJ-PL-CSR CURSOR FOR               19090062
191000              SELECT  DISTINCT                                    19100062
191100                      A.CNSTK_REQ_PL_NBR                          19110062
191200                     ,A.CNSTK_LOC_ID                              19120062
191300                     ,A.SRC_REF_NBR                               19130062
191400                     ,A.SRC_TYP_CDE                               19140062
191500                     ,A.STAT_CDE                                  19150062
191600                FROM  TCEPLRQ      A                              19160062
191700                     ,TCEPLST      B                              19170062
191800                     ,TCEPLIT      C                              19180062
191900                     ,XLV_SKU      D                              19190062
192000                     ,XLV_VND_STYL E                              19200062
192100               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        19210062
192200                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            19220062
192300                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           19230062
192400                                            :PV-TYPE-2,           19240062
192500                                            :PV-TYPE-3,           19250062
192600                                            :PV-TYPE-4)           19260062
192700                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         19270062
192800                                            :PV-STATUS-2,         19280062
192900                                            :PV-STATUS-3,         19290062
193000                                            :PV-STATUS-4,         19300062
193100                                            :PV-STATUS-5)         19310062
193200                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   19320062
193300                 AND  B.STAT_CDE         =  'NW'                  19330062
193400                 AND  B.PL_LNE_NBR       =  :PC-ZERO              19340062
193500                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         19350062
193600                 AND  B.CRE_TMST        <=  :DK-TO-TMST           19360062
193700                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   19370062
193800                 AND  C.ITM_NBR          =   D.ITM_NBR            19380062
193900                 AND  D.STYL_ID          =   E.STYL_ID            19390062
194000                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       19400062
194100                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        19410062
194200            ORDER BY  A.CNSTK_REQ_PL_NBR                          19420062
194300     END-EXEC.                                                    19430062
194400                                                                  19440062
194500*---------------------------------------------------------------* 19450062
194600     EXEC SQL                                                     19460062
194700          DECLARE REF-NBR-DPT-MAJ-SUB-PL-CSR CURSOR FOR           19470062
194800              SELECT  DISTINCT                                    19480062
194900                      A.CNSTK_REQ_PL_NBR                          19490062
195000                     ,A.CNSTK_LOC_ID                              19500062
195100                     ,A.SRC_REF_NBR                               19510062
195200                     ,A.SRC_TYP_CDE                               19520062
195300                     ,A.STAT_CDE                                  19530062
195400                FROM  TCEPLRQ      A                              19540062
195500                     ,TCEPLST      B                              19550062
195600                     ,TCEPLIT      C                              19560062
195700                     ,XLV_SKU      D                              19570062
195800                     ,XLV_VND_STYL E                              19580062
195900               WHERE  A.SRC_REF_NBR      =  :DK-REF-NUMBER        19590062
196000                 AND  A.CNSTK_LOC_ID     =  :DK-LOC-ID            19600062
196100                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           19610062
196200                                            :PV-TYPE-2,           19620062
196300                                            :PV-TYPE-3,           19630062
196400                                            :PV-TYPE-4)           19640062
196500                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         19650062
196600                                            :PV-STATUS-2,         19660062
196700                                            :PV-STATUS-3,         19670062
196800                                            :PV-STATUS-4,         19680062
196900                                            :PV-STATUS-5)         19690062
197000                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   19700062
197100                 AND  B.STAT_CDE         =  'NW'                  19710062
197200                 AND  B.PL_LNE_NBR       =  :PC-ZERO              19720062
197300                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         19730062
197400                 AND  B.CRE_TMST        <=  :DK-TO-TMST           19740062
197500                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   19750062
197600                 AND  C.ITM_NBR          =   D.ITM_NBR            19760062
197700                 AND  D.STYL_ID          =   E.STYL_ID            19770062
197800                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       19780062
197900                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        19790062
198000                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        19800062
198100            ORDER BY  A.CNSTK_REQ_PL_NBR                          19810062
198200     END-EXEC.                                                    19820062
198300*TS 08/02/2010 END                                                19830062
198400                                                                  19840062
198500*---------------------------------------------------------------* 19850062
198600* REF NBR CSR - CREATE DATE ORDER DESC - ALL DC'S - ALL DEPT    * 19860062
198700*---------------------------------------------------------------* 19870062
198800     EXEC SQL                                                     19880062
198900          DECLARE REF-NBR-ALL-DT-CSR CURSOR FOR                   19890062
199000              SELECT  A.CNSTK_REQ_PL_NBR                          19900062
199100                     ,A.CNSTK_LOC_ID                              19910062
199200                     ,A.SRC_REF_NBR                               19920062
199300                     ,A.SRC_TYP_CDE                               19930062
199400                     ,A.STAT_CDE                                  19940062
199500                     ,B.CRE_TMST                                  19950062
199600                FROM  TCEPLRQ A                                   19960062
199700                     ,TCEPLST B                                   19970062
199800               WHERE  A.SRC_REF_NBR     = :DK-REF-NUMBER          19980062
199900                 AND  A.SRC_TYP_CDE   IN (:PV-TYPE-1,             19990062
200000                                          :PV-TYPE-2,             20000062
200100                                          :PV-TYPE-3,             20010062
200200                                          :PV-TYPE-4)             20020062
200300                 AND  A.STAT_CDE      IN (:PV-STATUS-1,           20030062
200400                                          :PV-STATUS-2,           20040062
200500                                          :PV-STATUS-3,           20050062
200600                                          :PV-STATUS-4,           20060062
200700                                          :PV-STATUS-5)           20070062
200800                 AND  A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR     20080062
200900                 AND  B.PL_LNE_NBR       = :PC-ZERO               20090062
201000                 AND  B.STAT_CDE         = 'NW'                   20100062
201100                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         20110062
201200                 AND  B.CRE_TMST        <=  :DK-TO-TMST           20120062
201300            ORDER BY  B.CRE_TMST                                  20130062
201400     END-EXEC.                                                    20140062
201500                                                                  20150062
201600*---------------------------------------------------------------* 20160062
201700* REF NBR CSR - CREATE DATE ORDER DESC - ALL DC'S - 1 DEPT      * 20170062
201800*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 20180062
201900*---------------------------------------------------------------* 20190062
202000     EXEC SQL                                                     20200062
202100          DECLARE REF-ALL-DPT-DT-CSR CURSOR FOR                   20210062
202200              SELECT  DISTINCT                                    20220062
202300                      A.CNSTK_REQ_PL_NBR                          20230062
202400                     ,A.CNSTK_LOC_ID                              20240062
202500                     ,A.SRC_REF_NBR                               20250062
202600                     ,A.SRC_TYP_CDE                               20260062
202700                     ,A.STAT_CDE                                  20270062
202800                     ,B.CRE_TMST                                  20280062
202900                FROM  TCEPLRQ      A                              20290062
203000                     ,TCEPLST      B                              20300062
203100                     ,TCEPLIT      C                              20310062
203200                     ,XLV_SKU      D                              20320062
203300                     ,XLV_VND_STYL E                              20330062
203400               WHERE  A.SRC_REF_NBR      = :DK-REF-NUMBER         20340062
203500                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            20350062
203600                                           :PV-TYPE-2,            20360062
203700                                           :PV-TYPE-3,            20370062
203800                                           :PV-TYPE-4)            20380062
203900                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          20390062
204000                                           :PV-STATUS-2,          20400062
204100                                           :PV-STATUS-3,          20410062
204200                                           :PV-STATUS-4,          20420062
204300                                           :PV-STATUS-5)          20430062
204400                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    20440062
204500                 AND  B.PL_LNE_NBR       = :PC-ZERO               20450062
204600                 AND  B.STAT_CDE         = 'NW'                   20460062
204700                 AND  B.CRE_TMST        >= :DK-FROM-TMST          20470062
204800                 AND  B.CRE_TMST        <= :DK-TO-TMST            20480062
204900                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    20490062
205000                 AND  C.ITM_NBR          =  D.ITM_NBR             20500062
205100                 AND  D.STYL_ID          =   E.STYL_ID            20510062
205200                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       20520062
205300            ORDER BY  B.CRE_TMST                                  20530062
205400     END-EXEC.                                                    20540062
205500                                                                  20550062
205600*TS 08/02/2010 BEG                                                20560062
205700*---------------------------------------------------------------* 20570062
205800     EXEC SQL                                                     20580062
205900          DECLARE REF-ALL-DPT-MAJ-DT-CSR CURSOR FOR               20590062
206000              SELECT  DISTINCT                                    20600062
206100                      A.CNSTK_REQ_PL_NBR                          20610062
206200                     ,A.CNSTK_LOC_ID                              20620062
206300                     ,A.SRC_REF_NBR                               20630062
206400                     ,A.SRC_TYP_CDE                               20640062
206500                     ,A.STAT_CDE                                  20650062
206600                     ,B.CRE_TMST                                  20660062
206700                FROM  TCEPLRQ      A                              20670062
206800                     ,TCEPLST      B                              20680062
206900                     ,TCEPLIT      C                              20690062
207000                     ,XLV_SKU      D                              20700062
207100                     ,XLV_VND_STYL E                              20710062
207200               WHERE  A.SRC_REF_NBR      = :DK-REF-NUMBER         20720062
207300                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            20730062
207400                                           :PV-TYPE-2,            20740062
207500                                           :PV-TYPE-3,            20750062
207600                                           :PV-TYPE-4)            20760062
207700                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          20770062
207800                                           :PV-STATUS-2,          20780062
207900                                           :PV-STATUS-3,          20790062
208000                                           :PV-STATUS-4,          20800062
208100                                           :PV-STATUS-5)          20810062
208200                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    20820062
208300                 AND  B.PL_LNE_NBR       = :PC-ZERO               20830062
208400                 AND  B.STAT_CDE         = 'NW'                   20840062
208500                 AND  B.CRE_TMST        >= :DK-FROM-TMST          20850062
208600                 AND  B.CRE_TMST        <= :DK-TO-TMST            20860062
208700                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    20870062
208800                 AND  C.ITM_NBR          =  D.ITM_NBR             20880062
208900                 AND  D.STYL_ID          =   E.STYL_ID            20890062
209000                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       20900062
209100                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        20910062
209200            ORDER BY  B.CRE_TMST                                  20920062
209300     END-EXEC.                                                    20930062
209400                                                                  20940062
209500*---------------------------------------------------------------* 20950062
209600     EXEC SQL                                                     20960062
209700          DECLARE REF-ALL-DPT-MAJ-SUB-DT-CSR CURSOR FOR           20970062
209800              SELECT  DISTINCT                                    20980062
209900                      A.CNSTK_REQ_PL_NBR                          20990062
210000                     ,A.CNSTK_LOC_ID                              21000062
210100                     ,A.SRC_REF_NBR                               21010062
210200                     ,A.SRC_TYP_CDE                               21020062
210300                     ,A.STAT_CDE                                  21030062
210400                     ,B.CRE_TMST                                  21040062
210500                FROM  TCEPLRQ      A                              21050062
210600                     ,TCEPLST      B                              21060062
210700                     ,TCEPLIT      C                              21070062
210800                     ,XLV_SKU      D                              21080062
210900                     ,XLV_VND_STYL E                              21090062
211000               WHERE  A.SRC_REF_NBR      = :DK-REF-NUMBER         21100062
211100                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            21110062
211200                                           :PV-TYPE-2,            21120062
211300                                           :PV-TYPE-3,            21130062
211400                                           :PV-TYPE-4)            21140062
211500                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          21150062
211600                                           :PV-STATUS-2,          21160062
211700                                           :PV-STATUS-3,          21170062
211800                                           :PV-STATUS-4,          21180062
211900                                           :PV-STATUS-5)          21190062
212000                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    21200062
212100                 AND  B.PL_LNE_NBR       = :PC-ZERO               21210062
212200                 AND  B.STAT_CDE         = 'NW'                   21220062
212300                 AND  B.CRE_TMST        >= :DK-FROM-TMST          21230062
212400                 AND  B.CRE_TMST        <= :DK-TO-TMST            21240062
212500                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    21250062
212600                 AND  C.ITM_NBR          =  D.ITM_NBR             21260062
212700                 AND  D.STYL_ID          =   E.STYL_ID            21270062
212800                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       21280062
212900                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        21290062
213000                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        21300062
213100            ORDER BY  B.CRE_TMST                                  21310062
213200     END-EXEC.                                                    21320062
213300                                                                  21330062
213400*TS 08/02/2010 END                                                21340062
213500                                                                  21350062
213600*---------------------------------------------------------------* 21360062
213700* REF NBR CSR - CREATE DATE ORDER DESC - 1 DC - ALL DEPARTMENTS * 21370062
213800*---------------------------------------------------------------* 21380062
213900     EXEC SQL                                                     21390062
214000          DECLARE REF-NBR-DTE-SQ-CSR CURSOR FOR                   21400062
214100              SELECT  A.CNSTK_REQ_PL_NBR                          21410062
214200                     ,A.CNSTK_LOC_ID                              21420062
214300                     ,A.SRC_REF_NBR                               21430062
214400                     ,A.SRC_TYP_CDE                               21440062
214500                     ,A.STAT_CDE                                  21450062
214600                     ,B.CRE_TMST                                  21460062
214700                FROM  TCEPLRQ A                                   21470062
214800                     ,TCEPLST B                                   21480062
214900               WHERE  A.SRC_REF_NBR     = :DK-REF-NUMBER          21490062
215000                 AND  A.CNSTK_LOC_ID    = :DK-LOC-ID              21500062
215100                 AND  A.SRC_TYP_CDE   IN (:PV-TYPE-1,             21510062
215200                                          :PV-TYPE-2,             21520062
215300                                          :PV-TYPE-3,             21530062
215400                                          :PV-TYPE-4)             21540062
215500                 AND  A.STAT_CDE      IN (:PV-STATUS-1,           21550062
215600                                          :PV-STATUS-2,           21560062
215700                                          :PV-STATUS-3,           21570062
215800                                          :PV-STATUS-4,           21580062
215900                                          :PV-STATUS-5)           21590062
216000                 AND  A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR     21600062
216100                 AND  B.PL_LNE_NBR       = :PC-ZERO               21610062
216200                 AND  B.STAT_CDE         = 'NW'                   21620062
216300                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         21630062
216400                 AND  B.CRE_TMST        <=  :DK-TO-TMST           21640062
216500            ORDER BY  B.CRE_TMST                                  21650062
216600     END-EXEC.                                                    21660062
216700                                                                  21670062
216800                                                                  21680062
216900*---------------------------------------------------------------* 21690062
217000* REF NBR CSR - CREATE DATE ORDER DESC - 1 DC - 1 DEPARTMENT    * 21700062
217100*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 21710062
217200*---------------------------------------------------------------* 21720062
217300     EXEC SQL                                                     21730062
217400          DECLARE REF-NBR-DPT-DT-CSR CURSOR FOR                   21740062
217500              SELECT  DISTINCT                                    21750062
217600                      A.CNSTK_REQ_PL_NBR                          21760062
217700                     ,A.CNSTK_LOC_ID                              21770062
217800                     ,A.SRC_REF_NBR                               21780062
217900                     ,A.SRC_TYP_CDE                               21790062
218000                     ,A.STAT_CDE                                  21800062
218100                     ,B.CRE_TMST                                  21810062
218200                FROM  TCEPLRQ      A                              21820062
218300                     ,TCEPLST      B                              21830062
218400                     ,TCEPLIT      C                              21840062
218500                     ,XLV_SKU      D                              21850062
218600                     ,XLV_VND_STYL E                              21860062
218700               WHERE  A.SRC_REF_NBR      = :DK-REF-NUMBER         21870062
218800                 AND  A.CNSTK_LOC_ID     = :DK-LOC-ID             21880062
218900                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            21890062
219000                                           :PV-TYPE-2,            21900062
219100                                           :PV-TYPE-3,            21910062
219200                                           :PV-TYPE-4)            21920062
219300                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          21930062
219400                                           :PV-STATUS-2,          21940062
219500                                           :PV-STATUS-3,          21950062
219600                                           :PV-STATUS-4,          21960062
219700                                           :PV-STATUS-5)          21970062
219800                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    21980062
219900                 AND  B.PL_LNE_NBR       = :PC-ZERO               21990062
220000                 AND  B.STAT_CDE         = 'NW'                   22000062
220100                 AND  B.CRE_TMST        >= :DK-FROM-TMST          22010062
220200                 AND  B.CRE_TMST        <= :DK-TO-TMST            22020062
220300                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    22030062
220400                 AND  C.ITM_NBR          =  D.ITM_NBR             22040062
220500                 AND  D.STYL_ID          =   E.STYL_ID            22050062
220600                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       22060062
220700            ORDER BY  B.CRE_TMST                                  22070062
220800     END-EXEC.                                                    22080062
220900                                                                  22090062
221000*TS 08/02/2010 BEG                                                22100062
221100*---------------------------------------------------------------* 22110062
221200     EXEC SQL                                                     22120062
221300          DECLARE REF-NBR-DPT-MAJ-DT-CSR CURSOR FOR               22130062
221400              SELECT  DISTINCT                                    22140062
221500                      A.CNSTK_REQ_PL_NBR                          22150062
221600                     ,A.CNSTK_LOC_ID                              22160062
221700                     ,A.SRC_REF_NBR                               22170062
221800                     ,A.SRC_TYP_CDE                               22180062
221900                     ,A.STAT_CDE                                  22190062
222000                     ,B.CRE_TMST                                  22200062
222100                FROM  TCEPLRQ      A                              22210062
222200                     ,TCEPLST      B                              22220062
222300                     ,TCEPLIT      C                              22230062
222400                     ,XLV_SKU      D                              22240062
222500                     ,XLV_VND_STYL E                              22250062
222600               WHERE  A.SRC_REF_NBR      = :DK-REF-NUMBER         22260062
222700                 AND  A.CNSTK_LOC_ID     = :DK-LOC-ID             22270062
222800                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            22280062
222900                                           :PV-TYPE-2,            22290062
223000                                           :PV-TYPE-3,            22300062
223100                                           :PV-TYPE-4)            22310062
223200                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          22320062
223300                                           :PV-STATUS-2,          22330062
223400                                           :PV-STATUS-3,          22340062
223500                                           :PV-STATUS-4,          22350062
223600                                           :PV-STATUS-5)          22360062
223700                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    22370062
223800                 AND  B.PL_LNE_NBR       = :PC-ZERO               22380062
223900                 AND  B.STAT_CDE         = 'NW'                   22390062
224000                 AND  B.CRE_TMST        >= :DK-FROM-TMST          22400062
224100                 AND  B.CRE_TMST        <= :DK-TO-TMST            22410062
224200                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    22420062
224300                 AND  C.ITM_NBR          =  D.ITM_NBR             22430062
224400                 AND  D.STYL_ID          =   E.STYL_ID            22440062
224500                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       22450062
224600                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        22460062
224700            ORDER BY  B.CRE_TMST                                  22470062
224800     END-EXEC.                                                    22480062
224900                                                                  22490062
225000*---------------------------------------------------------------* 22500062
225100     EXEC SQL                                                     22510062
225200          DECLARE REF-NBR-DPT-MAJ-SUB-DT-CSR CURSOR FOR           22520062
225300              SELECT  DISTINCT                                    22530062
225400                      A.CNSTK_REQ_PL_NBR                          22540062
225500                     ,A.CNSTK_LOC_ID                              22550062
225600                     ,A.SRC_REF_NBR                               22560062
225700                     ,A.SRC_TYP_CDE                               22570062
225800                     ,A.STAT_CDE                                  22580062
225900                     ,B.CRE_TMST                                  22590062
226000                FROM  TCEPLRQ      A                              22600062
226100                     ,TCEPLST      B                              22610062
226200                     ,TCEPLIT      C                              22620062
226300                     ,XLV_SKU      D                              22630062
226400                     ,XLV_VND_STYL E                              22640062
226500               WHERE  A.SRC_REF_NBR      = :DK-REF-NUMBER         22650062
226600                 AND  A.CNSTK_LOC_ID     = :DK-LOC-ID             22660062
226700                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            22670062
226800                                           :PV-TYPE-2,            22680062
226900                                           :PV-TYPE-3,            22690062
227000                                           :PV-TYPE-4)            22700062
227100                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          22710062
227200                                           :PV-STATUS-2,          22720062
227300                                           :PV-STATUS-3,          22730062
227400                                           :PV-STATUS-4,          22740062
227500                                           :PV-STATUS-5)          22750062
227600                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    22760062
227700                 AND  B.PL_LNE_NBR       = :PC-ZERO               22770062
227800                 AND  B.STAT_CDE         = 'NW'                   22780062
227900                 AND  B.CRE_TMST        >= :DK-FROM-TMST          22790062
228000                 AND  B.CRE_TMST        <= :DK-TO-TMST            22800062
228100                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    22810062
228200                 AND  C.ITM_NBR          =  D.ITM_NBR             22820062
228300                 AND  D.STYL_ID          =   E.STYL_ID            22830062
228400                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       22840062
228500                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        22850062
228600                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        22860062
228700            ORDER BY  B.CRE_TMST                                  22870062
228800     END-EXEC.                                                    22880062
228900                                                                  22890062
229000*TS 08/02/2010 END                                                22900062
229100                                                                  22910062
229200*---------------------------------------------------------------* 22920062
229300*  SELECT ALL REF NBR CSR - PULL NBR ORDER - ALL DC'S -ALL DEPT * 22930062
229400*---------------------------------------------------------------* 22940062
229500     EXEC SQL                                                     22950062
229600          DECLARE NO-NBR-ALL-PL-CSR CURSOR FOR                    22960062
229700              SELECT  A.CNSTK_REQ_PL_NBR                          22970062
229800                     ,A.CNSTK_LOC_ID                              22980062
229900                     ,A.SRC_REF_NBR                               22990062
230000                     ,A.SRC_TYP_CDE                               23000062
230100                     ,A.STAT_CDE                                  23010062
230200                FROM  TCEPLRQ A                                   23020062
230300                     ,TCEPLST B                                   23030062
230400               WHERE  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           23040062
230500                                            :PV-TYPE-2,           23050062
230600                                            :PV-TYPE-3,           23060062
230700                                            :PV-TYPE-4)           23070062
230800                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         23080062
230900                                            :PV-STATUS-2,         23090062
231000                                            :PV-STATUS-3,         23100062
231100                                            :PV-STATUS-4,         23110062
231200                                            :PV-STATUS-5)         23120062
231300                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   23130062
231400                 AND  B.STAT_CDE         =  'NW'                  23140062
231500                 AND  B.PL_LNE_NBR       = :PC-ZERO               23150062
231600                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         23160062
231700                 AND  B.CRE_TMST        <=  :DK-TO-TMST           23170062
231800            ORDER BY  A.CNSTK_REQ_PL_NBR                          23180062
231900     END-EXEC.                                                    23190062
232000                                                                  23200062
232100                                                                  23210062
232200*---------------------------------------------------------------* 23220062
232300*  SELECT ALL REF NBR CSR - PULL NBR ORDER - ALL DC'S - 1 DEPT  * 23230062
232400*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 23240062
232500*---------------------------------------------------------------* 23250062
232600     EXEC SQL                                                     23260062
232700          DECLARE NBR-ALL-DPT-PL-CSR CURSOR FOR                   23270062
232800              SELECT  DISTINCT                                    23280062
232900                      A.CNSTK_REQ_PL_NBR                          23290062
233000                     ,A.CNSTK_LOC_ID                              23300062
233100                     ,A.SRC_REF_NBR                               23310062
233200                     ,A.SRC_TYP_CDE                               23320062
233300                     ,A.STAT_CDE                                  23330062
233400                FROM  TCEPLRQ      A                              23340062
233500                     ,TCEPLST      B                              23350062
233600                     ,TCEPLIT      C                              23360062
233700                     ,XLV_SKU      D                              23370062
233800                     ,XLV_VND_STYL E                              23380062
233900               WHERE  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           23390062
234000                                            :PV-TYPE-2,           23400062
234100                                            :PV-TYPE-3,           23410062
234200                                            :PV-TYPE-4)           23420062
234300                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         23430062
234400                                            :PV-STATUS-2,         23440062
234500                                            :PV-STATUS-3,         23450062
234600                                            :PV-STATUS-4,         23460062
234700                                            :PV-STATUS-5)         23470062
234800                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   23480062
234900                 AND  B.STAT_CDE         =  'NW'                  23490062
235000                 AND  B.PL_LNE_NBR       =  :PC-ZERO              23500062
235100                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         23510062
235200                 AND  B.CRE_TMST        <=  :DK-TO-TMST           23520062
235300                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   23530062
235400                 AND  C.ITM_NBR          =   D.ITM_NBR            23540062
235500                 AND  D.STYL_ID          =   E.STYL_ID            23550062
235600                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       23560062
235700            ORDER BY  A.CNSTK_REQ_PL_NBR                          23570062
235800     END-EXEC.                                                    23580062
235900                                                                  23590062
236000*TS 08/02/2010 BEG                                                23600062
236100*---------------------------------------------------------------* 23610062
236200     EXEC SQL                                                     23620062
236300          DECLARE NBR-ALL-DPT-MAJ-PL-CSR CURSOR FOR               23630062
236400              SELECT  DISTINCT                                    23640062
236500                      A.CNSTK_REQ_PL_NBR                          23650062
236600                     ,A.CNSTK_LOC_ID                              23660062
236700                     ,A.SRC_REF_NBR                               23670062
236800                     ,A.SRC_TYP_CDE                               23680062
236900                     ,A.STAT_CDE                                  23690062
237000                FROM  TCEPLRQ      A                              23700062
237100                     ,TCEPLST      B                              23710062
237200                     ,TCEPLIT      C                              23720062
237300                     ,XLV_SKU      D                              23730062
237400                     ,XLV_VND_STYL E                              23740062
237500               WHERE  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           23750062
237600                                            :PV-TYPE-2,           23760062
237700                                            :PV-TYPE-3,           23770062
237800                                            :PV-TYPE-4)           23780062
237900                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         23790062
238000                                            :PV-STATUS-2,         23800062
238100                                            :PV-STATUS-3,         23810062
238200                                            :PV-STATUS-4,         23820062
238300                                            :PV-STATUS-5)         23830062
238400                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   23840062
238500                 AND  B.STAT_CDE         =  'NW'                  23850062
238600                 AND  B.PL_LNE_NBR       =  :PC-ZERO              23860062
238700                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         23870062
238800                 AND  B.CRE_TMST        <=  :DK-TO-TMST           23880062
238900                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   23890062
239000                 AND  C.ITM_NBR          =   D.ITM_NBR            23900062
239100                 AND  D.STYL_ID          =   E.STYL_ID            23910062
239200                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       23920062
239300                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        23930062
239400            ORDER BY  A.CNSTK_REQ_PL_NBR                          23940062
239500     END-EXEC.                                                    23950062
239600                                                                  23960062
239700*---------------------------------------------------------------* 23970062
239800     EXEC SQL                                                     23980062
239900          DECLARE NBR-ALL-DPT-MAJ-SUB-PL-CSR CURSOR FOR           23990062
240000              SELECT  DISTINCT                                    24000062
240100                      A.CNSTK_REQ_PL_NBR                          24010062
240200                     ,A.CNSTK_LOC_ID                              24020062
240300                     ,A.SRC_REF_NBR                               24030062
240400                     ,A.SRC_TYP_CDE                               24040062
240500                     ,A.STAT_CDE                                  24050062
240600                FROM  TCEPLRQ      A                              24060062
240700                     ,TCEPLST      B                              24070062
240800                     ,TCEPLIT      C                              24080062
240900                     ,XLV_SKU      D                              24090062
241000                     ,XLV_VND_STYL E                              24100062
241100               WHERE  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           24110062
241200                                            :PV-TYPE-2,           24120062
241300                                            :PV-TYPE-3,           24130062
241400                                            :PV-TYPE-4)           24140062
241500                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         24150062
241600                                            :PV-STATUS-2,         24160062
241700                                            :PV-STATUS-3,         24170062
241800                                            :PV-STATUS-4,         24180062
241900                                            :PV-STATUS-5)         24190062
242000                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   24200062
242100                 AND  B.STAT_CDE         =  'NW'                  24210062
242200                 AND  B.PL_LNE_NBR       =  :PC-ZERO              24220062
242300                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         24230062
242400                 AND  B.CRE_TMST        <=  :DK-TO-TMST           24240062
242500                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   24250062
242600                 AND  C.ITM_NBR          =   D.ITM_NBR            24260062
242700                 AND  D.STYL_ID          =   E.STYL_ID            24270062
242800                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       24280062
242900                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        24290062
243000                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        24300062
243100            ORDER BY  A.CNSTK_REQ_PL_NBR                          24310062
243200     END-EXEC.                                                    24320062
243300                                                                  24330062
243400*TS 08/02/2010 END                                                24340062
243500                                                                  24350062
243600*---------------------------------------------------------------* 24360062
243700*  SELECT ALL REF NBR CSR - PULL NUMBER ORDER - 1 DC - ALL DEPT * 24370062
243800*---------------------------------------------------------------* 24380062
243900     EXEC SQL                                                     24390062
244000          DECLARE NO-NBR-PUL-SQ-CSR CURSOR FOR                    24400062
244100              SELECT  A.CNSTK_REQ_PL_NBR                          24410062
244200                     ,A.CNSTK_LOC_ID                              24420062
244300                     ,A.SRC_REF_NBR                               24430062
244400                     ,A.SRC_TYP_CDE                               24440062
244500                     ,A.STAT_CDE                                  24450062
244600                FROM  TCEPLRQ A                                   24460062
244700                     ,TCEPLST B                                   24470062
244800               WHERE  A.CNSTK_LOC_ID      = :DK-LOC-ID            24480062
244900                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           24490062
245000                                            :PV-TYPE-2,           24500062
245100                                            :PV-TYPE-3,           24510062
245200                                            :PV-TYPE-4)           24520062
245300                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         24530062
245400                                            :PV-STATUS-2,         24540062
245500                                            :PV-STATUS-3,         24550062
245600                                            :PV-STATUS-4,         24560062
245700                                            :PV-STATUS-5)         24570062
245800                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   24580062
245900                 AND  B.STAT_CDE         =  'NW'                  24590062
246000                 AND  B.PL_LNE_NBR       =  :PC-ZERO              24600062
246100                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         24610062
246200                 AND  B.CRE_TMST        <=  :DK-TO-TMST           24620062
246300            ORDER BY  A.CNSTK_REQ_PL_NBR                          24630062
246400     END-EXEC.                                                    24640062
246500                                                                  24650062
246600                                                                  24660062
246700*---------------------------------------------------------------* 24670062
246800*  SELECT ALL REF NBR CSR - PULL NUMBER ORDER - 1 DC - 1 DEPT   * 24680062
246900*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 24690062
247000*---------------------------------------------------------------* 24700062
247100     EXEC SQL                                                     24710062
247200          DECLARE NO-NBR-DEPT-PL-CSR CURSOR FOR                   24720062
247300              SELECT  DISTINCT                                    24730062
247400                      A.CNSTK_REQ_PL_NBR                          24740062
247500                     ,A.CNSTK_LOC_ID                              24750062
247600                     ,A.SRC_REF_NBR                               24760062
247700                     ,A.SRC_TYP_CDE                               24770062
247800                     ,A.STAT_CDE                                  24780062
247900                FROM  TCEPLRQ      A                              24790062
248000                     ,TCEPLST      B                              24800062
248100                     ,TCEPLIT      C                              24810062
248200                     ,XLV_SKU      D                              24820062
248300                     ,XLV_VND_STYL E                              24830062
248400               WHERE  A.CNSTK_LOC_ID      = :DK-LOC-ID            24840062
248500                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           24850062
248600                                            :PV-TYPE-2,           24860062
248700                                            :PV-TYPE-3,           24870062
248800                                            :PV-TYPE-4)           24880062
248900                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         24890062
249000                                            :PV-STATUS-2,         24900062
249100                                            :PV-STATUS-3,         24910062
249200                                            :PV-STATUS-4,         24920062
249300                                            :PV-STATUS-5)         24930062
249400                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   24940062
249500                 AND  B.STAT_CDE         =  'NW'                  24950062
249600                 AND  B.PL_LNE_NBR       =  :PC-ZERO              24960062
249700                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         24970062
249800                 AND  B.CRE_TMST        <=  :DK-TO-TMST           24980062
249900                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   24990062
250000                 AND  C.ITM_NBR          =   D.ITM_NBR            25000062
250100                 AND  D.STYL_ID          =   E.STYL_ID            25010062
250200                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       25020062
250300            ORDER BY  A.CNSTK_REQ_PL_NBR                          25030062
250400     END-EXEC.                                                    25040062
250500                                                                  25050062
250600*TS 08/02/2010 BEG                                                25060062
250700*---------------------------------------------------------------* 25070062
250800     EXEC SQL                                                     25080062
250900          DECLARE NO-NBR-DEPT-MAJ-PL-CSR CURSOR FOR               25090062
251000              SELECT  DISTINCT                                    25100062
251100                      A.CNSTK_REQ_PL_NBR                          25110062
251200                     ,A.CNSTK_LOC_ID                              25120062
251300                     ,A.SRC_REF_NBR                               25130062
251400                     ,A.SRC_TYP_CDE                               25140062
251500                     ,A.STAT_CDE                                  25150062
251600                FROM  TCEPLRQ      A                              25160062
251700                     ,TCEPLST      B                              25170062
251800                     ,TCEPLIT      C                              25180062
251900                     ,XLV_SKU      D                              25190062
252000                     ,XLV_VND_STYL E                              25200062
252100               WHERE  A.CNSTK_LOC_ID      = :DK-LOC-ID            25210062
252200                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           25220062
252300                                            :PV-TYPE-2,           25230062
252400                                            :PV-TYPE-3,           25240062
252500                                            :PV-TYPE-4)           25250062
252600                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         25260062
252700                                            :PV-STATUS-2,         25270062
252800                                            :PV-STATUS-3,         25280062
252900                                            :PV-STATUS-4,         25290062
253000                                            :PV-STATUS-5)         25300062
253100                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   25310062
253200                 AND  B.STAT_CDE         =  'NW'                  25320062
253300                 AND  B.PL_LNE_NBR       =  :PC-ZERO              25330062
253400                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         25340062
253500                 AND  B.CRE_TMST        <=  :DK-TO-TMST           25350062
253600                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   25360062
253700                 AND  C.ITM_NBR          =   D.ITM_NBR            25370062
253800                 AND  D.STYL_ID          =   E.STYL_ID            25380062
253900                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       25390062
254000                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        25400062
254100            ORDER BY  A.CNSTK_REQ_PL_NBR                          25410062
254200     END-EXEC.                                                    25420062
254300                                                                  25430062
254400*---------------------------------------------------------------* 25440062
254500     EXEC SQL                                                     25450062
254600          DECLARE NO-NBR-DEPT-MAJ-SUB-PL-CSR CURSOR FOR           25460062
254700              SELECT  DISTINCT                                    25470062
254800                      A.CNSTK_REQ_PL_NBR                          25480062
254900                     ,A.CNSTK_LOC_ID                              25490062
255000                     ,A.SRC_REF_NBR                               25500062
255100                     ,A.SRC_TYP_CDE                               25510062
255200                     ,A.STAT_CDE                                  25520062
255300                FROM  TCEPLRQ      A                              25530062
255400                     ,TCEPLST      B                              25540062
255500                     ,TCEPLIT      C                              25550062
255600                     ,XLV_SKU      D                              25560062
255700                     ,XLV_VND_STYL E                              25570062
255800               WHERE  A.CNSTK_LOC_ID      = :DK-LOC-ID            25580062
255900                 AND  A.SRC_TYP_CDE     IN (:PV-TYPE-1,           25590062
256000                                            :PV-TYPE-2,           25600062
256100                                            :PV-TYPE-3,           25610062
256200                                            :PV-TYPE-4)           25620062
256300                 AND  A.STAT_CDE        IN (:PV-STATUS-1,         25630062
256400                                            :PV-STATUS-2,         25640062
256500                                            :PV-STATUS-3,         25650062
256600                                            :PV-STATUS-4,         25660062
256700                                            :PV-STATUS-5)         25670062
256800                 AND  A.CNSTK_REQ_PL_NBR =   B.CNSTK_REQ_PL_NBR   25680062
256900                 AND  B.STAT_CDE         =  'NW'                  25690062
257000                 AND  B.PL_LNE_NBR       =  :PC-ZERO              25700062
257100                 AND  B.CRE_TMST        >=  :DK-FROM-TMST         25710062
257200                 AND  B.CRE_TMST        <=  :DK-TO-TMST           25720062
257300                 AND  A.CNSTK_REQ_PL_NBR =   C.CNSTK_REQ_PL_NBR   25730062
257400                 AND  C.ITM_NBR          =   D.ITM_NBR            25740062
257500                 AND  D.STYL_ID          =   E.STYL_ID            25750062
257600                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       25760062
257700                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        25770062
257800                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        25780062
257900            ORDER BY  A.CNSTK_REQ_PL_NBR                          25790062
258000     END-EXEC.                                                    25800062
258100                                                                  25810062
258200*TS 08/02/2010 END                                                25820062
258300                                                                  25830062
258400*---------------------------------------------------------------* 25840062
258500*  SELECT ALL REF NBR CSR - CREATE DATE ORDER (DESCENDING)      * 25850062
258600*    ALL DC'S - ALL DEPARTMENTS                                 * 25860062
258700*---------------------------------------------------------------* 25870062
258800     EXEC SQL                                                     25880062
258900          DECLARE NO-NBR-ALL-DT-CSR CURSOR FOR                    25890062
259000              SELECT  A.CNSTK_REQ_PL_NBR                          25900062
259100                     ,A.CNSTK_LOC_ID                              25910062
259200                     ,A.SRC_REF_NBR                               25920062
259300                     ,A.SRC_TYP_CDE                               25930062
259400                     ,A.STAT_CDE                                  25940062
259500                     ,B.CRE_TMST                                  25950062
259600                FROM  TCEPLRQ A                                   25960062
259700                     ,TCEPLST B                                   25970062
259800               WHERE  A.SRC_TYP_CDE   IN (:PV-TYPE-1,             25980062
259900                                          :PV-TYPE-2,             25990062
260000                                          :PV-TYPE-3,             26000062
260100                                          :PV-TYPE-4)             26010062
260200                 AND  A.STAT_CDE      IN (:PV-STATUS-1,           26020062
260300                                          :PV-STATUS-2,           26030062
260400                                          :PV-STATUS-3,           26040062
260500                                          :PV-STATUS-4,           26050062
260600                                          :PV-STATUS-5)           26060062
260700                 AND  A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR     26070062
260800                 AND  B.PL_LNE_NBR       = :PC-ZERO               26080062
260900                 AND  B.STAT_CDE         = 'NW'                   26090062
261000                 AND  B.CRE_TMST        >= :DK-FROM-TMST          26100062
261100                 AND  B.CRE_TMST        <= :DK-TO-TMST            26110062
261200            ORDER BY  B.CRE_TMST                                  26120062
261300     END-EXEC.                                                    26130062
261400                                                                  26140062
261500                                                                  26150062
261600*---------------------------------------------------------------* 26160062
261700*  SELECT ALL REF NBR CSR - CREATE DATE ORDER (DESCENDING)      * 26170062
261800*    ALL DC'S - 1 DEPARTMENT                                    * 26180062
261900*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 26190062
262000*---------------------------------------------------------------* 26200062
262100     EXEC SQL                                                     26210062
262200          DECLARE NBR-ALL-DPT-DT-CSR CURSOR FOR                   26220062
262300              SELECT  DISTINCT                                    26230062
262400                      A.CNSTK_REQ_PL_NBR                          26240062
262500                     ,A.CNSTK_LOC_ID                              26250062
262600                     ,A.SRC_REF_NBR                               26260062
262700                     ,A.SRC_TYP_CDE                               26270062
262800                     ,A.STAT_CDE                                  26280062
262900                     ,B.CRE_TMST                                  26290062
263000                FROM  TCEPLRQ      A                              26300062
263100                     ,TCEPLST      B                              26310062
263200                     ,TCEPLIT      C                              26320062
263300                     ,XLV_SKU      D                              26330062
263400                     ,XLV_VND_STYL E                              26340062
263500               WHERE  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            26350062
263600                                           :PV-TYPE-2,            26360062
263700                                           :PV-TYPE-3,            26370062
263800                                           :PV-TYPE-4)            26380062
263900                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          26390062
264000                                           :PV-STATUS-2,          26400062
264100                                           :PV-STATUS-3,          26410062
264200                                           :PV-STATUS-4,          26420062
264300                                           :PV-STATUS-5)          26430062
264400                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    26440062
264500                 AND  B.PL_LNE_NBR       = :PC-ZERO               26450062
264600                 AND  B.STAT_CDE         = 'NW'                   26460062
264700                 AND  B.CRE_TMST        >= :DK-FROM-TMST          26470062
264800                 AND  B.CRE_TMST        <= :DK-TO-TMST            26480062
264900                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    26490062
265000                 AND  C.ITM_NBR          =  D.ITM_NBR             26500062
265100                 AND  D.STYL_ID          =   E.STYL_ID            26510062
265200                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       26520062
265300            ORDER BY  B.CRE_TMST                                  26530062
265400     END-EXEC.                                                    26540062
265500                                                                  26550062
265600*TS 08/02/2010 BEG                                                26560062
265700*---------------------------------------------------------------* 26570062
265800     EXEC SQL                                                     26580062
265900          DECLARE NBR-ALL-DPT-MAJ-DT-CSR CURSOR FOR               26590062
266000              SELECT  DISTINCT                                    26600062
266100                      A.CNSTK_REQ_PL_NBR                          26610062
266200                     ,A.CNSTK_LOC_ID                              26620062
266300                     ,A.SRC_REF_NBR                               26630062
266400                     ,A.SRC_TYP_CDE                               26640062
266500                     ,A.STAT_CDE                                  26650062
266600                     ,B.CRE_TMST                                  26660062
266700                FROM  TCEPLRQ      A                              26670062
266800                     ,TCEPLST      B                              26680062
266900                     ,TCEPLIT      C                              26690062
267000                     ,XLV_SKU      D                              26700062
267100                     ,XLV_VND_STYL E                              26710062
267200               WHERE  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            26720062
267300                                           :PV-TYPE-2,            26730062
267400                                           :PV-TYPE-3,            26740062
267500                                           :PV-TYPE-4)            26750062
267600                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          26760062
267700                                           :PV-STATUS-2,          26770062
267800                                           :PV-STATUS-3,          26780062
267900                                           :PV-STATUS-4,          26790062
268000                                           :PV-STATUS-5)          26800062
268100                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    26810062
268200                 AND  B.PL_LNE_NBR       = :PC-ZERO               26820062
268300                 AND  B.STAT_CDE         = 'NW'                   26830062
268400                 AND  B.CRE_TMST        >= :DK-FROM-TMST          26840062
268500                 AND  B.CRE_TMST        <= :DK-TO-TMST            26850062
268600                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    26860062
268700                 AND  C.ITM_NBR          =  D.ITM_NBR             26870062
268800                 AND  D.STYL_ID          =   E.STYL_ID            26880062
268900                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       26890062
269000                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        26900062
269100            ORDER BY  B.CRE_TMST                                  26910062
269200     END-EXEC.                                                    26920062
269300                                                                  26930062
269400*---------------------------------------------------------------* 26940062
269500     EXEC SQL                                                     26950062
269600          DECLARE NBR-ALL-DPT-MAJ-SUB-DT-CSR CURSOR FOR           26960062
269700              SELECT  DISTINCT                                    26970062
269800                      A.CNSTK_REQ_PL_NBR                          26980062
269900                     ,A.CNSTK_LOC_ID                              26990062
270000                     ,A.SRC_REF_NBR                               27000062
270100                     ,A.SRC_TYP_CDE                               27010062
270200                     ,A.STAT_CDE                                  27020062
270300                     ,B.CRE_TMST                                  27030062
270400                FROM  TCEPLRQ      A                              27040062
270500                     ,TCEPLST      B                              27050062
270600                     ,TCEPLIT      C                              27060062
270700                     ,XLV_SKU      D                              27070062
270800                     ,XLV_VND_STYL E                              27080062
270900               WHERE  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            27090062
271000                                           :PV-TYPE-2,            27100062
271100                                           :PV-TYPE-3,            27110062
271200                                           :PV-TYPE-4)            27120062
271300                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          27130062
271400                                           :PV-STATUS-2,          27140062
271500                                           :PV-STATUS-3,          27150062
271600                                           :PV-STATUS-4,          27160062
271700                                           :PV-STATUS-5)          27170062
271800                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    27180062
271900                 AND  B.PL_LNE_NBR       = :PC-ZERO               27190062
272000                 AND  B.STAT_CDE         = 'NW'                   27200062
272100                 AND  B.CRE_TMST        >= :DK-FROM-TMST          27210062
272200                 AND  B.CRE_TMST        <= :DK-TO-TMST            27220062
272300                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    27230062
272400                 AND  C.ITM_NBR          =  D.ITM_NBR             27240062
272500                 AND  D.STYL_ID          =   E.STYL_ID            27250062
272600                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       27260062
272700                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        27270062
272800                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        27280062
272900            ORDER BY  B.CRE_TMST                                  27290062
273000     END-EXEC.                                                    27300062
273100                                                                  27310062
273200*TS 08/02/2010 END                                                27320062
273300                                                                  27330062
273400*---------------------------------------------------------------* 27340062
273500* ALL REF NBR CSR - CREATE DATE ORDER (DESC) - 1 DC - ALL DEPT. * 27350062
273600*---------------------------------------------------------------* 27360062
273700     EXEC SQL                                                     27370062
273800          DECLARE NO-NBR-DTE-SQ-CSR CURSOR FOR                    27380062
273900              SELECT  A.CNSTK_REQ_PL_NBR                          27390062
274000                     ,A.CNSTK_LOC_ID                              27400062
274100                     ,A.SRC_REF_NBR                               27410062
274200                     ,A.SRC_TYP_CDE                               27420062
274300                     ,A.STAT_CDE                                  27430062
274400                     ,B.CRE_TMST                                  27440062
274500                FROM  TCEPLRQ A                                   27450062
274600                     ,TCEPLST B                                   27460062
274700               WHERE  A.CNSTK_LOC_ID    = :DK-LOC-ID              27470062
274800                 AND  A.SRC_TYP_CDE   IN (:PV-TYPE-1,             27480062
274900                                          :PV-TYPE-2,             27490062
275000                                          :PV-TYPE-3,             27500062
275100                                          :PV-TYPE-4)             27510062
275200                 AND  A.STAT_CDE      IN (:PV-STATUS-1,           27520062
275300                                          :PV-STATUS-2,           27530062
275400                                          :PV-STATUS-3,           27540062
275500                                          :PV-STATUS-4,           27550062
275600                                          :PV-STATUS-5)           27560062
275700                 AND  A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR     27570062
275800                 AND  B.PL_LNE_NBR       = :PC-ZERO               27580062
275900                 AND  B.STAT_CDE         = 'NW'                   27590062
276000                 AND  B.PL_LNE_NBR       = :PC-ZERO               27600062
276100                 AND  B.CRE_TMST        >= :DK-FROM-TMST          27610062
276200                 AND  B.CRE_TMST        <= :DK-TO-TMST            27620062
276300            ORDER BY  B.CRE_TMST                                  27630062
276400     END-EXEC.                                                    27640062
276500                                                                  27650062
276600                                                                  27660062
276700*---------------------------------------------------------------* 27670062
276800* ALL REF NBR CSR - CREATE DATE ORDER (DESC) - 1 DC - 1 DEPT.   * 27680062
276900*----CHANGED FROM TSK TO XLV VIEWS            WR/IR# 230ZZ------* 27690062
277000*---------------------------------------------------------------* 27700062
277100     EXEC SQL                                                     27710062
277200          DECLARE NO-NBR-DEPT-DT-CSR CURSOR FOR                   27720062
277300              SELECT  DISTINCT                                    27730062
277400                      A.CNSTK_REQ_PL_NBR                          27740062
277500                     ,A.CNSTK_LOC_ID                              27750062
277600                     ,A.SRC_REF_NBR                               27760062
277700                     ,A.SRC_TYP_CDE                               27770062
277800                     ,A.STAT_CDE                                  27780062
277900                     ,B.CRE_TMST                                  27790062
278000                FROM  TCEPLRQ      A                              27800062
278100                     ,TCEPLST      B                              27810062
278200                     ,TCEPLIT      C                              27820062
278300                     ,XLV_SKU      D                              27830062
278400                     ,XLV_VND_STYL E                              27840062
278500               WHERE  A.CNSTK_LOC_ID     = :DK-LOC-ID             27850062
278600                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            27860062
278700                                           :PV-TYPE-2,            27870062
278800                                           :PV-TYPE-3,            27880062
278900                                           :PV-TYPE-4)            27890062
279000                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          27900062
279100                                           :PV-STATUS-2,          27910062
279200                                           :PV-STATUS-3,          27920062
279300                                           :PV-STATUS-4,          27930062
279400                                           :PV-STATUS-5)          27940062
279500                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    27950062
279600                 AND  B.PL_LNE_NBR       = :PC-ZERO               27960062
279700                 AND  B.STAT_CDE         = 'NW'                   27970062
279800                 AND  B.PL_LNE_NBR       = :PC-ZERO               27980062
279900                 AND  B.CRE_TMST        >= :DK-FROM-TMST          27990062
280000                 AND  B.CRE_TMST        <= :DK-TO-TMST            28000062
280100                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    28010062
280200*                AND  C.ITM_NBR          =  D.ITEM_NMBR           28020062
280300*                AND  D.MERCH_DEPT_NMBR  = :DK-DEPT-NUMBER        28030062
280400                 AND  C.ITM_NBR          =  D.ITM_NBR             28040062
280500                 AND  D.STYL_ID          =   E.STYL_ID            28050062
280600                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       28060062
280700            ORDER BY  B.CRE_TMST                                  28070062
280800     END-EXEC.                                                    28080062
280900                                                                  28090062
281000*TS 08/02/2010 END                                                28100062
281100*---------------------------------------------------------------* 28110062
281200     EXEC SQL                                                     28120062
281300          DECLARE NO-NBR-DEPT-MAJ-DT-CSR CURSOR FOR               28130062
281400              SELECT  DISTINCT                                    28140062
281500                      A.CNSTK_REQ_PL_NBR                          28150062
281600                     ,A.CNSTK_LOC_ID                              28160062
281700                     ,A.SRC_REF_NBR                               28170062
281800                     ,A.SRC_TYP_CDE                               28180062
281900                     ,A.STAT_CDE                                  28190062
282000                     ,B.CRE_TMST                                  28200062
282100                FROM  TCEPLRQ      A                              28210062
282200                     ,TCEPLST      B                              28220062
282300                     ,TCEPLIT      C                              28230062
282400                     ,XLV_SKU      D                              28240062
282500                     ,XLV_VND_STYL E                              28250062
282600               WHERE  A.CNSTK_LOC_ID     = :DK-LOC-ID             28260062
282700                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            28270062
282800                                           :PV-TYPE-2,            28280062
282900                                           :PV-TYPE-3,            28290062
283000                                           :PV-TYPE-4)            28300062
283100                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          28310062
283200                                           :PV-STATUS-2,          28320062
283300                                           :PV-STATUS-3,          28330062
283400                                           :PV-STATUS-4,          28340062
283500                                           :PV-STATUS-5)          28350062
283600                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    28360062
283700                 AND  B.PL_LNE_NBR       = :PC-ZERO               28370062
283800                 AND  B.STAT_CDE         = 'NW'                   28380062
283900                 AND  B.PL_LNE_NBR       = :PC-ZERO               28390062
284000                 AND  B.CRE_TMST        >= :DK-FROM-TMST          28400062
284100                 AND  B.CRE_TMST        <= :DK-TO-TMST            28410062
284200                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    28420062
284300                 AND  C.ITM_NBR          =  D.ITM_NBR             28430062
284400                 AND  D.STYL_ID          =   E.STYL_ID            28440062
284500                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       28450062
284600                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        28460062
284700            ORDER BY  B.CRE_TMST                                  28470062
284800     END-EXEC.                                                    28480062
284900                                                                  28490062
285000*---------------------------------------------------------------* 28500062
285100     EXEC SQL                                                     28510062
285200          DECLARE NO-NBR-DEPT-MAJ-SUB-DT-CSR CURSOR FOR           28520062
285300              SELECT  DISTINCT                                    28530062
285400                      A.CNSTK_REQ_PL_NBR                          28540062
285500                     ,A.CNSTK_LOC_ID                              28550062
285600                     ,A.SRC_REF_NBR                               28560062
285700                     ,A.SRC_TYP_CDE                               28570062
285800                     ,A.STAT_CDE                                  28580062
285900                     ,B.CRE_TMST                                  28590062
286000                FROM  TCEPLRQ      A                              28600062
286100                     ,TCEPLST      B                              28610062
286200                     ,TCEPLIT      C                              28620062
286300                     ,XLV_SKU      D                              28630062
286400                     ,XLV_VND_STYL E                              28640062
286500               WHERE  A.CNSTK_LOC_ID     = :DK-LOC-ID             28650062
286600                 AND  A.SRC_TYP_CDE    IN (:PV-TYPE-1,            28660062
286700                                           :PV-TYPE-2,            28670062
286800                                           :PV-TYPE-3,            28680062
286900                                           :PV-TYPE-4)            28690062
287000                 AND  A.STAT_CDE       IN (:PV-STATUS-1,          28700062
287100                                           :PV-STATUS-2,          28710062
287200                                           :PV-STATUS-3,          28720062
287300                                           :PV-STATUS-4,          28730062
287400                                           :PV-STATUS-5)          28740062
287500                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    28750062
287600                 AND  B.PL_LNE_NBR       = :PC-ZERO               28760062
287700                 AND  B.STAT_CDE         = 'NW'                   28770062
287800                 AND  B.PL_LNE_NBR       = :PC-ZERO               28780062
287900                 AND  B.CRE_TMST        >= :DK-FROM-TMST          28790062
288000                 AND  B.CRE_TMST        <= :DK-TO-TMST            28800062
288100                 AND  A.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR    28810062
288200                 AND  C.ITM_NBR          =  D.ITM_NBR             28820062
288300                 AND  D.STYL_ID          =   E.STYL_ID            28830062
288400                 AND  E.DEPT_NBR         =  :DK-DEPT-NUMBER       28840062
288500                 AND  E.MAJ_CL_NBR       =  :DK-MAJ-CL-NBR        28850062
288600                 AND  E.SUB_CL_NBR       =  :DK-SUB-CL-NBR        28860062
288700            ORDER BY  B.CRE_TMST                                  28870062
288800     END-EXEC.                                                    28880062
288900                                                                  28890062
289000*TS 08/02/2010 END                                                28900062
289100                                                                  28910062
289200*---------------------------------------------------------------* 28920062
289300*    LINE ITEM CURSOR                                           * 28930062
289400*---------------------------------------------------------------* 28940062
289500                                                                  28950062
289600     EXEC SQL                                                     28960062
289700          DECLARE CNFM-LINE-ITEM-CSR CURSOR FOR                   28970062
289800              SELECT  PL_LNE_NBR                                  28980062
289900                FROM  TCEPLIT                                     28990062
290000               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          29000062
290100                 AND  STAT_CDE        IN ('IP')                   29010062
290200            ORDER BY  PL_LNE_NBR                                  29020062
290300     END-EXEC.                                                    29030062
290400                                                                  29040062
290500                                                                  29050062
290600*---------------------------------------------------------------* 29060062
290700*    DB2 AREA FOR COMMUNICATIONS                                * 29070062
290800*---------------------------------------------------------------* 29080062
290900     EXEC SQL                                                     29090062
291000          INCLUDE SQLCA                                           29100062
291100     END-EXEC.                                                    29110062
291200                                                                  29120062
291300                                                                  29130062
291400*---------------------------------------------------------------* 29140062
291500*                                                               * 29150062
291600*---------------------------------------------------------------* 29160062
291700 LINKAGE SECTION.                                                 29170062
291800                                                                  29180062
291900 01  DFHCOMMAREA.                                                 29190062
292000     05  FILLER                         OCCURS  1 TO 4072 TIMES   29200062
292100                                        DEPENDING ON EIBCALEN.    29210062
292200         10  FILLER                     PIC X.                    29220062
292300                                                                  29230062
292400 EJECT                                                            29240062
292500 PROCEDURE DIVISION.                                              29250062
292600******************************************************************29260062
292700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **29270062
292800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **29280062
292900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **29290062
293000******************************************************************29300062
293100 0000-MAIN-MODULE.                                                29310062
293200     INITIALIZE DP030-CICS-API-FIELDS.                            29320062
293300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       29330062
293400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          29340062
293500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         29350062
293600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       29360062
293700     MOVE LENGTH OF CE601AI        TO DP030-MAP-LENGTH (1).       29370062
293800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     29380062
293900     PERFORM 0001-CALL-CICS-ARCH-API.                             29390062
294000*                                                                 29400062
294100     PERFORM 1000-CONTROL-PROCESSING                              29410062
294200*                                                                 29420062
294300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     29430062
294400     PERFORM 0001-CALL-CICS-ARCH-API.                             29440062
294500                                                                  29450062
294600******************************************************************29460062
294700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **29470062
294800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **29480062
294900******************************************************************29490062
295000 0001-CALL-CICS-ARCH-API.                                         29500062
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      29501073
295200                                    DFHCOMMAREA                   29520073
295300                                    DP030-CICS-API-FIELDS         29530073
295400                                    DP020-STANDARD-COMMAREA       29540073
295500                                    CE601AI.                      29550073
295600*                                                                 29560062
295700     IF  DP030-RC-CALL-SUCCESSFUL                                 29570062
295800         CONTINUE                                                 29580062
295900     ELSE                                                         29590062
296000         SET DP013-NO-ROLLBACK                                    29600062
296100             DP013-XCTL-DISPLAY-RESTART                           29610062
296200             DP013-CICS-ABEND      TO TRUE                        29620062
296300         MOVE '0001-CALL-CICS-ARCH-API'                           29630062
296400                                   TO DP013-PARAGRAPH             29640062
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O29641073
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      29642073
296700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      29670062
296800         PERFORM DP013-0000-PROCESS-ABEND                         29680062
296900     END-IF.                                                      29690062
297000*----------------------------------------------------------------*29700062
297100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *29710062
297200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *29720062
297300*                                                                *29730062
297400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *29740062
297500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *29750062
297600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *29760062
297700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *29770062
297800*----------------------------------------------------------------*29780062
297900                                                                  29790062
298000 1000-CONTROL-PROCESSING.                                         29800062
298100                                                                  29810062
298200     EVALUATE TRUE                                                29820062
298300         WHEN DP020-NEXT-ACT-INITIAL                              29830062
298400             INITIALIZE ASC-SPECIFIC-COMMAREA                     29840062
298500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            29850062
298600                                      ASC-SEL-TERM-ID             29860062
298700             MOVE DP020-SRC-TASK-NUMBER                           29870062
298800                                   TO ASC-LIST-TASK-NUMBER        29880062
298900                                      ASC-SEL-TASK-NUMBER         29890062
299000             MOVE PC-LIST-QUEUE-SEQ                               29900062
299100                                   TO ASC-LIST-SEQ                29910062
299200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 29920062
299300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 29930062
299400                                                                  29940062
299500             PERFORM 4000-BUILD-INITIAL-PANEL                     29950062
299600                                                                  29960062
299700         WHEN DP020-NEXT-ACT-READ-MAP                             29970062
299800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        29980062
299900                                   TO PV-TOP-ITEM                 29990062
300000             PERFORM 2000-PROCESS-PANEL                           30000062
300100                                                                  30010062
300200         WHEN DP020-NEXT-ACT-RETURN                               30020062
300300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        30030062
300400                                   TO PV-TOP-ITEM                 30040062
300500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    30050062
300600                                                                  30060062
300700         IF  ASC-XCNTL-TO-RESEND                                  30070062
300800             PERFORM 2050-DELETE-LIST-QUEUE                       30080062
300900             PERFORM 4000-BUILD-INITIAL-PANEL                     30090062
301000             PERFORM 2140-DESELECT-ALL-ITEMS                      30100062
301100             PERFORM 3200-RESET-ATTRIBUTES                        30110062
301200             SET ASC-XCNTL-TO-RESEND-NO  TO TRUE                  30120062
301300         END-IF                                                   30130062
301400                                                                  30140062
301500             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 30150062
301600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 30160062
301700                                                                  30170062
301800         WHEN OTHER                                               30180062
301900             SET DP013-LOGIC-ABEND TO TRUE                        30190062
302000             SET DP013-NO-ROLLBACK TO TRUE                        30200062
302100             MOVE '1000-CONTROL-PROCESSING'                       30210062
302200                                   TO DP013-PARAGRAPH             30220062
302300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    30230062
302400                                   TO DP013-MESSAGE-TEXT(1)       30240062
302500             PERFORM DP013-0000-PROCESS-ABEND                     30250062
302600     END-EVALUATE.                                                30260062
302700                                                                  30270062
302800 EJECT                                                            30280062
302900*----------------------------------------------------------------*30290062
303000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *30300062
303100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *30310062
303200*----------------------------------------------------------------*30320062
303300                                                                  30330062
303400 1100-PROCESS-INTER-APPL-COMM.                                    30340062
303500                                                                  30350062
303600     SET PS-COMMAREA-VALID         TO TRUE.                       30360062
303700     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     30370062
303800                                                                  30380062
303900     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          30390062
304000         MOVE CE001-CURR-OPER-UNT-ID-N                            30400062
304100                                      TO ASC-CURR-OPER-UNT-ID-N   30410062
304200         MOVE PC-0001                 TO ASC-CURR-FCLTY-ID-N      30420062
304300         MOVE CE001-CS-LOCATION       TO ASC-CS-LOC               30430062
304400         MOVE CE001-CS-PRINTER-ID     TO ASC-CS-PRINTER-ID        30440062
304500         MOVE CE001-PULL-NBR          TO ASC-PULL-NBR-N           30450062
304600         MOVE CE001-REF-NBR           TO ASC-REF-NBR              30460062
304700         MOVE CE001-PULL-SELECT-STATUS                            30470062
304800                                      TO ASC-PULL-SELECT-STATUS   30480062
304900         MOVE CE001-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     30490062
305000         MOVE CE001-PULL-SELECT-DATE-FROM                         30500062
305100                                      TO ASC-PULL-SELECT-DATE-FROM30510062
305200         MOVE CE001-PULL-SELECT-DATE-TO                           30520062
305300                                      TO ASC-PULL-SELECT-DATE-TO  30530062
305400         MOVE CE001-SELECT-LIST-SEQUENCE                          30540062
305500                                      TO ASC-SELECT-LIST-SEQUENCE 30550062
305600         MOVE CE001-CURR-PULL-STATUS  TO ASC-CURR-PULL-STATUS     30560062
305700         MOVE CE001-CURR-PULL-TYPE    TO ASC-CURR-PULL-TYPE       30570062
305800         MOVE CE001-DEPT-NBR          TO ASC-DEPT-NBR             30580062
305900*TS 08/02/2010 BEG                                                30590062
306000         MOVE CE001-MAJ-CLASS         TO ASC-MAJ-CLASS            30600062
306100         MOVE CE001-SUB-CLASS         TO ASC-SUB-CLASS            30610062
306200*TS 08/02/2010 END                                                30620062
306300     ELSE                                                         30630062
306400         MOVE CE002-CURR-OPER-UNT-ID-N                            30640062
306500                                      TO ASC-CURR-OPER-UNT-ID-N   30650062
306600         MOVE PC-0001                 TO ASC-CURR-FCLTY-ID-N      30660062
306700         MOVE CE002-CS-LOCATION       TO ASC-CS-LOC               30670062
306800         MOVE CE002-CS-PRINTER-ID     TO ASC-CS-PRINTER-ID        30680062
306900         MOVE CE002-PULL-NBR          TO ASC-PULL-NBR-N           30690062
307000         MOVE CE002-REF-NBR           TO ASC-REF-NBR              30700062
307100         MOVE CE002-PULL-SELECT-STATUS                            30710062
307200                                      TO ASC-PULL-SELECT-STATUS   30720062
307300         MOVE CE002-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     30730062
307400         MOVE CE002-PULL-SELECT-DATE-FROM                         30740062
307500                                      TO ASC-PULL-SELECT-DATE-FROM30750062
307600         MOVE CE002-PULL-SELECT-DATE-TO                           30760062
307700                                      TO ASC-PULL-SELECT-DATE-TO  30770062
307800         MOVE CE002-SELECT-LIST-SEQUENCE                          30780062
307900                                      TO ASC-SELECT-LIST-SEQUENCE 30790062
308000         MOVE CE002-CURR-PULL-STATUS  TO ASC-CURR-PULL-STATUS     30800062
308100         MOVE CE002-CURR-PULL-TYPE    TO ASC-CURR-PULL-TYPE       30810062
308200     END-IF.                                                      30820062
308300                                                                  30830062
308400                                                                  30840062
308500*----------------------------------------------------------------*30850062
308600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *30860062
308700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *30870062
308800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *30880062
308900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *30890062
309000* FUNCTION KEYS CAN GET THIS FAR.                                *30900062
309100*----------------------------------------------------------------*30910062
309200                                                                  30920062
309300 2000-PROCESS-PANEL.                                              30930062
309400     EVALUATE TRUE                                                30940062
309500         WHEN DP020-SRC-AID = DP016-CLEAR                         30950062
309600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    30960062
309700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   30970062
309800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 30980062
309900                                                                  30990062
310000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    31000062
310100             PERFORM 2050-DELETE-LIST-QUEUE                       31010062
310200             PERFORM 4000-BUILD-INITIAL-PANEL                     31020062
310300                                                                  31030062
310400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    31040062
310500             PERFORM 2140-DESELECT-ALL-ITEMS                      31050062
310600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 31060062
310700                                                                  31070062
310800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  31080062
310900             PERFORM 2150-SELECT-ALL-ITEMS                        31090062
311000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 31100062
311100                                                                  31110062
311200         WHEN OTHER                                               31120062
311300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 31130062
311400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   31140062
311500                                                                  31150062
311600             IF  PS-NO-ERROR                                      31160062
311700                 SET DP030-CONTINUE-GO                            31170062
311800                                 TO TRUE                          31180062
311900                 PERFORM 2100-CHECK-FUNCTION-KEY                  31190062
312000             ELSE                                                 31200062
312100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             31210062
312200                 SET DP030-OVERRIDE-GO                            31220062
312300                                 TO TRUE                          31230062
312400             END-IF                                               31240062
312500     END-EVALUATE.                                                31250062
312600 EJECT                                                            31260062
312700*----------------------------------------------------------------*31270062
312800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *31280062
312900*----------------------------------------------------------------*31290062
313000 2050-DELETE-LIST-QUEUE.                                          31300062
313100                                                                  31310062
313200     EXEC CICS                                                    31320062
313300         DELETEQ TS                                               31330062
313400             QUEUE (ASC-LIST-QUEUE-NAME)                          31340062
313500             RESP  (PV-CICS-RESP)                                 31350062
313600     END-EXEC.                                                    31360062
313700                                                                  31370062
313800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       31380062
313900        (PV-CICS-RESP = DFHRESP(QIDERR))                          31390062
314000         CONTINUE                                                 31400062
314100     ELSE                                                         31410062
314200         SET DP013-CICS-ABEND      TO TRUE                        31420062
314300         SET DP013-NO-ROLLBACK     TO TRUE                        31430062
314400                                                                  31440062
314500         MOVE '2050-DELETE-LIST-QUEUE'                            31450062
314600                                   TO DP013-PARAGRAPH             31460062
314700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    31470062
314800                                   TO DP013-MESSAGE-TEXT (1)      31480062
314900         PERFORM DP013-0000-PROCESS-ABEND                         31490062
315000     END-IF.                                                      31500062
315100                                                                  31510062
315200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  31520062
315300 EJECT                                                            31530062
315400*----------------------------------------------------------------*31540062
315500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*31550062
315600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *31560062
315700* CICS ARCHITECTURE API.                                         *31570062
315800*----------------------------------------------------------------*31580062
315900 2100-CHECK-FUNCTION-KEY.                                         31590062
316000                                                                  31600062
316100     EVALUATE TRUE                                                31610062
316200*                                                                 31620062
316300* F23 - PRINT PULL      (LOCAL-FUNC-06)                           31630062
316400*                                                                 31640062
316500         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              31650062
316600                                                                  31660062
316700             MOVE 'CECSPPRT' TO DP008-FUNCTION-NAME               31670062
316800             PERFORM 2105-RACF-ACCESS                             31680062
316900             IF  PS-ACCESS-NOT-ALLOWED                            31690062
317000                 SET  PS-ERROR                                    31700062
317100                      DP020-MSG-FATAL TO TRUE                     31710062
317200                 MOVE PC-TSYMSG-02306 TO DP020-MSG-NUMBER         31720062
317300                 MOVE -1              TO MR-SELECTL (1)           31730062
317400                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             31740062
317500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             31750062
317600             END-IF                                               31760062
317700                                                                  31770062
317800             IF  PS-NO-ERROR                                      31780062
317900                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          31790062
318000                     PERFORM 4600-PROCESS-PRINT-FUNCTION          31800062
318100                         VARYING PV-ITEM  FROM 1 BY 1             31810062
318200                         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN31820062
318300                            OR PS-SOFT-ABORT-ERROR                31830062
318400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         31840062
318500                 ELSE                                             31850062
318600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         31860062
318700                     SET DP030-OVERRIDE-GO TO TRUE                31870062
318800                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    31880062
318900                     SET DP020-MSG-WARNING TO TRUE                31890062
319000                 END-IF                                           31900062
319100             END-IF                                               31910062
319200*                                                                 31920062
319300* F15 - RESEND          (LOCAL-FUNC-08)                           31930062
319400*                                                                 31940062
319500         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              31950062
319600                                                                  31960062
319700         IF ((ASC-NUMBER-OF-SELECTED-ITEMS = 1)                   31970062
319800             OR (ASC-NUMBER-OF-SELECTED-ITEMS = 0 AND             31980062
319900                 CE002-NUMBER-OF-SELECTED-ITEMS = 1))             31990062
320000            INITIALIZE CE002-INTER-APPL-COMMAREA                  32000062
320100            MOVE ASC-NUMBER-OF-SELECTED-ITEMS                     32010062
320200                           TO CE002-NUMBER-OF-SELECTED-ITEMS      32020062
320300            MOVE ASC-CURR-OPER-UNT-ID-N                           32030062
320400                                TO CE002-CURR-OPER-UNT-ID-N       32040062
320500            MOVE ASC-CURR-FCLTY-ID-N                              32050062
320600                                TO CE002-CURR-FCLTY-ID-N          32060062
320700            MOVE ASC-CS-LOC-N                                     32070062
320800                               TO CE002-CS-LOCATION               32080062
320900            MOVE ASC-CS-PRINTER-ID                                32090062
321000                               TO CE002-CS-PRINTER-ID             32100062
321100            MOVE ASC-PULL-NBR-N                                   32110062
321200                               TO CE002-PULL-NBR                  32120062
321300            MOVE ASC-REF-NBR   TO CE002-REF-NBR                   32130062
321400            MOVE ASC-PULL-SELECT-STATUS                           32140062
321500                               TO CE002-PULL-SELECT-STATUS        32150062
321600            MOVE ASC-PULL-SELECT-TYPE                             32160062
321700                               TO CE002-PULL-SELECT-TYPE          32170062
321800            MOVE ASC-SELECT-LIST-SEQUENCE                         32180062
321900                           TO CE002-SELECT-LIST-SEQUENCE          32190062
322000            PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                  32200062
322100            PERFORM 5000-PREPARE-SEL-QUEUE                        32210062
322200         ELSE                                                     32220062
322300            IF ASC-NUMBER-OF-SELECTED-ITEMS = 0                   32230062
322400               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               32240062
322500               SET  PS-ERROR                                      32250062
322600                    DP030-OVERRIDE-GO                             32260062
322700                    DP020-MSG-WARNING       TO TRUE               32270062
322800               MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER           32280062
322900            ELSE                                                  32290062
323000               IF ASC-NUMBER-OF-SELECTED-ITEMS > +1               32300062
323100                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            32310062
323200                  SET  PS-ERROR                                   32320062
323300                       DP030-OVERRIDE-GO                          32330062
323400                       DP020-MSG-WARNING       TO TRUE            32340062
323500                  MOVE PC-TSYMSG-00047 TO DP020-MSG-NUMBER        32350062
323600               END-IF                                             32360062
323700            END-IF                                                32370062
323800         END-IF                                                   32380062
323900                                                                  32390062
324000***                                                               32400062
324100***  THIS LOGIC WAS MOVED TO THE EDIT PORTION OF THE PROGRAM      32410062
324200***  NEW PARAGRAPH 3645 WILL BE USED TO VERIFY RDM FACILITY       32420062
324300***                                                               32430062
324400***      PERFORM 3700-GET-STORE-INFORMATION                       32440062
324500***      PERFORM 3390-VALIDATE-RDM-FACILITY                       32450062
324600***      IF PS-VALID-RDM-FACILITY                                 32460062
324700***         CONTINUE                                              32470062
324800***      ELSE                                                     32480062
324900***         PERFORM 3391-CHECK-CE-PULL-LOC                        32490062
325000***      END-IF                                                   32500062
325100***                                                               32510062
325200                                                                  32520062
325300         IF PS-VALID-RDM-FACILITY                                 32530062
325400            IF ASC-NUMBER-OF-SELECTED-ITEMS = +1                  32540062
325500               SET ASC-XCNTL-TO-RESEND   TO TRUE                  32550062
325600            END-IF                                                32560062
325700         END-IF                                                   32570062
325800                                                                  32580062
325900***          ELSE                                                 32590062
326000***             PERFORM 2050-DELETE-LIST-QUEUE                    32600062
326100***             PERFORM 4000-BUILD-INITIAL-PANEL                  32610062
326200***             SET  PS-ERROR                                     32620062
326300***                  DP030-OVERRIDE-GO                            32630062
326400***                  DP020-MSG-FATAL TO TRUE                      32640062
326500***             MOVE PC-TSYMSG-02516 TO DP020-MSG-NUMBER          32650062
326600***          END-IF                                               32660062
326700                                                                  32670062
326800*                                                                 32680062
326900* F17 - ITEM LIST       (LOCAL-FUNC-03)                           32690062
327000* F22 - STATUS LIST     (LOCAL-FUNC-07)                           32700062
327100* EA 08/02/2010                                                   32710062
327200* F18 - PLDC LIST       (LOCAL-FUNC-09)                           32720062
327300* EA 08/02/2010                                                   32730062
327400*                                                                 32740062
327500                                                                  32750062
327600         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              32760062
327700         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              32770062
327800         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              32780062
327900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              32790062
328000                 INITIALIZE CE001-INTER-APPL-COMMAREA             32800062
328100                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                32810062
328200                                TO CE002-NUMBER-OF-SELECTED-ITEMS 32820062
328300                 MOVE ASC-CURR-OPER-UNT-ID-N                      32830062
328400                                    TO CE002-CURR-OPER-UNT-ID-N   32840062
328500                 MOVE ASC-CURR-FCLTY-ID-N                         32850062
328600                                    TO CE002-CURR-FCLTY-ID-N      32860062
328700                 MOVE ASC-CS-LOC-N                                32870062
328800                                    TO CE002-CS-LOCATION          32880062
328900                 MOVE ASC-CS-PRINTER-ID                           32890062
329000                                    TO CE002-CS-PRINTER-ID        32900062
329100                 MOVE ASC-PULL-NBR-N                              32910062
329200                                    TO CE002-PULL-NBR             32920062
329300                 MOVE ASC-REF-NBR   TO CE002-REF-NBR              32930062
329400                 MOVE ASC-PULL-SELECT-STATUS                      32940062
329500                                    TO CE002-PULL-SELECT-STATUS   32950062
329600                 MOVE ASC-PULL-SELECT-TYPE                        32960062
329700                                    TO CE002-PULL-SELECT-TYPE     32970062
329800                 MOVE ASC-SELECT-LIST-SEQUENCE                    32980062
329900                                    TO CE002-SELECT-LIST-SEQUENCE 32990062
330000                 PERFORM 5000-PREPARE-SEL-QUEUE                   33000062
330100             ELSE                                                 33010062
330200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             33020062
330300                 SET DP030-OVERRIDE-GO                            33030062
330400                                   TO TRUE                        33040062
330500                 MOVE PC-TSYMSG-00057                             33050062
330600                                   TO DP020-MSG-NUMBER            33060062
330700                 SET DP020-MSG-WARNING                            33070062
330800                                   TO TRUE                        33080062
330900             END-IF                                               33090062
331000*                                                                 33100062
331100* F2-CONFIRM -CNCL/UNCNCL- -CNFM/UNCNFM DISTRO-                   33110062
331200*                                                                 33120062
331300         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    33130062
331400             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              33140062
331500                 EVALUATE TRUE                                    33150062
331600                     WHEN ASC-CONFIRM-CNCL-PULL                   33160062
331700                     WHEN ASC-CONFIRM-UNCNCL-PULL                 33170062
331800                     WHEN ASC-CONFIRM-CONF-DIST                   33180062
331900                     WHEN ASC-CONFIRM-UNCONF-DIST                 33190062
332000                     WHEN ASC-CONFIRM-CONF-PULL                   33200062
332100                     WHEN ASC-CONFIRM-UNCONF-PULL                 33210062
332200                          PERFORM 4700-PROCESS-CONFIRM-FUNCTION   33220062
332300                          VARYING PV-ITEM  FROM 1 BY 1            33230062
332400                          UNTIL PV-ITEM >                         33240062
332500                                        ASC-HIGHEST-BLOCK-WRITTEN 33250062
332600                             OR PS-SOFT-ABORT-ERROR               33260062
332700                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    33270062
332800                                                                  33280062
332900                  WHEN OTHER                                      33290062
333000                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       33300062
333100                       SET  PS-ERROR                              33310062
333200                            DP020-MSG-FATAL  TO TRUE              33320062
333300                       MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER  33330062
333400                                                                  33340062
333500                  END-EVALUATE                                    33350062
333600             ELSE                                                 33360062
333700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             33370062
333800                 SET DP030-OVERRIDE-GO       TO TRUE              33380062
333900                 MOVE PC-TSYMSG-00057        TO DP020-MSG-NUMBER  33390062
334000                 SET DP020-MSG-WARNING       TO TRUE              33400062
334100             END-IF                                               33410062
334200                                                                  33420062
334300             SET  ASC-CONFIRM-TYPE-NONE  TO  TRUE                 33430062
334400*                                                                 33440062
334500* F14 - CANCEL/UNCANCEL           (LOCAL-FUNC-01)                 33450062
334600* F15 - RESEND                    (LOCAL-FUNC-08)                 33460062
334700* F24 - CONFIRM/UNCONFIRM DISTR   (LOCAL-FUNC-04)                 33470062
334800*                                                                 33480062
334900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              33490062
335000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              33500062
335100         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              33510062
335200                 IF  ASC-NUMBER-OF-SELECTED-ITEMS = +1            33520062
335300                     CONTINUE                                     33530062
335400                 ELSE                                             33540062
335500                     IF  ASC-NUMBER-OF-SELECTED-ITEMS > +1        33550062
335600                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     33560062
335700                         SET DP030-OVERRIDE-GO TO TRUE            33570062
335800                         MOVE PC-TSYMSG-00047  TO DP020-MSG-NUMBER33580062
335900                         SET DP020-MSG-WARNING  TO TRUE           33590062
336000                     ELSE                                         33600062
336100                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     33610062
336200                         SET DP030-OVERRIDE-GO TO TRUE            33620062
336300                         MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER33630062
336400                         SET DP020-MSG-WARNING  TO TRUE           33640062
336500                     END-IF                                       33650062
336600                 END-IF                                           33660062
336700*                                                                 33670062
336800* F6 - FIRST PAGE                                                 33680062
336900*                                                                 33690062
337000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  33700062
337100             MOVE +1               TO PV-TOP-ITEM                 33710062
337200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 33720062
337300*                                                                 33730062
337400* F7 - PREVIOUS PAGE                                              33740062
337500*                                                                 33750062
337600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   33760062
337700             PERFORM 2110-BROWSE-BACKWARD                         33770062
337800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 33780062
337900*                                                                 33790062
338000* F8 - NEXT PAGE                                                  33800062
338100*                                                                 33810062
338200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   33820062
338300             PERFORM 3200-RESET-ATTRIBUTES                        33830062
338400             MOVE -1               TO  MR-SELECTL(1)              33840062
338500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   33850062
338600             PERFORM 2120-BROWSE-FORWARD                          33860062
338700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 33870062
338800*                                                                 33880062
338900* ENTER                                                           33890062
339000*                                                                 33900062
339100         WHEN DP020-SRC-AID = DP016-ENTER                         33910062
339200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   33920062
339300             IF  PS-ERROR                                         33930062
339400                 CONTINUE                                         33940062
339500             ELSE                                                 33950062
339501*** DMH - 1/18/12 BEGIN                                           33950163
339510                 PERFORM 3200-RESET-ATTRIBUTES                    33951063
339520                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               33952063
339530*** DMH - 1/18/12 END                                             33953063
339600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             33960062
339700             END-IF                                               33970062
339800                                                                  33980062
339900         WHEN OTHER                                               33990062
340000             SET DP013-NO-ROLLBACK                                34000062
340100                 DP013-XCTL-DISPLAY-RESTART                       34010062
340200                 DP013-CICS-ABEND  TO TRUE                        34020062
340300             MOVE '2100-CHECK-FUNCTION-KEY'                       34030062
340400                                   TO DP013-PARAGRAPH             34040062
340500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      34050062
340600                                   TO DP013-MESSAGE-TEXT (1)      34060062
340700             PERFORM DP013-0000-PROCESS-ABEND                     34070062
340800     END-EVALUATE.                                                34080062
340900                                                                  34090062
341000                                                                  34100062
341100*----------------------------------------------------------------*34110062
341200* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     34120062
341300*----------------------------------------------------------------*34130062
341400 2105-RACF-ACCESS.                                                34140062
341500                                                                  34150062
341600      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  34160062
341700      SET DP008-ACCESS-TYPE-USE          TO TRUE                  34170062
341800                                                                  34180062
341900      EXEC CICS                                                   34190062
342000         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 34200062
342100              COMMAREA (DP008-SECURITY-COMMAREA)                  34210062
342200              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             34220062
342300      END-EXEC                                                    34230062
342400                                                                  34240062
342500      IF DP008-CALL-SUCCESSFUL                                    34250062
342600         IF DP008-ACCESS-ALLOWED                                  34260062
342700             SET PS-ACCESS-ALLOWED TO TRUE                        34270062
342800         ELSE                                                     34280062
342900             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    34290062
343000             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          34300062
343100             STRING ' CEKCS601- RACF -'  DELIMITED BY SIZE        34310062
343200                    ' DP008-ACCESS-SW- ' DELIMITED BY SIZE        34320062
343300                      DP008-ACCESS-SW    DELIMITED BY SIZE        34330062
343400                    ' RACF ERROR CODE-'  DELIMITED BY SIZE        34340062
343500                      PV-RACF-ERROR-CODE DELIMITED BY SIZE        34350062
343600                                    INTO PV-CICS-MSG-AREA2        34360062
343700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     34370062
343800               TO PV-COMMAREA-LENGTH                              34380062
343900             EXEC CICS                                            34390062
344000                  WRITEQ TD                                       34400062
344100                   QUEUE  ('CSSL')                                34410062
344200                    FROM  (PV-CICS-MSG-AREA2)                     34420062
344300                  LENGTH  (PV-COMMAREA-LENGTH)                    34430062
344400                    RESP  (PV-CICS-RESP)                          34440062
344500             END-EXEC                                             34450062
344600         END-IF                                                   34460062
344700     ELSE                                                         34470062
344800         MOVE ' 2105-RACF-ACCESS'                                 34480062
344900                               TO DP013-PARAGRAPH                 34490062
345000          MOVE 'UNABLE TO ACCESS CICS'                            34500062
345100                               TO DP013-MESSAGE-TEXT (1)          34510062
345200          MOVE SQLCA                 TO DP013-SQLCA               34520062
345300          SET DP013-DB2-ABEND                                     34530062
345400              DP013-XCTL-DISPLAY-RESTART                          34540062
345500                               TO TRUE                            34550062
345600          PERFORM DP013-0000-PROCESS-ABEND                        34560062
345700      END-IF.                                                     34570062
345800                                                                  34580062
345900                                                                  34590062
346000                                                                  34600062
346100*----------------------------------------------------------------*34610062
346200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *34620062
346300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *34630062
346400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *34640062
346500*    MESSAGE.                                                    *34650062
346600*----------------------------------------------------------------*34660062
346700                                                                  34670062
346800 2110-BROWSE-BACKWARD.                                            34680062
346900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    34690062
347000         GIVING PV-TOP-ITEM.                                      34700062
347100*                                                                 34710062
347200     IF  ((PV-TOP-ITEM < +1)                                      34720062
347300       OR (PV-TOP-ITEM = +1))                                     34730062
347400         MOVE +1                   TO PV-TOP-ITEM                 34740062
347500*        -- TOP OF LIST --                                        34750062
347600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            34760062
347700         SET DP020-MSG-INFORMATIONAL TO TRUE                      34770062
347800     END-IF.                                                      34780062
347900                                                                  34790062
348000 EJECT                                                            34800062
348100*----------------------------------------------------------------*34810062
348200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *34820062
348300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *34830062
348400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *34840062
348500*----------------------------------------------------------------*34850062
348600                                                                  34860062
348700 2120-BROWSE-FORWARD.                                             34870062
348800                                                                  34880062
348900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              34890062
349000         GIVING PV-TOP-ITEM.                                      34900062
349100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   34910062
349200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            34920062
349300                                   TO PV-TOP-ITEM                 34930062
349400*        -- BOTTOM OF LIST --                                     34940062
349500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            34950062
349600         SET DP020-MSG-INFORMATIONAL                              34960062
349700                                   TO TRUE                        34970062
349800     ELSE                                                         34980062
349900         COMPUTE PV-BOTTOM-ITEM =                                 34990062
350000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 35000062
350100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            35010062
350200*            -- BOTTOM OF LIST --                                 35020062
350300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            35030062
350400             SET DP020-MSG-INFORMATIONAL                          35040062
350500                                   TO TRUE                        35050062
350600         END-IF                                                   35060062
350700     END-IF.                                                      35070062
350800 EJECT                                                            35080062
350900*----------------------------------------------------------------*35090062
351000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *35100062
351100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *35110062
351200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *35120062
351300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *35130062
351400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *35140062
351500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *35150062
351600*----------------------------------------------------------------*35160062
351700                                                                  35170062
351800 2130-CHECK-FOR-JUMP-BROWSE.                                      35180062
351900     SET PS-NO-ERROR               TO TRUE.                       35190062
352000     IF (ASC-START-ITEM-REQUEST = SPACE)                          35200062
352100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            35210062
352200                                   TO PV-TOP-ITEM                 35220062
352300     ELSE                                                         35230062
352400         MOVE ASC-START-ITEM-REQUEST                              35240062
352500                                   TO DP010I-UNEDITED-FIELD       35250062
352510         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     35251068
352520         MOVE LENGTH OF ASC-START-ITEM-REQUEST                    35252068
352600                                 TO DP010I-MAXIMUM-DIGITS         35260068
352800         SET DP010I-NEGATIVE-NOT-ALLOWED                          35280062
352900                                   TO TRUE                        35290062
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         35301072
263455              USING DP010I-NUMERIC-EDIT-AREA                      35302072
353100                                                                  35310062
353200         IF  NOT DP010I-ERROR-DETECTED                            35320062
353300             MOVE DP010I-NUMERIC-FIELD                            35330062
353400                                   TO  ASC-START-ITEM-REQUEST-N   35340062
353500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  35350062
353600                 IF  ASC-START-ITEM-REQUEST-N >                   35360062
353700                                          ASC-NUMBER-OF-ITEMS-READ35370062
353800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         35380062
353900                     COMPUTE PV-TOP-ITEM =                        35390062
354000                             ASC-NUMBER-OF-ITEMS-READ             35400062
354100                             - PC-ITEMS-PER-PANEL + 1             35410062
354200                     IF  PV-TOP-ITEM < +1                         35420062
354300                         MOVE +1   TO PV-TOP-ITEM                 35430062
354400                         MOVE PC-TSYMSG-00070                     35440062
354500                                   TO DP020-MSG-NUMBER            35450062
354600                         SET DP020-MSG-INFORMATIONAL              35460062
354700                                   TO TRUE                        35470062
354900                     ELSE                                         35490068
355000                         MOVE  PV-TOP-ITEM                        35500068
355100                           TO  ASC-START-ITEM-REQUEST-N           35510068
356100                     END-IF                                       35610062
356200                 ELSE                                             35620068
356210                     MOVE ASC-START-ITEM-REQUEST-N                35621068
356220                                   TO PV-TOP-ITEM                 35622068
356230                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      35623068
356240                     COMPUTE PV-BOTTOM-ITEM =                     35624068
356250                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     35625068
356260                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ35626068
356270                         SUBTRACT  PV-TOP-ITEM                    35627068
356280                             FROM  ASC-NUMBER-OF-ITEMS-READ       35628068
356290                           GIVING  ASC-ITEMS-DISPLAYED            35629068
356291                         MOVE  ASC-NUMBER-OF-ITEMS-READ           35629168
356292                           TO  PV-BOTTOM-ITEM                     35629268
356293*                        -- BOTTOM OF LIST --                     35629368
356294                         MOVE PC-TSYMSG-00070                     35629468
356295                                   TO DP020-MSG-NUMBER            35629568
356296                         SET DP020-MSG-INFORMATIONAL              35629668
356297                                   TO TRUE                        35629768
356298                     END-IF                                       35629868
356299                 END-IF                                           35629968
356300             ELSE                                                 35630068
356400*                --- VALUE OUT OF RANGE ----                      35640062
356500                 MOVE PC-TSYMSG-00101                             35650062
356600                                   TO DP020-MSG-NUMBER            35660062
356700                 MOVE -1           TO ASTRTITL                    35670062
356800                 SET DP030-SET-CURSOR-APPL-1                      35680062
356900                                   TO TRUE                        35690062
357000                 MOVE DP015-REVERSE                               35700062
357100                                   TO ASTRTITH                    35710062
357200                 MOVE DP015-RED    TO ASTRTITC                    35720062
357300                 MOVE DP015-UNP-NUM-BRT-MDT                       35730062
357400                                   TO ASTRTITA                    35740062
357500                 SET DP020-MSG-FATAL                              35750062
357600                                   TO TRUE                        35760062
357700                 SET PS-ERROR      TO TRUE                        35770062
357800             END-IF                                               35780062
357900                                                                  35790062
358000         ELSE                                                     35800062
358100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            35810062
358200             MOVE -1               TO ASTRTITL                    35820062
358300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  35830062
358400             MOVE DP015-REVERSE    TO ASTRTITH                    35840062
358500             MOVE DP015-RED        TO ASTRTITC                    35850062
358600             MOVE DP015-UNP-NUM-BRT-MDT                           35860062
358700                                   TO ASTRTITA                    35870062
358800             SET DP020-MSG-FATAL   TO TRUE                        35880062
358900             SET PS-ERROR          TO TRUE                        35890062
359000         END-IF                                                   35900062
359100     END-IF.                                                      35910062
359200 EJECT                                                            35920062
359300*----------------------------------------------------------------*35930062
359400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *35940062
359500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *35950062
359600*----------------------------------------------------------------*35960062
359700 2140-DESELECT-ALL-ITEMS.                                         35970062
359800     MOVE +1                       TO ASC-BLK-SUB.                35980062
359900                                                                  35990062
360000     PERFORM 2141-CLEAR-SELECTED-INDS                             36000062
360100         VARYING ASC-ITEM-SUB                                     36010062
360200         FROM 1 BY 1                                              36020062
360300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 36030062
360400                                                                  36040062
360500     ADD +1                        TO ASC-BLK-SUB.                36050062
360600                                                                  36060062
360700     PERFORM 2141-CLEAR-SELECTED-INDS                             36070062
360800         VARYING ASC-ITEM-SUB                                     36080062
360900         FROM 1 BY 1                                              36090062
361000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 36100062
361100                                                                  36110062
361200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               36120062
361300                                   TO PV-LIST-ITEM-NUMBER.        36130062
361400                                                                  36140062
361500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            36150062
361600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    36160062
361700                                                                  36170062
361800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     36180062
361900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      36190062
362000         MOVE +1                   TO ASC-BLK-SUB                 36200062
362100                                                                  36210062
362200         PERFORM 5100-WRITE-TEMP-STORAGE                          36220062
362300                                                                  36230062
362400         MOVE +1                   TO PV-BLOCK-NUMBER             36240062
362500                                                                  36250062
362600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         36260062
362700             PV-FIRST-BLOCK-IN-ARRAY - 1                          36270062
362800                                                                  36280062
362900         PERFORM                                                  36290062
363000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       36300062
363100                                                                  36310062
363200             PERFORM 4410-READ-TEMP-STORAGE                       36320062
363300                                                                  36330062
363400             PERFORM 2141-CLEAR-SELECTED-INDS                     36340062
363500                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 36350062
363600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          36360062
363700                                                                  36370062
363800             PERFORM 5100-WRITE-TEMP-STORAGE                      36380062
363900                                                                  36390062
364000             ADD +1                TO PV-BLOCK-NUMBER             36400062
364100                                                                  36410062
364200         END-PERFORM                                              36420062
364300                                                                  36430062
364400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         36440062
364500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     36450062
364600                                                                  36460062
364700         PERFORM                                                  36470062
364800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       36480062
364900                   ASC-HIGHEST-BLOCK-WRITTEN                      36490062
365000                                                                  36500062
365100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          36510062
365200                                   TO PV-BLOCK-NUMBER             36520062
365300                                                                  36530062
365400             PERFORM 4410-READ-TEMP-STORAGE                       36540062
365500                                                                  36550062
365600             PERFORM 2141-CLEAR-SELECTED-INDS                     36560062
365700                 VARYING ASC-ITEM-SUB                             36570062
365800                 FROM 1 BY 1                                      36580062
365900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          36590062
366000                                                                  36600062
366100             PERFORM 5100-WRITE-TEMP-STORAGE                      36610062
366200                                                                  36620062
366300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      36630062
366400                                                                  36640062
366500         END-PERFORM                                              36650062
366600                                                                  36660062
366700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             36670062
366800                                   TO PV-BLOCK-NUMBER             36680062
366900                                                                  36690062
367000         PERFORM 4410-READ-TEMP-STORAGE                           36700062
367100     END-IF.                                                      36710062
367200                                                                  36720062
367300     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.36730062
367400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.36740062
367500     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  36750062
367600                                                                  36760062
367700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        36770062
367800                                                                  36780062
367900 EJECT                                                            36790062
368000*----------------------------------------------------------------*36800062
368100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *36810062
368200*----------------------------------------------------------------*36820062
368300                                                                  36830062
368400 2141-CLEAR-SELECTED-INDS.                                        36840062
368500                                                                  36850062
368600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           36860062
368700             NOT EQUAL ZERO                                       36870062
368800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          36880062
368900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          36890062
369000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    36900062
369100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  36910062
369200                                   TO TRUE                        36920062
369300         END-IF                                                   36930062
369400     END-IF.                                                      36940062
369500                                                                  36950062
369600 EJECT                                                            36960062
369700*----------------------------------------------------------------*36970062
369800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *36980062
369900*  FOR ALL ITEMS.                                                *36990062
370000*----------------------------------------------------------------*37000062
370100                                                                  37010062
370200 2150-SELECT-ALL-ITEMS.                                           37020062
370300                                                                  37030062
370400     MOVE +1                       TO ASC-BLK-SUB.                37040062
370500                                                                  37050062
370600     PERFORM 2151-SET-SELECTED-INDS                               37060062
370700         VARYING ASC-ITEM-SUB                                     37070062
370800         FROM 1 BY 1                                              37080062
370900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 37090062
371000                                                                  37100062
371100     ADD +1                        TO ASC-BLK-SUB.                37110062
371200                                                                  37120062
371300     PERFORM 2151-SET-SELECTED-INDS                               37130062
371400         VARYING ASC-ITEM-SUB                                     37140062
371500         FROM 1 BY 1                                              37150062
371600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 37160062
371700                                                                  37170062
371800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               37180062
371900                                   TO PV-LIST-ITEM-NUMBER.        37190062
372000                                                                  37200062
372100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            37210062
372200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37220062
372300                                                                  37230062
372400* 2/18/00 - BEGIN                                                 37240062
372500     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            37250062
372600         MOVE +1                   TO ASC-BLK-SUB                 37260062
372700                                                                  37270062
372800         PERFORM 5100-WRITE-TEMP-STORAGE                          37280062
372900         MOVE +2                   TO ASC-BLK-SUB                 37290062
373000         PERFORM 5100-WRITE-TEMP-STORAGE                          37300062
373100         MOVE +1                   TO ASC-BLK-SUB                 37310062
373200         MOVE +1                   TO PV-BLOCK-NUMBER             37320062
373300     END-IF.                                                      37330062
373400* 2/18/00 - END                                                   37340062
373500                                                                  37350062
373600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     37360062
373700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    37370062
373800         MOVE +1                   TO ASC-BLK-SUB                 37380062
373900                                                                  37390062
374000         PERFORM 5100-WRITE-TEMP-STORAGE                          37400062
374100                                                                  37410062
374200         MOVE +1                   TO PV-BLOCK-NUMBER             37420062
374300                                                                  37430062
374400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         37440062
374500             PV-FIRST-BLOCK-IN-ARRAY - 1                          37450062
374600                                                                  37460062
374700         PERFORM                                                  37470062
374800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       37480062
374900                                                                  37490062
375000             PERFORM 4410-READ-TEMP-STORAGE                       37500062
375100                                                                  37510062
375200             PERFORM 2151-SET-SELECTED-INDS                       37520062
375300                 VARYING ASC-ITEM-SUB                             37530062
375400                 FROM 1 BY 1                                      37540062
375500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          37550062
375600                                                                  37560062
375700             PERFORM 5100-WRITE-TEMP-STORAGE                      37570062
375800                                                                  37580062
375900             ADD +1                TO PV-BLOCK-NUMBER             37590062
376000                                                                  37600062
376100         END-PERFORM                                              37610062
376200                                                                  37620062
376300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         37630062
376400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     37640062
376500                                                                  37650062
376600         PERFORM                                                  37660062
376700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       37670062
376800                   ASC-HIGHEST-BLOCK-WRITTEN                      37680062
376900                                                                  37690062
377000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          37700062
377100                                   TO PV-BLOCK-NUMBER             37710062
377200                                                                  37720062
377300             PERFORM 4410-READ-TEMP-STORAGE                       37730062
377400                                                                  37740062
377500             PERFORM 2151-SET-SELECTED-INDS                       37750062
377600                 VARYING ASC-ITEM-SUB                             37760062
377700                 FROM 1 BY 1                                      37770062
377800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          37780062
377900                                                                  37790062
378000             PERFORM 5100-WRITE-TEMP-STORAGE                      37800062
378100                                                                  37810062
378200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      37820062
378300                                                                  37830062
378400         END-PERFORM                                              37840062
378500                                                                  37850062
378600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             37860062
378700                                   TO PV-BLOCK-NUMBER             37870062
378800                                                                  37880062
378900         PERFORM 4410-READ-TEMP-STORAGE                           37890062
379000     END-IF.                                                      37900062
379100                                                                  37910062
379200                                                                  37920062
379300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             37930062
379400                       ASC-NUMBER-OF-SELECTED-ITEMS.              37940062
379500                                                                  37950062
379600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        37960062
379700                                                                  37970062
379800 EJECT                                                            37980062
379900*----------------------------------------------------------------*37990062
380000*    MARK EACH ITEM AS BEING SELECTED.                           *38000062
380100*----------------------------------------------------------------*38010062
380200                                                                  38020062
380300 2151-SET-SELECTED-INDS.                                          38030062
380400                                                                  38040062
380500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           38050062
380600             NOT EQUAL ZERO                                       38060062
380700         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             38070062
380800             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             38080062
380900                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        38090062
381000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  38100062
381100                               TO  TRUE                           38110062
381200         END-IF                                                   38120062
381300     END-IF.                                                      38130062
381400******************************************************************38140062
381500** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **38150062
381600** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **38160062
381700******************************************************************38170062
381800 2200-MOVE-SCREEN-TO-COMMAREA.                                    38180062
381900                                                                  38190062
382000     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             38200062
382100     MOVE +1                       TO PV-SUB.                     38210062
382200*                                                                 38220062
382300     PERFORM 3100-SET-SUBSCRIPTS.                                 38230062
382400     IF  ASTRTITL > ZERO                                          38240062
382500         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          38250062
382600     ELSE                                                         38260062
382700         IF  ASTRTITF = DP015-ERASE-EOF                           38270062
382800             INITIALIZE ASC-START-ITEM-REQUEST                    38280062
382900         END-IF                                                   38290062
383000     END-IF.                                                      38300062
383100                                                                  38310062
383200     IF  APRTIDL > ZERO                                           38320062
383300         MOVE APRTIDI          TO ASC-CS-PRINTER-ID               38330062
383400     ELSE                                                         38340062
383500         IF  APRTIDF = DP015-ERASE-EOF                            38350062
383600             MOVE  SPACES      TO ASC-CS-PRINTER-ID               38360062
383700         END-IF                                                   38370062
383800     END-IF.                                                      38380062
383900                                                                  38390062
384000     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          38400062
384100         VARYING PV-SUB                                           38410062
384200         FROM 1 BY 1                                              38420062
384300         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      38430062
384400******************************************************************38440062
384500** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**38450062
384600******************************************************************38460062
384700 2210-MOVE-LINES-TO-COMMAREA.                                     38470062
384800     IF  MR-SELECTL (PV-SUB) > ZERO                               38480062
384900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             38490062
385000         MOVE MR-SELECTI (PV-SUB)                                 38500062
385100                                   TO ASC-TEMP-SELECTED-SW        38510062
385200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      38520062
385300     ELSE                                                         38530062
385400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                38540062
385500                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     38550062
385600                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        38560062
385700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      38570062
385800         END-IF                                                   38580062
385900     END-IF.                                                      38590062
386000     ADD +1                        TO ASC-ITEM-SUB.               38600062
386100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38610062
386200         ADD +1                    TO ASC-BLK-SUB                 38620062
386300         MOVE +1                   TO ASC-ITEM-SUB                38630062
386400     END-IF.                                                      38640062
386500******************************************************************38650062
386600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **38660062
386700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **38670062
386800******************************************************************38680062
386900 3000-EDIT-DATA-IN-COMMAREA.                                      38690062
387000     SET PS-NO-ERROR               TO TRUE.                       38700062
387100     PERFORM 3200-RESET-ATTRIBUTES.                               38710062
387200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     38720062
387300                                                                  38730062
387400*-----------------------------------------------------------------38740062
387500* VALIDATE PRINTER ID                                             38750062
387600*-----------------------------------------------------------------38760062
387700     IF  PS-NO-ERROR                                              38770062
387800         EVALUATE TRUE                                            38780062
387900             WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)          38790062
388000                  PERFORM 3010-VALIDATE-PRINTER-ID                38800062
388100         END-EVALUATE                                             38810062
388200     END-IF.                                                      38820062
388300*-----------------------------------------------------------------38830062
388400* VERIFY RACF AUTHORITY                                           38840062
388500*  F14 - LOCAL-01 (CANCEL/UNCANCEL)                               38850062
388600*  F24 - LOCAL-04 (CONFIRM/UNCONFIRM DISTRIBUTION)                38860062
388700*-----------------------------------------------------------------38870062
388800     EVALUATE TRUE                                                38880062
388900                                                                  38890062
389000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              38900062
389100                                                                  38910062
389200              MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME              38920062
389300              PERFORM 2105-RACF-ACCESS                            38930062
389400              IF  PS-ACCESS-NOT-ALLOWED                           38940062
389500                  SET  PS-ERROR                                   38950062
389600                       DP020-MSG-FATAL TO TRUE                    38960062
389700                  MOVE PC-TSYMSG-02307 TO DP020-MSG-NUMBER        38970062
389800                  MOVE -1              TO MR-SELECTL (1)          38980062
389900                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            38990062
390000              END-IF                                              39000062
390100                                                                  39010062
390200         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              39020062
390300                                                                  39030062
390400              MOVE 'CECSPCNF' TO DP008-FUNCTION-NAME              39040062
390500              PERFORM 2105-RACF-ACCESS                            39050062
390600              IF  PS-ACCESS-NOT-ALLOWED                           39060062
390700                  SET  PS-ERROR                                   39070062
390800                       DP020-MSG-FATAL TO TRUE                    39080062
390900                  MOVE PC-TSYMSG-02308 TO DP020-MSG-NUMBER        39090062
391000                  MOVE -1              TO MR-SELECTL (1)          39100062
391100                  SET  DP030-SET-CURSOR-APPL-1 TO TRUE            39110062
391200              END-IF                                              39120062
391300                                                                  39130062
391400     END-EVALUATE.                                                39140062
391500                                                                  39150062
391600**                                                                39160062
391700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              39170062
391800* EDITTING IS DONE FROM THE BOTTOM UP.                            39180062
391900**                                                                39190062
392000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       39200062
392100         ASC-ITEMS-DISPLAYED - 1.                                 39210062
392200     PERFORM 3100-SET-SUBSCRIPTS.                                 39220062
392300                                                                  39230062
392400     IF  PS-NO-ERROR                                              39240062
392500         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        39250062
392600     END-IF.                                                      39260062
392700                                                                  39270062
392800     IF  PS-NO-ERROR                                              39280062
392900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        39290062
393000     END-IF.                                                      39300062
393100*                                                                 39310062
393200     IF  ((PS-NO-ERROR)                                           39320062
393300       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   39330062
393400       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    39340062
393500             PERFORM 3500-MARK-RANGE-AS-SELECTED                  39350062
393600     END-IF.                                                      39360062
393700                                                                  39370062
393800*----------------------------------------------------------------*39380062
393900*   3005-EDIT-COMMAREA-BLOCKS                                    *39390062
394000*----------------------------------------------------------------*39400062
394100 3005-EDIT-COMMAREA-BLOCKS.                                       39410062
394200     MOVE +1                       TO PV-BLOCK-NUMBER.            39420062
394300     MOVE +1                       TO ASC-BLK-SUB.                39430070
394400     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               39440062
394500                                                                  39450062
394600     COMPUTE PV-BLOCK-NUMBER  =                                   39460062
394700        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 39470062
394800            PC-ITEMS-PER-PANEL.                                   39480062
394900                                                                  39490062
395000     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          39500062
395100                                                                  39510062
395200     PERFORM                                                      39520062
395300       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          39530062
395400          OR PS-ERROR                                             39540062
395500          OR PS-BLOCK-ERROR                                       39550062
395600                                                                  39560062
395700             COMPUTE PV-ITEMS-HOLD  =                             39570062
395800                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        39580062
395900                     PC-ITEMS-PER-PANEL - 1                       39590062
396000                                                                  39600062
396100             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       39610062
396200                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               39620062
396300                     FROM  PV-ITEMS-HOLD                          39630062
396400                   GIVING  PV-ITEMS-DIFF                          39640062
396500                 SUBTRACT  PV-ITEMS-DIFF                          39650062
396600                     FROM  PC-ITEMS-PER-PANEL                     39660062
396700                   GIVING  PV-ITEMS-HOLD                          39670062
396800                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              39680062
396900                                              ASC-ITEM-SUB        39690062
397000                                              ASC-ITEMS-DISPLAYED 39700062
397100             ELSE                                                 39710062
397200                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              39720062
397300                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        39730062
397400             END-IF                                               39740062
397500                                                                  39750062
397600             PERFORM 3300-EDIT-SELECTIONS                         39760062
397700                     VARYING PV-SUB                               39770062
397800                        FROM PV-SUB BY -1                         39780062
397900                       UNTIL PV-SUB < +1                          39790062
398000                                                                  39800062
398100             MOVE +1               TO ASC-BLK-SUB                 39810062
398200                                                                  39820062
398300             PERFORM 5105-REWRITE-ASC-LISTQ                       39830062
398400                                                                  39840062
398500             MOVE +1                TO ASC-BLK-SUB                39850062
398600                                                                  39860062
398700             IF  PS-BLOCK-ERROR                                   39870062
398800                 SET  PS-ERROR     TO TRUE                        39880062
398900                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        39890062
399000                                   TO PV-TOP-ITEM                 39900062
399100             ELSE                                                 39910062
399200                 ADD  +1           TO PV-BLOCK-NUMBER             39920062
399300                 IF  PV-BLOCK-NUMBER >                            39930062
399400                     ASC-HIGHEST-BLOCK-WRITTEN                    39940062
399500                     MOVE +2       TO ASC-BLK-SUB                 39950062
399600                     PERFORM 4410-READ-TEMP-STORAGE               39960062
399700                     MOVE +1       TO ASC-BLK-SUB                 39970062
399800                 ELSE                                             39980062
399900                     PERFORM 4410-READ-TEMP-STORAGE               39990062
400000                     ADD  +1        TO PV-BLOCK-NUMBER            40000062
400100                     MOVE +2        TO ASC-BLK-SUB                40010062
400200                     PERFORM 4410-READ-TEMP-STORAGE               40020062
400300                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            40030062
400400                     MOVE +1        TO ASC-BLK-SUB                40040062
400500                 END-IF                                           40050062
400600             END-IF                                               40060062
400700     END-PERFORM.                                                 40070062
400800                                                                  40080062
400900     IF  PV-ORIGINAL-BLOCK  = +1    OR                            40090062
401000         PS-ERROR                   OR                            40100062
401100         PS-BLOCK-ERROR                                           40110062
401200         CONTINUE                                                 40120062
401300     ELSE                                                         40130062
401400         MOVE +1                 TO PV-BLOCK-NUMBER               40140062
401500         MOVE +1                 TO ASC-BLK-SUB                   40150062
401600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  40160062
401700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           40170062
401800         PERFORM 4410-READ-TEMP-STORAGE                           40180062
401900                                                                  40190062
402000         PERFORM                                                  40200062
402100           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              40210062
402200              OR PS-ERROR                                         40220062
402300              OR PS-BLOCK-ERROR                                   40230062
402400                                                                  40240062
402500                 COMPUTE PV-ITEMS-HOLD  =                         40250062
402600                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    40260062
402700                         PC-ITEMS-PER-PANEL - 1                   40270062
402800                                                                  40280062
402900                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     40290062
403000                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           40300062
403100                         FROM  PV-ITEMS-HOLD                      40310062
403200                       GIVING  PV-ITEMS-DIFF                      40320062
403300                     SUBTRACT  PV-ITEMS-DIFF                      40330062
403400                         FROM  PC-ITEMS-PER-PANEL                 40340062
403500                       GIVING  PV-ITEMS-HOLD                      40350062
403600                         MOVE  PV-ITEMS-HOLD TO PV-SUB            40360062
403700                                                ASC-ITEM-SUB      40370062
403800                                               ASC-ITEMS-DISPLAYED40380062
403900                 ELSE                                             40390062
404000                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          40400062
404100                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    40410062
404200                 END-IF                                           40420062
404300                                                                  40430062
404400                 PERFORM 3300-EDIT-SELECTIONS                     40440062
404500                         VARYING PV-SUB                           40450062
404600                            FROM PV-SUB BY -1                     40460062
404700                           UNTIL PV-SUB < +1                      40470062
404800                                                                  40480062
404900                 EVALUATE TRUE                                    40490062
405000                     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  40500062
405100                          PERFORM 3006-CHECK-SAME-STATUS          40510062
405200                 END-EVALUATE                                     40520062
405300                                                                  40530062
405400                 MOVE +1               TO ASC-BLK-SUB             40540062
405500                                                                  40550062
405600                 PERFORM 5105-REWRITE-ASC-LISTQ                   40560062
405700                                                                  40570062
405800                 MOVE +1                TO ASC-BLK-SUB            40580062
405900                                                                  40590062
406000                 IF  PS-BLOCK-ERROR                               40600062
406100                     SET  PS-ERROR     TO TRUE                    40610062
406200                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    40620062
406300                                       TO PV-TOP-ITEM             40630062
406400                 ELSE                                             40640062
406500                     ADD  +1            TO PV-BLOCK-NUMBER        40650062
406600                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      40660062
406700                         MOVE +2        TO ASC-BLK-SUB            40670062
406800                         PERFORM 4410-READ-TEMP-STORAGE           40680062
406900                         MOVE +1        TO ASC-BLK-SUB            40690062
407000                     ELSE                                         40700062
407100                         PERFORM 4410-READ-TEMP-STORAGE           40710062
407200                         ADD  +1        TO PV-BLOCK-NUMBER        40720062
407300                         MOVE +2        TO ASC-BLK-SUB            40730062
407400                         PERFORM 4410-READ-TEMP-STORAGE           40740062
407500                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        40750062
407600                         MOVE +1        TO ASC-BLK-SUB            40760062
407700                     END-IF                                       40770062
407800                 END-IF                                           40780062
407900     END-PERFORM.                                                 40790062
408000                                                                  40800062
408100                                                                  40810062
408200*----------------------------------------------------------------*40820062
408300* CHECK TO MAKE SURE THAT ALL SELECTED ITEMS HAS SAME STATUS     *40830062
408400*----------------------------------------------------------------*40840062
408500 3006-CHECK-SAME-STATUS.                                          40850062
408600                                                                  40860062
408700     IF  PS-NO-BLOCK-ERROR                                        40870062
408800         EVALUATE TRUE                                            40880062
408900             WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)          40890062
409000                  EVALUATE TRUE                                   40900062
409100                      WHEN ASC-CONFIRM-UNCNCL-PULL                40910062
409200                           IF  PV-SEL-UNCNCL-CNT  =               40920062
409300                               ASC-NUMBER-OF-SELECTED-ITEMS       40930062
409400                               CONTINUE                           40940062
409500                            ELSE                                  40950062
409600                               SET PS-ERROR                       40960062
409700                                   PS-BLOCK-ERROR                 40970062
409800                                   DP020-MSG-FATAL                40980062
409900                                   DP030-SET-CURSOR-APPL-1 TO TRUE40990062
410000                               MOVE PC-TSYMSG-02278               41000062
410100                                        TO  DP020-MSG-NUMBER      41010062
410200                               MOVE -1  TO  MR-SELECTL (1)        41020062
410300                            END-IF                                41030062
410400                                                                  41040062
410500                       WHEN ASC-CONFIRM-CNCL-PULL                 41050062
410600                            IF  PV-SEL-CNCL-CNT  =                41060062
410700                                ASC-NUMBER-OF-SELECTED-ITEMS      41070062
410800                                CONTINUE                          41080062
410900                            ELSE                                  41090062
411000                               SET PS-ERROR                       41100062
411100                                   PS-BLOCK-ERROR                 41110062
411200                                   DP020-MSG-FATAL                41120062
411300                                   DP030-SET-CURSOR-APPL-1 TO TRUE41130062
411400                               MOVE PC-TSYMSG-02278               41140062
411500                                        TO  DP020-MSG-NUMBER      41150062
411600                               MOVE -1  TO  MR-SELECTL (1)        41160062
411700                            END-IF                                41170062
411800                 END-EVALUATE                                     41180062
411900         END-EVALUATE                                             41190062
412000     END-IF.                                                      41200062
412100                                                                  41210062
412200                                                                  41220062
412300*----------------------------------------------------------------*41230062
412400* VALIDATE PRINTER ID                                            *41240062
412500*----------------------------------------------------------------*41250062
412600 3010-VALIDATE-PRINTER-ID.                                        41260062
412700                                                                  41270062
412800     IF  ASC-CS-PRINTER-ID  =  SPACES                             41280062
412900         SET PS-ERROR                                             41290062
413000             DP020-MSG-FATAL       TO TRUE                        41300062
413100         MOVE PC-TSYMSG-01563      TO DP020-MSG-NUMBER            41310062
413200         MOVE DP015-UNP-ALP-BRT-OFF                               41320062
413300                                   TO APRTIDA                     41330062
413400         MOVE DP015-RED            TO APRTIDC                     41340062
413500         MOVE DP015-REVERSE        TO APRTIDH                     41350062
413600         MOVE -1                   TO APRTIDL                     41360062
413700         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    41370062
413800     ELSE                                                         41380062
413900         PERFORM 3020-VALIDATE-PRINTER                            41390062
414000         IF  DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'              41400062
414100             CONTINUE                                             41410062
414200         ELSE                                                     41420062
414300             SET PS-ERROR                                         41430062
414400                 DP020-MSG-FATAL           TO TRUE                41440062
414500             MOVE PC-TSYMSG-00746          TO DP020-MSG-NUMBER    41450062
414600             MOVE DP015-UNP-ALP-BRT-OFF    TO APRTIDA             41460062
414700             MOVE DP015-RED                TO APRTIDC             41470062
414800             MOVE DP015-REVERSE            TO APRTIDH             41480062
414900             MOVE -1                       TO APRTIDL             41490062
415000             SET DP030-SET-CURSOR-APPL-1   TO TRUE                41500062
415100         END-IF                                                   41510062
415200     END-IF.                                                      41520062
415300                                                                  41530062
415400                                                                  41540062
415500*----------------------------------------------------------------*41550062
415600*   3020-VALIDATE-PRINTER                                        *41560062
415700* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *41570062
415800*----------------------------------------------------------------*41580062
415900 3020-VALIDATE-PRINTER.                                           41590062
416000                                                                  41600062
416100     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     41610062
416200     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 41620062
416300     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        41630062
416400     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     41640062
416500                                        DP072-FCLTY-ID.           41650062
416600     MOVE ASC-CS-PRINTER-ID          TO DP072-PRINTER-ID          41660062
416700     MOVE PC-REPORT-PGM-1            TO DP072-RPT-PGM-NME         41670062
416800     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     41680062
416900     SET DP072-VALIDATE              TO TRUE.                     41690062
417000                                                                  41700062
417100     EXEC CICS                                                    41710062
417200          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  41720062
417300               COMMAREA (DP072-COMM-AREA)                         41730062
417400               RESP     (PV-CICS-RESPONSE)                        41740062
417500     END-EXEC                                                     41750062
417600                                                                  41760062
417700     EVALUATE TRUE                                                41770062
417800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 41780062
417900              CONTINUE                                            41790062
418000         WHEN OTHER                                               41800062
418100             SET PS-ERROR                                         41810062
418200                 DP020-MSG-FATAL       TO TRUE                    41820062
418300             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        41830062
418400             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              41840062
418500                 MOVE DP015-UNP-ALP-BRT-OFF                       41850062
418600                                       TO APRTIDA                 41860062
418700                 MOVE DP015-RED        TO APRTIDC                 41870062
418800                 MOVE DP015-REVERSE    TO APRTIDH                 41880062
418900                 MOVE -1               TO APRTIDL                 41890062
419000             ELSE                                                 41900062
419100                 MOVE DP015-UNP-ALP-BRT-OFF                       41910062
419200                                       TO APRTIDA                 41920062
419300                 MOVE DP015-RED        TO APRTIDC                 41930062
419400                 MOVE DP015-REVERSE    TO APRTIDH                 41940062
419500                 MOVE -1               TO APRTIDL                 41950062
419600             END-IF                                               41960062
419700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  41970062
419800     END-EVALUATE.                                                41980062
419900                                                                  41990062
420000                                                                  42000062
420100*----------------------------------------------------------------*42010062
420200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *42020062
420300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*42030062
420400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *42040062
420500*                                                                *42050062
420600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *42060062
420700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *42070062
420800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *42080062
420900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *42090062
421000*----------------------------------------------------------------*42100062
421100                                                                  42110062
421200 3100-SET-SUBSCRIPTS.                                             42120062
421300                                                                  42130062
421400     COMPUTE ASC-ITEM-SUB =                                       42140062
421500         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        42150062
421600                                                                  42160062
421700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         42170062
421800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            42180062
421900                                                                  42190062
422000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               42200062
422100     ELSE                                                         42210062
422200         MOVE +1                     TO ASC-BLK-SUB               42220062
422300     END-IF.                                                      42230062
422400******************************************************************42240062
422500** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **42250062
422600******************************************************************42260062
422700                                                                  42270062
422800 3200-RESET-ATTRIBUTES.                                           42280062
422900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    42290062
423000                                      APRTIDA.                    42300062
423100     MOVE DP015-GREEN              TO ASTRTITC                    42310062
423200                                      APRTIDC.                    42320062
423300     MOVE DP015-UNDERLINE          TO ASTRTITH                    42330062
423400                                      APRTIDH.                    42340062
423500*                                                                 42350062
423600     PERFORM                                                      42360062
423700         VARYING PV-SUB                                           42370062
423800         FROM 1 BY 1                                              42380062
423900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        42390062
424000         MOVE DP015-UNP-ALP-NOR-OFF                               42400062
424100                                   TO MR-SELECTA (PV-SUB)         42410062
424200         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         42420062
424300         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         42430062
424400         MOVE DP015-HL-OFF         TO MR-PULL-NUMBERH (PV-SUB)    42440062
424500         MOVE DP015-BLUE           TO MR-PULL-NUMBERC (PV-SUB)    42450062
424600         MOVE DP015-BLUE           TO MR-PULL-STATUSC (PV-SUB)    42460062
424700     END-PERFORM.                                                 42470062
424800******************************************************************42480062
424900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **42490062
425000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **42500062
425100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **42510062
425200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **42520062
425300******************************************************************42530062
425400 3300-EDIT-SELECTIONS.                                            42540062
425500     EVALUATE TRUE                                                42550062
425600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     42560062
425700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         42570062
425800                 CONTINUE                                         42580062
425900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         42590062
426000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        42600062
426100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   42610062
426200                 MOVE ASC-TEMP-SELECTED-SW                        42620062
426300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42630062
426400                                TO ASC-SELECTED-SW                42640062
426500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42650062
426600             END-IF                                               42660062
426700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     42670062
426800                 = SPACE                                          42680062
426900             EVALUATE TRUE                                        42690062
427000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       42700062
427100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS42710062
427200                     MOVE SPACE TO ASC-SELECTED-SW                42720062
427300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42730062
427400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        42740062
427500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    42750062
427600                     MOVE SPACE TO ASC-SELECTED-SW                42760062
427700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42770062
427800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          42780062
427900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      42790062
428000                     MOVE SPACE TO ASC-SELECTED-SW                42800062
428100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42810062
428200             END-EVALUATE                                         42820062
428300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           42830062
428400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            42840062
428500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    42850062
428600             END-IF                                               42860062
428700             PERFORM 3310-EDIT-RANGE                              42870062
428800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             42880062
428900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            42890062
429000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    42900062
429100             END-IF                                               42910062
429200             PERFORM 3310-EDIT-RANGE                              42920062
429300         WHEN OTHER                                               42930062
429400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           42940062
429500             SET DP020-MSG-FATAL    TO TRUE                       42950062
429600             MOVE -1                TO MR-SELECTL (PV-SUB)        42960062
429700             SET DP030-SET-CURSOR-APPL-1                          42970062
429800                                    TO TRUE                       42980062
429900             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        42990062
430000             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        43000062
430100             SET PS-ERROR TO TRUE                                 43010062
430200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            43020062
430300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     43030062
430400                 MOVE SPACE         TO ASC-SELECTED-SW            43040062
430500                                        (ASC-BLK-SUB ASC-ITEM-SUB)43050062
430600             END-IF                                               43060062
430700     END-EVALUATE.                                                43070062
430800                                                                  43080062
430900     EVALUATE TRUE                                                43090062
431000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              43100062
431100              EVALUATE TRUE                                       43110062
431200                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      43120062
431300                       PERFORM 3600-UN-CNCL-EDITS                 43130062
431400             END-EVALUATE                                         43140062
431500                                                                  43150062
431600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              43160062
431700              EVALUATE TRUE                                       43170062
431800                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      43180062
431900                       PERFORM 3630-UN-CNFM-DIST-EDITS            43190062
432000              END-EVALUATE                                        43200062
432100                                                                  43210062
432200         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               43220062
432300              EVALUATE TRUE                                       43230062
432400                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      43240062
432500                       PERFORM 3640-PRT-PULL-FIELDS               43250062
432600              END-EVALUATE                                        43260062
432700                                                                  43270062
432800         WHEN DP020-FK-LOCAL-FUNC-08(DP020-SRC-AID)               43280062
432900              EVALUATE TRUE                                       43290062
433000                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      43300062
433100                       PERFORM 3645-RESEND-PULL-EDITS             43310062
433200              END-EVALUATE                                        43320062
433300     END-EVALUATE.                                                43330062
433400                                                                  43340062
433500     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 43350062
433600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               43360062
433700     IF  ASC-ITEM-SUB < 1                                         43370062
433800         SUBTRACT +1 FROM ASC-BLK-SUB                             43380062
433900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                43390062
434000     END-IF.                                                      43400062
434100******************************************************************43410062
434200** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **43420062
434300** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **43430062
434400** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**43440062
434500** THE ENDING.                                                  **43450062
434600******************************************************************43460062
434700 3310-EDIT-RANGE.                                                 43470062
434800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                43480062
434900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   43490062
435000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)43500062
435100                                   TO ASC-SELECTED-SW             43510062
435200                                        (ASC-BLK-SUB ASC-ITEM-SUB)43520062
435300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 43530062
435400         ELSE                                                     43540062
435500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     43550062
435600                 CONTINUE                                         43560062
435700             ELSE                                                 43570062
435800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        43580062
435900                 MOVE PC-TSYMSG-00054                             43590062
436000                                   TO DP020-MSG-NUMBER            43600062
436100                 SET DP020-MSG-FATAL                              43610062
436200                                   TO TRUE                        43620062
436300                 MOVE -1           TO MR-SELECTL (PV-SUB)         43630062
436400                 SET DP030-SET-CURSOR-APPL-1                      43640062
436500                                   TO TRUE                        43650062
436600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         43660062
436700                 MOVE DP015-UNDERLINE                             43670062
436800                                   TO MR-SELECTH (PV-SUB)         43680062
436900                 SET PS-ERROR      TO TRUE                        43690062
437000             END-IF                                               43700062
437100         END-IF                                                   43710062
437200     ELSE                                                         43720062
437300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     43730062
437400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 43740062
437500                                   TO ASC-SELECTED-SW             43750062
437600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   43760062
437700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   43770062
437800         ELSE                                                     43780062
437900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       43790062
438000                 CONTINUE                                         43800062
438100             ELSE                                                 43810062
438200*                -- ONLY ONE END-OF-RANGE ALLOWED --              43820062
438300                 MOVE PC-TSYMSG-00055                             43830062
438400                                   TO DP020-MSG-NUMBER            43840062
438500                 SET DP020-MSG-FATAL                              43850062
438600                                   TO TRUE                        43860062
438700                 MOVE -1           TO MR-SELECTL (PV-SUB)         43870062
438800                 SET DP030-SET-CURSOR-APPL-1                      43880062
438900                                   TO TRUE                        43890062
439000                 SET PS-ERROR      TO TRUE                        43900062
439100             END-IF                                               43910062
439200         END-IF                                                   43920062
439300     END-IF.                                                      43930062
439400                                                                  43940062
439500*-----------------------------------------------------------------43950062
439600* CHECK TO MAKE SURE THAT EACH ACTIVE LINE HAS DISTRIBUTION      -43960062
439700*-----------------------------------------------------------------43970062
439800 3324-CHECK-DISTRO.                                               43980062
439900                                                                  43990062
440000     MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER.                 44000062
440100     MOVE  ZEROES             TO  PV-CEPLDS-COUNT.                44010062
440200                                                                  44020062
440300     EXEC SQL                                                     44030062
440400         SELECT  COUNT(*)                                         44040062
440500           INTO  :PV-CEPLDS-COUNT                                 44050062
440600           FROM  TCEPLDS                                          44060062
440700          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             44070062
440800            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             44080062
440900     END-EXEC.                                                    44090062
441000                                                                  44100062
441100     EVALUATE TRUE                                                44110062
441200         WHEN SQLCODE = ZERO                                      44120062
441300         WHEN SQLCODE = +100                                      44130062
441400              CONTINUE                                            44140062
441500                                                                  44150062
441600         WHEN SQLWARN0 NOT = SPACE                                44160062
441700         WHEN SQLCODE NOT = ZERO                                  44170062
441800              SET PS-ERROR     TO TRUE                            44180062
441900              MOVE '3324-CHECK-DISTRO       '                     44190062
442000                               TO DP013-PARAGRAPH                 44200062
442100              MOVE 'COUNT NUMBER DISTRO ROWS FOR LINE  '          44210062
442200                               TO DP013-MESSAGE-TEXT (1)          44220062
442300              MOVE SQLCA       TO DP013-SQLCA                     44230062
442400              MOVE 'TCEPLDS'   TO DP013-DB2-TABLE-NAME (1)        44240062
442500              SET DP013-DB2-ABEND                                 44250062
442600                               TO TRUE                            44260062
442700              PERFORM DP013-0000-PROCESS-ABEND                    44270062
442800     END-EVALUATE.                                                44280062
442900                                                                  44290062
443000     IF  PS-NO-ERROR                                              44300062
443100         IF  PV-CEPLDS-COUNT  >  0                                44310062
443200             CONTINUE                                             44320062
443300         ELSE                                                     44330062
443400             SET  PS-ERROR                                        44340062
443500                  DP020-MSG-FATAL TO TRUE                         44350062
443600             MOVE PC-TSYMSG-02288 TO DP020-MSG-NUMBER             44360062
443700             MOVE -1              TO MR-SELECTL (PV-SUB)          44370062
443800             MOVE DP015-REVERSE   TO MR-PULL-NUMBERH (PV-SUB)     44380062
443900             MOVE DP015-RED       TO MR-PULL-NUMBERC (PV-SUB)     44390062
444000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  44400062
444100             SET PS-BLOCK-ERROR   TO TRUE                         44410062
444200        END-IF                                                    44420062
444300     END-IF.                                                      44430062
444400                                                                  44440062
444500                                                                  44450062
444600*-----------------------------------------------------------------44460062
444700* COUNT THE NUMBER OF ACTIVE LINES FOR PULL                      -44470062
444800*-----------------------------------------------------------------44480062
444900 3326-COUNT-NBR-LINES.                                            44490062
445000                                                                  44500062
445100     MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER.                 44510062
445200     MOVE  ZEROES             TO  PV-CEPLIT-COUNT.                44520062
445300                                                                  44530062
445400     EXEC SQL                                                     44540062
445500         SELECT  COUNT(*)                                         44550062
445600           INTO  :PV-CEPLIT-COUNT                                 44560062
445700           FROM  TCEPLIT                                          44570062
445800          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             44580062
445900            AND  STAT_CDE         IN ('IP','NW')                  44590062
446000     END-EXEC.                                                    44600062
446100                                                                  44610062
446200     EVALUATE TRUE                                                44620062
446300         WHEN SQLCODE = ZERO                                      44630062
446400              IF  PV-CEPLIT-COUNT  >  1                           44640062
446500                  MOVE PC-TSYMSG-02322  TO DP020-MSG-NUMBER       44650062
446600              END-IF                                              44660062
446700         WHEN SQLCODE = +100                                      44670062
446800              CONTINUE                                            44680062
446900                                                                  44690062
447000         WHEN SQLWARN0 NOT = SPACE                                44700062
447100         WHEN SQLCODE NOT = ZERO                                  44710062
447200              SET PS-ERROR     TO TRUE                            44720062
447300              MOVE '3326-COUNT-NBR-LINES    '                     44730062
447400                               TO DP013-PARAGRAPH                 44740062
447500              MOVE 'COUNT NUMBER LINES FOR PULL        '          44750062
447600                               TO DP013-MESSAGE-TEXT (1)          44760062
447700              MOVE SQLCA       TO DP013-SQLCA                     44770062
447800              MOVE 'TCEPLIT'   TO DP013-DB2-TABLE-NAME (1)        44780062
447900              SET DP013-DB2-ABEND                                 44790062
448000                               TO TRUE                            44800062
448100              PERFORM DP013-0000-PROCESS-ABEND                    44810062
448200     END-EVALUATE.                                                44820062
448300                                                                  44830062
448400*-----------------------------------------------------------------44840062
448500* MAKE SURE THIS CENTRAL STOCK LOCATION IS A VALID RDM LOCATION  -44850062
448600* PRIOR TO XCNTLING TO THE PGM THAT WILL UPDATE TCEPLIT.         -44860062
448700*-----------------------------------------------------------------44870062
448800 3390-VALIDATE-RDM-FACILITY.                                      44880062
448900                                                                  44890062
449000     SET PS-VALID-RDM-FACILITY-NO      TO TRUE.                   44900062
449100                                                                  44910062
449200     EXEC SQL                                                     44920062
449300          SELECT LOC_ID                                           44930062
449400          INTO :KRPRPM-LOC-ID                                     44940062
449500          FROM TKRPRPM B                                          44950062
449600          WHERE B.LOC_ID        = :PV-DC-NBR-SIGNED               44960062
449700            AND B.INTFC_SYS_CDE = 'RDM'                           44970062
449800            AND B.SYS_PRC_FUNC_CDE  = 'RDMFAC'                    44980062
449900            AND B.FUNC_PRC_STAT_CDE = 'AC'                        44990062
450000            AND B.FUNC_TXT = 'Y'                                  45000062
450100            AND (CURRENT DATE                                     45010062
450200        BETWEEN DATE(B.FUNC_BEG_TMST) AND                         45020062
450300                DATE(B.FUNC_END_TMST) )                           45030062
450400     END-EXEC.                                                    45040062
450500                                                                  45050062
450600     EVALUATE TRUE                                                45060062
450700         WHEN SQLCODE = +0                                        45070062
450800              SET PS-VALID-RDM-FACILITY     TO TRUE               45080062
450900         WHEN OTHER                                               45090062
451000              SET PS-VALID-RDM-FACILITY-NO  TO TRUE               45100062
451100     END-EVALUATE.                                                45110062
451200*                                                                 45120062
451300*-----------------------------------------------------------------45130062
451400* CHECK CENTRAL STOCK PULL LOCATION                               45140062
451500*-----------------------------------------------------------------45150062
451600                                                                  45160062
451700 3391-CHECK-CE-PULL-LOC.                                          45170062
451800                                                                  45180062
451900     SET PS-VALID-RDM-FACILITY-NO TO TRUE.                        45190062
452000                                                                  45200062
452010     EXEC SQL                                                     45201062
452020          SELECT B.LOC_ID                                         45202062
452030          INTO :KRPRPM-LOC-ID                                     45203062
452040          FROM TCEPLRQ A,                                         45204062
452050               TKRPRPM B                                          45205062
452060          WHERE A.CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER              45206062
452070            AND A.CNSTK_LOC_ID = B.LOC_ID                         45207062
452080            AND B.INTFC_SYS_CDE = 'KHL'                           45208062
452090            AND B.SYS_PRC_FUNC_CDE = 'PTFAC'                      45209062
452091            AND B.FUNC_PRC_STAT_CDE = 'AC'                        45209162
452092            AND B.FUNC_TXT = 'Y'                                  45209262
452093            AND (CURRENT DATE                                     45209362
452094        BETWEEN DATE(B.FUNC_BEG_TMST) AND                         45209462
452095                DATE(B.FUNC_END_TMST))                            45209562
452096     END-EXEC.                                                    45209662
452097                                                                  45209762
452098     EVALUATE TRUE                                                45209862
452099         WHEN SQLCODE = +0                                        45209962
452100              SET PS-VALID-RDM-FACILITY     TO TRUE               45210062
452101         WHEN OTHER                                               45210162
452102              SET PS-VALID-RDM-FACILITY-NO  TO TRUE               45210262
452103     END-EVALUATE.                                                45210362
452104******************************************************************45210462
452105** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **45210562
452106** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **45210662
452107******************************************************************45210762
452108 3400-CHECK-RANGE-SEQUENCE.                                       45210862
452109     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       45210962
452110       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      45211062
452120       AND  ASC-START-OF-SELECTED-RANGE >                         45212062
452130                                         ASC-END-OF-SELECTED-RANGE45213062
452140*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                45214062
452150         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 45215062
452160         SET DP020-MSG-FATAL TO TRUE                              45216062
452170         SET PS-ERROR TO TRUE                                     45217062
452180         PERFORM 3410-POSITION-AT-ERROR                           45218062
452190     END-IF.                                                      45219062
452200******************************************************************45220062
452300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **45230062
452400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **45240062
452500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **45250062
452600******************************************************************45260062
452700 3410-POSITION-AT-ERROR.                                          45270062
452800     SET DP030-SET-CURSOR-APPL-1                                  45280062
452900                                   TO TRUE.                       45290062
453000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 45300062
453100                    - PV-TOP-ITEM + 1.                            45310062
453200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      45320062
453300         CONTINUE                                                 45330062
453400     ELSE                                                         45340062
453500         MOVE -1                   TO MR-SELECTL (PV-SUB)         45350062
453600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         45360062
453700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         45370062
453800     END-IF.                                                      45380062
453900*                                                                 45390062
454000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   45400062
454100                    - PV-TOP-ITEM + 1.                            45410062
454200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      45420062
454300         CONTINUE                                                 45430062
454400     ELSE                                                         45440062
454500         MOVE -1                   TO MR-SELECTL (PV-SUB)         45450062
454600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         45460062
454700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         45470062
454800     END-IF.                                                      45480062
454900 EJECT                                                            45490062
455000*----------------------------------------------------------------*45500062
455100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *45510062
455200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *45520062
455300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *45530062
455400*----------------------------------------------------------------*45540062
455500                                                                  45550062
455600 3500-MARK-RANGE-AS-SELECTED.                                     45560062
455700     MOVE +1                       TO  ASC-BLK-SUB.               45570062
455800     PERFORM 3510-MARK-SELECTED-INDS                              45580062
455900         VARYING ASC-ITEM-SUB                                     45590062
456000         FROM 1 BY 1                                              45600062
456100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 45610062
456200                                                                  45620062
456300     ADD +1                        TO ASC-BLK-SUB.                45630062
456400     PERFORM 3510-MARK-SELECTED-INDS                              45640062
456500         VARYING ASC-ITEM-SUB                                     45650062
456600         FROM 1 BY 1                                              45660062
456700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 45670062
456800                                                                  45680062
456900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               45690062
457000                                   TO  PV-LIST-ITEM-NUMBER.       45700062
457100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            45710062
457200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         45720062
457300               PC-ITEMS-PER-PANEL).                               45730062
457400                                                                  45740062
457500     MOVE ASC-START-OF-SELECTED-RANGE                             45750062
457600                                   TO PV-START-OF-SELECTED-RANGE. 45760062
457700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            45770062
457800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  45780062
457900               PC-ITEMS-PER-PANEL).                               45790062
458000                                                                  45800062
458100     MOVE ASC-END-OF-SELECTED-RANGE                               45810062
458200                                   TO  PV-END-OF-SELECTED-RANGE.  45820062
458300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             45830062
458400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    45840062
458500               PC-ITEMS-PER-PANEL).                               45850062
458600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             45860062
458700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             45870062
458800                                                                  45880062
458900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    45890062
459000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        45900062
459100         MOVE +1                   TO ASC-BLK-SUB                 45910062
459200         PERFORM 5100-WRITE-TEMP-STORAGE                          45920062
459300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         45930062
459400             PV-FIRST-BLOCK-IN-ARRAY - 1                          45940062
459500                                                                  45950062
459600         PERFORM                                                  45960062
459700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      45970062
459800                   PV-PREV-BLOCK-IN-ARRAY                         45980062
459900             MOVE PV-FIRST-BLOCK-IN-RANGE                         45990062
460000                                   TO PV-BLOCK-NUMBER             46000062
460100             PERFORM 4410-READ-TEMP-STORAGE                       46010062
460200             PERFORM 3510-MARK-SELECTED-INDS                      46020062
460300                 VARYING ASC-ITEM-SUB                             46030062
460400                 FROM 1 BY 1                                      46040062
460500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          46050062
460600             PERFORM 5100-WRITE-TEMP-STORAGE                      46060062
460700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     46070062
460800         END-PERFORM                                              46080062
460900                                                                  46090062
461000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         46100062
461100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     46110062
461200         PERFORM                                                  46120062
461300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       46130062
461400                   PV-LAST-BLOCK-IN-RANGE                         46140062
461500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          46150062
461600                                   TO PV-BLOCK-NUMBER             46160062
461700             PERFORM 4410-READ-TEMP-STORAGE                       46170062
461800             PERFORM 3510-MARK-SELECTED-INDS                      46180062
461900                 VARYING ASC-ITEM-SUB                             46190062
462000                 FROM 1 BY 1                                      46200062
462100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          46210062
462200             PERFORM 5100-WRITE-TEMP-STORAGE                      46220062
462300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      46230062
462400         END-PERFORM                                              46240062
462500                                                                  46250062
462600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             46260062
462700                                   TO PV-BLOCK-NUMBER             46270062
462800         PERFORM 4410-READ-TEMP-STORAGE                           46280062
462900     END-IF.                                                      46290062
463000                                                                  46300062
463100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 46310062
463200                                      ASC-END-OF-SELECTED-RANGE.  46320062
463300                                                                  46330062
463400 EJECT                                                            46340062
463500*----------------------------------------------------------------*46350062
463600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *46360062
463700*----------------------------------------------------------------*46370062
463800                                                                  46380062
463900 3510-MARK-SELECTED-INDS.                                         46390062
464000                                                                  46400062
464100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         46410062
464200                                ASC-ITEM-SUB) >                   46420062
464300         ASC-START-OF-SELECTED-RANGE)                             46430062
464400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         46440062
464500                                ASC-ITEM-SUB) =                   46450062
464600         ASC-START-OF-SELECTED-RANGE)                             46460062
464700                                                                  46470062
464800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     46480062
464900                                    ASC-ITEM-SUB) <               46490062
465000             ASC-END-OF-SELECTED-RANGE)                           46500062
465100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     46510062
465200                                    ASC-ITEM-SUB) =               46520062
465300             ASC-END-OF-SELECTED-RANGE)                           46530062
465400                                                                  46540062
465500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          46550062
465600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   46560062
465700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   46570062
465800                               TO TRUE                            46580062
465900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              46590062
466000                               TO TRUE                            46600062
466100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    46610062
466200             END-IF                                               46620062
466300         END-IF                                                   46630062
466400     END-IF.                                                      46640062
466500                                                                  46650062
466600                                                                  46660062
466700*----------------------------------------------------------------*46670062
466800* CANCEL/UNCANCEL EDITS                                          *46680062
466900*----------------------------------------------------------------*46690062
467000 3600-UN-CNCL-EDITS.                                              46700062
467100                                                                  46710062
467200*-----------------------------------------------------------------46720062
467300* VERIFY RACF AUTHORITY FOR "UNCANCEL/CANCEL"                     46730062
467400*  F14 - LOCAL-01 (CHECK WHEN DOWNLOADED TO RDM) 12/17/01 BUD     46740062
467500*-----------------------------------------------------------------46750062
467600     MOVE  ASC-PULL-NUMBER     (ASC-BLK-SUB ASC-ITEM-SUB)         46760062
467700                               TO DK-PULL-NUMBER.                 46770062
467800                                                                  46780062
467900         EXEC SQL                                                 46790062
468000             SELECT  CNSTK_REQ_PL_NBR                             46800062
468100               INTO :CEPLIT-CNSTK-REQ-PL-NBR                      46810062
468200               FROM  TCEPLIT                                      46820062
468300              WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER         46830062
468400                AND  DWNLD_RDM_STAT_CDE IN ('X','R')              46840062
468500         END-EXEC.                                                46850062
468600                                                                  46860062
468700         EVALUATE TRUE                                            46870062
468800             WHEN SQLCODE = ZERO                                  46880062
468900             WHEN SQLCODE = -811                                  46890062
469000                                                                  46900062
469100             MOVE 'CECSCNCL' TO DP008-FUNCTION-NAME               46910062
469200             PERFORM 2105-RACF-ACCESS                             46920062
469300             IF  PS-ACCESS-NOT-ALLOWED                            46930062
469400                 SET  PS-ERROR                                    46940062
469500                   DP020-MSG-FATAL TO TRUE                        46950062
469600                 MOVE PC-TSYMSG-02880 TO DP020-MSG-NUMBER         46960062
469700                 MOVE -1              TO MR-SELECTL (1)           46970062
469800                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             46980062
469900             END-IF                                               46990062
470000                                                                  47000062
470100             WHEN OTHER                                           47010062
470200                 CONTINUE                                         47020062
470300         END-EVALUATE.                                            47030062
470400                                                                  47040062
470500     MOVE  ASC-PULL-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)         47050062
470600       TO  PV-PULL-STATUS.                                        47060062
470700                                                                  47070062
470800     EVALUATE  TRUE                                               47080062
470900         WHEN  PV-PULL-STATUS-DISTRIBTD                           47090062
471000         WHEN  PV-PULL-STATUS-POSTED                              47100062
471100               SET PS-ERROR                                       47110062
471200                   DP020-MSG-FATAL   TO TRUE                      47120062
471300               MOVE PC-TSYMSG-02267  TO DP020-MSG-NUMBER          47130062
471400               MOVE -1               TO MR-PULL-NUMBERL (PV-SUB)  47140062
471500               SET DP030-SET-CURSOR-APPL-1 TO TRUE                47150062
471600               MOVE DP015-RED        TO MR-PULL-NUMBERC (PV-SUB)  47160062
471700               MOVE DP015-REVERSE    TO MR-PULL-NUMBERH (PV-SUB)  47170062
471800               SET PS-BLOCK-ERROR    TO TRUE                      47180062
471900     END-EVALUATE.                                                47190062
472000                                                                  47200062
472100     IF  PS-NO-ERROR                                              47210062
472200         PERFORM 3610-COUNT-LINES-DIST                            47220062
472300     END-IF.                                                      47230062
472400                                                                  47240062
472500     IF  PS-NO-ERROR                                              47250062
472600         PERFORM 3615-CHECK-RDM-TCEPLMF                           47260062
472700     END-IF.                                                      47270062
472800                                                                  47280062
472900     IF  PS-NO-ERROR                                              47290062
473000         PERFORM 3617-CHECK-RDM-TCEPLAU                           47300062
473100     END-IF.                                                      47310062
473200                                                                  47320062
473300     IF  PS-NO-ERROR                                              47330062
473400         IF  PV-PULL-STATUS-CANCELLED                             47340062
473500             PERFORM 3700-GET-STORE-INFORMATION                   47350062
473600                                                                  47360062
473700             IF XL071-E-BUS-IND   = 'Y' AND                       47370062
473800                XL071-LOC-TYP-CDE = 'DS'                          47380062
473900                 SET DP030-OVERRIDE-GO TO TRUE                    47390062
474000                 MOVE PC-TSYMSG-02879                             47400062
474100                                  TO DP020-MSG-NUMBER             47410062
474200                 SET DP020-MSG-WARNING  TO TRUE                   47420062
474300                 SET ASC-CONFIRM-TYPE-NONE TO TRUE                47430062
474400                 SET PS-ERROR              TO TRUE                47440062
474500             ELSE                                                 47450062
474600                 SET  ASC-CONFIRM-UNCNCL-PULL                     47460062
474700                      PS-ERROR                                    47470062
474800                      DP020-MSG-WARNING                           47480062
474900                      PS-CONFIRM-PROCESSING  TO TRUE              47490062
475000                 MOVE PC-TSYMSG-02255        TO DP020-MSG-NUMBER  47500062
475100                 MOVE -1                     TO MR-SELECTL (1)    47510062
475200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              47520062
475300                 ADD  1  TO PV-SEL-UNCNCL-CNT                     47530062
475400             END-IF                                               47540062
475500         ELSE                                                     47550062
475600             SET  ASC-CONFIRM-CNCL-PULL                           47560062
475700                  PS-ERROR                                        47570062
475800                  DP020-MSG-WARNING                               47580062
475900                  PS-CONFIRM-PROCESSING  TO TRUE                  47590062
476000             MOVE PC-TSYMSG-02254        TO DP020-MSG-NUMBER      47600062
476100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  47610062
476200             ADD  1  TO PV-SEL-CNCL-CNT                           47620062
476300         END-IF                                                   47630062
476400     END-IF.                                                      47640062
476500                                                                  47650062
476600                                                                  47660062
476700*-----------------------------------------------------------------47670062
476800* COUNT THE NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT HAVE     47680062
476900* ALREADY BEEN POSTED OR DISTRIBUTED.                             47690062
477000*-----------------------------------------------------------------47700062
477100 3610-COUNT-LINES-DIST.                                           47710062
477200                                                                  47720062
477300     INITIALIZE  PV-LINES-POSTED-DISTRB.                          47730062
477400     MOVE  ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             47740062
477500       TO  DK-PULL-NUMBER.                                        47750062
477600                                                                  47760062
477700     EXEC SQL                                                     47770062
477800          SELECT COUNT(*)                                         47780062
477900            INTO :PV-LINES-POSTED-DISTRB                          47790062
478000            FROM TCEPLIT                                          47800062
478100           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             47810062
478200             AND STAT_CDE         IN  ('DS', 'PD')                47820062
478300     END-EXEC.                                                    47830062
478400                                                                  47840062
478500     EVALUATE TRUE                                                47850062
478600         WHEN SQLCODE = +0                                        47860062
478700              IF  PV-LINES-POSTED-DISTRB  >  0                    47870062
478800                  SET  PS-ERROR                                   47880062
478900                       DP020-MSG-FATAL        TO TRUE             47890062
479000                  MOVE PC-TSYMSG-02268        TO DP020-MSG-NUMBER 47900062
479100                  MOVE DP015-RED      TO MR-PULL-NUMBERC (PV-SUB) 47910062
479200                  MOVE DP015-REVERSE  TO MR-PULL-NUMBERH (PV-SUB) 47920062
479300                  MOVE -1             TO MR-SELECTL (PV-SUB)      47930062
479400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             47940062
479500                  SET PS-BLOCK-ERROR  TO TRUE                     47950062
479600              END-IF                                              47960062
479700                                                                  47970062
479800         WHEN SQLCODE = +100                                      47980062
479900              SET  PS-ERROR                                       47990062
480000                   DP020-MSG-FATAL            TO TRUE             48000062
480100              MOVE PC-TSYMSG-02214            TO DP020-MSG-NUMBER 48010062
480200              MOVE DP015-RED          TO MR-PULL-NUMBERC (PV-SUB) 48020062
480300              MOVE DP015-REVERSE      TO MR-PULL-NUMBERH (PV-SUB) 48030062
480400              MOVE -1                 TO MR-SELECTL (PV-SUB)      48040062
480500              SET  DP030-SET-CURSOR-APPL-1    TO TRUE             48050062
480600              SET PS-BLOCK-ERROR  TO TRUE                         48060062
480700                                                                  48070062
480800         WHEN OTHER                                               48080062
480900              MOVE '4000-COUNT-LINES-DIST'    TO DP013-PARAGRAPH  48090062
481000              MOVE 'COUNT NBR LINES POSTED/DISTRBUTD'             48100062
481100                                       TO DP013-MESSAGE-TEXT (1)  48110062
481200              STRING ' PULL NBR-'    DELIMITED BY SIZE            48120062
481300                      ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  48130062
481400                                     DELIMITED BY SIZE            48140062
481500                                     INTO DP013-MESSAGE-TEXT (2)  48150062
481600              MOVE SQLCA                      TO DP013-SQLCA      48160062
481700              MOVE 'TCEPLIT '        TO DP013-DB2-TABLE-NAME (1)  48170062
481800              SET  DP013-DB2-ABEND                                48180062
481900                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            48190062
482000              PERFORM DP013-0000-PROCESS-ABEND                    48200062
482100     END-EVALUATE.                                                48210062
482200                                                                  48220062
482300                                                                  48230062
482400*-----------------------------------------------------------------48240062
482500* COUNT NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT ARE BEING    48250062
482600* WORKED IN RDM                                                   48260062
482700*-----------------------------------------------------------------48270062
482800 3615-CHECK-RDM-TCEPLMF.                                          48280062
482900                                                                  48290062
483000     INITIALIZE  PV-TCEPLMF-COUNT.                                48300062
483100     MOVE  ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             48310062
483200       TO  DK-PULL-NUMBER.                                        48320062
483300                                                                  48330062
483400     EXEC SQL                                                     48340062
483500          SELECT COUNT(*)                                         48350062
483600            INTO :PV-TCEPLMF-COUNT                                48360062
483700            FROM TCEPLMF                                          48370062
483800           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             48380062
483900     END-EXEC.                                                    48390062
484000                                                                  48400062
484100     EVALUATE TRUE                                                48410062
484200         WHEN SQLCODE = +0                                        48420062
484300              IF  PV-TCEPLMF-COUNT  >  0                          48430062
484400                  SET  PS-ERROR                                   48440062
484500                       DP020-MSG-FATAL        TO TRUE             48450062
484600                  MOVE PC-TSYMSG-02268        TO DP020-MSG-NUMBER 48460062
484700                  MOVE DP015-RED      TO MR-PULL-NUMBERC (PV-SUB) 48470062
484800                  MOVE DP015-REVERSE  TO MR-PULL-NUMBERH (PV-SUB) 48480062
484900                  MOVE -1             TO MR-SELECTL (PV-SUB)      48490062
485000                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             48500062
485100                  SET PS-BLOCK-ERROR  TO TRUE                     48510062
485200              END-IF                                              48520062
485300                                                                  48530062
485400         WHEN SQLCODE = +100                                      48540062
485500              CONTINUE                                            48550062
485600                                                                  48560062
485700         WHEN OTHER                                               48570062
485800              MOVE '3615-CHECK-RDM-TCEPLMF'   TO DP013-PARAGRAPH  48580062
485900              MOVE 'COUNT NBR LINES WORKED BY RDM   '             48590062
486000                                       TO DP013-MESSAGE-TEXT (1)  48600062
486100              STRING ' PULL NBR-'    DELIMITED BY SIZE            48610062
486200                      ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  48620062
486300                                     DELIMITED BY SIZE            48630062
486400                                     INTO DP013-MESSAGE-TEXT (2)  48640062
486500              MOVE SQLCA                      TO DP013-SQLCA      48650062
486600              MOVE 'TCEPLMF '        TO DP013-DB2-TABLE-NAME (1)  48660062
486700              SET  DP013-DB2-ABEND                                48670062
486800                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            48680062
486900              PERFORM DP013-0000-PROCESS-ABEND                    48690062
487000     END-EVALUATE.                                                48700062
487100                                                                  48710062
487200                                                                  48720062
487300*-----------------------------------------------------------------48730062
487400* COUNT NUMBER OF LINES FOR A GIVEN PULL NUMBER THAT ARE BEING    48740062
487500* WORKED IN RDM                                                   48750062
487600*-----------------------------------------------------------------48760062
487700 3617-CHECK-RDM-TCEPLAU.                                          48770062
487800                                                                  48780062
487900     INITIALIZE  PV-TCEPLAU-COUNT.                                48790062
488000     MOVE  ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             48800062
488100       TO  DK-PULL-NUMBER.                                        48810062
488200                                                                  48820062
488300     EXEC SQL                                                     48830062
488400          SELECT COUNT(*)                                         48840062
488500            INTO :PV-TCEPLAU-COUNT                                48850062
488600            FROM TCEPLMF                                          48860062
488700           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             48870062
488800     END-EXEC.                                                    48880062
488900                                                                  48890062
489000     EVALUATE TRUE                                                48900062
489100         WHEN SQLCODE = +0                                        48910062
489200              IF  PV-TCEPLAU-COUNT  >  0                          48920062
489300                  SET  PS-ERROR                                   48930062
489400                       DP020-MSG-FATAL        TO TRUE             48940062
489500                  MOVE PC-TSYMSG-02268        TO DP020-MSG-NUMBER 48950062
489600                  MOVE DP015-RED      TO MR-PULL-NUMBERC (PV-SUB) 48960062
489700                  MOVE DP015-REVERSE  TO MR-PULL-NUMBERH (PV-SUB) 48970062
489800                  MOVE -1             TO MR-SELECTL (PV-SUB)      48980062
489900                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             48990062
490000                  SET PS-BLOCK-ERROR  TO TRUE                     49000062
490100              END-IF                                              49010062
490200                                                                  49020062
490300         WHEN SQLCODE = +100                                      49030062
490400              CONTINUE                                            49040062
490500                                                                  49050062
490600         WHEN OTHER                                               49060062
490700              MOVE '3617-CHECK-RDM-TCEPLAU'   TO DP013-PARAGRAPH  49070062
490800              MOVE 'COUNT NBR LINES WORKED BY RDM   '             49080062
490900                                       TO DP013-MESSAGE-TEXT (1)  49090062
491000              STRING ' PULL NBR-'    DELIMITED BY SIZE            49100062
491100                      ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  49110062
491200                                     DELIMITED BY SIZE            49120062
491300                                     INTO DP013-MESSAGE-TEXT (2)  49130062
491400              MOVE SQLCA                      TO DP013-SQLCA      49140062
491500              MOVE 'TCEPLAU '        TO DP013-DB2-TABLE-NAME (1)  49150062
491600              SET  DP013-DB2-ABEND                                49160062
491700                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            49170062
491800              PERFORM DP013-0000-PROCESS-ABEND                    49180062
491900     END-EVALUATE.                                                49190062
492000                                                                  49200062
492100                                                                  49210062
492200*-----------------------------------------------------------------49220062
492300* COUNT NUMBER OF LINES WITH STATUS "NEW"                         49230062
492400*-----------------------------------------------------------------49240062
492500 3621-COUNT-NEW-LINES.                                            49250062
492600                                                                  49260062
492700     MOVE  ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             49270062
492800       TO  DK-PULL-NUMBER.                                        49280062
492900     MOVE  ZEROES             TO  PV-LINES-NEW.                   49290062
493000                                                                  49300062
493100     EXEC SQL                                                     49310062
493200         SELECT  COUNT(*)                                         49320062
493300           INTO  :PV-LINES-NEW                                    49330062
493400           FROM  TCEPLIT                                          49340062
493500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             49350062
493600            AND  STAT_CDE          =  'NW'                        49360062
493700     END-EXEC.                                                    49370062
493800                                                                  49380062
493900     EVALUATE TRUE                                                49390062
494000         WHEN SQLCODE = ZERO                                      49400062
494100              CONTINUE                                            49410062
494200                                                                  49420062
494300         WHEN SQLWARN0 NOT = SPACE                                49430062
494400         WHEN SQLCODE NOT = ZERO                                  49440062
494500              SET PS-ERROR     TO TRUE                            49450062
494600              MOVE '3621-COUNT-NEW-LINES    '                     49460062
494700                               TO DP013-PARAGRAPH                 49470062
494800              MOVE 'COUNT NUMBER NEW LINES             '          49480062
494900                               TO DP013-MESSAGE-TEXT (1)          49490062
495000              MOVE SQLCA       TO DP013-SQLCA                     49500062
495100              MOVE 'TCEPLIT'   TO DP013-DB2-TABLE-NAME (1)        49510062
495200              SET DP013-DB2-ABEND                                 49520062
495300                               TO TRUE                            49530062
495400              PERFORM DP013-0000-PROCESS-ABEND                    49540062
495500     END-EVALUATE.                                                49550062
495600                                                                  49560062
495700     IF  PS-NO-ERROR                                              49570062
495800         IF  PV-LINES-NEW  >  0                                   49580062
495900             SET  PS-ERROR                                        49590062
496000                  DP020-MSG-FATAL TO TRUE                         49600062
496100             MOVE PC-TSYMSG-02354 TO DP020-MSG-NUMBER             49610062
496200             MOVE -1              TO MR-SELECTL (PV-SUB)          49620062
496300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  49630062
496400             SET PS-BLOCK-ERROR   TO TRUE                         49640062
496500        END-IF                                                    49650062
496600     END-IF.                                                      49660062
496700                                                                  49670062
496800                                                                  49680062
496900*-----------------------------------------------------------------49690062
497000* CHECK TO MAKE SURE THAT PULL HAS LINE ITEMS ENTERED AND EACH   *49700062
497100* LINE HAS DISTRIBUTION                                          *49710062
497200*-----------------------------------------------------------------49720062
497300 3622-CHECK-ALL-LINES.                                            49730062
497400                                                                  49740062
497500     MOVE  ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             49750062
497600       TO  DK-PULL-NUMBER.                                        49760062
497700                                                                  49770062
497800     IF  PS-NO-ERROR                                              49780062
497900         PERFORM 7050-OPEN-CNFM-LNE-CSR                           49790062
498000     END-IF.                                                      49800062
498100                                                                  49810062
498200     IF  PS-NO-ERROR                                              49820062
498300         PERFORM 7055-FETCH-CNFM-LNE-CSR                          49830062
498400     END-IF.                                                      49840062
498500                                                                  49850062
498600     IF  PS-EOF-CNFM-LNE-CSR                                      49860062
498700         SET  PS-ERROR                                            49870062
498800              DP020-MSG-FATAL TO TRUE                             49880062
498900         MOVE PC-TSYMSG-02287 TO DP020-MSG-NUMBER                 49890062
499000         MOVE -1              TO MR-SELECTL (PV-SUB)              49900062
499100         MOVE DP015-REVERSE   TO MR-PULL-NUMBERH (PV-SUB)         49910062
499200         MOVE DP015-RED       TO MR-PULL-NUMBERC (PV-SUB)         49920062
499300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      49930062
499400         SET PS-BLOCK-ERROR   TO TRUE                             49940062
499500     END-IF.                                                      49950062
499600                                                                  49960062
499700     IF  PS-NO-ERROR                                              49970062
499800         PERFORM                                                  49980062
499900           UNTIL PS-ERROR                                         49990062
500000              OR PS-EOF-CNFM-LNE-CSR                              50000062
500100                 PERFORM 3324-CHECK-DISTRO                        50010062
500200                 IF  PS-NO-ERROR                                  50020062
500300                     PERFORM 7055-FETCH-CNFM-LNE-CSR              50030062
500400                 END-IF                                           50040062
500500         END-PERFORM                                              50050062
500600     END-IF.                                                      50060062
500700                                                                  50070062
500800     IF  PS-NO-ERROR                                              50080062
500900         PERFORM 7060-CLOSE-CNFM-LNE-CSR                          50090062
501000     END-IF.                                                      50100062
501100                                                                  50110062
501200     IF  PS-NO-ERROR                                              50120062
501300         PERFORM 3326-COUNT-NBR-LINES                             50130062
501400     END-IF.                                                      50140062
501500                                                                  50150062
501600                                                                  50160062
501700                                                                  50170062
501800*----------------------------------------------------------------*50180062
501900* CONFIRM/UNCONFIRM DISTRIBUTION EDITS                           *50190062
502000* F24 - LOCAL-04                                                 *50200062
502100*----------------------------------------------------------------*50210062
502200 3630-UN-CNFM-DIST-EDITS.                                         50220062
502300                                                                  50230062
502400     PERFORM 3635-CHECK-FOR-RDM.                                  50240062
502500                                                                  50250062
502600     MOVE  ASC-PULL-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)         50260062
502700       TO  PV-PULL-STATUS.                                        50270062
502800                                                                  50280062
502900     IF  PS-NO-ERROR                                              50290062
503000         EVALUATE TRUE                                            50300062
503100             WHEN PV-PULL-STATUS-NEW                              50310062
503200                  SET  PS-ERROR                                   50320062
503300                       DP020-MSG-FATAL TO TRUE                    50330062
503400                  MOVE PC-TSYMSG-02317 TO DP020-MSG-NUMBER        50340062
503500                  MOVE -1              TO MR-SELECTL (PV-SUB)     50350062
503600                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             50360062
503700                  SET PS-BLOCK-ERROR   TO TRUE                    50370062
503800                                                                  50380062
503900             WHEN PV-PULL-STATUS-POSTED                           50390062
504000                  SET  PS-ERROR                                   50400062
504100                       DP020-MSG-FATAL TO TRUE                    50410062
504200                  MOVE PC-TSYMSG-02224 TO DP020-MSG-NUMBER        50420062
504300                  MOVE -1              TO MR-SELECTL (PV-SUB)     50430062
504400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             50440062
504500                  SET PS-BLOCK-ERROR   TO TRUE                    50450062
504600                                                                  50460062
504700             WHEN PV-PULL-STATUS-CANCELLED                        50470062
504800                  SET  PS-ERROR                                   50480062
504900                       DP020-MSG-FATAL TO TRUE                    50490062
505000                  MOVE PC-TSYMSG-02225 TO DP020-MSG-NUMBER        50500062
505100                  MOVE -1              TO MR-SELECTL (PV-SUB)     50510062
505200                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             50520062
505300                  SET PS-BLOCK-ERROR   TO TRUE                    50530062
505400                                                                  50540062
505500         END-EVALUATE                                             50550062
505600     END-IF.                                                      50560062
505700                                                                  50570062
505800     IF  PS-NO-ERROR                                              50580062
505900         EVALUATE TRUE                                            50590062
506000             WHEN PV-PULL-STATUS-DISTRIBTD                        50600062
506100                  SET  ASC-CONFIRM-UNCONF-DIST                    50610062
506200                       PS-ERROR                                   50620062
506300                       DP020-MSG-WARNING                          50630062
506400                       PS-CONFIRM-PROCESSING  TO TRUE             50640062
506500                       MOVE PC-TSYMSG-02259   TO DP020-MSG-NUMBER 50650062
506600                       MOVE -1             TO MR-SELECTL (PV-SUB) 50660062
506700                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             50670062
506800                                                                  50680062
506900             WHEN OTHER                                           50690062
507000                  INITIALIZE PV-LINES-NEW                         50700062
507100                  IF  PS-NO-ERROR                                 50710062
507200                      PERFORM 3621-COUNT-NEW-LINES                50720062
507300                  END-IF                                          50730062
507400                                                                  50740062
507500                  IF  PS-NO-ERROR                                 50750062
507600                      PERFORM 3622-CHECK-ALL-LINES                50760062
507700                  END-IF                                          50770062
507800                                                                  50780062
507900                  IF  PS-NO-ERROR                                 50790062
508000                      SET  ASC-CONFIRM-CONF-DIST                  50800062
508100                           PS-ERROR                               50810062
508200                           DP020-MSG-WARNING                      50820062
508300                           PS-CONFIRM-PROCESSING  TO TRUE         50830062
508400                      IF  DP020-MSG-NUMBER  =  PC-TSYMSG-02322    50840062
508500                          CONTINUE                                50850062
508600                      ELSE                                        50860062
508700                         MOVE PC-TSYMSG-02258 TO DP020-MSG-NUMBER 50870062
508800                      END-IF                                      50880062
508900                      MOVE -1              TO MR-SELECTL (PV-SUB) 50890062
509000                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         50900062
509100                  END-IF                                          50910062
509200                                                                  50920062
509300         END-EVALUATE                                             50930062
509400     END-IF.                                                      50940062
509500                                                                  50950062
509600                                                                  50960062
509700*----------------------------------------------------------------*50970062
509800* VALIDATE CONFIRM/UNCONFIRM FOR RDM                             *50980062
509900*----------------------------------------------------------------*50990062
510000 3635-CHECK-FOR-RDM.                                              51000062
510100                                                                  51010062
510200     MOVE  ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             51020062
510300                             TO DK-RDM-PULL-NUMBER.               51030062
510400                                                                  51040062
510500      EXEC SQL                                                    51050062
510600        SELECT  1                                                 51060062
510700          INTO  :DK-DUMMY-FIELD                                   51070062
510800           FROM  TCEPLRQ A, TCEPLST B,                            51080062
510900                 TKRPRPM C                                        51090062
511000           WHERE     A.CNSTK_REQ_PL_NBR = B.CNSTK_REQ_PL_NBR      51100062
511100                 AND B.CNSTK_REQ_PL_NBR = :DK-RDM-PULL-NUMBER     51110062
511200                 AND A.CNSTK_LOC_ID = C.LOC_ID                    51120062
511300                 AND B.PL_LNE_NBR = 0                             51130062
511400                 AND B.STAT_CDE = 'NW'                            51140062
511500                 AND C.INTFC_SYS_CDE = 'RDM'                      51150062
511600                 AND C.SYS_PRC_FUNC_CDE = 'RDMCSL'                51160062
511700                 AND C.FUNC_PRC_STAT_CDE = 'AC'                   51170062
511800                 AND DATE(FUNC_BEG_TMST) < DATE(CRE_TMST)         51180062
511900      END-EXEC.                                                   51190062
512000                                                                  51200062
512100      EVALUATE TRUE                                               51210062
512200          WHEN SQLCODE = 0                                        51220062
512300              SET PS-ERROR                                        51230062
512400                  DP020-MSG-FATAL TO  TRUE                        51240062
512500              MOVE PC-TSYMSG-02495        TO DP020-MSG-NUMBER     51250062
512600              MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SELECTA (PV-SUB)  51260062
512700              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  51270062
512800              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  51280062
512900              MOVE -1                     TO MR-SELECTL (PV-SUB)  51290062
513000              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 51300062
513100      END-EVALUATE.                                               51310062
513200                                                                  51320062
513300                                                                  51330062
513400*-----------------------------------------------------------------51340062
513500* VERIFY NECESSARY FIELDS ENTERED FOR "PRINT PULL"                51350062
513600*  F23 - LOCAL-06                                                 51360062
513700*-----------------------------------------------------------------51370062
513800 3640-PRT-PULL-FIELDS.                                            51380062
513900                                                                  51390062
514000     MOVE  ASC-PULL-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)         51400062
514100       TO  PV-PULL-STATUS.                                        51410062
514200                                                                  51420062
514300     IF  PS-NO-ERROR                                              51430062
514400         IF  PV-PULL-STATUS-CANCELLED                             51440062
514500             SET PS-ERROR                                         51450062
514600                 DP020-MSG-FATAL   TO TRUE                        51460062
514700             MOVE PC-TSYMSG-02226  TO DP020-MSG-NUMBER            51470062
514800             MOVE -1               TO MR-SELECTL (PV-SUB)         51480062
514900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  51490062
515000             SET PS-BLOCK-ERROR    TO TRUE                        51500062
515100         ELSE                                                     51510062
515200         IF  PV-PULL-STATUS-DISTRIBTD  OR                         51520062
515300             PV-PULL-STATUS-POSTED                                51530062
515400             SET PS-ERROR                                         51540062
515500                 DP020-MSG-FATAL   TO TRUE                        51550062
515600             MOVE PC-TSYMSG-02323  TO DP020-MSG-NUMBER            51560062
515700             MOVE -1               TO MR-SELECTL (PV-SUB)         51570062
515800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  51580062
515900             SET PS-BLOCK-ERROR    TO TRUE                        51590062
516000         END-IF                                                   51600062
516100         END-IF                                                   51610062
516200     END-IF.                                                      51620062
516300                                                                  51630062
516400     IF  PS-NO-ERROR                                              51640062
516500         IF  ASC-NBR-ITEMS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    51650062
516600             CONTINUE                                             51660062
516700         ELSE                                                     51670062
516800             SET PS-ERROR                                         51680062
516900                 DP020-MSG-FATAL   TO TRUE                        51690062
517000             MOVE PC-TSYMSG-02296  TO DP020-MSG-NUMBER            51700062
517100             MOVE -1               TO MR-SELECTL (PV-SUB)         51710062
517200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  51720062
517300             SET PS-BLOCK-ERROR    TO TRUE                        51730062
517400         END-IF                                                   51740062
517500     END-IF.                                                      51750062
517600                                                                  51760062
517700                                                                  51770062
517800*-----------------------------------------------------------------51780062
517900* CHECK TO MAKE SURE RESEND PULL VALID                            51790062
518000* NEED TO MAKE SURE VALID RDM FACILITY                            51800062
518100*  F15 - LOCAL-08                                                 51810062
518200*  ADDED 10/19/11                                                 51820062
518300*-----------------------------------------------------------------51830062
518400 3645-RESEND-PULL-EDITS.                                          51840062
518500                                                                  51850062
518600     PERFORM 3700-GET-STORE-INFORMATION                           51860062
518700     PERFORM 3390-VALIDATE-RDM-FACILITY                           51870062
518800     IF  PS-VALID-RDM-FACILITY                                    51880062
518900         CONTINUE                                                 51890062
519000     ELSE                                                         51900062
519100         MOVE ASC-PULL-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           51910062
519200           TO DK-PULL-NUMBER                                      51920062
519201         PERFORM 3391-CHECK-CE-PULL-LOC                           51920162
519202     END-IF.                                                      51920262
519203                                                                  51920362
519204     IF  PS-VALID-RDM-FACILITY-NO                                 51920462
519205         SET  PS-ERROR  TO  TRUE                                  51920562
519206         MOVE PC-TSYMSG-02516  TO DP020-MSG-NUMBER                51920662
519207     END-IF.                                                      51920762
519208                                                                  51920862
519209     IF  PS-NO-ERROR                                              51920962
519210         IF  ASC-NBR-ITEMS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    51921062
519211             CONTINUE                                             51921162
519212         ELSE                                                     51921262
519213             SET PS-ERROR                                         51921362
519214                 DP020-MSG-FATAL   TO TRUE                        51921462
519215             MOVE PC-TSYMSG-02516  TO DP020-MSG-NUMBER            51921562
519216             MOVE -1               TO MR-SELECTL (PV-SUB)         51921662
519217             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  51921762
519218             SET PS-BLOCK-ERROR    TO TRUE                        51921862
519220         END-IF                                                   51922062
519221     END-IF.                                                      51922162
519230                                                                  51923062
519240                                                                  51924062
519250****************************************************************  51925062
519260*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  51926062
519270*                                                              *  51927062
519280****************************************************************  51928062
519290 3700-GET-STORE-INFORMATION.                                      51929062
519300                                                                  51930062
519400     INITIALIZE PV-CS-LOC-SIGNED                                  51940062
519500                PV-DC-NBR-SIGNED.                                 51950062
519600                                                                  51960062
519700     INITIALIZE XL071-COMMAREA.                                   51970062
519800     MOVE ASC-CS-LOC-N TO XL071-LOCATION-NUMBER                   51980062
519900                          PV-CS-LOC-SIGNED.                       51990062
520000                                                                  52000062
520100     CALL XL071-LOCATION-MODULE USING                             52010062
520200                                DFHEIBLK                          52020062
520300                                XL071-COMMAREA                    52030062
520400                                XL071-COMMAREA-REC.               52040062
520500                                                                  52050062
520600     EVALUATE TRUE                                                52060062
520700         WHEN XL071-NO-ERRORS                                     52070062
520800              MOVE XL071-ASGMT-DC-NBR TO PV-DC-NBR-SIGNED         52080062
520900                                                                  52090062
521000         WHEN XL071-LOC-NOT-FOUND                                 52100062
521100              CONTINUE                                            52110062
521200                                                                  52120062
521300         WHEN OTHER                                               52130062
521400              MOVE '3700-GET-STORE-INFORMATION'                   52140062
521500                                  TO DP013-PARAGRAPH              52150062
521600              MOVE 'VERIFY LOCATION IS CENTRAL STOCK'             52160062
521700                                  TO DP013-MESSAGE-TEXT (1)       52170062
521800              STRING ' LOCATION - '                               52180062
521900                      XL071-LOCATION-NUMBER                       52190062
522000                      DELIMITED BY SIZE                           52200062
522100                      INTO DP013-MESSAGE-TEXT (2)                 52210062
522200              MOVE XL071-SQLCODE TO SQLCODE                       52220062
522300              MOVE XL071-SQLCA   TO DP013-SQLCA                   52230062
522400              MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)         52240062
522500              SET DP013-DB2-ABEND                                 52250062
522600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              52260062
522700              PERFORM DP013-0000-PROCESS-ABEND                    52270062
522800                                                                  52280062
522900     END-EVALUATE.                                                52290062
523000                                                                  52300062
523100                                                                  52310062
523200*----------------------------------------------------------------*52320062
523300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *52330062
523400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *52340062
523500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *52350062
523600*    DISPLAY THE PANEL TO USER.                                  *52360062
523700*----------------------------------------------------------------*52370062
523800                                                                  52380062
523900 4000-BUILD-INITIAL-PANEL.                                        52390062
524000                                                                  52400062
524100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            52410062
524200                                 ASC-BLOCK-ENTRIES (2).           52420062
524300     MOVE +1                 TO  ASC-BLK-SUB.                     52430062
524400     SET ASC-ITEMS-LEFT-ON-DB                                     52440062
524500                             TO TRUE.                             52450062
524600                                                                  52460062
524700     MOVE +0                 TO ASC-ITEM-SUB                      52470062
524800                                ASC-NUMBER-OF-ITEMS-READ          52480062
524900                                ASC-NUMBER-OF-SELECTED-ITEMS      52490062
525000                                ASC-HIGHEST-BLOCK-WRITTEN         52500062
525100                                ASC-START-OF-SELECTED-RANGE       52510062
525200                                ASC-END-OF-SELECTED-RANGE         52520062
525300                                ASC-ITEM-AT-TOP-OF-PANEL.         52530062
525400                                                                  52540062
525500                                                                  52550062
525600     PERFORM 4100-PREPARE-CURSOR                                  52560062
525700                                                                  52570062
525800     PERFORM 4010-OPEN-CURSOR.                                    52580062
525900                                                                  52590062
526000     PERFORM 4300-READ-ITEMS-FROM-DB.                             52600062
526100                                                                  52610062
526200     PERFORM 4020-CLOSE-CURSOR.                                   52620062
526300                                                                  52630062
526400     MOVE +1                   TO  PV-TOP-ITEM.                   52640062
526500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          52650062
526600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    52660062
526700         SET DP020-MSG-FATAL   TO  TRUE                           52670062
526800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               52680062
526900     ELSE                                                         52690062
527000         MOVE -1               TO MR-SELECTL (1)                  52700062
527100         SET DP030-SET-CURSOR-APPL-1                              52710062
527200                               TO TRUE                            52720062
527300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     52730062
527400     END-IF.                                                      52740062
527500 EJECT                                                            52750062
527600*----------------------------------------------------------------*52760062
527700* OPEN THE TMESSAGE CURSOR.                                      *52770062
527800*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *52780062
527900*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *52790062
528000*   USER.                                                        *52800062
528100*----------------------------------------------------------------*52810062
528200                                                                  52820062
528300 4010-OPEN-CURSOR.                                                52830062
528400     PERFORM                                                      52840062
528500         WITH TEST AFTER                                          52850062
528600         VARYING PV-RETRY-COUNTER                                 52860062
528700         FROM 1 BY 1                                              52870062
528800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52880062
528900                   OR (SQLCODE = ZERO))                           52890062
529000         EVALUATE TRUE                                            52900062
529100             WHEN ASC-PULL-REF-NBR-CURSOR                         52910062
529200                  MOVE 'CURSOR:  PULL-REF-NBR-CSR'                52920062
529300                                 TO DP013-MESSAGE-TEXT (2)        52930062
529400                  EXEC SQL                                        52940062
529500                       OPEN PULL-REF-NBR-CSR                      52950062
529600                  END-EXEC                                        52960062
529700                                                                  52970062
529800             WHEN ASC-PULL-REFNBR-AL-CSR                          52980062
529900                 MOVE 'CURSOR:  PULL-REFNBR-AL-CSR'               52990062
530000                                   TO DP013-MESSAGE-TEXT (2)      53000062
530100                 EXEC SQL                                         53010062
530200                      OPEN PULL-REFNBR-AL-CSR                     53020062
530300                 END-EXEC                                         53030062
530400                                                                  53040062
530500             WHEN ASC-PULL-NUMBER-CURSOR                          53050062
530600                 MOVE 'CURSOR:  PULL-NBR-CSR'                     53060062
530700                                   TO DP013-MESSAGE-TEXT (2)      53070062
530800                 EXEC SQL                                         53080062
530900                      OPEN PULL-NBR-CSR                           53090062
531000                 END-EXEC                                         53100062
531100                                                                  53110062
531200             WHEN ASC-PULL-NBR-ALL-CURSOR                         53120062
531300                 MOVE 'CURSOR:  PULL-NBR-ALL-CSR'                 53130062
531400                                   TO DP013-MESSAGE-TEXT (2)      53140062
531500                 EXEC SQL                                         53150062
531600                      OPEN PULL-NBR-ALL-CSR                       53160062
531700                 END-EXEC                                         53170062
531800                                                                  53180062
531900             WHEN ASC-REF-NBR-PULL-CURSOR                         53190062
532000                 MOVE 'CURSOR:  REF-NBR-PUL-SQ-CSR'               53200062
532100                                   TO DP013-MESSAGE-TEXT (2)      53210062
532200                 EXEC SQL                                         53220062
532300                      OPEN REF-NBR-PUL-SQ-CSR                     53230062
532400                 END-EXEC                                         53240062
532500                                                                  53250062
532600             WHEN ASC-REF-NBR-ALL-PULL-CSR                        53260062
532700                 MOVE 'CURSOR:  REF-NBR-ALL-PL-CSR'               53270062
532800                                   TO DP013-MESSAGE-TEXT (2)      53280062
532900                 EXEC SQL                                         53290062
533000                      OPEN REF-NBR-ALL-PL-CSR                     53300062
533100                 END-EXEC                                         53310062
533200                                                                  53320062
533300             WHEN ASC-REF-NBR-DATE-CURSOR                         53330062
533400                 MOVE 'CURSOR:  REF-NBR-DTE-SQ-CSR'               53340062
533500                                   TO DP013-MESSAGE-TEXT (2)      53350062
533600                 EXEC SQL                                         53360062
533700                      OPEN REF-NBR-DTE-SQ-CSR                     53370062
533800                 END-EXEC                                         53380062
533900                                                                  53390062
534000             WHEN ASC-REF-NBR-ALL-DATE-CSR                        53400062
534100                 MOVE 'CURSOR:  REF-NBR-ALL-DT-CSR'               53410062
534200                                   TO DP013-MESSAGE-TEXT (2)      53420062
534300                 EXEC SQL                                         53430062
534400                      OPEN REF-NBR-ALL-DT-CSR                     53440062
534500                 END-EXEC                                         53450062
534600                                                                  53460062
534700             WHEN ASC-NO-NBR-PULL-CURSOR                          53470062
534800                 MOVE 'CURSOR:  NO-NBR-PUL-SQ-CSR'                53480062
534900                                   TO DP013-MESSAGE-TEXT (2)      53490062
535000                 EXEC SQL                                         53500062
535100                      OPEN NO-NBR-PUL-SQ-CSR                      53510062
535200                 END-EXEC                                         53520062
535300                                                                  53530062
535400             WHEN ASC-NO-NBR-ALL-PULL-CSR                         53540062
535500                 MOVE 'CURSOR:  NO-NBR-ALL-PL-CSR'                53550062
535600                                   TO DP013-MESSAGE-TEXT (2)      53560062
535700                 EXEC SQL                                         53570062
535800                      OPEN NO-NBR-ALL-PL-CSR                      53580062
535900                 END-EXEC                                         53590062
536000                                                                  53600062
536100             WHEN ASC-NO-NBR-DATE-CURSOR                          53610062
536200                 MOVE 'CURSOR:  NO-NBR-DTE-SQ-CSR'                53620062
536300                                   TO DP013-MESSAGE-TEXT (2)      53630062
536400                 EXEC SQL                                         53640062
536500                      OPEN NO-NBR-DTE-SQ-CSR                      53650062
536600                 END-EXEC                                         53660062
536700                                                                  53670062
536800             WHEN ASC-NO-NBR-ALL-DATE-CSR                         53680062
536900                 MOVE 'CURSOR:  NO-NBR-ALL-DT-CSR'                53690062
537000                                   TO DP013-MESSAGE-TEXT (2)      53700062
537100                 EXEC SQL                                         53710062
537200                      OPEN NO-NBR-ALL-DT-CSR                      53720062
537300                 END-EXEC                                         53730062
537400                                                                  53740062
537500             WHEN ASC-PULL-REF-NBR-DEPT-CURSOR                    53750062
537600                  MOVE 'CURSOR:  PULL-REF-DEPT-CSR'               53760062
537700                                 TO DP013-MESSAGE-TEXT (2)        53770062
537800                  EXEC SQL                                        53780062
537900                       OPEN PULL-REF-DEPT-CSR                     53790062
538000                  END-EXEC                                        53800062
538100                                                                  53810062
538200             WHEN ASC-PULL-REFNBR-AL-DEPT-CSR                     53820062
538300                 MOVE 'CURSOR:  PUL-REF-DPT-AL-CSR'               53830062
538400                                   TO DP013-MESSAGE-TEXT (2)      53840062
538500                 EXEC SQL                                         53850062
538600                      OPEN PUL-REF-DPT-AL-CSR                     53860062
538700                 END-EXEC                                         53870062
538800                                                                  53880062
538900             WHEN ASC-PULL-NUMBER-DEPT-CURSOR                     53890062
539000                 MOVE 'CURSOR:  PULL-NBR-DEPT-CSR'                53900062
539100                                   TO DP013-MESSAGE-TEXT (2)      53910062
539200                 EXEC SQL                                         53920062
539300                      OPEN PULL-NBR-DEPT-CSR                      53930062
539400                 END-EXEC                                         53940062
539500                                                                  53950062
539600             WHEN ASC-PULL-NBR-ALL-DEPT-CURSOR                    53960062
539700                 MOVE 'CURSOR:  PUL-NBR-DPT-AL-CSR'               53970062
539800                                   TO DP013-MESSAGE-TEXT (2)      53980062
539900                 EXEC SQL                                         53990062
540000                      OPEN PUL-NBR-DPT-AL-CSR                     54000062
540100                 END-EXEC                                         54010062
540200                                                                  54020062
540300             WHEN ASC-REF-NBR-DEPT-PULL-CURSOR                    54030062
540400                 MOVE 'CURSOR:  REF-NBR-DPT-PL-CSR'               54040062
540500                                   TO DP013-MESSAGE-TEXT (2)      54050062
540600                 EXEC SQL                                         54060062
540700                      OPEN REF-NBR-DPT-PL-CSR                     54070062
540800                 END-EXEC                                         54080062
540900                                                                  54090062
541000             WHEN ASC-REF-NBR-ALL-DEPT-PULL-CSR                   54100062
541100                 MOVE 'CURSOR:  REF-ALL-DPT-PL-CSR'               54110062
541200                                   TO DP013-MESSAGE-TEXT (2)      54120062
541300                 EXEC SQL                                         54130062
541400                      OPEN REF-ALL-DPT-PL-CSR                     54140062
541500                 END-EXEC                                         54150062
541600                                                                  54160062
541700             WHEN ASC-REF-NBR-DEPT-DATE-CURSOR                    54170062
541800                 MOVE 'CURSOR:  REF-NBR-DPT-DT-CSR'               54180062
541900                                   TO DP013-MESSAGE-TEXT (2)      54190062
542000                 EXEC SQL                                         54200062
542100                      OPEN REF-NBR-DPT-DT-CSR                     54210062
542200                 END-EXEC                                         54220062
542300                                                                  54230062
542400             WHEN ASC-REF-NBR-ALL-DEPT-DATE-CSR                   54240062
542500                 MOVE 'CURSOR:  REF-ALL-DPT-DT-CSR'               54250062
542600                                   TO DP013-MESSAGE-TEXT (2)      54260062
542700                 EXEC SQL                                         54270062
542800                      OPEN REF-ALL-DPT-DT-CSR                     54280062
542900                 END-EXEC                                         54290062
543000                                                                  54300062
543100             WHEN ASC-NO-NBR-DEPT-PULL-CURSOR                     54310062
543200                 MOVE 'CURSOR:  NO-NBR-DEPT-PL-CSR'               54320062
543300                                   TO DP013-MESSAGE-TEXT (2)      54330062
543400                 EXEC SQL                                         54340062
543500                      OPEN NO-NBR-DEPT-PL-CSR                     54350062
543600                 END-EXEC                                         54360062
543700                                                                  54370062
543800             WHEN ASC-NO-NBR-ALL-DEPT-PULL-CSR                    54380062
543900                 MOVE 'CURSOR:  NBR-ALL-DPT-PL-CSR'               54390062
544000                                   TO DP013-MESSAGE-TEXT (2)      54400062
544100                 EXEC SQL                                         54410062
544200                      OPEN NBR-ALL-DPT-PL-CSR                     54420062
544300                 END-EXEC                                         54430062
544400                                                                  54440062
544500             WHEN ASC-NO-NBR-DEPT-DATE-CURSOR                     54450062
544600                 MOVE 'CURSOR:  NO-NBR-DEPT-DT-CSR'               54460062
544700                                   TO DP013-MESSAGE-TEXT (2)      54470062
544800                 EXEC SQL                                         54480062
544900                      OPEN NO-NBR-DEPT-DT-CSR                     54490062
545000                 END-EXEC                                         54500062
545100                                                                  54510062
545200             WHEN ASC-NO-NBR-ALL-DEPT-DATE-CSR                    54520062
545300                 MOVE 'CURSOR:  NBR-ALL-DPT-DT-CSR'               54530062
545400                                   TO DP013-MESSAGE-TEXT (2)      54540062
545500                 EXEC SQL                                         54550062
545600                      OPEN NBR-ALL-DPT-DT-CSR                     54560062
545700                 END-EXEC                                         54570062
545800*TS 08/02/2010 BEG                                                54580062
545900             WHEN ASC-PULL-REFNBR-AL-MAJCL-CSR                    54590062
546000                 MOVE 'CURSOR:  PUL-REF-DPT-MAJ-AL-CSR'           54600062
546100                                   TO DP013-MESSAGE-TEXT (2)      54610062
546200                 EXEC SQL                                         54620062
546300                      OPEN PUL-REF-DPT-MAJ-AL-CSR                 54630062
546400                 END-EXEC                                         54640062
546500             WHEN ASC-PULL-REFNBR-AL-SUBCL-CSR                    54650062
546600                 MOVE 'CURSOR:  PUL-REF-DPT-MAJ-SUB-AL-CSR'       54660062
546700                                   TO DP013-MESSAGE-TEXT (2)      54670062
546800                 EXEC SQL                                         54680062
546900                      OPEN PUL-REF-DPT-MAJ-SUB-AL-CSR             54690062
547000                 END-EXEC                                         54700062
547100             WHEN ASC-PULL-REF-NBR-MAJCL-CURSOR                   54710062
547200                 MOVE 'CURSOR:  PULL-REF-DEPT-MAJ-CSR'            54720062
547300                                   TO DP013-MESSAGE-TEXT (2)      54730062
547400                 EXEC SQL                                         54740062
547500                      OPEN PULL-REF-DEPT-MAJ-CSR                  54750062
547600                 END-EXEC                                         54760062
547700             WHEN ASC-PULL-REF-NBR-SUBCL-CURSOR                   54770062
547800                 MOVE 'CURSOR:  PULL-REF-DEPT-MAJ-SUB-CSR'        54780062
547900                                   TO DP013-MESSAGE-TEXT (2)      54790062
548000                 EXEC SQL                                         54800062
548100                      OPEN PULL-REF-DEPT-MAJ-SUB-CSR              54810062
548200                 END-EXEC                                         54820062
548300             WHEN ASC-PULL-NBR-ALL-MAJCL-CURSOR                   54830062
548400                 MOVE 'CURSOR:  PUL-NBR-DPT-MAJ-AL-CSR'           54840062
548500                                   TO DP013-MESSAGE-TEXT (2)      54850062
548600                 EXEC SQL                                         54860062
548700                      OPEN PUL-NBR-DPT-MAJ-AL-CSR                 54870062
548800                 END-EXEC                                         54880062
548900             WHEN ASC-PULL-NBR-ALL-SUBCL-CURSOR                   54890062
549000                 MOVE 'CURSOR:  PUL-NBR-DPT-MAJ-SUB-AL-CSR'       54900062
549100                                   TO DP013-MESSAGE-TEXT (2)      54910062
549200                 EXEC SQL                                         54920062
549300                      OPEN PUL-NBR-DPT-MAJ-SUB-AL-CSR             54930062
549400                 END-EXEC                                         54940062
549500             WHEN ASC-PULL-NUMBER-MAJCL-CURSOR                    54950062
549600                 MOVE 'CURSOR:  PULL-NBR-DEPT-MAJ-CSR'            54960062
549700                                   TO DP013-MESSAGE-TEXT (2)      54970062
549800                 EXEC SQL                                         54980062
549900                      OPEN PULL-NBR-DEPT-MAJ-CSR                  54990062
550000                 END-EXEC                                         55000062
550100             WHEN ASC-PULL-NUMBER-SUBCL-CURSOR                    55010062
550200                 MOVE 'CURSOR:  PULL-NBR-DEPT-MAJ-SUB-CSR'        55020062
550300                                   TO DP013-MESSAGE-TEXT (2)      55030062
550400                 EXEC SQL                                         55040062
550500                      OPEN PULL-NBR-DEPT-MAJ-SUB-CSR              55050062
550600                 END-EXEC                                         55060062
550700             WHEN ASC-REF-NBR-ALL-MAJCL-PULL-CSR                  55070062
550800                 MOVE 'CURSOR:  REF-ALL-DPT-MAJ-PL-CSR'           55080062
550900                                   TO DP013-MESSAGE-TEXT (2)      55090062
551000                 EXEC SQL                                         55100062
551100                      OPEN REF-ALL-DPT-MAJ-PL-CSR                 55110062
551200                 END-EXEC                                         55120062
551300             WHEN ASC-REF-NBR-ALL-SUBCL-PULL-CSR                  55130062
551400                 MOVE 'CURSOR:  REF-ALL-DPT-MAJ-SUB-PL-CSR'       55140062
551500                                   TO DP013-MESSAGE-TEXT (2)      55150062
551600                 EXEC SQL                                         55160062
551700                      OPEN REF-ALL-DPT-MAJ-SUB-PL-CSR             55170062
551800                 END-EXEC                                         55180062
551900             WHEN ASC-REF-NBR-MAJCL-PULL-CURSOR                   55190062
552000                 MOVE 'CURSOR:  REF-NBR-DPT-MAJ-PL-CSR'           55200062
552100                                   TO DP013-MESSAGE-TEXT (2)      55210062
552200                 EXEC SQL                                         55220062
552300                      OPEN REF-NBR-DPT-MAJ-PL-CSR                 55230062
552400                 END-EXEC                                         55240062
552500             WHEN ASC-REF-NBR-SUBCL-PULL-CURSOR                   55250062
552600                 MOVE 'CURSOR:  REF-NBR-DPT-MAJ-SUB-PL-CSR'       55260062
552700                                   TO DP013-MESSAGE-TEXT (2)      55270062
552800                 EXEC SQL                                         55280062
552900                      OPEN REF-NBR-DPT-MAJ-SUB-PL-CSR             55290062
553000                 END-EXEC                                         55300062
553100             WHEN ASC-REF-NBR-ALL-MAJCL-DATE-CSR                  55310062
553200                 MOVE 'CURSOR:  REF-ALL-DPT-MAJ-DT-CSR'           55320062
553300                                   TO DP013-MESSAGE-TEXT (2)      55330062
553400                 EXEC SQL                                         55340062
553500                      OPEN REF-ALL-DPT-MAJ-DT-CSR                 55350062
553600                 END-EXEC                                         55360062
553700             WHEN ASC-REF-NBR-ALL-SUBCL-DATE-CSR                  55370062
553800                 MOVE 'CURSOR:  REF-ALL-DPT-MAJ-SUB-DT-CSR'       55380062
553900                                   TO DP013-MESSAGE-TEXT (2)      55390062
554000                 EXEC SQL                                         55400062
554100                      OPEN REF-ALL-DPT-MAJ-SUB-DT-CSR             55410062
554200                 END-EXEC                                         55420062
554300             WHEN ASC-REF-NBR-MAJCL-DATE-CURSOR                   55430062
554400                 MOVE 'CURSOR:  REF-NBR-DPT-MAJ-DT-CSR'           55440062
554500                                   TO DP013-MESSAGE-TEXT (2)      55450062
554600                 EXEC SQL                                         55460062
554700                      OPEN REF-NBR-DPT-MAJ-DT-CSR                 55470062
554800                 END-EXEC                                         55480062
554900             WHEN ASC-REF-NBR-SUBCL-DATE-CURSOR                   55490062
555000                 MOVE 'CURSOR:  REF-NBR-DPT-MAJ-SUB-DT-CSR'       55500062
555100                                   TO DP013-MESSAGE-TEXT (2)      55510062
555200                 EXEC SQL                                         55520062
555300                      OPEN REF-NBR-DPT-MAJ-SUB-DT-CSR             55530062
555400                 END-EXEC                                         55540062
555500             WHEN ASC-NBR-ALL-MAJCL-PULL-CSR                      55550062
555600                 MOVE 'CURSOR:  NBR-ALL-DPT-MAJ-PL-CSR'           55560062
555700                                   TO DP013-MESSAGE-TEXT (2)      55570062
555800                 EXEC SQL                                         55580062
555900                      OPEN NBR-ALL-DPT-MAJ-PL-CSR                 55590062
556000                 END-EXEC                                         55600062
556100             WHEN ASC-NBR-ALL-SUBCL-PULL-CSR                      55610062
556200                 MOVE 'CURSOR:  NBR-ALL-DPT-MAJ-SUB-PL-CSR'       55620062
556300                                   TO DP013-MESSAGE-TEXT (2)      55630062
556400                 EXEC SQL                                         55640062
556500                      OPEN NBR-ALL-DPT-MAJ-SUB-PL-CSR             55650062
556600                 END-EXEC                                         55660062
556700             WHEN ASC-NO-NBR-MAJCL-PULL-CURSOR                    55670062
556800                 MOVE 'CURSOR:  NO-NBR-DEPT-MAJ-PL-CSR'           55680062
556900                                   TO DP013-MESSAGE-TEXT (2)      55690062
557000                 EXEC SQL                                         55700062
557100                      OPEN NO-NBR-DEPT-MAJ-PL-CSR                 55710062
557200                 END-EXEC                                         55720062
557300             WHEN ASC-NO-NBR-SUBCL-PULL-CURSOR                    55730062
557400                 MOVE 'CURSOR:  NO-NBR-DEPT-MAJ-SUB-PL-CSR'       55740062
557500                                   TO DP013-MESSAGE-TEXT (2)      55750062
557600                 EXEC SQL                                         55760062
557700                      OPEN NO-NBR-DEPT-MAJ-SUB-PL-CSR             55770062
557800                 END-EXEC                                         55780062
557900             WHEN ASC-NBR-ALL-MAJCL-DATE-CSR                      55790062
558000                 MOVE 'CURSOR:  NBR-ALL-DPT-MAJ-DT-CSR'           55800062
558100                                   TO DP013-MESSAGE-TEXT (2)      55810062
558200                 EXEC SQL                                         55820062
558300                      OPEN NBR-ALL-DPT-MAJ-DT-CSR                 55830062
558400                 END-EXEC                                         55840062
558500             WHEN ASC-NBR-ALL-SUBCL-DATE-CSR                      55850062
558600                 MOVE 'CURSOR:  NBR-ALL-DPT-MAJ-SUB-DT-CSR'       55860062
558700                                   TO DP013-MESSAGE-TEXT (2)      55870062
558800                 EXEC SQL                                         55880062
558900                      OPEN NBR-ALL-DPT-MAJ-SUB-DT-CSR             55890062
559000                 END-EXEC                                         55900062
559100             WHEN ASC-NO-NBR-MAJCL-DATE-CURSOR                    55910062
559200                 MOVE 'CURSOR:  NO-NBR-DEPT-MAJ-DT-CSR'           55920062
559300                                   TO DP013-MESSAGE-TEXT (2)      55930062
559400                 EXEC SQL                                         55940062
559500                      OPEN NO-NBR-DEPT-MAJ-DT-CSR                 55950062
559600                 END-EXEC                                         55960062
559700             WHEN ASC-NO-NBR-SUBCL-DATE-CURSOR                    55970062
559800                 MOVE 'CURSOR:  NO-NBR-DEPT-MAJ-SUB-DT-CSR'       55980062
559900                                   TO DP013-MESSAGE-TEXT (2)      55990062
560000                 EXEC SQL                                         56000062
560100                      OPEN NO-NBR-DEPT-MAJ-SUB-DT-CSR             56010062
560200                 END-EXEC                                         56020062
560300                                                                  56030062
560400*TS 08/02/2010 END                                                56040062
560500                                                                  56050062
560600         END-EVALUATE                                             56060062
560700                                                                  56070062
560800         EVALUATE TRUE                                            56080062
560900             WHEN SQLCODE = ZERO                                  56090062
561000             WHEN SQLCODE = -904                                  56100062
561100             WHEN SQLCODE = -913                                  56110062
561200                 CONTINUE                                         56120062
561300             WHEN SQLWARN0 NOT = SPACES                           56130062
561400             WHEN SQLCODE < ZERO                                  56140062
561500             WHEN SQLCODE > ZERO                                  56150062
561600                 MOVE '4010-OPEN-CURSOR'                          56160062
561700                                   TO DP013-PARAGRAPH             56170062
561800                 MOVE 'OPEN SYSTEM MESSAGE CURSOR - '             56180062
561900                                   TO DP013-MESSAGE-TEXT (1)      56190062
562000                 MOVE SQLCA        TO DP013-SQLCA                 56200062
562100                 MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)    56210062
562200                 SET DP013-DB2-ABEND                              56220062
562300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           56230062
562400                 PERFORM DP013-0000-PROCESS-ABEND                 56240062
562500         END-EVALUATE                                             56250062
562600     END-PERFORM.                                                 56260062
562700*                                                                 56270062
562800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        56280062
562900         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             56290062
563000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   56300062
563100                                   TO DP013-MESSAGE-TEXT (1)      56310062
563200         MOVE SQLCA                TO DP013-SQLCA                 56320062
563300         MOVE 'TSYMSG  '           TO DP013-DB2-TABLE-NAME (1)    56330062
563400         SET DP013-DB2-ABEND                                      56340062
563500             DP013-XCTL-DISPLAY-RESTART                           56350062
563600                                   TO TRUE                        56360062
563700         PERFORM DP013-0000-PROCESS-ABEND                         56370062
563800     END-IF.                                                      56380062
563900                                                                  56390062
564000 EJECT                                                            56400062
564100*----------------------------------------------------------------*56410062
564200* CLOSE THE TMESSAGE CURSOR.                                     *56420062
564300*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *56430062
564400*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *56440062
564500*   USER.                                                        *56450062
564600*----------------------------------------------------------------*56460062
564700                                                                  56470062
564800 4020-CLOSE-CURSOR.                                               56480062
564900     EVALUATE TRUE                                                56490062
565000         WHEN ASC-PULL-REF-NBR-CURSOR                             56500062
565100             EXEC SQL                                             56510062
565200                 CLOSE PULL-REF-NBR-CSR                           56520062
565300             END-EXEC                                             56530062
565400                                                                  56540062
565500         WHEN ASC-PULL-REFNBR-AL-CSR                              56550062
565600             EXEC SQL                                             56560062
565700                 CLOSE PULL-REFNBR-AL-CSR                         56570062
565800             END-EXEC                                             56580062
565900                                                                  56590062
566000         WHEN ASC-PULL-NUMBER-CURSOR                              56600062
566100             EXEC SQL                                             56610062
566200                 CLOSE PULL-NBR-CSR                               56620062
566300             END-EXEC                                             56630062
566400                                                                  56640062
566500         WHEN ASC-PULL-NBR-ALL-CURSOR                             56650062
566600             EXEC SQL                                             56660062
566700                 CLOSE PULL-NBR-ALL-CSR                           56670062
566800             END-EXEC                                             56680062
566900                                                                  56690062
567000         WHEN ASC-REF-NBR-PULL-CURSOR                             56700062
567100             EXEC SQL                                             56710062
567200                 CLOSE REF-NBR-PUL-SQ-CSR                         56720062
567300             END-EXEC                                             56730062
567400                                                                  56740062
567500         WHEN ASC-REF-NBR-ALL-PULL-CSR                            56750062
567600             EXEC SQL                                             56760062
567700                 CLOSE REF-NBR-ALL-PL-CSR                         56770062
567800             END-EXEC                                             56780062
567900                                                                  56790062
568000         WHEN ASC-REF-NBR-DATE-CURSOR                             56800062
568100             EXEC SQL                                             56810062
568200                 CLOSE REF-NBR-DTE-SQ-CSR                         56820062
568300             END-EXEC                                             56830062
568400                                                                  56840062
568500         WHEN ASC-REF-NBR-ALL-DATE-CSR                            56850062
568600             EXEC SQL                                             56860062
568700                 CLOSE REF-NBR-ALL-DT-CSR                         56870062
568800             END-EXEC                                             56880062
568900                                                                  56890062
569000         WHEN ASC-NO-NBR-PULL-CURSOR                              56900062
569100             EXEC SQL                                             56910062
569200                 CLOSE NO-NBR-PUL-SQ-CSR                          56920062
569300             END-EXEC                                             56930062
569400                                                                  56940062
569500         WHEN ASC-NO-NBR-ALL-PULL-CSR                             56950062
569600             EXEC SQL                                             56960062
569700                 CLOSE NO-NBR-ALL-PL-CSR                          56970062
569800             END-EXEC                                             56980062
569900                                                                  56990062
570000         WHEN ASC-NO-NBR-DATE-CURSOR                              57000062
570100             EXEC SQL                                             57010062
570200                 CLOSE NO-NBR-DTE-SQ-CSR                          57020062
570300             END-EXEC                                             57030062
570400                                                                  57040062
570500         WHEN ASC-NO-NBR-ALL-DATE-CSR                             57050062
570600             EXEC SQL                                             57060062
570700                 CLOSE NO-NBR-ALL-DT-CSR                          57070062
570800             END-EXEC                                             57080062
570900                                                                  57090062
571000         WHEN ASC-PULL-REF-NBR-DEPT-CURSOR                        57100062
571100             EXEC SQL                                             57110062
571200                 CLOSE PULL-REF-DEPT-CSR                          57120062
571300             END-EXEC                                             57130062
571400                                                                  57140062
571500         WHEN ASC-PULL-REFNBR-AL-DEPT-CSR                         57150062
571600             EXEC SQL                                             57160062
571700                 CLOSE PUL-REF-DPT-AL-CSR                         57170062
571800             END-EXEC                                             57180062
571900                                                                  57190062
572000         WHEN ASC-PULL-NUMBER-DEPT-CURSOR                         57200062
572100             EXEC SQL                                             57210062
572200                 CLOSE PULL-NBR-DEPT-CSR                          57220062
572300             END-EXEC                                             57230062
572400                                                                  57240062
572500         WHEN ASC-PULL-NBR-ALL-DEPT-CURSOR                        57250062
572600             EXEC SQL                                             57260062
572700                 CLOSE PUL-NBR-DPT-AL-CSR                         57270062
572800             END-EXEC                                             57280062
572900                                                                  57290062
573000         WHEN ASC-REF-NBR-DEPT-PULL-CURSOR                        57300062
573100             EXEC SQL                                             57310062
573200                 CLOSE REF-NBR-DPT-PL-CSR                         57320062
573300             END-EXEC                                             57330062
573400                                                                  57340062
573500         WHEN ASC-REF-NBR-ALL-DEPT-PULL-CSR                       57350062
573600             EXEC SQL                                             57360062
573700                 CLOSE REF-ALL-DPT-PL-CSR                         57370062
573800             END-EXEC                                             57380062
573900                                                                  57390062
574000         WHEN ASC-REF-NBR-DEPT-DATE-CURSOR                        57400062
574100             EXEC SQL                                             57410062
574200                 CLOSE REF-NBR-DPT-DT-CSR                         57420062
574300             END-EXEC                                             57430062
574400                                                                  57440062
574500         WHEN ASC-REF-NBR-ALL-DEPT-DATE-CSR                       57450062
574600             EXEC SQL                                             57460062
574700                 CLOSE REF-ALL-DPT-DT-CSR                         57470062
574800             END-EXEC                                             57480062
574900                                                                  57490062
575000         WHEN ASC-NO-NBR-DEPT-PULL-CURSOR                         57500062
575100             EXEC SQL                                             57510062
575200                 CLOSE NO-NBR-DEPT-PL-CSR                         57520062
575300             END-EXEC                                             57530062
575400                                                                  57540062
575500         WHEN ASC-NO-NBR-ALL-DEPT-PULL-CSR                        57550062
575600             EXEC SQL                                             57560062
575700                 CLOSE NBR-ALL-DPT-PL-CSR                         57570062
575800             END-EXEC                                             57580062
575900                                                                  57590062
576000         WHEN ASC-NO-NBR-DEPT-DATE-CURSOR                         57600062
576100             EXEC SQL                                             57610062
576200                 CLOSE NO-NBR-DEPT-DT-CSR                         57620062
576300             END-EXEC                                             57630062
576400                                                                  57640062
576500         WHEN ASC-NO-NBR-ALL-DEPT-DATE-CSR                        57650062
576600             EXEC SQL                                             57660062
576700                 CLOSE NBR-ALL-DPT-DT-CSR                         57670062
576800             END-EXEC                                             57680062
576900*TS 08/02/2010 BEG                                                57690062
577000         WHEN ASC-PULL-REFNBR-AL-MAJCL-CSR                        57700062
577100             EXEC SQL                                             57710062
577200                 CLOSE PUL-REF-DPT-MAJ-AL-CSR                     57720062
577300             END-EXEC                                             57730062
577400         WHEN ASC-PULL-REFNBR-AL-SUBCL-CSR                        57740062
577500             EXEC SQL                                             57750062
577600                 CLOSE PUL-REF-DPT-MAJ-SUB-AL-CSR                 57760062
577700             END-EXEC                                             57770062
577800         WHEN ASC-PULL-REF-NBR-MAJCL-CURSOR                       57780062
577900             EXEC SQL                                             57790062
578000                 CLOSE PULL-REF-DEPT-MAJ-CSR                      57800062
578100             END-EXEC                                             57810062
578200         WHEN ASC-PULL-REF-NBR-SUBCL-CURSOR                       57820062
578300             EXEC SQL                                             57830062
578400                 CLOSE PULL-REF-DEPT-MAJ-SUB-CSR                  57840062
578500             END-EXEC                                             57850062
578600         WHEN ASC-PULL-NBR-ALL-MAJCL-CURSOR                       57860062
578700             EXEC SQL                                             57870062
578800                 CLOSE PUL-NBR-DPT-MAJ-AL-CSR                     57880062
578900             END-EXEC                                             57890062
579000         WHEN ASC-PULL-NBR-ALL-SUBCL-CURSOR                       57900062
579100             EXEC SQL                                             57910062
579200                 CLOSE PUL-NBR-DPT-MAJ-SUB-AL-CSR                 57920062
579300             END-EXEC                                             57930062
579400         WHEN ASC-PULL-NUMBER-MAJCL-CURSOR                        57940062
579500             EXEC SQL                                             57950062
579600                 CLOSE PULL-NBR-DEPT-MAJ-CSR                      57960062
579700             END-EXEC                                             57970062
579800         WHEN ASC-PULL-NUMBER-SUBCL-CURSOR                        57980062
579900             EXEC SQL                                             57990062
580000                 CLOSE PULL-NBR-DEPT-MAJ-SUB-CSR                  58000062
580100             END-EXEC                                             58010062
580200         WHEN ASC-REF-NBR-ALL-MAJCL-PULL-CSR                      58020062
580300             EXEC SQL                                             58030062
580400                 CLOSE REF-ALL-DPT-MAJ-PL-CSR                     58040062
580500             END-EXEC                                             58050062
580600         WHEN ASC-REF-NBR-ALL-SUBCL-PULL-CSR                      58060062
580700             EXEC SQL                                             58070062
580800                 CLOSE REF-ALL-DPT-MAJ-SUB-PL-CSR                 58080062
580900             END-EXEC                                             58090062
581000         WHEN ASC-REF-NBR-MAJCL-PULL-CURSOR                       58100062
581100             EXEC SQL                                             58110062
581200                 CLOSE REF-NBR-DPT-MAJ-PL-CSR                     58120062
581300             END-EXEC                                             58130062
581400         WHEN ASC-REF-NBR-SUBCL-PULL-CURSOR                       58140062
581500             EXEC SQL                                             58150062
581600                 CLOSE REF-NBR-DPT-MAJ-SUB-PL-CSR                 58160062
581700             END-EXEC                                             58170062
581800         WHEN ASC-REF-NBR-ALL-MAJCL-DATE-CSR                      58180062
581900             EXEC SQL                                             58190062
582000                 CLOSE REF-ALL-DPT-MAJ-DT-CSR                     58200062
582100             END-EXEC                                             58210062
582200         WHEN ASC-REF-NBR-ALL-SUBCL-DATE-CSR                      58220062
582300             EXEC SQL                                             58230062
582400                 CLOSE REF-ALL-DPT-MAJ-SUB-DT-CSR                 58240062
582500             END-EXEC                                             58250062
582600         WHEN ASC-REF-NBR-MAJCL-DATE-CURSOR                       58260062
582700             EXEC SQL                                             58270062
582800                 CLOSE REF-NBR-DPT-MAJ-DT-CSR                     58280062
582900             END-EXEC                                             58290062
583000         WHEN ASC-REF-NBR-SUBCL-DATE-CURSOR                       58300062
583100             EXEC SQL                                             58310062
583200                 CLOSE REF-NBR-DPT-MAJ-SUB-DT-CSR                 58320062
583300             END-EXEC                                             58330062
583400         WHEN ASC-NBR-ALL-MAJCL-PULL-CSR                          58340062
583500             EXEC SQL                                             58350062
583600                 CLOSE NBR-ALL-DPT-MAJ-PL-CSR                     58360062
583700             END-EXEC                                             58370062
583800         WHEN ASC-NBR-ALL-SUBCL-PULL-CSR                          58380062
583900             EXEC SQL                                             58390062
584000                 CLOSE NBR-ALL-DPT-MAJ-SUB-PL-CSR                 58400062
584100             END-EXEC                                             58410062
584200         WHEN ASC-NO-NBR-MAJCL-PULL-CURSOR                        58420062
584300             EXEC SQL                                             58430062
584400                 CLOSE NO-NBR-DEPT-MAJ-PL-CSR                     58440062
584500             END-EXEC                                             58450062
584600         WHEN ASC-NO-NBR-SUBCL-PULL-CURSOR                        58460062
584700             EXEC SQL                                             58470062
584800                 CLOSE NO-NBR-DEPT-MAJ-SUB-PL-CSR                 58480062
584900             END-EXEC                                             58490062
585000         WHEN ASC-NBR-ALL-MAJCL-DATE-CSR                          58500062
585100             EXEC SQL                                             58510062
585200                 CLOSE NBR-ALL-DPT-MAJ-DT-CSR                     58520062
585300             END-EXEC                                             58530062
585400         WHEN ASC-NBR-ALL-SUBCL-DATE-CSR                          58540062
585500             EXEC SQL                                             58550062
585600                 CLOSE NBR-ALL-DPT-MAJ-SUB-DT-CSR                 58560062
585700             END-EXEC                                             58570062
585800         WHEN ASC-NO-NBR-MAJCL-DATE-CURSOR                        58580062
585900             EXEC SQL                                             58590062
586000                 CLOSE NO-NBR-DEPT-MAJ-DT-CSR                     58600062
586100             END-EXEC                                             58610062
586200         WHEN ASC-NO-NBR-SUBCL-DATE-CURSOR                        58620062
586300             EXEC SQL                                             58630062
586400                 CLOSE NO-NBR-DEPT-MAJ-SUB-DT-CSR                 58640062
586500             END-EXEC                                             58650062
586600*TS 08/02/2010 END                                                58660062
586700                                                                  58670062
586800     END-EVALUATE.                                                58680062
586900*                                                                 58690062
587000     EVALUATE TRUE                                                58700062
587100         WHEN SQLCODE = ZERO                                      58710062
587200             CONTINUE                                             58720062
587300         WHEN SQLWARN0 NOT = SPACES                               58730062
587400         WHEN SQLCODE < ZERO                                      58740062
587500         WHEN SQLCODE > ZERO                                      58750062
587600             MOVE '4020-CLOSE-CURSOR'                             58760062
587700                               TO DP013-PARAGRAPH                 58770062
587800             MOVE 'CLOSE SYSTEM MESSAGE CURSOR '                  58780062
587900                               TO DP013-MESSAGE-TEXT (1)          58790062
588000             MOVE SQLCA        TO DP013-SQLCA                     58800062
588100             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        58810062
588200             SET DP013-DB2-ABEND                                  58820062
588300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               58830062
588400             PERFORM DP013-0000-PROCESS-ABEND                     58840062
588500     END-EVALUATE.                                                58850062
588600                                                                  58860062
588700 EJECT                                                            58870062
588800*----------------------------------------------------------------*58880062
588900*    SET UP THE HOST VARIABLES.                                  *58890062
589000*----------------------------------------------------------------*58900062
589100                                                                  58910062
589200 4100-PREPARE-CURSOR.                                             58920062
589300                                                                  58930062
589400     SET ASC-NO-CURSOR         TO TRUE.                           58940062
589500                                                                  58950062
589600     IF  ASC-PULL-NBR GREATER THAN ZERO AND                       58960062
589700         ASC-REF-NBR  GREATER THAN SPACES                         58970062
589800         IF  ASC-CS-LOC  =  PC-ALL                                58980062
589900*TS 08/02/2010 BEG                                                58990062
590000            IF ASC-SUB-CLASS > SPACES                             59000062
590100                  SET ASC-PULL-REFNBR-AL-SUBCL-CSR TO TRUE        59010062
590200            ELSE                                                  59020062
590300               IF ASC-MAJ-CLASS > SPACES                          59030062
590400                  SET ASC-PULL-REFNBR-AL-MAJCL-CSR TO TRUE        59040062
590500               ELSE                                               59050062
590600*TS 08/02/2010 END                                                59060062
590700                  IF ASC-DEPT-NBR  >  SPACES                      59070062
590800                     SET ASC-PULL-REFNBR-AL-DEPT-CSR TO TRUE      59080062
590900                  ELSE                                            59090062
591000                     SET ASC-PULL-REFNBR-AL-CSR      TO TRUE      59100062
591100                  END-IF                                          59110062
591200*TS 08/02/2010 BEG                                                59120062
591300               END-IF                                             59130062
591400            END-IF                                                59140062
591500*TS 08/02/2010 END                                                59150062
591600         ELSE                                                     59160062
591700*TS 08/02/2010 BEG                                                59170062
591800            IF ASC-SUB-CLASS > SPACES                             59180062
591900                  SET ASC-PULL-REF-NBR-SUBCL-CURSOR  TO TRUE      59190062
592000            ELSE                                                  59200062
592100               IF ASC-MAJ-CLASS > SPACES                          59210062
592200                  SET ASC-PULL-REF-NBR-MAJCL-CURSOR  TO TRUE      59220062
592300               ELSE                                               59230062
592400*TS 08/02/2010 END                                                59240062
592500                  IF  ASC-DEPT-NBR  >  SPACES                     59250062
592600                     SET ASC-PULL-REF-NBR-DEPT-CURSOR TO TRUE     59260062
592700                  ELSE                                            59270062
592800                     SET ASC-PULL-REF-NBR-CURSOR      TO TRUE     59280062
592900                  END-IF                                          59290062
593000*TS 08/02/2010 BEG                                                59300062
593100               END-IF                                             59310062
593200            END-IF                                                59320062
593300*TS 08/02/2010 END                                                59330062
593400         END-IF                                                   59340062
593500                                                                  59350062
593600     ELSE                                                         59360062
593700     IF  ASC-PULL-NBR GREATER THAN ZERO                           59370062
593800         IF  ASC-CS-LOC  =  PC-ALL                                59380062
593900*TS 08/02/2010 BEG                                                59390062
594000            IF ASC-SUB-CLASS > SPACES                             59400062
594100                  SET ASC-PULL-NBR-ALL-SUBCL-CURSOR TO TRUE       59410062
594200            ELSE                                                  59420062
594300               IF ASC-MAJ-CLASS > SPACES                          59430062
594400                  SET ASC-PULL-NBR-ALL-MAJCL-CURSOR TO TRUE       59440062
594500               ELSE                                               59450062
594600*TS 08/02/2010 END                                                59460062
594700                  IF  ASC-DEPT-NBR  >  SPACES                     59470062
594800                     SET ASC-PULL-NBR-ALL-DEPT-CURSOR TO TRUE     59480062
594900                  ELSE                                            59490062
595000                     SET ASC-PULL-NBR-ALL-CURSOR      TO TRUE     59500062
595100                  END-IF                                          59510062
595200*TS 08/02/2010 BEG                                                59520062
595300               END-IF                                             59530062
595400            END-IF                                                59540062
595500*TS 08/02/2010 END                                                59550062
595600         ELSE                                                     59560062
595700*TS 08/02/2010 BEG                                                59570062
595800            IF ASC-SUB-CLASS > SPACES                             59580062
595900                  SET ASC-PULL-NUMBER-SUBCL-CURSOR  TO TRUE       59590062
596000            ELSE                                                  59600062
596100               IF ASC-MAJ-CLASS > SPACES                          59610062
596200                  SET ASC-PULL-NUMBER-MAJCL-CURSOR  TO TRUE       59620062
596300               ELSE                                               59630062
596400*TS 08/02/2010 END                                                59640062
596500                  IF  ASC-DEPT-NBR  >  SPACES                     59650062
596600                      SET ASC-PULL-NUMBER-DEPT-CURSOR  TO TRUE    59660062
596700                  ELSE                                            59670062
596800                      SET ASC-PULL-NUMBER-CURSOR       TO TRUE    59680062
596900                  END-IF                                          59690062
597000*TS 08/02/2010 BEG                                                59700062
597100               END-IF                                             59710062
597200            END-IF                                                59720062
597300*TS 08/02/2010 END                                                59730062
597400         END-IF                                                   59740062
597500                                                                  59750062
597600     ELSE                                                         59760062
597700     IF  ASC-REF-NBR GREATER THAN SPACES                          59770062
597800         EVALUATE TRUE                                            59780062
597900             WHEN ASC-LIST-SEQ-PL-NBR                             59790062
598000                  IF  ASC-CS-LOC  =  PC-ALL                       59800062
598100*TS 08/02/2010 BEG                                                59810062
598200                    IF ASC-SUB-CLASS > SPACES                     59820062
598300                      SET ASC-REF-NBR-ALL-SUBCL-PULL-CSR TO TRUE  59830062
598400                    ELSE                                          59840062
598500                      IF ASC-MAJ-CLASS > SPACES                   59850062
598600                        SET ASC-REF-NBR-ALL-MAJCL-PULL-CSR TO TRUE59860062
598700                      ELSE                                        59870062
598800*TS 08/02/2010 END                                                59880062
598900                        IF  ASC-DEPT-NBR  >  SPACES               59890062
599000                           SET ASC-REF-NBR-ALL-DEPT-PULL-CSR      59900062
599100                                                        TO TRUE   59910062
599200                        ELSE                                      59920062
599300                           SET ASC-REF-NBR-ALL-PULL-CSR TO TRUE   59930062
599400                        END-IF                                    59940062
599500*TS 08/02/2010 BEG                                                59950062
599600                      END-IF                                      59960062
599700                    END-IF                                        59970062
599800*TS 08/02/2010 END                                                59980062
599900                  ELSE                                            59990062
600000*TS 08/02/2010 BEG                                                60000062
600100                    IF ASC-SUB-CLASS > SPACES                     60010062
600200                       SET ASC-REF-NBR-SUBCL-PULL-CURSOR TO TRUE  60020062
600300                    ELSE                                          60030062
600400                       IF ASC-MAJ-CLASS > SPACES                  60040062
600500                         SET ASC-REF-NBR-MAJCL-PULL-CURSOR TO TRUE60050062
600600                       ELSE                                       60060062
600700*TS 08/02/2010 END                                                60070062
600800                         IF  ASC-DEPT-NBR  >  SPACES              60080062
600900                            SET ASC-REF-NBR-DEPT-PULL-CURSOR      60090062
601000                                                         TO TRUE  60100062
601100                         ELSE                                     60110062
601200                            SET ASC-REF-NBR-PULL-CURSOR  TO TRUE  60120062
601300                         END-IF                                   60130062
601400*TS 08/02/2010 BEG                                                60140062
601500                       END-IF                                     60150062
601600                    END-IF                                        60160062
601700*TS 08/02/2010 END                                                60170062
601800                  END-IF                                          60180062
601900             WHEN ASC-LIST-SEQ-CR-DTE                             60190062
602000                  IF  ASC-CS-LOC  =  PC-ALL                       60200062
602100*TS 08/02/2010 BEG                                                60210062
602200                    IF ASC-SUB-CLASS > SPACES                     60220062
602300                       SET ASC-REF-NBR-ALL-SUBCL-DATE-CSR TO TRUE 60230062
602400                    ELSE                                          60240062
602500                       IF ASC-MAJ-CLASS > SPACES                  60250062
602600                          SET ASC-REF-NBR-ALL-MAJCL-DATE-CSR      60260062
602700                                                        TO TRUE   60270062
602800                       ELSE                                       60280062
602900*TS 08/02/2010 END                                                60290062
603000                         IF  ASC-DEPT-NBR  >  SPACES              60300062
603100                            SET ASC-REF-NBR-ALL-DEPT-DATE-CSR     60310062
603200                                                       TO TRUE    60320062
603300                         ELSE                                     60330062
603400                            SET ASC-REF-NBR-ALL-DATE-CSR TO TRUE  60340062
603500                         END-IF                                   60350062
603600*TS 08/02/2010 BEG                                                60360062
603700                       END-IF                                     60370062
603800                    END-IF                                        60380062
603900*TS 08/02/2010 END                                                60390062
604000                  ELSE                                            60400062
604100*TS 08/02/2010 BEG                                                60410062
604200                    IF ASC-SUB-CLASS > SPACES                     60420062
604300                       SET ASC-REF-NBR-SUBCL-DATE-CURSOR TO TRUE  60430062
604400                    ELSE                                          60440062
604500                       IF ASC-MAJ-CLASS > SPACES                  60450062
604600                          SET ASC-REF-NBR-MAJCL-DATE-CURSOR       60460062
604700                                                        TO TRUE   60470062
604800                       ELSE                                       60480062
604900*TS 08/02/2010 END                                                60490062
605000                         IF  ASC-DEPT-NBR  >  SPACES              60500062
605100                            SET ASC-REF-NBR-DEPT-DATE-CURSOR      60510062
605200                                                       TO TRUE    60520062
605300                         ELSE                                     60530062
605400                            SET ASC-REF-NBR-DATE-CURSOR  TO TRUE  60540062
605500                         END-IF                                   60550062
605600*TS 08/02/2010 BEG                                                60560062
605700                       END-IF                                     60570062
605800                    END-IF                                        60580062
605900*TS 08/02/2010 END                                                60590062
606000                  END-IF                                          60600062
606100         END-EVALUATE                                             60610062
606200     ELSE                                                         60620062
606300     IF  ASC-PULL-NBR  =  ZERO AND                                60630062
606400         ASC-REF-NBR   =  SPACES                                  60640062
606500         EVALUATE TRUE                                            60650062
606600             WHEN ASC-LIST-SEQ-PL-NBR                             60660062
606700                  IF  ASC-CS-LOC  =  PC-ALL                       60670062
606800*TS 08/02/2010 BEG                                                60680062
606900                    IF ASC-SUB-CLASS > SPACES                     60690062
607000                       SET ASC-NBR-ALL-SUBCL-PULL-CSR TO TRUE     60700062
607100                    ELSE                                          60710062
607200                       IF ASC-MAJ-CLASS > SPACES                  60720062
607300                          SET ASC-NBR-ALL-MAJCL-PULL-CSR TO TRUE  60730062
607400                       ELSE                                       60740062
607500*TS 08/02/2010 END                                                60750062
607600                         IF  ASC-DEPT-NBR  >  SPACES              60760062
607700                            SET ASC-NO-NBR-ALL-DEPT-PULL-CSR      60770062
607800                                                      TO TRUE     60780062
607900                         ELSE                                     60790062
608000                            SET ASC-NO-NBR-ALL-PULL-CSR TO TRUE   60800062
608100                         END-IF                                   60810062
608200*TS 08/02/2010 BEG                                                60820062
608300                       END-IF                                     60830062
608400                    END-IF                                        60840062
608500*TS 08/02/2010 END                                                60850062
608600                  ELSE                                            60860062
608700*TS 08/02/2010 BEG                                                60870062
608800                    IF ASC-SUB-CLASS > SPACES                     60880062
608900                       SET ASC-NO-NBR-SUBCL-PULL-CURSOR  TO TRUE  60890062
609000                    ELSE                                          60900062
609100                       IF ASC-MAJ-CLASS > SPACES                  60910062
609200                          SET ASC-NO-NBR-MAJCL-PULL-CURSOR TO TRUE60920062
609300                       ELSE                                       60930062
609400*TS 08/02/2010 END                                                60940062
609500                         IF  ASC-DEPT-NBR  >  SPACES              60950062
609600                            SET ASC-NO-NBR-DEPT-PULL-CURSOR       60960062
609700                                                      TO TRUE     60970062
609800                         ELSE                                     60980062
609900                            SET ASC-NO-NBR-PULL-CURSOR  TO TRUE   60990062
610000                         END-IF                                   61000062
610100*TS 08/02/2010 BEG                                                61010062
610200                       END-IF                                     61020062
610300                    END-IF                                        61030062
610400*TS 08/02/2010 END                                                61040062
610500                  END-IF                                          61050062
610600             WHEN ASC-LIST-SEQ-CR-DTE                             61060062
610700                  IF  ASC-CS-LOC  =  PC-ALL                       61070062
610800*TS 08/02/2010 BEG                                                61080062
610900                    IF ASC-SUB-CLASS > SPACES                     61090062
611000                       SET ASC-NBR-ALL-SUBCL-DATE-CSR TO TRUE     61100062
611100                    ELSE                                          61110062
611200                       IF ASC-MAJ-CLASS > SPACES                  61120062
611300                          SET ASC-NBR-ALL-MAJCL-DATE-CSR TO TRUE  61130062
611400                       ELSE                                       61140062
611500*TS 08/02/2010 END                                                61150062
611600                         IF  ASC-DEPT-NBR  >  SPACES              61160062
611700                            SET ASC-NO-NBR-ALL-DEPT-DATE-CSR      61170062
611800                                                      TO TRUE     61180062
611900                         ELSE                                     61190062
612000                            SET ASC-NO-NBR-ALL-DATE-CSR TO TRUE   61200062
612100                         END-IF                                   61210062
612200*TS 08/02/2010 BEG                                                61220062
612300                       END-IF                                     61230062
612400                    END-IF                                        61240062
612500*TS 08/02/2010 END                                                61250062
612600                  ELSE                                            61260062
612700*TS 08/02/2010 BEG                                                61270062
612800                    IF ASC-SUB-CLASS > SPACES                     61280062
612900                       SET ASC-NO-NBR-SUBCL-DATE-CURSOR  TO TRUE  61290062
613000                    ELSE                                          61300062
613100                       IF ASC-MAJ-CLASS > SPACES                  61310062
613200                          SET ASC-NO-NBR-MAJCL-DATE-CURSOR        61320062
613300                                                         TO TRUE  61330062
613400                       ELSE                                       61340062
613500*TS 08/02/2010 END                                                61350062
613600                         IF  ASC-DEPT-NBR  >  SPACES              61360062
613700                            SET ASC-NO-NBR-DEPT-DATE-CURSOR       61370062
613800                                                      TO TRUE     61380062
613900                         ELSE                                     61390062
614000                            SET ASC-NO-NBR-DATE-CURSOR  TO TRUE   61400062
614100                         END-IF                                   61410062
614200*TS 08/02/2010 BEG                                                61420062
614300                       END-IF                                     61430062
614400                    END-IF                                        61440062
614500*TS 08/02/2010 END                                                61450062
614600                  END-IF                                          61460062
614700         END-EVALUATE                                             61470062
614800     END-IF.                                                      61480062
614900                                                                  61490062
615000     MOVE ASC-PULL-NBR         TO DK-PULL-NUMBER.                 61500062
615100     MOVE ASC-REF-NBR          TO DK-REF-NUMBER.                  61510062
615200     MOVE ASC-DEPT-NBR-N       TO DK-DEPT-NUMBER.                 61520062
615300*TS 08/02/2010 BEG                                                61530062
615400     MOVE ASC-MAJ-CLASS        TO DK-MAJ-CL-NBR                   61540062
615500     MOVE ASC-SUB-CLASS        TO DK-SUB-CL-NBR                   61550062
615600*TS 08/02/2010 END                                                61560062
615700                                                                  61570062
615800     INITIALIZE  PV-FROM-TMST                                     61580062
615900                 PV-TO-TMST.                                      61590062
616000     MOVE  ASC-FROM-MM  TO  PV-FROM-MM.                           61600062
616100     MOVE  ASC-FROM-DD  TO  PV-FROM-DD.                           61610062
616200     MOVE  ASC-FROM-YY  TO  PV-FROM-YY.                           61620062
616300     MOVE  ASC-TO-MM    TO  PV-TO-MM.                             61630062
616400     MOVE  ASC-TO-DD    TO  PV-TO-DD.                             61640062
616500     MOVE  ASC-TO-YY    TO  PV-TO-YY.                             61650062
616600     MOVE  PV-FROM-TMST TO  DK-FROM-TMST.                         61660062
616700     MOVE  PV-TO-TMST   TO  DK-TO-TMST.                           61670062
616800                                                                  61680062
616900     IF  ASC-CS-LOC  =  PC-ALL                                    61690062
617000         CONTINUE                                                 61700062
617100     ELSE                                                         61710062
617200         MOVE ASC-CS-LOC-N     TO DK-LOC-ID                       61720062
617300     END-IF.                                                      61730062
617400                                                                  61740062
617500     EVALUATE TRUE                                                61750062
617600         WHEN  ASC-SELECT-ALL                                     61760062
617700                   SET  PV-STATUS-1-NEW                           61770062
617800                        PV-STATUS-2-CANCELLED                     61780062
617900                        PV-STATUS-3-INPROCESS                     61790062
618000                        PV-STATUS-4-DISTRIBTD                     61800062
618100                        PV-STATUS-5-POSTED     TO  TRUE           61810062
618200         WHEN  ASC-SELECT-CNCLD                                   61820062
618300                   SET  PV-STATUS-1-CANCELLED                     61830062
618400                        PV-STATUS-2-CANCELLED                     61840062
618500                        PV-STATUS-3-CANCELLED                     61850062
618600                        PV-STATUS-4-CANCELLED                     61860062
618700                        PV-STATUS-5-CANCELLED  TO  TRUE           61870062
618800         WHEN  ASC-SELECT-DSTRB                                   61880062
618900                   SET  PV-STATUS-1-DISTRIBTD                     61890062
619000                        PV-STATUS-2-DISTRIBTD                     61900062
619100                        PV-STATUS-3-DISTRIBTD                     61910062
619200                        PV-STATUS-4-DISTRIBTD                     61920062
619300                        PV-STATUS-5-DISTRIBTD  TO  TRUE           61930062
619400         WHEN  ASC-SELECT-INPROC                                  61940062
619500                   SET  PV-STATUS-1-INPROCESS                     61950062
619600                        PV-STATUS-2-INPROCESS                     61960062
619700                        PV-STATUS-3-INPROCESS                     61970062
619800                        PV-STATUS-4-INPROCESS                     61980062
619900                        PV-STATUS-5-INPROCESS  TO  TRUE           61990062
620000         WHEN  ASC-SELECT-NEW                                     62000062
620100                   SET  PV-STATUS-1-NEW                           62010062
620200                        PV-STATUS-2-NEW                           62020062
620300                        PV-STATUS-3-NEW                           62030062
620400                        PV-STATUS-4-NEW                           62040062
620500                        PV-STATUS-5-NEW        TO  TRUE           62050062
620600         WHEN  ASC-SELECT-POSTD                                   62060062
620700                   SET  PV-STATUS-1-POSTED                        62070062
620800                        PV-STATUS-2-POSTED                        62080062
620900                        PV-STATUS-3-POSTED                        62090062
621000                        PV-STATUS-4-POSTED                        62100062
621100                        PV-STATUS-5-POSTED     TO  TRUE           62110062
621200         WHEN  ASC-SELECT-NEW-INPROC                              62120062
621300                   SET  PV-STATUS-1-NEW                           62130062
621400                        PV-STATUS-2-INPROCESS                     62140062
621500                        PV-STATUS-3-INPROCESS                     62150062
621600                        PV-STATUS-4-INPROCESS                     62160062
621700                        PV-STATUS-5-INPROCESS  TO  TRUE           62170062
621800     END-EVALUATE.                                                62180062
621900                                                                  62190062
622000**DJK - 05/04/10 - ADDED FLAGS BELOW FOR EFC2                     62200062
622100     EVALUATE TRUE                                                62210062
622200         WHEN  ASC-SELECT-SRC-ALL                                 62220062
622300*TS 08/02/2010 BEG                                                62230062
622400*                  SET  PV-TYPE-1-ADAM                            62240062
622500                   SET  PV-TYPE-1-ALOC                            62250062
622600*                       PV-TYPE-2-INFOREM                         62260062
622700                        PV-TYPE-2-REPL                            62270062
622800*TS 08/02/2010 END                                                62280062
622900                        PV-TYPE-3-MANUAL                          62290062
623000                        PV-TYPE-4-XFER         TO  TRUE           62300062
623100*TS 08/02/2010 BEG                                                62310062
623200*        WHEN  ASC-SELECT-SRC-ADAM                                62320062
623300*                  SET  PV-TYPE-1-ADAM                            62330062
623400*                       PV-TYPE-2-ADAM                            62340062
623500*                       PV-TYPE-3-ADAM                            62350062
623600*                       PV-TYPE-4-ADAM         TO  TRUE           62360062
623700         WHEN  ASC-SELECT-SRC-ALOC                                62370062
623800                   SET  PV-TYPE-1-ALOC                            62380062
623900                        PV-TYPE-2-ALOC                            62390062
624000                        PV-TYPE-3-ALOC                            62400062
624100                        PV-TYPE-4-ALOC         TO  TRUE           62410062
624200*        WHEN  ASC-SELECT-SRC-INFOREM                             62420062
624300*                  SET  PV-TYPE-1-INFOREM                         62430062
624400*                       PV-TYPE-2-INFOREM                         62440062
624500*                       PV-TYPE-3-INFOREM                         62450062
624600*                       PV-TYPE-4-INFOREM      TO  TRUE           62460062
624700         WHEN  ASC-SELECT-SRC-REPL                                62470062
624800                   SET  PV-TYPE-1-REPL                            62480062
624900                        PV-TYPE-2-REPL                            62490062
625000                        PV-TYPE-3-REPL                            62500062
625100                        PV-TYPE-4-REPL         TO  TRUE           62510062
625200*TS 08/02/2010 END                                                62520062
625300         WHEN  ASC-SELECT-SRC-MANUAL                              62530062
625400                   SET  PV-TYPE-1-MANUAL                          62540062
625500                        PV-TYPE-2-MANUAL                          62550062
625600                        PV-TYPE-3-MANUAL                          62560062
625700                        PV-TYPE-4-MANUAL       TO  TRUE           62570062
625800         WHEN  ASC-SELECT-SRC-XFER                                62580062
625900                   SET  PV-TYPE-1-XFER                            62590062
626000                        PV-TYPE-2-XFER                            62600062
626100                        PV-TYPE-3-XFER                            62610062
626200                        PV-TYPE-4-XFER         TO  TRUE           62620062
626300     END-EVALUATE.                                                62630062
626400                                                                  62640062
626500                                                                  62650062
626600                                                                  62660062
626700                                                                  62670062
626800*----------------------------------------------------------------*62680062
626900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *62690062
627000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *62700062
627100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *62710062
627200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *62720062
627300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *62730062
627400*                                                                *62740062
627500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *62750062
627600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *62760062
627700*    UPON INITIALIZATION.                                        *62770062
627800*----------------------------------------------------------------*62780062
627900 4300-READ-ITEMS-FROM-DB.                                         62790062
628000                                                                  62800062
628100     PERFORM                                                      62810062
628200         VARYING PV-READ-COUNT                                    62820062
628300         FROM 1 BY 1                                              62830062
628400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    62840062
628500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         62850062
628600                                                                  62860062
628700         PERFORM 4310-FETCH                                       62870062
628800                                                                  62880062
628900         IF  ASC-ITEMS-LEFT-ON-DB                                 62890062
629000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                62900062
629100                 ADD +1            TO ASC-ITEM-SUB                62910062
629200             ELSE                                                 62920062
629300                 ADD +1            TO ASC-BLK-SUB                 62930062
629400                 MOVE +1           TO ASC-ITEM-SUB                62940062
629500                                                                  62950062
629600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         62960062
629700                     MOVE +1       TO ASC-BLK-SUB                 62970062
629800                     SET ASC-BLOCK-MODIFIED (1)                   62980062
629900                                   TO TRUE                        62990062
630000                     PERFORM 5100-WRITE-TEMP-STORAGE              63000062
630100                     MOVE ASC-BLOCK-ENTRIES                       63010062
630200                               (PC-MAX-BLOCKS-IN-ARRAY)           63020062
630300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 63030062
630400                     ADD +1        TO ASC-BLK-SUB                 63040062
630500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   63050062
630600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      63060062
630700                                   TO TRUE                        63070062
630800                 END-IF                                           63080062
630900             END-IF                                               63090062
631000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    63100062
631100             MOVE ASC-NUMBER-OF-ITEMS-READ                        63110062
631200                                   TO ASC-LIST-ITEM-NUMBER        63120062
631300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  63130062
631400                                                                  63140062
631500             MOVE CEPLRQ-CNSTK-REQ-PL-NBR                         63150062
631600                              TO DK-PULL-NUMBER                   63160062
631700                                                                  63170062
631800             PERFORM 4320-GET-PULL-STATUS                         63180062
631900             PERFORM 4330-GET-PULL-ITEM                           63190062
632000             PERFORM 4340-GET-PULL-DISTRO                         63200062
632100             PERFORM 4350-GET-PULL-MANIFEST                       63210062
632200             PERFORM 4360-GET-PULL-ADJUST                         63220062
632300                                                                  63230062
632400             MOVE CEPLRQ-CNSTK-REQ-PL-NBR                         63240062
632500                               TO ASC-PULL-NUMBER                 63250062
632600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63260062
632700             MOVE CEPLRQ-SRC-REF-NBR                              63270062
632800                               TO ASC-REF-NUMBER                  63280062
632900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63290062
633000             MOVE CEPLRQ-CNSTK-LOC-ID                             63300062
633100                               TO ASC-CS-LOCATION                 63310062
633200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63320062
633300             MOVE PV-CREATE-MMDDYY                                63330062
633400                               TO ASC-CREATE-DATE                 63340062
633500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63350062
633600             MOVE  PV-PULL-STATUS                                 63360062
633700                               TO ASC-PULL-STATUS-CDE             63370062
633800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63380062
633900             EVALUATE  TRUE                                       63390062
634000                 WHEN  PV-PULL-STATUS-NEW                         63400062
634100                           MOVE  PC-NEW-DESC                      63410062
634200                               TO ASC-PULL-STATUS-DESC            63420062
634300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63430062
634400                 WHEN  PV-PULL-STATUS-CANCELLED                   63440062
634500                           MOVE  PC-PULL-STATUS-CANCELLED         63450062
634600                               TO ASC-PULL-STATUS-DESC            63460062
634700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63470062
634800                 WHEN  PV-PULL-STATUS-INPROCESS                   63480062
634900                           MOVE  PC-IN-PROCESS-DESC               63490062
635000                               TO ASC-PULL-STATUS-DESC            63500062
635100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63510062
635200                 WHEN  PV-PULL-STATUS-DISTRIBTD                   63520062
635300                           MOVE  PC-DISTRIB-DESC                  63530062
635400                               TO ASC-PULL-STATUS-DESC            63540062
635500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63550062
635600                 WHEN  PV-PULL-STATUS-POSTED                      63560062
635700                           MOVE  PC-POSTED-DESC                   63570062
635800                               TO ASC-PULL-STATUS-DESC            63580062
635900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63590062
636000             END-EVALUATE                                         63600062
636100                                                                  63610062
636200             MOVE PV-STATUS-MMDDYY                                63620062
636300                               TO ASC-STATUS-DATE                 63630062
636400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63640062
636500                                                                  63650062
636600             MOVE  PV-PULL-SOURCE                                 63660062
636700                               TO ASC-PULL-SOURCE-CDE             63670062
636800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63680062
636900             EVALUATE  TRUE                                       63690062
637000*TS 08/02/2010 BEG                                                63700062
637100*                WHEN  PV-SOURCE-ADAM                             63710062
637200*                          MOVE  PC-ADAM-DESC                     63720062
637300                 WHEN  PV-SOURCE-ALOC                             63730062
637400                           MOVE  PC-ALOC-DESC                     63740062
637500*TS 08/02/2010 END                                                63750062
637600                               TO ASC-PULL-SOURCE-DESC            63760062
637700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63770062
637800*TS 08/02/2010 BEG                                                63780062
637900*                WHEN  PV-SOURCE-INFOREM                          63790062
638000*                          MOVE  PC-INFOREM-DESC                  63800062
638100                 WHEN  PV-SOURCE-REPL                             63810062
638200                           MOVE  PC-REPL-DESC                     63820062
638300*TS 08/02/2010 END                                                63830062
638400                               TO ASC-PULL-SOURCE-DESC            63840062
638500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63850062
638600                 WHEN  PV-SOURCE-MANUAL                           63860062
638700                           MOVE  PC-MANUAL-DESC                   63870062
638800                               TO ASC-PULL-SOURCE-DESC            63880062
638900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63890062
639000**DJK - 05/04/10 - ADDED CODE BELOW FOR DESCRIPT MOVE FOR EFC2    63900062
639100                 WHEN  PV-SOURCE-XFER                             63910062
639200                           MOVE  PC-XFER-DESC                     63920062
639300                               TO ASC-PULL-SOURCE-DESC            63930062
639400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63940062
639500                 WHEN  OTHER                                      63950062
639600                           MOVE  PC-UNKNOWN-DESC                  63960062
639700                               TO ASC-PULL-SOURCE-DESC            63970062
639800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63980062
639900             END-EVALUATE                                         63990062
640000                                                                  64000062
640100             MOVE PV-CEPLIT-ITEM-QTY                              64010062
640200                               TO ASC-NBR-ITEMS                   64020062
640300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64030062
640400             MOVE PV-CEPLIT-REQ-QTY                               64040062
640500                               TO ASC-REQ-PULL-UNITS              64050062
640600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64060062
640700             MOVE PV-CEPLIT-ACTL-QTY                              64070062
640800                               TO ASC-ACT-PULL-UNITS              64080062
640900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64090062
641000             COMPUTE PV-COMPUTE-DISTRB-QTY =                      64100062
641100                     (PV-CEPLDS-DISTRB-QTY +                      64110062
641200                      PV-CEPLMF-MANIF-QTY  +                      64120062
641300                      PV-CEPLAU-ADJUST-QTY)                       64130062
641400             MOVE PV-COMPUTE-DISTRB-QTY                           64140062
641500                               TO ASC-DISTRBUTED-UNITS            64150062
641600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64160062
641700                                  ASC-DISTRB-UNTS-NUM             64170062
641800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64180062
641900* DMH 12/15/00 - BEGIN                                            64190062
642000             EVALUATE  TRUE                                       64200062
642100                 WHEN  PV-PULL-STATUS-NEW                         64210062
642200                 WHEN  PV-PULL-STATUS-INPROCESS                   64220062
642300                       PERFORM 4365-GET-TCEPLMF                   64230062
642400                       IF  PV-TCEPLMF-COUNT  >  0                 64240062
642500                           MOVE 'Y' TO ASC-IN-TCEPLMF             64250062
642600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64260062
642700                       ELSE                                       64270062
642800                           MOVE 'N' TO ASC-IN-TCEPLMF             64280062
642900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64290062
643000                       END-IF                                     64300062
643100                 WHEN OTHER                                       64310062
643200                           MOVE 'N' TO ASC-IN-TCEPLMF             64320062
643300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 64330062
643400             END-EVALUATE                                         64340062
643500* DMH 12/15/00 - END                                              64350062
643600         END-IF                                                   64360062
643700     END-PERFORM.                                                 64370062
643800                                                                  64380062
643900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          64390062
644000         MOVE +1               TO ASC-BLK-SUB                     64400062
644100         PERFORM 5100-WRITE-TEMP-STORAGE                          64410062
644200         ADD +1                TO ASC-BLK-SUB                     64420062
644300         PERFORM 5100-WRITE-TEMP-STORAGE                          64430062
644400                                                                  64440062
644500         MOVE 1                TO ASC-BLK-SUB                     64450062
644600                                  PV-BLOCK-NUMBER                 64460062
644700         PERFORM 4410-READ-TEMP-STORAGE                           64470062
644800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             64480062
644900             MOVE 2            TO ASC-BLK-SUB                     64490062
645000                                  PV-BLOCK-NUMBER                 64500062
645100             PERFORM 4410-READ-TEMP-STORAGE                       64510062
645200         END-IF                                                   64520062
645300     END-IF.                                                      64530062
645400 EJECT                                                            64540062
645500*----------------------------------------------------------------*64550062
645600*    FETCH THE MESSAGE CURSOR.                                   *64560062
645700*----------------------------------------------------------------*64570062
645800                                                                  64580062
645900 4310-FETCH.                                                      64590062
646000                                                                  64600062
646100     EVALUATE TRUE                                                64610062
646200         WHEN ASC-PULL-REF-NBR-CURSOR                             64620062
646300              EXEC SQL                                            64630062
646400                   FETCH PULL-REF-NBR-CSR                         64640062
646500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 64650062
646600                       , :CEPLRQ-CNSTK-LOC-ID                     64660062
646700                       , :CEPLRQ-SRC-REF-NBR                      64670062
646800                       , :CEPLRQ-SRC-TYP-CDE                      64680062
646900                       , :CEPLRQ-STAT-CDE                         64690062
647000              END-EXEC                                            64700062
647100                                                                  64710062
647200         WHEN ASC-PULL-REFNBR-AL-CSR                              64720062
647300              EXEC SQL                                            64730062
647400                   FETCH PULL-REFNBR-AL-CSR                       64740062
647500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 64750062
647600                       , :CEPLRQ-CNSTK-LOC-ID                     64760062
647700                       , :CEPLRQ-SRC-REF-NBR                      64770062
647800                       , :CEPLRQ-SRC-TYP-CDE                      64780062
647900                       , :CEPLRQ-STAT-CDE                         64790062
648000              END-EXEC                                            64800062
648100                                                                  64810062
648200         WHEN ASC-PULL-NUMBER-CURSOR                              64820062
648300              EXEC SQL                                            64830062
648400                   FETCH PULL-NBR-CSR                             64840062
648500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 64850062
648600                       , :CEPLRQ-CNSTK-LOC-ID                     64860062
648700                       , :CEPLRQ-SRC-REF-NBR                      64870062
648800                       , :CEPLRQ-SRC-TYP-CDE                      64880062
648900                       , :CEPLRQ-STAT-CDE                         64890062
649000              END-EXEC                                            64900062
649100                                                                  64910062
649200         WHEN ASC-PULL-NBR-ALL-CURSOR                             64920062
649300              EXEC SQL                                            64930062
649400                   FETCH PULL-NBR-ALL-CSR                         64940062
649500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 64950062
649600                       , :CEPLRQ-CNSTK-LOC-ID                     64960062
649700                       , :CEPLRQ-SRC-REF-NBR                      64970062
649800                       , :CEPLRQ-SRC-TYP-CDE                      64980062
649900                       , :CEPLRQ-STAT-CDE                         64990062
650000              END-EXEC                                            65000062
650100                                                                  65010062
650200         WHEN ASC-REF-NBR-PULL-CURSOR                             65020062
650300              EXEC SQL                                            65030062
650400                   FETCH REF-NBR-PUL-SQ-CSR                       65040062
650500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65050062
650600                       , :CEPLRQ-CNSTK-LOC-ID                     65060062
650700                       , :CEPLRQ-SRC-REF-NBR                      65070062
650800                       , :CEPLRQ-SRC-TYP-CDE                      65080062
650900                       , :CEPLRQ-STAT-CDE                         65090062
651000              END-EXEC                                            65100062
651100                                                                  65110062
651200         WHEN ASC-REF-NBR-ALL-PULL-CSR                            65120062
651300              EXEC SQL                                            65130062
651400                   FETCH REF-NBR-ALL-PL-CSR                       65140062
651500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65150062
651600                       , :CEPLRQ-CNSTK-LOC-ID                     65160062
651700                       , :CEPLRQ-SRC-REF-NBR                      65170062
651800                       , :CEPLRQ-SRC-TYP-CDE                      65180062
651900                       , :CEPLRQ-STAT-CDE                         65190062
652000              END-EXEC                                            65200062
652100                                                                  65210062
652200         WHEN ASC-REF-NBR-DATE-CURSOR                             65220062
652300              EXEC SQL                                            65230062
652400                   FETCH REF-NBR-DTE-SQ-CSR                       65240062
652500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65250062
652600                       , :CEPLRQ-CNSTK-LOC-ID                     65260062
652700                       , :CEPLRQ-SRC-REF-NBR                      65270062
652800                       , :CEPLRQ-SRC-TYP-CDE                      65280062
652900                       , :CEPLRQ-STAT-CDE                         65290062
653000                       , :CEPLST-CRE-TMST                         65300062
653100              END-EXEC                                            65310062
653200                                                                  65320062
653300         WHEN ASC-REF-NBR-ALL-DATE-CSR                            65330062
653400              EXEC SQL                                            65340062
653500                   FETCH REF-NBR-ALL-DT-CSR                       65350062
653600                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65360062
653700                       , :CEPLRQ-CNSTK-LOC-ID                     65370062
653800                       , :CEPLRQ-SRC-REF-NBR                      65380062
653900                       , :CEPLRQ-SRC-TYP-CDE                      65390062
654000                       , :CEPLRQ-STAT-CDE                         65400062
654100                       , :CEPLST-CRE-TMST                         65410062
654200              END-EXEC                                            65420062
654300                                                                  65430062
654400         WHEN ASC-NO-NBR-PULL-CURSOR                              65440062
654500              EXEC SQL                                            65450062
654600                   FETCH NO-NBR-PUL-SQ-CSR                        65460062
654700                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65470062
654800                       , :CEPLRQ-CNSTK-LOC-ID                     65480062
654900                       , :CEPLRQ-SRC-REF-NBR                      65490062
655000                       , :CEPLRQ-SRC-TYP-CDE                      65500062
655100                       , :CEPLRQ-STAT-CDE                         65510062
655200              END-EXEC                                            65520062
655300                                                                  65530062
655400         WHEN ASC-NO-NBR-ALL-PULL-CSR                             65540062
655500              EXEC SQL                                            65550062
655600                   FETCH NO-NBR-ALL-PL-CSR                        65560062
655700                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65570062
655800                       , :CEPLRQ-CNSTK-LOC-ID                     65580062
655900                       , :CEPLRQ-SRC-REF-NBR                      65590062
656000                       , :CEPLRQ-SRC-TYP-CDE                      65600062
656100                       , :CEPLRQ-STAT-CDE                         65610062
656200              END-EXEC                                            65620062
656300                                                                  65630062
656400         WHEN ASC-NO-NBR-DATE-CURSOR                              65640062
656500              EXEC SQL                                            65650062
656600                   FETCH NO-NBR-DTE-SQ-CSR                        65660062
656700                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65670062
656800                       , :CEPLRQ-CNSTK-LOC-ID                     65680062
656900                       , :CEPLRQ-SRC-REF-NBR                      65690062
657000                       , :CEPLRQ-SRC-TYP-CDE                      65700062
657100                       , :CEPLRQ-STAT-CDE                         65710062
657200                       , :CEPLST-CRE-TMST                         65720062
657300              END-EXEC                                            65730062
657400                                                                  65740062
657500         WHEN ASC-NO-NBR-ALL-DATE-CSR                             65750062
657600              EXEC SQL                                            65760062
657700                   FETCH NO-NBR-ALL-DT-CSR                        65770062
657800                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65780062
657900                       , :CEPLRQ-CNSTK-LOC-ID                     65790062
658000                       , :CEPLRQ-SRC-REF-NBR                      65800062
658100                       , :CEPLRQ-SRC-TYP-CDE                      65810062
658200                       , :CEPLRQ-STAT-CDE                         65820062
658300                       , :CEPLST-CRE-TMST                         65830062
658400              END-EXEC                                            65840062
658500                                                                  65850062
658600         WHEN ASC-PULL-REF-NBR-DEPT-CURSOR                        65860062
658700              EXEC SQL                                            65870062
658800                   FETCH PULL-REF-DEPT-CSR                        65880062
658900                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 65890062
659000                       , :CEPLRQ-CNSTK-LOC-ID                     65900062
659100                       , :CEPLRQ-SRC-REF-NBR                      65910062
659200                       , :CEPLRQ-SRC-TYP-CDE                      65920062
659300                       , :CEPLRQ-STAT-CDE                         65930062
659400              END-EXEC                                            65940062
659500                                                                  65950062
659600*TS 08/02/2010 BEG                                                65960062
659700         WHEN ASC-PULL-REF-NBR-MAJCL-CURSOR                       65970062
659800              EXEC SQL                                            65980062
659900                   FETCH PULL-REF-DEPT-MAJ-CSR                    65990062
660000                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66000062
660100                       , :CEPLRQ-CNSTK-LOC-ID                     66010062
660200                       , :CEPLRQ-SRC-REF-NBR                      66020062
660300                       , :CEPLRQ-SRC-TYP-CDE                      66030062
660400                       , :CEPLRQ-STAT-CDE                         66040062
660500              END-EXEC                                            66050062
660600                                                                  66060062
660700         WHEN ASC-PULL-REF-NBR-SUBCL-CURSOR                       66070062
660800              EXEC SQL                                            66080062
660900                   FETCH PULL-REF-DEPT-MAJ-SUB-CSR                66090062
661000                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66100062
661100                       , :CEPLRQ-CNSTK-LOC-ID                     66110062
661200                       , :CEPLRQ-SRC-REF-NBR                      66120062
661300                       , :CEPLRQ-SRC-TYP-CDE                      66130062
661400                       , :CEPLRQ-STAT-CDE                         66140062
661500              END-EXEC                                            66150062
661600*TS 08/02/2010 END                                                66160062
661700                                                                  66170062
661800         WHEN ASC-PULL-REFNBR-AL-DEPT-CSR                         66180062
661900              EXEC SQL                                            66190062
662000                   FETCH PUL-REF-DPT-AL-CSR                       66200062
662100                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66210062
662200                       , :CEPLRQ-CNSTK-LOC-ID                     66220062
662300                       , :CEPLRQ-SRC-REF-NBR                      66230062
662400                       , :CEPLRQ-SRC-TYP-CDE                      66240062
662500                       , :CEPLRQ-STAT-CDE                         66250062
662600              END-EXEC                                            66260062
662700                                                                  66270062
662800*TS 08/02/2010 BEG                                                66280062
662900         WHEN ASC-PULL-REFNBR-AL-MAJCL-CSR                        66290062
663000              EXEC SQL                                            66300062
663100                   FETCH PUL-REF-DPT-MAJ-AL-CSR                   66310062
663200                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66320062
663300                       , :CEPLRQ-CNSTK-LOC-ID                     66330062
663400                       , :CEPLRQ-SRC-REF-NBR                      66340062
663500                       , :CEPLRQ-SRC-TYP-CDE                      66350062
663600                       , :CEPLRQ-STAT-CDE                         66360062
663700              END-EXEC                                            66370062
663800                                                                  66380062
663900         WHEN ASC-PULL-REFNBR-AL-SUBCL-CSR                        66390062
664000              EXEC SQL                                            66400062
664100                   FETCH PUL-REF-DPT-MAJ-SUB-AL-CSR               66410062
664200                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66420062
664300                       , :CEPLRQ-CNSTK-LOC-ID                     66430062
664400                       , :CEPLRQ-SRC-REF-NBR                      66440062
664500                       , :CEPLRQ-SRC-TYP-CDE                      66450062
664600                       , :CEPLRQ-STAT-CDE                         66460062
664700              END-EXEC                                            66470062
664800*TS 08/02/2010 END                                                66480062
664900                                                                  66490062
665000         WHEN ASC-PULL-NUMBER-DEPT-CURSOR                         66500062
665100              EXEC SQL                                            66510062
665200                   FETCH PULL-NBR-DEPT-CSR                        66520062
665300                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66530062
665400                       , :CEPLRQ-CNSTK-LOC-ID                     66540062
665500                       , :CEPLRQ-SRC-REF-NBR                      66550062
665600                       , :CEPLRQ-SRC-TYP-CDE                      66560062
665700                       , :CEPLRQ-STAT-CDE                         66570062
665800              END-EXEC                                            66580062
665900                                                                  66590062
666000*TS 08/02/2010 BEG                                                66600062
666100         WHEN ASC-PULL-NUMBER-MAJCL-CURSOR                        66610062
666200              EXEC SQL                                            66620062
666300                   FETCH PULL-NBR-DEPT-MAJ-CSR                    66630062
666400                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66640062
666500                       , :CEPLRQ-CNSTK-LOC-ID                     66650062
666600                       , :CEPLRQ-SRC-REF-NBR                      66660062
666700                       , :CEPLRQ-SRC-TYP-CDE                      66670062
666800                       , :CEPLRQ-STAT-CDE                         66680062
666900              END-EXEC                                            66690062
667000                                                                  66700062
667100         WHEN ASC-PULL-NUMBER-SUBCL-CURSOR                        66710062
667200              EXEC SQL                                            66720062
667300                   FETCH PULL-NBR-DEPT-MAJ-SUB-CSR                66730062
667400                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66740062
667500                       , :CEPLRQ-CNSTK-LOC-ID                     66750062
667600                       , :CEPLRQ-SRC-REF-NBR                      66760062
667700                       , :CEPLRQ-SRC-TYP-CDE                      66770062
667800                       , :CEPLRQ-STAT-CDE                         66780062
667900              END-EXEC                                            66790062
668000                                                                  66800062
668100*TS 08/02/2010 END                                                66810062
668200                                                                  66820062
668300         WHEN ASC-PULL-NBR-ALL-DEPT-CURSOR                        66830062
668400              EXEC SQL                                            66840062
668500                   FETCH PUL-NBR-DPT-AL-CSR                       66850062
668600                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66860062
668700                       , :CEPLRQ-CNSTK-LOC-ID                     66870062
668800                       , :CEPLRQ-SRC-REF-NBR                      66880062
668900                       , :CEPLRQ-SRC-TYP-CDE                      66890062
669000                       , :CEPLRQ-STAT-CDE                         66900062
669100              END-EXEC                                            66910062
669200                                                                  66920062
669300*TS 08/02/2010 BEG                                                66930062
669400         WHEN ASC-PULL-NBR-ALL-MAJCL-CURSOR                       66940062
669500              EXEC SQL                                            66950062
669600                   FETCH PUL-NBR-DPT-MAJ-AL-CSR                   66960062
669700                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 66970062
669800                       , :CEPLRQ-CNSTK-LOC-ID                     66980062
669900                       , :CEPLRQ-SRC-REF-NBR                      66990062
670000                       , :CEPLRQ-SRC-TYP-CDE                      67000062
670100                       , :CEPLRQ-STAT-CDE                         67010062
670200              END-EXEC                                            67020062
670300                                                                  67030062
670400         WHEN ASC-PULL-NBR-ALL-SUBCL-CURSOR                       67040062
670500              EXEC SQL                                            67050062
670600                   FETCH PUL-NBR-DPT-MAJ-SUB-AL-CSR               67060062
670700                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67070062
670800                       , :CEPLRQ-CNSTK-LOC-ID                     67080062
670900                       , :CEPLRQ-SRC-REF-NBR                      67090062
671000                       , :CEPLRQ-SRC-TYP-CDE                      67100062
671100                       , :CEPLRQ-STAT-CDE                         67110062
671200              END-EXEC                                            67120062
671300                                                                  67130062
671400*TS 08/02/2010 END                                                67140062
671500                                                                  67150062
671600         WHEN ASC-REF-NBR-DEPT-PULL-CURSOR                        67160062
671700              EXEC SQL                                            67170062
671800                   FETCH REF-NBR-DPT-PL-CSR                       67180062
671900                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67190062
672000                       , :CEPLRQ-CNSTK-LOC-ID                     67200062
672100                       , :CEPLRQ-SRC-REF-NBR                      67210062
672200                       , :CEPLRQ-SRC-TYP-CDE                      67220062
672300                       , :CEPLRQ-STAT-CDE                         67230062
672400              END-EXEC                                            67240062
672500                                                                  67250062
672600*TS 08/02/2010 BEG                                                67260062
672700         WHEN ASC-REF-NBR-MAJCL-PULL-CURSOR                       67270062
672800              EXEC SQL                                            67280062
672900                   FETCH REF-NBR-DPT-MAJ-PL-CSR                   67290062
673000                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67300062
673100                       , :CEPLRQ-CNSTK-LOC-ID                     67310062
673200                       , :CEPLRQ-SRC-REF-NBR                      67320062
673300                       , :CEPLRQ-SRC-TYP-CDE                      67330062
673400                       , :CEPLRQ-STAT-CDE                         67340062
673500              END-EXEC                                            67350062
673600                                                                  67360062
673700         WHEN ASC-REF-NBR-SUBCL-PULL-CURSOR                       67370062
673800              EXEC SQL                                            67380062
673900                   FETCH REF-NBR-DPT-MAJ-SUB-PL-CSR               67390062
674000                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67400062
674100                       , :CEPLRQ-CNSTK-LOC-ID                     67410062
674200                       , :CEPLRQ-SRC-REF-NBR                      67420062
674300                       , :CEPLRQ-SRC-TYP-CDE                      67430062
674400                       , :CEPLRQ-STAT-CDE                         67440062
674500              END-EXEC                                            67450062
674600                                                                  67460062
674700*TS 08/02/2010 END                                                67470062
674800                                                                  67480062
674900         WHEN ASC-REF-NBR-ALL-DEPT-PULL-CSR                       67490062
675000              EXEC SQL                                            67500062
675100                   FETCH REF-ALL-DPT-PL-CSR                       67510062
675200                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67520062
675300                       , :CEPLRQ-CNSTK-LOC-ID                     67530062
675400                       , :CEPLRQ-SRC-REF-NBR                      67540062
675500                       , :CEPLRQ-SRC-TYP-CDE                      67550062
675600                       , :CEPLRQ-STAT-CDE                         67560062
675700              END-EXEC                                            67570062
675800                                                                  67580062
675900*TS 08/02/2010 BEG                                                67590062
676000         WHEN ASC-REF-NBR-ALL-MAJCL-PULL-CSR                      67600062
676100              EXEC SQL                                            67610062
676200                   FETCH REF-ALL-DPT-MAJ-PL-CSR                   67620062
676300                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67630062
676400                       , :CEPLRQ-CNSTK-LOC-ID                     67640062
676500                       , :CEPLRQ-SRC-REF-NBR                      67650062
676600                       , :CEPLRQ-SRC-TYP-CDE                      67660062
676700                       , :CEPLRQ-STAT-CDE                         67670062
676800              END-EXEC                                            67680062
676900                                                                  67690062
677000         WHEN ASC-REF-NBR-ALL-SUBCL-PULL-CSR                      67700062
677100              EXEC SQL                                            67710062
677200                   FETCH REF-ALL-DPT-MAJ-SUB-PL-CSR               67720062
677300                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67730062
677400                       , :CEPLRQ-CNSTK-LOC-ID                     67740062
677500                       , :CEPLRQ-SRC-REF-NBR                      67750062
677600                       , :CEPLRQ-SRC-TYP-CDE                      67760062
677700                       , :CEPLRQ-STAT-CDE                         67770062
677800              END-EXEC                                            67780062
677900                                                                  67790062
678000*TS 08/02/2010 END                                                67800062
678100                                                                  67810062
678200         WHEN ASC-REF-NBR-DEPT-DATE-CURSOR                        67820062
678300              EXEC SQL                                            67830062
678400                   FETCH REF-NBR-DPT-DT-CSR                       67840062
678500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67850062
678600                       , :CEPLRQ-CNSTK-LOC-ID                     67860062
678700                       , :CEPLRQ-SRC-REF-NBR                      67870062
678800                       , :CEPLRQ-SRC-TYP-CDE                      67880062
678900                       , :CEPLRQ-STAT-CDE                         67890062
679000                       , :CEPLST-CRE-TMST                         67900062
679100              END-EXEC                                            67910062
679200                                                                  67920062
679300*TS 08/02/2010 BEG                                                67930062
679400         WHEN ASC-REF-NBR-MAJCL-DATE-CURSOR                       67940062
679500              EXEC SQL                                            67950062
679600                   FETCH REF-NBR-DPT-MAJ-DT-CSR                   67960062
679700                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 67970062
679800                       , :CEPLRQ-CNSTK-LOC-ID                     67980062
679900                       , :CEPLRQ-SRC-REF-NBR                      67990062
680000                       , :CEPLRQ-SRC-TYP-CDE                      68000062
680100                       , :CEPLRQ-STAT-CDE                         68010062
680200                       , :CEPLST-CRE-TMST                         68020062
680300              END-EXEC                                            68030062
680400                                                                  68040062
680500         WHEN ASC-REF-NBR-SUBCL-DATE-CURSOR                       68050062
680600              EXEC SQL                                            68060062
680700                   FETCH REF-NBR-DPT-MAJ-SUB-DT-CSR               68070062
680800                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68080062
680900                       , :CEPLRQ-CNSTK-LOC-ID                     68090062
681000                       , :CEPLRQ-SRC-REF-NBR                      68100062
681100                       , :CEPLRQ-SRC-TYP-CDE                      68110062
681200                       , :CEPLRQ-STAT-CDE                         68120062
681300                       , :CEPLST-CRE-TMST                         68130062
681400              END-EXEC                                            68140062
681500                                                                  68150062
681600*TS 08/02/2010 END                                                68160062
681700                                                                  68170062
681800         WHEN ASC-REF-NBR-ALL-DEPT-DATE-CSR                       68180062
681900              EXEC SQL                                            68190062
682000                   FETCH REF-ALL-DPT-DT-CSR                       68200062
682100                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68210062
682200                       , :CEPLRQ-CNSTK-LOC-ID                     68220062
682300                       , :CEPLRQ-SRC-REF-NBR                      68230062
682400                       , :CEPLRQ-SRC-TYP-CDE                      68240062
682500                       , :CEPLRQ-STAT-CDE                         68250062
682600                       , :CEPLST-CRE-TMST                         68260062
682700              END-EXEC                                            68270062
682800                                                                  68280062
682900*TS 08/02/2010 BEG                                                68290062
683000         WHEN ASC-REF-NBR-ALL-MAJCL-DATE-CSR                      68300062
683100              EXEC SQL                                            68310062
683200                   FETCH REF-ALL-DPT-MAJ-DT-CSR                   68320062
683300                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68330062
683400                       , :CEPLRQ-CNSTK-LOC-ID                     68340062
683500                       , :CEPLRQ-SRC-REF-NBR                      68350062
683600                       , :CEPLRQ-SRC-TYP-CDE                      68360062
683700                       , :CEPLRQ-STAT-CDE                         68370062
683800                       , :CEPLST-CRE-TMST                         68380062
683900              END-EXEC                                            68390062
684000                                                                  68400062
684100         WHEN ASC-REF-NBR-ALL-SUBCL-DATE-CSR                      68410062
684200              EXEC SQL                                            68420062
684300                   FETCH REF-ALL-DPT-MAJ-SUB-DT-CSR               68430062
684400                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68440062
684500                       , :CEPLRQ-CNSTK-LOC-ID                     68450062
684600                       , :CEPLRQ-SRC-REF-NBR                      68460062
684700                       , :CEPLRQ-SRC-TYP-CDE                      68470062
684800                       , :CEPLRQ-STAT-CDE                         68480062
684900                       , :CEPLST-CRE-TMST                         68490062
685000              END-EXEC                                            68500062
685100                                                                  68510062
685200*TS 08/02/2010 END                                                68520062
685300                                                                  68530062
685400         WHEN ASC-NO-NBR-DEPT-PULL-CURSOR                         68540062
685500              EXEC SQL                                            68550062
685600                   FETCH NO-NBR-DEPT-PL-CSR                       68560062
685700                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68570062
685800                       , :CEPLRQ-CNSTK-LOC-ID                     68580062
685900                       , :CEPLRQ-SRC-REF-NBR                      68590062
686000                       , :CEPLRQ-SRC-TYP-CDE                      68600062
686100                       , :CEPLRQ-STAT-CDE                         68610062
686200              END-EXEC                                            68620062
686300                                                                  68630062
686400*TS 08/02/2010 BEG                                                68640062
686500         WHEN ASC-NO-NBR-MAJCL-PULL-CURSOR                        68650062
686600              EXEC SQL                                            68660062
686700                   FETCH NO-NBR-DEPT-MAJ-PL-CSR                   68670062
686800                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68680062
686900                       , :CEPLRQ-CNSTK-LOC-ID                     68690062
687000                       , :CEPLRQ-SRC-REF-NBR                      68700062
687100                       , :CEPLRQ-SRC-TYP-CDE                      68710062
687200                       , :CEPLRQ-STAT-CDE                         68720062
687300              END-EXEC                                            68730062
687400                                                                  68740062
687500         WHEN ASC-NO-NBR-SUBCL-PULL-CURSOR                        68750062
687600              EXEC SQL                                            68760062
687700                   FETCH NO-NBR-DEPT-MAJ-SUB-PL-CSR               68770062
687800                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68780062
687900                       , :CEPLRQ-CNSTK-LOC-ID                     68790062
688000                       , :CEPLRQ-SRC-REF-NBR                      68800062
688100                       , :CEPLRQ-SRC-TYP-CDE                      68810062
688200                       , :CEPLRQ-STAT-CDE                         68820062
688300              END-EXEC                                            68830062
688400                                                                  68840062
688500*TS 08/02/2010 END                                                68850062
688600                                                                  68860062
688700         WHEN ASC-NO-NBR-ALL-DEPT-PULL-CSR                        68870062
688800              EXEC SQL                                            68880062
688900                   FETCH NBR-ALL-DPT-PL-CSR                       68890062
689000                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 68900062
689100                       , :CEPLRQ-CNSTK-LOC-ID                     68910062
689200                       , :CEPLRQ-SRC-REF-NBR                      68920062
689300                       , :CEPLRQ-SRC-TYP-CDE                      68930062
689400                       , :CEPLRQ-STAT-CDE                         68940062
689500              END-EXEC                                            68950062
689600                                                                  68960062
689700*TS 08/02/2010 BEG                                                68970062
689800         WHEN ASC-NBR-ALL-MAJCL-PULL-CSR                          68980062
689900              EXEC SQL                                            68990062
690000                   FETCH NBR-ALL-DPT-MAJ-PL-CSR                   69000062
690100                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69010062
690200                       , :CEPLRQ-CNSTK-LOC-ID                     69020062
690300                       , :CEPLRQ-SRC-REF-NBR                      69030062
690400                       , :CEPLRQ-SRC-TYP-CDE                      69040062
690500                       , :CEPLRQ-STAT-CDE                         69050062
690600              END-EXEC                                            69060062
690700                                                                  69070062
690800         WHEN ASC-NBR-ALL-SUBCL-PULL-CSR                          69080062
690900              EXEC SQL                                            69090062
691000                   FETCH NBR-ALL-DPT-MAJ-SUB-PL-CSR               69100062
691100                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69110062
691200                       , :CEPLRQ-CNSTK-LOC-ID                     69120062
691300                       , :CEPLRQ-SRC-REF-NBR                      69130062
691400                       , :CEPLRQ-SRC-TYP-CDE                      69140062
691500                       , :CEPLRQ-STAT-CDE                         69150062
691600              END-EXEC                                            69160062
691700                                                                  69170062
691800*TS 08/02/2010 END                                                69180062
691900                                                                  69190062
692000         WHEN ASC-NO-NBR-DEPT-DATE-CURSOR                         69200062
692100              EXEC SQL                                            69210062
692200                   FETCH NO-NBR-DEPT-DT-CSR                       69220062
692300                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69230062
692400                       , :CEPLRQ-CNSTK-LOC-ID                     69240062
692500                       , :CEPLRQ-SRC-REF-NBR                      69250062
692600                       , :CEPLRQ-SRC-TYP-CDE                      69260062
692700                       , :CEPLRQ-STAT-CDE                         69270062
692800                       , :CEPLST-CRE-TMST                         69280062
692900              END-EXEC                                            69290062
693000                                                                  69300062
693100*TS 08/02/2010 BEG                                                69310062
693200         WHEN ASC-NO-NBR-MAJCL-DATE-CURSOR                        69320062
693300              EXEC SQL                                            69330062
693400                   FETCH NO-NBR-DEPT-MAJ-DT-CSR                   69340062
693500                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69350062
693600                       , :CEPLRQ-CNSTK-LOC-ID                     69360062
693700                       , :CEPLRQ-SRC-REF-NBR                      69370062
693800                       , :CEPLRQ-SRC-TYP-CDE                      69380062
693900                       , :CEPLRQ-STAT-CDE                         69390062
694000                       , :CEPLST-CRE-TMST                         69400062
694100              END-EXEC                                            69410062
694200                                                                  69420062
694300         WHEN ASC-NO-NBR-SUBCL-DATE-CURSOR                        69430062
694400              EXEC SQL                                            69440062
694500                   FETCH NO-NBR-DEPT-MAJ-SUB-DT-CSR               69450062
694600                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69460062
694700                       , :CEPLRQ-CNSTK-LOC-ID                     69470062
694800                       , :CEPLRQ-SRC-REF-NBR                      69480062
694900                       , :CEPLRQ-SRC-TYP-CDE                      69490062
695000                       , :CEPLRQ-STAT-CDE                         69500062
695100                       , :CEPLST-CRE-TMST                         69510062
695200              END-EXEC                                            69520062
695300                                                                  69530062
695400*TS 08/02/2010 END                                                69540062
695500                                                                  69550062
695600         WHEN ASC-NO-NBR-ALL-DEPT-DATE-CSR                        69560062
695700              EXEC SQL                                            69570062
695800                   FETCH NBR-ALL-DPT-DT-CSR                       69580062
695900                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69590062
696000                       , :CEPLRQ-CNSTK-LOC-ID                     69600062
696100                       , :CEPLRQ-SRC-REF-NBR                      69610062
696200                       , :CEPLRQ-SRC-TYP-CDE                      69620062
696300                       , :CEPLRQ-STAT-CDE                         69630062
696400                       , :CEPLST-CRE-TMST                         69640062
696500              END-EXEC                                            69650062
696600                                                                  69660062
696700*TS 08/02/2010 BEG                                                69670062
696800         WHEN ASC-NBR-ALL-MAJCL-DATE-CSR                          69680062
696900              EXEC SQL                                            69690062
697000                   FETCH NBR-ALL-DPT-MAJ-DT-CSR                   69700062
697100                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69710062
697200                       , :CEPLRQ-CNSTK-LOC-ID                     69720062
697300                       , :CEPLRQ-SRC-REF-NBR                      69730062
697400                       , :CEPLRQ-SRC-TYP-CDE                      69740062
697500                       , :CEPLRQ-STAT-CDE                         69750062
697600                       , :CEPLST-CRE-TMST                         69760062
697700              END-EXEC                                            69770062
697800                                                                  69780062
697900         WHEN ASC-NBR-ALL-SUBCL-DATE-CSR                          69790062
698000              EXEC SQL                                            69800062
698100                   FETCH NBR-ALL-DPT-MAJ-SUB-DT-CSR               69810062
698200                   INTO  :CEPLRQ-CNSTK-REQ-PL-NBR                 69820062
698300                       , :CEPLRQ-CNSTK-LOC-ID                     69830062
698400                       , :CEPLRQ-SRC-REF-NBR                      69840062
698500                       , :CEPLRQ-SRC-TYP-CDE                      69850062
698600                       , :CEPLRQ-STAT-CDE                         69860062
698700                       , :CEPLST-CRE-TMST                         69870062
698800              END-EXEC                                            69880062
698900                                                                  69890062
699000*TS 08/02/2010 END                                                69900062
699100                                                                  69910062
699200     END-EVALUATE.                                                69920062
699300                                                                  69930062
699400     EVALUATE TRUE                                                69940062
699500         WHEN SQLCODE = ZERO                                      69950062
699600              MOVE  CEPLRQ-STAT-CDE     TO  PV-PULL-STATUS        69960062
699700              MOVE  CEPLRQ-SRC-TYP-CDE  TO  PV-PULL-SOURCE        69970062
699800         WHEN SQLCODE = +100                                      69980062
699900              MOVE  SPACES              TO  PV-PULL-STATUS        69990062
700000              MOVE  SPACES              TO  PV-PULL-SOURCE        70000062
700100         WHEN SQLWARN0 NOT = SPACE                                70010062
700200         WHEN SQLCODE NOT = ZERO                                  70020062
700300              MOVE '4310-FETCH-CURSOR'                            70030062
700400                               TO DP013-PARAGRAPH                 70040062
700500              MOVE 'FETCH MESSAGE CURSOR'                         70050062
700600                               TO DP013-MESSAGE-TEXT (1)          70060062
700700              MOVE SQLCA       TO DP013-SQLCA                     70070062
700800              SET DP013-DB2-ABEND                                 70080062
700900                               TO TRUE                            70090062
701000              PERFORM DP013-0000-PROCESS-ABEND                    70100062
701100     END-EVALUATE.                                                70110062
701200                                                                  70120062
701300     IF  SQLCODE EQUAL +100                                       70130062
701400         SET ASC-NO-ITEMS-LEFT-ON-DB                              70140062
701500                                   TO TRUE                        70150062
701600     END-IF.                                                      70160062
701700                                                                  70170062
701800                                                                  70180062
701900*----------------------------------------------------------------*70190062
702000* GET PULL STATUS (LINE LEVEL=0)                                 *70200062
702100*   STAT_CDE = PC-NEW - GETS THE DATE CREATED                    *70210062
702200*   STAT_CDE = CEPLRQ-STAT-CDE - GETS THE CURRENT PULL STATUS    *70220062
702300*----------------------------------------------------------------*70230062
702400 4320-GET-PULL-STATUS.                                            70240062
702500     INITIALIZE  PV-CREATE-TMST                                   70250062
702600                 PV-CREATE-MMDDYY.                                70260062
702700                                                                  70270062
702800     EXEC SQL                                                     70280062
702900         SELECT MAX(CRE_TMST)                                     70290062
703000           INTO :CEPLST-CRE-TMST :PV-NULL-IND-1                   70300062
703100           FROM TCEPLST                                           70310062
703200          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              70320062
703300            AND PL_LNE_NBR        =  :PC-ZERO                     70330062
703400            AND STAT_CDE          =  :PC-NEW                      70340062
703500     END-EXEC                                                     70350062
703600                                                                  70360062
703700     EVALUATE TRUE                                                70370062
703800         WHEN SQLCODE = +0                                        70380062
703900              IF  PV-NULL-IND-1 < +0                              70390062
704000                  MOVE  SPACES           TO  PV-CREATE-TMST       70400062
704100                  MOVE  SPACES           TO  PV-CREATE-MMDDYY     70410062
704200              ELSE                                                70420062
704300                  MOVE  CEPLST-CRE-TMST  TO  PV-CREATE-TMST       70430062
704400                  MOVE  PV-CREATE-MM     TO  PV-CREATE-EDIT-MM    70440062
704500                  MOVE  PV-CREATE-DD     TO  PV-CREATE-EDIT-DD    70450062
704600                  MOVE  PV-CREATE-YY     TO  PV-CREATE-EDIT-YY    70460062
704700                  MOVE  PC-SLASH         TO  PV-CREATE-SLASH-1    70470062
704800                  MOVE  PC-SLASH         TO  PV-CREATE-SLASH-2    70480062
704900              END-IF                                              70490062
705000         WHEN SQLCODE = -904                                      70500062
705100         WHEN SQLCODE = -911                                      70510062
705200         WHEN SQLCODE = -913                                      70520062
705300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    70530062
705400             MOVE '4320-GET-PULL-STATUS'    TO PV-SOFT-PARAGRAPH  70540062
705500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  70550062
705600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     70560062
705700               TO PV-COMMAREA-LENGTH                              70570062
705800             EXEC CICS                                            70580062
705900                  WRITEQ TD                                       70590062
706000                   QUEUE  ('CSSL')                                70600062
706100                    FROM  (PV-CICS-MSG-AREA2)                     70610062
706200                  LENGTH  (PV-COMMAREA-LENGTH)                    70620062
706300                    RESP  (PV-CICS-RESP)                          70630062
706400             END-EXEC                                             70640062
706500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          70650062
706600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              70660062
706700             PERFORM 9900-SOFT-ABORT                              70670062
706800         WHEN OTHER                                               70680062
706900              MOVE '4320-GET-PULL-STATUS'                         70690062
707000                               TO DP013-PARAGRAPH                 70700062
707100              MOVE  DK-PULL-NUMBER  TO  PV-DISPLAY-PULL-NBR       70710062
707200              STRING 'GET PULL CREATE DATE ' DELIMITED BY SIZE    70720062
707300                      'PULL NBR-'            DELIMITED BY SIZE    70730062
707400                      PV-DISPLAY-PULL-NBR    DELIMITED BY SIZE    70740062
707500                             INTO DP013-MESSAGE-TEXT (1)          70750062
707600              MOVE SQLCA       TO DP013-SQLCA                     70760062
707700              MOVE 'TCEPLST '  TO DP013-DB2-TABLE-NAME (1)        70770062
707800              SET DP013-DB2-ABEND                                 70780062
707900                  DP013-XCTL-DISPLAY-RESTART                      70790062
708000                                   TO TRUE                        70800062
708100                  PERFORM DP013-0000-PROCESS-ABEND                70810062
708200     END-EVALUATE.                                                70820062
708300                                                                  70830062
708400                                                                  70840062
708500     INITIALIZE  PV-CREATE-TMST                                   70850062
708600                 PV-STATUS-MMDDYY.                                70860062
708700                                                                  70870062
708800     EXEC SQL                                                     70880062
708900         SELECT MAX(CRE_TMST)                                     70890062
709000           INTO :CEPLST-CRE-TMST :PV-NULL-IND-1                   70900062
709100           FROM TCEPLST                                           70910062
709200          WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER              70920062
709300            AND PL_LNE_NBR        =  :PC-ZERO                     70930062
709400            AND STAT_CDE          =  :CEPLRQ-STAT-CDE             70940062
709500     END-EXEC                                                     70950062
709600                                                                  70960062
709700     EVALUATE TRUE                                                70970062
709800         WHEN SQLCODE = +0                                        70980062
709900              IF  PV-NULL-IND-1 < +0                              70990062
710000                  MOVE  SPACES           TO  PV-CREATE-TMST       71000062
710100                  MOVE  SPACES           TO  PV-STATUS-MMDDYY     71010062
710200              ELSE                                                71020062
710300                  MOVE  CEPLST-CRE-TMST  TO  PV-CREATE-TMST       71030062
710400                  MOVE  PV-CREATE-MM     TO  PV-STATUS-EDIT-MM    71040062
710500                  MOVE  PV-CREATE-DD     TO  PV-STATUS-EDIT-DD    71050062
710600                  MOVE  PV-CREATE-YY     TO  PV-STATUS-EDIT-YY    71060062
710700                  MOVE  PC-SLASH         TO  PV-STATUS-SLASH-1    71070062
710800                  MOVE  PC-SLASH         TO  PV-STATUS-SLASH-2    71080062
710900              END-IF                                              71090062
711000         WHEN SQLCODE = -904                                      71100062
711100         WHEN SQLCODE = -911                                      71110062
711200         WHEN SQLCODE = -913                                      71120062
711300             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    71130062
711400             MOVE '4320-GET-PULL-STATUS'    TO PV-SOFT-PARAGRAPH  71140062
711500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  71150062
711600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     71160062
711700               TO PV-COMMAREA-LENGTH                              71170062
711800             EXEC CICS                                            71180062
711900                  WRITEQ TD                                       71190062
712000                   QUEUE  ('CSSL')                                71200062
712100                    FROM  (PV-CICS-MSG-AREA2)                     71210062
712200                  LENGTH  (PV-COMMAREA-LENGTH)                    71220062
712300                    RESP  (PV-CICS-RESP)                          71230062
712400             END-EXEC                                             71240062
712500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          71250062
712600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              71260062
712700             PERFORM 9900-SOFT-ABORT                              71270062
712800         WHEN OTHER                                               71280062
712900              MOVE '4320-GET-PULL-STATUS'                         71290062
713000                               TO DP013-PARAGRAPH                 71300062
713100              MOVE 'GET PULL STATUS DATE     '                    71310062
713200                               TO DP013-MESSAGE-TEXT (1)          71320062
713300              MOVE SQLCA       TO DP013-SQLCA                     71330062
713400              MOVE 'TCEPLST '  TO DP013-DB2-TABLE-NAME (1)        71340062
713500              SET DP013-DB2-ABEND                                 71350062
713600                  DP013-XCTL-DISPLAY-RESTART                      71360062
713700                                   TO TRUE                        71370062
713800                  PERFORM DP013-0000-PROCESS-ABEND                71380062
713900     END-EVALUATE.                                                71390062
714000                                                                  71400062
714100                                                                  71410062
714200*----------------------------------------------------------------*71420062
714300* GET PULL ITEM QTYS                                             *71430062
714400*----------------------------------------------------------------*71440062
714500 4330-GET-PULL-ITEM.                                              71450062
714600     INITIALIZE  PV-CEPLIT-ITEM-QTY                               71460062
714700                 PV-CEPLIT-REQ-QTY                                71470062
714800                 PV-CEPLIT-ACTL-QTY.                              71480062
714900                                                                  71490062
715000     EXEC SQL                                                     71500062
715100         SELECT  COUNT(*)                                         71510062
715200                ,SUM(PL_REQ_QTY)                                  71520062
715300                ,SUM(ACTL_PL_QTY)                                 71530062
715400           INTO  :PV-CEPLIT-ITEM-QTY                              71540062
715500                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               71550062
715600                ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2               71560062
715700           FROM  TCEPLIT                                          71570062
715800          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             71580062
715900            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    71590062
716000     END-EXEC                                                     71600062
716100                                                                  71610062
716200     EVALUATE TRUE                                                71620062
716300         WHEN SQLCODE = +0                                        71630062
716400              CONTINUE                                            71640062
716500         WHEN SQLCODE = -904                                      71650062
716600         WHEN SQLCODE = -911                                      71660062
716700         WHEN SQLCODE = -913                                      71670062
716800             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    71680062
716900             MOVE '4330-GET-PULL-ITEM  '    TO PV-SOFT-PARAGRAPH  71690062
717000             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  71700062
717100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     71710062
717200               TO PV-COMMAREA-LENGTH                              71720062
717300             EXEC CICS                                            71730062
717400                  WRITEQ TD                                       71740062
717500                   QUEUE  ('CSSL')                                71750062
717600                    FROM  (PV-CICS-MSG-AREA2)                     71760062
717700                  LENGTH  (PV-COMMAREA-LENGTH)                    71770062
717800                    RESP  (PV-CICS-RESP)                          71780062
717900             END-EXEC                                             71790062
718000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          71800062
718100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              71810062
718200             PERFORM 9900-SOFT-ABORT                              71820062
718300         WHEN OTHER                                               71830062
718400              MOVE '4330-GET-PULL-ITEM'                           71840062
718500                               TO DP013-PARAGRAPH                 71850062
718600              MOVE 'GET PULL STATUS ITEM QTYS'                    71860062
718700                               TO DP013-MESSAGE-TEXT (1)          71870062
718800              MOVE SQLCA       TO DP013-SQLCA                     71880062
718900              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        71890062
719000              SET DP013-DB2-ABEND                                 71900062
719100                  DP013-XCTL-DISPLAY-RESTART                      71910062
719200                                   TO TRUE                        71920062
719300                  PERFORM DP013-0000-PROCESS-ABEND                71930062
719400     END-EVALUATE.                                                71940062
719500                                                                  71950062
719600                                                                  71960062
719700*----------------------------------------------------------------*71970062
719800* GET PULL DISTRIBUTION QTY                                      *71980062
719900*----------------------------------------------------------------*71990062
720000 4340-GET-PULL-DISTRO.                                            72000062
720100     INITIALIZE  PV-CEPLDS-DISTRB-QTY.                            72010062
720200                                                                  72020062
720300     EXEC SQL                                                     72030062
720400          SELECT  SUM(B.ACTL_DISTRB_QTY)                          72040062
720500            INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1            72050062
720600            FROM  TCEPLIT A                                       72060062
720700                 ,TCEPLDS B                                       72070062
720800           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           72080062
720900             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        72090062
721000             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              72100062
721100             AND  A.STAT_CDE   IN  ('DS','PD')                    72110062
721200     END-EXEC                                                     72120062
721300                                                                  72130062
721400                                                                  72140062
721500     EVALUATE TRUE                                                72150062
721600         WHEN SQLCODE = +0                                        72160062
721700              CONTINUE                                            72170062
721800         WHEN SQLCODE = -904                                      72180062
721900         WHEN SQLCODE = -911                                      72190062
722000         WHEN SQLCODE = -913                                      72200062
722100             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    72210062
722200             MOVE '4340-GET-PULL-DISTRO'    TO PV-SOFT-PARAGRAPH  72220062
722300             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  72230062
722400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     72240062
722500               TO PV-COMMAREA-LENGTH                              72250062
722600             EXEC CICS                                            72260062
722700                  WRITEQ TD                                       72270062
722800                   QUEUE  ('CSSL')                                72280062
722900                    FROM  (PV-CICS-MSG-AREA2)                     72290062
723000                  LENGTH  (PV-COMMAREA-LENGTH)                    72300062
723100                    RESP  (PV-CICS-RESP)                          72310062
723200             END-EXEC                                             72320062
723300             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          72330062
723400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              72340062
723500             PERFORM 9900-SOFT-ABORT                              72350062
723600         WHEN OTHER                                               72360062
723700              MOVE '4340-GET-PULL-DISTRO'                         72370062
723800                               TO DP013-PARAGRAPH                 72380062
723900              MOVE 'GET PULL DISTRIBTION     '                    72390062
724000                               TO DP013-MESSAGE-TEXT (1)          72400062
724100              MOVE SQLCA       TO DP013-SQLCA                     72410062
724200              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        72420062
724300              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        72430062
724400              SET DP013-DB2-ABEND                                 72440062
724500                  DP013-XCTL-DISPLAY-RESTART                      72450062
724600                                   TO TRUE                        72460062
724700                  PERFORM DP013-0000-PROCESS-ABEND                72470062
724800     END-EVALUATE.                                                72480062
724900                                                                  72490062
725000                                                                  72500062
725100*----------------------------------------------------------------*72510062
725200* GET PULL MANIFESTED QUANTITY                                   *72520062
725300*----------------------------------------------------------------*72530062
725400 4350-GET-PULL-MANIFEST.                                          72540062
725500     INITIALIZE  PV-CEPLMF-MANIF-QTY.                             72550062
725600                                                                  72560062
725700     EXEC SQL                                                     72570062
725800          SELECT  SUM(B.MFST_UNT_QTY)                             72580062
725900            INTO  :PV-CEPLMF-MANIF-QTY :PV-NULL-IND-2             72590062
726000            FROM  TCEPLIT A                                       72600062
726100                 ,TCEPLMF B                                       72610062
726200           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           72620062
726300             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        72630062
726400             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              72640062
726500             AND  A.STAT_CDE         NOT IN ('CA', 'PD')          72650062
726600     END-EXEC                                                     72660062
726700                                                                  72670062
726800                                                                  72680062
726900     EVALUATE TRUE                                                72690062
727000         WHEN SQLCODE = +0                                        72700062
727100              CONTINUE                                            72710062
727200         WHEN SQLCODE = -904                                      72720062
727300         WHEN SQLCODE = -911                                      72730062
727400         WHEN SQLCODE = -913                                      72740062
727500             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    72750062
727600             MOVE '4350-GET-PULL-MANIFEST'  TO PV-SOFT-PARAGRAPH  72760062
727700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  72770062
727800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     72780062
727900               TO PV-COMMAREA-LENGTH                              72790062
728000             EXEC CICS                                            72800062
728100                  WRITEQ TD                                       72810062
728200                   QUEUE  ('CSSL')                                72820062
728300                    FROM  (PV-CICS-MSG-AREA2)                     72830062
728400                  LENGTH  (PV-COMMAREA-LENGTH)                    72840062
728500                    RESP  (PV-CICS-RESP)                          72850062
728600             END-EXEC                                             72860062
728700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          72870062
728800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              72880062
728900             PERFORM 9900-SOFT-ABORT                              72890062
729000         WHEN OTHER                                               72900062
729100              MOVE '4350-GET-PULL-MANIFEST'                       72910062
729200                               TO DP013-PARAGRAPH                 72920062
729300              MOVE 'GET PULL MANIFESTED QTY  '                    72930062
729400                               TO DP013-MESSAGE-TEXT (1)          72940062
729500              MOVE SQLCA       TO DP013-SQLCA                     72950062
729600              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        72960062
729700              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (2)        72970062
729800              SET DP013-DB2-ABEND                                 72980062
729900                  DP013-XCTL-DISPLAY-RESTART                      72990062
730000                                   TO TRUE                        73000062
730100                  PERFORM DP013-0000-PROCESS-ABEND                73010062
730200     END-EVALUATE.                                                73020062
730300                                                                  73030062
730400*----------------------------------------------------------------*73040062
730500* GET PULL ADJUSTED QUANTITY                                     *73050062
730600*----------------------------------------------------------------*73060062
730700 4360-GET-PULL-ADJUST.                                            73070062
730800     INITIALIZE  PV-CEPLAU-ADJUST-QTY.                            73080062
730900                                                                  73090062
731000     EXEC SQL                                                     73100062
731100          SELECT  SUM(B.AFT_ADJ_UNT_QTY - B.BEF_ADJ_UNT_QTY)      73110062
731200            INTO  :PV-CEPLAU-ADJUST-QTY :PV-NULL-IND-3            73120062
731300            FROM  TCEPLIT A                                       73130062
731400                 ,TCEPLAU B                                       73140062
731500           WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER           73150062
731600             AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR        73160062
731700             AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR              73170062
731800             AND  A.STAT_CDE         NOT IN ('CA', 'PD')          73180062
731900     END-EXEC                                                     73190062
732000                                                                  73200062
732100                                                                  73210062
732200     EVALUATE TRUE                                                73220062
732300         WHEN SQLCODE = +0                                        73230062
732400              CONTINUE                                            73240062
732500         WHEN SQLCODE = -904                                      73250062
732600         WHEN SQLCODE = -911                                      73260062
732700         WHEN SQLCODE = -913                                      73270062
732800             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    73280062
732900             MOVE '4360-GET-PULL-ADJUST'    TO PV-SOFT-PARAGRAPH  73290062
733000             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  73300062
733100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     73310062
733200               TO PV-COMMAREA-LENGTH                              73320062
733300             EXEC CICS                                            73330062
733400                  WRITEQ TD                                       73340062
733500                   QUEUE  ('CSSL')                                73350062
733600                    FROM  (PV-CICS-MSG-AREA2)                     73360062
733700                  LENGTH  (PV-COMMAREA-LENGTH)                    73370062
733800                    RESP  (PV-CICS-RESP)                          73380062
733900             END-EXEC                                             73390062
734000             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          73400062
734100             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              73410062
734200             PERFORM 9900-SOFT-ABORT                              73420062
734300         WHEN OTHER                                               73430062
734400              MOVE '4360-GET-PULL-ADJUST'                         73440062
734500                               TO DP013-PARAGRAPH                 73450062
734600              MOVE 'GET PULL ADJUSTMENT QTY  '                    73460062
734700                               TO DP013-MESSAGE-TEXT (1)          73470062
734800              MOVE SQLCA       TO DP013-SQLCA                     73480062
734900              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        73490062
735000              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (2)        73500062
735100              SET DP013-DB2-ABEND                                 73510062
735200                  DP013-XCTL-DISPLAY-RESTART                      73520062
735300                                   TO TRUE                        73530062
735400                  PERFORM DP013-0000-PROCESS-ABEND                73540062
735500     END-EVALUATE.                                                73550062
735600                                                                  73560062
735700                                                                  73570062
735800*----------------------------------------------------------------*73580062
735900* CHECK IF ROWS EXIST ON TCEPLMF                                 *73590062
736000*----------------------------------------------------------------*73600062
736100 4365-GET-TCEPLMF.                                                73610062
736200                                                                  73620062
736300     INITIALIZE  PV-TCEPLMF-COUNT.                                73630062
736400     MOVE  ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)             73640062
736500       TO  DK-PULL-NUMBER.                                        73650062
736600                                                                  73660062
736700     EXEC SQL                                                     73670062
736800          SELECT COUNT(*)                                         73680062
736900            INTO :PV-TCEPLMF-COUNT                                73690062
737000            FROM TCEPLMF                                          73700062
737100           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             73710062
737200     END-EXEC.                                                    73720062
737300                                                                  73730062
737400     EVALUATE TRUE                                                73740062
737500         WHEN SQLCODE = +0                                        73750062
737600         WHEN SQLCODE = +100                                      73760062
737700              CONTINUE                                            73770062
737800                                                                  73780062
737900         WHEN OTHER                                               73790062
738000              MOVE '4365-GET-TCEPLMF     '    TO DP013-PARAGRAPH  73800062
738100              MOVE 'COUNT ENTRIES IN TCEPLMF        '             73810062
738200                                       TO DP013-MESSAGE-TEXT (1)  73820062
738300              STRING ' PULL NBR-'    DELIMITED BY SIZE            73830062
738400                      ASC-PULL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)  73840062
738500                                     DELIMITED BY SIZE            73850062
738600                                     INTO DP013-MESSAGE-TEXT (2)  73860062
738700              MOVE SQLCA                      TO DP013-SQLCA      73870062
738800              MOVE 'TCEPLMF '        TO DP013-DB2-TABLE-NAME (1)  73880062
738900              SET  DP013-DB2-ABEND                                73890062
739000                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            73900062
739100              PERFORM DP013-0000-PROCESS-ABEND                    73910062
739200     END-EVALUATE.                                                73920062
739300                                                                  73930062
739400                                                                  73940062
739500*----------------------------------------------------------------*73950062
739600* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *73960062
739700*----------------------------------------------------------------*73970062
739800                                                                  73980062
739900 4400-MOVE-COMMAREA-TO-SCREEN.                                    73990062
740000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             74000062
740100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          74010062
740200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          74020062
740300             MOVE +1    TO ASC-BLK-SUB                            74030062
740400             PERFORM 5100-WRITE-TEMP-STORAGE                      74040062
740500             ADD +1     TO ASC-BLK-SUB                            74050062
740600             PERFORM 5100-WRITE-TEMP-STORAGE                      74060062
740700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             74070062
740800                 GIVING PV-BLOCK-NUMBER                           74080062
740900                 REMAINDER PV-REMAINDER                           74090062
741000             IF  PV-REMAINDER > ZERO                              74100062
741100                 ADD +1 TO PV-BLOCK-NUMBER                        74110062
741200             END-IF                                               74120062
741300             MOVE +1    TO ASC-BLK-SUB                            74130062
741400             PERFORM 4410-READ-TEMP-STORAGE                       74140062
741500             ADD +1     TO ASC-BLK-SUB                            74150062
741600                           PV-BLOCK-NUMBER                        74160062
741700             PERFORM 4410-READ-TEMP-STORAGE                       74170062
741800     END-IF.                                                      74180062
741900     MOVE +1            TO ASC-BLK-SUB.                           74190062
742000     COMPUTE ASC-ITEM-SUB =                                       74200062
742100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              74210062
742200         + PC-ITEMS-PER-PANEL).                                   74220062
742300*                                                                 74230062
742400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        74240062
742500         ADD +1         TO ASC-BLK-SUB                            74250062
742600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            74260062
742700     END-IF.                                                      74270062
742800*                                                                 74280062
742900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           74290062
743000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                74300062
743100     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        74310062
743200     PERFORM 4420-FORMAT-LIST-LINES                               74320062
743300         VARYING PV-SUB                                           74330062
743400         FROM PC-ITEMS-PER-PANEL BY -1                            74340062
743500         UNTIL PV-SUB < +1.                                       74350062
743600*                                                                 74360062
743700     COMPUTE ASC-ITEMS-DISPLAYED =                                74370062
743800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          74380062
743900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    74390062
744000                                      ASTRTITO.                   74400062
744100     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    74410062
744200     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    74420062
744300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            74430062
744400                                   TO ASELITO.                    74440062
744500*                                                                 74450062
744600     IF  ASC-CS-LOC  =  PC-ALL                                    74460062
744700         MOVE ASC-CS-LOC             TO ALOCIDO                   74470062
744800     ELSE                                                         74480062
744900         MOVE ASC-CS-LOC-N           TO PV-4-DIGIT-STORE          74490062
745000         MOVE PV-4-DIGIT-STORE       TO ALOCIDO                   74500062
745100     END-IF.                                                      74510062
745200                                                                  74520062
745300     MOVE ASC-CS-PRINTER-ID          TO APRTIDO.                  74530062
745400     MOVE ASC-PULL-SELECT-STATUS     TO APULSTO.                  74540062
745500                                                                  74550062
745600     EVALUATE TRUE                                                74560062
745700         WHEN ASC-SELECT-ALL                                      74570062
745800              MOVE PC-ALL-DESC              TO APLDESO            74580062
745900         WHEN ASC-SELECT-CNCLD                                    74590062
746000              MOVE PC-PULL-STATUS-CANCELLED TO APLDESO            74600062
746100         WHEN ASC-SELECT-DSTRB                                    74610062
746200              MOVE PC-DISTRIB-DESC          TO APLDESO            74620062
746300         WHEN ASC-SELECT-INPROC                                   74630062
746400              MOVE PC-IN-PROCESS-DESC       TO APLDESO            74640062
746500         WHEN ASC-SELECT-NEW                                      74650062
746600              MOVE PC-NEW-DESC              TO APLDESO            74660062
746700         WHEN ASC-SELECT-POSTD                                    74670062
746800              MOVE PC-POSTED-DESC           TO APLDESO            74680062
746900         WHEN ASC-SELECT-NEW-INPROC                               74690062
747000              MOVE PC-NEW-INPROC-DESC       TO APLDESO            74700062
747100     END-EVALUATE.                                                74710062
747200                                                                  74720062
747300     MOVE ASC-FROM-MM                TO PV-SELECT-FROM-EDIT-MM.   74730062
747400     MOVE PC-SLASH                   TO PV-SELECT-FROM-SLASH-1.   74740062
747500     MOVE ASC-FROM-DD                TO PV-SELECT-FROM-EDIT-DD.   74750062
747600     MOVE PC-SLASH                   TO PV-SELECT-FROM-SLASH-2.   74760062
747700     MOVE ASC-FROM-YY                TO PV-SELECT-FROM-EDIT-YY.   74770062
747800     MOVE PV-SELECT-FROM-DATE        TO AFROMDTO.                 74780062
747900     MOVE ASC-TO-MM                  TO PV-SELECT-FROM-EDIT-MM.   74790062
748000     MOVE PC-SLASH                   TO PV-SELECT-FROM-SLASH-1.   74800062
748100     MOVE ASC-TO-DD                  TO PV-SELECT-FROM-EDIT-DD.   74810062
748200     MOVE PC-SLASH                   TO PV-SELECT-FROM-SLASH-2.   74820062
748300     MOVE ASC-TO-YY                  TO PV-SELECT-FROM-EDIT-YY.   74830062
748400     MOVE PV-SELECT-FROM-DATE        TO ATODATEO.                 74840062
748500     MOVE ASC-SELECT-LIST-SEQUENCE   TO ALSTSQO.                  74850062
748600                                                                  74860062
748700     EVALUATE TRUE                                                74870062
748800         WHEN ASC-LIST-SEQ-PL-NBR                                 74880062
748900              MOVE PC-PULL-NBR-SEQ-DESC     TO ASQDESO            74890062
749000         WHEN ASC-LIST-SEQ-CR-DTE                                 74900062
749100              MOVE PC-CRTE-DTE-SEQ-DESC     TO ASQDESO            74910062
749200     END-EVALUATE.                                                74920062
749300                                                                  74930062
749400*TS 08/02/2010 BEG                                                74940062
749500     IF  ASC-REF-NBR   >  SPACES  AND                             74950062
749600         ASC-DEPT-NBR  >  SPACES  AND                             74960062
749700         ASC-MAJ-CLASS >  SPACES  AND                             74970062
749800         ASC-SUB-CLASS >  SPACES                                  74980062
749900         MOVE  PC-RQSTD-REF-DEPT     TO AREQDESO                  74990062
750000         INITIALIZE  PV-REF-DEPT-HOLD                             75000062
750100         MOVE  ASC-REF-NBR           TO PV-REF-HOLD               75010062
750200         MOVE  ASC-DEPT-NBR          TO PV-DEPT-HOLD              75020062
750300         MOVE  PV-REF-DEPT-HOLD      TO AREFNOO                   75030062
750400     ELSE                                                         75040062
750500     IF  ASC-REF-NBR   >  SPACES  AND                             75050062
750600         ASC-DEPT-NBR  >  SPACES  AND                             75060062
750700         ASC-MAJ-CLASS >  SPACES                                  75070062
750800         MOVE  PC-RQSTD-REF-DEPT     TO AREQDESO                  75080062
750900         INITIALIZE  PV-REF-DEPT-HOLD                             75090062
751000         MOVE  ASC-REF-NBR           TO PV-REF-HOLD               75100062
751100         MOVE  ASC-DEPT-NBR          TO PV-DEPT-HOLD              75110062
751200         MOVE  PV-REF-DEPT-HOLD      TO AREFNOO                   75120062
751300     ELSE                                                         75130062
751400     IF  ASC-DEPT-NBR  >  SPACES  AND                             75140062
751500         ASC-MAJ-CLASS >  SPACES  AND                             75150062
751600         ASC-SUB-CLASS >  SPACES                                  75160062
751700         INITIALIZE  PV-DEPT-MAJ-SUB-HOLD                         75170062
751800         MOVE  PC-RQSTD-DEPT-MJ-SUB        TO AREQDESO            75180062
751900         MOVE  ASC-DEPT-NBR                TO PV-DEPT-HOLD3       75190062
752000         MOVE  ASC-MAJ-CLASS               TO PV-MAJ-HOLD3        75200062
752100         MOVE  ASC-SUB-CLASS               TO PV-SUB-HOLD3        75210062
752200         MOVE  PV-DEPT-MAJ-SUB-HOLD        TO AREFNOO             75220062
752300     ELSE                                                         75230062
752400     IF  ASC-DEPT-NBR  >  SPACES  AND                             75240062
752500         ASC-MAJ-CLASS >  SPACES                                  75250062
752600         INITIALIZE  PV-DEPT-MAJ-HOLD                             75260062
752700         MOVE  PC-RQSTD-DEPT-MJ            TO AREQDESO            75270062
752800         MOVE  ASC-DEPT-NBR                TO PV-DEPT-HOLD4       75280062
752900         MOVE  ASC-MAJ-CLASS               TO PV-MAJ-HOLD4        75290062
753000         MOVE  PV-DEPT-MAJ-HOLD            TO AREFNOO             75300062
753100     ELSE                                                         75310062
753200*TS 08/02/2010 END                                                75320062
753300     IF  ASC-REF-NBR   >  SPACES  AND                             75330062
753400         ASC-DEPT-NBR  >  SPACES                                  75340062
753500         MOVE  PC-RQSTD-REF-DEPT     TO AREQDESO                  75350062
753600         INITIALIZE  PV-REF-DEPT-HOLD                             75360062
753700         MOVE  ASC-REF-NBR           TO PV-REF-HOLD               75370062
753800         MOVE  ASC-DEPT-NBR          TO PV-DEPT-HOLD              75380062
753900         MOVE  PV-REF-DEPT-HOLD      TO AREFNOO                   75390062
754000     ELSE                                                         75400062
754100     IF  ASC-DEPT-NBR  >  SPACES                                  75410062
754200         MOVE  PC-RQSTD-DEPT         TO AREQDESO                  75420062
754300         MOVE  ASC-DEPT-NBR          TO AREFNOO                   75430062
754400     ELSE                                                         75440062
754500         MOVE  PC-RQSTD-REF          TO AREQDESO                  75450062
754600         MOVE  ASC-REF-NBR           TO AREFNOO                   75460062
754700*TS 08/02/2010 BEG                                                75470062
754800     END-IF                                                       75480062
754900     END-IF                                                       75490062
755000     END-IF                                                       75500062
755100     END-IF                                                       75510062
755200*TS 08/02/2010 END                                                75520062
755300     END-IF                                                       75530062
755400     END-IF.                                                      75540062
755500                                                                  75550062
755600*                                                                 75560062
755700     IF  DP020-MSG-NUMBER-X = SPACE                               75570062
755800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  75580062
755900*            --- MORE ITEMS TO DISPLAY ----                       75590062
756000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            75600062
756100             SET DP020-MSG-INFORMATIONAL TO TRUE                  75610062
756200         END-IF                                                   75620062
756300     END-IF.                                                      75630062
756400*----------------------------------------------------------------*75640062
756500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *75650062
756600*----------------------------------------------------------------*75660062
756700                                                                  75670062
756800 4410-READ-TEMP-STORAGE.                                          75680062
756900                                                                  75690062
757000     EXEC CICS                                                    75700062
757100         READQ TS                                                 75710062
757200             QUEUE (ASC-LIST-QUEUE-NAME)                          75720062
757300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               75730062
757400             ITEM  (PV-BLOCK-NUMBER)                              75740062
757500             RESP  (PV-CICS-RESP)                                 75750062
757600     END-EXEC.                                                    75760062
757700                                                                  75770062
757800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       75780062
757900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     75790062
758000         CONTINUE                                                 75800062
758100     ELSE                                                         75810062
758200         SET DP013-CICS-ABEND     TO TRUE                         75820062
758300         SET DP013-NO-ROLLBACK    TO TRUE                         75830062
758400         MOVE '4410-READ-TEMP-STORAGE'                            75840062
758500                                  TO DP013-PARAGRAPH              75850062
758600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      75860062
758700                                  TO DP013-MESSAGE-TEXT(1)        75870062
758800         PERFORM DP013-0000-PROCESS-ABEND                         75880062
758900     END-IF.                                                      75890062
759000                                                                  75900062
759100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             75910062
759200*                                                                 75920062
759300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         75930062
759400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               75940062
759500     END-IF.                                                      75950062
759600 EJECT                                                            75960062
759700*----------------------------------------------------------------*75970062
759800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *75980062
759900*----------------------------------------------------------------*75990062
760000                                                                  76000062
760100 4420-FORMAT-LIST-LINES.                                          76010062
760200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      76020062
760300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                76030062
760400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           76040062
760500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           76050062
760600         MOVE SPACE              TO MR-SELECTI (PV-SUB)           76060062
760700                                    MR-ACTION (PV-SUB)            76070062
760800                                    MR-CREATE-DATE (PV-SUB)       76080062
760900                                    MR-PULL-STATUS (PV-SUB)       76090062
761000                                    MR-PULL-SOURCE (PV-SUB)       76100062
761100                                    MR-STATUS-DATE (PV-SUB)       76110062
761200                                    MR-DISTRBUTED-UNITS (PV-SUB)  76120062
761300                                                                  76130062
761400         MOVE ZEROES             TO MR-PULL-NUMBER (PV-SUB)       76140062
761500                                    MR-CS-LOCATION (PV-SUB)       76150062
761600                                    MR-NBR-ITEMS (PV-SUB)         76160062
761700                                    MR-REQ-PULL-UNITS (PV-SUB)    76170062
761800                                    MR-VARIANCE-UNITS (PV-SUB)    76180062
761900     ELSE                                                         76190062
762000         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      76200062
762100                                                   > SPACE        76210062
762200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 76220062
762300                                 TO MR-SELECTI (PV-SUB)           76230062
762400         ELSE                                                     76240062
762500             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      76250062
762600                                 TO MR-SELECTI (PV-SUB)           76260062
762700         END-IF                                                   76270062
762800*                                                                 76280062
762900         IF  DP030-SET-CURSOR-TRAILER                             76290062
763000             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)76300062
763100                 > SPACE)                                         76310062
763200               OR (PV-SUB = 1))                                   76320062
763300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               76330062
763400                MOVE -1          TO MR-SELECTL (PV-SUB)           76340062
763500             END-IF                                               76350062
763600         END-IF                                                   76360062
763700*                                                                 76370062
763800         MOVE ASC-PULL-NUMBER    (ASC-BLK-SUB ASC-ITEM-SUB)       76380062
763900                                 TO  DK-PULL-NUMBER               76390062
764000         PERFORM 4730-LINE-STATUS                                 76400062
764100         MOVE  PV-PULL-STATUS                                     76410062
764200           TO  ASC-PULL-STATUS-CDE (ASC-BLK-SUB ASC-ITEM-SUB)     76420062
764300         EVALUATE  TRUE                                           76430062
764400             WHEN  PV-PULL-STATUS-NEW                             76440062
764500                   MOVE  PC-NEW-DESC                              76450062
764600                     TO  ASC-PULL-STATUS-DESC                     76460062
764700                         (ASC-BLK-SUB ASC-ITEM-SUB)               76470062
764800             WHEN  PV-PULL-STATUS-CANCELLED                       76480062
764900                   MOVE  PC-PULL-STATUS-CANCELLED                 76490062
765000                     TO  ASC-PULL-STATUS-DESC                     76500062
765100                         (ASC-BLK-SUB ASC-ITEM-SUB)               76510062
765200             WHEN  PV-PULL-STATUS-INPROCESS                       76520062
765300                  MOVE  PC-IN-PROCESS-DESC                        76530062
765400                     TO  ASC-PULL-STATUS-DESC                     76540062
765500                         (ASC-BLK-SUB ASC-ITEM-SUB)               76550062
765600             WHEN  PV-PULL-STATUS-DISTRIBTD                       76560062
765700                   MOVE  PC-DISTRIB-DESC                          76570062
765800                     TO  ASC-PULL-STATUS-DESC                     76580062
765900                         (ASC-BLK-SUB ASC-ITEM-SUB)               76590062
766000             WHEN  PV-PULL-STATUS-POSTED                          76600062
766100                   MOVE  PC-POSTED-DESC                           76610062
766200                     TO  ASC-PULL-STATUS-DESC                     76620062
766300                         (ASC-BLK-SUB ASC-ITEM-SUB)               76630062
766400         END-EVALUATE                                             76640062
766500*                                                                 76650062
766600         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               76660062
766700                                 TO MR-ACTION (PV-SUB)            76670062
766800         MOVE ASC-PULL-NUMBER    (ASC-BLK-SUB ASC-ITEM-SUB)       76680062
766900                                 TO MR-PULL-NUMBER (PV-SUB)       76690062
767000                                    DK-PULL-NUMBER                76700062
767100         MOVE ASC-CS-LOCATION    (ASC-BLK-SUB ASC-ITEM-SUB)       76710062
767200                                 TO MR-CS-LOCATION (PV-SUB)       76720062
767300         MOVE ASC-CREATE-DATE    (ASC-BLK-SUB ASC-ITEM-SUB)       76730062
767400                                 TO MR-CREATE-DATE (PV-SUB)       76740062
767500         MOVE ASC-PULL-STATUS-DESC (ASC-BLK-SUB ASC-ITEM-SUB)     76750062
767600                                 TO MR-PULL-STATUS (PV-SUB)       76760062
767700         MOVE ASC-STATUS-DATE    (ASC-BLK-SUB ASC-ITEM-SUB)       76770062
767800                                 TO MR-STATUS-DATE (PV-SUB)       76780062
767900         MOVE ASC-PULL-SOURCE-DESC  (ASC-BLK-SUB ASC-ITEM-SUB)    76790062
768000                                 TO MR-PULL-SOURCE (PV-SUB)       76800062
768100         PERFORM 4330-GET-PULL-ITEM                               76810062
768200         MOVE PV-CEPLIT-ITEM-QTY                                  76820062
768300                                 TO ASC-NBR-ITEMS                 76830062
768400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76840062
768500         MOVE PV-CEPLIT-REQ-QTY                                   76850062
768600                                 TO ASC-REQ-PULL-UNITS            76860062
768700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76870062
768800         MOVE PV-CEPLIT-ACTL-QTY                                  76880062
768900                                 TO ASC-ACT-PULL-UNITS            76890062
769000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76900062
769100         MOVE ASC-NBR-ITEMS      (ASC-BLK-SUB ASC-ITEM-SUB)       76910062
769200                                 TO MR-NBR-ITEMS   (PV-SUB)       76920062
769300         MOVE ASC-REQ-PULL-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)       76930062
769400                                 TO MR-REQ-PULL-UNITS (PV-SUB)    76940062
769500         PERFORM 4340-GET-PULL-DISTRO                             76950062
769600         PERFORM 4350-GET-PULL-MANIFEST                           76960062
769700         PERFORM 4360-GET-PULL-ADJUST                             76970062
769800         COMPUTE PV-COMPUTE-DISTRB-QTY =                          76980062
769900                 (PV-CEPLDS-DISTRB-QTY +                          76990062
770000                  PV-CEPLMF-MANIF-QTY  +                          77000062
770100                  PV-CEPLAU-ADJUST-QTY)                           77010062
770200         IF  PV-NULL-IND-1  < + 0  AND                            77020062
770300             PV-NULL-IND-2  < + 0  AND                            77030062
770400             PV-NULL-IND-3  < + 0                                 77040062
770500             MOVE  SPACES     TO  ASC-DISTRBUTED-UNITS            77050062
770600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77060062
770700             MOVE  ZEROES     TO  ASC-DISTRB-UNTS-NUM             77070062
770800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77080062
770900         ELSE                                                     77090062
771000             MOVE  PV-COMPUTE-DISTRB-QTY                          77100062
771100                              TO  PV-NUMERIC-DISTRB-QTY           77110062
771200                                  ASC-DISTRB-UNTS-NUM             77120062
771300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77130062
771400             MOVE  PV-NUMERIC-DISTRB-QTY                          77140062
771500                              TO  ASC-DISTRBUTED-UNITS            77150062
771600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77160062
771700         END-IF                                                   77170062
771800         MOVE ASC-DISTRBUTED-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)     77180062
771900                                 TO MR-DISTRBUTED-UNITS(PV-SUB)   77190062
772000                                                                  77200062
772100         MOVE  ASC-REQ-PULL-UNITS  (ASC-BLK-SUB ASC-ITEM-SUB)     77210062
772200           TO  PV-REQ-PULL-UNITS                                  77220062
772300         IF  ASC-DISTRB-UNTS-NUM (ASC-BLK-SUB ASC-ITEM-SUB) = +0  77230062
772400             MOVE  ZEROES        TO ASC-VARIANCE-UNITS            77240062
772500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77250062
772600         ELSE                                                     77260062
772700             SUBTRACT PV-REQ-PULL-UNITS                           77270062
772800                 FROM ASC-DISTRB-UNTS-NUM                         77280062
772900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77290062
773000               GIVING ASC-VARIANCE-UNITS                          77300062
773100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77310062
773200         END-IF                                                   77320062
773300                                                                  77330062
773400         MOVE ASC-VARIANCE-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)       77340062
773500                                 TO MR-VARIANCE-UNITS (PV-SUB)    77350062
773600* DMH 12/15/00 - BEGIN                                            77360062
773700         EVALUATE  TRUE                                           77370062
773800             WHEN  PV-PULL-STATUS-NEW                             77380062
773900             WHEN  PV-PULL-STATUS-INPROCESS                       77390062
774000                   PERFORM 4365-GET-TCEPLMF                       77400062
774100                   IF  PV-TCEPLMF-COUNT  >  0                     77410062
774200                       MOVE 'Y' TO ASC-IN-TCEPLMF                 77420062
774300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77430062
774400                       MOVE DP015-YELLOW                          77440062
774500                                       TO MR-PULL-STATUSC(PV-SUB) 77450062
774600                   ELSE                                           77460062
774700                       MOVE 'N' TO ASC-IN-TCEPLMF                 77470062
774800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77480062
774900                   END-IF                                         77490062
775000             WHEN OTHER                                           77500062
775100                  MOVE 'N' TO ASC-IN-TCEPLMF                      77510062
775200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 77520062
775300         END-EVALUATE                                             77530062
775400* DMH 12/15/00 - END                                              77540062
775500     END-IF.                                                      77550062
775600     SUBTRACT +1 FROM ASC-ITEM-SUB                                77560062
775700     IF  ASC-ITEM-SUB < + 1                                       77570062
775800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  77580062
775900         MOVE +1                 TO ASC-BLK-SUB                   77590062
776000     END-IF.                                                      77600062
776100******************************************************************77610062
776200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **77620062
776300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **77630062
776400** ISSUE A WARNING.                                             **77640062
776500******************************************************************77650062
776600 4430-CHECK-FOR-BEGIN-AND-END.                                    77660062
776700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       77670062
776800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     77680062
776900*            -- NO END-OF-RANGE SPECFIED ---                      77690062
777000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            77700062
777100             SET DP020-MSG-WARNING TO TRUE                        77710062
777200             PERFORM 4431-POSITION-AT-WARNING                     77720062
777300         END-IF                                                   77730062
777400     ELSE                                                         77740062
777500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     77750062
777600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                77760062
777700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            77770062
777800             SET DP020-MSG-WARNING TO TRUE                        77780062
777900             PERFORM 4431-POSITION-AT-WARNING                     77790062
778000         END-IF                                                   77800062
778100     END-IF.                                                      77810062
778200******************************************************************77820062
778300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **77830062
778400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **77840062
778500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **77850062
778600** POSITION THE CURSOR THERE.                                   **77860062
778700******************************************************************77870062
778800 4431-POSITION-AT-WARNING.                                        77880062
778900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 77890062
779000                    - PV-TOP-ITEM + 1.                            77900062
779100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      77910062
779200         CONTINUE                                                 77920062
779300     ELSE                                                         77930062
779400         SET DP030-SET-CURSOR-APPL-1                              77940062
779500                                   TO TRUE                        77950062
779600         MOVE -1                   TO MR-SELECTL (PV-SUB)         77960062
779700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         77970062
779800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         77980062
779900     END-IF.                                                      77990062
780000*                                                                 78000062
780100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   78010062
780200                    - PV-TOP-ITEM + 1.                            78020062
780300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      78030062
780400         CONTINUE                                                 78040062
780500     ELSE                                                         78050062
780600         SET DP030-SET-CURSOR-APPL-1                              78060062
780700                                   TO TRUE                        78070062
780800         MOVE -1                   TO MR-SELECTL (PV-SUB)         78080062
780900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         78090062
781000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         78100062
781100     END-IF.                                                      78110062
781200                                                                  78120062
781300                                                                  78130062
781400*----------------------------------------------------------------*78140062
781500*  PRINT PULL FUNCTION                                           *78150062
781600*----------------------------------------------------------------*78160062
781700 4600-PROCESS-PRINT-FUNCTION.                                     78170062
781800                                                                  78180062
781900     MOVE +1                       TO ASC-BLK-SUB.                78190062
782000     PERFORM 5100-WRITE-TEMP-STORAGE.                             78200062
782100     ADD +1                        TO ASC-BLK-SUB.                78210062
782200     PERFORM 5100-WRITE-TEMP-STORAGE.                             78220062
782300                                                                  78230062
782400     PERFORM 6112-READ-LIST-QUEUE.                                78240062
782500                                                                  78250062
782600     SET  LQW-IDX  TO   1.                                        78260062
782700                                                                  78270062
782800     IF PS-NO-SOFT-ABORT-ERROR                                    78280062
782900       IF PV-CICS-RESP = DFHRESP (NORMAL)                         78290062
783000         PERFORM                                                  78300062
783100         VARYING LQW-IDX  FROM 1 BY 1                             78310062
783200         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     78320062
783300            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            78330062
783400            OR   PS-SOFT-ABORT-ERROR                              78340062
783500            OR   PS-ERROR                                         78350062
783600             IF  LQW-SELECT (LQW-IDX)                             78360062
783700                 PERFORM 4605-PROCESS-SELECTED-LINES              78370062
783800             END-IF                                               78380062
783900         END-PERFORM                                              78390062
784000       END-IF                                                     78400062
784100     END-IF.                                                      78410062
784200                                                                  78420062
784300     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           78430062
784400     PERFORM 6111-WRITE-LIST-QUEUE.                               78440062
784500                                                                  78450062
784600     MOVE +1                     TO  ASC-BLK-SUB.                 78460062
784700     PERFORM 4410-READ-TEMP-STORAGE.                              78470062
784800                                                                  78480062
784900     ADD +1                      TO  ASC-BLK-SUB                  78490062
785000                                     PV-BLOCK-NUMBER.             78500062
785100                                                                  78510062
785200     PERFORM 4410-READ-TEMP-STORAGE.                              78520062
785300                                                                  78530062
785400                                                                  78540062
785500*----------------------------------------------------------------*78550062
785600*                                                                *78560062
785700*----------------------------------------------------------------*78570062
785800 4605-PROCESS-SELECTED-LINES.                                     78580062
785900                                                                  78590062
786000     PERFORM 4620-PROCESS-LINES.                                  78600062
786100                                                                  78610062
786200     IF  PS-NO-ERROR                                              78620062
786300         EVALUATE TRUE                                            78630062
786400             WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)          78640062
786500                  SET DP020-MSG-INFORMATIONAL  TO  TRUE           78650062
786600                  MOVE PC-TSYMSG-02234  TO  DP020-MSG-NUMBER      78660062
786700         END-EVALUATE                                             78670062
786800     END-IF.                                                      78680062
786900                                                                  78690062
787000                                                                  78700062
787100*----------------------------------------------------------------*78710062
787200*                                                                *78720062
787300*                                                                *78730062
787400*----------------------------------------------------------------*78740062
787500 4620-PROCESS-LINES.                                              78750062
787600                                                                  78760062
787700     MOVE LQW-PULL-NUMBER (LQW-IDX)      TO PV-PULL-NUMBER.       78770062
787800     MOVE LQW-REF-NUMBER (LQW-IDX)       TO PV-REF-NUMBER.        78780062
787900     MOVE LQW-CS-LOCATION (LQW-IDX)      TO PV-CS-LOCATION.       78790062
788000     MOVE LQW-CREATE-DATE (LQW-IDX)      TO PV-CREATE-DATE.       78800062
788100     MOVE LQW-PULL-STATUS-CDE (LQW-IDX)  TO PV-PULL-STATUS-CDE.   78810062
788200     MOVE LQW-PULL-STATUS-DESC (LQW-IDX) TO PV-PULL-STATUS-DESC.  78820062
788300     MOVE LQW-STATUS-DATE (LQW-IDX)      TO PV-STATUS-DATE.       78830062
788400     MOVE LQW-PULL-SOURCE-CDE (LQW-IDX)  TO PV-PULL-SOURCE-CDE.   78840062
788500     MOVE LQW-PULL-SOURCE-DESC (LQW-IDX) TO PV-PULL-SOURCE-DESC.  78850062
788600     MOVE LQW-NBR-ITEMS (LQW-IDX)        TO PV-NBR-ITEMS.         78860062
788700     MOVE LQW-REQ-PULL-UNITS (LQW-IDX)   TO PV-REQ-PULL-UNITS.    78870062
788800     MOVE LQW-ACT-PULL-UNITS (LQW-IDX)   TO PV-ACT-PULL-UNITS.    78880062
788900     MOVE LQW-DISTRBUTED-UNITS (LQW-IDX) TO PV-DISTRBUTED-UNITS.  78890062
789000                                                                  78900062
789100     IF  PS-NO-ERROR                                              78910062
789200         IF  LQW-SELECT (LQW-IDX)                                 78920062
789300                 PERFORM 4630-ISSUE-PRINT-REQ                     78930062
789400         END-IF                                                   78940062
789500     END-IF.                                                      78950062
789600                                                                  78960062
789700                                                                  78970062
789800     IF  PS-NO-ERROR                                              78980062
789900         SET  LQW-DESELECT (LQW-IDX)                              78990062
790000              LQW-PRT (LQW-IDX)        TO  TRUE                   79000062
790100         SUBTRACT  1                                              79010062
790200             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   79020062
790300         MOVE LQW-SELECTED-SW (LQW-IDX)                           79030062
790400                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   79040062
790500     END-IF.                                                      79050062
790600                                                                  79060062
790700                                                                  79070062
790800*----------------------------------------------------------------*79080062
790900*                                                                *79090062
791000*----------------------------------------------------------------*79100062
791100 4630-ISSUE-PRINT-REQ.                                            79110062
791200                                                                  79120062
791300     INITIALIZE CE004-COMMAREA-REC.                               79130062
791400                                                                  79140062
791500     SET  CE004-CICS-LINK                                         79150062
791600          CE004-FROM-PULL-LIST    TO TRUE.                        79160062
791700                                                                  79170062
791800     MOVE ASC-CURR-OPER-UNT-ID-N  TO CE004-CURR-OPER-UNT-ID.      79180062
791900     MOVE ASC-CURR-FCLTY-ID-N     TO CE004-CURR-FCLTY-ID.         79190062
792000     MOVE ASC-CS-PRINTER-ID       TO CE004-CS-PRINTER-ID.         79200062
792100     MOVE ASC-PULL-SELECT-STATUS  TO CE004-PULL-SELECT-STATUS.    79210062
792200     MOVE ASC-PULL-SELECT-TYPE    TO CE004-PULL-SELECT-TYPE.      79220062
792300     MOVE ASC-SELECT-LIST-SEQUENCE                                79230062
792400                                  TO CE004-SELECT-LIST-SEQUENCE.  79240062
792500     MOVE ASC-PULL-SELECT-DATE-FROM                               79250062
792600                                  TO CE004-PULL-SELECT-DATE-FROM. 79260062
792700     MOVE ASC-PULL-SELECT-DATE-TO TO CE004-PULL-SELECT-DATE-TO.   79270062
792800                                                                  79280062
792900     MOVE PV-PULL-NUMBER          TO CE004-PULL-NBR.              79290062
793000     MOVE ASC-REF-NBR             TO CE004-REF-NBR.               79300062
793100     MOVE ZEROES                  TO CE004-LINE-NBR.              79310062
793200     MOVE PV-PULL-STATUS-CDE      TO CE004-PULL-STATUS.           79320062
793300     MOVE PV-STATUS-DATE          TO CE004-PULL-STATUS-DATE.      79330062
793400     MOVE PV-PULL-SOURCE-CDE      TO CE004-PULL-SOURCE.           79340062
793500     MOVE PV-CS-LOCATION          TO CE004-CS-LOCATION.           79350062
793600     MOVE PV-NBR-ITEMS            TO CE004-NBR-ITEMS.             79360062
793700     MOVE PV-REQ-PULL-UNITS       TO CE004-REQ-PULL-UNITS.        79370062
793800     MOVE PV-ACT-PULL-UNITS       TO CE004-ACT-PULL-UNITS.        79380062
793900     MOVE PV-DISTRBUTED-UNITS     TO CE004-DISTRBUTED-UNITS.      79390062
794000     MOVE DP020-USERID            TO CE004-USER-ID.               79400062
794100                                                                  79410062
794200     MOVE LENGTH OF CE004-COMMAREA-REC  TO PV-COMMAREA-LENGTH.    79420062
794300                                                                  79430062
794400     EXEC CICS                                                    79440062
794500         LINK                                                     79450062
794600             PROGRAM   (PC-PRINT-PROGRAM)                         79460062
794700             COMMAREA  (CE004-COMMAREA-REC)                       79470062
794800             LENGTH    (PV-COMMAREA-LENGTH)                       79480062
794900             RESP      (PV-CICS-RESP)                             79490062
795000     END-EXEC.                                                    79500062
795100                                                                  79510062
795200     EVALUATE TRUE                                                79520062
795300         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     79530062
795400              PERFORM 4640-VALIDATE-PRT-REQ-CALL                  79540062
795500         WHEN OTHER                                               79550062
795600              MOVE PC-TSYMSG-02238  TO DP020-MSG-NUMBER           79560062
795700              PERFORM 9900-SOFT-ABORT                             79570062
795800     END-EVALUATE.                                                79580062
795900                                                                  79590062
796000                                                                  79600062
796100*----------------------------------------------------------------*79610062
796200* CHECK RETURN CODE FROM LABEL PRINT PROGRAM TO SEE IF SUCCESSFUL*79620062
796300*----------------------------------------------------------------*79630062
796400 4640-VALIDATE-PRT-REQ-CALL.                                      79640062
796500                                                                  79650062
796600     IF  CE004-PRT-SUCCESSFUL                                     79660062
796700         CONTINUE                                                 79670062
796800     ELSE                                                         79680062
796900         MOVE PC-TSYMSG-02238  TO DP020-MSG-NUMBER                79690062
797000         PERFORM 9900-SOFT-ABORT                                  79700062
797100     END-IF.                                                      79710062
797200                                                                  79720062
797300                                                                  79730062
797400*----------------------------------------------------------------*79740062
797500* CONFIRM FUNCTION                                               *79750062
797600*----------------------------------------------------------------*79760062
797700 4700-PROCESS-CONFIRM-FUNCTION.                                   79770062
797800                                                                  79780062
797900     MOVE +1                       TO ASC-BLK-SUB.                79790062
798000     PERFORM 5100-WRITE-TEMP-STORAGE.                             79800062
798100     ADD +1                        TO ASC-BLK-SUB.                79810062
798200     PERFORM 5100-WRITE-TEMP-STORAGE.                             79820062
798300                                                                  79830062
798400     PERFORM 6112-READ-LIST-QUEUE.                                79840062
798500                                                                  79850062
798600     SET  LQW-IDX  TO   1.                                        79860062
798700                                                                  79870062
798800     IF PS-NO-SOFT-ABORT-ERROR                                    79880062
798900       IF PV-CICS-RESP = DFHRESP (NORMAL)                         79890062
799000         PERFORM                                                  79900062
799100         VARYING LQW-IDX  FROM 1 BY 1                             79910062
799200         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     79920062
799300            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            79930062
799400            OR   PS-SOFT-ABORT-ERROR                              79940062
799500            OR   PS-ERROR                                         79950062
799600             IF  LQW-SELECT (LQW-IDX)                             79960062
799700                 IF  PS-NO-ERROR                                  79970062
799800                         PERFORM 4710-PROCESS-CONFIRM-LINES       79980062
799900                 END-IF                                           79990062
800000             END-IF                                               80000062
800100         END-PERFORM                                              80010062
800200       END-IF                                                     80020062
800300     END-IF.                                                      80030062
800400                                                                  80040062
800500     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           80050062
800600     PERFORM 6111-WRITE-LIST-QUEUE.                               80060062
800700                                                                  80070062
800800     MOVE +1                     TO  ASC-BLK-SUB.                 80080062
800900     PERFORM 4410-READ-TEMP-STORAGE.                              80090062
801000                                                                  80100062
801100     ADD +1                      TO  ASC-BLK-SUB                  80110062
801200                                     PV-BLOCK-NUMBER.             80120062
801300                                                                  80130062
801400     PERFORM 4410-READ-TEMP-STORAGE.                              80140062
801500                                                                  80150062
801600                                                                  80160062
801700*----------------------------------------------------------------*80170062
801800* CONFIRM FUNCTION                                               *80180062
801900*----------------------------------------------------------------*80190062
802000 4710-PROCESS-CONFIRM-LINES.                                      80200062
802100                                                                  80210062
802200     INITIALIZE  CE005-INTER-APPL-COMMAREA                        80220062
802300     EVALUATE TRUE                                                80230062
802400         WHEN ASC-CONFIRM-CNCL-PULL                               80240062
802500              SET  CE005-CNCL-PULL  TO  TRUE                      80250062
802600              PERFORM 4715-LINK-CONFIRM-MODULE                    80260062
802700                                                                  80270062
802800         WHEN ASC-CONFIRM-UNCNCL-PULL                             80280062
802900              SET  CE005-UNCNCL-PULL  TO  TRUE                    80290062
803000              PERFORM 4715-LINK-CONFIRM-MODULE                    80300062
803100                                                                  80310062
803200         WHEN ASC-CONFIRM-CONF-DIST                               80320062
803300              SET  CE005-CNFM-DIST-PULL  TO  TRUE                 80330062
803400              PERFORM 4715-LINK-CONFIRM-MODULE                    80340062
803500                                                                  80350062
803600         WHEN ASC-CONFIRM-UNCONF-DIST                             80360062
803700              SET  CE005-UNCNFM-DIST-PULL  TO  TRUE               80370062
803800              PERFORM 4715-LINK-CONFIRM-MODULE                    80380062
803900                                                                  80390062
804000         WHEN ASC-CONFIRM-CONF-PULL                               80400062
804100              SET  CE005-CNFM-PULL  TO  TRUE                      80410062
804200              PERFORM 4715-LINK-CONFIRM-MODULE                    80420062
804300                                                                  80430062
804400         WHEN ASC-CONFIRM-UNCONF-PULL                             80440062
804500              SET  CE005-UNCNFM-PULL  TO  TRUE                    80450062
804600              PERFORM 4715-LINK-CONFIRM-MODULE                    80460062
804700                                                                  80470062
804800     END-EVALUATE.                                                80480062
804900                                                                  80490062
805000                                                                  80500062
805100*----------------------------------------------------------------*80510062
805200* LINK TO CANCEL/CONFIRMATION MODULE                             *80520062
805300*----------------------------------------------------------------*80530062
805400 4715-LINK-CONFIRM-MODULE.                                        80540062
805500                                                                  80550062
805600     MOVE DP020-USERID              TO  CE005-USER-ID.            80560062
805700     MOVE ASC-CURR-OPER-UNT-ID-N    TO  CE005-CURR-OPER-UNT-ID-N. 80570062
805800     MOVE ASC-CURR-FCLTY-ID-N       TO  CE005-CURR-FCLTY-ID-N.    80580062
805900     MOVE LQW-CS-LOCATION (LQW-IDX) TO  CE005-CS-LOCATION.        80590062
806000     MOVE ASC-CS-PRINTER-ID         TO  CE005-CS-PRINTER-ID.      80600062
806100     MOVE LQW-PULL-NUMBER (LQW-IDX) TO  CE005-PULL-NBR.           80610062
806200     MOVE LQW-REF-NUMBER (LQW-IDX)  TO  CE005-REF-NBR.            80620062
806300     MOVE LQW-PULL-STATUS-CDE (LQW-IDX)                           80630062
806400                                    TO  CE005-CURR-PULL-STATUS.   80640062
806500                                                                  80650062
806600     MOVE LENGTH OF CE005-INTER-APPL-COMMAREA                     80660062
806700                                    TO  PV-COMMAREA-LENGTH.       80670062
806800                                                                  80680062
806900     EXEC CICS                                                    80690062
807000         LINK                                                     80700062
807100             PROGRAM   (PC-CONFIRM-MODULE)                        80710062
807200             COMMAREA  (CE005-INTER-APPL-COMMAREA)                80720062
807300             RESP      (PV-CICS-RESPONSE)                         80730062
807400     END-EXEC.                                                    80740062
807500                                                                  80750062
807600     EVALUATE TRUE                                                80760062
807700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 80770062
807800             PERFORM 4720-VALIDATE-CONFIRM-CALL                   80780062
807900         WHEN OTHER                                               80790062
808000              EVALUATE TRUE                                       80800062
808100                  WHEN CE005-CNCL-PULL                            80810062
808200                  WHEN CE005-UNCNCL-PULL                          80820062
808300                       SET  PS-ERROR                              80830062
808400                            DP020-MSG-FATAL  TO TRUE              80840062
808500                       MOVE PC-TSYMSG-02269  TO DP020-MSG-NUMBER  80850062
808600                  WHEN CE005-CNFM-DIST-PULL                       80860062
808700                  WHEN CE005-UNCNFM-DIST-PULL                     80870062
808800                       SET  PS-ERROR                              80880062
808900                            DP020-MSG-FATAL  TO TRUE              80890062
809000                       MOVE PC-TSYMSG-02270  TO DP020-MSG-NUMBER  80900062
809100                  WHEN CE005-CNFM-PULL                            80910062
809200                  WHEN CE005-UNCNFM-PULL                          80920062
809300                       SET  PS-ERROR                              80930062
809400                            DP020-MSG-FATAL  TO TRUE              80940062
809500                       MOVE PC-TSYMSG-02271  TO DP020-MSG-NUMBER  80950062
809600              END-EVALUATE                                        80960062
809700     END-EVALUATE.                                                80970062
809800                                                                  80980062
809900     IF  PS-NO-ERROR                                              80990062
810000         SET  LQW-DESELECT (LQW-IDX)                              81000062
810100              LQW-UPD (LQW-IDX)        TO  TRUE                   81010062
810200              SUBTRACT  1                                         81020062
810300                  FROM  ASC-NUMBER-OF-SELECTED-ITEMS              81030062
810400              MOVE LQW-SELECTED-SW (LQW-IDX)                      81040062
810500                    TO LQW-TEMP-SELECTED-SW (LQW-IDX)             81050062
810600     END-IF.                                                      81060062
810700                                                                  81070062
810800     PERFORM 4725-GET-NEW-STATUS.                                 81080062
810900                                                                  81090062
811000                                                                  81100062
811100*----------------------------------------------------------------*81110062
811200* CHECK RETURN CODE FROM CNFM/CNCL PROGRAM TO SEE IF SUCCESSFUL  *81120062
811300*----------------------------------------------------------------*81130062
811400 4720-VALIDATE-CONFIRM-CALL.                                      81140062
811500                                                                  81150062
811600     EVALUATE TRUE                                                81160062
811700         WHEN CE005-FUNC-SUCCESSFUL                               81170062
811800              EVALUATE TRUE                                       81180062
811900                  WHEN CE005-CNCL-PULL                            81190062
812000                  WHEN CE005-UNCNCL-PULL                          81200062
812100                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      81210062
812200                       MOVE PC-TSYMSG-02274  TO DP020-MSG-NUMBER  81220062
812300                  WHEN CE005-CNFM-DIST-PULL                       81230062
812400                  WHEN CE005-UNCNFM-DIST-PULL                     81240062
812500                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      81250062
812600                       MOVE PC-TSYMSG-02275  TO DP020-MSG-NUMBER  81260062
812700                  WHEN CE005-CNFM-PULL                            81270062
812800                  WHEN CE005-UNCNFM-PULL                          81280062
812900                       SET  DP020-MSG-INFORMATIONAL  TO TRUE      81290062
813000                       MOVE PC-TSYMSG-02276  TO DP020-MSG-NUMBER  81300062
813100              END-EVALUATE                                        81310062
813200                                                                  81320062
813300         WHEN OTHER                                               81330062
813400              EVALUATE TRUE                                       81340062
813500                  WHEN CE005-RETURN-MSG = 'MQ SERIES ERROR'       81350062
813600                       SET  PS-ERROR                              81360062
813700                            DP020-MSG-FATAL  TO TRUE              81370062
813800                       MOVE PC-TSYMSG-02677  TO DP020-MSG-NUMBER  81380062
813900                  WHEN CE005-CNCL-PULL                            81390062
814000                  WHEN CE005-UNCNCL-PULL                          81400062
814100                       SET  PS-ERROR                              81410062
814200                            DP020-MSG-FATAL  TO TRUE              81420062
814300                       MOVE PC-TSYMSG-02269  TO DP020-MSG-NUMBER  81430062
814400                  WHEN CE005-CNFM-DIST-PULL                       81440062
814500                  WHEN CE005-UNCNFM-DIST-PULL                     81450062
814600                       SET  PS-ERROR                              81460062
814700                            DP020-MSG-FATAL  TO TRUE              81470062
814800                       MOVE PC-TSYMSG-02270  TO DP020-MSG-NUMBER  81480062
814900                  WHEN CE005-CNFM-PULL                            81490062
815000                  WHEN CE005-UNCNFM-PULL                          81500062
815100                       SET  PS-ERROR                              81510062
815200                            DP020-MSG-FATAL  TO TRUE              81520062
815300                       MOVE PC-TSYMSG-02271  TO DP020-MSG-NUMBER  81530062
815400              END-EVALUATE                                        81540062
815500     END-EVALUATE.                                                81550062
815600                                                                  81560062
815700                                                                  81570062
815800*----------------------------------------------------------------*81580062
815900* GET NEW LINE STATUS AFTER CONFIRM ROUTINE IS COMPLETE          *81590062
816000*----------------------------------------------------------------*81600062
816100 4725-GET-NEW-STATUS.                                             81610062
816200                                                                  81620062
816300     MOVE LQW-PULL-NUMBER (LQW-IDX) TO  DK-PULL-NUMBER.           81630062
816400     PERFORM 4730-LINE-STATUS.                                    81640062
816500                                                                  81650062
816600     MOVE  PV-PULL-STATUS TO LQW-PULL-STATUS-CDE (LQW-IDX)        81660062
816700     EVALUATE  TRUE                                               81670062
816800         WHEN  PV-PULL-STATUS-NEW                                 81680062
816900               MOVE  PC-NEW-DESC                                  81690062
817000                               TO LQW-PULL-STATUS-DESC (LQW-IDX)  81700062
817100         WHEN  PV-PULL-STATUS-CANCELLED                           81710062
817200               MOVE  PC-PULL-STATUS-CANCELLED                     81720062
817300                               TO LQW-PULL-STATUS-DESC (LQW-IDX)  81730062
817400         WHEN  PV-PULL-STATUS-INPROCESS                           81740062
817500               MOVE  PC-IN-PROCESS-DESC                           81750062
817600                               TO LQW-PULL-STATUS-DESC (LQW-IDX)  81760062
817700         WHEN  PV-PULL-STATUS-DISTRIBTD                           81770062
817800               MOVE  PC-DISTRIB-DESC                              81780062
817900                               TO LQW-PULL-STATUS-DESC (LQW-IDX)  81790062
818000         WHEN  PV-PULL-STATUS-POSTED                              81800062
818100               MOVE  PC-POSTED-DESC                               81810062
818200                               TO LQW-PULL-STATUS-DESC (LQW-IDX)  81820062
818300     END-EVALUATE.                                                81830062
818400                                                                  81840062
818500                                                                  81850062
818600*----------------------------------------------------------------*81860062
818700*                                                                *81870062
818800*----------------------------------------------------------------*81880062
818900 4730-LINE-STATUS.                                                81890062
819000                                                                  81900062
819100     EXEC SQL                                                     81910062
819200          SELECT STAT_CDE                                         81920062
819300            INTO :PV-PULL-STATUS                                  81930062
819400            FROM TCEPLRQ                                          81940062
819500           WHERE CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             81950062
819600     END-EXEC.                                                    81960062
819700                                                                  81970062
819800     EVALUATE TRUE                                                81980062
819900         WHEN SQLCODE = +0                                        81990062
820000              CONTINUE                                            82000062
820100                                                                  82010062
820200         WHEN OTHER                                               82020062
820300              MOVE '4730-LINE-STATUS     '    TO DP013-PARAGRAPH  82030062
820400              MOVE 'GET NEW PULL STATUS AFTER CONFIRM ROUTINE'    82040062
820500                                       TO DP013-MESSAGE-TEXT (1)  82050062
820600              STRING ' PULL NBR-'    DELIMITED BY SIZE            82060062
820700                      LQW-PULL-NUMBER (LQW-IDX)                   82070062
820800                                     DELIMITED BY SIZE            82080062
820900                                     INTO DP013-MESSAGE-TEXT (2)  82090062
821000              MOVE SQLCA                      TO DP013-SQLCA      82100062
821100              MOVE 'TCEPLRQ '        TO DP013-DB2-TABLE-NAME (1)  82110062
821200              SET  DP013-DB2-ABEND                                82120062
821300                   DP013-XCTL-DISPLAY-RESTART  TO TRUE            82130062
821400              PERFORM DP013-0000-PROCESS-ABEND                    82140062
821500     END-EVALUATE.                                                82150062
821600                                                                  82160062
821700                                                                  82170062
821800*----------------------------------------------------------------*82180062
821900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *82190062
822000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *82200062
822100* FOR THE SELECTED ITEMS QUEUE.                                  *82210062
822200*                                                                *82220062
822300* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *82230062
822400* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *82240062
822500* THE ARRAY IS FULL.                                             *82250062
822600*----------------------------------------------------------------*82260062
822700                                                                  82270062
822800 5000-PREPARE-SEL-QUEUE.                                          82280062
822900                                                                  82290062
823000     MOVE +1                   TO  ASC-BLK-SUB.                   82300062
823100     PERFORM 5100-WRITE-TEMP-STORAGE.                             82310062
823200     ADD +1                    TO  ASC-BLK-SUB.                   82320062
823300     PERFORM 5100-WRITE-TEMP-STORAGE.                             82330062
823400                                                                  82340062
823500     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          82350062
823600     PERFORM 6010-DELETE-SEL-QUEUE.                               82360062
823700                                                                  82370062
823800     SET ASC-UPDATE-TSQ        TO  TRUE.                          82380062
823900                                                                  82390062
824000     SET CE003-IDX             TO  1.                             82400062
824100     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       82410062
824200     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        82420062
824300                                                                  82430062
824400     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           82440062
824500             VARYING PV-ITEM                                      82450062
824600             FROM 1 BY 1                                          82460062
824700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     82470062
824800                                                                  82480062
824900     IF  CE003-IDX > 1                                            82490062
825000         PERFORM 5205-WRITE-SEL-QUEUE                             82500062
825100         ADD +1                TO CE002-NUMBER-OF-TS-ITEMS        82510062
825200     END-IF.                                                      82520062
825300 EJECT                                                            82530062
825400*----------------------------------------------------------------*82540062
825500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *82550062
825600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *82560062
825700*----------------------------------------------------------------*82570062
825800                                                                  82580062
825900 5100-WRITE-TEMP-STORAGE.                                         82590062
826000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     82600062
826100                                   TO PV-LIST-ITEM-NUMBER.        82610062
826200     COMPUTE PV-BLOCK-NUMBER =                                    82620062
826300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    82630062
826400                                                                  82640062
826500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             82650062
826600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             82660062
826700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      82670062
826800             PERFORM 5105-REWRITE-ASC-LISTQ                       82680062
826900         END-IF                                                   82690062
827000     ELSE                                                         82700062
827100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       82710062
827200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            82720062
827300         PERFORM 5110-WRITE-ASC-LISTQ                             82730062
827400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   82740062
827500     END-IF.                                                      82750062
827600                                                                  82760062
827700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             82770062
827800******************************************************************82780062
827900** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **82790062
828000** SPECIFIC COMMAREA.                                           **82800062
828100******************************************************************82810062
828200 5105-REWRITE-ASC-LISTQ.                                          82820062
828300     EXEC CICS                                                    82830062
828400         WRITEQ TS                                                82840062
828500             QUEUE (ASC-LIST-QUEUE-NAME)                          82850062
828600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               82860062
828700             ITEM  (PV-BLOCK-NUMBER)                              82870062
828800             REWRITE                                              82880062
828900             RESP  (PV-CICS-RESP)                                 82890062
829000     END-EXEC.                                                    82900062
829100                                                                  82910062
829200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           82920062
829300         CONTINUE                                                 82930062
829400     ELSE                                                         82940062
829500         SET DP013-CICS-ABEND            TO TRUE                  82950062
829600         SET DP013-NO-ROLLBACK           TO TRUE                  82960062
829700         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       82970062
829800         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     82980062
829900                                         TO DP013-MESSAGE-TEXT(1) 82990062
830000         PERFORM DP013-0000-PROCESS-ABEND                         83000062
830100     END-IF.                                                      83010062
830200                                                                  83020062
830300******************************************************************83030062
830400** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **83040062
830500** SPECIFIC COMMAREA.                                           **83050062
830600******************************************************************83060062
830700 5110-WRITE-ASC-LISTQ.                                            83070062
830800     EXEC CICS                                                    83080062
830900         WRITEQ TS                                                83090062
831000             QUEUE (ASC-LIST-QUEUE-NAME)                          83100062
831100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               83110062
831200             ITEM  (PV-BLOCK-NUMBER)                              83120062
831300             RESP  (PV-CICS-RESP)                                 83130062
831400     END-EXEC.                                                    83140062
831500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      83150062
831600         SET DP013-CICS-ABEND      TO TRUE                        83160062
831700         SET DP013-NO-ROLLBACK     TO TRUE                        83170062
831800         MOVE '5110-WRITE-ASC-LISTQ'                              83180062
831900                                   TO DP013-PARAGRAPH             83190062
832000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           83200062
832100                                   TO DP013-MESSAGE-TEXT(1)       83210062
832200         PERFORM DP013-0000-PROCESS-ABEND                         83220062
832300     END-IF.                                                      83230062
832400 EJECT                                                            83240062
832500*----------------------------------------------------------------*83250062
832600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *83260062
832700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *83270062
832800*----------------------------------------------------------------*83280062
832900                                                                  83290062
833000 5200-FILL-SEL-QUEUE-RECORD.                                      83300062
833100                                                                  83310062
833200     PERFORM 6112-READ-LIST-QUEUE.                                83320062
833300                                                                  83330062
833400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       83340062
833500         PERFORM                                                  83350062
833600         VARYING LQW-IDX                                          83360062
833700         FROM 1 BY 1                                              83370062
833800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            83380062
833900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          83390062
834000                                                                  83400062
834100             IF  LQW-SELECT (LQW-IDX)                             83410062
834200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              83420062
834300                                   TO CE003-ITEM (CE003-IDX)      83430062
834400                 MOVE SPACE        TO CE003-ACTION-SW (CE003-IDX) 83440062
834500                                                                  83450062
834600                 MOVE LQW-PULL-NUMBER (LQW-IDX)                   83460062
834700                                   TO  CE003-PULL-NUMBER          83470062
834800                                        (CE003-IDX)               83480062
834900                                       PV-PULL-NBR-SIGNED         83490062
835000                 MOVE PV-PULL-NBR-SIGNED TO CE002-PULL-NBR        83500062
835100                 MOVE LQW-REF-NUMBER (LQW-IDX)                    83510062
835200                                   TO  CE003-REF-NUMBER           83520062
835300                                        (CE003-IDX)               83530062
835400                                       CE002-REF-NBR              83540062
835500                 MOVE LQW-CS-LOCATION (LQW-IDX)                   83550062
835600                                   TO  CE003-CS-LOCATION          83560062
835700                                        (CE003-IDX)               83570062
835800                 MOVE LQW-CREATE-DATE (LQW-IDX)                   83580062
835900                                   TO  CE003-CREATE-DATE          83590062
836000                                        (CE003-IDX)               83600062
836100                 MOVE LQW-PULL-STATUS-CDE (LQW-IDX)               83610062
836200                                   TO  CE003-PULL-STATUS-CDE      83620062
836300                                        (CE003-IDX)               83630062
836400                 MOVE LQW-PULL-SOURCE-CDE (LQW-IDX)               83640062
836500                                   TO  CE003-PULL-SOURCE-CDE      83650062
836600                                        (CE003-IDX)               83660062
836700                                       CE002-CURR-PULL-TYPE       83670062
836800                 MOVE LQW-NBR-ITEMS (LQW-IDX)                     83680062
836900                                   TO  CE003-NBR-ITEMS            83690062
837000                                        (CE003-IDX)               83700062
837100                 MOVE LQW-REQ-PULL-UNITS (LQW-IDX)                83710062
837200                                   TO  CE003-REQ-PULL-UNITS       83720062
837300                                        (CE003-IDX)               83730062
837400                 MOVE LQW-ACT-PULL-UNITS (LQW-IDX)                83740062
837500                                   TO  CE003-ACT-PULL-UNITS       83750062
837600                                        (CE003-IDX)               83760062
837700* EA 08/02/2010                                                   83770062
837800*                MOVE LQW-DISTRBUTED-UNITS (LQW-IDX)              83780062
837900                 MOVE LQW-DISTRB-UNTS-NUM (LQW-IDX)               83790062
838000* EA 08/02/2010                                                   83800062
838100                                   TO  CE003-DIST-PULL-UNITS      83810062
838200                                        (CE003-IDX)               83820062
838300                                                                  83830062
838400                 SET CE003-IDX UP BY 1                            83840062
838500                 IF  CE003-IDX > CE003-MAX-ITEMS                  83850062
838600                     PERFORM 5205-WRITE-SEL-QUEUE                 83860062
838700                     ADD +1        TO CE002-NUMBER-OF-TS-ITEMS    83870062
838800                     INITIALIZE CE003-SELECTED-ITEM-ARRAY         83880062
838900                     SET CE003-IDX TO  1                          83890062
839000                 END-IF                                           83900062
839100             END-IF                                               83910062
839200         END-PERFORM                                              83920062
839300     END-IF.                                                      83930062
839400                                                                  83940062
839500*----------------------------------------------------------------*83950062
839600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *83960062
839700*----------------------------------------------------------------*83970062
839800                                                                  83980062
839900 5205-WRITE-SEL-QUEUE.                                            83990062
840000                                                                  84000062
840100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            84010062
840200                                   TO CE003-SELECTED-ITEMS.       84020062
840300                                                                  84030062
840400     EXEC CICS                                                    84040062
840500          WRITEQ TS                                               84050062
840600              QUEUE (ASC-SEL-QUEUE-NAME)                          84060062
840700              FROM  (CE003-SELECT-RECORD)                         84070062
840800              ITEM  (PV-SEL-QUEUE-ITEM)                           84080062
840900              RESP  (PV-CICS-RESP)                                84090062
841000     END-EXEC.                                                    84100062
841100                                                                  84110062
841200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          84120062
841300         CONTINUE                                                 84130062
841400     ELSE                                                         84140062
841500         SET DP013-CICS-ABEND      TO TRUE                        84150062
841600         SET DP013-NO-ROLLBACK     TO TRUE                        84160062
841700         MOVE '5205-WRITE-SEL-QUEUE'                              84170062
841800                                   TO DP013-PARAGRAPH             84180062
841900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          84190062
842000                                   TO DP013-MESSAGE-TEXT(1)       84200062
842100         PERFORM DP013-0000-PROCESS-ABEND                         84210062
842200     END-IF.                                                      84220062
842300 EJECT                                                            84230062
842400******************************************************************84240062
842500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **84250062
842600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **84260062
842700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **84270062
842800** THE USER.                                                    **84280062
842900******************************************************************84290062
843000 6000-REFRESH-PANEL-FROM-TEMP.                                    84300062
843100                                                                  84310062
843200     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      84320062
843300         SET ASC-NO-TSQ-UPDATE TO TRUE                            84330062
843400         MOVE ZERO                 TO PV-SAVE-ITEM                84340062
843500                                      PV-SEL-QUEUE-ITEM           84350062
843600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        84360062
843700                                   TO PV-HOLD-SELECTED-ITEMS      84370062
843800         MOVE +1                   TO PV-ITEMS-PROCESSED          84380062
843900         PERFORM 6100-UPDATE-TSQ                                  84390062
844000             UNTIL PV-ITEMS-PROCESSED >                           84400062
844100                                     PV-HOLD-SELECTED-ITEMS       84410062
844200         PERFORM 6010-DELETE-SEL-QUEUE                            84420062
844300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         84430062
844400                    ASC-BLOCK-ENTRIES (2)                         84440062
844500     END-IF.                                                      84450062
844600                                                                  84460062
844700*----------------------------------------------------------------*84470062
844800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *84480062
844900*----------------------------------------------------------------*84490062
845000 6010-DELETE-SEL-QUEUE.                                           84500062
845100                                                                  84510062
845200     EXEC CICS                                                    84520062
845300         DELETEQ TS                                               84530062
845400             QUEUE (ASC-SEL-QUEUE-NAME)                           84540062
845500             RESP  (PV-CICS-RESP)                                 84550062
845600     END-EXEC.                                                    84560062
845700*                                                                 84570062
845800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      84580062
845900        (PV-CICS-RESP = DFHRESP(QIDERR)))                         84590062
846000         CONTINUE                                                 84600062
846100     ELSE                                                         84610062
846200         SET DP013-CICS-ABEND TO TRUE                             84620062
846300         SET DP013-NO-ROLLBACK TO TRUE                            84630062
846400         MOVE '6010-DELETE-SEL-QUEUE'                             84640062
846500                        TO DP013-PARAGRAPH                        84650062
846600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         84660062
846700                        TO DP013-MESSAGE-TEXT (1)                 84670062
846800         PERFORM DP013-0000-PROCESS-ABEND                         84680062
846900     END-IF.                                                      84690062
847000                                                                  84700062
847100*----------------------------------------------------------------*84710062
847200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *84720062
847300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *84730062
847400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *84740062
847500*    THE TEMP QUEUE.                                             *84750062
847600*----------------------------------------------------------------*84760062
847700                                                                  84770062
847800 6100-UPDATE-TSQ.                                                 84780062
847900                                                                  84790062
848000     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             84800062
848100     PERFORM 6105-READ-SEL-QUEUE.                                 84810062
848200     PERFORM                                                      84820062
848300         VARYING CE003-IDX                                        84830062
848400         FROM 1 BY 1                                              84840062
848500         UNTIL ((PV-ITEMS-PROCESSED >                             84850062
848600                              PV-HOLD-SELECTED-ITEMS)             84860062
848700         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             84870062
848800         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  84880062
848900             PERFORM 6110-PROCESS-ITEMS                           84890062
849000         END-IF                                                   84900062
849100         ADD +1                TO PV-ITEMS-PROCESSED              84910062
849200     END-PERFORM.                                                 84920062
849300     PERFORM 6111-WRITE-LIST-QUEUE.                               84930062
849400*----------------------------------------------------------------*84940062
849500*    READ THE LIST QUEUE RECORD.                                 *84950062
849600*----------------------------------------------------------------*84960062
849700                                                                  84970062
849800 6105-READ-SEL-QUEUE.                                             84980062
849900                                                                  84990062
850000     EXEC CICS                                                    85000062
850100          READQ TS                                                85010062
850200              QUEUE (ASC-SEL-QUEUE-NAME)                          85020062
850300              INTO  (CE003-SELECT-RECORD)                         85030062
850400              ITEM  (PV-SEL-QUEUE-ITEM)                           85040062
850500              RESP  (PV-CICS-RESP)                                85050062
850600     END-EXEC.                                                    85060062
850700*                                                                 85070062
850800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          85080062
850900         CONTINUE                                                 85090062
851000     ELSE                                                         85100062
851100         SET DP013-CICS-ABEND      TO  TRUE                       85110062
851200         SET DP013-NO-ROLLBACK     TO  TRUE                       85120062
851300         MOVE '6105-READ-SEL-QUEUE'                               85130062
851400                                   TO  DP013-PARAGRAPH            85140062
851500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           85150062
851600                                   TO  DP013-MESSAGE-TEXT(1)      85160062
851700                                                                  85170062
851800         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              85180062
851900         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          85190062
852000         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  85200062
852100         STRING ' QUEUE TERM ID-'     DELIMITED BY SIZE           85210062
852200                 PV-SEL-TERM-ID       DELIMITED BY SIZE           85220062
852300                ' QUEUE TASK-'        DELIMITED BY SIZE           85230062
852400                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           85240062
852500                ' QUEUE SEQ-'         DELIMITED BY SIZE           85250062
852600                 PV-SEL-SEQ           DELIMITED BY SIZE           85260062
852700                                 INTO  DP013-MESSAGE-TEXT(2)      85270062
852800         PERFORM DP013-0000-PROCESS-ABEND                         85280062
852900     END-IF.                                                      85290062
853000 EJECT                                                            85300062
853100*----------------------------------------------------------------*85310062
853200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*85320062
853300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*85330062
853400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *85340062
853500*----------------------------------------------------------------*85350062
853600                                                                  85360062
853700 6110-PROCESS-ITEMS.                                              85370062
853800                                                                  85380062
853900     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          85390062
854000                     / PC-ITEMS-PER-PANEL).                       85400062
854100                                                                  85410062
854200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           85420062
854300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          85430062
854400             PERFORM 6111-WRITE-LIST-QUEUE                        85440062
854500         END-IF                                                   85450062
854600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    85460062
854700                                                                  85470062
854800         PERFORM 6112-READ-LIST-QUEUE                             85480062
854900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               85490062
855000             CONTINUE                                             85500062
855100         END-IF                                                   85510062
855200     END-IF.                                                      85520062
855300                                                                  85530062
855400     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     85540062
855500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              85550062
855600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         85560062
855700     MOVE LQW-SELECTED-SW (PV-SUB)                                85570062
855800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  85580062
855900     EVALUATE TRUE                                                85590062
856000         WHEN CE003-INQ (CE003-IDX)                               85600062
856100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             85610062
856200                                                                  85620062
856300         WHEN CE003-UPD (CE003-IDX)                               85630062
856400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             85640062
856500                                                                  85650062
856600         WHEN CE003-DEL (CE003-IDX)                               85660062
856700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             85670062
856800                                                                  85680062
856900         WHEN CE003-ERR (CE003-IDX)                               85690062
857000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             85700062
857100     END-EVALUATE.                                                85710062
857200                                                                  85720062
857300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                85730062
857400                                                                  85740062
857500*----------------------------------------------------------------*85750062
857600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *85760062
857700*----------------------------------------------------------------*85770062
857800                                                                  85780062
857900 6111-WRITE-LIST-QUEUE.                                           85790062
858000                                                                  85800062
858100     EXEC CICS                                                    85810062
858200         WRITEQ TS                                                85820062
858300             QUEUE (ASC-LIST-QUEUE-NAME)                          85830062
858400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     85840062
858500             ITEM  (PV-SAVE-ITEM)                                 85850062
858600             REWRITE                                              85860062
858700             RESP  (PV-CICS-RESP)                                 85870062
858800     END-EXEC.                                                    85880062
858900*                                                                 85890062
859000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          85900062
859100         CONTINUE                                                 85910062
859200     ELSE                                                         85920062
859300         SET DP013-CICS-ABEND  TO  TRUE                           85930062
859400         SET DP013-NO-ROLLBACK TO  TRUE                           85940062
859500         MOVE '6111-WRITE-LIST-QUEUE'                             85950062
859600                               TO  DP013-PARAGRAPH                85960062
859700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  85970062
859800                               TO  DP013-MESSAGE-TEXT(1)          85980062
859900         PERFORM DP013-0000-PROCESS-ABEND                         85990062
860000     END-IF.                                                      86000062
860100                                                                  86010062
860200 EJECT                                                            86020062
860300*----------------------------------------------------------------*86030062
860400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*86040062
860500*----------------------------------------------------------------*86050062
860600                                                                  86060062
860700 6112-READ-LIST-QUEUE.                                            86070062
860800                                                                  86080062
860900     EXEC CICS                                                    86090062
861000         READQ TS                                                 86100062
861100             QUEUE (ASC-LIST-QUEUE-NAME)                          86110062
861200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     86120062
861300             ITEM  (PV-ITEM)                                      86130062
861400             RESP  (PV-CICS-RESP)                                 86140062
861500     END-EXEC.                                                    86150062
861600*                                                                 86160062
861700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          86170062
861800         CONTINUE                                                 86180062
861900     ELSE                                                         86190062
862000         SET DP013-CICS-ABEND        TO TRUE                      86200062
862100         SET DP013-NO-ROLLBACK       TO TRUE                      86210062
862200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           86220062
862300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    86230062
862400                                     TO DP013-MESSAGE-TEXT(1)     86240062
862500         PERFORM DP013-0000-PROCESS-ABEND                         86250062
862600     END-IF.                                                      86260062
862700*----------------------------------------------------------------*86270062
862800* OPEN LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION             *86280062
862900*----------------------------------------------------------------*86290062
863000 7050-OPEN-CNFM-LNE-CSR.                                          86300062
863100                                                                  86310062
863200      EXEC SQL                                                    86320062
863300           OPEN CNFM-LINE-ITEM-CSR                                86330062
863400      END-EXEC                                                    86340062
863500                                                                  86350062
863600     EVALUATE TRUE                                                86360062
863700         WHEN SQLCODE = ZERO                                      86370062
863800             CONTINUE                                             86380062
863900         WHEN SQLWARN0 NOT = SPACES                               86390062
864000         WHEN SQLCODE < ZERO                                      86400062
864100         WHEN SQLCODE > ZERO                                      86410062
864200              SET PS-ERROR    TO TRUE                             86420062
864300              MOVE '7050-OPEN-CNFM-LNE-CURSOR'                    86430062
864400                              TO DP013-PARAGRAPH                  86440062
864500              MOVE 'OPEN CS CONFIRM LINE CURSOR - '               86450062
864600                              TO DP013-MESSAGE-TEXT (1)           86460062
864700              MOVE 'CURSOR:  CNFM-LINE-ITEM-CSR      '            86470062
864800                              TO DP013-MESSAGE-TEXT (2)           86480062
864900              MOVE SQLCA      TO DP013-SQLCA                      86490062
865000              MOVE 'TCEPLIT ' TO DP013-DB2-TABLE-NAME (1)         86500062
865100              SET DP013-DB2-ABEND                                 86510062
865200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              86520062
865300              PERFORM DP013-0000-PROCESS-ABEND                    86530062
865400     END-EVALUATE.                                                86540062
865500                                                                  86550062
865600                                                                  86560062
865700*----------------------------------------------------------------*86570062
865800* FETCH LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION            *86580062
865900*----------------------------------------------------------------*86590062
866000 7055-FETCH-CNFM-LNE-CSR.                                         86600062
866100                                                                  86610062
866200     EXEC SQL                                                     86620062
866300          FETCH CNFM-LINE-ITEM-CSR                                86630062
866400           INTO :CEPLIT-PL-LNE-NBR                                86640062
866500     END-EXEC.                                                    86650062
866600                                                                  86660062
866700     EVALUATE TRUE                                                86670062
866800         WHEN SQLCODE = ZERO                                      86680062
866900              CONTINUE                                            86690062
867000                                                                  86700062
867100         WHEN SQLCODE = +100                                      86710062
867200              SET PS-EOF-CNFM-LNE-CSR  TO  TRUE                   86720062
867300                                                                  86730062
867400         WHEN SQLWARN0 NOT = SPACE                                86740062
867500         WHEN SQLCODE NOT = ZERO                                  86750062
867600              SET PS-ERROR     TO TRUE                            86760062
867700              MOVE '7055-FETCH-CNFM-LNE-CSR.'                     86770062
867800                               TO DP013-PARAGRAPH                 86780062
867900              MOVE 'FETCH CS CONFIRM DISTRO LINE CURSOR'          86790062
868000                               TO DP013-MESSAGE-TEXT (1)          86800062
868100              MOVE 'CURSOR:  CNFM-LINE-ITEM-CSR  '                86810062
868200                               TO DP013-MESSAGE-TEXT (2)          86820062
868300              MOVE SQLCA       TO DP013-SQLCA                     86830062
868400              MOVE 'TCEPLIT'   TO DP013-DB2-TABLE-NAME (1)        86840062
868500              SET DP013-DB2-ABEND                                 86850062
868600                               TO TRUE                            86860062
868700              PERFORM DP013-0000-PROCESS-ABEND                    86870062
868800     END-EVALUATE.                                                86880062
868900                                                                  86890062
869000                                                                  86900062
869100*----------------------------------------------------------------*86910062
869200* CLOSE LINE CURSOR FOR CONFIRM DISTRIBUTION FUNCTION            *86920062
869300*----------------------------------------------------------------*86930062
869400 7060-CLOSE-CNFM-LNE-CSR.                                         86940062
869500                                                                  86950062
869600     EXEC SQL                                                     86960062
869700          CLOSE CNFM-LINE-ITEM-CSR                                86970062
869800     END-EXEC                                                     86980062
869900                                                                  86990062
870000     EVALUATE TRUE                                                87000062
870100         WHEN SQLCODE = ZERO                                      87010062
870200             CONTINUE                                             87020062
870300         WHEN SQLWARN0 NOT = SPACES                               87030062
870400         WHEN SQLCODE < ZERO                                      87040062
870500         WHEN SQLCODE > ZERO                                      87050062
870600             MOVE '7060-CLOSE-CNFM-LNE-CSR '                      87060062
870700                               TO DP013-PARAGRAPH                 87070062
870800             MOVE 'CLOSE CS CONFIRM DISTRO LINE CSR'              87080062
870900                               TO DP013-MESSAGE-TEXT (1)          87090062
871000             MOVE 'CURSOR:  CNFM-LINE-ITEM-CSR'                   87100062
871100                               TO DP013-MESSAGE-TEXT (2)          87110062
871200             MOVE SQLCA        TO DP013-SQLCA                     87120062
871300             MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)        87130062
871400             SET DP013-DB2-ABEND                                  87140062
871500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               87150062
871600             PERFORM DP013-0000-PROCESS-ABEND                     87160062
871700     END-EVALUATE.                                                87170062
871800                                                                  87180062
871900                                                                  87190062
872000                                                                  87200062
872100                                                                  87210062
872200*----------------------------------------------------------------*87220062
872300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *87230062
872400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *87240062
872500*----------------------------------------------------------------*87250062
872600 9900-SOFT-ABORT.                                                 87260062
872700                                                                  87270062
872800     EXEC CICS SYNCPOINT                                          87280062
872900          ROLLBACK                                                87290062
873000     END-EXEC.                                                    87300062
873100                                                                  87310062
873200     SET  PS-ERROR                                                87320062
873300          PS-SOFT-ABORT-ERROR                                     87330062
873400          DP020-MSG-FATAL       TO  TRUE.                         87340062
873500                                                                  87350062
873600                                                                  87360062
873700*----------------------------------------------------------------*87370062
873800*    ABEND PROCESSOR MODULE                                      *87380062
873900*----------------------------------------------------------------*87390062
874000                                                                  87400062
874100     COPY DPPD013.                                                87410062
