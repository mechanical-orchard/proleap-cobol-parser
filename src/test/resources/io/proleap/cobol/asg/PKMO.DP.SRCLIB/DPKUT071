000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000310                                                                  00031000
000400 PROGRAM-ID.             DPKUT071.                                00040000
000600 AUTHOR.                 RICK TULLOCH                             00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           02-09-07.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*                                                                *00120000
001210******************************************************************00121000
001280                                                                  00128000
001290******************************************************************00129000
001300 ENVIRONMENT DIVISION.                                            00130000
001400******************************************************************00140000
001500                                                                  00150000
001600 CONFIGURATION SECTION.                                           00160000
001700                                                                  00170000
001800 SOURCE-COMPUTER.        IBM-3090.                                00180000
001900 OBJECT-COMPUTER.        IBM-3090.                                00190000
002000                                                                  00200000
002100 INPUT-OUTPUT SECTION.                                            00210000
002110                                                                  00211000
002120 FILE-CONTROL.                                                    00212000
002130                                                                  00213000
002140     SELECT FIXED-LENGTH-FILE                                     00214000
002150         ASSIGN TO INP01.                                         00215000
002151                                                                  00215100
002160     SELECT VARIABLE-LENGTH-FILE                                  00216000
002170         ASSIGN TO OUT01.                                         00217000
002200                                                                  00220000
002300******************************************************************00230000
002400 DATA DIVISION.                                                   00240000
002500******************************************************************00250000
002600                                                                  00260000
002700 FILE SECTION.                                                    00270000
002800                                                                  00280000
002900 FD  FIXED-LENGTH-FILE                                            00290000
003000     RECORDING MODE IS F                                          00300000
003100     LABEL RECORDS ARE STANDARD                                   00310000
003200     BLOCK CONTAINS 0 RECORDS                                     00320000
003210     RECORD CONTAINS 132 CHARACTERS                               00321000
003220     DATA RECORD IS FL-FIXED-LENGTH-RECORDS.                      00322000
003230                                                                  00323000
003300 01  FL-FIXED-LENGTH-RECORD      PIC X(132).                      00330000
003400                                                                  00340000
003500 FD  VARIABLE-LENGTH-FILE                                         00350000
003600     RECORDING MODE IS V                                          00360000
003700     LABEL RECORDS ARE STANDARD                                   00370000
003800     RECORD IS VARYING FROM 1 TO 132                              00380000
003900     DEPENDING ON PV-VB-RECORD-LENGTH                             00390000
004000     DATA RECORD IS VL-VARIABLE-LENGTH-RECORD.                    00400000
004010                                                                  00401000
004100 01  VL-VARIABLE-LENGTH-RECORD.                                   00410000
004300     05  VL-BYTE                 PIC X(1)                         00430000
004400                                 OCCURS 1 TO 132 TIMES            00440000
004500                                 DEPENDING ON PV-VB-RECORD-LENGTH.00450000
004600                                                                  00460000
004700 WORKING-STORAGE SECTION.                                         00470000
004800                                                                  00480000
005000 01  PS-PROGRAM-SWITCHES.                                         00500000
005100     05  PS-END-OF-FIXED-FILE-SW                                  00510000
005200                                 PIC X(1)     VALUE 'N'.          00520000
005210         88  PS-END-OF-FIXED-FILE             VALUE 'Y'.          00521000
005600                                                                  00560000
005700 01  PV-PROGRAM-VARIABLES.                                        00570000
005800     05  PV-FIXED-RECORD         PIC X(132)   VALUE SPACES.       00580000
005810     05  PV-VB-RECORD-LENGTH     PIC 9(3)     VALUE ZEROS.        00581001
006000     05  PV-END-OF-RECORD        PIC S9(4)    VALUE ZEROS         00600000
006100                                              COMP SYNC.          00610000
007400                                                                  00740000
007500******************************************************************00750000
007600 PROCEDURE DIVISION.                                              00760000
007700******************************************************************00770000
007800                                                                  00780000
007900 0000-MAINLINE.                                                   00790000
008000                                                                  00800000
008100     PERFORM 1000-INITIALIZE.                                     00810000
008200                                                                  00820000
008300     PERFORM 2000-PROCESS-FIXED-RECORD                            00830000
008310         UNTIL PS-END-OF-FIXED-FILE.                              00831000
008320                                                                  00832000
008330     PERFORM 9000-EOJ-ROUTINE.                                    00833000
008400                                                                  00840000
008500     GOBACK.                                                      00850000
008600                                                                  00860000
008700******************************************************************00870000
008800*                                                                *00880000
008810******************************************************************00881000
008820                                                                  00882000
008830 1000-INITIALIZE.                                                 00883000
009000     OPEN INPUT  FIXED-LENGTH-FILE                                00900000
009100          OUTPUT VARIABLE-LENGTH-FILE.                            00910000
009110                                                                  00911000
009200     PERFORM 7000-READ-FIXED-RECORD.                              00920000
009210*1000-EXIT.                                                       00921000
009211                                                                  00921100
009212******************************************************************00921200
009213*                                                                *00921300
009214******************************************************************00921400
010200                                                                  01020000
010210 2000-PROCESS-FIXED-RECORD.                                       01021000
010220     MOVE LENGTH OF PV-FIXED-RECORD TO PV-END-OF-RECORD.          01022001
010230                                                                  01023001
010300     PERFORM                                                      01030000
010700             UNTIL ((PV-FIXED-RECORD (PV-END-OF-RECORD:1) NOT =   01070000
010710                                                           SPACES)01071002
010800                     OR (PV-END-OF-RECORD NOT > 1))               01080000
010810         SUBTRACT +1 FROM PV-END-OF-RECORD                        01081001
010900     END-PERFORM.                                                 01090000
011000                                                                  01100000
011010     MOVE PV-END-OF-RECORD TO PV-VB-RECORD-LENGTH.                01101000
011200     MOVE PV-FIXED-RECORD (1:PV-VB-RECORD-LENGTH) TO              01120000
011300               VL-VARIABLE-LENGTH-RECORD.                         01130000
011310                                                                  01131000
011400     PERFORM 8000-WRITE-VARIABLE-RECORD.                          01140000
011500                                                                  01150000
011600     PERFORM 7000-READ-FIXED-RECORD.                              01160000
011610*2000-EXIT.                                                       01161000
011700                                                                  01170000
011800******************************************************************01180000
011900*  READ A 132 BYTE FIXED LENGTH RECORD.                          *01190000
012000******************************************************************01200000
012010                                                                  01201000
012100 7000-READ-FIXED-RECORD.                                          01210000
012200     READ FIXED-LENGTH-FILE                                       01220000
012210         INTO PV-FIXED-RECORD                                     01221000
012300         AT END                                                   01230000
012400             SET PS-END-OF-FIXED-FILE TO TRUE                     01240000
012401     END-READ.                                                    01240100
012402*7000-EXIT.                                                       01240200
012410                                                                  01241000
012420******************************************************************01242000
012600*  WRITE A VARIABLE LENGTH RECORD, STRIPPED OF ALL BLANK SPACE   *01260000
012700*  ON THE RIGHT.                                                 *01270000
012701******************************************************************01270100
012710                                                                  01271000
012800 8000-WRITE-VARIABLE-RECORD.                                      01280000
012900     WRITE VL-VARIABLE-LENGTH-RECORD.                             01290000
012910*8000-EXIT.                                                       01291000
013000                                                                  01300000
013100******************************************************************01310000
013200*  CLOSE ALL FILES.                                              *01320000
013300******************************************************************01330000
013310                                                                  01331000
013400 9000-EOJ-ROUTINE.                                                01340000
013500     CLOSE FIXED-LENGTH-FILE                                      01350000
013600           VARIABLE-LENGTH-FILE.                                  01360000
013700*9000-EXIT.                                                       01370000
