000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     VNKUT210.                                        00020001
000300 AUTHOR.         MIKE BESKE.                                      00030001
000400 DATE-WRITTEN.   MAY 2007.                                        00040001
000500*************************************************************     00050000
000600*    COBOL 2 WITH DB2 SQL                                   *     00060001
000700*                                                           *     00070000
000800*  VENDOR LEGACY DATA EXTRACT FOR EDW SYSTEM                *     00080069
000900*                                                           *     00090068
001000*  THE PURPOSE OF THIS PROGRAM IS TO PRODUCE DATA EXTRACTS  *     00100068
001100*  CONTAINING INFORMATION FROM THE VENDOR LEGACY SYSTEM FOR *     00110016
001200*  DATA WAREHOUSE EDW TABLES. ONE EXTRACT FILE WILL BE USED *     00120016
001300*  BY THE DATA WAREHOUSE GROUP TO POPULATE THE FOLLOWING    *     00130001
001400*  TABLES: CWT_EXENT CWT_EXP_VND CWT_MDSE_VND. ANOTHER      *     00140009
001500*  EXTRACT FILE WILL BE USED TO POPULATE CWT_EXENT_ROL_ASSN *     00150003
001600*  EDW TABLE.  ANOTHER FILE WILL BE USED TO POPULATE THE EDW*     00160009
001700*  TABLE CWT_EXENT_DEPT_ASSN. ANOTHER FILE WILL BE USED FOR *     00170015
001800*  POPULATING THE EDW TABLE CWT_EXENT_CPBL_ASSN. ANOTHER    *     00180016
001900*  FILE WILL CONTAIN ALL OF THE VENDOR AGREEMENT DATA FOR   *     00190016
002000*  THESE EDW TABLES: CWT_EXENT_AGRMT CWT_SHPG_AGRMT         *     00200016
002100*  CWT_PAYT_AGRMT CWT_PRCH_AGRMT CWT_INCTV_AGRMT            *     00210016
002200*  CWT_PGM_AGRMT.                                           *     00220016
002300*                                                           *     00230016
002400*************************************************************     00240016
002500*                                                           *     00250016
002600* DB2 TABLES:                                               *     00260016
002700*  1. EXTERNAL ENTITY TABLE            (TEXTENT)            *     00270016
002800*  2. ENTITY NAME TABLE                (TENTNME)            *     00280016
002900*  3. VENDOR DEPARTMENT TABLE          (TVNDAGR)            *     00290016
003000*  4. VENDOR CAPABILITIES TABLE        (VNT00001)           *     00300016
003100*  5. VENDOR AGREEMENT TABLE           (TVNDAGR)            *     00310016
003200*  6. VENDOR FREIGHT TERMS TABLE       (TFRGTRM)            *     00320025
003300*  7. VENDOR INCENTIVE TYPE TABLE      (TINCTYP)            *     00330043
003400*                                                           *     00340036
003500* OUTPUT:                                                   *     00350036
003600*  1. VENDOR EXTRACT FILE              (VNRD210)            *     00360036
003700*  2. VENDOR ROLE FILE                 (VNRD211)            *     00370036
003800*  3. VENDOR DEPARTMENT FILE           (VNRD213)            *     00380036
003900*  4. VENDOR CAPABILITIES FILE         (VNRD212)            *     00390036
004000*  5. VENDOR AGREEMENT FILE            (VNRD214)            *     00400036
004100*                                                           *     00410036
004200*************************************************************     00420036
004300* CHANGE LOG:                                               *     00430036
004400*                                                           *     00440036
004500* DATE  05/21/2007                                          *     00450036
004600*     CHANGE MADE: INITIAL IMPLEMENTATION.                  *     00460036
004700*     MADE BY: MIKE BESKE              WR/IR #: WR31780     *     00470036
004800*                                                           *     00480036
004900* DATE  08/16/2007                                          *     00490070
005000*     CHANGE MADE: ADDED ANOTHER CONDITION TO THE WHERE     *     00500070
005100*     CLAUSE OF THE DEPT_CSR TO ONLY EXTRACT VEND_TYP_IND = *     00510070
005200*     'M' (MERCHANDISE DEPARTMENTS).                        *     00520070
005300*     MADE BY: MIKE BESKE              WR/IR #: INC000000013399   00530072
005400*                                                           *     00540070
005500*************************************************************     00550036
005600                                                                  00560036
005700 ENVIRONMENT DIVISION.                                            00570036
005800                                                                  00580036
005900 INPUT-OUTPUT SECTION.                                            00590036
006000                                                                  00600036
006100 FILE-CONTROL.                                                    00610036
006200     SELECT VENDOR-EXTRACT-FILE           ASSIGN TO OUT01.        00620036
006300     SELECT VENDOR-ROLE-FILE              ASSIGN TO OUT02.        00630036
006400     SELECT VENDOR-DEPT-FILE              ASSIGN TO OUT03.        00640036
006500     SELECT VENDOR-CPBL-FILE              ASSIGN TO OUT04.        00650036
006600     SELECT VENDOR-AGRMT-FILE             ASSIGN TO OUT05.        00660036
006700     SELECT VENDOR-AGRMT-DUMP             ASSIGN TO OUT06.        00670051
006800                                                                  00680036
006900 DATA DIVISION.                                                   00690036
007000                                                                  00700036
007100 FILE SECTION.                                                    00710036
007200 FD  VENDOR-EXTRACT-FILE                                          00720036
007300     RECORDING MODE IS F                                          00730036
007400     LABEL RECORDS ARE STANDARD                                   00740036
007500     DATA RECORD IS VENDOR-EXTRACT-REC.                           00750036
007600 01  VENDOR-EXTRACT-REC            PIC X(136).                    00760036
007700                                                                  00770036
007800 FD  VENDOR-ROLE-FILE                                             00780036
007900     RECORDING MODE IS F                                          00790036
008000     LABEL RECORDS ARE STANDARD                                   00800036
008100     DATA RECORD IS VENDOR-ROLE-REC.                              00810036
008200 01  VENDOR-ROLE-REC               PIC X(013).                    00820036
008300                                                                  00830036
008400 FD  VENDOR-DEPT-FILE                                             00840036
008500     RECORDING MODE IS F                                          00850036
008600     LABEL RECORDS ARE STANDARD                                   00860036
008700     DATA RECORD IS VENDOR-DEPT-REC.                              00870036
008800 01  VENDOR-DEPT-REC               PIC X(027).                    00880055
008900                                                                  00890036
009000 FD  VENDOR-CPBL-FILE                                             00900036
009100     RECORDING MODE IS F                                          00910036
009200     LABEL RECORDS ARE STANDARD                                   00920036
009300     DATA RECORD IS VENDOR-CPBL-REC.                              00930036
009400 01  VENDOR-CPBL-REC               PIC X(057).                    00940036
009500                                                                  00950036
009600 FD  VENDOR-AGRMT-FILE                                            00960036
009700     RECORDING MODE IS F                                          00970036
009800     LABEL RECORDS ARE STANDARD                                   00980036
009900     DATA RECORD IS VENDOR-AGRMT-REC.                             00990036
010000 01  VENDOR-AGRMT-REC              PIC X(115).                    01000055
010100                                                                  01010051
010200 FD  VENDOR-AGRMT-DUMP                                            01020051
010300     RECORDING MODE IS F                                          01030051
010400     LABEL RECORDS ARE STANDARD                                   01040051
010500     DATA RECORD IS VENDOR-AGRMT-DUMP-REC.                        01050051
010600 01  VENDOR-AGRMT-DUMP-REC         PIC X(115).                    01060055
010700                                                                  01070036
010800 WORKING-STORAGE SECTION.                                         01080036
010900                                                                  01090036
011000 01  FILLER                        PIC X(25)  VALUE               01100036
011100                             'WS FOR VNKUT210 BEGINS==>'.         01110036
011200                                                                  01120036
011300 01  WS-RETRY-COUNTER              PIC S9(4)  COMP VALUE ZERO.    01130036
011400 01  WS-RETRY-MAX                  PIC S9(4)  COMP VALUE 3.       01140036
011500                                                                  01150036
011600 01  WS-INTEGER-UNPK               PIC S9(10).                    01160064
011700 01  WS-SMALLINT-UNPK              PIC S9(4).                     01170036
011800 01  WS-DEPT-NBR-999               PIC  9(3).                     01180036
011900 01  WS-CHARGE-UNPK                PIC S9(2)V9(4).                01190036
012000 01  WS-DISCOUNT-UNPK              PIC S9(2)V9(2).                01200036
012100 01  WS-AMOUNT-UNPK                PIC S9(8)V99.                  01210036
012200 01  WS-CHRG-PCT                   PIC S9(2)V9(4) COMP-3.         01220036
012300 01  WS-DISC-PCT                   PIC S9(2)V9(2) COMP-3.         01230036
012400                                                                  01240036
012500 01  WS-INTEGER-EDIT               PIC ++++++++++9.               01250064
012600 01  WS-ENT-ID-EDIT                PIC ZZZZZZZZZ9.                01260063
012700 01  WS-SMALLINT-EDIT              PIC +++++9.                    01270036
012800 01  WS-DEPT-NBR-EDIT              PIC +++999.                    01280055
012900 01  WS-PERCENT-EDIT               PIC ++++.999.                  01290036
013000 01  WS-AMOUNT-EDIT                PIC +++++++++.99.              01300036
013100                                                                  01310036
013200 01  PS-SWITCH-AREA.                                              01320036
013300     05  WS-END-OF-CURSOR-SW       PIC X(1)   VALUE 'N'.          01330036
013400         88  WS-END-OF-VENDOR-CSR             VALUE 'Y'.          01340036
013500     05  WS-END-OF-DEPT-CSR-SW     PIC X(1)   VALUE 'N'.          01350036
013600         88  WS-END-OF-DEPT-CSR               VALUE 'Y'.          01360036
013700         88  WS-NOT-END-OF-DEPT-CSR           VALUE 'N'.          01370036
013800     05  WS-END-OF-CPBL-CSR-SW     PIC X(1)   VALUE 'N'.          01380036
013900         88  WS-END-OF-CPBL-CSR               VALUE 'Y'.          01390036
014000         88  WS-NOT-END-OF-CPBL-CSR           VALUE 'N'.          01400036
014100     05  WS-END-OF-SHPG-CSR-SW     PIC X(1)   VALUE 'N'.          01410057
014200         88  WS-END-OF-SHPG-CSR               VALUE 'Y'.          01420057
014300         88  WS-NOT-END-OF-SHPG-CSR           VALUE 'N'.          01430057
014400     05  WS-END-OF-PAYT-CSR-SW     PIC X(1)   VALUE 'N'.          01440057
014500         88  WS-END-OF-PAYT-CSR               VALUE 'Y'.          01450057
014600         88  WS-NOT-END-OF-PAYT-CSR           VALUE 'N'.          01460057
014700     05  WS-END-OF-PRCH-CSR-SW     PIC X(1)   VALUE 'N'.          01470057
014800         88  WS-END-OF-PRCH-CSR               VALUE 'Y'.          01480057
014900         88  WS-NOT-END-OF-PRCH-CSR           VALUE 'N'.          01490057
015000     05  WS-END-OF-INCTV-CSR-SW    PIC X(1)   VALUE 'N'.          01500057
015100         88  WS-END-OF-INCTV-CSR              VALUE 'Y'.          01510057
015200         88  WS-NOT-END-OF-INCTV-CSR          VALUE 'N'.          01520057
015300     05  WS-END-OF-PGM-CSR-SW      PIC X(1)   VALUE 'N'.          01530057
015400         88  WS-END-OF-PGM-CSR                VALUE 'Y'.          01540057
015500         88  WS-NOT-END-OF-PGM-CSR            VALUE 'N'.          01550057
015600     05  WS-DONT-SKIP-PRCH-AGRMT-SW PIC X(1)  VALUE 'N'.          01560057
015700         88  WS-SKIP-PRCH-AGRMT               VALUE 'Y'.          01570057
015800         88  WS-DONT-SKIP-PRCH-AGRMT          VALUE 'N'.          01580057
015900                                                                  01590057
016000 01  WS-PROGRAM-COUNTERS.                                         01600057
016100     05  WS-VENDOR-ROWS-FETCHED    PIC 9(09)  VALUE ZEROS.        01610057
016200     05  WS-DEPT-ROWS-FETCHED      PIC 9(09)  VALUE ZEROS.        01620057
016300     05  WS-CPBL-ROWS-FETCHED      PIC 9(09)  VALUE ZEROS.        01630057
016400     05  WS-SHPG-ROWS-FETCHED      PIC 9(09)  VALUE ZEROS.        01640057
016500     05  WS-PAYT-ROWS-FETCHED      PIC 9(09)  VALUE ZEROS.        01650057
016600     05  WS-PRCH-ROWS-FETCHED      PIC 9(09)  VALUE ZEROS.        01660057
016700     05  WS-INCTV-ROWS-FETCHED     PIC 9(09)  VALUE ZEROS.        01670057
016800     05  WS-PGM-ROWS-FETCHED       PIC 9(09)  VALUE ZEROS.        01680057
016900     05  WS-PGM-ROWS-SKIPPED       PIC 9(09)  VALUE ZEROS.        01690057
017000     05  WS-HEADER-WRITTEN         PIC 9(09)  VALUE ZEROS.        01700057
017100     05  WS-ROLE-WRITTEN           PIC 9(09)  VALUE ZEROS.        01710057
017200     05  WS-DEPT-WRITTEN           PIC 9(09)  VALUE ZEROS.        01720057
017300     05  WS-CPBL-WRITTEN           PIC 9(09)  VALUE ZEROS.        01730057
017400     05  WS-AGRMT-WRITTEN          PIC 9(09)  VALUE ZEROS.        01740057
017500     05  WS-AGRMT-DUMP-WRITTEN     PIC 9(09)  VALUE ZEROS.        01750057
017600                                                                  01760057
017700*---------------------------------------------------------------* 01770057
017800* SQLA MESSAGE MODULE                                             01780057
017900*---------------------------------------------------------------* 01790057
018000     COPY DPWS004.                                                01800057
018100                                                                  01810057
018200*---------------------------------------------------------------* 01820057
018300*  OUTPUT FILE COPYBOOK CONTAINING DATA FOR CWT_EXENT CWT_EXP_VND 01830057
018400*  CWT_MDSE_VND EDW TABLES                                        01840057
018500*---------------------------------------------------------------* 01850057
018600     COPY VNRD210.                                                01860057
018700                                                                  01870057
018800*---------------------------------------------------------------* 01880057
018900*  OUTPUT FILE COPYBOOK CONTAINING DATA FOR CWT_EXENT_ROL_ASSN    01890057
019000*  EDW TABLE                                                      01900057
019100*---------------------------------------------------------------* 01910057
019200     COPY VNRD211.                                                01920057
019300                                                                  01930057
019400*---------------------------------------------------------------* 01940057
019500*  OUTPUT FILE COPYBOOK CONTAINING DATA FOR CWT_EXENT_DEPT_ASSN   01950057
019600*  EDW TABLE                                                      01960057
019700*---------------------------------------------------------------* 01970057
019800     COPY VNRD213.                                                01980057
019900                                                                  01990057
020000*---------------------------------------------------------------* 02000057
020100*  OUTPUT FILE COPYBOOK CONTAINING DATA FOR CWT_EXENT_CPBL_ASSN   02010057
020200*  EDW TABLE                                                      02020057
020300*---------------------------------------------------------------* 02030057
020400     COPY VNRD212.                                                02040057
020500                                                                  02050057
020600*---------------------------------------------------------------* 02060057
020700*  OUTPUT FILE COPYBOOK CONTAINING DATA FOR THE FOLLOWING EDW     02070057
020800*  TABLES: CWT_EXENT_AGRMT CWT_SHPG_AGRMT CWT_PAYT_AGRMT          02080057
020900*  CWT_PRCH_AGRMT CWT_INCTV_AGRMT CWT_PGM_AGRMT.                  02090057
021000*---------------------------------------------------------------* 02100057
021100     COPY VNRD214.                                                02110057
021200                                                                  02120057
021300 01  WS-ABEND-FIELDS.                                             02130057
021400     05  WS-ABEND-PROGRAM          PIC X(8)   VALUE 'VNKUT210'.   02140057
021500     05  WS-ABEND-PARAGRAPH        PIC X(50)  VALUE SPACES.       02150057
021600     05  WS-ABEND-OPERATION        PIC X(50)  VALUE SPACES.       02160057
021700     05  WS-ABEND-STRUCTURE-1      PIC X(8)   VALUE SPACES.       02170057
021800     05  WS-ABEND-STRUCTURE-2      PIC X(8)   VALUE SPACES.       02180057
021900     05  WS-ABEND-STATUS           PIC XX     VALUE SPACES.       02190057
022000                                                                  02200057
022100 01  ABEND-CODE                    PIC S9(4)  COMP SYNC           02210057
022200                                              VALUE ZEROS.        02220057
022300     88 AP-TABLE-FULL              VALUE +4004.                   02230057
022400     88 AP-EMPTY-FILE              VALUE +4005.                   02240057
022500     88 AP-DB2-ERROR               VALUE +4013.                   02250057
022600                                                                  02260057
022700*---------------------------------------------------------------* 02270057
022800*  COMMUNICATIONS AREA2 FOR DB2                                   02280057
022900*---------------------------------------------------------------* 02290057
023000     COPY SQLCA2.                                                 02300057
023100                                                                  02310057
023200*---------------------------------------------------------------* 02320057
023300* SQL COMMUNICATIONS AREA DCLGEN                                  02330057
023400*---------------------------------------------------------------* 02340057
023500     EXEC SQL                                                     02350057
023600          INCLUDE SQLCA                                           02360057
023700     END-EXEC.                                                    02370057
023800                                                                  02380057
023900*---------------------------------------------------------------* 02390057
024000* EXTERNAL ENTITY TABLE                                           02400057
024100*---------------------------------------------------------------* 02410057
024200     EXEC SQL                                                     02420057
024300          INCLUDE TEXTENT                                         02430057
024400     END-EXEC.                                                    02440057
024500                                                                  02450057
024600*---------------------------------------------------------------* 02460057
024700* ENTITY NAME TABLE                                               02470057
024800*---------------------------------------------------------------* 02480057
024900     EXEC SQL                                                     02490057
025000          INCLUDE TENTNME                                         02500057
025100     END-EXEC.                                                    02510057
025200                                                                  02520057
025300*---------------------------------------------------------------* 02530057
025400* VENDOR DEPARTMENT TABLE                                         02540057
025500*---------------------------------------------------------------* 02550057
025600     EXEC SQL                                                     02560057
025700          INCLUDE TVNDDPT                                         02570057
025800     END-EXEC.                                                    02580057
025900                                                                  02590057
026000*---------------------------------------------------------------* 02600057
026100* VENDOR CAPABILITIES TABLE                                       02610057
026200*---------------------------------------------------------------* 02620057
026300     EXEC SQL                                                     02630057
026400          INCLUDE VNT00001                                        02640057
026500     END-EXEC.                                                    02650057
026600                                                                  02660057
026700*---------------------------------------------------------------* 02670057
026800* VENDOR AGREEMENT TABLE                                          02680057
026900*---------------------------------------------------------------* 02690057
027000     EXEC SQL                                                     02700057
027100          INCLUDE TVNDAGR                                         02710057
027200     END-EXEC.                                                    02720057
027300                                                                  02730057
027400*---------------------------------------------------------------* 02740057
027500* VENDOR FREIGHT TERMS TABLE                                      02750057
027600*---------------------------------------------------------------* 02760057
027700     EXEC SQL                                                     02770057
027800          INCLUDE TFRGTRM                                         02780057
027900     END-EXEC.                                                    02790057
028000                                                                  02800057
028100*---------------------------------------------------------------* 02810057
028200* VENDOR INCENTIVE TYPE TABLE                                     02820057
028300*---------------------------------------------------------------* 02830057
028400     EXEC SQL                                                     02840057
028500          INCLUDE TINCTYP                                         02850057
028600     END-EXEC.                                                    02860057
028700                                                                  02870057
028800*--------------------------------------------------------------*  02880057
028900*   THIS IS THE CURSOR THAT RETREIVES THE VENDOR INFORMATION   *  02890057
029000*   NEEDED FOR THE EXTRACT FILES.                              *  02900057
029100*--------------------------------------------------------------*  02910057
029200     EXEC SQL                                                     02920057
029300        DECLARE VENDOR_CSR CURSOR FOR                             02930057
029400          SELECT A.ENT_ID                                         02940057
029500                ,A.DUN_NBR                                        02950057
029600                ,A.PRIM_TYP_CDE                                   02960057
029700                ,B.ENT_NAME_DESC                                  02970057
029800                ,A.STATUS_CDE                                     02980057
029900                ,A.CRE_TMST                                       02990057
030000                ,A.LAST_UPD_TMST                                  03000057
030100                ,A.SCAC_CDE                                       03010057
030200                ,A.CFY_SLSRNK_NBR                                 03020057
030300                ,A.PFY_SLSRNK_NBR                                 03030057
030400                ,A.P12MN_SLSRNK_NBR                               03040057
030500                ,A.PRTNR_IND                                      03050057
030600                ,A.PRTNR_TYP_CDE                                  03060057
030700                ,A.VND_CLSN_CDE                                   03070057
030800          FROM TEXTENT   A                                        03080057
030900              ,TENTNME   B                                        03090057
031000          WHERE A.ENT_ID   = B.ENT_ID                             03100057
031100            AND B.TYPE_CDE = '01'                                 03110057
031200          ORDER BY A.ENT_ID                                       03120057
031300     END-EXEC.                                                    03130057
031400                                                                  03140057
031500*---------------------------------------------------------------* 03150057
031600*   THIS IS THE CURSOR THAT RETRIEVES THE VENDOR/DEPT DATA      * 03160057
031700*   NEEDED FOR THE EXTRACT FILE                                 * 03170057
031800*---------------------------------------------------------------* 03180057
031900     EXEC SQL                                                     03190057
032000        DECLARE DEPT_CSR CURSOR FOR                               03200057
032100          SELECT A.DEPT_NBR                                       03210057
032200                ,A.VND_DEPT_STAT_CD                               03220057
032300                ,A.CRE_DTE                                        03230057
032400          FROM TVNDDPT A                                          03240057
032500          WHERE A.ENT_ID       = :EXTENT-ENT-ID                   03250057
032600            AND A.VEND_TYP_IND = 'M'                              03260070
032700          ORDER BY A.DEPT_NBR                                     03270057
032800     END-EXEC.                                                    03280057
032900                                                                  03290057
033000*---------------------------------------------------------------* 03300057
033100*   THIS IS THE CURSOR THAT RETRIEVES THE VENDOR CAPABILITY     * 03310057
033200*   DATA NEEDED FOR THE EXTRACT FILE                            * 03320057
033300*---------------------------------------------------------------* 03330057
033400     EXEC SQL                                                     03340057
033500        DECLARE CPBL_CSR CURSOR FOR                               03350057
033600          SELECT A.VND_CPBL_CDE                                   03360057
033700                ,A.CRE_DTE                                        03370057
033800                ,A.LAST_UPD_TMST                                  03380057
033900                ,A.LAST_UPD_BY_USR_ID                             03390057
034000          FROM VNT_VND_CPBL A                                     03400057
034100          WHERE A.ENT_ID       = :EXTENT-ENT-ID                   03410057
034200          ORDER BY A.VND_CPBL_CDE                                 03420057
034300     END-EXEC.                                                    03430057
034400                                                                  03440057
034500*----------------------------------------------------------------*03450057
034600* SHPG_CSR  WILL FIND ALL OF THE SHIPPING TERMS FOR THE VENDOR/  *03460057
034700* DEPARTMENT BEING PROCESSED.                                    *03470057
034800*----------------------------------------------------------------*03480057
034900     EXEC SQL                                                     03490057
035000       DECLARE SHPG_CSR CURSOR FOR                                03500057
035100       SELECT COALESCE(VT1.CHRG_FCTR_CDE,' ')                     03510057
035200             ,COALESCE(B.FRGT_TERM_ID,0)                          03520057
035300             ,COALESCE(VT1.LATE_SHIPT_IND,'N')                    03530057
035400             ,COALESCE(VT1.CHRG_PCT,0)                            03540057
035500             ,COALESCE(VT1.CHRG_AMT,0)                            03550067
035600             ,SEQ_NBR                                             03560057
035700             ,EFFECTIVE_DATE                                      03570057
035800             ,EXPIRATION_DATE                                     03580057
035900         FROM                                                     03590057
036000             (SELECT A.CHRG_FCTR_CDE                              03600057
036100                    ,A.FRGT_TERM_ID                               03610057
036200                    ,A.LATE_SHIPT_IND                             03620057
036300                    ,A.CHRG_PCT                                   03630057
036400                    ,A.CHRG_AMT                                   03640067
036500                    ,A.SEQ_NBR                                    03650057
036600                    ,A.EFFECTIVE_DATE                             03660057
036700                    ,A.EXPIRATION_DATE                            03670057
036800                FROM TVNDAGR A                                    03680057
036900               WHERE A.ENT_ID           = :EXTENT-ENT-ID          03690057
037000                 AND A.DEPT_NBR         = :VNDDPT-DEPT-NBR        03700057
037100                 AND A.AGRMT_TYP_ID     = '1'                     03710057
037200                 AND A.EXPIRATION_DATE >= '2005-01-01')           03720057
037300                                       AS VT1                     03730057
037400       LEFT OUTER JOIN TFRGTRM B                                  03740057
037500            ON B.FRGT_TERM_ID = VT1.FRGT_TERM_ID                  03750057
037600     END-EXEC.                                                    03760057
037700                                                                  03770057
037800*----------------------------------------------------------------*03780059
037900* PAYT_CSR  WILL FIND ALL OF THE PAYMENT TERMS FOR THE VENDOR/   *03790059
038000* DEPARTMENT BEING PROCESSED.                                    *03800059
038100*----------------------------------------------------------------*03810059
038200     EXEC SQL                                                     03820059
038300       DECLARE PAYT_CSR CURSOR FOR                                03830059
038400         SELECT COALESCE(PAYT_TERM_ID,0)                          03840059
038500               ,SEQ_NBR                                           03850059
038600               ,EFFECTIVE_DATE                                    03860059
038700               ,EXPIRATION_DATE                                   03870059
038800           FROM TVNDAGR                                           03880059
038900          WHERE ENT_ID           = :EXTENT-ENT-ID                 03890059
039000            AND DEPT_NBR         = :VNDDPT-DEPT-NBR               03900059
039100            AND AGRMT_TYP_ID     = '2'                            03910059
039200            AND EXPIRATION_DATE >= '2005-01-01'                   03920059
039300     END-EXEC.                                                    03930059
039400                                                                  03940059
039500*----------------------------------------------------------------*03950059
039600* PRCH_CSR WILL FIND ALL OF THE PURCHASE TERMS FOR THE VENDOR/   *03960059
039700* DEPARTMENT BEING PROCESSED.                                    *03970059
039800*----------------------------------------------------------------*03980059
039900     EXEC SQL                                                     03990059
040000       DECLARE PRCH_CSR CURSOR FOR                                04000059
040100         SELECT COALESCE(RTV_RA_REQD_IND,'N')                     04010059
040200               ,COALESCE(RTV_NO_RA_REQD_IND,'N')                  04020059
040300               ,COALESCE(DEBIT_DESTROY_IND,'N')                   04030059
040400               ,COALESCE(MARKOUT_IND,'N')                         04040059
040500               ,COALESCE(VND_AUTH_ID,'          ')                04050059
040600               ,SEQ_NBR                                           04060059
040700               ,EFFECTIVE_DATE                                    04070059
040800               ,EXPIRATION_DATE                                   04080059
040900           FROM TVNDAGR                                           04090059
041000          WHERE ENT_ID            = :EXTENT-ENT-ID                04100059
041100            AND DEPT_NBR          = :VNDDPT-DEPT-NBR              04110059
041200            AND AGRMT_TYP_ID      = '3'                           04120059
041300            AND EXPIRATION_DATE  >= '2005-01-01'                  04130059
041400     END-EXEC.                                                    04140059
041500                                                                  04150059
041600*----------------------------------------------------------------*04160059
041700* INCTV_CSR WILL FIND ALL OF THE DISCOUNTS FOR THE VENDOR/       *04170059
041800* DEPARTMENT BEING PROCESSED.                                    *04180059
041900*----------------------------------------------------------------*04190059
042000     EXEC SQL                                                     04200059
042100       DECLARE INCTV_CSR CURSOR FOR                               04210059
042200         SELECT E.TYP_CDE                                         04220059
042300               ,COALESCE(E.DISCOUNT_PCT,0)                        04230059
042400               ,COALESCE(E.EXT_PAY_DAYS_QTY,0)                    04240059
042500               ,E.SEQ_NBR                                         04250059
042600               ,E.EFFECTIVE_DATE                                  04260059
042700               ,E.EXPIRATION_DATE                                 04270059
042800           FROM TVNDAGR E                                         04280059
042900               ,TINCTYP F                                         04290059
043000          WHERE E.TYP_CDE           = F.INCENTIVE_ID              04300059
043100            AND E.ENT_ID            = :EXTENT-ENT-ID              04310059
043200            AND E.DEPT_NBR          = :VNDDPT-DEPT-NBR            04320059
043300            AND E.AGRMT_TYP_ID      = '5'                         04330059
043400            AND E.TYP_CDE      NOT IN (2,3,4,5,6)                 04340059
043500            AND E.EXPIRATION_DATE  >= '2005-01-01'                04350059
043600*           AND E.EFFECTIVE_DATE   <= CURRENT DATE                04360059
043700*           AND E.EXPIRATION_DATE  >  CURRENT DATE                04370059
043800     END-EXEC.                                                    04380059
043900                                                                  04390059
044000*----------------------------------------------------------------*04400059
044100* PGM_CSR WILL FIND ALL OF THE OFF INVOICE DATA FOR THE          *04410059
044200* VENDOR/DEPARTMENT BEING PROCESSED.                             *04420059
044300*----------------------------------------------------------------*04430059
044400     EXEC SQL                                                     04440059
044500       DECLARE PGM_CSR CURSOR FOR                                 04450059
044600         SELECT A.AP_TRN_CDE                                      04460059
044700               ,A.DISCOUNT_PCT                                    04470059
044800               ,A.PSTG_FRQ_CDE                                    04480059
044900               ,A.DED_DISC_IND                                    04490059
045000               ,A.DED_RTV_IND                                     04500059
045100               ,A.SEQ_NBR                                         04510059
045200               ,A.EFFECTIVE_DATE                                  04520059
045300               ,A.EXPIRATION_DATE                                 04530059
045400           FROM TVNDAGR A                                         04540059
045500          WHERE A.AGRMT_TYP_ID   = '6'                            04550059
045600            AND A.TYP_CDE        = 6                              04560059
045700            AND A.EXPIRATION_DATE  >= '2005-01-01'                04570059
045800*           AND (CURRENT DATE BETWEEN A.EFFECTIVE_DATE AND        04580059
045900*                                     A.EXPIRATION_DATE           04590059
046000*                OR A.EFFECTIVE_DATE > CURRENT DATE)              04600059
046100            AND A.ENT_ID         = :EXTENT-ENT-ID                 04610059
046200            AND A.DEPT_NBR       = :VNDDPT-DEPT-NBR               04620059
046300     END-EXEC.                                                    04630059
046400                                                                  04640059
046500 01  FILLER                        PIC X(25) VALUE                04650059
046600          '<====WS FOR VNKUT210 ENDS'.                            04660059
046700                                                                  04670059
046800 PROCEDURE DIVISION.                                              04680059
046900                                                                  04690059
047000*---------------------------------------------------------------* 04700059
047100*  MAIN PARAGRAPH.                                                04710059
047200*---------------------------------------------------------------* 04720059
047300 A100-MAINLINE.                                                   04730059
047400                                                                  04740059
047500     PERFORM B100-INITIALIZATION.                                 04750059
047600                                                                  04760059
047700     PERFORM B200-CREATE-VENDOR-EXTRACT                           04770059
047800       UNTIL WS-END-OF-VENDOR-CSR.                                04780059
047900                                                                  04790059
048000     PERFORM B300-END-OF-JOB.                                     04800059
048100                                                                  04810059
048200     GOBACK.                                                      04820059
048300                                                                  04830059
048400*---------------------------------------------------------------* 04840059
048500*  INITIALIZATION AND FETCH THE FIRST RECORD FROM THE             04850059
048600*  VENDOR CURSOR.                                                 04860059
048700*---------------------------------------------------------------* 04870059
048800 B100-INITIALIZATION.                                             04880059
048900                                                                  04890059
049000     DISPLAY '**********************************'                 04900059
049100     DISPLAY '*   STARTING PROGRAM VNKUT210    *'                 04910059
049200     DISPLAY '**********************************'                 04920059
049300                                                                  04930059
049400     OPEN OUTPUT VENDOR-EXTRACT-FILE                              04940059
049500                 VENDOR-ROLE-FILE                                 04950059
049600                 VENDOR-DEPT-FILE                                 04960059
049700                 VENDOR-CPBL-FILE                                 04970059
049800                 VENDOR-AGRMT-FILE                                04980059
049900                 VENDOR-AGRMT-DUMP.                               04990059
050000                                                                  05000059
050100     INITIALIZE DCLTEXTENT                                        05010059
050200                DCLTENTNME.                                       05020059
050300                                                                  05030059
050400     PERFORM Y100-OPEN-VENDOR-CSR.                                05040059
050500                                                                  05050059
050600     PERFORM R100-FETCH-VENDOR-CSR.                               05060059
050700                                                                  05070059
050800     IF WS-END-OF-VENDOR-CSR                                      05080059
050900        DISPLAY '**********************************'              05090059
051000        DISPLAY '*   PROGRAM ** = VNKUT210        *'              05100059
051100        DISPLAY '**********************************'              05110059
051200        DISPLAY '* NO ROWS WERE SELECTED FROM     *'              05120059
051300        DISPLAY '* THE VENDOR CURSOR.             *'              05130059
051400        DISPLAY '**********************************'              05140059
051500     END-IF.                                                      05150059
051600                                                                  05160059
051700*----------------------------------------------------------------*05170059
051800*  CREATE A VENDOR EXTRACT RECORD FOR EACH ROW RETRIEVED FROM    *05180059
051900*  THE VENDOR CURSOR.                                            *05190059
052000*----------------------------------------------------------------*05200059
052100 B200-CREATE-VENDOR-EXTRACT.                                      05210059
052200                                                                  05220059
052300     INITIALIZE VN210-RECORD.                                     05230059
052400                                                                  05240059
052500     MOVE EXTENT-ENT-ID           TO WS-INTEGER-UNPK.             05250059
052600     MOVE WS-INTEGER-UNPK         TO WS-ENT-ID-EDIT.              05260063
052700     MOVE WS-ENT-ID-EDIT          TO VN210-EXENT-ID.              05270063
052800                                                                  05280059
052900     MOVE EXTENT-DUN-NBR          TO VN210-EXENT-NBR.             05290059
053000                                                                  05300059
053100     IF EXTENT-PRIM-TYP-CDE = 'E'                                 05310059
053200**      EDW VENDOR TYPE IS EXPENSE                                05320059
053300        MOVE EXTENT-PRIM-TYP-CDE  TO VN210-VND-TYP-CDE            05330059
053400        PERFORM B250-CREATE-ROLE-EXTRACT                          05340059
053500        IF EXTENT-PRTNR-IND = 'Y'                                 05350059
053600**      EDW VENDOR TYPE IS PARTNER                                05360059
053700           MOVE 'P'               TO VN210-VND-TYP-CDE            05370059
053800           PERFORM B250-CREATE-ROLE-EXTRACT                       05380059
053900           PERFORM B275-CREATE-PARTNER-ROLE                       05390059
054000        END-IF                                                    05400059
054100        IF EXTENT-VND-CLSN-CDE = 'E'                              05410059
054200**      EDW VENDOR TYPE IS KOHLS EMPLOYEE                         05420059
054300           MOVE 'K'               TO VN210-VND-TYP-CDE            05430059
054400           PERFORM B250-CREATE-ROLE-EXTRACT                       05440059
054500        END-IF                                                    05450059
054600     ELSE                                                         05460059
054700**      EDW VENDOR TYPE IS MERCHANDISE OR FACTOR                  05470059
054800        MOVE EXTENT-PRIM-TYP-CDE  TO VN210-VND-TYP-CDE            05480059
054900        PERFORM B250-CREATE-ROLE-EXTRACT                          05490059
055000     END-IF.                                                      05500059
055100                                                                  05510059
055200     MOVE ENTNME-ENT-NAME-DESC    TO VN210-PRIM-EXENT-NM.         05520059
055300     MOVE EXTENT-STATUS-CDE       TO VN210-EXENT-ACTV-IND.        05530059
055400     MOVE EXTENT-CRE-TMST         TO VN210-SOR-CRE-TMST.          05540059
055500     MOVE EXTENT-LAST-UPD-TMST    TO VN210-SOR-LAST-UPD-TMST.     05550059
055600     MOVE EXTENT-SCAC-CDE         TO VN210-SCAC-CDE.              05560059
055700                                                                  05570059
055800     MOVE EXTENT-CFY-SLSRNK-NBR   TO WS-SMALLINT-UNPK.            05580059
055900     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            05590059
056000     MOVE WS-SMALLINT-EDIT        TO VN210-CFY-SLS-RNK-NBR.       05600059
056100                                                                  05610059
056200     MOVE EXTENT-PFY-SLSRNK-NBR   TO WS-SMALLINT-UNPK.            05620059
056300     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            05630059
056400     MOVE WS-SMALLINT-EDIT        TO VN210-PFY-SLS-RNK-NBR.       05640059
056500                                                                  05650059
056600     MOVE EXTENT-P12MN-SLSRNK-NBR TO WS-SMALLINT-UNPK.            05660059
056700     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            05670059
056800     MOVE WS-SMALLINT-EDIT     TO VN210-PREV-12-MN-SLS-RNK-NBR.   05680059
056900                                                                  05690059
057000     PERFORM S100-SELECT-SHORT-NAME.                              05700059
057100                                                                  05710059
057200     PERFORM C100-CHECK-FOR-DEPT.                                 05720059
057300                                                                  05730059
057400     PERFORM C200-CHECK-FOR-CPBL.                                 05740059
057500                                                                  05750059
057600     PERFORM W100-WRITE-VENDOR-REC.                               05760059
057700                                                                  05770059
057800     PERFORM R100-FETCH-VENDOR-CSR.                               05780059
057900                                                                  05790059
058000*----------------------------------------------------------------*05800059
058100*  CREATE A ROLE RECORD FOR THE VENDOR TYPE CDE FOR THE RETRIEVED*05810059
058200*  ROW FROM THE VENDOR CURSOR.                                   *05820059
058300*----------------------------------------------------------------*05830059
058400 B250-CREATE-ROLE-EXTRACT.                                        05840059
058500                                                                  05850059
058600     INITIALIZE VN211-RECORD.                                     05860059
058700                                                                  05870059
058800     MOVE VN210-EXENT-ID          TO VN211-EXENT-ID.              05880059
058900                                                                  05890059
059000     MOVE VN210-VND-TYP-CDE       TO VN211-EXENT-ROL-CDE.         05900059
059100                                                                  05910059
059200     PERFORM W200-WRITE-ROLE-REC.                                 05920059
059300                                                                  05930059
059400*----------------------------------------------------------------*05940059
059500*  CREATE A ROLE RECORD FOR THE PARTNER CODE FOR THE RETRIEVED   *05950059
059600*  ROW FROM THE VENDOR CURSOR.                                   *05960059
059700*----------------------------------------------------------------*05970059
059800 B275-CREATE-PARTNER-ROLE.                                        05980059
059900                                                                  05990059
060000     INITIALIZE VN211-RECORD.                                     06000059
060100                                                                  06010059
060200     MOVE VN210-EXENT-ID          TO VN211-EXENT-ID.              06020059
060300                                                                  06030059
060400     MOVE EXTENT-PRTNR-TYP-CDE    TO VN211-EXENT-ROL-CDE.         06040059
060500                                                                  06050059
060600     PERFORM W200-WRITE-ROLE-REC.                                 06060059
060700                                                                  06070059
060800*----------------------------------------------------------------*06080059
060900*  END OF PROGRAM PROCESSING.                                     06090059
061000*----------------------------------------------------------------*06100059
061100 B300-END-OF-JOB.                                                 06110059
061200                                                                  06120059
061300     PERFORM Y200-CLOSE-VENDOR-CSR.                               06130059
061400                                                                  06140059
061500     CLOSE VENDOR-EXTRACT-FILE                                    06150059
061600           VENDOR-ROLE-FILE                                       06160059
061700           VENDOR-DEPT-FILE                                       06170059
061800           VENDOR-CPBL-FILE                                       06180059
061900           VENDOR-AGRMT-FILE                                      06190059
062000           VENDOR-AGRMT-DUMP.                                     06200059
062100                                                                  06210059
062200     DISPLAY 'VENDOR ROWS FETCHED = ' WS-VENDOR-ROWS-FETCHED.     06220059
062300     DISPLAY 'DEPT ROWS FETCHED   = ' WS-DEPT-ROWS-FETCHED.       06230059
062400     DISPLAY 'CPBL ROWS FETCHED   = ' WS-CPBL-ROWS-FETCHED.       06240059
062500     DISPLAY 'SHPG ROWS FETCHED   = ' WS-SHPG-ROWS-FETCHED.       06250059
062600     DISPLAY 'PAYT ROWS FETCHED   = ' WS-PAYT-ROWS-FETCHED.       06260059
062700     DISPLAY 'PRCH ROWS FETCHED   = ' WS-PRCH-ROWS-FETCHED.       06270059
062800     DISPLAY 'INCTV ROWS FETCHED  = ' WS-INCTV-ROWS-FETCHED.      06280059
062900     DISPLAY 'PGM ROWS FETCHED    = ' WS-PGM-ROWS-FETCHED.        06290059
063000     DISPLAY 'PGM ROWS SKIPPED    = ' WS-PGM-ROWS-SKIPPED.        06300059
063100     DISPLAY 'EXENT HEADER RECORDS WRITTEN = ' WS-HEADER-WRITTEN. 06310059
063200     DISPLAY 'EXENT ROLE RECORDS WRITTEN   = ' WS-ROLE-WRITTEN.   06320059
063300     DISPLAY 'EXENT DEPT RECORDS WRITTEN   = ' WS-DEPT-WRITTEN.   06330059
063400     DISPLAY 'EXENT CPBL RECORDS WRITTEN   = ' WS-CPBL-WRITTEN.   06340059
063500     DISPLAY 'EXENT AGRMT RECORDS WRITTEN  = ' WS-AGRMT-WRITTEN.  06350059
063600     DISPLAY 'EXENT AGRMT DUMP RECS WRITTEN= '                    06360059
063700                                            WS-AGRMT-DUMP-WRITTEN.06370059
063800                                                                  06380059
063900     DISPLAY ' PROGRAM VNKUT210 ENDS NORMALLY '.                  06390059
064000                                                                  06400059
064100*----------------------------------------------------------------*06410059
064200*  CHECK FOR ANY DEPARTMENTS FOR THE VENDOR BEING PROCESSED.      06420059
064300*----------------------------------------------------------------*06430059
064400 C100-CHECK-FOR-DEPT.                                             06440059
064500                                                                  06450059
064600     INITIALIZE DCLTVNDDPT.                                       06460059
064700     SET WS-NOT-END-OF-DEPT-CSR TO TRUE.                          06470059
064800                                                                  06480059
064900     PERFORM Y300-OPEN-DEPT-CSR.                                  06490059
065000                                                                  06500059
065100     PERFORM R200-FETCH-DEPT-CSR.                                 06510059
065200                                                                  06520059
065300     IF WS-NOT-END-OF-DEPT-CSR                                    06530059
065400        PERFORM D100-CREATE-DEPT-EXTRACT UNTIL WS-END-OF-DEPT-CSR 06540059
065500     END-IF.                                                      06550059
065600                                                                  06560059
065700     PERFORM Y400-CLOSE-DEPT-CSR.                                 06570059
065800                                                                  06580059
065900*----------------------------------------------------------------*06590059
066000*  CHECK FOR ANY CAPABILITIES FOR THE VENDOR BEING PROCESSED.     06600059
066100*----------------------------------------------------------------*06610059
066200 C200-CHECK-FOR-CPBL.                                             06620059
066300                                                                  06630059
066400     INITIALIZE DCLVNT00001.                                      06640059
066500     SET WS-NOT-END-OF-CPBL-CSR TO TRUE.                          06650059
066600                                                                  06660059
066700     PERFORM Y500-OPEN-CPBL-CSR.                                  06670059
066800                                                                  06680059
066900     PERFORM R300-FETCH-CPBL-CSR.                                 06690059
067000                                                                  06700059
067100     IF WS-NOT-END-OF-CPBL-CSR                                    06710059
067200        PERFORM D200-CREATE-CPBL-EXTRACT UNTIL WS-END-OF-CPBL-CSR 06720059
067300     END-IF.                                                      06730059
067400                                                                  06740059
067500     PERFORM Y600-CLOSE-CPBL-CSR.                                 06750059
067600                                                                  06760059
067700*----------------------------------------------------------------*06770059
067800*  PROCESS ANY DEPARTMENTS FOR THE VENDOR BEING PROCESSED.        06780059
067900*----------------------------------------------------------------*06790059
068000 D100-CREATE-DEPT-EXTRACT.                                        06800059
068100                                                                  06810059
068200     INITIALIZE VN213-RECORD.                                     06820059
068300                                                                  06830059
068400     MOVE VN210-EXENT-ID          TO VN213-EXENT-ID.              06840059
068500                                                                  06850059
068600     MOVE VNDDPT-DEPT-NBR         TO WS-DEPT-NBR-999.             06860059
068700     MOVE WS-DEPT-NBR-999         TO WS-DEPT-NBR-EDIT.            06870059
068800     MOVE WS-DEPT-NBR-EDIT        TO VN213-DEPT-NBR.              06880059
068900                                                                  06890059
069000     MOVE VNDDPT-VND-DEPT-STAT-CD TO VN213-EXENT-DEPT-ACTV-IND.   06900059
069100     MOVE VNDDPT-CRE-DTE          TO VN213-SOR-CRE-DTE.           06910059
069200                                                                  06920059
069300     PERFORM D300-CHECK-FOR-AGREEMENTS.                           06930059
069400                                                                  06940059
069500     PERFORM W300-WRITE-DEPT-REC.                                 06950059
069600                                                                  06960059
069700     PERFORM R200-FETCH-DEPT-CSR.                                 06970059
069800                                                                  06980059
069900*----------------------------------------------------------------*06990059
070000*  PROCESS ANY CAPABILITIES FOR THE VENDOR BEING PROCESSED.       07000059
070100*----------------------------------------------------------------*07010059
070200 D200-CREATE-CPBL-EXTRACT.                                        07020059
070300                                                                  07030059
070400     INITIALIZE VN212-RECORD.                                     07040059
070500                                                                  07050059
070600     MOVE VN210-EXENT-ID          TO VN212-EXENT-ID.              07060059
070700     MOVE VNT00001-VND-CPBL-CDE   TO VN212-EXENT-CPBL-CDE.        07070059
070800     MOVE VNT00001-CRE-DTE        TO VN212-SOR-CRE-DTE.           07080059
070900     MOVE VNT00001-LAST-UPD-TMST  TO VN212-SOR-LAST-UPD-TMST.     07090059
071000     MOVE VNT00001-LAST-UPD-BY-USR-ID TO VN212-SOR-LAST-UPD-USRID.07100059
071100                                                                  07110059
071200     PERFORM W400-WRITE-CPBL-REC.                                 07120059
071300                                                                  07130059
071400     PERFORM R300-FETCH-CPBL-CSR.                                 07140059
071500                                                                  07150059
071600*----------------------------------------------------------------*07160059
071700*  CHECK FOR ANY AGREEMENTS FOR THE VENDOR BEING PROCESSED.       07170059
071800*----------------------------------------------------------------*07180059
071900 D300-CHECK-FOR-AGREEMENTS.                                       07190059
072000                                                                  07200059
072100     INITIALIZE DCLTVNDAGR                                        07210059
072200                DCLTFRGTRM                                        07220059
072300                DCLTINCTYP.                                       07230059
072400                                                                  07240059
072500     PERFORM S200-SELECT-SHPG-TERMS.                              07250059
072600     PERFORM S300-SELECT-PAYT-TERMS.                              07260059
072700     PERFORM S400-SELECT-PRCH-TERMS.                              07270059
072800     PERFORM S500-SELECT-INCTV-TERMS.                             07280059
072900     PERFORM S600-SELECT-PGM-TERMS.                               07290059
073000                                                                  07300059
073100*----------------------------------------------------------------*07310059
073200*  FETCH THE NEXT ROW FROM THE VENDOR CURSOR.                     07320059
073300*----------------------------------------------------------------*07330059
073400 R100-FETCH-VENDOR-CSR.                                           07340059
073500                                                                  07350059
073600     EXEC SQL                                                     07360059
073700         FETCH VENDOR_CSR                                         07370059
073800          INTO :EXTENT-ENT-ID                                     07380059
073900              ,:EXTENT-DUN-NBR                                    07390059
074000              ,:EXTENT-PRIM-TYP-CDE                               07400059
074100              ,:ENTNME-ENT-NAME-DESC                              07410059
074200              ,:EXTENT-STATUS-CDE                                 07420059
074300              ,:EXTENT-CRE-TMST                                   07430059
074400              ,:EXTENT-LAST-UPD-TMST                              07440059
074500              ,:EXTENT-SCAC-CDE                                   07450059
074600              ,:EXTENT-CFY-SLSRNK-NBR                             07460059
074700              ,:EXTENT-PFY-SLSRNK-NBR                             07470059
074800              ,:EXTENT-P12MN-SLSRNK-NBR                           07480059
074900              ,:EXTENT-PRTNR-IND                                  07490059
075000              ,:EXTENT-PRTNR-TYP-CDE                              07500059
075100              ,:EXTENT-VND-CLSN-CDE                               07510059
075200     END-EXEC.                                                    07520059
075300                                                                  07530059
075400     EVALUATE TRUE                                                07540059
075500         WHEN SQLCODE = ZERO                                      07550059
075600              ADD 1                 TO WS-VENDOR-ROWS-FETCHED     07560059
075700         WHEN SQLCODE = +100                                      07570059
075800              SET WS-END-OF-VENDOR-CSR TO TRUE                    07580059
075900         WHEN SQLWARN0 NOT = SPACES                               07590059
076000         WHEN SQLCODE  NOT = ZERO                                 07600059
076100           MOVE 'R100-FETCH-VENDOR-CSR        '                   07610059
076200                           TO WS-ABEND-PARAGRAPH                  07620059
076300           MOVE 'UNSUCCESSFUL FETCH '                             07630059
076400                           TO WS-ABEND-OPERATION                  07640059
076500           MOVE 'TEXTENT'  TO WS-ABEND-STRUCTURE-1                07650059
076600           MOVE 'TENTNME ' TO WS-ABEND-STRUCTURE-2                07660059
076700           PERFORM Z999-SQL-ERROR                                 07670059
076800     END-EVALUATE.                                                07680059
076900                                                                  07690059
077000*----------------------------------------------------------------*07700059
077100*  FETCH THE NEXT ROW FROM THE DEPT CURSOR.                       07710059
077200*----------------------------------------------------------------*07720059
077300 R200-FETCH-DEPT-CSR.                                             07730059
077400                                                                  07740059
077500     EXEC SQL                                                     07750059
077600         FETCH DEPT_CSR                                           07760059
077700          INTO :VNDDPT-DEPT-NBR                                   07770059
077800              ,:VNDDPT-VND-DEPT-STAT-CD                           07780059
077900              ,:VNDDPT-CRE-DTE                                    07790059
078000     END-EXEC.                                                    07800059
078100                                                                  07810059
078200     EVALUATE TRUE                                                07820059
078300         WHEN SQLCODE = ZERO                                      07830059
078400              ADD 1                 TO WS-DEPT-ROWS-FETCHED       07840059
078500         WHEN SQLCODE = +100                                      07850059
078600              SET WS-END-OF-DEPT-CSR TO TRUE                      07860059
078700         WHEN SQLWARN0 NOT = SPACES                               07870059
078800         WHEN SQLCODE  NOT = ZERO                                 07880059
078900           MOVE 'R200-FETCH-DEPT-CSR          '                   07890059
079000                           TO WS-ABEND-PARAGRAPH                  07900059
079100           MOVE 'UNSUCCESSFUL FETCH '                             07910059
079200                           TO WS-ABEND-OPERATION                  07920059
079300           MOVE 'TVNDDPT'  TO WS-ABEND-STRUCTURE-1                07930059
079400           MOVE '        ' TO WS-ABEND-STRUCTURE-2                07940059
079500           PERFORM Z999-SQL-ERROR                                 07950059
079600     END-EVALUATE.                                                07960059
079700                                                                  07970059
079800*----------------------------------------------------------------*07980059
079900*  FETCH THE NEXT ROW FROM THE CPBL CURSOR.                       07990059
080000*----------------------------------------------------------------*08000059
080100 R300-FETCH-CPBL-CSR.                                             08010059
080200                                                                  08020059
080300     EXEC SQL                                                     08030059
080400         FETCH CPBL_CSR                                           08040059
080500          INTO :VNT00001-VND-CPBL-CDE                             08050059
080600              ,:VNT00001-CRE-DTE                                  08060059
080700              ,:VNT00001-LAST-UPD-TMST                            08070059
080800              ,:VNT00001-LAST-UPD-BY-USR-ID                       08080059
080900     END-EXEC.                                                    08090059
081000                                                                  08100059
081100     EVALUATE TRUE                                                08110059
081200         WHEN SQLCODE = ZERO                                      08120059
081300              ADD 1                 TO WS-CPBL-ROWS-FETCHED       08130059
081400         WHEN SQLCODE = +100                                      08140059
081500              SET WS-END-OF-CPBL-CSR TO TRUE                      08150059
081600         WHEN SQLWARN0 NOT = SPACES                               08160059
081700         WHEN SQLCODE  NOT = ZERO                                 08170059
081800           MOVE 'R300-FETCH-CPBL-CSR          '                   08180059
081900                           TO WS-ABEND-PARAGRAPH                  08190059
082000           MOVE 'UNSUCCESSFUL FETCH '                             08200059
082100                           TO WS-ABEND-OPERATION                  08210059
082200           MOVE 'VNT00001' TO WS-ABEND-STRUCTURE-1                08220059
082300           MOVE '        ' TO WS-ABEND-STRUCTURE-2                08230059
082400           PERFORM Z999-SQL-ERROR                                 08240059
082500     END-EVALUATE.                                                08250059
082600                                                                  08260059
082700*----------------------------------------------------------------*08270059
082800*  FETCH THE NEXT ROW FROM THE SHPG CURSOR.                       08280059
082900*----------------------------------------------------------------*08290059
083000 R400-FETCH-SHPG-CSR.                                             08300059
083100                                                                  08310059
083200     EXEC SQL                                                     08320059
083300         FETCH SHPG_CSR                                           08330059
083400          INTO :VNDAGR-CHRG-FCTR-CDE                              08340059
083500              ,:FRGTRM-FRGT-TERM-ID                               08350059
083600              ,:VNDAGR-LATE-SHIPT-IND                             08360059
083700              ,:VNDAGR-CHRG-PCT                                   08370059
083800              ,:VNDAGR-CHRG-AMT                                   08380067
083900              ,:VNDAGR-SEQ-NBR                                    08390059
084000              ,:VNDAGR-EFFECTIVE-DATE                             08400059
084100              ,:VNDAGR-EXPIRATION-DATE                            08410059
084200     END-EXEC.                                                    08420059
084300                                                                  08430059
084400     EVALUATE TRUE                                                08440059
084500         WHEN SQLCODE = ZERO                                      08450059
084600              ADD 1                 TO WS-SHPG-ROWS-FETCHED       08460059
084700         WHEN SQLCODE = +100                                      08470059
084800              SET WS-END-OF-SHPG-CSR TO TRUE                      08480059
084900         WHEN SQLWARN0 NOT = SPACES                               08490059
085000         WHEN SQLCODE  NOT = ZERO                                 08500059
085100           MOVE 'R400-FETCH-SHPG-CSR          '                   08510059
085200                           TO WS-ABEND-PARAGRAPH                  08520059
085300           MOVE 'UNSUCCESSFUL FETCH '                             08530059
085400                           TO WS-ABEND-OPERATION                  08540059
085500           MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1                08550059
085600           MOVE 'TFRGTRM ' TO WS-ABEND-STRUCTURE-2                08560059
085700           PERFORM Z999-SQL-ERROR                                 08570059
085800     END-EVALUATE.                                                08580059
085900                                                                  08590059
086000*----------------------------------------------------------------*08600059
086100*  FETCH THE NEXT ROW FROM THE PAYT CURSOR.                       08610059
086200*----------------------------------------------------------------*08620059
086300 R410-FETCH-PAYT-CSR.                                             08630059
086400                                                                  08640059
086500     EXEC SQL                                                     08650059
086600         FETCH PAYT_CSR                                           08660059
086700          INTO :VNDAGR-PAYT-TERM-ID                               08670059
086800              ,:VNDAGR-SEQ-NBR                                    08680059
086900              ,:VNDAGR-EFFECTIVE-DATE                             08690059
087000              ,:VNDAGR-EXPIRATION-DATE                            08700059
087100     END-EXEC.                                                    08710059
087200                                                                  08720059
087300     EVALUATE TRUE                                                08730059
087400         WHEN SQLCODE = ZERO                                      08740059
087500              ADD 1                 TO WS-PAYT-ROWS-FETCHED       08750059
087600         WHEN SQLCODE = +100                                      08760059
087700              SET WS-END-OF-PAYT-CSR TO TRUE                      08770059
087800         WHEN SQLWARN0 NOT = SPACES                               08780059
087900         WHEN SQLCODE  NOT = ZERO                                 08790059
088000           MOVE 'R410-FETCH-PAYT-CSR          '                   08800059
088100                           TO WS-ABEND-PARAGRAPH                  08810059
088200           MOVE 'UNSUCCESSFUL FETCH '                             08820059
088300                           TO WS-ABEND-OPERATION                  08830059
088400           MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1                08840059
088500           MOVE '        ' TO WS-ABEND-STRUCTURE-2                08850059
088600           PERFORM Z999-SQL-ERROR                                 08860059
088700     END-EVALUATE.                                                08870059
088800                                                                  08880059
088900*----------------------------------------------------------------*08890059
089000*  FETCH THE NEXT ROW FROM THE PRCH CURSOR.                       08900059
089100*----------------------------------------------------------------*08910059
089200 R420-FETCH-PRCH-CSR.                                             08920059
089300                                                                  08930059
089400     EXEC SQL                                                     08940059
089500         FETCH PRCH_CSR                                           08950059
089600          INTO :VNDAGR-RTV-RA-REQD-IND                            08960059
089700              ,:VNDAGR-RTV-NO-RA-REQD-IND                         08970059
089800              ,:VNDAGR-DEBIT-DESTROY-IND                          08980059
089900              ,:VNDAGR-MARKOUT-IND                                08990059
090000              ,:VNDAGR-VND-AUTH-ID                                09000059
090100              ,:VNDAGR-SEQ-NBR                                    09010059
090200              ,:VNDAGR-EFFECTIVE-DATE                             09020059
090300              ,:VNDAGR-EXPIRATION-DATE                            09030059
090400     END-EXEC.                                                    09040059
090500                                                                  09050059
090600     EVALUATE TRUE                                                09060059
090700         WHEN SQLCODE = ZERO                                      09070059
090800              ADD 1                 TO WS-PRCH-ROWS-FETCHED       09080059
090900         WHEN SQLCODE = +100                                      09090059
091000              SET WS-END-OF-PRCH-CSR TO TRUE                      09100059
091100         WHEN SQLWARN0 NOT = SPACES                               09110059
091200         WHEN SQLCODE  NOT = ZERO                                 09120059
091300           MOVE 'R420-FETCH-PRCH-CSR          '                   09130059
091400                           TO WS-ABEND-PARAGRAPH                  09140059
091500           MOVE 'UNSUCCESSFUL FETCH '                             09150059
091600                           TO WS-ABEND-OPERATION                  09160059
091700           MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1                09170059
091800           MOVE '        ' TO WS-ABEND-STRUCTURE-2                09180059
091900           PERFORM Z999-SQL-ERROR                                 09190059
092000     END-EVALUATE.                                                09200059
092100                                                                  09210059
092200*----------------------------------------------------------------*09220059
092300*  FETCH THE NEXT ROW FROM THE INCTV CURSOR.                      09230059
092400*----------------------------------------------------------------*09240059
092500 R430-FETCH-INCTV-CSR.                                            09250059
092600                                                                  09260059
092700     EXEC SQL                                                     09270059
092800         FETCH INCTV_CSR                                          09280059
092900          INTO :VNDAGR-TYP-CDE                                    09290059
093000              ,:VNDAGR-DISCOUNT-PCT                               09300059
093100              ,:VNDAGR-EXT-PAY-DAYS-QTY                           09310059
093200              ,:VNDAGR-SEQ-NBR                                    09320059
093300              ,:VNDAGR-EFFECTIVE-DATE                             09330059
093400              ,:VNDAGR-EXPIRATION-DATE                            09340059
093500     END-EXEC.                                                    09350059
093600                                                                  09360059
093700     EVALUATE TRUE                                                09370059
093800         WHEN SQLCODE = ZERO                                      09380059
093900              ADD 1                 TO WS-INCTV-ROWS-FETCHED      09390059
094000         WHEN SQLCODE = +100                                      09400059
094100              SET WS-END-OF-INCTV-CSR TO TRUE                     09410059
094200         WHEN SQLWARN0 NOT = SPACES                               09420059
094300         WHEN SQLCODE  NOT = ZERO                                 09430059
094400           MOVE 'R430-FETCH-INCTV-CSR         '                   09440059
094500                           TO WS-ABEND-PARAGRAPH                  09450059
094600           MOVE 'UNSUCCESSFUL FETCH '                             09460059
094700                           TO WS-ABEND-OPERATION                  09470059
094800           MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1                09480059
094900           MOVE 'TINCTYP ' TO WS-ABEND-STRUCTURE-2                09490059
095000           PERFORM Z999-SQL-ERROR                                 09500059
095100     END-EVALUATE.                                                09510059
095200                                                                  09520059
095300*----------------------------------------------------------------*09530059
095400*  FETCH THE NEXT ROW FROM THE PGM CURSOR.                        09540059
095500*----------------------------------------------------------------*09550059
095600 R440-FETCH-PGM-CSR.                                              09560059
095700                                                                  09570059
095800     EXEC SQL                                                     09580059
095900         FETCH PGM_CSR                                            09590059
096000          INTO :VNDAGR-AP-TRN-CDE                                 09600059
096100              ,:VNDAGR-DISCOUNT-PCT                               09610059
096200              ,:VNDAGR-PSTG-FRQ-CDE                               09620059
096300              ,:VNDAGR-DED-DISC-IND                               09630059
096400              ,:VNDAGR-DED-RTV-IND                                09640059
096500              ,:VNDAGR-SEQ-NBR                                    09650059
096600              ,:VNDAGR-EFFECTIVE-DATE                             09660059
096700              ,:VNDAGR-EXPIRATION-DATE                            09670059
096800     END-EXEC.                                                    09680059
096900                                                                  09690059
097000     EVALUATE TRUE                                                09700059
097100         WHEN SQLCODE = ZERO                                      09710059
097200              ADD 1                 TO WS-PGM-ROWS-FETCHED        09720059
097300         WHEN SQLCODE = +100                                      09730059
097400              SET WS-END-OF-PGM-CSR TO TRUE                       09740059
097500         WHEN SQLWARN0 NOT = SPACES                               09750059
097600         WHEN SQLCODE  NOT = ZERO                                 09760059
097700           MOVE 'R440-FETCH-PGM-CSR           '                   09770059
097800                           TO WS-ABEND-PARAGRAPH                  09780059
097900           MOVE 'UNSUCCESSFUL FETCH '                             09790059
098000                           TO WS-ABEND-OPERATION                  09800059
098100           MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1                09810059
098200           MOVE '        ' TO WS-ABEND-STRUCTURE-2                09820059
098300           PERFORM Z999-SQL-ERROR                                 09830059
098400     END-EVALUATE.                                                09840059
098500                                                                  09850059
098600*----------------------------------------------------------------*09860059
098700*  SELECT VENDOR SHORT NAME                                       09870059
098800*----------------------------------------------------------------*09880059
098900 S100-SELECT-SHORT-NAME.                                          09890059
099000                                                                  09900059
099100     EXEC SQL                                                     09910059
099200       SELECT ENT_NAME_DESC                                       09920059
099300         INTO :ENTNME-ENT-NAME-DESC                               09930059
099400         FROM TENTNME                                             09940059
099500        WHERE ENT_ID = :EXTENT-ENT-ID                             09950059
099600          AND TYPE_CDE = '04'                                     09960059
099700     END-EXEC.                                                    09970059
099800                                                                  09980059
099900     EVALUATE TRUE                                                09990059
100000       WHEN SQLCODE = ZERO                                        10000059
100100          MOVE ENTNME-ENT-NAME-DESC(1:10) TO VN210-SHRT-EXENT-NM  10010059
100200       WHEN SQLCODE = +100                                        10020059
100300          MOVE SPACES                     TO VN210-SHRT-EXENT-NM  10030059
100400       WHEN SQLWARN0 NOT = SPACE                                  10040059
100500       WHEN SQLCODE NOT = ZERO                                    10050059
100600          MOVE 'S100-SELECT-SHORT-NAME' TO WS-ABEND-PARAGRAPH     10060059
100700          MOVE 'UNSUCCESSFUL SELECT'    TO WS-ABEND-OPERATION     10070059
100800          MOVE 'TENTNME'                TO WS-ABEND-STRUCTURE-1   10080059
100900          MOVE SPACES                   TO WS-ABEND-STRUCTURE-2   10090059
101000          PERFORM Z999-SQL-ERROR                                  10100059
101100     END-EVALUATE.                                                10110059
101200                                                                  10120059
101300*----------------------------------------------------------------*10130059
101400*  SELECT VENDOR AGREEMENT SHIPPING TERMS                         10140059
101500*----------------------------------------------------------------*10150059
101600 S200-SELECT-SHPG-TERMS.                                          10160059
101700                                                                  10170059
101800     SET WS-NOT-END-OF-SHPG-CSR TO TRUE.                          10180059
101900                                                                  10190059
102000     PERFORM Y700-OPEN-SHPG-CSR.                                  10200059
102100                                                                  10210059
102200     PERFORM R400-FETCH-SHPG-CSR.                                 10220059
102300                                                                  10230059
102400     IF WS-NOT-END-OF-SHPG-CSR                                    10240059
102500       PERFORM T200-CREATE-SHPG-AGRMT-EXTRACT UNTIL               10250059
102600                                              WS-END-OF-SHPG-CSR  10260059
102700     END-IF.                                                      10270059
102800                                                                  10280059
102900     PERFORM Y800-CLOSE-SHPG-CSR.                                 10290059
103000                                                                  10300059
103100*----------------------------------------------------------------*10310059
103200*  SELECT VENDOR AGREEMENT PAYMENT TERMS                          10320059
103300*----------------------------------------------------------------*10330059
103400 S300-SELECT-PAYT-TERMS.                                          10340059
103500                                                                  10350059
103600     SET WS-NOT-END-OF-PAYT-CSR TO TRUE.                          10360059
103700                                                                  10370059
103800     PERFORM Y710-OPEN-PAYT-CSR.                                  10380059
103900                                                                  10390059
104000     PERFORM R410-FETCH-PAYT-CSR.                                 10400059
104100                                                                  10410059
104200     IF WS-NOT-END-OF-PAYT-CSR                                    10420059
104300       PERFORM T300-CREATE-PAYT-AGRMT-EXTRACT UNTIL               10430059
104400                                              WS-END-OF-PAYT-CSR  10440059
104500     END-IF.                                                      10450059
104600                                                                  10460059
104700     PERFORM Y810-CLOSE-PAYT-CSR.                                 10470059
104800                                                                  10480059
104900*----------------------------------------------------------------*10490059
105000*  SELECT VENDOR AGREEMENT PURCHASE TERMS                         10500059
105100*----------------------------------------------------------------*10510059
105200 S400-SELECT-PRCH-TERMS.                                          10520059
105300                                                                  10530059
105400     SET WS-NOT-END-OF-PRCH-CSR TO TRUE.                          10540059
105500                                                                  10550059
105600     PERFORM Y720-OPEN-PRCH-CSR.                                  10560059
105700                                                                  10570059
105800     PERFORM R420-FETCH-PRCH-CSR.                                 10580059
105900                                                                  10590059
106000     IF WS-NOT-END-OF-PRCH-CSR                                    10600059
106100       PERFORM T400-CREATE-PRCH-AGRMT-EXTRACT UNTIL               10610059
106200                                              WS-END-OF-PRCH-CSR  10620059
106300     END-IF.                                                      10630059
106400                                                                  10640059
106500     PERFORM Y820-CLOSE-PRCH-CSR.                                 10650059
106600                                                                  10660059
106700*----------------------------------------------------------------*10670059
106800*  SELECT VENDOR AGREEMENT INCENTIVE TERMS                        10680059
106900*----------------------------------------------------------------*10690059
107000 S500-SELECT-INCTV-TERMS.                                         10700059
107100                                                                  10710059
107200     SET WS-NOT-END-OF-INCTV-CSR TO TRUE.                         10720059
107300                                                                  10730059
107400     PERFORM Y730-OPEN-INCTV-CSR.                                 10740059
107500                                                                  10750059
107600     PERFORM R430-FETCH-INCTV-CSR.                                10760059
107700                                                                  10770059
107800     IF WS-NOT-END-OF-INCTV-CSR                                   10780059
107900       PERFORM T500-CREATE-INCTV-EXTRACT UNTIL WS-END-OF-INCTV-CSR10790059
108000     END-IF.                                                      10800059
108100                                                                  10810059
108200     PERFORM Y830-CLOSE-INCTV-CSR.                                10820059
108300                                                                  10830059
108400*----------------------------------------------------------------*10840059
108500*  SELECT VENDOR AGREEMENT PROGRAM TERMS                          10850059
108600*----------------------------------------------------------------*10860059
108700 S600-SELECT-PGM-TERMS.                                           10870059
108800                                                                  10880059
108900     SET WS-NOT-END-OF-PGM-CSR TO TRUE.                           10890059
109000                                                                  10900059
109100     PERFORM Y740-OPEN-PGM-CSR.                                   10910059
109200                                                                  10920059
109300     PERFORM R440-FETCH-PGM-CSR.                                  10930059
109400                                                                  10940059
109500     IF WS-NOT-END-OF-PGM-CSR                                     10950059
109600       PERFORM T600-CREATE-PGM-EXTRACT UNTIL WS-END-OF-PGM-CSR    10960059
109700     END-IF.                                                      10970059
109800                                                                  10980059
109900     PERFORM Y840-CLOSE-PGM-CSR.                                  10990059
110000                                                                  11000059
110100*----------------------------------------------------------------*11010059
110200*  PROCESS SHPG AGRMT FOR THE VENDOR BEING PROCESSED.             11020059
110300*----------------------------------------------------------------*11030059
110400 T200-CREATE-SHPG-AGRMT-EXTRACT.                                  11040059
110500                                                                  11050059
110600     INITIALIZE VN214-RECORD.                                     11060059
110700                                                                  11070059
110800     MOVE VN210-EXENT-ID          TO VN214-EXENT-ID.              11080059
110900     MOVE VN213-DEPT-NBR          TO VN214-DEPT-NBR.              11090059
111000     MOVE '1'                     TO VN214-VND-AGRMT-TYP-CDE.     11100059
111100                                                                  11110059
111200     MOVE VNDAGR-SEQ-NBR          TO WS-SMALLINT-UNPK.            11120059
111300     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            11130059
111400     MOVE WS-SMALLINT-EDIT        TO VN214-VND-AGRMT-SEQ-NBR.     11140059
111500                                                                  11150059
111600     MOVE VNDAGR-EFFECTIVE-DATE   TO VN214-SOR-EFF-BEG-DTE.       11160059
111700     MOVE VNDAGR-EXPIRATION-DATE  TO VN214-SOR-EFF-EXPRN-DTE.     11170059
111800                                                                  11180059
111900     MOVE FRGTRM-FRGT-TERM-ID     TO WS-SMALLINT-UNPK.            11190059
112000     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            11200059
112100     MOVE WS-SMALLINT-EDIT        TO VN214-FRGT-TERM-ID.          11210059
112200                                                                  11220059
112300     MOVE VNDAGR-CHRG-FCTR-CDE    TO VN214-CHRG-FCTR-CDE.         11230059
112400     MOVE VNDAGR-LATE-SHIPT-IND   TO VN214-LTE-SHIPT-IND.         11240059
112500                                                                  11250059
112600     COMPUTE WS-CHRG-PCT = VNDAGR-CHRG-PCT * 100.                 11260059
112700     MOVE WS-CHRG-PCT             TO WS-CHARGE-UNPK.              11270059
112800     MOVE WS-CHARGE-UNPK          TO WS-PERCENT-EDIT.             11280059
112900     MOVE WS-PERCENT-EDIT         TO VN214-CHRG-PCT.              11290059
113000                                                                  11300059
113100     MOVE VNDAGR-CHRG-AMT         TO WS-AMOUNT-UNPK.              11310067
113200     MOVE WS-AMOUNT-UNPK          TO WS-AMOUNT-EDIT.              11320059
113300     MOVE WS-AMOUNT-EDIT          TO VN214-CHRG-AMT.              11330059
113400                                                                  11340059
113500     PERFORM W500-WRITE-AGRMT-REC.                                11350059
113600                                                                  11360059
113700     PERFORM R400-FETCH-SHPG-CSR.                                 11370060
113800                                                                  11380060
113900*----------------------------------------------------------------*11390059
114000*  PROCESS PAYT AGRMT FOR THE VENDOR BEING PROCESSED.             11400059
114100*----------------------------------------------------------------*11410059
114200 T300-CREATE-PAYT-AGRMT-EXTRACT.                                  11420059
114300                                                                  11430059
114400     INITIALIZE VN214-RECORD.                                     11440059
114500                                                                  11450059
114600     MOVE VN210-EXENT-ID          TO VN214-EXENT-ID.              11460059
114700     MOVE VN213-DEPT-NBR          TO VN214-DEPT-NBR.              11470059
114800     MOVE '2'                     TO VN214-VND-AGRMT-TYP-CDE.     11480059
114900                                                                  11490059
115000     MOVE VNDAGR-SEQ-NBR          TO WS-SMALLINT-UNPK.            11500059
115100     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            11510059
115200     MOVE WS-SMALLINT-EDIT        TO VN214-VND-AGRMT-SEQ-NBR.     11520059
115300                                                                  11530059
115400     MOVE VNDAGR-EFFECTIVE-DATE   TO VN214-SOR-EFF-BEG-DTE.       11540059
115500     MOVE VNDAGR-EXPIRATION-DATE  TO VN214-SOR-EFF-EXPRN-DTE.     11550059
115600                                                                  11560059
115700     MOVE VNDAGR-PAYT-TERM-ID     TO WS-SMALLINT-UNPK.            11570059
115800     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            11580059
115900     MOVE WS-SMALLINT-EDIT        TO VN214-PAYT-TERM-ID.          11590059
116000                                                                  11600059
116100     PERFORM W500-WRITE-AGRMT-REC.                                11610059
116200                                                                  11620059
116300     PERFORM R410-FETCH-PAYT-CSR.                                 11630060
116400                                                                  11640060
116500*----------------------------------------------------------------*11650060
116600*  PROCESS PRCH AGRMT FOR THE VENDOR BEING PROCESSED.             11660060
116700*----------------------------------------------------------------*11670060
116800 T400-CREATE-PRCH-AGRMT-EXTRACT.                                  11680060
116900                                                                  11690060
117000     INITIALIZE VN214-RECORD.                                     11700060
117100     SET WS-DONT-SKIP-PRCH-AGRMT TO TRUE                          11710060
117200                                                                  11720060
117300     MOVE VN210-EXENT-ID          TO VN214-EXENT-ID.              11730060
117400     MOVE VN213-DEPT-NBR          TO VN214-DEPT-NBR.              11740060
117500     MOVE '3'                     TO VN214-VND-AGRMT-TYP-CDE.     11750060
117600                                                                  11760060
117700     MOVE VNDAGR-SEQ-NBR          TO WS-SMALLINT-UNPK.            11770060
117800     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            11780060
117900     MOVE WS-SMALLINT-EDIT        TO VN214-VND-AGRMT-SEQ-NBR.     11790060
118000                                                                  11800060
118100     MOVE VNDAGR-EFFECTIVE-DATE   TO VN214-SOR-EFF-BEG-DTE.       11810060
118200     MOVE VNDAGR-EXPIRATION-DATE  TO VN214-SOR-EFF-EXPRN-DTE.     11820060
118300                                                                  11830060
118400     MOVE VNDAGR-VND-AUTH-ID      TO VN214-RTV-AUTH-ID.           11840060
118500                                                                  11850060
118600     IF  VNDAGR-RTV-RA-REQD-IND        = 'Y'                      11860060
118700     AND VNDAGR-RTV-NO-RA-REQD-IND NOT = 'Y'                      11870060
118800     AND VNDAGR-DEBIT-DESTROY-IND  NOT = 'Y'                      11880060
118900     AND VNDAGR-MARKOUT-IND        NOT = 'Y'                      11890060
119000         MOVE 'RA' TO VN214-DC-MDSE-RET-TYP-CDE                   11900060
119100     ELSE                                                         11910060
119200         IF  VNDAGR-RTV-NO-RA-REQD-IND     = 'Y'                  11920060
119300         AND VNDAGR-RTV-RA-REQD-IND    NOT = 'Y'                  11930060
119400         AND VNDAGR-DEBIT-DESTROY-IND  NOT = 'Y'                  11940060
119500         AND VNDAGR-MARKOUT-IND        NOT = 'Y'                  11950060
119600             MOVE 'RV' TO VN214-DC-MDSE-RET-TYP-CDE               11960060
119700         ELSE                                                     11970060
119800             IF  VNDAGR-DEBIT-DESTROY-IND      = 'Y'              11980060
119900             AND VNDAGR-RTV-RA-REQD-IND    NOT = 'Y'              11990060
120000             AND VNDAGR-RTV-NO-RA-REQD-IND NOT = 'Y'              12000060
120100             AND VNDAGR-MARKOUT-IND        NOT = 'Y'              12010060
120200                 MOVE 'DD' TO VN214-DC-MDSE-RET-TYP-CDE           12020060
120300             ELSE                                                 12030060
120400                 IF  VNDAGR-MARKOUT-IND            = 'Y'          12040060
120500                 AND VNDAGR-RTV-RA-REQD-IND    NOT = 'Y'          12050060
120600                 AND VNDAGR-RTV-NO-RA-REQD-IND NOT = 'Y'          12060060
120700                 AND VNDAGR-DEBIT-DESTROY-IND  NOT = 'Y'          12070060
120800                     MOVE 'MO' TO VN214-DC-MDSE-RET-TYP-CDE       12080060
120900                 ELSE                                             12090060
121000                     IF  VNDAGR-MARKOUT-IND        = 'N'          12100060
121100                     AND VNDAGR-RTV-RA-REQD-IND    = 'N'          12110060
121200                     AND VNDAGR-RTV-NO-RA-REQD-IND = 'N'          12120060
121300                     AND VNDAGR-DEBIT-DESTROY-IND  = 'N'          12130060
121400                         SET WS-SKIP-PRCH-AGRMT TO TRUE           12140060
121500                         ADD 1 TO WS-PGM-ROWS-SKIPPED             12150060
121600                     ELSE                                         12160060
121700                         IF  VNDAGR-MARKOUT-IND        = ' '      12170060
121800                         AND VNDAGR-RTV-RA-REQD-IND    = ' '      12180060
121900                         AND VNDAGR-RTV-NO-RA-REQD-IND = ' '      12190060
122000                         AND VNDAGR-DEBIT-DESTROY-IND  = ' '      12200060
122100                             SET WS-SKIP-PRCH-AGRMT TO TRUE       12210060
122200                             ADD 1 TO WS-PGM-ROWS-SKIPPED         12220060
122300                         END-IF                                   12230060
122400                     END-IF                                       12240060
122500                 END-IF                                           12250060
122600             END-IF                                               12260060
122700         END-IF                                                   12270060
122800     END-IF.                                                      12280060
122900                                                                  12290060
123000     IF WS-DONT-SKIP-PRCH-AGRMT                                   12300060
123100        PERFORM W500-WRITE-AGRMT-REC                              12310060
123200     ELSE                                                         12320060
123300        PERFORM W600-WRITE-AGRMT-DUMP                             12330060
123400     END-IF.                                                      12340060
123500                                                                  12350060
123600     PERFORM R420-FETCH-PRCH-CSR.                                 12360060
123700                                                                  12370060
123800*----------------------------------------------------------------*12380060
123900*  PROCESS INCTV AGRMT FOR THE VENDOR BEING PROCESSED.            12390060
124000*----------------------------------------------------------------*12400060
124100 T500-CREATE-INCTV-EXTRACT.                                       12410060
124200                                                                  12420060
124300     INITIALIZE VN214-RECORD.                                     12430060
124400                                                                  12440060
124500     MOVE VN210-EXENT-ID          TO VN214-EXENT-ID.              12450060
124600     MOVE VN213-DEPT-NBR          TO VN214-DEPT-NBR.              12460060
124700     MOVE '5'                     TO VN214-VND-AGRMT-TYP-CDE.     12470060
124800                                                                  12480060
124900     MOVE VNDAGR-SEQ-NBR          TO WS-SMALLINT-UNPK.            12490060
125000     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            12500060
125100     MOVE WS-SMALLINT-EDIT        TO VN214-VND-AGRMT-SEQ-NBR.     12510060
125200                                                                  12520060
125300     MOVE VNDAGR-EFFECTIVE-DATE   TO VN214-SOR-EFF-BEG-DTE.       12530060
125400     MOVE VNDAGR-EXPIRATION-DATE  TO VN214-SOR-EFF-EXPRN-DTE.     12540060
125500                                                                  12550060
125600     MOVE VNDAGR-TYP-CDE          TO WS-SMALLINT-UNPK.            12560060
125700     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            12570060
125800     MOVE WS-SMALLINT-EDIT        TO VN214-TYP-CDE.               12580060
125900                                                                  12590060
126000     COMPUTE WS-DISC-PCT = VNDAGR-DISCOUNT-PCT * 100.             12600060
126100     MOVE WS-DISC-PCT             TO WS-DISCOUNT-UNPK.            12610060
126200     MOVE WS-DISCOUNT-UNPK        TO WS-PERCENT-EDIT.             12620060
126300     MOVE WS-PERCENT-EDIT         TO VN214-DISC-PCT.              12630060
126400                                                                  12640060
126500     MOVE VNDAGR-EXT-PAY-DAYS-QTY TO WS-SMALLINT-UNPK.            12650060
126600     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            12660060
126700     MOVE WS-SMALLINT-EDIT        TO VN214-EXTD-PAY-DAYS-QTY.     12670060
126800                                                                  12680060
126900     PERFORM W500-WRITE-AGRMT-REC.                                12690060
127000                                                                  12700060
127100     PERFORM R430-FETCH-INCTV-CSR.                                12710060
127200                                                                  12720060
127300*----------------------------------------------------------------*12730060
127400*  PROCESS PGM AGRMT FOR THE VENDOR BEING PROCESSED.              12740060
127500*----------------------------------------------------------------*12750060
127600 T600-CREATE-PGM-EXTRACT.                                         12760060
127700                                                                  12770060
127800     INITIALIZE VN214-RECORD.                                     12780060
127900                                                                  12790060
128000     MOVE VN210-EXENT-ID          TO VN214-EXENT-ID.              12800060
128100     MOVE VN213-DEPT-NBR          TO VN214-DEPT-NBR.              12810060
128200     MOVE '6'                     TO VN214-VND-AGRMT-TYP-CDE.     12820060
128300                                                                  12830060
128400     MOVE VNDAGR-SEQ-NBR          TO WS-SMALLINT-UNPK.            12840060
128500     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            12850060
128600     MOVE WS-SMALLINT-EDIT        TO VN214-VND-AGRMT-SEQ-NBR.     12860060
128700                                                                  12870060
128800     MOVE VNDAGR-EFFECTIVE-DATE   TO VN214-SOR-EFF-BEG-DTE.       12880060
128900     MOVE VNDAGR-EXPIRATION-DATE  TO VN214-SOR-EFF-EXPRN-DTE.     12890060
129000                                                                  12900060
129100     MOVE 6                       TO WS-SMALLINT-UNPK.            12910060
129200     MOVE WS-SMALLINT-UNPK        TO WS-SMALLINT-EDIT.            12920060
129300     MOVE WS-SMALLINT-EDIT        TO VN214-TYP-CDE.               12930060
129400                                                                  12940060
129500     COMPUTE WS-DISC-PCT = VNDAGR-DISCOUNT-PCT * 100.             12950060
129600     MOVE WS-DISC-PCT             TO WS-DISCOUNT-UNPK.            12960060
129700     MOVE WS-DISCOUNT-UNPK        TO WS-PERCENT-EDIT.             12970060
129800     MOVE WS-PERCENT-EDIT         TO VN214-DISC-PCT.              12980060
129900                                                                  12990060
130000     MOVE VNDAGR-AP-TRN-CDE       TO VN214-AP-TRN-CDE.            13000060
130100     MOVE VNDAGR-PSTG-FRQ-CDE     TO VN214-PSTG-FRQ-CDE.          13010060
130200     MOVE VNDAGR-DED-DISC-IND     TO VN214-DED-DISC-IND.          13020060
130300     MOVE VNDAGR-DED-RTV-IND      TO VN214-DED-RTV-IND.           13030060
130400                                                                  13040060
130500     PERFORM W500-WRITE-AGRMT-REC.                                13050060
130600                                                                  13060060
130700     PERFORM R440-FETCH-PGM-CSR.                                  13070060
130800                                                                  13080060
130900*----------------------------------------------------------------*13090060
131000*  WRITE THE VENDOR RECORD TO THE OUTPUT FILE.                    13100060
131100*----------------------------------------------------------------*13110060
131200 W100-WRITE-VENDOR-REC.                                           13120060
131300                                                                  13130060
131400     WRITE VENDOR-EXTRACT-REC FROM VN210-RECORD.                  13140060
131500                                                                  13150060
131600     ADD 1 TO WS-HEADER-WRITTEN.                                  13160060
131700                                                                  13170060
131800*----------------------------------------------------------------*13180060
131900*  WRITE THE ROLE RECORD TO THE OUTPUT FILE.                      13190060
132000*----------------------------------------------------------------*13200060
132100 W200-WRITE-ROLE-REC.                                             13210060
132200                                                                  13220060
132300     WRITE VENDOR-ROLE-REC FROM VN211-RECORD.                     13230060
132400                                                                  13240060
132500     ADD 1 TO WS-ROLE-WRITTEN.                                    13250060
132600                                                                  13260060
132700*----------------------------------------------------------------*13270060
132800*  WRITE THE DEPT RECORD TO THE OUTPUT FILE.                      13280060
132900*----------------------------------------------------------------*13290060
133000 W300-WRITE-DEPT-REC.                                             13300060
133100                                                                  13310060
133200     WRITE VENDOR-DEPT-REC FROM VN213-RECORD.                     13320060
133300                                                                  13330060
133400     ADD 1 TO WS-DEPT-WRITTEN.                                    13340060
133500                                                                  13350060
133600*----------------------------------------------------------------*13360060
133700*  WRITE THE CPBL RECORD TO THE OUTPUT FILE.                      13370060
133800*----------------------------------------------------------------*13380060
133900 W400-WRITE-CPBL-REC.                                             13390060
134000                                                                  13400060
134100     WRITE VENDOR-CPBL-REC FROM VN212-RECORD.                     13410060
134200                                                                  13420060
134300     ADD 1 TO WS-CPBL-WRITTEN.                                    13430060
134400                                                                  13440060
134500*----------------------------------------------------------------*13450060
134600*  WRITE THE AGRMT RECORD TO THE OUTPUT FILE.                     13460060
134700*----------------------------------------------------------------*13470060
134800 W500-WRITE-AGRMT-REC.                                            13480060
134900                                                                  13490060
135000     WRITE VENDOR-AGRMT-REC FROM VN214-RECORD.                    13500060
135100                                                                  13510060
135200     ADD 1 TO WS-AGRMT-WRITTEN.                                   13520060
135300                                                                  13530060
135400*----------------------------------------------------------------*13540060
135500*  WRITE THE BYPASSED AGRMT RECORD TO THE DUMP FILE.              13550060
135600*----------------------------------------------------------------*13560060
135700 W600-WRITE-AGRMT-DUMP.                                           13570060
135800                                                                  13580060
135900     WRITE VENDOR-AGRMT-DUMP-REC FROM VN214-RECORD.               13590060
136000                                                                  13600060
136100     ADD 1 TO WS-AGRMT-DUMP-WRITTEN.                              13610060
136200                                                                  13620060
136300*----------------------------------------------------------------*13630060
136400*  OPEN VENDOR CURSOR                                             13640060
136500*----------------------------------------------------------------*13650060
136600 Y100-OPEN-VENDOR-CSR.                                            13660060
136700                                                                  13670060
136800     PERFORM WITH TEST AFTER                                      13680060
136900        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      13690060
137000          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   13700060
137100             OR SQLCODE = ZERO                                    13710060
137200                                                                  13720060
137300         EXEC SQL                                                 13730060
137400            OPEN VENDOR_CSR                                       13740060
137500         END-EXEC                                                 13750060
137600                                                                  13760060
137700         EVALUATE TRUE                                            13770060
137800             WHEN SQLCODE = ZERO                                  13780060
137900                  CONTINUE                                        13790060
138000             WHEN SQLCODE = -904                                  13800060
138100             WHEN SQLCODE = -913                                  13810060
138200                  CONTINUE                                        13820060
138300             WHEN SQLWARN0 NOT = SPACES                           13830060
138400             WHEN SQLCODE  NOT = ZERO                             13840060
138500                  MOVE 'Y100-OPEN-VENDOR-CSR         '            13850060
138600                                           TO WS-ABEND-PARAGRAPH  13860060
138700                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  13870060
138800                  MOVE 'TEXTENT' TO WS-ABEND-STRUCTURE-1          13880060
138900                  MOVE 'TENTNME' TO WS-ABEND-STRUCTURE-2          13890060
139000                  PERFORM Z999-SQL-ERROR                          13900060
139100         END-EVALUATE                                             13910060
139200     END-PERFORM.                                                 13920060
139300                                                                  13930060
139400     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           13940060
139500        MOVE 'Y100-OPEN-VENDOR-CSR' TO WS-ABEND-PARAGRAPH         13950060
139600        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 13960060
139700        PERFORM Z999-SQL-ERROR                                    13970060
139800     END-IF.                                                      13980060
139900                                                                  13990060
140000*----------------------------------------------------------------*14000060
140100*  CLOSE VENDOR CURSOR                                            14010060
140200*----------------------------------------------------------------*14020060
140300 Y200-CLOSE-VENDOR-CSR.                                           14030060
140400                                                                  14040060
140500         EXEC SQL                                                 14050060
140600            CLOSE VENDOR_CSR                                      14060060
140700         END-EXEC.                                                14070060
140800                                                                  14080060
140900         EVALUATE TRUE                                            14090060
141000             WHEN SQLCODE = ZERO                                  14100060
141100                  CONTINUE                                        14110060
141200             WHEN SQLWARN0 NOT = SPACES                           14120060
141300             WHEN SQLCODE  NOT = ZERO                             14130060
141400                  MOVE 'Y200-CLOSE-VENDOR-CSR'                    14140060
141500                                  TO WS-ABEND-PARAGRAPH           14150060
141600                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 14160060
141700                  MOVE 'TENTNME'  TO WS-ABEND-STRUCTURE-1         14170060
141800                  MOVE 'TEXTENT ' TO WS-ABEND-STRUCTURE-2         14180060
141900                  PERFORM Z999-SQL-ERROR                          14190060
142000         END-EVALUATE.                                            14200060
142100                                                                  14210060
142200*----------------------------------------------------------------*14220060
142300*  OPEN DEPT CURSOR                                               14230060
142400*----------------------------------------------------------------*14240060
142500 Y300-OPEN-DEPT-CSR.                                              14250060
142600                                                                  14260060
142700     PERFORM WITH TEST AFTER                                      14270060
142800        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      14280060
142900          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   14290060
143000             OR SQLCODE = ZERO                                    14300060
143100                                                                  14310060
143200         EXEC SQL                                                 14320060
143300            OPEN DEPT_CSR                                         14330060
143400         END-EXEC                                                 14340060
143500                                                                  14350060
143600         EVALUATE TRUE                                            14360060
143700             WHEN SQLCODE = ZERO                                  14370060
143800                  CONTINUE                                        14380060
143900             WHEN SQLCODE = -904                                  14390060
144000             WHEN SQLCODE = -913                                  14400060
144100                  CONTINUE                                        14410060
144200             WHEN SQLWARN0 NOT = SPACES                           14420060
144300             WHEN SQLCODE  NOT = ZERO                             14430060
144400                  MOVE 'Y300-OPEN-DEPT-CSR           '            14440060
144500                                           TO WS-ABEND-PARAGRAPH  14450060
144600                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  14460060
144700                  MOVE 'TVNDDPT' TO WS-ABEND-STRUCTURE-1          14470060
144800                  MOVE '       ' TO WS-ABEND-STRUCTURE-2          14480060
144900                  PERFORM Z999-SQL-ERROR                          14490060
145000         END-EVALUATE                                             14500060
145100     END-PERFORM.                                                 14510060
145200                                                                  14520060
145300     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           14530060
145400        MOVE 'Y300-OPEN-DEPT-CSR  ' TO WS-ABEND-PARAGRAPH         14540060
145500        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 14550060
145600        PERFORM Z999-SQL-ERROR                                    14560060
145700     END-IF.                                                      14570060
145800                                                                  14580060
145900*----------------------------------------------------------------*14590060
146000*  CLOSE DEPT CURSOR                                              14600060
146100*----------------------------------------------------------------*14610060
146200 Y400-CLOSE-DEPT-CSR.                                             14620060
146300                                                                  14630060
146400         EXEC SQL                                                 14640060
146500            CLOSE DEPT_CSR                                        14650060
146600         END-EXEC.                                                14660060
146700                                                                  14670060
146800         EVALUATE TRUE                                            14680060
146900             WHEN SQLCODE = ZERO                                  14690060
147000                  CONTINUE                                        14700060
147100             WHEN SQLWARN0 NOT = SPACES                           14710060
147200             WHEN SQLCODE  NOT = ZERO                             14720060
147300                  MOVE 'Y400-CLOSE-DEPT-CSR  '                    14730060
147400                                  TO WS-ABEND-PARAGRAPH           14740060
147500                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 14750060
147600                  MOVE 'TVNDDPT'  TO WS-ABEND-STRUCTURE-1         14760060
147700                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         14770060
147800                  PERFORM Z999-SQL-ERROR                          14780060
147900         END-EVALUATE.                                            14790060
148000                                                                  14800060
148100*----------------------------------------------------------------*14810060
148200*  OPEN CPBL CURSOR                                               14820060
148300*----------------------------------------------------------------*14830060
148400 Y500-OPEN-CPBL-CSR.                                              14840060
148500                                                                  14850060
148600     PERFORM WITH TEST AFTER                                      14860060
148700        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      14870060
148800          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   14880060
148900             OR SQLCODE = ZERO                                    14890060
149000                                                                  14900060
149100         EXEC SQL                                                 14910060
149200            OPEN CPBL_CSR                                         14920060
149300         END-EXEC                                                 14930060
149400                                                                  14940060
149500         EVALUATE TRUE                                            14950060
149600             WHEN SQLCODE = ZERO                                  14960060
149700                  CONTINUE                                        14970060
149800             WHEN SQLCODE = -904                                  14980060
149900             WHEN SQLCODE = -913                                  14990060
150000                  CONTINUE                                        15000060
150100             WHEN SQLWARN0 NOT = SPACES                           15010060
150200             WHEN SQLCODE  NOT = ZERO                             15020060
150300                  MOVE 'Y500-OPEN-CPBL-CSR           '            15030060
150400                                           TO WS-ABEND-PARAGRAPH  15040060
150500                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  15050060
150600                  MOVE 'VNT00001' TO WS-ABEND-STRUCTURE-1         15060060
150700                  MOVE '       '  TO WS-ABEND-STRUCTURE-2         15070060
150800                  PERFORM Z999-SQL-ERROR                          15080060
150900         END-EVALUATE                                             15090060
151000     END-PERFORM.                                                 15100060
151100                                                                  15110060
151200     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           15120060
151300        MOVE 'Y500-OPEN-CPBL-CSR  ' TO WS-ABEND-PARAGRAPH         15130060
151400        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 15140060
151500        PERFORM Z999-SQL-ERROR                                    15150060
151600     END-IF.                                                      15160060
151700                                                                  15170060
151800*----------------------------------------------------------------*15180060
151900*  CLOSE CPBL CURSOR                                              15190060
152000*----------------------------------------------------------------*15200060
152100 Y600-CLOSE-CPBL-CSR.                                             15210060
152200                                                                  15220060
152300         EXEC SQL                                                 15230060
152400            CLOSE CPBL_CSR                                        15240060
152500         END-EXEC.                                                15250060
152600                                                                  15260060
152700         EVALUATE TRUE                                            15270060
152800             WHEN SQLCODE = ZERO                                  15280060
152900                  CONTINUE                                        15290060
153000             WHEN SQLWARN0 NOT = SPACES                           15300060
153100             WHEN SQLCODE  NOT = ZERO                             15310060
153200                  MOVE 'Y600-CLOSE-CPBL-CSR  '                    15320060
153300                                  TO WS-ABEND-PARAGRAPH           15330060
153400                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 15340060
153500                  MOVE 'VNT00001' TO WS-ABEND-STRUCTURE-1         15350060
153600                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         15360060
153700                  PERFORM Z999-SQL-ERROR                          15370060
153800         END-EVALUATE.                                            15380060
153900                                                                  15390060
154000*----------------------------------------------------------------*15400060
154100*  OPEN SHPG CURSOR                                               15410060
154200*----------------------------------------------------------------*15420060
154300 Y700-OPEN-SHPG-CSR.                                              15430060
154400                                                                  15440060
154500     PERFORM WITH TEST AFTER                                      15450060
154600        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      15460060
154700          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   15470060
154800             OR SQLCODE = ZERO                                    15480060
154900                                                                  15490060
155000         EXEC SQL                                                 15500060
155100            OPEN SHPG_CSR                                         15510060
155200         END-EXEC                                                 15520060
155300                                                                  15530060
155400         EVALUATE TRUE                                            15540060
155500             WHEN SQLCODE = ZERO                                  15550060
155600                  CONTINUE                                        15560060
155700             WHEN SQLCODE = -904                                  15570060
155800             WHEN SQLCODE = -913                                  15580060
155900                  CONTINUE                                        15590060
156000             WHEN SQLWARN0 NOT = SPACES                           15600060
156100             WHEN SQLCODE  NOT = ZERO                             15610060
156200                  MOVE 'Y700-OPEN-SHPG-CSR           '            15620060
156300                                           TO WS-ABEND-PARAGRAPH  15630060
156400                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  15640060
156500                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         15650060
156600                  MOVE 'TFRGTRM ' TO WS-ABEND-STRUCTURE-2         15660060
156700                  PERFORM Z999-SQL-ERROR                          15670060
156800         END-EVALUATE                                             15680060
156900     END-PERFORM.                                                 15690060
157000                                                                  15700060
157100     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           15710060
157200        MOVE 'Y700-OPEN-SHPG-CSR  ' TO WS-ABEND-PARAGRAPH         15720060
157300        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 15730060
157400        PERFORM Z999-SQL-ERROR                                    15740060
157500     END-IF.                                                      15750060
157600                                                                  15760060
157700*----------------------------------------------------------------*15770060
157800*  OPEN PAYT CURSOR                                               15780060
157900*----------------------------------------------------------------*15790060
158000 Y710-OPEN-PAYT-CSR.                                              15800060
158100                                                                  15810060
158200     PERFORM WITH TEST AFTER                                      15820060
158300        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      15830060
158400          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   15840060
158500             OR SQLCODE = ZERO                                    15850060
158600                                                                  15860060
158700         EXEC SQL                                                 15870060
158800            OPEN PAYT_CSR                                         15880060
158900         END-EXEC                                                 15890060
159000                                                                  15900060
159100         EVALUATE TRUE                                            15910060
159200             WHEN SQLCODE = ZERO                                  15920060
159300                  CONTINUE                                        15930060
159400             WHEN SQLCODE = -904                                  15940060
159500             WHEN SQLCODE = -913                                  15950060
159600                  CONTINUE                                        15960060
159700             WHEN SQLWARN0 NOT = SPACES                           15970060
159800             WHEN SQLCODE  NOT = ZERO                             15980060
159900                  MOVE 'Y710-OPEN-PAYT-CSR           '            15990060
160000                                           TO WS-ABEND-PARAGRAPH  16000060
160100                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  16010060
160200                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         16020060
160300                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         16030060
160400                  PERFORM Z999-SQL-ERROR                          16040060
160500         END-EVALUATE                                             16050060
160600     END-PERFORM.                                                 16060060
160700                                                                  16070060
160800     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           16080060
160900        MOVE 'Y710-OPEN-PAYT-CSR  ' TO WS-ABEND-PARAGRAPH         16090060
161000        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 16100060
161100        PERFORM Z999-SQL-ERROR                                    16110060
161200     END-IF.                                                      16120060
161300                                                                  16130060
161400*----------------------------------------------------------------*16140060
161500*  OPEN PRCH CURSOR                                               16150060
161600*----------------------------------------------------------------*16160060
161700 Y720-OPEN-PRCH-CSR.                                              16170060
161800                                                                  16180060
161900     PERFORM WITH TEST AFTER                                      16190060
162000        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      16200060
162100          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   16210060
162200             OR SQLCODE = ZERO                                    16220060
162300                                                                  16230060
162400         EXEC SQL                                                 16240060
162500            OPEN PRCH_CSR                                         16250060
162600         END-EXEC                                                 16260060
162700                                                                  16270060
162800         EVALUATE TRUE                                            16280060
162900             WHEN SQLCODE = ZERO                                  16290060
163000                  CONTINUE                                        16300060
163100             WHEN SQLCODE = -904                                  16310060
163200             WHEN SQLCODE = -913                                  16320060
163300                  CONTINUE                                        16330060
163400             WHEN SQLWARN0 NOT = SPACES                           16340060
163500             WHEN SQLCODE  NOT = ZERO                             16350060
163600                  MOVE 'Y720-OPEN-PRCH-CSR           '            16360060
163700                                           TO WS-ABEND-PARAGRAPH  16370060
163800                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  16380060
163900                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         16390060
164000                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         16400060
164100                  PERFORM Z999-SQL-ERROR                          16410060
164200         END-EVALUATE                                             16420060
164300     END-PERFORM.                                                 16430060
164400                                                                  16440060
164500     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           16450060
164600        MOVE 'Y720-OPEN-PRCH-CSR  ' TO WS-ABEND-PARAGRAPH         16460060
164700        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 16470060
164800        PERFORM Z999-SQL-ERROR                                    16480060
164900     END-IF.                                                      16490060
165000                                                                  16500060
165100*----------------------------------------------------------------*16510060
165200*  OPEN INCTV CURSOR                                              16520060
165300*----------------------------------------------------------------*16530060
165400 Y730-OPEN-INCTV-CSR.                                             16540060
165500                                                                  16550060
165600     PERFORM WITH TEST AFTER                                      16560060
165700        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      16570060
165800          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   16580060
165900             OR SQLCODE = ZERO                                    16590060
166000                                                                  16600060
166100         EXEC SQL                                                 16610060
166200            OPEN INCTV_CSR                                        16620060
166300         END-EXEC                                                 16630060
166400                                                                  16640060
166500         EVALUATE TRUE                                            16650060
166600             WHEN SQLCODE = ZERO                                  16660060
166700                  CONTINUE                                        16670060
166800             WHEN SQLCODE = -904                                  16680060
166900             WHEN SQLCODE = -913                                  16690060
167000                  CONTINUE                                        16700060
167100             WHEN SQLWARN0 NOT = SPACES                           16710060
167200             WHEN SQLCODE  NOT = ZERO                             16720060
167300                  MOVE 'Y730-OPEN-INCTV-CSR          '            16730060
167400                                           TO WS-ABEND-PARAGRAPH  16740060
167500                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  16750060
167600                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         16760060
167700                  MOVE 'TINCTYP ' TO WS-ABEND-STRUCTURE-2         16770060
167800                  PERFORM Z999-SQL-ERROR                          16780060
167900         END-EVALUATE                                             16790060
168000     END-PERFORM.                                                 16800060
168100                                                                  16810060
168200     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           16820060
168300        MOVE 'Y730-OPEN-INCTV-CSR ' TO WS-ABEND-PARAGRAPH         16830060
168400        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 16840060
168500        PERFORM Z999-SQL-ERROR                                    16850060
168600     END-IF.                                                      16860060
168700                                                                  16870060
168800*----------------------------------------------------------------*16880060
168900*  OPEN PGM CURSOR                                                16890060
169000*----------------------------------------------------------------*16900060
169100 Y740-OPEN-PGM-CSR.                                               16910060
169200                                                                  16920060
169300     PERFORM WITH TEST AFTER                                      16930060
169400        VARYING WS-RETRY-COUNTER FROM 1 BY 1                      16940060
169500          UNTIL WS-RETRY-COUNTER > WS-RETRY-MAX                   16950060
169600             OR SQLCODE = ZERO                                    16960060
169700                                                                  16970060
169800         EXEC SQL                                                 16980060
169900            OPEN PGM_CSR                                          16990060
170000         END-EXEC                                                 17000060
170100                                                                  17010060
170200         EVALUATE TRUE                                            17020060
170300             WHEN SQLCODE = ZERO                                  17030060
170400                  CONTINUE                                        17040060
170500             WHEN SQLCODE = -904                                  17050060
170600             WHEN SQLCODE = -913                                  17060060
170700                  CONTINUE                                        17070060
170800             WHEN SQLWARN0 NOT = SPACES                           17080060
170900             WHEN SQLCODE  NOT = ZERO                             17090060
171000                  MOVE 'Y740-OPEN-PGM-CSR            '            17100060
171100                                           TO WS-ABEND-PARAGRAPH  17110060
171200                  MOVE 'UNSUCCESSFUL OPEN' TO WS-ABEND-OPERATION  17120060
171300                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         17130060
171400                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         17140060
171500                  PERFORM Z999-SQL-ERROR                          17150060
171600         END-EVALUATE                                             17160060
171700     END-PERFORM.                                                 17170060
171800                                                                  17180060
171900     IF WS-RETRY-COUNTER > WS-RETRY-MAX                           17190060
172000        MOVE 'Y740-OPEN-PGM-CSR   ' TO WS-ABEND-PARAGRAPH         17200060
172100        MOVE 'MAX RETRIES EXCEEDED ON OPEN' TO WS-ABEND-OPERATION 17210060
172200        PERFORM Z999-SQL-ERROR                                    17220060
172300     END-IF.                                                      17230060
172400                                                                  17240060
172500*----------------------------------------------------------------*17250060
172600*  CLOSE SHPG CURSOR                                              17260060
172700*----------------------------------------------------------------*17270060
172800 Y800-CLOSE-SHPG-CSR.                                             17280060
172900                                                                  17290060
173000         EXEC SQL                                                 17300060
173100            CLOSE SHPG_CSR                                        17310060
173200         END-EXEC.                                                17320060
173300                                                                  17330060
173400         EVALUATE TRUE                                            17340060
173500             WHEN SQLCODE = ZERO                                  17350060
173600                  CONTINUE                                        17360060
173700             WHEN SQLWARN0 NOT = SPACES                           17370060
173800             WHEN SQLCODE  NOT = ZERO                             17380060
173900                  MOVE 'Y800-CLOSE-SHPG-CSR  '                    17390060
174000                                  TO WS-ABEND-PARAGRAPH           17400060
174100                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 17410060
174200                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         17420060
174300                  MOVE 'TFRGTRM ' TO WS-ABEND-STRUCTURE-2         17430060
174400                  PERFORM Z999-SQL-ERROR                          17440060
174500         END-EVALUATE.                                            17450060
174600                                                                  17460060
174700*----------------------------------------------------------------*17470060
174800*  CLOSE PAYT CURSOR                                              17480060
174900*----------------------------------------------------------------*17490060
175000 Y810-CLOSE-PAYT-CSR.                                             17500060
175100                                                                  17510060
175200         EXEC SQL                                                 17520060
175300            CLOSE PAYT_CSR                                        17530062
175400         END-EXEC.                                                17540060
175500                                                                  17550060
175600         EVALUATE TRUE                                            17560060
175700             WHEN SQLCODE = ZERO                                  17570060
175800                  CONTINUE                                        17580060
175900             WHEN SQLWARN0 NOT = SPACES                           17590060
176000             WHEN SQLCODE  NOT = ZERO                             17600060
176100                  MOVE 'Y810-CLOSE-PAYT-CSR  '                    17610060
176200                                  TO WS-ABEND-PARAGRAPH           17620060
176300                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 17630060
176400                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         17640060
176500                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         17650060
176600                  PERFORM Z999-SQL-ERROR                          17660060
176700         END-EVALUATE.                                            17670060
176800                                                                  17680060
176900*----------------------------------------------------------------*17690060
177000*  CLOSE PRCH CURSOR                                              17700060
177100*----------------------------------------------------------------*17710060
177200 Y820-CLOSE-PRCH-CSR.                                             17720060
177300                                                                  17730060
177400         EXEC SQL                                                 17740060
177500            CLOSE PRCH_CSR                                        17750060
177600         END-EXEC.                                                17760060
177700                                                                  17770060
177800         EVALUATE TRUE                                            17780060
177900             WHEN SQLCODE = ZERO                                  17790060
178000                  CONTINUE                                        17800060
178100             WHEN SQLWARN0 NOT = SPACES                           17810060
178200             WHEN SQLCODE  NOT = ZERO                             17820060
178300                  MOVE 'Y820-CLOSE-PRCH-CSR  '                    17830060
178400                                  TO WS-ABEND-PARAGRAPH           17840060
178500                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 17850060
178600                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         17860060
178700                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         17870060
178800                  PERFORM Z999-SQL-ERROR                          17880060
178900         END-EVALUATE.                                            17890060
179000                                                                  17900060
179100*----------------------------------------------------------------*17910060
179200*  CLOSE INCTV CURSOR                                             17920060
179300*----------------------------------------------------------------*17930060
179400 Y830-CLOSE-INCTV-CSR.                                            17940060
179500                                                                  17950060
179600         EXEC SQL                                                 17960060
179700            CLOSE INCTV_CSR                                       17970060
179800         END-EXEC.                                                17980060
179900                                                                  17990060
180000         EVALUATE TRUE                                            18000060
180100             WHEN SQLCODE = ZERO                                  18010060
180200                  CONTINUE                                        18020060
180300             WHEN SQLWARN0 NOT = SPACES                           18030060
180400             WHEN SQLCODE  NOT = ZERO                             18040060
180500                  MOVE 'Y830-CLOSE-INCTV-CSR '                    18050060
180600                                  TO WS-ABEND-PARAGRAPH           18060060
180700                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 18070060
180800                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         18080060
180900                  MOVE 'TINCTYP ' TO WS-ABEND-STRUCTURE-2         18090060
181000                  PERFORM Z999-SQL-ERROR                          18100060
181100         END-EVALUATE.                                            18110060
181200                                                                  18120060
181300*----------------------------------------------------------------*18130060
181400*  CLOSE PGM CURSOR                                               18140060
181500*----------------------------------------------------------------*18150060
181600 Y840-CLOSE-PGM-CSR.                                              18160060
181700                                                                  18170060
181800         EXEC SQL                                                 18180060
181900            CLOSE PGM_CSR                                         18190060
182000         END-EXEC.                                                18200060
182100                                                                  18210060
182200         EVALUATE TRUE                                            18220060
182300             WHEN SQLCODE = ZERO                                  18230060
182400                  CONTINUE                                        18240060
182500             WHEN SQLWARN0 NOT = SPACES                           18250060
182600             WHEN SQLCODE  NOT = ZERO                             18260060
182700                  MOVE 'Y840-CLOSE-PGM-CSR   '                    18270060
182800                                  TO WS-ABEND-PARAGRAPH           18280060
182900                  MOVE 'UNSUCCESSFUL CLOSE' TO WS-ABEND-OPERATION 18290060
183000                  MOVE 'TVNDAGR ' TO WS-ABEND-STRUCTURE-1         18300060
183100                  MOVE '        ' TO WS-ABEND-STRUCTURE-2         18310060
183200                  PERFORM Z999-SQL-ERROR                          18320060
183300         END-EVALUATE.                                            18330060
183400                                                                  18340060
183500*----------------------------------------------------------------*18350060
183600*  PROCESS DB2 ABENDS.                                            18360060
183700*----------------------------------------------------------------*18370060
183800 Z999-SQL-ERROR.                                                  18380060
183900                                                                  18390060
184000     DISPLAY '*** DB2 ERROR '.                                    18400060
184100     DISPLAY '*** PROGRAM   = ' WS-ABEND-PROGRAM.                 18410060
184200     DISPLAY '*** PARAGRAPH = ' WS-ABEND-PARAGRAPH.               18420060
184300     DISPLAY '*** OPERATION = ' WS-ABEND-OPERATION.               18430060
184400     DISPLAY '*** TABLE 1   = ' WS-ABEND-STRUCTURE-1.             18440060
184500     IF WS-ABEND-STRUCTURE-2 > SPACES                             18450060
184600         DISPLAY '*** TABLE 2   = ' WS-ABEND-STRUCTURE-2.         18460060
184700                                                                  18470060
184800     SET AP-DB2-ERROR              TO TRUE.                       18480060
184900                                                                  18490060
185000     COPY DPPD004.                                                18500060
185100     CALL 'ILBOABN0' USING ABEND-CODE.                            18510060
