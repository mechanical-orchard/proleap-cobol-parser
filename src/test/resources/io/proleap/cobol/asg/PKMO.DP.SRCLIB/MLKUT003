       IDENTIFICATION DIVISION.                                         00010015
       PROGRAM-ID.    MLKUT003.                                         00020015
       AUTHOR.        SCOTT JACKSON.                                    00030015
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040015
       DATE-WRITTEN.  05/07/2002.                                       00050015
       DATE-COMPILED.                                                   00060015
      ******************************************************************00070015
      *  MERCHANDISE LEDGER SKU ATTRIBUTE CONVERSION PROGRAM            00080015
      *                                                                 00090015
      *  THIS PROGRAM CONVERTS DATASETS THAT FEED MLK140 AVEA INTO A    00100015
      *  SALES FILE CONTAINING SKU ATTRIBUTES FOR THE UPDATED COPYBOOK. 00110021
      *  CHANGE ID (BADSKU) ADDED FOR SKU NOT FOUND ON TSKXREF          00120022
      *                                                                 00130049
      *CHANGE HISTORY:                                                  00140049
      * WR/PROJ    DATE        DESCRIPTION OF CHANGES                   00150049
      * -------    ----------  ---------------------------------------- 00160049
517404* PM00517404 01-05-2003  SQL -811 ERR ON TUPC FOR SKU 2491055     00170049
517404*                        -ROD JANSSEN                             00180049
W21732* W21732     04/24/2003  MLRD017 ENHANCEMENT FOR ML017-PC-LINE-NBR00190061
W21732*                        -ROD JANSSEN                             00200061
W26603* W26603     03-08-2004  MERCH LEDGER STORE EXPANSION             00210063
W26603*                        - ROD JANSSEN                            00220063
      * 26006      03-06-2005  V. LEE YANG UPDATE ENT-ID (VENDOR) LOOKUP00230071
      *                        TO CORRECT A PRODUCTION ISSUE WITH VA    00240071
W28545* W28545     08-22-2005  ROD JANSSEN THE NEW TRANSFER PROCESS     00250079
W29145* W29145     11-20-2005  S. JACKSON SAS MARKDOWN OPTIMIZATION AND 00260096
W29145*                        EXPANSION OF MLRD017 COPYBOOK            00270096
SR3403* SR3403     03-07-2012  T KARWEER LARGE RETAIL AMOUNT FIELD      00280099
SR3403*                        EXPANSION FROM 4 TO 5 DIGITS             00290099
207210* CHG0207210 08-29-2018  JIM HUNTER  RENAME KDU1806 TO PSWS010    00300099
      ******************************************************************00310015
                                                                        00320015
       ENVIRONMENT DIVISION.                                            00330015
       CONFIGURATION SECTION.                                           00340015
       INPUT-OUTPUT SECTION.                                            00350015
       FILE-CONTROL.                                                    00360015
                                                                        00370015
           SELECT REGISTER-SALES-FILE                                   00380015
               ASSIGN TO INP01.                                         00390015
                                                                        00400015
           SELECT PRICE-CHANGE-FILE                                     00410015
               ASSIGN TO INP02.                                         00420015
                                                                        00430015
           SELECT STORE-TRANSFER-FILE                                   00440015
               ASSIGN TO INP03.                                         00450015
                                                                        00460015
W28545     SELECT FAST-TRANSFER-FILE                                    00470079
W28545         ASSIGN TO INP04.                                         00480079
W28545                                                                  00490079
           SELECT REGISTER-SALES-FILE-OUT                               00500015
               ASSIGN TO OUT01.                                         00510015
                                                                        00520015
           SELECT PRICE-CHANGE-FILE-OUT                                 00530015
               ASSIGN TO OUT02.                                         00540015
                                                                        00550015
           SELECT STORE-TRANSFER-FILE-OUT                               00560015
               ASSIGN TO OUT03.                                         00570015
                                                                        00580015
W28545     SELECT FAST-TRANSFER-FILE-OUT                                00590079
W28545         ASSIGN TO OUT04.                                         00600079
W28545                                                                  00610079
           SELECT ERROR-REPORT                                          00620015
               ASSIGN TO RPT01.                                         00630015
                                                                        00640015
       DATA DIVISION.                                                   00650016
       FILE SECTION.                                                    00660015
                                                                        00670015
       FD  REGISTER-SALES-FILE                                          00680015
           RECORDING  MODE IS F.                                        00690015
       01  REGISTER-SALES-REC               PIC X(56).                  00700015
                                                                        00710015
       FD  PRICE-CHANGE-FILE                                            00720015
           RECORDING  MODE IS F.                                        00730015
W26603*01  PRICE-CHANGE-FILE-OUT-REC        PIC X(120).                 00740096
W29145 01  PRICE-CHANGE-FILE-REC            PIC X(200).                 00750099
                                                                        00760015
       FD  STORE-TRANSFER-FILE                                          00770015
           RECORDING  MODE IS F.                                        00780015
       01  STORE-TRANSFER-REC               PIC X(80).                  00790015
                                                                        00800015
W28545 FD  FAST-TRANSFER-FILE                                           00810079
W28545     RECORDING  MODE IS F.                                        00820079
W28545 01  FAST-TRANSFER-REC               PIC X(120).                  00830079
W28545                                                                  00840079
       FD  REGISTER-SALES-FILE-OUT                                      00850099
           RECORDING  MODE IS F                                         00860099
           BLOCK CONTAINS 0 RECORDS.                                    00870099
       01  REGISTER-SALES-FILE-OUT-REC      PIC X(65).                  00880099
                                                                        00890099
       FD  PRICE-CHANGE-FILE-OUT                                        00900099
           RECORDING  MODE IS F                                         00910099
           BLOCK CONTAINS 0 RECORDS.                                    00920099
W26603*01  PRICE-CHANGE-FILE-OUT-REC        PIC X(120).                 00930099
W29145 01  PRICE-CHANGE-FILE-OUT-REC        PIC X(200).                 00940099
                                                                        00950099
       FD  STORE-TRANSFER-FILE-OUT                                      00960099
           RECORDING  MODE IS F                                         00970099
           BLOCK CONTAINS 0 RECORDS.                                    00980099
       01  STORE-TRANSFER-FILE-OUT-REC      PIC X(80).                  00990099
                                                                        01000099
W28545 FD  FAST-TRANSFER-FILE-OUT                                       01010099
W28545     RECORDING  MODE IS F                                         01020099
W28545     BLOCK CONTAINS 0 RECORDS.                                    01030099
W28545 01  FAST-TRANSFER-FILE-OUT-REC      PIC X(80).                   01040099
W28545                                                                  01050099
       FD  ERROR-REPORT                                                 01060015
           RECORDING  MODE IS F.                                        01070015
       01  ERROR-REC                        PIC X(132).                 01080018
                                                                        01090015
       EJECT                                                            01100015
       WORKING-STORAGE SECTION.                                         01110015
                                                                        01120015
      ***************************************************************** 01130015
      *  DATA ENTRY SALES - (N) VERSION IS OUTPUT NEWSKU FORMAT         01140015
      ***************************************************************** 01150015
207210*COPY PSWS010  (ORIGINAL INPUT FORMAT)                            01160099
207210     COPY PSWS010.                                                01170099
                                                                        01180015
      ***************************************************************** 01190015
      *  TRANSFERS      - MLRD005O IS FORMAT FEEDING SYSTEMS USE TO     01200019
      *                            CREATE TRANSFER DATA                 01210019
      *                 - MLRD019  IS INPUT/OUTPUT PRICE CHANGE LAYOUT  01220019
      ***************************************************************** 01230015
      *COPY MLRD005O (ORIGINAL INPUT FORMAT)                            01240015
W28545     COPY MLRD019.                                                01250085
                                                                        01260015
26006 ***************************************************************** 01270075
26006 *  PRICE CHANGES DATA LAYOUT                                      01280075
26006 ***************************************************************** 01290075
26006 *01  ML017-PRICE-CHANGE-RECORD.                                   01300075
26006      COPY MLRD017.                                                01310075
26006                                                                   01320075
W28545******************************************************************01330081
W28545* COPYBOOK - INVENTORY SNAPSHOT TO ML FILE FORMAT                 01340081
W28545******************************************************************01350081
W28545     COPY TFRD054.                                                01360081
W28545                                                                  01370081
      ******************************************************************01380015
      *  DB2 ERROR MESSAGES FORMAT AREA.                                01390015
      ******************************************************************01400015
           COPY DPWS004.                                                01410015
      *                                                                 01420015
       01  CPU-DATE.                                                    01430015
           05  CPU-YEAR                    PIC X(02)     VALUE SPACES.  01440015
           05  CPU-MONTH                   PIC X(02)     VALUE SPACES.  01450015
           05  CPU-DAY                     PIC X(02)     VALUE SPACES.  01460015
                                                                        01470015
       01  CPU-TIME.                                                    01480015
           05  CPU-HOUR                    PIC X(02)     VALUE SPACES.  01490015
           05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.  01500015
           05  FILLER                      PIC X(02)     VALUE SPACES.  01510015
                                                                        01520015
W28545 01  PC-PROGRAM-CONSTANTS.                                        01530081
W28545     05  PC-MAX-ITEM-QTY             PIC 9(03) VALUE 999.         01540081
W28545                                                                  01550081
       01  PV-PROGRAM-VARIABLES.                                        01560000
                                                                        01570099
207210     05  PV-SALES-FORMAT-PSWS010N.                                01580099
               10  PV-SALES-RECORD.                                     01590007
                   15  FILLER              PIC 9(5).                    01600007
                   15  FILLER              PIC 9(04)        COMP-3.     01610007
                   15  FILLER              PIC 9(04)        COMP-3.     01620007
                   15  FILLER              PIC 9(04)        COMP-3.     01630007
                   15  FILLER              PIC 9(06)        COMP-3.     01640007
517404             15  PV-SALE-DATE        PIC 9(06).                   01650049
517404**********   15  FILLER              PIC 9(06).                   01660049
                   15  FILLER              PIC 9(04)        COMP-3.     01670007
                   15  FILLER              PIC 9(02).                   01680007
                   15  PV-SALE-SKU.                                     01690007
                       20  FILLER          PIC 9(05).                   01700007
                       20  PV-SALE-SEQNO   PIC 9(03).                   01710007
                   15  FILLER              PIC X(01).                   01720007
                   15  FILLER              PIC S9(05)       COMP-3.     01730007
                   15  FILLER              PIC S9(05)V99    COMP-3.     01740007
                   15  FILLER              PIC 9(02).                   01750007
                   15  FILLER              PIC 9(01).                   01760007
                   15  FILLER              PIC 9(02).                   01770007
                   15  FILLER              PIC 9(01).                   01780007
                   15  PV-SLS-CORR-CDE     PIC X(01).                   01790007
                       88  PV-NORMAL-TRANS                VALUE ' '.    01800007
                       88  PV-SALES-AUDIT-CORR            VALUE 'S'.    01810007
                       88  PV-SYSTEM-LATE-CORR            VALUE 'L'.    01820007
                   15  FILLER              PIC S9(05)V99    COMP-3.     01830007
               10  PV-SALE-DEPT-CLASS  PIC  9(05).                      01840007
               10  PV-SALE-DEPT-CLASS-X REDEFINES PV-SALE-DEPT-CLASS.   01850007
                   15  PV-SALE-DEPT    PIC  9(03).                      01860007
                   15  PV-SALE-CLASS   PIC  9(02).                      01870007
               10  PV-SALE-MAJOR-CLASS PIC  9(04).                      01880007
                                                                        01890000
           05  PV-XFER-FORMAT-MLRD019.                                  01900007
                10  PV-XFER-STORE-TRANSFER-RECORD.                      01910007
                    15  FILLER                  PIC  9(01) VALUE ZERO.  01920045
                    15  FILLER                  PIC  X(01) VALUE SPACE. 01930007
W26603              15  FILLER                  PIC  9(10) VALUE ZERO.  01940066
517404              15  PV-XFER-DATE.                                   01950049
517404                  20  PV-XFER-MM          PIC  9(02) VALUE ZERO.  01960049
517404                  20  PV-XFER-DD          PIC  9(02) VALUE ZERO.  01970049
517404              15  FILLER                  PIC  9(02) VALUE ZERO.  01980049
                    15  FILLER                  PIC  X(03) VALUE SPACE. 01990007
                    15  FILLER                  PIC  9(03) VALUE ZERO.  02000007
SR3403              15  FILLER                  PIC S9(05)V99.          02010099
                    15  FILLER                  PIC  9(03) VALUE ZERO.  02020007
SR3403              15  FILLER                  PIC  X(04) VALUE SPACE. 02030099
W26603              15  FILLER                  PIC  9(05) VALUE ZERO.  02040064
                    15  PV-XFER-SKU.                                    02050007
                        20  FILLER              PIC  9(05) VALUE ZERO.  02060007
                        20  PV-XFER-SEQ-NO                              02070010
                                                PIC  9(03) VALUE ZERO.  02080007
                    15  FILLER                  PIC  9(04) VALUE ZEROS. 02090007
                    15  FILLER                  PIC  9(06) VALUE ZEROS. 02100007
                15  PV-XFER-SKU-DTA-ATTRIB.                             02110092
                    20  PV-XFER-DEPT-CLASS.                             02120092
                        25  PV-XFER-DEPT-NBR    PIC  9(03) VALUE ZEROES.02130092
                        25  PV-XFER-CLASS-NBR   PIC  9(02) VALUE ZEROES.02140092
W28545***********   15  PV-XFER-MAJ-CLASS       PIC  9(02) VALUE ZEROES.02150086
W28545          10  PV-XFER-ENT-ID  PIC S9(9) COMP VALUE ZEROS.         02160093
                10  FILLER                      PIC  X(10) VALUE SPACE. 02170099
                                                                        02180000
W28545     05  PV-EDIT-BATCH-NBR            PIC 9(04) VALUE ZEROS.      02190099
W28545     05  FILLER REDEFINES PV-EDIT-BATCH-NBR.                      02200099
W28545         10  PV-EDIT-BATCH-NBR-P1     PIC 9(01).                  02210099
W28545         10  PV-EDIT-BATCH-NBR-P2     PIC 9(03).                  02220099
W28545     05  PV-EDIT-SKU-NBR      PIC 9(09)  VALUE ZEROS.             02230081
W28545     05  PV-EDIT-LOC-NBR      PIC 9(05)  VALUE ZEROS.             02240081
W28545     05  PV-EDIT-DOC-NBR.                                         02250081
W28545         10  PV-EDIT-DOC-FROM-LOC-NBR  PIC 9(04) VALUE ZEROS.     02260081
W28545         10  PV-EDIT-DOC-SEQ-NBR       PIC 9(09) VALUE ZEROS.     02270081
W28545         10  PV-EDIT-DOC-SEQ-NBR-RED REDEFINES                    02280081
W28545             PV-EDIT-DOC-SEQ-NBR.                                 02290081
W28545             15  PV-EDIT-DOC-1ST-3     PIC 9(03).                 02300081
W28545             15  PV-EDIT-DOC-LAST-6    PIC 9(06).                 02310081
W28545     05  PV-EDIT-DEPT         PIC 9(04)  VALUE ZEROS.             02320081
W28545     05  FILLER REDEFINES PV-EDIT-DEPT.                           02330081
W28545         10  PV-EDIT-DEPT-P1  PIC 9(01).                          02340081
W28545         10  PV-EDIT-DEPT-P2  PIC 9(03).                          02350081
W28545     05  PV-EDIT-SUBCLASS     PIC 9(04)  VALUE ZEROS.             02360081
W28545     05  FILLER REDEFINES PV-EDIT-SUBCLASS.                       02370081
W28545         10  PV-EDIT-SCL-P1   PIC 9(02).                          02380081
W28545         10  PV-EDIT-SCL-P2   PIC 9(02).                          02390081
W28545     05  PV-SPLIT-RECORD      PIC 9(15) COMP-3 VALUE ZEROS.       02400081
           05  PV-XREF-SQL-CALLS               PIC 9(9)      VALUE 0.   02410000
                                                                        02420000
           05  PV-LINE-COUNT                   PIC 9(2).                02430000
           05  PV-PAGE-COUNT                   PIC 9(5).                02440015
           05  PV-TOT-MKDOWN-IN                PIC S9(09)    COMP-3.    02450015
           05  PV-TOT-MKDOWN-OK                PIC S9(09)    COMP-3.    02460015
           05  PV-TOT-MKUP-IN                  PIC S9(09)    COMP-3.    02470015
           05  PV-TOT-MKUP-OK                  PIC S9(09)    COMP-3.    02480015
           05  PV-TOT-PRC-CHG-IN               PIC S9(09)    COMP-3.    02490015
           05  PV-TOT-PRC-CHG-OK               PIC S9(09)    COMP-3.    02500015
           05  PV-TOT-SALE-IN                  PIC S9(09)    COMP-3.    02510015
           05  PV-TOT-SALE-OK                  PIC S9(09)    COMP-3.    02520015
           05  PV-TOT-TRANSFER-IN              PIC S9(09)    COMP-3.    02530015
           05  PV-TOT-TRANSFER-OK              PIC S9(09)    COMP-3.    02540015
                                                                        02550019
           05  PV-SKXREF-RENUM-STATUS          PIC 9(9) VALUE ZEROES.   02560019
                                                                        02570015
           05  PV-PARAGRAPH-NAME               PIC X(30).               02580015
           05  PV-RTL-AMT                      PIC S9(09)V99 COMP-3.    02590007
           05  PV-OPERATION-ATTEMPTED          PIC  X(30) VALUE SPACES. 02600015
      *    NEW SKU                                                      02610015
           05  PV-HOLD-SKU                   PIC S9(08)  VALUE ZEROES.  02620015
W28545     05  PV-HOLD-SKU-ALPH REDEFINES                               02630081
W28545         PV-HOLD-SKU                   PIC X(08).                 02640081
           05  PV-HOLD-SKU-XREF              PIC S9(08)V COMP-3.        02650015
517404     05  PV-HOLD-DATE.                                            02660049
517404         10  PV-HOLD-DATE-MM           PIC X(02)   VALUE SPACES.  02670060
517404         10  PV-HOLD-DATE-DD           PIC X(02)   VALUE SPACES.  02680060
517404         10  PV-HOLD-DATE-YY           PIC X(02)   VALUE SPACES.  02690060
517404     05  PV-HOLD-DATE-SAVE             PIC X(06)   VALUE SPACES.  02700060
517404     05  PV-WORK-DATE                  PIC X(10)   VALUE SPACES.  02710050
517404     05  PV-NULL-IND                 PIC S9(04) COMP VALUE ZERO.  02720049
517404     05  PV-DB2-MM                   PIC S9(09) COMP VALUE ZERO.  02730053
517404     05  PV-DB2-DD                   PIC S9(09) COMP VALUE ZERO.  02740053
           05  PV-NEW-SKU-MCL.                                          02750015
               10  FILLER                    PIC 9(02)   VALUE ZEROS.   02760015
               10  PV-NEW-SKU-MAJ-CLASS      PIC 9(01).                 02770015
               10  FILLER                    PIC 9(01)   VALUE ZEROS.   02780015
           05  PV-SAVE-DEPT-CLASS-ATTR.                                 02790015
               10  PV-SAVE-DEPT-CLASS.                                  02800015
                   15  PV-SAVE-DEPT          PIC  9(03)  VALUE ZEROS.   02810015
                   15  PV-SAVE-SCL           PIC  9(02)  VALUE ZEROS.   02820015
               10  PV-SAVE-MAJ-CL            PIC  9(04)  VALUE ZEROS.   02830015
26006      05  PV-SAVE-ENT-ID              PIC S9(09)      VALUE ZEROES 02840076
                               COMP.                                    02850076
                                                                        02860015
           05  PV-KOHLS-UPC-LOW.                                        02870041
               10  FILLER                    PIC 9(04)  VALUE 0400.     02880035
               10  PV-KOHLS-SKU-MIN          PIC 9(08)  VALUE ZEROS.    02890035
               10  FILLER                    PIC 9(01)  VALUE 0.        02900035
                                                                        02910022
           05  PV-KOHLS-UPC-HIGH.                                       02920041
               10  FILLER                    PIC 9(04)  VALUE 0400.     02930035
               10  PV-KOHLS-SKU-MAX          PIC 9(08)  VALUE ZEROS.    02940035
               10  FILLER                    PIC 9(01)  VALUE 9.        02950035
                                                                        02960023
           05  PV-KOHLS-SIGN-UPC.                                       02970041
               10  PV-KOHLS-UPC-MIN-SIGNONLY     PIC S9(13).            02980037
               10  PV-KOHLS-UPC-MAX-SIGNONLY     PIC S9(13).            02990037
                                                                        03000037
           05  PV-KOHLS-SIGN-UPC.                                       03010041
               10  PV-KOHLS-UPC-MIN-SIGNV     PIC S9(13)V.              03020037
               10  PV-KOHLS-UPC-MAX-SIGNV     PIC S9(13)V.              03030037
                                                                        03040037
           05  PV-KOHLS-MDSEAR-UPC.                                     03050041
               10  PV-KOHLS-UPC-MIN          PIC S9(13)V COMP-3.        03060036
               10  PV-KOHLS-UPC-MAX          PIC S9(13)V COMP-3.        03070036
                                                                        03080035
       01  PS-SWITCHES.                                                 03090015
           05  PS-ERROR-SW                   PIC X       VALUE 'N'.     03100015
               88  PS-NO-ERROR                           VALUE 'N'.     03110015
               88  PS-ERROR                              VALUE 'Y'.     03120015
           05  REGISTER-SALES-FILE-SW        PIC X       VALUE 'N'.     03130015
               88  END-OF-REGISTER-SALES-FILE            VALUE 'Y'.     03140015
           05  PRICE-CHANGE-FILE-SW          PIC X       VALUE 'N'.     03150015
               88  END-OF-PRICE-CHANGE-FILE              VALUE 'Y'.     03160015
           05  STORE-TRANSFER-FILE-SW        PIC X       VALUE 'N'.     03170015
               88  END-OF-STORE-TRANSFER-FILE            VALUE 'Y'.     03180015
                                                                        03190015
       01  PC-PROGRAM-CONSTANTS.                                        03200015
           05  PC-PROGRAM-NAME             PIC  X(8)   VALUE 'MLKUT003'.03210015
           05  PC-MORE-THAN-MAX-RETRY          PIC S9(4)   VALUE +4.    03220015
           05  PC-END-OF-REPORT                PIC  X(133) VALUE        03230015
               '-*** END OF REPORT ***'.                                03240015
           05  PC-TYP-CDE-TRANSFER             PIC  X      VALUE '2'.   03250015
           05  PC-DPKUT500                     PIC  X(08)  VALUE        03260015
               'DPKUT500'.                                              03270015
           05  PC-SALES-CORR-TYPE              PIC  X(01)  VALUE 'O'.   03280015
           05  PC-D09910-PC-ATTR          PIC  X(09)  VALUE '099100010'.03290015
                                                                        03300015
       01  PV-PROGRAM-VARIBLES.                                         03310015
                                                                        03320015
           05  PV-TRANSACTION-TYPE.                                     03330015
               10  PV-TRAN-TYPE                PIC X(2).                03340015
               10  PV-TRAN-TYPE-DESC           PIC X(20).               03350015
           05  FILLER REDEFINES PV-TRANSACTION-TYPE                     03360015
                                               PIC X(22).               03370015
               88  PV-SALE                     VALUE                    03380015
                  '20SALE                '.                             03390015
               88  PV-STORE-TRANSFER           VALUE                    03400015
                  '30STORE TRANSFER      '.                             03410015
               88  PV-MKDOWN                   VALUE                    03420015
                  '40MARKDOWN            '.                             03430015
               88  PV-MKUP                     VALUE                    03440015
                  '50MARKUP              '.                             03450015
                                                                        03460015
           05  PV-JRNL-IND                     PIC X(01).               03470015
               88  PV-JRNL-YES                 VALUE  'Y'.              03480015
               88  PV-JRNL-NO                  VALUE  'N'.              03490015
                                                                        03500015
       01  DISPLAYED-HEADINGS.                                          03510015
           05  DH-TITLE                        PIC X(80).               03520015
               88  DH-COUNT-BY-SOURCE          VALUE                    03530015
                  'MLKUT003 - COUNTS BY SOURCE SYSTEM:'.                03540015
               88  DH-COUNT-BY-TRAN-TYPE       VALUE                    03550015
                  'MLKUT003 - COUNTS BY TRANSACTION-TYPE:'.             03560015
                                                                        03570015
           05  DH-HEADING.                                              03580015
               10  FILLER                      PIC X(30) VALUE SPACES.  03590015
               10  FILLER                      PIC X(11) VALUE          03600015
                  'INPUT'.                                              03610015
               10  FILLER                      PIC X(06) VALUE          03620015
                  'ERROR'.                                              03630015
               10  FILLER                      PIC X(13) VALUE          03640015
                  'SKIP CLASS'.                                         03650015
               10  FILLER                      PIC X(11) VALUE          03660015
                  'ACCEPTED'.                                           03670015
                                                                        03680015
           05  DL-DETAIL.                                               03690015
               10  FILLER                      PIC X(04).               03700015
               10  DL-DESC                     PIC X(20).               03710015
      *        10  DL-DESC                     PIC X(27).               03720015
                   88  DT1                     VALUE                    03730015
                  'PRICE CHANGE MRKDOWN'.                               03740021
                   88  DT2                     VALUE                    03750021
                  'PRICE CHANGE MARKUPS'.                               03760021
                   88  DT10                    VALUE                    03770015
                  'REGISTER SALES      '.                               03780015
                   88  DT11                    VALUE                    03790021
                  'STORE TRANSFERS     '.                               03800021
                   88  DT20                    VALUE                    03810015
                  'MARKDOWNS           '.                               03820015
                   88  DT21                    VALUE                    03830015
                  'MARKUPS             '.                               03840015
                   88  DT22                    VALUE                    03850015
                  'SALES               '.                               03860015
                   88  DT24                    VALUE                    03870015
                  'TRANSFERS           '.                               03880015
               10  FILLER                      PIC X(01).               03890015
               10  DL-INPUT                    PIC ZZ,ZZZ,ZZ9.          03900015
               10  FILLER                      PIC X(01)   VALUE SPACES.03910015
               10  DL-ERROR                    PIC ZZ,ZZZ,ZZZ.          03920015
               10  FILLER                      PIC X(01)   VALUE SPACES.03930015
               10  DL-SKIP-CLASS               PIC ZZ,ZZZ,ZZZ.          03940015
               10  FILLER                      PIC X(01)   VALUE SPACES.03950015
               10  DL-ACCEPTED                 PIC ZZ,ZZZ,ZZ9.          03960015
               10  FILLER                      PIC X(01)   VALUE SPACES.03970015
                                                                        03980015
      ***************************************************************** 03990015
      *  WORK AREA PASSED IN CALL TO DPKUT500                          *04000015
      ***************************************************************** 04010015
           COPY DPWS500.                                                04020015
                                                                        04030015
      ***************************************************************** 04040015
      *  STANDARD 133 BYTE REPORT HEADINGS                             *04050015
      ***************************************************************** 04060015
           COPY DPWS133O.                                               04070015
       01  HEADER2.                                                     04080015
           05  FILLER                  PIC X(47)   VALUE SPACES.        04090015
           05  FILLER                  PIC X(40)   VALUE                04100015
               'INVENTORY TRANSACTION LOAD ERRORS'.                     04110015
           05  FILLER                  PIC X(46)   VALUE SPACES.        04120015
                                                                        04130015
       01  HEADER3.                                                     04140015
           05  FILLER                  PIC X(01)   VALUE '0'.           04150015
           05  FILLER                  PIC X(04)   VALUE 'CODE'.        04160015
           05  FILLER                  PIC X(06)   VALUE SPACES.        04170015
           05  FILLER                  PIC X(21)   VALUE 'SOURCE'.      04180015
           05  FILLER                  PIC X(26)   VALUE 'REASON'.      04190015
           05  FILLER                  PIC X(80)   VALUE 'RECORD DATA'. 04200015
                                                                        04210015
       01  ERROR-LINE.                                                  04220015
           05  FILLER                  PIC X(02)   VALUE '0'.           04230015
           05  EL-CODE                 PIC X(01).                       04240015
           05  FILLER                  PIC X(05)   VALUE SPACES.        04250015
           05  EL-SOURCE               PIC X(17).                       04260015
           05  FILLER                  PIC X(01)   VALUE SPACES.        04270015
           05  EL-REASON               PIC X(25).                       04280015
           05  FILLER                  PIC X(01)   VALUE SPACES.        04290015
           05  EL-DATA                 PIC X(80).                       04300015
                                                                        04310015
       01  ABEND-CODE                          PIC S9(04)  VALUE +0     04320015
                                                           COMP SYNC.   04330015
           EXEC SQL                                                     04340015
               INCLUDE SQLCA                                            04350015
           END-EXEC.                                                    04360015
                                                                        04370015
517404     EXEC SQL                                                     04380049
517404         INCLUDE TMLCNTL                                          04390049
517404     END-EXEC.                                                    04400049
517404                                                                  04410049
517404     EXEC SQL                                                     04420049
517404         INCLUDE TDTATTR                                          04430049
517404     END-EXEC.                                                    04440049
517404                                                                  04450049
           EXEC SQL                                                     04460025
               INCLUDE TMDSEAR                                          04470025
           END-EXEC.                                                    04480025
                                                                        04490025
26006 *01  ML501-PV-PROGRAM-VARIABLE.                                   04500071
26006 *    TSKXREF                                                      04510071
26006 *    TUPC                                                         04520071
26006 *    TVNDSTL                                                      04530071
26006 *    TVNDDPT                                                      04540071
26006      COPY MLWS501.                                                04550071
                                                                        04560071
       EJECT                                                            04570015
       PROCEDURE DIVISION.                                              04580015
                                                                        04590015
       1000-MAIN-MODULE.                                                04600019
      ******************************************************************04610015
      *  MAIN PROCESSING.                                               04620015
      ******************************************************************04630015
                                                                        04640015
           PERFORM 1100-HOUSEKEEPING.                                   04650019
                                                                        04660015
           PERFORM 2000-PROCESS-INPUT-FILES.                            04670019
                                                                        04680015
           PERFORM 3000-EOJ.                                            04690019
                                                                        04700015
           DISPLAY 'NBR OF SQL CALLS TO TSKXREF : ', PV-XREF-SQL-CALLS. 04710015
           DISPLAY 'XREF SKUS IN RENUM STATUS : ',                      04720019
                                                 PV-SKXREF-RENUM-STATUS.04730019
                                                                        04740015
W28545     IF PV-SPLIT-RECORD > ZEROES                                  04750081
W28545         DISPLAY ' *** FAST TRANFERS SPLIT ROUTINE EXECUTION -'   04760081
W28545                 ' ITEM QUANTITY EXCEEDING ' PC-MAX-ITEM-QTY      04770081
W28545                 ' UNITS'                                         04780081
W28545         DISPLAY ' *** SPLIT TRANSACTIONS WERE CREATED!!!'        04790081
W28545     END-IF.                                                      04800081
W28545                                                                  04810081
           STOP RUN.                                                    04820015
      *                                                                 04830015
       1100-HOUSEKEEPING.                                               04840019
      ******************************************************************04850015
      *                                                                 04860019
      ******************************************************************04870019
                                                                        04880015
           OPEN OUTPUT REGISTER-SALES-FILE-OUT                          04890015
                       PRICE-CHANGE-FILE-OUT                            04900015
                       STORE-TRANSFER-FILE-OUT                          04910015
W28545                 FAST-TRANSFER-FILE-OUT                           04920079
                       ERROR-REPORT.                                    04930015
                                                                        04940015
           INITIALIZE PV-PROGRAM-VARIABLES.                             04950015
                                                                        04960015
           MOVE 'N'   TO   REGISTER-SALES-FILE-SW                       04970015
                           PRICE-CHANGE-FILE-SW                         04980015
                           STORE-TRANSFER-FILE-SW                       04990015
                                                                        05000015
           ACCEPT CPU-DATE FROM DATE.                                   05010015
           MOVE CPU-YEAR   TO DP133O-RUN-YEAR                           05020015
           MOVE CPU-MONTH  TO DP133O-RUN-MONTH                          05030015
           MOVE CPU-DAY    TO DP133O-RUN-DAY                            05040015
                                                                        05050015
           ACCEPT CPU-TIME FROM TIME.                                   05060015
           MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                          05070015
           MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                        05080015
           MOVE 'MLKUT003' TO DP133O-PROGRAM-NAME.                      05090015
                                                                        05100015
           PERFORM 5000-WRITE-HEADINGS.                                 05110019
                                                                        05120015
517404     PERFORM 8000-GET-MLCNTL-DTES.                                05130049
517404                                                                  05140049
           EJECT.                                                       05150015
                                                                        05160015
      ******************************************************************05170019
      *                                                                 05180019
      ******************************************************************05190019
       1200-DISPLAY-COUNTS-BY-SOURCE.                                   05200019
                                                                        05210019
           MOVE ALL '*' TO DH-TITLE                                     05220019
           DISPLAY DH-TITLE                                             05230019
           SET DH-COUNT-BY-SOURCE            TO TRUE                    05240019
           DISPLAY DH-TITLE                                             05250019
           DISPLAY ' '                                                  05260019
           DISPLAY ' '                                                  05270019
           DISPLAY DH-HEADING                                           05280019
           DISPLAY ' '                                                  05290019
                                                                        05300019
           INITIALIZE DL-DETAIL                                         05310019
           MOVE   PV-TOT-MKDOWN-IN           TO DL-INPUT                05320019
           MOVE   PV-TOT-MKDOWN-OK           TO DL-ACCEPTED             05330019
                                                                        05340019
           SET DT1 TO TRUE                                              05350019
           DISPLAY DL-DETAIL                                            05360019
                                                                        05370019
           INITIALIZE DL-DETAIL                                         05380019
           MOVE   PV-TOT-MKUP-IN             TO DL-INPUT                05390019
           MOVE   PV-TOT-MKUP-OK             TO DL-ACCEPTED             05400019
                                                                        05410019
           SET DT2 TO TRUE                                              05420021
           DISPLAY DL-DETAIL                                            05430019
                                                                        05440019
           INITIALIZE DL-DETAIL                                         05450019
           MOVE   PV-TOT-SALE-IN               TO DL-INPUT              05460019
           MOVE   PV-TOT-SALE-OK               TO DL-ACCEPTED           05470019
                                                                        05480019
           SET DT10 TO TRUE                                             05490019
           DISPLAY DL-DETAIL                                            05500019
                                                                        05510019
           MOVE   PV-TOT-TRANSFER-IN         TO DL-INPUT                05520019
           MOVE   PV-TOT-TRANSFER-OK         TO DL-ACCEPTED             05530019
                                                                        05540019
           SET DT11 TO TRUE                                             05550021
           DISPLAY DL-DETAIL                                            05560019
           INITIALIZE DL-DETAIL.                                        05570019
                                                                        05580019
      ******************************************************************05590019
      *                                                                 05600019
      ******************************************************************05610019
       1300-DISPLAY-COUNTS-BY-TRAN-TP.                                  05620019
                                                                        05630019
           DISPLAY ' '                                                  05640019
           MOVE ALL '*' TO DH-TITLE                                     05650019
           DISPLAY DH-TITLE                                             05660019
           SET DH-COUNT-BY-TRAN-TYPE         TO TRUE                    05670019
           DISPLAY DH-TITLE                                             05680019
           DISPLAY ' '                                                  05690019
           DISPLAY ' '                                                  05700019
           DISPLAY DH-HEADING                                           05710019
           DISPLAY ' '                                                  05720019
                                                                        05730019
           INITIALIZE DL-DETAIL                                         05740019
           MOVE   PV-TOT-MKDOWN-IN           TO DL-INPUT                05750019
           MOVE   PV-TOT-MKDOWN-OK           TO DL-ACCEPTED             05760019
                                                                        05770019
           SET DT20 TO TRUE                                             05780019
           DISPLAY DL-DETAIL                                            05790019
           INITIALIZE DL-DETAIL                                         05800019
                                                                        05810019
           MOVE   PV-TOT-MKUP-IN             TO DL-INPUT                05820019
           MOVE   PV-TOT-MKUP-OK             TO DL-ACCEPTED             05830019
                                                                        05840019
           SET DT21 TO TRUE                                             05850019
           DISPLAY DL-DETAIL                                            05860019
           INITIALIZE DL-DETAIL                                         05870019
                                                                        05880019
           MOVE   PV-TOT-SALE-IN             TO DL-INPUT                05890019
           MOVE   PV-TOT-SALE-OK             TO DL-ACCEPTED             05900019
                                                                        05910019
           SET DT22 TO TRUE                                             05920019
           DISPLAY DL-DETAIL                                            05930019
           INITIALIZE DL-DETAIL                                         05940019
                                                                        05950019
           MOVE   PV-TOT-TRANSFER-IN         TO DL-INPUT                05960019
           MOVE   PV-TOT-TRANSFER-OK         TO DL-ACCEPTED             05970019
                                                                        05980019
           SET DT24 TO TRUE                                             05990019
           DISPLAY DL-DETAIL                                            06000019
           INITIALIZE DL-DETAIL                                         06010019
                                                                        06020019
           DISPLAY ' '                                                  06030019
           MOVE ALL '*' TO DH-TITLE                                     06040019
           DISPLAY DH-TITLE.                                            06050019
                                                                        06060019
      ******************************************************************06070019
      *                                                                 06080019
      ******************************************************************06090019
                                                                        06100015
       2000-PROCESS-INPUT-FILES.                                        06110019
                                                                        06120015
           DISPLAY 'OPEN REGISTER-SALES-FILE'                           06130015
           OPEN  INPUT REGISTER-SALES-FILE                              06140015
           PERFORM 7100-READ-REGISTER-SALES                             06150019
           PERFORM 2100-PROCESS-REGISTER-SALES                          06160019
               UNTIL END-OF-REGISTER-SALES-FILE                         06170015
           CLOSE REGISTER-SALES-FILE                                    06180015
           DISPLAY 'CLOSE REGISTER-SALES-FILE'                          06190015
           DISPLAY '*****'                                              06200015
                                                                        06210015
           DISPLAY '                        '                           06220015
           DISPLAY 'OPEN PRICE-CHANGE-FILE'                             06230015
           OPEN INPUT  PRICE-CHANGE-FILE                                06240015
           PERFORM 7200-READ-PRICE-CHANGE                               06250019
           PERFORM 2200-PROCESS-PRICE-CHANGE                            06260019
               UNTIL END-OF-PRICE-CHANGE-FILE                           06270015
           CLOSE PRICE-CHANGE-FILE                                      06280015
           DISPLAY 'CLOSE PRICE-CHANGE-FILE'                            06290015
           DISPLAY '*****'                                              06300015
                                                                        06310015
           DISPLAY '                        '                           06320015
           DISPLAY 'OPEN STORE-TRANSFER-FILE'                           06330015
           OPEN INPUT  STORE-TRANSFER-FILE                              06340015
           PERFORM 7300-READ-STORE-TRANSFER                             06350019
           PERFORM 2300-PROCESS-STORE-TRANSFER                          06360019
               UNTIL END-OF-STORE-TRANSFER-FILE                         06370015
           CLOSE STORE-TRANSFER-FILE.                                   06380015
           DISPLAY 'CLOSE STORE-TRANSFER-FILE'.                         06390015
                                                                        06400015
W28545     DISPLAY '                        '                           06410079
W28545     DISPLAY 'OPEN FAST-TRANSFER-FILE'                            06420079
W28545     MOVE 'N' TO STORE-TRANSFER-FILE-SW                           06430079
W28545     OPEN INPUT FAST-TRANSFER-FILE                                06440079
W28545     PERFORM 7400-READ-FAST-TRANSFER                              06450079
W28545     PERFORM 2400-PROCESS-FAST-TRANSFER                           06460079
W28545         UNTIL END-OF-STORE-TRANSFER-FILE                         06470079
W28545     CLOSE FAST-TRANSFER-FILE.                                    06480079
W28545     DISPLAY 'CLOSE FAST-TRANSFER-FILE'.                          06490079
W28545                                                                  06500079
      /*****************************************************************06510079
      *                                                                 06520019
      ******************************************************************06530019
       2100-PROCESS-REGISTER-SALES.                                     06540019
                                                                        06550015
           SET PV-SALE   TO TRUE.                                       06560015
                                                                        06570015
           ADD 1 TO  PV-TOT-SALE-IN.                                    06580015
                                                                        06590015
           IF  PV-SALE-SEQNO = ZEROES                                   06600015
                   MOVE PV-SALE-SKU(1:5)   TO PV-SALE-DEPT-CLASS        06610015
                                              PV-SAVE-DEPT-CLASS        06620015
                   MOVE PV-SALE-CLASS(1:1) TO PV-NEW-SKU-MAJ-CLASS      06630015
                   MOVE PV-NEW-SKU-MCL     TO PV-SALE-MAJOR-CLASS       06640015
                                              PV-SAVE-MAJ-CL            06650015
           ELSE                                                         06660015
               IF  PV-HOLD-SKU = PV-SALE-SKU                            06670015
                   MOVE PV-SAVE-DEPT-CLASS TO PV-SALE-DEPT-CLASS        06680015
                   MOVE PV-SAVE-MAJ-CL     TO PV-SALE-MAJOR-CLASS       06690015
               ELSE                                                     06700015
                   MOVE PV-SALE-SKU     TO PV-HOLD-SKU                  06710015
                   MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF             06720015
517404             MOVE PV-SALE-DATE    TO PV-HOLD-DATE                 06730049
                   PERFORM 4000-RETRIEVE-SKU-ATTRIBUTES                 06740019
                   MOVE SKXREF-DEPT     TO PV-SALE-DEPT                 06750015
                                           PV-SAVE-DEPT                 06760015
                   MOVE SKXREF-SUBCLASS TO PV-SALE-CLASS                06770015
                                           PV-SAVE-SCL                  06780015
                   MOVE SKXREF-CLASS    TO PV-SALE-MAJOR-CLASS          06790015
                                           PV-SAVE-MAJ-CL               06800015
               END-IF                                                   06810015
           END-IF.                                                      06820015
                                                                        06830015
           PERFORM 3100-FMT-SALES-REC.                                  06840019
                                                                        06850015
           ADD 1 TO PV-TOT-SALE-OK.                                     06860015
                                                                        06870015
           PERFORM 7100-READ-REGISTER-SALES.                            06880019
                                                                        06890015
      ******************************************************************06900019
      *                                                                 06910019
      ******************************************************************06920019
                                                                        06930019
       2200-PROCESS-PRICE-CHANGE.                                       06940019
                                                                        06950019
                                                                        06960019
           ADD 1     TO  PV-TOT-PRC-CHG-IN                              06970019
                                                                        06980019
26006      IF ML017-MKDOWN                                              06990075
               ADD 1 TO PV-TOT-MKDOWN-IN                                07000019
           ELSE                                                         07010019
26006          IF ML017-MKUP                                            07020075
                   ADD 1 TO PV-TOT-MKUP-IN                              07030019
               END-IF                                                   07040019
           END-IF                                                       07050019
                                                                        07060019
26006      IF  ML017-PC-SEQ-NBR = ZEROES                                07070075
26006          MOVE ML017-PC-SKU(1:5)         TO ML017-PC-DEPT-CLASS    07080075
                                                 PV-SAVE-DEPT-CLASS     07090021
26006          MOVE ML017-PC-CLASS-NBR(1:1)   TO PV-NEW-SKU-MAJ-CLASS   07100078
               MOVE PV-NEW-SKU-MCL            TO ML017-PC-MAJ-CLASS     07110072
                                                                        07120076
26006          SET ML501-PV-INHOUSE-LOOKUP TO TRUE                      07130076
26006          MOVE ML017-PC-ENT-ID   TO ML501-PV-ENT-ID-IN-9           07140076
26006          MOVE ML017-PC-DEPT-NBR TO ML501-PV-DEPT-IN-9             07150076
26006          MOVE ML017-PC-VENDOR-INHSE-NMBR                          07160076
26006              TO ML501-PV-INHOUSE-NBR-IN                           07170076
26006          PERFORM ML501-LOOKUP-VENDOR                              07180076
26006          IF SQLCODE = ZEROES                                      07190076
26006              OR SQLCODE = +100                                    07200076
26006              MOVE ML501-PV-ENT-ID-OUT TO ML017-PC-ENT-ID          07210076
26006                                          PV-SAVE-ENT-ID           07220076
26006          ELSE                                                     07230076
26006              DISPLAY '*** VENDOR LOOKUP USING DEPT = '            07240076
26006                      ML017-PC-DEPT-NBR                            07250076
26006                      ', IN-HOUSE NBR = '                          07260076
26006                      ML501-PV-INHOUSE-NBR-IN                      07270076
26006              MOVE '2200-PROCESS-PRICE-CHANGE'                     07280076
26006                  TO PV-PARAGRAPH-NAME                             07290076
26006              MOVE 'CALL TO GET VENDOR  '                          07300076
26006                  TO PV-OPERATION-ATTEMPTED                        07310076
26006              PERFORM 9999-SQL-ABEND                               07320076
26006          END-IF                                                   07330076
           ELSE                                                         07340019
      *    099-10 TRANSACTIONS WITH NON-000 SEQ (NOT FOUND - TSKXREF)   07350019
      *    MOVE 099-10 TO NEW SKU ATTRIBUTES                            07360019
26006          IF ML017-PC-SKU(1:5) = '09910'                           07370075
                   MOVE PC-D09910-PC-ATTR    TO ML017-PC-SKU-DTA-ATTRIB 07380019
               ELSE                                                     07390019
26006              IF PV-HOLD-SKU = ML017-PC-SKU                        07400076
                       MOVE PV-SAVE-DEPT-CLASS-ATTR                     07410019
                           TO ML017-PC-SKU-DTA-ATTRIB                   07420076
26006                  MOVE PV-SAVE-ENT-ID TO ML017-PC-ENT-ID           07430076
                   ELSE                                                 07440019
26006                  MOVE ML017-PC-SKU TO PV-HOLD-SKU                 07450075
26006                  IF ML017-PC-DEPT-CLASS NUMERIC                   07460075
26006                      AND ML017-PC-DEPT-NBR NOT = ZEROES           07470075
26006                      AND ML017-PC-CLASS-NBR NOT = ZEROES          07480075
26006                      AND ML017-PC-MAJ-CLASS NUMERIC               07490075
26006                      AND ML017-PC-MAJ-CLASS NOT = ZEROES          07500075
26006                      MOVE ML017-PC-DEPT-NBR  TO PV-SAVE-DEPT      07510075
26006                      MOVE ML017-PC-CLASS-NBR TO PV-SAVE-SCL       07520075
26006                      MOVE ML017-PC-MAJ-CLASS TO PV-SAVE-MAJ-CL    07530075
26006                  ELSE                                             07540075
26006                      MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF     07550075
26006                      MOVE ML017-PC-DTE-MM TO PV-HOLD-DATE-MM      07560075
26006                      MOVE ML017-PC-DTE-DD TO PV-HOLD-DATE-DD      07570075
26006                      MOVE SPACES          TO PV-HOLD-DATE-YY      07580075
26006                      PERFORM 4000-RETRIEVE-SKU-ATTRIBUTES         07590075
26006                      MOVE SKXREF-DEPT     TO ML017-PC-DEPT-NBR    07600075
26006                                              PV-SAVE-DEPT         07610075
26006                      MOVE SKXREF-SUBCLASS TO ML017-PC-CLASS-NBR   07620075
26006                                              PV-SAVE-SCL          07630075
26006                      MOVE SKXREF-CLASS    TO ML017-PC-MAJ-CLASS   07640075
26006                                              PV-SAVE-MAJ-CL       07650075
26006                  END-IF                                           07660075
                                                                        07670076
26006                  SET ML501-PV-SKU-LOOKUP TO TRUE                  07680076
26006                  MOVE MLCNTL-OPN-FSCL-MN-DTE                      07690077
26006                      TO ML501-PV-EFF-DTE-IN                       07700077
26006                  MOVE ML017-PC-ENT-ID   TO ML501-PV-ENT-ID-IN-9   07710076
26006                  MOVE ML017-PC-SKU      TO ML501-PV-SKU-IN        07720076
26006                  MOVE ML017-PC-DEPT-NBR TO ML501-PV-DEPT-IN-9     07730076
26006                  MOVE ML017-PC-VENDOR-INHSE-NMBR                  07740076
26006                      TO ML501-PV-INHOUSE-NBR-IN                   07750076
26006                  PERFORM ML501-LOOKUP-VENDOR                      07760076
26006                  IF SQLCODE = ZEROES                              07770076
26006                      OR SQLCODE = +100                            07780076
26006                      MOVE ML501-PV-ENT-ID-OUT TO ML017-PC-ENT-ID  07790076
26006                                                  PV-SAVE-ENT-ID   07800076
26006                  ELSE                                             07810076
26006                      DISPLAY '*** VENDOR LOOKUP USING SKU = '     07820076
26006                              ML017-PC-SKU                         07830076
26006                              ', DEPT = '                          07840076
26006                              ML017-PC-DEPT-NBR                    07850076
26006                              ', IN-HOUSE NBR = '                  07860076
26006                              ML501-PV-INHOUSE-NBR-IN              07870076
26006                      MOVE '2200-PROCESS-PRICE-CHANGE'             07880076
26006                          TO PV-PARAGRAPH-NAME                     07890076
26006                      MOVE 'CALL TO GET VENDOR  '                  07900076
26006                          TO PV-OPERATION-ATTEMPTED                07910076
26006                      PERFORM 9999-SQL-ABEND                       07920076
26006                  END-IF                                           07930076
                   END-IF                                               07940076
               END-IF                                                   07950076
           END-IF.                                                      07960076
                                                                        07970076
           ADD 1 TO PV-TOT-PRC-CHG-OK                                   07980076
                                                                        07990076
26006      IF  ML017-MKDOWN                                             08000076
               ADD 1 TO PV-TOT-MKDOWN-OK                                08010076
           ELSE                                                         08020076
               ADD 1 TO PV-TOT-MKUP-OK                                  08030076
           END-IF.                                                      08040076
                                                                        08050076
           PERFORM 3200-FMT-PRICE-CHANGE-REC                            08060076
                                                                        08070076
           PERFORM 7200-READ-PRICE-CHANGE.                              08080076
                                                                        08090076
      ******************************************************************08100076
      *                                                                 08110076
      ******************************************************************08120076
                                                                        08130076
       2300-PROCESS-STORE-TRANSFER.                                     08140076
                                                                        08150076
           SET PV-STORE-TRANSFER TO TRUE                                08160076
                                                                        08170076
           ADD 1     TO  PV-TOT-TRANSFER-IN                             08180076
                                                                        08190076
           IF PV-XFER-SEQ-NO = ZEROES                                   08200090
W28545       IF (PV-XFER-DEPT-NBR = ZEROS AND                           08210089
W28545           PV-XFER-CLASS-NBR = ZEROS)                             08220089
               MOVE PV-XFER-SKU(1:5) TO PV-XFER-DEPT-CLASS              08230076
W28545         MOVE 5161             TO PV-XFER-ENT-ID                  08240084
W28545       ELSE                                                       08250089
W28545         MOVE 5161             TO PV-XFER-ENT-ID                  08260094
W28545       END-IF                                                     08270089
W28545     ELSE                                                         08280089
W28545     IF PV-HOLD-SKU-ALPH = PV-XFER-SKU                            08290084
W28545         MOVE PV-SAVE-DEPT-CLASS   TO PV-XFER-DEPT-CLASS          08300084
W28545         MOVE PV-SAVE-ENT-ID       TO PV-XFER-ENT-ID              08310084
W28545     ELSE                                                         08320084
W28545         MOVE PV-XFER-SKU       TO PV-HOLD-SKU                    08330091
W28545         IF (PV-XFER-DEPT-NBR IS NUMERIC   AND                    08340089
W28545             PV-XFER-DEPT-NBR NOT = ZEROS  AND                    08350089
W28545             PV-XFER-CLASS-NBR IS NUMERIC  AND                    08360089
W28545             PV-XFER-CLASS-NBR NOT = ZEROS)                       08370089
W28545           MOVE PV-XFER-DEPT-NBR   TO PV-SAVE-DEPT                08380089
W28545           MOVE PV-XFER-CLASS-NBR  TO PV-SAVE-SCL                 08390089
W28545         ELSE                                                     08400089
                 MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF               08410089
517404           MOVE PV-XFER-MM      TO PV-HOLD-DATE-MM                08420089
517404           MOVE PV-XFER-DD      TO PV-HOLD-DATE-DD                08430089
517404           MOVE SPACES          TO PV-HOLD-DATE-YY                08440089
                 PERFORM 4000-RETRIEVE-SKU-ATTRIBUTES                   08450089
                 MOVE SKXREF-DEPT     TO PV-XFER-DEPT-NBR               08460089
W28545                                   PV-SAVE-DEPT                   08470089
                 MOVE SKXREF-SUBCLASS TO PV-XFER-CLASS-NBR              08480089
W28545                                   PV-SAVE-SCL                    08490089
W28545         END-IF                                                   08500094
W28545                                                                  08510084
W28545         SET ML501-PV-SKU-LOOKUP  TO TRUE                         08520094
W28545         MOVE MLCNTL-OPN-FSCL-MN-DTE TO ML501-PV-EFF-DTE-IN       08530094
W28545         MOVE SPACES              TO ML501-PV-ENT-ID-IN           08540094
W28545         MOVE PV-HOLD-SKU         TO ML501-PV-SKU-IN              08550095
W28545         MOVE PV-XFER-DEPT-NBR    TO ML501-PV-DEPT-IN-9           08560094
W28545         MOVE SPACES              TO ML501-PV-INHOUSE-NBR-IN      08570094
W28545         PERFORM ML501-LOOKUP-VENDOR                              08580094
W28545         IF SQLCODE = ZEROES OR                                   08590094
W28545              SQLCODE = +100                                      08600089
W28545             MOVE ML501-PV-ENT-ID-OUT TO PV-XFER-ENT-ID           08610084
W28545                                         PV-SAVE-ENT-ID           08620084
W28545         ELSE                                                     08630094
W28545             DISPLAY '*** VENDOR LOOKUP USING SKU = '             08640084
W28545                     PV-XFER-SKU                                  08650084
W28545                     ', DEPT = '                                  08660084
W28545                     PV-XFER-DEPT-NBR                             08670084
W28545             MOVE '2300-PROCESS-STORE-TRANSFER'                   08680084
W28545                 TO PV-PARAGRAPH-NAME                             08690084
W28545             MOVE 'CALL TO GET VENDOR  '                          08700084
W28545                 TO PV-OPERATION-ATTEMPTED                        08710084
W28545             PERFORM 9999-SQL-ABEND                               08720084
W28545         END-IF                                                   08730089
           END-IF.                                                      08740076
                                                                        08750076
           PERFORM 3300-FMT-TRANSFER-REC                                08760076
                                                                        08770076
           ADD 1 TO PV-TOT-TRANSFER-OK                                  08780076
                                                                        08790076
           PERFORM 7300-READ-STORE-TRANSFER.                            08800076
                                                                        08810076
W28545******************************************************************08820079
W28545* 2400-PROCESS-FAST-TRANSFER.                                     08830079
W28545*     THE FAST TRANSFER ADJUSTMENT FILE IS IN THE TFRD054 RECORD  08840079
W28545* LAYOUT. THE ROUTINE CONVERTS THE INFORMATION TO THE LEDGER      08850079
W28545* MLRD019 RECORD LAYOUT. ALL OTHER TRANSFERS ARE PROCESSED THROUGH08860079
W28545* THE 2300- ROUTINE. THESE TRANSFERS COME FROM CENTRAL STOCK AND  08870079
W28545* KEYMATER.                                                       08880079
W28545******************************************************************08890079
W28545                                                                  08900079
W28545 2400-PROCESS-FAST-TRANSFER.                                      08910079
W28545                                                                  08920079
W28545     INITIALIZE ML019-TRANSFER-RECORD.                            08930088
W28545     SET PV-STORE-TRANSFER     TO TRUE                            08940079
W28545     ADD 1                     TO PV-TOT-TRANSFER-IN              08950079
W28545                                                                  08960079
W28545* SKU ATTRIBUTES - DEPT/SUB CLASS/ENT ID....                      08970079
W28545     MOVE TFRD054-SKU-NBR      TO PV-EDIT-SKU-NBR.                08980079
W28545     IF PV-EDIT-SKU-NBR (7:3) = ZEROES                            08990079
W28545       IF (TFRD054-DEPT = ZEROS AND                               09000079
W28545           TFRD054-SUBCLASS = ZEROS)                              09010079
W28545         MOVE PV-EDIT-SKU-NBR (2:5) TO ML019-TRANSFER-DEPT-CLASS  09020079
W28545         MOVE 5161                  TO ML019-TRANSFER-ENT-ID      09030079
W28545       ELSE                                                       09040079
W28545         MOVE TFRD054-DEPT     TO PV-EDIT-DEPT                    09050079
W28545         MOVE TFRD054-SUBCLASS TO PV-EDIT-SUBCLASS                09060079
W28545         STRING PV-EDIT-DEPT-P2 DELIMITED BY SIZE                 09070079
W28545                PV-EDIT-SCL-P2 DELIMITED BY SIZE                  09080079
W28545                               INTO ML019-TRANSFER-DEPT-CLASS     09090079
W28545         MOVE 5161             TO ML019-TRANSFER-ENT-ID           09100079
W28545       END-IF                                                     09110079
W28545     ELSE                                                         09120079
W28545     IF PV-HOLD-SKU-ALPH = ML019-SKU                              09130079
W28545         MOVE PV-SAVE-DEPT-CLASS   TO ML019-TRANSFER-DEPT-CLASS   09140079
W28545         MOVE PV-SAVE-ENT-ID       TO ML019-TRANSFER-ENT-ID       09150079
W28545     ELSE                                                         09160079
W28545         MOVE TFRD054-SKU-NBR      TO PV-HOLD-SKU                 09170079
W28545         IF (TFRD054-DEPT IS NUMERIC      AND                     09180079
W28545             TFRD054-DEPT NOT = ZEROS     AND                     09190079
W28545             TFRD054-SUBCLASS IS NUMERIC  AND                     09200079
W28545             TFRD054-SUBCLASS NOT = ZEROS)                        09210079
W28545             MOVE TFRD054-DEPT     TO ML019-TRANSFER-DEPT-NBR     09220079
W28545                                      PV-SAVE-DEPT                09230079
W28545             MOVE TFRD054-SUBCLASS TO ML019-TRANSFER-CLASS-NBR    09240079
W28545                                      PV-SAVE-SCL                 09250079
W28545         ELSE                                                     09260079
W28545             MOVE PV-HOLD-SKU      TO PV-HOLD-SKU-XREF            09270080
W28545             MOVE TFRD054-CREATE-DATE-MM TO PV-HOLD-DATE-MM       09280079
W28545             MOVE TFRD054-CREATE-DATE-DD TO PV-HOLD-DATE-DD       09290079
W28545             MOVE TFRD054-CREATE-DATE-YY TO PV-HOLD-DATE-YY       09300080
W28545             PERFORM 4000-RETRIEVE-SKU-ATTRIBUTES                 09310079
W28545             MOVE SKXREF-DEPT      TO ML019-TRANSFER-DEPT-NBR     09320079
W28545                                      PV-SAVE-DEPT                09330079
W28545             MOVE SKXREF-SUBCLASS  TO ML019-TRANSFER-CLASS-NBR    09340079
W28545                                      PV-SAVE-SCL                 09350079
W28545         END-IF                                                   09360079
W28545                                                                  09370079
W28545         SET ML501-PV-SKU-LOOKUP  TO TRUE                         09380079
W28545         MOVE MLCNTL-OPN-FSCL-MN-DTE TO ML501-PV-EFF-DTE-IN       09390079
W28545         MOVE SPACES              TO ML501-PV-ENT-ID-IN           09400079
W28545         MOVE TFRD054-SKU-NBR     TO ML501-PV-SKU-IN-9            09410079
W28545         MOVE TFRD054-DEPT        TO ML501-PV-DEPT-IN-9           09420079
W28545         MOVE SPACES              TO ML501-PV-INHOUSE-NBR-IN      09430079
W28545         PERFORM ML501-LOOKUP-VENDOR                              09440079
W28545         IF SQLCODE = ZEROES OR                                   09450079
W28545            SQLCODE = +100                                        09460079
W28545             MOVE ML501-PV-ENT-ID-OUT TO ML019-TRANSFER-ENT-ID    09470079
W28545                                         PV-SAVE-ENT-ID           09480079
W28545         ELSE                                                     09490079
W28545             DISPLAY '*** VENDOR LOOKUP USING SKU = '             09500079
W28545                     TFRD054-SKU-NBR                              09510079
W28545                     ', DEPT = '                                  09520079
W28545                     TFRD054-DEPT                                 09530079
W28545             MOVE '2400-PROCESS-FAST-TRANSFER'                    09540084
W28545                 TO PV-PARAGRAPH-NAME                             09550079
W28545             MOVE 'CALL TO GET VENDOR  '                          09560079
W28545                 TO PV-OPERATION-ATTEMPTED                        09570079
W28545             PERFORM 9999-SQL-ABEND                               09580079
W28545         END-IF                                                   09590079
W28545     END-IF.                                                      09600079
W28545                                                                  09610079
W28545* FORMAT THE ML TRANSFER RECORD...                                09620079
W28545     MOVE '3'                  TO ML019-TRANSFER-CODE.            09630079
W28545     MOVE 'FAST'               TO ML019-TRANSFER-NBR.             09640079
W28545                                                                  09650099
W28545     MOVE TFRD054-BATCH-NBR    TO PV-EDIT-BATCH-NBR.              09660099
W28545     MOVE PV-EDIT-BATCH-NBR-P2 TO ML019-TRANSFER-BATCH-NBR.       09670099
W28545                                                                  09680079
W28545     MOVE TFRD054-CREATE-DATE-MM   TO ML019-TRANSFER-MM.          09690079
W28545     MOVE TFRD054-CREATE-DATE-DD   TO ML019-TRANSFER-DD.          09700079
W28545     MOVE MLCNTL-PSTG-FSCL-MN-NBR  TO ML019-TRANSFER-KOHLS-MM.    09710079
W28545                                                                  09720079
W28545     MOVE TFRD054-DOC-FROM-LOC-NBR TO PV-EDIT-DOC-FROM-LOC-NBR.   09730079
W28545     MOVE PV-EDIT-DOC-FROM-LOC-NBR TO ML019-TRANSFER-DOC-STORE.   09740079
W28545                                                                  09750079
W28545     MOVE TFRD054-DOC-SEQ-NBR  TO PV-EDIT-DOC-SEQ-NBR.            09760079
W28545     MOVE PV-EDIT-DOC-LAST-6   TO ML019-TRANSFER-DOC-SEQ.         09770079
W28545                                                                  09780079
W28545     MOVE PV-EDIT-SKU-NBR(2:8) TO ML019-SKU.                      09790079
W28545                                                                  09800079
W28545     MOVE TFRD054-FROM-LOC-NBR TO PV-EDIT-LOC-NBR.                09810079
W28545     MOVE PV-EDIT-LOC-NBR      TO ML019-TRANSFER-FROM-STORE-NBR.  09820079
W28545                                                                  09830079
W28545     MOVE TFRD054-TO-LOC-NBR   TO PV-EDIT-LOC-NBR.                09840079
W28545     MOVE PV-EDIT-LOC-NBR      TO ML019-TRANSFER-TO-STORE-NBR.    09850079
W28545                                                                  09860079
W28545     MOVE TFRD054-ITEM-PRICE   TO ML019-TRANSFER-PER-UNT-RTL-AMT. 09870079
W28545                                                                  09880079
W28545* ARE SPLIT TRANSACTIONS REQUIRED FOR THE ITEM QUANTITY?          09890079
W28545     PERFORM                                                      09900079
W28545       UNTIL TFRD054-ITEM-QTY <= PC-MAX-ITEM-QTY                  09910079
W28545         ADD 1                 TO PV-SPLIT-RECORD                 09920079
W28545         COMPUTE TFRD054-ITEM-QTY = TFRD054-ITEM-QTY              09930079
W28545                                  - PC-MAX-ITEM-QTY               09940079
W28545         MOVE PC-MAX-ITEM-QTY  TO ML019-TRANSFER-QTY              09950079
W28545         MOVE TFRD054-ITEM-PRICE                                  09960079
W28545                               TO ML019-TRANSFER-PER-UNT-RTL-AMT  09970079
W28545         PERFORM 3400-FMT-TRANSFER-REC                            09980079
W28545     END-PERFORM.                                                 09990079
W28545                                                                  10000079
W28545     MOVE TFRD054-ITEM-QTY     TO ML019-TRANSFER-QTY.             10010079
W28545                                                                  10020079
W28545* WRITE THE ML TRANSFER TRANSACTION...                            10030079
W28545     PERFORM 3400-FMT-TRANSFER-REC                                10040079
W28545                                                                  10050079
W28545     ADD 1 TO PV-TOT-TRANSFER-OK                                  10060079
W28545                                                                  10070079
W28545* READ NEXT TRANSFER...                                           10080079
W28545     PERFORM 7400-READ-FAST-TRANSFER.                             10090079
W28545                                                                  10100079
      ******************************************************************10110076
      *    CLOSE THE FILES AND DISPLAY COUNTS                           10120076
      ******************************************************************10130076
       3000-EOJ.                                                        10140076
                                                                        10150076
           MOVE PC-END-OF-REPORT TO ERROR-LINE                          10160076
           PERFORM 5100-WRITE-ERROR-REPORT.                             10170076
           CLOSE REGISTER-SALES-FILE-OUT                                10180076
                 PRICE-CHANGE-FILE-OUT                                  10190076
                 STORE-TRANSFER-FILE-OUT                                10200076
                 ERROR-REPORT.                                          10210076
           PERFORM 1200-DISPLAY-COUNTS-BY-SOURCE.                       10220076
           PERFORM 1300-DISPLAY-COUNTS-BY-TRAN-TP.                      10230076
                                                                        10240076
      ******************************************************************10250076
      *                                                                 10260076
      ******************************************************************10270076
                                                                        10280015
       3100-FMT-SALES-REC.                                              10290019
                                                                        10300015
           INITIALIZE D040-RECORD.                                      10310015
                                                                        10320015
           WRITE REGISTER-SALES-FILE-OUT-REC                            10330015
207210                             FROM PV-SALES-FORMAT-PSWS010N.       10340099
                                                                        10350015
      ******************************************************************10360019
      *                                                                 10370019
      ******************************************************************10380019
                                                                        10390015
       3200-FMT-PRICE-CHANGE-REC.                                       10400019
                                                                        10410015
           WRITE PRICE-CHANGE-FILE-OUT-REC                              10420015
                                     FROM ML017-PRICE-CHANGE-RECORD.    10430072
                                                                        10440015
      ******************************************************************10450019
      *                                                                 10460019
      ******************************************************************10470019
                                                                        10480015
       3300-FMT-TRANSFER-REC.                                           10490019
                                                                        10500015
W28545**** INITIALIZE ML019-TRANSFER-RECORD.                            10510085
                                                                        10520015
           WRITE STORE-TRANSFER-FILE-OUT-REC                            10530015
                                     FROM PV-XFER-FORMAT-MLRD019.       10540010
                                                                        10550015
W28545******************************************************************10560079
W28545* 3400-FMT-TRANSFER-REC. (FAST TRANSFER FILE REFORMAT)            10570079
W28545******************************************************************10580079
W28545 3400-FMT-TRANSFER-REC.                                           10590079
W28545                                                                  10600079
W28545     WRITE FAST-TRANSFER-FILE-OUT-REC                             10610079
W28545                               FROM ML019-TRANSFER-RECORD.        10620079
W28545                                                                  10630079
      ******************************************************************10640015
      * IF SKU ATTRIBUTES (DEPT/SCL) ARE NOT ON INPUT FILE, USE 8-BYTE  10650015
      * SKU NUMBER TO RETRIEVE ATTRIBUTES (DEPT / SUBCLASS) FROM TSKXREF10660015
      ******************************************************************10670015
       4000-RETRIEVE-SKU-ATTRIBUTES.                                    10680019
                                                                        10690015
            ADD 1 TO PV-XREF-SQL-CALLS.                                 10700015
                                                                        10710015
W26603      MOVE PV-HOLD-SKU-XREF   TO SKXREF-SKU.                      10720065
W26603                                                                  10730065
            EXEC SQL                                                    10740015
                SELECT DEPT                                             10750015
                      ,CLASS                                            10760015
                      ,SUBCLASS                                         10770015
                      ,SKU_STAT_CDE                                     10780019
                 INTO  :SKXREF-DEPT                                     10790015
                      ,:SKXREF-CLASS                                    10800015
                      ,:SKXREF-SUBCLASS                                 10810015
                      ,:SKXREF-SKU-STAT-CDE                             10820019
                 FROM  TSKXREF                                          10830015
W26603          WHERE  SKU = :SKXREF-SKU                                10840065
W26603          WITH UR                                                 10850065
            END-EXEC.                                                   10860015
      *                                                                 10870015
           EVALUATE SQLCODE                                             10880015
               WHEN 0                                                   10890015
                  IF SKXREF-SKU-STAT-CDE = '98'                         10900041
                      ADD 1 TO PV-SKXREF-RENUM-STATUS                   10910019
                  END-IF                                                10920019
               WHEN +100                                                10930015
                  DISPLAY ' SKU ', PV-HOLD-SKU-XREF, ' XREF NOT FOUND'  10940024
                  PERFORM 4100-GET-DKEY-FROM-TUPC                       10950041
      *           MOVE '000'  TO SKXREF-DEPT                            10960022
      *           MOVE '0000' TO SKXREF-CLASS                           10970022
      *           MOVE '00'   TO SKXREF-SUBCLASS                        10980022
               WHEN OTHER                                               10990015
                  MOVE '4000-RETRIEVE-SKU-ATTRIBUTES'                   11000019
                                 TO PV-PARAGRAPH-NAME                   11010015
                  MOVE 'ERROR ON SELECT FROM TSKXREF'                   11020015
                                 TO PV-OPERATION-ATTEMPTED              11030015
                  PERFORM 9999-SQL-ABEND                                11040015
           END-EVALUATE.                                                11050015
                                                                        11060015
                                                                        11070015
      ******************************************************************11080022
      * PERFORMED WHEN A SKU IS NOT FOUND ON TSKXREF                    11090022
      ******************************************************************11100022
       4100-GET-DKEY-FROM-TUPC.                                         11110041
                                                                        11120022
517404*** BUILD A UPC RANGE.                                            11130049
           MOVE PV-HOLD-SKU-XREF  TO  PV-KOHLS-SKU-MIN                  11140027
                                      PV-KOHLS-SKU-MAX.                 11150027
                                                                        11160022
           MOVE PV-KOHLS-UPC-LOW  TO  PV-KOHLS-UPC-MIN-SIGNONLY         11170040
                                      PV-KOHLS-UPC-MIN-SIGNV            11180037
                                                                        11190038
           MOVE PV-KOHLS-UPC-HIGH TO  PV-KOHLS-UPC-MAX-SIGNONLY         11200040
                                      PV-KOHLS-UPC-MAX-SIGNV            11210037
                                                                        11220037
           MOVE PV-KOHLS-UPC-MIN-SIGNONLY TO PV-KOHLS-UPC-MIN.          11230040
                                                                        11240039
           MOVE PV-KOHLS-UPC-MAX-SIGNONLY TO PV-KOHLS-UPC-MAX.          11250040
                                                                        11260039
517404*** BUILD AN EFFECTIVE DATE RANGE FROM THE FIN LIAB DATE....      11270056
517404     PERFORM 6000-EDIT-WORK-DATE.                                 11280049
517404                                                                  11290049
      *** FIND THE MDSEAR ID ....                                       11300048
           EXEC SQL                                                     11310055
               SELECT SUB_CL_MDSEAR_ID                                  11320055
               INTO :UPC-SUB-CL-MDSEAR-ID                               11330055
               FROM TUPC                                                11340055
517404         WHERE (((UPC_NBR >= :PV-KOHLS-UPC-MIN                    11350055
                 AND    UPC_NBR <= :PV-KOHLS-UPC-MAX)                   11360055
517404           AND   (:PV-WORK-DATE BETWEEN EFF_BEG_DTE               11370055
517404                                    AND EFF_END_DTE))             11380055
517404         OR     ((UPC_NBR >= :PV-KOHLS-UPC-MIN                    11390055
517404           AND    UPC_NBR <= :PV-KOHLS-UPC-MAX)                   11400055
517404           AND   (:PV-WORK-DATE >= EFF_BEG_DTE                    11410055
517404           AND    EFF_END_DTE IS NULL)))                          11420055
W28545         WITH UR                                                  11430081
           END-EXEC.                                                    11440055
      *                                                                 11450039
           EVALUATE SQLCODE                                             11460039
               WHEN 0                                                   11470039
                  PERFORM 4200-GET-ATTR-FROM-TMDSEAR                    11480039
               WHEN +100                                                11490039
                  DISPLAY ' UPC ', PV-KOHLS-UPC-MIN, ' NOT FOUND-TUPC'  11500039
                  MOVE '000'  TO SKXREF-DEPT                            11510039
                  MOVE '0000' TO SKXREF-CLASS                           11520039
                  MOVE '00'   TO SKXREF-SUBCLASS                        11530039
               WHEN OTHER                                               11540039
                  MOVE '4100-GET-DKEY-FROM-TUPC'                        11550039
                                 TO PV-PARAGRAPH-NAME                   11560039
                  MOVE 'ERROR ON SELECT FROM TUPC'                      11570039
                                 TO PV-OPERATION-ATTEMPTED              11580039
                  PERFORM 9999-SQL-ABEND                                11590039
           END-EVALUATE.                                                11600039
                                                                        11610039
      ******************************************************************11620039
      *                                                                 11630039
      ******************************************************************11640039
       4200-GET-ATTR-FROM-TMDSEAR.                                      11650041
                                                                        11660039
            EXEC SQL                                                    11670039
                SELECT DEPT_NBR                                         11680039
                      ,MAJ_CL_NBR                                       11690039
                      ,SUB_CL_NBR                                       11700039
                 INTO  :MDSEAR-DEPT-NBR                                 11710039
                      ,:MDSEAR-MAJ-CL-NBR                               11720039
                      ,:MDSEAR-SUB-CL-NBR                               11730039
                 FROM  TMDSEAR                                          11740039
                WHERE  MDSEAR_DKEY = :UPC-SUB-CL-MDSEAR-ID              11750039
                  AND  MDSELV_CDE = 'SCL'                               11760039
W26603          WITH UR                                                 11770065
            END-EXEC.                                                   11780039
      *                                                                 11790039
           EVALUATE SQLCODE                                             11800039
               WHEN 0                                                   11810039
                  MOVE MDSEAR-DEPT-NBR   TO SKXREF-DEPT                 11820039
                  MOVE MDSEAR-MAJ-CL-NBR TO SKXREF-CLASS                11830039
                  MOVE MDSEAR-SUB-CL-NBR TO SKXREF-SUBCLASS             11840039
               WHEN +100                                                11850039
                  DISPLAY ' UPC ', PV-KOHLS-UPC-MIN, ' MDSEAR NOT FOUND'11860039
                  MOVE '000'  TO SKXREF-DEPT                            11870039
                  MOVE '0000' TO SKXREF-CLASS                           11880039
                  MOVE '00'   TO SKXREF-SUBCLASS                        11890039
               WHEN OTHER                                               11900039
                  MOVE '4200-GET-ATTR-FROM-TMDSEAR'                     11910039
                                 TO PV-PARAGRAPH-NAME                   11920039
                  MOVE 'ERROR ON SELECT FROM TMDSEAR'                   11930039
                                 TO PV-OPERATION-ATTEMPTED              11940039
                  PERFORM 9999-SQL-ABEND                                11950039
           END-EVALUATE.                                                11960039
                                                                        11970039
      ******************************************************************11980039
      *                                                                 11990019
      ******************************************************************12000019
                                                                        12010007
       5100-WRITE-ERROR-REPORT.                                         12020019
                                                                        12030015
           IF PV-LINE-COUNT > 58                                        12040015
               PERFORM 5000-WRITE-HEADINGS                              12050019
           END-IF.                                                      12060015
                                                                        12070015
           ADD  1 TO  PV-LINE-COUNT                                     12080015
                                                                        12090015
           MOVE ERROR-LINE TO ERROR-REC.                                12100015
                                                                        12110015
           PERFORM 5200-WRITE-ERROR-REPORT.                             12120019
                                                                        12130015
      ******************************************************************12140019
      *                                                                 12150019
      ******************************************************************12160019
       5000-WRITE-HEADINGS.                                             12170019
                                                                        12180015
           ADD 1              TO PV-PAGE-COUNT                          12190015
                                                                        12200015
           MOVE PV-PAGE-COUNT TO DP133O-PAGE-NUMBER.                    12210015
           MOVE 1             TO DP133O-REPORT-NUMBER.                  12220015
           MOVE DP133O-STANDRD-HEADER-133-COLS TO ERROR-REC.            12230015
                                                                        12240015
           PERFORM 5200-WRITE-ERROR-REPORT                              12250019
                                                                        12260015
           MOVE HEADER2       TO ERROR-REC                              12270015
           PERFORM 5200-WRITE-ERROR-REPORT                              12280019
                                                                        12290015
           MOVE HEADER3       TO ERROR-REC                              12300015
           PERFORM 5200-WRITE-ERROR-REPORT                              12310019
                                                                        12320015
           MOVE 4 TO PV-LINE-COUNT.                                     12330015
                                                                        12340015
      ******************************************************************12350019
      *                                                                 12360019
      ******************************************************************12370019
       5200-WRITE-ERROR-REPORT.                                         12380019
                                                                        12390015
           WRITE ERROR-REC.                                             12400015
      *                                                                 12410015
      *5200-ABEND.                                                      12420019
      *                                                                 12430015
      *    CALL 'ILBOABN0'             USING ABEND-CODE.                12440015
                                                                        12450048
517404******************************************************************12460049
 |    * 6000-EDIT-WORK-DATE.                                            12470048
 |    ******************************************************************12480048
 |     6000-EDIT-WORK-DATE.                                             12490048
 |                                                                      12500048
 |         IF PV-HOLD-DATE NOT EQUAL PV-HOLD-DATE-SAVE                  12510048
 |             PERFORM 8100-BUILD-THE-WORK-DATE                         12520048
 |             MOVE PV-HOLD-DATE    TO PV-HOLD-DATE-SAVE                12530060
 |         END-IF.                                                      12540048
517404                                                                  12550049
      ******************************************************************12560019
      *                                                                 12570019
      ******************************************************************12580019
                                                                        12590019
       7100-READ-REGISTER-SALES.                                        12600019
                                                                        12610019
           READ REGISTER-SALES-FILE  INTO PV-SALES-RECORD               12620019
              AT END                                                    12630019
                   SET END-OF-REGISTER-SALES-FILE     TO TRUE.          12640019
                                                                        12650019
      ******************************************************************12660019
      *                                                                 12670019
      ******************************************************************12680019
                                                                        12690019
       7200-READ-PRICE-CHANGE.                                          12700019
                                                                        12710019
26006      READ PRICE-CHANGE-FILE   INTO ML017-PRICE-CHANGE-RECORD      12720072
              AT END                                                    12730019
                   SET END-OF-PRICE-CHANGE-FILE       TO TRUE.          12740019
                                                                        12750019
      ******************************************************************12760019
      *                                                                 12770019
      ******************************************************************12780019
                                                                        12790019
       7300-READ-STORE-TRANSFER.                                        12800019
                                                                        12810019
           READ STORE-TRANSFER-FILE INTO PV-XFER-STORE-TRANSFER-RECORD  12820019
              AT END                                                    12830019
                   SET END-OF-STORE-TRANSFER-FILE     TO TRUE.          12840019
                                                                        12850019
W28545******************************************************************12860079
W28545* 7400-READ-FAST-TRANSFER                                         12870079
W28545******************************************************************12880079
W28545                                                                  12890079
W28545 7400-READ-FAST-TRANSFER.                                         12900079
W28545                                                                  12910079
W28545     READ FAST-TRANSFER-FILE INTO TFRD054-ML-DAILY-TRANSFER-FILE  12920083
W28545        AT END  SET END-OF-STORE-TRANSFER-FILE TO TRUE.           12930079
W28545                                                                  12940079
517404******************************************************************12950049
 |    * 8000-GET-MLCNTL-DTES.                                           12960048
 |    ******************************************************************12970048
 |     8000-GET-MLCNTL-DTES.                                            12980048
 |                                                                      12990048
 |          EXEC SQL                                                    13000051
 |             SELECT OPN_FSCL_MN_DTE                                   13010048
 |                   ,OPN_FSCL_MN_NBR                                   13020048
 |                   ,PSTG_FSCL_WK_DTE                                  13030048
 |                   ,PSTG_FSCL_WK_NBR                                  13040048
 |                  ,PSTG_FSCL_MN_DTE                                   13050049
 |                  ,PSTG_FSCL_MN_NBR                                   13060049
 |            INTO :MLCNTL-OPN-FSCL-MN-DTE                              13070049
 |                ,:MLCNTL-OPN-FSCL-MN-NBR                              13080049
 |                ,:MLCNTL-PSTG-FSCL-WK-DTE                             13090049
 |                ,:MLCNTL-PSTG-FSCL-WK-NBR                             13100049
 |                ,:MLCNTL-PSTG-FSCL-MN-DTE                             13110049
 |                ,:MLCNTL-PSTG-FSCL-MN-NBR                             13120049
517404         FROM TMLCNTL                                             13130065
W26603         WITH UR                                                  13140065
517404     END-EXEC.                                                    13150065
 |                                                                      13160049
 |         EVALUATE SQLCODE                                             13170051
 |            WHEN +0                                                   13180050
 |              CONTINUE                                                13190049
 |            WHEN OTHER                                                13200049
 |              MOVE '8000-GET-MLCNTL-DTE' TO PV-PARAGRAPH-NAME         13210050
 |              MOVE 'SELECT ROW FROM  MLCNTL'                          13220050
 |                                         TO PV-OPERATION-ATTEMPTED    13230050
 |              PERFORM 9999-SQL-ABEND                                  13240049
 |         END-EVALUATE.                                                13250051
 |                                                                      13260049
 |    ******************************************************************13270052
 |    * 8100-BUILD-THE-WORK-DATE.                                       13280052
 |    ******************************************************************13290052
 |     8100-BUILD-THE-WORK-DATE.                                        13300052
 |                                                                      13310049
 |         MOVE PV-HOLD-DATE-MM     TO PV-DB2-MM.                       13320053
 |         MOVE PV-HOLD-DATE-DD     TO PV-DB2-DD.                       13330053
 |                                                                      13340053
 |         EXEC SQL                                                     13350052
 |             SELECT MAX (KY_DTE)                                      13360049
 |             INTO :PV-WORK-DATE :PV-NULL-IND                          13370049
 |             FROM TDTATTR                                             13380049
 |             WHERE DAY (KY_DTE)   = :PV-DB2-DD                        13390053
 |               AND MONTH (KY_DTE) = :PV-DB2-MM                        13400053
517404           AND KY_DTE         <= :MLCNTL-PSTG-FSCL-WK-DTE         13410065
W26603         WITH UR                                                  13420065
517404     END-EXEC.                                                    13430065
 |                                                                      13440049
 |         EVALUATE SQLCODE                                             13450052
 |            WHEN +0                                                   13460050
 |              IF PV-NULL-IND IS LESS THAN ZERO                        13470049
 |                MOVE '9999-09-09' TO PV-WORK-DATE                     13480049
 |              END-IF                                                  13490049
 |            WHEN OTHER                                                13500049
 |              MOVE '8100-BUILD-THE-WORK-DATE' TO PV-PARAGRAPH-NAME    13510050
 |              MOVE 'SELECT ROW FROM TDTATTR'                          13520050
 |                                          TO PV-OPERATION-ATTEMPTED   13530050
 |              PERFORM 9999-SQL-ABEND                                  13540049
 |         END-EVALUATE.                                                13550049
517404                                                                  13560049
      ******************************************************************13570007
      *  STANDARD DB2 ERROR ABEND ROUTINE                               13580007
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             13590007
      ******************************************************************13600007
       9999-SQL-ABEND.                                                  13610007
                                                                        13620007
           MOVE +4013                 TO ABEND-CODE.                    13630007
           DISPLAY '**  ABEND     **'.                                  13640007
           DISPLAY '**  PROGRAM   ** => ' PC-PROGRAM-NAME.              13650007
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            13660007
           DISPLAY '**  OPERATION **  = ' PV-OPERATION-ATTEMPTED.       13670007
                                                                        13680007
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         13690007
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        13700007
                                                                        13710007
           COPY DPPD004.                                                13720007
           CALL 'ILBOABN0'  USING ABEND-CODE.                           13730007
                                                                        13740007
26006 *ML501-LOOKUP-VENDOR.                                             13750071
26006 *ML501-LOOKUP-DEFAULT.                                            13760071
26006 *ML501-LOOKUP-BY-SKU.                                             13770071
26006 *ML501-LOOKUP-BY-UPC-NBR.                                         13780071
26006 *ML501-LOOKUP-BY-UPC-ID.                                          13790071
26006 *ML501-LOOKUP-BY-ITM-NBR.                                         13800071
26006 *ML501-LOOKUP-BY-INHOUSE.                                         13810071
26006      COPY MLPD501.                                                13820071
                                                                        13830071
