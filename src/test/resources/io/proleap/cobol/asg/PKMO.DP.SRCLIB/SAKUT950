       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.      SAKUT950.                                       00030000
       AUTHOR.          JIM HUNTER.                                     00040000
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050000
       DATE-WRITTEN.    05/11/2021.                                     00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ******************************************************************00090000
      *    REBUILD GL DATA WITH QUERIES                                 00100000
      *    THIS WAS PROGRAM SAKGLQRY IN TEST, BUT HAS BEEN RENAMED TO   00101000
      *    SAKUT950 SO THAT IT CAN BE SAVED IN PRODUCTION.              00102000
      *=================================================================00110000
      *                                                                 00170000
      *  IN APRIL OF 2021, DUE TO ISSUES WITH INCORRECT TSASUM          00180000
      *  VALUES BEING LOADED, MISSING DATA AND REPLAYS OF DUPLICATE     00190000
      *  DATA, ROB AND THE SALES AUDIT TEAM WERE UNABLE TO GENERATE     00200000
      *  THE SAK131 GL FILE WITH CONFIDENCE THAT THE DATA WAS CORRECT.  00210000
      *                                                                 00220000
      *  AS A RESULT, HE REQUESTED THAT WE RUN QUERIES AFTER THE FACT   00230000
      *  THAT WOULD ALLOW HIM TO SEE THE ACTUAL DATA LOADED IN COSA     00240000
      *  SO THAT HE COULD CREATE ADJUSTMENTS (RECLASS) FOR GL FOR       00250000
      *  WEEKS THAT HAD ALREADY BEEN PROCESSED WITH THE SAK131 OUTPUT.  00260000
      *                                                                 00270000
      *  32 QUERIES WERE WRITTEN AND THE FINAL GL FILE FOR THE WEEK     00280000
      *  BEING REVIEWED WAS ALSO USED, IN AN ADHOC PROCESS THAT         00290000
      *  WAS RUN MANUALLY.   THE RESULTS OF EACH QUERY WERE EXPORTED    00300000
      *  FROM AQT TO THE F DRIVE.  THEY WERE THEN COPIED INTO GOOGLE.   00310000
      *  A SINGLE SHEET WAS CREATED CONTAININIG A TAB FOR EACH QUERY.   00320000
      *  RESULTS OF EACH QUERY WERE CUT AND PASTED INTO THEIR PROPER    00330000
      *  TABS.                                                          00340000
      *  THIS PROCESS WAS RUN TWICE, ONCE FOR EACH OF THE FIRST 2 WEEKS 00350000
      *  OF APRIL, 2021.  THEN IN MAY, IT WAS REQUESTED TO BE RUN FOR   00360000
      *  ENTIRE MONTH OF APRIL AS WELL AS THE 3RD WEEK OF APRIL.        00370000
      *                                                                 00380000
      *  THE GOAL OF WRITING THIS PROGRAM IS TO CONSOLIDATE ALL OF THE  00390000
      *  QUERIES INTO A SINGLE PROGRAM AND EXECUTE ALL OF THEM BY       00400000
      *  USING A CONTROL CARD WITH START AND END DATES.                 00410000
      *  OUTPUT WILL CONSIST OF A SINGLE SHEET WITH ROUGHLY 1200 ROWS   00420000
      *  (1 PER STORE) AND ROUGHLY 35 COLUMNS (1 FOR EACH QUERY RESULT).00430000
      *  A SEPERATE SHEET CONTAINING THE GL VALUES FROM THE GL FILE     00440000
      *  WILL ALSO BE GENERATED IN A SEPERATE TAB.                      00441000
      *  THE FINAL STM AND TMR VALUES, WHICH ARE ADJUSTED BY SOME OF    00450000
      *  THE OTHER QUERY VALUES, WILL ALSO BE CALCULATED.               00460000
      *                                                                 00470000
      *  THIS PROCESS DOES NOT INCLUDE THE MANUAL ADJUSTMENTS THAT      00480000
      *  ROB CURRENTLY MAKES FOR ASSOCIATE DISCOUNTS AFTER THE FACT.    00490000
      *                                                                 00500000
      *  2022                                                           00502000
      *  MARKETPLACE AND SEPHORA GIFT CARDS WERE ADDED AFTER THIS       00503000
      *  PROGRAM WAS WRITTEN.                                           00504000
      *  THE SALES HUB DOES NOT SET MARKETPLACE DETAILS IN THE TABLES   00505000
      *  TO ALLOW SELLER AMOUNTS AND COMMISSIONS TO BE CALCULATED.      00506000
      *  GL IS DEPENDENT ON THE TSASUM NUMBERS TO PROVIDE SELLER AMOUNTS00507000
      *  AND KOHL'S COMMISSIONS.  MARKETPLACE SALES AND RETURNS CAN     00508000
      *  BE IDENTIFIED BY DEPT NUMBER '985'.                            00508100
      *  SEPHORA GIFT CARDS AND TENDERS WILL BE ADDED WITH 2 NEW        00509000
      *  CURSORS.                                                       00509100
      *  SEPHORA GIFT CARD TENDERS ARE IDENTIFIED BY A COMBINATION OF   00509200
      *  TNDR_TYP_CDE = '13' AND TNDR_ID_SRC_CDE = '14'.                00509300
      *  THE KOHLS GC TENDERS (GDT) NEED TO BE ADJUSTED SO THAT THEY    00509400
      *  DON'T INCLUDE THE SEPHORA GIFT CARDS (TNDR_ID_SRC_CDE = '14'). 00509500
      *  SEPHORA GIFT CARD SALES ARE IDENTIFIED BY DEPT NUMBER '712'.   00509600
      *  THEY WILL NOT BE INCLUDED IN THIRD PARTY GC SALES (TPC).       00509700
      *                                                                 00510200
      *  2023                                                           00510300
      *  COBRAND TENDERS AND PAYMENTS ARE BEING ADDED IN 2023.          00510400
      *  COBRAND TENDERS ARE IDENTIFIED BY TNDR_TYP_CDE = '24'.         00510600
      *  THEY WILL NOT BE INCLUDED IN THE BANK CARD TENDERS (BCN).      00510700
      *  COBRAND PAYMENTS ARE IDENTIFIED BY COBRND_IND = 'Y' ON TEPPAY. 00510800
      *  KOHLS CHARGE PAYMENTS (KCP) NEED TO BE ADJUSTED SO THAT THEY   00510900
      *  DON'T INCLUDE THE COBRAND PAYMENTS (COBRND_IND <> 'Y').        00511000
      *                                                                 00511400
      *  INPUT: INP01 - CONTAINS START AND END DATES USED BY QUERIES.   00660000
      *                 TYPICALLY, 1 WEEK, SUNDAY THRU SATURDAY.        00670000
      *  INPUT: INP02 - THE GL INPUT FILE IS NOT CURRENTLY USED BY THIS 00680000
      *                 PROGRAM - IT IS FTP'D TO GOOGLE AND ADDED AS    00690000
      *                 A 2ND TAB IN THE SHEET THAT THE QUERY OUTPUT    00700000
      *                 FROM THIS PROGRAM IS USED TO BUILD.             00710000
      *                 REFERENCES TO THE GL INPUT FILE WILL BE         00720000
      *                 REMOVED FROM THIS PROGRAM IF ROB DOESN'T        00730000
      *                 NEED THE GL NUMBERS ADDED TO THE SAME TAB       00740000
      *                 AS THE THE QUERY RESULTS FROM THIS PROGRAM.     00750000
      *========================== CHANGE LOG ===========================00760000
      * CHANGE NBR   DATE          NAME            DESCRIPTION          00770000
      *=================================================================00780000
      * CHG0288509   05/11/2021    JIM HUNTER CREATE PROGRAM.           00790002
NEW   *  MARCH, 2023 - SFS CURSOR WON'T FIND RETURNS - JUST CHECK SALES.00801000
NEW   *              - KK* CURSORS SHOULD LOOK AT RETURNS AND SALES.    00802000
NEW   *              - SUBTRACTED KKU FROM STM                          00805000
2023  *  MAY, 2023   - ADD CURSORS FOR SEPHORA, MARKETPLACE AND COBRAND.00806100
2023  *  MAY, 2023   - ADD CURSORS FOR PAYPAL AND VENMO.                00806300
      *=================================================================00806402
      * CHG0305890   03/25/2024    JIM HUNTER                           00806502
2024  *              - REMOVE REVERSALS FROM ALL CURSORS.               00806602
      *=================================================================00807000
      ******************************************************************00810000
                                                                        00820000
       ENVIRONMENT DIVISION.                                            00830000
       CONFIGURATION SECTION.                                           00840000
                                                                        00850000
       SOURCE-COMPUTER.        IBM-3090.                                00860000
       OBJECT-COMPUTER.        IBM-3090.                                00870000
                                                                        00880000
       INPUT-OUTPUT SECTION.                                            00890000
       FILE-CONTROL.                                                    00900000
                                                                        00910000
           SELECT DATE-FILE-IN          ASSIGN TO INP01.                00920000
           SELECT GL-FILE-IN            ASSIGN TO INP02.                00930000
           SELECT GL-CSV-FILE-OUT       ASSIGN TO OUT01.                00940000
                                                                        00950000
       DATA DIVISION.                                                   00960000
       FILE SECTION.                                                    00970000
                                                                        00980000
       FD  DATE-FILE-IN                                                 00990000
           RECORDING MODE IS F                                          01000000
           BLOCK CONTAINS 0 RECORDS                                     01010000
           LABEL RECORDS ARE STANDARD.                                  01020000
       01  DATE-RECORD-IN                   PIC  X(80).                 01030000
                                                                        01040000
       FD  GL-FILE-IN                                                   01050000
           RECORDING MODE IS F                                          01060000
           BLOCK CONTAINS 0 RECORDS                                     01070000
           LABEL RECORDS ARE STANDARD.                                  01080000
       01  GL-RECORD-IN                     PIC  X(50).                 01090000
                                                                        01100000
       FD  GL-CSV-FILE-OUT                                              01110000
           RECORDING MODE IS F                                          01120000
           BLOCK CONTAINS 0 RECORDS                                     01130000
           LABEL RECORDS ARE STANDARD.                                  01140000
       01  GL-CSV-RECORD-OUT                PIC  X(625).                01150000
                                                                        01160000
                                                                        01170000
      ******************************************************************01180000
      *                       WORKING STORAGE                           01190000
      ******************************************************************01200000
       WORKING-STORAGE SECTION.                                         01210000
                                                                        01220000
       01  W-START                          PIC  X(50)    VALUE         01230000
           ' *** WORKING STORAGE STARTS HERE FOR SAKUT950 *** '.        01240000
                                                                        01250000
      ******************************************************************01260000
      *                          SWITCHES                               01270000
      ******************************************************************01280000
       01  PS-PROGRAM-SWITCHES.                                         01290000
                                                                        01300000
           05  PS-END-OF-CURSOR-SW          PIC  X(01)    VALUE 'N'.    01310000
               88  PS-NOT-END-OF-CURSOR                   VALUE 'N'.    01320000
               88  PS-END-OF-CURSOR                       VALUE 'Y'.    01330000
                                                                        01340000
           05  PS-END-OF-GL-FILE-SW         PIC  X(01)    VALUE 'N'.    01350000
               88  PS-END-OF-GL-FILE                      VALUE 'Y'.    01360000
                                                                        01370000
           05  PS-END-OF-DATE-FILE-SW       PIC  X(01)    VALUE 'N'.    01380000
               88  PS-END-OF-DATE-FILE                    VALUE 'Y'.    01390000
                                                                        01400000
      ******************************************************************01410000
      *                         CONSTANTS                               01420000
      ******************************************************************01430000
       01  PC-CONSTANTS.                                                01440000
           05  PC-PGM-NAME              PIC X(08)  VALUE 'SAKUT950'.    01450000
           05  PC-ROW-NOT-FOUND         PIC S9(04) VALUE +100 COMP.     01460000
                                                                        01470000
      ******************************************************************01480000
      *                      ACCUMULATORS                               01490000
      ******************************************************************01500000
       01  PA-ACCUMULATORS.                                             01510000
                                                                        01520000
           05  PA-RETURNS-CURSOR-CNT        PIC  9(07)    VALUE ZEROS.  01530000
           05  PA-SALES-CURSOR-CNT          PIC  9(07)    VALUE ZEROS.  01540000
           05  PA-GDS-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01550000
           05  PA-TPC-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01560000
           05  PA-TCC-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01570000
2023       05  PA-SGS-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01571000
           05  PA-BOS-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01580000
           05  PA-BSR-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01590000
           05  PA-BPS-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01600000
           05  PA-BPR-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01610000
           05  PA-SFS-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01620000
2023       05  PA-MKT-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01621000
           05  PA-KKB-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01630000
           05  PA-KKH-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01640000
           05  PA-KKS-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01650000
           05  PA-KKU-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01660000
           05  PA-SHS-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01670000
           05  PA-ECR-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01680000
           05  PA-SHR-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01690000
           05  PA-TAX-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01700000
           05  PA-FEE-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01710000
           05  PA-AEN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01720000
           05  PA-BCN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01730000
           05  PA-DBN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01740000
           05  PA-KCN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01750000
2023       05  PA-CVN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01751000
           05  PA-NCN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01760000
2023       05  PA-PPN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01761000
2023       05  PA-VMN-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01762000
           05  PA-GDT-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01770000
2023       05  PA-SGT-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01771000
           05  PA-KMT-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01780000
           05  PA-KMI-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01790000
           05  PA-CASH-CURSOR-CNT           PIC  9(07)    VALUE ZEROS.  01800000
           05  PA-CHECK-CURSOR-CNT          PIC  9(07)    VALUE ZEROS.  01810000
           05  PA-KCP-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01820000
2023       05  PA-CVP-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01821000
           05  PA-CRI-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01830000
           05  PA-EMPDISC-CURSOR-CNT        PIC  9(07)    VALUE ZEROS.  01840000
           05  PA-KKT-CURSOR-CNT            PIC  9(07)    VALUE ZEROS.  01850000
           05  PA-GL-FILE-IN-READ           PIC  9(07)    VALUE ZEROS.  01860000
           05  PA-GL-FILE-OUT-WRITTEN       PIC  9(07)    VALUE ZEROS.  01870000
                                                                        01880000
       01  DK-DB2-KEYS.                                                 01890000
           05  DK-BEGIN-DATE           PIC X(10)    VALUE SPACES.       01900000
           05  DK-END-DATE             PIC X(10)    VALUE SPACES.       01910000
                                                                        01920000
      ******************************************************************01930000
      *                       VARIABLES                                 01940000
      ******************************************************************01950000
       01  PV-VARIABLES.                                                01960000
           05  PV-SQL                       PIC S9(04)    VALUE ZEROS.  01970000
           05  PV-SUB                       PIC  9(05)    VALUE ZEROS.  01980000
           05  PV-PARAGRAPH-NAME            PIC  X(30)    VALUE SPACES. 01990000
           05  PV-DB2-TABLE-NAME            PIC  X(12)    VALUE SPACES. 02000000
           05  PV-DB2-OPERATION-MSG         PIC  X(60)    VALUE SPACES. 02010000
           05  PV-OPERATION-MSG-1           PIC  X(40)    VALUE SPACES. 02020000
           05  PV-OPERATION-MSG-2           PIC  X(40)    VALUE SPACES. 02030000
           05  PV-DISPLAY-CURSOR-COUNT      PIC ZZZZZZ9.                02040000
           05  PV-DPG52-LK-DATE-INPUT       PIC X(10)     VALUE SPACES. 02050000
           05  PV-STR-NBR                   PIC S9(04) COMP VALUE ZERO. 02060000
           05  PV-DB2-SUM              PIC S9(09)V99 COMP-3 VALUE ZERO. 02070000
                                                                        02080000
      ******************************************************************02090000
      *                        ERROR HANDLING                           02100000
      ******************************************************************02110000
       01  ABEND-CODE                       PIC S9(04)    VALUE ZEROS   02120000
                                                          COMP SYNC.    02130000
           88  ABEND-4001-WRITE-ERROR                     VALUE +4001.  02140000
           88  ABEND-4002-READ-ERROR                      VALUE +4002.  02150000
           88  ABEND-4003-CTRL-CARD-ERROR                 VALUE +4003.  02160000
           88  ABEND-4004-TABLE-ERROR                     VALUE +4004.  02170000
           88  ABEND-4005-OPEN-ERROR                      VALUE +4005.  02180000
           88  ABEND-4006-CLOSE-ERROR                     VALUE +4006.  02190000
           88  ABEND-4007-SEQUENCE-ERROR                  VALUE +4007.  02200000
           88  ABEND-4008-DATA-ERROR                      VALUE +4008.  02210000
           88  ABEND-4009-KEY-DATA-ERROR                  VALUE +4009.  02220000
           88  ABEND-4013-DB2-ERROR                       VALUE +4013.  02230000
           88  ABEND-4019-CAL-SUB-ERROR                   VALUE +4019.  02240000
           88  ABEND-4444-FORCED-ABEND                    VALUE +4444.  02250000
                                                                        02260000
      ******************************************************************02270000
      * RECORD LAYOUT FOR INPUT DATE CARD                               02280000
      ******************************************************************02290000
       01  CC-CONTROL-CARD.                                             02300000
           05  CC-START-DATE          PIC X(10)      VALUE SPACES.      02310000
           05  FILLER                 PIC X          VALUE SPACE.       02320000
           05  CC-END-DATE            PIC X(10)      VALUE SPACES.      02330000
           05  FILLER                 PIC X(59)      VALUE SPACE.       02340000
                                                                        02350000
      ******************************************************************02360000
      * RECORD LAYOUT FOR INPUT GL FILE                                 02370000
      ******************************************************************02380000
       01  WS-GL-RECORD-IN.                                             02390000
           05  WS-GL-IN-STORE         PIC 9(4)       VALUE ZEROES.      02400000
           05  WS-GL-IN-COMMA-1       PIC X          VALUE ','.         02410000
           05  WS-GL-IN-DEBIT-CREDIT  PIC X          VALUE SPACE.       02420000
           05  WS-GL-IN-COMMA-2       PIC X          VALUE ','.         02430000
           05  WS-GL-IN-DOLLAR-AMT    PIC 9(23).999  VALUE ZEROES.      02440000
           05  WS-GL-IN-COMMA-3       PIC X          VALUE ','.         02450000
           05  WS-GL-IN-CODE          PIC X(3)       VALUE SPACES.      02460000
           05  FILLER                 PIC X(12)      VALUE SPACES.      02470000
                                                                        02480000
      ******************************************************************02490000
      * RECORD LAYOUT FOR OUTPUT GL CSV FILE                            02500000
      ******************************************************************02510000
       01  GL-HEADER-RECORD.                                            02520000
           05  GL-HDR-STORE             PIC X(5)  VALUE 'STORE'.        02530000
           05  FILLER                   PIC X     VALUE ','.            02540000
           05  GL-HDR-SALES             PIC X(5)  VALUE 'SALES'.        02550000
           05  FILLER                   PIC X     VALUE ','.            02560000
           05  GL-HDR-GDS               PIC X(3)  VALUE 'GDS'.          02570000
           05  FILLER                   PIC X     VALUE ','.            02580000
           05  GL-HDR-TPC               PIC X(3)  VALUE 'TPC'.          02590000
           05  FILLER                   PIC X     VALUE ','.            02600000
           05  GL-HDR-TCC               PIC X(3)  VALUE 'TCC'.          02610000
           05  FILLER                   PIC X     VALUE ','.            02620000
2023       05  GL-HDR-SGS               PIC X(3)  VALUE 'SGS'.          02621000
2023       05  FILLER                   PIC X     VALUE ','.            02622000
           05  GL-HDR-BOS               PIC X(3)  VALUE 'BOS'.          02630000
           05  FILLER                   PIC X     VALUE ','.            02640000
           05  GL-HDR-BPS               PIC X(3)  VALUE 'BPS'.          02650000
           05  FILLER                   PIC X     VALUE ','.            02660000
           05  GL-HDR-SFS               PIC X(3)  VALUE 'SFS'.          02670000
           05  FILLER                   PIC X     VALUE ','.            02680000
2023       05  GL-HDR-MKT               PIC X(3)  VALUE 'MKT'.          02681000
2023       05  FILLER                   PIC X     VALUE ','.            02682000
           05  GL-HDR-KKB               PIC X(3)  VALUE 'KKB'.          02690000
           05  FILLER                   PIC X     VALUE ','.            02700000
           05  GL-HDR-KKH               PIC X(3)  VALUE 'KKH'.          02710000
           05  FILLER                   PIC X     VALUE ','.            02720000
           05  GL-HDR-KKS               PIC X(3)  VALUE 'KKS'.          02730000
           05  FILLER                   PIC X     VALUE ','.            02740000
           05  GL-HDR-KKU               PIC X(3)  VALUE 'KKU'.          02750000
           05  FILLER                   PIC X     VALUE ','.            02760000
           05  GL-HDR-SHS               PIC X(3)  VALUE 'SHS'.          02770000
           05  FILLER                   PIC X     VALUE ','.            02780000
           05  GL-HDR-STM               PIC X(3)  VALUE 'STM'.          02790000
           05  FILLER                   PIC X     VALUE ','.            02800000
           05  GL-HDR-RETURNS           PIC X(7)  VALUE 'RETURNS'.      02810000
           05  FILLER                   PIC X     VALUE ','.            02820000
           05  GL-HDR-BSR               PIC X(3)  VALUE 'BSR'.          02830000
           05  FILLER                   PIC X     VALUE ','.            02840000
           05  GL-HDR-BPR               PIC X(3)  VALUE 'BPR'.          02850000
           05  FILLER                   PIC X     VALUE ','.            02860000
           05  GL-HDR-ECR               PIC X(3)  VALUE 'ECR'.          02870000
           05  FILLER                   PIC X     VALUE ','.            02880000
           05  GL-HDR-SHR               PIC X(3)  VALUE 'SHR'.          02890000
           05  FILLER                   PIC X     VALUE ','.            02900000
           05  GL-HDR-TMR               PIC X(3)  VALUE 'TMR'.          02910000
           05  FILLER                   PIC X     VALUE ','.            02920000
           05  GL-HDR-TAX               PIC X(3)  VALUE 'TAX'.          02930000
           05  FILLER                   PIC X     VALUE ','.            02940000
           05  GL-HDR-FEE               PIC X(3)  VALUE 'FEE'.          02950000
           05  FILLER                   PIC X     VALUE ','.            02960000
           05  GL-HDR-AEN               PIC X(3)  VALUE 'AEN'.          02970000
           05  FILLER                   PIC X     VALUE ','.            02980000
           05  GL-HDR-BCN               PIC X(3)  VALUE 'BCN'.          02990000
           05  FILLER                   PIC X     VALUE ','.            03000000
           05  GL-HDR-DBN               PIC X(3)  VALUE 'DBN'.          03010000
           05  FILLER                   PIC X     VALUE ','.            03020000
           05  GL-HDR-KCN               PIC X(3)  VALUE 'KCN'.          03030000
           05  FILLER                   PIC X     VALUE ','.            03040000
2023       05  GL-HDR-CVN               PIC X(3)  VALUE 'CVN'.          03041000
2023       05  FILLER                   PIC X     VALUE ','.            03042000
           05  GL-HDR-NCN               PIC X(3)  VALUE 'NCN'.          03050000
           05  FILLER                   PIC X     VALUE ','.            03060000
2023       05  GL-HDR-PPN               PIC X(3)  VALUE 'PPN'.          03061000
2023       05  FILLER                   PIC X     VALUE ','.            03062000
2023       05  GL-HDR-VMN               PIC X(3)  VALUE 'VMN'.          03063000
2023       05  FILLER                   PIC X     VALUE ','.            03064000
           05  GL-HDR-GDT               PIC X(3)  VALUE 'GDT'.          03070000
           05  FILLER                   PIC X     VALUE ','.            03080000
2023       05  GL-HDR-SGT               PIC X(3)  VALUE 'SGT'.          03081000
2023       05  FILLER                   PIC X     VALUE ','.            03082000
           05  GL-HDR-KKT               PIC X(3)  VALUE 'KKT'.          03090000
           05  FILLER                   PIC X     VALUE ','.            03100000
           05  GL-HDR-GDTT              PIC X(4)  VALUE 'GDTT'.         03110000
           05  FILLER                   PIC X     VALUE ','.            03120000
           05  GL-HDR-KMT               PIC X(3)  VALUE 'KMT'.          03130000
           05  FILLER                   PIC X     VALUE ','.            03140000
           05  GL-HDR-KMI               PIC X(3)  VALUE 'KMI'.          03150000
           05  FILLER                   PIC X     VALUE ','.            03160000
           05  GL-HDR-CASH              PIC X(4)  VALUE 'CASH'.         03170000
           05  FILLER                   PIC X     VALUE ','.            03180000
           05  GL-HDR-CHECK             PIC X(5)  VALUE 'CHECK'.        03190000
           05  FILLER                   PIC X     VALUE ','.            03200000
           05  GL-HDR-KCP               PIC X(3)  VALUE 'KCP'.          03210000
           05  FILLER                   PIC X     VALUE ','.            03220000
2023       05  GL-HDR-CVP               PIC X(3)  VALUE 'CVP'.          03221000
2023       05  FILLER                   PIC X     VALUE ','.            03222000
           05  GL-HDR-CRI               PIC X(3)  VALUE 'CRI'.          03230000
           05  FILLER                   PIC X     VALUE ','.            03240000
           05  GL-HDR-EMPDISC           PIC X(8)  VALUE 'EMP DISC'.     03250000
           05  FILLER                   PIC X     VALUE ','.            03260000
                                                                        03270000
       01  GL-RECORD-TABLE.                                             03280000
           05  GL-WS-RECORD  OCCURS 9999 TIMES.                         03290000
               10  GL-WS-STORE             PIC 9(4).                    03300000
               10  GL-WS-SALES             PIC S9(9)V99.                03310000
               10  GL-WS-GDS               PIC S9(9)V99.                03320000
               10  GL-WS-TPC               PIC S9(9)V99.                03330000
               10  GL-WS-TCC               PIC S9(9)V99.                03340000
2023           10  GL-WS-SGS               PIC S9(9)V99.                03341000
               10  GL-WS-BOS               PIC S9(9)V99.                03350000
               10  GL-WS-BPS               PIC S9(9)V99.                03360000
               10  GL-WS-SFS               PIC S9(9)V99.                03370000
2023           10  GL-WS-MKT               PIC S9(9)V99.                03371000
               10  GL-WS-KKB               PIC S9(9)V99.                03380000
               10  GL-WS-KKH               PIC S9(9)V99.                03390000
               10  GL-WS-KKS               PIC S9(9)V99.                03400000
               10  GL-WS-KKU               PIC S9(9)V99.                03410000
               10  GL-WS-SHS               PIC S9(9)V99.                03420000
               10  GL-WS-STM               PIC S9(9)V99.                03430000
               10  GL-WS-RETURNS           PIC S9(9)V99.                03440000
               10  GL-WS-BSR               PIC S9(9)V99.                03450000
               10  GL-WS-BPR               PIC S9(9)V99.                03460000
               10  GL-WS-ECR               PIC S9(9)V99.                03470000
               10  GL-WS-SHR               PIC S9(9)V99.                03480000
               10  GL-WS-TMR               PIC S9(9)V99.                03490000
               10  GL-WS-TAX               PIC S9(9)V99.                03500000
               10  GL-WS-FEE               PIC S9(9)V99.                03510000
               10  GL-WS-AEN               PIC S9(9)V99.                03520000
               10  GL-WS-BCN               PIC S9(9)V99.                03530000
               10  GL-WS-DBN               PIC S9(9)V99.                03540000
               10  GL-WS-KCN               PIC S9(9)V99.                03550000
2023           10  GL-WS-CVN               PIC S9(9)V99.                03551000
               10  GL-WS-NCN               PIC S9(9)V99.                03560000
2023           10  GL-WS-PPN               PIC S9(9)V99.                03561000
2023           10  GL-WS-VMN               PIC S9(9)V99.                03562000
               10  GL-WS-GDT               PIC S9(9)V99.                03570000
2023           10  GL-WS-SGT               PIC S9(9)V99.                03571000
               10  GL-WS-KKT               PIC S9(9)V99.                03580000
               10  GL-WS-GDTT              PIC S9(9)V99.                03590000
               10  GL-WS-KMT               PIC S9(9)V99.                03600000
               10  GL-WS-KMI               PIC S9(9)V99.                03610000
               10  GL-WS-CASH              PIC S9(9)V99.                03620000
               10  GL-WS-CHECK             PIC S9(9)V99.                03630000
               10  GL-WS-KCP               PIC S9(9)V99.                03640000
2023           10  GL-WS-CVP               PIC S9(9)V99.                03641000
               10  GL-WS-CRI               PIC S9(9)V99.                03650000
               10  GL-WS-EMPDISC           PIC S9(9)V99.                03660000
                                                                        03670000
       01  GL-RECORD-OUT.                                               03680000
           05  GL-STORE             PIC 9(4).                           03690000
           05  FILLER               PIC X           VALUE ','.          03700000
           05  GL-SALES             PIC -9(9).99.                       03710000
           05  FILLER               PIC X           VALUE ','.          03720000
           05  GL-GDS               PIC -9(9).99.                       03730000
           05  FILLER               PIC X           VALUE ','.          03740000
           05  GL-TPC               PIC -9(9).99.                       03750000
           05  FILLER               PIC X           VALUE ','.          03760000
           05  GL-TCC               PIC -9(9).99.                       03770000
           05  FILLER               PIC X           VALUE ','.          03780000
2023       05  GL-SGS               PIC -9(9).99.                       03781000
2023       05  FILLER               PIC X           VALUE ','.          03782000
           05  GL-BOS               PIC -9(9).99.                       03790000
           05  FILLER               PIC X           VALUE ','.          03800000
           05  GL-BPS               PIC -9(9).99.                       03810000
           05  FILLER               PIC X           VALUE ','.          03820000
           05  GL-SFS               PIC -9(9).99.                       03830000
           05  FILLER               PIC X           VALUE ','.          03840000
2023       05  GL-MKT               PIC -9(9).99.                       03841000
2023       05  FILLER               PIC X           VALUE ','.          03842000
           05  GL-KKB               PIC -9(9).99.                       03850000
           05  FILLER               PIC X           VALUE ','.          03860000
           05  GL-KKH               PIC -9(9).99.                       03870000
           05  FILLER               PIC X           VALUE ','.          03880000
           05  GL-KKS               PIC -9(9).99.                       03890000
           05  FILLER               PIC X           VALUE ','.          03900000
           05  GL-KKU               PIC -9(9).99.                       03910000
           05  FILLER               PIC X           VALUE ','.          03920000
           05  GL-SHS               PIC -9(9).99.                       03930000
           05  FILLER               PIC X           VALUE ','.          03940000
           05  GL-STM               PIC -9(9).99.                       03950000
           05  FILLER               PIC X           VALUE ','.          03960000
           05  GL-RETURNS           PIC -9(9).99.                       03970000
           05  FILLER               PIC X           VALUE ','.          03980000
           05  GL-BSR               PIC -9(9).99.                       03990000
           05  FILLER               PIC X           VALUE ','.          04000000
           05  GL-BPR               PIC -9(9).99.                       04010000
           05  FILLER               PIC X           VALUE ','.          04020000
           05  GL-ECR               PIC -9(9).99.                       04030000
           05  FILLER               PIC X           VALUE ','.          04040000
           05  GL-SHR               PIC -9(9).99.                       04050000
           05  FILLER               PIC X           VALUE ','.          04060000
           05  GL-TMR               PIC -9(9).99.                       04070000
           05  FILLER               PIC X           VALUE ','.          04080000
           05  GL-TAX               PIC -9(9).99.                       04090000
           05  FILLER               PIC X           VALUE ','.          04100000
           05  GL-FEE               PIC -9(9).99.                       04110000
           05  FILLER               PIC X           VALUE ','.          04120000
           05  GL-AEN               PIC -9(9).99.                       04130000
           05  FILLER               PIC X           VALUE ','.          04140000
           05  GL-BCN               PIC -9(9).99.                       04150000
           05  FILLER               PIC X           VALUE ','.          04160000
           05  GL-DBN               PIC -9(9).99.                       04170000
           05  FILLER               PIC X           VALUE ','.          04180000
           05  GL-KCN               PIC -9(9).99.                       04190000
           05  FILLER               PIC X           VALUE ','.          04200000
2023       05  GL-CVN               PIC -9(9).99.                       04201000
2023       05  FILLER               PIC X           VALUE ','.          04202000
           05  GL-NCN               PIC -9(9).99.                       04210000
           05  FILLER               PIC X           VALUE ','.          04220000
2023       05  GL-PPN               PIC -9(9).99.                       04221000
2023       05  FILLER               PIC X           VALUE ','.          04222000
2023       05  GL-VMN               PIC -9(9).99.                       04223000
2023       05  FILLER               PIC X           VALUE ','.          04224000
           05  GL-GDT               PIC -9(9).99.                       04230000
           05  FILLER               PIC X           VALUE ','.          04240000
2023       05  GL-SGT               PIC -9(9).99.                       04241000
2023       05  FILLER               PIC X           VALUE ','.          04242000
           05  GL-KKT               PIC -9(9).99.                       04250000
           05  FILLER               PIC X           VALUE ','.          04260000
           05  GL-GDTT              PIC -9(9).99.                       04270000
           05  FILLER               PIC X           VALUE ','.          04280000
           05  GL-KMT               PIC -9(9).99.                       04290000
           05  FILLER               PIC X           VALUE ','.          04300000
           05  GL-KMI               PIC -9(9).99.                       04310000
           05  FILLER               PIC X           VALUE ','.          04320000
           05  GL-CASH              PIC -9(9).99.                       04330000
           05  FILLER               PIC X           VALUE ','.          04340000
           05  GL-CHECK             PIC -9(9).99.                       04350000
           05  FILLER               PIC X           VALUE ','.          04360000
           05  GL-KCP               PIC -9(9).99.                       04370000
           05  FILLER               PIC X           VALUE ','.          04380000
2023       05  GL-CVP               PIC -9(9).99.                       04381000
2023       05  FILLER               PIC X           VALUE ','.          04382000
           05  GL-CRI               PIC -9(9).99.                       04390000
           05  FILLER               PIC X           VALUE ','.          04400000
           05  GL-EMPDISC           PIC -9(9).99.                       04410000
           05  FILLER               PIC X           VALUE ','.          04420000
                                                                        04430000
                                                                        04440000
      ******************************************************************04450000
      *  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             04460000
      ******************************************************************04470000
           COPY DPWS500.                                                04480000
                                                                        04490000
      ******************************************************************04500000
      *  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            04510000
      ******************************************************************04520000
           COPY DPWS004.                                                04530000
                                                                        04540000
      ******************************************************************04550000
      *  DB2 MESSAGE AREA                                               04560000
      ******************************************************************04570000
           COPY SQLCA2.                                                 04580000
                                                                        04590000
      ******************************************************************04600000
      *  DB2 COMMUNICATION AREA.                                        04610000
      ******************************************************************04620000
           EXEC SQL                                                     04630000
                INCLUDE SQLCA                                           04640000
           END-EXEC.                                                    04650000
                                                                        04660000
      ******************************************************************04670000
      *  DB2 TABLE XST_LOC - STORE LOCATION TABLE                       04680000
      ******************************************************************04690000
           EXEC SQL                                                     04700000
                INCLUDE XST00001                                        04710000
           END-EXEC.                                                    04720000
                                                                        04730000
      ******************************************************************04740000
      *  DB2 TABLE TEPPART - PARTITION TABLE                            04750000
      ******************************************************************04760000
           EXEC SQL                                                     04770000
                INCLUDE TEPPART                                         04780000
           END-EXEC.                                                    04790000
                                                                        04800000
      ******************************************************************04810000
      *  DB2 TABLE TEPTRN - TRANSACTION TABLE                           04820000
      ******************************************************************04830000
           EXEC SQL                                                     04840000
                INCLUDE TEPTRN                                          04850000
           END-EXEC.                                                    04860000
                                                                        04870000
      ******************************************************************04880000
      *  DB2 TABLE TEPITM - ITEM TABLE                                  04890000
      ******************************************************************04900000
           EXEC SQL                                                     04910000
                INCLUDE TEPITM                                          04920000
           END-EXEC.                                                    04930000
                                                                        04940000
      ******************************************************************04950000
      *  DB2 TABLE TEPTND - TENDER TABLE                                04960000
      ******************************************************************04970000
           EXEC SQL                                                     04980000
                INCLUDE TEPTND                                          04990000
           END-EXEC.                                                    05000000
                                                                        05010000
      ******************************************************************05020000
      *  DB2 TABLE TEPIRT - ITEM RETURN INFO TABLE                      05030000
      ******************************************************************05040000
           EXEC SQL                                                     05050000
                INCLUDE TEPIRT                                          05060000
           END-EXEC.                                                    05070000
                                                                        05080000
      ******************************************************************05090000
      *  DB2 TABLE TEPSHP - SHIPPING TABLE                              05100000
      ******************************************************************05110000
           EXEC SQL                                                     05120000
                INCLUDE TEPSHP                                          05130000
           END-EXEC.                                                    05140000
                                                                        05150000
      ******************************************************************05160000
      *  DB2 TABLE TEPLIS - LINE ITEM SPECIAL SERVICES TABLE            05170000
      ******************************************************************05180000
           EXEC SQL                                                     05190000
                INCLUDE TEPLIS                                          05200000
           END-EXEC.                                                    05210000
                                                                        05220000
      ******************************************************************05230000
      *  DB2 TABLE TEPPAY - KOHLS CHARGE PAYMENT TABLE                  05240000
      ******************************************************************05250000
           EXEC SQL                                                     05260000
                INCLUDE TEPPAY                                          05270000
           END-EXEC.                                                    05280000
                                                                        05290000
      ******************************************************************05300000
      *  DB2 TABLE TEPRFN - CORP REFUND TABLE                           05310000
      ******************************************************************05320000
           EXEC SQL                                                     05330000
                INCLUDE TEPRFN                                          05340000
           END-EXEC.                                                    05350000
                                                                        05360000
      ******************************************************************05370000
      *  DB2 TABLE TEPEID - EMPLOYEE ITEM DISCOUNT TABLE                05380000
      ******************************************************************05390000
           EXEC SQL                                                     05400000
                INCLUDE TEPEID                                          05410000
           END-EXEC.                                                    05420000
                                                                        05430000
      ******************************************************************05440000
      *  DB2 TABLE TSASUM - SALES AUDIT SUMMARY TOTALS TABLE            05450000
      ******************************************************************05460000
           EXEC SQL                                                     05470000
                INCLUDE TSASUM                                          05480000
           END-EXEC.                                                    05490000
                                                                        05500000
      ******************************************************************05510000
      *  DB2 TABLE GCT00005 - GCT_VND_COMMS TABLE                       05520000
      ******************************************************************05530000
           EXEC SQL                                                     05540000
                INCLUDE GCT00005                                        05550000
           END-EXEC.                                                    05560000
                                                                        05570000
                                                                        05580000
      ******************************************************************05590000
      *  SALES-CURSOR -- CURSOR TO SUM TOTAL SALES                      05600000
      ******************************************************************05610000
           EXEC SQL                                                     05620000
             DECLARE SALES-CURSOR CURSOR FOR                            05630000
               SELECT T.STR_NBR                                         05640000
                     ,SUM(T.TRN_TOT_AMT - T.SLS_TX_AMT)                 05650000
               FROM   TEPPART P                                         05660000
                     ,TEPTRN  T                                         05670000
              WHERE   P.SLS_DTE     BETWEEN :DK-BEGIN-DATE              05680000
                                        AND :DK-END-DATE                05690000
                AND   T.PARTN_NBR         = P.PARTN_NBR                 05700000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             05710000
                AND   T.VOID_ABRT_CDE     = 'N'                         05720000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 05730000
                AND   T.STR_NBR          <> 6666                        05740000
           GROUP BY   T.STR_NBR                                         05750000
           ORDER BY   T.STR_NBR                                         05760000
            WITH UR                                                     05770000
           END-EXEC.                                                    05780000
                                                                        05790000
      ******************************************************************05800000
      *  RET-CURSOR -- CURSOR TO SUM TOTAL RETURNS                      05810000
      ******************************************************************05820000
           EXEC SQL                                                     05830000
             DECLARE RETURNS-CURSOR CURSOR FOR                          05840000
               SELECT T.STR_NBR                                         05850000
                     ,SUM(T.TRN_TOT_AMT - T.SLS_TX_AMT)                 05860000
               FROM   TEPPART P                                         05870000
                     ,TEPTRN  T                                         05880000
              WHERE   P.SLS_DTE     BETWEEN :DK-BEGIN-DATE              05890000
                                        AND :DK-END-DATE                05900000
                AND   T.PARTN_NBR         = P.PARTN_NBR                 05910000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             05920001
                AND   T.VOID_ABRT_CDE     = 'N'                         05930000
                AND   T.TRN_TYP_CDE      IN ('11','12','24','25')       05940000
                AND   T.STR_NBR          <> 6666                        05950000
           GROUP BY   T.STR_NBR                                         05960000
           ORDER BY   T.STR_NBR                                         05970000
            WITH UR                                                     05980000
           END-EXEC.                                                    05990000
                                                                        06000000
      ******************************************************************06010000
      *  GDS-CURSOR -- CURSOR TO GET KOHLS GIFT CARD SALES              06020000
      ******************************************************************06030000
           EXEC SQL                                                     06040000
             DECLARE GDS-CURSOR CURSOR FOR                              06050000
               SELECT T.STR_NBR                                         06060000
                     ,SUM(CUST_CHRGD_AMT)                               06070000
                 FROM TEPPART P                                         06080000
                     ,TEPTRN  T                                         06090000
                     ,TEPITM  I                                         06100000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               06110000
                                       AND :DK-END-DATE                 06120000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  06130000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  06140000
                AND   T.STR_NBR          = I.STR_NBR                    06150000
                AND   T.RGST_ID          = I.RGST_ID                    06160000
                AND   T.TRN_NBR          = I.TRN_NBR                    06170000
                AND   T.STRT_TM          = I.STRT_TM                    06180000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           06190000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             06200000
                AND   T.VOID_ABRT_CDE     = 'N'                         06210000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 06220000
                AND   T.STR_NBR          <> 6666                        06230000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   06240000
                AND   I.DEPT_NBR          = '983'                       06250000
           GROUP BY   T.STR_NBR                                         06260000
           ORDER BY   T.STR_NBR                                         06270000
            WITH UR                                                     06280000
           END-EXEC.                                                    06290000
                                                                        06300000
      ******************************************************************06310000
      *  TPC-CURSOR -- CURSOR TO GET THIRD PARTY GIFT CARD SALES        06320000
      ******************************************************************06330000
           EXEC SQL                                                     06340000
             DECLARE TPC-CURSOR CURSOR FOR                              06350000
               SELECT T.STR_NBR                                         06360000
                     ,SUM(CUST_CHRGD_AMT)                               06370000
                 FROM TEPPART P                                         06380000
                     ,TEPTRN  T                                         06390000
                     ,TEPITM  I                                         06400000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               06410000
                                       AND :DK-END-DATE                 06420000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  06430000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  06440000
                AND   T.STR_NBR          = I.STR_NBR                    06450000
                AND   T.RGST_ID          = I.RGST_ID                    06460000
                AND   T.TRN_NBR          = I.TRN_NBR                    06470000
                AND   T.STRT_TM          = I.STRT_TM                    06480000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           06490000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             06500000
                AND   T.VOID_ABRT_CDE     = 'N'                         06510000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 06520000
                AND   T.STR_NBR          <> 6666                        06530000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   06540000
                AND   I.DEPT_NBR         IN ('833','834')               06550000
           GROUP BY   T.STR_NBR                                         06560000
           ORDER BY   T.STR_NBR                                         06570000
            WITH UR                                                     06580000
           END-EXEC.                                                    06590000
                                                                        06600000
      ******************************************************************06610000
      *  TCC-CURSOR -- CURSOR TO GET THIRD PARTY GIFT CARD COMMISSIONS  06620000
      ******************************************************************06630000
           EXEC SQL                                                     06640000
             DECLARE TCC-CURSOR CURSOR FOR                              06650000
               SELECT T.STR_NBR                                         06660000
                     ,SUM(UNT_COMMS_AMT * I.SLD_QTY)                    06670000
                 FROM TEPPART        P                                  06680000
                     ,TEPTRN         T                                  06690000
                     ,TEPITM         I                                  06700000
                     ,GCT_VND_COMMS  C                                  06710000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               06720000
                                       AND :DK-END-DATE                 06730000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  06740000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  06750000
                AND   T.STR_NBR          = I.STR_NBR                    06760000
                AND   T.RGST_ID          = I.RGST_ID                    06770000
                AND   T.TRN_NBR          = I.TRN_NBR                    06780000
                AND   T.STRT_TM          = I.STRT_TM                    06790000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           06800000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             06810000
                AND   T.VOID_ABRT_CDE     = 'N'                         06820000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 06830000
                AND   T.STR_NBR          <> 6666                        06840000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   06850000
                AND   I.DEPT_NBR         IN ('833','834')               06860000
                AND   I.UPC_NBR          = C.UPC_NBR                    06870000
                AND  (C.EFF_STRT_DTE    <= T.SLS_DTE                    06880000
                AND   C.EFF_END_DTE      > T.SLS_DTE)                   06890000
           GROUP BY   T.STR_NBR                                         06900000
           ORDER BY   T.STR_NBR                                         06910000
            WITH UR                                                     06920000
           END-EXEC.                                                    06930000
                                                                        06940000
2023  ******************************************************************06941000
2023  *  SGS-CURSOR -- CURSOR TO GET SEPHORA GIFT CARD SALES            06942000
2023  ******************************************************************06943000
2023       EXEC SQL                                                     06944000
2023         DECLARE SGS-CURSOR CURSOR FOR                              06945000
2023           SELECT T.STR_NBR                                         06946000
2023                 ,SUM(CUST_CHRGD_AMT)                               06947000
2023             FROM TEPPART P                                         06948000
2023                 ,TEPTRN  T                                         06949000
2023                 ,TEPITM  I                                         06949100
2023          WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               06949200
2023                                   AND :DK-END-DATE                 06949300
2023            AND   T.PARTN_NBR        = P.PARTN_NBR                  06949400
2023            AND   T.PARTN_NBR        = I.PARTN_NBR                  06949500
2023            AND   T.STR_NBR          = I.STR_NBR                    06949600
2023            AND   T.RGST_ID          = I.RGST_ID                    06949700
2023            AND   T.TRN_NBR          = I.TRN_NBR                    06949800
2023            AND   T.STRT_TM          = I.STRT_TM                    06949900
2023            AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           06950000
2023            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             06950100
2023            AND   T.VOID_ABRT_CDE     = 'N'                         06950200
2023            AND   T.TRN_TYP_CDE      IN ('01','02')                 06950300
2023            AND   T.STR_NBR          <> 6666                        06950400
2023            AND   I.LIV_RSLU_CDE     IN ('+','-')                   06950500
2023            AND   I.DEPT_NBR          = '712'                       06950600
2023       GROUP BY   T.STR_NBR                                         06950700
2023       ORDER BY   T.STR_NBR                                         06950800
2023        WITH UR                                                     06950900
2023       END-EXEC.                                                    06951000
2023                                                                    06951100
      ******************************************************************06952000
      *  BOS-CURSOR -- CURSOR TO GET BUY ONLINE SHIP TO STORE SALES     06960000
      ******************************************************************06970000
           EXEC SQL                                                     06980000
             DECLARE BOS-CURSOR CURSOR FOR                              06990000
               SELECT T.STR_NBR                                         07000000
                     ,SUM(NET_CHRGD_AMT)                                07010000
                 FROM TEPPART P                                         07020000
                     ,TEPTRN  T                                         07030000
                     ,TEPITM  I                                         07040000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               07050000
                                       AND :DK-END-DATE                 07060000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  07070000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  07080000
                AND   T.STR_NBR          = I.STR_NBR                    07090000
                AND   T.RGST_ID          = I.RGST_ID                    07100000
                AND   T.TRN_NBR          = I.TRN_NBR                    07110000
                AND   T.STRT_TM          = I.STRT_TM                    07120000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           07130000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             07140000
                AND   T.VOID_ABRT_CDE     = 'N'                         07150000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 07160000
                AND   T.STR_NBR          <> 6666                        07170000
                AND   T.OMNI_CHNL_FFLMT_TYP_CDE = 'BOS'                 07180000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   07190000
           GROUP BY   T.STR_NBR                                         07200000
           ORDER BY   T.STR_NBR                                         07210000
            WITH UR                                                     07220000
           END-EXEC.                                                    07230000
                                                                        07240000
      ******************************************************************07250000
      *  BPS-CURSOR -- CURSOR TO GET BUY ONLINE PICK UP IN STORE SALES  07260000
      ******************************************************************07270000
           EXEC SQL                                                     07280000
             DECLARE BPS-CURSOR CURSOR FOR                              07290000
               SELECT T.STR_NBR                                         07300000
                     ,SUM(NET_CHRGD_AMT)                                07310000
                 FROM TEPPART P                                         07320000
                     ,TEPTRN  T                                         07330000
                     ,TEPITM  I                                         07340000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               07350000
                                       AND :DK-END-DATE                 07360000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  07370000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  07380000
                AND   T.STR_NBR          = I.STR_NBR                    07390000
                AND   T.RGST_ID          = I.RGST_ID                    07400000
                AND   T.TRN_NBR          = I.TRN_NBR                    07410000
                AND   T.STRT_TM          = I.STRT_TM                    07420000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           07430000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             07440000
                AND   T.VOID_ABRT_CDE     = 'N'                         07450000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 07460000
                AND   T.STR_NBR          <> 6666                        07470000
                AND   T.OMNI_CHNL_FFLMT_TYP_CDE = 'BPS'                 07480000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   07490000
           GROUP BY   T.STR_NBR                                         07500000
           ORDER BY   T.STR_NBR                                         07510000
            WITH UR                                                     07520000
           END-EXEC.                                                    07530000
                                                                        07540000
      ******************************************************************07550000
      *  SFS-CURSOR -- CURSOR TO GET SHIP FROM STORES SALES             07560000
      ******************************************************************07570000
           EXEC SQL                                                     07580000
             DECLARE SFS-CURSOR CURSOR FOR                              07590000
               SELECT T.STR_NBR                                         07600000
                     ,SUM(NET_CHRGD_AMT)                                07610000
                 FROM TEPPART P                                         07620000
                     ,TEPTRN  T                                         07630000
                     ,TEPITM  I                                         07640000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               07650000
                                       AND :DK-END-DATE                 07660000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  07670000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  07680000
                AND   T.STR_NBR          = I.STR_NBR                    07690000
                AND   T.RGST_ID          = I.RGST_ID                    07700000
                AND   T.TRN_NBR          = I.TRN_NBR                    07710000
                AND   T.STRT_TM          = I.STRT_TM                    07720000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           07730000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             07740000
                AND   T.VOID_ABRT_CDE     = 'N'                         07750000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 07760000
                AND   T.STR_NBR          <> 6666                        07770000
                AND   T.OMNI_CHNL_FFLMT_TYP_CDE = 'SFS'                 07780000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   07790000
           GROUP BY   T.STR_NBR                                         07800000
           ORDER BY   T.STR_NBR                                         07810000
            WITH UR                                                     07820000
           END-EXEC.                                                    07830000
                                                                        07840000
2023  ******************************************************************07841000
2023  *  MKT-CURSOR -- CURSOR TO GET MARKETPLACE SALES AND RETURNS      07842000
2023  ******************************************************************07843000
2023       EXEC SQL                                                     07844000
2023         DECLARE MKT-CURSOR CURSOR FOR                              07845000
2023           SELECT T.STR_NBR                                         07846000
2023                 ,SUM(NET_CHRGD_AMT)                                07847000
2023             FROM TEPPART P                                         07848000
2023                 ,TEPTRN  T                                         07849000
2023                 ,TEPITM  I                                         07849100
2023          WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               07849200
2023                                   AND :DK-END-DATE                 07849300
2023            AND   T.PARTN_NBR        = P.PARTN_NBR                  07849400
2023            AND   T.PARTN_NBR        = I.PARTN_NBR                  07849500
2023            AND   T.STR_NBR          = I.STR_NBR                    07849600
2023            AND   T.RGST_ID          = I.RGST_ID                    07849700
2023            AND   T.TRN_NBR          = I.TRN_NBR                    07849800
2023            AND   T.STRT_TM          = I.STRT_TM                    07849900
2023            AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           07850000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             07850101
2023            AND   T.VOID_ABRT_CDE     = 'N'                         07850200
2024            AND   T.TRN_TYP_CDE      IN ('01','02','11','12')       07850301
2023            AND   T.STR_NBR          <> 6666                        07850500
2023            AND   I.LIV_RSLU_CDE     IN ('+','-')                   07850600
2023            AND   I.DEPT_NBR          = '985'                       07850700
2023       GROUP BY   T.STR_NBR                                         07850800
2023       ORDER BY   T.STR_NBR                                         07850900
2023        WITH UR                                                     07851000
2023       END-EXEC.                                                    07851100
2023                                                                    07851200
      ******************************************************************07852000
      *  BSR-CURSOR -- CURSOR TO GET BUY ONLINE SHIP TO STORE RETURNS   07860000
      ******************************************************************07870000
           EXEC SQL                                                     07880000
             DECLARE BSR-CURSOR CURSOR FOR                              07890000
               SELECT T.STR_NBR                                         07900000
                     ,SUM(NET_CHRGD_AMT)                                07910000
                 FROM TEPPART P                                         07920000
                     ,TEPTRN  T                                         07930000
                     ,TEPITM  I                                         07940000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               07950000
                                       AND :DK-END-DATE                 07960000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  07970000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  07980000
                AND   T.STR_NBR          = I.STR_NBR                    07990000
                AND   T.RGST_ID          = I.RGST_ID                    08000000
                AND   T.TRN_NBR          = I.TRN_NBR                    08010000
                AND   T.STRT_TM          = I.STRT_TM                    08020000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           08030000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             08040001
                AND   T.VOID_ABRT_CDE     = 'N'                         08050000
                AND   T.TRN_TYP_CDE      IN ('11','12','24','25')       08060000
                AND   T.STR_NBR          <> 6666                        08070000
                AND   T.OMNI_CHNL_FFLMT_TYP_CDE = 'BOS'                 08080000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   08090000
           GROUP BY   T.STR_NBR                                         08100000
           ORDER BY   T.STR_NBR                                         08110000
            WITH UR                                                     08120000
           END-EXEC.                                                    08130000
                                                                        08140000
      ******************************************************************08150000
      *  BPR-CURSOR -- CURSOR TO GET BUY ONLINE PICK UP IN STORE RETURNS08160000
      ******************************************************************08170000
           EXEC SQL                                                     08180000
             DECLARE BPR-CURSOR CURSOR FOR                              08190000
               SELECT T.STR_NBR                                         08200000
                     ,SUM(NET_CHRGD_AMT)                                08210000
                 FROM TEPPART P                                         08220000
                     ,TEPTRN  T                                         08230000
                     ,TEPITM  I                                         08240000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               08250000
                                       AND :DK-END-DATE                 08260000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  08270000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  08280000
                AND   T.STR_NBR          = I.STR_NBR                    08290000
                AND   T.RGST_ID          = I.RGST_ID                    08300000
                AND   T.TRN_NBR          = I.TRN_NBR                    08310000
                AND   T.STRT_TM          = I.STRT_TM                    08320000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           08330000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             08361001
                AND   T.VOID_ABRT_CDE     = 'N'                         08362000
                AND   T.TRN_TYP_CDE      IN ('11','12','24','25')       08363000
                AND   T.STR_NBR          <> 6666                        08370000
                AND   T.OMNI_CHNL_FFLMT_TYP_CDE = 'BPS'                 08380000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   08390000
           GROUP BY   T.STR_NBR                                         08400000
           ORDER BY   T.STR_NBR                                         08410000
            WITH UR                                                     08420000
           END-EXEC.                                                    08430000
                                                                        08440000
      ******************************************************************08450000
      *  KKB-CURSOR -- CURSOR TO GET KCK BACK TO SCHOOL SALES           08460000
      ******************************************************************08470000
           EXEC SQL                                                     08480000
             DECLARE KKB-CURSOR CURSOR FOR                              08490000
               SELECT T.STR_NBR                                         08500000
                     ,SUM(NET_CHRGD_AMT)                                08510000
                 FROM TEPPART P                                         08520000
                     ,TEPTRN  T                                         08530000
                     ,TEPITM  I                                         08540000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               08550000
                                       AND :DK-END-DATE                 08560000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  08570000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  08580000
                AND   T.STR_NBR          = I.STR_NBR                    08590000
                AND   T.RGST_ID          = I.RGST_ID                    08600000
                AND   T.TRN_NBR          = I.TRN_NBR                    08610000
                AND   T.STRT_TM          = I.STRT_TM                    08620000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           08630000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             08640000
                AND   T.VOID_ABRT_CDE     = 'N'                         08650000
NEW   ***       AND   T.TRN_TYP_CDE      IN ('01','02')                 08660000
                AND   T.STR_NBR          <> 6666                        08670000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   08680000
                AND   I.DEPT_NBR          = '830'                       08690000
                AND   I.SUB_CL_NBR        = '12'                        08700000
           GROUP BY   T.STR_NBR                                         08710000
           ORDER BY   T.STR_NBR                                         08720000
            WITH UR                                                     08730000
           END-EXEC.                                                    08740000
                                                                        08750000
      ******************************************************************08760000
      *  KKH-CURSOR -- CURSOR TO GET KCK HOLIDAY SALES                  08770000
      ******************************************************************08780000
           EXEC SQL                                                     08790000
             DECLARE KKH-CURSOR CURSOR FOR                              08800000
               SELECT T.STR_NBR                                         08810000
                     ,SUM(NET_CHRGD_AMT)                                08820000
                 FROM TEPPART P                                         08830000
                     ,TEPTRN  T                                         08840000
                     ,TEPITM  I                                         08850000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               08860000
                                       AND :DK-END-DATE                 08870000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  08880000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  08890000
                AND   T.STR_NBR          = I.STR_NBR                    08900000
                AND   T.RGST_ID          = I.RGST_ID                    08910000
                AND   T.TRN_NBR          = I.TRN_NBR                    08920000
                AND   T.STRT_TM          = I.STRT_TM                    08930000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           08940000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             08950000
                AND   T.VOID_ABRT_CDE     = 'N'                         08960000
NEW   ***       AND   T.TRN_TYP_CDE      IN ('01','02')                 08970000
                AND   T.STR_NBR          <> 6666                        08980000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   08990000
                AND   I.DEPT_NBR          = '830'                       09000000
                AND   I.SUB_CL_NBR   NOT IN('11','12','14')             09010000
           GROUP BY   T.STR_NBR                                         09020000
           ORDER BY   T.STR_NBR                                         09030000
            WITH UR                                                     09040000
           END-EXEC.                                                    09050000
                                                                        09060000
      ******************************************************************09070000
      *  KKS-CURSOR -- CURSOR TO GET KCK SPRING SALES                   09080000
      ******************************************************************09090000
           EXEC SQL                                                     09100000
             DECLARE KKS-CURSOR CURSOR FOR                              09110000
               SELECT T.STR_NBR                                         09120000
                     ,SUM(NET_CHRGD_AMT)                                09130000
                 FROM TEPPART P                                         09140000
                     ,TEPTRN  T                                         09150000
                     ,TEPITM  I                                         09160000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               09170000
                                       AND :DK-END-DATE                 09180000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  09190000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  09200000
                AND   T.STR_NBR          = I.STR_NBR                    09210000
                AND   T.RGST_ID          = I.RGST_ID                    09220000
                AND   T.TRN_NBR          = I.TRN_NBR                    09230000
                AND   T.STRT_TM          = I.STRT_TM                    09240000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           09250000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             09260000
                AND   T.VOID_ABRT_CDE     = 'N'                         09270000
NEW   ***       AND   T.TRN_TYP_CDE      IN ('01','02')                 09280000
                AND   T.STR_NBR          <> 6666                        09290000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   09300000
                AND   I.DEPT_NBR          = '830'                       09310000
                AND   I.SUB_CL_NBR        = '11'                        09320000
           GROUP BY   T.STR_NBR                                         09330000
           ORDER BY   T.STR_NBR                                         09340000
            WITH UR                                                     09350000
           END-EXEC.                                                    09360000
                                                                        09370000
      ******************************************************************09380000
      *  KKU-CURSOR -- CURSOR TO GET KCK SUMMER SALES                   09390000
      ******************************************************************09400000
           EXEC SQL                                                     09410000
             DECLARE KKU-CURSOR CURSOR FOR                              09420000
               SELECT T.STR_NBR                                         09430000
                     ,SUM(NET_CHRGD_AMT)                                09440000
                 FROM TEPPART P                                         09450000
                     ,TEPTRN  T                                         09460000
                     ,TEPITM  I                                         09470000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               09480000
                                       AND :DK-END-DATE                 09490000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  09500000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  09510000
                AND   T.STR_NBR          = I.STR_NBR                    09520000
                AND   T.RGST_ID          = I.RGST_ID                    09530000
                AND   T.TRN_NBR          = I.TRN_NBR                    09540000
                AND   T.STRT_TM          = I.STRT_TM                    09550000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           09560000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             09570000
                AND   T.VOID_ABRT_CDE     = 'N'                         09580000
NEW   ***       AND   T.TRN_TYP_CDE      IN ('01','02')                 09590000
                AND   T.STR_NBR          <> 6666                        09600000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   09610000
                AND   I.DEPT_NBR          = '830'                       09620000
                AND   I.SUB_CL_NBR        = '14'                        09630000
           GROUP BY   T.STR_NBR                                         09640000
           ORDER BY   T.STR_NBR                                         09650000
            WITH UR                                                     09660000
           END-EXEC.                                                    09670000
                                                                        09680000
      ******************************************************************09690000
      *  SHS-CURSOR -- CURSOR TO GET SHIPPING SALES                     09700000
      ******************************************************************09710000
           EXEC SQL                                                     09720000
             DECLARE SHS-CURSOR CURSOR FOR                              09730000
               SELECT T.STR_NBR                                         09740000
                     ,SUM(SHIP_CHRG_AMT)                                09750000
                 FROM TEPPART P                                         09760000
                     ,TEPTRN  T                                         09770000
                     ,TEPSHP  S                                         09780000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               09790000
                                       AND :DK-END-DATE                 09800000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  09810000
                AND   T.PARTN_NBR        = S.PARTN_NBR                  09820000
                AND   T.STR_NBR          = S.STR_NBR                    09830000
                AND   T.RGST_ID          = S.RGST_ID                    09840000
                AND   T.TRN_NBR          = S.TRN_NBR                    09850000
                AND   T.STRT_TM          = S.STRT_TM                    09860000
                AND   T.SLS_CORR_SEQ_NBR = S.SLS_CORR_SEQ_NBR           09870000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             09880000
                AND   T.VOID_ABRT_CDE     = 'N'                         09890000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 09900000
                AND   T.STR_NBR          <> 6666                        09910000
           GROUP BY   T.STR_NBR                                         09920000
           ORDER BY   T.STR_NBR                                         09930000
            WITH UR                                                     09940000
           END-EXEC.                                                    09950000
                                                                        09960000
      ******************************************************************09970000
      *  ECR-CURSOR -- CURSOR TO GET ECOM RETURNS                       09980000
      ******************************************************************09990000
           EXEC SQL                                                     10000000
             DECLARE ECR-CURSOR CURSOR FOR                              10010000
               SELECT T.STR_NBR                                         10020000
                     ,SUM(NET_CHRGD_AMT)                                10030000
                 FROM TEPPART P                                         10040000
                     ,TEPTRN  T                                         10050000
                     ,TEPITM  I                                         10060000
                     ,TEPIRT  R                                         10070000
                     ,XST_LOC L                                         10080000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               10090000
                                       AND :DK-END-DATE                 10100000
                AND   T.PARTN_NBR         = P.PARTN_NBR                 10110000
                AND   T.PARTN_NBR         = I.PARTN_NBR                 10120000
                AND   T.STR_NBR           = I.STR_NBR                   10130000
                AND   T.RGST_ID           = I.RGST_ID                   10140000
                AND   T.TRN_NBR           = I.TRN_NBR                   10150000
                AND   T.STRT_TM           = I.STRT_TM                   10160000
                AND   T.SLS_CORR_SEQ_NBR  = I.SLS_CORR_SEQ_NBR          10170000
                AND   I.PARTN_NBR         = R.PARTN_NBR                 10180000
                AND   I.STR_NBR           = R.STR_NBR                   10190000
                AND   I.RGST_ID           = R.RGST_ID                   10200000
                AND   I.TRN_NBR           = R.TRN_NBR                   10210000
                AND   I.STRT_TM           = R.STRT_TM                   10220000
                AND   I.SLS_CORR_SEQ_NBR  = R.SLS_CORR_SEQ_NBR          10230000
                AND   I.LNE_ITM_SEQ_NBR   = R.LNE_ITM_SEQ_NBR           10240000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             10250001
                AND   T.VOID_ABRT_CDE     = 'N'                         10260000
NEW             AND   T.TRN_TYP_CDE      IN ('11','12','24','25')       10270000
                AND   T.STR_NBR          <> 6666                        10280000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   10290000
                AND   R.ORIG_STR_NBR      = L.LOC_NBR                   10300000
                AND   L.LOC_TYP_CDE       = 'DS'                        10310000
                AND  (L.E_BUS_IND         = 'Y')                        10320000
NEW   ***        OR  (L.E_BUS_IND         = 'N'                         10330000
NEW   ***       AND   R.ORIG_RGST_ID BETWEEN 90 AND 95))                10340000
           GROUP BY   T.STR_NBR                                         10350000
           ORDER BY   T.STR_NBR                                         10360000
            WITH UR                                                     10370000
           END-EXEC.                                                    10380000
                                                                        10390000
      ******************************************************************10400000
      *  SHR-CURSOR -- CURSOR TO GET SHIPPING RETURNS                   10410000
      ******************************************************************10420000
           EXEC SQL                                                     10430000
             DECLARE SHR-CURSOR CURSOR FOR                              10440000
               SELECT T.STR_NBR                                         10450000
                     ,SUM(L.SRVC_AMT)                                   10460000
                 FROM TEPPART P                                         10470000
                     ,TEPTRN  T                                         10480000
                     ,TEPITM  I                                         10490000
                     ,TEPLIS  L                                         10500000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               10510000
                                       AND :DK-END-DATE                 10520000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  10530000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  10540000
                AND   T.STR_NBR          = I.STR_NBR                    10550000
                AND   T.RGST_ID          = I.RGST_ID                    10560000
                AND   T.TRN_NBR          = I.TRN_NBR                    10570000
                AND   T.STRT_TM          = I.STRT_TM                    10580000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           10590000
                AND   I.PARTN_NBR        = L.PARTN_NBR                  10600000
                AND   I.STR_NBR          = L.STR_NBR                    10610000
                AND   I.RGST_ID          = L.RGST_ID                    10620000
                AND   I.TRN_NBR          = L.TRN_NBR                    10630000
                AND   I.STRT_TM          = L.STRT_TM                    10640000
                AND   I.SLS_CORR_SEQ_NBR = L.SLS_CORR_SEQ_NBR           10650000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             10660001
                AND   T.VOID_ABRT_CDE     = 'N'                         10670000
                AND   T.TRN_TYP_CDE      IN ('11','12','24','25')       10680000
                AND   T.STR_NBR          <> 6666                        10690000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   10700000
                AND   L.SRVC_TYP_CDE      = 'S'                         10710000
           GROUP BY   T.STR_NBR                                         10720000
           ORDER BY   T.STR_NBR                                         10730000
            WITH UR                                                     10740000
           END-EXEC.                                                    10750000
                                                                        10760000
      ******************************************************************10770000
      *  TAX-CURSOR -- CURSOR TO SUM TOTAL TAXES                        10780000
      ******************************************************************10790000
           EXEC SQL                                                     10800000
             DECLARE TAX-CURSOR CURSOR FOR                              10810000
               SELECT T.STR_NBR                                         10820000
                     ,SUM(T.SLS_TX_AMT)                                 10830000
               FROM   TEPPART P                                         10840000
                     ,TEPTRN  T                                         10850000
              WHERE   P.SLS_DTE     BETWEEN :DK-BEGIN-DATE              10860000
                                        AND :DK-END-DATE                10870000
                AND   T.PARTN_NBR         = P.PARTN_NBR                 10880000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             10890001
                AND   T.VOID_ABRT_CDE     = 'N'                         10900000
                AND   TRN_TYP_CDE    IN ('01','02','11','12','24','25') 10910000
                AND   T.STR_NBR          <> 6666                        10920000
           GROUP BY   T.STR_NBR                                         10930000
           ORDER BY   T.STR_NBR                                         10940000
            WITH UR                                                     10950000
           END-EXEC.                                                    10960000
                                                                        10970000
      ******************************************************************10980000
      *  FEE-CURSOR -- CURSOR TO GET FEES                               10990000
      ******************************************************************11000000
           EXEC SQL                                                     11010000
             DECLARE FEE-CURSOR CURSOR FOR                              11020000
               SELECT T.STR_NBR                                         11030000
                     ,SUM(L.SRVC_AMT)                                   11040000
                 FROM TEPPART P                                         11050000
                     ,TEPTRN  T                                         11060000
                     ,TEPITM  I                                         11070000
                     ,TEPLIS  L                                         11080000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               11090000
                                       AND :DK-END-DATE                 11100000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  11110000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  11120000
                AND   T.STR_NBR          = I.STR_NBR                    11130000
                AND   T.RGST_ID          = I.RGST_ID                    11140000
                AND   T.TRN_NBR          = I.TRN_NBR                    11150000
                AND   T.STRT_TM          = I.STRT_TM                    11160000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           11170000
                AND   I.PARTN_NBR        = L.PARTN_NBR                  11180000
                AND   I.STR_NBR          = L.STR_NBR                    11190000
                AND   I.RGST_ID          = L.RGST_ID                    11200000
                AND   I.TRN_NBR          = L.TRN_NBR                    11210000
                AND   I.STRT_TM          = L.STRT_TM                    11220000
                AND   I.SLS_CORR_SEQ_NBR = L.SLS_CORR_SEQ_NBR           11230000
                AND   I.LNE_ITM_SEQ_NBR  = L.LNE_ITM_SEQ_NBR            11240000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             11250001
                AND   T.VOID_ABRT_CDE     = 'N'                         11260000
                AND   T.STR_NBR          <> 6666                        11270000
                AND   I.LIV_RSLU_CDE     IN ('+','-')                   11280000
                AND   L.SRVC_TYP_CDE      = 'F'                         11290000
           GROUP BY   T.STR_NBR                                         11300000
           ORDER BY   T.STR_NBR                                         11310000
            WITH UR                                                     11320000
           END-EXEC.                                                    11330000
                                                                        11340000
      ******************************************************************11350000
      *  AEN-CURSOR -- CURSOR TO GET AMERICAN EXPRESS SALES AND RETURNS 11360000
      ******************************************************************11370000
           EXEC SQL                                                     11380000
             DECLARE AEN-CURSOR CURSOR FOR                              11390000
               SELECT T.STR_NBR                                         11400000
                     ,SUM(N.TNDR_AMT)                                   11410000
                 FROM TEPPART P                                         11420000
                     ,TEPTRN  T                                         11430000
                     ,TEPTND  N                                         11440000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               11450000
                                       AND :DK-END-DATE                 11460000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  11470000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  11480000
                AND   T.STR_NBR          = N.STR_NBR                    11490000
                AND   T.RGST_ID          = N.RGST_ID                    11500000
                AND   T.TRN_NBR          = N.TRN_NBR                    11510000
                AND   T.STRT_TM          = N.STRT_TM                    11520000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           11530000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             11540001
                AND   T.VOID_ABRT_CDE     = 'N'                         11550000
                AND   T.STR_NBR          <> 6666                        11560000
                AND   N.TNDR_TYP_CDE     = '08'                         11570000
                AND   N.TNDR_VOID_IND    = 'N'                          11580000
           GROUP BY   T.STR_NBR                                         11590000
           ORDER BY   T.STR_NBR                                         11600000
            WITH UR                                                     11610000
           END-EXEC.                                                    11620000
                                                                        11630000
      ******************************************************************11640000
      *  BCN-CURSOR -- CURSOR TO GET BANK CARD SALES AND RETURNS        11650000
      ******************************************************************11660000
           EXEC SQL                                                     11670000
             DECLARE BCN-CURSOR CURSOR FOR                              11680000
               SELECT T.STR_NBR                                         11690000
                     ,SUM(N.TNDR_AMT)                                   11700000
                 FROM TEPPART P                                         11710000
                     ,TEPTRN  T                                         11720000
                     ,TEPTND  N                                         11730000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               11740000
                                       AND :DK-END-DATE                 11750000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  11760000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  11770000
                AND   T.STR_NBR          = N.STR_NBR                    11780000
                AND   T.RGST_ID          = N.RGST_ID                    11790000
                AND   T.TRN_NBR          = N.TRN_NBR                    11800000
                AND   T.STRT_TM          = N.STRT_TM                    11810000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           11820000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             11830001
                AND   T.VOID_ABRT_CDE     = 'N'                         11840000
                AND   T.STR_NBR          <> 6666                        11850000
                AND   N.TNDR_TYP_CDE     IN ('05','06')                 11860000
                AND   N.TNDR_VOID_IND    = 'N'                          11870000
           GROUP BY   T.STR_NBR                                         11880000
           ORDER BY   T.STR_NBR                                         11890000
            WITH UR                                                     11900000
           END-EXEC.                                                    11910000
                                                                        11920000
      ******************************************************************11930000
      *  DBN-CURSOR -- CURSOR TO GET DEBIT CARD SALES AND RETURNS       11940000
      ******************************************************************11950000
           EXEC SQL                                                     11960000
             DECLARE DBN-CURSOR CURSOR FOR                              11970000
               SELECT T.STR_NBR                                         11980000
                     ,SUM(N.TNDR_AMT)                                   11990000
                 FROM TEPPART P                                         12000000
                     ,TEPTRN  T                                         12010000
                     ,TEPTND  N                                         12020000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               12030000
                                       AND :DK-END-DATE                 12040000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  12050000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  12060000
                AND   T.STR_NBR          = N.STR_NBR                    12070000
                AND   T.RGST_ID          = N.RGST_ID                    12080000
                AND   T.TRN_NBR          = N.TRN_NBR                    12090000
                AND   T.STRT_TM          = N.STRT_TM                    12100000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           12110000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             12120001
                AND   T.VOID_ABRT_CDE     = 'N'                         12130000
                AND   T.STR_NBR          <> 6666                        12140000
                AND   N.TNDR_TYP_CDE     = '19'                         12150000
                AND   N.TNDR_VOID_IND    = 'N'                          12160000
           GROUP BY   T.STR_NBR                                         12170000
           ORDER BY   T.STR_NBR                                         12180000
            WITH UR                                                     12190000
           END-EXEC.                                                    12200000
                                                                        12210000
      ******************************************************************12220000
      *  KCN-CURSOR -- CURSOR TO GET KOHL'S CHARGE SALES AND RETURNS    12230000
      ******************************************************************12240000
           EXEC SQL                                                     12250000
             DECLARE KCN-CURSOR CURSOR FOR                              12260000
               SELECT T.STR_NBR                                         12270000
                     ,SUM(N.TNDR_AMT)                                   12280000
                 FROM TEPPART P                                         12290000
                     ,TEPTRN  T                                         12300000
                     ,TEPTND  N                                         12310000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               12320000
                                       AND :DK-END-DATE                 12330000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  12340000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  12350000
                AND   T.STR_NBR          = N.STR_NBR                    12360000
                AND   T.RGST_ID          = N.RGST_ID                    12370000
                AND   T.TRN_NBR          = N.TRN_NBR                    12380000
                AND   T.STRT_TM          = N.STRT_TM                    12390000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           12400000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             12410001
                AND   T.VOID_ABRT_CDE     = 'N'                         12420000
                AND   T.STR_NBR          <> 6666                        12430000
                AND   N.TNDR_TYP_CDE     = '04'                         12440000
                AND   N.TNDR_VOID_IND    = 'N'                          12450000
           GROUP BY   T.STR_NBR                                         12460000
           ORDER BY   T.STR_NBR                                         12470000
            WITH UR                                                     12480000
           END-EXEC.                                                    12490000
                                                                        12500000
2023  ******************************************************************12501000
2023  *  CVN-CURSOR -- CURSOR TO GET COBRAND CHARGE SALES AND RETURNS   12502000
2023  ******************************************************************12503000
2023       EXEC SQL                                                     12504000
2023         DECLARE CVN-CURSOR CURSOR FOR                              12505000
2023           SELECT T.STR_NBR                                         12506000
2023                 ,SUM(N.TNDR_AMT)                                   12507000
2023             FROM TEPPART P                                         12508000
2023                 ,TEPTRN  T                                         12509000
2023                 ,TEPTND  N                                         12509100
2023          WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               12509200
2023                                   AND :DK-END-DATE                 12509300
2023            AND   T.PARTN_NBR        = P.PARTN_NBR                  12509400
2023            AND   T.PARTN_NBR        = N.PARTN_NBR                  12509500
2023            AND   T.STR_NBR          = N.STR_NBR                    12509600
2023            AND   T.RGST_ID          = N.RGST_ID                    12509700
2023            AND   T.TRN_NBR          = N.TRN_NBR                    12509800
2023            AND   T.STRT_TM          = N.STRT_TM                    12509900
2023            AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           12510000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             12510101
2023            AND   T.VOID_ABRT_CDE     = 'N'                         12510200
2023            AND   T.STR_NBR          <> 6666                        12510300
2023            AND   N.TNDR_TYP_CDE     = '24'                         12510400
2023            AND   N.TNDR_VOID_IND    = 'N'                          12510500
2023       GROUP BY   T.STR_NBR                                         12510600
2023       ORDER BY   T.STR_NBR                                         12510700
2023        WITH UR                                                     12510800
2023       END-EXEC.                                                    12510900
2023                                                                    12511000
      ******************************************************************12512000
      *  NCN-CURSOR -- CURSOR TO GET NOVUS (DISCOVER) SALES AND RETURNS 12520000
      ******************************************************************12530000
           EXEC SQL                                                     12540000
             DECLARE NCN-CURSOR CURSOR FOR                              12550000
               SELECT T.STR_NBR                                         12560000
                     ,SUM(N.TNDR_AMT)                                   12570000
                 FROM TEPPART P                                         12580000
                     ,TEPTRN  T                                         12590000
                     ,TEPTND  N                                         12600000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               12610000
                                       AND :DK-END-DATE                 12620000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  12630000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  12640000
                AND   T.STR_NBR          = N.STR_NBR                    12650000
                AND   T.RGST_ID          = N.RGST_ID                    12660000
                AND   T.TRN_NBR          = N.TRN_NBR                    12670000
                AND   T.STRT_TM          = N.STRT_TM                    12680000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           12690000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             12700001
                AND   T.VOID_ABRT_CDE     = 'N'                         12710000
                AND   T.STR_NBR          <> 6666                        12720000
                AND   N.TNDR_TYP_CDE     = '07'                         12730000
                AND   N.TNDR_VOID_IND    = 'N'                          12740000
           GROUP BY   T.STR_NBR                                         12750000
           ORDER BY   T.STR_NBR                                         12760000
            WITH UR                                                     12770000
           END-EXEC.                                                    12780000
                                                                        12790000
2023  ******************************************************************12792000
2023  *  PPN-CURSOR -- CURSOR TO GET PAYPAL CHARGE SALES AND RETURNS    12793000
2023  ******************************************************************12794000
2023       EXEC SQL                                                     12795000
2023         DECLARE PPN-CURSOR CURSOR FOR                              12796000
2023           SELECT T.STR_NBR                                         12797000
2023                 ,SUM(N.TNDR_AMT)                                   12798000
2023             FROM TEPPART P                                         12799000
2023                 ,TEPTRN  T                                         12799100
2023                 ,TEPTND  N                                         12799200
2023          WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               12799300
2023                                   AND :DK-END-DATE                 12799400
2023            AND   T.PARTN_NBR        = P.PARTN_NBR                  12799500
2023            AND   T.PARTN_NBR        = N.PARTN_NBR                  12799600
2023            AND   T.STR_NBR          = N.STR_NBR                    12799700
2023            AND   T.RGST_ID          = N.RGST_ID                    12799800
2023            AND   T.TRN_NBR          = N.TRN_NBR                    12799900
2023            AND   T.STRT_TM          = N.STRT_TM                    12800000
2023            AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           12800100
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             12800201
2023            AND   T.VOID_ABRT_CDE     = 'N'                         12800300
2023            AND   T.STR_NBR          <> 6666                        12800400
2023            AND   N.TNDR_TYP_CDE     = '16'                         12800500
2023            AND   N.TNDR_VOID_IND    = 'N'                          12800600
2023       GROUP BY   T.STR_NBR                                         12800700
2023       ORDER BY   T.STR_NBR                                         12800800
2023        WITH UR                                                     12800900
2023       END-EXEC.                                                    12801000
2023                                                                    12801100
2023  ******************************************************************12801200
2023  *  VMN-CURSOR -- CURSOR TO GET VENMO CHARGE SALES AND RETURNS     12801300
2023  ******************************************************************12801400
2023       EXEC SQL                                                     12801500
2023         DECLARE VMN-CURSOR CURSOR FOR                              12801600
2023           SELECT T.STR_NBR                                         12801700
2023                 ,SUM(N.TNDR_AMT)                                   12801800
2023             FROM TEPPART P                                         12801900
2023                 ,TEPTRN  T                                         12802000
2023                 ,TEPTND  N                                         12802100
2023          WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               12802200
2023                                   AND :DK-END-DATE                 12802300
2023            AND   T.PARTN_NBR        = P.PARTN_NBR                  12802400
2023            AND   T.PARTN_NBR        = N.PARTN_NBR                  12802500
2023            AND   T.STR_NBR          = N.STR_NBR                    12802600
2023            AND   T.RGST_ID          = N.RGST_ID                    12802700
2023            AND   T.TRN_NBR          = N.TRN_NBR                    12802800
2023            AND   T.STRT_TM          = N.STRT_TM                    12802900
2023            AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           12803000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             12803101
2023            AND   T.VOID_ABRT_CDE     = 'N'                         12803200
2023            AND   T.STR_NBR          <> 6666                        12803300
2023            AND   N.TNDR_TYP_CDE     = '17'                         12803400
2023            AND   N.TNDR_VOID_IND    = 'N'                          12803500
2023       GROUP BY   T.STR_NBR                                         12803600
2023       ORDER BY   T.STR_NBR                                         12803700
2023        WITH UR                                                     12803800
2023       END-EXEC.                                                    12803900
2023                                                                    12804000
      ******************************************************************12805000
      *  GDT-CURSOR -- CURSOR TO GET KOHLS GIFT CARDS TENDERED          12810000
      ******************************************************************12820000
           EXEC SQL                                                     12830000
             DECLARE GDT-CURSOR CURSOR FOR                              12840000
               SELECT T.STR_NBR                                         12850000
                     ,SUM(N.TNDR_AMT)                                   12860000
                 FROM TEPPART P                                         12870000
                     ,TEPTRN  T                                         12880000
                     ,TEPTND  N                                         12890000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               12900000
                                       AND :DK-END-DATE                 12910000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  12920000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  12930000
                AND   T.STR_NBR          = N.STR_NBR                    12940000
                AND   T.RGST_ID          = N.RGST_ID                    12950000
                AND   T.TRN_NBR          = N.TRN_NBR                    12960000
                AND   T.STRT_TM          = N.STRT_TM                    12970000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           12980000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             12990001
                AND   T.VOID_ABRT_CDE     = 'N'                         13000000
                AND   T.STR_NBR          <> 6666                        13010000
                AND   N.TNDR_TYP_CDE     = '13'                         13020000
2023            AND   N.TNDR_ID_SRC_CDE <> '14'                         13021000
                AND   N.TNDR_VOID_IND    = 'N'                          13030000
           GROUP BY   T.STR_NBR                                         13040000
           ORDER BY   T.STR_NBR                                         13050000
            WITH UR                                                     13060000
           END-EXEC.                                                    13070000
2023                                                                    13080000
2023  ******************************************************************13081000
2023  *  SGT-CURSOR -- CURSOR TO GET SEPHORA GIFT CARDS TENDERED        13082000
2023  ******************************************************************13083000
2023       EXEC SQL                                                     13084000
2023         DECLARE SGT-CURSOR CURSOR FOR                              13085000
2023           SELECT T.STR_NBR                                         13086000
2023                 ,SUM(N.TNDR_AMT)                                   13087000
2023             FROM TEPPART P                                         13088000
2023                 ,TEPTRN  T                                         13089000
2023                 ,TEPTND  N                                         13089100
2023          WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               13089200
2023                                   AND :DK-END-DATE                 13089300
2023            AND   T.PARTN_NBR        = P.PARTN_NBR                  13089400
2023            AND   T.PARTN_NBR        = N.PARTN_NBR                  13089500
2023            AND   T.STR_NBR          = N.STR_NBR                    13089600
2023            AND   T.RGST_ID          = N.RGST_ID                    13089700
2023            AND   T.TRN_NBR          = N.TRN_NBR                    13089800
2023            AND   T.STRT_TM          = N.STRT_TM                    13089900
2023            AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           13090000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             13090101
2023            AND   T.VOID_ABRT_CDE     = 'N'                         13090200
2023            AND   T.STR_NBR          <> 6666                        13090300
2023            AND   N.TNDR_TYP_CDE     = '13'                         13090400
2023            AND   N.TNDR_ID_SRC_CDE  = '14'                         13090500
2023            AND   N.TNDR_VOID_IND    = 'N'                          13090600
2023       GROUP BY   T.STR_NBR                                         13090700
2023       ORDER BY   T.STR_NBR                                         13090800
2023        WITH UR                                                     13090900
2023       END-EXEC.                                                    13091000
2023                                                                    13091100
      ******************************************************************13092000
      *  KMT-CURSOR -- CURSOR TO GET KOHLS MDSE CARDS TENDERED          13100000
      ******************************************************************13110000
           EXEC SQL                                                     13120000
             DECLARE KMT-CURSOR CURSOR FOR                              13130000
               SELECT T.STR_NBR                                         13140000
                     ,SUM(N.TNDR_AMT)                                   13150000
                 FROM TEPPART P                                         13160000
                     ,TEPTRN  T                                         13170000
                     ,TEPTND  N                                         13180000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               13190000
                                       AND :DK-END-DATE                 13200000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  13210000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  13220000
                AND   T.STR_NBR          = N.STR_NBR                    13230000
                AND   T.RGST_ID          = N.RGST_ID                    13240000
                AND   T.TRN_NBR          = N.TRN_NBR                    13250000
                AND   T.STRT_TM          = N.STRT_TM                    13260000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           13270000
                AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             13280000
                AND   T.VOID_ABRT_CDE     = 'N'                         13290000
                AND   T.TRN_TYP_CDE      IN ('01','02')                 13300000
                AND   T.STR_NBR          <> 6666                        13310000
                AND   N.TNDR_TYP_CDE     = '02'                         13320000
                AND   N.TNDR_VOID_IND    = 'N'                          13330000
           GROUP BY   T.STR_NBR                                         13340000
           ORDER BY   T.STR_NBR                                         13350000
            WITH UR                                                     13360000
           END-EXEC.                                                    13370000
                                                                        13380000
      ******************************************************************13390000
      *  KMI-CURSOR -- CURSOR TO GET KOHLS MDSE CARDS ISSUED            13400000
      ******************************************************************13410000
           EXEC SQL                                                     13420000
             DECLARE KMI-CURSOR CURSOR FOR                              13430000
               SELECT T.STR_NBR                                         13440000
                     ,SUM(N.TNDR_AMT)                                   13450000
                 FROM TEPPART P                                         13460000
                     ,TEPTRN  T                                         13470000
                     ,TEPTND  N                                         13480000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               13490000
                                       AND :DK-END-DATE                 13500000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  13510000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  13520000
                AND   T.STR_NBR          = N.STR_NBR                    13530000
                AND   T.RGST_ID          = N.RGST_ID                    13540000
                AND   T.TRN_NBR          = N.TRN_NBR                    13550000
                AND   T.STRT_TM          = N.STRT_TM                    13560000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           13570000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             13580001
                AND   T.VOID_ABRT_CDE     = 'N'                         13590000
                AND   T.TRN_TYP_CDE      IN ('11','12','24','25')       13600000
                AND   T.STR_NBR          <> 6666                        13610000
                AND   N.TNDR_TYP_CDE     = '02'                         13620000
                AND   N.TNDR_VOID_IND    = 'N'                          13630000
           GROUP BY   T.STR_NBR                                         13640000
           ORDER BY   T.STR_NBR                                         13650000
            WITH UR                                                     13660000
           END-EXEC.                                                    13670000
                                                                        13680000
      ******************************************************************13690000
      *  CASH-CURSOR -- CURSOR TO GET CASH TENDERED                     13700000
      ******************************************************************13710000
           EXEC SQL                                                     13720000
             DECLARE CASH-CURSOR CURSOR FOR                             13730000
               SELECT T.STR_NBR                                         13740000
                     ,SUM(N.TNDR_AMT)                                   13750000
                 FROM TEPPART P                                         13760000
                     ,TEPTRN  T                                         13770000
                     ,TEPTND  N                                         13780000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               13790000
                                       AND :DK-END-DATE                 13800000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  13810000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  13820000
                AND   T.STR_NBR          = N.STR_NBR                    13830000
                AND   T.RGST_ID          = N.RGST_ID                    13840000
                AND   T.TRN_NBR          = N.TRN_NBR                    13850000
                AND   T.STRT_TM          = N.STRT_TM                    13860000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           13870000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             13880001
                AND   T.VOID_ABRT_CDE     = 'N'                         13890000
                AND   T.STR_NBR          <> 6666                        13900000
                AND   N.TNDR_TYP_CDE     = '00'                         13910000
                AND   N.TNDR_VOID_IND    = 'N'                          13920000
           GROUP BY   T.STR_NBR                                         13930000
           ORDER BY   T.STR_NBR                                         13940000
            WITH UR                                                     13950000
           END-EXEC.                                                    13960000
                                                                        13970000
      ******************************************************************13980000
      *  CHECK-CURSOR -- CURSOR TO GET CHECKS TENDERED                  13990000
      ******************************************************************14000000
           EXEC SQL                                                     14010000
             DECLARE CHECK-CURSOR CURSOR FOR                            14020000
               SELECT T.STR_NBR                                         14030000
                     ,SUM(N.TNDR_AMT)                                   14040000
                 FROM TEPPART P                                         14050000
                     ,TEPTRN  T                                         14060000
                     ,TEPTND  N                                         14070000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               14080000
                                       AND :DK-END-DATE                 14090000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  14100000
                AND   T.PARTN_NBR        = N.PARTN_NBR                  14110000
                AND   T.STR_NBR          = N.STR_NBR                    14120000
                AND   T.RGST_ID          = N.RGST_ID                    14130000
                AND   T.TRN_NBR          = N.TRN_NBR                    14140000
                AND   T.STRT_TM          = N.STRT_TM                    14150000
                AND   T.SLS_CORR_SEQ_NBR = N.SLS_CORR_SEQ_NBR           14160000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             14170001
                AND   T.VOID_ABRT_CDE     = 'N'                         14180000
                AND   T.STR_NBR          <> 6666                        14190000
                AND   N.TNDR_TYP_CDE     = '01'                         14200000
                AND   N.TNDR_VOID_IND    = 'N'                          14210000
           GROUP BY   T.STR_NBR                                         14220000
           ORDER BY   T.STR_NBR                                         14230000
            WITH UR                                                     14240000
           END-EXEC.                                                    14250000
                                                                        14260000
      ******************************************************************14270000
      *  KCP-CURSOR -- CURSOR TO GET KOHLS CHARGE PAYMENTS              14280000
      ******************************************************************14290000
           EXEC SQL                                                     14300000
             DECLARE KCP-CURSOR CURSOR FOR                              14310000
               SELECT T.STR_NBR                                         14320000
                     ,SUM(Y.PAYT_AMT)                                   14330000
                 FROM TEPPART P                                         14340000
                     ,TEPTRN  T                                         14350000
                     ,TEPPAY  Y                                         14360000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               14370000
                                       AND :DK-END-DATE                 14380000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  14390000
                AND   T.PARTN_NBR        = Y.PARTN_NBR                  14400000
                AND   T.STR_NBR          = Y.STR_NBR                    14410000
                AND   T.RGST_ID          = Y.RGST_ID                    14420000
                AND   T.TRN_NBR          = Y.TRN_NBR                    14430000
                AND   T.STRT_TM          = Y.STRT_TM                    14440000
                AND   T.SLS_CORR_SEQ_NBR = Y.SLS_CORR_SEQ_NBR           14450000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             14460001
                AND   T.VOID_ABRT_CDE    = 'N'                          14470000
                AND   T.STR_NBR         <> 6666                         14480000
2023            AND   Y.COBRND_IND      <> 'Y'                          14481000
           GROUP BY   T.STR_NBR                                         14490000
           ORDER BY   T.STR_NBR                                         14500000
            WITH UR                                                     14510000
           END-EXEC.                                                    14520000
2023                                                                    14530000
2023  ******************************************************************14531000
2023  *  CVP-CURSOR -- CURSOR TO GET COBRAND CHARGE PAYMENTS            14532000
2023  ******************************************************************14533000
2023       EXEC SQL                                                     14534000
2023         DECLARE CVP-CURSOR CURSOR FOR                              14535000
2023           SELECT T.STR_NBR                                         14536000
2023                 ,SUM(Y.PAYT_AMT)                                   14537000
2023             FROM TEPPART P                                         14538000
2023                 ,TEPTRN  T                                         14539000
2023                 ,TEPPAY  Y                                         14539100
2023          WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               14539200
2023                                   AND :DK-END-DATE                 14539300
2023            AND   T.PARTN_NBR        = P.PARTN_NBR                  14539400
2023            AND   T.PARTN_NBR        = Y.PARTN_NBR                  14539500
2023            AND   T.STR_NBR          = Y.STR_NBR                    14539600
2023            AND   T.RGST_ID          = Y.RGST_ID                    14539700
2023            AND   T.TRN_NBR          = Y.TRN_NBR                    14539800
2023            AND   T.STRT_TM          = Y.STRT_TM                    14539900
2023            AND   T.SLS_CORR_SEQ_NBR = Y.SLS_CORR_SEQ_NBR           14540000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             14540101
2023            AND   T.VOID_ABRT_CDE    = 'N'                          14540200
2023            AND   T.STR_NBR          <> 6666                        14540300
2023            AND   Y.COBRND_IND       = 'Y'                          14540400
2023       GROUP BY   T.STR_NBR                                         14540500
2023       ORDER BY   T.STR_NBR                                         14540600
2023        WITH UR                                                     14540700
2023       END-EXEC.                                                    14540800
2023                                                                    14540900
      ******************************************************************14541000
      *  CRI-CURSOR -- CURSOR TO CORPORATE REFUNDS                      14550000
      ******************************************************************14560000
           EXEC SQL                                                     14570000
             DECLARE CRI-CURSOR CURSOR FOR                              14580000
               SELECT T.STR_NBR                                         14590000
                     ,SUM(X.TNDR_AMT)                                   14600000
                 FROM TEPPART P                                         14610000
                     ,TEPTRN  T                                         14620000
                     ,TEPRFN  Y                                         14630000
                     ,TEPTND  X                                         14640000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               14650000
                                       AND :DK-END-DATE                 14660000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  14670000
                AND   T.PARTN_NBR        = Y.PARTN_NBR                  14680000
                AND   T.STR_NBR          = Y.STR_NBR                    14690000
                AND   T.RGST_ID          = Y.RGST_ID                    14700000
                AND   T.TRN_NBR          = Y.TRN_NBR                    14710000
                AND   T.STRT_TM          = Y.STRT_TM                    14720000
                AND   T.SLS_CORR_SEQ_NBR = Y.SLS_CORR_SEQ_NBR           14730000
                AND   T.PARTN_NBR        = X.PARTN_NBR                  14740000
                AND   T.STR_NBR          = X.STR_NBR                    14750000
                AND   T.RGST_ID          = X.RGST_ID                    14760000
                AND   T.TRN_NBR          = X.TRN_NBR                    14770000
                AND   T.STRT_TM          = X.STRT_TM                    14780000
                AND   T.SLS_CORR_SEQ_NBR = X.SLS_CORR_SEQ_NBR           14790000
                AND   Y.TNDR_SEQ_NBR     = X.TNDR_SEQ_NBR               14800000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             14810001
                AND   T.VOID_ABRT_CDE     = 'N'                         14820000
                AND   T.STR_NBR          <> 6666                        14830000
           GROUP BY   T.STR_NBR                                         14840000
           ORDER BY   T.STR_NBR                                         14850000
            WITH UR                                                     14860000
           END-EXEC.                                                    14870000
                                                                        14880000
      ******************************************************************14890000
      *  EMPDISC-CURSOR -- CURSOR TO GET EMPLOYEE DISCOUNTS             14900000
      ******************************************************************14910000
           EXEC SQL                                                     14920000
             DECLARE EMPDISC-CURSOR CURSOR FOR                          14930000
               SELECT T.STR_NBR                                         14940000
                     ,SUM(E.EMP_DISC_AMT)                               14950000
                 FROM TEPPART P                                         14960000
                     ,TEPTRN  T                                         14970000
                     ,TEPITM  I                                         14980000
                     ,TEPEID  E                                         14990000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               15000000
                                       AND :DK-END-DATE                 15010000
                AND   T.PARTN_NBR        = P.PARTN_NBR                  15020000
                AND   T.PARTN_NBR        = I.PARTN_NBR                  15030000
                AND   T.STR_NBR          = I.STR_NBR                    15040000
                AND   T.RGST_ID          = I.RGST_ID                    15050000
                AND   T.TRN_NBR          = I.TRN_NBR                    15060000
                AND   T.STRT_TM          = I.STRT_TM                    15070000
                AND   T.SLS_CORR_SEQ_NBR = I.SLS_CORR_SEQ_NBR           15080000
                AND   I.PARTN_NBR        = E.PARTN_NBR                  15090000
                AND   I.STR_NBR          = E.STR_NBR                    15100000
                AND   I.RGST_ID          = E.RGST_ID                    15110000
                AND   I.TRN_NBR          = E.TRN_NBR                    15120000
                AND   I.STRT_TM          = E.STRT_TM                    15130000
                AND   I.SLS_CORR_SEQ_NBR = E.SLS_CORR_SEQ_NBR           15140000
                AND   I.LNE_ITM_SEQ_NBR  = E.LNE_ITM_SEQ_NBR            15150000
2024            AND   T.TRN_STAT_CDE     IN ('Z', 'L', 'V')             15160001
                AND   T.VOID_ABRT_CDE     = 'N'                         15170000
                AND   I.LIV_RSLU_CDE     IN ('+', '-')                  15180000
                AND   T.STR_NBR          <> 6666                        15190000
           GROUP BY   T.STR_NBR                                         15200000
           ORDER BY   T.STR_NBR                                         15210000
            WITH UR                                                     15220000
           END-EXEC.                                                    15230000
                                                                        15240000
      ******************************************************************15250000
      *  KKT-CURSOR -- CURSOR TO GET KOHL'S CARES FOR KIDS CARDS        15260000
      *        NOTE -- TO GET ACTUAL KKT TOTAL, TENDER ID NEEDS TO BE   15270000
      *                DETOKENIZED SO THAT IT CAN BE LOOKED UP IN SV    15280000
      *                TABLES TO DETERMINE WHAT TYPE OF GIFT CARD IT IS.15290000
      ******************************************************************15300000
           EXEC SQL                                                     15310000
             DECLARE KKT-CURSOR CURSOR FOR                              15320000
               SELECT S.STR_NBR                                         15330000
                     ,SUM(S.CTG_AMT)                                    15340000
                 FROM TEPPART P                                         15350000
                     ,TSASUM  S                                         15360000
              WHERE   P.SLS_DTE    BETWEEN :DK-BEGIN-DATE               15370000
                                       AND :DK-END-DATE                 15380000
                AND   P.PARTN_NBR        = S.PARTN_NBR                  15390000
                AND   S.STR_NBR          <> 6666                        15400000
                AND   S.SUM_CTG_CDE       = 'KKT'                       15410000
                AND   S.RGST_ID           =  0                          15420000
           GROUP BY   S.STR_NBR                                         15430000
           ORDER BY   S.STR_NBR                                         15440000
            WITH UR                                                     15450000
           END-EXEC.                                                    15460000
                                                                        15470000
                                                                        15480000
       PROCEDURE DIVISION.                                              15490000
      ******************************************************************15500000
      * MAINLINE                                                        15510000
      ******************************************************************15520000
       0000-MAINLINE-PARAGRAPH.                                         15530000
                                                                        15540000
           PERFORM 1000-INITIALIZE-PROGRAM.                             15550000
                                                                        15560000
      **   PERFORM 2000-PROCESS-GL-FILE-IN.                             15570000
                                                                        15580000
           PERFORM 3000-PROCESS-QUERIES.                                15590000
                                                                        15600000
           PERFORM 4000-WRITE-GL-RECORDS.                               15610000
                                                                        15620000
           PERFORM 9900-END-PROC.                                       15630000
                                                                        15640000
           STOP RUN.                                                    15650000
                                                                        15660000
                                                                        15670000
      ******************************************************************15680000
      * OPEN FILES, PROCESS CONTROL CARD, INITIALIZE WS TABLE.          15690000
      ******************************************************************15700000
       1000-INITIALIZE-PROGRAM.                                         15710000
                                                                        15720000
           OPEN INPUT  DATE-FILE-IN.                                    15730000
      **   OPEN INPUT  GL-FILE-IN.                                      15740000
           OPEN OUTPUT GL-CSV-FILE-OUT.                                 15750000
                                                                        15760000
           PERFORM 1100-PROCESS-DATE-CONTROL-CARD.                      15770000
                                                                        15780000
           INITIALIZE GL-RECORD-TABLE.                                  15790000
                                                                        15800000
      ******************************************************************15810000
      * READ CONTROL CARD TO GET START AND END DATES.                   15820000
      * CALL DATE ROUTINE TO VALIDATE BOTH DATES.                       15830000
      ******************************************************************15840000
       1100-PROCESS-DATE-CONTROL-CARD.                                  15850000
                                                                        15860000
           PERFORM 1110-READ-DATE-FILE.                                 15870000
                                                                        15880000
           IF PS-END-OF-DATE-FILE                                       15890000
               MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   15900000
               MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  15910000
                                                                        15920000
               SET ABEND-4003-CTRL-CARD-ERROR TO TRUE                   15930000
               PERFORM 9200-ABEND                                       15940000
           END-IF.                                                      15950000
                                                                        15960000
           CLOSE DATE-FILE-IN.                                          15970000
                                                                        15980000
                                                                        15990000
      ******************************************************************16000000
      * READ DATE CONTROL CARD.                                         16010000
      ******************************************************************16020000
       1110-READ-DATE-FILE.                                             16030000
                                                                        16040000
           READ DATE-FILE-IN INTO CC-CONTROL-CARD                       16050000
              AT END                                                    16060000
                  SET PS-END-OF-DATE-FILE TO TRUE                       16070000
              NOT AT END                                                16080000
                  MOVE CC-START-DATE        TO PV-DPG52-LK-DATE-INPUT   16090000
                  PERFORM 1125-VALIDATE-INPUT-DATE                      16100000
                  MOVE CC-START-DATE        TO DK-BEGIN-DATE            16110000
                                                                        16120000
                  MOVE CC-END-DATE          TO PV-DPG52-LK-DATE-INPUT   16130000
                  PERFORM 1125-VALIDATE-INPUT-DATE                      16140000
                  MOVE CC-END-DATE          TO DK-END-DATE              16150000
                                                                        16160000
                  DISPLAY '** CONTROL CARD = ' CC-CONTROL-CARD.         16170000
                                                                        16180000
                                                                        16190000
      ******************************************************************16200000
      * CALL KOHLS CALENDAR ROUTINE:                                    16210000
      *     PASS: CONTROL CARD DATE (CCYY-MM-DD FORMAT).                16220000
      *   RETURN: ACTUAL CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT).     16230000
      ******************************************************************16240000
       1125-VALIDATE-INPUT-DATE.                                        16250000
                                                                        16260000
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              16270000
                                                                        16280000
           SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   16290000
           SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   16300000
           SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   16310000
                                                                        16320000
           MOVE PV-DPG52-LK-DATE-INPUT       TO DPG52-LK-DATE-INPUT.    16330000
                                                                        16340000
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    16350000
                                                   DPG54 DPG55 DPG56.   16360000
           EVALUATE TRUE                                                16370000
               WHEN DPG54-SEVERE-ERROR                                  16380000
               WHEN DPG54-DATE-INVALID                                  16390000
                   MOVE '1125-VALIDATE-INPUT-DATE'                      16400000
                                             TO PV-PARAGRAPH-NAME       16410000
                   MOVE 'ERROR CONVERTING INPUT CARD DATE'              16420000
                                             TO PV-OPERATION-MSG-1      16430000
                   SET ABEND-4019-CAL-SUB-ERROR                         16440000
                                             TO TRUE                    16450000
                   MOVE DPG54-ERROR-MESSAGE                             16460000
                                             TO PV-OPERATION-MSG-2      16470000
                   PERFORM 9200-ABEND                                   16480000
           END-EVALUATE.                                                16490000
                                                                        16500000
                                                                        16510000
      ******************************************************************16520000
      * 2000-PROCESS                                                    16530000
      *     - OPEN, FETCH & CLOSE CURSORS                               16540000
      *     - MOVE THE RESULTS TO THE GL WS TABLE.                      16550000
      ******************************************************************16560000
       3000-PROCESS-QUERIES.                                            16570000
                                                                        16580000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16590000
           PERFORM 3005-OPEN-SALES-CURSOR.                              16600000
           PERFORM 3010-FETCH-SALES-CURSOR                              16610000
              UNTIL PS-END-OF-CURSOR.                                   16620000
           PERFORM 3015-CLOSE-SALES-CURSOR.                             16630000
                                                                        16640000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16650000
           PERFORM 3020-OPEN-RETURNS-CURSOR.                            16660000
           PERFORM 3025-FETCH-RETURNS-CURSOR                            16670000
              UNTIL PS-END-OF-CURSOR.                                   16680000
           PERFORM 3030-CLOSE-RETURNS-CURSOR.                           16690000
                                                                        16700000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16710000
           PERFORM 3035-OPEN-GDS-CURSOR.                                16720000
           PERFORM 3040-FETCH-GDS-CURSOR                                16730000
              UNTIL PS-END-OF-CURSOR.                                   16740000
           PERFORM 3045-CLOSE-GDS-CURSOR.                               16750000
                                                                        16760000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16770000
           PERFORM 3050-OPEN-TPC-CURSOR.                                16780000
           PERFORM 3055-FETCH-TPC-CURSOR                                16790000
              UNTIL PS-END-OF-CURSOR.                                   16800000
           PERFORM 3060-CLOSE-TPC-CURSOR.                               16810000
                                                                        16820000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16830000
           PERFORM 3065-OPEN-TCC-CURSOR.                                16840000
           PERFORM 3070-FETCH-TCC-CURSOR                                16850000
              UNTIL PS-END-OF-CURSOR.                                   16860000
           PERFORM 3075-CLOSE-TCC-CURSOR.                               16870000
                                                                        16880000
2023       SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16881000
2023       PERFORM 3500-OPEN-SGS-CURSOR.                                16882000
2023       PERFORM 3505-FETCH-SGS-CURSOR                                16883000
2023          UNTIL PS-END-OF-CURSOR.                                   16884000
2023       PERFORM 3510-CLOSE-SGS-CURSOR.                               16885000
2023                                                                    16886000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16890000
           PERFORM 3080-OPEN-BOS-CURSOR.                                16900000
           PERFORM 3085-FETCH-BOS-CURSOR                                16910000
              UNTIL PS-END-OF-CURSOR.                                   16920000
           PERFORM 3090-CLOSE-BOS-CURSOR.                               16930000
                                                                        16940000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           16950000
           PERFORM 3095-OPEN-BPS-CURSOR.                                16960000
           PERFORM 3100-FETCH-BPS-CURSOR                                16970000
              UNTIL PS-END-OF-CURSOR.                                   16980000
           PERFORM 3105-CLOSE-BPS-CURSOR.                               16990000
                                                                        17000000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17010000
           PERFORM 3110-OPEN-SFS-CURSOR.                                17020000
           PERFORM 3115-FETCH-SFS-CURSOR                                17030000
              UNTIL PS-END-OF-CURSOR.                                   17040000
           PERFORM 3120-CLOSE-SFS-CURSOR.                               17050000
                                                                        17060000
2023       SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17061000
2023       PERFORM 3515-OPEN-MKT-CURSOR.                                17062000
2023       PERFORM 3520-FETCH-MKT-CURSOR                                17063000
2023          UNTIL PS-END-OF-CURSOR.                                   17064000
2023       PERFORM 3525-CLOSE-MKT-CURSOR.                               17065000
2023                                                                    17066000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17070000
           PERFORM 3125-OPEN-BSR-CURSOR.                                17080000
           PERFORM 3130-FETCH-BSR-CURSOR                                17090000
              UNTIL PS-END-OF-CURSOR.                                   17100000
           PERFORM 3135-CLOSE-BSR-CURSOR.                               17110000
                                                                        17120000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17130000
           PERFORM 3140-OPEN-BPR-CURSOR.                                17140000
           PERFORM 3145-FETCH-BPR-CURSOR                                17150000
              UNTIL PS-END-OF-CURSOR.                                   17160000
           PERFORM 3150-CLOSE-BPR-CURSOR.                               17170000
                                                                        17180000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17190000
           PERFORM 3155-OPEN-KKB-CURSOR.                                17200000
           PERFORM 3160-FETCH-KKB-CURSOR                                17210000
              UNTIL PS-END-OF-CURSOR.                                   17220000
           PERFORM 3165-CLOSE-KKB-CURSOR.                               17230000
                                                                        17240000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17250000
           PERFORM 3170-OPEN-KKH-CURSOR.                                17260000
           PERFORM 3175-FETCH-KKH-CURSOR                                17270000
              UNTIL PS-END-OF-CURSOR.                                   17280000
           PERFORM 3180-CLOSE-KKH-CURSOR.                               17290000
                                                                        17300000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17310000
           PERFORM 3185-OPEN-KKS-CURSOR.                                17320000
           PERFORM 3190-FETCH-KKS-CURSOR                                17330000
              UNTIL PS-END-OF-CURSOR.                                   17340000
           PERFORM 3195-CLOSE-KKS-CURSOR.                               17350000
                                                                        17360000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17370000
           PERFORM 3200-OPEN-KKU-CURSOR.                                17380000
           PERFORM 3205-FETCH-KKU-CURSOR                                17390000
              UNTIL PS-END-OF-CURSOR.                                   17400000
           PERFORM 3210-CLOSE-KKU-CURSOR.                               17410000
                                                                        17420000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17430000
           PERFORM 3215-OPEN-SHS-CURSOR.                                17440000
           PERFORM 3220-FETCH-SHS-CURSOR                                17450000
              UNTIL PS-END-OF-CURSOR.                                   17460000
           PERFORM 3225-CLOSE-SHS-CURSOR.                               17470000
                                                                        17480000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17490000
           PERFORM 3230-OPEN-ECR-CURSOR.                                17500000
           PERFORM 3235-FETCH-ECR-CURSOR                                17510000
              UNTIL PS-END-OF-CURSOR.                                   17520000
           PERFORM 3240-CLOSE-ECR-CURSOR.                               17530000
                                                                        17540000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17550000
           PERFORM 3245-OPEN-SHR-CURSOR.                                17560000
           PERFORM 3250-FETCH-SHR-CURSOR                                17570000
              UNTIL PS-END-OF-CURSOR.                                   17580000
           PERFORM 3255-CLOSE-SHR-CURSOR.                               17590000
                                                                        17600000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17610000
           PERFORM 3260-OPEN-TAX-CURSOR.                                17620000
           PERFORM 3265-FETCH-TAX-CURSOR                                17630000
              UNTIL PS-END-OF-CURSOR.                                   17640000
           PERFORM 3270-CLOSE-TAX-CURSOR.                               17650000
                                                                        17660000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17670000
           PERFORM 3275-OPEN-FEE-CURSOR.                                17680000
           PERFORM 3280-FETCH-FEE-CURSOR                                17690000
              UNTIL PS-END-OF-CURSOR.                                   17700000
           PERFORM 3285-CLOSE-FEE-CURSOR.                               17710000
                                                                        17720000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17730000
           PERFORM 3290-OPEN-AEN-CURSOR.                                17740000
           PERFORM 3295-FETCH-AEN-CURSOR                                17750000
              UNTIL PS-END-OF-CURSOR.                                   17760000
           PERFORM 3300-CLOSE-AEN-CURSOR.                               17770000
                                                                        17780000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17790000
           PERFORM 3305-OPEN-BCN-CURSOR.                                17800000
           PERFORM 3310-FETCH-BCN-CURSOR                                17810000
              UNTIL PS-END-OF-CURSOR.                                   17820000
           PERFORM 3315-CLOSE-BCN-CURSOR.                               17830000
                                                                        17840000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17850000
           PERFORM 3320-OPEN-DBN-CURSOR.                                17860000
           PERFORM 3325-FETCH-DBN-CURSOR                                17870000
              UNTIL PS-END-OF-CURSOR.                                   17880000
           PERFORM 3330-CLOSE-DBN-CURSOR.                               17890000
                                                                        17900000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17910000
           PERFORM 3335-OPEN-KCN-CURSOR.                                17920000
           PERFORM 3340-FETCH-KCN-CURSOR                                17930000
              UNTIL PS-END-OF-CURSOR.                                   17940000
           PERFORM 3345-CLOSE-KCN-CURSOR.                               17950000
                                                                        17960000
2023       SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17961000
2023       PERFORM 3530-OPEN-CVN-CURSOR.                                17962000
2023       PERFORM 3535-FETCH-CVN-CURSOR                                17963000
2023          UNTIL PS-END-OF-CURSOR.                                   17964000
2023       PERFORM 3540-CLOSE-CVN-CURSOR.                               17965000
2023                                                                    17966000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           17970000
           PERFORM 3350-OPEN-NCN-CURSOR.                                17980000
           PERFORM 3355-FETCH-NCN-CURSOR                                17990000
              UNTIL PS-END-OF-CURSOR.                                   18000000
           PERFORM 3360-CLOSE-NCN-CURSOR.                               18010000
                                                                        18020000
2023       SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18021000
2023       PERFORM 3575-OPEN-PPN-CURSOR.                                18022000
2023       PERFORM 3580-FETCH-PPN-CURSOR                                18023000
2023          UNTIL PS-END-OF-CURSOR.                                   18024000
2023       PERFORM 3585-CLOSE-PPN-CURSOR.                               18025000
2023                                                                    18026000
2023       SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18027000
2023       PERFORM 3590-OPEN-VMN-CURSOR.                                18028000
2023       PERFORM 3595-FETCH-VMN-CURSOR                                18029000
2023          UNTIL PS-END-OF-CURSOR.                                   18029100
2023       PERFORM 3600-CLOSE-VMN-CURSOR.                               18029200
2023                                                                    18029300
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18030000
           PERFORM 3365-OPEN-GDT-CURSOR.                                18040000
           PERFORM 3370-FETCH-GDT-CURSOR                                18050000
              UNTIL PS-END-OF-CURSOR.                                   18060000
           PERFORM 3375-CLOSE-GDT-CURSOR.                               18070000
                                                                        18080000
2023       SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18081000
2023       PERFORM 3545-OPEN-SGT-CURSOR.                                18082000
2023       PERFORM 3550-FETCH-SGT-CURSOR                                18083000
2023          UNTIL PS-END-OF-CURSOR.                                   18084000
2023       PERFORM 3555-CLOSE-SGT-CURSOR.                               18085000
2023                                                                    18086000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18090000
           PERFORM 3380-OPEN-KMT-CURSOR.                                18100000
           PERFORM 3385-FETCH-KMT-CURSOR                                18110000
              UNTIL PS-END-OF-CURSOR.                                   18120000
           PERFORM 3390-CLOSE-KMT-CURSOR.                               18130000
                                                                        18140000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18150000
           PERFORM 3395-OPEN-KMI-CURSOR.                                18160000
           PERFORM 3400-FETCH-KMI-CURSOR                                18170000
              UNTIL PS-END-OF-CURSOR.                                   18180000
           PERFORM 3405-CLOSE-KMI-CURSOR.                               18190000
                                                                        18200000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18210000
           PERFORM 3410-OPEN-CASH-CURSOR.                               18220000
           PERFORM 3415-FETCH-CASH-CURSOR                               18230000
              UNTIL PS-END-OF-CURSOR.                                   18240000
           PERFORM 3420-CLOSE-CASH-CURSOR.                              18250000
                                                                        18260000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18270000
           PERFORM 3425-OPEN-CHECK-CURSOR.                              18280000
           PERFORM 3430-FETCH-CHECK-CURSOR                              18290000
              UNTIL PS-END-OF-CURSOR.                                   18300000
           PERFORM 3435-CLOSE-CHECK-CURSOR.                             18310000
                                                                        18320000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18330000
           PERFORM 3440-OPEN-KCP-CURSOR.                                18340000
           PERFORM 3445-FETCH-KCP-CURSOR                                18350000
              UNTIL PS-END-OF-CURSOR.                                   18360000
           PERFORM 3450-CLOSE-KCP-CURSOR.                               18370000
                                                                        18380000
2023       SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18381000
2023       PERFORM 3560-OPEN-CVP-CURSOR.                                18382000
2023       PERFORM 3565-FETCH-CVP-CURSOR                                18383000
2023          UNTIL PS-END-OF-CURSOR.                                   18384000
2023       PERFORM 3570-CLOSE-CVP-CURSOR.                               18385000
2023                                                                    18386000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18390000
           PERFORM 3455-OPEN-CRI-CURSOR.                                18400000
           PERFORM 3460-FETCH-CRI-CURSOR                                18410000
              UNTIL PS-END-OF-CURSOR.                                   18420000
           PERFORM 3465-CLOSE-CRI-CURSOR.                               18430000
                                                                        18440000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18450000
           PERFORM 3470-OPEN-EMPDISC-CURSOR.                            18460000
           PERFORM 3475-FETCH-EMPDISC-CURSOR                            18470000
              UNTIL PS-END-OF-CURSOR.                                   18480000
           PERFORM 3480-CLOSE-EMPDISC-CURSOR.                           18490000
                                                                        18500000
           SET PS-NOT-END-OF-CURSOR  TO TRUE.                           18510000
           PERFORM 3485-OPEN-KKT-CURSOR.                                18520000
           PERFORM 3490-FETCH-KKT-CURSOR                                18530000
              UNTIL PS-END-OF-CURSOR.                                   18540000
           PERFORM 3495-CLOSE-KKT-CURSOR.                               18550000
                                                                        18560000
      ******************************************************************18570000
      *  OPEN THE SALES-CURSOR                                          18580000
      ******************************************************************18590000
       3005-OPEN-SALES-CURSOR.                                          18600000
                                                                        18610000
           EXEC SQL                                                     18620000
                OPEN SALES-CURSOR                                       18630000
           END-EXEC.                                                    18640000
                                                                        18650000
           EVALUATE TRUE                                                18660000
               WHEN SQLCODE = ZERO                                      18670000
                   CONTINUE                                             18680000
               WHEN SQLWARN0 NOT EQUAL SPACE                            18690000
               WHEN SQLCODE NOT EQUAL ZERO                              18700000
                   MOVE SQLCODE TO PV-SQL                               18710000
                   MOVE '3005-OPEN-SALES-CURSOR' TO PV-PARAGRAPH-NAME   18720000
                   STRING 'ERROR OPENING SALES-CURSOR - SQLCODE = '     18730000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG18740000
                   END-STRING                                           18750000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    18760000
                   PERFORM 9100-SQL-ABEND                               18770000
           END-EVALUATE.                                                18780000
                                                                        18790000
      ******************************************************************18800000
      *  FETCH THE SALES CURSOR.                                        18810000
      ******************************************************************18820000
       3010-FETCH-SALES-CURSOR.                                         18830000
                                                                        18840000
           EXEC SQL                                                     18850000
                FETCH SALES-CURSOR                                      18860000
                 INTO :PV-STR-NBR                                       18870000
                     ,:PV-DB2-SUM                                       18880000
           END-EXEC.                                                    18890000
                                                                        18900000
           EVALUATE TRUE                                                18910000
               WHEN SQLCODE = ZERO                                      18920000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        18930000
                   MOVE PV-DB2-SUM   TO GL-WS-SALES (PV-STR-NBR)        18940000
                   ADD 1 TO PA-SALES-CURSOR-CNT                         18950000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          18960000
                   SET PS-END-OF-CURSOR TO TRUE                         18970000
               WHEN SQLWARN0 NOT EQUAL SPACE                            18980000
               WHEN SQLCODE NOT EQUAL ZERO                              18990000
                   MOVE SQLCODE TO PV-SQL                               19000000
                   MOVE '3010-FETCH-SALES-CURSOR' TO PV-PARAGRAPH-NAME  19010000
                   STRING 'ERROR FETCHING SALES-CURSOR - SQLCODE = '    19020000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG19030000
                   END-STRING                                           19040000
                   SET ABEND-4002-READ-ERROR TO TRUE                    19050000
                   PERFORM 9100-SQL-ABEND                               19060000
           END-EVALUATE.                                                19070000
                                                                        19080000
      ******************************************************************19090000
      *  CLOSE THE SUM CURSOR.                                          19100000
      ******************************************************************19110000
       3015-CLOSE-SALES-CURSOR.                                         19120000
                                                                        19130000
           EXEC SQL                                                     19140000
                CLOSE SALES-CURSOR                                      19150000
           END-EXEC.                                                    19160000
                                                                        19170000
           EVALUATE TRUE                                                19180000
               WHEN SQLCODE = ZERO                                      19190000
                    CONTINUE                                            19200000
               WHEN SQLWARN0 NOT EQUAL SPACE                            19210000
               WHEN SQLCODE NOT EQUAL ZERO                              19220000
                   MOVE SQLCODE TO PV-SQL                               19230000
                   MOVE '3015-CLOSE-SALES-CURSOR' TO PV-PARAGRAPH-NAME  19240000
                   STRING 'ERROR CLOSING SALES-CURSOR - SQLCODE = '     19250000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG19260000
                   END-STRING                                           19270000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   19280000
                   PERFORM 9100-SQL-ABEND                               19290000
           END-EVALUATE.                                                19300000
                                                                        19310000
                                                                        19320000
      ******************************************************************19330000
      *  OPEN THE RETURNS-CURSOR                                        19340000
      ******************************************************************19350000
       3020-OPEN-RETURNS-CURSOR.                                        19360000
                                                                        19370000
           EXEC SQL                                                     19380000
                OPEN RETURNS-CURSOR                                     19390000
           END-EXEC.                                                    19400000
                                                                        19410000
           EVALUATE TRUE                                                19420000
               WHEN SQLCODE = ZERO                                      19430000
                   CONTINUE                                             19440000
               WHEN SQLWARN0 NOT EQUAL SPACE                            19450000
               WHEN SQLCODE NOT EQUAL ZERO                              19460000
                   MOVE SQLCODE TO PV-SQL                               19470000
                   MOVE '3020-OPEN-RETURNS-CURSOR' TO PV-PARAGRAPH-NAME 19480000
                   STRING 'ERROR OPENING RETURNS-CURSOR - SQLCODE = '   19490000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG19500000
                   END-STRING                                           19510000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    19520000
                   PERFORM 9100-SQL-ABEND                               19530000
           END-EVALUATE.                                                19540000
                                                                        19550000
                                                                        19560000
      ******************************************************************19570000
      *  FETCH THE RETURNS CURSOR.                                      19580000
      ******************************************************************19590000
       3025-FETCH-RETURNS-CURSOR.                                       19600000
                                                                        19610000
           EXEC SQL                                                     19620000
                FETCH RETURNS-CURSOR                                    19630000
                 INTO :PV-STR-NBR                                       19640000
                     ,:PV-DB2-SUM                                       19650000
           END-EXEC.                                                    19660000
                                                                        19670000
           EVALUATE TRUE                                                19680000
               WHEN SQLCODE = ZERO                                      19690000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        19700000
                   MOVE PV-DB2-SUM   TO GL-WS-RETURNS (PV-STR-NBR)      19710000
                   ADD 1 TO PA-RETURNS-CURSOR-CNT                       19720000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          19730000
                   SET PS-END-OF-CURSOR TO TRUE                         19740000
               WHEN SQLWARN0 NOT EQUAL SPACE                            19750000
               WHEN SQLCODE NOT EQUAL ZERO                              19760000
                   MOVE SQLCODE TO PV-SQL                               19770000
                   MOVE '3025-FETCH-RETURNS-CURSOR' TO PV-PARAGRAPH-NAME19780000
                   STRING 'ERROR FETCHING RETURNS-CURSOR - SQLCODE = '  19790000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG19800000
                   END-STRING                                           19810000
                   SET ABEND-4002-READ-ERROR TO TRUE                    19820000
                   PERFORM 9100-SQL-ABEND                               19830000
           END-EVALUATE.                                                19840000
                                                                        19850000
                                                                        19860000
      ******************************************************************19870000
      *  CLOSE THE RETURNS CURSOR.                                      19880000
      ******************************************************************19890000
       3030-CLOSE-RETURNS-CURSOR.                                       19900000
                                                                        19910000
           EXEC SQL                                                     19920000
                CLOSE RETURNS-CURSOR                                    19930000
           END-EXEC.                                                    19940000
                                                                        19950000
           EVALUATE TRUE                                                19960000
               WHEN SQLCODE = ZERO                                      19970000
                    CONTINUE                                            19980000
               WHEN SQLWARN0 NOT EQUAL SPACE                            19990000
               WHEN SQLCODE NOT EQUAL ZERO                              20000000
                   MOVE SQLCODE TO PV-SQL                               20010000
                   MOVE '3030-CLOSE-RETURNS-CURSOR' TO PV-PARAGRAPH-NAME20020000
                   STRING 'ERROR CLOSING RETURNS-CURSOR - SQLCODE = '   20030000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG20040000
                   END-STRING                                           20050000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   20060000
                   PERFORM 9100-SQL-ABEND                               20070000
           END-EVALUATE.                                                20080000
                                                                        20090000
      ******************************************************************20100000
      *  OPEN THE GDS-CURSOR                                            20110000
      ******************************************************************20120000
       3035-OPEN-GDS-CURSOR.                                            20130000
                                                                        20140000
           EXEC SQL                                                     20150000
                OPEN GDS-CURSOR                                         20160000
           END-EXEC.                                                    20170000
                                                                        20180000
           EVALUATE TRUE                                                20190000
               WHEN SQLCODE = ZERO                                      20200000
                   CONTINUE                                             20210000
               WHEN SQLWARN0 NOT EQUAL SPACE                            20220000
               WHEN SQLCODE NOT EQUAL ZERO                              20230000
                   MOVE SQLCODE TO PV-SQL                               20240000
                   MOVE '3035-OPEN-GDS-CURSOR' TO PV-PARAGRAPH-NAME     20250000
                   STRING 'ERROR OPENING GDS-CURSOR - SQLCODE = '       20260000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG20270000
                   END-STRING                                           20280000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    20290000
                   PERFORM 9100-SQL-ABEND                               20300000
           END-EVALUATE.                                                20310000
                                                                        20320000
      ******************************************************************20330000
      *  FETCH THE GDS CURSOR.                                          20340000
      ******************************************************************20350000
       3040-FETCH-GDS-CURSOR.                                           20360000
                                                                        20370000
           EXEC SQL                                                     20380000
                FETCH GDS-CURSOR                                        20390000
                 INTO :PV-STR-NBR                                       20400000
                     ,:PV-DB2-SUM                                       20410000
           END-EXEC.                                                    20420000
                                                                        20430000
           EVALUATE TRUE                                                20440000
               WHEN SQLCODE = ZERO                                      20450000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        20460000
                   MOVE PV-DB2-SUM   TO GL-WS-GDS (PV-STR-NBR)          20470000
                   ADD 1 TO PA-GDS-CURSOR-CNT                           20480000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          20490000
                   SET PS-END-OF-CURSOR  TO TRUE                        20500000
               WHEN SQLWARN0 NOT EQUAL SPACE                            20510000
               WHEN SQLCODE NOT EQUAL ZERO                              20520000
                   MOVE SQLCODE TO PV-SQL                               20530000
                   MOVE '3040-FETCH-GDS-CURSOR' TO PV-PARAGRAPH-NAME    20540000
                   STRING 'ERROR FETCHING GDS-CURSOR - SQLCODE = '      20550000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG20560000
                   END-STRING                                           20570000
                   SET ABEND-4002-READ-ERROR TO TRUE                    20580000
                   PERFORM 9100-SQL-ABEND                               20590000
           END-EVALUATE.                                                20600000
                                                                        20610000
                                                                        20620000
      ******************************************************************20630000
      *  CLOSE THE GDS CURSOR.                                          20640000
      ******************************************************************20650000
       3045-CLOSE-GDS-CURSOR.                                           20660000
                                                                        20670000
           EXEC SQL                                                     20680000
                CLOSE GDS-CURSOR                                        20690000
           END-EXEC.                                                    20700000
                                                                        20710000
           EVALUATE TRUE                                                20720000
               WHEN SQLCODE = ZERO                                      20730000
                    CONTINUE                                            20740000
               WHEN SQLWARN0 NOT EQUAL SPACE                            20750000
               WHEN SQLCODE NOT EQUAL ZERO                              20760000
                   MOVE SQLCODE TO PV-SQL                               20770000
                   MOVE '3045-CLOSE-GDS-CURSOR' TO PV-PARAGRAPH-NAME    20780000
                   STRING 'ERROR CLOSING GDS-CURSOR - SQLCODE = '       20790000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG20800000
                   END-STRING                                           20810000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   20820000
                   PERFORM 9100-SQL-ABEND                               20830000
           END-EVALUATE.                                                20840000
                                                                        20850000
                                                                        20860000
      ******************************************************************20870000
      *  OPEN THE TPC-CURSOR                                            20880000
      ******************************************************************20890000
       3050-OPEN-TPC-CURSOR.                                            20900000
                                                                        20910000
           EXEC SQL                                                     20920000
                OPEN TPC-CURSOR                                         20930000
           END-EXEC.                                                    20940000
                                                                        20950000
           EVALUATE TRUE                                                20960000
               WHEN SQLCODE = ZERO                                      20970000
                   CONTINUE                                             20980000
               WHEN SQLWARN0 NOT EQUAL SPACE                            20990000
               WHEN SQLCODE NOT EQUAL ZERO                              21000000
                   MOVE SQLCODE TO PV-SQL                               21010000
                   MOVE '3050-OPEN-TPC-CURSOR' TO PV-PARAGRAPH-NAME     21020000
                   STRING 'ERROR OPENING TPC-CURSOR - SQLCODE = '       21030000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG21040000
                   END-STRING                                           21050000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    21060000
                   PERFORM 9100-SQL-ABEND                               21070000
           END-EVALUATE.                                                21080000
                                                                        21090000
      ******************************************************************21100000
      *  FETCH THE TPC CURSOR.                                          21110000
      ******************************************************************21120000
       3055-FETCH-TPC-CURSOR.                                           21130000
                                                                        21140000
           EXEC SQL                                                     21150000
                FETCH TPC-CURSOR                                        21160000
                 INTO :PV-STR-NBR                                       21170000
                     ,:PV-DB2-SUM                                       21180000
           END-EXEC.                                                    21190000
                                                                        21200000
           EVALUATE TRUE                                                21210000
               WHEN SQLCODE = ZERO                                      21220000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        21230000
                   MOVE PV-DB2-SUM   TO GL-WS-TPC (PV-STR-NBR)          21240000
                   ADD 1 TO PA-TPC-CURSOR-CNT                           21250000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          21260000
                   SET PS-END-OF-CURSOR  TO TRUE                        21270000
               WHEN SQLWARN0 NOT EQUAL SPACE                            21280000
               WHEN SQLCODE NOT EQUAL ZERO                              21290000
                   MOVE SQLCODE TO PV-SQL                               21300000
                   MOVE '3055-FETCH-TPC-CURSOR' TO PV-PARAGRAPH-NAME    21310000
                   STRING 'ERROR FETCHING TPC-CURSOR - SQLCODE = '      21320000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG21330000
                   END-STRING                                           21340000
                   SET ABEND-4002-READ-ERROR TO TRUE                    21350000
                   PERFORM 9100-SQL-ABEND                               21360000
           END-EVALUATE.                                                21370000
                                                                        21380000
                                                                        21390000
      ******************************************************************21400000
      *  CLOSE THE TPC CURSOR.                                          21410000
      ******************************************************************21420000
       3060-CLOSE-TPC-CURSOR.                                           21430000
                                                                        21440000
           EXEC SQL                                                     21450000
                CLOSE TPC-CURSOR                                        21460000
           END-EXEC.                                                    21470000
                                                                        21480000
           EVALUATE TRUE                                                21490000
               WHEN SQLCODE = ZERO                                      21500000
                    CONTINUE                                            21510000
               WHEN SQLWARN0 NOT EQUAL SPACE                            21520000
               WHEN SQLCODE NOT EQUAL ZERO                              21530000
                   MOVE SQLCODE TO PV-SQL                               21540000
                   MOVE '3060-CLOSE-TPC-CURSOR' TO PV-PARAGRAPH-NAME    21550000
                   STRING 'ERROR CLOSING TPC-CURSOR - SQLCODE = '       21560000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG21570000
                   END-STRING                                           21580000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   21590000
                   PERFORM 9100-SQL-ABEND                               21600000
           END-EVALUATE.                                                21610000
                                                                        21620000
                                                                        21630000
      ******************************************************************21640000
      *  OPEN THE TCC-CURSOR                                            21650000
      ******************************************************************21660000
       3065-OPEN-TCC-CURSOR.                                            21670000
                                                                        21680000
           EXEC SQL                                                     21690000
                OPEN TCC-CURSOR                                         21700000
           END-EXEC.                                                    21710000
                                                                        21720000
           EVALUATE TRUE                                                21730000
               WHEN SQLCODE = ZERO                                      21740000
                   CONTINUE                                             21750000
               WHEN SQLWARN0 NOT EQUAL SPACE                            21760000
               WHEN SQLCODE NOT EQUAL ZERO                              21770000
                   MOVE SQLCODE TO PV-SQL                               21780000
                   MOVE '3065-OPEN-TCC-CURSOR' TO PV-PARAGRAPH-NAME     21790000
                   STRING 'ERROR OPENING TCC-CURSOR - SQLCODE = '       21800000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG21810000
                   END-STRING                                           21820000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    21830000
                   PERFORM 9100-SQL-ABEND                               21840000
           END-EVALUATE.                                                21850000
                                                                        21860000
      ******************************************************************21870000
      *  FETCH THE TCC CURSOR.                                          21880000
      ******************************************************************21890000
       3070-FETCH-TCC-CURSOR.                                           21900000
                                                                        21910000
           EXEC SQL                                                     21920000
                FETCH TCC-CURSOR                                        21930000
                 INTO :PV-STR-NBR                                       21940000
                     ,:PV-DB2-SUM                                       21950000
           END-EXEC.                                                    21960000
                                                                        21970000
           EVALUATE TRUE                                                21980000
               WHEN SQLCODE = ZERO                                      21990000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        22000000
                   MOVE PV-DB2-SUM   TO GL-WS-TCC (PV-STR-NBR)          22010000
                   ADD 1 TO PA-TCC-CURSOR-CNT                           22020000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          22030000
                   SET PS-END-OF-CURSOR  TO TRUE                        22040000
               WHEN SQLWARN0 NOT EQUAL SPACE                            22050000
               WHEN SQLCODE NOT EQUAL ZERO                              22060000
                   MOVE SQLCODE TO PV-SQL                               22070000
                   MOVE '3070-FETCH-TCC-CURSOR' TO PV-PARAGRAPH-NAME    22080000
                   STRING 'ERROR FETCHING TCC-CURSOR - SQLCODE = '      22090000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG22100000
                   END-STRING                                           22110000
                   SET ABEND-4002-READ-ERROR TO TRUE                    22120000
                   PERFORM 9100-SQL-ABEND                               22130000
           END-EVALUATE.                                                22140000
                                                                        22150000
                                                                        22160000
      ******************************************************************22170000
      *  CLOSE THE TCC CURSOR.                                          22180000
      ******************************************************************22190000
       3075-CLOSE-TCC-CURSOR.                                           22200000
                                                                        22210000
           EXEC SQL                                                     22220000
                CLOSE TCC-CURSOR                                        22230000
           END-EXEC.                                                    22240000
                                                                        22250000
           EVALUATE TRUE                                                22260000
               WHEN SQLCODE = ZERO                                      22270000
                    CONTINUE                                            22280000
               WHEN SQLWARN0 NOT EQUAL SPACE                            22290000
               WHEN SQLCODE NOT EQUAL ZERO                              22300000
                   MOVE SQLCODE TO PV-SQL                               22310000
                   MOVE '3075-CLOSE-TCC-CURSOR' TO PV-PARAGRAPH-NAME    22320000
                   STRING 'ERROR CLOSING TCC-CURSOR - SQLCODE = '       22330000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG22340000
                   END-STRING                                           22350000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   22360000
                   PERFORM 9100-SQL-ABEND                               22370000
           END-EVALUATE.                                                22380000
                                                                        22390000
                                                                        22400000
      ******************************************************************22410000
      *  OPEN THE BOS-CURSOR                                            22420000
      ******************************************************************22430000
       3080-OPEN-BOS-CURSOR.                                            22440000
                                                                        22450000
           EXEC SQL                                                     22460000
                OPEN BOS-CURSOR                                         22470000
           END-EXEC.                                                    22480000
                                                                        22490000
           EVALUATE TRUE                                                22500000
               WHEN SQLCODE = ZERO                                      22510000
                   CONTINUE                                             22520000
               WHEN SQLWARN0 NOT EQUAL SPACE                            22530000
               WHEN SQLCODE NOT EQUAL ZERO                              22540000
                   MOVE SQLCODE TO PV-SQL                               22550000
                   MOVE '3080-OPEN-BOS-CURSOR' TO PV-PARAGRAPH-NAME     22560000
                   STRING 'ERROR OPENING BOS-CURSOR - SQLCODE = '       22570000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG22580000
                   END-STRING                                           22590000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    22600000
                   PERFORM 9100-SQL-ABEND                               22610000
           END-EVALUATE.                                                22620000
                                                                        22630000
      ******************************************************************22640000
      *  FETCH THE BOS CURSOR.                                          22650000
      ******************************************************************22660000
       3085-FETCH-BOS-CURSOR.                                           22670000
                                                                        22680000
           EXEC SQL                                                     22690000
                FETCH BOS-CURSOR                                        22700000
                 INTO :PV-STR-NBR                                       22710000
                     ,:PV-DB2-SUM                                       22720000
           END-EXEC.                                                    22730000
                                                                        22740000
           EVALUATE TRUE                                                22750000
               WHEN SQLCODE = ZERO                                      22760000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        22770000
                   MOVE PV-DB2-SUM   TO GL-WS-BOS (PV-STR-NBR)          22780000
                   ADD 1 TO PA-BOS-CURSOR-CNT                           22790000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          22800000
                   SET PS-END-OF-CURSOR  TO TRUE                        22810000
               WHEN SQLWARN0 NOT EQUAL SPACE                            22820000
               WHEN SQLCODE NOT EQUAL ZERO                              22830000
                   MOVE SQLCODE TO PV-SQL                               22840000
                   MOVE '3085-FETCH-BOS-CURSOR' TO PV-PARAGRAPH-NAME    22850000
                   STRING 'ERROR FETCHING BOS-CURSOR - SQLCODE = '      22860000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG22870000
                   END-STRING                                           22880000
                   SET ABEND-4002-READ-ERROR TO TRUE                    22890000
                   PERFORM 9100-SQL-ABEND                               22900000
           END-EVALUATE.                                                22910000
                                                                        22920000
                                                                        22930000
      ******************************************************************22940000
      *  CLOSE THE BOS CURSOR.                                          22950000
      ******************************************************************22960000
       3090-CLOSE-BOS-CURSOR.                                           22970000
                                                                        22980000
           EXEC SQL                                                     22990000
                CLOSE BOS-CURSOR                                        23000000
           END-EXEC.                                                    23010000
                                                                        23020000
           EVALUATE TRUE                                                23030000
               WHEN SQLCODE = ZERO                                      23040000
                    CONTINUE                                            23050000
               WHEN SQLWARN0 NOT EQUAL SPACE                            23060000
               WHEN SQLCODE NOT EQUAL ZERO                              23070000
                   MOVE SQLCODE TO PV-SQL                               23080000
                   MOVE '3090-CLOSE-BOS-CURSOR' TO PV-PARAGRAPH-NAME    23090000
                   STRING 'ERROR CLOSING BOS-CURSOR - SQLCODE = '       23100000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG23110000
                   END-STRING                                           23120000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   23130000
                   PERFORM 9100-SQL-ABEND                               23140000
           END-EVALUATE.                                                23150000
                                                                        23160000
      ******************************************************************23170000
      *  OPEN THE BPS-CURSOR                                            23180000
      ******************************************************************23190000
       3095-OPEN-BPS-CURSOR.                                            23200000
                                                                        23210000
           EXEC SQL                                                     23220000
                OPEN BPS-CURSOR                                         23230000
           END-EXEC.                                                    23240000
                                                                        23250000
           EVALUATE TRUE                                                23260000
               WHEN SQLCODE = ZERO                                      23270000
                   CONTINUE                                             23280000
               WHEN SQLWARN0 NOT EQUAL SPACE                            23290000
               WHEN SQLCODE NOT EQUAL ZERO                              23300000
                   MOVE SQLCODE TO PV-SQL                               23310000
                   MOVE '3095-OPEN-BPS-CURSOR' TO PV-PARAGRAPH-NAME     23320000
                   STRING 'ERROR OPENING BPS-CURSOR - SQLCODE = '       23330000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG23340000
                   END-STRING                                           23350000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    23360000
                   PERFORM 9100-SQL-ABEND                               23370000
           END-EVALUATE.                                                23380000
                                                                        23390000
      ******************************************************************23400000
      *  FETCH THE BPS CURSOR.                                          23410000
      ******************************************************************23420000
       3100-FETCH-BPS-CURSOR.                                           23430000
                                                                        23440000
           EXEC SQL                                                     23450000
                FETCH BPS-CURSOR                                        23460000
                 INTO :PV-STR-NBR                                       23470000
                     ,:PV-DB2-SUM                                       23480000
           END-EXEC.                                                    23490000
                                                                        23500000
           EVALUATE TRUE                                                23510000
               WHEN SQLCODE = ZERO                                      23520000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        23530000
                   MOVE PV-DB2-SUM   TO GL-WS-BPS (PV-STR-NBR)          23540000
                   ADD 1 TO PA-BPS-CURSOR-CNT                           23550000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          23560000
                   SET PS-END-OF-CURSOR  TO TRUE                        23570000
               WHEN SQLWARN0 NOT EQUAL SPACE                            23580000
               WHEN SQLCODE NOT EQUAL ZERO                              23590000
                   MOVE SQLCODE TO PV-SQL                               23600000
                   MOVE '3100-FETCH-BPS-CURSOR' TO PV-PARAGRAPH-NAME    23610000
                   STRING 'ERROR FETCHING BPS-CURSOR - SQLCODE = '      23620000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG23630000
                   END-STRING                                           23640000
                   SET ABEND-4002-READ-ERROR TO TRUE                    23650000
                   PERFORM 9100-SQL-ABEND                               23660000
           END-EVALUATE.                                                23670000
                                                                        23680000
                                                                        23690000
      ******************************************************************23700000
      *  CLOSE THE BPS CURSOR.                                          23710000
      ******************************************************************23720000
       3105-CLOSE-BPS-CURSOR.                                           23730000
                                                                        23740000
           EXEC SQL                                                     23750000
                CLOSE BPS-CURSOR                                        23760000
           END-EXEC.                                                    23770000
                                                                        23780000
           EVALUATE TRUE                                                23790000
               WHEN SQLCODE = ZERO                                      23800000
                    CONTINUE                                            23810000
               WHEN SQLWARN0 NOT EQUAL SPACE                            23820000
               WHEN SQLCODE NOT EQUAL ZERO                              23830000
                   MOVE SQLCODE TO PV-SQL                               23840000
                   MOVE '3105-CLOSE-BPS-CURSOR' TO PV-PARAGRAPH-NAME    23850000
                   STRING 'ERROR CLOSING BPS-CURSOR - SQLCODE = '       23860000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG23870000
                   END-STRING                                           23880000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   23890000
                   PERFORM 9100-SQL-ABEND                               23900000
           END-EVALUATE.                                                23910000
                                                                        23920000
      ******************************************************************23930000
      *  OPEN THE SFS-CURSOR                                            23940000
      ******************************************************************23950000
       3110-OPEN-SFS-CURSOR.                                            23960000
                                                                        23970000
           EXEC SQL                                                     23980000
                OPEN SFS-CURSOR                                         23990000
           END-EXEC.                                                    24000000
                                                                        24010000
           EVALUATE TRUE                                                24020000
               WHEN SQLCODE = ZERO                                      24030000
                   CONTINUE                                             24040000
               WHEN SQLWARN0 NOT EQUAL SPACE                            24050000
               WHEN SQLCODE NOT EQUAL ZERO                              24060000
                   MOVE SQLCODE TO PV-SQL                               24070000
                   MOVE '3110-OPEN-SFS-CURSOR' TO PV-PARAGRAPH-NAME     24080000
                   STRING 'ERROR OPENING SFS-CURSOR - SQLCODE = '       24090000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG24100000
                   END-STRING                                           24110000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    24120000
                   PERFORM 9100-SQL-ABEND                               24130000
           END-EVALUATE.                                                24140000
                                                                        24150000
      ******************************************************************24160000
      *  FETCH THE SFS CURSOR.                                          24170000
      ******************************************************************24180000
       3115-FETCH-SFS-CURSOR.                                           24190000
                                                                        24200000
           EXEC SQL                                                     24210000
                FETCH SFS-CURSOR                                        24220000
                 INTO :PV-STR-NBR                                       24230000
                     ,:PV-DB2-SUM                                       24240000
           END-EXEC.                                                    24250000
                                                                        24260000
           EVALUATE TRUE                                                24270000
               WHEN SQLCODE = ZERO                                      24280000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        24290000
                   MOVE PV-DB2-SUM   TO GL-WS-SFS (PV-STR-NBR)          24300000
                   ADD 1 TO PA-SFS-CURSOR-CNT                           24310000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          24320000
                   SET PS-END-OF-CURSOR  TO TRUE                        24330000
               WHEN SQLWARN0 NOT EQUAL SPACE                            24340000
               WHEN SQLCODE NOT EQUAL ZERO                              24350000
                   MOVE SQLCODE TO PV-SQL                               24360000
                   MOVE '3115-FETCH-SFS-CURSOR' TO PV-PARAGRAPH-NAME    24370000
                   STRING 'ERROR FETCHING SFS-CURSOR - SQLCODE = '      24380000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG24390000
                   END-STRING                                           24400000
                   SET ABEND-4002-READ-ERROR TO TRUE                    24410000
                   PERFORM 9100-SQL-ABEND                               24420000
           END-EVALUATE.                                                24430000
                                                                        24440000
                                                                        24450000
      ******************************************************************24460000
      *  CLOSE THE SFS CURSOR.                                          24470000
      ******************************************************************24480000
       3120-CLOSE-SFS-CURSOR.                                           24490000
                                                                        24500000
           EXEC SQL                                                     24510000
                CLOSE SFS-CURSOR                                        24520000
           END-EXEC.                                                    24530000
                                                                        24540000
           EVALUATE TRUE                                                24550000
               WHEN SQLCODE = ZERO                                      24560000
                    CONTINUE                                            24570000
               WHEN SQLWARN0 NOT EQUAL SPACE                            24580000
               WHEN SQLCODE NOT EQUAL ZERO                              24590000
                   MOVE SQLCODE TO PV-SQL                               24600000
                   MOVE '3120-CLOSE-SFS-CURSOR' TO PV-PARAGRAPH-NAME    24610000
                   STRING 'ERROR CLOSING SFS-CURSOR - SQLCODE = '       24620000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG24630000
                   END-STRING                                           24640000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   24650000
                   PERFORM 9100-SQL-ABEND                               24660000
           END-EVALUATE.                                                24670000
                                                                        24680000
      ******************************************************************24690000
      *  OPEN THE BSR-CURSOR                                            24700000
      ******************************************************************24710000
       3125-OPEN-BSR-CURSOR.                                            24720000
                                                                        24730000
           EXEC SQL                                                     24740000
                OPEN BSR-CURSOR                                         24750000
           END-EXEC.                                                    24760000
                                                                        24770000
           EVALUATE TRUE                                                24780000
               WHEN SQLCODE = ZERO                                      24790000
                   CONTINUE                                             24800000
               WHEN SQLWARN0 NOT EQUAL SPACE                            24810000
               WHEN SQLCODE NOT EQUAL ZERO                              24820000
                   MOVE SQLCODE TO PV-SQL                               24830000
                   MOVE '3125-OPEN-BSR-CURSOR' TO PV-PARAGRAPH-NAME     24840000
                   STRING 'ERROR OPENING BSR-CURSOR - SQLCODE = '       24850000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG24860000
                   END-STRING                                           24870000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    24880000
                   PERFORM 9100-SQL-ABEND                               24890000
           END-EVALUATE.                                                24900000
                                                                        24910000
      ******************************************************************24920000
      *  FETCH THE BSR CURSOR.                                          24930000
      ******************************************************************24940000
       3130-FETCH-BSR-CURSOR.                                           24950000
                                                                        24960000
           EXEC SQL                                                     24970000
                FETCH BSR-CURSOR                                        24980000
                 INTO :PV-STR-NBR                                       24990000
                     ,:PV-DB2-SUM                                       25000000
           END-EXEC.                                                    25010000
                                                                        25020000
           EVALUATE TRUE                                                25030000
               WHEN SQLCODE = ZERO                                      25040000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        25050000
                   MOVE PV-DB2-SUM   TO GL-WS-BSR (PV-STR-NBR)          25060000
                   ADD 1 TO PA-BSR-CURSOR-CNT                           25070000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          25080000
                   SET PS-END-OF-CURSOR  TO TRUE                        25090000
               WHEN SQLWARN0 NOT EQUAL SPACE                            25100000
               WHEN SQLCODE NOT EQUAL ZERO                              25110000
                   MOVE SQLCODE TO PV-SQL                               25120000
                   MOVE '3130-FETCH-BSR-CURSOR' TO PV-PARAGRAPH-NAME    25130000
                   STRING 'ERROR FETCHING BSR-CURSOR - SQLCODE = '      25140000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG25150000
                   END-STRING                                           25160000
                   SET ABEND-4002-READ-ERROR TO TRUE                    25170000
                   PERFORM 9100-SQL-ABEND                               25180000
           END-EVALUATE.                                                25190000
                                                                        25200000
                                                                        25210000
      ******************************************************************25220000
      *  CLOSE THE BSR CURSOR.                                          25230000
      ******************************************************************25240000
       3135-CLOSE-BSR-CURSOR.                                           25250000
                                                                        25260000
           EXEC SQL                                                     25270000
                CLOSE BSR-CURSOR                                        25280000
           END-EXEC.                                                    25290000
                                                                        25300000
           EVALUATE TRUE                                                25310000
               WHEN SQLCODE = ZERO                                      25320000
                    CONTINUE                                            25330000
               WHEN SQLWARN0 NOT EQUAL SPACE                            25340000
               WHEN SQLCODE NOT EQUAL ZERO                              25350000
                   MOVE SQLCODE TO PV-SQL                               25360000
                   MOVE '3135-CLOSE-BSR-CURSOR' TO PV-PARAGRAPH-NAME    25370000
                   STRING 'ERROR CLOSING BSR-CURSOR - SQLCODE = '       25380000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG25390000
                   END-STRING                                           25400000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   25410000
                   PERFORM 9100-SQL-ABEND                               25420000
           END-EVALUATE.                                                25430000
                                                                        25440000
      ******************************************************************25450000
      *  OPEN THE BPR-CURSOR                                            25460000
      ******************************************************************25470000
       3140-OPEN-BPR-CURSOR.                                            25480000
                                                                        25490000
           EXEC SQL                                                     25500000
                OPEN BPR-CURSOR                                         25510000
           END-EXEC.                                                    25520000
                                                                        25530000
           EVALUATE TRUE                                                25540000
               WHEN SQLCODE = ZERO                                      25550000
                   CONTINUE                                             25560000
               WHEN SQLWARN0 NOT EQUAL SPACE                            25570000
               WHEN SQLCODE NOT EQUAL ZERO                              25580000
                   MOVE SQLCODE TO PV-SQL                               25590000
                   MOVE '3140-OPEN-BPR-CURSOR' TO PV-PARAGRAPH-NAME     25600000
                   STRING 'ERROR OPENING BPR-CURSOR - SQLCODE = '       25610000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG25620000
                   END-STRING                                           25630000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    25640000
                   PERFORM 9100-SQL-ABEND                               25650000
           END-EVALUATE.                                                25660000
                                                                        25670000
      ******************************************************************25680000
      *  FETCH THE BPR CURSOR.                                          25690000
      ******************************************************************25700000
       3145-FETCH-BPR-CURSOR.                                           25710000
                                                                        25720000
           EXEC SQL                                                     25730000
                FETCH BPR-CURSOR                                        25740000
                 INTO :PV-STR-NBR                                       25750000
                     ,:PV-DB2-SUM                                       25760000
           END-EXEC.                                                    25770000
                                                                        25780000
           EVALUATE TRUE                                                25790000
               WHEN SQLCODE = ZERO                                      25800000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        25810000
                   MOVE PV-DB2-SUM   TO GL-WS-BPR (PV-STR-NBR)          25820000
                   ADD 1 TO PA-BPR-CURSOR-CNT                           25830000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          25840000
                   SET PS-END-OF-CURSOR  TO TRUE                        25850000
               WHEN SQLWARN0 NOT EQUAL SPACE                            25860000
               WHEN SQLCODE NOT EQUAL ZERO                              25870000
                   MOVE SQLCODE TO PV-SQL                               25880000
                   MOVE '3145-FETCH-BPR-CURSOR' TO PV-PARAGRAPH-NAME    25890000
                   STRING 'ERROR FETCHING BPR-CURSOR - SQLCODE = '      25900000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG25910000
                   END-STRING                                           25920000
                   SET ABEND-4002-READ-ERROR TO TRUE                    25930000
                   PERFORM 9100-SQL-ABEND                               25940000
           END-EVALUATE.                                                25950000
                                                                        25960000
                                                                        25970000
      ******************************************************************25980000
      *  CLOSE THE BPR CURSOR.                                          25990000
      ******************************************************************26000000
       3150-CLOSE-BPR-CURSOR.                                           26010000
                                                                        26020000
           EXEC SQL                                                     26030000
                CLOSE BPR-CURSOR                                        26040000
           END-EXEC.                                                    26050000
                                                                        26060000
           EVALUATE TRUE                                                26070000
               WHEN SQLCODE = ZERO                                      26080000
                    CONTINUE                                            26090000
               WHEN SQLWARN0 NOT EQUAL SPACE                            26100000
               WHEN SQLCODE NOT EQUAL ZERO                              26110000
                   MOVE SQLCODE TO PV-SQL                               26120000
                   MOVE '3150-CLOSE-BPR-CURSOR' TO PV-PARAGRAPH-NAME    26130000
                   STRING 'ERROR CLOSING BPR-CURSOR - SQLCODE = '       26140000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG26150000
                   END-STRING                                           26160000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   26170000
                   PERFORM 9100-SQL-ABEND                               26180000
           END-EVALUATE.                                                26190000
                                                                        26200000
      ******************************************************************26210000
      *  OPEN THE KKB-CURSOR                                            26220000
      ******************************************************************26230000
       3155-OPEN-KKB-CURSOR.                                            26240000
                                                                        26250000
           EXEC SQL                                                     26260000
                OPEN KKB-CURSOR                                         26270000
           END-EXEC.                                                    26280000
                                                                        26290000
           EVALUATE TRUE                                                26300000
               WHEN SQLCODE = ZERO                                      26310000
                   CONTINUE                                             26320000
               WHEN SQLWARN0 NOT EQUAL SPACE                            26330000
               WHEN SQLCODE NOT EQUAL ZERO                              26340000
                   MOVE SQLCODE TO PV-SQL                               26350000
                   MOVE '3155-OPEN-KKB-CURSOR' TO PV-PARAGRAPH-NAME     26360000
                   STRING 'ERROR OPENING KKB-CURSOR - SQLCODE = '       26370000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG26380000
                   END-STRING                                           26390000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    26400000
                   PERFORM 9100-SQL-ABEND                               26410000
           END-EVALUATE.                                                26420000
                                                                        26430000
      ******************************************************************26440000
      *  FETCH THE KKB CURSOR.                                          26450000
      ******************************************************************26460000
       3160-FETCH-KKB-CURSOR.                                           26470000
                                                                        26480000
           EXEC SQL                                                     26490000
                FETCH KKB-CURSOR                                        26500000
                 INTO :PV-STR-NBR                                       26510000
                     ,:PV-DB2-SUM                                       26520000
           END-EXEC.                                                    26530000
                                                                        26540000
           EVALUATE TRUE                                                26550000
               WHEN SQLCODE = ZERO                                      26560000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        26570000
                   MOVE PV-DB2-SUM   TO GL-WS-KKB (PV-STR-NBR)          26580000
                   ADD 1 TO PA-KKB-CURSOR-CNT                           26590000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          26600000
                   SET PS-END-OF-CURSOR  TO TRUE                        26610000
               WHEN SQLWARN0 NOT EQUAL SPACE                            26620000
               WHEN SQLCODE NOT EQUAL ZERO                              26630000
                   MOVE SQLCODE TO PV-SQL                               26640000
                   MOVE '3160-FETCH-KKB-CURSOR' TO PV-PARAGRAPH-NAME    26650000
                   STRING 'ERROR FETCHING KKB-CURSOR - SQLCODE = '      26660000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG26670000
                   END-STRING                                           26680000
                   SET ABEND-4002-READ-ERROR TO TRUE                    26690000
                   PERFORM 9100-SQL-ABEND                               26700000
           END-EVALUATE.                                                26710000
                                                                        26720000
                                                                        26730000
      ******************************************************************26740000
      *  CLOSE THE KKB CURSOR.                                          26750000
      ******************************************************************26760000
       3165-CLOSE-KKB-CURSOR.                                           26770000
                                                                        26780000
           EXEC SQL                                                     26790000
                CLOSE KKB-CURSOR                                        26800000
           END-EXEC.                                                    26810000
                                                                        26820000
           EVALUATE TRUE                                                26830000
               WHEN SQLCODE = ZERO                                      26840000
                    CONTINUE                                            26850000
               WHEN SQLWARN0 NOT EQUAL SPACE                            26860000
               WHEN SQLCODE NOT EQUAL ZERO                              26870000
                   MOVE SQLCODE TO PV-SQL                               26880000
                   MOVE '3165-CLOSE-KKB-CURSOR' TO PV-PARAGRAPH-NAME    26890000
                   STRING 'ERROR CLOSING KKB-CURSOR - SQLCODE = '       26900000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG26910000
                   END-STRING                                           26920000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   26930000
                   PERFORM 9100-SQL-ABEND                               26940000
           END-EVALUATE.                                                26950000
                                                                        26960000
      ******************************************************************26970000
      *  OPEN THE KKH-CURSOR                                            26980000
      ******************************************************************26990000
       3170-OPEN-KKH-CURSOR.                                            27000000
                                                                        27010000
           EXEC SQL                                                     27020000
                OPEN KKH-CURSOR                                         27030000
           END-EXEC.                                                    27040000
                                                                        27050000
           EVALUATE TRUE                                                27060000
               WHEN SQLCODE = ZERO                                      27070000
                   CONTINUE                                             27080000
               WHEN SQLWARN0 NOT EQUAL SPACE                            27090000
               WHEN SQLCODE NOT EQUAL ZERO                              27100000
                   MOVE SQLCODE TO PV-SQL                               27110000
                   MOVE '3170-OPEN-KKH-CURSOR' TO PV-PARAGRAPH-NAME     27120000
                   STRING 'ERROR OPENING KKH-CURSOR - SQLCODE = '       27130000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG27140000
                   END-STRING                                           27150000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    27160000
                   PERFORM 9100-SQL-ABEND                               27170000
           END-EVALUATE.                                                27180000
                                                                        27190000
      ******************************************************************27200000
      *  FETCH THE KKH CURSOR.                                          27210000
      ******************************************************************27220000
       3175-FETCH-KKH-CURSOR.                                           27230000
                                                                        27240000
           EXEC SQL                                                     27250000
                FETCH KKH-CURSOR                                        27260000
                 INTO :PV-STR-NBR                                       27270000
                     ,:PV-DB2-SUM                                       27280000
           END-EXEC.                                                    27290000
                                                                        27300000
           EVALUATE TRUE                                                27310000
               WHEN SQLCODE = ZERO                                      27320000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        27330000
                   MOVE PV-DB2-SUM   TO GL-WS-KKH (PV-STR-NBR)          27340000
                   ADD 1 TO PA-KKH-CURSOR-CNT                           27350000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          27360000
                   SET PS-END-OF-CURSOR  TO TRUE                        27370000
               WHEN SQLWARN0 NOT EQUAL SPACE                            27380000
               WHEN SQLCODE NOT EQUAL ZERO                              27390000
                   MOVE SQLCODE TO PV-SQL                               27400000
                   MOVE '3175-FETCH-KKH-CURSOR' TO PV-PARAGRAPH-NAME    27410000
                   STRING 'ERROR FETCHING KKH-CURSOR - SQLCODE = '      27420000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG27430000
                   END-STRING                                           27440000
                   SET ABEND-4002-READ-ERROR TO TRUE                    27450000
                   PERFORM 9100-SQL-ABEND                               27460000
           END-EVALUATE.                                                27470000
                                                                        27480000
                                                                        27490000
      ******************************************************************27500000
      *  CLOSE THE KKH CURSOR.                                          27510000
      ******************************************************************27520000
       3180-CLOSE-KKH-CURSOR.                                           27530000
                                                                        27540000
           EXEC SQL                                                     27550000
                CLOSE KKH-CURSOR                                        27560000
           END-EXEC.                                                    27570000
                                                                        27580000
           EVALUATE TRUE                                                27590000
               WHEN SQLCODE = ZERO                                      27600000
                    CONTINUE                                            27610000
               WHEN SQLWARN0 NOT EQUAL SPACE                            27620000
               WHEN SQLCODE NOT EQUAL ZERO                              27630000
                   MOVE SQLCODE TO PV-SQL                               27640000
                   MOVE '3180-CLOSE-KKH-CURSOR' TO PV-PARAGRAPH-NAME    27650000
                   STRING 'ERROR CLOSING KKH-CURSOR - SQLCODE = '       27660000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG27670000
                   END-STRING                                           27680000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   27690000
                   PERFORM 9100-SQL-ABEND                               27700000
           END-EVALUATE.                                                27710000
                                                                        27720000
      ******************************************************************27730000
      *  OPEN THE KKS-CURSOR                                            27740000
      ******************************************************************27750000
       3185-OPEN-KKS-CURSOR.                                            27760000
                                                                        27770000
           EXEC SQL                                                     27780000
                OPEN KKS-CURSOR                                         27790000
           END-EXEC.                                                    27800000
                                                                        27810000
           EVALUATE TRUE                                                27820000
               WHEN SQLCODE = ZERO                                      27830000
                   CONTINUE                                             27840000
               WHEN SQLWARN0 NOT EQUAL SPACE                            27850000
               WHEN SQLCODE NOT EQUAL ZERO                              27860000
                   MOVE SQLCODE TO PV-SQL                               27870000
                   MOVE '3185-OPEN-KKS-CURSOR' TO PV-PARAGRAPH-NAME     27880000
                   STRING 'ERROR OPENING KKS-CURSOR - SQLCODE = '       27890000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG27900000
                   END-STRING                                           27910000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    27920000
                   PERFORM 9100-SQL-ABEND                               27930000
           END-EVALUATE.                                                27940000
                                                                        27950000
      ******************************************************************27960000
      *  FETCH THE KKS CURSOR.                                          27970000
      ******************************************************************27980000
       3190-FETCH-KKS-CURSOR.                                           27990000
                                                                        28000000
           EXEC SQL                                                     28010000
                FETCH KKS-CURSOR                                        28020000
                 INTO :PV-STR-NBR                                       28030000
                     ,:PV-DB2-SUM                                       28040000
           END-EXEC.                                                    28050000
                                                                        28060000
           EVALUATE TRUE                                                28070000
               WHEN SQLCODE = ZERO                                      28080000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        28090000
                   MOVE PV-DB2-SUM   TO GL-WS-KKS (PV-STR-NBR)          28100000
                   ADD 1 TO PA-KKS-CURSOR-CNT                           28110000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          28120000
                   SET PS-END-OF-CURSOR  TO TRUE                        28130000
               WHEN SQLWARN0 NOT EQUAL SPACE                            28140000
               WHEN SQLCODE NOT EQUAL ZERO                              28150000
                   MOVE SQLCODE TO PV-SQL                               28160000
                   MOVE '3190-FETCH-KKS-CURSOR' TO PV-PARAGRAPH-NAME    28170000
                   STRING 'ERROR FETCHING KKS-CURSOR - SQLCODE = '      28180000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG28190000
                   END-STRING                                           28200000
                   SET ABEND-4002-READ-ERROR TO TRUE                    28210000
                   PERFORM 9100-SQL-ABEND                               28220000
           END-EVALUATE.                                                28230000
                                                                        28240000
                                                                        28250000
      ******************************************************************28260000
      *  CLOSE THE KKS CURSOR.                                          28270000
      ******************************************************************28280000
       3195-CLOSE-KKS-CURSOR.                                           28290000
                                                                        28300000
           EXEC SQL                                                     28310000
                CLOSE KKS-CURSOR                                        28320000
           END-EXEC.                                                    28330000
                                                                        28340000
           EVALUATE TRUE                                                28350000
               WHEN SQLCODE = ZERO                                      28360000
                    CONTINUE                                            28370000
               WHEN SQLWARN0 NOT EQUAL SPACE                            28380000
               WHEN SQLCODE NOT EQUAL ZERO                              28390000
                   MOVE SQLCODE TO PV-SQL                               28400000
                   MOVE '3195-CLOSE-KKS-CURSOR' TO PV-PARAGRAPH-NAME    28410000
                   STRING 'ERROR CLOSING KKS-CURSOR - SQLCODE = '       28420000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG28430000
                   END-STRING                                           28440000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   28450000
                   PERFORM 9100-SQL-ABEND                               28460000
           END-EVALUATE.                                                28470000
                                                                        28480000
      ******************************************************************28490000
      *  OPEN THE KKU-CURSOR                                            28500000
      ******************************************************************28510000
       3200-OPEN-KKU-CURSOR.                                            28520000
                                                                        28530000
           EXEC SQL                                                     28540000
                OPEN KKU-CURSOR                                         28550000
           END-EXEC.                                                    28560000
                                                                        28570000
           EVALUATE TRUE                                                28580000
               WHEN SQLCODE = ZERO                                      28590000
                   CONTINUE                                             28600000
               WHEN SQLWARN0 NOT EQUAL SPACE                            28610000
               WHEN SQLCODE NOT EQUAL ZERO                              28620000
                   MOVE SQLCODE TO PV-SQL                               28630000
                   MOVE '3200-OPEN-KKU-CURSOR' TO PV-PARAGRAPH-NAME     28640000
                   STRING 'ERROR OPENING KKU-CURSOR - SQLCODE = '       28650000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG28660000
                   END-STRING                                           28670000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    28680000
                   PERFORM 9100-SQL-ABEND                               28690000
           END-EVALUATE.                                                28700000
                                                                        28710000
      ******************************************************************28720000
      *  FETCH THE KKU CURSOR.                                          28730000
      ******************************************************************28740000
       3205-FETCH-KKU-CURSOR.                                           28750000
                                                                        28760000
           EXEC SQL                                                     28770000
                FETCH KKU-CURSOR                                        28780000
                 INTO :PV-STR-NBR                                       28790000
                     ,:PV-DB2-SUM                                       28800000
           END-EXEC.                                                    28810000
                                                                        28820000
           EVALUATE TRUE                                                28830000
               WHEN SQLCODE = ZERO                                      28840000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        28850000
                   MOVE PV-DB2-SUM   TO GL-WS-KKU (PV-STR-NBR)          28860000
                   ADD 1 TO PA-KKU-CURSOR-CNT                           28870000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          28880000
                   SET PS-END-OF-CURSOR  TO TRUE                        28890000
               WHEN SQLWARN0 NOT EQUAL SPACE                            28900000
               WHEN SQLCODE NOT EQUAL ZERO                              28910000
                   MOVE SQLCODE TO PV-SQL                               28920000
                   MOVE '3205-FETCH-KKU-CURSOR' TO PV-PARAGRAPH-NAME    28930000
                   STRING 'ERROR FETCHING KKU-CURSOR - SQLCODE = '      28940000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG28950000
                   END-STRING                                           28960000
                   SET ABEND-4002-READ-ERROR TO TRUE                    28970000
                   PERFORM 9100-SQL-ABEND                               28980000
           END-EVALUATE.                                                28990000
                                                                        29000000
                                                                        29010000
      ******************************************************************29020000
      *  CLOSE THE KKU CURSOR.                                          29030000
      ******************************************************************29040000
       3210-CLOSE-KKU-CURSOR.                                           29050000
                                                                        29060000
           EXEC SQL                                                     29070000
                CLOSE KKU-CURSOR                                        29080000
           END-EXEC.                                                    29090000
                                                                        29100000
           EVALUATE TRUE                                                29110000
               WHEN SQLCODE = ZERO                                      29120000
                    CONTINUE                                            29130000
               WHEN SQLWARN0 NOT EQUAL SPACE                            29140000
               WHEN SQLCODE NOT EQUAL ZERO                              29150000
                   MOVE SQLCODE TO PV-SQL                               29160000
                   MOVE '3210-CLOSE-KKU-CURSOR' TO PV-PARAGRAPH-NAME    29170000
                   STRING 'ERROR CLOSING KKU-CURSOR - SQLCODE = '       29180000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG29190000
                   END-STRING                                           29200000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   29210000
                   PERFORM 9100-SQL-ABEND                               29220000
           END-EVALUATE.                                                29230000
                                                                        29240000
      ******************************************************************29250000
      *  OPEN THE SHS-CURSOR                                            29260000
      ******************************************************************29270000
       3215-OPEN-SHS-CURSOR.                                            29280000
                                                                        29290000
           EXEC SQL                                                     29300000
                OPEN SHS-CURSOR                                         29310000
           END-EXEC.                                                    29320000
                                                                        29330000
           EVALUATE TRUE                                                29340000
               WHEN SQLCODE = ZERO                                      29350000
                   CONTINUE                                             29360000
               WHEN SQLWARN0 NOT EQUAL SPACE                            29370000
               WHEN SQLCODE NOT EQUAL ZERO                              29380000
                   MOVE SQLCODE TO PV-SQL                               29390000
                   MOVE '3215-OPEN-SHS-CURSOR' TO PV-PARAGRAPH-NAME     29400000
                   STRING 'ERROR OPENING SHS-CURSOR - SQLCODE = '       29410000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG29420000
                   END-STRING                                           29430000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    29440000
                   PERFORM 9100-SQL-ABEND                               29450000
           END-EVALUATE.                                                29460000
                                                                        29470000
      ******************************************************************29480000
      *  FETCH THE SHS CURSOR.                                          29490000
      ******************************************************************29500000
       3220-FETCH-SHS-CURSOR.                                           29510000
                                                                        29520000
           EXEC SQL                                                     29530000
                FETCH SHS-CURSOR                                        29540000
                 INTO :PV-STR-NBR                                       29550000
                     ,:PV-DB2-SUM                                       29560000
           END-EXEC.                                                    29570000
                                                                        29580000
           EVALUATE TRUE                                                29590000
               WHEN SQLCODE = ZERO                                      29600000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        29610000
                   MOVE PV-DB2-SUM   TO GL-WS-SHS (PV-STR-NBR)          29620000
                   ADD 1 TO PA-SHS-CURSOR-CNT                           29630000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          29640000
                   SET PS-END-OF-CURSOR  TO TRUE                        29650000
               WHEN SQLWARN0 NOT EQUAL SPACE                            29660000
               WHEN SQLCODE NOT EQUAL ZERO                              29670000
                   MOVE SQLCODE TO PV-SQL                               29680000
                   MOVE '3220-FETCH-SHS-CURSOR' TO PV-PARAGRAPH-NAME    29690000
                   STRING 'ERROR FETCHING SHS-CURSOR - SQLCODE = '      29700000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG29710000
                   END-STRING                                           29720000
                   SET ABEND-4002-READ-ERROR TO TRUE                    29730000
                   PERFORM 9100-SQL-ABEND                               29740000
           END-EVALUATE.                                                29750000
                                                                        29760000
                                                                        29770000
      ******************************************************************29780000
      *  CLOSE THE SHS CURSOR.                                          29790000
      ******************************************************************29800000
       3225-CLOSE-SHS-CURSOR.                                           29810000
                                                                        29820000
           EXEC SQL                                                     29830000
                CLOSE SHS-CURSOR                                        29840000
           END-EXEC.                                                    29850000
                                                                        29860000
           EVALUATE TRUE                                                29870000
               WHEN SQLCODE = ZERO                                      29880000
                    CONTINUE                                            29890000
               WHEN SQLWARN0 NOT EQUAL SPACE                            29900000
               WHEN SQLCODE NOT EQUAL ZERO                              29910000
                   MOVE SQLCODE TO PV-SQL                               29920000
                   MOVE '3225-CLOSE-SHS-CURSOR' TO PV-PARAGRAPH-NAME    29930000
                   STRING 'ERROR CLOSING SHS-CURSOR - SQLCODE = '       29940000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG29950000
                   END-STRING                                           29960000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   29970000
                   PERFORM 9100-SQL-ABEND                               29980000
           END-EVALUATE.                                                29990000
                                                                        30000000
                                                                        30010000
      ******************************************************************30020000
      *  OPEN THE ECR-CURSOR                                            30030000
      ******************************************************************30040000
       3230-OPEN-ECR-CURSOR.                                            30050000
                                                                        30060000
           EXEC SQL                                                     30070000
                OPEN ECR-CURSOR                                         30080000
           END-EXEC.                                                    30090000
                                                                        30100000
           EVALUATE TRUE                                                30110000
               WHEN SQLCODE = ZERO                                      30120000
                   CONTINUE                                             30130000
               WHEN SQLWARN0 NOT EQUAL SPACE                            30140000
               WHEN SQLCODE NOT EQUAL ZERO                              30150000
                   MOVE SQLCODE TO PV-SQL                               30160000
                   MOVE '3230-OPEN-ECR-CURSOR' TO PV-PARAGRAPH-NAME     30170000
                   STRING 'ERROR OPENING ECR-CURSOR - SQLCODE = '       30180000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG30190000
                   END-STRING                                           30200000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    30210000
                   PERFORM 9100-SQL-ABEND                               30220000
           END-EVALUATE.                                                30230000
                                                                        30240000
      ******************************************************************30250000
      *  FETCH THE ECR CURSOR.                                          30260000
      ******************************************************************30270000
       3235-FETCH-ECR-CURSOR.                                           30280000
                                                                        30290000
           EXEC SQL                                                     30300000
                FETCH ECR-CURSOR                                        30310000
                 INTO :PV-STR-NBR                                       30320000
                     ,:PV-DB2-SUM                                       30330000
           END-EXEC.                                                    30340000
                                                                        30350000
           EVALUATE TRUE                                                30360000
               WHEN SQLCODE = ZERO                                      30370000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        30380000
                   MOVE PV-DB2-SUM   TO GL-WS-ECR (PV-STR-NBR)          30390000
                   ADD 1 TO PA-ECR-CURSOR-CNT                           30400000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          30410000
                   SET PS-END-OF-CURSOR  TO TRUE                        30420000
               WHEN SQLWARN0 NOT EQUAL SPACE                            30430000
               WHEN SQLCODE NOT EQUAL ZERO                              30440000
                   MOVE SQLCODE TO PV-SQL                               30450000
                   MOVE '3235-FETCH-ECR-CURSOR' TO PV-PARAGRAPH-NAME    30460000
                   STRING 'ERROR FETCHING ECR-CURSOR - SQLCODE = '      30470000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG30480000
                   END-STRING                                           30490000
                   SET ABEND-4002-READ-ERROR TO TRUE                    30500000
                   PERFORM 9100-SQL-ABEND                               30510000
           END-EVALUATE.                                                30520000
                                                                        30530000
                                                                        30540000
      ******************************************************************30550000
      *  CLOSE THE ECR CURSOR.                                          30560000
      ******************************************************************30570000
       3240-CLOSE-ECR-CURSOR.                                           30580000
                                                                        30590000
           EXEC SQL                                                     30600000
                CLOSE ECR-CURSOR                                        30610000
           END-EXEC.                                                    30620000
                                                                        30630000
           EVALUATE TRUE                                                30640000
               WHEN SQLCODE = ZERO                                      30650000
                    CONTINUE                                            30660000
               WHEN SQLWARN0 NOT EQUAL SPACE                            30670000
               WHEN SQLCODE NOT EQUAL ZERO                              30680000
                   MOVE SQLCODE TO PV-SQL                               30690000
                   MOVE '3240-CLOSE-ECR-CURSOR' TO PV-PARAGRAPH-NAME    30700000
                   STRING 'ERROR CLOSING ECR-CURSOR - SQLCODE = '       30710000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG30720000
                   END-STRING                                           30730000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   30740000
                   PERFORM 9100-SQL-ABEND                               30750000
           END-EVALUATE.                                                30760000
                                                                        30770000
                                                                        30780000
      ******************************************************************30790000
      *  OPEN THE SHR-CURSOR                                            30800000
      ******************************************************************30810000
       3245-OPEN-SHR-CURSOR.                                            30820000
                                                                        30830000
           EXEC SQL                                                     30840000
                OPEN SHR-CURSOR                                         30850000
           END-EXEC.                                                    30860000
                                                                        30870000
           EVALUATE TRUE                                                30880000
               WHEN SQLCODE = ZERO                                      30890000
                   CONTINUE                                             30900000
               WHEN SQLWARN0 NOT EQUAL SPACE                            30910000
               WHEN SQLCODE NOT EQUAL ZERO                              30920000
                   MOVE SQLCODE TO PV-SQL                               30930000
                   MOVE '3245-OPEN-SHR-CURSOR' TO PV-PARAGRAPH-NAME     30940000
                   STRING 'ERROR OPENING SHR-CURSOR - SQLCODE = '       30950000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG30960000
                   END-STRING                                           30970000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    30980000
                   PERFORM 9100-SQL-ABEND                               30990000
           END-EVALUATE.                                                31000000
                                                                        31010000
      ******************************************************************31020000
      *  FETCH THE SHR CURSOR.                                          31030000
      ******************************************************************31040000
       3250-FETCH-SHR-CURSOR.                                           31050000
                                                                        31060000
           EXEC SQL                                                     31070000
                FETCH SHR-CURSOR                                        31080000
                 INTO :PV-STR-NBR                                       31090000
                     ,:PV-DB2-SUM                                       31100000
           END-EXEC.                                                    31110000
                                                                        31120000
           EVALUATE TRUE                                                31130000
               WHEN SQLCODE = ZERO                                      31140000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        31150000
                   MOVE PV-DB2-SUM   TO GL-WS-SHR (PV-STR-NBR)          31160000
                   ADD 1 TO PA-SHR-CURSOR-CNT                           31170000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          31180000
                   SET PS-END-OF-CURSOR  TO TRUE                        31190000
               WHEN SQLWARN0 NOT EQUAL SPACE                            31200000
               WHEN SQLCODE NOT EQUAL ZERO                              31210000
                   MOVE SQLCODE TO PV-SQL                               31220000
                   MOVE '3250-FETCH-SHR-CURSOR' TO PV-PARAGRAPH-NAME    31230000
                   STRING 'ERROR FETCHING SHR-CURSOR - SQLCODE = '      31240000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG31250000
                   END-STRING                                           31260000
                   SET ABEND-4002-READ-ERROR TO TRUE                    31270000
                   PERFORM 9100-SQL-ABEND                               31280000
           END-EVALUATE.                                                31290000
                                                                        31300000
                                                                        31310000
      ******************************************************************31320000
      *  CLOSE THE SHR CURSOR.                                          31330000
      ******************************************************************31340000
       3255-CLOSE-SHR-CURSOR.                                           31350000
                                                                        31360000
           EXEC SQL                                                     31370000
                CLOSE SHR-CURSOR                                        31380000
           END-EXEC.                                                    31390000
                                                                        31400000
           EVALUATE TRUE                                                31410000
               WHEN SQLCODE = ZERO                                      31420000
                    CONTINUE                                            31430000
               WHEN SQLWARN0 NOT EQUAL SPACE                            31440000
               WHEN SQLCODE NOT EQUAL ZERO                              31450000
                   MOVE SQLCODE TO PV-SQL                               31460000
                   MOVE '3255-CLOSE-SHR-CURSOR' TO PV-PARAGRAPH-NAME    31470000
                   STRING 'ERROR CLOSING SHR-CURSOR - SQLCODE = '       31480000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG31490000
                   END-STRING                                           31500000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   31510000
                   PERFORM 9100-SQL-ABEND                               31520000
           END-EVALUATE.                                                31530000
                                                                        31540000
                                                                        31550000
      ******************************************************************31560000
      *  OPEN THE TAX-CURSOR                                            31570000
      ******************************************************************31580000
       3260-OPEN-TAX-CURSOR.                                            31590000
                                                                        31600000
           EXEC SQL                                                     31610000
                OPEN TAX-CURSOR                                         31620000
           END-EXEC.                                                    31630000
                                                                        31640000
           EVALUATE TRUE                                                31650000
               WHEN SQLCODE = ZERO                                      31660000
                   CONTINUE                                             31670000
               WHEN SQLWARN0 NOT EQUAL SPACE                            31680000
               WHEN SQLCODE NOT EQUAL ZERO                              31690000
                   MOVE SQLCODE TO PV-SQL                               31700000
                   MOVE '3260-OPEN-TAX-CURSOR' TO PV-PARAGRAPH-NAME     31710000
                   STRING 'ERROR OPENING TAX-CURSOR - SQLCODE = '       31720000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG31730000
                   END-STRING                                           31740000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    31750000
                   PERFORM 9100-SQL-ABEND                               31760000
           END-EVALUATE.                                                31770000
                                                                        31780000
      ******************************************************************31790000
      *  FETCH THE TAX CURSOR.                                          31800000
      ******************************************************************31810000
       3265-FETCH-TAX-CURSOR.                                           31820000
                                                                        31830000
           EXEC SQL                                                     31840000
                FETCH TAX-CURSOR                                        31850000
                 INTO :PV-STR-NBR                                       31860000
                     ,:PV-DB2-SUM                                       31870000
           END-EXEC.                                                    31880000
                                                                        31890000
           EVALUATE TRUE                                                31900000
               WHEN SQLCODE = ZERO                                      31910000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        31920000
                   MOVE PV-DB2-SUM   TO GL-WS-TAX (PV-STR-NBR)          31930000
                   ADD 1 TO PA-TAX-CURSOR-CNT                           31940000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          31950000
                   SET PS-END-OF-CURSOR  TO TRUE                        31960000
               WHEN SQLWARN0 NOT EQUAL SPACE                            31970000
               WHEN SQLCODE NOT EQUAL ZERO                              31980000
                   MOVE SQLCODE TO PV-SQL                               31990000
                   MOVE '3265-FETCH-TAX-CURSOR' TO PV-PARAGRAPH-NAME    32000000
                   STRING 'ERROR FETCHING TAX-CURSOR - SQLCODE = '      32010000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG32020000
                   END-STRING                                           32030000
                   SET ABEND-4002-READ-ERROR TO TRUE                    32040000
                   PERFORM 9100-SQL-ABEND                               32050000
           END-EVALUATE.                                                32060000
                                                                        32070000
                                                                        32080000
      ******************************************************************32090000
      *  CLOSE THE TAX CURSOR.                                          32100000
      ******************************************************************32110000
       3270-CLOSE-TAX-CURSOR.                                           32120000
                                                                        32130000
           EXEC SQL                                                     32140000
                CLOSE TAX-CURSOR                                        32150000
           END-EXEC.                                                    32160000
                                                                        32170000
           EVALUATE TRUE                                                32180000
               WHEN SQLCODE = ZERO                                      32190000
                    CONTINUE                                            32200000
               WHEN SQLWARN0 NOT EQUAL SPACE                            32210000
               WHEN SQLCODE NOT EQUAL ZERO                              32220000
                   MOVE SQLCODE TO PV-SQL                               32230000
                   MOVE '3270-CLOSE-TAX-CURSOR' TO PV-PARAGRAPH-NAME    32240000
                   STRING 'ERROR CLOSING TAX-CURSOR - SQLCODE = '       32250000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG32260000
                   END-STRING                                           32270000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   32280000
                   PERFORM 9100-SQL-ABEND                               32290000
           END-EVALUATE.                                                32300000
                                                                        32310000
                                                                        32320000
      ******************************************************************32330000
      *  OPEN THE FEE-CURSOR                                            32340000
      ******************************************************************32350000
       3275-OPEN-FEE-CURSOR.                                            32360000
                                                                        32370000
           EXEC SQL                                                     32380000
                OPEN FEE-CURSOR                                         32390000
           END-EXEC.                                                    32400000
                                                                        32410000
           EVALUATE TRUE                                                32420000
               WHEN SQLCODE = ZERO                                      32430000
                   CONTINUE                                             32440000
               WHEN SQLWARN0 NOT EQUAL SPACE                            32450000
               WHEN SQLCODE NOT EQUAL ZERO                              32460000
                   MOVE SQLCODE TO PV-SQL                               32470000
                   MOVE '3275-OPEN-FEE-CURSOR' TO PV-PARAGRAPH-NAME     32480000
                   STRING 'ERROR OPENING FEE-CURSOR - SQLCODE = '       32490000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG32500000
                   END-STRING                                           32510000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    32520000
                   PERFORM 9100-SQL-ABEND                               32530000
           END-EVALUATE.                                                32540000
                                                                        32550000
      ******************************************************************32560000
      *  FETCH THE FEE CURSOR.                                          32570000
      ******************************************************************32580000
       3280-FETCH-FEE-CURSOR.                                           32590000
                                                                        32600000
           EXEC SQL                                                     32610000
                FETCH FEE-CURSOR                                        32620000
                 INTO :PV-STR-NBR                                       32630000
                     ,:PV-DB2-SUM                                       32640000
           END-EXEC.                                                    32650000
                                                                        32660000
           EVALUATE TRUE                                                32670000
               WHEN SQLCODE = ZERO                                      32680000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        32690000
                   MOVE PV-DB2-SUM   TO GL-WS-FEE (PV-STR-NBR)          32700000
                   ADD 1 TO PA-FEE-CURSOR-CNT                           32710000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          32720000
                   SET PS-END-OF-CURSOR  TO TRUE                        32730000
               WHEN SQLWARN0 NOT EQUAL SPACE                            32740000
               WHEN SQLCODE NOT EQUAL ZERO                              32750000
                   MOVE SQLCODE TO PV-SQL                               32760000
                   MOVE '3280-FETCH-FEE-CURSOR' TO PV-PARAGRAPH-NAME    32770000
                   STRING 'ERROR FETCHING FEE-CURSOR - SQLCODE = '      32780000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG32790000
                   END-STRING                                           32800000
                   SET ABEND-4002-READ-ERROR TO TRUE                    32810000
                   PERFORM 9100-SQL-ABEND                               32820000
           END-EVALUATE.                                                32830000
                                                                        32840000
                                                                        32850000
      ******************************************************************32860000
      *  CLOSE THE FEE CURSOR.                                          32870000
      ******************************************************************32880000
       3285-CLOSE-FEE-CURSOR.                                           32890000
                                                                        32900000
           EXEC SQL                                                     32910000
                CLOSE FEE-CURSOR                                        32920000
           END-EXEC.                                                    32930000
                                                                        32940000
           EVALUATE TRUE                                                32950000
               WHEN SQLCODE = ZERO                                      32960000
                    CONTINUE                                            32970000
               WHEN SQLWARN0 NOT EQUAL SPACE                            32980000
               WHEN SQLCODE NOT EQUAL ZERO                              32990000
                   MOVE SQLCODE TO PV-SQL                               33000000
                   MOVE '3285-CLOSE-FEE-CURSOR' TO PV-PARAGRAPH-NAME    33010000
                   STRING 'ERROR CLOSING FEE-CURSOR - SQLCODE = '       33020000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG33030000
                   END-STRING                                           33040000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   33050000
                   PERFORM 9100-SQL-ABEND                               33060000
           END-EVALUATE.                                                33070000
                                                                        33080000
                                                                        33090000
      ******************************************************************33100000
      *  OPEN THE AEN-CURSOR                                            33110000
      ******************************************************************33120000
       3290-OPEN-AEN-CURSOR.                                            33130000
                                                                        33140000
           EXEC SQL                                                     33150000
                OPEN AEN-CURSOR                                         33160000
           END-EXEC.                                                    33170000
                                                                        33180000
           EVALUATE TRUE                                                33190000
               WHEN SQLCODE = ZERO                                      33200000
                   CONTINUE                                             33210000
               WHEN SQLWARN0 NOT EQUAL SPACE                            33220000
               WHEN SQLCODE NOT EQUAL ZERO                              33230000
                   MOVE SQLCODE TO PV-SQL                               33240000
                   MOVE '3290-OPEN-AEN-CURSOR' TO PV-PARAGRAPH-NAME     33250000
                   STRING 'ERROR OPENING AEN-CURSOR - SQLCODE = '       33260000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG33270000
                   END-STRING                                           33280000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    33290000
                   PERFORM 9100-SQL-ABEND                               33300000
           END-EVALUATE.                                                33310000
                                                                        33320000
      ******************************************************************33330000
      *  FETCH THE AEN CURSOR.                                          33340000
      ******************************************************************33350000
       3295-FETCH-AEN-CURSOR.                                           33360000
                                                                        33370000
           EXEC SQL                                                     33380000
                FETCH AEN-CURSOR                                        33390000
                 INTO :PV-STR-NBR                                       33400000
                     ,:PV-DB2-SUM                                       33410000
           END-EXEC.                                                    33420000
                                                                        33430000
           EVALUATE TRUE                                                33440000
               WHEN SQLCODE = ZERO                                      33450000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        33460000
                   MOVE PV-DB2-SUM   TO GL-WS-AEN (PV-STR-NBR)          33470000
                   ADD 1 TO PA-AEN-CURSOR-CNT                           33480000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          33490000
                   SET PS-END-OF-CURSOR  TO TRUE                        33500000
               WHEN SQLWARN0 NOT EQUAL SPACE                            33510000
               WHEN SQLCODE NOT EQUAL ZERO                              33520000
                   MOVE SQLCODE TO PV-SQL                               33530000
                   MOVE '3295-FETCH-AEN-CURSOR' TO PV-PARAGRAPH-NAME    33540000
                   STRING 'ERROR FETCHING AEN-CURSOR - SQLCODE = '      33550000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG33560000
                   END-STRING                                           33570000
                   SET ABEND-4002-READ-ERROR TO TRUE                    33580000
                   PERFORM 9100-SQL-ABEND                               33590000
           END-EVALUATE.                                                33600000
                                                                        33610000
                                                                        33620000
      ******************************************************************33630000
      *  CLOSE THE AEN CURSOR.                                          33640000
      ******************************************************************33650000
       3300-CLOSE-AEN-CURSOR.                                           33660000
                                                                        33670000
           EXEC SQL                                                     33680000
                CLOSE AEN-CURSOR                                        33690000
           END-EXEC.                                                    33700000
                                                                        33710000
           EVALUATE TRUE                                                33720000
               WHEN SQLCODE = ZERO                                      33730000
                    CONTINUE                                            33740000
               WHEN SQLWARN0 NOT EQUAL SPACE                            33750000
               WHEN SQLCODE NOT EQUAL ZERO                              33760000
                   MOVE SQLCODE TO PV-SQL                               33770000
                   MOVE '3300-CLOSE-AEN-CURSOR' TO PV-PARAGRAPH-NAME    33780000
                   STRING 'ERROR CLOSING AEN-CURSOR - SQLCODE = '       33790000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG33800000
                   END-STRING                                           33810000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   33820000
                   PERFORM 9100-SQL-ABEND                               33830000
           END-EVALUATE.                                                33840000
                                                                        33850000
                                                                        33860000
      ******************************************************************33870000
      *  OPEN THE BCN-CURSOR                                            33880000
      ******************************************************************33890000
       3305-OPEN-BCN-CURSOR.                                            33900000
                                                                        33910000
           EXEC SQL                                                     33920000
                OPEN BCN-CURSOR                                         33930000
           END-EXEC.                                                    33940000
                                                                        33950000
           EVALUATE TRUE                                                33960000
               WHEN SQLCODE = ZERO                                      33970000
                   CONTINUE                                             33980000
               WHEN SQLWARN0 NOT EQUAL SPACE                            33990000
               WHEN SQLCODE NOT EQUAL ZERO                              34000000
                   MOVE SQLCODE TO PV-SQL                               34010000
                   MOVE '3305-OPEN-BCN-CURSOR' TO PV-PARAGRAPH-NAME     34020000
                   STRING 'ERROR OPENING BCN-CURSOR - SQLCODE = '       34030000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG34040000
                   END-STRING                                           34050000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    34060000
                   PERFORM 9100-SQL-ABEND                               34070000
           END-EVALUATE.                                                34080000
                                                                        34090000
      ******************************************************************34100000
      *  FETCH THE BCN CURSOR.                                          34110000
      ******************************************************************34120000
       3310-FETCH-BCN-CURSOR.                                           34130000
                                                                        34140000
           EXEC SQL                                                     34150000
                FETCH BCN-CURSOR                                        34160000
                 INTO :PV-STR-NBR                                       34170000
                     ,:PV-DB2-SUM                                       34180000
           END-EXEC.                                                    34190000
                                                                        34200000
           EVALUATE TRUE                                                34210000
               WHEN SQLCODE = ZERO                                      34220000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        34230000
                   MOVE PV-DB2-SUM   TO GL-WS-BCN (PV-STR-NBR)          34240000
                   ADD 1 TO PA-BCN-CURSOR-CNT                           34250000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          34260000
                   SET PS-END-OF-CURSOR  TO TRUE                        34270000
               WHEN SQLWARN0 NOT EQUAL SPACE                            34280000
               WHEN SQLCODE NOT EQUAL ZERO                              34290000
                   MOVE SQLCODE TO PV-SQL                               34300000
                   MOVE '3310-FETCH-BCN-CURSOR' TO PV-PARAGRAPH-NAME    34310000
                   STRING 'ERROR FETCHING BCN-CURSOR - SQLCODE = '      34320000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG34330000
                   END-STRING                                           34340000
                   SET ABEND-4002-READ-ERROR TO TRUE                    34350000
                   PERFORM 9100-SQL-ABEND                               34360000
           END-EVALUATE.                                                34370000
                                                                        34380000
                                                                        34390000
      ******************************************************************34400000
      *  CLOSE THE BCN CURSOR.                                          34410000
      ******************************************************************34420000
       3315-CLOSE-BCN-CURSOR.                                           34430000
                                                                        34440000
           EXEC SQL                                                     34450000
                CLOSE BCN-CURSOR                                        34460000
           END-EXEC.                                                    34470000
                                                                        34480000
           EVALUATE TRUE                                                34490000
               WHEN SQLCODE = ZERO                                      34500000
                    CONTINUE                                            34510000
               WHEN SQLWARN0 NOT EQUAL SPACE                            34520000
               WHEN SQLCODE NOT EQUAL ZERO                              34530000
                   MOVE SQLCODE TO PV-SQL                               34540000
                   MOVE '3315-CLOSE-BCN-CURSOR' TO PV-PARAGRAPH-NAME    34550000
                   STRING 'ERROR CLOSING BCN-CURSOR - SQLCODE = '       34560000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG34570000
                   END-STRING                                           34580000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   34590000
                   PERFORM 9100-SQL-ABEND                               34600000
           END-EVALUATE.                                                34610000
                                                                        34620000
                                                                        34630000
      ******************************************************************34640000
      *  OPEN THE DBN-CURSOR                                            34650000
      ******************************************************************34660000
       3320-OPEN-DBN-CURSOR.                                            34670000
                                                                        34680000
           EXEC SQL                                                     34690000
                OPEN DBN-CURSOR                                         34700000
           END-EXEC.                                                    34710000
                                                                        34720000
           EVALUATE TRUE                                                34730000
               WHEN SQLCODE = ZERO                                      34740000
                   CONTINUE                                             34750000
               WHEN SQLWARN0 NOT EQUAL SPACE                            34760000
               WHEN SQLCODE NOT EQUAL ZERO                              34770000
                   MOVE SQLCODE TO PV-SQL                               34780000
                   MOVE '3320-OPEN-DBN-CURSOR' TO PV-PARAGRAPH-NAME     34790000
                   STRING 'ERROR OPENING DBN-CURSOR - SQLCODE = '       34800000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG34810000
                   END-STRING                                           34820000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    34830000
                   PERFORM 9100-SQL-ABEND                               34840000
           END-EVALUATE.                                                34850000
                                                                        34860000
      ******************************************************************34870000
      *  FETCH THE DBN CURSOR.                                          34880000
      ******************************************************************34890000
       3325-FETCH-DBN-CURSOR.                                           34900000
                                                                        34910000
           EXEC SQL                                                     34920000
                FETCH DBN-CURSOR                                        34930000
                 INTO :PV-STR-NBR                                       34940000
                     ,:PV-DB2-SUM                                       34950000
           END-EXEC.                                                    34960000
                                                                        34970000
           EVALUATE TRUE                                                34980000
               WHEN SQLCODE = ZERO                                      34990000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        35000000
                   MOVE PV-DB2-SUM   TO GL-WS-DBN (PV-STR-NBR)          35010000
                   ADD 1 TO PA-DBN-CURSOR-CNT                           35020000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          35030000
                   SET PS-END-OF-CURSOR  TO TRUE                        35040000
               WHEN SQLWARN0 NOT EQUAL SPACE                            35050000
               WHEN SQLCODE NOT EQUAL ZERO                              35060000
                   MOVE SQLCODE TO PV-SQL                               35070000
                   MOVE '3325-FETCH-DBN-CURSOR' TO PV-PARAGRAPH-NAME    35080000
                   STRING 'ERROR FETCHING DBN-CURSOR - SQLCODE = '      35090000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG35100000
                   END-STRING                                           35110000
                   SET ABEND-4002-READ-ERROR TO TRUE                    35120000
                   PERFORM 9100-SQL-ABEND                               35130000
           END-EVALUATE.                                                35140000
                                                                        35150000
                                                                        35160000
      ******************************************************************35170000
      *  CLOSE THE DBN CURSOR.                                          35180000
      ******************************************************************35190000
       3330-CLOSE-DBN-CURSOR.                                           35200000
                                                                        35210000
           EXEC SQL                                                     35220000
                CLOSE DBN-CURSOR                                        35230000
           END-EXEC.                                                    35240000
                                                                        35250000
           EVALUATE TRUE                                                35260000
               WHEN SQLCODE = ZERO                                      35270000
                    CONTINUE                                            35280000
               WHEN SQLWARN0 NOT EQUAL SPACE                            35290000
               WHEN SQLCODE NOT EQUAL ZERO                              35300000
                   MOVE SQLCODE TO PV-SQL                               35310000
                   MOVE '3330-CLOSE-DBN-CURSOR' TO PV-PARAGRAPH-NAME    35320000
                   STRING 'ERROR CLOSING DBN-CURSOR - SQLCODE = '       35330000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG35340000
                   END-STRING                                           35350000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   35360000
                   PERFORM 9100-SQL-ABEND                               35370000
           END-EVALUATE.                                                35380000
                                                                        35390000
                                                                        35400000
      ******************************************************************35410000
      *  OPEN THE KCN-CURSOR                                            35420000
      ******************************************************************35430000
       3335-OPEN-KCN-CURSOR.                                            35440000
                                                                        35450000
           EXEC SQL                                                     35460000
                OPEN KCN-CURSOR                                         35470000
           END-EXEC.                                                    35480000
                                                                        35490000
           EVALUATE TRUE                                                35500000
               WHEN SQLCODE = ZERO                                      35510000
                   CONTINUE                                             35520000
               WHEN SQLWARN0 NOT EQUAL SPACE                            35530000
               WHEN SQLCODE NOT EQUAL ZERO                              35540000
                   MOVE SQLCODE TO PV-SQL                               35550000
                   MOVE '3335-OPEN-KCN-CURSOR' TO PV-PARAGRAPH-NAME     35560000
                   STRING 'ERROR OPENING KCN-CURSOR - SQLCODE = '       35570000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG35580000
                   END-STRING                                           35590000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    35600000
                   PERFORM 9100-SQL-ABEND                               35610000
           END-EVALUATE.                                                35620000
                                                                        35630000
      ******************************************************************35640000
      *  FETCH THE KCN CURSOR.                                          35650000
      ******************************************************************35660000
       3340-FETCH-KCN-CURSOR.                                           35670000
                                                                        35680000
           EXEC SQL                                                     35690000
                FETCH KCN-CURSOR                                        35700000
                 INTO :PV-STR-NBR                                       35710000
                     ,:PV-DB2-SUM                                       35720000
           END-EXEC.                                                    35730000
                                                                        35740000
           EVALUATE TRUE                                                35750000
               WHEN SQLCODE = ZERO                                      35760000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        35770000
                   MOVE PV-DB2-SUM   TO GL-WS-KCN (PV-STR-NBR)          35780000
                   ADD 1 TO PA-KCN-CURSOR-CNT                           35790000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          35800000
                   SET PS-END-OF-CURSOR  TO TRUE                        35810000
               WHEN SQLWARN0 NOT EQUAL SPACE                            35820000
               WHEN SQLCODE NOT EQUAL ZERO                              35830000
                   MOVE SQLCODE TO PV-SQL                               35840000
                   MOVE '3340-FETCH-KCN-CURSOR' TO PV-PARAGRAPH-NAME    35850000
                   STRING 'ERROR FETCHING KCN-CURSOR - SQLCODE = '      35860000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG35870000
                   END-STRING                                           35880000
                   SET ABEND-4002-READ-ERROR TO TRUE                    35890000
                   PERFORM 9100-SQL-ABEND                               35900000
           END-EVALUATE.                                                35910000
                                                                        35920000
                                                                        35930000
      ******************************************************************35940000
      *  CLOSE THE KCN CURSOR.                                          35950000
      ******************************************************************35960000
       3345-CLOSE-KCN-CURSOR.                                           35970000
                                                                        35980000
           EXEC SQL                                                     35990000
                CLOSE KCN-CURSOR                                        36000000
           END-EXEC.                                                    36010000
                                                                        36020000
           EVALUATE TRUE                                                36030000
               WHEN SQLCODE = ZERO                                      36040000
                    CONTINUE                                            36050000
               WHEN SQLWARN0 NOT EQUAL SPACE                            36060000
               WHEN SQLCODE NOT EQUAL ZERO                              36070000
                   MOVE SQLCODE TO PV-SQL                               36080000
                   MOVE '3345-CLOSE-KCN-CURSOR' TO PV-PARAGRAPH-NAME    36090000
                   STRING 'ERROR CLOSING KCN-CURSOR - SQLCODE = '       36100000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG36110000
                   END-STRING                                           36120000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   36130000
                   PERFORM 9100-SQL-ABEND                               36140000
           END-EVALUATE.                                                36150000
                                                                        36160000
                                                                        36170000
      ******************************************************************36180000
      *  OPEN THE NCN-CURSOR                                            36190000
      ******************************************************************36200000
       3350-OPEN-NCN-CURSOR.                                            36210000
                                                                        36220000
           EXEC SQL                                                     36230000
                OPEN NCN-CURSOR                                         36240000
           END-EXEC.                                                    36250000
                                                                        36260000
           EVALUATE TRUE                                                36270000
               WHEN SQLCODE = ZERO                                      36280000
                   CONTINUE                                             36290000
               WHEN SQLWARN0 NOT EQUAL SPACE                            36300000
               WHEN SQLCODE NOT EQUAL ZERO                              36310000
                   MOVE SQLCODE TO PV-SQL                               36320000
                   MOVE '3350-OPEN-NCN-CURSOR' TO PV-PARAGRAPH-NAME     36330000
                   STRING 'ERROR OPENING NCN-CURSOR - SQLCODE = '       36340000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG36350000
                   END-STRING                                           36360000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    36370000
                   PERFORM 9100-SQL-ABEND                               36380000
           END-EVALUATE.                                                36390000
                                                                        36400000
      ******************************************************************36410000
      *  FETCH THE NCN CURSOR.                                          36420000
      ******************************************************************36430000
       3355-FETCH-NCN-CURSOR.                                           36440000
                                                                        36450000
           EXEC SQL                                                     36460000
                FETCH NCN-CURSOR                                        36470000
                 INTO :PV-STR-NBR                                       36480000
                     ,:PV-DB2-SUM                                       36490000
           END-EXEC.                                                    36500000
                                                                        36510000
           EVALUATE TRUE                                                36520000
               WHEN SQLCODE = ZERO                                      36530000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        36540000
                   MOVE PV-DB2-SUM   TO GL-WS-NCN (PV-STR-NBR)          36550000
                   ADD 1 TO PA-NCN-CURSOR-CNT                           36560000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          36570000
                   SET PS-END-OF-CURSOR  TO TRUE                        36580000
               WHEN SQLWARN0 NOT EQUAL SPACE                            36590000
               WHEN SQLCODE NOT EQUAL ZERO                              36600000
                   MOVE SQLCODE TO PV-SQL                               36610000
                   MOVE '3355-FETCH-NCN-CURSOR' TO PV-PARAGRAPH-NAME    36620000
                   STRING 'ERROR FETCHING NCN-CURSOR - SQLCODE = '      36630000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG36640000
                   END-STRING                                           36650000
                   SET ABEND-4002-READ-ERROR TO TRUE                    36660000
                   PERFORM 9100-SQL-ABEND                               36670000
           END-EVALUATE.                                                36680000
                                                                        36690000
                                                                        36700000
      ******************************************************************36710000
      *  CLOSE THE NCN CURSOR.                                          36720000
      ******************************************************************36730000
       3360-CLOSE-NCN-CURSOR.                                           36740000
                                                                        36750000
           EXEC SQL                                                     36760000
                CLOSE NCN-CURSOR                                        36770000
           END-EXEC.                                                    36780000
                                                                        36790000
           EVALUATE TRUE                                                36800000
               WHEN SQLCODE = ZERO                                      36810000
                    CONTINUE                                            36820000
               WHEN SQLWARN0 NOT EQUAL SPACE                            36830000
               WHEN SQLCODE NOT EQUAL ZERO                              36840000
                   MOVE SQLCODE TO PV-SQL                               36850000
                   MOVE '3360-CLOSE-NCN-CURSOR' TO PV-PARAGRAPH-NAME    36860000
                   STRING 'ERROR CLOSING NCN-CURSOR - SQLCODE = '       36870000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG36880000
                   END-STRING                                           36890000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   36900000
                   PERFORM 9100-SQL-ABEND                               36910000
           END-EVALUATE.                                                36920000
                                                                        36930000
                                                                        36940000
      ******************************************************************36950000
      *  OPEN THE GDT-CURSOR                                            36960000
      ******************************************************************36970000
       3365-OPEN-GDT-CURSOR.                                            36980000
                                                                        36990000
           EXEC SQL                                                     37000000
                OPEN GDT-CURSOR                                         37010000
           END-EXEC.                                                    37020000
                                                                        37030000
           EVALUATE TRUE                                                37040000
               WHEN SQLCODE = ZERO                                      37050000
                   CONTINUE                                             37060000
               WHEN SQLWARN0 NOT EQUAL SPACE                            37070000
               WHEN SQLCODE NOT EQUAL ZERO                              37080000
                   MOVE SQLCODE TO PV-SQL                               37090000
                   MOVE '3365-OPEN-GDT-CURSOR' TO PV-PARAGRAPH-NAME     37100000
                   STRING 'ERROR OPENING GDT-CURSOR - SQLCODE = '       37110000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG37120000
                   END-STRING                                           37130000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    37140000
                   PERFORM 9100-SQL-ABEND                               37150000
           END-EVALUATE.                                                37160000
                                                                        37170000
      ******************************************************************37180000
      *  FETCH THE GDT CURSOR.                                          37190000
      ******************************************************************37200000
       3370-FETCH-GDT-CURSOR.                                           37210000
                                                                        37220000
           EXEC SQL                                                     37230000
                FETCH GDT-CURSOR                                        37240000
                 INTO :PV-STR-NBR                                       37250000
                     ,:PV-DB2-SUM                                       37260000
           END-EXEC.                                                    37270000
                                                                        37280000
           EVALUATE TRUE                                                37290000
               WHEN SQLCODE = ZERO                                      37300000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        37310000
                   MOVE PV-DB2-SUM   TO GL-WS-GDT (PV-STR-NBR)          37320000
                   ADD 1 TO PA-GDT-CURSOR-CNT                           37330000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          37340000
                   SET PS-END-OF-CURSOR  TO TRUE                        37350000
               WHEN SQLWARN0 NOT EQUAL SPACE                            37360000
               WHEN SQLCODE NOT EQUAL ZERO                              37370000
                   MOVE SQLCODE TO PV-SQL                               37380000
                   MOVE '3370-FETCH-GDT-CURSOR' TO PV-PARAGRAPH-NAME    37390000
                   STRING 'ERROR FETCHING GDT-CURSOR - SQLCODE = '      37400000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG37410000
                   END-STRING                                           37420000
                   SET ABEND-4002-READ-ERROR TO TRUE                    37430000
                   PERFORM 9100-SQL-ABEND                               37440000
           END-EVALUATE.                                                37450000
                                                                        37460000
                                                                        37470000
      ******************************************************************37480000
      *  CLOSE THE GDT CURSOR.                                          37490000
      ******************************************************************37500000
       3375-CLOSE-GDT-CURSOR.                                           37510000
                                                                        37520000
           EXEC SQL                                                     37530000
                CLOSE GDT-CURSOR                                        37540000
           END-EXEC.                                                    37550000
                                                                        37560000
           EVALUATE TRUE                                                37570000
               WHEN SQLCODE = ZERO                                      37580000
                    CONTINUE                                            37590000
               WHEN SQLWARN0 NOT EQUAL SPACE                            37600000
               WHEN SQLCODE NOT EQUAL ZERO                              37610000
                   MOVE SQLCODE TO PV-SQL                               37620000
                   MOVE '3375-CLOSE-GDT-CURSOR' TO PV-PARAGRAPH-NAME    37630000
                   STRING 'ERROR CLOSING GDT-CURSOR - SQLCODE = '       37640000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG37650000
                   END-STRING                                           37660000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   37670000
                   PERFORM 9100-SQL-ABEND                               37680000
           END-EVALUATE.                                                37690000
                                                                        37700000
                                                                        37710000
      ******************************************************************37720000
      *  OPEN THE KMT-CURSOR                                            37730000
      ******************************************************************37740000
       3380-OPEN-KMT-CURSOR.                                            37750000
                                                                        37760000
           EXEC SQL                                                     37770000
                OPEN KMT-CURSOR                                         37780000
           END-EXEC.                                                    37790000
                                                                        37800000
           EVALUATE TRUE                                                37810000
               WHEN SQLCODE = ZERO                                      37820000
                   CONTINUE                                             37830000
               WHEN SQLWARN0 NOT EQUAL SPACE                            37840000
               WHEN SQLCODE NOT EQUAL ZERO                              37850000
                   MOVE SQLCODE TO PV-SQL                               37860000
                   MOVE '3380-OPEN-KMT-CURSOR' TO PV-PARAGRAPH-NAME     37870000
                   STRING 'ERROR OPENING KMT-CURSOR - SQLCODE = '       37880000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG37890000
                   END-STRING                                           37900000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    37910000
                   PERFORM 9100-SQL-ABEND                               37920000
           END-EVALUATE.                                                37930000
                                                                        37940000
      ******************************************************************37950000
      *  FETCH THE KMT CURSOR.                                          37960000
      ******************************************************************37970000
       3385-FETCH-KMT-CURSOR.                                           37980000
                                                                        37990000
           EXEC SQL                                                     38000000
                FETCH KMT-CURSOR                                        38010000
                 INTO :PV-STR-NBR                                       38020000
                     ,:PV-DB2-SUM                                       38030000
           END-EXEC.                                                    38040000
                                                                        38050000
           EVALUATE TRUE                                                38060000
               WHEN SQLCODE = ZERO                                      38070000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        38080000
                   MOVE PV-DB2-SUM   TO GL-WS-KMT (PV-STR-NBR)          38090000
                   ADD 1 TO PA-KMT-CURSOR-CNT                           38100000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          38110000
                   SET PS-END-OF-CURSOR  TO TRUE                        38120000
               WHEN SQLWARN0 NOT EQUAL SPACE                            38130000
               WHEN SQLCODE NOT EQUAL ZERO                              38140000
                   MOVE SQLCODE TO PV-SQL                               38150000
                   MOVE '3385-FETCH-KMT-CURSOR' TO PV-PARAGRAPH-NAME    38160000
                   STRING 'ERROR FETCHING KMT-CURSOR - SQLCODE = '      38170000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG38180000
                   END-STRING                                           38190000
                   SET ABEND-4002-READ-ERROR TO TRUE                    38200000
                   PERFORM 9100-SQL-ABEND                               38210000
           END-EVALUATE.                                                38220000
                                                                        38230000
                                                                        38240000
      ******************************************************************38250000
      *  CLOSE THE KMT CURSOR.                                          38260000
      ******************************************************************38270000
       3390-CLOSE-KMT-CURSOR.                                           38280000
                                                                        38290000
           EXEC SQL                                                     38300000
                CLOSE KMT-CURSOR                                        38310000
           END-EXEC.                                                    38320000
                                                                        38330000
           EVALUATE TRUE                                                38340000
               WHEN SQLCODE = ZERO                                      38350000
                    CONTINUE                                            38360000
               WHEN SQLWARN0 NOT EQUAL SPACE                            38370000
               WHEN SQLCODE NOT EQUAL ZERO                              38380000
                   MOVE SQLCODE TO PV-SQL                               38390000
                   MOVE '3390-CLOSE-KMT-CURSOR' TO PV-PARAGRAPH-NAME    38400000
                   STRING 'ERROR CLOSING KMT-CURSOR - SQLCODE = '       38410000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG38420000
                   END-STRING                                           38430000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   38440000
                   PERFORM 9100-SQL-ABEND                               38450000
           END-EVALUATE.                                                38460000
                                                                        38470000
                                                                        38480000
      ******************************************************************38490000
      *  OPEN THE KMI-CURSOR                                            38500000
      ******************************************************************38510000
       3395-OPEN-KMI-CURSOR.                                            38520000
                                                                        38530000
           EXEC SQL                                                     38540000
                OPEN KMI-CURSOR                                         38550000
           END-EXEC.                                                    38560000
                                                                        38570000
           EVALUATE TRUE                                                38580000
               WHEN SQLCODE = ZERO                                      38590000
                   CONTINUE                                             38600000
               WHEN SQLWARN0 NOT EQUAL SPACE                            38610000
               WHEN SQLCODE NOT EQUAL ZERO                              38620000
                   MOVE SQLCODE TO PV-SQL                               38630000
                   MOVE '3395-OPEN-KMI-CURSOR' TO PV-PARAGRAPH-NAME     38640000
                   STRING 'ERROR OPENING KMI-CURSOR - SQLCODE = '       38650000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG38660000
                   END-STRING                                           38670000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    38680000
                   PERFORM 9100-SQL-ABEND                               38690000
           END-EVALUATE.                                                38700000
                                                                        38710000
      ******************************************************************38720000
      *  FETCH THE KMI CURSOR.                                          38730000
      ******************************************************************38740000
       3400-FETCH-KMI-CURSOR.                                           38750000
                                                                        38760000
           EXEC SQL                                                     38770000
                FETCH KMI-CURSOR                                        38780000
                 INTO :PV-STR-NBR                                       38790000
                     ,:PV-DB2-SUM                                       38800000
           END-EXEC.                                                    38810000
                                                                        38820000
           EVALUATE TRUE                                                38830000
               WHEN SQLCODE = ZERO                                      38840000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        38850000
                   MOVE PV-DB2-SUM   TO GL-WS-KMI (PV-STR-NBR)          38860000
                   ADD 1 TO PA-KMI-CURSOR-CNT                           38870000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          38880000
                   SET PS-END-OF-CURSOR  TO TRUE                        38890000
               WHEN SQLWARN0 NOT EQUAL SPACE                            38900000
               WHEN SQLCODE NOT EQUAL ZERO                              38910000
                   MOVE SQLCODE TO PV-SQL                               38920000
                   MOVE '3400-FETCH-KMI-CURSOR' TO PV-PARAGRAPH-NAME    38930000
                   STRING 'ERROR FETCHING KMI-CURSOR - SQLCODE = '      38940000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG38950000
                   END-STRING                                           38960000
                   SET ABEND-4002-READ-ERROR TO TRUE                    38970000
                   PERFORM 9100-SQL-ABEND                               38980000
           END-EVALUATE.                                                38990000
                                                                        39000000
                                                                        39010000
      ******************************************************************39020000
      *  CLOSE THE KMI CURSOR.                                          39030000
      ******************************************************************39040000
       3405-CLOSE-KMI-CURSOR.                                           39050000
                                                                        39060000
           EXEC SQL                                                     39070000
                CLOSE KMI-CURSOR                                        39080000
           END-EXEC.                                                    39090000
                                                                        39100000
           EVALUATE TRUE                                                39110000
               WHEN SQLCODE = ZERO                                      39120000
                    CONTINUE                                            39130000
               WHEN SQLWARN0 NOT EQUAL SPACE                            39140000
               WHEN SQLCODE NOT EQUAL ZERO                              39150000
                   MOVE SQLCODE TO PV-SQL                               39160000
                   MOVE '3405-CLOSE-KMI-CURSOR' TO PV-PARAGRAPH-NAME    39170000
                   STRING 'ERROR CLOSING KMI-CURSOR - SQLCODE = '       39180000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG39190000
                   END-STRING                                           39200000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   39210000
                   PERFORM 9100-SQL-ABEND                               39220000
           END-EVALUATE.                                                39230000
                                                                        39240000
                                                                        39250000
      ******************************************************************39260000
      *  OPEN THE CASH-CURSOR                                           39270000
      ******************************************************************39280000
       3410-OPEN-CASH-CURSOR.                                           39290000
                                                                        39300000
           EXEC SQL                                                     39310000
                OPEN CASH-CURSOR                                        39320000
           END-EXEC.                                                    39330000
                                                                        39340000
           EVALUATE TRUE                                                39350000
               WHEN SQLCODE = ZERO                                      39360000
                   CONTINUE                                             39370000
               WHEN SQLWARN0 NOT EQUAL SPACE                            39380000
               WHEN SQLCODE NOT EQUAL ZERO                              39390000
                   MOVE SQLCODE TO PV-SQL                               39400000
                   MOVE '3410-OPEN-CASH-CURSOR' TO PV-PARAGRAPH-NAME    39410000
                   STRING 'ERROR OPENING CASH-CURSOR - SQLCODE = '      39420000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG39430000
                   END-STRING                                           39440000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    39450000
                   PERFORM 9100-SQL-ABEND                               39460000
           END-EVALUATE.                                                39470000
                                                                        39480000
      ******************************************************************39490000
      *  FETCH THE CASH CURSOR.                                         39500000
      ******************************************************************39510000
       3415-FETCH-CASH-CURSOR.                                          39520000
                                                                        39530000
           EXEC SQL                                                     39540000
                FETCH CASH-CURSOR                                       39550000
                 INTO :PV-STR-NBR                                       39560000
                     ,:PV-DB2-SUM                                       39570000
           END-EXEC.                                                    39580000
                                                                        39590000
           EVALUATE TRUE                                                39600000
               WHEN SQLCODE = ZERO                                      39610000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        39620000
                   MOVE PV-DB2-SUM   TO GL-WS-CASH (PV-STR-NBR)         39630000
                   ADD 1 TO PA-CASH-CURSOR-CNT                          39640000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          39650000
                   SET PS-END-OF-CURSOR  TO TRUE                        39660000
               WHEN SQLWARN0 NOT EQUAL SPACE                            39670000
               WHEN SQLCODE NOT EQUAL ZERO                              39680000
                   MOVE SQLCODE TO PV-SQL                               39690000
                   MOVE '3415-FETCH-CASH-CURSOR' TO PV-PARAGRAPH-NAME   39700000
                   STRING 'ERROR FETCHING CASH-CURSOR - SQLCODE = '     39710000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG39720000
                   END-STRING                                           39730000
                   SET ABEND-4002-READ-ERROR TO TRUE                    39740000
                   PERFORM 9100-SQL-ABEND                               39750000
           END-EVALUATE.                                                39760000
                                                                        39770000
                                                                        39780000
      ******************************************************************39790000
      *  CLOSE THE CASH CURSOR.                                         39800000
      ******************************************************************39810000
       3420-CLOSE-CASH-CURSOR.                                          39820000
                                                                        39830000
           EXEC SQL                                                     39840000
                CLOSE CASH-CURSOR                                       39850000
           END-EXEC.                                                    39860000
                                                                        39870000
           EVALUATE TRUE                                                39880000
               WHEN SQLCODE = ZERO                                      39890000
                    CONTINUE                                            39900000
               WHEN SQLWARN0 NOT EQUAL SPACE                            39910000
               WHEN SQLCODE NOT EQUAL ZERO                              39920000
                   MOVE SQLCODE TO PV-SQL                               39930000
                   MOVE '3420-CLOSE-CASH-CURSOR' TO PV-PARAGRAPH-NAME   39940000
                   STRING 'ERROR CLOSING CASH-CURSOR - SQLCODE = '      39950000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG39960000
                   END-STRING                                           39970000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   39980000
                   PERFORM 9100-SQL-ABEND                               39990000
           END-EVALUATE.                                                40000000
                                                                        40010000
                                                                        40020000
      ******************************************************************40030000
      *  OPEN THE CHECK-CURSOR                                          40040000
      ******************************************************************40050000
       3425-OPEN-CHECK-CURSOR.                                          40060000
                                                                        40070000
           EXEC SQL                                                     40080000
                OPEN CHECK-CURSOR                                       40090000
           END-EXEC.                                                    40100000
                                                                        40110000
           EVALUATE TRUE                                                40120000
               WHEN SQLCODE = ZERO                                      40130000
                   CONTINUE                                             40140000
               WHEN SQLWARN0 NOT EQUAL SPACE                            40150000
               WHEN SQLCODE NOT EQUAL ZERO                              40160000
                   MOVE SQLCODE TO PV-SQL                               40170000
                   MOVE '3425-OPEN-CHECK-CURSOR' TO PV-PARAGRAPH-NAME   40180000
                   STRING 'ERROR OPENING CHECK-CURSOR - SQLCODE = '     40190000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG40200000
                   END-STRING                                           40210000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    40220000
                   PERFORM 9100-SQL-ABEND                               40230000
           END-EVALUATE.                                                40240000
                                                                        40250000
      ******************************************************************40260000
      *  FETCH THE CHECK CURSOR.                                        40270000
      ******************************************************************40280000
       3430-FETCH-CHECK-CURSOR.                                         40290000
                                                                        40300000
           EXEC SQL                                                     40310000
                FETCH CHECK-CURSOR                                      40320000
                 INTO :PV-STR-NBR                                       40330000
                     ,:PV-DB2-SUM                                       40340000
           END-EXEC.                                                    40350000
                                                                        40360000
           EVALUATE TRUE                                                40370000
               WHEN SQLCODE = ZERO                                      40380000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        40390000
                   MOVE PV-DB2-SUM   TO GL-WS-CHECK (PV-STR-NBR)        40400000
                   ADD 1 TO PA-CHECK-CURSOR-CNT                         40410000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          40420000
                   SET PS-END-OF-CURSOR  TO TRUE                        40430000
               WHEN SQLWARN0 NOT EQUAL SPACE                            40440000
               WHEN SQLCODE NOT EQUAL ZERO                              40450000
                   MOVE SQLCODE TO PV-SQL                               40460000
                   MOVE '3430-FETCH-CHECK-CURSOR' TO PV-PARAGRAPH-NAME  40470000
                   STRING 'ERROR FETCHING CHECK-CURSOR - SQLCODE = '    40480000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG40490000
                   END-STRING                                           40500000
                   SET ABEND-4002-READ-ERROR TO TRUE                    40510000
                   PERFORM 9100-SQL-ABEND                               40520000
           END-EVALUATE.                                                40530000
                                                                        40540000
                                                                        40550000
      ******************************************************************40560000
      *  CLOSE THE CHECK CURSOR.                                        40570000
      ******************************************************************40580000
       3435-CLOSE-CHECK-CURSOR.                                         40590000
                                                                        40600000
           EXEC SQL                                                     40610000
                CLOSE CHECK-CURSOR                                      40620000
           END-EXEC.                                                    40630000
                                                                        40640000
           EVALUATE TRUE                                                40650000
               WHEN SQLCODE = ZERO                                      40660000
                    CONTINUE                                            40670000
               WHEN SQLWARN0 NOT EQUAL SPACE                            40680000
               WHEN SQLCODE NOT EQUAL ZERO                              40690000
                   MOVE SQLCODE TO PV-SQL                               40700000
                   MOVE '3435-CLOSE-CHECK-CURSOR' TO PV-PARAGRAPH-NAME  40710000
                   STRING 'ERROR CLOSING CHECK-CURSOR - SQLCODE = '     40720000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG40730000
                   END-STRING                                           40740000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   40750000
                   PERFORM 9100-SQL-ABEND                               40760000
           END-EVALUATE.                                                40770000
                                                                        40780000
                                                                        40790000
      ******************************************************************40800000
      *  OPEN THE KCP-CURSOR                                            40810000
      ******************************************************************40820000
       3440-OPEN-KCP-CURSOR.                                            40830000
                                                                        40840000
           EXEC SQL                                                     40850000
                OPEN KCP-CURSOR                                         40860000
           END-EXEC.                                                    40870000
                                                                        40880000
           EVALUATE TRUE                                                40890000
               WHEN SQLCODE = ZERO                                      40900000
                   CONTINUE                                             40910000
               WHEN SQLWARN0 NOT EQUAL SPACE                            40920000
               WHEN SQLCODE NOT EQUAL ZERO                              40930000
                   MOVE SQLCODE TO PV-SQL                               40940000
                   MOVE '3440-OPEN-KCP-CURSOR' TO PV-PARAGRAPH-NAME     40950000
                   STRING 'ERROR OPENING KCP-CURSOR - SQLCODE = '       40960000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG40970000
                   END-STRING                                           40980000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    40990000
                   PERFORM 9100-SQL-ABEND                               41000000
           END-EVALUATE.                                                41010000
                                                                        41020000
      ******************************************************************41030000
      *  FETCH THE KCP CURSOR.                                          41040000
      ******************************************************************41050000
       3445-FETCH-KCP-CURSOR.                                           41060000
                                                                        41070000
           EXEC SQL                                                     41080000
                FETCH KCP-CURSOR                                        41090000
                 INTO :PV-STR-NBR                                       41100000
                     ,:PV-DB2-SUM                                       41110000
           END-EXEC.                                                    41120000
                                                                        41130000
           EVALUATE TRUE                                                41140000
               WHEN SQLCODE = ZERO                                      41150000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        41160000
                   MOVE PV-DB2-SUM   TO GL-WS-KCP (PV-STR-NBR)          41170000
                   ADD 1 TO PA-KCP-CURSOR-CNT                           41180000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          41190000
                   SET PS-END-OF-CURSOR  TO TRUE                        41200000
               WHEN SQLWARN0 NOT EQUAL SPACE                            41210000
               WHEN SQLCODE NOT EQUAL ZERO                              41220000
                   MOVE SQLCODE TO PV-SQL                               41230000
                   MOVE '3445-FETCH-KCP-CURSOR' TO PV-PARAGRAPH-NAME    41240000
                   STRING 'ERROR FETCHING KCP-CURSOR - SQLCODE = '      41250000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG41260000
                   END-STRING                                           41270000
                   SET ABEND-4002-READ-ERROR TO TRUE                    41280000
                   PERFORM 9100-SQL-ABEND                               41290000
           END-EVALUATE.                                                41300000
                                                                        41310000
                                                                        41320000
      ******************************************************************41330000
      *  CLOSE THE KCP CURSOR.                                          41340000
      ******************************************************************41350000
       3450-CLOSE-KCP-CURSOR.                                           41360000
                                                                        41370000
           EXEC SQL                                                     41380000
                CLOSE KCP-CURSOR                                        41390000
           END-EXEC.                                                    41400000
                                                                        41410000
           EVALUATE TRUE                                                41420000
               WHEN SQLCODE = ZERO                                      41430000
                    CONTINUE                                            41440000
               WHEN SQLWARN0 NOT EQUAL SPACE                            41450000
               WHEN SQLCODE NOT EQUAL ZERO                              41460000
                   MOVE SQLCODE TO PV-SQL                               41470000
                   MOVE '3450-CLOSE-KCP-CURSOR' TO PV-PARAGRAPH-NAME    41480000
                   STRING 'ERROR CLOSING KCP-CURSOR - SQLCODE = '       41490000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG41500000
                   END-STRING                                           41510000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   41520000
                   PERFORM 9100-SQL-ABEND                               41530000
           END-EVALUATE.                                                41540000
                                                                        41550000
                                                                        41560000
      ******************************************************************41570000
      *  OPEN THE CRI-CURSOR                                            41580000
      ******************************************************************41590000
       3455-OPEN-CRI-CURSOR.                                            41600000
                                                                        41610000
           EXEC SQL                                                     41620000
                OPEN CRI-CURSOR                                         41630000
           END-EXEC.                                                    41640000
                                                                        41650000
           EVALUATE TRUE                                                41660000
               WHEN SQLCODE = ZERO                                      41670000
                   CONTINUE                                             41680000
               WHEN SQLWARN0 NOT EQUAL SPACE                            41690000
               WHEN SQLCODE NOT EQUAL ZERO                              41700000
                   MOVE SQLCODE TO PV-SQL                               41710000
                   MOVE '3455-OPEN-CRI-CURSOR' TO PV-PARAGRAPH-NAME     41720000
                   STRING 'ERROR OPENING CRI-CURSOR - SQLCODE = '       41730000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG41740000
                   END-STRING                                           41750000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    41760000
                   PERFORM 9100-SQL-ABEND                               41770000
           END-EVALUATE.                                                41780000
                                                                        41790000
      ******************************************************************41800000
      *  FETCH THE CRI CURSOR.                                          41810000
      ******************************************************************41820000
       3460-FETCH-CRI-CURSOR.                                           41830000
                                                                        41840000
           EXEC SQL                                                     41850000
                FETCH CRI-CURSOR                                        41860000
                 INTO :PV-STR-NBR                                       41870000
                     ,:PV-DB2-SUM                                       41880000
           END-EXEC.                                                    41890000
                                                                        41900000
           EVALUATE TRUE                                                41910000
               WHEN SQLCODE = ZERO                                      41920000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        41930000
                   MOVE PV-DB2-SUM   TO GL-WS-CRI (PV-STR-NBR)          41940000
                   ADD 1 TO PA-CRI-CURSOR-CNT                           41950000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          41960000
                   SET PS-END-OF-CURSOR  TO TRUE                        41970000
               WHEN SQLWARN0 NOT EQUAL SPACE                            41980000
               WHEN SQLCODE NOT EQUAL ZERO                              41990000
                   MOVE SQLCODE TO PV-SQL                               42000000
                   MOVE '3460-FETCH-CRI-CURSOR' TO PV-PARAGRAPH-NAME    42010000
                   STRING 'ERROR FETCHING CRI-CURSOR - SQLCODE = '      42020000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG42030000
                   END-STRING                                           42040000
                   SET ABEND-4002-READ-ERROR TO TRUE                    42050000
                   PERFORM 9100-SQL-ABEND                               42060000
           END-EVALUATE.                                                42070000
                                                                        42080000
                                                                        42090000
      ******************************************************************42100000
      *  CLOSE THE CRI CURSOR.                                          42110000
      ******************************************************************42120000
       3465-CLOSE-CRI-CURSOR.                                           42130000
                                                                        42140000
           EXEC SQL                                                     42150000
                CLOSE CRI-CURSOR                                        42160000
           END-EXEC.                                                    42170000
                                                                        42180000
           EVALUATE TRUE                                                42190000
               WHEN SQLCODE = ZERO                                      42200000
                    CONTINUE                                            42210000
               WHEN SQLWARN0 NOT EQUAL SPACE                            42220000
               WHEN SQLCODE NOT EQUAL ZERO                              42230000
                   MOVE SQLCODE TO PV-SQL                               42240000
                   MOVE '3465-CLOSE-CRI-CURSOR' TO PV-PARAGRAPH-NAME    42250000
                   STRING 'ERROR CLOSING CRI-CURSOR - SQLCODE = '       42260000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG42270000
                   END-STRING                                           42280000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   42290000
                   PERFORM 9100-SQL-ABEND                               42300000
           END-EVALUATE.                                                42310000
                                                                        42320000
                                                                        42330000
      ******************************************************************42340000
      *  OPEN THE EMPDISC-CURSOR                                        42350000
      ******************************************************************42360000
       3470-OPEN-EMPDISC-CURSOR.                                        42370000
                                                                        42380000
           EXEC SQL                                                     42390000
                OPEN EMPDISC-CURSOR                                     42400000
           END-EXEC.                                                    42410000
                                                                        42420000
           EVALUATE TRUE                                                42430000
               WHEN SQLCODE = ZERO                                      42440000
                   CONTINUE                                             42450000
               WHEN SQLWARN0 NOT EQUAL SPACE                            42460000
               WHEN SQLCODE NOT EQUAL ZERO                              42470000
                   MOVE SQLCODE TO PV-SQL                               42480000
                   MOVE '3470-OPEN-EMPDISC-CURSOR' TO PV-PARAGRAPH-NAME 42490000
                   STRING 'ERROR OPENING EMPDISC-CURSOR - SQLCODE = '   42500000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG42510000
                   END-STRING                                           42520000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    42530000
                   PERFORM 9100-SQL-ABEND                               42540000
           END-EVALUATE.                                                42550000
                                                                        42560000
      ******************************************************************42570000
      *  FETCH THE EMPDISC CURSOR.                                      42580000
      ******************************************************************42590000
       3475-FETCH-EMPDISC-CURSOR.                                       42600000
                                                                        42610000
           EXEC SQL                                                     42620000
                FETCH EMPDISC-CURSOR                                    42630000
                 INTO :PV-STR-NBR                                       42640000
                     ,:PV-DB2-SUM                                       42650000
           END-EXEC.                                                    42660000
                                                                        42670000
           EVALUATE TRUE                                                42680000
               WHEN SQLCODE = ZERO                                      42690000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        42700000
                   MOVE PV-DB2-SUM   TO GL-WS-EMPDISC (PV-STR-NBR)      42710000
                   ADD 1 TO PA-EMPDISC-CURSOR-CNT                       42720000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          42730000
                   SET PS-END-OF-CURSOR  TO TRUE                        42740000
               WHEN SQLWARN0 NOT EQUAL SPACE                            42750000
               WHEN SQLCODE NOT EQUAL ZERO                              42760000
                   MOVE SQLCODE TO PV-SQL                               42770000
                   MOVE '3475-FETCH-EMPDISC-CURSOR' TO PV-PARAGRAPH-NAME42780000
                   STRING 'ERROR FETCHING EMPDISC-CURSOR - SQLCODE = '  42790000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG42800000
                   END-STRING                                           42810000
                   SET ABEND-4002-READ-ERROR TO TRUE                    42820000
                   PERFORM 9100-SQL-ABEND                               42830000
           END-EVALUATE.                                                42840000
                                                                        42850000
                                                                        42860000
      ******************************************************************42870000
      *  CLOSE THE EMPDISC CURSOR.                                      42880000
      ******************************************************************42890000
       3480-CLOSE-EMPDISC-CURSOR.                                       42900000
                                                                        42910000
           EXEC SQL                                                     42920000
                CLOSE EMPDISC-CURSOR                                    42930000
           END-EXEC.                                                    42940000
                                                                        42950000
           EVALUATE TRUE                                                42960000
               WHEN SQLCODE = ZERO                                      42970000
                    CONTINUE                                            42980000
               WHEN SQLWARN0 NOT EQUAL SPACE                            42990000
               WHEN SQLCODE NOT EQUAL ZERO                              43000000
                   MOVE SQLCODE TO PV-SQL                               43010000
                   MOVE '3480-CLOSE-EMPDISC-CURSOR' TO PV-PARAGRAPH-NAME43020000
                   STRING 'ERROR CLOSING EMPDISC-CURSOR - SQLCODE = '   43030000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43040000
                   END-STRING                                           43050000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   43060000
                   PERFORM 9100-SQL-ABEND                               43070000
           END-EVALUATE.                                                43080000
                                                                        43090000
                                                                        43100000
      ******************************************************************43110000
      *  OPEN THE KKT-CURSOR                                            43120000
      ******************************************************************43130000
       3485-OPEN-KKT-CURSOR.                                            43140000
                                                                        43150000
           EXEC SQL                                                     43160000
                OPEN KKT-CURSOR                                         43170000
           END-EXEC.                                                    43180000
                                                                        43190000
           EVALUATE TRUE                                                43200000
               WHEN SQLCODE = ZERO                                      43210000
                   CONTINUE                                             43220000
               WHEN SQLWARN0 NOT EQUAL SPACE                            43230000
               WHEN SQLCODE NOT EQUAL ZERO                              43240000
                   MOVE SQLCODE TO PV-SQL                               43250000
                   MOVE '3485-OPEN-KKT-CURSOR' TO PV-PARAGRAPH-NAME     43260000
                   STRING 'ERROR OPENING KKT-CURSOR - SQLCODE = '       43270000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43280000
                   END-STRING                                           43290000
                   SET ABEND-4005-OPEN-ERROR TO TRUE                    43300000
                   PERFORM 9100-SQL-ABEND                               43310000
           END-EVALUATE.                                                43320000
                                                                        43330000
      ******************************************************************43340000
      *  FETCH THE KKT CURSOR.                                          43350000
      ******************************************************************43360000
       3490-FETCH-KKT-CURSOR.                                           43370000
                                                                        43380000
           EXEC SQL                                                     43390000
                FETCH KKT-CURSOR                                        43400000
                 INTO :PV-STR-NBR                                       43410000
                     ,:PV-DB2-SUM                                       43420000
           END-EXEC.                                                    43430000
                                                                        43440000
           EVALUATE TRUE                                                43450000
               WHEN SQLCODE = ZERO                                      43460000
                   MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43470000
                   MOVE PV-DB2-SUM   TO GL-WS-KKT (PV-STR-NBR)          43480000
                   ADD 1 TO PA-KKT-CURSOR-CNT                           43490000
               WHEN SQLCODE = PC-ROW-NOT-FOUND                          43500000
                   SET PS-END-OF-CURSOR  TO TRUE                        43510000
               WHEN SQLWARN0 NOT EQUAL SPACE                            43520000
               WHEN SQLCODE NOT EQUAL ZERO                              43530000
                   MOVE SQLCODE TO PV-SQL                               43540000
                   MOVE '3490-FETCH-KKT-CURSOR' TO PV-PARAGRAPH-NAME    43550000
                   STRING 'ERROR FETCHING KKT-CURSOR - SQLCODE = '      43560000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43570000
                   END-STRING                                           43580000
                   SET ABEND-4002-READ-ERROR TO TRUE                    43590000
                   PERFORM 9100-SQL-ABEND                               43600000
           END-EVALUATE.                                                43610000
                                                                        43620000
                                                                        43630000
      ******************************************************************43640000
      *  CLOSE THE KKT CURSOR.                                          43650000
      ******************************************************************43660000
       3495-CLOSE-KKT-CURSOR.                                           43670000
                                                                        43680000
           EXEC SQL                                                     43690000
                CLOSE KKT-CURSOR                                        43700000
           END-EXEC.                                                    43710000
                                                                        43720000
           EVALUATE TRUE                                                43730000
               WHEN SQLCODE = ZERO                                      43740000
                    CONTINUE                                            43750000
               WHEN SQLWARN0 NOT EQUAL SPACE                            43760000
               WHEN SQLCODE NOT EQUAL ZERO                              43770000
                   MOVE SQLCODE TO PV-SQL                               43780000
                   MOVE '3495-CLOSE-KKT-CURSOR' TO PV-PARAGRAPH-NAME    43790000
                   STRING 'ERROR CLOSING KKT-CURSOR - SQLCODE = '       43800000
                      PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43810000
                   END-STRING                                           43820000
                   SET ABEND-4006-CLOSE-ERROR TO TRUE                   43830000
                   PERFORM 9100-SQL-ABEND                               43840000
           END-EVALUATE.                                                43850000
                                                                        43860000
2023                                                                    43861000
2023  ******************************************************************43862000
2023  *  OPEN THE SGS-CURSOR                                            43863000
2023  ******************************************************************43864000
2023   3500-OPEN-SGS-CURSOR.                                            43865000
2023                                                                    43866000
2023       EXEC SQL                                                     43867000
2023            OPEN SGS-CURSOR                                         43868000
2023       END-EXEC.                                                    43869000
2023                                                                    43869100
2023       EVALUATE TRUE                                                43869200
2023           WHEN SQLCODE = ZERO                                      43869300
2023               CONTINUE                                             43869400
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43869500
2023           WHEN SQLCODE NOT EQUAL ZERO                              43869600
2023               MOVE SQLCODE TO PV-SQL                               43869700
2023               MOVE '3500-OPEN-SGS-CURSOR' TO PV-PARAGRAPH-NAME     43869800
2023               STRING 'ERROR OPENING SGS-CURSOR - SQLCODE = '       43869900
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43870000
2023               END-STRING                                           43870100
2023               SET ABEND-4005-OPEN-ERROR TO TRUE                    43870200
2023               PERFORM 9100-SQL-ABEND                               43870300
2023       END-EVALUATE.                                                43870400
2023                                                                    43870500
2023  ******************************************************************43870600
2023  *  FETCH THE SGS CURSOR.                                          43870700
2023  ******************************************************************43870800
2023   3505-FETCH-SGS-CURSOR.                                           43870900
2023                                                                    43871000
2023       EXEC SQL                                                     43871100
2023            FETCH SGS-CURSOR                                        43871200
2023             INTO :PV-STR-NBR                                       43871300
2023                 ,:PV-DB2-SUM                                       43871400
2023       END-EXEC.                                                    43871500
2023                                                                    43871600
2023       EVALUATE TRUE                                                43871700
2023           WHEN SQLCODE = ZERO                                      43871800
2023               MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43871900
2023               MOVE PV-DB2-SUM   TO GL-WS-SGS (PV-STR-NBR)          43872000
2023               ADD 1 TO PA-SGS-CURSOR-CNT                           43872100
2023           WHEN SQLCODE = PC-ROW-NOT-FOUND                          43872200
2023               SET PS-END-OF-CURSOR  TO TRUE                        43872300
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43872400
2023           WHEN SQLCODE NOT EQUAL ZERO                              43872500
2023               MOVE SQLCODE TO PV-SQL                               43872600
2023               MOVE '3505-FETCH-SGS-CURSOR' TO PV-PARAGRAPH-NAME    43872700
2023               STRING 'ERROR FETCHING SGS-CURSOR - SQLCODE = '      43872800
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43872900
2023               END-STRING                                           43873000
2023               SET ABEND-4002-READ-ERROR TO TRUE                    43873100
2023               PERFORM 9100-SQL-ABEND                               43873200
2023       END-EVALUATE.                                                43873300
2023                                                                    43873400
2023                                                                    43873500
2023  ******************************************************************43873600
2023  *  CLOSE THE SGS CURSOR.                                          43873700
2023  ******************************************************************43873800
2023   3510-CLOSE-SGS-CURSOR.                                           43873900
2023                                                                    43874000
2023       EXEC SQL                                                     43874100
2023            CLOSE SGS-CURSOR                                        43874200
2023       END-EXEC.                                                    43874300
2023                                                                    43874400
2023       EVALUATE TRUE                                                43874500
2023           WHEN SQLCODE = ZERO                                      43874600
2023                CONTINUE                                            43874700
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43874800
2023           WHEN SQLCODE NOT EQUAL ZERO                              43874900
2023               MOVE SQLCODE TO PV-SQL                               43875000
2023               MOVE '3510-CLOSE-SGS-CURSOR' TO PV-PARAGRAPH-NAME    43875100
2023               STRING 'ERROR CLOSING SGS-CURSOR - SQLCODE = '       43875200
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43875300
2023               END-STRING                                           43875400
2023               SET ABEND-4006-CLOSE-ERROR TO TRUE                   43875500
2023               PERFORM 9100-SQL-ABEND                               43875600
2023       END-EVALUATE.                                                43875700
2023                                                                    43875800
2023                                                                    43875900
2023  ******************************************************************43876000
2023  *  OPEN THE MARKETPLACE CURSOR                                    43876100
2023  ******************************************************************43876200
2023   3515-OPEN-MKT-CURSOR.                                            43876300
2023                                                                    43876400
2023       EXEC SQL                                                     43876500
2023            OPEN MKT-CURSOR                                         43876600
2023       END-EXEC.                                                    43876700
2023                                                                    43876800
2023       EVALUATE TRUE                                                43876900
2023           WHEN SQLCODE = ZERO                                      43877000
2023               CONTINUE                                             43877100
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43877200
2023           WHEN SQLCODE NOT EQUAL ZERO                              43877300
2023               MOVE SQLCODE TO PV-SQL                               43877400
2023               MOVE '3515-OPEN-MKT-CURSOR' TO PV-PARAGRAPH-NAME     43877500
2023               STRING 'ERROR OPENING MKT-CURSOR - SQLCODE = '       43877600
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43877700
2023               END-STRING                                           43877800
2023               SET ABEND-4005-OPEN-ERROR TO TRUE                    43877900
2023               PERFORM 9100-SQL-ABEND                               43878000
2023       END-EVALUATE.                                                43878100
2023                                                                    43878200
2023  ******************************************************************43878300
2023  *  FETCH THE MARKETPLACE CURSOR.                                  43878400
2023  ******************************************************************43878500
2023   3520-FETCH-MKT-CURSOR.                                           43878600
2023                                                                    43878700
2023       EXEC SQL                                                     43878800
2023            FETCH MKT-CURSOR                                        43878900
2023             INTO :PV-STR-NBR                                       43879000
2023                 ,:PV-DB2-SUM                                       43879100
2023       END-EXEC.                                                    43879200
2023                                                                    43879300
2023       EVALUATE TRUE                                                43879400
2023           WHEN SQLCODE = ZERO                                      43879500
2023               MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43879600
2023               MOVE PV-DB2-SUM   TO GL-WS-MKT (PV-STR-NBR)          43879700
2023               ADD 1 TO PA-MKT-CURSOR-CNT                           43879800
2023           WHEN SQLCODE = PC-ROW-NOT-FOUND                          43879900
2023               SET PS-END-OF-CURSOR  TO TRUE                        43880000
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43880100
2023           WHEN SQLCODE NOT EQUAL ZERO                              43880200
2023               MOVE SQLCODE TO PV-SQL                               43880300
2023               MOVE '3520-FETCH-MKT-CURSOR' TO PV-PARAGRAPH-NAME    43880400
2023               STRING 'ERROR FETCHING MKT-CURSOR - SQLCODE = '      43880500
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43880600
2023               END-STRING                                           43880700
2023               SET ABEND-4002-READ-ERROR TO TRUE                    43880800
2023               PERFORM 9100-SQL-ABEND                               43880900
2023       END-EVALUATE.                                                43881000
2023                                                                    43881100
2023                                                                    43881200
2023  ******************************************************************43881300
2023  *  CLOSE THE MARKETPLACE CURSOR.                                  43881400
2023  ******************************************************************43881500
2023   3525-CLOSE-MKT-CURSOR.                                           43881600
2023                                                                    43881700
2023       EXEC SQL                                                     43881800
2023            CLOSE MKT-CURSOR                                        43881900
2023       END-EXEC.                                                    43882000
2023                                                                    43882100
2023       EVALUATE TRUE                                                43882200
2023           WHEN SQLCODE = ZERO                                      43882300
2023                CONTINUE                                            43882400
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43882500
2023           WHEN SQLCODE NOT EQUAL ZERO                              43882600
2023               MOVE SQLCODE TO PV-SQL                               43882700
2023               MOVE '3525-CLOSE-MKT-CURSOR' TO PV-PARAGRAPH-NAME    43882800
2023               STRING 'ERROR CLOSING MKT-CURSOR - SQLCODE = '       43882900
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43883000
2023               END-STRING                                           43883100
2023               SET ABEND-4006-CLOSE-ERROR TO TRUE                   43883200
2023               PERFORM 9100-SQL-ABEND                               43883300
2023       END-EVALUATE.                                                43883400
2023                                                                    43883500
2023                                                                    43883600
2023  ******************************************************************43883700
2023  *  OPEN THE CVN-CURSOR                                            43883800
2023  ******************************************************************43883900
2023   3530-OPEN-CVN-CURSOR.                                            43884000
2023                                                                    43884100
2023       EXEC SQL                                                     43884200
2023            OPEN CVN-CURSOR                                         43884300
2023       END-EXEC.                                                    43884400
2023                                                                    43884500
2023       EVALUATE TRUE                                                43884600
2023           WHEN SQLCODE = ZERO                                      43884700
2023               CONTINUE                                             43884800
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43884900
2023           WHEN SQLCODE NOT EQUAL ZERO                              43885000
2023               MOVE SQLCODE TO PV-SQL                               43885100
2023               MOVE '3530-OPEN-CVN-CURSOR' TO PV-PARAGRAPH-NAME     43885200
2023               STRING 'ERROR OPENING CVN-CURSOR - SQLCODE = '       43885300
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43885400
2023               END-STRING                                           43885500
2023               SET ABEND-4005-OPEN-ERROR TO TRUE                    43885600
2023               PERFORM 9100-SQL-ABEND                               43885700
2023       END-EVALUATE.                                                43885800
2023                                                                    43885900
2023  ******************************************************************43886000
2023  *  FETCH THE CVN CURSOR.                                          43886100
2023  ******************************************************************43886200
2023   3535-FETCH-CVN-CURSOR.                                           43886300
2023                                                                    43886400
2023       EXEC SQL                                                     43886500
2023            FETCH CVN-CURSOR                                        43886600
2023             INTO :PV-STR-NBR                                       43886700
2023                 ,:PV-DB2-SUM                                       43886800
2023       END-EXEC.                                                    43886900
2023                                                                    43887000
2023       EVALUATE TRUE                                                43887100
2023           WHEN SQLCODE = ZERO                                      43887200
2023               MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43887300
2023               MOVE PV-DB2-SUM   TO GL-WS-CVN (PV-STR-NBR)          43887400
2023               ADD 1 TO PA-CVN-CURSOR-CNT                           43887500
2023           WHEN SQLCODE = PC-ROW-NOT-FOUND                          43887600
2023               SET PS-END-OF-CURSOR  TO TRUE                        43887700
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43887800
2023           WHEN SQLCODE NOT EQUAL ZERO                              43887900
2023               MOVE SQLCODE TO PV-SQL                               43888000
2023               MOVE '3535-FETCH-CVN-CURSOR' TO PV-PARAGRAPH-NAME    43888100
2023               STRING 'ERROR FETCHING CVN-CURSOR - SQLCODE = '      43888200
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43888300
2023               END-STRING                                           43888400
2023               SET ABEND-4002-READ-ERROR TO TRUE                    43888500
2023               PERFORM 9100-SQL-ABEND                               43888600
2023       END-EVALUATE.                                                43888700
2023                                                                    43888800
2023                                                                    43888900
2023  ******************************************************************43889000
2023  *  CLOSE THE CVN CURSOR.                                          43889100
2023  ******************************************************************43889200
2023   3540-CLOSE-CVN-CURSOR.                                           43889300
2023                                                                    43889400
2023       EXEC SQL                                                     43889500
2023            CLOSE CVN-CURSOR                                        43889600
2023       END-EXEC.                                                    43889700
2023                                                                    43889800
2023       EVALUATE TRUE                                                43889900
2023           WHEN SQLCODE = ZERO                                      43890000
2023                CONTINUE                                            43890100
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43890200
2023           WHEN SQLCODE NOT EQUAL ZERO                              43890300
2023               MOVE SQLCODE TO PV-SQL                               43890400
2023               MOVE '3540-CLOSE-CVN-CURSOR' TO PV-PARAGRAPH-NAME    43890500
2023               STRING 'ERROR CLOSING CVN-CURSOR - SQLCODE = '       43890600
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43890700
2023               END-STRING                                           43890800
2023               SET ABEND-4006-CLOSE-ERROR TO TRUE                   43890900
2023               PERFORM 9100-SQL-ABEND                               43891000
2023       END-EVALUATE.                                                43891100
2023                                                                    43891200
2023                                                                    43891300
2023  ******************************************************************43891400
2023  *  OPEN THE SGT-CURSOR                                            43891500
2023  ******************************************************************43891600
2023   3545-OPEN-SGT-CURSOR.                                            43891700
2023                                                                    43891800
2023       EXEC SQL                                                     43891900
2023            OPEN SGT-CURSOR                                         43892000
2023       END-EXEC.                                                    43892100
2023                                                                    43892200
2023       EVALUATE TRUE                                                43892300
2023           WHEN SQLCODE = ZERO                                      43892400
2023               CONTINUE                                             43892500
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43892600
2023           WHEN SQLCODE NOT EQUAL ZERO                              43892700
2023               MOVE SQLCODE TO PV-SQL                               43892800
2023               MOVE '3545-OPEN-SGT-CURSOR' TO PV-PARAGRAPH-NAME     43892900
2023               STRING 'ERROR OPENING SGT-CURSOR - SQLCODE = '       43893000
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43893100
2023               END-STRING                                           43893200
2023               SET ABEND-4005-OPEN-ERROR TO TRUE                    43893300
2023               PERFORM 9100-SQL-ABEND                               43893400
2023       END-EVALUATE.                                                43893500
2023                                                                    43893600
2023  ******************************************************************43893700
2023  *  FETCH THE SGT CURSOR.                                          43893800
2023  ******************************************************************43893900
2023   3550-FETCH-SGT-CURSOR.                                           43894000
2023                                                                    43894100
2023       EXEC SQL                                                     43894200
2023            FETCH SGT-CURSOR                                        43894300
2023             INTO :PV-STR-NBR                                       43894400
2023                 ,:PV-DB2-SUM                                       43894500
2023       END-EXEC.                                                    43894600
2023                                                                    43894700
2023       EVALUATE TRUE                                                43894800
2023           WHEN SQLCODE = ZERO                                      43894900
2023               MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43895000
2023               MOVE PV-DB2-SUM   TO GL-WS-SGT (PV-STR-NBR)          43895100
2023               ADD 1 TO PA-SGT-CURSOR-CNT                           43895200
2023           WHEN SQLCODE = PC-ROW-NOT-FOUND                          43895300
2023               SET PS-END-OF-CURSOR  TO TRUE                        43895400
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43895500
2023           WHEN SQLCODE NOT EQUAL ZERO                              43895600
2023               MOVE SQLCODE TO PV-SQL                               43895700
2023               MOVE '3550-FETCH-SGT-CURSOR' TO PV-PARAGRAPH-NAME    43895800
2023               STRING 'ERROR FETCHING SGT-CURSOR - SQLCODE = '      43895900
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43896000
2023               END-STRING                                           43896100
2023               SET ABEND-4002-READ-ERROR TO TRUE                    43896200
2023               PERFORM 9100-SQL-ABEND                               43896300
2023       END-EVALUATE.                                                43896400
2023                                                                    43896500
2023                                                                    43896600
2023  ******************************************************************43896700
2023  *  CLOSE THE SGT CURSOR.                                          43896800
2023  ******************************************************************43896900
2023   3555-CLOSE-SGT-CURSOR.                                           43897000
2023                                                                    43897100
2023       EXEC SQL                                                     43897200
2023            CLOSE SGT-CURSOR                                        43897300
2023       END-EXEC.                                                    43897400
2023                                                                    43897500
2023       EVALUATE TRUE                                                43897600
2023           WHEN SQLCODE = ZERO                                      43897700
2023                CONTINUE                                            43897800
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43897900
2023           WHEN SQLCODE NOT EQUAL ZERO                              43898000
2023               MOVE SQLCODE TO PV-SQL                               43898100
2023               MOVE '3555-CLOSE-SGT-CURSOR' TO PV-PARAGRAPH-NAME    43898200
2023               STRING 'ERROR CLOSING SGT-CURSOR - SQLCODE = '       43898300
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43898400
2023               END-STRING                                           43898500
2023               SET ABEND-4006-CLOSE-ERROR TO TRUE                   43898600
2023               PERFORM 9100-SQL-ABEND                               43898700
2023       END-EVALUATE.                                                43898800
2023                                                                    43898900
2023                                                                    43899000
2023  ******************************************************************43899100
2023  *  OPEN THE CVP-CURSOR                                            43899200
2023  ******************************************************************43899300
2023   3560-OPEN-CVP-CURSOR.                                            43899400
2023                                                                    43899500
2023       EXEC SQL                                                     43899600
2023            OPEN CVP-CURSOR                                         43899700
2023       END-EXEC.                                                    43899800
2023                                                                    43899900
2023       EVALUATE TRUE                                                43900000
2023           WHEN SQLCODE = ZERO                                      43900100
2023               CONTINUE                                             43900200
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43900300
2023           WHEN SQLCODE NOT EQUAL ZERO                              43900400
2023               MOVE SQLCODE TO PV-SQL                               43900500
2023               MOVE '3560-OPEN-CVP-CURSOR' TO PV-PARAGRAPH-NAME     43900600
2023               STRING 'ERROR OPENING CVP-CURSOR - SQLCODE = '       43900700
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43900800
2023               END-STRING                                           43900900
2023               SET ABEND-4005-OPEN-ERROR TO TRUE                    43901000
2023               PERFORM 9100-SQL-ABEND                               43901100
2023       END-EVALUATE.                                                43901200
2023                                                                    43901300
2023  ******************************************************************43901400
2023  *  FETCH THE CVP CURSOR.                                          43901500
2023  ******************************************************************43901600
2023   3565-FETCH-CVP-CURSOR.                                           43901700
2023                                                                    43901800
2023       EXEC SQL                                                     43901900
2023            FETCH CVP-CURSOR                                        43902000
2023             INTO :PV-STR-NBR                                       43902100
2023                 ,:PV-DB2-SUM                                       43902200
2023       END-EXEC.                                                    43902300
2023                                                                    43902400
2023       EVALUATE TRUE                                                43902500
2023           WHEN SQLCODE = ZERO                                      43902600
2023               MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43902700
2023               MOVE PV-DB2-SUM   TO GL-WS-CVP (PV-STR-NBR)          43902800
2023               ADD 1 TO PA-CVP-CURSOR-CNT                           43902900
2023           WHEN SQLCODE = PC-ROW-NOT-FOUND                          43903000
2023               SET PS-END-OF-CURSOR  TO TRUE                        43903100
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43903200
2023           WHEN SQLCODE NOT EQUAL ZERO                              43903300
2023               MOVE SQLCODE TO PV-SQL                               43903400
2023               MOVE '3565-FETCH-CVP-CURSOR' TO PV-PARAGRAPH-NAME    43903500
2023               STRING 'ERROR FETCHING CVP-CURSOR - SQLCODE = '      43903600
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43903700
2023               END-STRING                                           43903800
2023               SET ABEND-4002-READ-ERROR TO TRUE                    43903900
2023               PERFORM 9100-SQL-ABEND                               43904000
2023       END-EVALUATE.                                                43904100
2023                                                                    43904200
2023                                                                    43904300
2023  ******************************************************************43904400
2023  *  CLOSE THE CVP CURSOR.                                          43904500
2023  ******************************************************************43904600
2023   3570-CLOSE-CVP-CURSOR.                                           43904700
2023                                                                    43904800
2023       EXEC SQL                                                     43904900
2023            CLOSE CVP-CURSOR                                        43905000
2023       END-EXEC.                                                    43905100
2023                                                                    43905200
2023       EVALUATE TRUE                                                43905300
2023           WHEN SQLCODE = ZERO                                      43905400
2023                CONTINUE                                            43905500
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43905600
2023           WHEN SQLCODE NOT EQUAL ZERO                              43905700
2023               MOVE SQLCODE TO PV-SQL                               43905800
2023               MOVE '3570-CLOSE-CVP-CURSOR' TO PV-PARAGRAPH-NAME    43905900
2023               STRING 'ERROR CLOSING CVP-CURSOR - SQLCODE = '       43906000
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43906100
2023               END-STRING                                           43906200
2023               SET ABEND-4006-CLOSE-ERROR TO TRUE                   43906300
2023               PERFORM 9100-SQL-ABEND                               43906400
2023       END-EVALUATE.                                                43906500
2023                                                                    43906600
2023                                                                    43906700
2023  ******************************************************************43906800
2023  *  OPEN THE PAYPAL PPN CURSOR                                     43906900
2023  ******************************************************************43907000
2023   3575-OPEN-PPN-CURSOR.                                            43907100
2023                                                                    43907200
2023       EXEC SQL                                                     43907300
2023            OPEN PPN-CURSOR                                         43907400
2023       END-EXEC.                                                    43907500
2023                                                                    43907600
2023       EVALUATE TRUE                                                43907700
2023           WHEN SQLCODE = ZERO                                      43907800
2023               CONTINUE                                             43907900
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43908000
2023           WHEN SQLCODE NOT EQUAL ZERO                              43908100
2023               MOVE SQLCODE TO PV-SQL                               43908200
2023               MOVE '3575-OPEN-PPN-CURSOR' TO PV-PARAGRAPH-NAME     43908300
2023               STRING 'ERROR OPENING PPN-CURSOR - SQLCODE = '       43908400
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43908500
2023               END-STRING                                           43908600
2023               SET ABEND-4005-OPEN-ERROR TO TRUE                    43908700
2023               PERFORM 9100-SQL-ABEND                               43908800
2023       END-EVALUATE.                                                43908900
2023                                                                    43909000
2023  ******************************************************************43909100
2023  *  FETCH THE PPN CURSOR.                                          43909200
2023  ******************************************************************43909300
2023   3580-FETCH-PPN-CURSOR.                                           43909400
2023                                                                    43909500
2023       EXEC SQL                                                     43909600
2023            FETCH PPN-CURSOR                                        43909700
2023             INTO :PV-STR-NBR                                       43909800
2023                 ,:PV-DB2-SUM                                       43909900
2023       END-EXEC.                                                    43910000
2023                                                                    43910100
2023       EVALUATE TRUE                                                43910200
2023           WHEN SQLCODE = ZERO                                      43910300
2023               MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43910400
2023               MOVE PV-DB2-SUM   TO GL-WS-PPN (PV-STR-NBR)          43910500
2023               ADD 1 TO PA-PPN-CURSOR-CNT                           43910600
2023           WHEN SQLCODE = PC-ROW-NOT-FOUND                          43910700
2023               SET PS-END-OF-CURSOR  TO TRUE                        43910800
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43910900
2023           WHEN SQLCODE NOT EQUAL ZERO                              43911000
2023               MOVE SQLCODE TO PV-SQL                               43911100
2023               MOVE '3580-FETCH-PPN-CURSOR' TO PV-PARAGRAPH-NAME    43911200
2023               STRING 'ERROR FETCHING PPN-CURSOR - SQLCODE = '      43911300
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43911400
2023               END-STRING                                           43911500
2023               SET ABEND-4002-READ-ERROR TO TRUE                    43911600
2023               PERFORM 9100-SQL-ABEND                               43911700
2023       END-EVALUATE.                                                43911800
2023                                                                    43911900
2023                                                                    43912000
2023  ******************************************************************43912100
2023  *  CLOSE THE PPN CURSOR.                                          43912200
2023  ******************************************************************43912300
2023   3585-CLOSE-PPN-CURSOR.                                           43912400
2023                                                                    43912500
2023       EXEC SQL                                                     43912600
2023            CLOSE PPN-CURSOR                                        43912700
2023       END-EXEC.                                                    43912800
2023                                                                    43912900
2023       EVALUATE TRUE                                                43913000
2023           WHEN SQLCODE = ZERO                                      43913100
2023                CONTINUE                                            43913200
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43913300
2023           WHEN SQLCODE NOT EQUAL ZERO                              43913400
2023               MOVE SQLCODE TO PV-SQL                               43913500
2023               MOVE '3585-CLOSE-PPN-CURSOR' TO PV-PARAGRAPH-NAME    43913600
2023               STRING 'ERROR CLOSING PPN-CURSOR - SQLCODE = '       43913700
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43913800
2023               END-STRING                                           43913900
2023               SET ABEND-4006-CLOSE-ERROR TO TRUE                   43914000
2023               PERFORM 9100-SQL-ABEND                               43914100
2023       END-EVALUATE.                                                43914200
2023                                                                    43914300
2023                                                                    43914400
2023  ******************************************************************43914500
2023  *  OPEN THE VENMO VMN CURSOR                                      43914600
2023  ******************************************************************43914700
2023   3590-OPEN-VMN-CURSOR.                                            43914800
2023                                                                    43914900
2023       EXEC SQL                                                     43915000
2023            OPEN VMN-CURSOR                                         43915100
2023       END-EXEC.                                                    43915200
2023                                                                    43915300
2023       EVALUATE TRUE                                                43915400
2023           WHEN SQLCODE = ZERO                                      43915500
2023               CONTINUE                                             43915600
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43915700
2023           WHEN SQLCODE NOT EQUAL ZERO                              43915800
2023               MOVE SQLCODE TO PV-SQL                               43915900
2023               MOVE '3590-OPEN-VMN-CURSOR' TO PV-PARAGRAPH-NAME     43916000
2023               STRING 'ERROR OPENING VMN-CURSOR - SQLCODE = '       43916100
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43916200
2023               END-STRING                                           43916300
2023               SET ABEND-4005-OPEN-ERROR TO TRUE                    43916400
2023               PERFORM 9100-SQL-ABEND                               43916500
2023       END-EVALUATE.                                                43916600
2023                                                                    43916700
2023  ******************************************************************43916800
2023  *  FETCH THE VMN CURSOR.                                          43916900
2023  ******************************************************************43917000
2023   3595-FETCH-VMN-CURSOR.                                           43917100
2023                                                                    43917200
2023       EXEC SQL                                                     43917300
2023            FETCH VMN-CURSOR                                        43917400
2023             INTO :PV-STR-NBR                                       43917500
2023                 ,:PV-DB2-SUM                                       43917600
2023       END-EXEC.                                                    43917700
2023                                                                    43917800
2023       EVALUATE TRUE                                                43917900
2023           WHEN SQLCODE = ZERO                                      43918000
2023               MOVE PV-STR-NBR   TO GL-WS-STORE (PV-STR-NBR)        43918100
2023               MOVE PV-DB2-SUM   TO GL-WS-VMN (PV-STR-NBR)          43918200
2023               ADD 1 TO PA-VMN-CURSOR-CNT                           43918300
2023           WHEN SQLCODE = PC-ROW-NOT-FOUND                          43918400
2023               SET PS-END-OF-CURSOR  TO TRUE                        43918500
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43918600
2023           WHEN SQLCODE NOT EQUAL ZERO                              43918700
2023               MOVE SQLCODE TO PV-SQL                               43918800
2023               MOVE '3595-FETCH-VMN-CURSOR' TO PV-PARAGRAPH-NAME    43918900
2023               STRING 'ERROR FETCHING VMN-CURSOR - SQLCODE = '      43919000
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43919100
2023               END-STRING                                           43919200
2023               SET ABEND-4002-READ-ERROR TO TRUE                    43919300
2023               PERFORM 9100-SQL-ABEND                               43919400
2023       END-EVALUATE.                                                43919500
2023                                                                    43919600
2023                                                                    43919700
2023  ******************************************************************43919800
2023  *  CLOSE THE VMN CURSOR.                                          43919900
2023  ******************************************************************43920000
2023   3600-CLOSE-VMN-CURSOR.                                           43920100
2023                                                                    43920200
2023       EXEC SQL                                                     43920300
2023            CLOSE VMN-CURSOR                                        43920400
2023       END-EXEC.                                                    43920500
2023                                                                    43920600
2023       EVALUATE TRUE                                                43920700
2023           WHEN SQLCODE = ZERO                                      43920800
2023                CONTINUE                                            43920900
2023           WHEN SQLWARN0 NOT EQUAL SPACE                            43921000
2023           WHEN SQLCODE NOT EQUAL ZERO                              43921100
2023               MOVE SQLCODE TO PV-SQL                               43921200
2023               MOVE '3600-CLOSE-VMN-CURSOR' TO PV-PARAGRAPH-NAME    43921300
2023               STRING 'ERROR CLOSING VMN-CURSOR - SQLCODE = '       43921400
2023                  PV-SQL DELIMITED BY SIZE INTO PV-DB2-OPERATION-MSG43921500
2023               END-STRING                                           43921600
2023               SET ABEND-4006-CLOSE-ERROR TO TRUE                   43921700
2023               PERFORM 9100-SQL-ABEND                               43921800
2023       END-EVALUATE.                                                43921900
2023                                                                    43922000
2023                                                                    43922100
      ******************************************************************43922200
      * WRITE THE HEADER RECORD WITH COLUMN HEADINGS                    43922300
      * WRITE ALL STORE RECORDS THAT HAVE TOTALS                        43922400
      * TABLE HOLDS 9999 RECORDS BUT THERE ARE CURRENTLY < 2000 STORES. 43922500
      ******************************************************************43923000
       4000-WRITE-GL-RECORDS.                                           43930000
                                                                        43940000
           WRITE GL-CSV-RECORD-OUT  FROM  GL-HEADER-RECORD.             43950000
           ADD 1 TO PA-GL-FILE-OUT-WRITTEN.                             43960000
                                                                        43970000
           PERFORM VARYING PV-SUB FROM 1 BY 1                           43980000
             UNTIL PV-SUB > 9999                                        43990000
               IF GL-WS-STORE (PV-SUB) > ZERO                           44000000
                   PERFORM 4100-FORMAT-CSV-RECORD                       44010000
                   WRITE GL-CSV-RECORD-OUT  FROM  GL-RECORD-OUT         44020000
                   ADD 1 TO PA-GL-FILE-OUT-WRITTEN                      44030000
               END-IF                                                   44040000
           END-PERFORM.                                                 44050000
                                                                        44060000
      ******************************************************************44070000
      * STM (STATE TAXABLE MDSE) AND TMR (TOTAL MDSE RETURNS)           44080000
      * ARE CALCULATED BASED ON OTHER QUERIES.                          44090000
      * MOVE NUMERIC QUERY RESULTS TO FORMATTED CSV RECORD.             44100000
      ******************************************************************44110000
       4100-FORMAT-CSV-RECORD.                                          44120000
                                                                        44130000
           COMPUTE GL-WS-STM (PV-SUB) = GL-WS-SALES (PV-SUB)            44140000
                                      - GL-WS-SFS   (PV-SUB)            44150000
                                      - GL-WS-BOS   (PV-SUB)            44160000
                                      - GL-WS-BPS   (PV-SUB)            44170000
                                      - GL-WS-SHS   (PV-SUB)            44180000
                                      - GL-WS-GDS   (PV-SUB)            44230000
                                      - GL-WS-SGS   (PV-SUB)            44231000
                                      - GL-WS-TPC   (PV-SUB).           44240000
NEW   **** TPC INCLUDES TCC           - GL-WS-TCC   (PV-SUB).           44250000
NEW   **** KK*, MKTPLC AND FEES WILL BE SUBTRACTED LATER IF             44251000
NEW   **** THEY ARE POSITIVE.                                           44252000
                                                                        44260000
NEW   ***  DO NOT SUBTRACT BSR OR BPR FROM ECR                          44270000
                                                                        44300000
           COMPUTE GL-WS-TMR (PV-SUB) = GL-WS-RETURNS (PV-SUB)          44310000
                                      - GL-WS-ECR     (PV-SUB)          44320000
                                      - GL-WS-BSR     (PV-SUB)          44330000
                                      - GL-WS-BPR     (PV-SUB)          44340000
                                      - GL-WS-SHR     (PV-SUB).         44350000
NEW   **** KK*, MKTPLC AND FEES WILL BE SUBTRACTED LATER IF             44351000
NEW   **** THEY ARE NEGATIVE.                                           44352000
                                                                        44360000
           COMPUTE GL-WS-GDTT (PV-SUB) = GL-WS-GDT   (PV-SUB)           44370000
                                       - GL-WS-KKT   (PV-SUB).          44380000
                                                                        44390000
2023       COMPUTE GL-WS-TPC  (PV-SUB) = GL-WS-TPC   (PV-SUB)           44391000
2023                                   - GL-WS-TCC   (PV-SUB).          44392000
                                                                        44393000
2023       IF  GL-WS-MKT   (PV-SUB) > 0                                 44394000
2023           SUBTRACT GL-WS-MKT (PV-SUB) FROM GL-WS-STM (PV-SUB)      44395000
2023       ELSE                                                         44396000
2023           SUBTRACT GL-WS-MKT (PV-SUB) FROM GL-WS-TMR (PV-SUB)      44396100
2023       END-IF.                                                      44397000
                                                                        44398000
2023       IF  GL-WS-FEE   (PV-SUB) > 0                                 44399000
2023           SUBTRACT GL-WS-FEE (PV-SUB) FROM GL-WS-STM (PV-SUB)      44399100
2023       ELSE                                                         44399200
2023           SUBTRACT GL-WS-FEE (PV-SUB) FROM GL-WS-TMR (PV-SUB)      44399300
2023       END-IF.                                                      44399400
                                                                        44399500
2023       IF  GL-WS-KKB   (PV-SUB) > 0                                 44399600
2023           SUBTRACT GL-WS-KKB (PV-SUB) FROM GL-WS-STM (PV-SUB)      44399700
2023       ELSE                                                         44399800
2023           SUBTRACT GL-WS-KKB (PV-SUB) FROM GL-WS-TMR (PV-SUB)      44399900
2023       END-IF.                                                      44400000
                                                                        44400100
2023       IF  GL-WS-KKH   (PV-SUB) > 0                                 44400200
2023           SUBTRACT GL-WS-KKH (PV-SUB) FROM GL-WS-STM (PV-SUB)      44400300
2023       ELSE                                                         44400400
2023           SUBTRACT GL-WS-KKH (PV-SUB) FROM GL-WS-TMR (PV-SUB)      44400500
2023       END-IF.                                                      44400600
                                                                        44400700
2023       IF  GL-WS-KKS   (PV-SUB) > 0                                 44400800
2023           SUBTRACT GL-WS-KKS (PV-SUB) FROM GL-WS-STM (PV-SUB)      44400900
2023       ELSE                                                         44401000
2023           SUBTRACT GL-WS-KKS (PV-SUB) FROM GL-WS-TMR (PV-SUB)      44401100
2023       END-IF.                                                      44401200
                                                                        44401300
2023       IF  GL-WS-KKU   (PV-SUB) > 0                                 44401400
2023           SUBTRACT GL-WS-KKU (PV-SUB) FROM GL-WS-STM (PV-SUB)      44401500
2023       ELSE                                                         44401600
2023           SUBTRACT GL-WS-KKU (PV-SUB) FROM GL-WS-TMR (PV-SUB)      44401700
2023       END-IF.                                                      44401800
                                                                        44401900
           MOVE GL-WS-STORE   (PV-SUB) TO   GL-STORE.                   44402000
           MOVE GL-WS-SALES   (PV-SUB) TO   GL-SALES.                   44410000
           MOVE GL-WS-GDS     (PV-SUB) TO   GL-GDS.                     44420000
           MOVE GL-WS-TPC     (PV-SUB) TO   GL-TPC.                     44430000
           MOVE GL-WS-TCC     (PV-SUB) TO   GL-TCC.                     44440000
2023       MOVE GL-WS-SGS     (PV-SUB) TO   GL-SGS.                     44441000
           MOVE GL-WS-BOS     (PV-SUB) TO   GL-BOS.                     44450000
           MOVE GL-WS-BPS     (PV-SUB) TO   GL-BPS.                     44460000
           MOVE GL-WS-SFS     (PV-SUB) TO   GL-SFS.                     44470000
2023       MOVE GL-WS-MKT     (PV-SUB) TO   GL-MKT.                     44471000
           MOVE GL-WS-KKB     (PV-SUB) TO   GL-KKB.                     44480000
           MOVE GL-WS-KKH     (PV-SUB) TO   GL-KKH.                     44490000
           MOVE GL-WS-KKS     (PV-SUB) TO   GL-KKS.                     44500000
           MOVE GL-WS-KKU     (PV-SUB) TO   GL-KKU.                     44510000
           MOVE GL-WS-SHS     (PV-SUB) TO   GL-SHS.                     44520000
           MOVE GL-WS-STM     (PV-SUB) TO   GL-STM.                     44530000
           MOVE GL-WS-RETURNS (PV-SUB) TO   GL-RETURNS.                 44540000
           MOVE GL-WS-BSR     (PV-SUB) TO   GL-BSR.                     44550000
           MOVE GL-WS-BPR     (PV-SUB) TO   GL-BPR.                     44560000
           MOVE GL-WS-ECR     (PV-SUB) TO   GL-ECR.                     44570000
           MOVE GL-WS-SHR     (PV-SUB) TO   GL-SHR.                     44580000
           MOVE GL-WS-TMR     (PV-SUB) TO   GL-TMR.                     44590000
           MOVE GL-WS-TAX     (PV-SUB) TO   GL-TAX.                     44600000
           MOVE GL-WS-FEE     (PV-SUB) TO   GL-FEE.                     44610000
           MOVE GL-WS-AEN     (PV-SUB) TO   GL-AEN.                     44620000
           MOVE GL-WS-BCN     (PV-SUB) TO   GL-BCN.                     44630000
           MOVE GL-WS-DBN     (PV-SUB) TO   GL-DBN.                     44640000
           MOVE GL-WS-KCN     (PV-SUB) TO   GL-KCN.                     44650000
2023       MOVE GL-WS-CVN     (PV-SUB) TO   GL-CVN.                     44651000
           MOVE GL-WS-NCN     (PV-SUB) TO   GL-NCN.                     44660000
2023       MOVE GL-WS-PPN     (PV-SUB) TO   GL-PPN.                     44661000
2023       MOVE GL-WS-VMN     (PV-SUB) TO   GL-VMN.                     44662000
           MOVE GL-WS-GDT     (PV-SUB) TO   GL-GDT.                     44670000
2023       MOVE GL-WS-SGT     (PV-SUB) TO   GL-SGT.                     44671000
           MOVE GL-WS-KKT     (PV-SUB) TO   GL-KKT.                     44680000
           MOVE GL-WS-GDTT    (PV-SUB) TO   GL-GDTT.                    44690000
           MOVE GL-WS-KMT     (PV-SUB) TO   GL-KMT.                     44700000
           MOVE GL-WS-KMI     (PV-SUB) TO   GL-KMI.                     44710000
           MOVE GL-WS-CASH    (PV-SUB) TO   GL-CASH.                    44720000
           MOVE GL-WS-CHECK   (PV-SUB) TO   GL-CHECK.                   44730000
           MOVE GL-WS-KCP     (PV-SUB) TO   GL-KCP.                     44740000
2023       MOVE GL-WS-CVP     (PV-SUB) TO   GL-CVP.                     44741000
           MOVE GL-WS-CRI     (PV-SUB) TO   GL-CRI.                     44750000
           MOVE GL-WS-EMPDISC (PV-SUB) TO   GL-EMPDISC.                 44760000
                                                                        44770000
      ******************************************************************44780000
      * ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.    44790000
      ******************************************************************44800000
       9100-SQL-ABEND.                                                  44810000
                                                                        44820000
           MOVE SQLCODE    TO SQLCODE2.                                 44830000
           MOVE SQLERRD(3) TO SQLERRD3.                                 44840000
                                                                        44850000
           DISPLAY '** ABEND           ** = SQLABEND'.                  44860000
           DISPLAY '** PROGRAM         ** = ' PC-PGM-NAME.              44870000
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        44880000
           DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG.     44890000
           DISPLAY '** SQLCODE         ** = ' SQLCODE2.                 44900000
           DISPLAY '** ROWS PROCESSED  ** = ' SQLERRD3.                 44910000
           DISPLAY '** SQLERRM         ** = ' SQLERRM.                  44920000
           DISPLAY '** SQLERRMC        ** = ' SQLERRMC.                 44930000
                                                                        44940000
      ******************************************************************44950000
      *  THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   44960000
      *  MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        44970000
      * 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     44980000
      *  FORMAT.                                                        44990000
      ******************************************************************45000000
                                                                        45010000
           COPY DPPD004.                                                45020000
                                                                        45030000
           CALL 'ILBOABN0' USING ABEND-CODE.                            45040000
                                                                        45050000
                                                                        45060000
      ******************************************************************45070000
      *  ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                     45080000
      ******************************************************************45090000
       9200-ABEND.                                                      45100000
                                                                        45110000
           PERFORM 9900-END-PROC.                                       45120000
                                                                        45130000
           DISPLAY '** ABEND           **'.                             45140000
           DISPLAY '** PROGRAM         ** = ' PC-PGM-NAME.              45150000
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        45160000
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       45170000
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       45180000
                                                                        45190000
           CALL 'ILBOABN0' USING ABEND-CODE.                            45200000
                                                                        45210000
                                                                        45220000
      ******************************************************************45230000
      * PREFORMS TASK TERMINATION PROCESSING AND DISPLAYS COUNTS.       45240000
      ******************************************************************45250000
       9900-END-PROC.                                                   45260000
                                                                        45270000
      **   CLOSE GL-FILE-IN                                             45280000
           CLOSE GL-CSV-FILE-OUT.                                       45290000
                                                                        45300000
           DISPLAY '                    '.                              45310000
           DISPLAY '**********************'.                            45320000
           DISPLAY '   SAKUT950 CONTROLS  '.                            45330000
           DISPLAY '**********************'.                            45340000
           DISPLAY '======================'.                            45350000
           MOVE PA-SALES-CURSOR-CNT       TO PV-DISPLAY-CURSOR-COUNT.   45360000
           DISPLAY 'SALES ROWS FETCHED   = ' PV-DISPLAY-CURSOR-COUNT.   45370000
           MOVE PA-RETURNS-CURSOR-CNT     TO PV-DISPLAY-CURSOR-COUNT.   45380000
           DISPLAY 'RETURNS ROWS FETCHED = ' PV-DISPLAY-CURSOR-COUNT.   45390000
           MOVE PA-GDS-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45400000
           DISPLAY 'GDS ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45410000
           MOVE PA-TPC-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45420000
           DISPLAY 'TPC ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45430000
           MOVE PA-TCC-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45440000
           DISPLAY 'TCC ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45450000
2023       MOVE PA-SGS-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45451000
2023       DISPLAY 'SGS ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45452000
           MOVE PA-BOS-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45460000
           DISPLAY 'BOS ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45470000
           MOVE PA-BPS-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45480000
           DISPLAY 'BPS ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45490000
           MOVE PA-SFS-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45500000
           DISPLAY 'SFS ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45510000
2023       MOVE PA-MKT-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45511000
2023       DISPLAY 'MKT ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45512000
           MOVE PA-BSR-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45520000
           DISPLAY 'BSR ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45530000
           MOVE PA-BPR-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45540000
           DISPLAY 'BPR ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45550000
           MOVE PA-KKB-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45560000
           DISPLAY 'KKB ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45570000
           MOVE PA-KKH-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45580000
           DISPLAY 'KKH ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45590000
           MOVE PA-KKS-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45600000
           DISPLAY 'KKS ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45610000
           MOVE PA-KKU-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45620000
           DISPLAY 'KKU ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45630000
           MOVE PA-SHS-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45640000
           DISPLAY 'SHS ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45650000
           MOVE PA-ECR-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45660000
           DISPLAY 'ECR ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45670000
           MOVE PA-SHR-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45680000
           DISPLAY 'SHR ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45690000
           MOVE PA-TAX-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45700000
           DISPLAY 'TAX ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45710000
           MOVE PA-FEE-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45720000
           DISPLAY 'FEE ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45730000
           MOVE PA-AEN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45740000
           DISPLAY 'AEN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45750000
           MOVE PA-BCN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45760000
           DISPLAY 'BCN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45770000
           MOVE PA-DBN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45780000
           DISPLAY 'DBN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45790000
           MOVE PA-KCN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45800000
           DISPLAY 'KCN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45810000
2023       MOVE PA-CVN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45811000
2023       DISPLAY 'CVN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45812000
           MOVE PA-NCN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45820000
           DISPLAY 'NCN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45830000
2023       MOVE PA-PPN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45831000
2023       DISPLAY 'PPN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45832000
2023       MOVE PA-VMN-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45833000
2023       DISPLAY 'VMN ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45834000
           MOVE PA-GDT-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45840000
           DISPLAY 'GDT ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45850000
2023       MOVE PA-SGT-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45851000
2023       DISPLAY 'SGT ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45852000
           MOVE PA-KMT-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45860000
           DISPLAY 'KMT ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45870000
           MOVE PA-KMI-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45880000
           DISPLAY 'KMI ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45890000
           MOVE PA-CASH-CURSOR-CNT        TO PV-DISPLAY-CURSOR-COUNT.   45900000
           DISPLAY 'CASH ROWS FETCHED    = ' PV-DISPLAY-CURSOR-COUNT.   45910000
           MOVE PA-CHECK-CURSOR-CNT       TO PV-DISPLAY-CURSOR-COUNT.   45920000
           DISPLAY 'CHECK ROWS FETCHED   = ' PV-DISPLAY-CURSOR-COUNT.   45930000
           MOVE PA-KCP-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45940000
           DISPLAY 'KCP ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45950000
2023       MOVE PA-CVP-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45951000
2023       DISPLAY 'CVP ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45952000
           MOVE PA-CRI-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   45960000
           DISPLAY 'CRI ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   45970000
           MOVE PA-EMPDISC-CURSOR-CNT     TO PV-DISPLAY-CURSOR-COUNT.   45980000
           DISPLAY 'EMPDISC ROWS FETCHED = ' PV-DISPLAY-CURSOR-COUNT.   45990000
           MOVE PA-KKT-CURSOR-CNT         TO PV-DISPLAY-CURSOR-COUNT.   46000000
           DISPLAY 'KKT ROWS FETCHED     = ' PV-DISPLAY-CURSOR-COUNT.   46010000
           DISPLAY '                    '.                              46020000
           MOVE PA-GL-FILE-OUT-WRITTEN    TO PV-DISPLAY-CURSOR-COUNT.   46030000
           DISPLAY 'GL RECORDS WRITTEN   = ' PV-DISPLAY-CURSOR-COUNT.   46040000
           DISPLAY '                    '.                              46050000
                                                                        46060000
