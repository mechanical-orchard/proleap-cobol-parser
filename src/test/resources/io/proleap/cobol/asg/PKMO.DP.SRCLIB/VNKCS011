000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKCS011.                                         00020000
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  06/25/93.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    TRANID      - V011                                         * 00090000
001000*    TYPE        - CICS ARCHITECTURE INQUIRY - DB2              * 00100000
001100*    DESCRIPTION - SERVICES/PROGRAMS/INCENTIVES INQUIRY         * 00110000
001200*    MAPSET      - VNKM011                                      * 00120000
001300*                                                               * 00130000
001400*    THIS SCREEN ALLOWS USERS TO VIEW VENDOR SERVICES, PROGRAMS * 00140000
001500*    INCENTIVES.                                                * 00150000
001600*---------------------------------------------------------------* 00160000
001700* MODIFICATIONS MADE:                                             00170000
001800* DATE  03/09/2006                                                00180000
001900*     CHANGE MADE: REMOVED THE COOP AD DOLLARS AND FIXTURE/OTHER  00190000
002000*     DOLLARS INDICATORS FROM PROGRAM PER OK FROM WAYNE OSTLING.  00200000
002100*     ADDED CODE FOR DISPLAYING THE EFFECTIVE DATES FOR NEW STORE 00210000
002200*     DISC, MOS DISC, TRADE DISC, BROADCAST OFFINVOICE DISC.      00220000
002300*     ADDED CODE FOR NEW INCENTIVES: COOP ALW, MARKDOWN ALW,      00230000
002400*     TABLE/TOWER DATING.  REMOVED PARA 2200- BECAUSE IT WAS NOT  00240000
002500*     BEING USED IN THE PROGRAM.                                  00250000
002600*     MADE BY: MIKE BESKE              WR/IR #: WR30028           00260000
002700*                                                                 00270000
002800* DATE  05/29/2007                                                00280000
002900*     CHANGE MADE: DIRECT SHIP PROCESS                            00290000
003000*     ADDED CHRG_PCT AND CHRG_AMT TO TSERTYP OF SERVICE CURSOR.   00300000
003100*     ADDED ASC-DIRECT-SHIP-Y-N, ASC-DIRECT-SHIP-PCT AND          00310000
003200*     ASC-DIRECT-SHIP-DATE.  THESE ARE USED IN 4000-.  WITHIN     00320000
003300*     THE EVALUATE FOR TSERTYP: WHEN '10' MOVE 'Y' TO THE         00330000
003400*     ASC-DIRECT-SYIP-Y-N AND ALSO CHECK CHRG_PCT: WHEN IT        00340000
003500*     IS ZEROES MOVE THE CHRG_AMT TO ASC-DIRECT-SHIP-DATE         00350000
003600*     OTHERWISE MOVE CHRG_PCT TO ASC-DIRECT-SHIP-PCT.  THE 3 NEW  00360000
003700*     FIELDS ARE SET FOR THE SCREEN IF 4400-.                     00370000
003800*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR31112           00380000
003900*                                                                 00390004
004000* DATE  10/05/2007                                                00400004
004100*     CHANGE MADE: RESTORED THE DIRECT SHIP CODE FROM AN ARCHIVED 00410004
004200*     GENERATION OF VNKCS011.                                     00420004
004300*     MADE BY: MIKE BESKE              WR/IR #: INC000000096377   00430004
004310*                                                                 00431011
004320* DATE  05/02/2013                                                00432012
004330*     CHANGE MADE: ADDED RFID STATUS (TAGGING 'T' OR COMPLIANT    00433012
004340*     'C' OR 'N') TO SCREEN BASED ON TSERTYP BEING '11' OR '12'.  00434012
004350*     MADE BY: CHERI PARMLEY           WR/IR #: 5148B             00435012
004360*                                                                 00436014
004370* DATE  07/29/2013                                                00437014
004380*     CHANGE MADE: CORRECTED CODE BUG FROM RFID PROJECT IN        00438014
004390*     4000-BUILD-INITIAL-PANEL BY MOVING THE EVALUATE OF          00439014
004391*     SERTYP-SERVICE-ID FOR 11 AND 12 OUT FROM THE MIDDLE OF      00439114
004392*     THE CODE FOR VALUE OF 10.                                   00439214
004393*     MADE BY: MIKE BESKE              WR/IR #: CHG0059042        00439314
004360*                                                                 00439415
004370* DATE  01/05/2023                                                00439515
001420*            - CHANGE CALL OF DPKCS030 TO DYNAMIC               * 00439615
001450*      MADE BY: JEAN KURK               WR/IR #: CHG0277999      *00439715
004400*---------------------------------------------------------------* 00440000
004500                                                                  00450000
004600 ENVIRONMENT DIVISION.                                            00460000
004700 DATA DIVISION.                                                   00470000
004800/                                                                 00480000
004900 WORKING-STORAGE SECTION.                                         00490000
005000                                                                  00500000
005100 01  DN-DB2-NULL-INDICATORS.                                      00510000
005200     05  DN-UNIT-COST-AMT             PIC S9(04) VALUE +0         00520000
005300                                                  COMP.           00530000
005400     05  DN-UNIT-OF-MSMT              PIC S9(04) VALUE +0         00540000
005500                                                  COMP.           00550000
005600     05  DN-LEADTIME-DAYS-QTY         PIC S9(04) VALUE +0         00560000
005700                                                  COMP.           00570000
005800     05  DN-TKT-MKR-IND               PIC S9(04) VALUE +0         00580000
005900                                                  COMP.           00590000
006000     05  DN-BULK-STK-TKT-IND          PIC S9(04) VALUE +0         00600000
006100                                                  COMP.           00610000
006200     05  DN-DISCOUNT-PCT              PIC S9(04) VALUE +0         00620000
006300                                                  COMP.           00630000
006400     05  DN-EXT-PAY-DAYS-QTY          PIC S9(04) VALUE +0         00640000
006500                                                  COMP.           00650000
006600     05  DN-PARTIAL-IND               PIC S9(04) VALUE +0         00660000
006700                                                  COMP.           00670000
006800     05  DN-CHRG-PCT                  PIC S9(04) VALUE +0         00680000
006900                                                  COMP.           00690000
007000     05  DN-CHRG-AMT                  PIC S9(04) VALUE +0         00700000
007100                                                  COMP.           00710000
007200                                                                  00720000
007300 01  DK-DB2-KEYS.                                                 00730000
007400     05  DK-ENT-ID                    PIC S9(09) VALUE +0         00740000
007500                                                 COMP.            00750000
007600     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    00760000
007700     05  DK-INHOUSE-NUMBER-LOW        PIC S9(03) VALUE +0         00770000
007800                                                 COMP-3.          00780000
007900     05  DK-INHOUSE-NUMBER-HIGH       PIC S9(03) VALUE +0         00790000
008000                                                 COMP-3.          00800000
008100     05  DK-VENDOR-NAME-LOW           PIC X(30)  VALUE SPACES.    00810000
008200     05  DK-VENDOR-NAME-HIGH          PIC X(30)  VALUE SPACES.    00820000
008300                                                                  00830000
008400 01  PC-PROGRAM-CONSTANTS.                                        00840000
008500     05  PC-TRANS-ID                  PIC X(04)  VALUE 'V011'.    00850000
008600     05  PC-OPERATING-COMPANY         PIC X(02)  VALUE '03'.      00860000
008700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'VNKCS011'.00870000
008800     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'VN011A  '.00880000
008900     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'VNKM011 '.00890000
009000     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00900000
009100                                                 COMP.            00910000
009200     05  PC-INTER-APPL-CODES.                                     00920000
009300         10  PC-INTER-APPL-CRIT-SPEC  PIC X(01)  VALUE '1'.       00930000
009400         10  PC-INTER-APPL-LIST       PIC X(01)  VALUE '2'.       00940000
009500                                                                  00950000
009600     05  PC-TSYMSG-NUMBERS.                                       00960000
009700         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00970000
009800         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     00980000
009900         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     00990000
010000         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01000000
010100         10  PC-TSYMSG-00083          PIC 9(05)  VALUE 00083.     01010000
010200         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01020000
010300         10  PC-TSYMSG-00156          PIC 9(05)  VALUE 00156.     01030000
010400         10  PC-TSYMSG-00488          PIC 9(05)  VALUE 00488.     01040000
010500         10  PC-TSYMSG-00489          PIC 9(05)  VALUE 00489.     01050000
010600         10  PC-TSYMSG-00499          PIC 9(05)  VALUE 00499.     01060000
010700         10  PC-TSYMSG-00500          PIC 9(05)  VALUE 00500.     01070000
010800                                                                  01080000
010900 01  PS-PROGRAM-SWITCHES.                                         01090000
011000     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01100000
011100         88  PS-ERROR                            VALUE 'Y'.       01110000
011200         88  PS-NO-ERROR                         VALUE 'N'.       01120000
011300     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       01130000
011400         88  PS-LIST-END                         VALUE 'Y'.       01140000
011500         88  PS-NO-LIST-END                      VALUE 'N'.       01150000
011600     05  PS-EOF-SERVICE-CSR-SW        PIC X(01)  VALUE 'N'.       01160000
011700         88  PS-EOF-SERVICE-CSR                  VALUE 'Y'.       01170000
011800                                                                  01180000
011900 01  PV-PROGRAM-VARIABLES.                                        01190000
012000     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         01200000
012100                                                 COMP SYNC.       01210000
012200     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         01220000
012300                                                 COMP SYNC.       01230000
012400     05  PV-INHOUSE-NBR-X.                                        01240000
012500         10  PV-INHOUSE-NBR           PIC  9(03) VALUE ZERO.      01250000
012600     05  PV-INHOUSE-NUMBER            PIC S9(03) VALUE +0         01260000
012700                                                 COMP-3.          01270000
012800     05  PV-TABLE-NAME                PIC  X(08) VALUE SPACES.    01280000
012900     05  PV-EFFECTIVE-DATE            PIC  X(10).                 01290000
013000     05  PV-EFFECTIVE-DATE-RED REDEFINES PV-EFFECTIVE-DATE.       01300000
013100         10  PV-EFFECTIVE-CCYY        PIC  X(04).                 01310000
013200         10  FILLER                   PIC  X(01).                 01320000
013300         10  PV-EFFECTIVE-MM          PIC  X(02).                 01330000
013400         10  FILLER                   PIC  X(01).                 01340000
013500         10  PV-EFFECTIVE-DD          PIC  X(02).                 01350000
013600     05  PV-EFF-DATE                  PIC  X(10).                 01360000
013700     05  PV-EFF-DATE-RED REDEFINES PV-EFF-DATE.                   01370000
013800         10  PV-EFF-MM                PIC  X(02).                 01380000
013900         10  PV-EFF-SLASH1            PIC  X(01).                 01390000
014000         10  PV-EFF-DD                PIC  X(02).                 01400000
014100         10  PV-EFF-SLASH2            PIC  X(01).                 01410000
014200         10  PV-EFF-CCYY              PIC  X(04).                 01420000
014300                                                                  01430000
014400/                                                                 01440000
014500*----------------------------------------------------------------*01450000
014600*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *01460000
014700*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *01470000
014800*----------------------------------------------------------------*01480000
014900                                                                  01490000
015000     COPY VNWS003.                                                01500000
015100/                                                                 01510000
015200                                                                  01520000
015300*----------------------------------------------------------------*01530000
015400*    MAP LAYOUT                                                  *01540000
015500*----------------------------------------------------------------*01550000
015600                                                                  01560000
015700     COPY VNKM011.                                                01570000
015800                                                                  01580000
015900/                                                                 01590000
016000*----------------------------------------------------------------*01600000
016100*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *01610000
016200*----------------------------------------------------------------*01620000
016300                                                                  01630000
016400     COPY DPWS003.                                                01640000
016500                                                                  01650000
016600/                                                                 01660000
016700*----------------------------------------------------------------*01670000
016800*    ATTRIBUTE SETTINGS COPYBOOK.                                *01680000
016900*----------------------------------------------------------------*01690000
017000                                                                  01700000
017100     COPY DPWS015.                                                01710000
017200                                                                  01720000
017300/                                                                 01730000
017400*----------------------------------------------------------------*01740000
017500*    FUNCTION KEYS COPYBOOK                                      *01750000
017600*----------------------------------------------------------------*01760000
017700                                                                  01770000
017800     COPY DPWS016.                                                01780000
017900                                                                  01790000
018000/                                                                 01800000
018100*----------------------------------------------------------------*01810000
018200*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *01820000
018300*    SUB-ROUTINE (VNKUT100).                                     *01830000
018400*----------------------------------------------------------------*01840000
018500     COPY DPWS010I.                                               01850000
018600                                                                  01860000
018700/                                                                 01870000
018800*----------------------------------------------------------------*01880000
018900*    THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHIT.   *01890000
019000*    APPLICATION PROGRAMMING INTERFACE MODULE                    *01900015
019100*----------------------------------------------------------------*01910000
019200     COPY DPWS030.                                                01920000
019200     COPY DPWS930.                                                01921015
019300                                                                  01930000
019400/                                                                 01940000
019500*----------------------------------------------------------------*01950000
019600*    STANDARD COMMAREA.                                          *01960000
019700*----------------------------------------------------------------*01970000
019800                                                                  01980000
019900     COPY DPWS020.                                                01990000
020000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02000000
020100                                                                  02010000
020200*----------------------------------------------------------------*02020000
020300*    INTER-APPLICATION COMMAREA.                                 *02030000
020400*----------------------------------------------------------------*02040000
020500                                                                  02050000
020600         10  INTER-APPL-COMM-AREA PIC X(200).                     02060000
020700     COPY VNWS001.                                                02070000
020800     COPY VNWS002.                                                02080000
020900*----------------------------------------------------------------*02090000
021000*    SPECIFIC COMMMAREA FOR VNKCS011.                            *02100000
021100*----------------------------------------------------------------*02110000
021200         10  ASC-SPECIFIC-COMMAREA.                               02120000
021300             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             02130000
021400             15  ASC-USE-SELECTION-QUEUE-IND                      02140000
021500                                           PIC X(01).             02150000
021600                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        02160000
021700             15  ASC-SEL-QUEUE-NAME        PIC X(08).             02170000
021800             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     02180000
021900             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02190000
022000                                           PIC S9(09) COMP-3.     02200000
022100             15  ASC-SEL-SUB               PIC S9(04) COMP.       02210000
022200             15  ASC-SEL-ITEM              PIC S9(04) COMP.       02220000
022300             15  ASC-KEY-FIELDS.                                  02230000
022400                 20  ASC-KEY-ENT-ID        PIC S9(9) COMP.        02240000
022500                 20  ASC-KEY-DEPT-NBR      PIC X(03).             02250000
022600                 20  ASC-KEY-INHOUSE-NBR-LOW  PIC 9(03).          02260000
022700                 20  ASC-KEY-INHOUSE-NBR-HIGH PIC 9(03).          02270000
022800                 20  ASC-KEY-VENDOR-NAME-LOW  PIC X(30).          02280000
022900                 20  ASC-KEY-VENDOR-NAME-HIGH PIC X(30).          02290000
023000             15  ASC-SCREEN-FIELDS.                               02300000
023100                 20  ASC-INHOUSE-NBR        PIC 9(03).            02310000
023200                 20  ASC-ENT-NAME-DESC      PIC X(30).            02320000
023300                 20  ASC-DUN-NBR            PIC X(09).            02330000
023400                 20  ASC-PRE-TICK-IND       PIC X(01).            02340000
023500                 20  ASC-PACK-BY-STORE-Y-N  PIC X(01).            02350000
023600                 20  ASC-PRE-TICK-LEAD-TIME PIC 9(03).            02360000
023700                 20  ASC-HANGER-INSERT-Y-N  PIC X(01).            02370000
023800                 20  ASC-PRE-TICK-MAKER     PIC X(01).            02380000
023900                 20  ASC-PRE-TICK-BULK      PIC X(01).            02390000
024000                 20  ASC-SUP-TICK-IND       PIC X(01).            02400000
024100                 20  ASC-SUPPLIES-UPC-Y-N   PIC X(01).            02410000
024200                 20  ASC-DIRECT-SHIP-Y-N    PIC X(01).            02420000
024300                 20  ASC-DIRECT-SHIP-PCT    PIC 9(02)V99.         02430000
024400                 20  ASC-DIRECT-SHIP-RATE   PIC 9(04)V99.         02440000
024500                                                                  02450000
024600                 20  ASC-SUP-TICK-LEAD-TIME PIC 9(03).            02460000
024700                 20  ASC-NEW-STORE-DISC-IND PIC X(01).            02470000
024800                 20  ASC-NEW-STORE-DISC     PIC 9(02)V99.         02480000
024900                 20  ASC-NEW-STORE-DAYS     PIC 9(03).            02490000
025000                 20  ASC-SUP-TICK-MAKER     PIC X(01).            02500000
025100                 20  ASC-SUP-TICK-BULK      PIC X(01).            02510000
025200                 20  ASC-MOS-DISC-IND       PIC X(01).            02520000
025300                 20  ASC-MOS-DISC           PIC 9(02)V99.         02530000
025400                 20  ASC-TRADE-DISC-IND     PIC X(01).            02540000
025500                 20  ASC-TRADE-DISC         PIC 9(02)V99.         02550000
025600                 20  ASC-ADVTS-DISC-IND     PIC X(01).            02560000
025700                 20  ASC-ADVTS-DISC         PIC 9(02)V99.         02570000
025800                 20  ASC-DC-SPLIT-IND       PIC X(01).            02580000
025900                 20  ASC-DC-SPLIT-DAYS      PIC 9(04).            02590000
026000                 20  ASC-COOP-ALW-IND       PIC X(01).            02600000
026100                 20  ASC-COOP-ALW           PIC 9(02)V99.         02610000
026200                 20  ASC-PROFIT-ALW-IND     PIC X(01).            02620000
026300                 20  ASC-PROFIT-ALW         PIC 9(02)V99.         02630000
026400                 20  ASC-TBL-TWR-IND        PIC X(01).            02640000
026500                 20  ASC-TBL-TWR-DAYS       PIC 9(03).            02650000
026600                 20  ASC-NEW-STORE-EFFDATE  PIC X(10).            02660000
026700                 20  ASC-MOS-DISC-EFFDATE   PIC X(10).            02670000
026800                 20  ASC-TRADE-DISC-EFFDATE PIC X(10).            02680000
026900                 20  ASC-ADVTS-DISC-EFFDATE PIC X(10).            02690000
027000                 20  ASC-COOP-ALW-EFFDATE   PIC X(10).            02700000
027100                 20  ASC-PROFIT-ALW-EFFDATE PIC X(10).            02710000
027200                 20  ASC-TBL-TWR-EFFDATE    PIC X(10).            02720000
027300                 20  ASC-RFID-STATUS-N-T-C  PIC X(01).            02730012
027400                                                                  02740000
027500/                                                                 02750000
027600*----------------------------------------------------------------*02760000
027700*    ABEND PROCESSING COPYBOOK.                                  *02770000
027800*----------------------------------------------------------------*02780000
027900                                                                  02790000
028000     COPY DPWS013.                                                02800000
028100/                                                                 02810000
028200                                                                  02820000
028300*----------------------------------------------------------------*02830000
028400*    DB2 SQL COMMUNICATION AREA                                   02840000
028500*----------------------------------------------------------------*02850000
028600     EXEC SQL                                                     02860000
028700          INCLUDE SQLCA                                           02870000
028800     END-EXEC.                                                    02880000
028900/                                                                 02890000
029000                                                                  02900000
029100*----------------------------------------------------------------*02910000
029200*    DB2 DCLGEN FOR VENDOR DEPARTMENT TABLE                       02920000
029300*----------------------------------------------------------------*02930000
029400     EXEC SQL                                                     02940000
029500          INCLUDE TVNDDPT                                         02950000
029600     END-EXEC.                                                    02960000
029700/                                                                 02970000
029800                                                                  02980000
029900*----------------------------------------------------------------*02990000
030000*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE TABLE              03000000
030100*----------------------------------------------------------------*03010000
030200     EXEC SQL                                                     03020000
030300          INCLUDE TEXTENT                                         03030000
030400     END-EXEC.                                                    03040000
030500/                                                                 03050000
030600                                                                  03060000
030700*----------------------------------------------------------------*03070000
030800*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE NAME TABLE         03080000
030900*----------------------------------------------------------------*03090000
031000     EXEC SQL                                                     03100000
031100          INCLUDE TENTNME                                         03110000
031200     END-EXEC.                                                    03120000
031300/                                                                 03130000
031400                                                                  03140000
031500*----------------------------------------------------------------*03150000
031600*    DB2 DCLGEN FOR VENDOR AGREEMENT TABLE                        03160000
031700*----------------------------------------------------------------*03170000
031800     EXEC SQL                                                     03180000
031900          INCLUDE TVNDAGR                                         03190000
032000     END-EXEC.                                                    03200000
032100/                                                                 03210000
032200                                                                  03220000
032300*----------------------------------------------------------------*03230000
032400*    DB2 DCLGEN FOR SERVICE TYPE TABLE                            03240000
032500*----------------------------------------------------------------*03250000
032600     EXEC SQL                                                     03260000
032700          INCLUDE TSERTYP                                         03270000
032800     END-EXEC.                                                    03280000
032900                                                                  03290000
033000/                                                                 03300000
033100*----------------------------------------------------------------*03310000
033200*    DB2 DCLGEN FOR PROGRAM TYPE TABLE                            03320000
033300*----------------------------------------------------------------*03330000
033400     EXEC SQL                                                     03340000
033500          INCLUDE TPGMTYP                                         03350000
033600     END-EXEC.                                                    03360000
033700                                                                  03370000
033800/                                                                 03380000
033900*----------------------------------------------------------------*03390000
034000*    DB2 DCLGEN FOR INCENTIVES TYPE TABLE                         03400000
034100*----------------------------------------------------------------*03410000
034200     EXEC SQL                                                     03420000
034300          INCLUDE TINCTYP                                         03430000
034400     END-EXEC.                                                    03440000
034500                                                                  03450000
034600/                                                                 03460000
034700*---------------------------------------------------------------* 03470000
034800*  CURSOR TO SELECT SERIVCES/PRGROAMS/INCENTIVES FOR A DEPT     * 03480000
034900*---------------------------------------------------------------* 03490000
035000                                                                  03500000
035100     EXEC SQL                                                     03510000
035200         DECLARE SERVICE-CSR CURSOR FOR                           03520000
035300             SELECT 'TSERTYP'                                     03530000
035400                   ,B.SERVICE_ID                                  03540000
035500                   ,.0000                                         03550000
035600                   ,0000                                          03560000
035700                   ,A.EFFECTIVE_DATE                              03570000
035800                   ,A.CHRG_PCT                                    03580000
035900                   ,A.CHRG_AMT                                    03590000
036000             FROM TVNDAGR A                                       03600000
036100                 ,TSERTYP B                                       03610000
036200             WHERE A.DEPT_NBR          = :DK-DEPT-NBR             03620000
036300               AND A.ENT_ID            = :DK-ENT-ID               03630000
036400               AND A.AGRMT_TYP_ID      = '4'                      03640000
036500               AND A.EFFECTIVE_DATE   <= CURRENT DATE             03650000
036610               AND A.EXPIRATION_DATE  >  CURRENT DATE             03661010
036700               AND A.TYP_CDE           = B.SERVICE_ID             03670000
036800         UNION                                                    03680000
036900             SELECT 'TPGMTYP'                                     03690000
037000                   ,D.PROGRAM_ID                                  03700000
037100                   ,.0000                                         03710000
037200                   ,C.LEADTIME_DAYS_QTY                           03720000
037300                   ,C.EFFECTIVE_DATE                              03730000
037400                   ,.0000                                         03740000
037500                   ,0000                                          03750000
037600             FROM TVNDAGR C                                       03760000
037700                 ,TPGMTYP D                                       03770000
037800             WHERE C.DEPT_NBR          = :DK-DEPT-NBR             03780000
037900               AND C.ENT_ID            = :DK-ENT-ID               03790000
038000               AND C.AGRMT_TYP_ID      = '6'                      03800000
038100               AND C.EFFECTIVE_DATE   <= CURRENT DATE             03810000
038200               AND C.EXPIRATION_DATE  >  CURRENT DATE             03820000
038300               AND C.TYP_CDE           = D.PROGRAM_ID             03830000
038400         UNION                                                    03840000
038500             SELECT 'TINCTYP'                                     03850000
038600                   ,F.INCENTIVE_ID                                03860000
038700                   ,E.DISCOUNT_PCT                                03870000
038800                   ,E.EXT_PAY_DAYS_QTY                            03880000
038900                   ,E.EFFECTIVE_DATE                              03890000
039000                   ,.0000                                         03900000
039100                   ,0000                                          03910000
039200             FROM TVNDAGR E                                       03920000
039300                 ,TINCTYP F                                       03930000
039400             WHERE E.DEPT_NBR          = :DK-DEPT-NBR             03940000
039500               AND E.ENT_ID            = :DK-ENT-ID               03950000
039600               AND E.AGRMT_TYP_ID      = '5'                      03960000
039700               AND E.EFFECTIVE_DATE   <= CURRENT DATE             03970000
039800               AND E.EXPIRATION_DATE  >  CURRENT DATE             03980000
039900               AND E.TYP_CDE           = F.INCENTIVE_ID           03990000
040000             ORDER BY 1,2                                         04000000
040100             OPTIMIZE FOR 15 ROWS                                 04010000
040200     END-EXEC.                                                    04020000
040300                                                                  04030000
040400/                                                                 04040000
040500 LINKAGE SECTION.                                                 04050000
040600                                                                  04060000
040700 01  DFHCOMMAREA.                                                 04070000
040800     05  FILLER                       OCCURS  1 TO 4072 TIMES     04080000
040900                                      DEPENDING ON EIBCALEN.      04090000
041000         10  FILLER                   PIC X.                      04100000
041100                                                                  04110000
041200/                                                                 04120000
041300 PROCEDURE DIVISION.                                              04130000
041400                                                                  04140000
041500*----------------------------------------------------------------*04150000
041600*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *04160000
041700*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *04170000
041800*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *04180000
041900*                                                                *04190000
042000*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *04200000
042100*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *04210000
042200*----------------------------------------------------------------*04220000
042300 0000-MAIN-MODULE.                                                04230000
042400                                                                  04240000
042500     INITIALIZE DP030-CICS-API-FIELDS.                            04250000
042600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04260000
042700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04270000
042800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04280000
042900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04290000
043000     MOVE LENGTH OF VN011AI        TO DP030-MAP-LENGTH (1).       04300000
043100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04310000
043200     PERFORM 0001-CALL-CICS-ARCH-API.                             04320000
043300                                                                  04330000
043400     PERFORM 1000-CONTROL-PROCESSING.                             04340000
043500                                                                  04350000
043600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04360000
043700     PERFORM 0001-CALL-CICS-ARCH-API.                             04370000
043800                                                                  04380000
043900/                                                                 04390000
044000 0001-CALL-CICS-ARCH-API.                                         04400000
044100                                                                  04410000
044200*    CALL 'DPKCS030' USING DFHEIBLK                               04420015
044200     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04421015
044300                           DFHCOMMAREA                            04430000
044400                           DP030-CICS-API-FIELDS                  04440000
044500                           DP020-STANDARD-COMMAREA                04450000
044600                           VN011AI.                               04460000
044700                                                                  04470000
044800     IF  DP030-RC-CALL-SUCCESSFUL                                 04480000
044900         CONTINUE                                                 04490000
045000     ELSE                                                         04500000
045100         SET DP013-NO-ROLLBACK                                    04510000
045200             DP013-XCTL-DISPLAY-RESTART                           04520000
045300             DP013-CICS-ABEND      TO TRUE                        04530000
045400         MOVE 'BEFORE 0000-MAIN-MODULE'                           04540000
045500                                   TO DP013-PARAGRAPH             04550000
045600*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04560015
045700*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04570015
045600         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04571015
045700-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04572015
045800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04580000
045900         PERFORM DP013-0000-PROCESS-ABEND                         04590000
046000     END-IF.                                                      04600000
046100                                                                  04610000
046200/                                                                 04620000
046300*----------------------------------------------------------------*04630000
046400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04640000
046500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04650000
046600*----------------------------------------------------------------*04660000
046700                                                                  04670000
046800 1000-CONTROL-PROCESSING.                                         04680000
046900                                                                  04690000
047000     EVALUATE TRUE                                                04700000
047100         WHEN DP020-NEXT-ACT-INITIAL                              04710000
047200              PERFORM 1100-PROCESS-INTER-APPL-COMM                04720000
047300              IF  PS-ERROR                                        04730000
047400                  CONTINUE                                        04740000
047500              ELSE                                                04750000
047600                  PERFORM 4000-BUILD-INITIAL-PANEL                04760000
047700                     THRU 4000-EXIT                               04770000
047800                  PERFORM 3200-RESET-ATTRIBUTES                   04780000
047900              END-IF                                              04790000
048000                                                                  04800000
048100         WHEN DP020-NEXT-ACT-READ-MAP                             04810000
048200              PERFORM 2000-PROCESS-PANEL                          04820000
048300                                                                  04830000
048400         WHEN DP020-NEXT-ACT-RETURN                               04840000
048500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                04850000
048600              PERFORM 3200-RESET-ATTRIBUTES                       04860000
048700                                                                  04870000
048800         WHEN OTHER                                               04880000
048900              SET DP013-LOGIC-ABEND                               04890000
049000                  DP013-NO-ROLLBACK TO TRUE                       04900000
049100              MOVE '1000-CONTROL-PROCESSING'                      04910000
049200                                    TO DP013-PARAGRAPH            04920000
049300              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  04930000
049400                                    TO DP013-MESSAGE-TEXT(1)      04940000
049500              MOVE DP020-NEXT-APPL-ACTIVITY                       04950000
049600                                    TO DP013-MESSAGE-TEXT(2)      04960000
049700              PERFORM DP013-0000-PROCESS-ABEND                    04970000
049800     END-EVALUATE.                                                04980000
049900                                                                  04990000
050000/                                                                 05000000
050100*----------------------------------------------------------------*05010000
050200*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *05020000
050300*    INTER-APPLICATION FORMAT CODE.                              *05030000
050400*----------------------------------------------------------------*05040000
050500 1100-PROCESS-INTER-APPL-COMM.                                    05050000
050600                                                                  05060000
050700     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05070000
050800                                                                  05080000
050900     MOVE DP020-INT-APPL-FORMAT-IND                               05090000
051000                                   TO ASC-INT-APPL-FORMAT-IND.    05100000
051100                                                                  05110000
051200     EVALUATE DP020-INT-APPL-FORMAT-IND                           05120000
051300         WHEN PC-INTER-APPL-CRIT-SPEC                             05130000
051400             IF  VN001-DEPARTMENT-NUMBER = SPACES                 05140000
051500             AND VN001-INHOUSE-NUMBER    = SPACES                 05150000
051600             AND VN001-VENDOR-NAME       = SPACES                 05160000
051700             OR  (VN001-DEPARTMENT-NUMBER  > SPACES               05170000
051800             AND (VN001-INHOUSE-NUMBER    = SPACES                05180000
051900             AND  VN001-VENDOR-NAME       = SPACES))              05190000
052000                 MOVE PC-TSYMSG-00488                             05200000
052100                                   TO DP020-MSG-NUMBER            05210000
052200                 SET PS-ERROR                                     05220000
052300                     DP020-MSG-FATAL                              05230000
052400                     DP020-NEXT-ACT-APPL-ERROR                    05240000
052500                     DP030-OVERRIDE-GO                            05250000
052600                                   TO TRUE                        05260000
052700             ELSE                                                 05270000
052800                 PERFORM 1105-PREPARE-KEYS                        05280000
052900                 PERFORM 1110-GET-ENTERPRISE-ID                   05290000
053000             END-IF                                               05300000
053100                                                                  05310000
053200         WHEN PC-INTER-APPL-LIST                                  05320000
053300             IF  VN002-NUMBER-OF-SELECTED-ITEMS = ZERO            05330000
053400                 SET PS-ERROR                                     05340000
053500                     DP020-MSG-WARNING                            05350000
053600                     DP020-NEXT-ACT-APPL-ERROR                    05360000
053700                     DP030-OVERRIDE-GO                            05370000
053800                                   TO TRUE                        05380000
053900                 MOVE PC-TSYMSG-00057                             05390000
054000                                   TO DP020-MSG-NUMBER            05400000
054100             ELSE                                                 05410000
054200                 SET ASC-USE-SELECTION-QUEUE TO TRUE              05420000
054300                 MOVE VN002-NUMBER-OF-SELECTED-ITEMS              05430000
054400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS05440000
054500                 MOVE VN002-NUMBER-OF-TS-ITEMS                    05450000
054600                                   TO ASC-NUMBER-OF-TS-ITEMS      05460000
054700                 MOVE VN002-SEL-QUEUE-NAME                        05470000
054800                                   TO ASC-SEL-QUEUE-NAME          05480000
054900                 PERFORM 1120-PREPARE-LIST-ENTRY                  05490000
055000             END-IF                                               05500000
055100                                                                  05510000
055200         WHEN OTHER                                               05520000
055300             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            05530000
055400             SET DP020-MSG-FATAL                                  05540000
055500                 DP020-NEXT-ACT-APPL-ERROR                        05550000
055600                                   TO TRUE                        05560000
055700     END-EVALUATE.                                                05570000
055800                                                                  05580000
055900/                                                                 05590000
056000 1105-PREPARE-KEYS.                                               05600000
056100                                                                  05610000
056200     MOVE VN001-DEPARTMENT-NUMBER  TO DK-DEPT-NBR                 05620000
056300                                      ASC-KEY-DEPT-NBR.           05630000
056400                                                                  05640000
056500     IF  VN001-INHOUSE-NUMBER > SPACES                            05650000
056600         MOVE VN001-INHOUSE-NUMBER                                05660000
056700                                   TO PV-INHOUSE-NBR-X            05670000
056800         MOVE PV-INHOUSE-NBR       TO ASC-KEY-INHOUSE-NBR-LOW     05680000
056900                                      ASC-KEY-INHOUSE-NBR-HIGH    05690000
057000                                      DK-INHOUSE-NUMBER-LOW       05700000
057100                                      DK-INHOUSE-NUMBER-HIGH      05710000
057200         MOVE SPACES               TO ASC-KEY-VENDOR-NAME-LOW     05720000
057300                                      DK-VENDOR-NAME-LOW          05730000
057400         MOVE ALL '9'              TO ASC-KEY-VENDOR-NAME-HIGH    05740000
057500                                      DK-VENDOR-NAME-HIGH         05750000
057600     ELSE                                                         05760000
057700         MOVE +0                   TO ASC-KEY-INHOUSE-NBR-LOW     05770000
057800                                      DK-INHOUSE-NUMBER-LOW       05780000
057900         MOVE +999                 TO ASC-KEY-INHOUSE-NBR-HIGH    05790000
058000                                      DK-INHOUSE-NUMBER-HIGH      05800000
058100         IF  VN001-VENDOR-NAME > SPACES                           05810000
058200             MOVE VN001-VENDOR-NAME TO                            05820000
058300                                      DK-VENDOR-NAME-LOW          05830000
058400                                      ASC-KEY-VENDOR-NAME-LOW     05840000
058500                                      DK-VENDOR-NAME-HIGH         05850000
058600                                      ASC-KEY-VENDOR-NAME-HIGH    05860000
058700         ELSE                                                     05870000
058800             MOVE SPACES           TO ASC-KEY-VENDOR-NAME-LOW     05880000
058900                                      DK-VENDOR-NAME-LOW          05890000
059000             MOVE ALL '9'          TO ASC-KEY-VENDOR-NAME-HIGH    05900000
059100                                      DK-VENDOR-NAME-HIGH         05910000
059200         END-IF                                                   05920000
059300     END-IF.                                                      05930000
059400                                                                  05940000
059500                                                                  05950000
059600/                                                                 05960000
059700 1110-GET-ENTERPRISE-ID.                                          05970000
059800                                                                  05980000
059900     PERFORM                                                      05990000
060000         WITH TEST AFTER                                          06000000
060100         VARYING PV-RETRY-COUNTER                                 06010000
060200         FROM 1 BY 1                                              06020000
060300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               06030000
060400             OR (SQLCODE = +0)                                    06040000
060500             OR (SQLCODE = +100))                                 06050000
060600                                                                  06060000
060700         EXEC SQL                                                 06070000
060800             SELECT DISTINCT A.ENT_ID                             06080000
060900               INTO :VNDDPT-ENT-ID                                06090000
061000               FROM TVNDDPT A                                     06100000
061100                   ,TENTNME B                                     06110000
061200              WHERE A.ENT_ID   = B.ENT_ID                         06120000
061300                AND A.DEPT_NBR = :DK-DEPT-NBR                     06130000
061400                AND A.INHOUSE_NBR BETWEEN :DK-INHOUSE-NUMBER-LOW  06140000
061500                                      AND :DK-INHOUSE-NUMBER-HIGH 06150000
061600                AND B.ENT_NAME_DESC BETWEEN :DK-VENDOR-NAME-LOW   06160000
061700                                        AND :DK-VENDOR-NAME-HIGH  06170000
061800         END-EXEC                                                 06180000
061900                                                                  06190000
062000         EVALUATE TRUE                                            06200000
062100             WHEN SQLCODE = +0                                    06210000
062200                  MOVE VNDDPT-ENT-ID TO ASC-KEY-ENT-ID            06220000
062300                                        DK-ENT-ID                 06230000
062400                                                                  06240000
062500             WHEN SQLCODE = +100                                  06250000
062600                  SET PS-ERROR                                    06260000
062700                      DP020-MSG-FATAL                             06270000
062800                      DP020-NEXT-ACT-APPL-ERROR                   06280000
062900                                     TO TRUE                      06290000
063000                  IF  VN001-INHOUSE-NUMBER > SPACES               06300000
063100                      MOVE PC-TSYMSG-00156                        06310000
063200                                      TO DP020-MSG-NUMBER         06320000
063300                  ELSE                                            06330000
063400                      IF  VN001-VENDOR-NAME > SPACES              06340000
063500                          MOVE PC-TSYMSG-00489                    06350000
063600                                      TO DP020-MSG-NUMBER         06360000
063700                      END-IF                                      06370000
063800                  END-IF                                          06380000
063900                                                                  06390000
064000             WHEN SQLCODE = -904                                  06400000
064100             WHEN SQLCODE = -913                                  06410000
064200                  CONTINUE                                        06420000
064300                                                                  06430000
064400             WHEN SQLWARN0 NOT = SPACES                           06440000
064500             WHEN SQLCODE < +0                                    06450000
064600             WHEN SQLCODE > +0                                    06460000
064700                  MOVE '1110-GET-ENTERPRISE-ID'                   06470000
064800                                  TO DP013-PARAGRAPH              06480000
064900                  MOVE 'UNSUCCESSFUL SELECT ENTERPRIS ID'         06490000
065000                                  TO DP013-MESSAGE-TEXT (1)       06500000
065100                  MOVE SQLCA      TO DP013-SQLCA                  06510000
065200                  MOVE 'TVNDDPT ' TO DP013-DB2-TABLE-NAME (1)     06520000
065300                  SET DP013-DB2-ABEND                             06530000
065400                      DP013-XCTL-DISPLAY-RESTART                  06540000
065500                                  TO TRUE                         06550000
065600                  PERFORM DP013-0000-PROCESS-ABEND                06560000
065700         END-EVALUATE                                             06570000
065800     END-PERFORM.                                                 06580000
065900                                                                  06590000
066000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        06600000
066100         MOVE '1110-GET-ENTERPRISE-ID'                            06610000
066200                                  TO DP013-PARAGRAPH              06620000
066300         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE ID'      06630000
066400                                  TO DP013-MESSAGE-TEXT (1)       06640000
066500         MOVE SQLCA               TO DP013-SQLCA                  06650000
066600         MOVE 'TVNDDPT '          TO DP013-DB2-TABLE-NAME (1)     06660000
066700         SET DP013-DB2-ABEND                                      06670000
066800             DP013-XCTL-DISPLAY-RESTART                           06680000
066900                                  TO TRUE                         06690000
067000         PERFORM DP013-0000-PROCESS-ABEND                         06700000
067100     END-IF.                                                      06710000
067200                                                                  06720000
067300/                                                                 06730000
067400*----------------------------------------------------------------*06740000
067500*    ENTRY IS FROM A LIST.  GET THE VENDOR NUMBER FROM THE       *06750000
067600*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *06760000
067700*----------------------------------------------------------------*06770000
067800 1120-PREPARE-LIST-ENTRY.                                         06780000
067900                                                                  06790000
068000     MOVE VN003-MAX-ITEMS          TO ASC-SEL-SUB.                06800000
068100     MOVE ZERO                     TO ASC-SEL-ITEM.               06810000
068200     PERFORM 2110-GET-NEXT-VENDOR.                                06820000
068300                                                                  06830000
068400/                                                                 06840000
068500*----------------------------------------------------------------*06850000
068600*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*06860000
068700*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*06870000
068800*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *06880000
068900*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *06890000
069000*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *06900000
069100*----------------------------------------------------------------*06910000
069200                                                                  06920000
069300 2000-PROCESS-PANEL.                                              06930000
069400                                                                  06940000
069500     EVALUATE TRUE                                                06950000
069600                                                                  06960000
069700         WHEN DP020-SRC-AID = DP016-CLEAR                         06970000
069800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06980000
069900                                                                  06990000
070000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07000000
070100             MOVE ASC-KEY-ENT-ID   TO DK-ENT-ID                   07010000
070200             MOVE ASC-KEY-DEPT-NBR TO DK-DEPT-NBR                 07020000
070300             MOVE ASC-KEY-INHOUSE-NBR-LOW                         07030000
070400                                   TO DK-INHOUSE-NUMBER-LOW       07040000
070500             MOVE ASC-KEY-INHOUSE-NBR-HIGH                        07050000
070600                                   TO DK-INHOUSE-NUMBER-HIGH      07060000
070700             MOVE ASC-KEY-VENDOR-NAME-LOW                         07070000
070800                                   TO DK-VENDOR-NAME-LOW          07080000
070900             MOVE ASC-KEY-VENDOR-NAME-HIGH                        07090000
071000                                   TO DK-VENDOR-NAME-HIGH         07100000
071100             PERFORM 4000-BUILD-INITIAL-PANEL                     07110000
071200                THRU 4000-EXIT                                    07120000
071300             PERFORM 3200-RESET-ATTRIBUTES                        07130000
071400                                                                  07140000
071500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07150000
071600             IF  ASC-USE-SELECTION-QUEUE                          07160000
071700                 PERFORM 2110-GET-NEXT-VENDOR                     07170000
071800                 IF PS-LIST-END                                   07180000
071900                    SET PS-NO-LIST-END                            07190000
072000                                   TO TRUE                        07200000
072100                 ELSE                                             07210000
072200                    PERFORM 4000-BUILD-INITIAL-PANEL              07220000
072300                       THRU 4000-EXIT                             07230000
072400                    PERFORM 3200-RESET-ATTRIBUTES                 07240000
072500                 END-IF                                           07250000
072600             ELSE                                                 07260000
072700*                --- BOTTOM OF LIST ---                           07270000
072800                 MOVE PC-TSYMSG-00070                             07280000
072900                                   TO DP020-MSG-NUMBER            07290000
073000                 SET DP020-MSG-INFORMATIONAL                      07300000
073100                     PS-LIST-END   TO TRUE                        07310000
073200             END-IF                                               07320000
073300                                                                  07330000
073400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             07340000
073500             IF  ASC-USE-SELECTION-QUEUE                          07350000
073600                 PERFORM 2120-GET-PREV-VENDOR                     07360000
073700                 IF PS-LIST-END                                   07370000
073800                    SET PS-NO-LIST-END                            07380000
073900                                   TO TRUE                        07390000
074000                 ELSE                                             07400000
074100                    PERFORM 4000-BUILD-INITIAL-PANEL              07410000
074200                       THRU 4000-EXIT                             07420000
074300                    PERFORM 3200-RESET-ATTRIBUTES                 07430000
074400                 END-IF                                           07440000
074500             ELSE                                                 07450000
074600*                --- TOP OF LIST ---                              07460000
074700                 MOVE PC-TSYMSG-00069                             07470000
074800                                   TO DP020-MSG-NUMBER            07480000
074900                 SET DP020-MSG-INFORMATIONAL                      07490000
075000                     PS-LIST-END   TO TRUE                        07500000
075100             END-IF                                               07510000
075200                                                                  07520000
075300         WHEN OTHER                                               07530000
075400             PERFORM 2100-CHECK-FUNCTION-KEY                      07540000
075500     END-EVALUATE.                                                07550000
075600                                                                  07560000
075700/                                                                 07570000
075800*----------------------------------------------------------------*07580000
075900*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *07590000
076000*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*07600000
076100*    FROM THE CICS ARCHITECTURE API.                             *07610000
076200*----------------------------------------------------------------*07620000
076300                                                                  07630000
076400 2100-CHECK-FUNCTION-KEY.                                         07640000
076500                                                                  07650000
076600     EVALUATE TRUE                                                07660000
076700         WHEN DP020-SRC-AID = DP016-ENTER                         07670000
076800             CONTINUE                                             07680000
076900                                                                  07690000
077000         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  07700000
077100             MOVE ASC-KEY-DEPT-NBR TO VN001-DEPARTMENT-NUMBER     07710000
077200             MOVE ASC-INHOUSE-NBR  TO VN001-INHOUSE-NUMBER        07720000
077300             MOVE ASC-ENT-NAME-DESC                               07730000
077400                                   TO VN001-VENDOR-NAME           07740000
077500             MOVE ASC-DUN-NBR      TO VN001-DUNS-NUMBER           07750000
077600                                                                  07760000
077700         WHEN OTHER                                               07770000
077800             SET DP013-NO-ROLLBACK                                07780000
077900                 DP013-XCTL-DISPLAY-RESTART                       07790000
078000                 DP013-CICS-ABEND  TO TRUE                        07800000
078100             MOVE '2100-CHECK-FUNCTION-KEY'                       07810000
078200                                   TO DP013-PARAGRAPH             07820000
078300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07830000
078400                                   TO DP013-MESSAGE-TEXT (1)      07840000
078500             PERFORM DP013-0000-PROCESS-ABEND                     07850000
078600     END-EVALUATE.                                                07860000
078700                                                                  07870000
078800/                                                                 07880000
078900*----------------------------------------------------------------*07890000
079000*    GET THE VENDOR NUMBER (KEY) OF THE NEXT SELECTED OBJECT     *07900000
079100*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *07910000
079200*----------------------------------------------------------------*07920000
079300 2110-GET-NEXT-VENDOR.                                            07930000
079400                                                                  07940000
079500     ADD +1                        TO ASC-SEL-SUB.                07950000
079600     IF  ASC-SEL-SUB > VN003-MAX-ITEMS                            07960000
079700         ADD +1                    TO ASC-SEL-ITEM                07970000
079800         MOVE +1                   TO ASC-SEL-SUB                 07980000
079900     END-IF.                                                      07990000
080000                                                                  08000000
080100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08010000
080200         PERFORM 9100-READ-SEL-QUEUE                              08020000
080300         IF  VN003-ITEM (ASC-SEL-SUB) > ZERO                      08030000
080400             MOVE VN003-DEPARTMENT (ASC-SEL-SUB)                  08040000
080500                                   TO ASC-KEY-DEPT-NBR            08050000
080600                                      DK-DEPT-NBR                 08060000
080700             MOVE VN003-ENT-ID (ASC-SEL-SUB)                      08070000
080800                                   TO ASC-KEY-ENT-ID              08080000
080900                                      DK-ENT-ID                   08090000
081000             SET VN003-INQ (ASC-SEL-SUB)                          08100000
081100                                   TO TRUE                        08110000
081200             PERFORM 9200-REWRITE-LIST-QUEUE                      08120000
081300             INITIALIZE ASC-SCREEN-FIELDS                         08130000
081400         ELSE                                                     08140000
081500             SUBTRACT +1 FROM ASC-SEL-SUB                         08150000
081600*            --- BOTTOM OF LIST ---                               08160000
081700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            08170000
081800             SET DP020-MSG-INFORMATIONAL                          08180000
081900                 PS-LIST-END                                      08190000
082000                                   TO TRUE                        08200000
082100         END-IF                                                   08210000
082200     ELSE                                                         08220000
082300         SUBTRACT +1 FROM ASC-SEL-ITEM                            08230000
082400         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 08240000
082500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            08250000
082600         SET DP020-MSG-INFORMATIONAL                              08260000
082700             PS-LIST-END                                          08270000
082800                                   TO TRUE                        08280000
082900     END-IF.                                                      08290000
083000                                                                  08300000
083100/                                                                 08310000
083200*----------------------------------------------------------------*08320000
083300*    GET THE VENDOR NUMBER (KEY) OF THE PREVIOUS SELECTED        *08330000
083400*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *08340000
083500*----------------------------------------------------------------*08350000
083600 2120-GET-PREV-VENDOR.                                            08360000
083700                                                                  08370000
083800     SUBTRACT +1 FROM ASC-SEL-SUB.                                08380000
083900     IF  ASC-SEL-SUB < +1                                         08390000
084000         SUBTRACT +1 FROM ASC-SEL-ITEM                            08400000
084100         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 08410000
084200     END-IF.                                                      08420000
084300                                                                  08430000
084400     IF  ASC-SEL-ITEM > ZERO                                      08440000
084500         PERFORM 9100-READ-SEL-QUEUE                              08450000
084600         MOVE VN003-DEPARTMENT (ASC-SEL-SUB)                      08460000
084700                                   TO ASC-KEY-DEPT-NBR            08470000
084800                                      DK-DEPT-NBR                 08480000
084900         MOVE VN003-ENT-ID (ASC-SEL-SUB)                          08490000
085000                                   TO ASC-KEY-ENT-ID              08500000
085100                                      DK-ENT-ID                   08510000
085200         INITIALIZE ASC-SCREEN-FIELDS                             08520000
085300     ELSE                                                         08530000
085400         MOVE +1                   TO ASC-SEL-ITEM                08540000
085500                                      ASC-SEL-SUB                 08550000
085600*        --- TOP OF LIST ---                                      08560000
085700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            08570000
085800         SET DP020-MSG-INFORMATIONAL                              08580000
085900             PS-LIST-END           TO TRUE                        08590000
086000     END-IF.                                                      08600000
086100                                                                  08610000
086200/                                                                 08620000
086300*----------------------------------------------------------------*08630000
086400*    RESET THE ATTRIBUTES OF CERTAIN FIELDS ON THE MAP.          *08640000
086500*----------------------------------------------------------------*08650000
086600                                                                  08660000
086700 3200-RESET-ATTRIBUTES.                                           08670000
086800                                                                  08680000
086900     CONTINUE.                                                    08690000
087000/                                                                 08700000
087100                                                                  08710000
087200 4000-BUILD-INITIAL-PANEL.                                        08720000
087300                                                                  08730000
087400     INITIALIZE ASC-SCREEN-FIELDS.                                08740000
087500                                                                  08750000
087600     SET DP030-SET-CURSOR-TRAILER                                 08760000
087700         PS-NO-ERROR             TO TRUE.                         08770000
087800                                                                  08780000
087900     MOVE 'N'                    TO ASC-PRE-TICK-IND              08790000
088000                                    ASC-PACK-BY-STORE-Y-N         08800000
088100                                    ASC-HANGER-INSERT-Y-N         08810000
088200                                    ASC-SUPPLIES-UPC-Y-N          08820000
088300                                    ASC-DIRECT-SHIP-Y-N           08830000
088400                                    ASC-SUP-TICK-IND              08840000
088500                                    ASC-NEW-STORE-DISC-IND        08850000
088600                                    ASC-MOS-DISC-IND              08860000
088700                                    ASC-TRADE-DISC-IND            08870000
088800                                    ASC-ADVTS-DISC-IND            08880000
088900                                    ASC-COOP-ALW-IND              08890000
089000                                    ASC-PROFIT-ALW-IND            08900000
089100                                    ASC-TBL-TWR-IND               08910005
089110                                    ASC-RFID-STATUS-N-T-C.        08911011
089200                                                                  08920000
089300     MOVE ZEROES                 TO ASC-DIRECT-SHIP-PCT           08930000
089400                                    ASC-DIRECT-SHIP-RATE.         08940000
089500                                                                  08950000
089600     PERFORM 4010-GET-HEADING-INFO.                               08960000
089700                                                                  08970000
089800     IF  PS-NO-ERROR                                              08980000
089900         CONTINUE                                                 08990000
090000     ELSE                                                         09000000
090100         GO TO 4000-EXIT                                          09010000
090200     END-IF.                                                      09020000
090300                                                                  09030000
090400     PERFORM 4020-GET-PRE-TICKET-INFO.                            09040000
090500                                                                  09050000
090600     IF  SQLCODE = +0                                             09060000
090700         MOVE 'Y'                TO ASC-PRE-TICK-IND              09070000
090800         IF  DN-PARTIAL-IND NOT = -1                              09080000
090900             MOVE VNDAGR-PARTIAL-IND                              09090000
091000                                 TO ASC-PRE-TICK-IND              09100000
091100         END-IF                                                   09110000
091200         IF  DN-LEADTIME-DAYS-QTY = -1                            09120000
091300             MOVE ZEROES         TO ASC-PRE-TICK-LEAD-TIME        09130000
091400         ELSE                                                     09140000
091500             MOVE VNDAGR-LEADTIME-DAYS-QTY                        09150000
091600                                 TO ASC-PRE-TICK-LEAD-TIME        09160000
091700         END-IF                                                   09170000
091800         IF  DN-TKT-MKR-IND = -1                                  09180000
091900             MOVE SPACES         TO ASC-PRE-TICK-MAKER            09190000
092000         ELSE                                                     09200000
092100             MOVE VNDAGR-TKT-MKR-IND                              09210000
092200                                 TO ASC-PRE-TICK-MAKER            09220000
092300         END-IF                                                   09230000
092400         IF  DN-BULK-STK-TKT-IND = -1                             09240000
092500             MOVE SPACES         TO ASC-PRE-TICK-BULK             09250000
092600         ELSE                                                     09260000
092700             MOVE VNDAGR-BULK-STK-TKT-IND                         09270000
092800                                 TO ASC-PRE-TICK-BULK             09280000
092900         END-IF                                                   09290000
093000     ELSE                                                         09300000
093100         MOVE 'N'                TO ASC-PRE-TICK-IND              09310000
093200     END-IF.                                                      09320000
093300                                                                  09330000
093400     PERFORM 4030-GET-SUP-TICKET-INFO.                            09340000
093500                                                                  09350000
093600     IF  SQLCODE = +0                                             09360000
093700         MOVE 'Y'                TO ASC-SUP-TICK-IND              09370000
093800         IF  DN-PARTIAL-IND NOT = -1                              09380000
093900             MOVE VNDAGR-PARTIAL-IND                              09390000
094000                                 TO ASC-SUP-TICK-IND              09400000
094100         END-IF                                                   09410000
094200         IF  DN-LEADTIME-DAYS-QTY = -1                            09420000
094300             MOVE ZEROES         TO ASC-SUP-TICK-LEAD-TIME        09430000
094400         ELSE                                                     09440000
094500             MOVE VNDAGR-LEADTIME-DAYS-QTY                        09450000
094600                                 TO ASC-SUP-TICK-LEAD-TIME        09460000
094700         END-IF                                                   09470000
094800         IF  DN-TKT-MKR-IND = -1                                  09480000
094900             MOVE SPACES         TO ASC-SUP-TICK-MAKER            09490000
095000         ELSE                                                     09500000
095100             MOVE VNDAGR-TKT-MKR-IND                              09510000
095200                                 TO ASC-SUP-TICK-MAKER            09520000
095300         END-IF                                                   09530000
095400         IF  DN-BULK-STK-TKT-IND = -1                             09540000
095500             MOVE SPACES         TO ASC-SUP-TICK-BULK             09550000
095600         ELSE                                                     09560000
095700             MOVE VNDAGR-BULK-STK-TKT-IND                         09570000
095800                                 TO ASC-SUP-TICK-BULK             09580000
095900         END-IF                                                   09590000
096000     ELSE                                                         09600000
096100         MOVE 'N'                TO ASC-SUP-TICK-IND              09610000
096200     END-IF.                                                      09620000
096300                                                                  09630000
096400     MOVE 'N'                    TO PS-EOF-SERVICE-CSR-SW.        09640000
096500                                                                  09650000
096600     PERFORM 4040-OPEN-SERVICE-CSR.                               09660000
096700     PERFORM 4050-FETCH-SERVICE-CSR.                              09670000
096800                                                                  09680000
096900     PERFORM UNTIL PS-EOF-SERVICE-CSR                             09690000
097000       EVALUATE PV-TABLE-NAME                                     09700000
097100          WHEN 'TSERTYP'                                          09710000
097200             EVALUATE SERTYP-SERVICE-ID                           09720000
097300                WHEN 2                                            09730000
097400                   MOVE 'Y'       TO ASC-HANGER-INSERT-Y-N        09740000
097500                WHEN 3                                            09750000
097600                   MOVE 'Y'       TO ASC-SUPPLIES-UPC-Y-N         09760000
097700                WHEN 4                                            09770000
097800                   MOVE 'Y'       TO ASC-PACK-BY-STORE-Y-N        09780000
097900                WHEN 10                                           09790000
098000                   MOVE 'Y'       TO ASC-DIRECT-SHIP-Y-N          09800000
098300*  IF THE VALUE OF THE DATABASE CHARGE PERCENT IS NULL, MOVE 0 TO 09830003
098400*  ASC-DIRECT-SHIP-PCT AND MOVE THE DATABASE CHARGE AMOUNT TO     09840003
098500*  ASC-DIRECT-SHIP-RATE AMOUNT FIELD.                             09850003
098600                   IF DN-CHRG-PCT = -1                            09860003
098700                      MOVE ZEROES TO ASC-DIRECT-SHIP-PCT          09870000
098800                      MOVE VNDAGR-CHRG-AMT                        09880000
098900                                         TO ASC-DIRECT-SHIP-RATE  09890000
099000                   ELSE                                           09900002
099100*  IF THE VALUE OF THE DATABASE CHARGE AMOUNT IS NULL, MOVE 0 TO  09910003
099200*  ASC-DIRECT-SHIP-RATE AND MOVE THE DATABASE CHARGE PERCENT * 10009920003
099300*  TO THE ASC-DIRECT-SHIP-PCT FIELD.                              09930003
099400                      IF DN-CHRG-AMT = -1                         09940002
099500                         MOVE ZEROES TO ASC-DIRECT-SHIP-RATE      09950002
099600                         COMPUTE ASC-DIRECT-SHIP-PCT =            09960002
099700                                VNDAGR-CHRG-PCT * 100             09970002
099800                      ELSE                                        09980002
099900*  WHEN THE DATABASE CHARGE PERCENT AND AMOUNT VALUES ARE NOT NULL09990003
100000*  POPULATE ASC- FIELDS WITH THE DATABASE VALUES.                 10000003
100100                         COMPUTE ASC-DIRECT-SHIP-PCT =            10010002
100200                                VNDAGR-CHRG-PCT * 100             10020002
100300                         MOVE VNDAGR-CHRG-AMT                     10030002
100400                                      TO ASC-DIRECT-SHIP-RATE     10040002
100500                      END-IF                                      10050002
100600                   END-IF                                         10060002
100610                WHEN 11                                           10061012
100620                   MOVE 'T'       TO ASC-RFID-STATUS-N-T-C        10062012
100630                WHEN 12                                           10063012
100640                   MOVE 'C'       TO ASC-RFID-STATUS-N-T-C        10064012
100700             END-EVALUATE                                         10070002
100800          WHEN 'TPGMTYP'                                          10080002
100900             EVALUATE SERTYP-SERVICE-ID                           10090002
101000                WHEN 5                                            10100002
101100                   IF  VNDAGR-EXT-PAY-DAYS-QTY = 0                10110002
101200                       MOVE 'Y'   TO ASC-DC-SPLIT-IND             10120002
101300                       MOVE ZERO  TO ASC-DC-SPLIT-DAYS            10130002
101400                   ELSE                                           10140002
101500                       MOVE 'N'   TO ASC-DC-SPLIT-IND             10150002
101600                       MOVE VNDAGR-EXT-PAY-DAYS-QTY               10160002
101700                                  TO ASC-DC-SPLIT-DAYS            10170002
101800                   END-IF                                         10180002
101900             END-EVALUATE                                         10190002
102000          WHEN 'TINCTYP'                                          10200002
102100             EVALUATE SERTYP-SERVICE-ID                           10210002
102200                WHEN 1                                            10220002
102300                   MOVE 'Y'       TO ASC-NEW-STORE-DISC-IND       10230002
102400                   IF  DN-DISCOUNT-PCT = -1                       10240002
102500                       MOVE ZERO  TO ASC-NEW-STORE-DISC           10250002
102600                   ELSE                                           10260002
102700                       COMPUTE ASC-NEW-STORE-DISC =               10270002
102800                               VNDAGR-DISCOUNT-PCT * 100          10280002
102900                   END-IF                                         10290002
103000                   IF  DN-EXT-PAY-DAYS-QTY = -1                   10300002
103100                       MOVE ZERO  TO ASC-NEW-STORE-DAYS           10310002
103200                   ELSE                                           10320002
103300                       MOVE VNDAGR-EXT-PAY-DAYS-QTY               10330002
103400                                  TO ASC-NEW-STORE-DAYS           10340002
103500                   END-IF                                         10350002
103600                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             10360002
103700                   MOVE PV-EFF-DATE                               10370002
103800                                  TO ASC-NEW-STORE-EFFDATE        10380002
103900                WHEN 7                                            10390002
104000                   MOVE 'Y'       TO ASC-MOS-DISC-IND             10400002
104100                   IF  DN-DISCOUNT-PCT = -1                       10410002
104200                       MOVE ZERO  TO ASC-MOS-DISC                 10420002
104300                   ELSE                                           10430002
104400                       COMPUTE ASC-MOS-DISC =                     10440002
104500                               VNDAGR-DISCOUNT-PCT * 100          10450002
104600                   END-IF                                         10460002
104700                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             10470002
104800                   MOVE PV-EFF-DATE                               10480002
104900                                  TO ASC-MOS-DISC-EFFDATE         10490002
105000                WHEN 8                                            10500002
105100                   MOVE 'Y'       TO ASC-TRADE-DISC-IND           10510002
105200                   IF  DN-DISCOUNT-PCT = -1                       10520002
105300                       MOVE ZERO  TO ASC-TRADE-DISC               10530002
105400                   ELSE                                           10540002
105500                       COMPUTE ASC-TRADE-DISC =                   10550002
105600                               VNDAGR-DISCOUNT-PCT * 100          10560002
105700                   END-IF                                         10570002
105800                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             10580002
105900                   MOVE PV-EFF-DATE                               10590002
106000                                  TO ASC-TRADE-DISC-EFFDATE       10600002
106100                WHEN 9                                            10610002
106200                   MOVE 'Y'       TO ASC-ADVTS-DISC-IND           10620002
106300                   IF  DN-DISCOUNT-PCT = -1                       10630002
106400                       MOVE ZERO  TO ASC-ADVTS-DISC               10640002
106500                   ELSE                                           10650002
106600                       COMPUTE ASC-ADVTS-DISC =                   10660002
106700                               VNDAGR-DISCOUNT-PCT * 100          10670002
106800                   END-IF                                         10680002
106900                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             10690002
107000                   MOVE PV-EFF-DATE                               10700002
107100                                  TO ASC-ADVTS-DISC-EFFDATE       10710002
107200                WHEN 10                                           10720002
107300                   MOVE 'Y'       TO ASC-COOP-ALW-IND             10730002
107400                   IF  DN-DISCOUNT-PCT = -1                       10740002
107500                       MOVE ZERO  TO ASC-COOP-ALW                 10750002
107600                   ELSE                                           10760002
107700                       COMPUTE ASC-COOP-ALW =                     10770002
107800                               VNDAGR-DISCOUNT-PCT * 100          10780002
107900                   END-IF                                         10790002
108000                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             10800002
108100                   MOVE PV-EFF-DATE                               10810002
108200                                  TO ASC-COOP-ALW-EFFDATE         10820002
108300                WHEN 11                                           10830002
108400                   MOVE 'Y'       TO ASC-PROFIT-ALW-IND           10840002
108500                   IF  DN-DISCOUNT-PCT = -1                       10850002
108600                       MOVE ZERO  TO ASC-PROFIT-ALW               10860002
108700                   ELSE                                           10870002
108800                       COMPUTE ASC-PROFIT-ALW =                   10880002
108900                               VNDAGR-DISCOUNT-PCT * 100          10890002
109000                   END-IF                                         10900002
109100                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             10910002
109200                   MOVE PV-EFF-DATE                               10920002
109300                                  TO ASC-PROFIT-ALW-EFFDATE       10930002
109400                WHEN 12                                           10940002
109500                   MOVE 'Y'       TO ASC-TBL-TWR-IND              10950002
109600                   IF  DN-EXT-PAY-DAYS-QTY = -1                   10960002
109700                       MOVE ZERO  TO ASC-TBL-TWR-DAYS             10970002
109800                   ELSE                                           10980002
109900                       MOVE VNDAGR-EXT-PAY-DAYS-QTY               10990002
110000                                  TO ASC-TBL-TWR-DAYS             11000002
110100                   END-IF                                         11010002
110200                   PERFORM 4005-FORMAT-EFFECTIVE-DATE             11020002
110300                   MOVE PV-EFF-DATE                               11030002
110400                                  TO ASC-TBL-TWR-EFFDATE          11040002
110500             END-EVALUATE                                         11050002
110600         END-EVALUATE                                             11060002
110700         PERFORM 4050-FETCH-SERVICE-CSR                           11070002
110800     END-PERFORM.                                                 11080002
110900                                                                  11090002
111000     PERFORM 4060-CLOSE-SERVICE-CSR.                              11100002
111100                                                                  11110002
111200     IF  PS-NO-ERROR                                              11120002
111300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     11130002
111400     END-IF.                                                      11140002
111500                                                                  11150002
111600 4000-EXIT. EXIT.                                                 11160002
111700                                                                  11170002
111800/                                                                 11180002
111900*----------------------------------------------------------------*11190002
112000*    FORMAT THE EFFECTIVE DATE FROM TVNDAGR FOR SCREEN DISPLAY   *11200002
112100*----------------------------------------------------------------*11210002
112200 4005-FORMAT-EFFECTIVE-DATE.                                      11220002
112300                                                                  11230002
112400     MOVE VNDAGR-EFFECTIVE-DATE TO PV-EFFECTIVE-DATE.             11240002
112500     MOVE PV-EFFECTIVE-MM       TO PV-EFF-MM.                     11250002
112600     MOVE PV-EFFECTIVE-DD       TO PV-EFF-DD.                     11260002
112700     MOVE PV-EFFECTIVE-CCYY     TO PV-EFF-CCYY.                   11270002
112800     MOVE '/'                   TO PV-EFF-SLASH1                  11280002
112900                                   PV-EFF-SLASH2.                 11290002
113000                                                                  11300002
113100/                                                                 11310002
113200*----------------------------------------------------------------*11320002
113300*    GET THE VENDOR NAME AND DUNS NUMBER                         *11330002
113400*----------------------------------------------------------------*11340002
113500 4010-GET-HEADING-INFO.                                           11350002
113600                                                                  11360002
113700     PERFORM                                                      11370002
113800         WITH TEST AFTER                                          11380002
113900         VARYING PV-RETRY-COUNTER                                 11390002
114000         FROM 1 BY 1                                              11400002
114100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11410002
114200             OR (SQLCODE = +0)                                    11420002
114300             OR (SQLCODE = +100))                                 11430002
114400                                                                  11440002
114500         EXEC SQL                                                 11450002
114600              SELECT A.INHOUSE_NBR                                11460002
114700                    ,B.ENT_NAME_DESC                              11470002
114800                    ,C.DUN_NBR                                    11480002
114900                INTO :VNDDPT-INHOUSE-NBR                          11490002
115000                    ,:ENTNME-ENT-NAME-DESC                        11500002
115100                    ,:EXTENT-DUN-NBR                              11510002
115200                FROM TVNDDPT A                                    11520002
115300                    ,TENTNME B                                    11530002
115400                    ,TEXTENT C                                    11540002
115500               WHERE A.DEPT_NBR = :DK-DEPT-NBR                    11550002
115600                 AND A.ENT_ID   = :DK-ENT-ID                      11560002
115700                 AND B.SEQ_NBR  =                                 11570002
115800                     (SELECT MAX(SEQ_NBR)                         11580002
115900                        FROM TENTNME                              11590002
116000                       WHERE ENT_ID   = :DK-ENT-ID                11600002
116100                         AND TYPE_CDE = '01')                     11610002
116200                 AND B.TYPE_CDE = '01'                            11620002
116300                 AND A.ENT_ID   = B.ENT_ID                        11630002
116400                 AND A.ENT_ID   = C.ENT_ID                        11640002
116500         END-EXEC                                                 11650002
116600                                                                  11660002
116700         EVALUATE TRUE                                            11670002
116800             WHEN SQLCODE = +0                                    11680002
116900                  MOVE VNDDPT-INHOUSE-NBR                         11690002
117000                                  TO ASC-INHOUSE-NBR              11700002
117100                  MOVE ENTNME-ENT-NAME-DESC                       11710002
117200                                  TO ASC-ENT-NAME-DESC            11720002
117300                  MOVE EXTENT-DUN-NBR                             11730002
117400                                  TO ASC-DUN-NBR                  11740002
117500             WHEN SQLCODE = +100                                  11750002
117600                  MOVE PC-TSYMSG-00148                            11760002
117700                                  TO DP020-MSG-NUMBER             11770002
117800                  SET PS-ERROR                                    11780002
117900                      DP020-MSG-FATAL                             11790002
118000                      DP020-NEXT-ACT-APPL-ERROR                   11800002
118100                                  TO TRUE                         11810002
118200             WHEN SQLCODE = -904                                  11820002
118300             WHEN SQLCODE = -913                                  11830002
118400                  CONTINUE                                        11840002
118500                                                                  11850002
118600             WHEN SQLWARN0 NOT = SPACES                           11860002
118700             WHEN SQLCODE < +0                                    11870002
118800             WHEN SQLCODE > +0                                    11880002
118900                  MOVE '4010-GET-HEADER-INFO'                     11890002
119000                                  TO DP013-PARAGRAPH              11900002
119100                  MOVE 'UNSUCCESSFUL SELECT ENTERPRISE NAME'      11910002
119200                                  TO DP013-MESSAGE-TEXT (1)       11920002
119300                  MOVE SQLCA      TO DP013-SQLCA                  11930002
119400                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)     11940002
119500                  SET DP013-DB2-ABEND                             11950002
119600                      DP013-XCTL-DISPLAY-RESTART                  11960002
119700                                  TO TRUE                         11970002
119800                  PERFORM DP013-0000-PROCESS-ABEND                11980002
119900         END-EVALUATE                                             11990002
120000     END-PERFORM.                                                 12000002
120100                                                                  12010002
120200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12020002
120300         MOVE '4010-GET-HEADER-ID'                                12030002
120400                                  TO DP013-PARAGRAPH              12040002
120500         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    12050002
120600                                  TO DP013-MESSAGE-TEXT (1)       12060002
120700         MOVE SQLCA               TO DP013-SQLCA                  12070002
120800         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (1)     12080002
120900         SET DP013-DB2-ABEND                                      12090002
121000             DP013-XCTL-DISPLAY-RESTART                           12100002
121100                                  TO TRUE                         12110002
121200         PERFORM DP013-0000-PROCESS-ABEND                         12120002
121300     END-IF.                                                      12130002
121400                                                                  12140002
121500/                                                                 12150002
121600*----------------------------------------------------------------*12160002
121700*    GET PRE-TICKETING INFORMATION                               *12170002
121800*----------------------------------------------------------------*12180002
121900 4020-GET-PRE-TICKET-INFO.                                        12190002
122000                                                                  12200002
122100     PERFORM                                                      12210002
122200         WITH TEST AFTER                                          12220002
122300         VARYING PV-RETRY-COUNTER                                 12230002
122400         FROM 1 BY 1                                              12240002
122500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12250002
122600             OR (SQLCODE = +0)                                    12260002
122700             OR (SQLCODE = +100))                                 12270002
122800                                                                  12280002
122900         EXEC SQL                                                 12290002
123000              SELECT A.LEADTIME_DAYS_QTY                          12300002
123100                    ,A.TKT_MKR_IND                                12310002
123200                    ,A.BULK_STK_TKT_IND                           12320002
123300                    ,A.PARTIAL_IND                                12330002
123400                INTO :VNDAGR-LEADTIME-DAYS-QTY                    12340002
123500                        :DN-LEADTIME-DAYS-QTY                     12350002
123600                    ,:VNDAGR-TKT-MKR-IND                          12360002
123700                        :DN-TKT-MKR-IND                           12370002
123800                    ,:VNDAGR-BULK-STK-TKT-IND                     12380002
123900                        :DN-BULK-STK-TKT-IND                      12390002
124000                    ,:VNDAGR-PARTIAL-IND                          12400002
124100                        :DN-PARTIAL-IND                           12410002
124200                FROM TVNDAGR A                                    12420002
124300                    ,TSERTYP B                                    12430002
124400               WHERE A.AGRMT_TYP_ID      = '4'                    12440002
124500                 AND B.SERVICE_ID        = 1                      12450002
124600                 AND B.SERVICE_ID        = A.TYP_CDE              12460002
124700                 AND A.DEPT_NBR          = :DK-DEPT-NBR           12470002
124800                 AND A.ENT_ID            = :DK-ENT-ID             12480002
124900                 AND A.EFFECTIVE_DATE   <= CURRENT DATE           12490002
125000                 AND A.EXPIRATION_DATE  >  CURRENT DATE           12500002
125100         END-EXEC                                                 12510002
125200                                                                  12520002
125300         EVALUATE TRUE                                            12530002
125400             WHEN SQLCODE = +0                                    12540002
125500             WHEN SQLCODE = +100                                  12550002
125600             WHEN SQLCODE = -904                                  12560002
125700             WHEN SQLCODE = -913                                  12570002
125800                  CONTINUE                                        12580002
125900                                                                  12590002
126000             WHEN SQLWARN0 NOT = SPACES                           12600002
126100             WHEN SQLCODE < +0                                    12610002
126200             WHEN SQLCODE > +0                                    12620002
126300                  MOVE '4020-GET-PRE-TICKET-INFO'                 12630002
126400                                  TO DP013-PARAGRAPH              12640002
126500                  MOVE 'UNSUCCESSFUL GET ON PRE-TICKET INFO'      12650002
126600                                  TO DP013-MESSAGE-TEXT (1)       12660002
126700                  MOVE SQLCA      TO DP013-SQLCA                  12670002
126800                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     12680002
126900                  MOVE 'TSERTYP ' TO DP013-DB2-TABLE-NAME (2)     12690002
127000                  SET DP013-DB2-ABEND                             12700002
127100                      DP013-XCTL-DISPLAY-RESTART                  12710002
127200                                  TO TRUE                         12720002
127300                  PERFORM DP013-0000-PROCESS-ABEND                12730002
127400         END-EVALUATE                                             12740002
127500     END-PERFORM.                                                 12750002
127600                                                                  12760002
127700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12770002
127800         MOVE '4020-GET-PRE-TICKET-INFO'                          12780002
127900                                  TO DP013-PARAGRAPH              12790002
128000         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    12800002
128100                                  TO DP013-MESSAGE-TEXT (1)       12810002
128200         MOVE SQLCA               TO DP013-SQLCA                  12820002
128300         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     12830002
128400         MOVE 'TSERTYP '          TO DP013-DB2-TABLE-NAME (2)     12840002
128500         SET DP013-DB2-ABEND                                      12850002
128600             DP013-XCTL-DISPLAY-RESTART                           12860002
128700                                  TO TRUE                         12870002
128800         PERFORM DP013-0000-PROCESS-ABEND                         12880002
128900     END-IF.                                                      12890002
129000                                                                  12900002
129100/                                                                 12910002
129200*----------------------------------------------------------------*12920002
129300*    GET SUPRESS TICKETING INFORMATION                           *12930002
129400*----------------------------------------------------------------*12940002
129500 4030-GET-SUP-TICKET-INFO.                                        12950002
129600                                                                  12960002
129700     PERFORM                                                      12970002
129800         WITH TEST AFTER                                          12980002
129900         VARYING PV-RETRY-COUNTER                                 12990002
130000         FROM 1 BY 1                                              13000002
130100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13010002
130200             OR (SQLCODE = +0)                                    13020002
130300             OR (SQLCODE = +100))                                 13030002
130400                                                                  13040002
130500         EXEC SQL                                                 13050002
130600              SELECT A.LEADTIME_DAYS_QTY                          13060002
130700                    ,A.TKT_MKR_IND                                13070002
130800                    ,A.BULK_STK_TKT_IND                           13080002
130900                    ,A.PARTIAL_IND                                13090002
131000                INTO :VNDAGR-LEADTIME-DAYS-QTY                    13100002
131100                        :DN-LEADTIME-DAYS-QTY                     13110002
131200                    ,:VNDAGR-TKT-MKR-IND                          13120002
131300                        :DN-TKT-MKR-IND                           13130002
131400                    ,:VNDAGR-BULK-STK-TKT-IND                     13140002
131500                        :DN-BULK-STK-TKT-IND                      13150002
131600                    ,:VNDAGR-PARTIAL-IND                          13160002
131700                        :DN-PARTIAL-IND                           13170002
131800                FROM TVNDAGR A                                    13180002
131900                    ,TPGMTYP B                                    13190002
132000               WHERE A.AGRMT_TYP_ID      = '6'                    13200002
132100                 AND B.PROGRAM_ID        = 1                      13210002
132200                 AND B.PROGRAM_ID        = A.TYP_CDE              13220002
132300                 AND A.DEPT_NBR          = :DK-DEPT-NBR           13230002
132400                 AND A.ENT_ID            = :DK-ENT-ID             13240002
132500                 AND A.EFFECTIVE_DATE   <= CURRENT DATE           13250002
132600                 AND A.EXPIRATION_DATE  >  CURRENT DATE           13260002
132700         END-EXEC                                                 13270002
132800                                                                  13280002
132900         EVALUATE TRUE                                            13290002
133000             WHEN SQLCODE = +0                                    13300002
133100             WHEN SQLCODE = +100                                  13310002
133200             WHEN SQLCODE = -904                                  13320002
133300             WHEN SQLCODE = -913                                  13330002
133400                  CONTINUE                                        13340002
133500                                                                  13350002
133600             WHEN SQLWARN0 NOT = SPACES                           13360002
133700             WHEN SQLCODE < +0                                    13370002
133800             WHEN SQLCODE > +0                                    13380002
133900                  MOVE '4030-GET-SUP-TICKET-INFO'                 13390002
134000                                  TO DP013-PARAGRAPH              13400002
134100                  MOVE 'UNSUCCESSFUL GET ON PRE-TICKET INFO'      13410002
134200                                  TO DP013-MESSAGE-TEXT (1)       13420002
134300                  MOVE SQLCA      TO DP013-SQLCA                  13430002
134400                  MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)     13440002
134500                  MOVE 'TPGMTYP ' TO DP013-DB2-TABLE-NAME (2)     13450002
134600                  SET DP013-DB2-ABEND                             13460002
134700                      DP013-XCTL-DISPLAY-RESTART                  13470002
134800                                  TO TRUE                         13480002
134900                  PERFORM DP013-0000-PROCESS-ABEND                13490002
135000         END-EVALUATE                                             13500002
135100     END-PERFORM.                                                 13510002
135200                                                                  13520002
135300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13530002
135400         MOVE '4030-GET-SUP-TICKET-INFO'                          13540002
135500                                  TO DP013-PARAGRAPH              13550002
135600         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    13560002
135700                                  TO DP013-MESSAGE-TEXT (1)       13570002
135800         MOVE SQLCA               TO DP013-SQLCA                  13580002
135900         MOVE 'TVNDAGR '          TO DP013-DB2-TABLE-NAME (1)     13590002
136000         MOVE 'TPGMTYP '          TO DP013-DB2-TABLE-NAME (2)     13600002
136100         SET DP013-DB2-ABEND                                      13610002
136200             DP013-XCTL-DISPLAY-RESTART                           13620002
136300                                  TO TRUE                         13630002
136400         PERFORM DP013-0000-PROCESS-ABEND                         13640002
136500     END-IF.                                                      13650002
136600                                                                  13660002
136700/                                                                 13670002
136800*----------------------------------------------------------------*13680002
136900* OPEN THE SERVICE CURSOR                                        *13690002
137000*----------------------------------------------------------------*13700002
137100                                                                  13710002
137200 4040-OPEN-SERVICE-CSR.                                           13720002
137300                                                                  13730002
137400     PERFORM                                                      13740002
137500         WITH TEST AFTER                                          13750002
137600         VARYING PV-RETRY-COUNTER                                 13760002
137700         FROM 1 BY 1                                              13770002
137800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13780002
137900            OR (SQLCODE = +0))                                    13790002
138000                                                                  13800002
138100         EXEC SQL                                                 13810002
138200             OPEN SERVICE-CSR                                     13820002
138300         END-EXEC                                                 13830002
138400                                                                  13840002
138500         EVALUATE TRUE                                            13850002
138600             WHEN SQLCODE = +0                                    13860002
138700                  CONTINUE                                        13870002
138800             WHEN SQLCODE = -904                                  13880002
138900             WHEN SQLCODE = -913                                  13890002
139000                  CONTINUE                                        13900002
139100             WHEN SQLWARN0 NOT = SPACE                            13910002
139200             WHEN SQLCODE  NOT = +0                               13920002
139300                  MOVE '4040-OPEN-SERVICE-CSR'                    13930002
139400                                   TO DP013-PARAGRAPH             13940002
139500                  MOVE 'OPEN SERVICE-CSR CURSOR'                  13950002
139600                                   TO DP013-MESSAGE-TEXT (1)      13960002
139700                  MOVE SQLCA       TO DP013-SQLCA                 13970002
139800                  MOVE 'TVNDAGR'   TO DP013-DB2-TABLE-NAME (1)    13980002
139900                  MOVE 'TSERTYP'   TO DP013-DB2-TABLE-NAME (2)    13990002
140000                  MOVE 'TPGMTYP'   TO DP013-DB2-TABLE-NAME (3)    14000002
140100                  MOVE 'TINCTYP'   TO DP013-DB2-TABLE-NAME (4)    14010002
140200                  SET DP013-DB2-ABEND                             14020002
140300                                   TO TRUE                        14030002
140400                  PERFORM DP013-0000-PROCESS-ABEND                14040002
140500         END-EVALUATE                                             14050002
140600     END-PERFORM.                                                 14060002
140700                                                                  14070002
140800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14080002
140900         MOVE '4040-OPEN-SERVICE-CSR'                             14090002
141000                                   TO DP013-PARAGRAPH             14100002
141100         MOVE 'MAX RETRIES EXCEEDED FOR OPEN SERVICE CURSOR'      14110002
141200                                   TO DP013-MESSAGE-TEXT (1)      14120002
141300         MOVE SQLCA                TO DP013-SQLCA                 14130002
141400         SET DP013-DB2-ABEND       TO TRUE                        14140002
141500         PERFORM DP013-0000-PROCESS-ABEND                         14150002
141600     END-IF.                                                      14160002
141700                                                                  14170002
141800/                                                                 14180002
141900*----------------------------------------------------------------*14190002
142000*    FETCH A SERVICE CURSOR ROW                                  *14200002
142100*----------------------------------------------------------------*14210002
142200                                                                  14220002
142300 4050-FETCH-SERVICE-CSR.                                          14230002
142400                                                                  14240002
142500     EXEC SQL                                                     14250002
142600          FETCH  SERVICE-CSR                                      14260002
142700           INTO :PV-TABLE-NAME                                    14270002
142800               ,:SERTYP-SERVICE-ID                                14280002
142900               ,:VNDAGR-DISCOUNT-PCT                              14290002
143000                  :DN-DISCOUNT-PCT                                14300002
143100               ,:VNDAGR-EXT-PAY-DAYS-QTY                          14310002
143200                  :DN-EXT-PAY-DAYS-QTY                            14320002
143300               ,:VNDAGR-EFFECTIVE-DATE                            14330002
143400               ,:VNDAGR-CHRG-PCT                                  14340002
143500                  :DN-CHRG-PCT                                    14350002
143600               ,:VNDAGR-CHRG-AMT                                  14360002
143700                  :DN-CHRG-AMT                                    14370002
143800     END-EXEC.                                                    14380002
143900                                                                  14390002
144000     EVALUATE TRUE                                                14400002
144100         WHEN SQLCODE = +0                                        14410002
144200              CONTINUE                                            14420002
144300         WHEN SQLCODE = +100                                      14430002
144400              SET PS-EOF-SERVICE-CSR                              14440002
144500                                   TO TRUE                        14450002
144600         WHEN SQLWARN0 NOT = SPACE                                14460002
144700         WHEN SQLCODE < +0                                        14470002
144800         WHEN SQLCODE > +0                                        14480002
144900              MOVE '4050-FETCH-SERVICE-CSR'                       14490002
145000                                   TO DP013-PARAGRAPH             14500002
145100              MOVE 'FETCH SERVICE CURSOR'                         14510002
145200                                   TO DP013-MESSAGE-TEXT (1)      14520002
145300              MOVE SQLCA           TO DP013-SQLCA                 14530002
145400              MOVE 'TVNDAGR'       TO DP013-DB2-TABLE-NAME (1)    14540002
145500              MOVE 'TSERTYP'       TO DP013-DB2-TABLE-NAME (2)    14550002
145600              MOVE 'TPGMTYP'       TO DP013-DB2-TABLE-NAME (3)    14560002
145700              MOVE 'TINCTYP'       TO DP013-DB2-TABLE-NAME (4)    14570002
145800              SET DP013-DB2-ABEND  TO TRUE                        14580002
145900              PERFORM DP013-0000-PROCESS-ABEND                    14590002
146000     END-EVALUATE.                                                14600002
146100                                                                  14610002
146200/                                                                 14620002
146300*----------------------------------------------------------------*14630002
146400* CLOSE THE SERVICE CURSOR                                       *14640002
146500*----------------------------------------------------------------*14650002
146600                                                                  14660002
146700 4060-CLOSE-SERVICE-CSR.                                          14670002
146800                                                                  14680002
146900     EXEC SQL                                                     14690002
147000         CLOSE SERVICE-CSR                                        14700002
147100     END-EXEC.                                                    14710002
147200                                                                  14720002
147300     EVALUATE TRUE                                                14730002
147400         WHEN SQLCODE = +0                                        14740002
147500              CONTINUE                                            14750002
147600         WHEN SQLWARN0 NOT = SPACE                                14760002
147700         WHEN SQLCODE  NOT = +0                                   14770002
147800              MOVE '4060-CLOSE-SERVICE-CSR'                       14780002
147900                                   TO DP013-PARAGRAPH             14790002
148000              MOVE 'CLOSE SERCIVE-CSR CURSOR'                     14800002
148100                                   TO DP013-MESSAGE-TEXT (1)      14810002
148200              MOVE SQLCA           TO DP013-SQLCA                 14820002
148300              MOVE 'TVNDAGR'       TO DP013-DB2-TABLE-NAME (1)    14830002
148400              MOVE 'TSERTYP'       TO DP013-DB2-TABLE-NAME (2)    14840002
148500              MOVE 'TPGMTYP'       TO DP013-DB2-TABLE-NAME (3)    14850002
148600              MOVE 'TINCTYP'       TO DP013-DB2-TABLE-NAME (4)    14860002
148700              SET DP013-DB2-ABEND  TO TRUE                        14870002
148800              PERFORM DP013-0000-PROCESS-ABEND                    14880002
148900     END-EVALUATE.                                                14890002
149000                                                                  14900002
149100/                                                                 14910002
149200*----------------------------------------------------------------*14920002
149300*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *14930002
149400*----------------------------------------------------------------*14940002
149500 4400-MOVE-COMMAREA-TO-SCREEN.                                    14950002
149600                                                                  14960002
149700     MOVE ASC-KEY-DEPT-NBR         TO ADPTNBRO.                   14970002
149800     MOVE ASC-ENT-NAME-DESC        TO AVNNAMEO.                   14980002
149900     MOVE ASC-INHOUSE-NBR          TO AINHSO.                     14990002
150000     MOVE ASC-DUN-NBR              TO ADUNNBRO.                   15000002
150100                                                                  15010002
150200     MOVE ASC-PRE-TICK-IND         TO ATKIND1O.                   15020002
150300     MOVE ASC-PRE-TICK-LEAD-TIME   TO ALDTME1O.                   15030002
150400     MOVE ASC-PRE-TICK-MAKER       TO ATKMKR1O.                   15040002
150500     MOVE ASC-PRE-TICK-BULK        TO ABKTKT1O.                   15050002
150600                                                                  15060002
150700     MOVE ASC-PACK-BY-STORE-Y-N    TO APKSTORO.                   15070002
150800     MOVE ASC-HANGER-INSERT-Y-N    TO AHNGIS1O.                   15080002
150900     MOVE ASC-DC-SPLIT-IND         TO ADCSINDO.                   15090002
151000     MOVE ASC-DC-SPLIT-DAYS        TO ADCSDAYO.                   15100002
151100     MOVE ASC-SUPPLIES-UPC-Y-N     TO ASUPUCPO.                   15110002
151200     MOVE ASC-DIRECT-SHIP-Y-N      TO ADIRSHPO.                   15120002
151300     MOVE ASC-DIRECT-SHIP-RATE     TO ADIRRTEO.                   15130002
151400     MOVE ASC-DIRECT-SHIP-PCT      TO ADIRPCTO.                   15140002
151500                                                                  15150002
151600     MOVE ASC-SUP-TICK-IND         TO ATKIND2O.                   15160002
151700     MOVE ASC-SUP-TICK-LEAD-TIME   TO ALDTME2O.                   15170002
151800     MOVE ASC-SUP-TICK-MAKER       TO ATKMKR2O.                   15180002
151900     MOVE ASC-SUP-TICK-BULK        TO ABKTKT2O.                   15190002
152000                                                                  15200002
152100     MOVE ASC-NEW-STORE-DISC-IND   TO ANEWSTRO.                   15210002
152200     MOVE ASC-NEW-STORE-DISC       TO ANEWPCTO.                   15220002
152300     MOVE ASC-NEW-STORE-DAYS       TO ANEWDAYO.                   15230002
152400     MOVE ASC-NEW-STORE-EFFDATE    TO ANEWEFFO.                   15240002
152500     MOVE ASC-MOS-DISC-IND         TO AMOSDISO.                   15250002
152600     MOVE ASC-MOS-DISC             TO AMOSPCTO.                   15260002
152700     MOVE ASC-MOS-DISC-EFFDATE     TO AMOSEFFO.                   15270002
152800     MOVE ASC-TRADE-DISC-IND       TO ATRDDISO.                   15280002
152900     MOVE ASC-TRADE-DISC           TO ATRDPCTO.                   15290002
153000     MOVE ASC-TRADE-DISC-EFFDATE   TO ATRDEFFO.                   15300002
153100     MOVE ASC-ADVTS-DISC-IND       TO AADVDISO.                   15310002
153200     MOVE ASC-ADVTS-DISC           TO AADVPCTO.                   15320002
153300     MOVE ASC-ADVTS-DISC-EFFDATE   TO AADVEFFO.                   15330002
153400     MOVE ASC-COOP-ALW-IND         TO ACOPALWO.                   15340002
153500     MOVE ASC-COOP-ALW             TO ACOPPCTO.                   15350002
153600     MOVE ASC-COOP-ALW-EFFDATE     TO ACOPEFFO.                   15360002
153700     MOVE ASC-PROFIT-ALW-IND       TO APFTALWO.                   15370002
153800     MOVE ASC-PROFIT-ALW           TO APFTPCTO.                   15380002
153900     MOVE ASC-PROFIT-ALW-EFFDATE   TO APFTEFFO.                   15390002
154000     MOVE ASC-TBL-TWR-IND          TO ATBLINDO.                   15400002
154100     MOVE ASC-TBL-TWR-DAYS         TO ATBLDAYO.                   15410002
154200     MOVE ASC-TBL-TWR-EFFDATE      TO ATBLEFFO.                   15420002
154210     MOVE ASC-RFID-STATUS-N-T-C    TO RFDCOMPO.                   15421011
154300                                                                  15430002
154400/                                                                 15440002
154500*----------------------------------------------------------------*15450002
154600*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *15460002
154700*----------------------------------------------------------------*15470002
154800                                                                  15480002
154900 9100-READ-SEL-QUEUE.                                             15490002
155000     EXEC CICS                                                    15500002
155100         READQ TS                                                 15510002
155200             QUEUE (ASC-SEL-QUEUE-NAME)                           15520002
155300             INTO  (VN003-VENDOR-SEL-REC)                         15530002
155400             ITEM  (ASC-SEL-ITEM)                                 15540002
155500             RESP  (PV-CICS-RESPONSE)                             15550002
155600     END-EXEC.                                                    15560002
155700                                                                  15570002
155800     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   15580002
155900         CONTINUE                                                 15590002
156000     ELSE                                                         15600002
156100         SET DP013-LOGIC-ABEND                                    15610002
156200             DP013-NO-ROLLBACK     TO TRUE                        15620002
156300         MOVE '9100-READ-SEL-QUEUE'                               15630002
156400                                   TO DP013-PARAGRAPH             15640002
156500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   15650002
156600                                   TO DP013-MESSAGE-TEXT (1)      15660002
156700         PERFORM DP013-0000-PROCESS-ABEND                         15670002
156800     END-IF.                                                      15680002
156900                                                                  15690002
157000/                                                                 15700002
157100*----------------------------------------------------------------*15710002
157200*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *15720002
157300*----------------------------------------------------------------*15730002
157400 9200-REWRITE-LIST-QUEUE.                                         15740002
157500     EXEC CICS                                                    15750002
157600          WRITEQ TS                                               15760002
157700              QUEUE  (ASC-SEL-QUEUE-NAME)                         15770002
157800              FROM   (VN003-VENDOR-SEL-REC)                       15780002
157900              ITEM   (ASC-SEL-ITEM)                               15790002
158000              RESP   (PV-CICS-RESPONSE)                           15800002
158100              REWRITE                                             15810002
158200     END-EXEC.                                                    15820002
158300                                                                  15830002
158400     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               15840002
158500         SET DP013-CICS-ABEND                                     15850002
158600             DP013-NO-ROLLBACK     TO TRUE                        15860002
158700         MOVE '9200-REWRITE-LIST-QUEUE'                           15870002
158800                                   TO DP013-PARAGRAPH             15880002
158900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   15890002
159000                                   TO DP013-MESSAGE-TEXT (1)      15900002
159100         PERFORM DP013-0000-PROCESS-ABEND                         15910002
159200     END-IF.                                                      15920002
159300                                                                  15930002
159400/                                                                 15940002
159500*----------------------------------------------------------------*15950002
159600*    ABEND PROCESSOR MODULE                                      *15960002
159700*----------------------------------------------------------------*15970002
159800                                                                  15980002
159900     COPY DPPD013.                                                15990002
