000100*-----------------------*                                         00010059
000200 IDENTIFICATION DIVISION.                                         00020059
000300*-----------------------*                                         00030059
000400 PROGRAM-ID.    RCKCS286.                                         00040059
000500 AUTHOR.        MARY SARDINA.                                     00050059
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060059
000700 DATE-WRITTEN.  07-31-96.                                         00070059
000800 DATE-COMPILED.                                                   00080059
000900*----------------------------------------------------------------*00090059
001000*    E286 - PRETICKET FORMAT SELECTION                            00100059
001100*                                                                *00110059
001200*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00120059
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00130059
001400*    DETAIL SCREEN.  THE MESSAGE NUMBER, IF ENTERED, IS EDITTED  *00140059
001500*    TO BE A VALID NUMERIC.  ALL OTHER EDITS ARE DONE IN THE     *00150059
001600*    DESTINATION PROGRAMS WHEN THE 'GO-TO' TYPE FUNCTION IS USED *00160059
001700*    (LOCAL-FUNC-01 THRU LOCAL-FUNC-12, WITH DISPOSITION 'G').   *00170059
001800*----------------------------------------------------------------*00180059
001900                                                                  00190059
002000 ENVIRONMENT DIVISION.                                            00200059
002100                                                                  00210059
002200 DATA DIVISION.                                                   00220059
002300                                                                  00230059
002400 WORKING-STORAGE SECTION.                                         00240059
002500*                                                                 00250059
002600 01  PC-PROGRAM-CONSTANTS.                                        00260059
002700     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'RC286A  '. 00270059
002800     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'RCKM286 '. 00280059
002900     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'RCKCS286'. 00290059
003000     05  PC-CALENDAR-PGM           PIC  X(08)  VALUE  'DPKUT500'. 00300059
003100     05  PC-STATUS-CODES.                                         00310059
003200         10  PC-ACTIVE             PIC  X(01)  VALUE  'A'.        00320059
003300         10  PC-CANCELED           PIC  X(01)  VALUE  'C'.        00330059
003400         10  PC-HOLD               PIC  X(01)  VALUE  'H'.        00340059
003500         10  PC-INPROCESS          PIC  X(01)  VALUE  'I'.        00350059
003600         10  PC-PRINTED            PIC  X(01)  VALUE  'P'.        00360059
003700         10  PC-RUSH               PIC  X(01)  VALUE  'R'.        00370059
003800         10  PC-SHIPPED            PIC  X(01)  VALUE  'S'.        00380059
003900     05  PC-STATUS-DESC.                                          00390059
004000         10  PC-ACTIVE-DESC        PIC  X(06)  VALUE 'ACTIVE'.    00400059
004100         10  PC-CANCELED-DESC      PIC  X(08)  VALUE 'CANCELED'.  00410059
004200         10  PC-INPROCESS-DESC     PIC  X(09)  VALUE 'INPROCESS'. 00420059
004300         10  PC-PRINTED-DESC       PIC  X(07)  VALUE 'PRINTED'.   00430059
004400         10  PC-RUSH-DESC          PIC  X(04)  VALUE 'RUSH'.      00440059
004500         10  PC-HOLD-DESC          PIC  X(04)  VALUE 'HOLD'.      00450059
004600         10  PC-SHIPPED-DESC       PIC  X(07)  VALUE 'SHIPPED'.   00460059
004700     05  PC-REQ-TYPE-CODES.                                       00470059
004800         10  PC-PRETICKET-CDE      PIC  X(01)  VALUE  'P'.        00480059
004900         10  PC-LOCKSTOCK-CDE      PIC  X(01)  VALUE  'L'.        00490059
005000         10  PC-BOTH-CDE           PIC  X(01)  VALUE  'B'.        00500059
005100     05  PC-REQ-DESC.                                             00510059
005200         10  PC-PRETICKET          PIC  X(35)  VALUE              00520059
005300                        'PRETICKET REQUESTS                 '.    00530059
005400         10  PC-LOCKSTOCK          PIC  X(35)  VALUE              00540059
005500                        'LOCKER STOCK REQUESTS              '.    00550059
005600         10  PC-BOTH               PIC  X(35)  VALUE              00560059
005700                        'LOCKER STOCK AND PRETICKET REQUESTS'.    00570059
005800     05  PC-TSYMSG-NUMBERS.                                       00580059
005900         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00590059
006000         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00600059
006100         10  PC-TSYMSG-00095       PIC  9(05)  VALUE  00095.      00610059
006200         10  PC-TSYMSG-00224       PIC  9(05)  VALUE  00224.      00620059
006300         10  PC-TSYMSG-01339       PIC  9(05)  VALUE  01339.      00630059
006400     05  PC-THIRTY-DAYS            PIC  9(4)   VALUE  30.         00640059
006500*                                                                 00650059
006600 01  PS-PROGRAM-SWITCHES.                                         00660059
006700     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00670059
006800         88  PS-ERROR                          VALUE  'Y'.        00680059
006900         88  PS-NO-ERROR                       VALUE  'N'.        00690059
007000*                                                                 00700059
007100 01  PV-PROGRAM-VARIABLES.                                        00710059
007200     05  PV-DATE-USA.                                             00720059
007300         10 PV-MM                  PIC  X(02).                    00730059
007400         10 FILLER                 PIC  X(01) VALUE '/'.          00740059
007500         10 PV-DD                  PIC  X(02).                    00750059
007600         10 FILLER                 PIC  X(01) VALUE '/'.          00760059
007700         10 PV-CC                  PIC  X(02).                    00770059
007800         10 PV-YY                  PIC  X(02).                    00780059
007900     05  PV-DATE-ISO.                                             00790059
008000         10 PV-CC                  PIC  X(02).                    00800059
008100         10 PV-YY                  PIC  X(02).                    00810059
008200         10 FILLER                 PIC  X(01) VALUE '-'.          00820059
008300         10 PV-MM                  PIC  X(02).                    00830059
008400         10 FILLER                 PIC  X(01) VALUE '-'.          00840059
008500         10 PV-DD                  PIC  X(02).                    00850059
008600                                                                  00860059
008700 01  PM-PROGRAM-MESSAGES.                                         00870059
008800     05  PM-ABEND-INFO-A.                                         00880059
008900         10  FILLER                PIC X(15)   VALUE              00890059
009000                                   'DP020-SRC-AID: '.             00900059
009100         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00910059
009200         10  FILLER                PIC X(19)   VALUE              00920059
009300                                   '. DP020-FK-ACTION: '.         00930059
009400         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00940059
009500         10  FILLER                PIC X(22)   VALUE              00950059
009600                                   '. DP020-FK-DISPN-IND: '.      00960059
009700         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00970059
009800         10  FILLER                PIC X(01)   VALUE '.'.         00980059
009900         10  FILLER                PIC X(19)   VALUE SPACE.       00990059
010000                                                                  01000059
010100                                                                  01010059
010200*----------------------------------------------------------------*01020059
010300*    MAP LAYOUT                                                  *01030059
010400*----------------------------------------------------------------*01040059
010500                                                                  01050059
010600     COPY RCKM286.                                                01060059
010700     EJECT                                                        01070059
010800*----------------------------------------------------------------*01080059
010900*    ATTRIBUTE SETTINGS COPYBOOK.                                *01090059
011000*----------------------------------------------------------------*01100059
011100                                                                  01110059
011200     COPY DPWS015.                                                01120059
011300                                                                  01130059
011400*----------------------------------------------------------------*01140059
011500*    FUNCTION KEYS COPYBOOK                                      *01150059
011600*----------------------------------------------------------------*01160059
011700                                                                  01170059
011800     COPY DPWS016.                                                01180059
011900 EJECT                                                            01190059
012000                                                                  01200059
012100*----------------------------------------------------------------*01210059
012200*    CURRENT DATE/TIME COPYBOOK                                  *01220059
012300*----------------------------------------------------------------*01230059
012400                                                                  01240059
012500     COPY DPWS017.                                                01250059
012600                                                                  01260059
012700 EJECT                                                            01270059
012800******************************************************************01280059
012900** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01290059
013000** SUB-ROUTINE (DPKUT100).                                      **01300059
013100******************************************************************01310059
013200     COPY DPWS010I.                                               01320059
013300 EJECT                                                            01330059
013400******************************************************************01340059
013500** THE CALLING PARAMETER LIST (DPWS030DPWS930) FOR THE CICS     **01350061
013600** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01360059
013700******************************************************************01370059
013800     COPY DPWS030.                                                01380059
013810     COPY DPWS930.                                                01381061
013900******************************************************************01390059
014000** DATE VALIDATION CALLING PARAMETER LIST                       **01400059
014100******************************************************************01410059
014200     COPY DPWS500.                                                01420059
014300 EJECT                                                            01430059
014400***************************************************************** 01440059
014500*    STANDARD COMMAREA.                                           01450059
014600***************************************************************** 01460059
014700                                                                  01470059
014800     COPY DPWS020.                                                01480059
014900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01490059
015000                                                                  01500059
015100***************************************************************** 01510059
015200*    INTER-APPLICATION COMMAREA.                                  01520059
015300***************************************************************** 01530059
015400                                                                  01540059
015500         10  INTER-APPL-COMM-AREA PIC X(200).                     01550059
015600     COPY RCWS030.                                                01560059
015700***************************************************************** 01570059
015800*    SPECIFIC COMMMAREA FOR RCKCS286.                             01580059
015900***************************************************************** 01590059
016000         10  ASC-SPECIFIC-COMMAREA.                               01600059
016100             15  ASC-DATE-LIMIT              PIC X(10).           01610059
016200             15  ASC-REQUEST-TYPE            PIC  X(01).          01620059
016300             15  ASC-TYPE-DESC               PIC  X(35).          01630059
016400             15  ASC-REQUEST-STATUS          PIC  X(01).          01640059
016500             15  ASC-STATUS-DESC             PIC  X(35).          01650059
016600             15  ASC-DEFAULT-DATE-LIMIT      PIC  X(10).          01660059
016700     EJECT                                                        01670059
016800*----------------------------------------------------------------*01680059
016900*    ABEND PROCESSING COPYBOOK.                                  *01690059
017000*----------------------------------------------------------------*01700059
017100                                                                  01710059
017200     COPY DPWS013.                                                01720059
017300                                                                  01730059
017400                                                                  01740059
017500 EJECT                                                            01750059
017600 LINKAGE SECTION.                                                 01760059
017700                                                                  01770059
017800 01  DFHCOMMAREA.                                                 01780059
017900     05  FILLER                         OCCURS  1 TO 4072 TIMES   01790059
018000                                        DEPENDING ON EIBCALEN.    01800059
018100         10  FILLER                     PIC X.                    01810059
018200                                                                  01820059
018300                                                                  01830059
018400 PROCEDURE DIVISION.                                              01840059
018500***************************************************************** 01850059
018600** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01860059
018700** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01870059
018800** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01880059
018900**                                                             ** 01890059
019000** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01900059
019100** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01910059
019200***************************************************************** 01920059
019300 0000-MAIN-MODULE.                                                01930059
019400     INITIALIZE DP030-CICS-API-FIELDS.                            01940059
019500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01950059
019600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01960059
019700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01970059
019800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01980059
019900     MOVE LENGTH OF RC286AI        TO DP030-MAP-LENGTH (1).       01990059
020000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02000059
020100     PERFORM 0001-CALL-CICS-ARCH-API.                             02010059
020200*                                                                 02020059
020300     PERFORM 1000-CONTROL-PROCESSING                              02030059
020400*                                                                 02040059
020500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02050059
020600     PERFORM 0001-CALL-CICS-ARCH-API.                             02060059
020700                                                                  02070059
020800 0001-CALL-CICS-ARCH-API.                                         02080059
020910     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02091061
021000                                    DFHCOMMAREA                   02100061
021100                                    DP030-CICS-API-FIELDS         02110061
021200                                    DP020-STANDARD-COMMAREA       02120061
021300                                    RC286AI.                      02130061
021400*                                                                 02140059
021500     IF  DP030-RC-CALL-SUCCESSFUL                                 02150059
021600         CONTINUE                                                 02160059
021700     ELSE                                                         02170059
021800         SET DP013-NO-ROLLBACK                                    02180059
021900             DP013-XCTL-DISPLAY-RESTART                           02190059
022000             DP013-CICS-ABEND      TO TRUE                        02200059
022100         MOVE 'BEFORE 0000-MAIN-MODULE'                           02210059
022200                                   TO DP013-PARAGRAPH             02220059
022300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02230061
022400-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02240061
022500         MOVE DP030-RETURN-CODE                                   02250059
022600                                   TO DP013-MESSAGE-TEXT (3)      02260059
022700         PERFORM DP013-0000-PROCESS-ABEND                         02270059
022800     END-IF.                                                      02280059
022900 EJECT                                                            02290059
023000*----------------------------------------------------------------*02300059
023100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02310059
023200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02320059
023300*----------------------------------------------------------------*02330059
023400                                                                  02340059
023500 1000-CONTROL-PROCESSING.                                         02350059
023600                                                                  02360059
023700     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       02370059
023800                                                                  02380059
023900     EVALUATE TRUE                                                02390059
024000         WHEN DP020-NEXT-ACT-INITIAL                              02400059
024100             INITIALIZE ASC-SPECIFIC-COMMAREA                     02410059
024200             MOVE PC-BOTH-CDE TO ASC-REQUEST-TYPE                 02420059
024300             MOVE PC-ACTIVE TO ASC-REQUEST-STATUS                 02430059
024400             PERFORM 4000-BUILD-INITIAL-PANEL                     02440059
024500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02450059
024600                                                                  02460059
024700                                                                  02470059
024800         WHEN DP020-NEXT-ACT-READ-MAP                             02480059
024900             PERFORM 2000-FKEY-PROCESSING                         02490059
025000                                                                  02500059
025100         WHEN DP020-NEXT-ACT-RETURN                               02510059
025200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02520059
025300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02530059
025400                                                                  02540059
025500         WHEN OTHER                                               02550059
025600             SET DP013-LOGIC-ABEND                                02560059
025700                 DP013-NO-ROLLBACK TO TRUE                        02570059
025800             MOVE '1000-CONTROL-PROCESSING'                       02580059
025900                                   TO  DP013-PARAGRAPH            02590059
026000             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02600059
026100                                   TO  DP013-MESSAGE-TEXT(1)      02610059
026200             MOVE DP020-NEXT-APPL-ACTIVITY                        02620059
026300                                   TO DP013-MESSAGE-TEXT(2)       02630059
026400             PERFORM DP013-0000-PROCESS-ABEND                     02640059
026500     END-EVALUATE.                                                02650059
026600                                                                  02660059
026700*----------------------------------------------------------------*02670059
026800* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02680059
026900* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02690059
027000* EDITS.                                                         *02700059
027100*----------------------------------------------------------------*02710059
027200                                                                  02720059
027300 2000-FKEY-PROCESSING.                                            02730059
027400                                                                  02740059
027500     EVALUATE TRUE                                                02750059
027600                                                                  02760059
027700         WHEN DP020-SRC-AID = DP016-CLEAR                         02770059
027800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02780059
027900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02790059
028000                                                                  02800059
028100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02810059
028200             INITIALIZE ASC-SPECIFIC-COMMAREA                     02820059
028300             PERFORM 4000-BUILD-INITIAL-PANEL                     02830059
028400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02840059
028500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02850059
028600             PERFORM 3200-RESET-ATTRIBUTES                        02860059
028700                                                                  02870059
028800         WHEN OTHER                                               02880059
028900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02890059
029000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02900059
029100             IF  PS-NO-ERROR                                      02910059
029200                 SET DP030-CONTINUE-GO TO TRUE                    02920059
029300                 PERFORM 2100-CHECK-FUNCTION-KEY                  02930059
029400             ELSE                                                 02940059
029500                 SET DP030-OVERRIDE-GO TO TRUE                    02950059
029600             END-IF                                               02960059
029700     END-EVALUATE.                                                02970059
029800******************************************************************02980059
029900** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **02990059
030000** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03000059
030100** FROM THE CICS ARCHITECTURE API.                              **03010059
030200******************************************************************03020059
030300 2100-CHECK-FUNCTION-KEY.                                         03030059
030400     EVALUATE TRUE                                                03040059
030500*        WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 03050059
030600         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   03060059
030700             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03070059
030800                                                                  03080059
030900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03090059
031000             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03100059
031100                                                                  03110059
031200         WHEN DP020-SRC-AID = DP016-ENTER                         03120059
031300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03130059
031400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03140059
031500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03150059
031600                                                                  03160059
031700         WHEN OTHER                                               03170059
031800             SET DP013-NO-ROLLBACK                                03180059
031900                 DP013-XCTL-DISPLAY-RESTART                       03190059
032000                 DP013-CICS-ABEND  TO TRUE                        03200059
032100             MOVE '2100-CHECK-FUNCTION-KEY'                       03210059
032200                                   TO DP013-PARAGRAPH             03220059
032300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03230059
032400                                   TO DP013-MESSAGE-TEXT (1)      03240059
032500             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 03250059
032600                                   TO DP013-MESSAGE-TEXT (2)      03260059
032700             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                03270059
032800             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 03280059
032900                                   TO PM-A-FK-ACTION              03290059
033000             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              03300059
033100                                   TO PM-A-FK-DISPN               03310059
033200             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      03320059
033300             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        03330059
033400                                   TO DP013-MESSAGE-TEXT (4)      03340059
033500             PERFORM DP013-0000-PROCESS-ABEND                     03350059
033600     END-EVALUATE.                                                03360059
033700******************************************************************03370059
033800** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03380059
033900** INTER-APPLICATION COMMAREA.                                  **03390059
034000******************************************************************03400059
034100 2110-PREPARE-INTER-APPL-COMM.                                    03410059
034200     INITIALIZE RC030-INTER-APPL-COMMAREA.                        03420059
034300     MOVE ASC-DATE-LIMIT           TO RC030-DATE-LIMIT.           03430059
034400     MOVE ASC-REQUEST-TYPE         TO RC030-PRETKT-REQ-TYPE.      03440059
034500     MOVE ASC-REQUEST-STATUS       TO RC030-PRETKT-REQ-STAT.      03450059
034600 EJECT                                                            03460059
034700*----------------------------------------------------------------*03470059
034800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03480059
034900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03490059
035000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03500059
035100*----------------------------------------------------------------*03510059
035200                                                                  03520059
035300 2200-MOVE-SCREEN-TO-COMMAREA.                                    03530059
035400     IF  ADTELMTL > ZERO                                          03540059
035500         IF ADTELMTI = SPACES                                     03550059
035600             MOVE ASC-DEFAULT-DATE-LIMIT                          03560059
035700                                   TO ASC-DATE-LIMIT              03570059
035800         ELSE                                                     03580059
035900             MOVE ADTELMTI         TO PV-DATE-USA                 03590059
036000             MOVE CORR PV-DATE-USA TO PV-DATE-ISO                 03600059
036100             MOVE PV-DATE-ISO      TO ASC-DATE-LIMIT              03610059
036200         END-IF                                                   03620059
036300     ELSE                                                         03630059
036400         IF  ADTELMTF = DP015-ERASE-EOF                           03640059
036500             MOVE ASC-DEFAULT-DATE-LIMIT                          03650059
036600                                   TO ASC-DATE-LIMIT              03660059
036700         END-IF                                                   03670059
036800     END-IF.                                                      03680059
036900                                                                  03690059
037000     IF  AREQTYPL > ZERO                                          03700059
037100         MOVE AREQTYPI             TO ASC-REQUEST-TYPE            03710059
037200     ELSE                                                         03720059
037300         IF  AREQTYPF = DP015-ERASE-EOF                           03730059
037400             MOVE SPACE            TO ASC-REQUEST-TYPE            03740059
037500         END-IF                                                   03750059
037600     END-IF.                                                      03760059
037700                                                                  03770059
037800     IF  AREQSTATL > ZERO                                         03780059
037900         MOVE AREQSTATI            TO ASC-REQUEST-STATUS          03790059
038000     ELSE                                                         03800059
038100         IF  AREQSTATF = DP015-ERASE-EOF                          03810059
038200             MOVE SPACE            TO ASC-REQUEST-STATUS          03820059
038300         END-IF                                                   03830059
038400     END-IF.                                                      03840059
038500                                                                  03850059
038600*----------------------------------------------------------------*03860059
038700* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *03870059
038800* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *03880059
038900* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*03890059
039000* IN THE DESTINATION PROGRAM, NOT HERE.                          *03900059
039100*----------------------------------------------------------------*03910059
039200                                                                  03920059
039300 3000-EDIT-DATA-IN-COMMAREA.                                      03930059
039400     PERFORM 3200-RESET-ATTRIBUTES.                               03940059
039500*                                                                 03950059
039600     IF ASC-REQUEST-STATUS > SPACE                                03960059
039700         IF ASC-REQUEST-STATUS  = 'A' OR 'C' OR 'H'               03970059
039800                               OR 'I' OR 'P' OR 'R' OR 'S'        03980059
039900             CONTINUE                                             03990059
040000         ELSE                                                     04000059
040100             SET PS-ERROR         TO TRUE                         04010059
040200             SET DP020-MSG-FATAL  TO TRUE                         04020059
040300*            -- INVALID VALUE --                                  04030059
040400             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             04040059
040500             MOVE DP015-UNP-ALP-BRT-OFF                           04050059
040600                                  TO AREQSTATA                    04060059
040700             MOVE DP015-RED       TO AREQSTATC                    04070059
040800             MOVE DP015-REVERSE   TO AREQSTATH                    04080059
040900             MOVE -1              TO AREQSTATH                    04090059
041000             SET DP030-SET-CURSOR-APPL-1                          04100059
041100                                  TO TRUE                         04110059
041200         END-IF                                                   04120059
041300     ELSE                                                         04130059
041400         MOVE 'A'                 TO ASC-REQUEST-STATUS           04140059
041500         MOVE PC-ACTIVE           TO ASC-STATUS-DESC              04150059
041600     END-IF.                                                      04160059
041700*                                                                 04170059
041800     IF ASC-REQUEST-TYPE > SPACE                                  04180059
041900         IF ASC-REQUEST-TYPE    = 'P' OR 'L' OR 'B'               04190059
042000             CONTINUE                                             04200059
042100         ELSE                                                     04210059
042200             SET PS-ERROR         TO TRUE                         04220059
042300             SET DP020-MSG-FATAL  TO TRUE                         04230059
042400*            -- INVALID VALUE --                                  04240059
042500             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             04250059
042600             MOVE DP015-UNP-ALP-BRT-OFF                           04260059
042700                                  TO AREQTYPA                     04270059
042800             MOVE DP015-RED       TO AREQTYPC                     04280059
042900             MOVE DP015-REVERSE   TO AREQTYPH                     04290059
043000             MOVE -1              TO AREQTYPL                     04300059
043100             SET DP030-SET-CURSOR-APPL-1                          04310059
043200                                  TO TRUE                         04320059
043300         END-IF                                                   04330059
043400     ELSE                                                         04340059
043500         MOVE 'B'                 TO ASC-REQUEST-TYPE             04350059
043600         MOVE PC-BOTH             TO ASC-TYPE-DESC                04360059
043700     END-IF.                                                      04370059
043800*                                                                 04380059
043900*    DATE LIMIT EDIT CHECK                                        04390059
044000*                                                                 04400059
044100     MOVE DP017-CURRENT-DATE-YMD TO DPG51-SYSTEM-DATE.            04410059
044200     MOVE ASC-DATE-LIMIT         TO DPG52-LK-DATE-INPUT.          04420059
044300     SET DPG52-LK-DTE-ISO-FMT    TO TRUE.                         04430059
044400     SET DPG51-ACTUAL-CALENDAR-ONLY                               04440059
044500                                 TO TRUE.                         04450059
044600     SET DPG51-DO-NOT-INCR-DECR-DATE                              04460059
044700                                 TO TRUE.                         04470059
044800     CALL PC-CALENDAR-PGM USING DPG51 DPG52                       04480059
044900                                DPG53 DPG54                       04490059
045000                                DPG55 DPG56.                      04500059
045100     EVALUATE TRUE                                                04510059
045200         WHEN DPG54-NO-ERROR                                      04520059
045300             CONTINUE                                             04530059
045400                                                                  04540059
045500         WHEN DPG54-DATE-INVALID                                  04550059
045600             MOVE PC-TSYMSG-01339 TO DP020-MSG-NUMBER             04560059
045700             MOVE DP015-UNP-ALP-BRT-OFF                           04570059
045800                                  TO ADTELMTA                     04580059
045900             MOVE DP015-RED       TO ADTELMTC                     04590059
046000             MOVE DP015-REVERSE   TO ADTELMTH                     04600059
046100             MOVE -1              TO ADTELMTL                     04610059
046200             SET DP030-SET-CURSOR-APPL-1                          04620059
046300                 PS-ERROR         TO TRUE                         04630059
046400                                                                  04640059
046500         WHEN DPG54-SEVERE-ERROR                                  04650059
046600             SET DP013-NO-ROLLBACK                                04660059
046700                                  TO TRUE                         04670059
046800             SET DP013-XCTL-DISPLAY-RESTART                       04680059
046900                                  TO TRUE                         04690059
047000             SET DP013-CICS-ABEND TO TRUE                         04700059
047100             MOVE '3000-EDIT-COMMAREA'                            04710059
047200                                   TO DP013-PARAGRAPH             04720059
047300             MOVE 'INVALID CALENDAR ROUTINE CALL'                 04730059
047400                                   TO DP013-MESSAGE-TEXT (1)      04740059
047500             MOVE DPG54-ERROR-MESSAGE                             04750059
047600                                   TO DP013-MESSAGE-TEXT (2)      04760059
047700             PERFORM DP013-0000-PROCESS-ABEND                     04770059
047800     END-EVALUATE.                                                04780059
047900*                                                                 04790059
048000     IF  PS-NO-ERROR                                              04800059
048100         MOVE -1                   TO AREQTYPL                    04810059
048200         SET DP030-SET-CURSOR-APPL-1                              04820059
048300                                   TO TRUE                        04830059
048400     END-IF.                                                      04840059
048500******************************************************************04850059
048600** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **04860059
048700** MAP.                                                         **04870059
048800******************************************************************04880059
048900 3200-RESET-ATTRIBUTES.                                           04890059
049000     MOVE DP015-UNP-ALP-NOR-OFF    TO AREQTYPA                    04900059
049100                                      AREQSTATA                   04910059
049200                                      ADTELMTA.                   04920059
049300     MOVE DP015-GREEN              TO AREQTYPC                    04930059
049400                                      AREQSTATC                   04940059
049500                                      ADTELMTC.                   04950059
049600     MOVE DP015-UNDERLINE          TO AREQTYPH                    04960059
049700                                      AREQSTATH                   04970059
049800                                      ADTELMTH.                   04980059
049900*                                                                 04990059
050000*----------------------------------------------------------------*05000059
050100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *05010059
050200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *05020059
050300*  IT HERE.                                                      *05030059
050400*----------------------------------------------------------------*05040059
050500 4000-BUILD-INITIAL-PANEL.                                        05050059
050600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        05060059
050700     MOVE -1                       TO AREQTYPL.                   05070059
050800     PERFORM 4100-GET-PRIOR-DATE.                                 05080059
050900                                                                  05090059
051000*----------------------------------------------------------------*05100059
051100*  CALLS THE CALENDAR ROUTINE TO GET DATE 21 DAYS PRIOR TO THE   *05110059
051200*  CURRENT DATE.                                                 *05120059
051300*----------------------------------------------------------------*05130059
051400 4100-GET-PRIOR-DATE.                                             05140059
051500     MOVE DP017-CURRENT-DATE-YMD TO DPG51-SYSTEM-DATE.            05150059
051600     MOVE DP017-EDITED-DATE-YYYYMMDD                              05160059
051700                                 TO DPG52-LK-DATE-INPUT.          05170059
051800     SET DPG52-LK-DTE-ISO-FMT                                     05180059
051900         DPG51-ACTUAL-CALENDAR-ONLY                               05190059
052000         DPG51-INCREMENT-DATE    TO TRUE.                         05200059
052100                                                                  05210059
052200     MOVE PC-THIRTY-DAYS         TO DPG51-INCR-DECR-DAYS-9.       05220059
052300                                                                  05230059
052400     CALL PC-CALENDAR-PGM USING DPG51 DPG52                       05240059
052500                                DPG53 DPG54                       05250059
052600                                DPG55 DPG56.                      05260059
052700     EVALUATE TRUE                                                05270059
052800         WHEN DPG54-SEVERE-ERROR                                  05280059
052900         WHEN DPG54-DATE-INVALID                                  05290059
053000             SET DP013-NO-ROLLBACK                                05300059
053100                                  TO TRUE                         05310059
053200             SET DP013-XCTL-DISPLAY-RESTART                       05320059
053300                                  TO TRUE                         05330059
053400             SET DP013-CICS-ABEND TO TRUE                         05340059
053500             MOVE '4100-GET-PRIOR-DATE'                           05350059
053600                                   TO DP013-PARAGRAPH             05360059
053700             MOVE 'INVALID CALENDAR ROUTINE CALL'                 05370059
053800                                   TO DP013-MESSAGE-TEXT (1)      05380059
053900             MOVE DPG54-ERROR-MESSAGE                             05390059
054000                                   TO DP013-MESSAGE-TEXT (2)      05400059
054100             PERFORM DP013-0000-PROCESS-ABEND                     05410059
054200         WHEN OTHER                                               05420059
054300             MOVE DPG55-DB2-ISO-DATE-FMT                          05430059
054400                                 TO ASC-DATE-LIMIT                05440059
054500                                    ASC-DEFAULT-DATE-LIMIT        05450059
054600         END-EVALUATE.                                            05460059
054700*                                                                 05470059
054800*----------------------------------------------------------------*05480059
054900*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *05490059
055000*----------------------------------------------------------------*05500059
055100 4400-MOVE-COMMAREA-TO-SCREEN.                                    05510059
055200     MOVE ASC-DATE-LIMIT           TO PV-DATE-ISO.                05520059
055300     MOVE CORR PV-DATE-ISO         TO PV-DATE-USA.                05530059
055400     MOVE PV-DATE-USA              TO ADTELMTO.                   05540059
055500                                                                  05550059
055600     EVALUATE ASC-REQUEST-TYPE                                    05560059
055700         WHEN PC-PRETICKET-CDE                                    05570059
055800              MOVE PC-PRETICKET   TO ASC-TYPE-DESC                05580059
055900         WHEN PC-LOCKSTOCK-CDE                                    05590059
056000              MOVE PC-LOCKSTOCK   TO ASC-TYPE-DESC                05600059
056100         WHEN PC-BOTH-CDE                                         05610059
056200              MOVE PC-BOTH        TO ASC-TYPE-DESC                05620059
056300     END-EVALUATE.                                                05630059
056400     MOVE ASC-REQUEST-TYPE         TO AREQTYPO.                   05640059
056500     MOVE ASC-TYPE-DESC            TO ATYPDESO.                   05650059
056600                                                                  05660059
056700     EVALUATE ASC-REQUEST-STATUS                                  05670059
056800        WHEN PC-ACTIVE                                            05680059
056900            MOVE PC-ACTIVE-DESC    TO ASC-STATUS-DESC             05690059
057000        WHEN PC-CANCELED                                          05700059
057100            MOVE PC-CANCELED-DESC  TO ASC-STATUS-DESC             05710059
057200        WHEN PC-HOLD                                              05720059
057300            MOVE PC-HOLD-DESC      TO ASC-STATUS-DESC             05730059
057400        WHEN PC-INPROCESS                                         05740059
057500            MOVE PC-INPROCESS-DESC TO ASC-STATUS-DESC             05750059
057600        WHEN PC-PRINTED                                           05760059
057700            MOVE PC-PRINTED-DESC   TO ASC-STATUS-DESC             05770059
057800        WHEN PC-RUSH                                              05780059
057900            MOVE PC-RUSH-DESC      TO ASC-STATUS-DESC             05790059
058000        WHEN PC-SHIPPED                                           05800059
058100            MOVE PC-SHIPPED-DESC   TO ASC-STATUS-DESC             05810059
058200     END-EVALUATE.                                                05820059
058300     MOVE ASC-REQUEST-STATUS       TO AREQSTATO.                  05830059
058400     MOVE ASC-STATUS-DESC          TO ASTATDESO.                  05840059
058500 EJECT                                                            05850059
058600*----------------------------------------------------------------*05860059
058700*    ABEND PROCESSOR MODULE                                      *05870059
058800*----------------------------------------------------------------*05880059
058900                                                                  05890059
059000     COPY DPPD013.                                                05900059
059100*----------------------------------------------------------------*05910059
059200*    UPDATE DATE AND TIME                                        *05920059
059300*----------------------------------------------------------------*05930059
059400                                                                  05940059
059500     COPY DPPD017.                                                05950059
