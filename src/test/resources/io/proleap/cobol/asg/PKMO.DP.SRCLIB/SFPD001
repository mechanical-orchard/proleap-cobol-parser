      ******************************************************************00010048
      **SF - STORE LOOKUP MODULE                                        00020048
      **   - ITEM DETAIL INFORMATION LOOKUP                             00030048
      **   - POG INFORMATION LOOKUP                                     00040048
      ******************************************************************00050048
      **DATE:06/29/2004 CHANGED BY:JULIE TEWES INITIAL WRITE            00060048
      ******************************************************************00070048
      **DATE:09/21/2004 CHANGED BY:DAVE WELLER FASTER DEPT_NBR SELECT   00080048
      ******************************************************************00090048
      **DATE:12/26/2004 CHANGED BY:JULIE TEWES EXPAND WINDOW FOR NEW    00100048
      **     STORES TO USE APP TO 9 DAYS AFTER GRAND OPEN DATE          00110048
      ******************************************************************00120048
061107**DATE:06/11/2007 CHANGED BY:DAVE WELLER WR31875                  00130048
      ******************************************************************00140048
      ******************************************************************00141052
TEMP  **DATE:02/27/20013 ADDED THE TEMPORARY IF CONDITION TO PULL THE   00142052
TEMP  *                  PLANOGRAM INFORMATION FOR STORE 781.           00143052
TEMP  *                  CHANGED BY:SARVESWARAN N.S.K. CRQ000000041229  00143152
TEMP  ******************************************************************00144052
       SFPD001-1000-STORE-LOOKUP.                                       00150048
                                                                        00160048
           MOVE 'SFPD001-1000-STORE-LOOKUP'  TO DP013-PARAGRAPH.        00170048
                                                                        00180048
TEMP       IF XST00001-LOC-NBR = 781                                    00190048
TEMP                                                                    00200052
TEMP       EXEC SQL                                                     00210048
TEMP            SELECT LOC_NBR                                          00220048
TEMP            INTO  :XST00001-LOC-NBR                                 00230048
TEMP            FROM   XST_LOC                                          00240048
TEMP            WHERE LOC_NBR = :XST00001-LOC-NBR                       00250048
TEMP            WITH UR                                                 00260048
TEMP       END-EXEC                                                     00270048
TEMP                                                                    00271048
TEMP       ELSE                                                         00280048
TEMP                                                                    00281048
           EXEC SQL                                                     00290048
                SELECT LOC_NBR                                          00300048
                INTO  :XST00001-LOC-NBR                                 00310048
                FROM   XST_LOC                                          00320048
                WHERE LOC_NBR = :XST00001-LOC-NBR                       00330048
                  AND OPN_DTE + 14 DAYS >= CURRENT DATE                 00340048
                WITH UR                                                 00350048
           END-EXEC                                                     00360048
TEMP                                                                    00361048
TEMP       END-IF.                                                      00370048
                                                                        00380048
       EJECT.                                                           00390048
      ******************************************************************00400048
      **LOOKS UP EAS TAG INFORMATION                                    00410048
      ******************************************************************00420048
       SFPD001-2000-EAS-DATA-LOOKUP.                                    00430048
                                                                        00440048
           MOVE 'SFPD001-2000-EAS-DATA-LOOKUP'                          00450048
                                              TO DP013-PARAGRAPH.       00460048
                                                                        00470048
           EXEC SQL                                                     00480048
                SELECT DEPT_NBR                                         00490048
                INTO  :SFT00000-DEPT-NBR                                00500048
                FROM   SFT_EAS_TG_MDSE                                  00510048
                WHERE ( DEPT_NBR      = :XST00013-DEPT-NBR              00520048
                      AND MAJ_CL_NBR    = :XST00013-MAJ-CL-NBR          00530048
                      AND SUB_CL_NBR   = :XST00013-SUB-CL-NBR )         00540048
                  OR  ( DEPT_NBR      = :XST00013-DEPT-NBR              00550048
                      AND MAJ_CL_NBR    = :XST00013-MAJ-CL-NBR          00560048
                      AND SUB_CL_NBR IS NULL )                          00570048
                  AND BEG_PRPT_AMT <= :XST00008-UNT-RTL-AMT             00580048
                WITH UR                                                 00590048
           END-EXEC.                                                    00600048
                                                                        00610048
       EJECT.                                                           00620048
      ******************************************************************00630048
      **OPENS POG-CSR                                                   00640048
      ******************************************************************00650048
      *SFPD001-3000-OPEN-POG-CSR.                                       00660053
      *                                                                 00670053
      *    MOVE 'SFPD001-3000-OPEN-POG-CSR'  TO DP013-PARAGRAPH.        00680053
      *                                                                 00690053
      *    EXEC SQL                                                     00700053
      *         OPEN POG-CSR                                            00710053
      *    END-EXEC.                                                    00720053
      *                                                                 00730053
      *    EVALUATE TRUE                                                00740053
      *       WHEN SQLCODE = ZERO                                       00750053
      *            CONTINUE                                             00760053
      *       WHEN OTHER                                                00770053
      *            MOVE 'UNABLE TO OPEN POG CSR'                        00780053
      *                                      TO DP013-MESSAGE-TEXT (1)  00790053
      *            MOVE XST00001-LOC-NBR     TO DP013-MESSAGE-TEXT (2)  00800053
      *            MOVE XST00012-INTR-UPC-ID TO DP013-MESSAGE-TEXT (3)  00810053
      *            MOVE SQLCA                TO DP013-SQLCA             00820053
      *            MOVE 'XST_POG'            TO DP013-DB2-TABLE-NAME (1)00830053
      *            MOVE 'XST_POG_LOC_ASSN'   TO DP013-DB2-TABLE-NAME (2)00840053
      *            MOVE 'XST_POG_FIXT_LOC..' TO DP013-DB2-TABLE-NAME (3)00850053
      *            SET DP013-DB2-ABEND                                  00860053
      *                DP013-NO-ROLLBACK     TO TRUE                    00870053
      *            PERFORM 9999-WRITE-CICS-LOG-MSG                      00880053
      *            SET  DP011-MSG-FATAL      TO TRUE                    00890053
      *            IF  SQLCODE = -911  OR  SQLCODE = -913               00900053
      *                MOVE PC-TSYMSG-01063  TO DP011-MSG-NUMBER        00910053
      *            ELSE                                                 00920053
      *                MOVE PC-TSYMSG-01064  TO DP011-MSG-NUMBER        00930053
      *            END-IF                                               00940053
      *            PERFORM 9000-FMT-ERR-MSG-TO-PTC                      00950053
      *            PERFORM 9000-CALL-CICS                               00960053
      *    END-EVALUATE.                                                00970053
                                                                        00980048
       EJECT.                                                           00990048
      ******************************************************************01000048
      **LOOKS UP POG INFORMATION FOR ITEM SPECIFIED                     01010048
      ******************************************************************01020048
      *SFPD001-3100-FETCH-POG-CSR.                                      01030053
      *                                                                 01040053
      *    MOVE 'SFPD001-3100-FETCH-POG-CSR'  TO DP013-PARAGRAPH.       01050053
      *                                                                 01060053
      *    EXEC SQL                                                     01070053
      *        FETCH POG-CSR                                            01080053
      *         INTO  :XST00060-FLR-PAD-CDE                             01090053
      *              ,:XST00060-FIXT-LOC-NBR                            01100053
061107*              ,:XST00060-POG-POSN-NBR                            01110048
061107*              ,:XST00060-FIXT-OBJ-ID                             01120053
      *    END-EXEC.                                                    01130053
      *                                                                 01140053
      *EJECT.                                                           01150053
      ******************************************************************01160048
      **CLOSES POG-CSR                                                  01170048
      ******************************************************************01180048
      *SFPD001-3200-CLOSE-POG-CSR.                                      01190053
      *                                                                 01200053
      *    MOVE 'SFPD001-3200-CLOSE-POG-CSR' TO DP013-PARAGRAPH.        01210053
      *                                                                 01220053
      *    EXEC SQL                                                     01230053
      *         CLOSE POG-CSR                                           01240053
      *    END-EXEC.                                                    01250053
      *                                                                 01260053
      *    EVALUATE TRUE                                                01270053
      *       WHEN SQLCODE = ZERO                                       01280053
      *            CONTINUE                                             01290053
      *       WHEN OTHER                                                01300053
      *            MOVE 'UNABLE TO CLOSE POG-CSR'                       01310053
      *                                      TO DP013-MESSAGE-TEXT (1)  01320053
      *            MOVE XST00001-LOC-NBR     TO DP013-MESSAGE-TEXT (2)  01330053
      *            MOVE XST00012-INTR-UPC-ID TO DP013-MESSAGE-TEXT (3)  01340053
      *            MOVE SQLCA                TO DP013-SQLCA             01350053
      *            MOVE 'XST_POG'            TO DP013-DB2-TABLE-NAME (1)01360053
      *            MOVE 'XST_POG_LOC_ASSN'   TO DP013-DB2-TABLE-NAME (2)01370053
      *            MOVE 'XST_POG_FIXT_LOC..' TO DP013-DB2-TABLE-NAME (3)01380053
      *            SET DP013-DB2-ABEND                                  01390053
      *                DP013-NO-ROLLBACK     TO TRUE                    01400053
      *            PERFORM 9999-WRITE-CICS-LOG-MSG                      01410053
      *            SET  DP011-MSG-FATAL      TO TRUE                    01420053
      *            IF  SQLCODE = -911  OR  SQLCODE = -913               01430053
      *                MOVE PC-TSYMSG-01063  TO DP011-MSG-NUMBER        01440053
      *            ELSE                                                 01450053
      *                MOVE PC-TSYMSG-01064  TO DP011-MSG-NUMBER        01460053
      *            END-IF                                               01470053
      *            PERFORM 9000-FMT-ERR-MSG-TO-PTC                      01480053
      *            PERFORM 9000-CALL-CICS                               01490053
      *    END-EVALUATE.                                                01500053
                                                                        01510048
       EJECT.                                                           01520048
