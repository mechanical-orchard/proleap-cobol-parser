000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.                DPKCS203.                             00050000
000600 AUTHOR.                    BRUCE BORCHARDT.                      00060000
000700 INSTALLATION.              KOHLS DEPARTMENT STORES.              00070000
000800 DATE-WRITTEN.              01-23-90.                             00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  CICS PROGRAM - DPKCS203                                       *00120000
001300*                                                                *00130000
001400*  PLT TRANSACTION TO KICK OFF K019 AND OTHER PLT TIME DB2 PROGS.*00140000
001500******************************************************************00150000
001600                                                                  00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900******************************************************************00190000
002000                                                                  00200000
002100******************************************************************00210000
002200 DATA DIVISION.                                                   00220000
002300******************************************************************00230000
002400                                                                  00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600                                                                  00260000
002700 01  PC-PROGRAM-CONSTANTS.                                        00270000
002800     05  PC-STORE-TABLE-BUILD-TRANSID                             00280000
002900                                 PIC X(4)     VALUE 'K019'.       00290000
003000     05  PC-CRFND-AUTH-PARM-BLD-TRANSID                           00300000
003100                                 PIC X(4)     VALUE 'U010'.       00310000
003400     05  PC-EP-CHECK-AUTH-TRANSID                                 00340000
003500                                 PIC X(4)     VALUE 'S235'.       00350000
003600     05  PC-EP-GIFT-CARD-AUTH-TRANSID                             00360000
003700                                 PIC X(4)     VALUE 'S208'.       00370000
004000     05  PC-END-OF-FIRST-HALF-HOUR                                00400000
004100                                 PIC 9(2)     VALUE 29.           00410000
004200     05  PC-END-OF-SECOND-HALF-HOUR                               00420000
004300                                 PIC 9(2)     VALUE 59.           00430000
004400     05  PC-SECONDS-PER-MINUTE   PIC 9(2)     VALUE 60.           00440000
004500     05  PC-THIRTY-SECONDS-INTERVAL                               00450000
004600                                 PIC S9(7)    VALUE +030          00460000
004700                                              COMP-3.             00470000
004800     05  PC-ONE-MINUTE-INTERVAL  PIC S9(7)    VALUE +100          00480000
004900                                              COMP-3.             00490000
005000     05  PC-NINETY-SECONDS-INTERVAL                               00500000
005100                                 PIC S9(7)    VALUE +130          00510000
005200                                              COMP-3.             00520000
005300     05  PC-TWO-MINUTE-INTERVAL  PIC S9(7)    VALUE +200          00530000
005400                                              COMP-3.             00540000
005500     05  PC-THREE-MINUTE-INTERVAL                                 00550000
005600                                 PIC S9(7)    VALUE +300          00560000
005700                                              COMP-3.             00570000
005800     05  PC-SIX-O-CLOCK-A-M      PIC S9(7)    VALUE +60000        00580000
005900                                              COMP-3.             00590000
006000     05  PC-SIX-0-1-A-M          PIC S9(7)    VALUE +60100        00600000
006100                                              COMP-3.             00610000
006200     05  PC-K029-INPUT           PIC X(7)     VALUE 'K029001'.    00620000
006300                                                                  00630000
006400 01  PV-PROGRAM-VARIABLES.                                        00640000
006500     05  PV-EIBTIME              PIC 9(6)     VALUE ZEROS.        00650000
006600     05  FILLER                  REDEFINES PV-EIBTIME.            00660000
006700         10  PV-EIBTIME-HOUR     PIC 9(2).                        00670000
006800         10  PV-EIBTIME-MINUTE   PIC 9(2).                        00680000
006900         10  PV-EIBTIME-SECOND   PIC 9(2).                        00690000
007000     05  PV-INTERVAL             PIC 9(6)     VALUE ZEROS.        00700000
007100     05  FILLER                  REDEFINES PV-INTERVAL.           00710000
007200         10  PV-INTERVAL-HOUR    PIC 9(2).                        00720000
007300         10  PV-INTERVAL-MINUTE  PIC 9(2).                        00730000
007400         10  PV-INTERVAL-SECOND  PIC 9(2).                        00740000
007500     05  PV-INTERVAL-PACKED      PIC S9(7)    VALUE ZEROS         00750000
007600                                              COMP-3.             00760000
007700                                                                  00770000
007800******************************************************************00780000
007900 PROCEDURE DIVISION.                                              00790000
008000******************************************************************00800000
008100                                                                  00810000
008200 0000-MAIN-LINE.                                                  00820000
008300                                                                  00830000
011200                                                                  01120000
011300*    EXEC CICS                                                    01130010
011400*        START                                                    01140010
011500*            TRANSID  (PC-STORE-TABLE-BUILD-TRANSID)              01150010
011600*            INTERVAL (PC-ONE-MINUTE-INTERVAL)                    01160010
011700*    END-EXEC.                                                    01170010
011800                                                                  01180000
011900     EXEC CICS                                                    01190000
012000         START                                                    01200000
012100             TRANSID  (PC-CRFND-AUTH-PARM-BLD-TRANSID)            01210000
012200             INTERVAL (PC-ONE-MINUTE-INTERVAL)                    01220000
012300     END-EXEC.                                                    01230000
012400                                                                  01240000
013100*    EXEC CICS                                                    01310000
013200*        START                                                    01320000
013300*            TRANSID  (PC-EP-CHECK-AUTH-TRANSID)                  01330000
013400*            INTERVAL (010000)                                    01340000
013500*    END-EXEC.                                                    01350000
013600                                                                  01360000
013700     EXEC CICS                                                    01370007
013800         START                                                    01380007
013900             TRANSID  (PC-EP-GIFT-CARD-AUTH-TRANSID)              01390007
014000             INTERVAL (000130)                                    01400009
014100     END-EXEC.                                                    01410007
014200                                                                  01420000
014300     EXEC CICS                                                    01430000
014400         RETURN                                                   01440000
014500     END-EXEC.                                                    01450000
