000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400*                                                                 00040000
000500 PROGRAM-ID.             SNKRP002.                                00050000
000600 AUTHOR.                 GERMAN BANDA.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           OCTOBER 2023.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL BE USED TO CREATE A REPORT LISTING ALL OF    00120000
001300*  UNIT CARTON MISMATCHES BETWEEEN THE IMPORT CARTON TABLES AND   00130000
001310*  THE VENDOR ASN                                                 00131000
001320***************************************************************** 00132000
001330 ENVIRONMENT DIVISION.                                            00133000
001340***************************************************************** 00134000
001350 CONFIGURATION SECTION.                                           00135000
001360 SOURCE-COMPUTER.                        IBM-3090.                00136000
001370 OBJECT-COMPUTER.                        IBM-3090.                00137000
001380 INPUT-OUTPUT SECTION.                                            00138000
001390 FILE-CONTROL.                                                    00139000
001400                                                                  00140000
001500     SELECT ASN-ODD-CRTN-FILE                                     00150000
001600         ASSIGN TO INP01.                                         00160000
001700                                                                  00170000
001800     SELECT REPORT-FILE-1                                         00180000
001900         ASSIGN TO RPT01.                                         00190000
002000                                                                  00200000
002100*    SELECT REPORT-CD-FILE-2                                      00210051
002200*        ASSIGN TO OUT01.                                         00220051
002300*                                                                 00230051
002400***************************************************************** 00240000
002500 DATA DIVISION.                                                   00250000
002600***************************************************************** 00260000
002700 FILE SECTION.                                                    00270000
002800                                                                  00280000
002900 FD  ASN-ODD-CRTN-FILE                                            00290000
003000     RECORDING MODE IS F                                          00300000
003100     LABEL RECORDS ARE STANDARD                                   00310000
003200     BLOCK CONTAINS 0 RECORDS.                                    00320000
003300 01  EMPTY-UNKNOWN-RECORD             PIC X(175).                 00330000
003400                                                                  00340000
003500 FD  REPORT-FILE-1                                                00350000
003600     RECORDING MODE IS F                                          00360000
003700     BLOCK CONTAINS 0 RECORDS.                                    00370000
003800 01  REPORT-RECORD-1                  PIC X(200).                 00380032
003900                                                                  00390000
004000*FD  REPORT-CD-FILE-2                                             00400051
004100*    RECORDING MODE IS F                                          00410051
004200*    BLOCK CONTAINS 0 RECORDS.                                    00420051
004300*01  REPORT-CD-RECORD-2                  PIC X(200).              00430051
004400                                                                  00440000
004500/                                                                 00450000
004600***************************************************************** 00460000
004700 WORKING-STORAGE SECTION.                                         00470000
004800***************************************************************** 00480000
004900                                                                  00490000
005000 01  PS-SWITCHES.                                                 00500000
005100     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00510000
005200         88  PS-END-OF-INPUT                    VALUE 'Y'.        00520000
005300         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00530000
005400     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00540000
005500         88  PS-NEW-PAGE                        VALUE 'Y'.        00550000
005600         88  PS-SAME-PAGE                       VALUE 'N'.        00560000
005700     05  PS-END-OTBND-CART-CSR-SW     PIC X(01) VALUE 'N'.        00570000
005800         88  PS-END-OTBND-CART-CSR-YES          VALUE 'Y'.        00580000
005900         88  PS-END-OTBND-CART-CSR-NO           VALUE 'N'.        00590000
006000     05  PS-PRINT-INPUT-SW            PIC X(01) VALUE 'N'.        00600000
006100         88  PS-PRINT-INPUT                     VALUE 'Y'.        00610000
006200         88  PS-NOT-PRINT-INPUT                 VALUE 'N'.        00620000
006300                                                                  00630000
006400 01  DK-DB2-KEYS.                                                 00640000
006500     05  DK-RUN-DATE                  PIC X(10).                  00650000
006600     05  DK-WEEK-END-DATE             PIC X(10).                  00660000
006700     05  DK-OPER-ID                   PIC S9(4) COMP.             00670000
006800     05  DK-DB2-TMST-1                PIC X(26).                  00680000
006900     05  DK-DB2-TMST-2                PIC X(26).                  00690000
007000                                                                  00700000
007100 01  DN-NULL-INDICATORS.                                          00710000
007200     05  DN-OTBND-TRIP-NULL           PIC S9(04) COMP VALUE ZERO. 00720000
007300                                                                  00730000
007400 01  PV-DATE-RECORD.                                              00740000
007500     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     00750000
007600     05  FILLER                       PIC X(01) VALUE SPACES.     00760000
007700     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     00770000
007800                                                                  00780000
007900 01  SD-SYSTEM-DATE.                                              00790000
008000     05  SD-SYSTEM-DATE-YY            PIC  9(02)   VALUE ZERO.    00800000
008100     05  SD-SYSTEM-DATE-MM            PIC  9(02)   VALUE ZERO.    00810000
008200     05  SD-SYSTEM-DATE-DD            PIC  9(02)   VALUE ZERO.    00820000
008300                                                                  00830000
008400 01  ST-SYSTEM-TIME.                                              00840000
008500     05  ST-SYSTEM-HOUR               PIC  9(02)   VALUE ZERO.    00850000
008600     05  ST-SYSTEM-MINUTE             PIC  9(02)   VALUE ZERO.    00860000
008700     05  FILLER                       PIC  9(04)   VALUE ZERO.    00870000
008800                                                                  00880000
008900 01  PV-VARIABLES.                                                00890000
009000     05  PV-BEGINNING-SML             PIC S9(18)V COMP-3.         00900000
009100     05  PV-ENDING-SML                PIC S9(18)V COMP-3.         00910000
009200     05  PV-SHIPT-UNT-ID              PIC  9(20).                 00920000
009300     05  FILLER REDEFINES PV-SHIPT-UNT-ID.                        00930000
009400         10  FILLER                   PIC X(05).                  00940000
009500         10  PV-SHIPT-UNT-ID-STORE    PIC 9(04).                  00950000
009600         10  FILLER                   PIC X(11).                  00960000
009700     05  PV-READ-COUNT                PIC S9(7) COMP-3            00970000
009800                                                VALUE ZERO.       00980000
009900     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            00990000
010000                                                VALUE ZERO.       01000000
010100     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01010000
010200                                                VALUE ZERO.       01020000
010300     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01030000
010400                                                VALUE ZERO.       01040000
010500     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01050000
010600                                                 COMP SYNC.       01060000
010700***************************************************************   01070000
010800     05  PV-TOTAL-DIVERTS            PIC S9(07) VALUE ZERO        01080000
010900                                                 COMP SYNC.       01090000
011000     05  PV-SHIPPING-DOOR             PIC S9(07) VALUE ZERO       01100000
011100                                                 COMP SYNC.       01110000
011200     05  PV-STORAGE-DOOR              PIC S9(07) VALUE ZERO       01120000
011300                                                 COMP SYNC.       01130000
011400     05  PV-SHUTTLE-DOOR              PIC S9(07) VALUE ZERO       01140000
011500                                                 COMP SYNC.       01150000
011600     05  PV-OTHER                     PIC S9(07) VALUE ZERO       01160000
011700                                                 COMP SYNC.       01170000
011800     05  PV-DUPLICATE-DIVERTS         PIC S9(07) VALUE ZERO       01180000
011900                                                 COMP SYNC.       01190000
012000     05  PV-NO-INFO-DIVERTS           PIC S9(07) VALUE ZERO       01200000
012100                                                 COMP SYNC.       01210000
012200     05  PV-INACTIVE-DIVERTS          PIC S9(07) VALUE ZERO       01220000
012300                                                 COMP SYNC.       01230000
012400                                                                  01240000
012500***************************************************************   01250000
012600     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            01260000
012700     05  PV-STORE-NBR                 PIC S9(4) COMP.             01270000
012800     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01280000
012900     05  PV-LOCATION-NBR              PIC 9(04) VALUE ZEROS.      01290000
013000     05  PV-DC                        PIC S9(04) COMP.            01300000
013100     05  PV-PREV-DC                   PIC S9(04) COMP.            01310000
013200     05  PV-PREV-ENT-ID               PIC S9(09).                 01320000
013210     05  PV-VARIANCE                  PIC S9(04).                 01321002
013300                                                                  01330000
013400     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01340000
013500     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     01350000
013600     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01360000
013700     05  PV-DISPLAY-SML               PIC 9(20).                  01370000
013800     05  PV-DISPLAY-PO                PIC 9(09).                  01380000
013900     05  PV-DISPLAY-RCVR              PIC 9(04).                  01390000
014000     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01400000
014100     05  PV-DISP-LOC                  PIC  9(4).                  01410000
014200                                                                  01420000
014300     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01430000
014400     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01440000
014500     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    01450000
014600     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    01460000
014700     05  PV-DB2-YEAR                  PIC S9(08) COMP             01470000
014800                                          VALUE ZERO.             01480000
014900     05  PV-DB2-MONTH                 PIC S9(08) COMP             01490000
015000                                          VALUE ZERO.             01500000
015100     05  PV-DB2-DAY                   PIC S9(08) COMP             01510000
015200                                          VALUE ZERO.             01520000
015300     05  PV-DB2-HOUR                  PIC S9(08) COMP             01530000
015400                                          VALUE ZERO.             01540000
015500     05  PV-DB2-MINUTE                PIC S9(08) COMP             01550000
015600                                          VALUE ZERO.             01560000
015700     05  PV-DB2-SECOND                PIC S9(08) COMP             01570000
015800                                          VALUE ZERO.             01580000
015900                                                                  01590000
016000******************************************************************01600000
016100 01  PV-DATE-FIELDS.                                              01610000
016200     05  PV-DB2-TMST.                                             01620000
016300         10 PV-DB2-TMST-CCYY          PIC  9(04).                 01630000
016400         10 FILLER                    PIC  X(01).                 01640000
016500         10 PV-DB2-TMST-MM            PIC  9(02).                 01650000
016600         10 FILLER                    PIC  X(01).                 01660000
016700         10 PV-DB2-TMST-DD            PIC  9(02).                 01670000
016800         10 FILLER                    PIC  X(01).                 01680000
016900         10 PV-DB2-TMST-HH            PIC  9(02).                 01690000
017000         10 FILLER                    PIC  X(01).                 01700000
017100         10 PV-DB2-TMST-MN            PIC  9(02).                 01710000
017200         10 FILLER                    PIC  X(01).                 01720000
017300         10 PV-DB2-TMST-SS            PIC  9(02).                 01730000
017400         10 FILLER                    PIC  X(07).                 01740000
017500     05  PV-DIVERT-DATE               PIC  X(10).                 01750000
017600     05  FILLER REDEFINES PV-DIVERT-DATE.                         01760000
017700         10 FILLER                    PIC  X(02).                 01770000
017800         10 PV-DIVERT-DATE-YY         PIC  X(02).                 01780000
017900         10 FILLER                    PIC  X(01).                 01790000
018000         10 PV-DIVERT-DATE-MM         PIC  X(02).                 01800000
018100         10 FILLER                    PIC  X(01).                 01810000
018200         10 PV-DIVERT-DATE-DD         PIC  X(02).                 01820000
018300     05  PV-DIVERT-TIME               PIC  X(08).                 01830000
018400     05  FILLER REDEFINES PV-DIVERT-TIME.                         01840000
018500         10 PV-DIVERT-TIME-HH         PIC  X(02).                 01850000
018600         10 FILLER                    PIC  X(01).                 01860000
018700         10 PV-DIVERT-TIME-MM         PIC  X(02).                 01870000
018800         10 FILLER                    PIC  X(01).                 01880000
018900         10 PV-DIVERT-TIME-SS         PIC  X(02).                 01890000
019000     05  PV-CREATE-DATE               PIC  X(10).                 01900000
019100     05  FILLER REDEFINES PV-CREATE-DATE.                         01910000
019200         10 FILLER                    PIC  X(02).                 01920000
019300         10 PV-CREATE-DATE-YY         PIC  X(02).                 01930000
019400         10 FILLER                    PIC  X(01).                 01940000
019500         10 PV-CREATE-DATE-MM         PIC  X(02).                 01950000
019600         10 FILLER                    PIC  X(01).                 01960000
019700         10 PV-CREATE-DATE-DD         PIC  X(02).                 01970000
019800     05  PV-CREATE-TIME               PIC  X(08).                 01980000
019900     05  FILLER REDEFINES PV-CREATE-TIME.                         01990000
020000         10 PV-CREATE-TIME-HH         PIC  X(02).                 02000000
020100         10 FILLER                    PIC  X(01).                 02010000
020200         10 PV-CREATE-TIME-MM         PIC  X(02).                 02020000
020300         10 FILLER                    PIC  X(01).                 02030000
020400         10 PV-CREATE-TIME-SS         PIC  X(02).                 02040000
020500     05  PV-FORMAT-DATE-TIME.                                     02050000
020600         10  PV-FORMAT-DATE-MM            PIC X(02).              02060000
020700         10  FILLER                       PIC X(01) VALUE '/'.    02070000
020800         10  PV-FORMAT-DATE-DD            PIC X(02).              02080000
020900         10  FILLER                       PIC X(01) VALUE '/'.    02090000
021000         10  PV-FORMAT-DATE-YYYY          PIC X(04).              02100000
021100**       10  FILLER                       PIC X(01) VALUE SPACE.  02110000
021200**       10  PV-FORMAT-TIME-HH            PIC X(02).              02120000
021300**       10  FILLER                       PIC X(01) VALUE ':'.    02130000
021400**       10  PV-FORMAT-TIME-MM            PIC X(02).              02140000
021500                                                                  02150000
021600     05  PV-DB2-TMST-1.                                           02160000
021700         10  PV-DB2-DATE-1                PIC X(10) VALUE SPACES. 02170000
021800         10  FILLER                       PIC X(16) VALUE         02180000
021900                              '-00.00.00.000000'.                 02190000
022000     05  PV-DB2-TMST-2.                                           02200000
022100         10  PV-DB2-DATE-2                PIC X(10) VALUE SPACES. 02210000
022200         10  FILLER                       PIC X(16) VALUE         02220000
022300                              '-23.59.59.999999'.                 02230000
022400                                                                  02240000
022500                                                                  02250000
022600 01  PV-ABEND-FIELDS.                                             02260000
022700     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02270000
022800                                                 COMP SYNC.       02280000
022900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02290000
023000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02300000
023100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02310000
023200     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)  VALUE SPACE.    02320000
023300/                                                                 02330000
023400 01  PC-CONSTANTS.                                                02340000
023500     05  PC-SNKRP002                  PIC X(08) VALUE 'SNKRP002'. 02350000
023600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'SNKRP002'. 02360000
023700     05  PC-CRTN-STATUS-PGM           PIC X(08) VALUE 'PCKUT713'. 02370000
023800     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02380000
023900     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02390000
024000                                                COMP-3.           02400000
024100     05  PC-ASTERISKS                 PIC X(07) VALUE '*******'.  02410000
024200     05  PC-COMMA                     PIC X(01) VALUE ','.        02420000
024300/                                                                 02430000
024400******************************************************************02440000
024500*  WORK FIELDS FOR PRINTING A 200 CHARACTER REPORT.               02450032
024600******************************************************************02460000
024700     COPY DPWS200O.                                               02470029
024800*                                                                 02480000
024900 01  HL-HEADING-LINE-1.                                           02490000
025000     05  FILLER                      PIC  X(37).                  02500000
025100     05  FILLER                      PIC  X(59)  VALUE            02510000
025200     '      ASN - BULK- IMPORT CARTON /ASN CARTON MISMATCHES    '.02520000
025300     05  FILLER                      PIC  X(37).                  02530000
025400                                                                  02540000
025500 01  HL-HEADING-LINE-2.                                           02550000
025600     05  FILLER                      PIC  X(16)  VALUE            02560000
025700            '  DC LOCATION:  '.                                   02570000
025800     05  HL2-LOCATION.                                            02580000
025900         10  HL2-OPER-ID             PIC  X(04) VALUE SPACES.     02590000
026000         10  FILLER                  PIC  X(01) VALUE SPACES.     02600000
026100         10  FILLER                  PIC  X(01) VALUE '-'.        02610000
026200         10  FILLER                  PIC  X(01) VALUE SPACES.     02620000
026300         10  HL2-LOC-DESC            PIC  X(25) VALUE SPACES.     02630000
026400         10  FILLER                  PIC  X(84) VALUE SPACES.     02640000
026500                                                                  02650000
026600 01  HL-HEADING-LINE-3.                                           02660000
026700     05  FILLER                      PIC  X(04)  VALUE SPACES.    02670000
026800     05  FILLER                      PIC  X(52)  VALUE            02680006
026900       'VENDOR         OPER DEPT  PO NBR   LNE  SKU         '.    02690057
027000     05  FILLER                      PIC  X(04)  VALUE            02700039
027100      'SSCC'.                                                     02710036
027101     05  FILLER                      PIC  X(13)  VALUE SPACES.    02710154
027102     05  FILLER                      PIC  X(30)  VALUE            02710236
027103      'ASN  IMP DIFF CONTAINER    BOL'.                           02710336
027200     05  FILLER                      PIC  X(47)  VALUE            02720047
027300      '       PO  DATE       UPC NUMBER     ASN NUMBER'.          02730047
027400                                                                  02740000
027500 01  HL-HEADING-LINE-4.                                           02750000
027600     05  FILLER                      PIC  X(73)  VALUE SPACES.    02760055
028000     05  FILLER                      PIC  X(08)  VALUE            02800018
028100      'QTY  QTY'.                                                 02810018
028110     05  FILLER                      PIC  X(29)  VALUE SPACES.    02811055
028200     05  FILLER                      PIC  X(14)  VALUE            02820018
028210      'TY  PROCESSED'.                                            02821056
028300                                                                  02830000
028400 01  DL-DETAIL-LINE-1.                                            02840000
028500     05  FILLER                       PIC X(02) VALUE SPACES.     02850000
028600     05  DL1-VENDOR                   PIC X(16).                  02860000
028700     05  FILLER                       PIC X(01) VALUE SPACES.     02870000
028800     05  DL1-LOCATION                 PIC 9(04).                  02880000
028810     05  FILLER                       PIC X(01) VALUE SPACES.     02881000
028811     05  DL1-DEPT                     PIC X(03).                  02881144
028812     05  FILLER                       PIC X(01) VALUE SPACES.     02881237
028820     05  DL1-PO-NBR                   PIC Z(09).                  02882000
028900     05  FILLER                       PIC X(01) VALUE SPACES.     02890000
029000     05  DL1-LINE                     PIC Z(04).                  02900000
029100     05  FILLER                       PIC X(01) VALUE SPACES.     02910000
029200     05  DL1-SKU                      PIC 9(08).                  02920000
029300     05  FILLER                       PIC X(01) VALUE SPACES.     02930000
029400     05  DL1-CARTON                   PIC X(18).                  02940000
029500     05  FILLER                       PIC X(01) VALUE SPACES.     02950028
029800     05  DL1-ASN-QTY                  PIC ZZ99.                   02980000
029900     05  FILLER                       PIC X(01) VALUE SPACES.     02990000
030000     05  DL1-IMPRT-QTY                PIC ZZ99.                   03000000
030100*    05  FILLER                       PIC X(01) VALUE SPACES.     03010003
030200*    05  DL1-ASN-TOT-QTY              PIC ZZZZ.                   03020003
030300     05  FILLER                       PIC X(01) VALUE SPACES.     03030000
030400     05  DL1-VARIANCE                 PIC -999.                   03040026
030500     05  FILLER                       PIC X(01) VALUE SPACES.     03050000
030800     05  DL1-CONTAINER                PIC X(12).                  03080000
030900     05  FILLER                       PIC X(01) VALUE SPACES.     03090000
031000     05  DL1-BOL                      PIC X(10).                  03100014
031010     05  FILLER                       PIC X(01) VALUE SPACES.     03101014
031020     05  DL1-TYPE                     PIC X(02).                  03102017
031030     05  FILLER                       PIC X(01) VALUE SPACES.     03103017
031040     05  DL1-ASN-DATE                 PIC X(10).                  03104017
031100     05  FILLER                       PIC X(01) VALUE SPACES.     03110028
031110     05  DL1-UPC-NBR                  PIC 9(15).                  03111000
031120     05  FILLER                       PIC X(01) VALUE SPACES.     03112029
031130     05  DL1-ASN-NBR                  PIC X(30).                  03113029
031140     05  FILLER                       PIC X(10) VALUE SPACES.     03114033
031200                                                                  03120000
031300 01  ER-END-OF-REPORT-LINE.                                       03130000
031400     05  FILLER                       PIC X(19)  VALUE            03140000
031500         '** END OF REPORT **'.                                   03150000
031600     05  FILLER                       PIC X(113)  VALUE SPACES.   03160000
031700                                                                  03170000
031800 01  EP-EMPTY-REPORT-LINE.                                        03180000
031900     05  FILLER                       PIC X(34)  VALUE SPACES.    03190000
032000     05  FILLER                       PIC X(52)  VALUE            03200000
032100      '*************** EMPTY INPUT FILE *******************'.     03210000
032200     05  FILLER                       PIC X(49)  VALUE SPACES.    03220000
032300                                                                  03230000
032400 01  DL-BLANK-LINE                    PIC X(200) VALUE SPACES.    03240032
032500                                                                  03250000
032600 01  EL1-ERROR-LINE-1P.                                           03260000
032700     05  FILLER                      PIC  X(02)     VALUE SPACES. 03270000
032800     05  FILLER                      PIC  X(48)     VALUE         03280000
032900         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      03290000
033000     05  FILLER                      PIC  X(49)     VALUE         03300000
033100         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     03310000
033200     05  FILLER                      PIC  X(33)     VALUE         03320000
033300         'COMPLETED.                       '.                     03330000
033400                                                                  03340000
033500 01  EL2-ERROR-LINE-2F.                                           03350000
033600     05  FILLER                      PIC  X(02)     VALUE SPACES. 03360000
033700     05  FILLER                      PIC  X(36)     VALUE         03370000
033800         'NONE OF YOUR REPORTS WERE CREATED.  '.                  03380000
033900     05  FILLER                      PIC  X(36)     VALUE         03390000
034000         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  03400000
034100     05  FILLER                      PIC  X(58)     VALUE SPACES. 03410000
034200                                                                  03420000
034300 01  EL3-ERROR-LINE-3.                                            03430000
034400     05  FILLER                      PIC  X(02)     VALUE SPACES. 03440000
034500     05  FILLER                      PIC  X(50)     VALUE         03450000
034600         'YOUR REQUEST WAS AS FOLLOWS:                      '.    03460000
034700     05  FILLER                      PIC  X(81)     VALUE SPACES. 03470000
034800                                                                  03480000
034900 01  EL4-ERROR-LINE-4.                                            03490000
035000     05  FILLER                      PIC  X(02)     VALUE SPACES. 03500000
035100     05  FILLER                      PIC  X(18)     VALUE         03510000
035200         'REQUESTOR       : '.                                    03520000
035300     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 03530000
035400     05  FILLER                      PIC  X(07)     VALUE SPACES. 03540000
035500     05  FILLER                      PIC  X(21)     VALUE         03550000
035600         'PRINTER DESTINATION: '.                                 03560000
035700     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 03570000
035800     05  FILLER                      PIC  X(65)     VALUE SPACES. 03580000
035900                                                                  03590000
036000 01  EL5-ERROR-LINE-5B.                                           03600000
036100     05  FILLER                      PIC  X(02)     VALUE SPACES. 03610000
036200     05  FILLER                      PIC  X(18)     VALUE         03620000
036300         'START DATE RANGE: '.                                    03630000
036400     05  EL5-START-DATE-RANGE        PIC  X(10).                  03640000
036500     05  FILLER                      PIC  X(07)     VALUE SPACES. 03650000
036600     05  FILLER                      PIC  X(21)     VALUE         03660000
036700         'END DATE RANGE     : '.                                 03670000
036800     05  EL5-END-DATE-RANGE          PIC  X(10).                  03680000
036900     05  FILLER                      PIC  X(20)     VALUE SPACES. 03690000
037000/                                                                 03700000
037100******************************************************************03710000
037200*  RECORD LAYOUT FOR INPUT FILE                                   03720000
037300******************************************************************03730000
037400     COPY SNRD008.                                                03740000
037500/                                                                 03750000
037600******************************************************************03760000
037700*  RECORD LAYOUT FOR COMMA DELIMITED OUTPUT FILE                  03770000
037800******************************************************************03780000
037900**   COPY SNRD009.                                                03790051
038000/                                                                 03800000
038100*  LOGISTICS DOMAIN LOCATION MODULE                               03810000
038200*                                                                 03820000
038300     COPY XLWS071.                                                03830000
038400                                                                  03840000
038500******************************************************************03850000
038600*  COPYBOOK USED BY MBS SYSTEM                                    03860000
038700******************************************************************03870000
038800     COPY DPWS003.                                                03880000
038900*                                                                 03890000
039000******************************************************************03900000
039100*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03910000
039200******************************************************************03920000
039300     COPY DPWS024.                                                03930000
039400/                                                                 03940000
039500******************************************************************03950000
039600*  DB2 FORMATTED MESSAGE AREA                                     03960000
039700******************************************************************03970000
039800     COPY DPWS004.                                                03980000
039900/                                                                 03990000
040000******************************************************************04000000
040100* CORPORATE DATE ROUTINES                                         04010000
040200******************************************************************04020000
040300     COPY DPWS500.                                                04030000
040400/                                                                 04040000
040500*DB2 AREA FOR ENTITY NAME TABLE                                   04050000
040600     EXEC SQL                                                     04060000
040700          INCLUDE TENTNME                                         04070000
040800     END-EXEC.                                                    04080000
040900                                                                  04090000
041000******************************************************************04100000
041100*   DB2 SQL COMMUNICATION AREA                                    04110000
041200******************************************************************04120000
041300     EXEC SQL                                                     04130000
041400         INCLUDE SQLCA                                            04140000
041500     END-EXEC.                                                    04150000
041600*                                                                 04160000
041700     COPY SQLCA2.                                                 04170000
041800*                                                                 04180000
041900******************************************************************04190000
042000 PROCEDURE DIVISION.                                              04200000
042100******************************************************************04210000
042200 0000-MAINLINE.                                                   04220000
042300                                                                  04230000
042400     OPEN INPUT  ASN-ODD-CRTN-FILE                                04240000
042500          OUTPUT REPORT-FILE-1.                                   04250051
042600***              REPORT-CD-FILE-2.                                04260051
042700                                                                  04270000
042800     PERFORM 1000-INITIALIZE                                      04280000
042900     PERFORM 2100-READ-INPUT-FILE.                                04290000
043000     IF PS-END-OF-INPUT                                           04300000
043100         PERFORM 1300-NO-DETAIL-LINE                              04310000
043200     ELSE                                                         04320000
043300         MOVE SN008-LOCATION         TO PV-PREV-DC                04330000
043400         MOVE SN008-PURCHS-ENT-ID    TO PV-PREV-ENT-ID            04340000
043500**       PERFORM 5000-SELECT-OPER-DESC                            04350058
043600         PERFORM 5100-GET-VEND-NAME                               04360000
043700         MOVE ENTNME-ENT-NAME-DESC TO DL1-VENDOR                  04370000
043800         PERFORM 8000-WRITE-MAIN-HEADINGS                         04380000
043900         PERFORM 2000-PROCESS-EXTRACT                             04390000
044000             UNTIL PS-END-OF-INPUT                                04400000
044100     END-IF.                                                      04410000
044200                                                                  04420000
044300     PERFORM 9000-EOJ.                                            04430000
044400                                                                  04440000
044500     GOBACK.                                                      04450000
044600                                                                  04460000
044700******************************************************************04470000
044800 1000-INITIALIZE.                                                 04480000
044900******************************************************************04490000
045000*                                                                 04500000
045100* LOAD SYSTEM DATE INTO HEADINGS                                  04510000
045200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04520000
045300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04530000
045400                                                                  04540000
045500     MOVE SD-SYSTEM-DATE-YY      TO DP200O-RUN-YEAR.              04550030
045600     MOVE SD-SYSTEM-DATE-MM      TO DP200O-RUN-MONTH.             04560030
045700     MOVE SD-SYSTEM-DATE-DD      TO DP200O-RUN-DAY.               04570030
045800     MOVE ST-SYSTEM-HOUR         TO DP200O-RUN-HOUR.              04580030
045900     MOVE ST-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.            04590030
046000                                                                  04600000
046100     MOVE PC-CURRENT-PROGRAM-NAME                                 04610000
046200                                 TO DP200O-PROGRAM-NAME.          04620030
046300     MOVE 1                      TO DP200O-REPORT-NUMBER          04630030
046400                                    DP200O-PAGE-NUMBER.           04640030
046500                                                                  04650000
046600*                                                                 04660000
046700*                                                                 04670000
046800******************************************************************04680000
046900*  PRINT A 'NO INPUT' REPORT LINE.                                04690000
047000******************************************************************04700000
047100 1300-NO-DETAIL-LINE.                                             04710000
047200*                                                                 04720000
047300     PERFORM 8000-WRITE-MAIN-HEADINGS.                            04730000
047400                                                                  04740000
047500     WRITE REPORT-RECORD-1                                        04750000
047600       FROM EP-EMPTY-REPORT-LINE                                  04760000
047700         AFTER ADVANCING 3 LINES.                                 04770000
047800*                                                                 04780000
047900*                                                                 04790000
048000******************************************************************04800000
048100 2000-PROCESS-EXTRACT.                                            04810000
048200******************************************************************04820000
048300*                                                                 04830000
048400*    IF SN008-LOCATION NOT = PV-PREV-DC                           04840042
048500*        PERFORM 5000-SELECT-OPER-DESC                            04850042
048600*        MOVE ZERO                  TO PV-PAGE-COUNT              04860042
048700*        PERFORM 8000-WRITE-MAIN-HEADINGS                         04870042
048800*        MOVE SN008-LOCATION        TO PV-PREV-DC                 04880042
048900*    END-IF.                                                      04890042
049000                                                                  04900000
049100     IF SN008-PURCHS-ENT-ID NOT =  PV-PREV-ENT-ID                 04910000
049200         PERFORM 5100-GET-VEND-NAME                               04920000
049300         MOVE SN008-PURCHS-ENT-ID TO PV-PREV-ENT-ID               04930000
049400         MOVE ENTNME-ENT-NAME-DESC TO DL1-VENDOR                  04940000
049500     END-IF.                                                      04950000
049600                                                                  04960000
049700     PERFORM 3010-PRINT-FROM-INPUT                                04970000
049800**   PERFORM 3020-FORMAT-CSV                                      04980051
049900                                                                  04990000
050000     ADD 2 TO PV-LINE-COUNT.                                      05000000
050100     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05010000
050200         SUBTRACT 2 FROM PV-LINE-COUNT                            05020000
050300     ELSE                                                         05030000
050400         WRITE REPORT-RECORD-1                                    05040000
050500           FROM DL-BLANK-LINE                                     05050000
050600             AFTER ADVANCING 2 LINES                              05060000
050700     END-IF.                                                      05070000
050800                                                                  05080000
050900     PERFORM 2100-READ-INPUT-FILE.                                05090000
051000*                                                                 05100000
051100******************************************************************05110000
051200*  READ NEXT INPUT FILE RECORD.                                   05120000
051300******************************************************************05130000
051400 2100-READ-INPUT-FILE.                                            05140000
051500                                                                  05150000
051600     READ ASN-ODD-CRTN-FILE       INTO SN008-ASN-UPD-RECORD       05160000
051700        AT END                                                    05170000
051800           SET PS-END-OF-INPUT TO TRUE                            05180000
051900        NOT AT END                                                05190000
052000           ADD +1                   TO PV-READ-COUNT              05200000
052100     END-READ.                                                    05210000
052200*                                                                 05220000
052300 3010-PRINT-FROM-INPUT.                                           05230000
052310      MOVE +0 TO PV-VARIANCE                                      05231002
052400      MOVE SN008-LOCATION         TO DL1-LOCATION.                05240002
052500      MOVE SN008-PO-NBR           TO DL1-PO-NBR.                  05250000
052510      MOVE SN008-DEPT             TO DL1-DEPT.                    05251044
052600      MOVE SN008-LNE-NBR          TO DL1-LINE.                    05260000
052700      MOVE SN008-SKU              TO DL1-SKU.                     05270000
052800      MOVE SN008-CARTON-NBR(3:18) TO DL1-CARTON.                  05280000
052810      COMPUTE PV-VARIANCE  = (SN008-ASN-UNT-QTY -                 05281002
052820                                        SN008-IMPRT-UNT-QTY)      05282002
052830      MOVE PV-VARIANCE            TO DL1-VARIANCE.                05283002
052900      MOVE SN008-ASN-UNT-QTY      TO DL1-ASN-QTY.                 05290000
053000      MOVE SN008-IMPRT-UNT-QTY    TO DL1-IMPRT-QTY.               05300000
053100**    MOVE SN008-TOT-ASN-QTY      TO DL1-ASN-TOT-QTY.             05310003
053200**    MOVE SN008-TOT-IMP-QTY      TO DL1-IMP-TOT-QTY.             05320001
053300      MOVE SN008-UPC-NBR          TO DL1-UPC-NBR.                 05330000
053400      MOVE SN008-CONTNR-ID        TO DL1-CONTAINER.               05340000
053410      MOVE SN008-BOL-NBR          TO DL1-BOL.                     05341015
053420      MOVE SN008-PO-TYP-CDE       TO DL1-TYPE.                    05342022
053500      MOVE SN008-ASNHDR-TMST      TO PV-DB2-TMST                  05350000
053510      MOVE SN008-ASNHDR-NBR       TO DL1-ASN-NBR                  05351029
053600      MOVE PV-DB2-TMST-CCYY       TO PV-FORMAT-DATE-YYYY          05360000
053700      MOVE PV-DB2-TMST-MM         TO PV-FORMAT-DATE-MM            05370000
053800      MOVE PV-DB2-TMST-DD         TO PV-FORMAT-DATE-DD            05380000
053900      MOVE PV-FORMAT-DATE-TIME    TO DL1-ASN-DATE.                05390000
053910      PERFORM 7000-PRINT-DETAILS.                                 05391053
054000                                                                  05400000
054100*3020-FORMAT-CSV.                                                 05410051
054200*     INITIALIZE SN009-ASNHDR-NBR.                                05420051
054300*     MOVE PC-COMMA  TO  SN009-COMMA-1                            05430051
054400*                        SN009-COMMA-2                            05440051
054500*                        SN009-COMMA-3                            05450051
054600*                        SN009-COMMA-4                            05460051
054700*                        SN009-COMMA-5                            05470051
054800*                        SN009-COMMA-6                            05480051
054900*                        SN009-COMMA-7                            05490051
055000*                        SN009-COMMA-8                            05500051
055100*                        SN009-COMMA-9                            05510051
055200*                        SN009-COMMA-10                           05520051
055300*                        SN009-COMMA-11                           05530051
055400*                        SN009-COMMA-12                           05540051
055500*                        SN009-COMMA-13                           05550051
055510*                        SN009-COMMA-14                           05551051
055520*                        SN009-COMMA-15.                          05552051
055600*                                                                 05560051
055610*     MOVE ENTNME-ENT-NAME-DESC   TO SN009-VENDOR-NME             05561051
055700*     MOVE SN008-LOCATION         TO SN009-LOCATION               05570051
055800*     MOVE SN008-DEPT             TO SN009-DEPT                   05580051
055900*     MOVE SN008-PO-NBR           TO SN009-PO-NBR                 05590051
056000*     MOVE SN008-LNE-NBR          TO SN009-LNE-NBR                05600051
056100*     MOVE SN008-SKU              TO SN009-SKU                    05610051
056200*     MOVE SN008-CARTON-NBR       TO SN009-CARTON-NBR             05620051
056220*     MOVE SN008-IMPRT-UNT-QTY    TO SN009-IMPRT-UNT-QTY          05622051
056230*     MOVE SN008-ASN-UNT-QTY      TO SN009-ASN-UNT-QTY            05623051
056240*     MOVE PV-VARIANCE            TO SN009-DIFFERENCE             05624051
056250*     MOVE SN008-CONTNR-ID        TO SN009-CONTNR-ID              05625051
056260*     MOVE SN008-BOL-NBR          TO SN009-BOL                    05626051
056270*     MOVE SN008-PO-TYP-CDE       TO SN009-PO-TYP-CDE             05627051
057000*     MOVE PV-FORMAT-DATE-TIME    TO SN009-ASNHDR-DATE.           05700051
057010*     MOVE SN008-UPC-NBR          TO SN009-UPC-NBR                05701051
057020*     MOVE SN008-ASNHDR-NBR       TO SN009-ASNHDR-NBR             05702051
057100*     PERFORM 7000-PRINT-DETAILS.                                 05710051
057200*     PERFORM 7100-WRITE-OUT01.                                   05720051
057300*                                                                 05730051
057400******************************************************************05740000
057500***************************************************************** 05750000
057600 5000-SELECT-OPER-DESC.                                           05760000
057700***************************************************************** 05770000
057800     INITIALIZE XL071-COMMAREA-REC.                               05780000
057900     MOVE SN008-LOCATION        TO XL071-LOCATION-NUMBER          05790000
058000                                   PV-DISP-LOC                    05800000
058100                                   HL2-OPER-ID                    05810000
058200                                                                  05820000
058300     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05830000
058400                                                                  05840000
058500     EVALUATE TRUE                                                05850000
058600     WHEN XL071-NO-ERRORS                                         05860000
058700         MOVE XL071-LOC-NM          TO HL2-LOC-DESC               05870000
058800     WHEN XL071-LOC-NOT-FOUND                                     05880000
058900     WHEN XL071-DC-ASGMT-NOT-FND                                  05890000
059000         MOVE 'UNKNOWN'             TO HL2-LOC-DESC               05900000
059100     WHEN XL071-BAD-DB2-RETURN                                    05910000
059200         MOVE    '5000-SELECT-OPER-DESC' TO PV-PARAGRAPH          05920000
059300         DISPLAY '5000-SELECT-OPER-DESC'                          05930000
059400         DISPLAY '** LOCATION     = ' PV-DISP-LOC                 05940000
059500         DISPLAY 'CALL LOCATION MOD '                             05950000
059600         DISPLAY 'XLT00010'                                       05960000
059700         MOVE XL071-SQLCA             TO SQLCA                    05970000
059800         PERFORM 9200-SQL-ABEND                                   05980000
059900     END-EVALUATE.                                                05990000
060000                                                                  06000000
060100 5100-GET-VEND-NAME.                                              06010000
060200     MOVE SN008-PURCHS-ENT-ID  TO ENTNME-ENT-ID                   06020000
060300                                                                  06030000
060400     EXEC SQL                                                     06040000
060500        SELECT A.ENT_NAME_DESC                                    06050000
060600          INTO :ENTNME-ENT-NAME-DESC                              06060000
060700          FROM TENTNME A                                          06070000
060800         WHERE A.ENT_ID   = :ENTNME-ENT-ID                        06080000
060900          AND  A.TYPE_CDE  = '01'                                 06090000
061000     END-EXEC.                                                    06100000
061100                                                                  06110000
061200     EVALUATE TRUE                                                06120000
061300         WHEN SQLCODE = ZERO                                      06130000
061400             CONTINUE                                             06140000
061500         WHEN SQLCODE = +100                                      06150000
061600             MOVE 'VND NOT FOUND' TO ENTNME-ENT-NAME-DESC         06160000
061700         WHEN SQLWARN0 NOT = SPACES                               06170000
061800         WHEN SQLCODE < +0                                        06180000
061900         WHEN SQLCODE > ZERO                                      06190000
062000             MOVE '5100-GET-VEND-NAME'                            06200000
062100                                   TO PV-PARAGRAPH                06210000
062200             MOVE 'SELECT'         TO PV-DB2-OPERATION-MESSAGE-1  06220000
062300             MOVE 'TENTNME'        TO PV-DB2-TABLE-NAME           06230000
062400             STRING 'ENT_ID  '      DELIMITED BY SIZE             06240000
062500                    SN008-PURCHS-ENT-ID DELIMITED BY SIZE         06250000
062600                           INTO PV-DB2-OPERATION-MESSAGE-2        06260000
062700             PERFORM 9200-SQL-ABEND                               06270000
062800     END-EVALUATE.                                                06280000
062900******************************************************************06290000
063000*  FILL AND PRINT DETAIL REPORT LINE.                             06300000
063100******************************************************************06310000
063200 7000-PRINT-DETAILS.                                              06320000
063300                                                                  06330000
063400*CHECK FOR OVERFLOW.                                              06340000
063500     ADD 1 TO PV-LINE-COUNT.                                      06350000
063600     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         06360000
063700         SET PS-NEW-PAGE TO TRUE                                  06370000
063800         PERFORM 8000-WRITE-MAIN-HEADINGS                         06380000
063900     END-IF.                                                      06390000
064000     WRITE REPORT-RECORD-1                                        06400000
064100       FROM DL-DETAIL-LINE-1                                      06410000
064200         AFTER ADVANCING 1 LINES.                                 06420000
064300*                                                                 06430000
064400******************************************************************06440000
064500*7100-WRITE-OUT01.                                                06450051
064600*                                                                 06460051
064700*    WRITE REPORT-CD-RECORD-2                                     06470051
064800*      FROM SN009-ASN-UPD-RECORD.                                 06480051
064900*                                                                 06490000
065000******************************************************************06500000
065100 8000-WRITE-MAIN-HEADINGS.                                        06510000
065200******************************************************************06520000
065300*                                                                 06530000
065400     ADD 1                         TO PV-PAGE-COUNT.              06540000
065500     MOVE PV-PAGE-COUNT            TO DP200O-PAGE-NUMBER.         06550030
065600     MOVE ZERO                     TO PV-LINE-COUNT.              06560000
065700                                                                  06570000
065800     WRITE REPORT-RECORD-1 FROM                                   06580000
065900         DP200O-STANDRD-HEADER-200-COLS                           06590031
066000         AFTER ADVANCING PAGE.                                    06600000
066100                                                                  06610000
066200     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06620000
066300         AFTER ADVANCING 1 LINE                                   06630000
066400                                                                  06640000
066500     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1                 06650000
066600        AFTER ADVANCING 1 LINES.                                  06660000
066700                                                                  06670000
066800     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06680000
066900         AFTER ADVANCING 1 LINE                                   06690000
067000                                                                  06700000
067100*    WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2                 06710027
067200*       AFTER ADVANCING 1 LINES.                                  06720027
067300                                                                  06730000
067400     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06740000
067500         AFTER ADVANCING 1 LINE                                   06750000
067600                                                                  06760000
067700     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3                 06770000
067800        AFTER ADVANCING 1 LINES.                                  06780000
067900                                                                  06790000
068000     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4                 06800000
068100        AFTER ADVANCING 1 LINES.                                  06810000
068200                                                                  06820000
068300     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     06830000
068400         AFTER ADVANCING 1 LINE                                   06840000
068500                                                                  06850000
068600     ADD 8                            TO PV-LINE-COUNT.           06860000
068700*                                                                 06870000
068800******************************************************************06880000
068900 9000-EOJ.                                                        06890000
069000******************************************************************06900000
069100*                                                                 06910000
069200     WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE             06920000
069300        AFTER ADVANCING 2 LINES                                   06930000
069400                                                                  06940000
069500*CLOSE FILES.                                                     06950000
069600     CLOSE ASN-ODD-CRTN-FILE                                      06960000
069700           REPORT-FILE-1.                                         06970052
069800*          REPORT-CD-FILE-2.                                      06980052
069900                                                                  06990000
070000     MOVE PV-READ-COUNT      TO PV-DISPLAY-COUNT.                 07000000
070100     DISPLAY 'TOTAL INPUT RECORDS READ...: ' PV-DISPLAY-COUNT.    07010000
070200     MOVE PV-WRITE-COUNT     TO PV-DISPLAY-COUNT.                 07020000
070300     DISPLAY 'TOTAL INPUT RECORDS WRITTEN: ' PV-DISPLAY-COUNT.    07030000
070400                                                                  07040000
070500/                                                                 07050000
070600******************************************************************07060000
070700 9200-SQL-ABEND.                                                  07070000
070800******************************************************************07080000
070900                                                                  07090000
071000     MOVE SQLCODE                     TO SQLCODE2.                07100000
071100     MOVE SQLERRD(3)                  TO SQLERRD3.                07110000
071200                                                                  07120000
071300     DISPLAY '** ABEND **         ** = SQLERROR'.                 07130000
071400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07140000
071500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   07150000
071600     DISPLAY '** TABLE NAME * = ' PV-DB2-TABLE-NAME.              07160000
071700     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07170000
071800     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     07180000
071900     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     07190000
072000     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     07200000
072100                                                                  07210000
072200     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                07220000
072300     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                07230000
072400     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 07240000
072500     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                07250000
072600                                                                  07260000
072700                                                                  07270000
072800     MOVE +4013                       TO PV-ABEND-CODE.           07280000
072900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07290000
073000                                                                  07300000
