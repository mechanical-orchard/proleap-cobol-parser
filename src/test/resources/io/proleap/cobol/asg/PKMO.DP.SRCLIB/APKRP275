000100 IDENTIFICATION DIVISION.                                         00010040
000200 PROGRAM-ID.     APKRP275.                                        00020040
000300 AUTHOR.         PAUL KEBER - STRATAGEM.                          00030002
000400 DATE-WRITTEN.   09/15/1995.                                      00040040
000500 DATE-COMPILED.                                                   00050040
000600*************************************************************     00060040
000700*    COBOL 2 BATCH                                          *     00070040
000800*       --- CLASS DISTRIBUTION EXCEPTION REPORTING ---      *     00080040
000900*                                                           *     00090040
001000*    THIS PROGRAM INPUTS THE CLASS DISTRIBUTION ERROR       *     00100040
001100*    LINES FILE WHICH IS SORTED IN PO/STORE SEQUENCE.  AN   *     00110040
001200*    OUTPUT REPORT IS FORMATTED WITH STANDARD HEADINGS AND  *     00120040
001300*    THE INPUT ERROR LINES.                                 *     00130040
001400*                                                           *     00140040
001500*                                                           *     00150040
001600* INPUT:                                                    *     00160040
001700*  1. CLASS DISTRIBUTION ERROR LINES                        *     00170040
001800*     (PKMT.AP.CLASS.DIST.ERRORS.SRTD)                      *     00180040
001900*                                                           *     00190040
002000* OUTPUT:                                                   *     00200040
002100*  1. CLASS DISTRIBUTION EXCEPTION REPORT                   *     00210040
002200*                                                           *     00220040
002300*************************************************************     00230040
002400                                                                  00240040
002500*-----------------------------------------------------------------00250040
002600*                                                                 00260040
002700* 11/05/97  -  ADD TOTALS TO REPORT.  THIS INCLUDES TOTALS FOR    00270040
002800*              RECEIVING, INVOICE, AND VARIANCE.                  00280040
002900* BY CHRIS BOEHNLEIN WR:5704                                      00290052
003000*-----------------------------------------------------------------00300040
003100                                                                  00310040
003200                                                                  00320040
003300 ENVIRONMENT DIVISION.                                            00330040
003400 CONFIGURATION SECTION.                                           00340040
003500 SOURCE-COMPUTER.    IBM-3090.                                    00350040
003600 OBJECT-COMPUTER.    IBM-3090.                                    00360040
003700                                                                  00370040
003800 INPUT-OUTPUT SECTION.                                            00380040
003900 FILE-CONTROL.                                                    00390040
004000     SELECT CLASS-DIST-ERRS-FILE ASSIGN TO UT-S-INP01.            00400040
004100     SELECT EXCEPTION-RPT-FILE   ASSIGN TO UT-S-RPT01.            00410040
004200                                                                  00420040
004300 DATA DIVISION.                                                   00430040
004400 FILE SECTION.                                                    00440040
004500                                                                  00450040
004600 FD  CLASS-DIST-ERRS-FILE                                         00460040
004700     RECORDING MODE IS F                                          00470040
004800     LABEL RECORDS ARE STANDARD                                   00480040
004900     BLOCK CONTAINS 0 RECORDS                                     00490040
005000     DATA RECORD IS CLASS-DIST-ERRS-REC.                          00500040
005100 01  CLASS-DIST-ERRS-REC              PIC  X(132).                00510040
005200                                                                  00520040
005300 FD  EXCEPTION-RPT-FILE                                           00530040
005400     RECORDING MODE IS F                                          00540040
005500     LABEL RECORDS ARE STANDARD                                   00550040
005600     BLOCK CONTAINS 0 RECORDS                                     00560040
005700     DATA RECORD IS EXCEPTION-RPT-REC.                            00570040
005800 01  EXCEPTION-RPT-REC                PIC  X(132).                00580040
005900 EJECT                                                            00590040
006000                                                                  00600040
006100 WORKING-STORAGE SECTION.                                         00610040
006200                                                                  00620040
006300 01  PV-PROGRAM-VARIABLES.                                        00630040
006400     05  FILLER                      PIC  X(30)  VALUE            00640040
006500         '** BEGINING OF APKRP275 W/S **'.                        00650040
006600     05  PV-CURRENT-PARAGRAPH        PIC  X(35).                  00660040
006700     05  PV-PROGRAM-NAME             PIC  X(08)  VALUE 'APKRP275'.00670040
006800                                                                  00680040
006900     05  PV-DATE-TIME-FIELDS.                                     00690040
007000         10  PV-CURRENT-DATE.                                     00700040
007100             15  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.     00710040
007200             15  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.     00720040
007300             15  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.     00730040
007400         10  PV-CURRENT-TIME.                                     00740040
007500             15  PV-CURRENT-HOURS    PIC  9(02)  VALUE ZEROS.     00750040
007600             15  PV-CURRENT-MIN      PIC  9(02)  VALUE ZEROS.     00760040
007700             15  PV-CURRENT-SEC      PIC  9(02)  VALUE ZEROS.     00770040
007800             15  PV-CURRENT-HUN      PIC  9(02)  VALUE ZEROS.     00780040
007900                                                                  00790040
008000     05  PV-COUNTERS.                                             00800040
008100         10  PV-LINE-COUNT           PIC S9(03)  VALUE +61        00810040
008200                                                 COMP-3.          00820040
008300         10  PV-PAGE-COUNT           PIC S9(05)  VALUE ZEROS      00830040
008400                                                 COMP-3.          00840040
008500     05  PV-TOT-TOTALS.                                           00850040
008600         10  PV-PRCCLM-TOTAL         PIC S9(12)V99 VALUE ZERO     00860063
008700                                                   COMP-3.        00870040
008800         10  PV-COST-TOTAL           PIC S9(12)V99 VALUE ZERO     00880063
008900                                                   COMP-3.        00890040
009000         10  PV-MISSING-TOTAL        PIC S9(12)V99 VALUE ZERO     00900063
009100                                                   COMP-3.        00910040
               10  PV-REC-TOTAL            PIC  9(9)V99 VALUE ZERO      00911091
                                                         COMP-3.        00912053
009200         10  PV-INVC-TOTAL           PIC  9(9)V99 VALUE ZERO      00920091
                                                         COMP-3.        00921053
               10  PV-TOTAL-VAR            PIC S9(9)V99 VALUE ZERO      00921191
                                                         COMP-3.        00921257
                                                                        00922053
009300 01  PC-PROGRAM-CONSTANTS.                                        00930040
009400     05  PC-MAX-LINES            PIC S9(03)  VALUE +60            00940040
009500                                             COMP-3.              00950040
009600                                                                  00960040
009700 01  PS-PROGRAM-SWITCHES.                                         00970040
009800     05  PS-OUT-OF-ERR-LINES-SW  PIC  X(01)  VALUE 'M'.           00980040
009900         88  OUT-OF-ERR-LINES                VALUE 'O'.           00990040
010000         88  MORE-ERR-LINES                  VALUE 'M'.           01000040
010100                                                                  01010040
010200 01  D1-DETAIL-IN.                                                01020079
010300     05  D1-FILLER-A             PIC  X(19)  VALUE SPACES.        01030057
010400     05  D1-ERROR                PIC  X(32)  VALUE SPACES.        01040059
010500     05  D1-FILLER-B             PIC  X(14)  VALUE SPACES.        01050076
           05  D1-FILLER-1             PIC  X(11)  VALUE SPACES.        01050159
           05  D1-REC-BREAKDOWN REDEFINES D1-FILLER-1.                  01050253
               10  D1-REC-TOT          PIC  9(09)V99.                   01050385
           05  D1-FILLER-C             PIC  X(15)  VALUE SPACES.        01050456
           05  D1-FILLER-C-BREAKDOWN REDEFINES D1-FILLER-C.             01050582
               10 FILLER               PIC  X(01).                      01050680
               10 D1-FILLER-C-BREAK    PIC  X(14).                      01050781
           05  D1-FILLER-2             PIC  X(11).                      01050862
           05  D1-INVC-BREAKDOWN REDEFINES D1-FILLER-2.                 01050953
               10  D1-INVC-TOT         PIC  9(09)V99.                   01051085
           05  D1-FILLER-D             PIC  X(19)  VALUE SPACES.        01051176
           05  D1-FILLER-D-BREAKDOWN REDEFINES D1-FILLER-D.             01051280
               10  FILLER              PIC  X(04).                      01051380
               10  D1-FILLER-D-BREAK   PIC  X(11).                      01051484
               10  FILLER              PIC  X(04).                      01051584
           05  D1-FILLER-3             PIC  X(11).                      01051653
           05  D1-VARIANCE-BREAKDOWN REDEFINES D1-FILLER-3.             01052055
010600         10  D1-VARIANCE         PIC  9(09)V99.                   01060085
010700                                                                  01070040
010800                                                                  01080040
010900 EJECT                                                            01090040
011000*----------------------------------------------------------------*01100040
011100*  STANDARD HEADER LAYOUT                                        *01110040
011200*----------------------------------------------------------------*01120040
011300     COPY DPWS132O.                                               01130093
011400                                                                  01140040
011500                                                                  01150040
011600 01  H2-HEADER2.                                                  01160040
011700     05  FILLER                  PIC  X(48) VALUE SPACES.         01170040
011800     05  FILLER                  PIC  X(85) VALUE                 01180040
011900         'CLASS DISTRIBUTION - EXCEPTION REPORT'.                 01190040
012000                                                                  01200040
012100 01  DH-DETAIL-HEADER.                                            01210040
012200     05  FILLER                  PIC  X(01)  VALUE SPACE.         01220040
012300     05  FILLER                  PIC  X(11)  VALUE 'P/O#'.        01230040
012400     05  FILLER                  PIC  X(07)  VALUE 'STORE#'.      01240040
012500     05  FILLER                  PIC  X(114) VALUE                01250040
012600          ' ERROR MESSAGE'.                                       01260040
012700                                                                  01270040
012800 01  DETAIL-LINE-CM.                                              01280073
012900     05  DLCM-FILLER-A           PIC  X(19)  VALUE SPACES.        01290073
013000     05  DLCM-ERROR              PIC  X(32)  VALUE SPACES.        01300073
013100     05  DLCM-FILLER-B           PIC  X(14)  VALUE SPACES.        01310073
           05  DLCM-REC-TOT            PIC  ZZZ,ZZZ,ZZ9.99.             01311073
           05  DLCM-FILLER-C           PIC  X(14)  VALUE SPACES.        01312080
           05  DLCM-INVC-TOT           PIC  ZZZ,ZZZ,ZZ9.99.             01313073
           05  DLCM-FILLER-D           PIC  X(11).                      01314085
013200     05  DLCM-VARIANCE           PIC  ZZZ,ZZZ,ZZ9.99.             01320073
                                                                        01321073
013300                                                                  01330040
       01  DETAIL-LINE.                                                 01331073
           05  DL-FILLER-A             PIC  X(19)  VALUE SPACES.        01332073
           05  DL-ERROR                PIC  X(32)  VALUE SPACES.        01333073
           05  DL-FILLER-B             PIC  X(14)  VALUE SPACES.        01334073
           05  DL-FILLER-1             PIC  X(11)  VALUE SPACES.        01335077
           05  DL-FILLER-C             PIC  X(12)  VALUE SPACES.        01336073
           05  DL-FILLER-2             PIC  X(15)  VALUE SPACES.        01337090
           05  DL-FILLER-D             PIC  X(15)  VALUE SPACES.        01338089
           05  DL-VARIANCE             PIC  ZZZ,ZZZ,ZZ9.99.             01339090
                                                                        01339173
013400 01  TOTAL-LINE1.                                                 01340040
013500     05  FILLER                  PIC  X(80)  VALUE SPACES.        01350040
013600     05  FILLER                  PIC  X(38)  VALUE                01360040
013700           ' PRCCLM LINE# NOT FOUND IN RCVR TOTAL:'.              01370040
013800     05  TL-PRCCLM-TOTAL         PIC  ZZZ,ZZZ,ZZZ.99.             01380040
013900                                                                  01390040
014000 01  TOTAL-LINE2.                                                 01400040
014100     05  FILLER                  PIC  X(80)  VALUE SPACES.        01410040
014200     05  FILLER                  PIC  X(38)  VALUE                01420040
014300           'MISSING PRCCLM LN# MATCH W/RCVR TOTAL:'.              01430040
014400     05  TL-MISSING-TOTAL        PIC  ZZZ,ZZZ,ZZZ.99.             01440040
014500                                                                  01450040
014600 01  TOTAL-LINE5.                                                 01460054
014700     05  FILLER                  PIC  X(80)  VALUE SPACES.        01470091
           05  FILLER                  PIC  X(38)  VALUE                01471083
           'COST MISMATCH      REC TOTAL VARIANCE:'.                    01472092
           05  T5-REC-TOTAL            PIC  $$$,$$$,$$9.99.             01473091
       01  TOTAL-LINE6.                                                 01473167
           05  FILLER                  PIC  X(80)  VALUE SPACES.        01474091
           05  FILLER                  PIC  X(38)  VALUE                01475083
           'COST MISMATCH     INVC TOTAL VARIANCE:'.                    01476092
           05  T5-INVC-TOTAL           PIC  $$$,$$$,$$9.99.             01477091
015100                                                                  01510040
015200 01  DL-NO-ERROR.                                                 01520040
015300     05  FILLER                  PIC  X(54) VALUE SPACES.         01530040
015400     05  FILLER                  PIC  X(32) VALUE                 01540043
015500       'THERE ARE NO ERRORS TODAY   '.                            01550043
           05  FILLER                  PIC  X(46) VALUE SPACES.         01551043
                                                                        01552043
015600 EJECT                                                            01560040
015700*----------------------------------------------------------------*01570040
015800*  ABEND DATA AREAS                                              *01580040
015900*----------------------------------------------------------------*01590040
016000 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          01600040
016100                                             COMP SYNC.           01610040
016200     88  AC-NO-INPUT-ERR                     VALUE +2750.         01620040
016300                                                                  01630040
016400                                                                  01640040
016500 01  ABEND-AREAS.                                                 01650040
016600     05  AA-ABEND-LIT            PIC  X(40)  VALUE                01660040
016700             '*****       ABEND'.                                 01670040
016800     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                01680040
016900             '*****   PROGRAM: APKRP275'.                         01690040
017000     05  AA-PARAGRAPH-LIT.                                        01700040
017100         10  FILLER              PIC  X(17)  VALUE                01710040
017200             '***** PARAGRAPH: '.                                 01720040
017300         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        01730040
017400     05  AA-MESSAGE-LINE.                                         01740040
017500         10  FILLER              PIC  X(06)  VALUE '*****'.       01750040
017600         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        01760040
017700 EJECT                                                            01770040
017800 PROCEDURE DIVISION.                                              01780040
017900 A100-MAIN.                                                       01790040
018000                                                                  01800040
018100     MOVE 'A100-MAIN' TO PV-CURRENT-PARAGRAPH.                    01810040
018200                                                                  01820040
018300     PERFORM B100-INITIALIZE.                                     01830040
018400                                                                  01840040
018500     PERFORM R100-READ-CLASS-DIST-ERRS.                           01850040
018600     IF OUT-OF-ERR-LINES                                          01860040
018700         MOVE 'EMPTY INPUT FILE' TO AA-MESSAGE                    01870040
018800         SET AC-NO-INPUT-ERR         TO TRUE                      01880040
018900         PERFORM Z999-ABEND                                       01890040
019000     END-IF.                                                      01900040
019100                                                                  01910040
019200     PERFORM B200-PROCESS-CLASS-DIST-ERRS                         01920040
019300         UNTIL OUT-OF-ERR-LINES.                                  01930040
019400                                                                  01940040
019500        PERFORM W200-WRITE-TOTAL-LINES                            01950040
019600                                                                  01960040
019700     CLOSE CLASS-DIST-ERRS-FILE                                   01970040
019800           EXCEPTION-RPT-FILE.                                    01980040
019900                                                                  01990040
020000     GOBACK.                                                      02000040
020100 EJECT                                                            02010040
020200*----------------------------------------------------------------*02020040
020300*    INITIALIZATION PROCESSING                                   *02030040
020400*    CALLED FROM A100-MAIN                                       *02040040
020500*----------------------------------------------------------------*02050040
020600 B100-INITIALIZE.                                                 02060040
020700                                                                  02070040
020800     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              02080040
020900                                                                  02090040
021000     OPEN INPUT  CLASS-DIST-ERRS-FILE.                            02100040
021100     OPEN OUTPUT EXCEPTION-RPT-FILE.                              02110040
021200                                                                  02120040
021300     MOVE PV-PROGRAM-NAME   TO DP132O-PROGRAM-NAME.               02130040
021400                                                                  02140040
021500     ACCEPT PV-CURRENT-TIME FROM TIME.                            02150040
021600     MOVE PV-CURRENT-HOURS  TO DP132O-RUN-HOUR.                   02160040
021700     MOVE PV-CURRENT-MIN    TO DP132O-RUN-MINUTE.                 02170040
021800                                                                  02180040
021900     ACCEPT PV-CURRENT-DATE FROM DATE.                            02190040
022000     MOVE PV-CURRENT-YEAR   TO DP132O-RUN-YEAR.                   02200040
022100     MOVE PV-CURRENT-MONTH  TO DP132O-RUN-MONTH.                  02210040
022200     MOVE PV-CURRENT-DAY    TO DP132O-RUN-DAY.                    02220040
022300                                                                  02230040
022400     PERFORM W150-PRINT-HEADERS.                                  02240040
022500 EJECT                                                            02250040
022600*----------------------------------------------------------------*02260040
022700*    WRITES EACH CLASS DISTRIBUTION EXCEPTION REPORT RECORD AND  *02270040
022800*    READS ANOTHER INPUT ERROR LINE RECORD.                      *02280040
022900*    CALLED FROM A100-MAIN                                       *02290040
023000*----------------------------------------------------------------*02300040
023100 B200-PROCESS-CLASS-DIST-ERRS.                                    02310040
023200                                                                  02320040
023300     MOVE 'B200-PROCESS-CLASS-DIST-ERRS' TO PV-CURRENT-PARAGRAPH. 02330040
023400                                                                  02340040
023700     IF DL-ERROR NOT = 'THERE ARE NO ERRORS TODAY      '          02370040
023800         PERFORM C100-COMPUTE-TOTALS                              02380040
023900     END-IF                                                       02390040
024000                                                                  02400040
024100     PERFORM R100-READ-CLASS-DIST-ERRS.                           02410040
024200 EJECT                                                            02420040
024300                                                                  02430040
024400*-----------------------------------------------------------------02440040
024500* COMPUTES THE TOTALS OF OF BOTH ERROR TYPES                      02450040
024600*-----------------------------------------------------------------02460040
024700 C100-COMPUTE-TOTALS.                                             02470040
             IF D1-ERROR = 'COST MISMATCH                  '            02471072
               IF D1-REC-TOT > D1-INVC-TOT                              02471185
                COMPUTE PV-REC-TOTAL  = PV-REC-TOTAL + D1-VARIANCE      02472086
               ELSE                                                     02472183
                COMPUTE PV-INVC-TOTAL = PV-INVC-TOTAL + D1-VARIANCE     02473087
               END-IF                                                   02473183
                PERFORM W125-PRINT-EXCEPTION-CM                         02473274
             ELSE                                                       02474073
024800                                                                  02480040
024900      IF D1-ERROR = 'PRCCLM LINE# NOT FOUND IN RCVR '             02490040
025000        COMPUTE PV-PRCCLM-TOTAL = PV-PRCCLM-TOTAL + D1-VARIANCE   02500040
              PERFORM W100-PRINT-EXCEPTION                              02501074
025100      ELSE                                                        02510073
025200                                                                  02520040
025300      IF D1-ERROR = 'MISSING PRCCLM LN# MATCH W/RCVR'             02530040
025400        COMPUTE PV-MISSING-TOTAL = PV-MISSING-TOTAL + D1-VARIANCE 02540040
              PERFORM W100-PRINT-EXCEPTION                              02541073
025500      ELSE                                                        02550073
              PERFORM W100-PRINT-EXCEPTION                              02560075
            END-IF.                                                     02570074
026000                                                                  02600040
026100*----------------------------------------------------------------*02610040
026200*    READS THE SORTED CLASS DISTRIBUTION ERROR LINES FILE.       *02620040
026300*----------------------------------------------------------------*02630040
026400 R100-READ-CLASS-DIST-ERRS.                                       02640040
026500                                                                  02650040
026600     MOVE 'R100-READ-CLASS-DIST-ERRS' TO PV-CURRENT-PARAGRAPH.    02660040
026700                                                                  02670040
026800     READ CLASS-DIST-ERRS-FILE INTO D1-DETAIL-IN                  02680079
026900         AT END                                                   02690040
027000             SET OUT-OF-ERR-LINES TO TRUE.                        02700040
      ***************************************************************** 02700173
      * W100-PRINT-EXEPTION                                             02700273
      * PRINTS ALL OF THE LINE ITEMS EXCEPT THE COST MISMATCH           02700373
      ***************************************************************** 02700473
                                                                        02700573
027600 W100-PRINT-EXCEPTION.                                            02700673
027700                                                                  02700773
027800     MOVE 'W100-PRINT-EXCEPTION'      TO PV-CURRENT-PARAGRAPH.    02700873
027900                                                                  02700973
028000     IF PV-LINE-COUNT > PC-MAX-LINES                              02701073
028100         PERFORM W150-PRINT-HEADERS                               02701173
028200     END-IF.                                                      02701273
028300                                                                  02701373
028400     IF D1-ERROR = 'THERE ARE NO ERRORS TODAY      '              02701473
028500       WRITE EXCEPTION-RPT-REC FROM DL-NO-ERROR AFTER 1           02701573
028600     ELSE                                                         02701673
028700       MOVE D1-FILLER-A         TO DL-FILLER-A                    02701773
028800       MOVE D1-ERROR            TO DL-ERROR                       02701873
028900       MOVE D1-FILLER-B         TO DL-FILLER-B                    02701973
             MOVE D1-FILLER-1         TO DL-FILLER-1                    02702073
             MOVE D1-FILLER-C         TO DL-FILLER-C                    02702173
             MOVE D1-FILLER-2         TO DL-FILLER-2                    02702273
             MOVE D1-FILLER-D         TO DL-FILLER-D                    02702373
             MOVE D1-VARIANCE         TO DL-VARIANCE                    02702473
029100                                                                  02702573
029200       WRITE EXCEPTION-RPT-REC FROM DETAIL-LINE AFTER 1           02702673
029300                                                                  02702773
029400       ADD +1 TO PV-LINE-COUNT                                    02702873
029500                                                                  02702973
029600     END-IF.                                                      02703073
027100 EJECT                                                            02710040
027200*----------------------------------------------------------------*02720040
027300*    PRINTS THE ERROR REPORT DETAIL LINE FOR COST MISMATCH       *02730073
027500*----------------------------------------------------------------*02750040
027600 W125-PRINT-EXCEPTION-CM.                                         02760073
027700                                                                  02770040
027800     MOVE 'W125-PRINT-EXCEPTION-CM'      TO PV-CURRENT-PARAGRAPH. 02780073
027900                                                                  02790040
028000     IF PV-LINE-COUNT > PC-MAX-LINES                              02800040
028100         PERFORM W150-PRINT-HEADERS                               02810040
028200     END-IF.                                                      02820040
028300                                                                  02830046
028700       MOVE D1-FILLER-A         TO DLCM-FILLER-A.                 02870075
028800       MOVE D1-ERROR            TO DLCM-ERROR.                    02880075
028900       MOVE D1-FILLER-B         TO DLCM-FILLER-B.                 02890075
             MOVE D1-REC-TOT          TO DLCM-REC-TOT.                  02901075
             MOVE D1-FILLER-C-BREAK   TO DLCM-FILLER-C.                 02902080
             MOVE D1-INVC-TOT         TO DLCM-INVC-TOT.                 02903075
             MOVE D1-FILLER-D-BREAK   TO DLCM-FILLER-D.                 02904080
             MOVE D1-VARIANCE         TO DLCM-VARIANCE.                 02905075
029100                                                                  02910040
029200       WRITE EXCEPTION-RPT-REC FROM DETAIL-LINE-CM AFTER 1.       02920075
029300                                                                  02930040
029400       ADD +1 TO PV-LINE-COUNT.                                   02940075
029700                                                                  02970040
029800*----------------------------------------------------------------*02980040
029900*    PRINTS HEADERS FOR THE EXCEPTION REPORT.                    *02990040
030000*    CALLED FROM B100-INITIALIZE                                 *03000040
030100*                W100-PRINT-EXCEPTION                            *03010040
030200*----------------------------------------------------------------*03020040
030300 W150-PRINT-HEADERS.                                              03030040
030400                                                                  03040040
030500     MOVE 'W150-PRINT-HEADERS' TO PV-CURRENT-PARAGRAPH.           03050040
030600                                                                  03060040
030700     ADD 1              TO PV-PAGE-COUNT.                         03070040
030800     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    03080040
030900     MOVE 1             TO DP132O-REPORT-NUMBER.                  03090040
031000                                                                  03100040
031100     WRITE EXCEPTION-RPT-REC                                      03110040
031200           FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.        03120040
031300     WRITE EXCEPTION-RPT-REC FROM H2-HEADER2 AFTER 1.             03130040
031400                                                                  03140040
031500     WRITE EXCEPTION-RPT-REC FROM DH-DETAIL-HEADER AFTER 2.       03150040
031600     INITIALIZE EXCEPTION-RPT-REC.                                03160040
031700     WRITE EXCEPTION-RPT-REC AFTER 1.                             03170040
031800                                                                  03180040
031900     MOVE 5                           TO PV-LINE-COUNT.           03190040
032000 EJECT                                                            03200040
032100*-----------------------------------------------------------------03210040
032200* WRITE OUT THE TOTAL LINES ON THE REPORT                         03220040
032300*-----------------------------------------------------------------03230040
032400                                                                  03240040
032500 W200-WRITE-TOTAL-LINES.                                          03250040
032600                                                                  03260040
032700      MOVE SPACES TO EXCEPTION-RPT-REC.                           03270040
032800      WRITE EXCEPTION-RPT-REC AFTER 1.                            03280040
                                                                        03280172
            IF PV-REC-TOTAL NOT= ZERO    OR                             03281072
               PV-INVC-TOTAL NOT= ZERO                                  03282072
                MOVE PV-REC-TOTAL  TO T5-REC-TOTAL                      03285072
                MOVE PV-INVC-TOTAL TO T5-INVC-TOTAL                     03286072
                WRITE EXCEPTION-RPT-REC FROM TOTAL-LINE5 AFTER 1        03287072
                WRITE EXCEPTION-RPT-REC FROM TOTAL-LINE6 AFTER 1        03288072
            END-IF.                                                     03289172
032900                                                                  03290040
033000      IF PV-PRCCLM-TOTAL NOT= ZERO                                03300040
033100          MOVE PV-PRCCLM-TOTAL TO TL-PRCCLM-TOTAL                 03310040
033200          WRITE EXCEPTION-RPT-REC FROM TOTAL-LINE1 AFTER 2        03320072
033300      END-IF.                                                     03330040
033400                                                                  03340040
033500      IF PV-MISSING-TOTAL NOT= ZERO                               03350040
033600          MOVE PV-MISSING-TOTAL TO TL-MISSING-TOTAL               03360040
033700          WRITE EXCEPTION-RPT-REC FROM TOTAL-LINE2 AFTER 2        03370072
033800      END-IF.                                                     03380040
033900                                                                  03390040
034500  EJECT                                                           03450040
034600*----------------------------------------------------------------*03460040
034700*    ABEND ROUTINE                                               *03470040
034800*----------------------------------------------------------------*03480040
034900 Z999-ABEND.                                                      03490040
035000                                                                  03500040
035100     DISPLAY AA-ABEND-LIT.                                        03510040
035200     DISPLAY AA-PROGRAM-LIT.                                      03520040
035300     DISPLAY AA-PARAGRAPH-LIT.                                    03530040
035400     DISPLAY AA-MESSAGE-LINE.                                     03540040
035500     CALL 'ILBOABN0' USING ABEND-CODE.                            03550040
