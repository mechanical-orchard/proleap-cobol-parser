      *----------------------------------------------------------       00000100
       IDENTIFICATION DIVISION.                                         00000200
      *----------------------------------------------------------       00000300
       PROGRAM-ID.    PXKUT093.                                         00000400
       AUTHOR.        DAVID WELLER.                                     00000500
       DATE-WRITTEN.  MAY, 2007.                                        00000600
                                                                        00000700
      *----------------------------------------------------------       00000800
      * RETURN 4091 WHEN THERE IS NO EVENT NO-OF-DAYS FROM THE          00000900
      *             CURRENT DATE                                        00001000
      *----------------------------------------------------------       00001100
      * HISTORY LOG:                                                    00002000
      *                                                                 00003000
      *----------------------------------------------------------       00004000
      * DATE:                                                           00005024
      * WR/IR#:                                                         00006024
      * PROGRAMMER:                                                     00007024
      * DESCRIPTION:                                                    00008025
      *                                                                 00009025
      *----------------------------------------------------------       00010000
       ENVIRONMENT DIVISION.                                            00020000
      *----------------------------------------------------------       00030000
       CONFIGURATION SECTION.                                           00040000
       SOURCE-COMPUTER. IBM-3090.                                       00050000
       OBJECT-COMPUTER. IBM-3090.                                       00060000
                                                                        00070000
       INPUT-OUTPUT SECTION.                                            00080000
                                                                        00090000
       FILE-CONTROL.                                                    00100000
                                                                        00110000
           SELECT NUMBER-OF-DAYS-FILE                                   00120000
               ASSIGN TO INP01.                                         00130000
                                                                        00140000
           SELECT CTG-TYP-FILE                                          00141001
               ASSIGN TO INP02.                                         00142000
006926                                                                  00143019
006926     SELECT DATE-CONTROL-CARD                                     00144018
006926         ASSIGN TO INP03.                                         00145018
                                                                        00146010
      *----------------------------------------------------------       00170000
       DATA DIVISION.                                                   00180000
      *----------------------------------------------------------       00190000
       FILE SECTION.                                                    00200000
                                                                        00280000
       FD  NUMBER-OF-DAYS-FILE                                          00290000
           RECORDING MODE IS F                                          00300000
           LABEL RECORDS ARE STANDARD                                   00310000
           RECORD CONTAINS 80 CHARACTERS                                00320000
           BLOCK CONTAINS 0 RECORDS                                     00330000
           DATA RECORD IS NUMBER-OF-DAYS-RECORD.                        00340006
       01  NUMBER-OF-DAYS-RECORD       PIC X(80).                       00350006
                                                                        00350100
       FD  CTG-TYP-FILE                                                 00350201
           RECORDING MODE IS F                                          00350300
           LABEL RECORDS ARE STANDARD                                   00350400
           RECORD CONTAINS 80 CHARACTERS                                00350500
           BLOCK CONTAINS 0 RECORDS                                     00350600
           DATA RECORD IS CTG-TYP-RECORD.                               00350701
       01  CTG-TYP-RECORD              PIC X(80).                       00350801
                                                                        00351000
006926 FD  DATE-CONTROL-CARD                                            00352018
006926     RECORDING MODE IS F                                          00353018
006926     LABEL RECORDS ARE STANDARD                                   00354018
006926     RECORD CONTAINS 80 CHARACTERS                                00355018
006926     BLOCK CONTAINS 0 RECORDS                                     00356018
006926     DATA RECORD IS DATE-CONTROL-RECORD.                          00357018
006926 01  DATE-CONTROL-RECORD         PIC X(80).                       00358018
006926                                                                  00359018
      *---------------------------------------------------------        00360000
                                                                        00370000
       WORKING-STORAGE SECTION.                                         00380000
006926*---------------------------------------------------------        00390019
006926*DATE CONTROL CARD LAYOUT                                         00392018
006926*---------------------------------------------------------        00393018
006926 01 CC-CONTROL-DATE.                                              00394018
006926    05 CC-DATE.                                                   00395018
006926       10  CC-CONTROL-YY              PIC  9(04) VALUE ZEROS.     00396018
006926       10  FILLER                     PIC  X(01) VALUE SPACE.     00397018
006926       10  CC-CONTROL-MM              PIC  9(02) VALUE ZEROS.     00398018
006926       10  FILLER                     PIC  X(01) VALUE SPACE.     00399018
006926       10  CC-CONTROL-DD              PIC  9(02) VALUE ZEROS.     00399118
006926       10  FILLER                     PIC  X(70) VALUE SPACE.     00399222
      *---------------------------------------------------------        00399312
      * PC- PROGRAM CONSTANTS                                           00400000
      *----------------------------------------------------------       00410000
       01  PC-PROGRAM-CONSTANTS.                                        00420000
           05  PC-PROGRAM-NAME              PIC X(08) VALUE 'PXKUT093'. 00430000
           05  PC-DAYS-FR                   PIC S9(3)  VALUE +0.        00440000
           05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00450000
           05  PC-NULL-VALUE                PIC S9(04) VALUE -1         00460000
                                                       COMP SYNC.       00470000
                                                                        00540000
      *----------------------------------------------------------       00550000
      * PS- PROGRAM SWITCHES                                            00560000
      *----------------------------------------------------------       00570000
       01  PS-PROGRAM-SWITCHES.                                         00580000
           05  PS-NUMBER-OF-DAYS-FILE-SW    PIC  X(01)  VALUE 'N'.      00620000
               88  PS-NUMBER-OF-DAYS-FILE-END           VALUE 'Y'.      00630000
               88  PS-NUMBER-OF-DAYS-FILE-START         VALUE 'N'.      00640000
           05  PS-CTG-TYP-FILE-SW           PIC  X(01)  VALUE 'N'.      00641001
               88  PS-CTG-TYP-FILE-END                  VALUE 'Y'.      00642001
               88  PS-CTG-TYP-FILE-START                VALUE 'N'.      00643001
           05  PS-PRCHG-FOUND-SW            PIC  X(01)  VALUE 'N'.      00644005
               88  PS-PRCHG-FOUND                       VALUE 'Y'.      00645005
               88  PS-PRCHG-NOT-FOUND                   VALUE 'N'.      00646005
006926     05  PS-END-OF-DATE-CONTROL-SW    PIC  X(01)  VALUE 'N'.      00647018
006926         88  PS-DATE-CONTROL-END                  VALUE 'Y'.      00648018
                                                                        00650000
      *----------------------------------------------------------       00660000
      * PV- PROGRAM VARIABLES                                           00670000
      *----------------------------------------------------------       00680000
       01 PV-PROGRAM-VARIABLES.                                         00740000
          05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 00750000
          05  PV-DB2-DATE                   PIC X(10).                  00760000
          05  PV-DAYS-FR-DATE               PIC X(10).                  00770000
          05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   00780000
          05  PV-EVNT-COUNT                 PIC S9(4)  VALUE +0 COMP.   00790001
                                                                        00900000
           05  PV-OPERATION-MSG             PIC  X(60)  VALUE SPACES.   00939000
           05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACES.   00940000
                                                                        01150000
      ***************************************************************** 01160000
      *  PARAMETER IN RECORD LAYOUT                                     01170000
      ***************************************************************** 01180000
      *01  PX035-PARAMETER-RECORD.                                      01190000
           COPY PXRD035.                                                01200000
                                                                        01201001
      ***************************************************************** 01202001
      *  PARAMETER IN RECORD LAYOUT                                     01203001
      ***************************************************************** 01204001
      *01  PX092-PARAMETER-RECORD.                                      01205007
           COPY PXRD092.                                                01206007
                                                                        01210000
      *----------------------------------------------------------       01220000
      * DATE ROUTINE COPY MEMBERS                                       01230000
      *----------------------------------------------------------       01240000
           COPY DPWS500.                                                01250000
                                                                        01260000
      *----------------------------------------------------------       01270000
      * VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         01280000
      *----------------------------------------------------------       01290000
           COPY DPWS004.                                                01300000
                                                                        01310000
      *---------------------------------------------                    01320000
      *  DB2 COMMUNICATION AREA.                                        01330000
      *---------------------------------------------                    01340000
           EXEC SQL                                                     01350000
                INCLUDE SQLCA                                           01360000
           END-EXEC.                                                    01370000
                                                                        01380000
           COPY SQLCA2.                                                 01390000
                                                                        01460000
      *---------------------------------------------                    01470000
      *  DB2 TABLE XST00063 (XST_PRCHG)                                 01471006
      *---------------------------------------------                    01472006
           EXEC SQL                                                     01473000
                INCLUDE XST00063                                        01474001
           END-EXEC.                                                    01475000
                                                                        01476000
      *---------------------------------------------                    01477000
      *  DB2 TABLE XST00064 (XST_STR_GP_PRCHG)                          01478006
      *---------------------------------------------                    01479000
           EXEC SQL                                                     01479100
                INCLUDE XST00064                                        01479201
           END-EXEC.                                                    01479300
                                                                        01560000
      *----------------------------------------------------------       01561000
       PROCEDURE DIVISION.                                              01562000
      *----------------------------------------------------------       01563000
       0000-MAINLINE.                                                   01564000
                                                                        01565000
           PERFORM 1000-INITIALIZATION.                                 01566000
                                                                        01566102
           PERFORM 2000-FIND-EVNT                                       01568002
              THRU 2000-EXIT                                            01569002
              UNTIL PS-CTG-TYP-FILE-END.                                01569102
                                                                        01569205
           PERFORM 9999-WRAPUP.                                         01580000
                                                                        01590000
           GOBACK.                                                      01600000
                                                                        01610000
      *0000-EXIT.                                                       01620000
       EJECT.                                                           01630000
                                                                        01640000
      *----------------------------------------------------------       01650000
      * 1000-INITIALIZATION.                                            01660000
      *     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            01670000
      *     UPDATE OR INSERT A RECORD.                                  01680000
      *----------------------------------------------------------       01690000
       1000-INITIALIZATION.                                             01700000
                                                                        01720000
           OPEN INPUT NUMBER-OF-DAYS-FILE.                              01730000
           OPEN INPUT CTG-TYP-FILE.                                     01740001
006926     OPEN INPUT DATE-CONTROL-CARD.                                01741018
                                                                        01750000
006926     READ DATE-CONTROL-CARD INTO CC-CONTROL-DATE                  01751018
006926         AT END                                                   01752018
006926             SET PS-DATE-CONTROL-END TO TRUE.                     01753018
006926                                                                  01754018
006926     IF PS-DATE-CONTROL-END                                       01755018
006926             MOVE 'DATE CONTROL CARD MISSING'                     01756018
006926                                 TO PV-OPERATION-MSG-1            01757018
006926             PERFORM Z910-ABEND                                   01759018
006926     END-IF.                                                      01759118
006926     DISPLAY PC-PROGRAM-NAME ' DATE CONTROL CARD:  '              01759218
006926             CC-CONTROL-DATE.                                     01759318
006926                                                                  01759418
           PERFORM 2010-COMPUTE-STRT-DTE                                01760000
              THRU 2010-EXIT.                                           01770000
                                                                        01930000
           PERFORM 2020-READ-CTG-TYP                                    01931001
              THRU 2020-EXIT.                                           01932001
                                                                        01932101
      *1100-EXIT.                                                       01933000
       EJECT.                                                           01934000
                                                                        01935000
      *----------------------------------------------------------       01936000
      * 2000-FIND-EVNT.                                                 01937001
      *     THIS LOOKS FOR AND EVENT WITH                               01938001
      *     1)  EVNT_CTG_CDE = CTG-CDE ON CTG-TYP-FILE                  01939001
      *     2)  PRCHG-TYP-CDE = TYP-CDE ON CTG-TYP-FILE                 01940001
      *     3)  PRCHG-EFF-DTE = CURRENT DATE + DAYS-FR-EVNT-NBR         01950001
      *   FINDING THE EVENT MEANS THE PROGRAM RETURNS 0.                01951001
      *   NOT FINDING THE EVENT MEANS THE PROGRAM RETURNS 4091.         01952001
      *----------------------------------------------------------       01960000
       2000-FIND-EVNT.                                                  01960101
                                                                        01960201
           MOVE PX092-CTG-CDE          TO XST00063-EVNT-CTG-CDE.        01960307
           MOVE PX092-TYP-CDE          TO XST00063-PRCHG-TYP-CDE.       01960407
           MOVE PV-DAYS-FR-DATE        TO XST00064-PRCHG-EFF-DTE.       01960501
                                                                        01960601
           EXEC SQL                                                     01961001
                SELECT COUNT(*)                                         01962001
                INTO  :PV-EVNT-COUNT                                    01965001
                FROM   XST_PRCHG         A                              01968001
                     , XST_STR_GP_PRCHG  B                              01968101
                WHERE  A.EVNT_CTG_CDE    =  :XST00063-EVNT-CTG-CDE      01969001
                  AND  A.PRCHG_TYP_CDE   =  :XST00063-PRCHG-TYP-CDE     01969101
                  AND  B.PRCHG_ID        =  A.PRCHG_ID                  01969201
                  AND  B.PRCHG_EFF_DTE   =  :XST00064-PRCHG-EFF-DTE     01969301
                  AND  A.LAST_ACTN_CDE   <> 'D'                         01969409
                  AND  B.LAST_ACTN_CDE   <> 'D'                         01969509
                WITH UR                                                 01969601
           END-EXEC.                                                    01969701
                                                                        01969801
           EVALUATE TRUE                                                01979501
              WHEN SQLCODE = +0                                         01979601
                  IF PV-EVNT-COUNT > 0                                  01979702
                      DISPLAY '*** FOUND ***'                           01979804
                      DISPLAY 'EVNT-CTG-CDE:  ' XST00063-EVNT-CTG-CDE   01979904
                      DISPLAY 'PRCHG-TYP-CDE: ' XST00063-PRCHG-TYP-CDE  01980004
                      DISPLAY 'PRCHG-EFF-DTE: ' XST00064-PRCHG-EFF-DTE  01980104
                      DISPLAY '***'                                     01980204
                      SET PS-PRCHG-FOUND TO TRUE                        01980305
                  ELSE                                                  01980405
                      DISPLAY '*** NOT FOUND ***'                       01980505
                      DISPLAY 'EVNT-CTG-CDE:  ' XST00063-EVNT-CTG-CDE   01980605
                      DISPLAY 'PRCHG-TYP-CDE: ' XST00063-PRCHG-TYP-CDE  01980705
                      DISPLAY 'PRCHG-EFF-DTE: ' XST00064-PRCHG-EFF-DTE  01980805
                      DISPLAY '***'                                     01980905
                  END-IF                                                01981001
              WHEN SQLCODE = +100                                       01981103
                DISPLAY '*** NOT FOUND ***'                             01981203
                DISPLAY 'EVNT-CTG-CDE:  ' XST00063-EVNT-CTG-CDE         01981303
                DISPLAY 'PRCHG-TYP-CDE: ' XST00063-PRCHG-TYP-CDE        01981403
                DISPLAY 'PRCHG-EFF-DTE: ' XST00064-PRCHG-EFF-DTE        01981503
                DISPLAY '***'                                           01981603
              WHEN SQLCODE = -304                                       01981708
                DISPLAY '*** FOUND ***'                                 01981908
                DISPLAY 'EVNT-CTG-CDE:  ' XST00063-EVNT-CTG-CDE         01982008
                DISPLAY 'PRCHG-TYP-CDE: ' XST00063-PRCHG-TYP-CDE        01982108
                DISPLAY 'PRCHG-EFF-DTE: ' XST00064-PRCHG-EFF-DTE        01982208
                DISPLAY '***'                                           01982308
                SET PS-PRCHG-FOUND TO TRUE                              01982408
              WHEN OTHER                                                01983201
                DISPLAY 'SELECT FAILED FOR TABLES'                      01983301
                DISPLAY 'EVNT-CTG-CDE:  ' XST00063-EVNT-CTG-CDE         01983401
                DISPLAY 'PRCHG-TYP-CDE: ' XST00063-PRCHG-TYP-CDE        01983501
                DISPLAY 'PRCHG-EFF-DTE: ' XST00064-PRCHG-EFF-DTE        01983601
                MOVE SQLCODE       TO RETURN-CODE                       01984002
                PERFORM U9980-SQL-ERROR                                 01986001
                  THRU U9980-EXIT                                       01987001
           END-EVALUATE.                                                01988001
                                                                        01988102
           READ CTG-TYP-FILE INTO PX092-PARAMETER-RECORD                01988207
              AT END                                                    01988302
                 SET PS-CTG-TYP-FILE-END TO TRUE                        01988402
           END-READ.                                                    01988502
                                                                        01989001
       2000-EXIT.                                                       02130002
       EJECT.                                                           02140000
                                                                        02150000
       2010-COMPUTE-STRT-DTE.                                           02160000
                                                                        02170000
           READ NUMBER-OF-DAYS-FILE INTO PX035-PARAMETER-RECORD         02180000
              AT END                                                    02190000
                 SET PS-NUMBER-OF-DAYS-FILE-END TO TRUE                 02200000
           END-READ.                                                    02210000
                                                                        02220000
           IF PS-NUMBER-OF-DAYS-FILE-END                                02230000
               MOVE 'NO DAY FILE TO PROCESS'                            02240000
                                       TO PV-OPERATION-MSG-1            02250000
               PERFORM Z910-ABEND                                       02260000
           ELSE                                                         02270000
               DISPLAY 'NBR-OF-DAYS = ' PX035-DAYS-FR-EVNT-NBR          02280000
           END-IF.                                                      02290000
                                                                        02300000
           IF PX035-SIGN = '+' OR PX035-SIGN = ' '                      02301000
               MOVE PX035-DAYS         TO PC-DAYS-FR                    02302000
           ELSE                                                         02303000
               COMPUTE PC-DAYS-FR = PX035-DAYS * -1                     02303100
           END-IF.                                                      02303200
                                                                        02303300
006926                                                                  02303718
006926     MOVE CC-DATE TO PV-DB2-DATE                                  02303818
           DISPLAY 'PV-DB2-DATE:  ' PV-DB2-DATE.                        02304216
                                                                        02304316
           IF PX035-SIGN = '+' OR PX035-SIGN = ' '                      02304416
               PERFORM 2011-INCREMENT-DATE                              02305000
                  THRU 2011-EXIT                                        02306000
           ELSE                                                         02307000
               PERFORM 2012-DECREMENT-DATE                              02308000
                  THRU 2012-EXIT                                        02309000
           END-IF.                                                      02310000
                                                                        02320000
       2010-EXIT.                                                       02330000
           EXIT.                                                        02340000
       EJECT.                                                           02350000
                                                                        02360000
       2011-INCREMENT-DATE.                                             02370000
                                                                        02380000
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02390000
           MOVE PV-DB2-DATE              TO DPG52-LK-DATE-INPUT.        02400000
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       02410000
           SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       02420000
           SET DPG51-INCREMENT-DATE      TO TRUE.                       02430000
           MOVE PC-DAYS-FR               TO DPG51-INCR-DECR-DAYS-9.     02440000
           PERFORM 9999-DATE-ROUTINE.                                   02450000
           MOVE DPG55-DB2-ISO-DATE-FMT   TO PV-DAYS-FR-DATE.            02460000
                                                                        02470000
           DISPLAY 'PV-DAYS-FR-DATE: ' PV-DAYS-FR-DATE.                 02480000
                                                                        02490000
       2011-EXIT.                                                       02491000
           EXIT.                                                        02491100
                                                                        02491200
       2012-DECREMENT-DATE.                                             02491300
                                                                        02491400
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02491500
           MOVE PV-DB2-DATE              TO DPG52-LK-DATE-INPUT.        02491600
           SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       02491700
           SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       02491800
           SET DPG51-DECREMENT-DATE      TO TRUE.                       02491900
           MOVE PC-DAYS-FR               TO DPG51-INCR-DECR-DAYS-9.     02492000
           PERFORM 9999-DATE-ROUTINE.                                   02493000
           MOVE DPG55-DB2-ISO-DATE-FMT   TO PV-DAYS-FR-DATE.            02493100
                                                                        02493200
           DISPLAY 'PV-DAYS-FR-DATE: ' PV-DAYS-FR-DATE.                 02493300
                                                                        02493400
       2012-EXIT.                                                       02493500
           EXIT.                                                        02493600
                                                                        02493701
       2020-READ-CTG-TYP.                                               02493801
                                                                        02493901
           READ CTG-TYP-FILE INTO PX092-PARAMETER-RECORD                02494007
              AT END                                                    02494101
                 SET PS-CTG-TYP-FILE-END TO TRUE                        02494201
           END-READ.                                                    02494301
                                                                        02494401
           IF PS-CTG-TYP-FILE-END                                       02494501
               MOVE 'NO CTG TYP FILE TO PROCESS'                        02494601
                                       TO PV-OPERATION-MSG-1            02494701
               PERFORM Z910-ABEND                                       02494801
           ELSE                                                         02494901
               DISPLAY 'CTG-CDE = ' PX092-CTG-CDE                       02495007
               DISPLAY 'TYP-CDE = ' PX092-TYP-CDE                       02495107
           END-IF.                                                      02495201
                                                                        02497301
       2020-EXIT.                                                       02497401
           EXIT.                                                        02497501
                                                                        02497600
       EJECT.                                                           02498000
                                                                        02783000
      *----------------------------------------------------------       02784000
      * 9999-WRAPUP.                                                    02785000
      *     MOVES ALL ERROR CODES TO THE LINKAGE VARIABLES TO           02786000
      *     BE PASSED BACK TO THE CALLING PROGRAM.  EXITS THE           02787000
      *     PROGRAM.                                                    02788000
      *----------------------------------------------------------       02789000
*                                                                       02790021
      *----------------------------------------------------------       02800000
       U9980-SQL-ERROR.                                                 02810000
      *----------------------------------------------------------       02820000
                                                                        02830000
           MOVE SQLCODE    TO SQLCODE2.                                 02840000
           MOVE SQLERRD(3) TO SQLERRD3.                                 02850000
           DISPLAY '** ABEND **       ** = SQLWARNING'.                 02860000
           DISPLAY '** PROGRAM        ** = PXKUT093'.                   02870000
           DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  02880000
           DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  02890000
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                   02900000
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  02910000
                                                                        02920000
           MOVE 4013 TO ABEND-CODE.                                     02930000
           CALL 'ILBOABN0' USING ABEND-CODE.                            02940000
                                                                        02950000
       U9980-EXIT.                                                      02960000
           EXIT.                                                        02970000
                                                                        02980000
      *----------------------------------------------------------       02990000
       U9990-SQL-WARNING.                                               03000000
      *----------------------------------------------------------       03010000
                                                                        03020000
           MOVE SQLCODE    TO SQLCODE2.                                 03030000
           MOVE SQLERRD(3) TO SQLERRD3.                                 03040000
           DISPLAY '** ABEND **       ** = SQLWARNING'.                 03050000
           DISPLAY '** PROGRAM        ** = PXKUT093'.                   03060000
                                                                        03070000
           MOVE 4013 TO ABEND-CODE.                                     03080000
           CALL 'ILBOABN0' USING ABEND-CODE.                            03090000
                                                                        03100000
       U9990-EXIT.                                                      03110000
           EXIT.                                                        03120000
                                                                        03130000
       9999-WRAPUP.                                                     03140000
           CLOSE NUMBER-OF-DAYS-FILE.                                   03150000
           CLOSE CTG-TYP-FILE.                                          03160001
006926     CLOSE DATE-CONTROL-CARD.                                     03161018
                                                                        03170005
           IF PS-PRCHG-NOT-FOUND                                        03180005
               MOVE +4091              TO RETURN-CODE                   03181005
           END-IF.                                                      03200005
                                                                        03210000
      *9999-EXIT.                                                       03220000
       EJECT.                                                           03230000
                                                                        03240000
      ******************************************************************03250000
      **RUN DATE ROUTINE                                                03260000
      ******************************************************************03270000
       9999-DATE-ROUTINE.                                               03280000
                                                                        03290000
           CALL DP500-KOHLS-CALENDAR-ROUTINE                            03300000
                      USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.        03310000
                                                                        03320000
           EVALUATE TRUE                                                03330000
                WHEN DPG54-NO-ERROR                                     03340000
                     CONTINUE                                           03350000
                WHEN OTHER                                              03360000
                   DISPLAY 'RETRIEVING END DATE...'                     03370000
                   DISPLAY DPG54-ERROR-MESSAGE                          03380000
                   PERFORM Z910-ABEND                                   03390000
           END-EVALUATE.                                                03400000
                                                                        03401000
      ******************************************************************03402000
      * Z910-ABEND - PERFORMS A NON-SQL-ABEND                          *03403000
      ******************************************************************03404000
       Z910-ABEND.                                                      03405000
                                                                        03406000
           DISPLAY '** ABEND           **'.                             03407000
      *    DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  03408000
      *    DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03409000
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03410000
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.       03420000
                                                                        03430000
           CALL 'ILBOABN0' USING ABEND-CODE.                            03440000
