000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   TRKUT220.                                          00050000
000600 AUTHOR.       MARGARET MORRISON.                                 00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. APRIL, 1998.                                       00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM EDITS ORIGIN RECEIVING DATA.  IT CREATES A FILE  *00120000
001300*  THAT CONTAINS EDITED UPDATE RECEVING RECORDS THAT WILL BE     *00130000
001400*  PASSED TO PROGRAM TRKUP225 WHICH WILL ACTUALLY UPDATE         *00140000
001401*  (ADD, CHANGE, DELETE) THE DB2 IMPORT RECEVING TABLES.         *00140100
001402*  THE PROGRAM ALSO CREATES A FILE THAT CONTAINS ERROR RECORDS   *00140200
001403*  THAT WILL BE PASSED TO THE ERROR REPORT PROGRAM.              *00140300
001404******************************************************************00140400
001405******************************************************************00140500
001406 ENVIRONMENT DIVISION.                                            00140600
001407******************************************************************00140700
001408                                                                  00140800
001409 CONFIGURATION SECTION.                                           00140900
001410                                                                  00141000
001420 SOURCE-COMPUTER.        IBM-3090.                                00142000
001430 OBJECT-COMPUTER.        IBM-3090.                                00143000
001440                                                                  00144000
001450 INPUT-OUTPUT SECTION.                                            00145000
001460                                                                  00146000
001470 FILE-CONTROL.                                                    00147000
001480                                                                  00148000
001490     SELECT TR015-RECEIVING-FILE                                  00149000
001500         ASSIGN TO INP01.                                         00150000
001600                                                                  00160000
001700     SELECT TR025-UPDATE-RECEIVING-FILE                           00170000
001800         ASSIGN TO OUT01.                                         00180000
001900                                                                  00190000
002000     SELECT TR221-RECEIVING-ERROR-FILE                            00200000
002100         ASSIGN TO OUT02.                                         00210000
002200                                                                  00220000
002300******************************************************************00230000
002400 DATA DIVISION.                                                   00240000
002500******************************************************************00250000
002600                                                                  00260000
002700 FILE SECTION.                                                    00270000
002800                                                                  00280000
002900 FD  TR015-RECEIVING-FILE                                         00290000
003000     RECORDING MODE IS F                                          00300000
003100     LABEL RECORDS ARE STANDARD                                   00310000
003200     BLOCK CONTAINS 0 RECORDS.                                    00320000
003300                                                                  00330000
003400 01  TR015-RECEIVING-RECORD          PIC X(300).                  00340000
003500                                                                  00350000
003600 FD  TR025-UPDATE-RECEIVING-FILE                                  00360000
003700     RECORDING MODE IS F                                          00370000
003800     LABEL RECORDS ARE STANDARD                                   00380000
003900     BLOCK CONTAINS 0 RECORDS.                                    00390000
004000                                                                  00400000
004100 01  TR025-UPDATE-RECEIVING-RECORD   PIC X(300).                  00410000
004200                                                                  00420000
004300 FD  TR221-RECEIVING-ERROR-FILE                                   00430000
004400     RECORDING MODE IS F                                          00440000
004410     LABEL RECORDS ARE STANDARD                                   00441000
004411     BLOCK CONTAINS 0 RECORDS.                                    00441100
004412                                                                  00441200
004413 01  TR221-RECEIVING-ERROR-RECORD    PIC X(254).                  00441300
004414                                                                  00441400
004415******************************************************************00441500
004416 WORKING-STORAGE SECTION.                                         00441600
004417******************************************************************00441700
004418                                                                  00441800
004419******************************************************************00441900
004420*  DB2 FORMATTED MESSAGE AREA                                     00442000
004430******************************************************************00443000
004440     COPY DPWS004.                                                00444000
004450                                                                  00445000
004460******************************************************************00446000
004470*  COMMUNICATIONS AREA FOR DB2                                    00447000
004480******************************************************************00448000
004490     EXEC SQL                                                     00449000
004500          INCLUDE SQLCA                                           00450000
004600     END-EXEC.                                                    00460000
004700                                                                  00470000
004800******************************************************************00480000
004900*  DB2 TABLE DECLARATION -  ET-TRADING PARTNERSHIP TABLE.         00490000
005000*      (TTRDPRT)                                                  00500000
005100******************************************************************00510000
005200     EXEC SQL                                                     00520000
005300          INCLUDE TTRDPRT                                         00530000
005400     END-EXEC.                                                    00540000
005500                                                                  00550000
005600******************************************************************00560000
005700*  DB2 TABLE DECLARATION -  ENTERPRISE NAME TABLE.                00570000
005800*      (TENTNME)                                                  00580000
005900******************************************************************00590000
006000     EXEC SQL                                                     00600000
006100          INCLUDE TENTNME                                         00610000
006200     END-EXEC.                                                    00620000
006300                                                                  00630000
006400******************************************************************00640000
006500*  IMPORT ORIGIN RECEIVING DATA LAYOUT                            00650000
006600******************************************************************00660000
006700     COPY TRRD015.                                                00670000
006800 EJECT                                                            00680000
006900                                                                  00690000
007000******************************************************************00700000
007100*  EDITED IMPORT ORIGIN RECEIVING DATA LAYOUT                     00710000
007200******************************************************************00720000
007300     COPY TRRD025.                                                00730000
007400 EJECT                                                            00740000
007500                                                                  00750000
007600******************************************************************00760000
007700*  RECEIVING REPORT RECORD LAYOUT - EXTRACT FOR THE ERROR REPORT.*00770000
007800*  IT IS USED TO FORMAT THE ERROR RECORDS.  THEY ARE THEN        *00780000
007900*  WRITTEN TO AN OUTPUT FILE.  THE ERRORS WILL BE COMBINED WITH  *00790000
008000*  ERRORS FROM PROGRAM TRKUP225 AND WILL LATER BE USED AS INPUT  *00800000
008100*  TO THE ERROR REPORT PROGRAM WHICH WILL CREATE AN ERROR REPORT *00810000
008200*  OF RECEIVING RECORDS.                                         *00820000
008300******************************************************************00830000
008400     COPY TRRD221.                                                00840000
008500 EJECT                                                            00850000
008600                                                                  00860000
008700     COPY DPWS500.                                                00870000
008800 EJECT                                                            00880000
008900                                                                  00890000
009000 01  PV-TR015-REC-TYP-ERD.                                        00900000
009100     05  PV-TR015-ERD-REC-KEY.                                    00910000
009200         10  PV-TR015-ERD-TRN-TYP          PIC X(01).             00920000
009300         10  PV-TR015-ERD-REC-TYP-CDE      PIC X(06).             00930000
009400         10  PV-TR015-ERD-SEQ-NBR          PIC X(02).             00940000
009500         10  PV-TR015-ERD-3RD-PARTY-CDE    PIC X(06).             00950000
009600         10  PV-TR015-ERD-PO-NBR           PIC 9(09).             00960000
009700         10  PV-TR015-ERD-PO-NBR-X REDEFINES                      00970000
009800             PV-TR015-ERD-PO-NBR           PIC X(09).             00980000
009900         10  PV-TR015-ERD-EXTL-REF-NBR     PIC X(15).             00990000
010000         10  PV-TR015-ERD-PO-RCVD-DELY-DTE PIC X(08).             01000000
010100         10  PV-TR015-ERD-PO-RCVD-DELY-TM  PIC X(04).             01010000
010200         10  PV-TR015-ERD-ORGN-SHPD-FR-CDE PIC X(03).             01020000
010300         10  PV-TR015-ERD-IMPRT-TRIP-ID    PIC X(10).             01030000
010400         10  PV-TR015-ERD-CARR-SCAC-ID     PIC X(04).             01040000
010500     05  PV-TR015-ERD-IMPRT-VEH-NM         PIC X(25).             01050000
010600     05  PV-TR015-ERD-POE-DELY-DTE         PIC X(08).             01060000
010700     05  PV-TR015-ERD-POE-DELY-TM          PIC X(04).             01070000
010800     05  PV-TR015-ERD-DPRTR-DTE            PIC X(08).             01080000
010900     05  PV-TR015-ERD-DPRTR-TM             PIC X(04).             01090000
011000     05  PV-TR015-ERD-FOB-CDE              PIC X(05).             01100000
011100     05  PV-TR015-ERD-DEST-POE-CDE         PIC X(04).             01110000
011200     05  PV-TR015-ERD-TRIP-TYP-CDE         PIC X(01).             01120000
011300     05  PV-TR015-ERD-EST-LBD-NM           PIC X(18).             01130000
011400     05  PV-TR015-ERD-FILLER               PIC X(131).            01140000
011410     05  PV-TR015-ERD-FILE-ID              PIC X(09).             01141000
011420     05  PV-TR015-ERD-ENT-ID               PIC 9(09).             01142000
011500     05  PV-TR015-ERD-PROC-SEQ-NBR         PIC 9(06).             01150000
011600                                                                  01160000
011700 01  PV-TR015-REC-TYP-ERDRSN.                                     01170000
011800     05  PV-TR015-ERDRSN-REC-KEY.                                 01180000
011900         10  PV-TR015-ERDRSN-TRN-TYP       PIC X(01).             01190000
012000         10  PV-TR015-ERDRSN-REC-TYP-CDE   PIC X(06).             01200000
012100         10  PV-TR015-ERDRSN-SEQ-NBR       PIC X(02).             01210000
012200         10  PV-TR015-ERDRSN-3RD-PARTY-CDE PIC X(06).             01220000
012300         10  PV-TR015-ERDRSN-PO-NBR        PIC 9(09).             01230000
012400         10  PV-TR015-ERDRSN-PO-NBR-X REDEFINES                   01240000
012500             PV-TR015-ERDRSN-PO-NBR        PIC X(09).             01250000
012600         10  PV-TR015-ERDRSN-EXTL-REF-NBR  PIC X(15).             01260000
012700         10  PV-TR015-ERDRSN-PO-RCV-DELY-DT PIC X(08).            01270000
012800         10  PV-TR015-ERDRSN-PO-RCV-DELY-TM PIC X(04).            01280000
012900         10  PV-TR015-ERDRSN-ORG-SHP-FR-CDE PIC X(03).            01290000
013000         10  PV-TR015-ERDRSN-IMPRT-TRIP-ID PIC X(10).             01300000
013100         10  PV-TR015-ERDRSN-CARR-SCAC-ID  PIC X(04).             01310000
013200     05  PV-TR015-ERDRSN-POE-DELY-DTE      PIC X(08).             01320000
013300     05  PV-TR015-ERDRSN-POE-DELY-TM       PIC X(04).             01330000
013400     05  PV-TR015-ERDRSN-DPRTR-DTE         PIC X(08).             01340000
013500     05  PV-TR015-ERDRSN-DPRTR-TM          PIC X(04).             01350000
013600     05  PV-TR015-ERDRSN-VOY-CHG-RSN-DS    PIC X(30).             01360000
013700     05  PV-TR015-ERDRSN-FILLER            PIC X(154).            01370000
013701     05  PV-TR015-ERDRSN-FILE-ID           PIC X(09).             01370100
013710     05  PV-TR015-ERDRSN-ENT-ID            PIC 9(09).             01371000
013800     05  PV-TR015-ERDRSN-PROC-SEQ-NBR      PIC 9(06).             01380000
013900                                                                  01390000
014000 01  PV-TR015-REC-TYP-LOG.                                        01400000
014100     05  PV-TR015-LOG-REC-KEY.                                    01410000
014200         10  PV-TR015-LOG-TRN-TYP          PIC X(01).             01420000
014300         10  PV-TR015-LOG-REC-TYP-CDE      PIC X(06).             01430000
014400         10  PV-TR015-LOG-SEQ-NBR          PIC X(02).             01440000
014500         10  PV-TR015-LOG-3RD-PARTY-CDE    PIC X(06).             01450000
014600         10  PV-TR015-LOG-PO-NBR           PIC 9(09).             01460000
014700         10  PV-TR015-LOG-PO-NBR-X REDEFINES                      01470000
014800             PV-TR015-LOG-PO-NBR           PIC X(09).             01480000
014900         10  PV-TR015-LOG-EXTL-REF-NBR     PIC X(15).             01490000
015000         10  PV-TR015-LOG-PO-RCVD-DELY-DTE PIC X(08).             01500000
015100         10  PV-TR015-LOG-PO-RCVD-DELY-TM  PIC X(04).             01510000
015200         05  PV-TR015-LOG-ORGN-SHPD-FR-CDE PIC X(03).             01520000
015300     05  PV-TR015-LOG-PROD-FCTRY-NM        PIC X(35).             01530000
015400     05  PV-TR015-LOG-C-O-PROD-CDE         PIC X(03).             01540000
015500     05  PV-TR015-LOG-PO-CART-CNT          PIC 9(09).             01550000
015600     05  PV-TR015-LOG-PO-CART-CNT-X REDEFINES                     01560000
015700         PV-TR015-LOG-PO-CART-CNT          PIC X(09).             01570000
015800     05  PV-TR015-LOG-PO-UNT-QTY           PIC 9(09).             01580000
015900     05  PV-TR015-LOG-PO-UNT-QTY-X REDEFINES                      01590000
016000         PV-TR015-LOG-PO-UNT-QTY           PIC X(09).             01600000
016100     05  PV-TR015-LOG-PO-CBMT-QTY          PIC 9(07)V99.          01610000
016200     05  PV-TR015-LOG-PO-CBMT-QTY-X REDEFINES                     01620000
016300         PV-TR015-LOG-PO-CBMT-QTY          PIC X(09).             01630000
016400     05  PV-TR015-LOG-PO-WT-KGRM-QTY       PIC 9(09).             01640000
016500     05  PV-TR015-LOG-PO-WT-KGRM-QTY-X REDEFINES                  01650000
016600         PV-TR015-LOG-PO-WT-KGRM-QTY       PIC X(09).             01660000
016700     05  PV-TR015-LOG-CONSOL-SCAC-ID       PIC X(04).             01670000
016800     05  PV-TR015-LOG-FILLER               PIC X(144).            01680000
016810     05  PV-TR015-LOG-FILE-ID              PIC X(09).             01681000
016820     05  PV-TR015-LOG-ENT-ID               PIC 9(09).             01682000
016900     05  PV-TR015-LOG-PROC-SEQ-NBR         PIC 9(06).             01690000
017000                                                                  01700000
017100 01  PV-TR015-REC-TYP-LOGVS.                                      01710000
017200     05  PV-TR015-LOGVS-REC-KEY.                                  01720000
017300         10  PV-TR015-LOGVS-TRN-TYP        PIC X(01).             01730000
017400         10  PV-TR015-LOGVS-REC-TYP-CDE    PIC X(06).             01740000
017500         10  PV-TR015-LOGVS-SEQ-NBR        PIC X(02).             01750000
017600         10  PV-TR015-LOGVS-3RD-PARTY-CDE  PIC X(06).             01760000
017700         10  PV-TR015-LOGVS-PO-NBR         PIC 9(09).             01770000
017800         10  PV-TR015-LOGVS-PO-NBR-X REDEFINES                    01780000
017900             PV-TR015-LOGVS-PO-NBR         PIC X(09).             01790000
018000         10  PV-TR015-LOGVS-EXTL-REF-NBR   PIC X(15).             01800000
018100         10  PV-TR015-LOGVS-PO-RCV-DELY-DTE PIC X(08).            01810000
018200         10  PV-TR015-LOGVS-PO-RCV-DELY-TM PIC X(04).             01820000
018300         10  PV-TR015-LOGVS-ORG-SHP-FR-CDE PIC X(03).             01830000
018400     05  PV-TR015-LOGVS-VS-NBR             PIC X(20).             01840000
018500     05  PV-TR015-LOGVS-CART-CNT           PIC 9(09).             01850000
018600     05  PV-TR015-LOGVS-CART-CNT-X REDEFINES                      01860000
018700         PV-TR015-LOGVS-CART-CNT           PIC X(09).             01870000
018800     05  PV-TR015-LOGVS-UNT-QTY            PIC 9(09).             01880000
018900     05  PV-TR015-LOGVS-UNT-QTY-X REDEFINES                       01890000
019000         PV-TR015-LOGVS-UNT-QTY            PIC X(09).             01900000
019100     05  PV-TR015-LOGVS-CBMT-QTY           PIC 9(07)V99.          01910000
019200     05  PV-TR015-LOGVS-CBMT-QTY-X REDEFINES                      01920000
019300         PV-TR015-LOGVS-CBMT-QTY           PIC X(09).             01930000
019400     05  PV-TR015-LOGVS-WT-KGRM-QTY        PIC 9(09).             01940000
019500     05  PV-TR015-LOGVS-WT-KGRM-QTY-X REDEFINES                   01950000
019600         PV-TR015-LOGVS-WT-KGRM-QTY        PIC X(09).             01960000
019700     05  PV-TR015-LOGVS-FILLER             PIC X(166).            01970000
019701     05  PV-TR015-LOGVS-FILE-ID            PIC X(09).             01970100
019710     05  PV-TR015-LOGVS-ENT-ID             PIC 9(09).             01971000
019800     05  PV-TR015-LOGVS-PROC-SEQ-NBR       PIC 9(06).             01980000
019900                                                                  01990000
020000 01  PV-TR015-REC-TYP-LOGUPC.                                     02000000
020100     05  PV-TR015-LOGUPC-REC-KEY.                                 02010000
020200         10  PV-TR015-LOGUPC-TRN-TYP       PIC X(01).             02020000
020300         10  PV-TR015-LOGUPC-REC-TYP-CDE   PIC X(06).             02030000
020400         10  PV-TR015-LOGUPC-SEQ-NBR       PIC X(02).             02040000
020500         10  PV-TR015-LOGUPC-3RD-PARTY-CDE PIC X(06).             02050000
020600         10  PV-TR015-LOGUPC-PO-NBR        PIC 9(09).             02060000
020700         10  PV-TR015-LOGUPC-PO-NBR-X REDEFINES                   02070000
020800             PV-TR015-LOGUPC-PO-NBR        PIC X(09).             02080000
020900         10  PV-TR015-LOGUPC-EXTL-REF-NBR  PIC X(15).             02090000
021000         10  PV-TR015-LOGUPC-PO-RCV-DELY-DT  PIC X(08).           02100000
021100         10  PV-TR015-LOGUPC-PO-RCV-DELY-TM  PIC X(04).           02110000
021200         10  PV-TR015-LOGUPC-ORG-SHP-FR-CDE  PIC X(03).           02120000
021300     05  PV-TR015-LOGUPC-VS-NBR            PIC X(20).             02130000
021400     05  PV-TR015-LOGUPC-UPC-NBR           PIC 9(15).             02140000
021500     05  PV-TR015-LOGUPC-UPC-NBR-X REDEFINES                      02150000
021600         PV-TR015-LOGUPC-UPC-NBR           PIC X(15).             02160000
021700     05  PV-TR015-LOGUPC-CART-CNT          PIC 9(09).             02170000
021800     05  PV-TR015-LOGUPC-CART-CNT-X REDEFINES                     02180000
021900         PV-TR015-LOGUPC-CART-CNT          PIC X(09).             02190000
022000     05  PV-TR015-LOGUPC-UNT-QTY           PIC 9(09).             02200000
022100     05  PV-TR015-LOGUPC-UNT-QTY-X REDEFINES                      02210000
022200         PV-TR015-LOGUPC-UNT-QTY           PIC X(09).             02220000
022300     05  PV-TR015-LOGUPC-CBMT-QTY          PIC 9(07)V99.          02230000
022400     05  PV-TR015-LOGUPC-CBMT-QTY-X REDEFINES                     02240000
022500         PV-TR015-LOGUPC-CBMT-QTY          PIC X(09).             02250000
022600     05  PV-TR015-LOGUPC-WT-KGRM-QTY       PIC 9(09).             02260000
022700     05  PV-TR015-LOGUPC-WT-KGRM-QTY-X REDEFINES                  02270000
022800         PV-TR015-LOGUPC-WT-KGRM-QTY       PIC X(09).             02280000
022900     05  PV-TR015-LOGUPC-FILLER            PIC X(151).            02290000
022901     05  PV-TR015-LOGUPC-FILE-ID           PIC X(09).             02290100
022910     05  PV-TR015-LOGUPC-ENT-ID            PIC 9(09).             02291000
023000     05  PV-TR015-LOGUPC-PROC-SEQ-NBR      PIC 9(06).             02300000
023100                                                                  02310000
023200                                                                  02320000
023300 01  ABEND-CODE                      PIC S9(04)    VALUE +0       02330000
023400                                                   COMP SYNC.     02340000
023500 01  PA-PROGRAM-ACCUMULATORS.                                     02350000
023600     05  PA-TOTALS.                                               02360000
023700         10 PA-RCVD-INPUT-COUNT       PIC  S9(09)  VALUE +0       02370000
023800                                                     COMP-3.      02380000
023900         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0       02390000
024000                                                     COMP-3.      02400000
024100         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0       02410000
024200                                                     COMP-3.      02420000
024300         10 PA-TOTAL-UPDATE-COUNT     PIC  S9(13)  VALUE +0       02430000
024400                                                     COMP-3.      02440000
024500         10 PA-TOT-RCPO-RECS-ADD      PIC  S9(13)  VALUE +0       02450000
024600                                                     COMP-3.      02460000
024700         10 PA-TOT-RCVS-RECS-ADD      PIC  S9(13)  VALUE +0       02470000
024800                                                     COMP-3.      02480000
024900         10 PA-TOT-RCUP-RECS-ADD      PIC  S9(13)  VALUE +0       02490000
025000                                                     COMP-3.      02500000
025100         10 PA-TOT-LOG-RECS-DELETE    PIC  S9(13)  VALUE +0       02510000
025200                                                     COMP-3.      02520000
025300         10 PA-TOT-RCPO-RECS-CHANGE   PIC  S9(13)  VALUE +0       02530000
025400                                                     COMP-3.      02540000
025500         10 PA-TOT-RCVS-RECS-CHANGE   PIC  S9(13)  VALUE +0       02550000
025600                                                     COMP-3.      02560000
025700         10 PA-TOT-RCUP-RECS-CHANGE   PIC  S9(13)  VALUE +0       02570000
025800                                                     COMP-3.      02580000
025900         10 PA-TOT-RCPO-RECS-CHG-ADD  PIC  S9(13)  VALUE +0       02590000
026000                                                     COMP-3.      02600000
026100         10 PA-TOT-RCVS-RECS-CHG-ADD  PIC  S9(13)  VALUE +0       02610000
026200                                                     COMP-3.      02620000
026300         10 PA-TOT-RCUP-RECS-CHG-ADD  PIC  S9(13)  VALUE +0       02630000
026400                                                     COMP-3.      02640000
026500                                                                  02650000
026600 01  PA-PROGRAM-SWITCHES.                                         02660000
026700     05  PS-END-OF-INPUT-SW            PIC  X(01)    VALUE 'N'.   02670000
026800         88  PS-END-OF-INPUT                         VALUE 'Y'.   02680000
026900         88  PS-END-OF-INPUT-NO                      VALUE 'N'.   02690000
027000     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.   02700000
027100         88  PS-EDIT-ERROR                           VALUE 'Y'.   02710000
027200         88  PS-EDIT-ERROR-NO                        VALUE 'N'.   02720000
027300     05  PS-EDI-RECORD-SW              PIC  X(01)    VALUE 'N'.   02730000
027400         88  PS-EDI-RECORD                           VALUE 'Y'.   02740000
027500         88  PS-EDI-RECORD-NO                        VALUE 'N'.   02750000
027600     05  PS-GOOD-RECORD-SW             PIC  X(01)    VALUE 'N'.   02760000
027700         88  PS-GOOD-RECORD                          VALUE 'Y'.   02770000
027800         88  PS-GOOD-RECORD-NO                       VALUE 'N'.   02780000
027900     05  PS-GOOD-ERD-LOG-WRITE-SW      PIC  X(01)    VALUE 'N'.   02790000
028000         88  PS-GOOD-ERD-LOG-WRITE                   VALUE 'Y'.   02800000
028100         88  PS-GOOD-ERD-LOG-WRITE-NO                VALUE 'N'.   02810000
028200     05  PS-GOOD-LOGVS-WRITE-SW        PIC  X(01)    VALUE 'N'.   02820000
028300         88  PS-GOOD-LOGVS-WRITE                     VALUE 'Y'.   02830000
028400         88  PS-GOOD-LOGVS-WRITE-NO                  VALUE 'N'.   02840000
028500     05  PS-SAME-INPUT-FIELDS-SW       PIC  X(01)    VALUE 'N'.   02850000
028600         88  PS-SAME-INPUT-FIELDS                    VALUE 'Y'.   02860000
028700         88  PS-NOT-SAME-INPUT-FIELDS                VALUE 'N'.   02870000
028800     05  PS-ERD-SENT-SW                PIC  X(01)    VALUE 'N'.   02880000
028900         88  PS-ERD-SENT                             VALUE 'Y'.   02890000
029000         88  PS-ERD-NOT-SENT                         VALUE 'N'.   02900000
029100     05  PS-ERDRSN-SENT-SW             PIC  X(01)    VALUE 'N'.   02910000
029200         88  PS-ERDRSN-SENT                          VALUE 'Y'.   02920000
029300         88  PS-ERDRSN-NOT-SENT                      VALUE 'N'.   02930000
029400     05  PS-LOG-SENT-SW                PIC  X(01)    VALUE 'N'.   02940000
029500         88  PS-LOG-SENT                             VALUE 'Y'.   02950000
029600         88  PS-LOG-NOT-SENT                         VALUE 'N'.   02960000
029700     05  PS-LOGVS-SENT-SW              PIC  X(01)    VALUE 'N'.   02970000
029800         88  PS-LOGVS-SENT                           VALUE 'Y'.   02980000
029900         88  PS-LOGVS-NOT-SENT                       VALUE 'N'.   02990000
030000     05  PS-LOG-DELETE-SENT-SW         PIC  X(01)    VALUE 'N'.   03000000
030100         88  PS-LOG-DELETE-SENT                      VALUE 'Y'.   03010000
030200         88  PS-LOG-DELETE-NOT-SENT                  VALUE 'N'.   03020000
030300     05  PS-NEW-RECEIVING-SW           PIC  X(01)    VALUE 'N'.   03030000
030400         88  PS-NEW-RECEIVING                        VALUE 'Y'.   03040000
030500         88  PS-NEW-RECEIVING-NO                     VALUE 'N'.   03050000
030600     05  PS-NEW-GROUP-SW               PIC  X(01)    VALUE 'N'.   03060000
030700         88  PS-NEW-GROUP                            VALUE 'Y'.   03070000
030800         88  PS-NEW-GROUP-NO                         VALUE 'N'.   03080000
030900     05  PS-NEW-VS-SW                  PIC  X(01)    VALUE 'N'.   03090000
031000         88  PS-NEW-VS                               VALUE 'Y'.   03100000
031100         88  PS-NEW-VS-NO                            VALUE 'N'.   03110000
031200     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.   03120000
031300         88  PS-NEW-UPC                              VALUE 'Y'.   03130000
031400         88  PS-NEW-UPC-NO                           VALUE 'N'.   03140000
031500     05  PS-FIELDS-OK-SW               PIC  X(01)    VALUE 'N'.   03150000
031600         88  PS-FIELDS-OK                            VALUE 'Y'.   03160000
031700         88  PS-FIELDS-NOT-OK                        VALUE 'N'.   03170000
031800     05  PS-WARNING-TIME-SW            PIC  X(01)    VALUE 'N'.   03180000
031900         88  PS-WARNING-TIME                         VALUE 'Y'.   03190000
032000         88  PS-WARNING-TIME-NO                      VALUE 'N'.   03200000
032100     05  PS-WARNING-DATE-SW            PIC  X(01)    VALUE 'N'.   03210000
032200         88  PS-WARNING-DATE                         VALUE 'Y'.   03220000
032300         88  PS-WARNING-DATE-NO                      VALUE 'N'.   03230000
032400     05  PS-ENTNME-SW                  PIC X(01)     VALUE 'Y'.   03240000
032500         88  PS-VALID-ENTNME                         VALUE 'Y'.   03250000
032600         88  PS-INVALID-ENTNME                       VALUE 'N'.   03260000
032700     05  PS-TRN-TYP-ADD-SW             PIC  X(01)    VALUE 'N'.   03270000
032800         88  PS-TRN-TYP-ADD                          VALUE 'Y'.   03280000
032900         88  PS-TRN-TYP-ADD-NO                       VALUE 'N'.   03290000
033000                                                                  03300000
033100 01  PC-PROGRAM-CONSTANTS.                                        03310000
033200     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          03320000
033300         'TRKUT220'.                                              03330000
033400     05  PC-01                       PIC X(02)     VALUE '01'.    03340000
033500     05  PC-10                       PIC X(02)     VALUE '10'.    03350000
033600     05  PC-11                       PIC X(02)     VALUE '11'.    03360000
033700     05  PC-19                       PIC X(02)     VALUE '19'.    03370000
033800     05  PC-20                       PIC X(02)     VALUE '20'.    03380000
033900     05  PC-21                       PIC X(02)     VALUE '21'.    03390000
034000     05  PC-22                       PIC X(02)     VALUE '22'.    03400000
034100     05  PC-98                       PIC X(02)     VALUE '98'.    03410000
034200     05  PC-99                       PIC X(02)     VALUE '99'.    03420000
034300     05  PC-A                        PIC X(01)     VALUE 'A'.     03430000
034400     05  PC-B                        PIC X(01)     VALUE 'B'.     03440000
034500     05  PC-C                        PIC X(01)     VALUE 'C'.     03450000
034600     05  PC-D                        PIC X(01)     VALUE 'D'.     03460000
034700     05  PC-E                        PIC X(01)     VALUE 'E'.     03470000
034800     05  PC-M                        PIC X(01)     VALUE 'M'.     03480000
034900     05  PC-O                        PIC X(01)     VALUE 'O'.     03490000
035000     05  PC-Z                        PIC X(01)     VALUE 'Z'.     03500000
035100     05  PC-A0                       PIC X(02)     VALUE 'A0'.    03510000
035200     05  PC-CFS                      PIC X(03)     VALUE 'CFS'.   03520000
035300     05  PC-CY                       PIC X(02)     VALUE 'CY'.    03530000
035400                                                                  03540000
035500     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.   03550000
035600     05  PC-IEA                      PIC X(06)     VALUE 'IEA   '.03560000
035700     05  PC-ERD                      PIC X(06)     VALUE 'ERD   '.03570000
035800     05  PC-ERDRSN                   PIC X(06)     VALUE 'ERDRSN'.03580000
035900     05  PC-LOG                      PIC X(06)     VALUE 'LOG   '.03590000
036000     05  PC-LOGVS                    PIC X(06)     VALUE 'LOGVS '.03600000
036100     05  PC-LOGUPC                   PIC X(06)     VALUE 'LOGUPC'.03610000
036200                                                                  03620000
036300     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   03630000
036400     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   03640000
036500     05  PC-EMPTY                    PIC X(03)     VALUE 'EMT'.   03650000
036600     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.03660000
036700     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.   03670000
036800     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.   03680000
036900     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.   03690000
037000     05  PC-DASH                     PIC X(01)     VALUE '-'.     03700000
037100     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE          03710000
037200                                     '9999-09-09-00.00.00.000000'.03720000
037300     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          03730000
037400                                     '0001-01-01-00.00.00.000000'.03740000
037500     05  PC-DEFAULT-DTE              PIC X(10)     VALUE          03750000
037600                                     '0001-01-01'.                03760000
037700     05  PC-DEFAULT-DATE             PIC X(08)     VALUE          03770000
037800                                     '00010101'.                  03780000
037900     05  PC-DEFAULT-TIME             PIC X(04)     VALUE          03790000
038000                                     '0000'.                      03800000
038100     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5       03810000
038200                                                     COMP-3.      03820000
038300                                                                  03830000
038400 01  PV-PROGRAM-VARIABLES.                                        03840000
038500     05  PV-RCVD-DELY-DTE            PIC X(08)     VALUE SPACES.  03850000
038600     05  PV-RCVD-DELY-TM             PIC X(04)     VALUE SPACES.  03860000
038700     05  PV-HOLD-DPRTR-DTE           PIC X(08)     VALUE SPACES.  03870000
038800     05  PV-HOLD-DPRTR-TM            PIC X(04)     VALUE SPACES.  03880000
038900     05  PV-HOLD-POE-DELY-DTE        PIC X(08)     VALUE SPACES.  03890000
039000     05  PV-HOLD-POE-DELY-TM         PIC X(04)     VALUE SPACES.  03900000
039100     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0       03910000
039200                                                   COMP.          03920000
039201     05  PV-ENT-ID-SIGNED            PIC S9(09)    VALUE +0       03920100
039210                                                   COMP.          03921000
039300     05  PV-VEND-ID-QUAL             PIC X(02)     VALUE SPACES.  03930000
039400     05  PV-VEND-ID                  PIC X(15)     VALUE SPACES.  03940000
039500     05  PV-HOLD-TR221-RPT-TYP       PIC X(01)     VALUE SPACES.  03950000
039600     05  PV-HOLD-TR221-REC-TYP       PIC X(06).                   03960000
039700         88  PV-HOLD-TR221-REC-TYP-ERD             VALUE 'ERD   '.03970000
039800         88  PV-HOLD-TR221-REC-TYP-ERDRSN          VALUE 'ERDRSN'.03980000
039900         88  PV-HOLD-TR221-REC-TYP-LOG             VALUE 'LOG   '.03990000
040000         88  PV-HOLD-TR221-REC-TYP-LOGVS           VALUE 'LOGVS '.04000000
040100         88  PV-HOLD-TR221-REC-TYP-LOGUPC          VALUE 'LOGUPC'.04010000
040200     05  PV-HOLD-TR221-PO-NBR        PIC 9(09).                   04020000
040300     05  PV-HOLD-TR221-PO-NBR-X REDEFINES                         04030000
040400         PV-HOLD-TR221-PO-NBR        PIC X(09).                   04040000
040500     05  PV-HOLD-TR221-EXTL-REF-NBR  PIC X(15)     VALUE SPACES.  04050000
040600     05  PV-HOLD-TR221-PO-RCVD-DELY-DTE PIC X(08)  VALUE SPACES.  04060000
040700     05  PV-HOLD-TR221-PO-RCVD-DELY-TM  PIC X(04)  VALUE SPACES.  04070000
040800     05  PV-HOLD-TR221-ORGN-SHPD-FR-CDE PIC X(03)  VALUE SPACES.  04080000
040900     05  PV-HOLD-TR221-TRN-TYP       PIC X(01)     VALUE SPACES.  04090000
041000     05  PV-HOLD-TR221-DATA-IN-ERROR PIC X(15)     VALUE SPACES.  04100000
041100     05  PV-HOLD-TR221-ERROR-TYPE     PIC X(03)    VALUE SPACES.  04110000
041200     05  PV-HOLD-TR221-DATA-VALUE-NUM.                            04120000
041300         10 PV-HOLD-TR221-DATA-VALUE-X PIC 9(02)   VALUE ZEROES.  04130000
041400         10 PV-HOLD-TR221-DATA-VALUE-N PIC 9(15)V9(3) VALUE ZERO. 04140000
041500     05  PV-HOLD-TR221-DATA-VALUE REDEFINES                       04150000
041600         PV-HOLD-TR221-DATA-VALUE-NUM PIC X(20).                  04160000
041700     05  PV-HOLD-TR221-ERROR-MSG      PIC X(50)    VALUE SPACES.  04170000
041800                                                                  04180000
041900     05  PV-HOLD-PO-NBR-SELECT       PIC S9(09)    VALUE ZEROS    04190000
042000                                                   COMP.          04200000
042100     05  PV-EXTL-REF-NBR-SELECT      PIC X(15)     VALUE SPACES.  04210000
042200     05  PV-HOLD-UPC-NBR-SELECT      PIC S9(15)V   VALUE ZEROS    04220000
042300                                                   COMP-3.        04230000
042400     05  PV-HOLD-PO-NBR              PIC S9(09).                  04240000
042401     05  PV-HOLD-PO-NBR-X REDEFINES                               04240100
042410         PV-HOLD-PO-NBR              PIC X(09).                   04241000
042500     05  PV-HOLD-EXTL-REF-NBR        PIC X(15)     VALUE SPACES.  04250000
042600     05  PV-HOLD-PO-RCVD-DELY-DTE    PIC X(08)     VALUE SPACES.  04260000
042700     05  PV-HOLD-PO-RCVD-DELY-TM     PIC X(04)     VALUE SPACES.  04270000
042800     05  PV-HOLD-ORGN-SHPD-FR-CDE    PIC X(03)     VALUE SPACES.  04280000
042900     05  PV-HOLD-VS-NBR              PIC X(20)     VALUE SPACES.  04290000
043000     05  PV-HOLD-UPC-NBR             PIC S9(15)V   VALUE ZEROS    04300000
043100                                                   COMP-3.        04310000
043200     05  PV-HOLD-LAST-TRN-TYP        PIC X(01)     VALUE SPACES.  04320000
043300     05  PV-HOLD-LAST-REC-TYP        PIC X(06)     VALUE SPACES.  04330000
043600                                                                  04360000
043700     05  PV-EVAL-TRN-TYP-CDE         PIC X(01).                   04370000
043800         88  TRN-TYP-ADD                           VALUE 'A'.     04380000
043900         88  TRN-TYP-CHG                           VALUE 'C'.     04390000
044000         88  TRN-TYP-DEL                           VALUE 'D'.     04400000
044100                                                                  04410000
044200     05  PV-HOLD-REC-TYP-CDE         PIC X(06).                   04420000
044300         88  REC-TYP-ERD                           VALUE 'ERD   '.04430000
044400         88  REC-TYP-ERDRSN                        VALUE 'ERDRSN'.04440000
044500         88  REC-TYP-LOG                           VALUE 'LOG   '.04450000
044600         88  REC-TYP-LOGVS                         VALUE 'LOGVS '.04460000
044700         88  REC-TYP-LOGUPC                        VALUE 'LOGUPC'.04470000
044800         88  REC-TYP-ERD-LOG                       VALUE 'ERD   ',04480000
044900                                                         'ERDRSN',04490000
045000                                                         'LOG   '.04500000
045100                                                                  04510000
045200     05  PV-CHECK-REC-TYP-CDE        PIC X(06).                   04520000
045300         88  VALID-REC-TYP-CDE                     VALUE 'ERD   ',04530000
045400                                                         'ERDRSN',04540000
045500                                                         'LOG   ',04550000
045600                                                         'LOGVS ',04560000
045700                                                         'LOGUPC',04570000
045800                                                         'CTT   ',04580000
045900                                                         'IEA   ',04590000
046000                                                         'ISA   '.04600000
046100     05  PV-EDI-RECORDS              PIC  X(03).                  04610000
046200         88  EDI-RECORD                            VALUE 'CTT',   04620000
046300                                                         'IEA',   04630000
046400                                                         'ISA'.   04640000
046500         88  EDI-IEA-RECORD                        VALUE 'IEA'.   04650000
046600                                                                  04660000
046700     05  PV-HOLD-EDI-RECORD.                                      04670000
046800         10  FILLER                  PIC X(32)     VALUE SPACES.  04680000
046900         10  PV-EDI-VEND-ID-QUAL     PIC X(02)     VALUE SPACES.  04690000
047000         10  FILLER                  PIC X(01)     VALUE SPACES.  04700000
047100         10  PV-EDI-VEND-ID          PIC X(15)     VALUE SPACES.  04710000
047200         10  FILLER                  PIC X(20)     VALUE SPACES.  04720000
047300         10  PV-EDI-CONSOL-TRNS-DTE  PIC X(06)     VALUE SPACES.  04730000
047400         10  FILLER                  PIC X(01)     VALUE SPACES.  04740000
047500         10  PV-EDI-CONSOL-TRNS-TM   PIC X(04)     VALUE SPACES.  04750000
047600         10  FILLER                  PIC X(09)     VALUE SPACES.  04760000
047700         10  PV-EDI-CONSOL-FIL-ID    PIC X(09)     VALUE SPACES.  04770000
047800         10  FILLER                  PIC X(51)     VALUE SPACES.  04780000
047802         10  PV-EDI-FILE-ID          PIC X(09)     VALUE SPACES.  04780200
047803         10  PV-EDI-ENT-ID           PIC X(09)     VALUE SPACES.  04780300
047804         10  PV-EDI-ENT-ID-9    REDEFINES                         04780400
047805             PV-EDI-ENT-ID           PIC 9(09).                   04780500
047810         10  FILLER                  PIC X(132)    VALUE SPACES.  04781000
047900                                                                  04790000
048000     05  PV-TMST                     PIC X(26)     VALUE SPACES.  04800000
048100     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.  04810000
048200     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.  04820000
048300     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0       04830000
048400                                                    COMP SYNC.    04840000
048500                                                                  04850000
048600     05  PV-FORMAT-TMST.                                          04860000
048700         10  PV-FORMAT-TMST-DTE.                                  04870000
048800             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  04880000
048900             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.     04890000
049000             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  04900000
049100             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.     04910000
049200             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  04920000
049300             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.     04930000
049400         10  PV-FORMAT-TMST-TM.                                   04940000
049500             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  04950000
049600             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.     04960000
049700             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  04970000
049800             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE          04980000
049900                                                     '.00.000000'.04990000
050000     05  PV-FORMAT-RCDT.                                          05000000
050100         10  PV-FORMAT-RCDT-DTE-CY  PIC X(04)  VALUE SPACES.      05010000
050200         10  PV-FORMAT-RCDT-DTE-D1  PIC X(01)  VALUE '-'.         05020000
050300         10  PV-FORMAT-RCDT-DTE-MM  PIC X(02)  VALUE SPACES.      05030000
050400         10  PV-FORMAT-RCDT-DTE-D2  PIC X(01)  VALUE '-'.         05040000
050500         10  PV-FORMAT-RCDT-DTE-DD  PIC X(02)  VALUE SPACES.      05050000
050600         10  PV-FORMAT-RCDT-DTE-D3  PIC X(01)  VALUE '-'.         05060000
050700         10  PV-FORMAT-RCDT-TM-HH   PIC X(02)  VALUE SPACES.      05070000
050800         10  PV-FORMAT-RCDT-TM-D1   PIC X(01)  VALUE '.'.         05080000
050900         10  PV-FORMAT-RCDT-TM-MM   PIC X(02)  VALUE SPACES.      05090000
051000         10  PV-FORMAT-RCDT-TM-D2   PIC X(10)  VALUE '.00.000000'.05100000
051100                                                                  05110000
051200     05  PV-REFORMAT-TMST.                                        05120000
051300         10  PV-REFORMAT-TMST-DTE.                                05130000
051400             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.05140000
051500             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.05150000
051600             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.05160000
051700         10  PV-REFORMAT-TMST-TM.                                 05170000
051800             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.05180000
051900             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.05190000
052000                                                                  05200000
052100     05  PV-HDR-CONSOL-TRNS-DTE.                                  05210000
052200         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.05220000
052300         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.05230000
052400                                                                  05240000
052500******************************************************************05250000
052600 LINKAGE SECTION.                                                 05260000
052700******************************************************************05270000
052800                                                                  05280000
052900******************************************************************05290000
053000 PROCEDURE DIVISION.                                              05300000
053100******************************************************************05310000
053200******************************************************************05320000
053300*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *05330000
053400******************************************************************05340000
053500 0000-PROGRAM-MAINLINE.                                           05350000
053600                                                                  05360000
053700     PERFORM 1000-INITIALIZE.                                     05370000
053800                                                                  05380000
053900     PERFORM 2000-PROCESS-RCVD-RECORDS                            05390000
054000         UNTIL PS-END-OF-INPUT.                                   05400000
054100                                                                  05410000
054200     PERFORM 8000-EOJ-ROUTINE.                                    05420000
054300     STOP RUN.                                                    05430000
054400                                                                  05440000
054500******************************************************************05450000
054600*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *05460000
054700*  JOB PROCESSES.                                                *05470000
054800******************************************************************05480000
054900 1000-INITIALIZE.                                                 05490000
055000                                                                  05500000
055100     OPEN INPUT TR015-RECEIVING-FILE                              05510000
055200         OUTPUT TR025-UPDATE-RECEIVING-FILE                       05520000
055300                TR221-RECEIVING-ERROR-FILE.                       05530000
055400                                                                  05540000
055500     SET PS-GOOD-RECORD-NO TO TRUE.                               05550000
055600                                                                  05560000
055700     MOVE PC-IEA TO PV-HOLD-LAST-REC-TYP.                         05570000
055800                                                                  05580000
055900     PERFORM 6000-READ-RECEIVING-FILE                             05590000
056000         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                 05600000
056100     SET PS-GOOD-RECORD-NO TO TRUE.                               05610000
056200                                                                  05620000
056300     IF PS-END-OF-INPUT                                           05630000
056400         MOVE PC-EMPTY       TO PV-HOLD-TR221-ERROR-TYPE          05640000
056500     END-IF.                                                      05650000
056600                                                                  05660000
056700 EJECT                                                            05670000
056800******************************************************************05680000
056900* MAIN PROCESSING PARAGRAPH.                                     *05690000
057000* THE INCOMING RECORD TYPE CODE IS EVALUATED AND PROCESSED AS    *05700000
057100* FOLLOWS:                                                       *05710000
057200*  REC-TYP-ERD-LOG (ERD, ERDRSN, & LOG)                          *05720000
057300*       THESE RECORD TYPES PERFORM THE PURCHASE ORDER LEVEL      *05730000
057400*       PROCESSING PARAGRAPHS (PARA 3000- THRU 3125-) DEPENDING  *05740000
057500*       ON WHAT TRANS TYPE THEY ARE (ADD, CHANGE, OR DELETE).    *05750000
057600*                                                                *05760000
057700*  REC-TYP-LOGVS                                                 *05770000
057800*       THIS RECORD TYPE PERFORMS THE VENDOR STYLE LEVEL         *05780000
057900*       PROCESSING PARAGRAPHS (PARA 3200- THRU 3300-) DEPENDING  *05790000
058000*       ON WHAT TRAN TYPE IT IS (ADD, CHANGE, OR DELETE).        *05800000
058100*       FOR THIS RECORD TYPE TO BEGIN PROCESSING THE             *05810000
058200*       FOLLOWING CONDITIONS MUST BE MET:                        *05820000
058300*        -- A GOOD WRITE TO THE EDITED UPDATE EXTRACT FILE MUST  *05830000
058400*           HAVE OCCURED FOR THE ERD AND LOG RECORDS.            *05840000
058500*             IF NOT -- AN ERROR FOR EACH RECORD BELONGING TO    *05850000
058600*                       THIS PO IS WRITTEN TO THE ERROR FILE AS  *05860000
058700*                       THE PROGRAM READS TO THE NEXT PO.        *05870000
058800*        -- CERTAIN KEY NUMERIC FIELDS ARE EDITED AND MUST PASS  *05880000
058900*           THE EDIT CONDITIONS                                  *05890000
059000*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *05900000
059100*                       AND THE PROGRAM READS TO THE NEXT VS.    *05910000
059200*        -- THE PO NBR, EXTERNAL REFERENCE NUMBER, TRAN TYPE,    *05920000
059300*           RECEIVED DELIVERY DATA/TIME, AND ORIGIN SHIPPED FROM *05930000
059400*           CODE OF THE INCOMING RECORD MUST EQUAL THE HOLD      *05940000
059500*           FIELDS                                               *05950000
059600*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *05960000
059700*                       AND THE PROGRAM READS TO THE NEXT VS.    *05970000
059800*                                                                *05980000
059900*  REC-TYP-LOGUPC                                                *05990000
060000*       THESE RECORD TYPES PERFORM THE UPC LEVEL PROCESSING      *06000000
060100*       PARAGRAPHS (PARA 3400- THRU 3485-) DEPENDING ON WHAT     *06010000
060200*       TRAN TYPE THEY ARE (ADD, CHANGE, OR DELETE).             *06020000
060300*       FOR THIS RECORD TYPE TO BEGIN PROCESSING THE             *06030000
060400*       FOLLOWING CONDITIONS MUST BE MET:                        *06040000
060500*        -- A GOOD WRITE TO THE EDITED UPDATE EXTRACT FILE MUST  *06050000
060600*           HAVE OCCURED FOR THE ERD AND LOG RECORDS.            *06060000
060700*             IF NOT -- AN ERROR FOR EACH RECORD BELONGING TO    *06070000
060800*                       THIS PO IS WRITTEN TO THE ERROR FILE AS  *06080000
060900*                       THE PROGRAM READS TO THE NEXT PO.        *06090000
061000*        -- A GOOD WRITE TO THE EDITED UPDATE EXTRACT FILE MUST  *06100000
061100*           HAVE OCCURED FOR THE LOGVS RECORDS.                  *06110000
061200*             IF NOT -- AN ERROR FOR EACH RECORD BELONGING TO    *06120000
061300*                       THIS VS IS WRITTEN TO THE ERROR FILE AS  *06130000
061400*                       THE PROGRAM READS TO THE NEXT VS.        *06140000
061500*        -- CERTAIN KEY NUMERIC FIELDS ARE EDITED AND MUST PASS  *06150000
061600*           THE EDIT CONDITIONS                                  *06160000
061700*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *06170000
061800*                       AND THE PROGRAM READS TO THE NEXT UPC.   *06180000
061900*        -- THE PO NBR, EXTERNAL REFERENCE NUMBER, TRAN TYPE,    *06190000
062000*           RECEIVED DELIVERY DATE/TIME, ORIGIN SHIPPED FROM CODE*06200000
062100*           AND VS NBR OF THE INCOMING RECORD MUST EQUAL THE     *06210000
062200*           HOLD FIELDS                                          *06220000
062300*             IF NOT -- AN ERROR IS WRITTEN TO THE ERROR FILE    *06230000
062400*                       AND THE PROGRAM READS TO THE NEXT UPC.   *06240000
062500******************************************************************06250000
062600 2000-PROCESS-RCVD-RECORDS.                                       06260000
062700                                                                  06270000
062800     MOVE TR015-ERD-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    06280000
062900                                                                  06290000
063000     EVALUATE TRUE                                                06300000
063100                                                                  06310000
063200        WHEN REC-TYP-ERD-LOG                                      06320000
063300            PERFORM 4100-EDIT-ERD-LOG-KEY-FIELDS                  06330000
063400            IF PS-FIELDS-OK                                       06340000
063500                PERFORM 3000-PROCESS-ERD-LOG-REC                  06350000
063600                SET PS-FIELDS-NOT-OK  TO TRUE                     06360000
063700            ELSE                                                  06370000
063800                PERFORM 4000-MOVE-TO-ERD-HOLD                     06380000
063900                SET PS-EDI-RECORD-NO TO TRUE                      06390000
064000                PERFORM 3017-PROCESS-ERD-LOG-ERROR                06400000
064100                    UNTIL PS-NEW-RECEIVING OR                     06410000
064200                          PS-END-OF-INPUT                         06420000
064300                SET PS-NEW-RECEIVING-NO TO TRUE                   06430000
064400            END-IF                                                06440000
064500                                                                  06450000
064600        WHEN REC-TYP-LOGVS                                        06460000
064700            IF PS-GOOD-ERD-LOG-WRITE                              06470000
064800                PERFORM 4110-EDIT-LOGVS-KEY-FIELDS                06480000
064900                IF PS-FIELDS-OK                                   06490000
065000                    PERFORM 4250-CHECK-ERD-LOG-HOLD-FIELDS        06500000
065100                    SET PS-FIELDS-NOT-OK  TO TRUE                 06510000
065200                    IF PS-SAME-INPUT-FIELDS                       06520000
065300                        PERFORM 3200-PROCESS-LOGVS-REC            06530000
065400                    ELSE                                          06540000
065500                        PERFORM 4300-DIFFERENT-INPUT-FIELDS       06550000
065600                        PERFORM 4010-MOVE-TO-LOGVS-HOLD           06560000
065700                        SET PS-EDI-RECORD-NO TO TRUE              06570000
065800                        PERFORM 3217-PROCESS-LOGVS-ERROR          06580000
065900                            UNTIL PS-NEW-VS  OR                   06590000
066000                                  PS-END-OF-INPUT                 06600000
066100                        SET PS-NEW-VS-NO    TO TRUE               06610000
066200                    END-IF                                        06620000
066300                ELSE                                              06630000
066400                    PERFORM 4010-MOVE-TO-LOGVS-HOLD               06640000
066500                    SET PS-EDI-RECORD-NO TO TRUE                  06650000
066600                    PERFORM 3217-PROCESS-LOGVS-ERROR              06660000
066700                        UNTIL PS-NEW-VS  OR                       06670000
066800                              PS-END-OF-INPUT                     06680000
066900                    SET PS-NEW-VS-NO    TO TRUE                   06690000
067000                END-IF                                            06700000
067100            ELSE                                                  06710000
067200                PERFORM 4200-ERD-LOG-DATA-MISSING-ERR             06720000
067300                SET PS-EDI-RECORD-NO TO TRUE                      06730000
067400                PERFORM 4000-MOVE-TO-ERD-HOLD                     06740000
067500                PERFORM 3017-PROCESS-ERD-LOG-ERROR                06750000
067600                    UNTIL PS-NEW-RECEIVING OR                     06760000
067700                          PS-END-OF-INPUT                         06770000
067800                SET PS-NEW-RECEIVING-NO TO TRUE                   06780000
067900            END-IF                                                06790000
068000                                                                  06800000
068100        WHEN REC-TYP-LOGUPC                                       06810000
068200            IF PS-GOOD-ERD-LOG-WRITE  AND                         06820000
068300               PS-GOOD-LOGVS-WRITE                                06830000
068400                PERFORM 4120-EDIT-LOGUPC-KEY-FIELDS               06840000
068500                IF PS-FIELDS-OK                                   06850000
068600                    PERFORM 4260-CHECK-LOGVS-HOLD-FIELDS          06860000
068700                    SET PS-FIELDS-NOT-OK  TO TRUE                 06870000
068800                    IF PS-SAME-INPUT-FIELDS                       06880000
068900                        PERFORM 3400-PROCESS-LOGUPC-REC           06890000
069000                    ELSE                                          06900000
069100                        PERFORM 4300-DIFFERENT-INPUT-FIELDS       06910000
069200                        PERFORM 4020-MOVE-TO-LOGUPC-HOLD          06920000
069300                        SET PS-EDI-RECORD-NO TO TRUE              06930000
069400                        PERFORM 3417-PROCESS-LOGUPC-ERROR         06940000
069500                            UNTIL PS-NEW-UPC OR                   06950000
069600                                  PS-END-OF-INPUT                 06960000
069700                        SET PS-NEW-UPC-NO   TO TRUE               06970000
069800                    END-IF                                        06980000
069900                ELSE                                              06990000
070000                    PERFORM 4020-MOVE-TO-LOGUPC-HOLD              07000000
070100                    SET PS-EDI-RECORD-NO TO TRUE                  07010000
070200                    PERFORM 3417-PROCESS-LOGUPC-ERROR             07020000
070300                        UNTIL PS-NEW-UPC OR                       07030000
070400                              PS-END-OF-INPUT                     07040000
070500                    SET PS-NEW-UPC-NO   TO TRUE                   07050000
070600                END-IF                                            07060000
070700            ELSE                                                  07070000
070800                IF PS-GOOD-ERD-LOG-WRITE-NO                       07080000
070900                    PERFORM 4200-ERD-LOG-DATA-MISSING-ERR         07090000
071000                    SET PS-EDI-RECORD-NO TO TRUE                  07100000
071100                    PERFORM 4000-MOVE-TO-ERD-HOLD                 07110000
071200                    PERFORM 3017-PROCESS-ERD-LOG-ERROR            07120000
071300                        UNTIL PS-NEW-RECEIVING OR                 07130000
071400                              PS-END-OF-INPUT                     07140000
071500                    SET PS-NEW-RECEIVING-NO TO TRUE               07150000
071600                ELSE                                              07160000
071700                    IF PS-GOOD-LOGVS-WRITE-NO                     07170000
071800                        PERFORM 4210-LOGVS-DATA-MISSING-ERR       07180000
071900                        SET PS-EDI-RECORD-NO TO TRUE              07190000
072000                        PERFORM 4010-MOVE-TO-LOGVS-HOLD           07200000
072100                        PERFORM 3217-PROCESS-LOGVS-ERROR          07210000
072200                            UNTIL PS-NEW-VS       OR              07220000
072300                                  PS-END-OF-INPUT                 07230000
072400                        SET PS-NEW-VS-NO TO TRUE                  07240000
072500                    END-IF                                        07250000
072600                END-IF                                            07260000
072700            END-IF                                                07270000
072800     END-EVALUATE.                                                07280000
072900                                                                  07290000
073000******************************************************************07300000
073100* PROCESS THE ERD, ERDRSN, AND LOG RECORDS.                      *07310000
073200* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *07320000
073300******************************************************************07330000
073400 3000-PROCESS-ERD-LOG-REC.                                        07340000
073500                                                                  07350000
073600     PERFORM 4000-MOVE-TO-ERD-HOLD.                               07360000
073700                                                                  07370000
073800     MOVE TR015-ERD-TRN-TYP           TO PV-EVAL-TRN-TYP-CDE.     07380000
073900                                                                  07390000
074000     EVALUATE TRUE                                                07400000
074100                                                                  07410000
074200         WHEN TRN-TYP-ADD                                         07420000
074300             PERFORM 3010-PROCESS-ERD-ADD-CHG                     07430000
074400                                                                  07440000
074500         WHEN TRN-TYP-CHG                                         07450000
074600             PERFORM 3010-PROCESS-ERD-ADD-CHG                     07460000
074700                                                                  07470000
074800         WHEN TRN-TYP-DEL                                         07480000
074900             PERFORM 3100-PROCESS-LOG-DEL                         07490000
075000             PERFORM 3125-CHECK-SPIN-FIELDS                       07500000
075100                                                                  07510000
075200         WHEN OTHER                                               07520000
075300             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            07530000
075400             MOVE TR015-ERD-PO-NBR               TO               07540000
075500                   PV-HOLD-TR221-PO-NBR                           07550000
075600             MOVE TR015-ERD-EXTL-REF-NBR         TO               07560000
075700                   PV-HOLD-TR221-EXTL-REF-NBR                     07570000
075800             MOVE TR015-ERD-PO-RCVD-DELY-DTE     TO               07580000
075900                   PV-HOLD-TR221-PO-RCVD-DELY-DTE                 07590000
076000             MOVE TR015-ERD-PO-RCVD-DELY-TM      TO               07600000
076100                   PV-HOLD-TR221-PO-RCVD-DELY-TM                  07610000
076200             MOVE TR015-ERD-ORGN-SHPD-FR-CDE     TO               07620000
076300                   PV-HOLD-TR221-ORGN-SHPD-FR-CDE                 07630000
076400             MOVE TR015-ERD-TRN-TYP              TO               07640000
076500                   PV-HOLD-TR221-DATA-VALUE                       07650000
076600                   PV-HOLD-TR221-TRN-TYP                          07660000
076700             MOVE 'TRAN TYPE ERD '               TO               07670000
076800                   PV-HOLD-TR221-DATA-IN-ERROR                    07680000
076900             MOVE 'INVALID TRAN TYPE'            TO               07690000
077000                   PV-HOLD-TR221-ERROR-MSG                        07700000
077100             SET PS-EDI-RECORD-NO     TO TRUE                     07710000
077200             PERFORM 3017-PROCESS-ERD-LOG-ERROR                   07720000
077300                 UNTIL PS-NEW-RECEIVING  OR                       07730000
077400                       PS-END-OF-INPUT                            07740000
077500             SET PS-NEW-RECEIVING-NO TO TRUE                      07750000
077600                                                                  07760000
077700     END-EVALUATE.                                                07770000
077800******************************************************************07780000
077900* PROCESS ERD, ERDRSN, & LOG RECORD ADD AND CHANGE TRANSACTIONS. *07790000
078000* PARAGRAPH PERFORMS PARA 3015- WHICH SETS SWITCHES DEPENDING    *07800000
078100* ON WHICH ERD, ERDRSN, LOG RECORDS WERE SENT TO US.  THESE      *07810000
078200* SWITCHES ARE CHECKED HERE TO DETERMINE IF WE NEED TO WRITE AN  *07820000
078300* ERROR OR A WARNING TO THE ERROR FILE, OR IF WE NEED TO WRITE   *07830000
078400* AN EDITED UPDATE RECORD TO THE UPDATE FILE.                    *07840000
078500******************************************************************07850000
078600 3010-PROCESS-ERD-ADD-CHG.                                        07860000
078700                                                                  07870000
078800     SET PS-NEW-GROUP-NO TO TRUE.                                 07880000
078900                                                                  07890000
079000     PERFORM 3018-RESET-ERD-SWITCHES.                             07900000
079100                                                                  07910000
079200     IF TR015-ERD-TRN-TYP = PC-A                                  07920000
079300         SET PS-TRN-TYP-ADD TO TRUE                               07930000
079400         PERFORM 3015-PROCESS-ERD-ADD-ERD                         07940000
079500             UNTIL (TR015-ERD-TRN-TYP           NOT = PC-A) OR    07950000
079701                   (TR015-ERD-PO-NBR-X          NOT =             07970100
079710                    PV-HOLD-PO-NBR-X)                       OR    07971000
079800                   (TR015-ERD-EXTL-REF-NBR      NOT =             07980000
079900                    PV-HOLD-EXTL-REF-NBR)                   OR    07990000
080000                   (TR015-ERD-PO-RCVD-DELY-DTE   NOT =            08000000
080100                    PV-HOLD-PO-RCVD-DELY-DTE)               OR    08010000
080200                   (TR015-ERD-ORGN-SHPD-FR-CDE  NOT =             08020000
080300                    PV-HOLD-ORGN-SHPD-FR-CDE)               OR    08030000
080400                   (TR015-ERD-REC-TYP-CDE       NOT =             08040000
080500                    PC-ERD AND PC-ERDRSN AND PC-LOG)              08050000
080600                   OR PS-NEW-GROUP                                08060000
080700                   OR PS-END-OF-INPUT                             08070000
080800     ELSE                                                         08080000
080900     IF TR015-ERD-TRN-TYP = PC-C                                  08090000
081000         PERFORM 3015-PROCESS-ERD-ADD-ERD                         08100000
081100             UNTIL (TR015-ERD-TRN-TYP           NOT = PC-C) OR    08110000
081301                   (TR015-ERD-PO-NBR-X          NOT =             08130100
081310                    PV-HOLD-PO-NBR-X)                       OR    08131000
081400                   (TR015-ERD-EXTL-REF-NBR      NOT =             08140000
081500                    PV-HOLD-EXTL-REF-NBR)                   OR    08150000
081600                   (TR015-ERD-PO-RCVD-DELY-DTE   NOT =            08160000
081700                    PV-HOLD-PO-RCVD-DELY-DTE)               OR    08170000
081800                   (TR015-ERD-ORGN-SHPD-FR-CDE  NOT =             08180000
081900                    PV-HOLD-ORGN-SHPD-FR-CDE)               OR    08190000
082000                   (TR015-ERD-REC-TYP-CDE       NOT =             08200000
082100                    PC-ERD AND PC-ERDRSN AND PC-LOG)              08210000
082200                   OR PS-NEW-GROUP                                08220000
082300                   OR PS-END-OF-INPUT                             08230000
082400     END-IF.                                                      08240000
082500                                                                  08250000
082600     IF PS-TRN-TYP-ADD                                            08260000
082700         MOVE PC-A            TO PV-HOLD-TR221-TRN-TYP            08270000
082800     ELSE                                                         08280000
082900         MOVE PC-C            TO PV-HOLD-TR221-TRN-TYP            08290000
083000     END-IF.                                                      08300000
083100     SET PS-TRN-TYP-ADD-NO    TO TRUE.                            08310000
083200                                                                  08320000
083300     IF  PS-ERD-SENT AND PS-LOG-SENT                              08330000
083400          SET PS-GOOD-ERD-LOG-WRITE TO TRUE                       08340000
083500          PERFORM 5300-LOAD-ERD-FIELDS-UPDATE                     08350000
083600          IF PS-EDIT-ERROR                                        08360000
083700              PERFORM 3017-PROCESS-ERD-LOG-ERROR                  08370000
083800                  UNTIL PS-NEW-RECEIVING OR                       08380000
083900                        PS-END-OF-INPUT                           08390000
084000              SET PS-EDIT-ERROR-NO  TO TRUE                       08400000
084100              SET PS-NEW-RECEIVING-NO TO TRUE                     08410000
084200          ELSE                                                    08420000
084300              EVALUATE PV-TR015-ERD-TRN-TYP                       08430000
084400                  WHEN PC-C                                       08440000
084500                      ADD +1 TO PA-TOT-RCPO-RECS-CHANGE           08450000
084600                  WHEN PC-A                                       08460000
084700                      ADD +1 TO PA-TOT-RCPO-RECS-ADD              08470000
084800              END-EVALUATE                                        08480000
084900          END-IF                                                  08490000
085000          IF PS-ERDRSN-SENT                                       08500000
085100              PERFORM 5310-LOAD-ERDRSN-FIELDS-UPDATE              08510000
085200              IF PS-EDIT-ERROR                                    08520000
085300                  PERFORM 3017-PROCESS-ERD-LOG-ERROR              08530000
085400                      UNTIL PS-NEW-RECEIVING OR                   08540000
085500                            PS-END-OF-INPUT                       08550000
085600                  SET PS-EDIT-ERROR-NO  TO TRUE                   08560000
085700                  SET PS-NEW-RECEIVING-NO TO TRUE                 08570000
085800              ELSE                                                08580000
085900                  EVALUATE PV-TR015-ERDRSN-TRN-TYP                08590000
086000                      WHEN PC-C                                   08600000
086100                          ADD +1 TO PA-TOT-RCPO-RECS-CHANGE       08610000
086200                      WHEN PC-A                                   08620000
086300                          ADD +1 TO PA-TOT-RCPO-RECS-ADD          08630000
086400                  END-EVALUATE                                    08640000
086500              END-IF                                              08650000
086600          END-IF                                                  08660000
086700          PERFORM 5320-LOAD-LOG-FIELDS-UPDATE                     08670000
086800          IF PS-EDIT-ERROR                                        08680000
086900              PERFORM 3017-PROCESS-ERD-LOG-ERROR                  08690000
087000                  UNTIL PS-NEW-RECEIVING OR                       08700000
087100                        PS-END-OF-INPUT                           08710000
087200              SET PS-EDIT-ERROR-NO  TO TRUE                       08720000
087300              SET PS-NEW-RECEIVING-NO TO TRUE                     08730000
087400          ELSE                                                    08740000
087500              EVALUATE PV-TR015-LOG-TRN-TYP                       08750000
087600                  WHEN PC-C                                       08760000
087700                      ADD +1 TO PA-TOT-RCPO-RECS-CHANGE           08770000
087800                  WHEN PC-A                                       08780000
087900                      ADD +1 TO PA-TOT-RCPO-RECS-ADD              08790000
088000              END-EVALUATE                                        08800000
088100          END-IF                                                  08810000
088200     END-IF.                                                      08820000
088300                                                                  08830000
088400     EVALUATE TRUE                                                08840000
088500        WHEN PS-ERD-NOT-SENT AND PS-LOG-NOT-SENT                  08850000
088600           MOVE PC-ERROR          TO PV-HOLD-TR221-ERROR-TYPE     08860000
088700           MOVE TR015-ERD-PO-NBR  TO PV-HOLD-TR221-DATA-VALUE     08870000
088800           MOVE 'PO LEVEL       ' TO PV-HOLD-TR221-DATA-IN-ERROR  08880000
088900           MOVE 'ERD & LOG DATA MISSING' TO                       08890000
089000                                     PV-HOLD-TR221-ERROR-MSG      08900000
089100           IF PS-ERDRSN-SENT                                      08910000
089200               PERFORM 5510-LOAD-ERDRSN-TO-REPORT                 08920000
089300           END-IF                                                 08930000
089400                                                                  08940000
089500           IF (TR015-ERD-TRN-TYP          NOT =                   08950000
089600                PV-HOLD-LAST-TRN-TYP)                  OR         08960000
089801              (TR015-ERD-PO-NBR-X         NOT =                   08980100
089810               PV-HOLD-PO-NBR-X)                       OR         08981000
089900              (TR015-ERD-EXTL-REF-NBR     NOT =                   08990000
090000               PV-HOLD-EXTL-REF-NBR)                   OR         09000000
090100              (TR015-ERD-PO-RCVD-DELY-DTE NOT =                   09010000
090200               PV-HOLD-PO-RCVD-DELY-DTE)               OR         09020000
090300              (TR015-ERD-ORGN-SHPD-FR-CDE NOT =                   09030000
090400               PV-HOLD-ORGN-SHPD-FR-CDE)                          09040000
090500               CONTINUE                                           09050000
090600           ELSE                                                   09060000
090700               SET PS-EDI-RECORD-NO TO TRUE                       09070000
090800               PERFORM 3017-PROCESS-ERD-LOG-ERROR                 09080000
090900                   UNTIL PS-NEW-RECEIVING OR                      09090000
091000                         PS-END-OF-INPUT                          09100000
091100               SET PS-NEW-RECEIVING-NO TO TRUE                    09110000
091200           END-IF                                                 09120000
091300                                                                  09130000
091400        WHEN PS-ERD-NOT-SENT                                      09140000
091500           MOVE PC-ERROR          TO PV-HOLD-TR221-ERROR-TYPE     09150000
091600           MOVE PV-TR015-LOG-PO-NBR  TO PV-HOLD-TR221-DATA-VALUE  09160000
091700           MOVE 'PO LEVEL       ' TO PV-HOLD-TR221-DATA-IN-ERROR  09170000
091800           MOVE 'ERD DATA MISSING' TO PV-HOLD-TR221-ERROR-MSG     09180000
091900                                                                  09190000
092000           IF PS-ERDRSN-SENT                                      09200000
092100               PERFORM 5510-LOAD-ERDRSN-TO-REPORT                 09210000
092200           END-IF                                                 09220000
092300                                                                  09230000
092400           IF PS-LOG-SENT                                         09240000
092500               PERFORM 5520-LOAD-LOG-TO-REPORT                    09250000
092600           END-IF                                                 09260000
092700                                                                  09270000
092800           IF (TR015-ERD-TRN-TYP          NOT =                   09280000
092900                PV-HOLD-LAST-TRN-TYP)                  OR         09290000
093110              (TR015-ERD-PO-NBR-X         NOT =                   09311000
093120               PV-HOLD-PO-NBR-X)                       OR         09312000
093200              (TR015-ERD-EXTL-REF-NBR     NOT =                   09320000
093300               PV-HOLD-EXTL-REF-NBR)                   OR         09330000
093400              (TR015-ERD-PO-RCVD-DELY-DTE NOT =                   09340000
093500               PV-HOLD-PO-RCVD-DELY-DTE)               OR         09350000
093600              (TR015-ERD-ORGN-SHPD-FR-CDE NOT =                   09360000
093700               PV-HOLD-ORGN-SHPD-FR-CDE)                          09370000
093800               CONTINUE                                           09380000
093900           ELSE                                                   09390000
094000               SET PS-EDI-RECORD-NO TO TRUE                       09400000
094100               PERFORM 3017-PROCESS-ERD-LOG-ERROR                 09410000
094200                   UNTIL PS-NEW-RECEIVING OR                      09420000
094300                         PS-END-OF-INPUT                          09430000
094400               SET PS-NEW-RECEIVING-NO TO TRUE                    09440000
094500           END-IF                                                 09450000
094600                                                                  09460000
094700        WHEN PS-LOG-NOT-SENT                                      09470000
094800           MOVE PC-ERROR          TO PV-HOLD-TR221-ERROR-TYPE     09480000
094900           MOVE PV-TR015-ERD-PO-NBR  TO PV-HOLD-TR221-DATA-VALUE  09490000
095000           MOVE 'PO LEVEL       ' TO PV-HOLD-TR221-DATA-IN-ERROR  09500000
095100           MOVE 'LOG DATA MISSING'   TO                           09510000
095200                                     PV-HOLD-TR221-ERROR-MSG      09520000
095300           IF PS-ERD-SENT                                         09530000
095400               PERFORM 5500-LOAD-ERD-TO-REPORT                    09540000
095500           END-IF                                                 09550000
095600           IF PS-ERDRSN-SENT                                      09560000
095700               PERFORM 5510-LOAD-ERDRSN-TO-REPORT                 09570000
095800           END-IF                                                 09580000
095900                                                                  09590000
096000           IF (TR015-ERD-TRN-TYP          NOT =                   09600000
096100                PV-HOLD-LAST-TRN-TYP)                  OR         09610000
096310              (TR015-ERD-PO-NBR-X         NOT =                   09631000
096320               PV-HOLD-PO-NBR-X)                       OR         09632000
096400              (TR015-ERD-EXTL-REF-NBR     NOT =                   09640000
096500               PV-HOLD-EXTL-REF-NBR)                   OR         09650000
096600              (TR015-ERD-PO-RCVD-DELY-DTE NOT =                   09660000
096700               PV-HOLD-PO-RCVD-DELY-DTE)               OR         09670000
096800              (TR015-ERD-ORGN-SHPD-FR-CDE NOT =                   09680000
096900               PV-HOLD-ORGN-SHPD-FR-CDE)                          09690000
097000               CONTINUE                                           09700000
097100           ELSE                                                   09710000
097200               SET PS-EDI-RECORD-NO TO TRUE                       09720000
097300               PERFORM 3017-PROCESS-ERD-LOG-ERROR                 09730000
097400                   UNTIL PS-NEW-RECEIVING OR                      09740000
097500                         PS-END-OF-INPUT                          09750000
097600               SET PS-NEW-RECEIVING-NO TO TRUE                    09760000
097700           END-IF                                                 09770000
097800                                                                  09780000
097900     END-EVALUATE.                                                09790000
098000                                                                  09800000
098100******************************************************************09810000
098200* MOVE INPUT FIELDS TO WORKING STORAGE HOLD FIELDS.  DEPENDING ON*09820000
098300* WHAT RECORDS WERE SENT, SET THE APPROPRIATE SWITCHES SO THAT   *09830000
098400* PARA 3010- CAN DETERMINE IF AN ERROR OR WARNING NEEDS TO BE    *09840000
098500* WRITTEN TO THE ERROR FILE OR IF AN EDITED UPDATE RECORD NEEDS  *09850000
098600* TO BE WRITTEN TO THE EDITED UPDATE FILE.                       *09860000
098700******************************************************************09870000
098800 3015-PROCESS-ERD-ADD-ERD.                                        09880000
098900                                                                  09890000
099000     MOVE TR015-ERD-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    09900000
099100                                                                  09910000
099200     EVALUATE TRUE                                                09920000
099300                                                                  09930000
099400        WHEN REC-TYP-ERD                                          09940000
099500            PERFORM 5000-MOVE-TR015-ERD-TO-HOLD                   09950000
099600            SET PS-ERD-SENT TO TRUE                               09960000
099700                                                                  09970000
099800        WHEN REC-TYP-ERDRSN                                       09980000
099900            PERFORM 5010-MOVE-TR015-ERDRSN-TO-HOLD                09990000
100000            SET PS-ERDRSN-SENT TO TRUE                            10000000
100100                                                                  10010000
100200        WHEN REC-TYP-LOG                                          10020000
100300            PERFORM 5020-MOVE-TR015-LOG-TO-HOLD                   10030000
100400            SET PS-LOG-SENT TO TRUE                               10040000
100500                                                                  10050000
100600     END-EVALUATE.                                                10060000
100700                                                                  10070000
100800     PERFORM 6000-READ-RECEIVING-FILE                             10080000
100900         UNTIL PS-GOOD-RECORD OR                                  10090000
101000               PS-END-OF-INPUT.                                   10100000
101100     SET PS-GOOD-RECORD-NO TO TRUE.                               10110000
101200                                                                  10120000
101300******************************************************************10130000
101400* THERE WAS AN ERD, ERDRSN, OR LOG RECORD ERROR.  BYPASS ALL THE *10140000
101500* RECORDS THAT ARE RELATED TO THIS RECEIVING.                    *10150000
101600******************************************************************10160000
101700 3017-PROCESS-ERD-LOG-ERROR.                                      10170000
101800                                                                  10180000
101900     IF PS-EDI-RECORD-NO                                          10190000
102000         PERFORM 3500-CHECK-MOVE-TO-REPORT                        10200000
102100     END-IF.                                                      10210000
102200                                                                  10220000
102300     READ TR015-RECEIVING-FILE                                    10230000
102400         INTO TR015-REC-TYP-ERD                                   10240000
102500         AT END                                                   10250000
102600           SET PS-END-OF-INPUT TO TRUE.                           10260000
102700                                                                  10270000
102800     MOVE TR015-RECEIVING-RECORD(1:3) TO PV-EDI-RECORDS.          10280000
102900     IF EDI-RECORD                                                10290000
103000         SET PS-EDI-RECORD TO TRUE                                10300000
103100         PERFORM 6030-PROCESS-EDI-RECORD                          10310000
103200     ELSE                                                         10320000
103300         SET PS-EDI-RECORD-NO TO TRUE                             10330000
103400         ADD +1 TO PV-PROCESS-SEQ-NBR                             10340000
103610         IF (TR015-ERD-PO-NBR-X         NOT EQUAL                 10361000
103620             PV-HOLD-PO-NBR-X)                     OR             10362000
103700            (TR015-ERD-EXTL-REF-NBR     NOT EQUAL                 10370000
103800             PV-HOLD-EXTL-REF-NBR)                 OR             10380000
103900            (TR015-ERD-PO-RCVD-DELY-DTE NOT EQUAL                 10390000
104000             PV-HOLD-PO-RCVD-DELY-DTE)             OR             10400000
104100            (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL                 10410000
104200             PV-HOLD-ORGN-SHPD-FR-CDE)             OR             10420000
104300            (TR015-ERD-TRN-TYP          NOT EQUAL                 10430000
104400             PV-HOLD-LAST-TRN-TYP)                                10440000
104500            SET PS-NEW-RECEIVING TO TRUE                          10450000
104600            PERFORM 4900-RESET-WRITE-SWITCHES                     10460000
104700         END-IF                                                   10470000
104800     END-IF.                                                      10480000
104900                                                                  10490000
105000     IF (TR015-ERD-REC-TYP-CDE = PC-ERD  AND                      10500000
105100         TR015-ERD-TRN-TYP NOT = PC-D)         OR                 10510000
105200        (TR015-ERD-REC-TYP-CDE = PC-LOG  AND                      10520000
105300         TR015-ERD-TRN-TYP     = PC-D)                            10530000
105400         SET PS-NEW-GROUP TO TRUE                                 10540000
105500     END-IF.                                                      10550000
105600                                                                  10560000
105700     IF PS-END-OF-INPUT-NO                                        10570000
105800         ADD +1 TO PA-RCVD-INPUT-COUNT                            10580000
105900         MOVE TR015-REC-TYP-ERD (1:3) TO PV-HOLD-LAST-REC-TYP     10590000
106000     END-IF.                                                      10600000
106100                                                                  10610000
106200******************************************************************10620000
106300* RESET THE ERD LEVEL SWITCHES.                                  *10630000
106400******************************************************************10640000
106500 3018-RESET-ERD-SWITCHES.                                         10650000
106600                                                                  10660000
106700     SET PS-ERD-NOT-SENT         TO TRUE.                         10670000
106800     SET PS-ERDRSN-NOT-SENT      TO TRUE.                         10680000
106900     SET PS-LOG-NOT-SENT         TO TRUE.                         10690000
107000                                                                  10700000
107100******************************************************************10710000
107200* ALL DELETE EDITING PROCESSING IS PERFORMED FROM THE PO LEVEL.  *10720000
107300* ONLY AN LOG RECORD TYPE WILL BE SENT FOR DELETES.              *10730000
107400******************************************************************10740000
107500 3100-PROCESS-LOG-DEL.                                            10750000
107600                                                                  10760000
107700     MOVE TR015-LOG-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    10770000
107800                                                                  10780000
107900     EVALUATE TRUE                                                10790000
108000                                                                  10800000
108100        WHEN REC-TYP-LOG                                          10810000
108200            PERFORM 5020-MOVE-TR015-LOG-TO-HOLD                   10820000
108300            PERFORM 3120-PROCESS-DELETE                           10830000
108400                                                                  10840000
108500        WHEN OTHER                                                10850000
108600            PERFORM 3105-PROCESS-LOG-DEL-LOG                      10860000
108700                                                                  10870000
108800     END-EVALUATE.                                                10880000
108900                                                                  10890000
109000******************************************************************10900000
109100* ALL DELETE EDITING PROCESSING IS PERFORMED FROM THE PO LEVEL.  *10910000
109200* ONLY AN LOG RECORD TYPE WILL BE SENT FOR DELETES.              *10920000
109300******************************************************************10930000
109400 3105-PROCESS-LOG-DEL-LOG.                                        10940000
109500                                                                  10950000
109600     SET PS-NEW-GROUP-NO        TO TRUE.                          10960000
109700     SET PS-LOG-DELETE-NOT-SENT TO TRUE.                          10970000
109800                                                                  10980000
109900     IF TR015-LOG-TRN-TYP = PC-D                                  10990000
110000         PERFORM 3110-PROCESS-LOG-DEL-CHK                         11000000
110100             UNTIL (TR015-LOG-TRN-TYP         NOT = PC-D)   OR    11010000
110301                   (TR015-LOG-PO-NBR-X        NOT =               11030100
110310                    PV-HOLD-PO-NBR-X)                       OR    11031000
110400                   (TR015-LOG-EXTL-REF-NBR    NOT =               11040000
110500                    PV-HOLD-EXTL-REF-NBR)                   OR    11050000
110600                   (TR015-LOG-PO-RCVD-DELY-DTE NOT =              11060000
110700                    PV-HOLD-PO-RCVD-DELY-DTE)               OR    11070000
110800                   (TR015-LOG-ORGN-SHPD-FR-CDE NOT =              11080000
110900                    PV-HOLD-ORGN-SHPD-FR-CDE)               OR    11090000
111000                   (TR015-LOG-REC-TYP-CDE     NOT =               11100000
111100                    PC-ERD AND PC-ERDRSN AND PC-LOG)              11110000
111200                   OR PS-NEW-GROUP                                11120000
111300                   OR PS-END-OF-INPUT                             11130000
111400     END-IF.                                                      11140000
111500                                                                  11150000
111600     IF (TR015-LOG-REC-TYP-CDE          = PC-LOG)           AND   11160000
111700        (TR015-LOG-TRN-TYP              = PC-D)             AND   11170000
111901        (TR015-LOG-PO-NBR-X             =                         11190100
111910          PV-HOLD-PO-NBR-X)                                 AND   11191000
112000        (TR015-LOG-EXTL-REF-NBR         =                         11200000
112100          PV-HOLD-EXTL-REF-NBR)                             AND   11210000
112200        (TR015-LOG-PO-RCVD-DELY-DTE     =                         11220000
112300          PV-HOLD-PO-RCVD-DELY-DTE)                         AND   11230000
112400        (TR015-LOG-ORGN-SHPD-FR-CDE     =                         11240000
112500          PV-HOLD-ORGN-SHPD-FR-CDE)                         AND   11250000
112600        PS-NEW-GROUP                                              11260000
112700                                                                  11270000
112800         PERFORM 3110-PROCESS-LOG-DEL-CHK                         11280000
112900     END-IF.                                                      11290000
113000                                                                  11300000
113100     IF PS-LOG-DELETE-SENT                                        11310000
113200         PERFORM 3120-PROCESS-DELETE                              11320000
113300         IF (TR015-LOG-REC-TYP-CDE          = PC-LOG)       AND   11330000
113400            (TR015-LOG-TRN-TYP              = PC-D)         AND   11340000
113601            (TR015-LOG-PO-NBR-X             =                     11360100
113610              PV-HOLD-PO-NBR-X)                             AND   11361000
113700            (TR015-LOG-EXTL-REF-NBR         =                     11370000
113800              PV-HOLD-EXTL-REF-NBR)                         AND   11380000
113900            (TR015-LOG-PO-RCVD-DELY-DTE     =                     11390000
114000              PV-HOLD-PO-RCVD-DELY-DTE)                     AND   11400000
114100            (TR015-LOG-ORGN-SHPD-FR-CDE     =                     11410000
114200              PV-HOLD-ORGN-SHPD-FR-CDE)                     AND   11420000
114300             PS-NEW-GROUP                                         11430000
114400                                                                  11440000
114500             PERFORM 3110-PROCESS-LOG-DEL-CHK                     11450000
114600             PERFORM 3120-PROCESS-DELETE                          11460000
114700         END-IF                                                   11470000
114800     ELSE                                                         11480000
114900         MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE                11490000
115000         MOVE 'PO LEVEL'            TO                            11500000
115100               PV-HOLD-TR221-DATA-IN-ERROR                        11510000
115200         MOVE 'LOG DATA MISSING'    TO                            11520000
115300               PV-HOLD-TR221-ERROR-MSG                            11530000
115400         EVALUATE TRUE                                            11540000
115500             WHEN REC-TYP-ERD                                     11550000
115600                 MOVE PC-ERD TO PV-HOLD-TR221-DATA-VALUE          11560000
115700                 PERFORM 5500-LOAD-ERD-TO-REPORT                  11570000
115800             WHEN REC-TYP-ERDRSN                                  11580000
115900                 MOVE PC-ERDRSN TO PV-HOLD-TR221-DATA-VALUE       11590000
116000                 PERFORM 5510-LOAD-ERDRSN-TO-REPORT               11600000
116100         END-EVALUATE                                             11610000
116200     END-IF.                                                      11620000
116300                                                                  11630000
116400******************************************************************11640000
116500* MOVE INPUT FIELDS TO WORKING STORAGE HOLD FIELDS.  DEPENDING ON*11650000
116600* WHAT RECORDS WERE SENT, SET THE APPROPRIATE SWITCHES SO THAT   *11660000
116700* PARA 3105- CAN DETERMINE IF AN ERROR OR WARNING NEEDS TO BE    *11670000
116800* WRITTEN TO THE ERROR FILE OR IF AN EDITED UPDATE RECORD NEEDS  *11680000
116900* TO BE WRITTEN TO THE UPDATE FILE.                              *11690000
117000******************************************************************11700000
117100 3110-PROCESS-LOG-DEL-CHK.                                        11710000
117200                                                                  11720000
117300     MOVE TR015-LOG-REC-TYP-CDE        TO PV-HOLD-REC-TYP-CDE.    11730000
117400                                                                  11740000
117500     EVALUATE TRUE                                                11750000
117600                                                                  11760000
117700        WHEN REC-TYP-LOG                                          11770000
117800            PERFORM 5020-MOVE-TR015-LOG-TO-HOLD                   11780000
117900            SET PS-LOG-DELETE-SENT    TO TRUE                     11790000
118000                                                                  11800000
118100        WHEN REC-TYP-ERD                                          11810000
118200            PERFORM 5000-MOVE-TR015-ERD-TO-HOLD                   11820000
118300                                                                  11830000
118400        WHEN REC-TYP-ERDRSN                                       11840000
118500            PERFORM 5010-MOVE-TR015-ERDRSN-TO-HOLD                11850000
118600                                                                  11860000
118700     END-EVALUATE.                                                11870000
118800                                                                  11880000
118900     SET PS-EDI-RECORD-NO TO TRUE.                                11890000
119000     PERFORM 6000-READ-RECEIVING-FILE                             11900000
119100         UNTIL PS-GOOD-RECORD OR                                  11910000
119200               PS-END-OF-INPUT.                                   11920000
119300     SET PS-GOOD-RECORD-NO TO TRUE.                               11930000
119400                                                                  11940000
119500******************************************************************11950000
119600* PROCESS THE LOG DELETE.                                        *11960000
119700******************************************************************11970000
119800 3120-PROCESS-DELETE.                                             11980000
119900                                                                  11990000
120000     PERFORM 5420-INITIAL-LOG-FIELDS-UPD.                         12000000
120100                                                                  12010000
120200     MOVE PV-TR015-LOG-TRN-TYP        TO TR025-LOG-TRN-TYP.       12020000
120300     MOVE PC-LOG                      TO TR025-LOG-REC-TYP-CDE.   12030000
120400     MOVE PC-20                       TO TR025-LOG-SEQ-NBR.       12040000
120500     MOVE PV-TR015-LOG-3RD-PARTY-CDE  TO TR025-LOG-3RD-PARTY-CDE. 12050000
120600                                                                  12060000
120700     IF PV-TR015-LOG-PO-RCVD-DELY-DTE EQUAL SPACES                12070000
120800         MOVE PC-DEFAULT-DATE TO TR025-LOG-PO-RCVD-DELY-DTE       12080000
120900     END-IF.                                                      12090000
121000                                                                  12100000
121100     IF PV-TR015-LOG-PO-RCVD-DELY-TM EQUAL SPACES                 12110000
121200         MOVE PC-DEFAULT-TIME TO TR025-LOG-PO-RCVD-DELY-TM        12120000
121300     END-IF.                                                      12130000
121400                                                                  12140000
121500     EVALUATE TRUE                                                12150000
121600                                                                  12160000
121700         WHEN PV-TR015-LOG-PO-NBR NOT NUMERIC OR                  12170000
121800              PV-TR015-LOG-PO-NBR  = ZERO                         12180000
121900               SET PS-EDIT-ERROR TO TRUE                          12190000
122000               MOVE PC-ERROR    TO PV-HOLD-TR221-ERROR-TYPE       12200000
122100               MOVE 'PO NUMBER' TO PV-HOLD-TR221-DATA-IN-ERROR    12210000
122200               MOVE PV-TR015-LOG-PO-NBR TO                        12220000
122300                     PV-HOLD-TR221-DATA-VALUE                     12230000
122400               MOVE 'INVALID PO NUMBER'    TO                     12240000
122500                     PV-HOLD-TR221-ERROR-MSG                      12250000
122600               PERFORM 5520-LOAD-LOG-TO-REPORT                    12260000
122700                                                                  12270000
122800         WHEN PV-TR015-LOG-ORGN-SHPD-FR-CDE EQUAL SPACES OR       12280000
122900             (PV-TR015-LOG-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS      12290000
123000              AND PC-CY)                                          12300000
123100             SET PS-EDIT-ERROR TO TRUE                            12310000
123200             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            12320000
123300             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR221-DATA-IN-ERROR 12330000
123400             MOVE PV-TR015-LOG-ORGN-SHPD-FR-CDE  TO               12340000
123500                   PV-HOLD-TR221-DATA-VALUE                       12350000
123600             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               12360000
123700                   PV-HOLD-TR221-ERROR-MSG                        12370000
123800             PERFORM 5520-LOAD-LOG-TO-REPORT                      12380000
123900                                                                  12390000
124000         WHEN PV-TR015-LOG-PO-RCVD-DELY-DTE NOT EQUAL SPACES      12400000
124100                AND                                               12410000
124200              PV-TR015-LOG-PO-RCVD-DELY-DTE NOT EQUAL             12420000
124300               PC-DEFAULT-DATE                                    12430000
124400             MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE  TO               12440000
124500                   PV-RCVD-DELY-DTE                               12450000
124600             MOVE PV-TR015-LOG-PO-RCVD-DELY-TM   TO               12460000
124700                   PV-RCVD-DELY-TM                                12470000
124800             PERFORM 5715-FORMAT-RCVD-DELY-TMST                   12480000
124900             IF PS-WARNING-DATE                                   12490000
125000                 SET PS-EDIT-ERROR TO TRUE                        12500000
125100                 MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE        12510000
125200                 MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO            12520000
125300                       PV-HOLD-TR221-DATA-VALUE                   12530000
125400                 MOVE 'DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR   12540000
125500                 MOVE 'INVALID DELIVERY DATE'      TO             12550000
125600                       PV-HOLD-TR221-ERROR-MSG                    12560000
125700                 PERFORM 5520-LOAD-LOG-TO-REPORT                  12570000
125800             ELSE                                                 12580000
125900                 IF PS-WARNING-TIME                               12590000
126000                     SET PS-EDIT-ERROR TO TRUE                    12600000
126100                     MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE    12610000
126200                     MOVE PV-TR015-LOG-PO-RCVD-DELY-TM TO         12620000
126300                           PV-HOLD-TR221-DATA-VALUE               12630000
126400                     MOVE 'DELY TM' TO PV-HOLD-TR221-DATA-IN-ERROR12640000
126500                     MOVE 'INVALID DELIVERY TIME'     TO          12650000
126600                           PV-HOLD-TR221-ERROR-MSG                12660000
126700                     PERFORM 5520-LOAD-LOG-TO-REPORT              12670000
126800                 ELSE                                             12680000
126900                     MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO        12690000
127000                           TR025-LOG-PO-RCVD-DELY-DTE             12700000
127100                     MOVE PV-TR015-LOG-PO-RCVD-DELY-TM TO         12710000
127200                           TR025-LOG-PO-RCVD-DELY-TM              12720000
127300                 END-IF                                           12730000
127400             END-IF                                               12740000
127500             SET PS-WARNING-DATE-NO TO TRUE                       12750000
127600             SET PS-WARNING-TIME-NO TO TRUE                       12760000
127700     END-EVALUATE.                                                12770000
127800                                                                  12780000
127900     IF PS-EDIT-ERROR-NO                                          12790000
128000         ADD +1 TO PA-TOT-LOG-RECS-DELETE                         12800000
128100         MOVE PV-TR015-LOG-PO-NBR TO                              12810000
128200               TR025-LOG-PO-NBR                                   12820000
128300         MOVE PV-TR015-LOG-EXTL-REF-NBR TO                        12830000
128400               TR025-LOG-EXTL-REF-NBR                             12840000
128500         MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO                    12850000
128600               TR025-LOG-PO-RCVD-DELY-DTE                         12860000
128700         MOVE PV-TR015-LOG-PO-RCVD-DELY-TM TO                     12870000
128800               TR025-LOG-PO-RCVD-DELY-TM                          12880000
128900         MOVE PV-TR015-LOG-ORGN-SHPD-FR-CDE TO                    12890000
129000               TR025-LOG-ORGN-SHPD-FR-CDE                         12900000
129100         MOVE PV-TR015-LOG-PROC-SEQ-NBR TO                        12910000
129200               TR025-LOG-PROCESS-SEQ-NBR                          12920000
129201         MOVE PV-TR015-LOG-FILE-ID TO                             12920100
129202               TR025-LOG-FILE-ID                                  12920200
129203         MOVE PV-TR015-LOG-ENT-ID  TO                             12920300
129210               TR025-LOG-ENT-ID                                   12921000
129300         PERFORM 6400-WRITE-UPDATE-RECORD                         12930000
129400     END-IF.                                                      12940000
129500                                                                  12950000
129600******************************************************************12960000
129700* ON A DELETE CHECK INPUT FIELDS TO SEE IF RECORDS NEED TO       *12970000
129800* BE BYPASSED ON READ.  THE DELETE EDITING PROCESS ONLY EDITS THE*12980000
129900* LOG RECORD FOR THE DELETE.  ONCE IT IS FINISHED EDITING THE    *12990000
130000* LOG RECORD, WE NEED TO SPIN PAST THE REST OF THE RECORDS FOR   *13000000
130100* THIS PO TO GET TO THE NEXT PO.                                 *13010000
130200******************************************************************13020000
130300 3125-CHECK-SPIN-FIELDS.                                          13030000
130400                                                                  13040000
130500     SET PS-NEW-GROUP-NO TO TRUE.                                 13050000
130600                                                                  13060000
130710     IF TR015-LOG-PO-NBR-X         =  PV-HOLD-PO-NBR-X        AND 13071000
130800        TR015-LOG-EXTL-REF-NBR     =  PV-HOLD-EXTL-REF-NBR    AND 13080000
130900        TR015-LOG-PO-RCVD-DELY-DTE = PV-HOLD-PO-RCVD-DELY-DTE AND 13090000
131000        TR015-LOG-ORGN-SHPD-FR-CDE = PV-HOLD-ORGN-SHPD-FR-CDE AND 13100000
131100        PV-HOLD-LAST-TRN-TYP       =  PC-D                        13110000
131200         SET PS-EDI-RECORD-NO TO TRUE                             13120000
131300         PERFORM 6000-READ-RECEIVING-FILE                         13130000
131501             UNTIL (TR015-ERD-PO-NBR-X         NOT EQUAL          13150100
131510                     PV-HOLD-PO-NBR-X)                      OR    13151000
131600                   (TR015-ERD-EXTL-REF-NBR     NOT EQUAL          13160000
131700                     PV-HOLD-EXTL-REF-NBR)                  OR    13170000
131800                   (TR015-ERD-PO-RCVD-DELY-DTE NOT EQUAL          13180000
131900                     PV-HOLD-PO-RCVD-DELY-DTE)              OR    13190000
132000                   (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL          13200000
132100                     PV-HOLD-ORGN-SHPD-FR-CDE)              OR    13210000
132200                   PS-EDI-RECORD                            OR    13220000
132300                   PS-NEW-GROUP                             OR    13230000
132400                   PS-END-OF-INPUT                                13240000
132500         SET PS-GOOD-RECORD-NO TO TRUE                            13250000
132600     END-IF.                                                      13260000
132700                                                                  13270000
132800     IF PS-EDI-RECORD AND PS-END-OF-INPUT-NO                      13280000
132900         PERFORM 6000-READ-RECEIVING-FILE                         13290000
133000             UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT              13300000
133100         SET PS-GOOD-RECORD-NO TO TRUE                            13310000
133200     END-IF.                                                      13320000
133300                                                                  13330000
133400******************************************************************13340000
133500* PROCESS THE VENDOR STYLE LEVEL RECORD  (LOGVS).                *13350000
133600* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *13360000
133700******************************************************************13370000
133800 3200-PROCESS-LOGVS-REC.                                          13380000
133900                                                                  13390000
134000     PERFORM 4010-MOVE-TO-LOGVS-HOLD.                             13400000
134100                                                                  13410000
134200     MOVE TR015-LOGVS-TRN-TYP         TO PV-EVAL-TRN-TYP-CDE.     13420000
134300                                                                  13430000
134400     EVALUATE TRUE                                                13440000
134500         WHEN TRN-TYP-ADD                                         13450000
134600             PERFORM 3210-PROCESS-LOGVS-ADD-CHG                   13460000
134700                                                                  13470000
134800         WHEN TRN-TYP-CHG                                         13480000
134900             PERFORM 3210-PROCESS-LOGVS-ADD-CHG                   13490000
135000                                                                  13500000
135100         WHEN OTHER                                               13510000
135200             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            13520000
135300             MOVE TR015-LOGVS-PO-NBR              TO              13530000
135400                   PV-HOLD-TR221-PO-NBR                           13540000
135500             MOVE TR015-LOGVS-EXTL-REF-NBR        TO              13550000
135600                   PV-HOLD-TR221-EXTL-REF-NBR                     13560000
135700             MOVE TR015-LOGVS-PO-RCVD-DELY-DTE    TO              13570000
135800                   PV-HOLD-TR221-PO-RCVD-DELY-DTE                 13580000
135900             MOVE TR015-LOGVS-PO-RCVD-DELY-TM     TO              13590000
136000                   PV-HOLD-TR221-PO-RCVD-DELY-TM                  13600000
136100             MOVE TR015-LOGVS-ORGN-SHPD-FR-CDE    TO              13610000
136200                   PV-HOLD-TR221-ORGN-SHPD-FR-CDE                 13620000
136300             MOVE TR015-LOGVS-TRN-TYP             TO              13630000
136400                   PV-HOLD-TR221-DATA-VALUE                       13640000
136500                   PV-HOLD-TR221-TRN-TYP                          13650000
136600             MOVE 'TRAN TYPE-VS'                  TO              13660000
136700                   PV-HOLD-TR221-DATA-IN-ERROR                    13670000
136800             MOVE 'INVALID TRAN TYPE'             TO              13680000
136900                   PV-HOLD-TR221-ERROR-MSG                        13690000
137000             SET PS-EDI-RECORD-NO     TO TRUE                     13700000
137100             PERFORM 3217-PROCESS-LOGVS-ERROR                     13710000
137200                 UNTIL PS-NEW-VS  OR                              13720000
137300                       PS-END-OF-INPUT                            13730000
137400             SET PS-NEW-VS-NO         TO TRUE                     13740000
137500                                                                  13750000
137600     END-EVALUATE.                                                13760000
137700                                                                  13770000
137800******************************************************************13780000
137900* PROCESS VENDOR STYLE RECORD ADD AND CHANGE TRANSACTIONS.       *13790000
138000******************************************************************13800000
138100 3210-PROCESS-LOGVS-ADD-CHG.                                      13810000
138200                                                                  13820000
138300     SET PS-LOGVS-NOT-SENT TO TRUE.                               13830000
138400                                                                  13840000
138500     IF TR015-LOGVS-TRN-TYP = PC-A                                13850000
138600         MOVE PC-A                 TO PV-HOLD-TR221-TRN-TYP       13860000
138700     ELSE                                                         13870000
138800         MOVE PC-C                 TO PV-HOLD-TR221-TRN-TYP       13880000
138900     END-IF.                                                      13890000
139000                                                                  13900000
139110     IF TR015-LOGVS-PO-NBR-X = PV-HOLD-PO-NBR-X                   13911000
139200         PERFORM 5030-MOVE-TR015-LOGVS-TO-HOLD                    13920000
139300         PERFORM 5330-LOAD-LOGVS-FIELDS-UPDATE                    13930000
139400         SET PS-GOOD-LOGVS-WRITE TO TRUE                          13940000
139500         EVALUATE PV-TR015-LOGVS-TRN-TYP                          13950000
139600             WHEN PC-C                                            13960000
139700                 ADD +1 TO PA-TOT-RCVS-RECS-CHANGE                13970000
139800             WHEN PC-A                                            13980000
139900                 ADD +1 TO PA-TOT-RCVS-RECS-ADD                   13990000
140000         END-EVALUATE                                             14000000
140100         SET PS-LOGVS-SENT TO TRUE                                14010000
140200         PERFORM 6000-READ-RECEIVING-FILE                         14020000
140300             UNTIL PS-GOOD-RECORD  OR                             14030000
140400                   PS-END-OF-INPUT                                14040000
140500         SET PS-GOOD-RECORD-NO TO TRUE                            14050000
140600     ELSE                                                         14060000
140700         MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE                14070000
140800         MOVE TR015-LOGVS-VS-NBR  TO PV-HOLD-TR221-DATA-VALUE     14080000
140900         MOVE 'VENDOR STYLE'      TO PV-HOLD-TR221-DATA-IN-ERROR  14090000
141000         MOVE 'PO NBR MISSING' TO PV-HOLD-TR221-ERROR-MSG         14100000
141100         SET PS-EDI-RECORD-NO TO TRUE                             14110000
141200         PERFORM 3217-PROCESS-LOGVS-ERROR                         14120000
141300             UNTIL PS-NEW-VS      OR                              14130000
141400                   PS-END-OF-INPUT                                14140000
141500         SET PS-NEW-VS-NO    TO TRUE                              14150000
141600     END-IF.                                                      14160000
141700                                                                  14170000
141800******************************************************************14180000
141900* THERE WAS A VS LEVEL ERROR -- BYPASS THE UPC RECORDS THAT ARE  *14190000
142000* RELATED TO THIS VENDOR STYLE.                                  *14200000
142100******************************************************************14210000
142200 3217-PROCESS-LOGVS-ERROR.                                        14220000
142300                                                                  14230000
142400     IF PS-EDI-RECORD-NO                                          14240000
142500         PERFORM 3500-CHECK-MOVE-TO-REPORT                        14250000
142600     END-IF.                                                      14260000
142700                                                                  14270000
142800     READ TR015-RECEIVING-FILE                                    14280000
142900         INTO TR015-REC-TYP-ERD                                   14290000
143000         AT END                                                   14300000
143100           SET PS-END-OF-INPUT TO TRUE.                           14310000
143200                                                                  14320000
143300     MOVE TR015-RECEIVING-RECORD (1:3) TO PV-EDI-RECORDS.         14330000
143400     IF EDI-RECORD                                                14340000
143500         SET PS-EDI-RECORD   TO TRUE                              14350000
143600         PERFORM 6030-PROCESS-EDI-RECORD                          14360000
143700     ELSE                                                         14370000
143800         SET PS-EDI-RECORD-NO         TO TRUE                     14380000
143900         ADD +1 TO PV-PROCESS-SEQ-NBR                             14390000
144101         IF (TR015-LOGVS-PO-NBR-X         NOT EQUAL               14410100
144110             PV-HOLD-PO-NBR-X)                        OR          14411000
144200            (TR015-LOGVS-EXTL-REF-NBR     NOT EQUAL               14420000
144300             PV-HOLD-EXTL-REF-NBR)                    OR          14430000
144400            (TR015-LOGVS-PO-RCVD-DELY-DTE NOT EQUAL               14440000
144500             PV-HOLD-PO-RCVD-DELY-DTE)                OR          14450000
144600            (TR015-LOGVS-ORGN-SHPD-FR-CDE NOT EQUAL               14460000
144700             PV-HOLD-ORGN-SHPD-FR-CDE)                OR          14470000
144800            (TR015-LOGVS-TRN-TYP          NOT EQUAL               14480000
144900             PV-HOLD-LAST-TRN-TYP)                    OR          14490000
145000            (TR015-LOGVS-VS-NBR           NOT EQUAL               14500000
145100             PV-HOLD-VS-NBR)                                      14510000
145200            SET PS-NEW-VS         TO TRUE                         14520000
145300            PERFORM 4900-RESET-WRITE-SWITCHES                     14530000
145400         END-IF                                                   14540000
145500     END-IF.                                                      14550000
145600                                                                  14560000
145700     IF (TR015-ERD-REC-TYP-CDE = PC-ERD  AND                      14570000
145800         TR015-ERD-TRN-TYP NOT = PC-D)         OR                 14580000
145900        (TR015-ERD-REC-TYP-CDE = PC-LOG  AND                      14590000
146000         TR015-ERD-TRN-TYP     = PC-D)                            14600000
146100         SET PS-NEW-GROUP TO TRUE                                 14610000
146200     END-IF.                                                      14620000
146300                                                                  14630000
146400     IF PS-END-OF-INPUT-NO                                        14640000
146500         ADD +1 TO PA-RCVD-INPUT-COUNT                            14650000
146600         MOVE TR015-REC-TYP-ERD (1:3) TO PV-HOLD-LAST-REC-TYP     14660000
146700     END-IF.                                                      14670000
146800                                                                  14680000
146900******************************************************************14690000
147000* PROCESS THE LOGUPC LEVEL RECORDS.                              *14700000
147100* DETERMINE TRAN TYPE  (ADD, CHANGE, OR DELETE).                 *14710000
147200******************************************************************14720000
147300 3400-PROCESS-LOGUPC-REC.                                         14730000
147400                                                                  14740000
147500     MOVE TR015-LOGUPC-TRN-TYP        TO PV-EVAL-TRN-TYP-CDE.     14750000
147600                                                                  14760000
147700     EVALUATE TRUE                                                14770000
147800         WHEN TRN-TYP-ADD                                         14780000
147900             PERFORM 3410-PROCESS-LOGUPC-ADD-CHG                  14790000
148000                                                                  14800000
148100         WHEN TRN-TYP-CHG                                         14810000
148200             PERFORM 3410-PROCESS-LOGUPC-ADD-CHG                  14820000
148300                                                                  14830000
148400         WHEN OTHER                                               14840000
148500             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            14850000
148600             MOVE TR015-LOGUPC-PO-NBR              TO             14860000
148700                   PV-HOLD-TR221-PO-NBR                           14870000
148800             MOVE TR015-LOGUPC-EXTL-REF-NBR        TO             14880000
148900                   PV-HOLD-TR221-EXTL-REF-NBR                     14890000
149000             MOVE TR015-LOGUPC-PO-RCVD-DELY-DTE    TO             14900000
149100                   PV-HOLD-TR221-PO-RCVD-DELY-DTE                 14910000
149200             MOVE TR015-LOGUPC-PO-RCVD-DELY-TM     TO             14920000
149300                   PV-HOLD-TR221-PO-RCVD-DELY-TM                  14930000
149400             MOVE TR015-LOGUPC-ORGN-SHPD-FR-CDE      TO           14940000
149500                   PV-HOLD-TR221-ORGN-SHPD-FR-CDE                 14950000
149600             MOVE TR015-LOGUPC-TRN-TYP             TO             14960000
149700                   PV-HOLD-TR221-DATA-VALUE                       14970000
149800                   PV-HOLD-TR221-TRN-TYP                          14980000
149900             MOVE 'TRAN TYPE-UPC'                  TO             14990000
150000                   PV-HOLD-TR221-DATA-IN-ERROR                    15000000
150100             MOVE 'INVALID TRAN TYPE'              TO             15010000
150200                   PV-HOLD-TR221-ERROR-MSG                        15020000
150300             SET PS-EDI-RECORD-NO TO TRUE                         15030000
150400             PERFORM 3417-PROCESS-LOGUPC-ERROR                    15040000
150500                 UNTIL PS-NEW-UPC OR                              15050000
150600                       PS-END-OF-INPUT                            15060000
150700             SET PS-NEW-UPC-NO    TO TRUE                         15070000
150800                                                                  15080000
150900     END-EVALUATE.                                                15090000
151000                                                                  15100000
151100******************************************************************15110000
151200* PROCESS UPC RECORD ADD AND CHANGE TRANSACTIONS.                *15120000
151300******************************************************************15130000
151400 3410-PROCESS-LOGUPC-ADD-CHG.                                     15140000
151500                                                                  15150000
151600     IF TR015-LOGUPC-TRN-TYP = PC-A                               15160000
151700         MOVE PC-A                 TO PV-HOLD-TR221-TRN-TYP       15170000
151800     ELSE                                                         15180000
151900         MOVE PC-C                 TO PV-HOLD-TR221-TRN-TYP       15190000
152000     END-IF.                                                      15200000
152100                                                                  15210000
152210     IF TR015-LOGUPC-PO-NBR-X = PV-HOLD-PO-NBR-X                  15221000
152300       IF TR015-LOGUPC-VS-NBR = PV-HOLD-VS-NBR                    15230000
152400           PERFORM 5040-MOVE-TR015-LOGUPC-TO-HOLD                 15240000
152500           PERFORM 5340-LOAD-LOGUPC-FIELDS-UPDATE                 15250000
152600           EVALUATE PV-TR015-LOGVS-TRN-TYP                        15260000
152700               WHEN PC-C                                          15270000
152800                   ADD +1 TO PA-TOT-RCUP-RECS-CHANGE              15280000
152900               WHEN PC-A                                          15290000
153000                   ADD +1 TO PA-TOT-RCUP-RECS-ADD                 15300000
153100           END-EVALUATE                                           15310000
153200           PERFORM 6000-READ-RECEIVING-FILE                       15320000
153300               UNTIL PS-GOOD-RECORD  OR                           15330000
153400                     PS-END-OF-INPUT                              15340000
153500           SET PS-GOOD-RECORD-NO TO TRUE                          15350000
153600       ELSE                                                       15360000
153700           MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE              15370000
153800           MOVE TR015-LOGUPC-VS-NBR TO PV-HOLD-TR221-DATA-VALUE   15380000
153900           MOVE 'VENDOR STYLE'              TO                    15390000
154000                 PV-HOLD-TR221-DATA-IN-ERROR                      15400000
154100           MOVE 'UPC VENDOR STYLE MISSING'  TO                    15410000
154200                 PV-HOLD-TR221-ERROR-MSG                          15420000
154300           SET PS-EDI-RECORD-NO TO TRUE                           15430000
154400           PERFORM 3417-PROCESS-LOGUPC-ERROR                      15440000
154500               UNTIL PS-NEW-UPC     OR                            15450000
154600                     PS-END-OF-INPUT                              15460000
154700           SET PS-NEW-UPC-NO   TO TRUE                            15470000
154800       END-IF                                                     15480000
154900     ELSE                                                         15490000
155000         MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE                15500000
155100         MOVE TR015-LOGUPC-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     15510000
155200         MOVE 'PO NUMBER'         TO PV-HOLD-TR221-DATA-IN-ERROR  15520000
155300         MOVE 'UPC PO NBR MISSING' TO PV-HOLD-TR221-ERROR-MSG     15530000
155400         SET PS-EDI-RECORD-NO TO TRUE                             15540000
155500         PERFORM 3417-PROCESS-LOGUPC-ERROR                        15550000
155600             UNTIL PS-NEW-UPC     OR                              15560000
155700                   PS-END-OF-INPUT                                15570000
155800         SET PS-NEW-UPC-NO   TO TRUE                              15580000
155900     END-IF.                                                      15590000
156000                                                                  15600000
156100******************************************************************15610000
156200* THERE WAS A UPC LEVEL ERROR - BYPASS THE UPC RECORDS THAT ARE  *15620000
156300* RELATED TO THIS UPC.                                           *15630000
156400******************************************************************15640000
156500 3417-PROCESS-LOGUPC-ERROR.                                       15650000
156600                                                                  15660000
156700     IF PS-EDI-RECORD-NO                                          15670000
156800         PERFORM 3500-CHECK-MOVE-TO-REPORT                        15680000
156900     END-IF.                                                      15690000
157000                                                                  15700000
157100     READ TR015-RECEIVING-FILE                                    15710000
157200         INTO TR015-REC-TYP-ERD                                   15720000
157300         AT END                                                   15730000
157400           SET PS-END-OF-INPUT TO TRUE.                           15740000
157500                                                                  15750000
157600     MOVE TR015-RECEIVING-RECORD (1:3) TO PV-EDI-RECORDS.         15760000
157700     IF EDI-RECORD                                                15770000
157800         SET PS-EDI-RECORD TO TRUE                                15780000
157900         PERFORM 6030-PROCESS-EDI-RECORD                          15790000
158000     ELSE                                                         15800000
158100         SET PS-EDI-RECORD-NO          TO TRUE                    15810000
158200         ADD +1 TO PV-PROCESS-SEQ-NBR                             15820000
158401         IF (TR015-LOGUPC-PO-NBR-X         NOT EQUAL              15840100
158410             PV-HOLD-PO-NBR-X)                        OR          15841000
158500            (TR015-LOGUPC-UPC-NBR          NOT EQUAL              15850000
158600             PV-HOLD-UPC-NBR)                         OR          15860000
158700            (TR015-LOGUPC-VS-NBR           NOT EQUAL              15870000
158800             PV-HOLD-VS-NBR)                          OR          15880000
158900            (TR015-LOGUPC-EXTL-REF-NBR     NOT EQUAL              15890000
159000             PV-HOLD-EXTL-REF-NBR)                    OR          15900000
159100            (TR015-LOGUPC-PO-RCVD-DELY-DTE NOT EQUAL              15910000
159200             PV-HOLD-PO-RCVD-DELY-DTE)                OR          15920000
159300            (TR015-LOGUPC-ORGN-SHPD-FR-CDE NOT EQUAL              15930000
159400             PV-HOLD-ORGN-SHPD-FR-CDE)                OR          15940000
159500            (TR015-LOGUPC-TRN-TYP          NOT EQUAL              15950000
159600             PV-HOLD-LAST-TRN-TYP)                                15960000
159700            SET PS-NEW-UPC        TO TRUE                         15970000
159800            PERFORM 4900-RESET-WRITE-SWITCHES                     15980000
159900         END-IF                                                   15990000
160000     END-IF.                                                      16000000
160100                                                                  16010000
160200     IF (TR015-ERD-REC-TYP-CDE = PC-ERD  AND                      16020000
160300         TR015-ERD-TRN-TYP NOT = PC-D)         OR                 16030000
160400        (TR015-ERD-REC-TYP-CDE = PC-LOG  AND                      16040000
160500         TR015-ERD-TRN-TYP     = PC-D)                            16050000
160600         SET PS-NEW-GROUP TO TRUE                                 16060000
160700     END-IF.                                                      16070000
160800                                                                  16080000
160900     IF PS-END-OF-INPUT-NO                                        16090000
161000         ADD +1 TO PA-RCVD-INPUT-COUNT                            16100000
161100         MOVE TR015-REC-TYP-ERD (1:3) TO PV-HOLD-LAST-REC-TYP     16110000
161200     END-IF.                                                      16120000
161300                                                                  16130000
161400******************************************************************16140000
161500* WRITE RECORDS OUT TO THE ERROR REPORT FILE  DEPENDING ON THE   *16150000
161600* RECORD TYPE CODE.                                              *16160000
161700******************************************************************16170000
161800 3500-CHECK-MOVE-TO-REPORT.                                       16180000
161900                                                                  16190000
162000     MOVE TR015-ERD-REC-TYP-CDE TO PV-HOLD-REC-TYP-CDE.           16200000
162100                                                                  16210000
162200     EVALUATE TRUE                                                16220000
162300         WHEN REC-TYP-ERD                                         16230000
162400             PERFORM 5000-MOVE-TR015-ERD-TO-HOLD                  16240000
162500             PERFORM 5500-LOAD-ERD-TO-REPORT                      16250000
162600         WHEN REC-TYP-ERDRSN                                      16260000
162700             PERFORM 5010-MOVE-TR015-ERDRSN-TO-HOLD               16270000
162800             PERFORM 5510-LOAD-ERDRSN-TO-REPORT                   16280000
162900         WHEN REC-TYP-LOG                                         16290000
163000             PERFORM 5020-MOVE-TR015-LOG-TO-HOLD                  16300000
163100             PERFORM 5520-LOAD-LOG-TO-REPORT                      16310000
163200         WHEN REC-TYP-LOGVS                                       16320000
163300             PERFORM 5030-MOVE-TR015-LOGVS-TO-HOLD                16330000
163400             PERFORM 5530-LOAD-LOGVS-TO-REPORT                    16340000
163500         WHEN REC-TYP-LOGUPC                                      16350000
163600             PERFORM 5040-MOVE-TR015-LOGUPC-TO-HOLD               16360000
163700             PERFORM 5540-LOAD-LOGUPC-TO-REPORT                   16370000
163800     END-EVALUATE.                                                16380000
163900                                                                  16390000
164000******************************************************************16400000
164100* MOVE ERD RECORD KEY FIELDS TO HOLD AREA.                       *16410000
164200******************************************************************16420000
164300 4000-MOVE-TO-ERD-HOLD.                                           16430000
164400                                                                  16440000
164510     MOVE TR015-ERD-PO-NBR-X        TO PV-HOLD-PO-NBR-X.          16451000
164600     MOVE TR015-ERD-EXTL-REF-NBR    TO PV-HOLD-EXTL-REF-NBR.      16460000
164700     MOVE TR015-ERD-PO-RCVD-DELY-DTE TO PV-HOLD-PO-RCVD-DELY-DTE. 16470000
164800     MOVE TR015-ERD-PO-RCVD-DELY-TM TO PV-HOLD-PO-RCVD-DELY-TM.   16480000
164900     MOVE TR015-ERD-ORGN-SHPD-FR-CDE TO PV-HOLD-ORGN-SHPD-FR-CDE. 16490000
165000     MOVE TR015-ERD-TRN-TYP         TO PV-HOLD-LAST-TRN-TYP.      16500000
165100                                                                  16510000
165200******************************************************************16520000
165300* MOVE LOGVS RECORD KEY FIELDS TO HOLD AREA.                     *16530000
165400******************************************************************16540000
165500 4010-MOVE-TO-LOGVS-HOLD.                                         16550000
165600                                                                  16560000
165710     MOVE TR015-LOGVS-PO-NBR-X        TO PV-HOLD-PO-NBR-X.        16571000
165800     MOVE TR015-LOGVS-EXTL-REF-NBR    TO PV-HOLD-EXTL-REF-NBR.    16580000
165900     MOVE TR015-LOGVS-PO-RCVD-DELY-DTE TO                         16590000
166000                                      PV-HOLD-PO-RCVD-DELY-DTE.   16600000
166100     MOVE TR015-LOGVS-PO-RCVD-DELY-TM TO PV-HOLD-PO-RCVD-DELY-TM. 16610000
166200     MOVE TR015-LOGVS-ORGN-SHPD-FR-CDE TO                         16620000
166300                                      PV-HOLD-ORGN-SHPD-FR-CDE.   16630000
166400     MOVE TR015-LOGVS-VS-NBR          TO PV-HOLD-VS-NBR.          16640000
166500     MOVE TR015-LOGVS-TRN-TYP         TO PV-HOLD-LAST-TRN-TYP.    16650000
166600                                                                  16660000
166700******************************************************************16670000
166800* MOVE LOGUPC RECORD KEY FIELDS TO HOLD AREA.                    *16680000
166900******************************************************************16690000
167000 4020-MOVE-TO-LOGUPC-HOLD.                                        16700000
167100                                                                  16710000
167210     MOVE TR015-LOGUPC-PO-NBR-X        TO PV-HOLD-PO-NBR-X.       16721000
167300     MOVE TR015-LOGUPC-EXTL-REF-NBR    TO PV-HOLD-EXTL-REF-NBR.   16730000
167400     MOVE TR015-LOGUPC-PO-RCVD-DELY-DTE TO                        16740000
167500           PV-HOLD-PO-RCVD-DELY-DTE.                              16750000
167600     MOVE TR015-LOGUPC-PO-RCVD-DELY-TM TO                         16760000
167700           PV-HOLD-PO-RCVD-DELY-TM.                               16770000
167800     MOVE TR015-LOGUPC-ORGN-SHPD-FR-CDE TO                        16780000
167900                                      PV-HOLD-ORGN-SHPD-FR-CDE.   16790000
168000     MOVE TR015-LOGUPC-VS-NBR          TO PV-HOLD-VS-NBR.         16800000
168100     MOVE TR015-LOGUPC-UPC-NBR         TO PV-HOLD-UPC-NBR.        16810000
168200     MOVE TR015-LOGUPC-TRN-TYP         TO PV-HOLD-LAST-TRN-TYP.   16820000
168300                                                                  16830000
168400******************************************************************16840000
168500* EDIT KEY FIELDS ON ERD, ERDRSN, AND LOG RECORDS.               *16850000
168600* CHECK FOR NUMERIC AND NOT BLANK ON PO NUMBER.                  *16860000
168700* CHECK FOR SPACES ON PO RECEIVED DELIVERY DATE AND TIME.        *16870000
168800* CHECK FOR SPACES AND EQUAL TO CFS OR CY ON ORGN SHPD FROM CODE.*16880000
168900******************************************************************16890000
169000 4100-EDIT-ERD-LOG-KEY-FIELDS.                                    16900000
169100                                                                  16910000
169200     SET PS-FIELDS-OK TO TRUE.                                    16920000
169300                                                                  16930000
169400     EVALUATE TRUE                                                16940000
169500                                                                  16950000
169510        WHEN (TR015-ERD-PO-NBR           EQUAL ZEROES  OR         16951000
169520              TR015-ERD-PO-NBR           NOT NUMERIC)  AND        16952000
169530              TR015-ERD-PO-RCVD-DELY-DTE EQUAL SPACES  AND        16953000
169531              TR015-ERD-EXTL-REF-NBR EQUAL SPACES      AND        16953100
169540             (TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES  OR         16954000
169550              (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    16955000
169560               TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       16956000
169570            SET PS-FIELDS-NOT-OK TO TRUE                          16957000
169580            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     16958000
169590            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             16959000
169591            MOVE 'PO/DLY/REF/SHPD' TO PV-HOLD-TR221-DATA-IN-ERROR 16959100
169592            MOVE                                                  16959200
169593              'PO, DELY DTE, REF NBR, & ORG SHP FR DATA NOT SENT' 16959300
169594                 TO PV-HOLD-TR221-ERROR-MSG                       16959400
169595                                                                  16959500
169600        WHEN (TR015-ERD-PO-NBR           EQUAL ZEROES  OR         16960000
169700              TR015-ERD-PO-NBR           NOT NUMERIC)  AND        16970000
169800             TR015-ERD-PO-RCVD-DELY-DTE EQUAL SPACES   AND        16980000
169900             (TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES  OR         16990000
170000              (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17000000
170100               TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17010000
170200            SET PS-FIELDS-NOT-OK TO TRUE                          17020000
170300            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17030000
170400            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17040000
170500            MOVE 'PO/DELY DT/SHPD' TO PV-HOLD-TR221-DATA-IN-ERROR 17050000
170600            MOVE 'PO, RCVD DELY DTE, & ORG SHP FR DATA NOT SENT'  17060000
170700                  TO PV-HOLD-TR221-ERROR-MSG                      17070000
170800                                                                  17080000
170810        WHEN (TR015-ERD-PO-NBR           EQUAL ZEROES  OR         17081000
170820              TR015-ERD-PO-NBR           NOT NUMERIC)  AND        17082000
170830             TR015-ERD-EXTL-REF-NBR EQUAL SPACES       AND        17083000
170840             (TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES  OR         17084000
170850              (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17085000
170860               TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17086000
170870            SET PS-FIELDS-NOT-OK TO TRUE                          17087000
170880            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17088000
170890            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17089000
170891            MOVE 'PO/REF NBR/SHPD' TO PV-HOLD-TR221-DATA-IN-ERROR 17089100
170892            MOVE 'PO, REF NBR, & ORG SHP FR DATA NOT SENT'        17089200
170893                  TO PV-HOLD-TR221-ERROR-MSG                      17089300
170894                                                                  17089400
170896        WHEN (TR015-ERD-PO-NBR           EQUAL ZEROES  OR         17089600
170897              TR015-ERD-PO-NBR           NOT NUMERIC)  AND        17089700
170898             TR015-ERD-PO-RCVD-DELY-DTE EQUAL SPACES   AND        17089800
170899             TR015-ERD-EXTL-REF-NBR EQUAL SPACES                  17089900
170902            SET PS-FIELDS-NOT-OK TO TRUE                          17090200
170903            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17090300
170904            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17090400
170905            MOVE 'PO/DELY DT/REF ' TO PV-HOLD-TR221-DATA-IN-ERROR 17090500
170906            MOVE 'PO, RCVD DELY DTE, & REF NBR DATA NOT SENT'     17090600
170907                  TO PV-HOLD-TR221-ERROR-MSG                      17090700
170908                                                                  17090800
170910        WHEN (TR015-ERD-PO-NBR             EQUAL ZEROES  OR       17091000
171000              TR015-ERD-PO-NBR             NOT NUMERIC)  AND      17100000
171100              TR015-ERD-PO-RCVD-DELY-DTE   EQUAL SPACES           17110000
171200            SET PS-FIELDS-NOT-OK TO TRUE                          17120000
171300            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17130000
171400            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17140000
171500            MOVE 'PO NBR/DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR 17150000
171600            MOVE 'PO NUMBER AND RCVD DELIVERY DATE NOT SENT'      17160000
171700                  TO PV-HOLD-TR221-ERROR-MSG                      17170000
171800                                                                  17180000
171900        WHEN (TR015-ERD-PO-NBR          EQUAL ZEROES  OR          17190000
172000              TR015-ERD-PO-NBR          NOT NUMERIC)  AND         17200000
172100             (TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES     OR      17210000
172200              (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17220000
172300               TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17230000
172400            SET PS-FIELDS-NOT-OK TO TRUE                          17240000
172500            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17250000
172600            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17260000
172700            MOVE 'PO NBR/ORG SHPD' TO PV-HOLD-TR221-DATA-IN-ERROR 17270000
172800            MOVE 'PO NUMBER AND ORG SHPD FROM DATA NOT SENT'      17280000
172900                  TO PV-HOLD-TR221-ERROR-MSG                      17290000
173000                                                                  17300000
173010        WHEN (TR015-ERD-PO-NBR             EQUAL ZEROES  OR       17301000
173020              TR015-ERD-PO-NBR             NOT NUMERIC)  AND      17302000
173030              TR015-ERD-EXTL-REF-NBR       EQUAL SPACES           17303000
173040            SET PS-FIELDS-NOT-OK TO TRUE                          17304000
173050            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17305000
173060            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17306000
173070            MOVE 'PO NBR/REF NBR ' TO PV-HOLD-TR221-DATA-IN-ERROR 17307000
173080            MOVE 'PO NUMBER AND REFERENCE NUMBER NOT SENT'        17308000
173090                  TO PV-HOLD-TR221-ERROR-MSG                      17309000
173091                                                                  17309100
173100        WHEN TR015-ERD-PO-RCVD-DELY-DTE  EQUAL SPACES   AND       17310000
173200             (TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES   OR        17320000
173300              (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17330000
173400               TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17340000
173500            SET PS-FIELDS-NOT-OK TO TRUE                          17350000
173600            MOVE TR015-ERD-PO-RCVD-DELY-DTE TO                    17360000
173700                  PV-HOLD-TR221-DATA-VALUE                        17370000
173800            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17380000
173900            MOVE 'DELY DT/ORG SHP' TO PV-HOLD-TR221-DATA-IN-ERROR 17390000
174000            MOVE 'RCVD DELY DTE AND ORG SHPD FROM DATA NOT SENT'  17400000
174100                  TO PV-HOLD-TR221-ERROR-MSG                      17410000
174200                                                                  17420000
174202        WHEN TR015-ERD-PO-RCVD-DELY-DTE  EQUAL SPACES   AND       17420200
174203             TR015-ERD-EXTL-REF-NBR EQUAL SPACES                  17420300
174206            SET PS-FIELDS-NOT-OK TO TRUE                          17420600
174207            MOVE TR015-ERD-PO-RCVD-DELY-DTE TO                    17420700
174208                  PV-HOLD-TR221-DATA-VALUE                        17420800
174209            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17420900
174210            MOVE 'DELY DT/REF NBR' TO PV-HOLD-TR221-DATA-IN-ERROR 17421000
174211            MOVE 'RCVD DELY DTE AND REFERENCE NBR DATA NOT SENT'  17421100
174212                  TO PV-HOLD-TR221-ERROR-MSG                      17421200
174213                                                                  17421300
174215        WHEN TR015-ERD-EXTL-REF-NBR      EQUAL SPACES   AND       17421500
174216             (TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES   OR        17421600
174217              (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND    17421700
174218               TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY))       17421800
174219            SET PS-FIELDS-NOT-OK TO TRUE                          17421900
174220            MOVE TR015-ERD-EXTL-REF-NBR TO                        17422000
174221                  PV-HOLD-TR221-DATA-VALUE                        17422100
174222            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17422200
174223            MOVE 'REF NBR/ORG SHP' TO PV-HOLD-TR221-DATA-IN-ERROR 17422300
174224            MOVE 'REFERENCE NBR AND ORG SHPD FROM DATA NOT SENT'  17422400
174225                  TO PV-HOLD-TR221-ERROR-MSG                      17422500
174226                                                                  17422600
174227        WHEN TR015-ERD-PO-NBR-X EQUAL SPACES OR ZEROES            17422700
174228            SET PS-FIELDS-NOT-OK TO TRUE                          17422800
174229            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17422900
174230            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17423000
174231            MOVE 'PO NBR' TO PV-HOLD-TR221-DATA-IN-ERROR          17423100
174232            MOVE 'PO NUMBER NOT SENT' TO PV-HOLD-TR221-ERROR-MSG  17423200
174233                                                                  17423300
174234        WHEN TR015-ERD-PO-NBR-X NOT NUMERIC                       17423400
174235            SET PS-FIELDS-NOT-OK TO TRUE                          17423500
174236            MOVE TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE     17423600
174237            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17423700
174238            MOVE 'PO NBR' TO PV-HOLD-TR221-DATA-IN-ERROR          17423800
174240            MOVE 'INVALID PO NUMBER' TO PV-HOLD-TR221-ERROR-MSG   17424000
175000                                                                  17500000
175100        WHEN TR015-ERD-PO-RCVD-DELY-DTE EQUAL SPACES              17510000
175200            SET PS-FIELDS-NOT-OK TO TRUE                          17520000
175300            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17530000
175400            MOVE TR015-ERD-PO-RCVD-DELY-DTE TO                    17540000
175500                  PV-HOLD-TR221-DATA-VALUE                        17550000
175600            MOVE 'RCVD DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR   17560000
175700            MOVE 'RCVD DELIVERY DATE NOT SENT' TO                 17570000
175800                  PV-HOLD-TR221-ERROR-MSG                         17580000
175900                                                                  17590000
176000        WHEN  TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES             17600000
176100        WHEN (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS AND     17610000
176200               TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CY)        17620000
176300            SET PS-FIELDS-NOT-OK TO TRUE                          17630000
176400            MOVE TR015-ERD-ORGN-SHPD-FR-CDE  TO                   17640000
176500                  PV-HOLD-TR221-DATA-VALUE                        17650000
176600            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17660000
176700            MOVE 'ORGN SHPD FR CD' TO PV-HOLD-TR221-DATA-IN-ERROR 17670000
176800            MOVE 'ORGN SHPD FROM DATA NOT SENT'                   17680000
176900                  TO PV-HOLD-TR221-ERROR-MSG                      17690000
177000                                                                  17700000
177010        WHEN TR015-ERD-EXTL-REF-NBR EQUAL SPACES                  17701000
177020            SET PS-FIELDS-NOT-OK TO TRUE                          17702000
177030            MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE             17703000
177040            MOVE TR015-ERD-EXTL-REF-NBR TO                        17704000
177050                  PV-HOLD-TR221-DATA-VALUE                        17705000
177060            MOVE 'REFERENCE NBR' TO PV-HOLD-TR221-DATA-IN-ERROR   17706000
177070            MOVE 'REFERENCE NUMBER NOT SENT' TO                   17707000
177080                  PV-HOLD-TR221-ERROR-MSG                         17708000
177090                                                                  17709000
177100     END-EVALUATE.                                                17710000
177200                                                                  17720000
177300     MOVE PC-DEFAULT-TIME TO PV-TR015-ERD-PO-RCVD-DELY-TM.        17730000
177400                                                                  17740000
177500     IF TR015-ERD-PO-RCVD-DELY-DTE NOT EQUAL SPACES               17750000
177600         MOVE TR015-ERD-PO-RCVD-DELY-DTE   TO PV-RCVD-DELY-DTE    17760000
177700         MOVE PV-TR015-ERD-PO-RCVD-DELY-TM TO PV-RCVD-DELY-TM     17770000
177800         PERFORM 5715-FORMAT-RCVD-DELY-TMST                       17780000
177900         EVALUATE TRUE                                            17790000
178000             WHEN PS-WARNING-DATE                                 17800000
178100                 SET PS-FIELDS-NOT-OK TO TRUE                     17810000
178200                 MOVE TR015-ERD-PO-RCVD-DELY-DTE TO               17820000
178300                       PV-HOLD-TR221-DATA-VALUE                   17830000
178400                 MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE        17840000
178500                 MOVE 'RCVD DELY DTE'           TO                17850000
178600                       PV-HOLD-TR221-DATA-IN-ERROR                17860000
178700                 MOVE 'INVALID DELIVERY DATE'   TO                17870000
178800                       PV-HOLD-TR221-ERROR-MSG                    17880000
178900                                                                  17890000
179000             WHEN PS-WARNING-TIME                                 17900000
179100                 SET PS-FIELDS-NOT-OK TO TRUE                     17910000
179200                 MOVE TR015-ERD-PO-RCVD-DELY-TM TO                17920000
179300                       PV-HOLD-TR221-DATA-VALUE                   17930000
179400                 MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE        17940000
179500                 MOVE 'RCVD DELY TM'            TO                17950000
179600                       PV-HOLD-TR221-DATA-IN-ERROR                17960000
179700                 MOVE 'INVALID DELIVERY TIME'   TO                17970000
179800                       PV-HOLD-TR221-ERROR-MSG                    17980000
179900         END-EVALUATE                                             17990000
180000     END-IF.                                                      18000000
180100                                                                  18010000
180200     SET PS-WARNING-DATE-NO TO TRUE.                              18020000
180300     SET PS-WARNING-TIME-NO TO TRUE.                              18030000
180400                                                                  18040000
180500******************************************************************18050000
180600* EDIT KEY FIELDS ON LOGVS RECORDS.                              *18060000
180700* CHECK FOR NUMERIC AND NOT BLANK PO NUMBER.                     *18070000
180800* CHECK FOR SPACES ON PO RECEIVED DELIVERY DATE AND TIME.        *18080000
180900* CHECK FOR SPACES AND EQUAL TO CFS OR CY ON ORGN SHPD FROM CODE.*18090000
181000* CHECK FOR SPACES ON VENDOR STYLE NUMBER.                       *18100000
181100******************************************************************18110000
181200 4110-EDIT-LOGVS-KEY-FIELDS.                                      18120000
181300                                                                  18130000
181400     PERFORM 4100-EDIT-ERD-LOG-KEY-FIELDS.                        18140000
181500                                                                  18150000
181600     IF TR015-LOGVS-VS-NBR  = SPACES                              18160000
181700         MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE                18170000
181800         MOVE TR015-LOGVS-VS-NBR  TO                              18180000
181900               PV-HOLD-TR221-DATA-VALUE                           18190000
182000         MOVE 'VS NUMBER     '    TO                              18200000
182100               PV-HOLD-TR221-DATA-IN-ERROR                        18210000
182200         MOVE 'INVALID VS NUMBER' TO                              18220000
182300               PV-HOLD-TR221-ERROR-MSG                            18230000
182400         SET PS-FIELDS-NOT-OK    TO TRUE                          18240000
182500     END-IF.                                                      18250000
182600                                                                  18260000
182700******************************************************************18270000
182800* EDIT KEY FIELDS ON LOGUPC RECORDS.                             *18280000
182900* CHECK FOR NUMERIC AND NOT BLANK PO NUMBER.                     *18290000
183000* CHECK FOR NUMERIC UPC NUMBER.                                  *18300000
183100* CHECK FOR SPACES ON PO RECEIVED DELIVERY DATE AND TIME.        *18310000
183200* CHECK FOR SPACES AND EQUAL TO CFS OR CY ON ORGN SHPD FROM CODE.*18320000
183300* CHECK FOR SPACES ON VENDOR STYLE NUMBER.                       *18330000
183400******************************************************************18340000
183500 4120-EDIT-LOGUPC-KEY-FIELDS.                                     18350000
183600                                                                  18360000
183700     PERFORM 4110-EDIT-LOGVS-KEY-FIELDS.                          18370000
183800                                                                  18380000
183900     IF TR015-LOGUPC-UPC-NBR NUMERIC AND                          18390000
184000        TR015-LOGUPC-UPC-NBR NOT = ZEROS                          18400000
184100         CONTINUE                                                 18410000
184200     ELSE                                                         18420000
184300         MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE                18430000
184400         MOVE TR015-LOGUPC-UPC-NBR  TO                            18440000
184500               PV-HOLD-TR221-DATA-VALUE                           18450000
184600         MOVE 'UPC NUMBER'          TO                            18460000
184700               PV-HOLD-TR221-DATA-IN-ERROR                        18470000
184800         MOVE 'INVALID UPC NUMBER'  TO                            18480000
184900               PV-HOLD-TR221-ERROR-MSG                            18490000
185000         SET PS-FIELDS-NOT-OK    TO TRUE                          18500000
185100     END-IF.                                                      18510000
185200                                                                  18520000
185300******************************************************************18530000
185400* PROCESS ERROR FOR ERD AND/OR LOG DATA MISSING.                 *18540000
185500******************************************************************18550000
185600 4200-ERD-LOG-DATA-MISSING-ERR.                                   18560000
185700                                                                  18570000
185800     PERFORM 4100-EDIT-ERD-LOG-KEY-FIELDS.                        18580000
185900                                                                  18590000
186000     IF PS-FIELDS-OK                                              18600000
186100         MOVE PC-ERROR           TO PV-HOLD-TR221-ERROR-TYPE      18610000
186200         MOVE TR015-LOGVS-PO-NBR TO PV-HOLD-TR221-DATA-VALUE      18620000
186300         MOVE 'PO LEVEL'         TO PV-HOLD-TR221-DATA-IN-ERROR   18630000
186400         MOVE 'ERD AND/OR LOG DATA MISSING' TO                    18640000
186500               PV-HOLD-TR221-ERROR-MSG                            18650000
186600     END-IF.                                                      18660000
186700                                                                  18670000
186800******************************************************************18680000
186900* PROCESS ERROR FOR LOGVS DATA MISSING.                          *18690000
187000******************************************************************18700000
187100 4210-LOGVS-DATA-MISSING-ERR.                                     18710000
187200                                                                  18720000
187300     PERFORM 4110-EDIT-LOGVS-KEY-FIELDS.                          18730000
187400                                                                  18740000
187500     IF PS-FIELDS-OK                                              18750000
187600         MOVE PC-ERROR             TO PV-HOLD-TR221-ERROR-TYPE    18760000
187700         MOVE TR015-LOGVS-VS-NBR   TO PV-HOLD-TR221-DATA-VALUE    18770000
187800         MOVE 'VS LEVEL'           TO PV-HOLD-TR221-DATA-IN-ERROR 18780000
187900         MOVE 'LOGVS DATA MISSING' TO PV-HOLD-TR221-ERROR-MSG     18790000
188000     END-IF.                                                      18800000
188100                                                                  18810000
188200******************************************************************18820000
188300* CHECK ERD AND LOG HOLD FIELDS WHEN READING THE RECEIVING FILE. *18830000
188400******************************************************************18840000
188500 4250-CHECK-ERD-LOG-HOLD-FIELDS.                                  18850000
188600                                                                  18860000
188710     IF TR015-ERD-PO-NBR-X         = PV-HOLD-PO-NBR-X         AND 18871000
188800        TR015-ERD-EXTL-REF-NBR     = PV-HOLD-EXTL-REF-NBR     AND 18880000
188900        TR015-ERD-PO-RCVD-DELY-DTE  = PV-HOLD-PO-RCVD-DELY-DTE AND18890000
189000        TR015-ERD-PO-RCVD-DELY-TM   = PV-HOLD-PO-RCVD-DELY-TM  AND18900000
189100        TR015-ERD-ORGN-SHPD-FR-CDE = PV-HOLD-ORGN-SHPD-FR-CDE AND 18910000
189200        TR015-ERD-TRN-TYP          = PV-HOLD-LAST-TRN-TYP         18920000
189300         SET PS-SAME-INPUT-FIELDS TO TRUE                         18930000
189400     ELSE                                                         18940000
189500         SET PS-NOT-SAME-INPUT-FIELDS TO TRUE                     18950000
189600     END-IF.                                                      18960000
189700                                                                  18970000
189800******************************************************************18980000
189900* CHECK UPC HOLD FIELDS WHEN READING THE RECEIVING FILE.         *18990000
190000******************************************************************19000000
190100 4260-CHECK-LOGVS-HOLD-FIELDS.                                    19010000
190200                                                                  19020000
190310     IF TR015-LOGUPC-PO-NBR-X        = PV-HOLD-PO-NBR-X     AND   19031000
190400        TR015-LOGUPC-EXTL-REF-NBR    = PV-HOLD-EXTL-REF-NBR AND   19040000
190500        TR015-LOGUPC-PO-RCVD-DELY-DTE =                           19050000
190600                            PV-HOLD-PO-RCVD-DELY-DTE        AND   19060000
190700        TR015-LOGUPC-ORGN-SHPD-FR-CDE =                           19070000
190800                            PV-HOLD-ORGN-SHPD-FR-CDE        AND   19080000
190900        TR015-LOGUPC-VS-NBR          = PV-HOLD-VS-NBR       AND   19090000
191000        TR015-LOGUPC-TRN-TYP         = PV-HOLD-LAST-TRN-TYP       19100000
191100         SET PS-SAME-INPUT-FIELDS TO TRUE                         19110000
191200     ELSE                                                         19120000
191300         SET PS-NOT-SAME-INPUT-FIELDS TO TRUE                     19130000
191400     END-IF.                                                      19140000
191500                                                                  19150000
191600******************************************************************19160000
191700* PROCESS PROPER ERROR WHEN THE HOLD FIELDS DO NOT EQUAL THE     *19170000
191800* CURRENT INPUT FIELDS.                                          *19180000
191900******************************************************************19190000
192000 4300-DIFFERENT-INPUT-FIELDS.                                     19200000
192100                                                                  19210000
192200     MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE.                   19220000
192300                                                                  19230000
192400     IF REC-TYP-LOGVS                                             19240000
192500         EVALUATE TRUE                                            19250000
192701             WHEN TR015-LOGVS-PO-NBR-X        NOT EQUAL           19270100
192710                   PV-HOLD-PO-NBR-X                               19271000
192800                 MOVE TR015-LOGVS-PO-NBR                      TO  19280000
192900                       PV-HOLD-TR221-DATA-VALUE                   19290000
193000                 MOVE 'PO NUMBER'                             TO  19300000
193100                       PV-HOLD-TR221-DATA-IN-ERROR                19310000
193200                 MOVE 'ERD AND/OR LOG DATA MISSING'           TO  19320000
193300                       PV-HOLD-TR221-ERROR-MSG                    19330000
193400                                                                  19340000
193500             WHEN TR015-LOGVS-EXTL-REF-NBR    NOT EQUAL           19350000
193600                   PV-HOLD-EXTL-REF-NBR                           19360000
193700                 MOVE TR015-LOGVS-EXTL-REF-NBR                TO  19370000
193800                       PV-HOLD-TR221-DATA-VALUE                   19380000
193900                 MOVE 'EXTL REF NBR'                          TO  19390000
194000                       PV-HOLD-TR221-DATA-IN-ERROR                19400000
194100                 MOVE 'ERD AND/OR LOG DATA MISSING'           TO  19410000
194200                       PV-HOLD-TR221-ERROR-MSG                    19420000
194300                                                                  19430000
194400             WHEN TR015-LOGVS-PO-RCVD-DELY-DTE NOT EQUAL          19440000
194500                   PV-HOLD-PO-RCVD-DELY-DTE                       19450000
194600                 MOVE TR015-LOGVS-PO-RCVD-DELY-DTE            TO  19460000
194700                       PV-HOLD-TR221-DATA-VALUE                   19470000
194800                 MOVE 'RCVD DELY DTE'                         TO  19480000
194900                       PV-HOLD-TR221-DATA-IN-ERROR                19490000
195000                 MOVE 'ERD AND/OR LOG DATA MISSING'           TO  19500000
195100                       PV-HOLD-TR221-ERROR-MSG                    19510000
195200                                                                  19520000
195300             WHEN TR015-LOGVS-ORGN-SHPD-FR-CDE NOT EQUAL          19530000
195400                   PV-HOLD-ORGN-SHPD-FR-CDE                       19540000
195500                 MOVE TR015-LOGVS-ORGN-SHPD-FR-CDE            TO  19550000
195600                       PV-HOLD-TR221-DATA-VALUE                   19560000
195700                 MOVE 'ORGN SHP FR CDE'                       TO  19570000
195800                       PV-HOLD-TR221-DATA-IN-ERROR                19580000
195900                 MOVE 'ERD AND/OR LOG DATA MISSING'           TO  19590000
196000                       PV-HOLD-TR221-ERROR-MSG                    19600000
196100                                                                  19610000
196200             WHEN TR015-LOGVS-TRN-TYP         NOT EQUAL           19620000
196300                   PV-HOLD-LAST-TRN-TYP                           19630000
196400                 MOVE TR015-LOGVS-TRN-TYP                     TO  19640000
196500                       PV-HOLD-TR221-DATA-VALUE                   19650000
196600                 MOVE 'TRAN TYPE'                             TO  19660000
196700                       PV-HOLD-TR221-DATA-IN-ERROR                19670000
196800                 MOVE 'ERD AND/OR LOG DATA MISSING'           TO  19680000
196900                       PV-HOLD-TR221-ERROR-MSG                    19690000
197000         END-EVALUATE                                             19700000
197100     END-IF.                                                      19710000
197200                                                                  19720000
197300     IF REC-TYP-LOGUPC                                            19730000
197400         EVALUATE TRUE                                            19740000
197601             WHEN TR015-LOGUPC-PO-NBR-X       NOT EQUAL           19760100
197610                   PV-HOLD-PO-NBR-X                               19761000
197700                 MOVE TR015-LOGUPC-PO-NBR                     TO  19770000
197800                       PV-HOLD-TR221-DATA-VALUE                   19780000
197900                 MOVE 'PO NUMBER'                             TO  19790000
198000                       PV-HOLD-TR221-DATA-IN-ERROR                19800000
198100                 MOVE 'ERD AND/OR LOG AND/OR VS DATA MISSING' TO  19810000
198200                       PV-HOLD-TR221-ERROR-MSG                    19820000
198300                                                                  19830000
198400             WHEN TR015-LOGUPC-EXTL-REF-NBR   NOT EQUAL           19840000
198500                   PV-HOLD-EXTL-REF-NBR                           19850000
198600                 MOVE TR015-LOGUPC-EXTL-REF-NBR               TO  19860000
198700                       PV-HOLD-TR221-DATA-VALUE                   19870000
198800                 MOVE 'EXTL REF NBR'                          TO  19880000
198900                       PV-HOLD-TR221-DATA-IN-ERROR                19890000
199000                 MOVE 'ERD AND/OR LOG AND/OR VS DATA MISSING' TO  19900000
199100                       PV-HOLD-TR221-ERROR-MSG                    19910000
199200                                                                  19920000
199300             WHEN TR015-LOGUPC-PO-RCVD-DELY-DTE NOT EQUAL         19930000
199400                   PV-HOLD-PO-RCVD-DELY-DTE                       19940000
199500                 MOVE TR015-LOGUPC-PO-RCVD-DELY-DTE           TO  19950000
199600                       PV-HOLD-TR221-DATA-VALUE                   19960000
199700                 MOVE 'RCVD DELY DTE'                         TO  19970000
199800                       PV-HOLD-TR221-DATA-IN-ERROR                19980000
199900                 MOVE 'ERD AND/OR LOG AND/OR VS DATA MISSING' TO  19990000
200000                       PV-HOLD-TR221-ERROR-MSG                    20000000
200100                                                                  20010000
200200             WHEN TR015-LOGUPC-ORGN-SHPD-FR-CDE NOT EQUAL         20020000
200300                   PV-HOLD-ORGN-SHPD-FR-CDE                       20030000
200400                 MOVE TR015-LOGUPC-ORGN-SHPD-FR-CDE           TO  20040000
200500                       PV-HOLD-TR221-DATA-VALUE                   20050000
200600                 MOVE 'ORGN SHP FR CDE'                       TO  20060000
200700                       PV-HOLD-TR221-DATA-IN-ERROR                20070000
200800                 MOVE 'ERD AND/OR LOG AND/OR VS DATA MISSING' TO  20080000
200900                       PV-HOLD-TR221-ERROR-MSG                    20090000
201000                                                                  20100000
201100             WHEN TR015-LOGUPC-VS-NBR         NOT EQUAL           20110000
201200                   PV-HOLD-VS-NBR                                 20120000
201300                 MOVE TR015-LOGUPC-VS-NBR                     TO  20130000
201400                       PV-HOLD-TR221-DATA-VALUE                   20140000
201500                 MOVE 'VS NUMBER'                             TO  20150000
201600                       PV-HOLD-TR221-DATA-IN-ERROR                20160000
201700                 MOVE 'ERD AND/OR LOG AND/OR VS DATA MISSING' TO  20170000
201800                       PV-HOLD-TR221-ERROR-MSG                    20180000
201900                                                                  20190000
202000             WHEN TR015-LOGUPC-TRN-TYP        NOT EQUAL           20200000
202100                   PV-HOLD-LAST-TRN-TYP                           20210000
202200                 MOVE TR015-LOGUPC-TRN-TYP                    TO  20220000
202300                       PV-HOLD-TR221-DATA-VALUE                   20230000
202400                 MOVE 'TRAN TYPE'                             TO  20240000
202500                       PV-HOLD-TR221-DATA-IN-ERROR                20250000
202600                 MOVE 'ERD AND/OR LOG AND/OR VS DATA MISSING' TO  20260000
202700                       PV-HOLD-TR221-ERROR-MSG                    20270000
202800         END-EVALUATE                                             20280000
202900     END-IF.                                                      20290000
203000                                                                  20300000
203100***************************************************************** 20310000
203200* RESET WRITE SWITCHES FOR EDITED EXTRACT FILE.                 * 20320000
203300***************************************************************** 20330000
203400 4900-RESET-WRITE-SWITCHES.                                       20340000
203500                                                                  20350000
203600     EVALUATE TRUE                                                20360000
203700        WHEN                                                      20370000
203901            (TR015-ERD-PO-NBR-X         NOT EQUAL                 20390100
203910             PV-HOLD-PO-NBR-X)                       OR           20391000
204000            (TR015-ERD-EXTL-REF-NBR     NOT EQUAL                 20400000
204100             PV-HOLD-EXTL-REF-NBR)                   OR           20410000
204200            (TR015-ERD-PO-RCVD-DELY-DTE NOT EQUAL                 20420000
204300             PV-HOLD-PO-RCVD-DELY-DTE)               OR           20430000
204400            (TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL                 20440000
204500             PV-HOLD-ORGN-SHPD-FR-CDE)               OR           20450000
204600            (TR015-ERD-TRN-TYP          NOT EQUAL                 20460000
204700             PV-HOLD-LAST-TRN-TYP)                                20470000
204800                SET PS-GOOD-ERD-LOG-WRITE-NO   TO TRUE            20480000
204900                SET PS-GOOD-LOGVS-WRITE-NO     TO TRUE            20490000
205000                                                                  20500000
205100        WHEN REC-TYP-LOGVS                           OR           20510000
205200             REC-TYP-LOGUPC                                       20520000
205300             EVALUATE TRUE                                        20530000
205400                 WHEN                                             20540000
205601                     (TR015-LOGVS-PO-NBR-X     NOT EQUAL          20560100
205610                         PV-HOLD-PO-NBR-X)           AND          20561000
205700                     (TR015-LOGVS-VS-NBR       NOT EQUAL          20570000
205800                         PV-HOLD-VS-NBR)                          20580000
205900                        SET PS-GOOD-LOGVS-WRITE-NO     TO TRUE    20590000
206000                                                                  20600000
206100                 WHEN                                             20610000
206200                     (TR015-LOGVS-VS-NBR       NOT EQUAL          20620000
206300                         PV-HOLD-VS-NBR)                          20630000
206400                        SET PS-GOOD-LOGVS-WRITE-NO     TO TRUE    20640000
206500             END-EVALUATE                                         20650000
206600     END-EVALUATE.                                                20660000
206700                                                                  20670000
206800******************************************************************20680000
206900*  MOVE ERD INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO BE  *20690000
207000*  USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.      *20700000
207100******************************************************************20710000
207200 5000-MOVE-TR015-ERD-TO-HOLD.                                     20720000
207300                                                                  20730000
207400     INITIALIZE PV-TR015-REC-TYP-ERD.                             20740000
207500                                                                  20750000
207600     MOVE TR015-ERD-TRN-TYP        TO PV-TR015-ERD-TRN-TYP.       20760000
207700     MOVE PC-ERD                   TO PV-TR015-ERD-REC-TYP-CDE.   20770000
207800     MOVE PC-10                    TO PV-TR015-ERD-SEQ-NBR.       20780000
207900     MOVE TR015-ERD-3RD-PARTY-CDE  TO PV-TR015-ERD-3RD-PARTY-CDE. 20790000
208000                                                                  20800000
208100     IF TR015-ERD-PO-NBR NUMERIC                                  20810000
208200         MOVE TR015-ERD-PO-NBR          TO PV-TR015-ERD-PO-NBR    20820000
208300     ELSE                                                         20830000
208400         MOVE TR015-ERD-PO-NBR-X        TO PV-TR015-ERD-PO-NBR-X  20840000
208500     END-IF.                                                      20850000
208600                                                                  20860000
208700     MOVE TR015-ERD-EXTL-REF-NBR    TO                            20870000
208800                                PV-TR015-ERD-EXTL-REF-NBR.        20880000
208900                                                                  20890000
209000     IF TR015-ERD-PO-RCVD-DELY-DTE EQUAL SPACES                   20900000
209100         MOVE PC-DEFAULT-DATE      TO                             20910000
209200                                PV-TR015-ERD-PO-RCVD-DELY-DTE     20920000
209300     ELSE                                                         20930000
209400         MOVE TR015-ERD-PO-RCVD-DELY-DTE TO                       20940000
209500                                PV-TR015-ERD-PO-RCVD-DELY-DTE     20950000
209600     END-IF.                                                      20960000
209700                                                                  20970000
209800     MOVE PC-DEFAULT-TIME      TO PV-TR015-ERD-PO-RCVD-DELY-TM.   20980000
209900                                                                  20990000
210000     MOVE TR015-ERD-ORGN-SHPD-FR-CDE TO                           21000000
210100                                   PV-TR015-ERD-ORGN-SHPD-FR-CDE. 21010000
210200     MOVE TR015-ERD-IMPRT-TRIP-ID  TO PV-TR015-ERD-IMPRT-TRIP-ID. 21020000
210300     MOVE TR015-ERD-CARR-SCAC-ID   TO PV-TR015-ERD-CARR-SCAC-ID.  21030000
210400     MOVE TR015-ERD-IMPRT-VEH-NM   TO                             21040000
210500                                   PV-TR015-ERD-IMPRT-VEH-NM.     21050000
210600                                                                  21060000
210700     MOVE TR015-ERD-POE-DELY-DTE   TO PV-TR015-ERD-POE-DELY-DTE.  21070000
210800     MOVE TR015-ERD-POE-DELY-TM    TO PV-TR015-ERD-POE-DELY-TM.   21080000
210900     MOVE TR015-ERD-DPRTR-DTE      TO PV-TR015-ERD-DPRTR-DTE.     21090000
211000     MOVE TR015-ERD-DPRTR-TM       TO PV-TR015-ERD-DPRTR-TM.      21100000
211100     MOVE TR015-ERD-FOB-CDE        TO PV-TR015-ERD-FOB-CDE.       21110000
211200     MOVE TR015-ERD-DEST-POE-CDE   TO PV-TR015-ERD-DEST-POE-CDE.  21120000
211300     MOVE TR015-ERD-EST-LBD-NM     TO PV-TR015-ERD-EST-LBD-NM.    21130000
211400     MOVE TR015-ERD-TRIP-TYP-CDE   TO PV-TR015-ERD-TRIP-TYP-CDE.  21140000
211401     MOVE TR015-ERD-FILE-ID        TO PV-TR015-ERD-FILE-ID.       21140100
211410     MOVE TR015-ERD-ENT-ID         TO PV-TR015-ERD-ENT-ID.        21141000
211500     MOVE PV-PROCESS-SEQ-NBR       TO PV-TR015-ERD-PROC-SEQ-NBR.  21150000
211600                                                                  21160000
211700******************************************************************21170000
211800*  MOVE ERDRSN INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO  *21180000
211900*  BE USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.   *21190000
212000******************************************************************21200000
212100 5010-MOVE-TR015-ERDRSN-TO-HOLD.                                  21210000
212200                                                                  21220000
212300     INITIALIZE PV-TR015-REC-TYP-ERDRSN.                          21230000
212400                                                                  21240000
212500     MOVE TR015-ERDRSN-TRN-TYP     TO PV-TR015-ERDRSN-TRN-TYP.    21250000
212600     MOVE PC-ERDRSN                TO PV-TR015-ERDRSN-REC-TYP-CDE.21260000
212700     MOVE PC-11                    TO PV-TR015-ERDRSN-SEQ-NBR.    21270000
212800     MOVE TR015-ERDRSN-3RD-PARTY-CDE TO                           21280000
212900                                   PV-TR015-ERDRSN-3RD-PARTY-CDE. 21290000
213000                                                                  21300000
213100     IF TR015-ERDRSN-PO-NBR NUMERIC                               21310000
213200         MOVE TR015-ERDRSN-PO-NBR    TO PV-TR015-ERDRSN-PO-NBR    21320000
213300     ELSE                                                         21330000
213400         MOVE TR015-ERDRSN-PO-NBR-X  TO PV-TR015-ERDRSN-PO-NBR-X  21340000
213500     END-IF.                                                      21350000
213600                                                                  21360000
213700     MOVE TR015-ERDRSN-EXTL-REF-NBR    TO                         21370000
213800                                  PV-TR015-ERDRSN-EXTL-REF-NBR.   21380000
213900                                                                  21390000
214000     IF TR015-ERDRSN-PO-RCVD-DELY-DTE EQUAL SPACES                21400000
214100         MOVE PC-DEFAULT-DATE      TO                             21410000
214200                                PV-TR015-ERDRSN-PO-RCV-DELY-DT    21420000
214300     ELSE                                                         21430000
214400         MOVE TR015-ERDRSN-PO-RCVD-DELY-DTE TO                    21440000
214500                                PV-TR015-ERDRSN-PO-RCV-DELY-DT    21450000
214600     END-IF.                                                      21460000
214700                                                                  21470000
214800     MOVE PC-DEFAULT-TIME  TO PV-TR015-ERDRSN-PO-RCV-DELY-TM.     21480000
214900                                                                  21490000
215000     MOVE TR015-ERDRSN-ORGN-SHPD-FR-CDE TO                        21500000
215100                              PV-TR015-ERDRSN-ORG-SHP-FR-CDE.     21510000
215200     MOVE TR015-ERDRSN-IMPRT-TRIP-ID   TO                         21520000
215300                                  PV-TR015-ERDRSN-IMPRT-TRIP-ID.  21530000
215400     MOVE TR015-ERDRSN-CARR-SCAC-ID    TO                         21540000
215500                                  PV-TR015-ERDRSN-CARR-SCAC-ID.   21550000
215600                                                                  21560000
215700     MOVE TR015-ERDRSN-POE-DELY-DTE    TO                         21570000
215800                                PV-TR015-ERDRSN-POE-DELY-DTE.     21580000
215900     MOVE TR015-ERDRSN-POE-DELY-TM     TO                         21590000
216000                                PV-TR015-ERDRSN-POE-DELY-TM.      21600000
216100     MOVE TR015-ERDRSN-DPRTR-DTE      TO PV-TR015-ERDRSN-DPRTR-DTE21610000
216200     MOVE TR015-ERDRSN-DPRTR-TM       TO PV-TR015-ERDRSN-DPRTR-TM.21620000
216300     MOVE TR015-ERDRSN-VOY-CHG-RSN-DESC TO                        21630000
216400                                PV-TR015-ERDRSN-VOY-CHG-RSN-DS.   21640000
216401     MOVE TR015-ERDRSN-FILE-ID     TO PV-TR015-ERDRSN-FILE-ID.    21640100
216410     MOVE TR015-ERDRSN-ENT-ID      TO PV-TR015-ERDRSN-ENT-ID.     21641000
216500     MOVE PV-PROCESS-SEQ-NBR     TO PV-TR015-ERDRSN-PROC-SEQ-NBR. 21650000
216600                                                                  21660000
216700******************************************************************21670000
216800*  MOVE LOG INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO BE  *21680000
216900*  USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.      *21690000
217000******************************************************************21700000
217100 5020-MOVE-TR015-LOG-TO-HOLD.                                     21710000
217200                                                                  21720000
217300     INITIALIZE PV-TR015-REC-TYP-LOG.                             21730000
217400                                                                  21740000
217500     MOVE TR015-LOG-TRN-TYP        TO PV-TR015-LOG-TRN-TYP.       21750000
217600     MOVE PC-LOG                   TO PV-TR015-LOG-REC-TYP-CDE.   21760000
217700     MOVE PC-20                    TO PV-TR015-LOG-SEQ-NBR.       21770000
217800     MOVE TR015-LOG-3RD-PARTY-CDE  TO PV-TR015-LOG-3RD-PARTY-CDE. 21780000
217900                                                                  21790000
218000     IF TR015-LOG-PO-NBR NUMERIC                                  21800000
218100         MOVE TR015-LOG-PO-NBR    TO PV-TR015-LOG-PO-NBR          21810000
218200     ELSE                                                         21820000
218300         MOVE TR015-LOG-PO-NBR-X  TO PV-TR015-LOG-PO-NBR-X        21830000
218400     END-IF.                                                      21840000
218500                                                                  21850000
218600     MOVE TR015-LOG-EXTL-REF-NBR    TO PV-TR015-LOG-EXTL-REF-NBR. 21860000
218700                                                                  21870000
218800     IF TR015-LOG-PO-RCVD-DELY-DTE EQUAL SPACES                   21880000
218900         MOVE PC-DEFAULT-DATE      TO                             21890000
219000                                PV-TR015-LOG-PO-RCVD-DELY-DTE     21900000
219100     ELSE                                                         21910000
219200         MOVE TR015-LOG-PO-RCVD-DELY-DTE TO                       21920000
219300                                PV-TR015-LOG-PO-RCVD-DELY-DTE     21930000
219400     END-IF.                                                      21940000
219500                                                                  21950000
219600     MOVE PC-DEFAULT-TIME  TO PV-TR015-LOG-PO-RCVD-DELY-TM.       21960000
219700                                                                  21970000
219800     MOVE TR015-LOG-ORGN-SHPD-FR-CDE TO                           21980000
219900                                   PV-TR015-LOG-ORGN-SHPD-FR-CDE. 21990000
220000                                                                  22000000
220100     IF TR015-LOG-PO-CART-CNT NUMERIC                             22010000
220200         MOVE TR015-LOG-PO-CART-CNT     TO                        22020000
220300                                    PV-TR015-LOG-PO-CART-CNT      22030000
220400     ELSE                                                         22040000
220500         MOVE TR015-LOG-PO-CART-CNT-X   TO                        22050000
220600                                    PV-TR015-LOG-PO-CART-CNT-X    22060000
220700     END-IF.                                                      22070000
220800                                                                  22080000
220900     IF TR015-LOG-PO-UNT-QTY NUMERIC                              22090000
221000         MOVE TR015-LOG-PO-UNT-QTY      TO                        22100000
221100                                    PV-TR015-LOG-PO-UNT-QTY       22110000
221200     ELSE                                                         22120000
221300         MOVE TR015-LOG-PO-UNT-QTY-X    TO                        22130000
221400                                    PV-TR015-LOG-PO-UNT-QTY-X     22140000
221500     END-IF.                                                      22150000
221600                                                                  22160000
221700     IF TR015-LOG-PO-CBMT-QTY NUMERIC                             22170000
221800         MOVE TR015-LOG-PO-CBMT-QTY     TO                        22180000
221900                                    PV-TR015-LOG-PO-CBMT-QTY      22190000
222000     ELSE                                                         22200000
222100         MOVE TR015-LOG-PO-CBMT-QTY-X    TO                       22210000
222200                                    PV-TR015-LOG-PO-CBMT-QTY-X    22220000
222300     END-IF.                                                      22230000
222400                                                                  22240000
222500     IF TR015-LOG-PO-WT-KGRM-QTY NUMERIC                          22250000
222600         MOVE TR015-LOG-PO-WT-KGRM-QTY  TO                        22260000
222700                                    PV-TR015-LOG-PO-WT-KGRM-QTY   22270000
222800     ELSE                                                         22280000
222900         MOVE TR015-LOG-PO-WT-KGRM-QTY-X TO                       22290000
223000                                    PV-TR015-LOG-PO-WT-KGRM-QTY-X 22300000
223100     END-IF.                                                      22310000
223200                                                                  22320000
223300     MOVE TR015-LOG-PROD-FCTRY-NM   TO                            22330000
223400                                   PV-TR015-LOG-PROD-FCTRY-NM.    22340000
223500     MOVE TR015-LOG-C-O-PROD-CDE    TO PV-TR015-LOG-C-O-PROD-CDE. 22350000
223600     MOVE TR015-LOG-CONSOL-SCAC-ID  TO                            22360000
223700                                   PV-TR015-LOG-CONSOL-SCAC-ID.   22370000
223800                                                                  22380000
223801     MOVE TR015-LOG-FILE-ID        TO PV-TR015-LOG-FILE-ID.       22380100
223810     MOVE TR015-LOG-ENT-ID         TO PV-TR015-LOG-ENT-ID.        22381000
223900     MOVE PV-PROCESS-SEQ-NBR       TO PV-TR015-LOG-PROC-SEQ-NBR.  22390000
223901                                                                  22390100
224100******************************************************************22410000
224200*  MOVE LOGVS INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO BE*22420000
224300*  USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.      *22430000
224400******************************************************************22440000
224500 5030-MOVE-TR015-LOGVS-TO-HOLD.                                   22450000
224600                                                                  22460000
224700     INITIALIZE PV-TR015-REC-TYP-LOGVS.                           22470000
224800                                                                  22480000
224900     MOVE TR015-LOGVS-TRN-TYP       TO PV-TR015-LOGVS-TRN-TYP.    22490000
225000     MOVE PC-LOGVS                  TO PV-TR015-LOGVS-REC-TYP-CDE.22500000
225100     MOVE PC-21                     TO PV-TR015-LOGVS-SEQ-NBR.    22510000
225200     MOVE TR015-LOGVS-3RD-PARTY-CDE TO                            22520000
225300                                PV-TR015-LOGVS-3RD-PARTY-CDE.     22530000
225400                                                                  22540000
225500     IF TR015-LOGVS-PO-NBR NUMERIC                                22550000
225600         MOVE TR015-LOGVS-PO-NBR    TO PV-TR015-LOGVS-PO-NBR      22560000
225700     ELSE                                                         22570000
225800         MOVE TR015-LOGVS-PO-NBR-X  TO PV-TR015-LOGVS-PO-NBR-X    22580000
225900     END-IF.                                                      22590000
226000                                                                  22600000
226100     MOVE TR015-LOGVS-EXTL-REF-NBR TO PV-TR015-LOGVS-EXTL-REF-NBR.22610000
226200                                                                  22620000
226300     IF TR015-LOGVS-PO-RCVD-DELY-DTE EQUAL SPACES                 22630000
226400         MOVE PC-DEFAULT-DATE      TO                             22640000
226500                                PV-TR015-LOGVS-PO-RCV-DELY-DTE    22650000
226600     ELSE                                                         22660000
226700         MOVE TR015-LOGVS-PO-RCVD-DELY-DTE TO                     22670000
226800                                PV-TR015-LOGVS-PO-RCV-DELY-DTE    22680000
226900     END-IF.                                                      22690000
227000                                                                  22700000
227100     MOVE PC-DEFAULT-TIME  TO PV-TR015-LOGVS-PO-RCV-DELY-TM.      22710000
227200                                                                  22720000
227300     MOVE TR015-LOGVS-ORGN-SHPD-FR-CDE TO                         22730000
227400                                   PV-TR015-LOGVS-ORG-SHP-FR-CDE. 22740000
227500                                                                  22750000
227600     MOVE TR015-LOGVS-VS-NBR          TO PV-TR015-LOGVS-VS-NBR.   22760000
227700                                                                  22770000
227800     IF TR015-LOGVS-VS-CART-CNT NUMERIC                           22780000
227900         MOVE TR015-LOGVS-VS-CART-CNT    TO                       22790000
228000                                   PV-TR015-LOGVS-CART-CNT        22800000
228100     ELSE                                                         22810000
228200         MOVE TR015-LOGVS-VS-CART-CNT-X  TO                       22820000
228300                                   PV-TR015-LOGVS-CART-CNT-X      22830000
228400     END-IF.                                                      22840000
228500                                                                  22850000
228600     IF TR015-LOGVS-VS-UNT-QTY NUMERIC                            22860000
228700         MOVE TR015-LOGVS-VS-UNT-QTY     TO                       22870000
228800                                   PV-TR015-LOGVS-UNT-QTY         22880000
228900     ELSE                                                         22890000
229000         MOVE TR015-LOGVS-VS-UNT-QTY-X   TO                       22900000
229100                                   PV-TR015-LOGVS-UNT-QTY-X       22910000
229200     END-IF.                                                      22920000
229300                                                                  22930000
229400     IF TR015-LOGVS-VS-CBMT-QTY NUMERIC                           22940000
229500         MOVE TR015-LOGVS-VS-CBMT-QTY    TO                       22950000
229600                                   PV-TR015-LOGVS-CBMT-QTY        22960000
229700     ELSE                                                         22970000
229800         MOVE TR015-LOGVS-VS-CBMT-QTY-X  TO                       22980000
229900                                   PV-TR015-LOGVS-CBMT-QTY-X      22990000
230000     END-IF.                                                      23000000
230100                                                                  23010000
230200     IF TR015-LOGVS-VS-WT-KGRM-QTY NUMERIC                        23020000
230300         MOVE TR015-LOGVS-VS-WT-KGRM-QTY   TO                     23030000
230400                                   PV-TR015-LOGVS-WT-KGRM-QTY     23040000
230500     ELSE                                                         23050000
230600         MOVE TR015-LOGVS-VS-WT-KGRM-QTY-X TO                     23060000
230700                                   PV-TR015-LOGVS-WT-KGRM-QTY-X   23070000
230800     END-IF.                                                      23080000
230900                                                                  23090000
230901     MOVE TR015-LOGVS-FILE-ID    TO PV-TR015-LOGVS-FILE-ID.       23090100
230910     MOVE TR015-LOGVS-ENT-ID     TO PV-TR015-LOGVS-ENT-ID.        23091000
231000     MOVE PV-PROCESS-SEQ-NBR     TO PV-TR015-LOGVS-PROC-SEQ-NBR.  23100000
231100                                                                  23110000
231200******************************************************************23120000
231300*  MOVE LOGUPC INPUT RECORD FIELDS TO WORKING STORAGE FIELDS TO  *23130000
231400*  BE USED LATER WHEN IT IS DETERMINED WHAT RECORDS WERE SENT.   *23140000
231500******************************************************************23150000
231600 5040-MOVE-TR015-LOGUPC-TO-HOLD.                                  23160000
231700                                                                  23170000
231800     INITIALIZE PV-TR015-REC-TYP-LOGUPC.                          23180000
231900                                                                  23190000
232000     MOVE TR015-LOGUPC-TRN-TYP       TO PV-TR015-LOGUPC-TRN-TYP.  23200000
232100     MOVE PC-LOGUPC                  TO                           23210000
232200                                PV-TR015-LOGUPC-REC-TYP-CDE.      23220000
232300     MOVE PC-22                      TO PV-TR015-LOGUPC-SEQ-NBR.  23230000
232400     MOVE TR015-LOGUPC-3RD-PARTY-CDE TO                           23240000
232500                                PV-TR015-LOGUPC-3RD-PARTY-CDE.    23250000
232600                                                                  23260000
232700     IF TR015-LOGUPC-PO-NBR NUMERIC                               23270000
232800         MOVE TR015-LOGUPC-PO-NBR   TO PV-TR015-LOGUPC-PO-NBR     23280000
232900     ELSE                                                         23290000
233000         MOVE TR015-LOGUPC-PO-NBR-X TO PV-TR015-LOGUPC-PO-NBR-X   23300000
233100     END-IF.                                                      23310000
233200                                                                  23320000
233300     MOVE TR015-LOGUPC-EXTL-REF-NBR TO                            23330000
233400                                PV-TR015-LOGUPC-EXTL-REF-NBR.     23340000
233500                                                                  23350000
233600     IF TR015-LOGUPC-PO-RCVD-DELY-DTE EQUAL SPACES                23360000
233700         MOVE PC-DEFAULT-DATE      TO                             23370000
233800                                PV-TR015-LOGUPC-PO-RCV-DELY-DT    23380000
233900     ELSE                                                         23390000
234000         MOVE TR015-LOGUPC-PO-RCVD-DELY-DTE TO                    23400000
234100                                PV-TR015-LOGUPC-PO-RCV-DELY-DT    23410000
234200     END-IF.                                                      23420000
234300                                                                  23430000
234400     MOVE PC-DEFAULT-TIME  TO PV-TR015-LOGUPC-PO-RCV-DELY-TM.     23440000
234500                                                                  23450000
234600     MOVE TR015-LOGUPC-ORGN-SHPD-FR-CDE TO                        23460000
234700                                 PV-TR015-LOGUPC-ORG-SHP-FR-CDE.  23470000
234800                                                                  23480000
234900     MOVE TR015-LOGUPC-VS-NBR       TO PV-TR015-LOGUPC-VS-NBR.    23490000
235000                                                                  23500000
235100     IF TR015-LOGUPC-UPC-NBR NUMERIC                              23510000
235200         MOVE TR015-LOGUPC-UPC-NBR    TO                          23520000
235300                                PV-TR015-LOGUPC-UPC-NBR           23530000
235400     ELSE                                                         23540000
235500         MOVE TR015-LOGUPC-UPC-NBR-X  TO                          23550000
235600                                PV-TR015-LOGUPC-UPC-NBR-X         23560000
235700     END-IF.                                                      23570000
235800                                                                  23580000
235900     IF TR015-LOGUPC-UPC-CART-CNT NUMERIC                         23590000
236000         MOVE TR015-LOGUPC-UPC-CART-CNT   TO                      23600000
236100                                PV-TR015-LOGUPC-CART-CNT          23610000
236200     ELSE                                                         23620000
236300         MOVE TR015-LOGUPC-UPC-CART-CNT-X TO                      23630000
236400                                PV-TR015-LOGUPC-CART-CNT-X        23640000
236500     END-IF.                                                      23650000
236600                                                                  23660000
236700     IF TR015-LOGUPC-UPC-UNT-QTY NUMERIC                          23670000
236800         MOVE TR015-LOGUPC-UPC-UNT-QTY    TO                      23680000
236900                                PV-TR015-LOGUPC-UNT-QTY           23690000
237000     ELSE                                                         23700000
237100         MOVE TR015-LOGUPC-UPC-UNT-QTY-X  TO                      23710000
237200                                PV-TR015-LOGUPC-UNT-QTY-X         23720000
237300     END-IF.                                                      23730000
237400                                                                  23740000
237500     IF TR015-LOGUPC-UPC-CBMT-QTY NUMERIC                         23750000
237600         MOVE TR015-LOGUPC-UPC-CBMT-QTY    TO                     23760000
237700                                PV-TR015-LOGUPC-CBMT-QTY          23770000
237800     ELSE                                                         23780000
237900         MOVE TR015-LOGUPC-UPC-CBMT-QTY-X  TO                     23790000
238000                                PV-TR015-LOGUPC-CBMT-QTY-X        23800000
238100     END-IF.                                                      23810000
238200                                                                  23820000
238300     IF TR015-LOGUPC-UPC-WT-KGRM-QTY NUMERIC                      23830000
238400         MOVE TR015-LOGUPC-UPC-WT-KGRM-QTY    TO                  23840000
238500                                PV-TR015-LOGUPC-WT-KGRM-QTY       23850000
238600     ELSE                                                         23860000
238700         MOVE TR015-LOGUPC-UPC-WT-KGRM-QTY-X  TO                  23870000
238800                                PV-TR015-LOGUPC-WT-KGRM-QTY-X     23880000
238900     END-IF.                                                      23890000
239000                                                                  23900000
239001     MOVE TR015-LOGUPC-FILE-ID     TO PV-TR015-LOGUPC-FILE-ID.    23900100
239010     MOVE TR015-LOGUPC-ENT-ID      TO PV-TR015-LOGUPC-ENT-ID.     23901000
239100     MOVE PV-PROCESS-SEQ-NBR   TO PV-TR015-LOGUPC-PROC-SEQ-NBR.   23910000
239200                                                                  23920000
239300******************************************************************23930000
239400*  MOVE WORKING STORAGE ERD RECORD FIELDS TO THE EDITED UPDATE   *23940000
239500*  EXTRACT FILE.  THIS FILE WILL BE PASSED TO THE UPDATE PROGRAM.*23950000
239600******************************************************************23960000
239700 5300-LOAD-ERD-FIELDS-UPDATE.                                     23970000
239800                                                                  23980000
239900     PERFORM 5400-INITIAL-ERD-FIELDS-UPD.                         23990000
240000                                                                  24000000
240100     MOVE PV-TR015-ERD-TRN-TYP        TO TR025-ERD-TRN-TYP.       24010000
240200     MOVE PC-ERD                      TO TR025-ERD-REC-TYP-CDE.   24020000
240300     MOVE PC-10                       TO TR025-ERD-SEQ-NBR.       24030000
240400     MOVE PV-TR015-ERD-3RD-PARTY-CDE  TO TR025-ERD-3RD-PARTY-CDE. 24040000
240500                                                                  24050000
240600     EVALUATE TRUE                                                24060000
240700                                                                  24070000
240800         WHEN PV-TR015-ERD-PO-NBR NOT NUMERIC OR                  24080000
240900              PV-TR015-ERD-PO-NBR  = ZERO                         24090000
241000             SET PS-EDIT-ERROR TO TRUE                            24100000
241100             MOVE PC-ERROR    TO PV-HOLD-TR221-ERROR-TYPE         24110000
241200             MOVE 'PO NUMBER' TO PV-HOLD-TR221-DATA-IN-ERROR      24120000
241300             MOVE PV-TR015-ERD-PO-NBR TO PV-HOLD-TR221-DATA-VALUE 24130000
241400             MOVE 'INVALID PO NUMBER' TO                          24140000
241500                   PV-HOLD-TR221-ERROR-MSG                        24150000
241600             PERFORM 5500-LOAD-ERD-TO-REPORT                      24160000
241700                                                                  24170000
241800         WHEN PV-TR015-ERD-PO-RCVD-DELY-DTE EQUAL SPACES          24180000
241900             SET PS-EDIT-ERROR TO TRUE                            24190000
242000             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            24200000
242100             MOVE 'RCVD DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR  24210000
242200             MOVE PV-TR015-ERD-PO-RCVD-DELY-DTE TO                24220000
242300                   PV-HOLD-TR221-DATA-VALUE                       24230000
242400             MOVE 'RCVD DELIVERY DATE NOT SENT' TO                24240000
242500                   PV-HOLD-TR221-ERROR-MSG                        24250000
242600             PERFORM 5500-LOAD-ERD-TO-REPORT                      24260000
242700                                                                  24270000
242800         WHEN PV-TR015-ERD-ORGN-SHPD-FR-CDE EQUAL SPACES OR       24280000
242900             (PV-TR015-ERD-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS      24290000
243000              AND PC-CY)                                          24300000
243100             SET PS-EDIT-ERROR TO TRUE                            24310000
243200             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            24320000
243300             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR221-DATA-IN-ERROR 24330000
243400             MOVE PV-TR015-ERD-ORGN-SHPD-FR-CDE  TO               24340000
243500                   PV-HOLD-TR221-DATA-VALUE                       24350000
243600             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               24360000
243700                   PV-HOLD-TR221-ERROR-MSG                        24370000
243800             PERFORM 5500-LOAD-ERD-TO-REPORT                      24380000
243900                                                                  24390000
244000         WHEN PV-TR015-ERD-PO-RCVD-DELY-DTE NOT EQUAL SPACES AND  24400000
244100              PV-TR015-ERD-PO-RCVD-DELY-DTE NOT EQUAL             24410000
244200               PC-DEFAULT-DATE                                    24420000
244300             MOVE PV-TR015-ERD-PO-RCVD-DELY-DTE TO                24430000
244400                   PV-RCVD-DELY-DTE                               24440000
244500             MOVE PV-TR015-ERD-PO-RCVD-DELY-TM  TO                24450000
244600                   PV-RCVD-DELY-TM                                24460000
244700             PERFORM 5715-FORMAT-RCVD-DELY-TMST                   24470000
244800             IF PS-WARNING-DATE                                   24480000
244900                 SET PS-EDIT-ERROR TO TRUE                        24490000
245000                 MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE        24500000
245100                 MOVE PV-TR015-ERD-PO-RCVD-DELY-DTE TO            24510000
245200                       PV-HOLD-TR221-DATA-VALUE                   24520000
245300                 MOVE 'DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR   24530000
245400                 MOVE 'INVALID DELIVERY DATE'      TO             24540000
245500                       PV-HOLD-TR221-ERROR-MSG                    24550000
245600                 PERFORM 5500-LOAD-ERD-TO-REPORT                  24560000
245700             ELSE                                                 24570000
245800                 IF PS-WARNING-TIME                               24580000
245900                     SET PS-EDIT-ERROR TO TRUE                    24590000
246000                     MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE    24600000
246100                     MOVE PV-TR015-ERD-PO-RCVD-DELY-TM TO         24610000
246200                           PV-HOLD-TR221-DATA-VALUE               24620000
246300                     MOVE 'DELY TM' TO PV-HOLD-TR221-DATA-IN-ERROR24630000
246400                     MOVE 'INVALID DELIVERY TIME'     TO          24640000
246500                           PV-HOLD-TR221-ERROR-MSG                24650000
246600                     PERFORM 5500-LOAD-ERD-TO-REPORT              24660000
246700                 ELSE                                             24670000
246800                     MOVE PV-TR015-ERD-PO-RCVD-DELY-DTE TO        24680000
246900                                       TR025-ERD-PO-RCVD-DELY-DTE 24690000
247000                     MOVE PV-TR015-ERD-PO-RCVD-DELY-TM TO         24700000
247100                                       TR025-ERD-PO-RCVD-DELY-TM  24710000
247200                 END-IF                                           24720000
247300             END-IF                                               24730000
247400             SET PS-WARNING-DATE-NO TO TRUE                       24740000
247500             SET PS-WARNING-TIME-NO TO TRUE                       24750000
247600     END-EVALUATE.                                                24760000
247700                                                                  24770000
247800     IF PS-EDIT-ERROR-NO                                          24780000
247900         MOVE PV-TR015-ERD-PO-NBR          TO TR025-ERD-PO-NBR    24790000
248000         MOVE PV-TR015-ERD-EXTL-REF-NBR TO TR025-ERD-EXTL-REF-NBR 24800000
248100         MOVE PV-TR015-ERD-PO-RCVD-DELY-DTE TO                    24810000
248200               TR025-ERD-PO-RCVD-DELY-DTE                         24820000
248300         MOVE PV-TR015-ERD-PO-RCVD-DELY-TM  TO                    24830000
248400               TR025-ERD-PO-RCVD-DELY-TM                          24840000
248500         MOVE PV-TR015-ERD-ORGN-SHPD-FR-CDE TO                    24850000
248600               TR025-ERD-ORGN-SHPD-FR-CDE                         24860000
248700         PERFORM 5305-LOAD-ERD-FIELDS-UPDATE-2                    24870000
248800     ELSE                                                         24880000
248900         IF PS-ERDRSN-SENT                                        24890000
249000             PERFORM 5510-LOAD-ERDRSN-TO-REPORT                   24900000
249100         END-IF                                                   24910000
249200         PERFORM 5520-LOAD-LOG-TO-REPORT                          24920000
249300     END-IF.                                                      24930000
249400                                                                  24940000
249500******************************************************************24950000
249600*  MOVE WORKING STORAGE ERD RECORD FIELDS TO THE EDITED UPDATE   *24960000
249700*  EXTRACT FILE.  THIS FILE WILL BE PASSED TO THE UPDATE PROGRAM.*24970000
249800******************************************************************24980000
249900 5305-LOAD-ERD-FIELDS-UPDATE-2.                                   24990000
250000                                                                  25000000
250100     MOVE PV-TR015-ERD-IMPRT-TRIP-ID  TO TR025-ERD-IMPRT-TRIP-ID. 25010000
250200     IF PV-TR015-ERD-IMPRT-TRIP-ID  EQUAL SPACES                  25020000
250300         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              25030000
250400         MOVE 'IMPRT TRIP ID'    TO PV-HOLD-TR221-DATA-IN-ERROR   25040000
250500         MOVE PV-TR015-ERD-IMPRT-TRIP-ID    TO                    25050000
250600               PV-HOLD-TR221-DATA-VALUE                           25060000
250700         MOVE 'DATA NOT SENT'             TO                      25070000
250800               PV-HOLD-TR221-ERROR-MSG                            25080000
250900         PERFORM 5500-LOAD-ERD-TO-REPORT                          25090000
251000     END-IF.                                                      25100000
251100                                                                  25110000
251200     MOVE PV-TR015-ERD-CARR-SCAC-ID   TO TR025-ERD-CARR-SCAC-ID.  25120000
251300                                                                  25130000
251400     MOVE PV-TR015-ERD-IMPRT-VEH-NM   TO TR025-ERD-IMPRT-VEH-NM.  25140000
251500     IF PV-TR015-ERD-IMPRT-VEH-NM   EQUAL SPACES                  25150000
251600         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              25160000
251700         MOVE 'IMPRT VEH NM'     TO PV-HOLD-TR221-DATA-IN-ERROR   25170000
251800         MOVE PV-TR015-ERD-IMPRT-VEH-NM     TO                    25180000
251900               PV-HOLD-TR221-DATA-VALUE                           25190000
252000         MOVE 'DATA NOT SENT'             TO                      25200000
252100               PV-HOLD-TR221-ERROR-MSG                            25210000
252200         PERFORM 5500-LOAD-ERD-TO-REPORT                          25220000
252300     END-IF.                                                      25230000
252400                                                                  25240000
252500*    IF PV-TR015-ERD-POE-DELY-DTE EQUAL SPACES                    25250000
252600*        MOVE PC-DEFAULT-DATE           TO TR025-ERD-POE-DELY-DTE 25260000
252700*                                          PV-HOLD-POE-DELY-DTE   25270000
252800*    ELSE                                                         25280000
252900*        MOVE PV-TR015-ERD-POE-DELY-DTE TO TR025-ERD-POE-DELY-DTE 25290000
253000*                                          PV-HOLD-POE-DELY-DTE   25300000
253100*    END-IF.                                                      25310000
253200*                                                                 25320000
253300*    IF PV-TR015-ERD-POE-DELY-TM EQUAL SPACES                     25330000
253400*        MOVE PC-DEFAULT-TIME           TO TR025-ERD-POE-DELY-TM  25340000
253500*                                          PV-HOLD-POE-DELY-TM    25350000
253600*    ELSE                                                         25360000
253700*        MOVE PV-TR015-ERD-POE-DELY-TM  TO TR025-ERD-POE-DELY-TM  25370000
253800*                                          PV-HOLD-POE-DELY-TM    25380000
253900*    END-IF.                                                      25390000
254000*                                                                 25400000
254100*    PERFORM 5705-FORMAT-POE-DELY-TMST.                           25410000
254200*    IF PS-WARNING-DATE                                           25420000
254300*        MOVE PC-WARNING        TO PV-HOLD-TR221-ERROR-TYPE       25430000
254400*        MOVE 'POE DELY DTE'    TO PV-HOLD-TR221-DATA-IN-ERROR    25440000
254500*        MOVE PV-TR015-ERD-POE-DELY-DTE     TO                    25450000
254600*              PV-HOLD-TR221-DATA-VALUE                           25460000
254700*        MOVE 'INVALID DATE'                TO                    25470000
254800*              PV-HOLD-TR221-ERROR-MSG                            25480000
254900*        PERFORM 5500-LOAD-ERD-TO-REPORT                          25490000
255000*        MOVE PC-DEFAULT-DATE               TO                    25500000
255100*              TR025-ERD-POE-DELY-DTE                             25510000
255200*    ELSE                                                         25520000
255300*        IF PS-WARNING-TIME                                       25530000
255400*            MOVE PC-WARNING    TO PV-HOLD-TR221-ERROR-TYPE       25540000
255500*            MOVE 'POE DELY TM' TO PV-HOLD-TR221-DATA-IN-ERROR    25550000
255600*            MOVE PV-TR015-ERD-POE-DELY-TM     TO                 25560000
255700*                  PV-HOLD-TR221-DATA-VALUE                       25570000
255800*            MOVE 'INVALID TIME'               TO                 25580000
255900*                  PV-HOLD-TR221-ERROR-MSG                        25590000
256000*            PERFORM 5500-LOAD-ERD-TO-REPORT                      25600000
256100*            MOVE PC-DEFAULT-TIME               TO                25610000
256200*                  TR025-ERD-POE-DELY-TM                          25620000
256300*        END-IF                                                   25630000
256400*    END-IF.                                                      25640000
256500*    SET PS-WARNING-DATE-NO     TO TRUE.                          25650000
256600*    SET PS-WARNING-TIME-NO     TO TRUE.                          25660000
256700                                                                  25670000
256800     MOVE PC-DEFAULT-DATE       TO TR025-ERD-POE-DELY-DTE.        25680000
256900     MOVE PC-DEFAULT-TIME       TO TR025-ERD-POE-DELY-TM.         25690000
257000                                                                  25700000
257100     IF PV-TR015-ERD-DPRTR-DTE EQUAL SPACES                       25710000
257200         MOVE PC-DEFAULT-DATE         TO TR025-ERD-DPRTR-DTE      25720000
257300                                         PV-HOLD-DPRTR-DTE        25730000
257400     ELSE                                                         25740000
257500         MOVE PV-TR015-ERD-DPRTR-DTE  TO TR025-ERD-DPRTR-DTE      25750000
257600                                         PV-HOLD-DPRTR-DTE        25760000
257700     END-IF.                                                      25770000
257800                                                                  25780000
257900     IF PV-TR015-ERD-DPRTR-TM EQUAL SPACES                        25790000
258000         MOVE PC-DEFAULT-TIME         TO TR025-ERD-DPRTR-TM       25800000
258100                                         PV-HOLD-DPRTR-TM         25810000
258200     ELSE                                                         25820000
258300         MOVE PV-TR015-ERD-DPRTR-TM   TO TR025-ERD-DPRTR-TM       25830000
258400                                         PV-HOLD-DPRTR-TM         25840000
258500     END-IF.                                                      25850000
258600                                                                  25860000
258700     PERFORM 5700-FORMAT-DPRTR-TMST.                              25870000
258800     IF PS-WARNING-DATE                                           25880000
258900         MOVE PC-WARNING        TO PV-HOLD-TR221-ERROR-TYPE       25890000
259000         MOVE 'DPRTR DTE'       TO PV-HOLD-TR221-DATA-IN-ERROR    25900000
259100         MOVE PV-TR015-ERD-DPRTR-DTE        TO                    25910000
259200               PV-HOLD-TR221-DATA-VALUE                           25920000
259300         MOVE 'INVALID DATE'                TO                    25930000
259400               PV-HOLD-TR221-ERROR-MSG                            25940000
259500         PERFORM 5500-LOAD-ERD-TO-REPORT                          25950000
259600         MOVE PC-DEFAULT-DATE         TO TR025-ERD-DPRTR-DTE      25960000
259700     ELSE                                                         25970000
259800         IF PS-WARNING-TIME                                       25980000
259900             MOVE PC-WARNING   TO PV-HOLD-TR221-ERROR-TYPE        25990000
260000             MOVE 'DPRTR TM'   TO PV-HOLD-TR221-DATA-IN-ERROR     26000000
260100             MOVE PV-TR015-ERD-DPRTR-TM        TO                 26010000
260200                   PV-HOLD-TR221-DATA-VALUE                       26020000
260300             MOVE 'INVALID TIME'               TO                 26030000
260400                   PV-HOLD-TR221-ERROR-MSG                        26040000
260500             PERFORM 5500-LOAD-ERD-TO-REPORT                      26050000
260600             MOVE PC-DEFAULT-TIME    TO TR025-ERD-DPRTR-TM        26060000
260700         END-IF                                                   26070000
260800     END-IF.                                                      26080000
260900     SET PS-WARNING-DATE-NO     TO TRUE.                          26090000
261000     SET PS-WARNING-TIME-NO     TO TRUE.                          26100000
261100                                                                  26110000
261200     MOVE PV-TR015-ERD-FOB-CDE        TO TR025-ERD-FOB-CDE.       26120000
261210     IF PV-TR015-ERD-FOB-CDE EQUAL SPACES                         26121000
261220*       ***** 10995 OR   10594 = EXPEDITOR                        26122004
261221        IF PV-TR015-ERD-ENT-ID = 10594 OR 10995                   26122104
261230            CONTINUE                                              26123000
261240        ELSE                                                      26124000
261241            MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE           26124100
261242            MOVE 'FOB CDE'  TO PV-HOLD-TR221-DATA-IN-ERROR        26124200
261243            MOVE PV-TR015-ERD-FOB-CDE    TO                       26124300
261244                 PV-HOLD-TR221-DATA-VALUE                         26124400
261245            MOVE 'DATA NOT SENT'         TO                       26124500
261246                  PV-HOLD-TR221-ERROR-MSG                         26124600
261247            PERFORM 5500-LOAD-ERD-TO-REPORT                       26124700
261248        END-IF                                                    26124800
261249     END-IF.                                                      26124900
261270                                                                  26127000
261300*    IF PV-TR015-ERD-FOB-CDE EQUAL SPACES                         26130000
261400*        MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              26140000
261500*        MOVE 'FOB CDE'  TO PV-HOLD-TR221-DATA-IN-ERROR           26150000
261600*        MOVE PV-TR015-ERD-FOB-CDE    TO                          26160000
261700*              PV-HOLD-TR221-DATA-VALUE                           26170000
261800*        MOVE 'DATA NOT SENT'         TO                          26180000
261900*              PV-HOLD-TR221-ERROR-MSG                            26190000
262000*        PERFORM 5500-LOAD-ERD-TO-REPORT                          26200000
262100*    END-IF.                                                      26210000
262200                                                                  26220000
262300     MOVE PV-TR015-ERD-DEST-POE-CDE   TO TR025-ERD-DEST-POE-CDE.  26230000
262400                                                                  26240000
262500     MOVE PV-TR015-ERD-TRIP-TYP-CDE   TO TR025-ERD-TRIP-TYP-CDE.  26250000
262600     IF PV-TR015-ERD-TRIP-TYP-CDE EQUAL PC-A OR PC-O OR PC-M      26260000
262700         CONTINUE                                                 26270000
262800     ELSE                                                         26280000
262900         IF PV-TR015-ERD-TRIP-TYP-CDE EQUAL SPACES                26290000
263000             MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE          26300000
263100             MOVE 'TRIP TYP CDE'   TO PV-HOLD-TR221-DATA-IN-ERROR 26310000
263200             MOVE PV-TR015-ERD-TRIP-TYP-CDE   TO                  26320000
263300                   PV-HOLD-TR221-DATA-VALUE                       26330000
263400             MOVE 'DATA NOT SENT'             TO                  26340000
263500                   PV-HOLD-TR221-ERROR-MSG                        26350000
263600             PERFORM 5500-LOAD-ERD-TO-REPORT                      26360000
263700         ELSE                                                     26370000
263800             MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE          26380000
263900             MOVE 'TRIP TYP CDE'   TO PV-HOLD-TR221-DATA-IN-ERROR 26390000
264000             MOVE PV-TR015-ERD-TRIP-TYP-CDE   TO                  26400000
264100                   PV-HOLD-TR221-DATA-VALUE                       26410000
264200             MOVE 'INVALID TRIP TYPE'         TO                  26420000
264300                   PV-HOLD-TR221-ERROR-MSG                        26430000
264400             PERFORM 5500-LOAD-ERD-TO-REPORT                      26440000
264500         END-IF                                                   26450000
264600     END-IF.                                                      26460000
264700                                                                  26470000
264800     MOVE PV-TR015-ERD-EST-LBD-NM TO TR025-ERD-EST-LBD-NM.        26480000
264900                                                                  26490000
265101     MOVE PV-TR015-ERD-FILE-ID    TO TR025-ERD-FILE-ID.           26510100
265110     MOVE PV-TR015-ERD-ENT-ID     TO TR025-ERD-ENT-ID.            26511000
265200     MOVE PV-TR015-ERD-PROC-SEQ-NBR  TO                           26520000
265300                                TR025-ERD-PROCESS-SEQ-NBR.        26530000
265400     PERFORM 6400-WRITE-UPDATE-RECORD.                            26540000
265500                                                                  26550000
265600******************************************************************26560000
265700*  MOVE WORKING STORAGE ERDRSN RECORD FIELDS TO THE EDITED       *26570000
265800*  UPDATE EXTRACT FILE.                                          *26580000
265900******************************************************************26590000
266000 5310-LOAD-ERDRSN-FIELDS-UPDATE.                                  26600000
266100                                                                  26610000
266200     PERFORM 5410-INITIAL-ERDRSN-FIELDS-UPD.                      26620000
266300                                                                  26630000
266400     MOVE PV-TR015-ERDRSN-TRN-TYP  TO TR025-ERDRSN-TRN-TYP.       26640000
266500     MOVE PC-ERDRSN                TO TR025-ERDRSN-REC-TYP-CDE.   26650000
266600     MOVE PC-11                    TO TR025-ERDRSN-SEQ-NBR.       26660000
266700     MOVE PV-TR015-ERDRSN-3RD-PARTY-CDE TO                        26670000
266800                                   TR025-ERDRSN-3RD-PARTY-CDE.    26680000
266900                                                                  26690000
267000     EVALUATE TRUE                                                26700000
267100                                                                  26710000
267200         WHEN PV-TR015-ERDRSN-PO-NBR NOT NUMERIC OR               26720000
267300              PV-TR015-ERDRSN-PO-NBR  = ZERO                      26730000
267400               SET PS-EDIT-ERROR TO TRUE                          26740000
267500               MOVE PC-ERROR    TO PV-HOLD-TR221-ERROR-TYPE       26750000
267600               MOVE 'PO NUMBER' TO PV-HOLD-TR221-DATA-IN-ERROR    26760000
267700               MOVE PV-TR015-ERDRSN-PO-NBR TO                     26770000
267800                     PV-HOLD-TR221-DATA-VALUE                     26780000
267900               MOVE 'INVALID PO NUMBER'    TO                     26790000
268000                     PV-HOLD-TR221-ERROR-MSG                      26800000
268100               PERFORM 5510-LOAD-ERDRSN-TO-REPORT                 26810000
268200                                                                  26820000
268300         WHEN PV-TR015-ERDRSN-PO-RCV-DELY-DT EQUAL SPACES         26830000
268400             SET PS-EDIT-ERROR TO TRUE                            26840000
268500             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            26850000
268600             MOVE 'RCVD DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR  26860000
268700             MOVE PV-TR015-ERDRSN-PO-RCV-DELY-DT TO               26870000
268800                   PV-HOLD-TR221-DATA-VALUE                       26880000
268900             MOVE 'RCVD DELIVERY DATE NOT SENT' TO                26890000
269000                   PV-HOLD-TR221-ERROR-MSG                        26900000
269100             PERFORM 5510-LOAD-ERDRSN-TO-REPORT                   26910000
269200                                                                  26920000
269300         WHEN PV-TR015-ERDRSN-ORG-SHP-FR-CDE EQUAL SPACES OR      26930000
269400             (PV-TR015-ERDRSN-ORG-SHP-FR-CDE NOT EQUAL PC-CFS     26940000
269500              AND PC-CY)                                          26950000
269600             SET PS-EDIT-ERROR TO TRUE                            26960000
269700             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            26970000
269800             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR221-DATA-IN-ERROR 26980000
269900             MOVE PV-TR015-ERDRSN-ORG-SHP-FR-CDE  TO              26990000
270000                   PV-HOLD-TR221-DATA-VALUE                       27000000
270100             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               27010000
270200                   PV-HOLD-TR221-ERROR-MSG                        27020000
270300             PERFORM 5510-LOAD-ERDRSN-TO-REPORT                   27030000
270400                                                                  27040000
270500         WHEN PV-TR015-ERDRSN-PO-RCV-DELY-DT NOT EQUAL SPACES     27050000
270600                AND                                               27060000
270700              PV-TR015-ERDRSN-PO-RCV-DELY-DT NOT EQUAL            27070000
270800               PC-DEFAULT-DATE                                    27080000
270900             MOVE PV-TR015-ERDRSN-PO-RCV-DELY-DT   TO             27090000
271000                   PV-RCVD-DELY-DTE                               27100000
271100             MOVE PV-TR015-ERDRSN-PO-RCV-DELY-TM   TO             27110000
271200                   PV-RCVD-DELY-TM                                27120000
271300             PERFORM 5715-FORMAT-RCVD-DELY-TMST                   27130000
271400             IF PS-WARNING-DATE                                   27140000
271500                 SET PS-EDIT-ERROR TO TRUE                        27150000
271600                 MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE        27160000
271700                 MOVE PV-TR015-ERDRSN-PO-RCV-DELY-DT TO           27170000
271800                       PV-HOLD-TR221-DATA-VALUE                   27180000
271900                 MOVE 'DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR   27190000
272000                 MOVE 'INVALID DELIVERY DATE'        TO           27200000
272100                       PV-HOLD-TR221-ERROR-MSG                    27210000
272200                 PERFORM 5510-LOAD-ERDRSN-TO-REPORT               27220000
272300             ELSE                                                 27230000
272400                 IF PS-WARNING-TIME                               27240000
272500                     SET PS-EDIT-ERROR TO TRUE                    27250000
272600                     MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE    27260000
272700                     MOVE PV-TR015-ERDRSN-PO-RCV-DELY-TM TO       27270000
272800                           PV-HOLD-TR221-DATA-VALUE               27280000
272900                     MOVE 'DELY TM' TO PV-HOLD-TR221-DATA-IN-ERROR27290000
273000                     MOVE 'INVALID DELIVERY TIME'     TO          27300000
273100                           PV-HOLD-TR221-ERROR-MSG                27310000
273200                     PERFORM 5510-LOAD-ERDRSN-TO-REPORT           27320000
273300                 ELSE                                             27330000
273400                     MOVE PV-TR015-ERDRSN-PO-RCV-DELY-DT TO       27340000
273500                           TR025-ERDRSN-PO-RCVD-DELY-DTE          27350000
273600                     MOVE PV-TR015-ERDRSN-PO-RCV-DELY-TM TO       27360000
273700                           TR025-ERDRSN-PO-RCVD-DELY-TM           27370000
273800                 END-IF                                           27380000
273900             END-IF                                               27390000
274000             SET PS-WARNING-DATE-NO TO TRUE                       27400000
274100             SET PS-WARNING-TIME-NO TO TRUE                       27410000
274200     END-EVALUATE.                                                27420000
274300                                                                  27430000
274400     IF PS-EDIT-ERROR-NO                                          27440000
274500         MOVE PV-TR015-ERDRSN-PO-NBR       TO TR025-ERDRSN-PO-NBR 27450000
274600         MOVE PV-TR015-ERDRSN-EXTL-REF-NBR TO                     27460000
274700               TR025-ERDRSN-EXTL-REF-NBR                          27470000
274800         MOVE PV-TR015-ERDRSN-PO-RCV-DELY-DT  TO                  27480000
274900               TR025-ERDRSN-PO-RCVD-DELY-DTE                      27490000
275000         MOVE PV-TR015-ERDRSN-PO-RCV-DELY-TM  TO                  27500000
275100               TR025-ERDRSN-PO-RCVD-DELY-TM                       27510000
275200         MOVE PV-TR015-ERDRSN-ORG-SHP-FR-CDE TO                   27520000
275300               TR025-ERDRSN-ORGN-SHPD-FR-CDE                      27530000
275400         PERFORM 5315-LOAD-ERDRSN-FIELDS-UPD-2                    27540000
275500     ELSE                                                         27550000
275600         IF PS-LOG-SENT                                           27560000
275700             PERFORM 5520-LOAD-LOG-TO-REPORT                      27570000
275800         END-IF                                                   27580000
275900     END-IF.                                                      27590000
276000                                                                  27600000
276100******************************************************************27610000
276200*  MOVE WORKING STORAGE ERDRSN RECORD FIELDS TO THE EDITED       *27620000
276300*  UPDATE EXTRACT FILE.                                          *27630000
276400******************************************************************27640000
276500 5315-LOAD-ERDRSN-FIELDS-UPD-2.                                   27650000
276600                                                                  27660000
276700     MOVE PV-TR015-ERDRSN-IMPRT-TRIP-ID     TO                    27670000
276800                                   TR025-ERDRSN-IMPRT-TRIP-ID.    27680000
276900     IF PV-TR015-ERDRSN-IMPRT-TRIP-ID  EQUAL SPACES               27690000
277000         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              27700000
277100         MOVE 'IMPRT TRIP ID'    TO PV-HOLD-TR221-DATA-IN-ERROR   27710000
277200         MOVE PV-TR015-ERDRSN-IMPRT-TRIP-ID    TO                 27720000
277300               PV-HOLD-TR221-DATA-VALUE                           27730000
277400         MOVE 'DATA NOT SENT'             TO                      27740000
277500               PV-HOLD-TR221-ERROR-MSG                            27750000
277600         PERFORM 5510-LOAD-ERDRSN-TO-REPORT                       27760000
277700     END-IF.                                                      27770000
277800                                                                  27780000
277900     MOVE PV-TR015-ERDRSN-CARR-SCAC-ID    TO                      27790000
278000                                   TR025-ERDRSN-CARR-SCAC-ID.     27800000
278100                                                                  27810000
278200*    IF PV-TR015-ERDRSN-POE-DELY-DTE EQUAL SPACES                 27820000
278300*        MOVE PC-DEFAULT-DATE        TO TR025-ERDRSN-POE-DELY-DTE 27830000
278400*                                       PV-HOLD-POE-DELY-DTE      27840000
278500*    ELSE                                                         27850000
278600*        MOVE PV-TR015-ERDRSN-POE-DELY-DTE TO                     27860000
278700*                                    TR025-ERDRSN-POE-DELY-DTE    27870000
278800*                                    PV-HOLD-POE-DELY-DTE         27880000
278900*    END-IF.                                                      27890000
279000*                                                                 27900000
279100*    IF PV-TR015-ERDRSN-POE-DELY-TM EQUAL SPACES                  27910000
279200*        MOVE PC-DEFAULT-TIME       TO TR025-ERDRSN-POE-DELY-TM   27920000
279300*                                      PV-HOLD-POE-DELY-TM        27930000
279400*    ELSE                                                         27940000
279500*        MOVE PV-TR015-ERDRSN-POE-DELY-TM  TO                     27950000
279600*                                      TR025-ERDRSN-POE-DELY-TM   27960000
279700*                                      PV-HOLD-POE-DELY-TM        27970000
279800*    END-IF.                                                      27980000
279900*                                                                 27990000
280000*    PERFORM 5705-FORMAT-POE-DELY-TMST.                           28000000
280100*    IF PS-WARNING-DATE                                           28010000
280200*        MOVE PC-WARNING        TO PV-HOLD-TR221-ERROR-TYPE       28020000
280300*        MOVE 'POE DELY DTE'    TO PV-HOLD-TR221-DATA-IN-ERROR    28030000
280400*        MOVE PV-TR015-ERDRSN-POE-DELY-DTE     TO                 28040000
280500*              PV-HOLD-TR221-DATA-VALUE                           28050000
280600*        MOVE 'INVALID DATE'                   TO                 28060000
280700*              PV-HOLD-TR221-ERROR-MSG                            28070000
280800*        PERFORM 5510-LOAD-ERDRSN-TO-REPORT                       28080000
280900*        MOVE PC-DEFAULT-DATE   TO TR025-ERDRSN-POE-DELY-DTE      28090000
281000*    ELSE                                                         28100000
281100*        IF PS-WARNING-TIME                                       28110000
281200*            MOVE PC-WARNING    TO PV-HOLD-TR221-ERROR-TYPE       28120000
281300*            MOVE 'POE DELY TM' TO PV-HOLD-TR221-DATA-IN-ERROR    28130000
281400*            MOVE PV-TR015-ERDRSN-POE-DELY-TM     TO              28140000
281500*                  PV-HOLD-TR221-DATA-VALUE                       28150000
281600*            MOVE 'INVALID TIME'               TO                 28160000
281700*                  PV-HOLD-TR221-ERROR-MSG                        28170000
281800*            PERFORM 5510-LOAD-ERDRSN-TO-REPORT                   28180000
281900*            MOVE PC-DEFAULT-TIME TO TR025-ERDRSN-POE-DELY-TM     28190000
282000*        END-IF                                                   28200000
282100*    END-IF.                                                      28210000
282200*    SET PS-WARNING-DATE-NO     TO TRUE.                          28220000
282300*    SET PS-WARNING-TIME-NO     TO TRUE.                          28230000
282400                                                                  28240000
282500     MOVE PC-DEFAULT-DATE       TO TR025-ERDRSN-POE-DELY-DTE.     28250000
282600     MOVE PC-DEFAULT-TIME       TO TR025-ERDRSN-POE-DELY-TM.      28260000
282700                                                                  28270000
282800     IF PV-TR015-ERDRSN-DPRTR-DTE EQUAL SPACES                    28280000
282900         MOVE PC-DEFAULT-DATE         TO TR025-ERDRSN-DPRTR-DTE   28290000
283000                                         PV-HOLD-DPRTR-DTE        28300000
283100     ELSE                                                         28310000
283200         MOVE PV-TR015-ERDRSN-DPRTR-DTE  TO                       28320000
283300                                      TR025-ERDRSN-DPRTR-DTE      28330000
283400                                      PV-HOLD-DPRTR-DTE           28340000
283500     END-IF.                                                      28350000
283600                                                                  28360000
283700     IF PV-TR015-ERDRSN-DPRTR-TM EQUAL SPACES                     28370000
283800         MOVE PC-DEFAULT-TIME         TO TR025-ERDRSN-DPRTR-TM    28380000
283900                                         PV-HOLD-DPRTR-TM         28390000
284000     ELSE                                                         28400000
284100         MOVE PV-TR015-ERDRSN-DPRTR-TM   TO TR025-ERDRSN-DPRTR-TM 28410000
284200                                         PV-HOLD-DPRTR-TM         28420000
284300     END-IF.                                                      28430000
284400                                                                  28440000
284500     PERFORM 5700-FORMAT-DPRTR-TMST.                              28450000
284600     IF PS-WARNING-DATE                                           28460000
284700         MOVE PC-WARNING        TO PV-HOLD-TR221-ERROR-TYPE       28470000
284800         MOVE 'DPRTR DTE'       TO PV-HOLD-TR221-DATA-IN-ERROR    28480000
284900         MOVE PV-TR015-ERDRSN-DPRTR-DTE        TO                 28490000
285000               PV-HOLD-TR221-DATA-VALUE                           28500000
285100         MOVE 'INVALID DATE'                   TO                 28510000
285200               PV-HOLD-TR221-ERROR-MSG                            28520000
285300         PERFORM 5510-LOAD-ERDRSN-TO-REPORT                       28530000
285400         MOVE PC-DEFAULT-DATE      TO TR025-ERDRSN-DPRTR-DTE      28540000
285500     ELSE                                                         28550000
285600         IF PS-WARNING-TIME                                       28560000
285700             MOVE PC-WARNING   TO PV-HOLD-TR221-ERROR-TYPE        28570000
285800             MOVE 'DPRTR TM'   TO PV-HOLD-TR221-DATA-IN-ERROR     28580000
285900             MOVE PV-TR015-ERDRSN-DPRTR-TM        TO              28590000
286000                   PV-HOLD-TR221-DATA-VALUE                       28600000
286100             MOVE 'INVALID TIME'                  TO              28610000
286200                   PV-HOLD-TR221-ERROR-MSG                        28620000
286300             PERFORM 5510-LOAD-ERDRSN-TO-REPORT                   28630000
286400             MOVE PC-DEFAULT-TIME  TO TR025-ERDRSN-DPRTR-TM       28640000
286500         END-IF                                                   28650000
286600     END-IF.                                                      28660000
286700     SET PS-WARNING-DATE-NO     TO TRUE.                          28670000
286800     SET PS-WARNING-TIME-NO     TO TRUE.                          28680000
286900                                                                  28690000
287000     MOVE PV-TR015-ERDRSN-VOY-CHG-RSN-DS   TO                     28700000
287100                                TR025-ERDRSN-VOY-CHG-RSN-DESC.    28710000
287200     IF PV-TR015-ERDRSN-VOY-CHG-RSN-DS   EQUAL SPACES             28720000
287300         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              28730000
287400         MOVE 'VOY CHG RSN'    TO PV-HOLD-TR221-DATA-IN-ERROR     28740000
287500         MOVE PV-TR015-ERDRSN-VOY-CHG-RSN-DS    TO                28750000
287600               PV-HOLD-TR221-DATA-VALUE                           28760000
287700         MOVE 'DATA NOT SENT'                   TO                28770000
287800               PV-HOLD-TR221-ERROR-MSG                            28780000
287900         PERFORM 5510-LOAD-ERDRSN-TO-REPORT                       28790000
288000     END-IF.                                                      28800000
288100                                                                  28810000
288101     MOVE PV-TR015-ERDRSN-FILE-ID    TO TR025-ERDRSN-FILE-ID.     28810100
288110     MOVE PV-TR015-ERDRSN-ENT-ID     TO TR025-ERDRSN-ENT-ID.      28811000
288120                                                                  28812000
288200     MOVE PV-TR015-ERDRSN-PROC-SEQ-NBR   TO                       28820000
288300           TR025-ERDRSN-PROCESS-SEQ-NBR                           28830000
288400     PERFORM 6400-WRITE-UPDATE-RECORD.                            28840000
288500                                                                  28850000
288600******************************************************************28860000
288700*  MOVE WORKING STORAGE LOG RECORD FIELDS TO THE EDITED UPDATE   *28870000
288800*  EXTRACT FILE.                                                 *28880000
288900******************************************************************28890000
289000 5320-LOAD-LOG-FIELDS-UPDATE.                                     28900000
289100                                                                  28910000
289200     PERFORM 5420-INITIAL-LOG-FIELDS-UPD.                         28920000
289300                                                                  28930000
289400     MOVE PV-TR015-LOG-TRN-TYP        TO TR025-LOG-TRN-TYP.       28940000
289500     MOVE PC-LOG                      TO TR025-LOG-REC-TYP-CDE.   28950000
289600     MOVE PC-20                       TO TR025-LOG-SEQ-NBR.       28960000
289700     MOVE PV-TR015-LOG-3RD-PARTY-CDE  TO TR025-LOG-3RD-PARTY-CDE. 28970000
289800                                                                  28980000
289900     EVALUATE TRUE                                                28990000
290000                                                                  29000000
290100         WHEN PV-TR015-LOG-PO-NBR NOT NUMERIC OR                  29010000
290200              PV-TR015-LOG-PO-NBR  = ZERO                         29020000
290300               SET PS-EDIT-ERROR TO TRUE                          29030000
290400               MOVE PC-ERROR    TO PV-HOLD-TR221-ERROR-TYPE       29040000
290500               MOVE 'PO NUMBER' TO PV-HOLD-TR221-DATA-IN-ERROR    29050000
290600               MOVE PV-TR015-LOG-PO-NBR TO                        29060000
290700                     PV-HOLD-TR221-DATA-VALUE                     29070000
290800               MOVE 'INVALID PO NUMBER'    TO                     29080000
290900                     PV-HOLD-TR221-ERROR-MSG                      29090000
291000               PERFORM 5520-LOAD-LOG-TO-REPORT                    29100000
291100                                                                  29110000
291200         WHEN PV-TR015-LOG-PO-RCVD-DELY-DTE EQUAL SPACES          29120000
291300             SET PS-EDIT-ERROR TO TRUE                            29130000
291400             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            29140000
291500             MOVE 'RCVD DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR  29150000
291600             MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO                29160000
291700                   PV-HOLD-TR221-DATA-VALUE                       29170000
291800             MOVE 'RCVD DELIVERY DATE NOT SENT' TO                29180000
291900                   PV-HOLD-TR221-ERROR-MSG                        29190000
292000             PERFORM 5520-LOAD-LOG-TO-REPORT                      29200000
292100                                                                  29210000
292200         WHEN PV-TR015-LOG-ORGN-SHPD-FR-CDE EQUAL SPACES OR       29220000
292300             (PV-TR015-LOG-ORGN-SHPD-FR-CDE NOT EQUAL PC-CFS      29230000
292400              AND PC-CY)                                          29240000
292500             SET PS-EDIT-ERROR TO TRUE                            29250000
292600             MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE            29260000
292700             MOVE 'ORG SHP FR CDE' TO PV-HOLD-TR221-DATA-IN-ERROR 29270000
292800             MOVE PV-TR015-LOG-ORGN-SHPD-FR-CDE  TO               29280000
292900                   PV-HOLD-TR221-DATA-VALUE                       29290000
293000             MOVE 'ORGN SHPD FROM CDE NOT SENT'  TO               29300000
293100                   PV-HOLD-TR221-ERROR-MSG                        29310000
293200             PERFORM 5520-LOAD-LOG-TO-REPORT                      29320000
293300                                                                  29330000
293400         WHEN PV-TR015-LOG-PO-RCVD-DELY-DTE NOT EQUAL SPACES      29340000
293500                AND                                               29350000
293600              PV-TR015-LOG-PO-RCVD-DELY-DTE NOT EQUAL             29360000
293700               PC-DEFAULT-DATE                                    29370000
293800             MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE   TO              29380000
293900                   PV-RCVD-DELY-DTE                               29390000
294000             MOVE PV-TR015-LOG-PO-RCVD-DELY-TM    TO              29400000
294100                   PV-RCVD-DELY-TM                                29410000
294200             PERFORM 5715-FORMAT-RCVD-DELY-TMST                   29420000
294300             IF PS-WARNING-DATE                                   29430000
294400                 SET PS-EDIT-ERROR TO TRUE                        29440000
294500                 MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE        29450000
294600                 MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO            29460000
294700                       PV-HOLD-TR221-DATA-VALUE                   29470000
294800                 MOVE 'DELY DTE' TO PV-HOLD-TR221-DATA-IN-ERROR   29480000
294900                 MOVE 'INVALID DELIVERY DATE'      TO             29490000
295000                       PV-HOLD-TR221-ERROR-MSG                    29500000
295100                 PERFORM 5520-LOAD-LOG-TO-REPORT                  29510000
295200             ELSE                                                 29520000
295300                 IF PS-WARNING-TIME                               29530000
295400                     SET PS-EDIT-ERROR TO TRUE                    29540000
295500                     MOVE PC-ERROR TO PV-HOLD-TR221-ERROR-TYPE    29550000
295600                     MOVE PV-TR015-LOG-PO-RCVD-DELY-TM TO         29560000
295700                           PV-HOLD-TR221-DATA-VALUE               29570000
295800                     MOVE 'DELY TM' TO PV-HOLD-TR221-DATA-IN-ERROR29580000
295900                     MOVE 'INVALID DELIVERY TIME'     TO          29590000
296000                           PV-HOLD-TR221-ERROR-MSG                29600000
296100                     PERFORM 5520-LOAD-LOG-TO-REPORT              29610000
296200                 ELSE                                             29620000
296300                     MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO        29630000
296400                           TR025-LOG-PO-RCVD-DELY-DTE             29640000
296500                     MOVE PV-TR015-LOG-PO-RCVD-DELY-TM TO         29650000
296600                           TR025-LOG-PO-RCVD-DELY-TM              29660000
296700                 END-IF                                           29670000
296800             END-IF                                               29680000
296900             SET PS-WARNING-DATE-NO TO TRUE                       29690000
297000             SET PS-WARNING-TIME-NO TO TRUE                       29700000
297100     END-EVALUATE.                                                29710000
297200                                                                  29720000
297300     IF PS-EDIT-ERROR-NO                                          29730000
297400         MOVE PV-TR015-LOG-PO-NBR       TO TR025-LOG-PO-NBR       29740000
297500         MOVE PV-TR015-LOG-EXTL-REF-NBR TO                        29750000
297600               TR025-LOG-EXTL-REF-NBR                             29760000
297700         MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO                    29770000
297800               TR025-LOG-PO-RCVD-DELY-DTE                         29780000
297900         MOVE PV-TR015-LOG-PO-RCVD-DELY-TM TO                     29790000
298000               TR025-LOG-PO-RCVD-DELY-TM                          29800000
298100         MOVE PV-TR015-LOG-ORGN-SHPD-FR-CDE TO                    29810000
298200               TR025-LOG-ORGN-SHPD-FR-CDE                         29820000
298300         PERFORM 5325-LOAD-LOG-FIELDS-UPDATE-2                    29830000
298400     END-IF.                                                      29840000
298500                                                                  29850000
298600******************************************************************29860000
298700*  MOVE WORKING STORAGE LOG RECORD FIELDS TO THE EDITED          *29870000
298800*  UPDATE EXTRACT FILE.                                          *29880000
298900******************************************************************29890000
299000 5325-LOAD-LOG-FIELDS-UPDATE-2.                                   29900000
299100                                                                  29910000
299200     IF PV-TR015-LOG-PO-CART-CNT NOT NUMERIC                      29920000
299300         MOVE PV-TR015-LOG-PO-CART-CNT-X  TO                      29930000
299400               TR025-LOG-PO-CART-CNT-X                            29940000
299500         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              29950000
299600         MOVE 'PO CARTON COUNT' TO PV-HOLD-TR221-DATA-IN-ERROR    29960000
299700         MOVE PV-TR015-LOG-PO-CART-CNT-X  TO                      29970000
299800               PV-HOLD-TR221-DATA-VALUE                           29980000
299900         MOVE 'INVALID CARTON COUNT'      TO                      29990000
300000               PV-HOLD-TR221-ERROR-MSG                            30000000
300100         PERFORM 5520-LOAD-LOG-TO-REPORT                          30010000
300200         MOVE ZEROES TO TR025-LOG-PO-CART-CNT                     30020000
300300     ELSE                                                         30030000
300400         MOVE PV-TR015-LOG-PO-CART-CNT TO TR025-LOG-PO-CART-CNT   30040000
300500     END-IF.                                                      30050000
300600                                                                  30060000
300700     IF PV-TR015-LOG-PO-UNT-QTY NOT NUMERIC                       30070000
300800         MOVE PV-TR015-LOG-PO-UNT-QTY-X TO                        30080000
300900               TR025-LOG-PO-UNT-QTY-X                             30090000
301000         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              30100000
301100         MOVE 'PO UNIT QTY' TO PV-HOLD-TR221-DATA-IN-ERROR        30110000
301200         MOVE PV-TR015-LOG-PO-UNT-QTY-X TO                        30120000
301300               PV-HOLD-TR221-DATA-VALUE                           30130000
301400         MOVE 'INVALID UNIT QTY'        TO                        30140000
301500               PV-HOLD-TR221-ERROR-MSG                            30150000
301600         PERFORM 5520-LOAD-LOG-TO-REPORT                          30160000
301700         MOVE ZEROES TO TR025-LOG-PO-UNT-QTY                      30170000
301800     ELSE                                                         30180000
301900         MOVE PV-TR015-LOG-PO-UNT-QTY TO TR025-LOG-PO-UNT-QTY     30190000
302000     END-IF.                                                      30200000
302100                                                                  30210000
302200     IF PV-TR015-LOG-PO-CBMT-QTY NOT NUMERIC                      30220000
302300         MOVE PV-TR015-LOG-PO-CBMT-QTY-X TO                       30230000
302400               TR025-LOG-PO-CBMT-QTY-X                            30240000
302500         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              30250000
302600         MOVE 'PO CBMT QTY' TO PV-HOLD-TR221-DATA-IN-ERROR        30260000
302700         MOVE PV-TR015-LOG-PO-CBMT-QTY-X TO                       30270000
302800                        PV-HOLD-TR221-DATA-VALUE-NUM              30280000
302900         MOVE 'INVALID CBM QTY'          TO                       30290000
303000               PV-HOLD-TR221-ERROR-MSG                            30300000
303100         PERFORM 5520-LOAD-LOG-TO-REPORT                          30310000
303200         MOVE ZEROES TO TR025-LOG-PO-CBMT-QTY                     30320000
303300     ELSE                                                         30330000
303400         MOVE PV-TR015-LOG-PO-CBMT-QTY TO TR025-LOG-PO-CBMT-QTY   30340000
303500     END-IF.                                                      30350000
303600                                                                  30360000
303700     IF PV-TR015-LOG-PO-WT-KGRM-QTY NOT NUMERIC                   30370000
303800         MOVE PV-TR015-LOG-PO-WT-KGRM-QTY-X TO                    30380000
303900               TR025-LOG-PO-WT-KGRM-QTY-X                         30390000
304000         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              30400000
304100         MOVE 'PO WT KGRM QTY' TO PV-HOLD-TR221-DATA-IN-ERROR     30410000
304200         MOVE PV-TR015-LOG-PO-WT-KGRM-QTY-X TO                    30420000
304300               PV-HOLD-TR221-DATA-VALUE                           30430000
304400         MOVE 'INVALID KGRM QTY   '         TO                    30440000
304500               PV-HOLD-TR221-ERROR-MSG                            30450000
304600         PERFORM 5520-LOAD-LOG-TO-REPORT                          30460000
304700         MOVE ZEROES TO TR025-LOG-PO-WT-KGRM-QTY                  30470000
304800     ELSE                                                         30480000
304900         MOVE PV-TR015-LOG-PO-WT-KGRM-QTY   TO                    30490000
305000               TR025-LOG-PO-WT-KGRM-QTY                           30500000
305100     END-IF.                                                      30510000
305200                                                                  30520000
305300     MOVE PV-TR015-LOG-PROD-FCTRY-NM  TO TR025-LOG-PROD-FCTRY-NM. 30530000
305400*    IF PV-TR015-LOG-PROD-FCTRY-NM    EQUAL SPACES                30540000
305500*        MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              30550000
305600*        MOVE 'PROD FCTRY NM'   TO PV-HOLD-TR221-DATA-IN-ERROR    30560000
305700*        MOVE PV-TR015-LOG-PROD-FCTRY-NM     TO                   30570000
305800*              PV-HOLD-TR221-DATA-VALUE                           30580000
305900*        MOVE 'DATA NOT SENT'                TO                   30590000
306000*              PV-HOLD-TR221-ERROR-MSG                            30600000
306100*        PERFORM 5520-LOAD-LOG-TO-REPORT                          30610000
306200*    END-IF.                                                      30620000
306300                                                                  30630000
306400     MOVE PV-TR015-LOG-C-O-PROD-CDE   TO TR025-LOG-C-O-PROD-CDE.  30640000
306500                                                                  30650000
306600     MOVE PV-TR015-LOG-CONSOL-SCAC-ID TO TR025-LOG-CONSOL-SCAC-ID.30660000
306700     IF PV-TR015-LOG-CONSOL-SCAC-ID EQUAL SPACES                  30670000
306800         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              30680000
306900         MOVE 'CONSOL SCAC ID' TO PV-HOLD-TR221-DATA-IN-ERROR     30690000
307000         MOVE PV-TR015-LOG-CONSOL-SCAC-ID TO                      30700000
307100               PV-HOLD-TR221-DATA-VALUE                           30710000
307200         MOVE 'DATA NOT SENT'             TO                      30720000
307300               PV-HOLD-TR221-ERROR-MSG                            30730000
307400         PERFORM 5520-LOAD-LOG-TO-REPORT                          30740000
307500     END-IF.                                                      30750000
307600                                                                  30760000
307601     MOVE PV-TR015-LOG-FILE-ID       TO TR025-LOG-FILE-ID.        30760100
307610     MOVE PV-TR015-LOG-ENT-ID        TO TR025-LOG-ENT-ID.         30761000
307620                                                                  30762000
307700     MOVE PV-TR015-LOG-PROC-SEQ-NBR   TO                          30770000
307800           TR025-LOG-PROCESS-SEQ-NBR.                             30780000
307900     PERFORM 6400-WRITE-UPDATE-RECORD.                            30790000
308000                                                                  30800000
308100******************************************************************30810000
308200*  MOVE WORKING STORAGE LOGVS RECORD FIELDS TO THE EDITED UPDATE *30820000
308300*  EXTRACT FILE.                                                 *30830000
308400******************************************************************30840000
308500 5330-LOAD-LOGVS-FIELDS-UPDATE.                                   30850000
308600                                                                  30860000
308700     PERFORM 5430-INITIAL-LOGVS-FIELDS-UPD.                       30870000
308800                                                                  30880000
308900     MOVE PV-TR015-LOGVS-TRN-TYP    TO TR025-LOGVS-TRN-TYP.       30890000
309000     MOVE PC-LOGVS                  TO TR025-LOGVS-REC-TYP-CDE.   30900000
309100     MOVE PC-21                     TO TR025-LOGVS-SEQ-NBR.       30910000
309200     MOVE PV-TR015-LOGVS-3RD-PARTY-CDE TO                         30920000
309300                                    TR025-LOGVS-3RD-PARTY-CDE.    30930000
309400                                                                  30940000
309500     IF PV-TR015-LOGVS-PO-NBR NOT NUMERIC                         30950000
309600         MOVE PV-TR015-LOGVS-PO-NBR-X TO TR025-LOGVS-PO-NBR-X     30960000
309700     ELSE                                                         30970000
309800         MOVE PV-TR015-LOGVS-PO-NBR   TO TR025-LOGVS-PO-NBR       30980000
309900     END-IF.                                                      30990000
310000                                                                  31000000
310100     MOVE PV-TR015-LOGVS-EXTL-REF-NBR TO TR025-LOGVS-EXTL-REF-NBR.31010000
310200                                                                  31020000
310300     MOVE PV-TR015-LOGVS-PO-RCV-DELY-DTE TO                       31030000
310400                                   TR025-LOGVS-PO-RCVD-DELY-DTE.  31040000
310500     MOVE PV-TR015-LOGVS-PO-RCV-DELY-TM  TO                       31050000
310600                                   TR025-LOGVS-PO-RCVD-DELY-TM.   31060000
310700     MOVE PV-TR015-LOGVS-ORG-SHP-FR-CDE  TO                       31070000
310800                                   TR025-LOGVS-ORGN-SHPD-FR-CDE.  31080000
310900                                                                  31090000
311000     MOVE PV-TR015-LOGVS-VS-NBR          TO TR025-LOGVS-VS-NBR.   31100000
311100                                                                  31110000
311200     IF PV-TR015-LOGVS-CART-CNT NOT NUMERIC                       31120000
311300         MOVE PV-TR015-LOGVS-CART-CNT-X  TO                       31130000
311400               TR025-LOGVS-VS-CART-CNT-X                          31140000
311500         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              31150000
311600         MOVE 'VS CARTON COUNT' TO PV-HOLD-TR221-DATA-IN-ERROR    31160000
311700         MOVE PV-TR015-LOGVS-CART-CNT-X  TO                       31170000
311800               PV-HOLD-TR221-DATA-VALUE                           31180000
311900         MOVE 'INVALID CARTON COUNT'     TO                       31190000
312000               PV-HOLD-TR221-ERROR-MSG                            31200000
312100         PERFORM 5530-LOAD-LOGVS-TO-REPORT                        31210000
312200         MOVE ZEROES TO TR025-LOGVS-VS-CART-CNT                   31220000
312300     ELSE                                                         31230000
312400         MOVE PV-TR015-LOGVS-CART-CNT TO TR025-LOGVS-VS-CART-CNT  31240000
312500     END-IF.                                                      31250000
312600                                                                  31260000
312700     IF PV-TR015-LOGVS-UNT-QTY NOT NUMERIC                        31270000
312800         MOVE PV-TR015-LOGVS-UNT-QTY-X  TO                        31280000
312900               TR025-LOGVS-VS-UNT-QTY-X                           31290000
313000         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              31300000
313100         MOVE 'VS UNIT QTY' TO PV-HOLD-TR221-DATA-IN-ERROR        31310000
313200         MOVE PV-TR015-LOGVS-UNT-QTY-X  TO                        31320000
313300               PV-HOLD-TR221-DATA-VALUE                           31330000
313400         MOVE 'INVALID UNIT QTY'        TO                        31340000
313500               PV-HOLD-TR221-ERROR-MSG                            31350000
313600         PERFORM 5530-LOAD-LOGVS-TO-REPORT                        31360000
313700         MOVE ZEROES TO TR025-LOGVS-VS-UNT-QTY                    31370000
313800     ELSE                                                         31380000
313900         MOVE PV-TR015-LOGVS-UNT-QTY TO TR025-LOGVS-VS-UNT-QTY    31390000
314000     END-IF.                                                      31400000
314100                                                                  31410000
314200     IF PV-TR015-LOGVS-CBMT-QTY NOT NUMERIC                       31420000
314300         MOVE PV-TR015-LOGVS-CBMT-QTY-X  TO                       31430000
314400               TR025-LOGVS-VS-CBMT-QTY-X                          31440000
314500         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              31450000
314600         MOVE 'VS CBMT QTY' TO PV-HOLD-TR221-DATA-IN-ERROR        31460000
314700         MOVE PV-TR015-LOGVS-CBMT-QTY-X  TO                       31470000
314800               PV-HOLD-TR221-DATA-VALUE-NUM                       31480000
314900         MOVE 'INVALID CBM QTY'          TO                       31490000
315000               PV-HOLD-TR221-ERROR-MSG                            31500000
315100         PERFORM 5530-LOAD-LOGVS-TO-REPORT                        31510000
315200         MOVE ZEROES TO TR025-LOGVS-VS-CBMT-QTY                   31520000
315300     ELSE                                                         31530000
315400         MOVE PV-TR015-LOGVS-CBMT-QTY    TO                       31540000
315500               TR025-LOGVS-VS-CBMT-QTY                            31550000
315600     END-IF.                                                      31560000
315700                                                                  31570000
315800     IF PV-TR015-LOGVS-WT-KGRM-QTY NOT NUMERIC                    31580000
315900         MOVE PV-TR015-LOGVS-WT-KGRM-QTY-X  TO                    31590000
316000               TR025-LOGVS-VS-WT-KGRM-QTY-X                       31600000
316100         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              31610000
316200         MOVE 'VS WT KGRM QTY' TO PV-HOLD-TR221-DATA-IN-ERROR     31620000
316300         MOVE PV-TR015-LOGVS-WT-KGRM-QTY-X  TO                    31630000
316400               PV-HOLD-TR221-DATA-VALUE                           31640000
316500         MOVE 'INVALID KGRM QTY'            TO                    31650000
316600               PV-HOLD-TR221-ERROR-MSG                            31660000
316700         PERFORM 5530-LOAD-LOGVS-TO-REPORT                        31670000
316800         MOVE ZEROES TO TR025-LOGVS-VS-WT-KGRM-QTY                31680000
316900     ELSE                                                         31690000
317000         MOVE PV-TR015-LOGVS-WT-KGRM-QTY    TO                    31700000
317100               TR025-LOGVS-VS-WT-KGRM-QTY                         31710000
317200     END-IF.                                                      31720000
317300                                                                  31730000
317301     MOVE PV-TR015-LOGVS-FILE-ID     TO TR025-LOGVS-FILE-ID.      31730100
317310     MOVE PV-TR015-LOGVS-ENT-ID      TO TR025-LOGVS-ENT-ID.       31731000
317400     MOVE PV-TR015-LOGVS-PROC-SEQ-NBR   TO                        31740000
317500           TR025-LOGVS-PROCESS-SEQ-NBR.                           31750000
317600     PERFORM 6400-WRITE-UPDATE-RECORD.                            31760000
317700                                                                  31770000
317800******************************************************************31780000
317900*  MOVE WORKING STORAGE LOGUPC RECORD FIELDS TO THE EDITED       *31790000
318000*  UPDATE EXTRACT FILE.                                          *31800000
318100******************************************************************31810000
318200 5340-LOAD-LOGUPC-FIELDS-UPDATE.                                  31820000
318300                                                                  31830000
318400     PERFORM 5440-INITIAL-LOGUPC-FIELDS-UPD.                      31840000
318500                                                                  31850000
318600     MOVE PV-TR015-LOGUPC-TRN-TYP   TO TR025-LOGUPC-TRN-TYP.      31860000
318700     MOVE PC-LOGUPC                 TO TR025-LOGUPC-REC-TYP-CDE.  31870000
318800     MOVE PC-22                     TO TR025-LOGUPC-SEQ-NBR.      31880000
318900     MOVE PV-TR015-LOGUPC-3RD-PARTY-CDE TO                        31890000
319000                                TR025-LOGUPC-3RD-PARTY-CDE.       31900000
319100                                                                  31910000
319200     IF PV-TR015-LOGUPC-PO-NBR NOT NUMERIC                        31920000
319300         MOVE PV-TR015-LOGUPC-PO-NBR-X TO TR025-LOGUPC-PO-NBR-X   31930000
319400     ELSE                                                         31940000
319500         MOVE PV-TR015-LOGUPC-PO-NBR TO TR025-LOGUPC-PO-NBR       31950000
319600     END-IF.                                                      31960000
319700                                                                  31970000
319800     MOVE PV-TR015-LOGUPC-EXTL-REF-NBR       TO                   31980000
319900                                   TR025-LOGUPC-EXTL-REF-NBR.     31990000
320000                                                                  32000000
320100     MOVE PV-TR015-LOGUPC-PO-RCV-DELY-DT  TO                      32010000
320200                                TR025-LOGUPC-PO-RCVD-DELY-DTE.    32020000
320300     MOVE PV-TR015-LOGUPC-PO-RCV-DELY-TM  TO                      32030000
320400                                TR025-LOGUPC-PO-RCVD-DELY-TM.     32040000
320500     MOVE PV-TR015-LOGUPC-ORG-SHP-FR-CDE  TO                      32050000
320600                                   TR025-LOGUPC-ORGN-SHPD-FR-CDE. 32060000
320700                                                                  32070000
320800     MOVE PV-TR015-LOGUPC-VS-NBR       TO TR025-LOGUPC-VS-NBR.    32080000
320900                                                                  32090000
321000     IF PV-TR015-LOGUPC-UPC-NBR NOT NUMERIC                       32100000
321100         MOVE PV-TR015-LOGUPC-UPC-NBR-X TO TR025-LOGUPC-UPC-NBR-X 32110000
321200     ELSE                                                         32120000
321300         MOVE PV-TR015-LOGUPC-UPC-NBR TO TR025-LOGUPC-UPC-NBR     32130000
321400     END-IF.                                                      32140000
321500                                                                  32150000
321600                                                                  32160000
321700     IF PV-TR015-LOGUPC-CART-CNT NOT NUMERIC                      32170000
321800         MOVE PV-TR015-LOGUPC-CART-CNT-X TO                       32180000
321900               TR025-LOGUPC-UPC-CART-CNT-X                        32190000
322000         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              32200000
322100         MOVE 'UPC CARTON COUNT' TO PV-HOLD-TR221-DATA-IN-ERROR   32210000
322200         MOVE PV-TR015-LOGUPC-CART-CNT-X   TO                     32220000
322300               PV-HOLD-TR221-DATA-VALUE                           32230000
322400         MOVE 'INVALID CARTON COUNT'       TO                     32240000
322500               PV-HOLD-TR221-ERROR-MSG                            32250000
322600         PERFORM 5540-LOAD-LOGUPC-TO-REPORT                       32260000
322700         MOVE ZEROES TO TR025-LOGUPC-UPC-CART-CNT                 32270000
322800     ELSE                                                         32280000
322900         MOVE PV-TR015-LOGUPC-CART-CNT TO                         32290000
323000                                   TR025-LOGUPC-UPC-CART-CNT      32300000
323100     END-IF.                                                      32310000
323200                                                                  32320000
323300     IF PV-TR015-LOGUPC-UNT-QTY NOT NUMERIC                       32330000
323400         MOVE PV-TR015-LOGUPC-UNT-QTY-X     TO                    32340000
323500               TR025-LOGUPC-UPC-UNT-QTY-X                         32350000
323600         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              32360000
323700         MOVE 'UPC UNIT QTY' TO PV-HOLD-TR221-DATA-IN-ERROR       32370000
323800         MOVE PV-TR015-LOGUPC-UNT-QTY-X     TO                    32380000
323900               PV-HOLD-TR221-DATA-VALUE                           32390000
324000         MOVE 'INVALID UNIT QTY'            TO                    32400000
324100               PV-HOLD-TR221-ERROR-MSG                            32410000
324200         PERFORM 5540-LOAD-LOGUPC-TO-REPORT                       32420000
324300         MOVE ZEROES TO TR025-LOGUPC-UPC-UNT-QTY                  32430000
324400     ELSE                                                         32440000
324500         MOVE PV-TR015-LOGUPC-UNT-QTY       TO                    32450000
324600               TR025-LOGUPC-UPC-UNT-QTY                           32460000
324700     END-IF.                                                      32470000
324800                                                                  32480000
324900     IF PV-TR015-LOGUPC-CBMT-QTY NOT NUMERIC                      32490000
325000         MOVE PV-TR015-LOGUPC-CBMT-QTY-X     TO                   32500000
325100               TR025-LOGUPC-UPC-CBMT-QTY-X                        32510000
325200         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              32520000
325300         MOVE 'UPC CBMT QTY' TO PV-HOLD-TR221-DATA-IN-ERROR       32530000
325400         MOVE PV-TR015-LOGUPC-CBMT-QTY-X     TO                   32540000
325500               PV-HOLD-TR221-DATA-VALUE-NUM                       32550000
325600         MOVE 'INVALID CBM QTY'              TO                   32560000
325700               PV-HOLD-TR221-ERROR-MSG                            32570000
325800         PERFORM 5540-LOAD-LOGUPC-TO-REPORT                       32580000
325900         MOVE ZEROES TO TR025-LOGUPC-UPC-CBMT-QTY                 32590000
326000     ELSE                                                         32600000
326100         MOVE PV-TR015-LOGUPC-CBMT-QTY       TO                   32610000
326200               TR025-LOGUPC-UPC-CBMT-QTY                          32620000
326300     END-IF.                                                      32630000
326400                                                                  32640000
326500     IF PV-TR015-LOGUPC-WT-KGRM-QTY NOT NUMERIC                   32650000
326600         MOVE PV-TR015-LOGUPC-WT-KGRM-QTY-X   TO                  32660000
326700               TR025-LOGUPC-UPC-WT-KGRM-QTY-X                     32670000
326800         MOVE PC-WARNING TO PV-HOLD-TR221-ERROR-TYPE              32680000
326900         MOVE 'UPC WT KGRM QTY' TO PV-HOLD-TR221-DATA-IN-ERROR    32690000
327000         MOVE PV-TR015-LOGUPC-WT-KGRM-QTY-X   TO                  32700000
327100               PV-HOLD-TR221-DATA-VALUE                           32710000
327200         MOVE 'INVALID KGRM QTY'              TO                  32720000
327300               PV-HOLD-TR221-ERROR-MSG                            32730000
327400         PERFORM 5540-LOAD-LOGUPC-TO-REPORT                       32740000
327500         MOVE ZEROES TO TR025-LOGUPC-UPC-WT-KGRM-QTY              32750000
327600     ELSE                                                         32760000
327700         MOVE PV-TR015-LOGUPC-WT-KGRM-QTY     TO                  32770000
327800               TR025-LOGUPC-UPC-WT-KGRM-QTY                       32780000
327900     END-IF.                                                      32790000
328000                                                                  32800000
328001     MOVE PV-TR015-LOGUPC-FILE-ID     TO TR025-LOGUPC-FILE-ID.    32800100
328010     MOVE PV-TR015-LOGUPC-ENT-ID      TO TR025-LOGUPC-ENT-ID.     32801000
328100     MOVE PV-TR015-LOGUPC-PROC-SEQ-NBR   TO                       32810000
328200           TR025-LOGUPC-PROCESS-SEQ-NBR.                          32820000
328300     PERFORM 6400-WRITE-UPDATE-RECORD.                            32830000
328400                                                                  32840000
328500******************************************************************32850000
328600* INITIALIZE ERD UPDATE RECORD FIELDS.                           *32860000
328700******************************************************************32870000
328800 5400-INITIAL-ERD-FIELDS-UPD.                                     32880000
328900                                                                  32890000
329000     MOVE ZEROES             TO  TR025-ERD-PO-NBR                 32900000
329100                                 TR025-ERD-ENT-ID.                32910000
329200                                                                  32920000
329300     MOVE SPACES             TO  TR025-ERD-TRN-TYP                32930000
329400                                 TR025-ERD-REC-TYP-CDE            32940000
329500                                 TR025-ERD-SEQ-NBR                32950000
329600                                 TR025-ERD-3RD-PARTY-CDE          32960000
329700                                 TR025-ERD-EXTL-REF-NBR           32970000
329800                                 TR025-ERD-PO-RCVD-DELY-DTE       32980000
329900                                 TR025-ERD-PO-RCVD-DELY-TM        32990000
330000                                 TR025-ERD-ORGN-SHPD-FR-CDE       33000000
330100                                 TR025-ERD-IMPRT-TRIP-ID          33010000
330200                                 TR025-ERD-CARR-SCAC-ID           33020000
330300                                 TR025-ERD-IMPRT-VEH-NM           33030000
330400                                 TR025-ERD-POE-DELY-DTE           33040000
330500                                 TR025-ERD-POE-DELY-TM            33050000
330600                                 TR025-ERD-DPRTR-DTE              33060000
330700                                 TR025-ERD-DPRTR-TM               33070000
330800                                 TR025-ERD-FOB-CDE                33080000
330900                                 TR025-ERD-DEST-POE-CDE           33090000
331000                                 TR025-ERD-EST-LBD-NM             33100000
331100                                 TR025-ERD-TRIP-TYP-CDE           33110000
331200                                 TR025-ERD-FILLER                 33120000
331210                                 TR025-ERD-FILE-ID.               33121000
331300                                                                  33130000
331400******************************************************************33140000
331500* INITIALIZE ERDRSN UPDATE RECORD FIELDS.                        *33150000
331600******************************************************************33160000
331700 5410-INITIAL-ERDRSN-FIELDS-UPD.                                  33170000
331800                                                                  33180000
331900     MOVE ZEROES             TO  TR025-ERDRSN-PO-NBR.             33190000
332000                                                                  33200000
332100     MOVE SPACES             TO  TR025-ERDRSN-TRN-TYP             33210000
332200                                 TR025-ERDRSN-REC-TYP-CDE         33220000
332300                                 TR025-ERDRSN-SEQ-NBR             33230000
332400                                 TR025-ERDRSN-3RD-PARTY-CDE       33240000
332500                                 TR025-ERDRSN-EXTL-REF-NBR        33250000
332600                                 TR025-ERDRSN-PO-RCVD-DELY-DTE    33260000
332700                                 TR025-ERDRSN-PO-RCVD-DELY-TM     33270000
332800                                 TR025-ERDRSN-ORGN-SHPD-FR-CDE    33280000
332900                                 TR025-ERDRSN-IMPRT-TRIP-ID       33290000
333000                                 TR025-ERDRSN-CARR-SCAC-ID        33300000
333100                                 TR025-ERDRSN-POE-DELY-DTE        33310000
333200                                 TR025-ERDRSN-POE-DELY-TM         33320000
333300                                 TR025-ERDRSN-DPRTR-DTE           33330000
333400                                 TR025-ERDRSN-DPRTR-TM            33340000
333500                                 TR025-ERDRSN-VOY-CHG-RSN-DESC    33350000
333600                                 TR025-ERDRSN-FILLER.             33360000
333700                                                                  33370000
333800******************************************************************33380000
333900* INITIALIZE LOG REPORT RECORD FIELDS.                           *33390000
334000******************************************************************33400000
334100 5420-INITIAL-LOG-FIELDS-UPD.                                     33410000
334200                                                                  33420000
334300     MOVE SPACES             TO  TR025-LOG-TRN-TYP                33430000
334400                                 TR025-LOG-REC-TYP-CDE            33440000
334500                                 TR025-LOG-SEQ-NBR                33450000
334600                                 TR025-LOG-3RD-PARTY-CDE          33460000
334700                                 TR025-LOG-EXTL-REF-NBR           33470000
334800                                 TR025-LOG-PO-RCVD-DELY-DTE       33480000
334900                                 TR025-LOG-PO-RCVD-DELY-TM        33490000
335000                                 TR025-LOG-PROD-FCTRY-NM          33500000
335100                                 TR025-LOG-C-O-PROD-CDE           33510000
335200                                 TR025-LOG-ORGN-SHPD-FR-CDE       33520000
335300                                 TR025-LOG-CONSOL-SCAC-ID         33530000
335400                                 TR025-LOG-FILLER.                33540000
335500                                                                  33550000
335600     MOVE ZEROES             TO  TR025-LOG-PO-NBR                 33560000
335700                                 TR025-LOG-PO-CART-CNT            33570000
335800                                 TR025-LOG-PO-UNT-QTY             33580000
335900                                 TR025-LOG-PO-CBMT-QTY            33590000
336000                                 TR025-LOG-PO-WT-KGRM-QTY.        33600000
336100                                                                  33610000
336200******************************************************************33620000
336300* INITIALIZE LOGVS REPORT RECORD FIELDS.                         *33630000
336400******************************************************************33640000
336500 5430-INITIAL-LOGVS-FIELDS-UPD.                                   33650000
336600                                                                  33660000
336700     MOVE SPACES             TO  TR025-LOGVS-TRN-TYP              33670000
336800                                 TR025-LOGVS-REC-TYP-CDE          33680000
336900                                 TR025-LOGVS-SEQ-NBR              33690000
337000                                 TR025-LOGVS-3RD-PARTY-CDE        33700000
337100                                 TR025-LOGVS-EXTL-REF-NBR         33710000
337200                                 TR025-LOGVS-PO-RCVD-DELY-DTE     33720000
337300                                 TR025-LOGVS-PO-RCVD-DELY-TM      33730000
337400                                 TR025-LOGVS-ORGN-SHPD-FR-CDE     33740000
337500                                 TR025-LOGVS-VS-NBR               33750000
337600                                 TR025-LOGVS-FILLER.              33760000
337700                                                                  33770000
337800     MOVE ZEROES             TO  TR025-LOGVS-PO-NBR               33780000
337900                                 TR025-LOGVS-VS-CART-CNT          33790000
338000                                 TR025-LOGVS-VS-UNT-QTY           33800000
338100                                 TR025-LOGVS-VS-CBMT-QTY          33810000
338200                                 TR025-LOGVS-VS-WT-KGRM-QTY.      33820000
338300                                                                  33830000
338400******************************************************************33840000
338500* INITIALIZE LOGUPC REPORT RECORD FIELDS.                        *33850000
338600******************************************************************33860000
338700 5440-INITIAL-LOGUPC-FIELDS-UPD.                                  33870000
338800                                                                  33880000
338900     MOVE SPACES             TO  TR025-LOGUPC-TRN-TYP             33890000
339000                                 TR025-LOGUPC-REC-TYP-CDE         33900000
339100                                 TR025-LOGUPC-SEQ-NBR             33910000
339200                                 TR025-LOGUPC-3RD-PARTY-CDE       33920000
339300                                 TR025-LOGUPC-EXTL-REF-NBR        33930000
339400                                 TR025-LOGUPC-PO-RCVD-DELY-DTE    33940000
339500                                 TR025-LOGUPC-PO-RCVD-DELY-TM     33950000
339600                                 TR025-LOGUPC-ORGN-SHPD-FR-CDE    33960000
339700                                 TR025-LOGUPC-VS-NBR              33970000
339800                                 TR025-LOGUPC-FILLER.             33980000
339900                                                                  33990000
340000     MOVE ZEROES             TO  TR025-LOGUPC-PO-NBR              34000000
340100                                 TR025-LOGUPC-UPC-NBR             34010000
340200                                 TR025-LOGUPC-UPC-CART-CNT        34020000
340300                                 TR025-LOGUPC-UPC-UNT-QTY         34030000
340400                                 TR025-LOGUPC-UPC-CBMT-QTY        34040000
340500                                 TR025-LOGUPC-UPC-WT-KGRM-QTY.    34050000
340600                                                                  34060000
340700******************************************************************34070000
340800* LOAD ERD RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR    *34080000
340900* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *34090000
341000******************************************************************34100000
341100 5500-LOAD-ERD-TO-REPORT.                                         34110000
341200                                                                  34120000
341300     PERFORM 5600-INITIAL-ERD-FIELDS.                             34130000
341400                                                                  34140000
341500     MOVE PV-TR015-ERD-TRN-TYP       TO PV-HOLD-TR221-TRN-TYP.    34150000
341600     MOVE PC-ERD                     TO TR221-REC-TYP-ERD-CDE     34160000
341700                                        PV-HOLD-TR221-REC-TYP.    34170000
341800     MOVE PC-10                      TO TR221-ERD-SEQ-NBR.        34180000
341900     MOVE PV-TR015-ERD-3RD-PARTY-CDE TO TR221-ERD-3RD-PARTY-CDE.  34190000
342000                                                                  34200000
342100     IF PV-TR015-ERD-PO-NBR NUMERIC                               34210000
342200         MOVE PV-TR015-ERD-PO-NBR    TO PV-HOLD-TR221-PO-NBR      34220000
342300     ELSE                                                         34230000
342400         MOVE PV-TR015-ERD-PO-NBR-X  TO PV-HOLD-TR221-PO-NBR-X    34240000
342500     END-IF.                                                      34250000
342600                                                                  34260000
342700     MOVE PV-TR015-ERD-EXTL-REF-NBR    TO                         34270000
342800                                PV-HOLD-TR221-EXTL-REF-NBR.       34280000
342900     MOVE PV-TR015-ERD-PO-RCVD-DELY-DTE TO                        34290000
343000                                PV-HOLD-TR221-PO-RCVD-DELY-DTE.   34300000
343100     MOVE PV-TR015-ERD-PO-RCVD-DELY-TM  TO                        34310000
343200                                PV-HOLD-TR221-PO-RCVD-DELY-TM.    34320000
343300     MOVE PV-TR015-ERD-ORGN-SHPD-FR-CDE TO                        34330000
343400                                PV-HOLD-TR221-ORGN-SHPD-FR-CDE.   34340000
343500                                                                  34350000
343600     MOVE PV-TR015-ERD-IMPRT-TRIP-ID  TO TR221-ERD-IMPRT-TRIP-ID. 34360000
343700     MOVE PV-TR015-ERD-CARR-SCAC-ID   TO TR221-ERD-CARR-SCAC-ID.  34370000
343800     MOVE PV-TR015-ERD-IMPRT-VEH-NM   TO TR221-ERD-IMPRT-VEH-NM.  34380000
343900     MOVE PV-TR015-ERD-POE-DELY-DTE   TO TR221-ERD-POE-DELY-DTE.  34390000
344000     MOVE PV-TR015-ERD-POE-DELY-TM    TO TR221-ERD-POE-DELY-TM.   34400000
344100                                                                  34410000
344200                                                                  34420000
344300     MOVE PV-TR015-ERD-DPRTR-DTE      TO TR221-ERD-DPRTR-DTE.     34430000
344400     MOVE PV-TR015-ERD-DPRTR-TM       TO TR221-ERD-DPRTR-TM.      34440000
344500     MOVE PV-TR015-ERD-FOB-CDE        TO TR221-ERD-FOB-CDE.       34450000
344600     MOVE PV-TR015-ERD-DEST-POE-CDE   TO TR221-ERD-DEST-POE-CDE.  34460000
344700     MOVE PV-TR015-ERD-EST-LBD-NM     TO TR221-ERD-EST-LBD-NM.    34470000
344800     MOVE PV-TR015-ERD-TRIP-TYP-CDE   TO TR221-ERD-TRIP-TYP-CDE.  34480000
344810     MOVE PV-TR015-ERD-ENT-ID         TO TR221-DAT-SRC-ENT-ID.    34481000
344900     MOVE PV-TR015-ERD-PROC-SEQ-NBR   TO TR221-PROCESS-SEQ-NBR.   34490000
345000                                                                  34500000
345100     PERFORM 6200-WRITE-LOAD-REPORT.                              34510000
345200                                                                  34520000
345300******************************************************************34530000
345400* LOAD ERDRSN RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR *34540000
345500* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *34550000
345600******************************************************************34560000
345700 5510-LOAD-ERDRSN-TO-REPORT.                                      34570000
345800                                                                  34580000
345900     PERFORM 5610-INITIAL-ERDRSN-FIELDS.                          34590000
346000                                                                  34600000
346100     MOVE PV-TR015-ERDRSN-TRN-TYP    TO PV-HOLD-TR221-TRN-TYP.    34610000
346200     MOVE PC-ERDRSN                  TO TR221-REC-TYP-ERDRSN-CDE  34620000
346300                                        PV-HOLD-TR221-REC-TYP.    34630000
346400     MOVE PC-11                      TO TR221-ERDRSN-SEQ-NBR.     34640000
346500     MOVE PV-TR015-ERDRSN-3RD-PARTY-CDE TO                        34650000
346600                                   TR221-ERDRSN-3RD-PARTY-CDE.    34660000
346700                                                                  34670000
346800     IF PV-TR015-ERDRSN-PO-NBR NUMERIC                            34680000
346900         MOVE PV-TR015-ERDRSN-PO-NBR  TO PV-HOLD-TR221-PO-NBR     34690000
347000     ELSE                                                         34700000
347100         MOVE PV-TR015-ERDRSN-PO-NBR-X TO PV-HOLD-TR221-PO-NBR-X  34710000
347200     END-IF.                                                      34720000
347300                                                                  34730000
347400     MOVE PV-TR015-ERDRSN-EXTL-REF-NBR    TO                      34740000
347500                                PV-HOLD-TR221-EXTL-REF-NBR.       34750000
347600     MOVE PV-TR015-ERDRSN-PO-RCV-DELY-DT  TO                      34760000
347700                                PV-HOLD-TR221-PO-RCVD-DELY-DTE.   34770000
347800     MOVE PV-TR015-ERDRSN-PO-RCV-DELY-TM  TO                      34780000
347900                                PV-HOLD-TR221-PO-RCVD-DELY-TM.    34790000
348000     MOVE PV-TR015-ERDRSN-ORG-SHP-FR-CDE TO                       34800000
348100                                PV-HOLD-TR221-ORGN-SHPD-FR-CDE.   34810000
348200                                                                  34820000
348300     MOVE PV-TR015-ERDRSN-IMPRT-TRIP-ID   TO                      34830000
348400                                TR221-ERDRSN-IMPRT-TRIP-ID.       34840000
348500     MOVE PV-TR015-ERDRSN-CARR-SCAC-ID    TO                      34850000
348600                                TR221-ERDRSN-CARR-SCAC-ID.        34860000
348700     MOVE PV-TR015-ERDRSN-POE-DELY-DTE    TO                      34870000
348800                                TR221-ERDRSN-POE-DELY-DTE.        34880000
348900     MOVE PV-TR015-ERDRSN-POE-DELY-TM     TO                      34890000
349000                                TR221-ERDRSN-POE-DELY-TM.         34900000
349100     MOVE PV-TR015-ERDRSN-DPRTR-DTE       TO                      34910000
349200                                TR221-ERDRSN-DPRTR-DTE.           34920000
349300     MOVE PV-TR015-ERDRSN-DPRTR-TM        TO                      34930000
349400                                TR221-ERDRSN-DPRTR-TM.            34940000
349500     MOVE PV-TR015-ERDRSN-VOY-CHG-RSN-DS  TO                      34950000
349600                                TR221-ERDRSN-VOY-CHG-RSN-DESC.    34960000
349610     MOVE PV-TR015-ERDRSN-ENT-ID      TO TR221-DAT-SRC-ENT-ID.    34961000
349700     MOVE PV-TR015-ERDRSN-PROC-SEQ-NBR  TO TR221-PROCESS-SEQ-NBR. 34970000
349800                                                                  34980000
349900     PERFORM 6200-WRITE-LOAD-REPORT.                              34990000
350000                                                                  35000000
350100******************************************************************35010000
350200* LOAD LOG RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR    *35020000
350300* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *35030000
350400******************************************************************35040000
350500 5520-LOAD-LOG-TO-REPORT.                                         35050000
350600                                                                  35060000
350700     PERFORM 5620-INITIAL-LOG-FIELDS.                             35070000
350800                                                                  35080000
350900     MOVE PV-TR015-LOG-TRN-TYP       TO PV-HOLD-TR221-TRN-TYP.    35090000
351000     MOVE PC-LOG                     TO TR221-REC-TYP-LOG-CDE     35100000
351100                                        PV-HOLD-TR221-REC-TYP.    35110000
351200     MOVE PC-20                      TO TR221-LOG-SEQ-NBR.        35120000
351300     MOVE PV-TR015-LOG-3RD-PARTY-CDE TO TR221-LOG-3RD-PARTY-CDE.  35130000
351400                                                                  35140000
351500     IF PV-TR015-LOG-PO-NBR NUMERIC                               35150000
351600         MOVE PV-TR015-LOG-PO-NBR      TO PV-HOLD-TR221-PO-NBR    35160000
351700     ELSE                                                         35170000
351800         MOVE PV-TR015-LOG-PO-NBR-X    TO PV-HOLD-TR221-PO-NBR-X  35180000
351900     END-IF.                                                      35190000
352000                                                                  35200000
352100     MOVE PV-TR015-LOG-EXTL-REF-NBR    TO                         35210000
352200                                PV-HOLD-TR221-EXTL-REF-NBR.       35220000
352300     MOVE PV-TR015-LOG-PO-RCVD-DELY-DTE TO                        35230000
352400                                PV-HOLD-TR221-PO-RCVD-DELY-DTE.   35240000
352500     MOVE PV-TR015-LOG-PO-RCVD-DELY-TM  TO                        35250000
352600                                PV-HOLD-TR221-PO-RCVD-DELY-TM.    35260000
352700     MOVE PV-TR015-LOG-ORGN-SHPD-FR-CDE TO                        35270000
352800                                PV-HOLD-TR221-ORGN-SHPD-FR-CDE.   35280000
352900                                                                  35290000
353000     MOVE PV-TR015-LOG-C-O-PROD-CDE   TO TR221-LOG-C-O-PROD-CDE.  35300000
353100     MOVE PV-TR015-LOG-PROD-FCTRY-NM  TO TR221-LOG-PROD-FCTRY-NM. 35310000
353200                                                                  35320000
353300     IF PV-TR015-LOG-PO-CART-CNT NUMERIC                          35330000
353400         MOVE PV-TR015-LOG-PO-CART-CNT TO TR221-LOG-PO-CART-CNT   35340000
353500     ELSE                                                         35350000
353600         MOVE PV-TR015-LOG-PO-CART-CNT TO TR221-LOG-PO-CART-CNT-X 35360000
353700     END-IF.                                                      35370000
353800                                                                  35380000
353900     IF PV-TR015-LOG-PO-UNT-QTY NUMERIC                           35390000
354000         MOVE PV-TR015-LOG-PO-UNT-QTY TO TR221-LOG-PO-UNT-QTY     35400000
354100     ELSE                                                         35410000
354200         MOVE PV-TR015-LOG-PO-UNT-QTY-X TO TR221-LOG-PO-UNT-QTY-X 35420000
354300     END-IF.                                                      35430000
354400                                                                  35440000
354500     IF PV-TR015-LOG-PO-CBMT-QTY NUMERIC                          35450000
354600         MOVE PV-TR015-LOG-PO-CBMT-QTY TO TR221-LOG-PO-CBMT-QTY   35460000
354700     ELSE                                                         35470000
354800         MOVE PV-TR015-LOG-PO-CBMT-QTY-X TO                       35480000
354900                                   TR221-LOG-PO-CBMT-QTY-X        35490000
355000     END-IF.                                                      35500000
355100                                                                  35510000
355200     IF PV-TR015-LOG-PO-WT-KGRM-QTY NUMERIC                       35520000
355300         MOVE PV-TR015-LOG-PO-WT-KGRM-QTY        TO               35530000
355400                                      TR221-LOG-PO-WT-KGRM-QTY    35540000
355500     ELSE                                                         35550000
355600         MOVE PV-TR015-LOG-PO-WT-KGRM-QTY-X      TO               35560000
355700                                      TR221-LOG-PO-WT-KGRM-QTY-X  35570000
355800     END-IF.                                                      35580000
355900                                                                  35590000
356000     MOVE PV-TR015-LOG-CONSOL-SCAC-ID TO TR221-LOG-CONSOL-SCAC-ID.35600000
356010     MOVE PV-TR015-LOG-ENT-ID         TO TR221-DAT-SRC-ENT-ID.    35601000
356100     MOVE PV-TR015-LOG-PROC-SEQ-NBR   TO TR221-PROCESS-SEQ-NBR.   35610000
356200                                                                  35620000
356300     PERFORM 6200-WRITE-LOAD-REPORT.                              35630000
356400                                                                  35640000
356500******************************************************************35650000
356600* LOAD LOGVS RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR  *35660000
356700* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *35670000
356800******************************************************************35680000
356900 5530-LOAD-LOGVS-TO-REPORT.                                       35690000
357000                                                                  35700000
357100     PERFORM 5630-INITIAL-LOGVS-FIELDS.                           35710000
357200                                                                  35720000
357300     MOVE PV-TR015-LOGVS-TRN-TYP     TO PV-HOLD-TR221-TRN-TYP.    35730000
357400     MOVE PC-LOGVS                   TO TR221-REC-TYP-LOGVS-CDE   35740000
357500                                        PV-HOLD-TR221-REC-TYP.    35750000
357600     MOVE PC-21                      TO TR221-LOGVS-SEQ-NBR.      35760000
357700     MOVE PV-TR015-LOGVS-3RD-PARTY-CDE   TO                       35770000
357800                                TR221-LOGVS-3RD-PARTY-CDE.        35780000
357900                                                                  35790000
358000     IF PV-TR015-LOGVS-PO-NBR NUMERIC                             35800000
358100         MOVE PV-TR015-LOGVS-PO-NBR    TO PV-HOLD-TR221-PO-NBR    35810000
358200     ELSE                                                         35820000
358300         MOVE PV-TR015-LOGVS-PO-NBR-X  TO PV-HOLD-TR221-PO-NBR-X  35830000
358400     END-IF.                                                      35840000
358500                                                                  35850000
358600     MOVE PV-TR015-LOGVS-EXTL-REF-NBR    TO                       35860000
358700                                PV-HOLD-TR221-EXTL-REF-NBR.       35870000
358800     MOVE PV-TR015-LOGVS-PO-RCV-DELY-DTE TO                       35880000
358900                                PV-HOLD-TR221-PO-RCVD-DELY-DTE.   35890000
359000     MOVE PV-TR015-LOGVS-PO-RCV-DELY-TM  TO                       35900000
359100                                PV-HOLD-TR221-PO-RCVD-DELY-TM.    35910000
359200     MOVE PV-TR015-LOGVS-ORG-SHP-FR-CDE TO                        35920000
359300                                PV-HOLD-TR221-ORGN-SHPD-FR-CDE.   35930000
359400                                                                  35940000
359500     MOVE PV-TR015-LOGVS-VS-NBR          TO TR221-LOGVS-VS-NBR.   35950000
359600                                                                  35960000
359700     IF PV-TR015-LOGVS-CART-CNT NUMERIC                           35970000
359800         MOVE PV-TR015-LOGVS-CART-CNT    TO                       35980000
359900                                    TR221-LOGVS-VS-CART-CNT       35990000
360000     ELSE                                                         36000000
360100         MOVE PV-TR015-LOGVS-CART-CNT-X  TO                       36010000
360200                                    TR221-LOGVS-VS-CART-CNT-X     36020000
360300     END-IF.                                                      36030000
360400                                                                  36040000
360500     IF PV-TR015-LOGVS-UNT-QTY NUMERIC                            36050000
360600         MOVE PV-TR015-LOGVS-UNT-QTY      TO                      36060000
360700                                    TR221-LOGVS-VS-UNT-QTY        36070000
360800     ELSE                                                         36080000
360900         MOVE PV-TR015-LOGVS-UNT-QTY-X    TO                      36090000
361000                                    TR221-LOGVS-VS-UNT-QTY-X      36100000
361100     END-IF.                                                      36110000
361200                                                                  36120000
361300     IF PV-TR015-LOGVS-CBMT-QTY NUMERIC                           36130000
361400         MOVE PV-TR015-LOGVS-CBMT-QTY     TO                      36140000
361500                                    TR221-LOGVS-VS-CBMT-QTY       36150000
361600     ELSE                                                         36160000
361700         MOVE PV-TR015-LOGVS-CBMT-QTY-X   TO                      36170000
361800                                    TR221-LOGVS-VS-CBMT-QTY-X     36180000
361900     END-IF.                                                      36190000
362000                                                                  36200000
362100     IF PV-TR015-LOGVS-WT-KGRM-QTY NUMERIC                        36210000
362200         MOVE PV-TR015-LOGVS-WT-KGRM-QTY     TO                   36220000
362300                                   TR221-LOGVS-VS-WT-KGRM-QTY     36230000
362400     ELSE                                                         36240000
362500         MOVE PV-TR015-LOGVS-WT-KGRM-QTY-X   TO                   36250000
362600                                   TR221-LOGVS-VS-WT-KGRM-QTY-X   36260000
362700     END-IF.                                                      36270000
362800                                                                  36280000
362810     MOVE PV-TR015-LOGVS-ENT-ID       TO TR221-DAT-SRC-ENT-ID.    36281000
362900     MOVE PV-TR015-LOGVS-PROC-SEQ-NBR TO                          36290000
363000                                TR221-PROCESS-SEQ-NBR.            36300000
363100                                                                  36310000
363200     PERFORM 6200-WRITE-LOAD-REPORT.                              36320000
363300                                                                  36330000
363400******************************************************************36340000
363500* LOAD LOGUPC RECORD INFORMATION FROM WORKING STORAGE FIELDS FOR *36350000
363600* ERROR RECORD AND WRITE RECORD TO THE ERROR FILE.               *36360000
363700******************************************************************36370000
363800 5540-LOAD-LOGUPC-TO-REPORT.                                      36380000
363900                                                                  36390000
364000     PERFORM 5640-INITIAL-LOGUPC-FIELDS.                          36400000
364100                                                                  36410000
364200     MOVE PV-TR015-LOGUPC-TRN-TYP    TO PV-HOLD-TR221-TRN-TYP.    36420000
364300     MOVE PC-LOGUPC                  TO TR221-REC-TYP-LOGUPC-CDE  36430000
364400                                        PV-HOLD-TR221-REC-TYP.    36440000
364500     MOVE PC-22                      TO TR221-LOGUPC-SEQ-NBR.     36450000
364600     MOVE PV-TR015-LOGUPC-3RD-PARTY-CDE TO                        36460000
364700                                TR221-LOGUPC-3RD-PARTY-CDE.       36470000
364800                                                                  36480000
364900     IF PV-TR015-LOGUPC-PO-NBR NUMERIC                            36490000
365000         MOVE PV-TR015-LOGUPC-PO-NBR   TO PV-HOLD-TR221-PO-NBR    36500000
365100     ELSE                                                         36510000
365200         MOVE PV-TR015-LOGUPC-PO-NBR-X TO PV-HOLD-TR221-PO-NBR-X  36520000
365300     END-IF.                                                      36530000
365400                                                                  36540000
365500     MOVE PV-TR015-LOGUPC-EXTL-REF-NBR    TO                      36550000
365600                                PV-HOLD-TR221-EXTL-REF-NBR.       36560000
365700     MOVE PV-TR015-LOGUPC-PO-RCV-DELY-DT  TO                      36570000
365800                                PV-HOLD-TR221-PO-RCVD-DELY-DTE.   36580000
365900     MOVE PV-TR015-LOGUPC-PO-RCV-DELY-TM  TO                      36590000
366000                                PV-HOLD-TR221-PO-RCVD-DELY-TM.    36600000
366100     MOVE PV-TR015-LOGUPC-ORG-SHP-FR-CDE TO                       36610000
366200                                PV-HOLD-TR221-ORGN-SHPD-FR-CDE.   36620000
366300                                                                  36630000
366400     MOVE PV-TR015-LOGUPC-VS-NBR       TO TR221-LOGUPC-VS-NBR.    36640000
366500                                                                  36650000
366600     IF PV-TR015-LOGUPC-UPC-NBR NUMERIC                           36660000
366700         MOVE PV-TR015-LOGUPC-UPC-NBR   TO TR221-LOGUPC-UPC-NBR   36670000
366800     ELSE                                                         36680000
366900         MOVE PV-TR015-LOGUPC-UPC-NBR-X TO TR221-LOGUPC-UPC-NBR-X 36690000
367000     END-IF.                                                      36700000
367100                                                                  36710000
367200     IF PV-TR015-LOGUPC-CART-CNT NUMERIC                          36720000
367300         MOVE PV-TR015-LOGUPC-CART-CNT     TO                     36730000
367400                                   TR221-LOGUPC-UPC-CART-CNT      36740000
367500     ELSE                                                         36750000
367600         MOVE PV-TR015-LOGUPC-CART-CNT-X   TO                     36760000
367700                                   TR221-LOGUPC-UPC-CART-CNT-X    36770000
367800     END-IF.                                                      36780000
367900                                                                  36790000
368000     IF PV-TR015-LOGUPC-UNT-QTY NUMERIC                           36800000
368100         MOVE PV-TR015-LOGUPC-UNT-QTY     TO                      36810000
368200                                   TR221-LOGUPC-UPC-UNT-QTY       36820000
368300     ELSE                                                         36830000
368400         MOVE PV-TR015-LOGUPC-UNT-QTY-X   TO                      36840000
368500                                   TR221-LOGUPC-UPC-UNT-QTY-X     36850000
368600     END-IF.                                                      36860000
368700                                                                  36870000
368800     IF PV-TR015-LOGUPC-CBMT-QTY NUMERIC                          36880000
368900         MOVE PV-TR015-LOGUPC-CBMT-QTY   TO                       36890000
369000                                   TR221-LOGUPC-UPC-CBMT-QTY      36900000
369100     ELSE                                                         36910000
369200         MOVE PV-TR015-LOGUPC-CBMT-QTY-X TO                       36920000
369300                                   TR221-LOGUPC-UPC-CBMT-QTY-X    36930000
369400     END-IF.                                                      36940000
369500                                                                  36950000
369600     IF PV-TR015-LOGUPC-WT-KGRM-QTY NUMERIC                       36960000
369700         MOVE PV-TR015-LOGUPC-WT-KGRM-QTY     TO                  36970000
369800                                   TR221-LOGUPC-UPC-WT-KGRM-QTY   36980000
369900     ELSE                                                         36990000
370000         MOVE PV-TR015-LOGUPC-WT-KGRM-QTY-X   TO                  37000000
370100                                   TR221-LOGUPC-UPC-WT-KGRM-QTY-X 37010000
370200     END-IF.                                                      37020000
370300                                                                  37030000
370310     MOVE PV-TR015-LOGUPC-ENT-ID      TO TR221-DAT-SRC-ENT-ID.    37031000
370400     MOVE PV-TR015-LOGUPC-PROC-SEQ-NBR TO                         37040000
370500                                   TR221-PROCESS-SEQ-NBR.         37050000
370600                                                                  37060000
370700     PERFORM 6200-WRITE-LOAD-REPORT.                              37070000
370800                                                                  37080000
370900******************************************************************37090000
371000* INITIALIZE ERD REPORT RECORD FIELDS.                           *37100000
371100******************************************************************37110000
371200 5600-INITIAL-ERD-FIELDS.                                         37120000
371300                                                                  37130000
371400     MOVE SPACES             TO  TR221-REC-TYP-ERD-CDE            37140000
371500                                 TR221-ERD-SEQ-NBR                37150000
371600                                 TR221-ERD-3RD-PARTY-CDE          37160000
371700                                 TR221-ERD-IMPRT-TRIP-ID          37170000
371800                                 TR221-ERD-CARR-SCAC-ID           37180000
371900                                 TR221-ERD-IMPRT-VEH-NM           37190000
372000                                 TR221-ERD-POE-DELY-DTE           37200000
372100                                 TR221-ERD-POE-DELY-TM            37210000
372200                                 TR221-ERD-DPRTR-DTE              37220000
372300                                 TR221-ERD-DPRTR-TM               37230000
372400                                 TR221-ERD-FOB-CDE                37240000
372500                                 TR221-ERD-DEST-POE-CDE           37250000
372600                                 TR221-ERD-EST-LBD-NM             37260000
372700                                 TR221-ERD-TRIP-TYP-CDE           37270000
372800                                 TR221-ERD-FILLER.                37280000
372900                                                                  37290000
373000******************************************************************37300000
373100* INITIALIZE ERDRSN REPORT RECORD FIELDS.                        *37310000
373200******************************************************************37320000
373300 5610-INITIAL-ERDRSN-FIELDS.                                      37330000
373400                                                                  37340000
373500     MOVE SPACES             TO  TR221-REC-TYP-ERDRSN-CDE         37350000
373600                                 TR221-ERDRSN-SEQ-NBR             37360000
373700                                 TR221-ERDRSN-3RD-PARTY-CDE       37370000
373800                                 TR221-ERDRSN-IMPRT-TRIP-ID       37380000
373900                                 TR221-ERDRSN-CARR-SCAC-ID        37390000
374000                                 TR221-ERDRSN-POE-DELY-DTE        37400000
374100                                 TR221-ERDRSN-POE-DELY-TM         37410000
374200                                 TR221-ERDRSN-DPRTR-DTE           37420000
374300                                 TR221-ERDRSN-DPRTR-TM            37430000
374400                                 TR221-ERDRSN-VOY-CHG-RSN-DESC    37440000
374500                                 TR221-ERDRSN-FILLER.             37450000
374600                                                                  37460000
374700******************************************************************37470000
374800* INITIALIZE LOG REPORT RECORD FIELDS.                           *37480000
374900******************************************************************37490000
375000 5620-INITIAL-LOG-FIELDS.                                         37500000
375100                                                                  37510000
375200     MOVE SPACES             TO  TR221-REC-TYP-LOG-CDE            37520000
375300                                 TR221-LOG-SEQ-NBR                37530000
375400                                 TR221-LOG-3RD-PARTY-CDE          37540000
375500                                 TR221-LOG-PROD-FCTRY-NM          37550000
375600                                 TR221-LOG-C-O-PROD-CDE           37560000
375700                                 TR221-LOG-CONSOL-SCAC-ID         37570000
375800                                 TR221-LOG-FILLER.                37580000
375900                                                                  37590000
376000     MOVE ZEROES             TO  TR221-LOG-PO-CART-CNT            37600000
376100                                 TR221-LOG-PO-UNT-QTY             37610000
376200                                 TR221-LOG-PO-CBMT-QTY            37620000
376300                                 TR221-LOG-PO-WT-KGRM-QTY.        37630000
376400                                                                  37640000
376500******************************************************************37650000
376600* INITIALIZE LOGVS REPORT RECORD FIELDS.                         *37660000
376700******************************************************************37670000
376800 5630-INITIAL-LOGVS-FIELDS.                                       37680000
376900                                                                  37690000
377000     MOVE SPACES             TO  TR221-REC-TYP-LOGVS-CDE          37700000
377100                                 TR221-LOGVS-SEQ-NBR              37710000
377200                                 TR221-LOGVS-3RD-PARTY-CDE        37720000
377300                                 TR221-LOGVS-VS-NBR               37730000
377400                                 TR221-LOGVS-FILLER.              37740000
377500                                                                  37750000
377600     MOVE ZEROES             TO  TR221-LOGVS-VS-CART-CNT          37760000
377700                                 TR221-LOGVS-VS-UNT-QTY           37770000
377800                                 TR221-LOGVS-VS-CBMT-QTY          37780000
377900                                 TR221-LOGVS-VS-WT-KGRM-QTY.      37790000
378000                                                                  37800000
378100******************************************************************37810000
378200* INITIALIZE LOGUPC REPORT RECORD FIELDS.                        *37820000
378300******************************************************************37830000
378400 5640-INITIAL-LOGUPC-FIELDS.                                      37840000
378500                                                                  37850000
378600     MOVE SPACES             TO  TR221-REC-TYP-LOGUPC-CDE         37860000
378700                                 TR221-LOGUPC-SEQ-NBR             37870000
378800                                 TR221-LOGUPC-3RD-PARTY-CDE       37880000
378900                                 TR221-LOGUPC-VS-NBR              37890000
379000                                 TR221-LOGUPC-FILLER.             37900000
379100                                                                  37910000
379200     MOVE ZEROES             TO  TR221-LOGUPC-UPC-CART-CNT        37920000
379300                                 TR221-LOGUPC-UPC-NBR             37930000
379400                                 TR221-LOGUPC-UPC-UNT-QTY         37940000
379500                                 TR221-LOGUPC-UPC-CBMT-QTY        37950000
379600                                 TR221-LOGUPC-UPC-WT-KGRM-QTY.    37960000
379700                                                                  37970000
379800******************************************************************37980000
379900* INITIALIZE ERROR RECORD KEY FIELDS.                            *37990000
380000******************************************************************38000000
380100 5650-INITIAL-ERROR-KEY-FIELDS.                                   38010000
380200                                                                  38020000
380300     MOVE SPACES             TO  TR221-RPT-TYP                    38030000
380400                                 TR221-PO-NBR-X                   38040000
380500                                 TR221-TRN-TYP                    38050000
380600                                 TR221-EXTL-REF-NBR               38060000
380700                                 TR221-PO-RCVD-DELY-DTE           38070000
380800                                 TR221-PO-RCVD-DELY-TM            38080000
380900                                 TR221-ORGN-SHPD-FR-CDE           38090000
381000                                 TR221-DATA-IN-ERROR              38100000
381100                                 TR221-DATA-VALUE                 38110000
381200                                 TR221-ERROR-TYPE                 38120000
381300                                 TR221-ERROR-MSG.                 38130000
381400                                                                  38140000
381500     MOVE ZEROES             TO  TR221-PROCESS-SEQ-NBR.           38150000
381600                                                                  38160000
381700******************************************************************38170000
381800* INITIALIZE HEADER REPORT RECORD FIELDS.                        *38180000
381900******************************************************************38190000
382000 5660-INITIAL-HDR-FIELDS.                                         38200000
382100                                                                  38210000
382200     MOVE SPACES             TO  TR221-REC-TYP-HDR-CDE            38220000
382300                                 TR221-HDR-SEQ-NBR                38230000
382400                                 TR221-HDR-3RD-PARTY-CDE          38240000
382500                                 TR221-HDR-CONSOL-ENTNME          38250000
382600                                 TR221-HDR-CONSOL-TRNS-DTE        38260000
382700                                 TR221-HDR-CONSOL-TRNS-TM         38270000
382800                                 TR221-HDR-CONSOL-FIL-ID          38280000
382900                                 TR221-HDR-LOAD-DTE               38290000
383000                                 TR221-HDR-LOAD-TM                38300000
383100                                 TR221-HDR-FILLER.                38310000
383200                                                                  38320000
383300******************************************************************38330000
383400* FORMAT THE ACTUAL DEPARTURE TIMESTAMP.                         *38340000
383500******************************************************************38350000
383600 5700-FORMAT-DPRTR-TMST.                                          38360000
383700                                                                  38370000
383800     MOVE PV-HOLD-DPRTR-DTE (1:4)  TO  PV-FORMAT-TMST-DTE-CY.     38380000
383900     MOVE PV-HOLD-DPRTR-DTE (5:2)  TO  PV-FORMAT-TMST-DTE-MM.     38390000
384000     MOVE PV-HOLD-DPRTR-DTE (7:2)  TO  PV-FORMAT-TMST-DTE-DD.     38400000
384100                                                                  38410000
384501     IF PV-HOLD-DPRTR-TM EQUAL SPACES                             38450101
384502         MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH                38450201
384503                              PV-FORMAT-TMST-TM-MM                38450301
384504         PERFORM 6500-CALENDAR-ROUTINE-SETUP                      38450401
384505     ELSE                                                         38450501
384506         IF PV-HOLD-DPRTR-TM (1:1) = SPACES OR                    38450601
384507            PV-HOLD-DPRTR-TM (2:1) = SPACES OR                    38450701
384508            PV-HOLD-DPRTR-TM (3:1) = SPACES OR                    38450801
384509            PV-HOLD-DPRTR-TM (4:1) = SPACES                       38450901
384510             SET PS-WARNING-TIME TO TRUE                          38451003
384511             MOVE ZEROS TO PV-FORMAT-TMST-TM-HH                   38451101
384512                           PV-FORMAT-TMST-TM-MM                   38451201
384513             PERFORM 6500-CALENDAR-ROUTINE-SETUP                  38451301
384514         ELSE                                                     38451401
384515             IF ((PV-HOLD-DPRTR-TM (1:2) > '0' AND                38451501
384516                  PV-HOLD-DPRTR-TM (1:2) < '24')     AND          38451601
384517                 (PV-HOLD-DPRTR-TM (3:2) > '0' AND                38451701
384518                  PV-HOLD-DPRTR-TM (3:2) < '60'))                 38451801
384519                   MOVE PV-HOLD-DPRTR-TM (1:2)   TO               38451901
384520                        PV-FORMAT-TMST-TM-HH                      38452001
384521                   MOVE PV-HOLD-DPRTR-TM (3:2)   TO               38452101
384522                        PV-FORMAT-TMST-TM-MM                      38452201
384523                   PERFORM 6500-CALENDAR-ROUTINE-SETUP            38452301
384524             ELSE                                                 38452401
384525                 SET PS-WARNING-TIME TO TRUE                      38452501
384526                 MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH        38452601
384527                                      PV-FORMAT-TMST-TM-MM        38452701
384528                 PERFORM 6500-CALENDAR-ROUTINE-SETUP              38452801
384529             END-IF                                               38452901
384530         END-IF                                                   38453001
384540     END-IF.                                                      38454001
386400                                                                  38640000
386500******************************************************************38650000
386600* FORMAT THE ESTIMATED ARRIVAL TIMESTAMP.                        *38660000
386700******************************************************************38670000
386800*5705-FORMAT-POE-DELY-TMST.                                       38680000
386900*                                                                 38690000
387000*    MOVE PV-HOLD-POE-DELY-DTE (1:4) TO PV-FORMAT-TMST-DTE-CY.    38700000
387100*    MOVE PV-HOLD-POE-DELY-DTE (5:2) TO PV-FORMAT-TMST-DTE-MM.    38710000
387200*    MOVE PV-HOLD-POE-DELY-DTE (7:2) TO PV-FORMAT-TMST-DTE-DD.    38720000
387300*                                                                 38730000
387701*    IF PV-HOLD-POE-DELY-TM EQUAL SPACES                          38770101
387702*        MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH                38770201
387703*                             PV-FORMAT-TMST-TM-MM                38770301
387704*        PERFORM 6500-CALENDAR-ROUTINE-SETUP                      38770401
387705*    ELSE                                                         38770501
387706*        IF PV-HOLD-POE-DELY-TM (1:1) = SPACES OR                 38770601
387707*           PV-HOLD-POE-DELY-TM (2:1) = SPACES OR                 38770701
387708*           PV-HOLD-POE-DELY-TM (3:1) = SPACES OR                 38770801
387709*           PV-HOLD-POE-DELY-TM (4:1) = SPACES                    38770901
387710*            SET PS-WARNING-TIME TO TRUE                          38771003
387711*            MOVE ZEROS TO PV-FORMAT-TMST-TM-HH                   38771101
387712*                          PV-FORMAT-TMST-TM-MM                   38771201
387713*            PERFORM 6500-CALENDAR-ROUTINE-SETUP                  38771301
387714*        ELSE                                                     38771401
387715*            IF ((PV-HOLD-POE-DELY-TM (1:2) > '0' AND             38771501
387716*                 PV-HOLD-POE-DELY-TM (1:2) < '24')     AND       38771601
387717*                (PV-HOLD-POE-DELY-TM (3:2) > '0' AND             38771701
387718*                 PV-HOLD-POE-DELY-TM (3:2) < '60'))              38771801
387719*                  MOVE PV-HOLD-POE-DELY-TM (1:2)   TO            38771901
387720*                       PV-FORMAT-TMST-TM-HH                      38772001
387721*                  MOVE PV-HOLD-POE-DELY-TM (3:2)   TO            38772101
387722*                       PV-FORMAT-TMST-TM-MM                      38772201
387723*                  PERFORM 6500-CALENDAR-ROUTINE-SETUP            38772301
387724*            ELSE                                                 38772401
387725*                SET PS-WARNING-TIME TO TRUE                      38772501
387726*                MOVE ZEROS TO        PV-FORMAT-TMST-TM-HH        38772601
387727*                                     PV-FORMAT-TMST-TM-MM        38772701
387728*                PERFORM 6500-CALENDAR-ROUTINE-SETUP              38772801
387729*            END-IF                                               38772901
387730*        END-IF                                                   38773001
387740*    END-IF.                                                      38774001
389600*                                                                 38960000
389700******************************************************************38970000
389800* FORMAT THE PO RECEIVED DELIVERY TIMESTAMP.                     *38980000
389900******************************************************************38990000
390000 5715-FORMAT-RCVD-DELY-TMST.                                      39000000
390100                                                                  39010000
390200     MOVE PV-RCVD-DELY-DTE (1:4)  TO                              39020000
390300                 PV-FORMAT-RCDT-DTE-CY.                           39030000
390400     MOVE PV-RCVD-DELY-DTE (5:2)  TO                              39040000
390500                 PV-FORMAT-RCDT-DTE-MM.                           39050000
390600     MOVE PV-RCVD-DELY-DTE (7:2)  TO                              39060000
390700                 PV-FORMAT-RCDT-DTE-DD.                           39070000
390800                                                                  39080000
391210     IF PV-RCVD-DELY-TM EQUAL SPACES                              39121001
391220         MOVE ZEROS TO        PV-FORMAT-RCDT-TM-HH                39122001
391230                              PV-FORMAT-RCDT-TM-MM                39123001
391240         PERFORM 6505-CALENDAR-ROUTINE-SETUP                      39124002
391250     ELSE                                                         39125001
391260         IF PV-RCVD-DELY-TM (1:1) = SPACES OR                     39126001
391270            PV-RCVD-DELY-TM (2:1) = SPACES OR                     39127001
391280            PV-RCVD-DELY-TM (3:1) = SPACES OR                     39128001
391290            PV-RCVD-DELY-TM (4:1) = SPACES                        39129001
391291             SET PS-WARNING-TIME TO TRUE                          39129103
391292             MOVE ZEROS TO PV-FORMAT-RCDT-TM-HH                   39129201
391293                           PV-FORMAT-RCDT-TM-MM                   39129301
391294             PERFORM 6505-CALENDAR-ROUTINE-SETUP                  39129402
391295         ELSE                                                     39129501
391296             IF ((PV-RCVD-DELY-TM (1:2) > '0' AND                 39129601
391297                  PV-RCVD-DELY-TM (1:2) < '24')     AND           39129701
391298                 (PV-RCVD-DELY-TM (3:2) > '0' AND                 39129801
391299                  PV-RCVD-DELY-TM (3:2) < '60'))                  39129901
391300                   MOVE PV-RCVD-DELY-TM (1:2)   TO                39130001
391301                        PV-FORMAT-RCDT-TM-HH                      39130101
391302                   MOVE PV-RCVD-DELY-TM (3:2)   TO                39130201
391303                        PV-FORMAT-RCDT-TM-MM                      39130301
391304                   PERFORM 6505-CALENDAR-ROUTINE-SETUP            39130402
391305             ELSE                                                 39130501
391306                 SET PS-WARNING-TIME TO TRUE                      39130601
391307                 MOVE ZEROS TO        PV-FORMAT-RCDT-TM-HH        39130701
391308                                      PV-FORMAT-RCDT-TM-MM        39130801
391309                 PERFORM 6505-CALENDAR-ROUTINE-SETUP              39130902
391310             END-IF                                               39131001
391311         END-IF                                                   39131101
391312     END-IF.                                                      39131201
391313                                                                  39131301
393200******************************************************************39320000
393300* REFORMAT CURRENT TIMESTAMP.                                    *39330000
393400******************************************************************39340000
393500 5730-REFORMAT-CURRENT-TMST.                                      39350000
393600                                                                  39360000
393700     MOVE PV-CURRENT-TMST (1:4) TO                                39370000
393800                      PV-REFORMAT-TMST-DTE-CY.                    39380000
393900     MOVE PV-CURRENT-TMST (6:2) TO                                39390000
394000                      PV-REFORMAT-TMST-DTE-MM.                    39400000
394100     MOVE PV-CURRENT-TMST (9:2) TO                                39410000
394200                      PV-REFORMAT-TMST-DTE-DD.                    39420000
394300     MOVE PV-CURRENT-TMST (12:2) TO                               39430000
394400                      PV-REFORMAT-TMST-TM-HH.                     39440000
394500     MOVE PV-CURRENT-TMST (15:2) TO                               39450000
394600                      PV-REFORMAT-TMST-TM-MM.                     39460000
394700                                                                  39470000
394800******************************************************************39480000
394900* READ A RECORD FROM THE ORIGIN RECEIVING FILE.                  *39490000
395000******************************************************************39500000
395100 6000-READ-RECEIVING-FILE.                                        39510000
395200                                                                  39520000
395300     READ TR015-RECEIVING-FILE                                    39530000
395400         INTO TR015-REC-TYP-ERD                                   39540000
395500         AT END                                                   39550000
395600           SET PS-END-OF-INPUT TO TRUE.                           39560000
395700                                                                  39570000
395800     IF PS-END-OF-INPUT                                           39580000
395900         CONTINUE                                                 39590000
396000     ELSE                                                         39600000
396100         MOVE TR015-RECEIVING-RECORD (1:3) TO PV-EDI-RECORDS      39610000
396200         IF EDI-RECORD                                            39620000
396300             SET PS-EDI-RECORD TO TRUE                            39630000
396400             PERFORM 6030-PROCESS-EDI-RECORD                      39640000
396500         ELSE                                                     39650000
396600             SET PS-GOOD-RECORD TO TRUE                           39660000
396700             ADD +1 TO PV-PROCESS-SEQ-NBR                         39670000
396901             IF (TR015-ERD-PO-NBR-X          NOT EQUAL            39690100
396910                 PV-HOLD-PO-NBR-X)                      OR        39691000
397000                (TR015-ERD-EXTL-REF-NBR      NOT EQUAL            39700000
397100                 PV-HOLD-EXTL-REF-NBR)                  OR        39710000
397200                (TR015-ERD-PO-RCVD-DELY-DTE   NOT EQUAL           39720000
397300                 PV-HOLD-PO-RCVD-DELY-DTE)              OR        39730000
397400                (TR015-ERD-ORGN-SHPD-FR-CDE  NOT EQUAL            39740000
397500                 PV-HOLD-ORGN-SHPD-FR-CDE)              OR        39750000
397600                (TR015-ERD-TRN-TYP           NOT EQUAL            39760000
397700                 PV-HOLD-LAST-TRN-TYP)                            39770000
397800                PERFORM 4900-RESET-WRITE-SWITCHES                 39780000
397900             END-IF                                               39790000
398000         END-IF                                                   39800000
398100     END-IF.                                                      39810000
398200                                                                  39820000
398300     IF (TR015-ERD-REC-TYP-CDE = PC-ERD  AND                      39830000
398400         TR015-ERD-TRN-TYP NOT = PC-D)         OR                 39840000
398500        (TR015-ERD-REC-TYP-CDE = PC-LOG  AND                      39850000
398600         TR015-ERD-TRN-TYP     = PC-D)                            39860000
398700         SET PS-NEW-GROUP TO TRUE                                 39870000
398800     END-IF.                                                      39880000
398900                                                                  39890000
399000     IF PS-END-OF-INPUT-NO                                        39900000
399100         ADD +1 TO PA-RCVD-INPUT-COUNT                            39910000
399200         MOVE TR015-REC-TYP-ERD (1:3) TO PV-HOLD-LAST-REC-TYP     39920000
399300     END-IF.                                                      39930000
399400                                                                  39940000
399500***************************************************************** 39950000
399600* CHECK EDI RECORDS FOR AN ISA RECORD TO DETERMINE THE          * 39960000
399700* CONSOLIDATOR NAME.                                            * 39970000
399800***************************************************************** 39980000
399900 6030-PROCESS-EDI-RECORD.                                         39990000
400000                                                                  40000000
400100     IF TR015-RECEIVING-RECORD (1:3) EQUAL PC-ISA                 40010000
400200         PERFORM 6040-CHECK-IEA-RECORD                            40020000
400300         ADD +1 TO PV-PROCESS-SEQ-NBR                             40030000
400400         MOVE TR015-RECEIVING-RECORD TO PV-HOLD-EDI-RECORD        40040000
400500         MOVE PV-EDI-VEND-ID-QUAL     TO PV-VEND-ID-QUAL          40050000
400600         MOVE PV-EDI-VEND-ID          TO PV-VEND-ID               40060000
400700         PERFORM 6035-PROCESS-ISA-RECORD                          40070000
400800     END-IF.                                                      40080000
400900                                                                  40090000
401000***************************************************************** 40100000
401100* PROCESS THE ISA RECORD TO OBTAIN HEADER RECORD FIELDS.        * 40110000
401200***************************************************************** 40120000
401300 6035-PROCESS-ISA-RECORD.                                         40130000
401400                                                                  40140000
401500     PERFORM 5660-INITIAL-HDR-FIELDS.                             40150000
401510     MOVE PC-HEADER1           TO PV-HOLD-TR221-ERROR-TYPE.       40151000
401600     SET TR221-REC-TYP-HDR-CDE-HDR  TO TRUE.                      40160000
401800     SET TR221-HDR-SEQ-NBR-01       TO TRUE.                      40180000
401810     MOVE PV-EDI-ENT-ID        TO TR221-DAT-SRC-ENT-ID.           40181000
401900     MOVE PV-PROCESS-SEQ-NBR   TO TR221-PROCESS-SEQ-NBR.          40190000
402000                                                                  40200000
402100     MOVE SPACES               TO PV-HOLD-TR221-DATA-IN-ERROR     40210000
402200                                  PV-HOLD-TR221-PO-NBR-X          40220000
402300                                  PV-HOLD-TR221-DATA-VALUE        40230000
402400                                  PV-HOLD-TR221-TRN-TYP           40240000
402500                                  PV-HOLD-TR221-EXTL-REF-NBR      40250000
402600                                  PV-HOLD-TR221-ORGN-SHPD-FR-CDE  40260000
402700                                  PV-HOLD-TR221-ERROR-MSG         40270000
402800                                  PV-HOLD-TR221-PO-RCVD-DELY-DTE  40280000
402900                                  PV-HOLD-TR221-PO-RCVD-DELY-TM.  40290000
403000                                                                  40300000
403100     PERFORM 7292-SELECT-TENTNME.                                 40310000
403200     IF PS-VALID-ENTNME                                           40320000
403300         MOVE ENTNME-ENT-NAME-DESC TO TR221-HDR-CONSOL-ENTNME     40330000
403500     ELSE                                                         40350000
403600         MOVE 'UNKNOWN ENT ID - EI USED'                          40360000
403610                                   TO TR221-HDR-CONSOL-ENTNME     40361000
403700         MOVE '10594'              TO TR221-DAT-SRC-ENT-ID        40370000
403800     END-IF.                                                      40380000
403900                                                                  40390000
404000     MOVE PV-EDI-CONSOL-TRNS-DTE   TO PV-HDR-CONSOL-TRNS-DTE-REST.40400000
404100     IF PV-EDI-CONSOL-TRNS-DTE (1:2) EQUAL PC-98 OR PC-99         40410000
404200         MOVE PC-19 TO PV-HDR-CONSOL-TRNS-DTE-CC                  40420000
404300     ELSE                                                         40430000
404400         MOVE PC-20 TO PV-HDR-CONSOL-TRNS-DTE-CC                  40440000
404500     END-IF.                                                      40450000
404600     MOVE PV-HDR-CONSOL-TRNS-DTE   TO TR221-HDR-CONSOL-TRNS-DTE.  40460000
404700                                                                  40470000
404800     MOVE PV-EDI-CONSOL-TRNS-TM    TO TR221-HDR-CONSOL-TRNS-TM.   40480000
404900     MOVE PV-EDI-CONSOL-FIL-ID     TO TR221-HDR-CONSOL-FIL-ID.    40490000
405000                                                                  40500000
405100     PERFORM 7100-SET-CURRENT-TMST.                               40510000
405200     PERFORM 5730-REFORMAT-CURRENT-TMST.                          40520000
405300     MOVE PV-REFORMAT-TMST-DTE     TO TR221-HDR-LOAD-DTE.         40530000
405400     MOVE PV-REFORMAT-TMST-TM      TO TR221-HDR-LOAD-TM.          40540000
405500     PERFORM 6200-WRITE-LOAD-REPORT.                              40550000
405600                                                                  40560000
405700     MOVE PC-HEADER2               TO PV-HOLD-TR221-ERROR-TYPE.   40570000
405800     MOVE PC-D                     TO TR221-RPT-TYP.              40580000
405900     MOVE PV-PROCESS-SEQ-NBR       TO TR221-PROCESS-SEQ-NBR.      40590000
406000     PERFORM 6210-WRITE-LOAD-REPORT-2.                            40600000
406100     ADD +1 TO PA-TOTAL-DETAIL-COUNT.                             40610000
406200                                                                  40620000
406300     PERFORM 5400-INITIAL-ERD-FIELDS-UPD.                         40630000
406400     MOVE TR015-REC-TYP-ERD        TO TR025-REC-TYP-ERD.          40640000
406500     MOVE PV-PROCESS-SEQ-NBR       TO TR025-ERD-PROCESS-SEQ-NBR.  40650000
406600     PERFORM 6400-WRITE-UPDATE-RECORD.                            40660000
406700                                                                  40670000
406800***************************************************************** 40680000
406900* CHECK TO SEE IF PREVIOUS RECORD WAS AN IEA RECORD.            * 40690000
407000***************************************************************** 40700000
407100 6040-CHECK-IEA-RECORD.                                           40710000
407200                                                                  40720000
407300     IF PV-HOLD-LAST-REC-TYP EQUAL PC-IEA                         40730000
407400         CONTINUE                                                 40740000
407500     ELSE                                                         40750000
407600         PERFORM 5650-INITIAL-ERROR-KEY-FIELDS                    40760000
407700         MOVE PC-EDI         TO PV-HOLD-TR221-ERROR-TYPE          40770000
407800         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  40780000
407900                             TO PV-HOLD-TR221-ERROR-MSG           40790000
408000         MOVE SPACES         TO TR221-REC-TYP-ERD                 40800000
408100                                PV-HOLD-TR221-DATA-IN-ERROR       40810000
408200                                PV-HOLD-TR221-PO-NBR-X            40820000
408300                                PV-HOLD-TR221-DATA-VALUE          40830000
408400                                PV-HOLD-TR221-TRN-TYP             40840000
408500                                PV-HOLD-TR221-EXTL-REF-NBR        40850000
408600                                PV-HOLD-TR221-PO-RCVD-DELY-DTE    40860000
408700                                PV-HOLD-TR221-PO-RCVD-DELY-TM     40870000
408800                                PV-HOLD-TR221-ORGN-SHPD-FR-CDE    40880000
408900         ADD +1 TO PV-PROCESS-SEQ-NBR                             40890000
409000         MOVE PV-PROCESS-SEQ-NBR TO TR221-PROCESS-SEQ-NBR         40900000
409100         PERFORM 6200-WRITE-LOAD-REPORT                           40910000
409200     END-IF.                                                      40920000
409300                                                                  40930000
409400***************************************************************** 40940000
409500* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 40950000
409600***************************************************************** 40960000
409700                                                                  40970000
409800 6200-WRITE-LOAD-REPORT.                                          40980000
409900                                                                  40990000
410000     MOVE PC-E TO TR221-RPT-TYP                                   41000000
410100     PERFORM 6210-WRITE-LOAD-REPORT-2.                            41010000
410200     ADD +1 TO PA-TOTAL-ERROR-COUNT.                              41020000
410300                                                                  41030000
410400***************************************************************** 41040000
410500* SETUP THE ERROR RECORD PRIOR TO WRITING OUT TO THE ERROR FILE.* 41050000
410600***************************************************************** 41060000
410700 6210-WRITE-LOAD-REPORT-2.                                        41070000
410800                                                                  41080000
410900     MOVE PV-HOLD-TR221-TRN-TYP           TO TR221-TRN-TYP.       41090000
411000                                                                  41100000
411100     IF PV-HOLD-TR221-PO-NBR NUMERIC                              41110000
411200         MOVE PV-HOLD-TR221-PO-NBR        TO TR221-PO-NBR         41120000
411300     ELSE                                                         41130000
411400         MOVE PV-HOLD-TR221-PO-NBR-X      TO TR221-PO-NBR-X       41140000
411500     END-IF.                                                      41150000
411600                                                                  41160000
411700     MOVE PV-HOLD-TR221-EXTL-REF-NBR  TO TR221-EXTL-REF-NBR.      41170000
411800     MOVE PV-HOLD-TR221-PO-RCVD-DELY-DTE TO                       41180000
411900                                  TR221-PO-RCVD-DELY-DTE.         41190000
412000     MOVE PV-HOLD-TR221-PO-RCVD-DELY-TM  TO                       41200000
412100                                  TR221-PO-RCVD-DELY-TM.          41210000
412200     MOVE PV-HOLD-TR221-ORGN-SHPD-FR-CDE TO                       41220000
412300                                  TR221-ORGN-SHPD-FR-CDE.         41230000
412400     MOVE PV-HOLD-TR221-DATA-IN-ERROR TO TR221-DATA-IN-ERROR.     41240000
412500     MOVE PV-HOLD-TR221-DATA-VALUE    TO TR221-DATA-VALUE.        41250000
412600     MOVE PV-HOLD-TR221-ERROR-TYPE    TO TR221-ERROR-TYPE.        41260000
412700     MOVE PV-HOLD-TR221-ERROR-MSG     TO TR221-ERROR-MSG.         41270000
412701                                                                  41270100
412702     IF TR221-REC-TYP-HDR-CDE-HDR                                 41270200
412703       MOVE PV-EDI-ENT-ID             TO TR221-DAT-SRC-ENT-ID     41270300
412704     END-IF.                                                      41270400
412800                                                                  41280000
412900     WRITE TR221-RECEIVING-ERROR-RECORD FROM                      41290000
413000           TR221-RECORD.                                          41300000
413100                                                                  41310000
413200***************************************************************** 41320000
413300* SETUP THE EDITED UPDATE RECORD PRIOR TO WRITING TO THE UPDATE * 41330000
413400* FILE THAT WILL BE PASSED TO PROGRAM TRKUP205.                 * 41340000
413500***************************************************************** 41350000
413600 6400-WRITE-UPDATE-RECORD.                                        41360000
413700                                                                  41370000
413800     WRITE TR025-UPDATE-RECEIVING-RECORD FROM                     41380000
413900           TR025-REC-TYP-ERD.                                     41390000
414000                                                                  41400000
414100     ADD +1 TO PA-TOTAL-UPDATE-COUNT.                             41410000
414200                                                                  41420000
414300***************************************************************** 41430000
414400* SETUP FIELDS FOR CALENDAR ROUTINE TO CHECK TIMESTAMPS.        * 41440000
414500***************************************************************** 41450000
414600 6500-CALENDAR-ROUTINE-SETUP.                                     41460000
414700                                                                  41470000
414800     INITIALIZE  DPG51 DPG52 DPG53                                41480000
414900                 DPG54 DPG55 DPG56.                               41490000
415000                                                                  41500000
415100     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            41510000
415200     MOVE PV-FORMAT-TMST-DTE (1:10) TO DPG52-LK-DATE-INPUT.       41520000
415300     MOVE PC-A0                TO DPG51-CALENDAR-TYPE.            41530000
415400     PERFORM 6510-CALENDAR-ROUTINE.                               41540000
415500                                                                  41550000
415600***************************************************************** 41560000
415700* SETUP FIELDS FOR CALENDAR ROUTINE TO CHECK TIMESTAMPS.        * 41570000
415800***************************************************************** 41580000
415900 6505-CALENDAR-ROUTINE-SETUP.                                     41590000
416000                                                                  41600000
416100     INITIALIZE  DPG51 DPG52 DPG53                                41610000
416200                 DPG54 DPG55 DPG56.                               41620000
416300                                                                  41630000
416400     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                            41640000
416500     MOVE PV-FORMAT-RCDT (1:10) TO DPG52-LK-DATE-INPUT.           41650000
416600     MOVE PC-A0                TO DPG51-CALENDAR-TYPE.            41660000
416700     PERFORM 6510-CALENDAR-ROUTINE.                               41670000
416800                                                                  41680000
416900***************************************************************** 41690000
417000* CALENDAR ROUTINE CALL TO CHECK TIMESTAMPS.                    * 41700000
417100***************************************************************** 41710000
417200 6510-CALENDAR-ROUTINE.                                           41720000
417300                                                                  41730000
417400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          41740000
417500                                             DPG53 DPG54          41750000
417600                                             DPG55 DPG56.         41760000
417700                                                                  41770000
417800     EVALUATE TRUE                                                41780000
417900         WHEN DPG54-SEVERE-ERROR                                  41790000
418000         WHEN DPG54-WARNING-ERROR                                 41800000
418100             SET PS-WARNING-DATE TO TRUE                          41810000
418200     END-EVALUATE.                                                41820000
418300                                                                  41830000
418400******************************************************************41840000
418500* SET THE CURRENT TIMESTAMP.                                     *41850000
418600******************************************************************41860000
418700 7100-SET-CURRENT-TMST.                                           41870000
418800                                                                  41880000
418900          EXEC SQL                                                41890000
419000              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            41900000
419100          END-EXEC                                                41910000
419200                                                                  41920000
419300         EVALUATE TRUE                                            41930000
419400             WHEN SQLCODE = ZERO                                  41940000
419500                 CONTINUE                                         41950000
419600                                                                  41960000
419700             WHEN SQLWARN0 NOT EQUAL SPACE                        41970000
419800             WHEN SQLCODE NOT EQUAL ZERO                          41980000
419900                 DISPLAY '**************************************' 41990000
420000                 DISPLAY '** ABEND                            **' 42000000
420100                 DISPLAY '** PROGRAM = TRKUT220               **' 42010000
420200                 DISPLAY '** PARAGRAPH = 7100-SET-CURRENT-TMST**' 42020000
420300                 DISPLAY '** SET CURRENT TIMESTAMP            **' 42030000
420400                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   42040000
420500                 DISPLAY '**************************************' 42050000
420600                 PERFORM 9100-SQL-ABEND                           42060000
420700         END-EVALUATE.                                            42070000
420800                                                                  42080000
420900******************************************************************42090000
421000* SELECT THE CONSOLIDATOR ENTERPRISE NAME FOR HEADER RECORD.     *42100000
421100******************************************************************42110000
421200 7292-SELECT-TENTNME.                                             42120000
421300                                                                  42130000
421310     MOVE PV-EDI-ENT-ID-9        TO PV-ENT-ID-SIGNED.             42131000
421320                                                                  42132000
421400     PERFORM                                                      42140000
421500         WITH TEST AFTER                                          42150000
421600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     42160000
421700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR            42170000
421800                 SQLCODE = ZERO                     OR            42180000
421900                 SQLCODE = +100                                   42190000
422000                                                                  42200000
422001         EXEC SQL                                                 42200100
422002             SELECT DISTINCT                                      42200200
422003                    ENT_NAME_DESC                                 42200300
422004              INTO :ENTNME-ENT-NAME-DESC                          42200400
422005              FROM  TENTNME                                       42200500
422006              WHERE ENT_ID    = :PV-ENT-ID-SIGNED                 42200600
422007              AND   TYPE_CDE  = '01'                              42200700
422010         END-EXEC                                                 42201000
423500                                                                  42350000
423600         EVALUATE TRUE                                            42360000
423700             WHEN SQLCODE = ZERO                                  42370000
423800             WHEN SQLCODE = -811                                  42380000
423900                 SET PS-VALID-ENTNME   TO TRUE                    42390000
424000                                                                  42400000
424100             WHEN SQLCODE = +100                                  42410000
424200                 SET PS-INVALID-ENTNME TO TRUE                    42420000
424300                                                                  42430000
424400             WHEN SQLWARN0 NOT EQUAL SPACE                        42440000
424500             WHEN SQLCODE NOT EQUAL ZERO                          42450000
424600                 DISPLAY '**************************************' 42460000
424700                 DISPLAY '** ABEND                            **' 42470000
424800                 DISPLAY '** PROGRAM = TRKUT220               **' 42480000
424900                 DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME  **' 42490000
425000                 DISPLAY '** SELECT CONSOLIDATOR NAME         **' 42500000
425100                 DISPLAY '** FROM ISA RECORD.                 **' 42510000
425200                 DISPLAY '** VEND ID      = ' PV-VEND-ID          42520000
425300                 DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL     42530000
425400                 DISPLAY '**************************************' 42540000
425500                 PERFORM 9100-SQL-ABEND                           42550000
425600         END-EVALUATE                                             42560000
425700     END-PERFORM.                                                 42570000
425800                                                                  42580000
425900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42590000
426000         (SQLCODE NOT = ZERO    AND                               42600000
426100             SQLCODE NOT = +100 AND                               42610000
426200             SQLCODE NOT = -811)                                  42620000
426300         DISPLAY '****************************************'       42630000
426400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       42640000
426500         DISPLAY '** SELECT FROM TENTNME                **'       42650000
426600         DISPLAY '** PARAGRAPH = 7292-SELECT-TENTNME    **'       42660000
426700         DISPLAY '** VEND ID      = ' PV-VEND-ID                  42670000
426800         DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL             42680000
426900         DISPLAY '****************************************'       42690000
427000         PERFORM 9100-SQL-ABEND                                   42700000
427100     END-IF.                                                      42710000
427200                                                                  42720000
427300 EJECT                                                            42730000
427400                                                                  42740000
427500******************************************************************42750000
427600* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *42760000
427700* JOB SUMMARY INFORMATION.                                       *42770000
427800* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *42780000
427900* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *42790000
428000* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TO LONG, THE EDI   *42800000
428100* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*42810000
428200* NO RETURN CODE OR MESSAGE IS SENT.                             *42820000
428300******************************************************************42830000
428400 8000-EOJ-ROUTINE.                                                42840000
428500                                                                  42850000
428600     IF EDI-IEA-RECORD OR                                         42860000
428700        PV-HOLD-TR221-ERROR-TYPE = PC-EMPTY                       42870000
428800         CONTINUE                                                 42880000
428900     ELSE                                                         42890000
429000         PERFORM 5650-INITIAL-ERROR-KEY-FIELDS                    42900000
429100         MOVE PC-EDI         TO PV-HOLD-TR221-ERROR-TYPE          42910000
429200         MOVE 'NO IEA RECORD - CALL PROGRAMMING'                  42920000
429300                             TO PV-HOLD-TR221-ERROR-MSG           42930000
429400         MOVE SPACES         TO TR221-REC-TYP-ERD                 42940000
429500                                PV-HOLD-TR221-DATA-IN-ERROR       42950000
429600                                PV-HOLD-TR221-PO-NBR-X            42960000
429700                                PV-HOLD-TR221-DATA-VALUE          42970000
429800                                PV-HOLD-TR221-TRN-TYP             42980000
429900                                PV-HOLD-TR221-EXTL-REF-NBR        42990000
430000                                PV-HOLD-TR221-PO-RCVD-DELY-DTE    43000000
430100                                PV-HOLD-TR221-PO-RCVD-DELY-TM     43010000
430200                                PV-HOLD-TR221-ORGN-SHPD-FR-CDE    43020000
430300         ADD +1 TO PV-PROCESS-SEQ-NBR                             43030000
430400         MOVE PV-PROCESS-SEQ-NBR TO TR221-PROCESS-SEQ-NBR         43040000
430500         PERFORM 6200-WRITE-LOAD-REPORT                           43050000
430600     END-IF.                                                      43060000
430700                                                                  43070000
430800     CLOSE TR015-RECEIVING-FILE                                   43080000
430900           TR025-UPDATE-RECEIVING-FILE                            43090000
431000           TR221-RECEIVING-ERROR-FILE.                            43100000
431100                                                                  43110000
431200     DISPLAY '**********************************'.                43120000
431300     DISPLAY '** TRKUT220 SUMMARY **'.                            43130000
431400     DISPLAY 'RECEIVED INPUT COUNT   = ' PA-RCVD-INPUT-COUNT.     43140000
431500     DISPLAY 'RCPO RECS ADD    COUNT = ' PA-TOT-RCPO-RECS-ADD.    43150000
431600     DISPLAY 'RCVS RECS ADD    COUNT = ' PA-TOT-RCVS-RECS-ADD.    43160000
431700     DISPLAY 'RCUP RECS ADD    COUNT = ' PA-TOT-RCUP-RECS-ADD.    43170000
431800     DISPLAY 'RCPO RECS CHANGE COUNT = ' PA-TOT-RCPO-RECS-CHANGE. 43180000
431900     DISPLAY 'RCVS RECS CHANGE COUNT = ' PA-TOT-RCVS-RECS-CHANGE. 43190000
432000     DISPLAY 'RCUP RECS CHANGE COUNT = ' PA-TOT-RCUP-RECS-CHANGE. 43200000
432100     DISPLAY 'LOG RECS  DELETE COUNT = ' PA-TOT-LOG-RECS-DELETE.  43210000
432200     DISPLAY 'TOTAL UPDATE COUNT     = ' PA-TOTAL-UPDATE-COUNT.   43220000
432300     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.    43230000
432400     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.   43240000
432500     DISPLAY '**********************************'.                43250000
432600                                                                  43260000
432700 EJECT                                                            43270000
432800                                                                  43280000
432900******************************************************************43290000
433000* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *43300000
433100* ERROR OR WARNING CODE OCCURS.                                  *43310000
433200******************************************************************43320000
433300 9100-SQL-ABEND.                                                  43330000
433400******************************************************************43340000
433500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *43350000
433600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *43360000
433700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *43370000
433800* FORMAT.                                                        *43380000
433900******************************************************************43390000
434000                                                                  43400000
434100     COPY DPPD004.                                                43410000
434200                                                                  43420000
434300     DISPLAY 'PO NBR ABEND     '  TR015-ERD-PO-NBR.               43430000
434400     DISPLAY 'EXTRL REF ABEND  '  TR015-ERD-EXTL-REF-NBR.         43440000
434500     DISPLAY 'RCVD DELY DTE ABND'  TR015-ERD-PO-RCVD-DELY-DTE.    43450000
434600     DISPLAY 'HOLD PO   ABEND  '  PV-HOLD-PO-NBR.                 43460000
434700     DISPLAY 'HOLD X REF ABEND '  PV-HOLD-EXTL-REF-NBR.           43470000
434800     DISPLAY 'HOLD RCVD DTE ABND'  PV-HOLD-PO-RCVD-DELY-DTE.      43480000
434900     DISPLAY 'HOLD ORG SHP FR  '  PV-HOLD-ORGN-SHPD-FR-CDE.       43490000
435000     MOVE +4013 TO ABEND-CODE.                                    43500000
435100     CALL 'ILBOABN0' USING ABEND-CODE.                            43510000
