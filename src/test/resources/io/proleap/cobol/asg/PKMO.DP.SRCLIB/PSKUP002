000100*                                                                 00010004
000200*                                                                 00020004
000300*                                                                 00030004
000400 IDENTIFICATION DIVISION.                                         00040004
000500                                                                  00050004
000600 PROGRAM-ID.          PSKUP002.                                   00060004
000700 AUTHOR.              D FRANKLIN.                                 00070004
000800 INSTALLATION.        KOHLS DEPARTMENT STORES.                    00080004
000900 DATE-WRITTEN.        01/11/88.                                   00090004
001000 DATE-COMPILED.                                                   00100004
001100                                                                  00110004
001200***************************************************************   00120004
001300*       UPDATE MASTER GIFT CERTIFICATE FILE.                  *   00130004
001400*                                                             *   00140004
001500*     THIS PROGRAM WILL READ THROUGH THE GIFT CERTIFICATE     *   00150004
001600*     MASTER FILE AND DELETE ALL TRANSACTIONS DEALING WITH    *   00160004
001700*     GIFT CERTIFICATES THAT HAVE BEEN REDEEMED FOR OVER A    *   00170004
001800*     MONTH.  INSTEAD OF ACTUALLY DELETING THE RECORDS, ALL   *   00180004
001900*     RECORDS FOR THOSE CERTIFICATES THAT HAVE NOT BEEN       *   00190004
002000*     REDEEMED AT ALL OR THOSE THAT HAVE BEEN REDEEMED FOR    *   00200004
002100*     LESS THAN 1 MONTH WILL BE WRITTEN TO THE NEW FILE.      *   00210004
002200*     THE OLD FILE IS DELETED WHEN THE PROGRAM COMPLETES AND  *   00220004
002300*     IS BUILT AGAIN BY COPYING THE NEW FILE TO IT.           *   00230004
002400*                                                             *   00240004
002500*     THIS PROGRAM USES A TABLE THAT CAN HOLD UP TO 80        *   00250004
002600*     GIFT CERTIFICATE RECORDS FOR THE SAME GIFT CERTIFICATE  *   00260004
002700*     NUMBER.   IF MORE THAN 80 EXIST ON FILE (SHOULD NEVER   *   00270004
002800*     HAPPEN), THE PROGRAM ABENDS.  SINCE THE NUMBERS ARE     *   00280004
002900*     UNIQUE WITHIN A DENOMINATION DUPLICATES CAN ONLY OCCURE *   00290004
003000*     ACROSS DENOMINATION.  MORE THAN 5  COULD INDICATE       *   00300004
003100*     INPUT DATA ERROR.                                       *   00310004
003200***************************************************************   00320004
003300*    READ THE FIRST OLD GIFT CERTIFICATE RECORD.                  00330004
003400*                      PROGRAM CHANGES                            00340004
003500*                      ---------------                            00350004
003600* BY: -------------------------   ON: MM/DD/YY    FOR: ------     00360004
003700*     ---------------------------------------------------------   00370004
003800*     ---------------------------------------------------------   00380004
003900*     ---------------------------------------------------------   00390004
004000*                                                                 00400004
004100* BY: W. A. EHMKE                 ON: 01/25/89    FOR: IR 10955   00410004
004200*     ALTER GIFT CERTIFICATE TABLE FROM 10 TO 50 ENTRIES.         00420004
004300*     ---------------------------------------------------------   00430004
004400*     ---------------------------------------------------------   00440004
004500*                                                                 00450004
004600* BY: D.MEDORA (CGA)              ON: 07/29/88    FOR: WR 471     00460004
004700*     CHANGED PARAGRAPH C100-CHECK-REDEEM-DATE TO REFERENCE       00470004
004800*     THE DISCOVER CARD CODE 29 IN THE GIFT TYPE IF STATEMENT.    00480004
004900******************************************************************00490004
005000* 12/27/95 - TCM -  WR NO. P000013505                            *00500004
005100*    - EXPAND GIFT CERTIFICATE TABLE (SR-SAVE-GIFTS) FROM 50 TO  *00510004
005200*      80 ENTRIES                                                *00520004
005300******************************************************************00530004
005400* CHANGED  01/13/99 BY DAVE MUSKAT     COMPUWARE       TKMA485   *00540004
005500*   WR: 6041   CHANGES FOR Y2K:                                  *00550004
005600*    ADDED WINDOWING TO ADD CENTURY TO DM-DATE-MANIPULATORS      *00560004
005700*    FIELDS.  CHANGED DM-DATE-MANIPULATORS FIELDS TO BE GROUP    *00570004
005800*    DATE FIELDS IN CCYYMMDD FORMAT.  REPLACED CODE COMPARING    *00580004
005900*    ELEMENTARY YEAR, MONTH, DAY FIELDS WITH CODE COMPARING THE  *00590004
006000*    GROUP DATE FIELDS.  ADDED CALL TO THE KOHLS CALENDAR        *00600004
006100*    ROUTINE TO COMPARE DATES AND DETERMINE IF MORE THAN ONE     *00610004
006200*    MONTH DIFFERENCE EXISTS BETWEEN THE DATES.                  *00620004
006300******************************************************************00630004
006400* CHANGED  02/19/03 BY GAYLE HAUPT                                00640004
006500*   WR#  P000527925                                               00650004
006600*    INCREASED NUMBER OF GIFT CERTIFICATES THAT CAN HAVE THE     *00660004
006700*    SAME GIFT CERTIFICATE NUMBER.   THIS BECOMES A POSSIBILITY  *00670004
006800*    MORE AND MORE AS THE NUMBER OF KOHLS STORES INCREASES.      *00680004
006900******************************************************************00690004
007000*                                                                 00700004
007100*                                                                 00710004
007200*                                                                 00720004
007300 ENVIRONMENT DIVISION.                                            00730004
007400*                                                                 00740004
007500*                                                                 00750004
007600 CONFIGURATION SECTION.                                           00760004
007700                                                                  00770004
007800 SOURCE-COMPUTER.     IBM-3090.                                   00780004
007900 OBJECT-COMPUTER.     IBM-3090.                                   00790004
008000*                                                                 00800004
008100*                                                                 00810004
008200 INPUT-OUTPUT SECTION.                                            00820004
008300 FILE-CONTROL.                                                    00830004
008400                                                                  00840004
008500     SELECT OLD-MASTER-GIFT-FILE                                  00850004
008600         ASSIGN TO INP01.                                         00860004
008700                                                                  00870004
008800     SELECT NEW-MASTER-GIFT-FILE                                  00880004
008900         ASSIGN TO OUT01.                                         00890004
009000 EJECT                                                            00900004
009100*                                                                 00910004
009200*                                                                 00920004
009300*                                                                 00930004
009400 DATA DIVISION.                                                   00940004
009500*                                                                 00950004
009600*                                                                 00960004
009700 FILE SECTION.                                                    00970004
009800                                                                  00980004
009900 FD  OLD-MASTER-GIFT-FILE                                         00990004
010000     RECORDING MODE IS F                                          01000004
010100     LABEL RECORDS ARE STANDARD                                   01010004
010200     BLOCK CONTAINS 0 RECORDS                                     01020004
010300     RECORD CONTAINS 56 CHARACTERS                                01030004
010400     DATA RECORD IS OM-OLD-MSTGIFT-RECORD.                        01040004
010500                                                                  01050004
010600 01  OM-OLD-MSTGIFT-RECORD           PIC X(56).                   01060004
010700                                                                  01070004
010800 FD  NEW-MASTER-GIFT-FILE                                         01080004
010900     RECORDING MODE IS F                                          01090004
011000     LABEL RECORDS ARE STANDARD                                   01100004
011100     BLOCK CONTAINS 0 RECORDS                                     01110004
011200     RECORD CONTAINS 56 CHARACTERS                                01120004
011300     DATA RECORD IS NM-NEW-MSTGIFT-RECORD.                        01130004
011400                                                                  01140004
011500 01  NM-NEW-MSTGIFT-RECORD           PIC X(56).                   01150004
011600 EJECT                                                            01160004
011700*                                                                 01170004
011800*                                                                 01180004
011900 WORKING-STORAGE SECTION.                                         01190004
012000                                                                  01200004
012100     COPY PSRD002I.                                               01210004
012200                                                                  01220004
012300     COPY PSRD002O.                                               01230004
012400                                                                  01240004
012500 01  DM-DATE-MANIPULATORS.                                        01250004
012600     05  DM-CCYYMMDD-1           PIC 9(08)    VALUE ZEROES.       01260004
012700     05  FILLER REDEFINES DM-CCYYMMDD-1.                          01270004
012800         10  DM-CC-1             PIC 9(02).                       01280004
012900         10  DM-YY-1             PIC 9(02).                       01290004
013000         10  DM-MM-1             PIC 9(02).                       01300004
013100         10  DM-DD-1             PIC 9(02).                       01310004
013200     05  DM-CCYYMMDD-2           PIC 9(08)    VALUE ZEROES.       01320004
013300     05  FILLER REDEFINES DM-CCYYMMDD-2.                          01330004
013400         10  DM-CC-2             PIC 9(02).                       01340004
013500         10  DM-YY-2             PIC 9(02).                       01350004
013600         10  DM-MM-2             PIC 9(02).                       01360004
013700         10  DM-DD-2             PIC 9(02).                       01370004
013800                                                                  01380004
013900 01  PH-PROGRAM-HOLD-AREAS.                                       01390004
014000     05  PH-MM                   PIC S9(4)    VALUE ZEROES        01400004
014100                                              COMP SYNC.          01410004
014200     05  PH-YY                   PIC S9(4)    VALUE ZEROES        01420004
014300                                              COMP SYNC.          01430004
014400                                                                  01440004
014500 01  PS-PROGRAM-SWITCHES.                                         01450004
014600     05  PS-EOF                  PIC X(1)     VALUE 'N'.          01460004
014700         88  PS-END-OF-FILE                   VALUE 'Y'.          01470004
014800     05  PS-DELETE-SW            PIC X(1)     VALUE 'N'.          01480004
014900         88  PS-DELETE                        VALUE 'Y'.          01490004
015000         88  PS-NO-DELETE                     VALUE 'N'.          01500004
015100     05  PS-PASSED-FIRST-SW      PIC X(1)     VALUE 'N'.          01510004
015200         88  PS-PASSED-FIRST                  VALUE 'Y'.          01520004
015300     05  PS-GREATER-DATE-SW      PIC X(1)     VALUE 'N'.          01530004
015400         88  PS-GREATER-DATE                  VALUE 'Y'.          01540004
015500         88  PS-NO-GREATER-DATE               VALUE 'N'.          01550004
015600                                                                  01560004
015700 01  PS-PROGRAM-SUBSCRIPTS.                                       01570004
015800     05  PS-X                    PIC S9(4)    VALUE 1             01580004
015900                                              COMP SYNC.          01590004
016000*  2/19/2003  INCREASED TABLE OCCURS FROM 180 TO 1500             01600005
016100 01  SR-SAVE-RECORD.                                              01610004
016200     05  SR-SAVE-GIFTS OCCURS 1500 TIMES.                         01620005
016300         10  SR-GIFT-NO          PIC X(5).                        01630004
016400         10  SR-STORE-NO         PIC X(4).                        01640004
016500         10  SR-OPERATOR         PIC S9(7)    COMP-3.             01650004
016600         10  SR-TRANSACTION      PIC S9(5)    COMP-3.             01660004
016700         10  SR-GIFT-DATE.                                        01670004
016800             15  SR-MM           PIC X(2).                        01680004
016900             15  SR-DD           PIC X(2).                        01690004
017000             15  SR-YY           PIC X(2).                        01700004
017100         10  SR-GIFT-TIME        PIC S9(3)V99 COMP-3.             01710004
017200         10  SR-GIFT-TYPE        PIC X(2).                        01720004
017300         10  SR-AMOUNT           PIC S9(5)V99 COMP-3.             01730004
017400         10  SR-PRINT-INDICATOR  PIC X(5).                        01740004
017500         10  FILLER              PIC X(20).                       01750004
017600                                                                  01760004
017700 01  TD-TODAYS-DATE.                                              01770004
017800     05  TD-YY                   PIC 9(2)     VALUE ZEROES.       01780004
017900     05  TD-MM                   PIC 9(2)     VALUE ZEROES.       01790004
018000     05  TD-DD                   PIC 9(2)     VALUE ZEROES.       01800004
018100                                                                  01810004
018200******************************************************************01820004
018300*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01830004
018400******************************************************************01840004
018500     COPY DPWS500.                                                01850004
018600                                                                  01860004
018700 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROES        01870004
018800                                              COMP SYNC.          01880004
018900     88  AC-CALENDAR-ROUTINE-ERROR            VALUE +4019.        01890004
019000 EJECT                                                            01900004
019100*                                                                 01910004
019200*                                                                 01920004
019300*                                                                 01930004
019400 PROCEDURE DIVISION.                                              01940004
019500                                                                  01950004
019600 A100-MAIN-MODULE.                                                01960004
019700                                                                  01970004
019800******************************************************************01980004
019900*    OPEN ALL FILES.                                              01990004
020000*    SAVE TODAYS DATE.                                            02000004
020100*    READ THE FIRST OLD GIFT CERTIFICATE RECORD.                  02010004
020200*    PROCESS THE REST OF THE RECORDS UNTIL END OF FILE.           02020004
020300*    CHECK IF THE LAST CERTIFICATE SHOULD BE DELETED.             02030004
020400*    CLOSE FILES.                                                 02040004
020500******************************************************************02050004
020600                                                                  02060004
020700     OPEN INPUT  OLD-MASTER-GIFT-FILE.                            02070004
020800     OPEN OUTPUT NEW-MASTER-GIFT-FILE.                            02080004
020900                                                                  02090004
021000     PERFORM B100-INITIALIZE.                                     02100004
021100                                                                  02110004
021200     PERFORM Z100-READ-OLD-GIFT.                                  02120004
021300     IF NOT PS-END-OF-FILE                                        02130004
021400         MOVE PS002I-GIFT-RECORD TO SR-SAVE-GIFTS(PS-X)           02140004
021500         PERFORM B200-PROCESS-RECORDS                             02150004
021600             UNTIL PS-END-OF-FILE                                 02160004
021700                                                                  02170004
021800         MOVE 1 TO PS-X                                           02180004
021900         SET PS-NO-DELETE TO TRUE                                 02190004
022000         PERFORM C100-CHECK-REDEEM-DATE                           02200004
022100             UNTIL (PS-X IS GREATER THAN 1500)            OR      02210005
022200                   (SR-GIFT-NO(PS-X) IS EQUAL TO SPACES) OR       02220004
022300                   (PS-DELETE)                                    02230004
022400                                                                  02240004
022500         IF PS-NO-DELETE                                          02250004
022600             MOVE 1 TO PS-X                                       02260004
022700             PERFORM Z200-WRITE-NEW-GIFT                          02270004
022800                 UNTIL (PS-X IS GREATER THAN 1500)        OR      02280005
022900                       (SR-GIFT-NO(PS-X) IS EQUAL TO SPACES)      02290004
023000         END-IF                                                   02300004
023100     END-IF.                                                      02310004
023200                                                                  02320004
023300     CLOSE OLD-MASTER-GIFT-FILE                                   02330004
023400           NEW-MASTER-GIFT-FILE.                                  02340004
023500                                                                  02350004
023600     STOP RUN.                                                    02360004
023700 EJECT                                                            02370004
023800 B100-INITIALIZE.                                                 02380004
023900                                                                  02390004
024000******************************************************************02400004
024100*    INITIALIZE VARIABLES.                                        02410004
024200*                                                                 02420004
024300*    PERFORMED BY A100-MAIN-MODULE.                               02430004
024400******************************************************************02440004
024500                                                                  02450004
024600     ACCEPT TD-TODAYS-DATE                                        02460004
024700         FROM DATE.                                               02470004
024800     MOVE TD-MM TO DM-MM-1.                                       02480004
024900     MOVE TD-DD TO DM-DD-1.                                       02490004
025000     MOVE TD-YY TO DM-YY-1.                                       02500004
025100                                                                  02510004
025200     IF DM-YY-1 > 80                                              02520004
025300         MOVE 19 TO DM-CC-1                                       02530004
025400     ELSE                                                         02540004
025500         MOVE 20 TO DM-CC-1                                       02550004
025600     END-IF.                                                      02560004
025700                                                                  02570004
025800     INITIALIZE SR-SAVE-RECORD.                                   02580004
025900 EJECT                                                            02590004
026000 B200-PROCESS-RECORDS.                                            02600004
026100                                                                  02610004
026200******************************************************************02620004
026300*    READ THE OLD GIFT CERTIFICATE RECORDS, SAVING THEM UNTIL     02630004
026400*    THE GIFT CERTIFICATE NUMBER CHANGES.                         02640004
026500*                                                                 02650004
026600*    IF THERE HAPPENS TO BE MORE THAN 80 RECORDS WITH THE         02660004
026700*    SAME GIFT CERTIFICATE NUMBER, THE PROGRAM WILL ABEND.        02670004
026800*                                                                 02680004
026900*    WHEN THE NUMBER CHANGES, SCAN THE TABLE AND CHECK IF THIS    02690004
027000*    CERTIFICATE HAS BEEN REDEEMED FOR OVER A MONTH.              02700004
027100*                                                                 02710004
027200*    IF THE CERTIFICATE HAS NOT BEEN REDEEMED FOR OVER A MONTH,   02720004
027300*    ADD ALL OF THE SAVED RECORDS TO THE NEW FILE.                02730004
027400*                                                                 02740004
027500*    PERFORMED BY A100-MAIN-MODULE.                               02750004
027600******************************************************************02760004
027700                                                                  02770004
027800     IF PS-PASSED-FIRST                                           02780004
027900         IF PS002I-GIFT-NO IS EQUAL TO SR-GIFT-NO(PS-X)           02790004
028000             ADD 1 TO PS-X                                        02800004
028100             IF PS-X IS GREATER THAN 1500                         02810005
028200                 MOVE 4004 TO ABEND-CODE                          02820004
028300                 DISPLAY '**** ABEND **** IN PSKUP002'            02830004
028400                 DISPLAY 'GIFT CERTIFICATE ' PS002I-GIFT-NO       02840004
028500                 DISPLAY 'HAS MORE THAN 1500 ENTRIES ON FILE'     02850005
028600                 CALL 'ILBOABN0' USING ABEND-CODE                 02860004
028700             END-IF                                               02870004
028800             MOVE PS002I-GIFT-RECORD TO SR-SAVE-GIFTS(PS-X)       02880004
028900                                                                  02890004
029000         ELSE                                                     02900004
029100             MOVE 1 TO PS-X                                       02910004
029200             SET PS-NO-DELETE TO TRUE                             02920004
029300             PERFORM C100-CHECK-REDEEM-DATE                       02930004
029400                 UNTIL (PS-X IS GREATER THAN 1500)            OR  02940005
029500                       (SR-GIFT-NO(PS-X) IS EQUAL TO SPACES) OR   02950004
029600                       (PS-DELETE)                                02960004
029700                                                                  02970004
029800             IF PS-NO-DELETE                                      02980004
029900                 MOVE 1 TO PS-X                                   02990004
030000                 PERFORM Z200-WRITE-NEW-GIFT                      03000004
030100                     UNTIL (PS-X IS GREATER THAN 1500)        OR  03010005
030200                           (SR-GIFT-NO(PS-X) IS EQUAL TO SPACES)  03020004
030300             END-IF                                               03030004
030400                                                                  03040004
030500             INITIALIZE SR-SAVE-RECORD                            03050004
030600             MOVE 1 TO PS-X                                       03060004
030700             MOVE PS002I-GIFT-RECORD TO SR-SAVE-GIFTS(PS-X)       03070004
030800         END-IF                                                   03080004
030900     ELSE                                                         03090004
031000         SET PS-PASSED-FIRST TO TRUE                              03100004
031100     END-IF.                                                      03110004
031200     PERFORM Z100-READ-OLD-GIFT.                                  03120004
031300 EJECT                                                            03130004
031400 C100-CHECK-REDEEM-DATE.                                          03140004
031500                                                                  03150004
031600******************************************************************03160004
031700*    CHECK IF THE CERTIFICATE HAS BEEN REDEEMED, AND IF ITS       03170004
031800*    REDEMPTION DATE IS OVER A MONTH OLD.                         03180004
031900*                                                                 03190004
032000*    IF THE CERTIFICATE SOMEHOW HAS A DATE GREATER THAN TODAY'S,  03200004
032100*    DO NOT DELETE IT FROM THE FILE.                              03210004
032200*                                                                 03220004
032300*    PERFORMED BY B200-PROCESS-RECORDS.                           03230004
032400******************************************************************03240004
032500                                                                  03250004
032600     IF (SR-GIFT-TYPE(PS-X) IS EQUAL TO '20') OR                  03260004
032700        (SR-GIFT-TYPE(PS-X) IS EQUAL TO '21') OR                  03270004
032800        (SR-GIFT-TYPE(PS-X) IS EQUAL TO '26') OR                  03280004
032900        (SR-GIFT-TYPE(PS-X) IS EQUAL TO '27') OR                  03290004
033000        (SR-GIFT-TYPE(PS-X) IS EQUAL TO '29')                     03300004
033100         MOVE SR-MM(PS-X) TO DM-MM-2                              03310004
033200         MOVE SR-DD(PS-X) TO DM-DD-2                              03320004
033300         MOVE SR-YY(PS-X) TO DM-YY-2                              03330004
033400         IF DM-YY-2 > 80                                          03340004
033500             MOVE 19 TO DM-CC-2                                   03350004
033600         ELSE                                                     03360004
033700             MOVE 20 TO DM-CC-2                                   03370004
033800         END-IF                                                   03380004
033900         PERFORM C200-CHECK-GREATER-DATE                          03390004
034000         IF PS-NO-GREATER-DATE                                    03400004
034100             PERFORM C300-COMPARE-CALENDAR-DATES                  03410004
034200         END-IF                                                   03420004
034300     END-IF.                                                      03430004
034400     ADD 1 TO PS-X.                                               03440004
034500                                                                  03450004
034600 EJECT                                                            03460004
034700 C200-CHECK-GREATER-DATE.                                         03470004
034800                                                                  03480004
034900******************************************************************03490004
035000*    CHECK IF THE CERTIFICATE HAS A GREATER DATE THAN TODAYS      03500004
035100*                                                                 03510004
035200*    PERFORMED BY C100-CHECK-REDEEM-DATE.                         03520004
035300******************************************************************03530004
035400                                                                  03540004
035500     SET PS-NO-GREATER-DATE TO TRUE.                              03550004
035600     IF DM-CCYYMMDD-2 IS GREATER THAN DM-CCYYMMDD-1               03560004
035700         SET PS-GREATER-DATE TO TRUE                              03570004
035800     END-IF.                                                      03580004
035900 EJECT                                                            03590004
036000 C300-COMPARE-CALENDAR-DATES.                                     03600004
036100                                                                  03610004
036200******************************************************************03620004
036300*    COMPARE THE CERTIFICATE DATE TO TODAYS DATE TO SEE IF THERE  03630004
036400*    IS MORE THAN 1 MONTH DIFFERENCE BETWEEN THEM.                03640004
036500*                                                                 03650004
036600*    PERFORMED BY C100-CHECK-REDEEM-DATE.                         03660004
036700******************************************************************03670004
036800                                                                  03680004
036900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03690004
037000                                                                  03700004
037100     SET DPG51-ACTUAL-CALENDAR-ONLY    TO TRUE.                   03710004
037200     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   03720004
037300     SET DPG52-LK-DTE-ISO              TO TRUE.                   03730004
037400     SET DPG53-LK-CMPR-DTE-ISO         TO TRUE.                   03740004
037500     MOVE DM-CCYYMMDD-1        TO DPG52-LK-DATE-INPUT             03750004
037600     MOVE DM-CCYYMMDD-2        TO DPG53-LK-CMPR-DATE-INPUT        03760004
037700                                                                  03770004
037800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03780004
037900                                             DPG54 DPG55 DPG56.   03790004
038000     EVALUATE TRUE                                                03800004
038100         WHEN DPG54-SEVERE-ERROR                                  03810004
038200         WHEN DPG54-DATE-INVALID                                  03820004
038300             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                03830004
038400             DISPLAY '**** ABEND **** IN PSKUP002'                03840004
038500             DISPLAY '** PARAGRAPH ** '                           03850004
038600                     'C300-COMPARE-CALENDAR-DATES'                03860004
038700             DISPLAY 'ERROR RETURNED FROM PROGRAM '               03870004
038800                     DP500-KOHLS-CALENDAR-ROUTINE                 03880004
038900             DISPLAY DPG54-ERROR-MESSAGE                          03890004
039000             CALL 'ILBOABN0' USING ABEND-CODE                     03900004
039100     END-EVALUATE.                                                03910004
039200     IF DPG55-DAYS-DIFFERENCE > 30                                03920004
039300         SET PS-DELETE TO TRUE                                    03930004
039400     END-IF.                                                      03940004
039500 EJECT                                                            03950004
039600 Z100-READ-OLD-GIFT.                                              03960004
039700                                                                  03970004
039800******************************************************************03980004
039900*    READ THE OLD MASTER GIFT CERTIFICATE FILE.                   03990004
040000*                                                                 04000004
040100*    PERFORMED BY A100-MAIN-MODULE.                               04010004
040200*    PERFORMED BY B200-PROCESS-RECORDS.                           04020004
040300******************************************************************04030004
040400                                                                  04040004
040500     READ OLD-MASTER-GIFT-FILE                                    04050004
040600         INTO PS002I-GIFT-RECORD                                  04060004
040700         AT END                                                   04070004
040800             SET PS-END-OF-FILE TO TRUE.                          04080004
040900                                                                  04090004
041000 Z200-WRITE-NEW-GIFT.                                             04100004
041100                                                                  04110004
041200******************************************************************04120004
041300*    ADD GIFT CERTIFICATE RECORDS TO THE END OF THE NEW           04130004
041400*    MASTER FILE.                                                 04140004
041500*                                                                 04150004
041600*    PERFORMED BY A100-MAIN-MODULE.                               04160004
041700*    PERFORMED BY B200-PROCESS-RECORDS.                           04170004
041800******************************************************************04180004
041900                                                                  04190004
042000     MOVE SR-SAVE-GIFTS(PS-X) TO PS002O-GIFT-RECORD.              04200004
042100                                                                  04210004
042200     WRITE NM-NEW-MSTGIFT-RECORD                                  04220004
042300         FROM PS002O-GIFT-RECORD.                                 04230004
042400                                                                  04240004
042500     ADD 1 TO PS-X.                                               04250004
