000010******************************************************************00010072
000020 IDENTIFICATION DIVISION.                                         00020072
000030******************************************************************00030072
000040                                                                  00040072
000050 PROGRAM-ID.             SAKRP101.                                00050072
000060 AUTHOR.                 BARB SCHULTZ.                            00060072
000070 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070072
000080 DATE-WRITTEN.           JUNE 2020.                               00080072
000090 DATE-COMPILED.                                                   00090072
000091                                                                  00100072
000092***************************************************************** 00110072
000093* THIS PROGRAM CREATES A REPORT THAT SHOWS SALES AND RETURN       00120072
000094* TOTALS FOR DEPT 985. (MIRAKL MARKETPLACE)                       00130072
000095* IT ALSO SHOWS THE LINE LEVEL DISCOUNTS PER ITEM FOR DEPT 985.   00140072
000096***************************************************************** 00150072
MKTPLC* DATE: 09-23-2020                      CHG#: CHG0249017          00160072
MKTPLC* WHO: BARB SCHULTZ                                               00170072
MKTPLC* WHY: THREE NEW COLUMNS WERE CREATED ON THE REPORT - SHIPPING    00180072
MKTPLC*      AMOUNT, SHIPPING TAX AMOUNT AND FEES. THE FEES CONSIST     00190072
MKTPLC*      OF GIFT WRAPPING (SALE AND RTN) AND FEES (SALE AND RTN).   00200072
000100******************************************************************00210072
FIXDSC* DATE: 10-20-2020                      CHG#: CHG0250190          00220072
FIXDSC* WHO: BARB SCHULTZ                                               00230072
FIXDSC* WHY: FIXED THE EMPLOYEE DISCOUNT.  ALSO ADDED A STORE TOTAL FOR 00240072
FIXDSC*      EACH COLUMN. SHIPPING AMOUNT, SHIPPING TAX AND FEES WERE   00250072
FIXDSC*      ALSO TAKEN OUT OF THE TOTAL SALES AND RETURN AMOUNTS.      00260072
FIXDSC*      INCREASED THE SIZE OF THE REPORT TO 150 CHARACTERS.        00270072
FIXDSC*      ADDED THE ORDER NUMBER TO THE DETAIL LINE.                 00280072
TOTALS******************************************************************00290072
TOTALS* DATE: 10-27-2020                      CHG#: CHG0250619          00300072
TOTALS* WHO: BARB SCHULTZ                                               00310072
TOTALS* WHY: ADDED SALE AND RETURN TOTALS FOR THE DISCOUNT COLUMNS.     00320072
SQLCHG******************************************************************00330074
SQLCHG* DATE: 10-27-2020                      CHG#: CHG0251246          00340074
SQLCHG* WHO: BARB SCHULTZ                                               00350074
SQLCHG* WHY: TOOK OUT THE TEPPART TABLE FROM TWO CURSORS - LID-CURSOR   00360074
SQLCHG* AND TEPLIS-CSR. THIS TABLE WAS NOT NEEDED IN BOTH CURSORS       00370074
SQLCHG* AND IT REDUCED THE TIMING OF THE PROGRAM SIGNIFICANTLY.         00380074
SQLCHG******************************************************************00381076
251411* DATE: 11-24-2020                      CHG#: CHG0251411          00382084
251411* WHO: BARB SCHULTZ & COGNIZANT                                   00383082
251411* WHY: IN PARAGRAPH 3550-SELECT-TEPSHP-AMT WE WERE PICKING UP     00384082
251411* SHIPPING COSTS FOR ALL ITEMS, NOT JUST THE MARKETPLACE ITEM IN  00384182
251411* THE TRANSACTION AND THIS CAUSED -811.  BY ADDING THIS LINE OF   00385082
251411* CODE, AND ITM.LNE_ITM_SEQ_NBR   = :EPITM-LNE-ITM-SEQ-NBR, WE    00387082
251411* PICKED UP JUST THE MARKETPLACE ITEM. ALSO FIXED THE FINAL TOTAL 00389082
251411* FOR THE SHIPPING CHARGE AMOUNT.                                 00389182
251536******************************************************************00389293
251536* DATE: 11-25-2020                      CHG#: CHG0251536          00389393
251536* WHO: BARB SCHULTZ                                               00389493
251536* WHY: THE KOHLS CASH DISCOUNT ON MARKETPLACE RETURNS WAS NOT     00389593
251536* BEING PICKED UP.  I ADDED LID_RSN_CDE '780' TO THE TEPLID       00389693
251536* CURSOR.  ALSO I ADDED CODE TO THE PROCEDURE DIVISION TO ADD     00389793
251536* THIS TO THE KOHLS CASH COLUMN. I ALSO DELETED THE LID_TYP_CDE   00389893
251536* K BECAUSE IT WAS NOT BEING USED IN THE PROGRAM.                 00389993
251972******************************************************************00391099
251972* DATE: 12-14-2020                     CHG#: CHG0251972           00392099
251972* WHO: BARB SCHULTZ                                               00393099
251972* WHY: THE YES WE CAN DISCOUNT ON MARKETPLACE SALES AND RETURNS   00394099
251972* WAS NOT BEING PICKED UP AND SHOWN ON THE REPORT. I ADDED        00394199
251972* LID_RSN_CDE '709' TO THE TEPLID CURSOR.  ALSO I ADDED CODE TO   00395099
251972* THE PROCEDURE DIVISION TO ADD THIS TO THE KOHLS CASH COLUMN.    00396099
254534******************************************************************00397099
254534* DATE: 03-09-2021                     CHG#: CHG0254534           00398099
254534* WHO: BARB SCHULTZ                                               00398199
254534* WHY: ADDED THE REVERSAL OF A SALE BY ADDING THE UNCORRECTED -   00398299
254534* 'U' VOID_ABRT_CDE TO THE CURSOR. THE RETURN THEN SHOWED UP ON   00398399
254534* THE REPORT.  ALSO ADDED A SECTION OF CODE TO BRING IN THE       00398499
254534* PRORATED PERCENTAGE OFF FROM TEPLID. THIS IS NOW IN THE %DISC   00398599
254534* COLUMN.  DELETED THE FEES COLUMN AND REPLACED IT WITH THE %DISC 00398699
254534* COLUMN.  DELETED THE TEPLIS CURSOR AND THE PARAGRAPHS THAT WENT 00398799
254534* WITH GETTING THE FEES.                                          00398899
000100******************************************************************00399094
000101***************************************************************** 00400074
000102 ENVIRONMENT DIVISION.                                            00410074
000103***************************************************************** 00420074
000104                                                                  00430074
000105 CONFIGURATION SECTION.                                           00440074
000106                                                                  00450074
000107 SOURCE-COMPUTER.        IBM-3090.                                00460074
000108                                                                  00470074
000109 OBJECT-COMPUTER.        IBM-3090.                                00480074
000110                                                                  00490074
000111 INPUT-OUTPUT SECTION.                                            00500074
000112                                                                  00510074
000113 FILE-CONTROL.                                                    00520074
000114                                                                  00530074
000115     SELECT POS-DATE-CARD-FILE                                    00540074
000116         ASSIGN TO INP01.                                         00550074
000117                                                                  00560074
000118     SELECT SALES-REPORT-FILE                                     00570074
000119         ASSIGN TO RPT01.                                         00580074
000120                                                                  00590074
000121******************************************************************00600074
000122 DATA DIVISION.                                                   00610074
000123******************************************************************00620074
000124                                                                  00630074
000125 FILE SECTION.                                                    00640074
000126                                                                  00650074
000127 FD  POS-DATE-CARD-FILE                                           00660074
000128     RECORDING MODE IS F                                          00670074
000129     BLOCK CONTAINS 0 RECORDS                                     00680074
000130     LABEL RECORDS ARE STANDARD.                                  00690074
000131                                                                  00700074
000132 01  POS-DATE-CARD-RECORD            PIC X(80).                   00710074
000133                                                                  00720074
000134 FD  SALES-REPORT-FILE                                            00730074
000135     RECORDING MODE IS F                                          00740074
000136     BLOCK CONTAINS 0  RECORDS.                                   00750074
000137                                                                  00760074
FIXDSC 01  SALES-REPORT-RECORD             PIC X(150).                  00770074
000139                                                                  00780074
000140******************************************************************00790074
000141 WORKING-STORAGE SECTION.                                         00800074
000142******************************************************************00810074
000143 01  FILLER                            PIC X(50)  VALUE           00820074
000144     ' *** WORKING STORAGE STARTS HERE FOR SAKRP101 *** '.        00830074
000145                                                                  00840074
000146******************************************************************00850074
000147* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                    00860074
000148******************************************************************00870074
000149 01  CC-CONTROL-CARD.                                             00880074
000150     05  CC-CONTROL-CARD-DISPLAY.                                 00890074
000151         10  CC-BEGIN-DATE       PIC X(10)    VALUE SPACES.       00900074
000152         10  FILLER              PIC X        VALUE SPACE.        00910074
000153         10  CC-END-DATE         PIC X(10)    VALUE ZERO.         00920074
000154     05  FILLER                  PIC X(59)    VALUE SPACE.        00930074
000155 01  DATE-CONTROL-CARD.                                           00940074
000155     05  CC-WEEK-ENDING-DATE-ISO.                                 00950074
000155         10  CC-WEEK-ENDING-CC   PIC X(02).                       00960074
000155         10  CC-WEEK-ENDING-YY   PIC X(02).                       00970074
000155         10  FILLER              PIC X(01).                       00980074
000155         10  CC-WEEK-ENDING-MM   PIC X(02).                       00990074
000155         10  FILLER              PIC X(01).                       01000074
000155         10  CC-WEEK-ENDING-DD   PIC X(02).                       01010074
000155     05  FILLER                  PIC X(70).                       01020074
000155                                                                  01030074
000156******************************************************************01040074
000157*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01050074
000158******************************************************************01060074
000159     COPY DPWS500.                                                01070074
000160                                                                  01080074
000161 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01090074
000162                                                  COMP SYNC.      01100074
000163     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01110074
000164     88  AC-DB2-ERROR                             VALUE +4013.    01120074
000165     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    01130074
000166                                                                  01140074
000167 01  PS-PROGRAM-SWITCHES.                                         01150074
000168     05  PS-END-OF-ITEM                PIC X(01)  VALUE 'N'.      01160074
000169         88  PS-END-OF-ITEM-YES                   VALUE 'Y'.      01170074
000170         88  PS-END-OF-ITEM-NO                    VALUE 'N'.      01180074
000171     05  PS-END-OF-LID-CURSOR          PIC X(01)  VALUE 'N'.      01190074
000172         88  PS-END-OF-LID-YES                    VALUE 'Y'.      01200074
000173         88  PS-END-OF-LID-NO                     VALUE 'N'.      01210074
FIXDSC     05  PS-END-OF-EID-CURSOR          PIC X(01)  VALUE 'N'.      01220074
FIXDSC         88  PS-END-OF-EID-YES                    VALUE 'Y'.      01230074
FIXDSC         88  PS-END-OF-EID-NO                     VALUE 'N'.      01240074
000174     05  PS-FIRST-TIME-SW              PIC X(01)  VALUE 'Y'.      01280074
000175         88  PS-FIRST-TIME                        VALUE 'Y'.      01290074
000176         88  PS-FIRST-TIME-NO                     VALUE 'N'.      01300074
000177     05  PS-END-OF-CARD-FILE           PIC X(01)  VALUE 'N'.      01310074
000178         88  PS-END-OF-CARD-FILE-YES              VALUE 'Y'.      01320074
FIXDSC     05  PS-ORDER-NUMBER-IND           PIC X(01)  VALUE 'N'.      01330074
FIXDSC         88  PS-ORDER-NUMBER-FOUND-Y              VALUE 'Y'.      01340074
FIXDSC         88  PS-ORDER-NUMBER-FOUND-N              VALUE 'N'.      01350074
000179                                                                  01360074
000180 01  PC-CONSTANTS.                                                01370074
000181     05  PC-NOT-FOUND                PIC S9(04)    VALUE +100.    01380074
000182     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01390074
000183                                     'SAKRP101'.                  01400074
000184     05  PC-REPORT-NBR-1             PIC 9(1)      VALUE 1.       01410074
000185                                                                  01420074
000186 01  PV-MISC-FIELDS.                                              01430074
000187     05  PV-LINE-SPACING             PIC  9        VALUE 1.       01440074
000188     05  PV-LINE-CNT                 PIC  9(03)    VALUE ZERO.    01450074
FIXDSC     05  PV-TOTAL-LINES              PIC  9(05)    VALUE ZERO.    01460074
000189     05  PV-PAGE-CNT                 PIC  9(04)    VALUE ZERO.    01470074
FIXDSC     05  PV-PRINT-RECORD             PIC  X(150)   VALUE SPACE.   01480074
000191     05  PV-LINE-SEQ-NBR             PIC  9(03)    VALUE ZERO.    01490074
000192     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   01500074
000193     05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACE.   01510074
000194     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   01520074
000195     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   01530074
000196     05  PV-SUBTOTAL                 PIC  9(7).99- VALUE ZERO.    01540074
000197     05  PV-TOTAL-SALES-AMT          PIC S9(7)V99  VALUE ZERO.    01550074
000198     05  PV-TOTAL-RTN-AMT            PIC S9(7)V99  VALUE ZERO.    01560074
000199     05  PV-TOTAL-SALES-TX-AMT       PIC S9(7)V99  VALUE ZERO.    01570074
000200     05  PV-TOTAL-RTN-TX-AMT         PIC S9(7)V99  VALUE ZERO.    01580074
000201     05  PV-TOTAL-AMT                PIC S9(7)V99  VALUE ZERO.    01590074
000202     05  PV-TOTAL-NET-CHRGD-AMT      PIC S9(7)V99  VALUE ZERO     01600074
000203                                                   COMP-3.        01610074
000204     05  PV-TOTAL-TX-AMT             PIC S9(7)V99  VALUE ZERO     01620074
000205                                                   COMP-3.        01630074
000204     05  PV-TX-AMT                   PIC S9(7)V99  VALUE ZERO.    01640074
FIXDSC     05  PV-EMP-DISC-AMT             PIC S9(7)V99  VALUE ZERO.    01650074
MKTPLC     05  PV-TEPSHP-SHIP-CHRG-AMT     PIC S9(7)V99  VALUE ZERO     01660074
MKTPLC                                                   COMP-3.        01670074
251536     05  PV-KOHLS-CASH               PIC S9(7)V99  VALUE ZERO     01671093
251536                                                   COMP-3.        01672093
251972     05  PV-RWD-AMT                  PIC S9(7)V99  VALUE ZERO     01673099
251972                                                   COMP-3.        01674099
000204     05  PV-TEPSHP-TX-AMT            PIC S9(7)V99  VALUE ZERO     01680074
000207                                                   COMP-3.        01690074
MKTPLC     05  PV-GIFT-SALE                PIC S9(7)V99  VALUE ZERO.    01700074
MKTPLC     05  PV-GIFT-RTN                 PIC S9(7)V99  VALUE ZERO.    01710074
254534     05  PV-RTN-DISC                 PIC S9(7)V99  VALUE ZERO.    01741099
254534     05  PV-SALE-DISC                PIC S9(7)V99  VALUE ZERO.    01742099
254534     05  PV-DISC                     PIC S9(7)V99  VALUE ZERO.    01743099
MKTPLC     05  PV-SHP-RTN-AMT              PIC S9(7)V99  VALUE ZERO.    01750074
MKTPLC     05  PV-SHP-RTN-TX-AMT           PIC S9(7)V99  VALUE ZERO.    01760074
                                                                        01770074
000206     05  PV-SUM-TOTAL                PIC S9(7)V99  VALUE ZERO     01780074
000207                                                   COMP-3.        01790074
000208     05  PV-TOTAL-SALES              PIC S9(7)V99  VALUE ZERO.    01800074
000209     05  PV-TOTAL-RETURNS            PIC S9(7)V99  VALUE ZERO.    01810074
000210     05  PV-STR-TOT-SALES-AMT        PIC S9(7)V99  VALUE ZERO.    01820074
000211     05  PV-STR-TOT-RTN-AMT          PIC S9(7)V99  VALUE ZERO.    01830074
000212     05  PV-STR-TOT-SALES-TX-AMT     PIC S9(7)V99  VALUE ZERO.    01840074
000213     05  PV-STR-TOT-RTN-TX-AMT       PIC S9(7)V99  VALUE ZERO.    01850074
000214     05  PV-STR-SALES                PIC S9(7)V99  VALUE ZERO.    01860074
000215     05  PV-STR-RETURNS              PIC S9(7)V99  VALUE ZERO.    01870074
000216     05  PV-STR-TOTAL-AMT            PIC S9(7)V99  VALUE ZERO.    01880074
000217     05  PV-DET-TOTAL-AMT            PIC S9(7)V99  VALUE ZERO.    01890074
000218     05  PV-HOLD-STR-NBR             PIC  9(04)    VALUE ZERO.    01900074
000219     05  PV-HOLD-PARTN-NBR           PIC  9(04)    VALUE ZERO.    01910074
000220     05  PV-HOLD-TRN-TYP-CDE         PIC  X(02)    VALUE SPACES.  01920074
FIXDSC     05  PV-STR-TOT-RWD-AMT          PIC S9(7)V99  VALUE ZERO.    01930074
FIXDSC     05  PV-STR-TOT-KOHLS-CASH       PIC S9(7)V99  VALUE ZERO.    01940074
FIXDSC     05  PV-STR-TOT-ASSOC-DSC        PIC S9(7)V99  VALUE ZERO.    01950074
FIXDSC     05  PV-STR-TOT-SHIP-CHRG-AMT    PIC S9(7)V99  VALUE ZERO.    01960074
FIXDSC     05  PV-STR-TOT-SHIP-TX-AMT      PIC S9(7)V99  VALUE ZERO.    01970074
254534     05  PV-STR-TOT-DISC             PIC S9(7)V99  VALUE ZERO.    01981099
FIXDSC     05  PV-STR-TOT-NET-CHRGD-AMT    PIC S9(7)V99  VALUE ZERO.    01990074
FIXDSC     05  PV-STR-TOT-TX-AMT           PIC S9(5)V99  VALUE ZERO.    02000074
FIXDSC     05  PV-STR-TOT-TOTAL-AMT        PIC S9(7)V99  VALUE ZERO.    02010074
FIXDSC     05  PV-TOT-RWD-AMT              PIC S9(7)V99  VALUE ZERO.    02020074
FIXDSC     05  PV-TOT-KOHLS-CASH           PIC S9(7)V99  VALUE ZERO.    02030074
FIXDSC     05  PV-TOT-ASSOC-DSC            PIC S9(7)V99  VALUE ZERO.    02040074
FIXDSC     05  PV-TOT-SHIP-CHRG-AMT        PIC S9(7)V99  VALUE ZERO.    02050074
FIXDSC     05  PV-TOT-SHIP-TX-AMT          PIC S9(7)V99  VALUE ZERO.    02060074
254534     05  PV-TOT-DISC                 PIC S9(7)V99  VALUE ZERO.    02071099
FIXDSC     05  PV-TOT-NET-CHRGD-AMT        PIC S9(7)V99  VALUE ZERO.    02080074
FIXDSC     05  PV-TOT-TX-AMT               PIC S9(7)V99  VALUE ZERO.    02090074
FIXDSC     05  PV-TOT-TOTAL-AMT            PIC S9(7)V99  VALUE ZERO.    02100074
TOTALS     05  PV-STR-RTN-KOHLS-CASH       PIC S9(7)V99  VALUE ZERO.    02110074
TOTALS     05  PV-TOT-RTN-KOHLS-CASH       PIC S9(7)V99  VALUE ZERO.    02120074
TOTALS     05  PV-STR-SALE-KOHLS-CASH      PIC S9(7)V99  VALUE ZERO.    02130074
TOTALS     05  PV-TOT-SALE-KOHLS-CASH      PIC S9(7)V99  VALUE ZERO.    02140074
TOTALS     05  PV-STR-RTN-RWD-AMT          PIC S9(7)V99  VALUE ZERO.    02150074
TOTALS     05  PV-TOT-RTN-RWD-AMT          PIC S9(7)V99  VALUE ZERO.    02160074
TOTALS     05  PV-STR-SALE-RWD-AMT         PIC S9(7)V99  VALUE ZERO.    02170074
TOTALS     05  PV-TOT-SALE-RWD-AMT         PIC S9(7)V99  VALUE ZERO.    02180074
TOTALS     05  PV-STR-RTN-EMPD-AMT         PIC S9(7)V99  VALUE ZERO.    02190074
TOTALS     05  PV-TOT-RTN-EMPD-AMT         PIC S9(7)V99  VALUE ZERO.    02200074
TOTALS     05  PV-STR-SALE-EMPD-AMT        PIC S9(7)V99  VALUE ZERO.    02210074
TOTALS     05  PV-TOT-SALE-EMPD-AMT        PIC S9(7)V99  VALUE ZERO.    02220074
254534     05  PV-STR-RDISC                 PIC S9(7)V99  VALUE ZERO.   02261099
254534     05  PV-STR-SDISC                 PIC S9(7)V99  VALUE ZERO.   02262099
254534     05  PV-TOT-RDISC                 PIC S9(7)V99  VALUE ZERO.   02263099
254534     05  PV-TOT-SDISC                 PIC S9(7)V99  VALUE ZERO.   02264099
000221                                                                  02270074
000222     05  PV-BEG-CCYY-MM-DD           PIC  X(10)    VALUE SPACE.   02280074
000223     05  FILLER REDEFINES PV-BEG-CCYY-MM-DD.                      02290074
000224         10  PV-BEG-CCYY             PIC  X(04).                  02300074
000225         10  FILLER                  PIC  X(01).                  02310074
000226         10  PV-BEG-MM               PIC  X(02).                  02320074
000227         10  FILLER                  PIC  X(01).                  02330074
000228         10  PV-BEG-DD               PIC  X(02).                  02340074
000229     05  PV-END-CCYY-MM-DD           PIC  X(10)    VALUE SPACE.   02350074
000230     05  FILLER REDEFINES PV-END-CCYY-MM-DD.                      02360074
000231         10  PV-END-CCYY             PIC  X(04).                  02370074
000232         10  FILLER                  PIC  X(01).                  02380074
000233         10  PV-END-MM               PIC  X(02).                  02390074
000234         10  FILLER                  PIC  X(01).                  02400074
000235         10  PV-END-DD               PIC  X(02).                  02410074
000236     05  PV-SALES-DATE.                                           02420074
000237         10  PV-SALES-MM             PIC  X(02)   VALUE SPACE.    02430074
000238         10  FILLER                  PIC  X(01)    VALUE '/'.     02440074
000239         10  PV-SALES-DD             PIC  X(02)    VALUE SPACE.   02450074
000240         10  FILLER                  PIC  X(01)    VALUE '/'.     02460074
000241         10  PV-SALES-CCYY           PIC  X(04)    VALUE SPACE.   02470074
000242     05  PV-CURR-DATE-CCYYMMDD.                                   02480074
000243         10  PV-CURR-DATE-CCYY       PIC  9(04).                  02490074
000244         10  PV-CURR-DATE-MM         PIC  9(02).                  02500074
000245         10  PV-CURR-DATE-DD         PIC  9(02).                  02510074
000246     05  PV-CURR-TIME.                                            02520074
000247         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    02530074
000248         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    02540074
000249         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    02550074
000250                                                                  02560074
000251******************************************************************02570074
000252*  TOP OF PAGE HEADING LINE FOR PRINTING A 132 CHARACTER REPORT.  02580074
000253******************************************************************02590074
FIXDSC*    COPY DPWS132.                                                02600074
FIXDSC                                                                  02610074
FIXDSC******************************************************************02620074
FIXDSC*  TOP OF PAGE HEADING LINE FOR PRINTING A 150 CHARACTER REPORT.  02630074
FIXDSC******************************************************************02640074
FIXDSC     COPY DPWS150.                                                02650074
FIXDSC                                                                  02660074
000256******************************************************************02670074
000257*  HEADING LINES FOR THE MARKETPLACE REPORT.                      02680074
000258******************************************************************02690074
000259 01  H1-HEADING-LINE-1.                                           02700074
FIXDSC     05  FILLER                      PIC  X(48)    VALUE SPACE.   02710074
000261     05  FILLER                      PIC  X(12)    VALUE          02720074
000262                                          'MARKETPLACE '.         02730074
000263     05  FILLER                      PIC  X(07)    VALUE          02740074
000264                                          'REPORT '.              02750074
000265     05  FILLER                      PIC  X(04)    VALUE 'FOR '.  02760074
000266     05  FILLER                      PIC  X(6)     VALUE          02770074
000267                                          'SALES '.               02780074
000268     05  H1-BEGIN-DATE.                                           02790074
000269         10  H1-BEG-MM               PIC  X(02)    VALUE SPACE.   02800074
000270         10  FILLER                  PIC  X(01)    VALUE '/'.     02810074
000271         10  H1-BEG-DD               PIC  X(02)    VALUE SPACE.   02820074
000272         10  FILLER                  PIC  X(01)    VALUE '/'.     02830074
000273         10  H1-BEG-CCYY             PIC  X(04)    VALUE SPACE.   02840074
000274     05  FILLER                      PIC  X(06)    VALUE ' THRU '.02850074
000275     05  H1-END-DATE.                                             02860074
000276         10  H1-END-MM               PIC  X(02)    VALUE SPACE.   02870074
000277         10  FILLER                  PIC  X(01)    VALUE '/'.     02880074
000278         10  H1-END-DD               PIC  X(02)    VALUE SPACE.   02890074
000279         10  FILLER                  PIC  X(01)    VALUE '/'.     02900074
000280         10  H1-END-CCYY             PIC  X(04)    VALUE SPACE.   02910074
000281     05  FILLER                      PIC  X(12)    VALUE SPACE.   02920074
000282                                                                  02930074
000283 01  H2-HEADING-LINE-2.                                           02940074
000284     05  FILLER                      PIC  X(2)     VALUE SPACES.  02950074
000285     05  FILLER                      PIC  X(5)     VALUE          02960074
000286                                                        'STORE'.  02970074
000287     05  FILLER                      PIC  X(1)     VALUE SPACES.  02980074
000288     05  FILLER                      PIC  X(4)     VALUE 'RGST'.  02990074
000289     05  FILLER                      PIC  X(2)     VALUE SPACES.  03000074
000290     05  FILLER                      PIC  X(4)     VALUE 'TRAN'.  03010074
000291     05  FILLER                      PIC  X(2)     VALUE SPACES.  03020074
000292     05  FILLER                      PIC  X(4)     VALUE ' SEQ'.  03030074
000293     05  FILLER                      PIC  X(2)     VALUE SPACES.  03040074
000294     05  FILLER                      PIC  X(3)     VALUE 'TYP'.   03050074
FIXDSC     05  FILLER                      PIC  X(4)     VALUE SPACES.  03060074
FIXDSC     05  FILLER                      PIC  X(6)     VALUE 'ORDER '.03070074
FIXDSC     05  FILLER                      PIC  X(8)     VALUE SPACES.  03080074
000296     05  FILLER                      PIC  X(4)     VALUE 'MDSE'.  03090074
000297     05  FILLER                      PIC  X(7)     VALUE SPACES.  03100074
000298     05  FILLER                      PIC  X(3)     VALUE 'QTY'.   03110074
000299     05  FILLER                      PIC  X(1)     VALUE SPACES.  03120074
000300     05  FILLER                      PIC  X(7)     VALUE          03130074
251972                                          'RWD/YWC'.              03140099
000301     05  FILLER                      PIC  X(3)     VALUE SPACES.  03150074
000302     05  FILLER                      PIC  X(8)     VALUE          03160074
000302                                          'KOHL CSH'.             03170074
000303     05  FILLER                      PIC  X(4)     VALUE SPACES.  03180074
000303     05  FILLER                      PIC  X(6) VALUE 'ASCDSC'.    03190074
000303     05  FILLER                      PIC  X(2)     VALUE SPACES.  03200074
000537     05  FILLER                      PIC  X(7)     VALUE          03210074
000537                                          'SHP AMT'.              03220074
000339     05  FILLER                      PIC  X(2)     VALUE SPACES.  03230074
000537     05  FILLER                      PIC  X(6)  VALUE             03240074
000537                                          'SHP TX'.               03250074
254534     05  FILLER                      PIC  X(4)     VALUE SPACES.  03280299
254534     05  FILLER                      PIC  X(5)  VALUE             03281099
254534                                          '%DISC'.                03282099
000305     05  FILLER                      PIC  X(4)     VALUE SPACES.  03290099
000306     05  FILLER                      PIC  X(7)     VALUE          03300074
000307                                          'NET AMT'.              03310074
000308     05  FILLER                      PIC  X(3)    VALUE SPACES.   03320074
000309     05  FILLER                      PIC  X(6)     VALUE          03330074
000310                                          'TX AMT'.               03340074
000311     05  FILLER                      PIC  X(4)     VALUE SPACES.  03350074
000312     05  FILLER                      PIC  X(9)     VALUE          03360074
000313                                          'TOTAL AMT'.            03370074
000314                                                                  03380074
000315******************************************************************03390074
000316*  DETAIL LINE.                                                   03400074
000317******************************************************************03410074
000318 01  D1-DETAIL-LINE-1.                                            03420074
000319     05  FILLER                      PIC  XX       VALUE SPACES.  03430074
000320     05  D1-STR-NBR                  PIC  9(4)     VALUE ZERO.    03440074
000321     05  FILLER                      PIC  XX       VALUE SPACES.  03450074
000322     05  D1-RGST-ID                  PIC  9(4)     VALUE ZERO.    03460074
000323     05  FILLER                      PIC  XX       VALUE SPACES.  03470074
000324     05  D1-TRN-NBR                  PIC  9(4)     VALUE ZERO.    03480074
000325     05  FILLER                      PIC  XX       VALUE SPACES.  03490074
000326     05  D1-SEQ-NBR                  PIC  X(5)     VALUE SPACES.  03500074
000327     05  FILLER                      PIC  XX       VALUE SPACES.  03510074
000328     05  D1-TRN-TYP-CDE              PIC  XX       VALUE SPACES.  03520074
000329     05  FILLER                      PIC  X        VALUE SPACES.  03530074
FIXDSC     05  D1-ORD-NBR                  PIC  X(10)    VALUE SPACES.  03540074
FIXDSC     05  FILLER                      PIC  X(1)     VALUE SPACES.  03550074
000330     05  D1-MDSE-ID                  PIC  9(15)    VALUE ZERO.    03560074
000331     05  FILLER                      PIC  X(1)     VALUE SPACES.  03570074
000332     05  D1-SLD-QTY                  PIC  ZZZ-     VALUE ZERO.    03580074
000334     05  D1-RWD-AMT                  PIC ZZZZ.99-  VALUE ZERO.    03600099
000335     05  FILLER                      PIC  X(2)     VALUE SPACES.  03610074
000336     05  D1-KOHLS-CASH               PIC ZZZZ.99-  VALUE ZERO.    03620074
FIXDSC     05  FILLER                      PIC  X(3)     VALUE SPACES.  03630074
000338     05  D1-ASSOC-DSC                PIC ZZZZ.99-  VALUE ZERO.    03640074
000339     05  FILLER                      PIC  X(4)     VALUE SPACES.  03650074
000537     05  D1-SHIP-CHRG-AMT            PIC  ZZ.99-   VALUE SPACES.  03660074
000339     05  FILLER                      PIC  X(2)     VALUE SPACES.  03670074
000537     05  D1-SHIP-TX-AMT              PIC  ZZ.99-   VALUE SPACES.  03680074
000339     05  FILLER                      PIC  X        VALUE SPACES.  03690074
254534     05  D1-DISC                     PIC  ZZZ.99-  VALUE SPACES.  03701099
000339     05  FILLER                      PIC  X        VALUE SPACES.  03710074
000340     05  D1-NET-CHRGD-AMT            PIC  ZZ,ZZZ.99- VALUE ZERO.  03720074
000341     05  FILLER                      PIC  X        VALUE SPACES.  03730074
000342     05  D1-TX-AMT                   PIC  ZZZZ.99- VALUE ZERO.    03740074
000343     05  FILLER                      PIC  XXX      VALUE SPACES.  03750074
000344     05  D1-TOTAL-AMT                PIC  ZZ,ZZZ.99- VALUE ZERO.  03760074
000345                                                                  03770074
TOTALS******************************************************************03780074
TOTALS*  SALES TOTAL LINE                                               03790074
TOTALS******************************************************************03800074
TOTALS 01  T1-SALE-TOTAL-LINE.                                          03810074
TOTALS     05  FILLER                      PIC  X(01)    VALUE SPACES.  03820074
TOTALS     05  FILLER                      PIC  X(26)                   03830074
TOTALS                              VALUE 'STORE SALE DISCOUNT TOTALS'. 03840074
TOTALS     05  FILLER                      PIC  X(34)    VALUE SPACES.  03850074
TOTALS     05  T1-SRWD-AMT                 PIC ZZZZ.99-  VALUE ZERO.    03860074
TOTALS     05  T1-SKOHLS-CASH              PIC ZZZZZZ.99-  VALUE ZERO.  03870074
TOTALS     05  FILLER                      PIC  X(01)    VALUE SPACES.  03880074
TOTALS     05  T1-SASSOC-DSC               PIC ZZZZZZ.99- VALUE ZERO.   03890074
TOTALS     05  FILLER                      PIC  X(18)    VALUE SPACES.  03900074
254534     05  T1-SDISC                    PIC ZZZZ.99-  VALUE SPACES.  03911099
TOTALS     05  FILLER                      PIC  X(33)    VALUE SPACES.  03920074
TOTALS                                                                  03930074
TOTALS******************************************************************03940074
TOTALS*  RETURN TOTAL LINE                                              03950074
TOTALS******************************************************************03960074
TOTALS 01  T1-RETURN-TOTAL-LINE.                                        03970074
TOTALS     05  FILLER                      PIC  X(01)    VALUE SPACES.  03980074
TOTALS     05  FILLER                      PIC  X(25)                   03990074
TOTALS                               VALUE 'STORE RTN DISCOUNT TOTALS'. 04000074
TOTALS     05  FILLER                      PIC  X(35)    VALUE SPACES.  04010074
TOTALS     05  T1-RRWD-AMT                 PIC ZZZZ.99-  VALUE ZERO.    04020074
TOTALS     05  T1-RKOHLS-CASH              PIC ZZZZZZ.99-  VALUE ZERO.  04030074
TOTALS     05  FILLER                      PIC  X(01)    VALUE SPACES.  04040074
TOTALS     05  T1-RASSOC-DSC               PIC ZZZZZZ.99- VALUE ZERO.   04050074
TOTALS     05  FILLER                      PIC  X(18)    VALUE SPACES.  04060074
254534     05  T1-RDISC                    PIC ZZZZ.99-  VALUE SPACES.  04071099
TOTALS     05  FILLER                      PIC  X(33)    VALUE SPACES.  04080074
TOTALS                                                                  04090074
TOTALS******************************************************************04100074
TOTALS*  FINAL TOTAL DISCOUNT LINE                                      04110074
TOTALS******************************************************************04120074
TOTALS 01  T1-FINAL-TOTAL-LINE.                                         04130074
TOTALS     05  FILLER                      PIC  X(01)    VALUE SPACES.  04140074
TOTALS     05  T1-FINAL-DESC               PIC  X(25)    VALUE SPACES.  04150074
TOTALS     05  FILLER                      PIC  X(35)    VALUE SPACES.  04160074
TOTALS     05  T1-TOT-RWD-AMT              PIC ZZZZ.99-  VALUE ZERO.    04170074
TOTALS     05  T1-TOT-KOHLS-CASH           PIC ZZZZZZ.99-  VALUE ZERO.  04180074
TOTALS     05  FILLER                      PIC  X(01)    VALUE SPACES.  04190074
TOTALS     05  T1-TOT-ASSOC-DSC            PIC ZZZZZZ.99- VALUE ZERO.   04200074
TOTALS     05  FILLER                      PIC  X(18)    VALUE SPACES.  04210074
254534     05  T1-TOT-DISC                 PIC ZZZZ.99-  VALUE SPACES.  04221099
TOTALS                                                                  04240074
FIXDSC******************************************************************04250074
FIXDSC*  TOTAL LINE                                                     04260074
FIXDSC******************************************************************04270074
FIXDSC 01  T1-TOTAL-LINE.                                               04280074
FIXDSC     05  FILLER                      PIC  X(01)    VALUE SPACES.  04290074
FIXDSC     05  T1-TOTAL-DESC               PIC  X(19)    VALUE SPACES.  04300074
FIXDSC     05  FILLER                      PIC  X(41)    VALUE SPACES.  04310074
FIXDSC     05  T1-RWD-AMT                  PIC ZZZZ.99-  VALUE ZERO.    04320074
FIXDSC     05  T1-KOHLS-CASH               PIC ZZZZZZ.99-  VALUE ZERO.  04330074
FIXDSC     05  FILLER                      PIC  X(01)    VALUE SPACES.  04340074
FIXDSC     05  T1-ASSOC-DSC                PIC ZZZZZZ.99- VALUE ZERO.   04350074
FIXDSC     05  FILLER                      PIC X(02)     VALUE SPACES.  04360074
FIXDSC     05  T1-SHIP-CHRG-AMT            PIC ZZZZ.99-  VALUE ZERO.    04370074
FIXDSC     05  T1-SHIP-TX-AMT              PIC ZZZZ.99-  VALUE ZERO.    04380074
254534     05  T1-DISC                     PIC ZZZZ.99-  VALUE ZEROES.  04391099
FIXDSC     05  T1-NET-CHRGD-AMT            PIC ZZZZ,ZZZ.99- VALUE ZERO. 04400074
FIXDSC     05  T1-TX-AMT                   PIC ZZZZZ.99- VALUE ZERO.    04410074
FIXDSC     05  T1-TOTAL-AMT                PIC ZZZZ,ZZZ.99- VALUE ZERO. 04420074
000345                                                                  04430074
000346******************************************************************04440074
000347*  DETAIL LINE.                                                   04450074
000348******************************************************************04460074
000349 01  D2-DETAIL-LINE-2.                                            04470074
000350     05  FILLER                      PIC  X(2)     VALUE SPACES.  04480074
000351     05  FILLER                      PIC  X(3)     VALUE 'STR'.   04490074
000352     05  FILLER                      PIC  X        VALUE SPACES.  04500074
000353     05  D2-STR-NBR                  PIC  9(4)     VALUE ZERO.    04510074
000354     05  FILLER                      PIC  X(2)     VALUE SPACES.  04520074
000355     05  FILLER                      PIC  X(4)     VALUE 'SLS'.   04530074
000356     05  FILLER                      PIC  X(6)     VALUE          04540074
000357                                                   'AMT = '.      04550074
000358     05  D2-SALES-AMT                PIC ZZZ,ZZZ.99-.             04560074
000359     05  FILLER                      PIC  X(1)     VALUE SPACES.  04570074
000360     05  FILLER                      PIC  X(4)     VALUE 'SLS '.  04580074
000361     05  FILLER                      PIC  X(9)     VALUE          04590074
000362                                       'TX AMT = '.               04600074
000363     05  D2-SALES-TX-AMT             PIC ZZZZZ.99-.               04610074
000364     05  FILLER                      PIC  X(1)     VALUE SPACES.  04620074
000365     05  FILLER                      PIC  X(4)     VALUE          04630074
000366                                                   'RTN '.        04640074
000367     05  FILLER                      PIC  X(6)     VALUE          04650074
000368                                                   'AMT = '.      04660074
000369     05  D2-RETURNS-AMT              PIC ZZZ,ZZZ.99-.             04670074
000370     05  FILLER                      PIC  X(1)     VALUE SPACES.  04680074
000371     05  FILLER                      PIC  X(4)     VALUE 'RTN '.  04690074
000372     05  FILLER                      PIC  X(9)     VALUE          04700074
000373                                       'TX AMT = '.               04710074
000374     05  D2-RETURNS-TAX-AMT          PIC ZZZZZ.99-.               04720074
000375     05  FILLER                      PIC  X(1)     VALUE SPACES.  04730074
000376     05  FILLER                      PIC  X(6)     VALUE 'TOTAL '.04740074
000377     05  FILLER                      PIC  X(6)     VALUE 'AMT = '.04750074
000378     05  D2-STR-TOT-AMT              PIC ZZZZZ,ZZZ.99-.           04760074
000379                                                                  04770074
000380******************************************************************04780074
000381*  DETAIL TOTAL LINE                                              04790074
000382******************************************************************04800074
000383 01  D3-DETAIL-LINE-3.                                            04810074
000384     05  FILLER                      PIC  X        VALUE SPACE.   04820074
000385     05  FILLER                      PIC  X(4)     VALUE 'TOT '.  04830074
000386     05  FILLER                      PIC  X(4)     VALUE 'SLS '.  04840074
000387     05  FILLER                      PIC  X(8)     VALUE          04850074
000388                                                   'AMT = '.      04860074
000389     05  D3-SALES-AMT                PIC ZZZ,ZZZ.99-.             04870074
000390     05  FILLER                      PIC  X(2)     VALUE SPACES.  04880074
000391     05  FILLER                      PIC  X(4)     VALUE 'TOT '.  04890074
000392     05  FILLER                      PIC  X(4)     VALUE 'SLS '.  04900074
000393     05  FILLER                      PIC  X(9)     VALUE          04910074
000394                                       'TX AMT = '.               04920074
000395     05  D3-SALES-TX-AMT             PIC  ZZZZZ.99-.              04930074
000396     05  FILLER                      PIC  X(2)     VALUE SPACES.  04940074
000397     05  FILLER                      PIC  X(4)     VALUE 'TOT '.  04950074
000398     05  FILLER                      PIC  X(4)     VALUE          04960074
000399                                                   'RTN '.        04970074
000400     05  FILLER                      PIC  X(6)     VALUE          04980074
000401                                                   'AMT = '.      04990074
000402     05  D3-RETURNS-AMT              PIC ZZZZZZ.99-.              05000074
000403     05  FILLER                      PIC  X(2)     VALUE SPACES.  05010074
000404     05  FILLER                      PIC  X(4)     VALUE 'TOT '.  05020074
000405     05  FILLER                      PIC  X(4)     VALUE 'RTN '.  05030074
000406     05  FILLER                      PIC  X(9)     VALUE          05040074
000407                                       'TX AMT = '.               05050074
000408     05  D3-RETURNS-TAX-AMT          PIC ZZZZ9.99-.               05060074
000409     05  FILLER                      PIC  X(2)     VALUE SPACES.  05070074
000410     05  FILLER                      PIC  X(4)     VALUE 'TOT '.  05080074
000411     05  FILLER                      PIC  X(6)     VALUE 'AMT = '.05090074
000412     05  D3-TOT-AMT                  PIC  ZZZZZZ.99-.             05100074
000413                                                                  05110074
000414******************************************************************05120074
000415*  BLANK LINE.                                                    05130074
000416******************************************************************05140074
000417 01  D4-BLANK-LINE.                                               05150074
000418     05  FILLER                      PIC  X(150)   VALUE SPACES.  05160074
000419                                                                  05170074
000420******************************************************************05180074
000421*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            05190074
000422******************************************************************05200074
000423     COPY DPWS004.                                                05210074
000424                                                                  05220074
000425******************************************************************05230074
000426*  DB2 COMMUNICATION AREA.                                        05240074
000427******************************************************************05250074
000428     EXEC SQL                                                     05260074
000429          INCLUDE SQLCA                                           05270074
000430     END-EXEC.                                                    05280074
000431                                                                  05290074
000432******************************************************************05300074
000433*  DB2 TABLE TEPPART - COSA-PARTITIONING TABLE                    05310074
000434******************************************************************05320074
000435     EXEC SQL                                                     05330074
000436          INCLUDE TEPPART                                         05340074
000437     END-EXEC.                                                    05350074
000438                                                                  05360074
000439******************************************************************05370074
000440*  DB2 TABLE TEPTRN - COSA-TRANSACTION TABLE                      05380074
000441******************************************************************05390074
000442     EXEC SQL                                                     05400074
000443          INCLUDE TEPTRN                                          05410074
000444     END-EXEC.                                                    05420074
000445                                                                  05430074
000446******************************************************************05440074
000447*  DB2 TABLE TEPITM - COSA-ITEM TABLE                             05450074
000448******************************************************************05460074
000449     EXEC SQL                                                     05470074
000450          INCLUDE TEPITM                                          05480074
000451     END-EXEC.                                                    05490074
000452                                                                  05500074
FIXDSC******************************************************************05510074
FIXDSC*  DB2 TABLE TEPORD - COSA-ORDER TABLE                            05520074
FIXDSC******************************************************************05530074
FIXDSC     EXEC SQL                                                     05540074
FIXDSC          INCLUDE TEPORD                                          05550074
FIXDSC     END-EXEC.                                                    05560074
FIXDSC                                                                  05570074
000453******************************************************************05580074
000454*  DB2 TABLE TEPLID - COSA-LINE ITEM DISCOUNT                     05590074
000455******************************************************************05600074
000456     EXEC SQL                                                     05610074
000457          INCLUDE TEPLID                                          05620074
000458     END-EXEC.                                                    05630074
000459                                                                  05640074
FIXDSC******************************************************************05650074
FIXDSC*  DB2 TABLE TEPEID - EMPLOYEE ITEM DISCOUNT                      05660074
FIXDSC******************************************************************05670074
FIXDSC     EXEC SQL                                                     05680074
FIXDSC          INCLUDE TEPEID                                          05690074
FIXDSC     END-EXEC.                                                    05700074
FIXDSC                                                                  05710074
000459******************************************************************05720074
000459*  COSA SHIP TABLE                                                05730074
000459******************************************************************05740074
000459     EXEC SQL                                                     05750074
000459         INCLUDE TEPSHP                                           05760074
000459     END-EXEC.                                                    05770074
000459                                                                  05780074
000459******************************************************************05860074
000459*  COSA IPS TABLE                                                 05870074
000459******************************************************************05880074
000459     EXEC SQL                                                     05890074
000459         INCLUDE TEPIPS                                           05900074
000459     END-EXEC.                                                    05910074
000459                                                                  05920074
000460******************************************************************05930074
000470*  DB2 TABLE XST_LOC - STORE INFORMATION TABLE.                   05940074
000471*      WILL USE TO IDENTIFY E-STORE(S)                            05950074
000472******************************************************************05960074
000473     EXEC SQL                                                     05970074
000474          INCLUDE XST00001                                        05980074
000475     END-EXEC.                                                    05990074
000476                                                                  06000074
000477******************************************************************06010074
000478*  ITEM CURSOR (CURSOR TO PRODUCE THE REPORT)                     06020074
000479******************************************************************06030074
000480     EXEC SQL                                                     06040074
000481       DECLARE ITEM-CURSOR CURSOR FOR                             06050074
000482            SELECT C.PARTN_NBR                                    06060074
000483                 , C.STR_NBR                                      06070074
000484                 , C.RGST_ID                                      06080074
000485                 , C.TRN_NBR                                      06090074
000486                 , C.STRT_TM                                      06100074
000487                 , C.SLS_CORR_SEQ_NBR                             06110074
000488                 , C.LNE_ITM_SEQ_NBR                              06120074
000489                 , C.DEPT_NBR                                     06130074
000490                 , C.SLD_QTY                                      06140074
000491                 , C.NET_CHRGD_AMT                                06150074
000492                 , C.MDSE_ID                                      06160074
000493                 , C.TX_AMT                                       06170074
000494                 , B.TRN_TYP_CDE                                  06180074
000495                 , B.TRN_STAT_CDE                                 06190074
000496             FROM TEPPART A                                       06200074
000497                , TEPTRN  B                                       06210074
000498                , TEPITM  C                                       06220074
000498                , XST_LOC D                                       06230074
000500            WHERE A.PARTN_NBR        = B.PARTN_NBR                06240074
000501              AND A.PARTN_NBR        = C.PARTN_NBR                06250074
000502              AND B.STR_NBR          = D.LOC_NBR                  06260074
000503              AND B.STR_NBR          = C.STR_NBR                  06270074
000504              AND B.RGST_ID          = C.RGST_ID                  06280074
000505              AND B.TRN_NBR          = C.TRN_NBR                  06290074
000506              AND B.STRT_TM          = C.STRT_TM                  06300074
000507              AND B.SLS_CORR_SEQ_NBR = C.SLS_CORR_SEQ_NBR         06310074
000508              AND A.SLS_DTE BETWEEN :CC-BEGIN-DATE                06320074
000509                                AND :CC-END-DATE                  06330074
000510              AND A.DB_STRUC_CDE     = 'O'                        06340074
254534              AND B.VOID_ABRT_CDE   IN ('N', 'U')                 06350099
000512              AND B.TRN_STAT_CDE    IN ('V', 'Z', 'R', 'L')       06360074
000513              AND B.TRN_TYP_CDE     IN ('01', '02', '11', '12')   06370074
000515              AND C.DEPT_NBR         =  '985'                     06380074
000516              AND C.LIV_RSLU_CDE     IN ('+', '-')                06390074
000517          ORDER BY C.STR_NBR                                      06400074
000518                 , C.RGST_ID                                      06410074
000519                 , C.TRN_NBR                                      06420074
000520                 , C.LNE_ITM_SEQ_NBR                              06430074
000521                 , B.TRN_TYP_CDE                                  06440074
000522          WITH UR                                                 06450074
000523     END-EXEC.                                                    06460074
000524                                                                  06470074
000525******************************************************************06480074
000526*   LINE ITEM DISCOUNT CURSOR                                     06490074
000527******************************************************************06500074
000528     EXEC SQL                                                     06510074
000529       DECLARE LID-CURSOR CURSOR FOR                              06520074
000530         SELECT B.PARTN_NBR                                       06530074
000531              , B.STR_NBR                                         06540074
000532              , B.RGST_ID                                         06550074
000533              , B.TRN_NBR                                         06560074
000534              , B.STRT_TM                                         06570074
000535              , B.SLS_CORR_SEQ_NBR                                06580074
000536              , B.LNE_ITM_SEQ_NBR                                 06590074
000537              , B.LID_SEQ_NBR                                     06600074
000538              , B.LID_TYP_CDE                                     06610074
000539              , B.LID_RSN_CDE                                     06620074
000540              , B.LID_AMT                                         06630074
000542         FROM TEPLID  B                                           06640074
000543         WHERE B.PARTN_NBR        = :EPITM-PARTN-NBR              06650074
000544           AND B.STR_NBR          = :EPITM-STR-NBR                06660074
000545           AND B.RGST_ID          = :EPITM-RGST-ID                06670074
000546           AND B.TRN_NBR          = :EPITM-TRN-NBR                06680074
000547           AND B.STRT_TM          = :EPITM-STRT-TM                06690074
000548           AND B.SLS_CORR_SEQ_NBR = :EPITM-SLS-CORR-SEQ-NBR       06700074
000549           AND B.LNE_ITM_SEQ_NBR  = :EPITM-LNE-ITM-SEQ-NBR        06710074
251972           AND B.LID_RSN_CDE     IN ('733', '780', '709')         06740099
254534           AND B.LID_TYP_CDE     IN ('R', 'D', 'Q')               06741099
000556        WITH UR                                                   06750072
000557     END-EXEC.                                                    06760072
000558                                                                  06770072
FIXDSC******************************************************************06780072
FIXDSC*   EMPLOYEE DISCOUNT CURSOR                                      06790072
FIXDSC******************************************************************06800072
FIXDSC     EXEC SQL                                                     06810072
FIXDSC       DECLARE EID-CURSOR CURSOR FOR                              06820072
FIXDSC         SELECT EID.EMP_DISC_AMT                                  06830072
FIXDSC              , EID.EMP_DISC_CTG_CDE                              06840072
FIXDSC         FROM TEPEID EID                                          06850072
FIXDSC            , TEPITM ITM                                          06860072
FIXDSC         WHERE EID.PARTN_NBR         =:EPITM-PARTN-NBR            06870072
FIXDSC           AND EID.STR_NBR           =:EPITM-STR-NBR              06880072
FIXDSC           AND EID.RGST_ID           =:EPITM-RGST-ID              06890072
FIXDSC           AND EID.TRN_NBR           =:EPITM-TRN-NBR              06900072
FIXDSC           AND EID.STRT_TM           =:EPITM-STRT-TM              06910072
FIXDSC           AND EID.SLS_CORR_SEQ_NBR  =:EPITM-SLS-CORR-SEQ-NBR     06920072
FIXDSC           AND EID.LNE_ITM_SEQ_NBR   =:EPITM-LNE-ITM-SEQ-NBR      06930072
FIXDSC          WITH UR                                                 06940072
FIXDSC     END-EXEC.                                                    06950072
FIXDSC                                                                  06960072
000560***************************************************************** 07260072
000570 PROCEDURE DIVISION.                                              07270072
000580******************************************************************07280072
000590 0000-MAINLINE-PARAGRAPH.                                         07290072
000592                                                                  07300072
000593     PERFORM 1000-PROCESS-CONTROL-CARD.                           07310072
000594                                                                  07320072
000595     PERFORM 3000-OPEN-ITEM.                                      07330072
000596                                                                  07340072
000597     PERFORM 3200-FETCH-ITEM.                                     07350072
000598                                                                  07360072
000599     PERFORM 3300-PROCESS-ITEM                                    07370072
000600        UNTIL PS-END-OF-ITEM-YES.                                 07380072
000601                                                                  07390072
000602     PERFORM 3350-DETAIL-TOTAL.                                   07400072
000603     PERFORM 3400-TOTAL-LINE.                                     07410072
000604                                                                  07420072
000605     PERFORM 3700-CLOSE-ITEM.                                     07430072
000606                                                                  07440072
000607     CLOSE POS-DATE-CARD-FILE                                     07450072
000608           SALES-REPORT-FILE.                                     07460072
000609                                                                  07470072
000610     STOP RUN.                                                    07480072
000611                                                                  07490072
000612******************************************************************07500072
000614*     OPEN FILES. READ CONTROL CARD TO GET POS DATE IN MMDDYY     07510072
000615*     FORMAT. CALL DATE ROUTINE TO CONVERT DATE TO A CCYY-MM-DD   07520072
000616*     PROCESS DATE.                                               07530072
000617******************************************************************07540072
000618                                                                  07550072
000619 1000-PROCESS-CONTROL-CARD.                                       07560072
000620                                                                  07570072
000621     OPEN INPUT  POS-DATE-CARD-FILE                               07580072
000622          OUTPUT SALES-REPORT-FILE.                               07590072
000623                                                                  07600072
000624     READ POS-DATE-CARD-FILE INTO DATE-CONTROL-CARD               07610072
000625        AT END                                                    07620072
000626           SET PS-END-OF-CARD-FILE-YES TO TRUE.                   07630072
000627                                                                  07640072
000628     IF PS-END-OF-CARD-FILE-YES                                   07650072
000629         MOVE '1000-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   07660072
000630         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  07670072
000631         SET AC-CONTROL-CARD-ERROR TO TRUE                        07680072
000632         PERFORM 9999-ABEND                                       07690072
000633     END-IF.                                                      07700072
000634                                                                  07710072
000634     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              07720072
000634     MOVE CC-WEEK-ENDING-DATE-ISO                                 07730072
000634                           TO DPG52-LK-DATE-INPUT.                07740072
000634     SET DPG52-LK-DTE-ISO-FMT  TO TRUE.                           07750072
000634     SET DPG51-FISCAL-454-CALENDAR                                07760072
000634                               TO TRUE.                           07770072
000634     SET DPG51-DO-NOT-INCR-DECR-DATE                              07780072
000634                               TO TRUE.                           07790072
000634     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          07800072
000634                                             DPG53 DPG54          07810072
000634                                             DPG55 DPG56.         07820072
000634     EVALUATE TRUE                                                07830072
000634         WHEN DPG54-NO-ERROR                                      07840072
                   CONTINUE                                             07850072
000634         WHEN DPG54-SEVERE-ERROR                                  07860072
000634         WHEN DPG54-WARNING-ERROR                                 07870072
000634             DISPLAY '** ABEND **'                                07880072
000634             DISPLAY '** PROGRAM   ** = SAKRP101'                 07890072
000634             DISPLAY '** PARAGRAPH ** = 1000-PROCESS-CONTROL-CARD'07900072
000634             DISPLAY 'BAD INPUT DATE: '                           07910072
000634                            CC-WEEK-ENDING-DATE-ISO               07920072
000634             DISPLAY DPG54-ERROR-MESSAGE                          07930072
000634             SET AC-CONTROL-CARD-ERROR TO TRUE                    07940072
000634             CALL 'ILBOABN0' USING AC-ABEND-CODE                  07950072
000634     END-EVALUATE.                                                07960072
000634                                                                  07970072
000634     IF DPG55-ALPHA-WEEK-DAY-SATURDAY                             07980072
000634         CONTINUE                                                 07990072
000634     ELSE                                                         08000072
000634         DISPLAY '** ABEND **'                                    08010072
000634         DISPLAY '** PROGRAM   ** = SAKRP100'                     08020072
000634         DISPLAY '** PARAGRAPH ** = 1000-PROCESS-CONTROL-CARD'    08030072
000634         DISPLAY 'BAD INPUT DATE: '                               08040072
000634                            CC-WEEK-ENDING-DATE-ISO               08050072
000634         DISPLAY 'INPUT DATE IS NOT A WEEK ENDING DATE'           08060072
000634         SET AC-CONTROL-CARD-ERROR TO TRUE                        08070072
000634         CALL 'ILBOABN0' USING AC-ABEND-CODE                      08080072
000634     END-IF.                                                      08090072
000634                                                                  08100072
000634     MOVE CC-WEEK-ENDING-DATE-ISO   TO CC-END-DATE.               08110072
000634     MOVE DPG55-1ST-WKDY-DB2ISO-FMT TO CC-BEGIN-DATE.             08120072
000634                                                                  08130072
000635     DISPLAY PC-CURRENT-PROGRAM-NAME                              08140072
000636             ' - CALENDAR = (' CC-CONTROL-CARD-DISPLAY  ')'.      08150072
000637                                                                  08160072
000637     DISPLAY PC-CURRENT-PROGRAM-NAME                              08170072
000637             ' - DATE CONTROL CARD = (' DATE-CONTROL-CARD ')'.    08180072
000637                                                                  08190072
000638     PERFORM 1200-FORMAT-HEADINGS.                                08200072
000639                                                                  08210072
000640     PERFORM 8000-PRINT-HEADINGS.                                 08220072
000641                                                                  08230072
000642******************************************************************08240072
000644*     GET CURRENT DATE AND TIME FROM SYSTEM.                      08250072
000645*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          08260072
000646*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              08270072
000647******************************************************************08280072
000648                                                                  08290072
000649 1200-FORMAT-HEADINGS.                                            08300072
000650                                                                  08310072
000651     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   08320072
000652     ACCEPT PV-CURR-TIME FROM TIME.                               08330072
000653                                                                  08340072
FIXDSC     MOVE PV-CURR-DATE-MM             TO DP150-RUN-MONTH.         08350072
FIXDSC     MOVE PV-CURR-DATE-DD             TO DP150-RUN-DAY.           08360072
FIXDSC     MOVE PV-CURR-DATE-CCYY           TO DP150-RUN-YEAR.          08370072
FIXDSC                                                                  08380072
FIXDSC     MOVE PV-CURR-TIME-HH             TO DP150-RUN-HOUR.          08390072
FIXDSC     MOVE PV-CURR-TIME-MM             TO DP150-RUN-MINUTE.        08400072
FIXDSC     MOVE PC-CURRENT-PROGRAM-NAME     TO DP150-PROGRAM-NAME.      08410072
FIXDSC     MOVE PC-REPORT-NBR-1             TO DP150-REPORT-NUMBER.     08420072
000662                                                                  08430072
000663     MOVE CC-BEGIN-DATE               TO PV-BEG-CCYY-MM-DD.       08440072
000664     MOVE CC-END-DATE                 TO PV-END-CCYY-MM-DD.       08450072
000665     MOVE PV-BEG-CCYY                 TO H1-BEG-CCYY.             08460072
000666     MOVE PV-BEG-MM                   TO H1-BEG-MM.               08470072
000667     MOVE PV-BEG-DD                   TO H1-BEG-DD.               08480072
000668     MOVE PV-END-CCYY                 TO H1-END-CCYY.             08490072
000669     MOVE PV-END-MM                   TO H1-END-MM.               08500072
000670     MOVE PV-END-DD                   TO H1-END-DD.               08510072
000671                                                                  08520072
000672******************************************************************08530072
000673* OPEN ITEM CURSOR                                                08540072
000674******************************************************************08550072
000675                                                                  08560072
000676 3000-OPEN-ITEM.                                                  08570072
000677                                                                  08580072
000678     EXEC SQL                                                     08590072
000679          OPEN ITEM-CURSOR                                        08600072
000680     END-EXEC.                                                    08610072
000681                                                                  08620072
000682     IF NOT SQLCODE = ZERO                                        08630072
000683        MOVE SQLCODE                 TO PV-DB2-OPERATION          08640072
000684        PERFORM 9800-SQL-ABEND                                    08650072
000685     END-IF.                                                      08660072
000686                                                                  08670072
000687******************************************************************08680072
000688* FETCH ITEM CURSOR                                               08690072
000689******************************************************************08700072
000690                                                                  08710072
000691 3200-FETCH-ITEM.                                                 08720072
000692                                                                  08730072
000693     EXEC SQL                                                     08740072
000694          FETCH ITEM-CURSOR                                       08750072
000695           INTO :EPITM-PARTN-NBR                                  08760072
000696              , :EPITM-STR-NBR                                    08770072
000697              , :EPITM-RGST-ID                                    08780072
000698              , :EPITM-TRN-NBR                                    08790072
000699              , :EPITM-STRT-TM                                    08800072
000700              , :EPITM-SLS-CORR-SEQ-NBR                           08810072
000701              , :EPITM-LNE-ITM-SEQ-NBR                            08820072
000702              , :EPITM-DEPT-NBR                                   08830072
000703              , :EPITM-SLD-QTY                                    08840072
000704              , :EPITM-NET-CHRGD-AMT                              08850072
000705              , :EPITM-MDSE-ID                                    08860072
000706              , :EPITM-TX-AMT                                     08870072
000707              , :EPTRN-TRN-TYP-CDE                                08880072
000708              , :EPTRN-TRN-STAT-CDE                               08890072
000709     END-EXEC.                                                    08900072
000710                                                                  08910072
000711     EVALUATE TRUE                                                08920072
000712        WHEN SQLCODE = ZERO                                       08930072
000713             CONTINUE                                             08940072
000714        WHEN SQLCODE = PC-NOT-FOUND                               08950072
000715             SET PS-END-OF-ITEM-YES          TO TRUE              08960072
000716        WHEN OTHER                                                08970072
000717             MOVE '3200-FETCH-ITEM'          TO PV-PARAGRAPH-NAME 08980072
000720             MOVE SQLCODE                    TO PV-DB2-OPERATION  08990072
000721             PERFORM 9800-SQL-ABEND                               09000072
000722     END-EVALUATE.                                                09010072
000723                                                                  09020072
000724     IF PS-FIRST-TIME                                             09030072
000725         MOVE EPITM-PARTN-NBR     TO PV-HOLD-PARTN-NBR            09040072
000726         MOVE EPITM-STR-NBR       TO PV-HOLD-STR-NBR              09050072
000727         MOVE EPTRN-TRN-TYP-CDE   TO PV-HOLD-TRN-TYP-CDE          09060072
000728         MOVE 'N' TO PS-FIRST-TIME-SW                             09070072
000729         MOVE ZERO                TO D1-RWD-AMT                   09080072
000730                                     D1-KOHLS-CASH                09090072
000731                                     D1-ASSOC-DSC                 09100072
251536                                     PV-KOHLS-CASH                09101093
251972                                     PV-RWD-AMT                   09102099
000732     END-IF.                                                      09110072
000733                                                                  09120072
000734     IF PV-LINE-CNT > 55                                          09130072
000735         PERFORM 8000-PRINT-HEADINGS                              09140072
000736     END-IF.                                                      09150072
000737                                                                  09160072
000738******************************************************************09170072
000739* PROCESS ITEM DETAIL LINE                                        09180072
000740******************************************************************09190072
000741                                                                  09200072
000742 3300-PROCESS-ITEM.                                               09210072
000743                                                                  09220072
000744     IF EPITM-STR-NBR = PV-HOLD-STR-NBR                           09230072
000745         CONTINUE                                                 09240072
000746     ELSE                                                         09250072
000747         PERFORM 3350-DETAIL-TOTAL                                09260072
000748     END-IF.                                                      09270072
000749                                                                  09280072
000750     MOVE EPITM-PARTN-NBR        TO PV-HOLD-PARTN-NBR.            09290072
000751     MOVE EPITM-STR-NBR          TO PV-HOLD-STR-NBR.              09300072
000752     MOVE EPTRN-TRN-TYP-CDE      TO PV-HOLD-TRN-TYP-CDE.          09310072
000753                                                                  09320072
000754     MOVE EPITM-STR-NBR          TO D1-STR-NBR.                   09330072
000756     MOVE EPITM-RGST-ID          TO D1-RGST-ID.                   09340072
000758     MOVE EPITM-TRN-NBR          TO D1-TRN-NBR.                   09350072
000760     MOVE EPITM-LNE-ITM-SEQ-NBR  TO D1-SEQ-NBR.                   09360072
000762     MOVE EPTRN-TRN-TYP-CDE      TO D1-TRN-TYP-CDE.               09370073
000763     MOVE EPITM-MDSE-ID          TO D1-MDSE-ID.                   09380072
FIXDSC     PERFORM 4000-SELECT-ORDER-NUMBER.                            09390072
FIXDSC     IF PS-ORDER-NUMBER-FOUND-N                                   09400072
FIXDSC         MOVE SPACES             TO D1-ORD-NBR                    09410072
FIXDSC     ELSE                                                         09420072
FIXDSC         MOVE EPORD-ORD-NBR-TEXT                                  09430072
FIXDSC                                 TO D1-ORD-NBR                    09440072
FIXDSC     END-IF.                                                      09450072
                                                                        09460072
000764     MOVE EPITM-SLD-QTY          TO D1-SLD-QTY.                   09470072
000798                                                                  09480072
MKTPLC     PERFORM 3550-SELECT-TEPSHP-AMT.                              09570072
251411     MOVE PV-TEPSHP-SHIP-CHRG-AMT TO D1-SHIP-CHRG-AMT.            09580083
251411     ADD PV-TEPSHP-SHIP-CHRG-AMT TO PV-STR-TOT-SHIP-CHRG-AMT      09590083
FIXDSC                                    PV-TOT-SHIP-CHRG-AMT.         09600072
                                                                        09602080
251411     MOVE PV-TEPSHP-TX-AMT       TO D1-SHIP-TX-AMT.               09620083
FIXDSC     ADD PV-TEPSHP-TX-AMT        TO PV-STR-TOT-SHIP-TX-AMT        09630072
FIXDSC                                    PV-TOT-SHIP-TX-AMT.           09640072
MKTPLC                                                                  09654080
000765     MOVE EPITM-NET-CHRGD-AMT    TO D1-NET-CHRGD-AMT.             09660072
FIXDSC     ADD EPITM-NET-CHRGD-AMT     TO PV-STR-TOT-NET-CHRGD-AMT      09670072
FIXDSC                                    PV-TOT-NET-CHRGD-AMT.         09680072
000766     MOVE EPITM-TX-AMT           TO D1-TX-AMT.                    09690072
FIXDSC     ADD EPITM-TX-AMT            TO PV-STR-TOT-TX-AMT             09700072
FIXDSC                                    PV-TOT-TX-AMT.                09710072
                                                                        09750072
000767     COMPUTE PV-DET-TOTAL-AMT = EPITM-NET-CHRGD-AMT               09760072
000768                              + EPITM-TX-AMT.                     09770072
                                                                        09780072
000769     MOVE PV-DET-TOTAL-AMT       TO D1-TOTAL-AMT.                 09790072
FIXDSC     ADD  PV-DET-TOTAL-AMT       TO PV-STR-TOT-TOTAL-AMT          09800072
FIXDSC                                    PV-TOT-TOTAL-AMT.             09810072
                                                                        09820072
000770     IF EPTRN-TRN-TYP-CDE = '01' OR                               09830072
000771        EPTRN-TRN-TYP-CDE = '02'                                  09840072
000774          ADD EPITM-NET-CHRGD-AMT TO PV-TOTAL-SALES-AMT           09850072
000775                                     PV-STR-TOT-SALES-AMT         09860072
FIXDSC          ADD EPITM-TX-AMT        TO PV-TOTAL-SALES-TX-AMT        09870072
FIXDSC                                     PV-STR-TOT-SALES-TX-AMT      09880072
000778     ELSE                                                         09890072
000779        IF EPTRN-TRN-TYP-CDE = '11' OR                            09900072
000780           EPTRN-TRN-TYP-CDE = '12'                               09910072
000781             ADD EPITM-NET-CHRGD-AMT TO PV-TOTAL-RTN-AMT          09920072
000782                                        PV-STR-TOT-RTN-AMT        09930072
000783             ADD EPITM-TX-AMT        TO PV-TOTAL-RTN-TX-AMT       09940072
000784                                        PV-STR-TOT-RTN-TX-AMT     09950072
000785        ELSE                                                      09960072
000786             DISPLAY 'OTHER EPITM-NET-CHRGD-AMT '                 09970072
000787                            EPITM-NET-CHRGD-AMT                   09980072
000788             DISPLAY 'OTHER EPITM-TX-AMT '                        09990072
000789                            EPITM-TX-AMT                          10000072
000788             DISPLAY 'OTHER EPSHP-TX-AMT '                        10010072
000789                            EPSHP-TX-AMT                          10020072
000788             DISPLAY 'OTHER PV-TX-AMT '                           10030072
000789                            PV-TX-AMT                             10040072
000790        END-IF                                                    10050072
000791     END-IF.                                                      10060072
000792                                                                  10070072
000793     PERFORM 3500-OPEN-LID-CURSOR.                                10080072
000794     PERFORM 3510-FETCH-LID                                       10090072
000796           UNTIL PS-END-OF-LID-YES.                               10100072
                                                                        10110072
251972     MOVE PV-KOHLS-CASH  TO D1-KOHLS-CASH.                        10111099
251972     MOVE PV-RWD-AMT     TO D1-RWD-AMT.                           10112099
254534     MOVE PV-DISC        TO D1-DISC.                              10112199
254534     ADD PV-DISC         TO PV-STR-TOT-DISC                       10112399
254534                            PV-TOT-DISC.                          10112499
254534     MOVE ZERO           TO PV-DISC.                              10112599
251972                                                                  10113099
000797     PERFORM 3800-CLOSE-LID-CURSOR.                               10120072
                                                                        10130072
FIXDSC     PERFORM 3530-OPEN-EID-CURSOR.                                10140072
FIXDSC     PERFORM 3535-FETCH-EID                                       10150072
FIXDSC           UNTIL PS-END-OF-EID-YES.                               10160072
FIXDSC                                                                  10170072
FIXDSC     MOVE PV-EMP-DISC-AMT TO D1-ASSOC-DSC.                        10180072
FIXDSC                                                                  10190072
FIXDSC     PERFORM 3850-CLOSE-EID-CURSOR.                               10200072
000798                                                                  10210072
000799     PERFORM 3600-WRITE-ITEM-REPORT.                              10220072
TOTALS     ADD +1 TO PV-LINE-CNT.                                       10230072
000800                                                                  10240072
TOTALS     IF PV-LINE-CNT > 55                                          10250072
TOTALS         PERFORM 8000-PRINT-HEADINGS                              10260072
TOTALS     END-IF.                                                      10270072
000737                                                                  10280072
000801     PERFORM 3200-FETCH-ITEM.                                     10290072
000802                                                                  10300072
FIXDSC     MOVE 'N'   TO PS-END-OF-LID-CURSOR                           10310072
FIXDSC                   PS-END-OF-EID-CURSOR.                          10320072
000804     MOVE ZERO  TO D1-RWD-AMT                                     10330072
000805                   D1-KOHLS-CASH                                  10340072
000806                   D1-ASSOC-DSC                                   10350072
000204                   PV-TX-AMT                                      10360072
                         PV-TEPSHP-TX-AMT                               10370072
MKTPLC                   PV-TEPSHP-SHIP-CHRG-AMT                        10380072
MKTPLC                   PV-GIFT-SALE                                   10390072
254534                   PV-SALE-DISC                                   10401099
MKTPLC                   PV-GIFT-RTN                                    10410072
254534                   PV-RTN-DISC                                    10421099
MKTPLC                   PV-SHP-RTN-AMT                                 10430072
MKTPLC                   PV-SHP-RTN-TX-AMT                              10440072
000927                   PV-EMP-DISC-AMT                                10450091
251536                   PV-KOHLS-CASH                                  10451098
251972                   PV-RWD-AMT.                                    10452099
000807                                                                  10460072
000808******************************************************************10470072
000809* WRITE DETAIL TOTAL LINE                                         10480072
000810******************************************************************10490072
000811                                                                  10500072
000812 3350-DETAIL-TOTAL.                                               10510072
000813                                                                  10520072
TOTALS     WRITE SALES-REPORT-RECORD FROM D4-BLANK-LINE AFTER           10530072
TOTALS               ADVANCING 2 LINE.                                  10540072
TOTALS     ADD +1 TO PV-LINE-CNT.                                       10550072
000813                                                                  10560072
TOTALS     MOVE  PV-STR-RTN-KOHLS-CASH  TO T1-RKOHLS-CASH.              10570072
TOTALS     MOVE  PV-STR-RTN-RWD-AMT     TO T1-RRWD-AMT.                 10580072
TOTALS     MOVE  PV-STR-RTN-EMPD-AMT    TO T1-RASSOC-DSC.               10590072
254534     MOVE  PV-STR-RDISC           TO T1-RDISC.                    10600099
TOTALS                                                                  10610072
TOTALS     WRITE SALES-REPORT-RECORD FROM T1-RETURN-TOTAL-LINE AFTER    10620072
TOTALS                   ADVANCING 2 LINE.                              10630072
TOTALS     ADD +1 TO PV-LINE-CNT.                                       10640072
TOTALS                                                                  10650072
TOTALS     MOVE  PV-STR-SALE-KOHLS-CASH TO T1-SKOHLS-CASH.              10660072
TOTALS     MOVE  PV-STR-SALE-RWD-AMT    TO T1-SRWD-AMT.                 10670072
TOTALS     MOVE  PV-STR-SALE-EMPD-AMT   TO T1-SASSOC-DSC.               10680072
254534     MOVE  PV-STR-SDISC           TO T1-SDISC.                    10690099
TOTALS                                                                  10700072
TOTALS     WRITE SALES-REPORT-RECORD FROM T1-SALE-TOTAL-LINE AFTER      10710072
TOTALS                   ADVANCING 2 LINE.                              10720072
TOTALS     ADD +1 TO PV-LINE-CNT.                                       10730072
FIXDSC                                                                  10740072
FIXDSC     MOVE PV-STR-TOT-RWD-AMT       TO T1-RWD-AMT.                 10750072
FIXDSC     MOVE PV-STR-TOT-KOHLS-CASH    TO T1-KOHLS-CASH.              10760072
FIXDSC     MOVE PV-STR-TOT-ASSOC-DSC     TO T1-ASSOC-DSC.               10770072
FIXDSC     MOVE PV-STR-TOT-SHIP-CHRG-AMT TO T1-SHIP-CHRG-AMT.           10780072
FIXDSC     MOVE PV-STR-TOT-SHIP-TX-AMT   TO T1-SHIP-TX-AMT.             10790072
254534     MOVE PV-STR-TOT-DISC          TO T1-DISC.                    10801099
FIXDSC     MOVE PV-STR-TOT-NET-CHRGD-AMT TO T1-NET-CHRGD-AMT.           10810072
FIXDSC     MOVE PV-STR-TOT-TX-AMT        TO T1-TX-AMT.                  10820072
FIXDSC     MOVE PV-STR-TOT-TOTAL-AMT     TO T1-TOTAL-AMT.               10830072
FIXDSC     MOVE 'STORE TOTAL AMOUNT '    TO T1-TOTAL-DESC.              10840072
FIXDSC                                                                  10850072
FIXDSC     WRITE SALES-REPORT-RECORD FROM T1-TOTAL-LINE AFTER           10860072
FIXDSC                   ADVANCING 2 LINE.                              10870072
FIXDSC     ADD +1 TO PV-LINE-CNT.                                       10880072
000331                                                                  10890072
000814     WRITE SALES-REPORT-RECORD FROM D4-BLANK-LINE AFTER           10900072
000815               ADVANCING 2 LINE.                                  10910072
000816                                                                  10920072
000817     MOVE PV-HOLD-STR-NBR         TO D2-STR-NBR.                  10930072
000818     MOVE PV-STR-TOT-SALES-AMT    TO D2-SALES-AMT.                10940072
000819     MOVE PV-STR-TOT-SALES-TX-AMT TO D2-SALES-TX-AMT.             10950072
000820     MOVE PV-STR-TOT-RTN-AMT      TO D2-RETURNS-AMT.              10960072
000821     MOVE PV-STR-TOT-RTN-TX-AMT   TO D2-RETURNS-TAX-AMT.          10970072
000822     COMPUTE PV-STR-SALES =                                       10980072
000823             PV-STR-TOT-SALES-AMT + PV-STR-TOT-SALES-TX-AMT.      10990072
000824     COMPUTE PV-STR-RETURNS =                                     11000072
000825             PV-STR-TOT-RTN-AMT + PV-STR-TOT-RTN-TX-AMT.          11010072
000826     COMPUTE PV-STR-TOTAL-AMT =                                   11020072
000827             PV-STR-SALES + PV-STR-RETURNS.                       11030072
000828     MOVE PV-STR-TOTAL-AMT TO D2-STR-TOT-AMT.                     11040072
000829     WRITE SALES-REPORT-RECORD FROM D2-DETAIL-LINE-2 AFTER        11050072
000830               ADVANCING 2 LINE.                                  11060072
TOTALS     ADD +1 TO PV-LINE-CNT.                                       11070072
TOTALS                                                                  11080072
000831     WRITE SALES-REPORT-RECORD FROM D4-BLANK-LINE AFTER           11090072
000832               ADVANCING 2 LINE.                                  11100072
TOTALS     ADD +1 TO PV-LINE-CNT.                                       11110072
TOTALS                                                                  11120072
000833     MOVE ZEROES TO PV-STR-TOT-SALES-AMT                          11130072
000834                    PV-STR-TOT-SALES-TX-AMT                       11140072
FIXDSC                    PV-STR-TOT-RTN-AMT                            11150072
FIXDSC                    PV-STR-TOT-RTN-TX-AMT                         11160072
FIXDSC                    PV-STR-TOT-RWD-AMT                            11170072
FIXDSC                    PV-STR-TOT-KOHLS-CASH                         11180072
FIXDSC                    PV-STR-TOT-ASSOC-DSC                          11190072
FIXDSC                    PV-STR-TOT-SHIP-CHRG-AMT                      11200072
FIXDSC                    PV-STR-TOT-SHIP-TX-AMT                        11210072
254534                    PV-STR-TOT-DISC                               11221099
FIXDSC                    PV-STR-TOT-NET-CHRGD-AMT                      11230072
FIXDSC                    PV-STR-TOT-TX-AMT                             11240072
FIXDSC                    PV-STR-TOT-TOTAL-AMT                          11250072
TOTALS                    PV-STR-RTN-KOHLS-CASH                         11260072
TOTALS                    PV-STR-RTN-RWD-AMT                            11270072
TOTALS                    PV-STR-RTN-EMPD-AMT                           11280072
TOTALS                    PV-STR-SALE-KOHLS-CASH                        11290072
TOTALS                    PV-STR-SALE-RWD-AMT                           11300072
TOTALS                    PV-STR-SALE-EMPD-AMT                          11310099
254534                    PV-STR-RDISC                                  11311099
254534                    PV-STR-SDISC.                                 11313099
000837                                                                  11320072
000838     PERFORM 8000-PRINT-HEADINGS.                                 11330072
000839                                                                  11340072
000840******************************************************************11350072
000841* WRITE TOTAL LINE                                                11360072
000842******************************************************************11370072
000843                                                                  11380072
000844 3400-TOTAL-LINE.                                                 11390072
000843                                                                  11400072
FIXDSC     IF PV-LINE-CNT > 1                                           11410072
TOTALS        MOVE PV-TOT-RTN-KOHLS-CASH   TO T1-TOT-KOHLS-CASH         11420072
TOTALS        MOVE PV-TOT-RTN-RWD-AMT      TO T1-TOT-RWD-AMT            11430072
TOTALS        MOVE PV-TOT-RTN-EMPD-AMT     TO T1-TOT-ASSOC-DSC          11440072
254534        MOVE PV-TOT-RDISC            TO T1-TOT-DISC               11451099
TOTALS        MOVE 'FINAL DISC RTN AMT '   TO T1-FINAL-DESC             11460072
TOTALS        WRITE SALES-REPORT-RECORD FROM T1-FINAL-TOTAL-LINE AFTER  11470072
TOTALS                      ADVANCING 2 LINE                            11480072
TOTALS                                                                  11490072
TOTALS        MOVE PV-TOT-SALE-KOHLS-CASH  TO T1-TOT-KOHLS-CASH         11500072
TOTALS        MOVE PV-TOT-SALE-RWD-AMT     TO T1-TOT-RWD-AMT            11510072
TOTALS        MOVE PV-TOT-SALE-EMPD-AMT    TO T1-TOT-ASSOC-DSC          11520072
254534        MOVE PV-TOT-SDISC            TO T1-TOT-DISC               11531099
TOTALS        MOVE 'FINAL DISC SALE AMT'   TO T1-FINAL-DESC             11540072
TOTALS        WRITE SALES-REPORT-RECORD FROM T1-FINAL-TOTAL-LINE AFTER  11550072
TOTALS                      ADVANCING 1 LINE                            11560072
TOTALS                                                                  11570072
FIXDSC        MOVE PV-TOT-RWD-AMT          TO T1-RWD-AMT                11580072
FIXDSC        MOVE PV-TOT-KOHLS-CASH       TO T1-KOHLS-CASH             11590072
FIXDSC        MOVE PV-TOT-ASSOC-DSC        TO T1-ASSOC-DSC              11600072
FIXDSC        MOVE PV-TOT-SHIP-CHRG-AMT    TO T1-SHIP-CHRG-AMT          11610072
FIXDSC        MOVE PV-TOT-SHIP-TX-AMT      TO T1-SHIP-TX-AMT            11620072
254534        MOVE PV-TOT-DISC             TO T1-DISC                   11631099
FIXDSC        MOVE PV-TOT-NET-CHRGD-AMT    TO T1-NET-CHRGD-AMT          11640072
FIXDSC        MOVE PV-TOT-TX-AMT           TO T1-TX-AMT                 11650072
FIXDSC        MOVE PV-TOT-TOTAL-AMT        TO T1-TOTAL-AMT              11660072
FIXDSC        MOVE 'FINAL TOTAL AMOUNT '   TO T1-TOTAL-DESC             11670072
FIXDSC        WRITE SALES-REPORT-RECORD FROM T1-TOTAL-LINE AFTER        11680072
FIXDSC                      ADVANCING 2 LINE                            11690072
FIXDSC     END-IF.                                                      11700072
000864                                                                  11710072
000846     WRITE SALES-REPORT-RECORD FROM D4-BLANK-LINE AFTER           11720072
000847                      ADVANCING 2 LINE.                           11730072
000848                                                                  11740072
000849     COMPUTE PV-TOTAL-SALES =                                     11750072
000850               PV-TOTAL-SALES-AMT + PV-TOTAL-SALES-TX-AMT.        11760072
000851     COMPUTE PV-TOTAL-RETURNS =                                   11770072
000852               PV-TOTAL-RTN-AMT + PV-TOTAL-RTN-TX-AMT.            11780072
000853     COMPUTE PV-TOTAL-AMT =                                       11790072
000854               PV-TOTAL-SALES + PV-TOTAL-RETURNS.                 11800072
000855                                                                  11810072
000856     MOVE PV-TOTAL-SALES-AMT    TO D3-SALES-AMT.                  11820072
000857     MOVE PV-TOTAL-SALES-TX-AMT TO D3-SALES-TX-AMT.               11830072
000858     MOVE PV-TOTAL-RTN-AMT      TO D3-RETURNS-AMT.                11840072
000859     MOVE PV-TOTAL-RTN-TX-AMT   TO D3-RETURNS-TAX-AMT.            11850072
000860     MOVE PV-TOTAL-AMT          TO D3-TOT-AMT                     11860072
000861                                                                  11870072
000862     WRITE SALES-REPORT-RECORD FROM D3-DETAIL-LINE-3 AFTER        11880072
000863                   ADVANCING 2 LINE.                              11890072
000864                                                                  11900072
000865     WRITE SALES-REPORT-RECORD FROM D4-BLANK-LINE AFTER           11910072
000866                   ADVANCING 2 LINE.                              11920072
000867                                                                  11930072
000868******************************************************************11940072
000869* OPEN LID-CURSOR                                                 11950072
000870******************************************************************11960072
000871                                                                  11970072
000872 3500-OPEN-LID-CURSOR.                                            11980072
000873                                                                  11990072
000874     EXEC SQL                                                     12000072
000875          OPEN LID-CURSOR                                         12010072
000876     END-EXEC.                                                    12020072
000877                                                                  12030072
000878     IF NOT SQLCODE = ZERO                                        12040072
000879        MOVE '3500-OPEN-LID-CURSOR'  TO PV-PARAGRAPH-NAME         12050072
000880        MOVE SQLCODE                 TO PV-DB2-OPERATION          12060072
000881        PERFORM 9800-SQL-ABEND                                    12070072
000882     END-IF.                                                      12080072
000883                                                                  12090072
000884******************************************************************12100072
000885* FETCH LID CURSOR                                                12110072
000886******************************************************************12120072
000887                                                                  12130072
000888 3510-FETCH-LID.                                                  12140072
000889                                                                  12150072
000890     EXEC SQL                                                     12160072
000891          FETCH LID-CURSOR                                        12170072
000892           INTO :EPLID-PARTN-NBR                                  12180072
000893               ,:EPLID-STR-NBR                                    12190072
000894               ,:EPLID-RGST-ID                                    12200072
000895               ,:EPLID-TRN-NBR                                    12210072
000896               ,:EPLID-STRT-TM                                    12220072
000897               ,:EPLID-SLS-CORR-SEQ-NBR                           12230072
000898               ,:EPLID-LNE-ITM-SEQ-NBR                            12240072
000899               ,:EPLID-LID-SEQ-NBR                                12250072
000900               ,:EPLID-LID-TYP-CDE                                12260072
000901               ,:EPLID-LID-RSN-CDE                                12270072
000902               ,:EPLID-LID-AMT                                    12280072
000903     END-EXEC.                                                    12290072
000904                                                                  12300072
000905     EVALUATE TRUE                                                12310072
000906        WHEN SQLCODE = ZERO                                       12320072
000927            PERFORM 3520-LID-AMT                                  12330072
251972            MOVE 'N' TO PS-END-OF-LID-CURSOR                      12340099
000908        WHEN SQLCODE = -811                                       12350072
000932            PERFORM 3520-LID-AMT                                  12360072
000928            MOVE 'N' TO PS-END-OF-LID-CURSOR                      12370099
000910        WHEN SQLCODE = +100                                       12380072
000939            MOVE 'Y' TO PS-END-OF-LID-CURSOR                      12410072
000912        WHEN OTHER                                                12420072
000939            MOVE 'Y' TO PS-END-OF-LID-CURSOR                      12430072
000916     END-EVALUATE.                                                12460072
000918                                                                  12470072
000945******************************************************************12480072
000946* MOVE THE DISCOUNTS TO THE APPROPRIATE COLUMN                    12490072
000947******************************************************************12500072
000948                                                                  12510072
000949 3520-LID-AMT.                                                    12520072
000950                                                                  12530072
254534*    PRORATED DOLLAR OFF (KOHLS COUPON)                           12531099
000951     IF EPLID-LID-TYP-CDE = 'R' AND                               12540072
000952        EPLID-LID-RSN-CDE = '733'                                 12550072
251536           ADD  EPLID-LID-AMT      TO PV-KOHLS-CASH               12560093
TOTALS           IF EPTRN-TRN-TYP-CDE = '11' OR                         12570072
TOTALS              EPTRN-TRN-TYP-CDE = '12'                            12580072
TOTALS              ADD EPLID-LID-AMT    TO PV-STR-RTN-KOHLS-CASH       12590072
TOTALS                                      PV-TOT-RTN-KOHLS-CASH       12600072
TOTALS           ELSE                                                   12610072
TOTALS              ADD EPLID-LID-AMT    TO PV-STR-SALE-KOHLS-CASH      12620072
TOTALS                                      PV-TOT-SALE-KOHLS-CASH      12630072
TOTALS           END-IF                                                 12640072
FIXDSC           ADD EPLID-LID-AMT       TO PV-STR-TOT-KOHLS-CASH       12650072
FIXDSC                                      PV-TOT-KOHLS-CASH           12660072
251536     END-IF.                                                      12660193
251536                                                                  12660293
254534*    PRORATED PERCENT OFF (KOHLS COUPON)                          12660399
254534     IF EPLID-LID-TYP-CDE = 'Q' AND                               12660499
254534        EPLID-LID-RSN-CDE = '733'                                 12660599
254534           ADD  EPLID-LID-AMT      TO PV-DISC                     12660799
254534           IF EPTRN-TRN-TYP-CDE = '11' OR                         12660899
254534              EPTRN-TRN-TYP-CDE = '12'                            12660999
254534              ADD EPLID-LID-AMT    TO PV-RTN-DISC                 12661299
254534                                      PV-STR-RDISC                12661399
254534                                      PV-TOT-RDISC                12661499
254534           ELSE                                                   12661699
254534              ADD EPLID-LID-AMT    TO PV-SALE-DISC                12661999
254534                                      PV-STR-SDISC                12662099
254534                                      PV-TOT-SDISC                12662199
254534           END-IF                                                 12662399
254534     END-IF.                                                      12662799
254534                                                                  12662899
254534*    PRORATED DOLLAR OFF (KOHLS CASH)                             12662999
251536     IF EPLID-LID-TYP-CDE = 'R' AND                               12663099
251536        EPLID-LID-RSN-CDE = '780'                                 12663193
251536           ADD  EPLID-LID-AMT      TO PV-KOHLS-CASH               12663293
251536           IF EPTRN-TRN-TYP-CDE = '11' OR                         12664093
251536              EPTRN-TRN-TYP-CDE = '12'                            12665093
251536              ADD EPLID-LID-AMT    TO PV-STR-RTN-KOHLS-CASH       12666093
251536                                      PV-TOT-RTN-KOHLS-CASH       12667093
251536           ELSE                                                   12668093
251536              ADD EPLID-LID-AMT    TO PV-STR-SALE-KOHLS-CASH      12669093
251536                                      PV-TOT-SALE-KOHLS-CASH      12669193
251536           END-IF                                                 12669293
251536           ADD EPLID-LID-AMT       TO PV-STR-TOT-KOHLS-CASH       12669393
251536                                      PV-TOT-KOHLS-CASH           12669493
251536     END-IF.                                                      12669593
251536                                                                  12670093
254534*    DOLLAR OFF (KOHLS COUPON)                                    12671099
251536     IF EPLID-LID-TYP-CDE = 'D' AND                               12680093
000956        EPLID-LID-RSN-CDE = '733'                                 12690086
251972           ADD  EPLID-LID-AMT   TO PV-RWD-AMT                     12700099
TOTALS           IF EPTRN-TRN-TYP-CDE = '11' OR                         12710086
TOTALS              EPTRN-TRN-TYP-CDE = '12'                            12720086
TOTALS              ADD EPLID-LID-AMT    TO PV-STR-RTN-RWD-AMT          12730086
TOTALS                                      PV-TOT-RTN-RWD-AMT          12740086
TOTALS           ELSE                                                   12750086
TOTALS              ADD EPLID-LID-AMT    TO PV-STR-SALE-RWD-AMT         12760086
TOTALS                                      PV-TOT-SALE-RWD-AMT         12770086
TOTALS           END-IF                                                 12780086
FIXDSC           ADD EPLID-LID-AMT       TO PV-STR-TOT-RWD-AMT          12790086
FIXDSC                                      PV-TOT-RWD-AMT              12800072
251536     END-IF.                                                      12801099
251536                                                                  12810094
254534*    DOLLAR OFF (KOHLS YES WE CAN)                                12810199
251972     IF EPLID-LID-TYP-CDE = 'D' AND                               12811099
251972        EPLID-LID-RSN-CDE = '709'                                 12812099
251972           ADD  EPLID-LID-AMT   TO PV-RWD-AMT                     12813099
251972           IF EPTRN-TRN-TYP-CDE = '11' OR                         12814099
251972              EPTRN-TRN-TYP-CDE = '12'                            12815099
251972              ADD EPLID-LID-AMT    TO PV-STR-RTN-RWD-AMT          12816099
251972                                      PV-TOT-RTN-RWD-AMT          12817099
251972           ELSE                                                   12818099
251972              ADD EPLID-LID-AMT    TO PV-STR-SALE-RWD-AMT         12819099
251972                                      PV-TOT-SALE-RWD-AMT         12819199
251972           END-IF                                                 12819299
251972           ADD EPLID-LID-AMT       TO PV-STR-TOT-RWD-AMT          12819399
251972                                      PV-TOT-RWD-AMT              12819499
251972     END-IF.                                                      12820099
000964                                                                  12830072
FIXDSC******************************************************************12840072
FIXDSC* OPEN EID-CURSOR                                                 12850072
FIXDSC******************************************************************12860072
FIXDSC                                                                  12870072
FIXDSC 3530-OPEN-EID-CURSOR.                                            12880072
FIXDSC                                                                  12890072
FIXDSC     EXEC SQL                                                     12900072
FIXDSC          OPEN EID-CURSOR                                         12910072
FIXDSC     END-EXEC.                                                    12920072
FIXDSC                                                                  12930072
FIXDSC     IF NOT SQLCODE = ZERO                                        12940072
FIXDSC        MOVE '3530-OPEN-EID-CURSOR'  TO PV-PARAGRAPH-NAME         12950072
FIXDSC        MOVE SQLCODE                 TO PV-DB2-OPERATION          12960072
FIXDSC        PERFORM 9800-SQL-ABEND                                    12970072
FIXDSC     END-IF.                                                      12980072
000883                                                                  12990072
FIXDSC******************************************************************13000072
FIXDSC* FETCH EID CURSOR                                                13010072
FIXDSC******************************************************************13020072
FIXDSC                                                                  13030072
FIXDSC 3535-FETCH-EID.                                                  13040072
FIXDSC                                                                  13050072
FIXDSC     EXEC SQL                                                     13060072
FIXDSC          FETCH EID-CURSOR                                        13070072
FIXDSC           INTO :EPEID-EMP-DISC-AMT                               13080072
FIXDSC              , :EPEID-EMP-DISC-CTG-CDE                           13090072
FIXDSC     END-EXEC.                                                    13100072
FIXDSC                                                                  13110072
FIXDSC     EVALUATE TRUE                                                13120072
FIXDSC        WHEN SQLCODE = ZERO                                       13130072
FIXDSC            ADD EPEID-EMP-DISC-AMT TO PV-EMP-DISC-AMT             13140072
FIXDSC                                      PV-STR-TOT-ASSOC-DSC        13150072
FIXDSC                                      PV-TOT-ASSOC-DSC            13160072
TOTALS            IF EPTRN-TRN-TYP-CDE = '11' OR                        13170072
TOTALS               EPTRN-TRN-TYP-CDE = '12'                           13180072
TOTALS                 ADD EPEID-EMP-DISC-AMT TO PV-STR-RTN-EMPD-AMT    13190072
TOTALS                                           PV-TOT-RTN-EMPD-AMT    13200072
TOTALS            ELSE                                                  13210072
TOTALS                 ADD EPEID-EMP-DISC-AMT TO PV-STR-SALE-EMPD-AMT   13220072
TOTALS                                           PV-TOT-SALE-EMPD-AMT   13230072
TOTALS            END-IF                                                13240072
FIXDSC            MOVE 'Y' TO PS-END-OF-EID-CURSOR                      13250072
FIXDSC        WHEN SQLCODE = -811                                       13260072
FIXDSC            ADD EPEID-EMP-DISC-AMT TO PV-EMP-DISC-AMT             13270072
FIXDSC                                      PV-STR-TOT-ASSOC-DSC        13280072
FIXDSC                                      PV-TOT-ASSOC-DSC            13290072
TOTALS            IF EPTRN-TRN-TYP-CDE = '11' OR                        13300072
TOTALS               EPTRN-TRN-TYP-CDE = '12'                           13310072
TOTALS                 ADD EPEID-EMP-DISC-AMT TO PV-STR-RTN-EMPD-AMT    13320072
TOTALS                                           PV-TOT-RTN-EMPD-AMT    13330072
TOTALS            ELSE                                                  13340072
TOTALS                 ADD EPEID-EMP-DISC-AMT TO PV-STR-SALE-EMPD-AMT   13350072
TOTALS                                           PV-TOT-SALE-EMPD-AMT   13360072
TOTALS            END-IF                                                13370072
FIXDSC            MOVE 'N' TO PS-END-OF-EID-CURSOR                      13380072
FIXDSC        WHEN SQLCODE = +100                                       13390072
FIXDSC            MOVE 'Y' TO PS-END-OF-EID-CURSOR                      13400072
FIXDSC        WHEN OTHER                                                13410072
FIXDSC            MOVE 'Y' TO PS-END-OF-EID-CURSOR                      13420072
FIXDSC            MOVE ZERO  TO D1-ASSOC-DSC                            13430072
FIXDSC     END-EVALUATE.                                                13440072
FIXDSC                                                                  13450072
000964                                                                  13460072
000945******************************************************************13470072
000946* GET THE TX AMT FROM TEPSHP FOR MARKETPLACE ITEMS SOLD.  NEED    13480072
000946* TEPIPS TO KNOW WHICH LINE ITEM IS THE SHIPPING TAX.             13490072
000947******************************************************************13500072
000964                                                                  13510072
000966 3550-SELECT-TEPSHP-AMT.                                          13520072
000964                                                                  13530072
MKTPLC     MOVE ZERO TO PV-TEPSHP-SHIP-CHRG-AMT                         13540072
MKTPLC                  PV-TEPSHP-TX-AMT.                               13550072
000964     EXEC SQL                                                     13560072
000964        SELECT SHP.TX_AMT                                         13570072
MKTPLC             , SHP.SHIP_CHRG_AMT                                  13580072
000964        INTO :PV-TEPSHP-TX-AMT                                    13590072
MKTPLC           , :PV-TEPSHP-SHIP-CHRG-AMT                             13600072
000964        FROM TEPSHP SHP                                           13610072
000964           , TEPIPS IPS                                           13620072
000964           , TEPITM ITM                                           13630072
000964        WHERE SHP.PARTN_NBR         = :EPITM-PARTN-NBR            13640078
000964          AND SHP.STR_NBR           = :EPITM-STR-NBR              13650078
000964          AND SHP.RGST_ID           = :EPITM-RGST-ID              13660078
000964          AND SHP.TRN_NBR           = :EPITM-TRN-NBR              13670078
000964          AND SHP.STRT_TM           = :EPITM-STRT-TM              13680078
000964          AND SHP.SLS_CORR_SEQ_NBR  = :EPITM-SLS-CORR-SEQ-NBR     13690078
251411          AND ITM.LNE_ITM_SEQ_NBR   = :EPITM-LNE-ITM-SEQ-NBR      13691082
000964          AND SHP.PARTN_NBR         = IPS.PARTN_NBR               13700072
000964          AND SHP.PARTN_NBR         = ITM.PARTN_NBR               13710072
000964          AND SHP.STR_NBR           = IPS.STR_NBR                 13720072
000964          AND SHP.STR_NBR           = ITM.STR_NBR                 13730072
000964          AND SHP.RGST_ID           = IPS.RGST_ID                 13740072
000964          AND SHP.RGST_ID           = ITM.RGST_ID                 13750072
000964          AND SHP.TRN_NBR           = IPS.TRN_NBR                 13760072
000964          AND SHP.TRN_NBR           = ITM.TRN_NBR                 13770072
000964          AND SHP.STRT_TM           = IPS.STRT_TM                 13780072
000964          AND SHP.STRT_TM           = ITM.STRT_TM                 13790072
000964          AND SHP.SLS_CORR_SEQ_NBR  = IPS.SLS_CORR_SEQ_NBR        13800072
000964          AND SHP.SLS_CORR_SEQ_NBR  = ITM.SLS_CORR_SEQ_NBR        13810072
000964          AND IPS.LNE_ITM_SEQ_NBR   = ITM.LNE_ITM_SEQ_NBR         13820072
000964          AND SHP.PLND_SHIPT_NBR    = IPS.PLND_SHIPT_NBR          13830072
000964          WITH UR                                                 13850072
000964     END-EXEC.                                                    13860072
000964                                                                  13870072
000964     EVALUATE TRUE                                                13880072
000712        WHEN SQLCODE = ZERO                                       13890072
000713             CONTINUE                                             13900072
000714        WHEN SQLCODE = +100                                       13910072
000713             CONTINUE                                             13920072
000714        WHEN SQLCODE = -305                                       13930072
000713             CONTINUE                                             13940072
000716        WHEN OTHER                                                13950072
000717             MOVE '3550-SELECT-TEPSHP-AMT'   TO PV-PARAGRAPH-NAME 13960072
000720             MOVE SQLCODE                    TO PV-DB2-OPERATION  13970072
000721             PERFORM 9800-SQL-ABEND                               13980072
000722     END-EVALUATE.                                                13990072
000964                                                                  14000072
000965******************************************************************14010072
000966 3600-WRITE-ITEM-REPORT.                                          14020072
000967******************************************************************14030072
000968                                                                  14040072
000969     WRITE SALES-REPORT-RECORD FROM D1-DETAIL-LINE-1 AFTER        14050072
000970                   ADVANCING 1 LINE.                              14060072
000971                                                                  14070072
000972******************************************************************15010072
000980 3700-CLOSE-ITEM.                                                 15020072
000990******************************************************************15030072
001000                                                                  15040072
001010     EXEC SQL                                                     15050072
001020          CLOSE ITEM-CURSOR                                       15060072
001030     END-EXEC.                                                    15070072
001040                                                                  15080072
001041     IF NOT SQLCODE = ZERO                                        15090072
001042        MOVE '3700-CLOSE-ITEM'        TO PV-PARAGRAPH-NAME        15100072
001043        MOVE SQLCODE                  TO PV-DB2-OPERATION         15110072
001044        PERFORM 9800-SQL-ABEND                                    15120072
001045     END-IF.                                                      15130072
001046                                                                  15140072
001047******************************************************************15150072
001048 3800-CLOSE-LID-CURSOR.                                           15160072
001049******************************************************************15170072
001050                                                                  15180072
001051     EXEC SQL                                                     15190072
001052          CLOSE LID-CURSOR                                        15200072
001053     END-EXEC.                                                    15210072
001054                                                                  15220072
001055     IF NOT SQLCODE = ZERO                                        15230072
001056        MOVE '3800-CLOSE-LID-CURSOR'  TO PV-PARAGRAPH-NAME        15240072
001057        MOVE SQLCODE                  TO PV-DB2-OPERATION         15250072
001058        PERFORM 9800-SQL-ABEND                                    15260072
001059     END-IF.                                                      15270072
001060                                                                  15280072
FIXDSC******************************************************************15290072
FIXDSC 3850-CLOSE-EID-CURSOR.                                           15300072
FIXDSC******************************************************************15310072
FIXDSC                                                                  15320072
FIXDSC     EXEC SQL                                                     15330072
FIXDSC          CLOSE EID-CURSOR                                        15340072
FIXDSC     END-EXEC.                                                    15350072
FIXDSC                                                                  15360072
FIXDSC     IF NOT SQLCODE = ZERO                                        15370072
FIXDSC        MOVE '3850-CLOSE-EID-CURSOR'  TO PV-PARAGRAPH-NAME        15380072
FIXDSC        MOVE SQLCODE                  TO PV-DB2-OPERATION         15390072
FIXDSC        PERFORM 9800-SQL-ABEND                                    15400072
FIXDSC     END-IF.                                                      15410072
FIXDSC                                                                  15420072
FIXDSC******************************************************************15570072
FIXDSC*     CHECK IF ORDER NUMBER FOUND                                 15580072
FIXDSC******************************************************************15590072
FIXDSC 4000-SELECT-ORDER-NUMBER.                                        15600072
FIXDSC                                                                  15610072
FIXDSC     SET PS-ORDER-NUMBER-FOUND-N TO TRUE.                         15620072
FIXDSC                                                                  15630072
FIXDSC     EXEC SQL                                                     15640072
FIXDSC        SELECT  ORD_NBR                                           15650072
FIXDSC          INTO :EPORD-ORD-NBR                                     15660072
FIXDSC          FROM  TEPORD                                            15670072
FIXDSC        WHERE PARTN_NBR         = :EPITM-PARTN-NBR                15680072
FIXDSC           AND STR_NBR          = :EPITM-STR-NBR                  15690072
FIXDSC           AND RGST_ID          = :EPITM-RGST-ID                  15700072
FIXDSC           AND TRN_NBR          = :EPITM-TRN-NBR                  15710072
FIXDSC           AND STRT_TM          = :EPITM-STRT-TM                  15720072
FIXDSC           AND SLS_CORR_SEQ_NBR = :EPITM-SLS-CORR-SEQ-NBR         15730072
FIXDSC        WITH UR                                                   15740072
FIXDSC     END-EXEC.                                                    15750072
FIXDSC                                                                  15760072
FIXDSC     EVALUATE TRUE                                                15770072
FIXDSC        WHEN SQLCODE = ZERO                                       15780072
FIXDSC            SET PS-ORDER-NUMBER-FOUND-Y TO TRUE                   15790072
FIXDSC        WHEN SQLCODE = +100                                       15800072
FIXDSC            SET PS-ORDER-NUMBER-FOUND-N TO TRUE                   15810072
FIXDSC        WHEN OTHER                                                15820072
FIXDSC            MOVE '4000-SELECT-ORDER-NUMBER'  TO PV-PARAGRAPH-NAME 15830072
FIXDSC            MOVE SQLCODE                     TO PV-DB2-OPERATION  15840072
FIXDSC            PERFORM 9800-SQL-ABEND                                15850072
FIXDSC     END-EVALUATE.                                                15860072
001070                                                                  15870072
001070******************************************************************15880072
001071* 8000-PRINT-HEADINGS                                             15890072
001072*     PRINT THE HEADINGS FOR THE REPORT.                          15900072
001073******************************************************************15910072
001074 8000-PRINT-HEADINGS.                                             15920072
001075                                                                  15930072
001076     ADD +1                      TO PV-PAGE-CNT.                  15940072
FIXDSC     MOVE PV-PAGE-CNT TO DP150-PAGE-NUMBER.                       15950072
FIXDSC     MOVE DP150-STANDRD-HEADER-150-COLS                           15960072
001079                                 TO PV-PRINT-RECORD.              15970072
001080     PERFORM 8100-WRITE-RPT-TOP-OF-PAGE.                          15980072
001081                                                                  15990072
001082     MOVE H1-HEADING-LINE-1      TO PV-PRINT-RECORD.              16000072
001083     MOVE +2                     TO PV-LINE-SPACING.              16010072
001084     PERFORM 8200-WRITE-REPORT-LINE.                              16020072
001085     ADD  PV-LINE-SPACING        TO PV-LINE-CNT.                  16030072
001086                                                                  16040072
001087     WRITE SALES-REPORT-RECORD FROM D4-BLANK-LINE AFTER           16050072
001088               ADVANCING 2 LINE.                                  16060072
001089                                                                  16070072
001090     IF PS-END-OF-ITEM-NO                                         16080072
001091        MOVE H2-HEADING-LINE-2      TO PV-PRINT-RECORD            16090072
001092        MOVE +2                     TO PV-LINE-SPACING            16100072
001093        PERFORM 8200-WRITE-REPORT-LINE                            16110072
001094        ADD  PV-LINE-SPACING        TO PV-LINE-CNT                16120072
001095     END-IF.                                                      16130072
001096                                                                  16140072
001097******************************************************************16150072
001098* 8100-WRITE-RPT-TOP-OF-PAGE                                      16160072
001099*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   16170072
001100******************************************************************16180072
001101 8100-WRITE-RPT-TOP-OF-PAGE.                                      16190072
001102                                                                  16200072
001103     WRITE SALES-REPORT-RECORD                                    16210072
001104       FROM PV-PRINT-RECORD                                       16220072
001105         AFTER ADVANCING PAGE.                                    16230072
001106                                                                  16240072
001107     MOVE +3                     TO PV-LINE-CNT.                  16250072
001108                                                                  16260072
001109******************************************************************16270072
001110* 8200-WRITE-REPORT-LINE                                          16280072
001111*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             16290072
001112******************************************************************16300072
001113 8200-WRITE-REPORT-LINE.                                          16310072
001114                                                                  16320072
001115     WRITE SALES-REPORT-RECORD                                    16330072
001116       FROM PV-PRINT-RECORD                                       16340072
001117         AFTER ADVANCING PV-LINE-SPACING.                         16350072
001118                                                                  16360072
001119     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          16370072
001120                                                                  16380072
001121                                                                  16390072
001122******************************************************************16400072
001123 9800-SQL-ABEND.                                                  16410072
001124*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.16420072
001125******************************************************************16430072
001126     DISPLAY '** ABEND     **'.                                   16440072
001127     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        16450072
001128     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              16460072
001129     DISPLAY '** SQLCODE   ** = ' PV-DB2-OPERATION.               16470072
001130     DISPLAY '** PARTITION ** = ' EPTRN-PARTN-NBR                 16480072
001131     DISPLAY '** STORE     ** = ' EPTRN-STR-NBR                   16490072
001132     DISPLAY '** REGISTER  ** = ' EPTRN-RGST-ID                   16500072
001133     DISPLAY '** TRANSACT  ** = ' EPTRN-TRN-NBR                   16510072
001134                                                                  16520072
001135******************************************************************16530072
001136* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     16540072
001137* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      16550072
001138******************************************************************16560072
001139     COPY DPPD004.                                                16570072
001140                                                                  16580072
001141     SET AC-DB2-ERROR TO TRUE.                                    16590072
001142     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         16600072
001143                                                                  16610072
001144******************************************************************16620072
001145*9999-ABEND.                                                      16630072
001146*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  16640072
001147******************************************************************16650072
001148 9999-ABEND.                                                      16660072
001149     DISPLAY '** ABEND           **'.                             16670072
001150     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  16680072
001151     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        16690072
001152     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       16700072
001153     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       16710072
001154     DISPLAY '** PARTITION       ** = ' EPITM-PARTN-NBR           16720072
001155     DISPLAY '** STORE           ** = ' EPITM-STR-NBR             16730072
001156     DISPLAY '** REGISTER        ** = ' EPITM-RGST-ID             16740072
001157     DISPLAY '** TRANSACTION     ** = ' EPITM-TRN-NBR             16750072
001158     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         16760072
001159                                                                  16770072
