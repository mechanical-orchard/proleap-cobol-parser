000900 IDENTIFICATION DIVISION.                                         00010000
001000 PROGRAM-ID.         XMKRP030.                                    00020000
001100 AUTHOR.             BOB MCASEY.                                  00030000
001200 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
001300 DATE-WRITTEN.       02-07-2003.                                  00050000
001400 DATE-COMPILED.                                                   00060000
001510***************************************************************** 00070002
001520*  COMPARES DATA FROM DOMAIN TABLE AND RMS TABLE                  00080001
001530*  FOR THE XMT_TERR TABLE.                                        00090001
001540***************************************************************** 00100002
      *---------------------------------------------------------------* 00110002
      *    WR/PITS#     DATE        DESCRIPTION                       * 00120002
      *    --------   ----------   ---------------------------------  * 00130002
      *    WR24442    08/20/2003   INITIAL CREATION.                  * 00140002
      *---------------------------------------------------------------* 00150002
001550                                                                  00160000
001600 ENVIRONMENT DIVISION.                                            00170000
001700                                                                  00180000
001800 CONFIGURATION SECTION.                                           00190000
001900                                                                  00200000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00210000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00220000
002200                                                                  00230000
002300 INPUT-OUTPUT SECTION.                                            00240000
002400                                                                  00250000
002500 FILE-CONTROL.                                                    00260000
002600                                                                  00270000
002700     SELECT XMT-INPUT-FILE       ASSIGN TO INP01.                 00280001
002800     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00290000
002900     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00300000
003000                                                                  00310000
003100 DATA DIVISION.                                                   00320000
003200                                                                  00330000
003300 FILE SECTION.                                                    00340000
003400                                                                  00350000
003500 FD  RMS-INPUT-FILE                                               00360000
003600     RECORDING MODE IS F                                          00370000
003700     BLOCK CONTAINS 0 RECORDS                                     00380000
003800     LABEL RECORDS ARE OMITTED.                                   00390000
003900 01  RMS-INPUT-RECORD                    PIC  X(57).              00400000
004000                                                                  00410000
004100 FD  XMT-INPUT-FILE                                               00420001
004200     RECORDING MODE IS F                                          00430000
004300     BLOCK CONTAINS 0 RECORDS                                     00440000
004400     LABEL RECORDS ARE OMITTED.                                   00450000
004500 01  XMT-INPUT-RECORD                    PIC  X(57).              00460001
004600                                                                  00470000
004700 FD  ERROR-REPORT                                                 00480000
004800     RECORDING MODE IS F                                          00490000
004900     BLOCK CONTAINS 0 RECORDS                                     00500000
005000     LABEL RECORDS ARE OMITTED.                                   00510000
005100 01  ERR-RPT-LINE                        PIC  X(200).             00520000
005200                                                                  00530000
005300 WORKING-STORAGE SECTION.                                         00540000
005400                                                                  00550000
006300 01 PC-PROGRAM-CONSTANTS.                                         00560000
006400     05 PC-PGM-NAME           PIC X(08)  VALUE 'XMKRP030'.        00570000
006500                                                                  00580000
006600 01 PV-PROGRAM-VARIABLES.                                         00590000
006700     05 PV-XMT-KEY.                                               00600001
006800        10 PV-XMT-TERR-NBR       PIC 9(04).                       00610001
006900     05 PV-XMT-TERR-NM           PIC X(20) VALUE SPACE.           00620001
006910     05 PV-XMT-TERR-MGR-NM       PIC X(32) VALUE SPACE.           00630001
007000                                                                  00640000
007100     05 PV-RMS-KEY.                                               00650000
007200         10 PV-RMS-TERR-NBR       PIC 9(04).                      00660000
007300     05 PV-RMS-TERR-NM            PIC X(20) VALUE SPACE.          00670000
007310     05 PV-RMS-TERR-MGR-NM        PIC X(32) VALUE SPACE.          00680000
007400                                                                  00690000
007500     05 PV-PAGE-CNT               PIC S9(05)  VALUE ZERO.         00700000
007600     05 PV-LINE-CNT               PIC S9(04)  COMP VALUE ZERO.    00710000
007700     05 PV-MAX-LINES              PIC S9(04)  COMP VALUE +71.     00720000
007800                                                                  00730000
007900     05 PV-DISPLAY-CNT            PIC ZZZZ9.                      00740000
008000     05 PV-NBR-ERRORS             PIC S9(04)  COMP                00750000
008100                                                VALUE ZERO.       00760000
008200     05 PV-DATE-YYMMDD.                                           00770000
008300          10 PV-YYMMDD-YY       PIC X(02)  VALUE SPACE.           00780000
008400          10 PV-YYMMDD-MM       PIC X(02)  VALUE SPACE.           00790000
008500          10 PV-YYMMDD-DD       PIC X(02)  VALUE SPACE.           00800000
008600     05 PV-TIME-HHMMSS.                                           00810000
008700          10 PV-HHMMSS-HH       PIC X(02)  VALUE SPACE.           00820000
008800          10 PV-HHMMSS-MM       PIC X(02)  VALUE SPACE.           00830000
008900          10 PV-HHMMSS-SS       PIC X(02)  VALUE SPACE.           00840000
009000     05 PV-MESSAGE              PIC X(58)  VALUE SPACE.           00850000
009100                                                                  00860000
009200 01 RPT-TOTAL-LINE.                                               00870000
009300     05 FILLER     PIC  X(23) VALUE                               00880000
009400                         'TOTAL NUMBER OF ERRORS '.               00890000
009500     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00900000
009600                                                                  00910000
009700 01 RPT-END-OF-REPORT-LINE.                                       00920000
009800     05 FILLER     PIC  X(21) VALUE                               00930000
009900                            '*** END OF REPORT ***'.              00940000
010000 01 PA-PROGRAM-ACCUMULATORS.                                      00950000
010100     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              00960000
010200     05 PA-XMT-RECS-READ       PIC 9(13) VALUE ZERO.              00970001
010300     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              00980000
010400                                                                  00990000
010500 01 PS-PROGRAM-SWITCHES.                                          01000000
010600     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01010000
010700         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           01020000
010800         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           01030000
010900     05 PS-MORE-XMT-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01040001
011000         88 PS-MORE-XMT-INPUT-RECS           VALUE 'Y'.           01050001
011100         88 PS-END-OF-XMT-INPUT-RECS         VALUE 'N'.           01060001
011200     05 PS-RMS-OR-XMT-ERR        PIC X(01)   VALUE '0'.           01070001
011300         88 PS-RMS-ERROR                     VALUE '1'.           01080000
011400         88 PS-XMT-ERROR                     VALUE '2'.           01090001
011500         88 PS-DATA-ERROR                    VALUE '3'.           01100000
011600                                                                  01110000
011700 01 RPT-REPORT-HEADING.                                           01120000
011800     05 FILLER     PIC  X(84)    VALUE SPACES.                    01130000
011900     05 FILLER     PIC  X(37)    VALUE                            01140000
012000         'XM TERRITORY DATA INTEGRITY ERRORS'.                    01150001
012100                                                                  01160000
012200 01 RPT-COL-HEADING-1.                                            01170000
012300     05 FILLER     PIC  X(01) VALUE SPACE.                        01180000
012400     05 FILLER     PIC  X(02) VALUE ALL '-'.                      01190000
012500     05 FILLER     PIC  X(03) VALUE 'KEY'.                        01200000
012600     05 FILLER     PIC  X(02) VALUE ALL '-'.                      01210000
012700                                                                  01220000
012800 01 RPT-COL-HEADING-2.                                            01230000
012900     05 FILLER     PIC  X(01) VALUE SPACE.                        01240000
013000     05 FILLER     PIC  X(19) VALUE 'TERR_NBR'.                   01250000
013010     05 FILLER     PIC  X(03) VALUE SPACE.                        01260000
013100     05 FILLER     PIC  X(34) VALUE 'XM DOMAIN'.                  01270001
013200     05 FILLER     PIC  X(24) VALUE SPACE.                        01280000
013210     05 FILLER     PIC  X(41) VALUE 'RMS'.                        01290001
013220     05 FILLER     PIC  X(11) VALUE SPACE.                        01300000
013300     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    01310000
013400                                                                  01320000
013500 01 RPT-COL-HEADING-3.                                            01330000
013700     05 FILLER     PIC  X(12) VALUE SPACE.                        01340000
013800     05 FILLER     PIC  X(07) VALUE 'TERR_NM'.                    01350000
013801     05 FILLER     PIC  X(17) VALUE SPACE.                        01360000
013810     05 FILLER     PIC  X(11) VALUE 'TERR_MGR_NM'.                01370000
013811     05 FILLER     PIC  X(26) VALUE SPACE.                        01380000
013820     05 FILLER     PIC  X(07) VALUE 'TERR_NM'.                    01390000
013830     05 FILLER     PIC  X(17) VALUE SPACE.                        01400000
013840     05 FILLER     PIC  X(11) VALUE 'TERR_MGR_NM'.                01410000
014000                                                                  01420000
014100 01 RPT-COL-HEADING-4.                                            01430000
014200     05 FILLER     PIC  X(180) VALUE ALL '-'.                     01440000
014300                                                                  01450000
014400 01 DL-DETAIL-LINE.                                               01460000
014500     05 FILLER              PIC  X(01) VALUE SPACE.               01470000
014600     05 DL-TERR-NBR         PIC  X(04) VALUE SPACE.               01480000
014700     05 FILLER              PIC  X(06) VALUE SPACE.               01490000
014800     05 DL-XMT-TERR-NM      PIC  X(20) VALUE SPACE.               01500001
014810     05 FILLER              PIC  X(04) VALUE SPACE.               01510000
014820     05 DL-XMT-TERR-MGR-NM  PIC  X(32) VALUE SPACE.               01520001
014900     05 FILLER              PIC  X(06) VALUE SPACE.               01530000
015000     05 DL-RMS-TERR-NM      PIC  X(20) VALUE SPACE.               01540000
015010     05 FILLER              PIC  X(04) VALUE SPACE.               01550000
015020     05 DL-RMS-TERR-MGR-NM  PIC  X(32) VALUE SPACE.               01560000
015100     05 FILLER              PIC  X(04) VALUE SPACE.               01570000
015200     05 DL-MESSAGE          PIC  X(67) VALUE SPACE.               01580000
015300                                                                  01590000
005500     COPY HORD007.                                                01600002
005600                                                                  01610001
005700     COPY DPWS200O.                                               01620002
005800                                                                  01630001
005900 01 XMT-REC.                                                      01640001
006000     05 XMT-TERR-NBR          PIC S9(04) COMP-3.                  01650001
006100     05 XMT-TERR-NM           PIC X(20) VALUE SPACE.              01660001
006110     05 XMT-TERR-MGR-NM       PIC X(32) VALUE SPACE.              01670001
006200                                                                  01680001
015310******************************************************************01690000
015400 PROCEDURE DIVISION.                                              01700000
015410******************************************************************01710000
015600 0000-MAIN-MODULE.                                                01720000
015700                                                                  01730000
015800       OPEN INPUT RMS-INPUT-FILE                                  01740000
015900                  XMT-INPUT-FILE                                  01750001
016000            OUTPUT ERROR-REPORT.                                  01760000
016100                                                                  01770000
016200       PERFORM 1000-INITIALIZE.                                   01780000
016300       PERFORM 7000-READ-XMT-INPUT-FILE.                          01790001
016400       PERFORM 7100-READ-RMS-INPUT-FILE.                          01800000
016500                                                                  01810000
016600       PERFORM 2000-PROCESS-RECS                                  01820000
016700          UNTIL (PS-END-OF-XMT-INPUT-RECS                         01830001
016800            AND PS-END-OF-RMS-INPUT-RECS).                        01840000
016900                                                                  01850000
017000       PERFORM 8400-WRITE-TOTALS.                                 01860000
017100                                                                  01870000
017200       CLOSE RMS-INPUT-FILE                                       01880000
017300             XMT-INPUT-FILE                                       01890001
017400             ERROR-REPORT.                                        01900000
017500                                                                  01910000
017600       DISPLAY '**** XMKRP030 STATISTICS ****'                    01920000
017700       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     01930000
017800       DISPLAY 'TOTAL XMT RECORDS READ : ' PA-XMT-RECS-READ.      01940001
017900       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      01950000
018000       DISPLAY ' '                                                01960000
018100                                                                  01970000
018200       STOP RUN.                                                  01980000
018300                                                                  01990000
018400 1000-INITIALIZE.                                                 02000000
018500                                                                  02010000
018600       ACCEPT PV-DATE-YYMMDD FROM DATE.                           02020000
018700       MOVE PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      02030000
018800       MOVE PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     02040000
018900       MOVE PV-YYMMDD-DD TO DP200O-RUN-DAY.                       02050000
019000                                                                  02060000
019100       ACCEPT PV-TIME-HHMMSS FROM TIME.                           02070000
019200       MOVE PV-HHMMSS-HH TO DP200O-RUN-HOUR.                      02080000
019300       MOVE PV-HHMMSS-MM TO DP200O-RUN-MINUTE.                    02090000
019400       MOVE PC-PGM-NAME TO DP200O-PROGRAM-NAME.                   02100000
019500       MOVE 1        TO DP200O-REPORT-NUMBER.                     02110000
019600                                                                  02120000
019700       PERFORM 8100-WRITE-STD-RPT-HEADING.                        02130000
019800       PERFORM 8200-WRITE-REPORT-HEADING.                         02140000
019900       PERFORM 8300-WRITE-COLUMN-HEADING.                         02150000
020000                                                                  02160000
020100 2000-PROCESS-RECS.                                               02170000
020200                                                                  02180000
020300       MOVE HO007-TERR-NBR      TO  PV-RMS-TERR-NBR.              02190000
020400       MOVE HO007-TERR-NM       TO  PV-RMS-TERR-NM.               02200000
020410       MOVE HO007-TERR-MGR-NM   TO  PV-RMS-TERR-MGR-NM.           02210000
020500                                                                  02220000
020600       MOVE XMT-TERR-NBR        TO  PV-XMT-TERR-NBR.              02230001
020700       MOVE XMT-TERR-NM         TO  PV-XMT-TERR-NM.               02240001
020710       MOVE XMT-TERR-MGR-NM     TO  PV-XMT-TERR-MGR-NM.           02250001
020800                                                                  02260000
021800     IF PV-XMT-KEY = PV-RMS-KEY                                   02270001
022000        PERFORM 3000-COMPARE-FIELDS                               02280000
022100        PERFORM 7000-READ-XMT-INPUT-FILE                          02290001
022200        PERFORM 7100-READ-RMS-INPUT-FILE                          02300000
022300      ELSE                                                        02310000
022310          IF ((PV-RMS-KEY < PV-XMT-KEY)                           02320001
022320             OR PS-END-OF-XMT-INPUT-RECS) AND                     02330001
022330             PS-MORE-RMS-INPUT-RECS                               02340000
022340             MOVE '1' TO PS-RMS-OR-XMT-ERR                        02350001
022350             MOVE 'KEY ON RMS TABLE ONLY'                         02360001
022360                 TO PV-MESSAGE                                    02370000
022370             PERFORM 8000-WRITE-OUTPUT-REC                        02380000
022380             PERFORM 7100-READ-RMS-INPUT-FILE                     02390000
022390          ELSE                                                    02400000
022400              IF (PV-RMS-KEY > PV-XMT-KEY                         02410001
022500                   OR PS-END-OF-RMS-INPUT-RECS)                   02420000
022600                  AND PS-MORE-XMT-INPUT-RECS                      02430001
022700                  MOVE '2' TO PS-RMS-OR-XMT-ERR                   02440001
022800                  MOVE 'KEY ON XM DOMAIN TABLE ONLY'              02450001
022810                                                   TO PV-MESSAGE  02460000
022900                  PERFORM 8000-WRITE-OUTPUT-REC                   02470000
023000                  PERFORM 7000-READ-XMT-INPUT-FILE                02480001
023100              END-IF                                              02490000
023200          END-IF                                                  02500000
023300      END-IF.                                                     02510000
023400                                                                  02520000
023500 3000-COMPARE-FIELDS.                                             02530000
023600                                                                  02540000
023700      EVALUATE TRUE                                               02550000
023800         WHEN PV-RMS-TERR-NM  NOT = PV-XMT-TERR-NM                02560001
023900             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02570001
024000             MOVE 'TERRITORY NAME DATA DOES NOT MATCH'            02580000
024100                                                TO PV-MESSAGE     02590000
024200             PERFORM 8000-WRITE-OUTPUT-REC                        02600000
024210         WHEN PV-RMS-TERR-MGR-NM  NOT = PV-XMT-TERR-MGR-NM        02610001
024220             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02620001
024230             MOVE 'TERRITORY MANAGER NAME DOES NOT MATCH'         02630000
024240                                                TO PV-MESSAGE     02640000
024250             PERFORM 8000-WRITE-OUTPUT-REC                        02650000
024300      END-EVALUATE.                                               02660000
024400                                                                  02670000
024500 7000-READ-XMT-INPUT-FILE.                                        02680001
024600                                                                  02690000
024700       INITIALIZE XMT-REC.                                        02700001
024800                                                                  02710000
024900       READ XMT-INPUT-FILE INTO XMT-REC                           02720001
025000           AT END SET PS-END-OF-XMT-INPUT-RECS TO TRUE.           02730001
025100                                                                  02740000
025200       ADD 1 TO PA-XMT-RECS-READ.                                 02750001
025300                                                                  02760000
025400 7100-READ-RMS-INPUT-FILE.                                        02770000
025500                                                                  02780000
025600       INITIALIZE HO007-TERRITORY-DATA.                           02790000
025700                                                                  02800000
025800       READ RMS-INPUT-FILE INTO HO007-TERRITORY-DATA              02810000
025900            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          02820000
026000                                                                  02830000
026100       ADD 1 TO PA-RMS-RECS-READ.                                 02840000
026200                                                                  02850000
026300 8000-WRITE-OUTPUT-REC.                                           02860000
026500                                                                  02870000
026600       IF PS-RMS-ERROR                                            02880000
026700          MOVE SPACES TO DL-DETAIL-LINE                           02890000
026800          MOVE PV-RMS-TERR-NBR      TO DL-TERR-NBR                02900000
026810          MOVE PV-RMS-TERR-NM       TO DL-RMS-TERR-NM             02910000
026900          MOVE PV-RMS-TERR-MGR-NM   TO DL-RMS-TERR-MGR-NM         02920000
027000          MOVE PV-MESSAGE TO DL-MESSAGE                           02930000
027100       ELSE                                                       02940000
027200          IF PS-XMT-ERROR                                         02950001
027300             MOVE SPACES TO DL-DETAIL-LINE                        02960000
027400             MOVE PV-XMT-TERR-NBR    TO DL-TERR-NBR               02970001
027410             MOVE PV-XMT-TERR-NM     TO DL-XMT-TERR-NM            02980001
027500             MOVE PV-XMT-TERR-MGR-NM TO DL-XMT-TERR-MGR-NM        02990001
027600             MOVE PV-MESSAGE TO DL-MESSAGE                        03000000
027700          ELSE                                                    03010000
027800             MOVE SPACES TO DL-DETAIL-LINE                        03020000
027900             MOVE PV-RMS-TERR-NBR     TO DL-TERR-NBR              03030000
027910             MOVE PV-RMS-TERR-NM      TO DL-RMS-TERR-NM           03040000
028000             MOVE PV-RMS-TERR-MGR-NM  TO DL-RMS-TERR-MGR-NM       03050000
028100             MOVE PV-XMT-TERR-NM      TO DL-XMT-TERR-NM           03060001
028110             MOVE PV-XMT-TERR-MGR-NM  TO DL-XMT-TERR-MGR-NM       03070001
028200             MOVE PV-MESSAGE TO DL-MESSAGE                        03080000
028300          END-IF                                                  03090000
028400       END-IF.                                                    03100000
028500                                                                  03110000
028600       IF PV-LINE-CNT > PV-MAX-LINES                              03120000
028700          PERFORM 8100-WRITE-STD-RPT-HEADING                      03130000
028800          PERFORM 8200-WRITE-REPORT-HEADING                       03140000
028900          PERFORM 8300-WRITE-COLUMN-HEADING                       03150000
029000       END-IF.                                                    03160000
029100                                                                  03170000
029200       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     03180000
029300             AFTER ADVANCING 1 LINE.                              03190000
029400       ADD +1 TO PV-LINE-CNT.                                     03200000
029500                                                                  03210000
029510       MOVE 4095 TO RETURN-CODE.                                  03220000
029600       ADD 1 TO PA-ERROR-MESSAGES.                                03230000
029700                                                                  03240000
029800 8100-WRITE-STD-RPT-HEADING.                                      03250000
029900                                                                  03260000
030000       ADD 1  TO PV-PAGE-CNT.                                     03270000
030100       MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                    03280000
030200       WRITE ERR-RPT-LINE FROM DP200O-STANDRD-HEADER-200-COLS     03290000
030300             AFTER ADVANCING PAGE.                                03300000
030400       MOVE +1 TO PV-LINE-CNT.                                    03310000
030500                                                                  03320000
030600 8200-WRITE-REPORT-HEADING.                                       03330000
030700                                                                  03340000
030800       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 03350000
030900            AFTER ADVANCING 1 LINES.                              03360000
031000       ADD +1 TO PV-LINE-CNT.                                     03370000
031100                                                                  03380000
031200 8300-WRITE-COLUMN-HEADING.                                       03390000
031300                                                                  03400000
031400       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  03410000
031500            AFTER ADVANCING 2 LINES.                              03420000
031600       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  03430000
031700            AFTER ADVANCING 1 LINES.                              03440000
031800       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  03450000
031900            AFTER ADVANCING 1 LINES.                              03460000
032000       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  03470000
032100            AFTER ADVANCING 1 LINES.                              03480000
032200       ADD +5 TO PV-LINE-CNT.                                     03490000
032300                                                                  03500000
032400 8400-WRITE-TOTALS.                                               03510000
032500                                                                  03520000
032600      IF PV-LINE-CNT > PV-MAX-LINES                               03530000
032700         PERFORM 8100-WRITE-STD-RPT-HEADING                       03540000
032800         PERFORM 8200-WRITE-REPORT-HEADING                        03550000
032900         PERFORM 8300-WRITE-COLUMN-HEADING                        03560000
033000      END-IF.                                                     03570000
033100                                                                  03580000
033200      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    03590000
033300      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      03600000
033400            AFTER ADVANCING 2 LINES.                              03610000
033500      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              03620000
033600            AFTER ADVANCING 1 LINES.                              03630000
033700                                                                  03640000
