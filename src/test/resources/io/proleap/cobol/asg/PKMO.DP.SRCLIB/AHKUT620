000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    AHKUT620.                                         00020016
000300 AUTHOR.        BUDDY BARNES.                                     00030000
000400 INSTALLATION.  KOHLS.                                            00040000
000500 DATE-WRITTEN   DEC, 2010.                                        00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080000
000900*  AHKUT620.   "ARCHIVE HISTORY" PROJECT. DATA OFFLOAD.          *00090016
001000*                                                                *00100000
001000*                                                                *00101005
001100*  PURPOSE:                                                      *00110000
001200*  THIS PROGRAM BEGINS THE PROCESS OF CREATING A DRIVER FILE.    *00120000
001300*  ONCE COMPLETED, THE DRIVER FILE WILL BE USED BY SUBSEQUENT    *00130000
001400*  PROGRAMS TO IDENTIFY AND EXTRACT CONTAINER DATA               *00140000
001500*  FROM SEVERAL INTERRELATED TABLES, FOR ARCHIVING.              *00150000
001600*                                                                *00160000
001700*  PROCESSING OVERVIEW:                                          *00170000
001800*  THIS PROGRAM ACCESSES TIMCNTK AND BASED ON A CONTROL CARD DATE*00180000
001900*  APPLIES SELECTION CRITERIA, CREATING AN OUTPUT FILE           *00190000
002000*  OF RECORDS CONTAINING:                                        *00200000
002100*  1) THE FULL ROW OF DATA FROM TIMCNTK                          *00210000
002200*  THESE RECORDS ARE SORTED FOR EASE                             *00220015
002300*  AND EFFICIENCY OF SUBSEQUENT PROCESSING.                      *00230000
002400*                                                                *00240000
002500*  FOR EACH CONTAINER RETURNED, THE FULL ROW OF DATA IS WRITTEN  *00250000
002600*  TO THE EXTRACT FILE TO BE USED FOR ARCHIVING AND DELETING.    *00260000
003000******************************************************************00300000
006020******************************************************************00600600
006030 ENVIRONMENT DIVISION.                                            00600700
006040 CONFIGURATION SECTION.                                           00600800
006050 SOURCE-COMPUTER.        IBM-3090.                                00600900
006060 OBJECT-COMPUTER.        IBM-3090.                                00601000
006070                                                                  00602000
006080 INPUT-OUTPUT SECTION.                                            00603000
006090 FILE-CONTROL.                                                    00604000
006100                                                                  00605000
006200     SELECT  OUT-DRIVER-FILE              ASSIGN TO OUT01.        00606000
006300                                                                  00607000
006400 DATA DIVISION.                                                   00608000
006500 FILE SECTION.                                                    00609000
006600                                                                  00610000
006700 FD  OUT-DRIVER-FILE                                              00620000
006800     RECORDING MODE IS F                                          00630000
006900     LABEL RECORDS ARE STANDARD                                   00640000
007000     BLOCK CONTAINS 0 RECORDS.                                    00650000
007100 01  OUT-DRIVER-RECORD               PIC  X(672).                 00660010
007200                                                                  00670000
007300 WORKING-STORAGE SECTION.                                         00680000
007400                                                                  00690000
007500 01  PC-PROGRAM-CONSTANTS.                                        00700000
007600     05  PC-CURRENT-PROGRAM-NAME     PIC X(08) VALUE 'AHKUT620'.  00710015
007700     05  PC-PGM-PROGRESS-DESC.                                    00720000
007800         10  PC-BEGINNING            PIC X(09) VALUE 'BEGINNING'. 00730000
007800         10  PC-CONTINUING           PIC X(10) VALUE 'CONTINUING'.00740000
008500         10  PC-ENDING               PIC X(06) VALUE 'ENDING'.    00800000
008600         10  PC-ABENDING             PIC X(08) VALUE 'ABENDING'.  00810000
008700     05  PC-ABEND-INFO.                                           00820000
008800         10  PC-ABEND                PIC X(11) VALUE              00830000
008900                                               '** ABEND **'.     00840000
009000         10  PC-ABEND-MSG-PARA       PIC X(15) VALUE              00850000
009100                                               '- PARA       : '. 00860000
009200         10  PC-ABEND-MSG-DISPLAY-PARA                            00870000
009300                                     PIC X(15) VALUE              00880000
009400                                               '  CALLED PARA: '. 00890000
009500         10  PC-ABEND-MSG-NUMBER     PIC X(15) VALUE              00900000
009600                                               '  FOR ABEND# : '. 00910000
009700         10  PC-ABEND-MSG-DESC       PIC X(15) VALUE              00920000
009800                                               '- ERROR IS   : '. 00930000
009900         10  PC-ABEND-MSG-INDENT-15  PIC X(15) VALUE SPACES.      00940000
010000         10  PC-ABEND-MSG-ACTION     PIC X(15) VALUE              00950000
010100                                               '- ACTION     : '. 00960000
010200     05  PC-TEST-AND-SET-NULL-IND.                                00970000
010300         10  PC-NOT-NULL             PIC S9(4) COMP               00980000
010400                                               VALUE ZERO.        00990000
010500         10  PC-NULL                 PIC S9(4) COMP               01000000
010600                                               VALUE -1.          01010000
010700         10  PC-NULL-CONV-ERR        PIC S9(4) COMP               01020000
010800                                               VALUE -2.          01030000
010900         10  PC-NULLIF-QUESTION-MARK PIC X(01) VALUE '?'.         01040000
011000                                                                  01050000
011100     05  PC-HOW-OFTEN-TO-DISPLAY     PIC 9(9)  VALUE 010000.      01060014
011200                                                                  01070000
011300 01  PS-PROGRAM-SWITCHES.                                         01080000
011400     05  PS-TABLE-LOOP-DONE-SW       PIC X(01) VALUE 'N'.         01090000
011500         88  PS-TABLE-LOOP-DONE                VALUE 'Y'.         01100000
011600         88  PS-TABLE-LOOP-NOT-DONE            VALUE 'N'.         01110000
012000                                                                  01150000
012100 01  PV-PROGRAM-VARIABLES.                                        01160000
012400     05  DISPLAY-CNTR-NBR            PIC  X(12) VALUE SPACES.     01190010
013600     05  PV-FUNC-QTY                  PIC S9(09) COMP.            01191018
012500     05  PV-PRG-TMST                 PIC X(26) VALUE SPACES.      01200001
012600     05  PV-PRG-TMST-DETAIL REDEFINES PV-PRG-TMST.                01210001
012700         10  PV-PRG-DATE             PIC X(10).                   01220001
012800         10  PV-PRG-TIME             PIC X(16).                   01230001
013000     05  PV-TABLE-ROW-FETCHED-CNT    PIC  9(9) VALUE 0.           01250000
013100     05  PV-DRIVER-WRITTEN-CNT       PIC  9(9) VALUE 0.           01260000
013800     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.      01330000
013900     05  PV-DB2-OPERATION-MSG-1      PIC X(79) VALUE SPACES.      01340000
014000     05  PV-DB2-TABLE-NAME-1         PIC X(18) VALUE SPACES.      01350000
014100     05  PV-DB2-TABLE-NAME-2         PIC X(18) VALUE SPACES.      01360000
014200     05  PV-DISPLAY-NTH-MULTIPLE     PIC 9(9)  VALUE 0.           01370000
014300     05  PV-DISPLAY-NTH-REMAINDER    PIC 9(9)  VALUE 0.           01380000
014400     05  PV-SQLCODE                  PIC +999  VALUE ZERO.        01390000
014500                                                                  01400000
014600     05  PV-TMST                     PIC X(26) VALUE SPACES.      01410000
014700     05  PV-TIMESTAMP-DETAIL                                      01420000
014800         REDEFINES                                                01430000
014900         PV-TMST.                                                 01440000
015000         10  PV-TIMESTAMP-19.                                     01450000
015100             15  PV-TMS-DATE.                                     01460000
015200                 20  PV-TMS-YEAR.                                 01470000
015300                     25  PV-TMS-CC   PIC X(02).                   01480000
015400                     25  PV-TMS-YY   PIC X(02).                   01490000
015500                 20  FILLER          PIC X(01).                   01500000
015600                 20  PV-TMS-MONTH    PIC X(02).                   01510000
015700                 20  FILLER          PIC X(01).                   01520000
015800                 20  PV-TMS-DAY      PIC X(02).                   01530000
015900             15  FILLER              PIC X(01).                   01540000
016000             15  PV-TMS-HOUR         PIC X(02).                   01550000
016100             15  FILLER              PIC X(01).                   01560000
016200             15  PV-TMS-MINUTE       PIC X(02).                   01570000
016300             15  FILLER              PIC X(01).                   01580000
016400             15  PV-TMS-SECOND       PIC X(02).                   01590000
016500         10  FILLER                  PIC X(01).                   01600000
016600         10  PV-TMS-MSECOND          PIC X(06).                   01610000
016800                                                                  01630000
018200*---------------------------------------------------------------* 01770000
018300*  RECORD LAYOUT FOR DRIVER FILE.                               * 01780000
018400*---------------------------------------------------------------* 01790000
018500     COPY AHRD007.                                                01800001
018700                                                                  01820000
018800 01  DM-DISPLAY-MESSAGE.                                          01830000
018900     05  DM-01-10.                                                01840000
019000         10  DM-PROGRAM              PIC X(08) VALUE SPACE.       01850000
019100         10  FILLER                  PIC X(02) VALUE ': '.        01860000
019200     05  DM-11-80.                                                01870000
019300         10  FILLER                  PIC X(27) VALUE              01880000
019400                                    'BEGIN DRIVER FILE CREATION.'.01890000
019500         10  FILLER                  PIC X(01) VALUE SPACE.       01900000
019600         10  FILLER                  PIC X(42) VALUE ALL '*'.     01910000
019700     05  DM-81-120.                                               01920000
019800         10  FILLER                  PIC X(40) VALUE ALL '*'.     01930000
019900                                                                  01940000
020000 01  DP-DISPLAY-PROGRESS-MSG.                                     01950000
020100     05  DP-PROGRAM                  PIC X(08) VALUE SPACE.       01960000
020200     05  FILLER                      PIC X(02) VALUE SPACE.       01970000
020300     05  DP-STATUS-DESCRIPTION       PIC X(13) VALUE SPACE.       01980000
020400     05  FILLER                      PIC X(04) VALUE ' AT '.      01990000
020500     05  DP-TIMESTAMP                PIC X(26) VALUE SPACE.       02000000
020600     05  FILLER                      PIC X(03) VALUE '.  '.       02010000
020700     05  FILLER                      PIC X(09) VALUE 'FETCHES: '. 02020000
020800     05  DP-TABLE-ROW-FETCHED-CNT    PIC ZZZ,ZZZ,ZZ9              02030000
020900                                               VALUE ZERO.        02040000
021000     05  FILLER                      PIC X(02) VALUE ', '.        02050000
021100     05  FILLER                      PIC X(09) VALUE 'WRITTEN: '. 02060000
021200     05  DP-DRIVER-WRITTEN-CNT       PIC ZZZ,ZZZ,ZZ9              02070000
021300                                               VALUE ZERO.        02080000
021400     05  FILLER                      PIC X(01) VALUE '.'.         02090000
021500                                                                  02100000
021600 01  ABEND-CODE                      PIC S9(04)                   02110000
021700                                               VALUE ZEROES.      02120020
022000*---------------------------------------------------------------* 02150000
022100*  DB2 FORMATTED MESSAGE AREA                                     02160000
022200*---------------------------------------------------------------* 02170000
022300     COPY DPWS004.                                                02180000
022400                                                                  02180117
022500*---------------------------------------------------------------* 02180217
022600*    DB2 AREA FOR TIMCNTK                                       * 02180317
022700*---------------------------------------------------------------* 02180417
022800     EXEC SQL                                                     02180517
022900          INCLUDE TIMCNTK                                         02180617
023000     END-EXEC.                                                    02180717
023100                                                                  02180817
023200*---------------------------------------------------------------* 02180917
023300*    DB2 AREA FOR SYSDUMMY                                      * 02181017
023400*---------------------------------------------------------------* 02181117
023500     EXEC SQL                                                     02181217
023600          INCLUDE SYSDUMMY                                        02181317
023700     END-EXEC.                                                    02181417
023800                                                                  02181517
033500******************************************************************02181619
033600*    TKRPRPM TABLE                                                02181719
033700******************************************************************02181819
033800     EXEC SQL                                                     02181919
033900          INCLUDE TKRPRPM                                         02182019
034000     END-EXEC.                                                    02182119
034100*                                                                 02182219
023900*---------------------------------------------------------------* 02182317
024000*    DB2 AREA FOR COMMUNICATIONS                                * 02182417
024100*---------------------------------------------------------------* 02182517
024200     EXEC SQL                                                     02182617
024300          INCLUDE SQLCA                                           02182717
024400     END-EXEC.                                                    02182817
024500                                                                  02182917
024600*---------------------------------------------------------------* 02183017
024700*    DEFINE CURSOR FOR ACCESSING TIMCNTK                        * 02183117
024800*---------------------------------------------------------------* 02183217
024900     EXEC SQL                                                     02183317
025000         DECLARE TABLE-CURSOR CURSOR FOR                          02183417
025100           SELECT                                                 02183517
025200              CONTNR_ID                                           02183617
025300             ,CONTNR_SEQ_NBR                                      02183717
025400             ,CONSLR_SCAC_ID                                      02183817
025500             ,MOM_IMPRT_TRIP_ID                                   02183917
025600             ,MOM_DPRTR_TMST                                      02184017
025700             ,MOM_POE_DELY_TMST                                   02184117
025800             ,MOM_CARR_SCAC_ID                                    02184217
025900             ,MOM_FOB_CDE                                         02184317
026000             ,MOM_IMPRT_VEH_NM                                    02184417
026100             ,MOM_TRIP_TYP_CDE                                    02184517
026200             ,MOM_DEST_POE_CDE                                    02184617
026300             ,FDR_IMPRT_TRIP_ID                                   02184717
026400             ,FDR_DPRTR_TMST                                      02184817
026500             ,FDR_POE_DELY_TMST                                   02184917
026600             ,FDR_CARR_SCAC_ID                                    02185017
026700             ,FDR_FOB_CDE                                         02185117
026800             ,FDR_IMPRT_VEH_NM                                    02185217
026900             ,FDR_TRIP_TYP_CDE                                    02185317
027000             ,FDR_DEST_POE_CDE                                    02185417
027100             ,SIZE_CDE                                            02185517
027200             ,CART_CNT                                            02185617
027300             ,CBMT_QTY                                            02185717
027400             ,WT_KGRM_QTY                                         02185817
027500             ,UNT_QTY                                             02185917
027600             ,ORGN_SHPD_FR_CDE                                    02186017
027700             ,ORGN_SHPD_TO_CDE                                    02186117
027700             ,EST_LBD_NM                                          02186217
027700             ,EST_LBD_TMST                                        02186317
027700             ,RISU_DO_RSN_CDE                                     02186417
027700             ,BKR_FRGT_RLSE_TMST                                  02186517
027700             ,DO_TO_DCONSLR_TMST                                  02186617
027700             ,DO_RCVD_TMST                                        02186717
027700             ,CONTNR_PU_TMST                                      02186817
027700             ,DAT_SRC_ENT_ID                                      02186917
027700             ,CRE_BY_USR_ID                                       02187017
027700             ,CRE_TMST                                            02187117
027700             ,LAST_UPD_BY_USR_ID                                  02187217
027700             ,LAST_UPD_TMST                                       02187317
027700             ,ACTL_POE_DELY_TMST                                  02187417
027700             ,ACTL_DEST_POE_CDE                                   02187517
027700             ,ACTL_LBD_NM                                         02187617
027700             ,ACTL_LBD_TMST                                       02187717
027700             ,DVN_TMST                                            02187817
027700             ,DCONSLR_SCAC_ID                                     02187917
027700             ,DCONSLR_RET_TMST                                    02188017
027700             ,MOM_POL_CDE                                         02188117
027700             ,FDR_POL_CDE                                         02188217
027700             ,MOM_POR_CDE                                         02188317
027700             ,FDR_POR_CDE                                         02188417
027700             ,DCONSLR_DELY_TMST                                   02188517
027900             FROM TIMCNTK                                         02188617
028100            WHERE LAST_UPD_TMST <=                                02188718
028100                    CURRENT TIMESTAMP - :PV-FUNC-QTY DAYS         02188823
028440         ORDER BY CONTNR_ID                                       02189021
028450                 ,CONTNR_SEQ_NBR                                  02189121
028500         FOR FETCH ONLY                                           02189221
028600         WITH UR                                                  02189321
028700         OPTIMIZE FOR 1 ROW                                       02189421
028800     END-EXEC.                                                    02189521
029000                                                                  02189621
029100 PROCEDURE DIVISION.                                              02189721
029200                                                                  02189821
029300 0000-PROGRAM-MAINLINE.                                           02189921
029400                                                                  02190021
029500     PERFORM 1000-INITIALIZE.                                     02190121
029600                                                                  02190221
029700     PERFORM 2000-GET-NEXT-FROM-CURSOR                            02190321
029800         UNTIL PS-TABLE-LOOP-DONE.                                02190421
029900                                                                  02190521
030000     PERFORM 6000-EOJ-ROUTINE.                                    02190621
030100     STOP RUN.                                                    02190721
030200                                                                  02190821
030400******************************************************************02190921
030500*  INITIALIZATIONS                                               *02191021
030600******************************************************************02191121
030700 1000-INITIALIZE.                                                 02191221
030800                                                                  02191321
030900     MOVE PC-CURRENT-PROGRAM-NAME TO DM-PROGRAM.                  02191421
031000     DISPLAY DM-DISPLAY-MESSAGE.                                  02191521
031400                                                                  02191621
031500     OPEN OUTPUT OUT-DRIVER-FILE.                                 02191721
031600                                                                  02191821
328000     EXEC SQL                                                     02191921
328100         SELECT FUNC_QTY                                          02192021
328200           INTO   :PV-FUNC-QTY                                    02192121
328300           FROM   TKRPRPM                                         02192221
328400          WHERE LOC_ID           = 90                             02192321
328500            AND INTFC_SYS_CDE    = 'KHL'                          02192421
328600            AND SYS_PRC_FUNC_CDE = 'TRPGDY'                       02192521
328700            AND FUNC_PRC_STAT_CDE = 'AC'                          02192621
328800     END-EXEC.                                                    02192721
328900                                                                  02192821
329000     EVALUATE TRUE                                                02192921
329100         WHEN SQLCODE = +0                                        02193021
329200             CONTINUE                                             02193121
329300         WHEN OTHER                                               02193221
051900              MOVE '1000-INITIALIZE'                              02193321
052000                                 TO PV-PARAGRAPH-NAME             02193421
052100              MOVE 'SELECT FROM TABLE '                           02193521
052200                                 TO PV-DB2-OPERATION-MSG-1        02193621
052300              MOVE 'TKRPRPM'     TO PV-DB2-TABLE-NAME-1           02193721
052400              MOVE SPACES        TO PV-DB2-TABLE-NAME-2           02193821
052500              PERFORM 9999-DB2-ABEND                              02193921
329900     END-EVALUATE.                                                02194021
032000                                                                  02194121
031200     MOVE PC-BEGINNING            TO DP-STATUS-DESCRIPTION.       02194418
033600     DISPLAY 'PURGE USING CURRENT TIMESTAMP - ' DP-TIMESTAMP      02194525
033600     DISPLAY 'MINUS - ' PV-FUNC-QTY ' DAYS'                       02194625
032500     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           02194725
032600     SET PS-TABLE-LOOP-NOT-DONE TO TRUE.                          02194825
032700     PERFORM 9100-OPEN-TABLE-CURSOR.                              02194925
033000                                                                  02195025
033100     INITIALIZE DCLTIMCNTK                                        02195125
033200                AH007-DRIVER-RECORD-LAYOUT.                       02195225
033300     PERFORM 9110-FETCH-TABLE-CURSOR.                             02195325
033400                                                                  02195425
033500     IF PS-TABLE-LOOP-DONE                                        02195525
033600        DISPLAY 'NO CONTAINERS SELECTED FROM CURSOR'              02195625
033700     END-IF.                                                      02195725
033800                                                                  02195825
033900******************************************************************02195925
034000*  FETCH NEXT FROM CURSOR & WRITE OUTPUT DRIVER FILE RECORD.     *02196025
034100******************************************************************02196125
034200 2000-GET-NEXT-FROM-CURSOR.                                       02196225
034300                                                                  02196325
034400     MOVE IMCNTK-CONTNR-ID  TO DISPLAY-CNTR-NBR.                  02196425
034410*    DISPLAY 'FETCHED CONTAINER = ' DISPLAY-CNTR-NBR.             02196525
034610                                                                  02196625
036100     PERFORM 2010-POPULATE-DRIVER-RECORD.                         02196725
036200     PERFORM 9650-WRITE-DRIVER-RECORD.                            02196825
036300     PERFORM 2100-CHECK-PGM-PROGRESS.                             02196925
036600                                                                  02197025
036700     INITIALIZE DCLTIMCNTK                                        02197125
036800                AH007-DRIVER-RECORD-LAYOUT.                       02197225
036900     PERFORM 9110-FETCH-TABLE-CURSOR.                             02197325
037000                                                                  02197425
037100******************************************************************02197525
037200*  MOVE COLUMNS FROM TABLES TO FIELDS IN DRIVER FILE RECORD.     *02197625
037300******************************************************************02197725
037400 2010-POPULATE-DRIVER-RECORD.                                     02197825
037500                                                                  02197925
037600     INITIALIZE AH007-DRIVER-RECORD-LAYOUT.                       02198025
037700                                                                  02198125
037800     MOVE IMCNTK-CONTNR-ID         TO                             02198225
                                      AH007-CONTNR-ID.                  02198325
037900     MOVE IMCNTK-CONTNR-SEQ-NBR    TO                             02198425
                                      AH007-CONTNR-SEQ-NBR.             02198525
038000     MOVE IMCNTK-CONSLR-SCAC-ID    TO                             02198625
                                      AH007-CONSLR-SCAC-ID.             02198725
038100     MOVE IMCNTK-MOM-IMPRT-TRIP-ID TO                             02198825
                                      AH007-MOM-IMPRT-TRIP-ID.          02198925
038200     MOVE IMCNTK-MOM-DPRTR-TMST    TO                             02199025
                                      AH007-MOM-DPRTR-TMST.             02199125
038300     MOVE IMCNTK-MOM-POE-DELY-TMST TO                             02199225
                                      AH007-MOM-POE-DELY-TMST.          02199325
038400     MOVE IMCNTK-MOM-CARR-SCAC-ID  TO                             02199425
                                      AH007-MOM-CARR-SCAC-ID.           02199525
038500     MOVE IMCNTK-MOM-FOB-CDE       TO                             02199625
                                      AH007-MOM-FOB-CDE.                02199725
038600     MOVE IMCNTK-MOM-IMPRT-VEH-NM  TO                             02199825
                                      AH007-MOM-IMPRT-VEH-NM.           02199925
038700     MOVE IMCNTK-MOM-TRIP-TYP-CDE  TO                             02200025
                                      AH007-MOM-TRIP-TYP-CDE.           02200125
038800     MOVE IMCNTK-MOM-DEST-POE-CDE  TO                             02200225
                                      AH007-MOM-DEST-POE-CDE.           02200325
038900     MOVE IMCNTK-FDR-IMPRT-TRIP-ID TO                             02200425
                                      AH007-FDR-IMPRT-TRIP-ID.          02200525
039000     MOVE IMCNTK-FDR-DPRTR-TMST    TO                             02200625
                                      AH007-FDR-DPRTR-TMST.             02200725
039100     MOVE IMCNTK-FDR-POE-DELY-TMST TO                             02200825
                                      AH007-FDR-POE-DELY-TMST.          02200925
039200     MOVE IMCNTK-FDR-CARR-SCAC-ID  TO                             02201025
                                      AH007-FDR-CARR-SCAC-ID.           02201125
039300     MOVE IMCNTK-FDR-FOB-CDE       TO                             02201225
                                      AH007-FDR-FOB-CDE.                02201325
039400     MOVE IMCNTK-FDR-IMPRT-VEH-NM  TO                             02201425
                                      AH007-FDR-IMPRT-VEH-NM.           02201525
039500     MOVE IMCNTK-FDR-TRIP-TYP-CDE  TO                             02201625
                                      AH007-FDR-TRIP-TYP-CDE.           02201725
039600     MOVE IMCNTK-FDR-DEST-POE-CDE  TO                             02201825
                                      AH007-FDR-DEST-POE-CDE.           02201925
039700     MOVE IMCNTK-SIZE-CDE          TO                             02202025
                                      AH007-SIZE-CDE.                   02202125
039800     MOVE IMCNTK-CART-CNT          TO                             02202225
                                      AH007-CART-CNT.                   02202325
039900     MOVE IMCNTK-CBMT-QTY          TO                             02202425
                                      AH007-CBMT-QTY.                   02202525
040000     MOVE IMCNTK-WT-KGRM-QTY       TO                             02202625
                                      AH007-WT-KGRM-QTY.                02202725
040100     MOVE IMCNTK-UNT-QTY           TO                             02202825
                                      AH007-UNT-QTY.                    02202925
040200     MOVE IMCNTK-ORGN-SHPD-FR-CDE  TO                             02203025
                                      AH007-ORGN-SHPD-FR-CDE.           02203125
040300     MOVE IMCNTK-ORGN-SHPD-TO-CDE  TO                             02203225
                                      AH007-ORGN-SHPD-TO-CDE.           02203325
040400     MOVE IMCNTK-EST-LBD-NM        TO                             02203425
                                      AH007-EST-LBD-NM.                 02203525
040500     MOVE IMCNTK-EST-LBD-TMST      TO                             02203625
                                      AH007-EST-LBD-TMST.               02203725
040500     MOVE IMCNTK-RISU-DO-RSN-CDE   TO                             02203825
                                      AH007-RISU-DO-RSN-CDE.            02203925
040500     MOVE IMCNTK-BKR-FRGT-RLSE-TMST TO                            02204025
                                      AH007-BKR-FRGT-RLSE-TMST.         02204125
040500     MOVE IMCNTK-DO-TO-DCONSLR-TMST TO                            02204225
                                      AH007-DO-TO-DCONSLR-TMST.         02204325
040500     MOVE IMCNTK-DO-RCVD-TMST       TO                            02204425
                                      AH007-DO-RCVD-TMST.               02204525
040500     MOVE IMCNTK-CONTNR-PU-TMST     TO                            02204625
                                      AH007-CONTNR-PU-TMST.             02204725
040600     MOVE IMCNTK-DAT-SRC-ENT-ID     TO                            02204825
                                      AH007-DAT-SRC-ENT-ID.             02204925
           MOVE IMCNTK-CRE-BY-USR-ID      TO                            02205025
                                      AH007-CRE-BY-USR-ID.              02205125
           MOVE IMCNTK-CRE-TMST           TO                            02205225
                                      AH007-CRE-TMST.                   02205325
           MOVE IMCNTK-LAST-UPD-BY-USR-ID TO                            02205425
                                      AH007-LAST-UPD-BY-USR-ID.         02205525
           MOVE IMCNTK-LAST-UPD-TMST      TO                            02205625
                                      AH007-LAST-UPD-TMST.              02205725
           MOVE IMCNTK-ACTL-POE-DELY-TMST TO                            02205825
                                      AH007-ACTL-POE-DELY-TMST.         02205925
           MOVE IMCNTK-ACTL-DEST-POE-CDE  TO                            02206025
                                      AH007-ACTL-DEST-POE-CDE.          02206125
           MOVE IMCNTK-ACTL-LBD-NM        TO                            02206225
                                      AH007-ACTL-LBD-NM.                02206325
           MOVE IMCNTK-ACTL-LBD-TMST      TO                            02206425
                                      AH007-ACTL-LBD-TMST.              02206525
           MOVE IMCNTK-DVN-TMST           TO                            02206625
                                      AH007-DVN-TMST.                   02206725
           MOVE IMCNTK-DCONSLR-SCAC-ID    TO                            02206825
                                      AH007-DCONSLR-SCAC-ID.            02206925
           MOVE IMCNTK-DCONSLR-RET-TMST   TO                            02207025
                                      AH007-DCONSLR-RET-TMST.           02207125
           MOVE IMCNTK-MOM-POL-CDE        TO                            02207225
                                      AH007-MOM-POL-CDE.                02207325
           MOVE IMCNTK-FDR-POL-CDE        TO                            02207425
                                      AH007-FDR-POL-CDE.                02207525
           MOVE IMCNTK-MOM-POR-CDE        TO                            02207625
                                      AH007-MOM-POR-CDE.                02207725
           MOVE IMCNTK-FDR-POR-CDE        TO                            02207825
                                      AH007-FDR-POR-CDE.                02207925
           MOVE IMCNTK-DCONSLR-DELY-TMST  TO                            02208025
                                      AH007-DCONSLR-DELY-TMST.          02208125
                                                                        02208225
040700******************************************************************02208325
040800*      EVERY NTH RECORD (IE: INITIAL SETTING 1000), REPORT       *02208425
040900*      RECORD COUNT AND CURRENT DATE/TIME.  THIS WILL ASSIST     *02208525
041000*      WITH RUN-TIME ESTIMATE OF TIME REMAINING TO COMPLETE.     *02208625
041100******************************************************************02208725
041200 2100-CHECK-PGM-PROGRESS.                                         02208825
041300     DIVIDE    PV-DRIVER-WRITTEN-CNT                              02208925
041400         BY        PC-HOW-OFTEN-TO-DISPLAY                        02209025
041500         GIVING    PV-DISPLAY-NTH-MULTIPLE                        02209125
041600         REMAINDER PV-DISPLAY-NTH-REMAINDER.                      02209225
041700                                                                  02209325
041800     IF PV-DISPLAY-NTH-REMAINDER = ZERO                           02209425
041900         MOVE PC-CONTINUING         TO DP-STATUS-DESCRIPTION      02209525
042000         PERFORM 6200-DISPLAY-PGM-PROGRESS                        02209625
042100     END-IF.                                                      02209725
042200                                                                  02209825
046400******************************************************************02209925
046500*  CLOSE CURSOR & OUTPUT FILE, DISPLAY END OF RUN MESSAGE.       *02210025
046600******************************************************************02210125
046700 6000-EOJ-ROUTINE.                                                02210225
046800                                                                  02210325
047100     CLOSE OUT-DRIVER-FILE.                                       02210425
047200                                                                  02210525
047300     PERFORM 9130-CLOSE-TABLE-CURSOR.                             02210625
047400                                                                  02210725
046900     MOVE PC-ENDING  TO  DP-STATUS-DESCRIPTION.                   02210825
047500     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           02210925
047600                                                                  02211025
047700     DISPLAY 'TOTAL CONTAINERS PROCESSED = '                      02211125
047700                                  PV-DRIVER-WRITTEN-CNT.          02211225
047900                                                                  02211325
048000******************************************************************02211425
048100*  DISPLAY PROGRAM PROGRESS.                                     *02211525
048200******************************************************************02211625
048300 6200-DISPLAY-PGM-PROGRESS.                                       02211725
048400                                                                  02211825
048500     EXEC SQL                                                     02211925
048600          SET :PV-TMST = CURRENT TIMESTAMP                        02212025
048700     END-EXEC.                                                    02212125
048800                                                                  02212225
048900     MOVE PC-CURRENT-PROGRAM-NAME   TO DP-PROGRAM.                02212325
049000     MOVE PV-TMST                   TO DP-TIMESTAMP.              02212425
049100     MOVE PV-TABLE-ROW-FETCHED-CNT  TO DP-TABLE-ROW-FETCHED-CNT.  02212525
049200     MOVE PV-DRIVER-WRITTEN-CNT     TO DP-DRIVER-WRITTEN-CNT.     02212625
049300                                                                  02212725
049400     DISPLAY DP-DISPLAY-PROGRESS-MSG.                             02212825
049600                                                                  02212925
049700******************************************************************02213025
049800*  OPEN   TABLE CURSOR                                           *02213125
049900******************************************************************02213225
050000 9100-OPEN-TABLE-CURSOR.                                          02213325
050100     EXEC SQL                                                     02213425
050200          OPEN TABLE-CURSOR                                       02213525
050300     END-EXEC.                                                    02213625
050400                                                                  02213725
050500     EVALUATE TRUE                                                02213825
050600         WHEN SQLCODE = ZERO                                      02213925
050700              CONTINUE                                            02214025
050800         WHEN SQLCODE = +100                                      02214125
050900              SET PS-TABLE-LOOP-DONE TO TRUE                      02214225
051000              MOVE '9100-OPEN-TABLE-CURSOR'                       02214325
051100                                 TO PV-PARAGRAPH-NAME             02214425
051200              MOVE 'OPEN TABLE CURSOR - NO ROWS SELECTED'         02214525
051300                                 TO PV-DB2-OPERATION-MSG-1        02214625
051400              MOVE 'TIMCNTK'     TO PV-DB2-TABLE-NAME-1           02214725
051500              MOVE SPACES        TO PV-DB2-TABLE-NAME-2           02214825
051600              PERFORM 9999-DB2-ABEND                              02214925
051700         WHEN SQLWARN0 NOT EQUAL SPACE                            02215025
051800         WHEN SQLCODE  NOT EQUAL ZERO                             02215125
051900              MOVE '9100-OPEN-TABLE-CURSOR'                       02215225
052000                                 TO PV-PARAGRAPH-NAME             02215325
052100              MOVE 'OPEN TABLE CURSOR'                            02215425
052200                                 TO PV-DB2-OPERATION-MSG-1        02215525
052300              MOVE 'TIMCNTK'     TO PV-DB2-TABLE-NAME-1           02215625
052400              MOVE SPACES        TO PV-DB2-TABLE-NAME-2           02215725
052500              PERFORM 9999-DB2-ABEND                              02215825
052600     END-EVALUATE.                                                02215925
052700                                                                  02216025
052900******************************************************************02216125
053000*  FETCH TABLE CURSOR                                            *02216225
053100******************************************************************02216325
053200 9110-FETCH-TABLE-CURSOR.                                         02216425
053300     EXEC SQL                                                     02216525
053400         FETCH TABLE-CURSOR                                       02216625
053500          INTO  :IMCNTK-CONTNR-ID                                 02216725
053600               ,:IMCNTK-CONTNR-SEQ-NBR                            02216825
053700               ,:IMCNTK-CONSLR-SCAC-ID                            02216925
053800               ,:IMCNTK-MOM-IMPRT-TRIP-ID                         02217025
053900               ,:IMCNTK-MOM-DPRTR-TMST                            02217125
054000               ,:IMCNTK-MOM-POE-DELY-TMST                         02217225
054100               ,:IMCNTK-MOM-CARR-SCAC-ID                          02217325
054200               ,:IMCNTK-MOM-FOB-CDE                               02217425
054300               ,:IMCNTK-MOM-IMPRT-VEH-NM                          02217525
054400               ,:IMCNTK-MOM-TRIP-TYP-CDE                          02217625
054500               ,:IMCNTK-MOM-DEST-POE-CDE                          02217725
054600               ,:IMCNTK-FDR-IMPRT-TRIP-ID                         02217825
054700               ,:IMCNTK-FDR-DPRTR-TMST                            02217925
054800               ,:IMCNTK-FDR-POE-DELY-TMST                         02218025
054900               ,:IMCNTK-FDR-CARR-SCAC-ID                          02218125
055000               ,:IMCNTK-FDR-FOB-CDE                               02218225
055100               ,:IMCNTK-FDR-IMPRT-VEH-NM                          02218325
055200               ,:IMCNTK-FDR-TRIP-TYP-CDE                          02218425
055300               ,:IMCNTK-FDR-DEST-POE-CDE                          02218525
055400               ,:IMCNTK-SIZE-CDE                                  02218625
055500               ,:IMCNTK-CART-CNT                                  02218725
055600               ,:IMCNTK-CBMT-QTY                                  02218825
055700               ,:IMCNTK-WT-KGRM-QTY                               02218925
055800               ,:IMCNTK-UNT-QTY                                   02219025
055900               ,:IMCNTK-ORGN-SHPD-FR-CDE                          02219125
056000               ,:IMCNTK-ORGN-SHPD-TO-CDE                          02219225
056100               ,:IMCNTK-EST-LBD-NM                                02219325
056200               ,:IMCNTK-EST-LBD-TMST                              02219425
055000               ,:IMCNTK-RISU-DO-RSN-CDE                           02219525
055100               ,:IMCNTK-BKR-FRGT-RLSE-TMST                        02219625
055200               ,:IMCNTK-DO-TO-DCONSLR-TMST                        02219725
055300               ,:IMCNTK-DO-RCVD-TMST                              02219825
055400               ,:IMCNTK-CONTNR-PU-TMST                            02219925
055500               ,:IMCNTK-DAT-SRC-ENT-ID                            02220025
055600               ,:IMCNTK-CRE-BY-USR-ID                             02220125
055700               ,:IMCNTK-CRE-TMST                                  02220225
055800               ,:IMCNTK-LAST-UPD-BY-USR-ID                        02220325
055900               ,:IMCNTK-LAST-UPD-TMST                             02220425
056000               ,:IMCNTK-ACTL-POE-DELY-TMST                        02220525
056100               ,:IMCNTK-ACTL-DEST-POE-CDE                         02220625
056200               ,:IMCNTK-ACTL-LBD-NM                               02220725
055300               ,:IMCNTK-ACTL-LBD-TMST                             02220825
055400               ,:IMCNTK-DVN-TMST                                  02220925
055500               ,:IMCNTK-DCONSLR-SCAC-ID                           02221025
055600               ,:IMCNTK-DCONSLR-RET-TMST                          02221125
055700               ,:IMCNTK-MOM-POL-CDE                               02221225
055800               ,:IMCNTK-FDR-POL-CDE                               02221325
055900               ,:IMCNTK-MOM-POR-CDE                               02221425
056000               ,:IMCNTK-FDR-POR-CDE                               02221525
056100               ,:IMCNTK-DCONSLR-DELY-TMST                         02221625
056300     END-EXEC.                                                    02221725
056400                                                                  02221825
056500     EVALUATE TRUE                                                02221925
056600         WHEN SQLCODE = ZERO                                      02222025
056700              ADD +1                 TO PV-TABLE-ROW-FETCHED-CNT  02222125
056800         WHEN SQLCODE = +100                                      02222225
056900              SET PS-TABLE-LOOP-DONE TO TRUE                      02222325
057000         WHEN SQLWARN0 NOT EQUAL SPACE                            02222425
057100         WHEN SQLCODE NOT EQUAL ZERO                              02222525
057200              MOVE '9110-FETCH-TABLE-CURSOR'                      02222625
057300                                 TO PV-PARAGRAPH-NAME             02222725
057400              MOVE 'FETCH TABLE CURSOR'                           02222825
057500                                 TO PV-DB2-OPERATION-MSG-1        02222925
057600              MOVE 'TIMCNTK'     TO PV-DB2-TABLE-NAME-1           02223025
057700              MOVE SPACES        TO PV-DB2-TABLE-NAME-2           02223125
057800              PERFORM 9999-DB2-ABEND                              02223225
057900     END-EVALUATE.                                                02223325
058100                                                                  02223425
058200******************************************************************02223525
058300*  CLOSE TABLE CURSOR                                            *02223625
058400******************************************************************02223725
058500 9130-CLOSE-TABLE-CURSOR.                                         02223825
058600     EXEC SQL                                                     02223925
058700          CLOSE TABLE-CURSOR                                      02224025
058800     END-EXEC.                                                    02224125
058900                                                                  02224225
059000     EVALUATE TRUE                                                02224325
059100         WHEN SQLCODE = ZERO                                      02224425
059200              CONTINUE                                            02224525
059300         WHEN SQLWARN0 NOT EQUAL SPACE                            02224625
059400         WHEN SQLCODE NOT EQUAL ZERO                              02224725
059500              MOVE '9130-CLOSE-TABLE-CURSOR'                      02224825
059600                                 TO PV-PARAGRAPH-NAME             02224925
059700              MOVE 'CLOSE TABLE CURSOR'                           02225025
059800                                 TO PV-DB2-OPERATION-MSG-1        02225125
059900              MOVE 'TIMCNTK'     TO PV-DB2-TABLE-NAME-1           02225225
060000              MOVE SPACES        TO PV-DB2-TABLE-NAME-2           02225325
060100              PERFORM 9999-DB2-ABEND                              02225425
060200     END-EVALUATE.                                                02225525
060600                                                                  02225625
060700******************************************************************02225725
060800*  WRITE A RECORD TO THE DRIVER FILE                             *02225825
060900******************************************************************02225925
061000 9650-WRITE-DRIVER-RECORD.                                        02226025
061100     WRITE  OUT-DRIVER-RECORD  FROM  AH007-DRIVER-RECORD-LAYOUT.  02226125
061200     ADD +1 TO PV-DRIVER-WRITTEN-CNT.                             02226225
061400                                                                  02226325
061700******************************************************************02226425
061800*  DISPLAY INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT  *02226525
061900*  AND CALL THE ABEND PROCESSOR IN THE EVENT THAT AN             *02226625
062000*  SQL ERROR OR WARNING CODE OCCURS.                             *02226725
062100******************************************************************02226825
062200 9999-DB2-ABEND.                                                  02226925
062300     DISPLAY PC-CURRENT-PROGRAM-NAME                              02227025
062400             ' 9999-DB2-ABEND'.                                   02227125
062500     DISPLAY PC-CURRENT-PROGRAM-NAME                              02227225
062600             ' ** ABEND           **'.                            02227325
062700     DISPLAY PC-CURRENT-PROGRAM-NAME                              02227425
062800             ' ** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.       02227525
062900     DISPLAY PC-CURRENT-PROGRAM-NAME                              02227625
063000             ' ** TABLES AFFECTED ** = ' PV-DB2-TABLE-NAME-1.     02227725
063100     DISPLAY PC-CURRENT-PROGRAM-NAME                              02227825
063200             ' **                 ** = ' PV-DB2-TABLE-NAME-2.     02227925
063300     DISPLAY PC-CURRENT-PROGRAM-NAME                              02228025
063400             ' ** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.  02228125
063500                                                                  02228225
063600     DISPLAY PC-CURRENT-PROGRAM-NAME                              02228325
063700             ' ** SQLCODE         ** = ' SQLCODE.                 02228425
063800     MOVE SQLCODE TO PV-SQLCODE.                                  02228525
063900     DISPLAY PC-CURRENT-PROGRAM-NAME                              02228625
064000             ' ** PV-SQLCODE      ** = ' PV-SQLCODE '.'.          02228725
064100                                                                  02228825
064200     DISPLAY PC-CURRENT-PROGRAM-NAME                              02228925
064300             ' ** SQLWARN0        ** = ' SQLWARN0 '.'.            02229025
064400                                                                  02229125
064600*----------------------------------------------------------------*02229225
064700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *02229325
064800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *02229425
064900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *02229525
065000* FORMAT.                                                        *02229625
065100*----------------------------------------------------------------*02229725
065200     COPY DPPD004.                                                02229825
065300                                                                  02229925
065400     MOVE PC-ABENDING               TO DP-STATUS-DESCRIPTION.     02230025
065500     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           02230125
065700                                                                  02230225
065800*----------------------------------------------------------------*02230325
065900* CALL ABEND                                                     *02230425
066000*----------------------------------------------------------------*02230525
066100     MOVE +4013                  TO ABEND-CODE.                   02230625
066200     CALL 'ILBOABN0' USING ABEND-CODE.                            02230725
