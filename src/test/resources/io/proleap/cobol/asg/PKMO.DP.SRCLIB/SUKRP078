000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.             SUKRP078.                                00040000
000500 AUTHOR.                 DENISE HAHN.                             00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            OCTOBER 2021.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM WILL CREATE THE DAILY CARTONS SCAN BASED        * 00100000
001100*  RECEIVER BY DC REPORT                                        * 00110000
001110*                                                               * 00111000
001120*  THIS IS A COPY OF SUKRP040 - BUT IT IS ONLY FOR SEPHORA DEPTS* 00112000
001200***************************************************************** 00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400***************************************************************** 00140000
001500 CONFIGURATION SECTION.                                           00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800                                                                  00180000
001900 INPUT-OUTPUT SECTION.                                            00190000
002000 FILE-CONTROL.                                                    00200000
002100                                                                  00210001
002200     SELECT CONTROL-FILE                                          00220000
002300         ASSIGN TO SYSIN.                                         00230000
002400                                                                  00240001
002500     SELECT REPORT-FILE                                           00250000
002600         ASSIGN TO RPT01.                                         00260000
002700                                                                  00270001
002800     SELECT OUTPUT-FILE                                           00280000
002900         ASSIGN TO OUT01.                                         00290000
003000                                                                  00300001
003100***************************************************************** 00310000
003200 DATA DIVISION.                                                   00320000
003300***************************************************************** 00330000
003400 FILE SECTION.                                                    00340000
003500                                                                  00350001
003600 FD  CONTROL-FILE                                                 00360000
003700     RECORDING MODE IS F                                          00370000
003800     BLOCK CONTAINS 0 RECORDS.                                    00380000
003900 01  CONTROL-RECORD                   PIC X(080).                 00390000
004000                                                                  00400000
004100                                                                  00410001
004200 FD  REPORT-FILE                                                  00420000
004300     RECORDING MODE IS F                                          00430000
004400     BLOCK CONTAINS 0  RECORDS.                                   00440000
004500 01  REPORT-RECORD                   PIC  X(132).                 00450000
004600                                                                  00460001
004700 FD  OUTPUT-FILE                                                  00470000
004800     RECORDING MODE IS F                                          00480000
004900     BLOCK CONTAINS 0  RECORDS.                                   00490000
005000 01  OUTPUT-RECORD                   PIC  X(200).                 00500000
005100                                                                  00510001
005200***************************************************************** 00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400                                                                  00540001
005500 01  PROGRAM-SWITCHES.                                            00550000
005600     05  PS-END-P2L-CHECKIN-CURSOR-SW   PIC X(01) VALUE 'N'.      00560000
005700         88  PS-END-P2L-CHECKIN-CURSOR   VALUE 'Y'.               00570000
005800         88  PS-NOT-END-P2L-CHECKIN-CURSOR                        00580000
005900                                         VALUE 'N'.               00590000
006000     05  PS-END-OUTBOUND-CURSOR-SW      PIC X(01) VALUE 'N'.      00600000
006100         88  PS-NOT-END-OUTBOUND-CURSOR  VALUE 'N'.               00610000
006200         88  PS-END-OUTBOUND-CURSOR      VALUE 'Y'.               00620000
006300     05  PS-END-DC-CURSOR-SW            PIC X(01) VALUE 'N'.      00630000
006400         88  PS-NOT-END-DC-CURSOR        VALUE 'N'.               00640000
006500         88  PS-END-DC-CURSOR            VALUE 'Y'.               00650000
006600     05  PS-FIRST-FETCH-SW              PIC X(01) VALUE 'N'.      00660000
006700         88  PS-NOT-FIRST-FETCH          VALUE 'N'.               00670000
006800         88  PS-FIRST-FETCH              VALUE 'Y'.               00680000
006900                                                                  00690001
007000 01  PV-PROGRAM-CONSTANTS.                                        00700000
007100     05  PC-SUKRP078                 PIC X(08) VALUE  'SUKRP078'. 00710000
007200     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00720000
007300                                                                  00730001
007400 01  PV-PROGRAM-VARIABLES.                                        00740000
007500     05  PV-CONTROL-REC.                                          00750000
007600         10  PV-CONTROL-DATE         PIC X(10).                   00760000
007700         10  PV-CONTROL-FILLER       PIC X(70).                   00770000
007800     05  PV-DISP-OPER                PIC 9(04).                   00780000
007900     05  PV-DISP-COUNT               PIC 9(09)V99.                00790000
008000     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       00800000
008100     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00810000
008200     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00820000
008300                                                   COMP-3.        00830000
008400     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00840000
008500                                                   COMP-3.        00850000
008600     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00860000
008700                                                   COMP-3.        00870000
008800     05  PV-OUTBOUND-COUNT           PIC S9(9) COMP.              00880000
008900     05  PV-OUTBOUND-SMO             PIC S9(9) COMP.              00890000
009000     05  PV-OUTBOUND-ASN             PIC S9(9) COMP.              00900000
009100     05  PV-OUTBOUND-CPS             PIC S9(9) COMP.              00910000
009200     05  PV-DISTHD-P2L               PIC S9(9) COMP.              00920000
009300     05  PV-SULBXF-COUNT             PIC S9(9) COMP.              00930000
009400     05  PV-SULBXF-P2L               PIC S9(9) COMP.              00940000
009500     05  PV-TOT-CTNS-RECEIVED        PIC S9(9) COMP.              00950000
009600     05  PV-TOT-CTNS-CHECKIN         PIC S9(9) COMP.              00960000
009700     05  PV-TOT-CTNS-PHYSICAL        PIC S9(9) COMP.              00970000
009800     05  PV-TOT-SML                  PIC S9(9) COMP.              00980000
009900     05  PV-TOT-P2L                  PIC S9(9) COMP.              00990000
010000     05  PV-OUTBOUND-SMO-CORP        PIC S9(9) COMP.              01000000
010100     05  PV-OUTBOUND-ASN-CORP        PIC S9(9) COMP.              01010000
010200     05  PV-OUTBOUND-CPS-CORP        PIC S9(9) COMP.              01020000
010300     05  PV-DISTHD-P2L-CORP          PIC S9(9) COMP.              01030000
010400     05  PV-SULBXF-P2L-CORP          PIC S9(9) COMP.              01040000
010500     05  PV-TOT-CTNS-RECEIVED-CORP   PIC S9(9) COMP.              01050000
010600     05  PV-TOT-CTNS-CHECKIN-CORP    PIC S9(9) COMP.              01060000
010700     05  PV-TOT-CTNS-PHYSICAL-CORP   PIC S9(9) COMP.              01070000
010800     05  PV-TOT-SML-CORP             PIC S9(9) COMP.              01080000
010900     05  PV-TOT-P2L-CORP             PIC S9(9) COMP.              01090000
011000     05  PV-WORKING-PCT              PIC S9(9)V9999 COMP-3.       01100000
011100     05  PV-UCC128-PCT               PIC S9(9)V9 COMP-3.          01110000
011200     05  PV-PHYSICAL-PCT             PIC S9(9)V9 COMP-3.          01120000
011300     05  PV-SML-PCT                  PIC S9(9)V9 COMP-3.          01130000
011400     05  PV-SML-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01140000
011500     05  PV-SML-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01150000
011600     05  PV-SML-SMOOTHING-PCT        PIC S9(9)V9 COMP-3.          01160000
011700     05  PV-P2L-SML-PCT              PIC S9(9)V9 COMP-3.          01170000
011800     05  PV-P2L-CHECKIN-PCT          PIC S9(9)V9 COMP-3.          01180000
011900     05  PV-P2L-PHYSICAL-PCT         PIC S9(9)V9 COMP-3.          01190000
012000     05  PV-TODAYS-DATE.                                          01200000
012100         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01210000
012200         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01220000
012300         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01230000
012400     05  PV-TODAYS-TIME.                                          01240000
012500         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01250000
012600         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01260000
012700         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01270000
012800         10  FILLER                  PIC 9(02) VALUE ZERO.        01280000
012900     05  PV-COMPARE-DATE.                                         01290000
013000         10  PV-COMPARE-DATE-CC      PIC 9(02) VALUE ZERO.        01300000
013100         10  PV-COMPARE-DATE-YY      PIC 9(02) VALUE ZERO.        01310000
013200         10  FILLER                  PIC X(01) VALUE '-'.         01320000
013300         10  PV-COMPARE-DATE-MM      PIC 9(02) VALUE ZERO.        01330000
013400         10  FILLER                  PIC X(01) VALUE '-'.         01340000
013500         10  PV-COMPARE-DATE-DD      PIC 9(02) VALUE ZERO.        01350000
013600                                                                  01360001
013700 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01370000
013800                                                 COMP SYNC.       01380000
013900                                                                  01390001
014000******************************************************************01400000
014100*  DB2 FORMATTED MESSAGE AREA                                     01410000
014200******************************************************************01420000
014300     COPY DPWS004.                                                01430000
014400                                                                  01440001
014500     COPY SURD059.                                                01450000
014600                                                                  01460001
014700******************************************************************01470000
014800*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01480000
014900******************************************************************01490000
015000     COPY DPWS132O.                                               01500000
015100                                                                  01510001
015200 01  HEADING-LINES.                                               01520000
015300     05  HEADING-LINE-1.                                          01530000
015400         10  FILLER                  PIC  X(41)    VALUE SPACES.  01540001
015500         10  FILLER                  PIC  X(49)    VALUE          01550001
015600             'DAILY - SEPHORA CARTONS SCAN BASED RECEIVED BY DC'. 01560001
015700         10  FILLER                  PIC  X(42)    VALUE SPACES.  01570001
015800                                                                  01580001
015900     05  HEADING-LINE-2.                                          01590000
016000         10  FILLER                  PIC  X(56)    VALUE SPACES.  01600000
016100         10  FILLER                  PIC  X(06)    VALUE          01610000
016200             'DATE: '.                                            01620000
016300         10  HEADING-2-FORMATTED-DTE PIC  X(10)    VALUE SPACES.  01630000
016400         10  FILLER                  PIC  X(60)    VALUE SPACES.  01640000
016500                                                                  01650001
016600     05  HEADING-LINE-3.                                          01660000
016700         10  FILLER                  PIC  X(32)    VALUE SPACES.  01670000
016800         10  FILLER                  PIC  X(05)    VALUE          01680000
016900             'TOTAL'.                                             01690000
017000         10  FILLER                  PIC  X(06)    VALUE SPACES.  01700000
017100         10  FILLER                  PIC  X(05)    VALUE          01710000
017200             'TOTAL'.                                             01720000
017300         10  FILLER                  PIC  X(06)    VALUE SPACES.  01730000
017400         10  FILLER                  PIC  X(05)    VALUE          01740000
017500             'TOTAL'.                                             01750000
017600         10  FILLER                  PIC  X(73)    VALUE SPACES.  01760000
017700                                                                  01770001
017800     05  HEADING-LINE-4.                                          01780000
017900         10  FILLER                  PIC  X(31)    VALUE SPACES.  01790000
018000         10  FILLER                  PIC  X(07)    VALUE          01800000
018100             'CARTONS'.                                           01810000
018200         10  FILLER                  PIC  X(04)    VALUE SPACES.  01820000
018300         10  FILLER                  PIC  X(07)    VALUE          01830000
018400             'CARTONS'.                                           01840000
018500         10  FILLER                  PIC  X(04)    VALUE SPACES.  01850000
018600         10  FILLER                  PIC  X(07)    VALUE          01860000
018700             'CARTONS'.                                           01870000
018900         10  FILLER                  PIC  X(05)    VALUE SPACES.  01890000
019000         10  FILLER                  PIC  X(21)    VALUE          01900000
019100             '-------------- S M L '.                             01910000
019200         10  FILLER                  PIC  X(16)    VALUE          01920000
019300             '----------------'.                                  01930000
019400         10  FILLER                  PIC  X(02)    VALUE SPACES.  01940000
019500         10  FILLER                  PIC  X(27)    VALUE          01950000
019600             '--------- P 2 L -----------'.                       01960000
019700         10  FILLER                  PIC  X        VALUE SPACE.   01970000
019800                                                                  01980001
019900     05  HEADING-LINE-5.                                          01990000
020000         10  FILLER                  PIC  X(03)    VALUE          02000000
020100             ' DC'.                                               02010000
020200         10  FILLER                  PIC  X(28)    VALUE SPACES.  02020000
020300         10  FILLER                  PIC  X(08)    VALUE          02030000
020400             'RECEIVED'.                                          02040000
020500         10  FILLER                  PIC  X(03)    VALUE SPACES.  02050000
020600         10  FILLER                  PIC  X(07)    VALUE          02060000
020700             'CHECKIN'.                                           02070000
020800         10  FILLER                  PIC  X(04)    VALUE SPACES.  02080000
020900         10  FILLER                  PIC  X(08)    VALUE          02090000
021000             'PHYSICAL'.                                          02100000
021200         10  FILLER                  PIC  X(06)    VALUE SPACES.  02120000
021300         10  FILLER                  PIC  X(05)    VALUE          02130000
021400             'TOTAL'.                                             02140000
021500         10  FILLER                  PIC  X(03)    VALUE SPACES.  02150000
021600         10  FILLER                  PIC  X(07)    VALUE          02160000
021700             'CHECKIN'.                                           02170000
021800         10  FILLER                  PIC  X(02)    VALUE SPACES.  02180000
021900         10  FILLER                  PIC  X(08)    VALUE          02190000
022000             'PHYSICAL'.                                          02200000
022100         10  FILLER                  PIC  X(01)    VALUE SPACES.  02210000
022200         10  FILLER                  PIC  X(09)    VALUE          02220000
022300             'SMOOTHING'.                                         02230000
022400         10  FILLER                  PIC  X(04)    VALUE SPACES.  02240000
022500         10  FILLER                  PIC  X(05)    VALUE          02250000
022600             'TOTAL'.                                             02260000
022700         10  FILLER                  PIC  X(03)    VALUE SPACES.  02270000
022800         10  FILLER                  PIC  X(07)    VALUE          02280000
022900             'CHECKIN'.                                           02290000
023000         10  FILLER                  PIC  X(02)    VALUE SPACES.  02300000
023100         10  FILLER                  PIC  X(08)    VALUE          02310000
023200             'PHYSICAL'.                                          02320000
023300         10  FILLER                  PIC  X        VALUE SPACE.   02330000
023400                                                                  02340001
023500 01  DETAIL-LINES.                                                02350000
023600     05  DETAIL-LINE1.                                            02360000
023700         10  DL1-OPER-UNT           PIC  Z(04)     VALUE SPACES.  02370000
023800         10  FILLER                 PIC  X(01)     VALUE SPACES.  02380000
023900         10  DL1-OPER-DESC          PIC  X(23)     VALUE SPACES.  02390000
024000         10  FILLER                 PIC  X(03)     VALUE SPACES.  02400000
024100         10  DL1-TOT-CARTN-RECVD    PIC  ZZZ,ZZ9.                 02410000
024200         10  FILLER                 PIC  X(04)     VALUE SPACES.  02420000
024300         10  DL1-TOT-CARTN-CHCKIN   PIC  ZZZ,ZZ9.                 02430000
024400         10  FILLER                 PIC  X(04)     VALUE SPACES.  02440000
024500         10  DL1-TOT-CARTN-PHYSCL   PIC  ZZZ,ZZ9.                 02450000
024700         10  FILLER                 PIC  X(05)     VALUE SPACES.  02470000
024800         10  DL1-SML-TOTAL          PIC  ZZZ,ZZ9.                 02480000
024900         10  FILLER                 PIC  X(03)     VALUE SPACES.  02490000
025000         10  DL1-SML-CKECKIN        PIC  ZZZ,ZZ9.                 02500000
025100         10  FILLER                 PIC  X(03)     VALUE SPACES.  02510000
025200         10  DL1-SML-PHYSICAL       PIC  ZZZ,ZZ9.                 02520000
025300         10  FILLER                 PIC  X(02)     VALUE SPACES.  02530000
025400         10  DL1-SML-SMOOTHING      PIC  ZZZ,ZZ9.                 02540000
025500         10  FILLER                 PIC  X(03)     VALUE SPACES.  02550000
025600         10  DL1-P2L-TOTAL          PIC  ZZZ,ZZ9.                 02560000
025700         10  FILLER                 PIC  X(03)     VALUE SPACES.  02570000
025800         10  DL1-P2L-CHECKIN        PIC  ZZZ,ZZ9.                 02580000
025900         10  FILLER                 PIC  X(03)     VALUE SPACES.  02590000
026000         10  DL1-P2L-PHYSICAL       PIC  ZZZ,ZZ9.                 02600000
026100         10  FILLER                  PIC  X        VALUE SPACE.   02610000
026200                                                                  02620001
026300     05  DETAIL-LINE2.                                            02630000
026400         10  FILLER                 PIC  X(44)     VALUE SPACES.  02640000
026500         10  DL2-TOT-CRT-CHKIN-PCT  PIC  ZZZ.9.                   02650000
026600         10  FILLER                 PIC  X(06)     VALUE SPACES.  02660000
026700         10  DL2-TOT-CRT-PHYSCL-PCT PIC  ZZZ.9.                   02670000
026900         10  FILLER                 PIC  X(07)     VALUE SPACES.  02690000
027000         10  DL2-SML-TOTAL-PCT      PIC  ZZZ.9.                   02700000
027100         10  FILLER                 PIC  X(05)     VALUE SPACES.  02710000
027200         10  DL2-SML-CKECKIN-PCT    PIC  ZZZ.9.                   02720000
027300         10  FILLER                 PIC  X(05)     VALUE SPACES.  02730000
027400         10  DL2-SML-PHYSICAL-PCT   PIC  ZZZ.9.                   02740000
027500         10  FILLER                 PIC  X(04)     VALUE SPACES.  02750000
027600         10  DL2-SML-SMOOTHING-PCT  PIC  ZZZ.9.                   02760000
027700         10  FILLER                 PIC  X(05)     VALUE SPACES.  02770000
027800         10  DL2-P2L-TOTAL-PCT      PIC  ZZZ.9.                   02780000
027900         10  FILLER                 PIC  X(05)     VALUE SPACES.  02790000
028000         10  DL2-P2L-CHECKIN-PCT    PIC  ZZZ.9.                   02800000
028100         10  FILLER                 PIC  X(05)     VALUE SPACES.  02810000
028200         10  DL2-P2L-PHYSICAL-PCT   PIC  ZZZ.9.                   02820000
028300         10  FILLER                  PIC  X        VALUE SPACE.   02830000
028400                                                                  02840001
028500 01  MISCELLANEOUS-LINES.                                         02850000
028600     05  END-OF-REPORT-LINE.                                      02860000
028700         10  FILLER                  PIC  X(54)    VALUE SPACES.  02870000
028800         10  FILLER                  PIC  X(44)    VALUE          02880000
028900             '  ** END OF REPORT **                       '.      02890000
029000         10  FILLER                  PIC  X(44)    VALUE SPACES.  02900000
029100                                                                  02910001
029110*----------------------------------------------------------------*02911001
029200*DB2 AREA FOR COMPANY CONTROL TABLE                               02920000
029210*----------------------------------------------------------------*02921001
029300     EXEC SQL                                                     02930000
029400          INCLUDE TCOCNTL                                         02940000
029500     END-EXEC.                                                    02950000
029600                                                                  02960001
029610*----------------------------------------------------------------*02961001
029700*DB2 AREA FOR SUT_OTBND_CART TABLE                                02970000
029710*----------------------------------------------------------------*02971001
029800     EXEC SQL                                                     02980000
029900          INCLUDE SUT00024                                        02990000
030000     END-EXEC.                                                    03000000
030100                                                                  03010001
030101*----------------------------------------------------------------*03010102
030102*DB2 AREA FOR SUT_OTBND_UPC  TABLE                                03010202
030103*----------------------------------------------------------------*03010302
030104     EXEC SQL                                                     03010402
030105          INCLUDE SUT00028                                        03010502
030106     END-EXEC.                                                    03010602
030107                                                                  03010702
030110*----------------------------------------------------------------*03011001
030120* INBOUND SSCC - OUTBOUND/P2L BARCODE CROSS ERFERENCE            *03012001
030130*----------------------------------------------------------------*03013001
030200     EXEC SQL                                                     03020000
030300          INCLUDE TSULBXF                                         03030000
030400     END-EXEC.                                                    03040000
030500                                                                  03050001
030510*----------------------------------------------------------------*03051001
030520* INBOUND - SSCC SHIPPING UNIT LOCATION                          *03052001
030530*----------------------------------------------------------------*03053001
030600     EXEC SQL                                                     03060000
030700          INCLUDE TSHUNLO                                         03070000
030800     END-EXEC.                                                    03080000
030910                                                                  03091001
030911*----------------------------------------------------------------*03091103
030912* INBOUND - SSCC SHIPPING UNIT UPC CONTENTS                      *03091203
030913*----------------------------------------------------------------*03091303
030914     EXEC SQL                                                     03091403
030915          INCLUDE TSHUUPC                                         03091503
030916     END-EXEC.                                                    03091603
030917                                                                  03091703
030920*----------------------------------------------------------------*03092001
030930* DISTRIBUTION HEADER                                            *03093001
030940*----------------------------------------------------------------*03094001
031000     EXEC SQL                                                     03100000
031100          INCLUDE TDISTHD                                         03110000
031200     END-EXEC.                                                    03120000
031210                                                                  03121001
031220*----------------------------------------------------------------*03122001
031230* XLT_LOC                                                        *03123001
031240*----------------------------------------------------------------*03124001
031500     EXEC SQL                                                     03150000
031600          INCLUDE XLT00010                                        03160000
031700     END-EXEC.                                                    03170000
031800                                                                  03180001
031810*----------------------------------------------------------------*03181001
032000*  DATE ATTRIBUTE                                                 03200001
032100*----------------------------------------------------------------*03210001
032300     EXEC SQL                                                     03230000
032400          INCLUDE TDTATTR                                         03240000
032500     END-EXEC.                                                    03250000
032601*----------------------------------------------------------------*03260101
032620*  WST_INTGRTN_TYP                                                03262001
032630*----------------------------------------------------------------*03263001
032650     EXEC SQL                                                     03265001
032660          INCLUDE WST00008                                        03266001
032661     END-EXEC.                                                    03266101
032662                                                                  03266201
032663*----------------------------------------------------------------*03266301
032665*  WST_ATTR_DEFN                                                  03266501
032666*----------------------------------------------------------------*03266601
032668     EXEC SQL                                                     03266801
032669          INCLUDE WST00009                                        03266901
032670     END-EXEC.                                                    03267001
032671                                                                  03267101
032672*----------------------------------------------------------------*03267201
032675*  WST_ATTR_ELEM                                                  03267501
032676*----------------------------------------------------------------*03267601
032678     EXEC SQL                                                     03267801
032679          INCLUDE WST00010                                        03267901
032680     END-EXEC.                                                    03268001
032690                                                                  03269001
032691*----------------------------------------------------------------*03269102
032692*  TPURCHS                                                        03269202
032693*----------------------------------------------------------------*03269302
032694     EXEC SQL                                                     03269402
032695          INCLUDE TPURCHS                                         03269502
032696     END-EXEC.                                                    03269602
032697                                                                  03269702
032698*----------------------------------------------------------------*03269801
032800*  DB2 COMMUNICATION AREA                                         03280000
032810*----------------------------------------------------------------*03281001
033000     EXEC SQL                                                     03300000
033100         INCLUDE SQLCA                                            03310000
033200     END-EXEC.                                                    03320000
033300                                                                  03330000
033310*----------------------------------------------------------------*03331001
033500*  DB2 COMMUNICATION AREA2                                        03350000
033510*----------------------------------------------------------------*03351001
033700     COPY SQLCA2.                                                 03370000
033800                                                                  03380000
033810*----------------------------------------------------------------*03381001
033820*  DC_CSR                                                         03382001
033830*----------------------------------------------------------------*03383001
033900     EXEC SQL DECLARE DC_CSR CURSOR FOR                           03390000
034000         SELECT LOC_NBR                                           03400000
034100             ,  LOC_NM                                            03410000
034200         FROM XLT_LOC                                             03420000
034300         WHERE LOC_TYP_CDE     = 'DC'                             03430000
034400           AND E_BUS_IND = 'N'                                    03440000
034500           AND (OPN_DTE   = CURRENT DATE                          03450000
034600            OR  OPN_DTE   < CURRENT DATE)                         03460000
034700           AND  CLO_DTE      = '9999-09-09'                       03470000
034800      ORDER BY  LOC_NBR                                           03480000
034900     END-EXEC.                                                    03490000
035000                                                                  03500000
035010*----------------------------------------------------------------*03501001
035020*  SUT_OTBND_CSR - OUTBOUND CARTON CURSOR                         03502001
035030*----------------------------------------------------------------*03503001
035100     EXEC SQL DECLARE SUT_OTBOUND_CSR CURSOR FOR                  03510000
036500         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                   03650002
036501                  , A.ORGN_LOC_NBR                                03650102
036502                  , A.CART_SRC_CDE                                03650202
036503              FROM SUT_OTBND_CART A                               03650302
036505                 , SUT_OTBND_UPC B                                03650502
036506                 , TPURCHS C                                      03650602
036507                 , WST_INTGRTN_TYP D                              03650702
036508                 , WST_ATTR_DEFN E                                03650802
036509                 , WST_ATTR_ELEM F                                03650902
036510                 , WST_ATTR_ELEM G                                03651002
036511                 , WST_ATTR_ELEM H                                03651102
036512                 , WST_ATTR_ELEM I                                03651202
036513                 , WST_ATTR_ELEM J                                03651302
036514             WHERE A.CRE_DTE           = :COCNTL-BTCH-PRC-DTE     03651402
036515               AND A.CART_SRC_CDE      IN ('SMO', 'ASN', 'CPS')   03651502
036516               AND A.ACTV_IND          = 'Y'                      03651602
036517               AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID           03651702
036518               AND B.TRN_NBR           = C.PO_NBR                 03651802
036519               AND C.VER_STATUS_CDE    = 'A'                      03651902
036520               AND D.INTGRTN_TYP_CDE   = 'SEPHORDEPT'             03652002
036521               AND D.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE        03652102
036522               AND E.ATTR_DEFN_SEQ_NBR = 1                        03652202
036523               AND E.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE        03652302
036524               AND F.ATTR_DEFN_SEQ_NBR = 1                        03652402
036525               AND E.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE        03652502
036526               AND G.ATTR_DEFN_SEQ_NBR = 2                        03652602
036527               AND E.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE        03652702
036528               AND H.ATTR_DEFN_SEQ_NBR = 3                        03652802
036529               AND E.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE        03652902
036530               AND I.ATTR_DEFN_SEQ_NBR = 4                        03653002
036531               AND E.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE        03653102
036532               AND J.ATTR_DEFN_SEQ_NBR = 5                        03653202
036533               AND F.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR      03653302
036534               AND F.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR      03653402
036535               AND F.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR      03653502
036536               AND F.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR      03653602
036537               AND G.ATTR_ELEM_TXT     = 'AC'                     03653702
036538               AND H.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP        03653802
036539               AND I.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP        03653902
036540               AND INTEGER(C.DEPT_NBR) = F.ATTR_ELEM_NBR          03654002
036541          GROUP BY  A.ORGN_LOC_NBR                                03654102
036542                  , A.CART_SRC_CDE                                03654202
036543          ORDER BY  A.ORGN_LOC_NBR                                03654302
036544                  , A.CART_SRC_CDE                                03654402
036545         WITH UR                                                  03654502
036546     END-EXEC.                                                    03654602
036547                                                                  03654702
036552*----------------------------------------------------------------*03655202
036553*  P2L_CHECKIN_CSR                                                03655302
036560*----------------------------------------------------------------*03656002
036600     EXEC SQL DECLARE P2L_CHECKIN_CSR CURSOR FOR                  03660000
037810         SELECT COUNT(*)                                          03781002
037811            ,   B.OPER_UNT_ID                                     03781102
037812         FROM TSULBXF A                                           03781202
037813            , TSHUNLO B                                           03781302
037814            , TSHUUPC C                                           03781402
037815            , TPURCHS D                                           03781502
037816            , WST_INTGRTN_TYP E                                   03781602
037817            , WST_ATTR_DEFN F                                     03781702
037818            , WST_ATTR_ELEM G                                     03781802
037819            , WST_ATTR_ELEM H                                     03781902
037820            , WST_ATTR_ELEM I                                     03782002
037821            , WST_ATTR_ELEM J                                     03782102
037822            , WST_ATTR_ELEM K                                     03782202
037823         WHERE DATE(A.CRE_TMST)    = :COCNTL-BTCH-PRC-DTE         03782302
037824           AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID               03782402
037825           AND A.CRE_TMST          = B.CRE_TMST                   03782502
037826           AND A.CART_LBL_TYP_CDE  = 'P'                          03782602
037827           AND B.ACTV_CDE          = 'A'                          03782702
037828           AND B.SHIPT_UNT_ID      = C.SHIPT_UNT_ID               03782802
037829           AND C.TRN_NBR           = D.PO_NBR                     03782902
037830           AND D.VER_STATUS_CDE    = 'A'                          03783002
037831           AND E.INTGRTN_TYP_CDE   = 'SEPHORDEPT'                 03783102
037832           AND E.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE            03783202
037833           AND F.ATTR_DEFN_SEQ_NBR = 1                            03783302
037834           AND F.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE            03783402
037835           AND G.ATTR_DEFN_SEQ_NBR = 1                            03783502
037836           AND F.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE            03783602
037837           AND H.ATTR_DEFN_SEQ_NBR = 2                            03783702
037838           AND F.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE            03783802
037839           AND I.ATTR_DEFN_SEQ_NBR = 3                            03783902
037840           AND F.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE            03784002
037841           AND J.ATTR_DEFN_SEQ_NBR = 4                            03784102
037842           AND F.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE            03784202
037843           AND K.ATTR_DEFN_SEQ_NBR = 5                            03784302
037844           AND G.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR          03784402
037845           AND G.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR          03784502
037846           AND G.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR          03784602
037847           AND G.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR          03784702
037848           AND H.ATTR_ELEM_TXT     = 'AC'                         03784802
037849           AND I.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP            03784902
037850           AND J.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP            03785002
037851           AND INTEGER(D.DEPT_NBR) = G.ATTR_ELEM_NBR              03785102
037852         GROUP BY B.OPER_UNT_ID                                   03785202
037853         ORDER BY B.OPER_UNT_ID                                   03785302
037854     END-EXEC.                                                    03785402
037855                                                                  03785502
037870                                                                  03787002
037920*----------------------------------------------------------------*03792002
037930**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03793002
037940*----------------------------------------------------------------*03794002
038000 PROCEDURE DIVISION.                                              03800000
038100                                                                  03810001
038200 0000-MAINLINE-PROCESSING.                                        03820000
038600     DISPLAY '****** STARTING SUKRP078 ******'.                   03860000
038700                                                                  03870001
038900     OPEN INPUT  CONTROL-FILE                                     03890000
039000          OUTPUT REPORT-FILE                                      03900000
039100                 OUTPUT-FILE.                                     03910000
039200                                                                  03920001
039300     PERFORM 1000-INITIALIZATION.                                 03930000
039400                                                                  03940001
039500     SET PS-FIRST-FETCH  TO TRUE.                                 03950000
039600     PERFORM 8000-READ-CONTROL-REC.                               03960000
039700     IF PV-CONTROL-DATE = 'DEFAULT   '                            03970000
039800         PERFORM 1100-SELECT-DATE                                 03980000
039900     ELSE                                                         03990000
040000         MOVE PV-CONTROL-DATE  TO  COCNTL-BTCH-PRC-DTE            04000000
040100     END-IF.                                                      04010000
040200     PERFORM 1200-SELECT-TDTATTR.                                 04020000
040300     PERFORM 1300-PAGE-BREAK.                                     04030000
040400     PERFORM 5000-OPEN-OUTBOUND-CSR.                              04040000
040500     PERFORM 6000-OPEN-P2L-CHECKIN-CSR.                           04050000
040600     PERFORM 2000-PROCESS-DCS.                                    04060000
040700     PERFORM 5200-CLOSE-OUTBOUND-CURSOR.                          04070000
040800     PERFORM 6200-CLOSE-P2L-CHECKIN-CURSOR.                       04080000
040900                                                                  04090000
041100     CLOSE CONTROL-FILE                                           04110000
041200           REPORT-FILE                                            04120000
041300           OUTPUT-FILE.                                           04130000
041400     GOBACK.                                                      04140000
041500                                                                  04150001
041600*----------------------------------------------------------------*04160002
041620**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04162001
041621*----------------------------------------------------------------*04162102
041700 1000-INITIALIZATION.                                             04170000
042100                                                                  04210000
042200     ACCEPT PV-TODAYS-DATE                                        04220000
042300       FROM DATE.                                                 04230000
042400                                                                  04240001
042500     ACCEPT PV-TODAYS-TIME                                        04250000
042600       FROM TIME.                                                 04260000
042700                                                                  04270001
042800     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH                  04280000
042900                                PV-COMPARE-DATE-MM.               04290000
043000     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY                    04300000
043100                                PV-COMPARE-DATE-DD.               04310000
043200     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR                   04320000
043300                                PV-COMPARE-DATE-YY.               04330000
043400     IF PV-COMPARE-DATE-YY  >  80                                 04340000
043500         MOVE  19            TO PV-COMPARE-DATE-CC                04350000
043600     ELSE                                                         04360000
043700         MOVE  20            TO PV-COMPARE-DATE-CC                04370000
043800     END-IF.                                                      04380000
043900                                                                  04390001
044000     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  04400000
044100     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                04410000
044200                                                                  04420001
044300     MOVE PC-SUKRP078        TO DP132O-PROGRAM-NAME.              04430000
044400     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             04440000
044500                                                                  04450001
044600     MOVE +0                 TO PV-PAGE-COUNT.                    04460000
044700                                                                  04470001
044710                                                                  04471002
044720*----------------------------------------------------------------*04472002
044730*                                                                *04473002
044740*----------------------------------------------------------------*04474002
044800 1100-SELECT-DATE.                                                04480000
044810                                                                  04481002
044900     EXEC SQL                                                     04490000
045000         SELECT BTCH_PRC_DTE                                      04500000
045100         INTO  :COCNTL-BTCH-PRC-DTE                               04510000
045200         FROM TCOCNTL                                             04520000
045300         WHERE OPER_UNT_ID   = 90                                 04530000
045400     END-EXEC.                                                    04540000
045500     EVALUATE TRUE                                                04550000
045600         WHEN SQLCODE = +0                                        04560000
045700             CONTINUE                                             04570000
045800         WHEN SQLCODE = +100                                      04580000
045900             SET PS-END-DC-CURSOR   TO TRUE                       04590000
046000         WHEN SQLCODE < ZERO                                      04600000
046100         WHEN SQLCODE > ZERO                                      04610000
046200         WHEN SQLWARN0 NOT = SPACE                                04620000
046300             MOVE '1100-SELECT-DATE'                              04630000
046400                                      TO PV-PARAGRAPH             04640000
046500             MOVE 'SELECT'            TO PV-DB2-FUNCTION          04650000
046600             PERFORM 9100-SQL-ABEND                               04660000
046700     END-EVALUATE.                                                04670000
046800                                                                  04680000
046801                                                                  04680102
046802*----------------------------------------------------------------*04680202
046803*                                                                *04680302
046804*----------------------------------------------------------------*04680402
046900 1200-SELECT-TDTATTR.                                             04690000
047000                                                                  04700002
047200     EXEC SQL                                                     04720000
047300         SELECT                                                   04730000
047400                 FSCL_YR_NBR                                      04740000
047500               , FSCL_MN_NBR                                      04750000
047600               , FSCL_WK_NBR                                      04760000
047700               , SEA_DESC                                         04770000
047800         INTO   :DTATTR-FSCL-YR-NBR                               04780000
047900               ,:DTATTR-FSCL-MN-NBR                               04790000
048000               ,:DTATTR-FSCL-WK-NBR                               04800000
048100               ,:DTATTR-SEA-DESC                                  04810000
048200         FROM TDTATTR                                             04820000
048300         WHERE KY_DTE  = :COCNTL-BTCH-PRC-DTE                     04830000
048400     END-EXEC.                                                    04840000
048500                                                                  04850000
048600     EVALUATE TRUE                                                04860000
048700         WHEN SQLCODE = +0                                        04870000
048800             CONTINUE                                             04880000
048900         WHEN SQLCODE < ZERO                                      04890000
049000         WHEN SQLCODE > ZERO                                      04900000
049100         WHEN SQLWARN0 NOT = SPACE                                04910000
049200             MOVE '1200-SELECT-TDTATTR'                           04920000
049300                                      TO PV-PARAGRAPH             04930000
049400             MOVE 'SELECT'            TO PV-DB2-FUNCTION          04940000
049500             PERFORM 9100-SQL-ABEND                               04950000
049600     END-EVALUATE.                                                04960000
049700                                                                  04970001
049800                                                                  04980001
049900*----------------------------------------------------------------*04990002
050000**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  05000000
050100**  PAGES (AS NEEDED).                                            05010000
050200*----------------------------------------------------------------*05020002
050300 1300-PAGE-BREAK.                                                 05030000
050400                                                                  05040001
050500     ADD +1                   TO PV-PAGE-COUNT.                   05050000
050600     MOVE PV-PAGE-COUNT       TO DP132O-PAGE-NUMBER.              05060000
050700     STRING COCNTL-BTCH-PRC-DTE (6:2)                             05070000
050800            '/'                                                   05080000
050900            COCNTL-BTCH-PRC-DTE (9:2)                             05090000
051000            '/'                                                   05100000
051100            COCNTL-BTCH-PRC-DTE (1:4)                             05110000
051200                DELIMITED BY SIZE                                 05120000
051300                            INTO HEADING-2-FORMATTED-DTE.         05130000
051400                                                                  05140001
051500     WRITE REPORT-RECORD                                          05150000
051600       FROM DP132O-STANDRD-HEADER-132-COLS                        05160000
051700         AFTER ADVANCING PAGE.                                    05170000
051800                                                                  05180001
051900     WRITE REPORT-RECORD                                          05190000
052000       FROM HEADING-LINE-1                                        05200000
052100         AFTER ADVANCING 2 LINES.                                 05210000
052200                                                                  05220001
052300     WRITE REPORT-RECORD                                          05230000
052400       FROM HEADING-LINE-2                                        05240000
052500         AFTER ADVANCING 1 LINE.                                  05250000
052600                                                                  05260001
052700     WRITE REPORT-RECORD                                          05270000
052800       FROM HEADING-LINE-3                                        05280000
052900         AFTER ADVANCING 2 LINE.                                  05290000
053000                                                                  05300001
053100     WRITE REPORT-RECORD                                          05310000
053200       FROM HEADING-LINE-4                                        05320000
053300         AFTER ADVANCING 1 LINE.                                  05330000
053400                                                                  05340001
053500     WRITE REPORT-RECORD                                          05350000
053600       FROM HEADING-LINE-5                                        05360000
053700         AFTER ADVANCING 1 LINE.                                  05370000
053800                                                                  05380001
053900     MOVE +6                 TO PV-LINE-COUNT.                    05390000
054000                                                                  05400001
054010                                                                  05401001
054100*----------------------------------------------------------------*05410002
054110*                                                                *05411001
054120*----------------------------------------------------------------*05412002
054200 2000-PROCESS-DCS.                                                05420000
054300     MOVE 0      TO SUT00024-ORGN-LOC-NBR.                        05430000
054400     MOVE 0      TO SHUNLO-OPER-UNT-ID.                           05440000
054500     PERFORM 7000-OPEN-DC-CURSOR.                                 05450000
054600     PERFORM UNTIL PS-END-DC-CURSOR                               05460000
054700         PERFORM 7100-FETCH-DC-CURSOR                             05470000
054800         IF PS-FIRST-FETCH                                        05480000
054900             SET PS-NOT-FIRST-FETCH TO TRUE                       05490000
055000         END-IF                                                   05500000
055100         IF PS-NOT-END-DC-CURSOR                                  05510000
055200             PERFORM 2100-SUMM-DC                                 05520000
055300             PERFORM 3000-PRINT-DETAIL-LINE                       05530000
055400             PERFORM 4000-WRITE-OUTPUT-RECORD                     05540000
055500         END-IF                                                   05550000
055600     END-PERFORM.                                                 05560000
055700     PERFORM 7200-CLOSE-DC-CURSOR.                                05570000
055800                                                                  05580000
055900     IF PV-TOT-CTNS-CHECKIN-CORP > 0 AND                          05590000
056000        PV-TOT-CTNS-RECEIVED-CORP > 0                             05600000
056100         COMPUTE PV-WORKING-PCT =                                 05610000
056200                (PV-TOT-CTNS-CHECKIN-CORP /                       05620000
056300                 PV-TOT-CTNS-RECEIVED-CORP)                       05630000
056400         COMPUTE PV-UCC128-PCT ROUNDED =                          05640000
056500                 PV-WORKING-PCT * 100                             05650000
056600     ELSE                                                         05660000
056700         MOVE 0        TO PV-UCC128-PCT                           05670000
056800     END-IF.                                                      05680000
056900                                                                  05690000
057000     IF PV-TOT-CTNS-PHYSICAL-CORP > 0 AND                         05700000
057100        PV-TOT-CTNS-RECEIVED-CORP > 0                             05710000
057200         COMPUTE PV-WORKING-PCT =                                 05720000
057300                (PV-TOT-CTNS-PHYSICAL-CORP /                      05730000
057400                 PV-TOT-CTNS-RECEIVED-CORP)                       05740000
057500         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        05750000
057600                 PV-WORKING-PCT * 100                             05760000
057700     ELSE                                                         05770000
057800         MOVE 0      TO PV-PHYSICAL-PCT                           05780000
057900     END-IF.                                                      05790000
058000                                                                  05800000
058100     IF PV-TOT-SML-CORP > 0 AND                                   05810000
058200        PV-TOT-CTNS-RECEIVED-CORP > 0                             05820000
058300         COMPUTE PV-WORKING-PCT =                                 05830000
058400                (PV-TOT-SML-CORP /                                05840000
058500                 PV-TOT-CTNS-RECEIVED-CORP)                       05850000
058600         COMPUTE PV-SML-PCT ROUNDED =                             05860000
058700                 PV-WORKING-PCT * 100                             05870000
058800     ELSE                                                         05880000
058900         MOVE 0    TO PV-SML-PCT                                  05890000
059000     END-IF.                                                      05900000
059100                                                                  05910000
059200     IF PV-OUTBOUND-ASN-CORP > 0 AND                              05920000
059300        PV-TOT-SML-CORP > 0                                       05930000
059400         COMPUTE PV-WORKING-PCT =                                 05940000
059500                (PV-OUTBOUND-ASN-CORP /                           05950000
059600                 PV-TOT-SML-CORP)                                 05960000
059700         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     05970000
059800                 PV-WORKING-PCT * 100                             05980000
059900     ELSE                                                         05990000
060000         MOVE 0    TO PV-SML-CHECKIN-PCT                          06000000
060100     END-IF.                                                      06010000
060200                                                                  06020000
060300     IF PV-OUTBOUND-CPS-CORP > 0 AND                              06030000
060400        PV-TOT-SML-CORP > 0                                       06040000
060500         COMPUTE PV-WORKING-PCT =                                 06050000
060600                (PV-OUTBOUND-CPS-CORP /                           06060000
060700                 PV-TOT-SML-CORP)                                 06070000
060800         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    06080000
060900                 PV-WORKING-PCT * 100                             06090000
061000     ELSE                                                         06100000
061100         MOVE 0    TO PV-SML-PHYSICAL-PCT                         06110000
061200     END-IF.                                                      06120000
061300                                                                  06130000
061400     IF PV-OUTBOUND-SMO-CORP > 0 AND                              06140000
061500        PV-TOT-SML-CORP > 0                                       06150000
061600         COMPUTE PV-WORKING-PCT =                                 06160000
061700                (PV-OUTBOUND-SMO-CORP /                           06170000
061800                 PV-TOT-SML-CORP)                                 06180000
061900         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   06190000
062000                 PV-WORKING-PCT * 100                             06200000
062100     ELSE                                                         06210000
062200         MOVE 0    TO PV-SML-SMOOTHING-PCT                        06220000
062300     END-IF.                                                      06230000
062400                                                                  06240000
062500     IF PV-TOT-P2L-CORP > 0 AND                                   06250000
062600        PV-TOT-CTNS-RECEIVED-CORP > 0                             06260000
062700         COMPUTE PV-WORKING-PCT =                                 06270000
062800                (PV-TOT-P2L-CORP /                                06280000
062900                 PV-TOT-CTNS-RECEIVED-CORP)                       06290000
063000         COMPUTE PV-P2L-SML-PCT ROUNDED =                         06300000
063100                 PV-WORKING-PCT * 100                             06310000
063200     ELSE                                                         06320000
063300         MOVE 0    TO PV-P2L-SML-PCT                              06330000
063400     END-IF.                                                      06340000
063500                                                                  06350000
063600     IF PV-SULBXF-P2L-CORP > 0 AND                                06360000
063700        PV-TOT-P2L-CORP > 0                                       06370000
063800         COMPUTE PV-WORKING-PCT =                                 06380000
063900                (PV-SULBXF-P2L-CORP /                             06390000
064000                 PV-TOT-P2L-CORP)                                 06400000
064100         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     06410000
064200                 PV-WORKING-PCT * 100                             06420000
064300     ELSE                                                         06430000
064400         MOVE 0    TO PV-P2L-CHECKIN-PCT                          06440000
064500     END-IF.                                                      06450000
064600                                                                  06460000
064700     IF PV-DISTHD-P2L-CORP > 0 AND                                06470000
064800        PV-TOT-P2L-CORP > 0                                       06480000
064900         COMPUTE PV-WORKING-PCT =                                 06490000
065000                (PV-DISTHD-P2L-CORP /                             06500000
065100                 PV-TOT-P2L-CORP)                                 06510000
065200         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    06520000
065300                 PV-WORKING-PCT * 100                             06530000
065400     ELSE                                                         06540000
065500         MOVE 0    TO PV-P2L-PHYSICAL-PCT                         06550000
065600     END-IF.                                                      06560000
065700                                                                  06570000
065800     ADD +1                  TO PV-LINE-COUNT                     06580000
065900     PERFORM 3100-PRINT-CORP-DETAIL-LINE.                         06590000
066000                                                                  06600000
066100                                                                  06610000
066110*----------------------------------------------------------------*06611002
066120*                                                                *06612001
066130*----------------------------------------------------------------*06613002
066300 2100-SUMM-DC.                                                    06630000
066310                                                                  06631001
066400     MOVE 0                   TO PV-OUTBOUND-ASN.                 06640000
066500     MOVE 0                   TO PV-OUTBOUND-CPS.                 06650000
066600     MOVE 0                   TO PV-OUTBOUND-SMO.                 06660000
066700     PERFORM 5100-FETCH-OUTBOUND-CURSOR                           06670000
066800         UNTIL (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06680000
066900           AND SUT00024-CART-SRC-CDE = 'ASN')                     06690000
067000            OR (SUT00024-ORGN-LOC-NBR > XLT00010-LOC-NBR)         06700000
067100            OR (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06710000
067200           AND SUT00024-CART-SRC-CDE > 'ASN') OR                  06720000
067300           PS-END-OUTBOUND-CURSOR.                                06730000
067400     IF PS-NOT-END-OUTBOUND-CURSOR AND                            06740000
067500        SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR AND              06750000
067600        SUT00024-CART-SRC-CDE = 'ASN'                             06760000
067700         MOVE PV-OUTBOUND-COUNT   TO PV-OUTBOUND-ASN              06770000
067800     END-IF.                                                      06780000
067900     PERFORM 5100-FETCH-OUTBOUND-CURSOR                           06790000
068000         UNTIL (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06800000
068100           AND SUT00024-CART-SRC-CDE = 'CPS')                     06810000
068200            OR (SUT00024-ORGN-LOC-NBR > XLT00010-LOC-NBR)         06820000
068300            OR (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06830000
068400           AND SUT00024-CART-SRC-CDE > 'CPS') OR                  06840000
068500           PS-END-OUTBOUND-CURSOR.                                06850000
068600     IF PS-NOT-END-OUTBOUND-CURSOR AND                            06860000
068700        SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR AND              06870000
068800        SUT00024-CART-SRC-CDE = 'CPS'                             06880000
068900         MOVE PV-OUTBOUND-COUNT   TO PV-OUTBOUND-CPS              06890000
069000     END-IF.                                                      06900000
069100     PERFORM 5100-FETCH-OUTBOUND-CURSOR                           06910000
069200         UNTIL (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06920000
069300           AND SUT00024-CART-SRC-CDE = 'SMO')                     06930000
069400            OR (SUT00024-ORGN-LOC-NBR > XLT00010-LOC-NBR)         06940000
069500            OR (SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR          06950000
069600           AND SUT00024-CART-SRC-CDE > 'SMO') OR                  06960000
069700           PS-END-OUTBOUND-CURSOR.                                06970000
069800     IF PS-NOT-END-OUTBOUND-CURSOR AND                            06980000
069900        SUT00024-ORGN-LOC-NBR = XLT00010-LOC-NBR AND              06990000
070000        SUT00024-CART-SRC-CDE = 'SMO'                             07000000
070100         MOVE PV-OUTBOUND-COUNT   TO PV-OUTBOUND-SMO              07010000
070200     END-IF.                                                      07020000
070300     PERFORM 2200-SUM-DISTHD-P2L.                                 07030000
070400     MOVE 0    TO PV-SULBXF-P2L.                                  07040000
070500     PERFORM 6100-FETCH-P2L-CHECKIN-CURSOR                        07050000
070600         UNTIL SHUNLO-OPER-UNT-ID = XLT00010-LOC-NBR OR           07060000
070700               SHUNLO-OPER-UNT-ID > XLT00010-LOC-NBR OR           07070000
070800               PS-END-P2L-CHECKIN-CURSOR.                         07080000
070900     IF PS-NOT-END-P2L-CHECKIN-CURSOR AND                         07090000
071000        SHUNLO-OPER-UNT-ID  = XLT00010-LOC-NBR                    07100000
071100         MOVE PV-SULBXF-COUNT     TO PV-SULBXF-P2L                07110000
071200     END-IF.                                                      07120000
071300     COMPUTE PV-TOT-CTNS-RECEIVED =                               07130000
071400             PV-OUTBOUND-SMO +                                    07140000
071500             PV-OUTBOUND-ASN +                                    07150000
071600             PV-OUTBOUND-CPS +                                    07160000
071700             PV-DISTHD-P2L +                                      07170000
071800             PV-SULBXF-P2L.                                       07180000
071900     COMPUTE PV-TOT-CTNS-RECEIVED-CORP =                          07190000
072000             PV-TOT-CTNS-RECEIVED-CORP +                          07200000
072100             PV-TOT-CTNS-RECEIVED.                                07210000
072200     COMPUTE PV-OUTBOUND-SMO-CORP =                               07220000
072300             PV-OUTBOUND-SMO-CORP +                               07230000
072400             PV-OUTBOUND-SMO.                                     07240000
072500     COMPUTE PV-OUTBOUND-ASN-CORP =                               07250000
072600             PV-OUTBOUND-ASN-CORP +                               07260000
072700             PV-OUTBOUND-ASN.                                     07270000
072800     COMPUTE PV-OUTBOUND-CPS-CORP =                               07280000
072900             PV-OUTBOUND-CPS-CORP +                               07290000
073000             PV-OUTBOUND-CPS.                                     07300000
073100     COMPUTE PV-DISTHD-P2L-CORP =                                 07310000
073200             PV-DISTHD-P2L-CORP +                                 07320000
073300             PV-DISTHD-P2L.                                       07330000
073400     COMPUTE PV-SULBXF-P2L-CORP =                                 07340000
073500             PV-SULBXF-P2L-CORP +                                 07350000
073600             PV-SULBXF-P2L.                                       07360000
073700                                                                  07370000
073800     COMPUTE PV-TOT-CTNS-CHECKIN =                                07380000
073900             PV-OUTBOUND-ASN +                                    07390000
074000             PV-SULBXF-P2L.                                       07400000
074100     COMPUTE PV-TOT-CTNS-CHECKIN-CORP =                           07410000
074200             PV-TOT-CTNS-CHECKIN-CORP +                           07420000
074300             PV-TOT-CTNS-CHECKIN.                                 07430000
074400                                                                  07440000
074500     COMPUTE PV-TOT-CTNS-PHYSICAL =                               07450000
074600             PV-OUTBOUND-SMO +                                    07460000
074700             PV-OUTBOUND-CPS +                                    07470000
074800             PV-DISTHD-P2L.                                       07480000
074900     COMPUTE PV-TOT-CTNS-PHYSICAL-CORP =                          07490000
075000             PV-TOT-CTNS-PHYSICAL-CORP +                          07500000
075100             PV-TOT-CTNS-PHYSICAL.                                07510000
075200                                                                  07520000
075300     COMPUTE PV-TOT-SML =                                         07530000
075400             PV-OUTBOUND-SMO +                                    07540000
075500             PV-OUTBOUND-ASN +                                    07550000
075600             PV-OUTBOUND-CPS.                                     07560000
075700     COMPUTE PV-TOT-SML-CORP =                                    07570000
075800             PV-TOT-SML-CORP +                                    07580000
075900             PV-TOT-SML.                                          07590000
076000                                                                  07600000
076100     COMPUTE PV-TOT-P2L =                                         07610000
076200             PV-DISTHD-P2L +                                      07620000
076300             PV-SULBXF-P2L.                                       07630000
076400     COMPUTE PV-TOT-P2L-CORP =                                    07640000
076500             PV-TOT-P2L-CORP +                                    07650000
076600             PV-TOT-P2L.                                          07660000
076700                                                                  07670000
076800     IF PV-TOT-CTNS-CHECKIN > 0 AND                               07680000
076900        PV-TOT-CTNS-RECEIVED > 0                                  07690000
077000         COMPUTE PV-WORKING-PCT =                                 07700000
077100                (PV-TOT-CTNS-CHECKIN /                            07710000
077200                 PV-TOT-CTNS-RECEIVED)                            07720000
077300         COMPUTE PV-UCC128-PCT ROUNDED =                          07730000
077400                 PV-WORKING-PCT * 100                             07740000
077500     ELSE                                                         07750000
077600         MOVE 0        TO PV-UCC128-PCT                           07760000
077700     END-IF.                                                      07770000
077800                                                                  07780000
077900     IF PV-TOT-CTNS-PHYSICAL > 0 AND                              07790000
078000        PV-TOT-CTNS-RECEIVED > 0                                  07800000
078100         COMPUTE PV-WORKING-PCT =                                 07810000
078200                (PV-TOT-CTNS-PHYSICAL /                           07820000
078300                 PV-TOT-CTNS-RECEIVED)                            07830000
078400         COMPUTE PV-PHYSICAL-PCT ROUNDED =                        07840000
078500                 PV-WORKING-PCT * 100                             07850000
078600     ELSE                                                         07860000
078700         MOVE 0        TO PV-PHYSICAL-PCT                         07870000
078800     END-IF.                                                      07880000
078900                                                                  07890000
079000     IF PV-TOT-SML > 0 AND                                        07900000
079100        PV-TOT-CTNS-RECEIVED > 0                                  07910000
079200         COMPUTE PV-WORKING-PCT =                                 07920000
079300                (PV-TOT-SML /                                     07930000
079400                 PV-TOT-CTNS-RECEIVED)                            07940000
079500         COMPUTE PV-SML-PCT ROUNDED =                             07950000
079600                 PV-WORKING-PCT * 100                             07960000
079700     ELSE                                                         07970000
079800         MOVE 0        TO PV-SML-PCT                              07980000
079900     END-IF.                                                      07990000
080000                                                                  08000000
080100     IF PV-OUTBOUND-ASN > 0 AND                                   08010000
080200        PV-TOT-SML > 0                                            08020000
080300         COMPUTE PV-WORKING-PCT =                                 08030000
080400                (PV-OUTBOUND-ASN /                                08040000
080500                 PV-TOT-SML)                                      08050000
080600         COMPUTE PV-SML-CHECKIN-PCT ROUNDED =                     08060000
080700                 PV-WORKING-PCT * 100                             08070000
080800     ELSE                                                         08080000
080900         MOVE 0        TO PV-SML-CHECKIN-PCT                      08090000
081000     END-IF.                                                      08100000
081100                                                                  08110000
081200     IF PV-OUTBOUND-CPS > 0 AND                                   08120000
081300        PV-TOT-SML > 0                                            08130000
081400         COMPUTE PV-WORKING-PCT =                                 08140000
081500                (PV-OUTBOUND-CPS /                                08150000
081600                 PV-TOT-SML)                                      08160000
081700         COMPUTE PV-SML-PHYSICAL-PCT ROUNDED =                    08170000
081800                 PV-WORKING-PCT * 100                             08180000
081900     ELSE                                                         08190000
082000         MOVE 0        TO PV-SML-PHYSICAL-PCT                     08200000
082100     END-IF.                                                      08210000
082200                                                                  08220000
082300     IF PV-OUTBOUND-SMO > 0 AND                                   08230000
082400        PV-TOT-SML > 0                                            08240000
082500         COMPUTE PV-WORKING-PCT =                                 08250000
082600                (PV-OUTBOUND-SMO /                                08260000
082700                 PV-TOT-SML)                                      08270000
082800         COMPUTE PV-SML-SMOOTHING-PCT ROUNDED =                   08280000
082900                 PV-WORKING-PCT * 100                             08290000
083000     ELSE                                                         08300000
083100         MOVE 0        TO PV-SML-SMOOTHING-PCT                    08310000
083200     END-IF.                                                      08320000
083300                                                                  08330000
083400     IF PV-TOT-P2L > 0 AND                                        08340000
083500        PV-TOT-CTNS-RECEIVED > 0                                  08350000
083600         COMPUTE PV-WORKING-PCT =                                 08360000
083700                (PV-TOT-P2L /                                     08370000
083800                 PV-TOT-CTNS-RECEIVED)                            08380000
083900         COMPUTE PV-P2L-SML-PCT ROUNDED =                         08390000
084000                 PV-WORKING-PCT * 100                             08400000
084100     ELSE                                                         08410000
084200         MOVE 0        TO PV-P2L-SML-PCT                          08420000
084300     END-IF.                                                      08430000
084400                                                                  08440000
084500     IF PV-SULBXF-P2L > 0 AND                                     08450000
084600        PV-TOT-P2L > 0                                            08460000
084700         COMPUTE PV-WORKING-PCT =                                 08470000
084800                (PV-SULBXF-P2L /                                  08480000
084900                 PV-TOT-P2L)                                      08490000
085000         COMPUTE PV-P2L-CHECKIN-PCT ROUNDED =                     08500000
085100                 PV-WORKING-PCT * 100                             08510000
085200     ELSE                                                         08520000
085300         MOVE 0        TO PV-P2L-CHECKIN-PCT                      08530000
085400     END-IF.                                                      08540000
085500                                                                  08550000
085600     IF PV-DISTHD-P2L > 0 AND                                     08560000
085700        PV-TOT-P2L > 0                                            08570000
085800         COMPUTE PV-WORKING-PCT =                                 08580000
085900                (PV-DISTHD-P2L /                                  08590000
086000                 PV-TOT-P2L)                                      08600000
086100         COMPUTE PV-P2L-PHYSICAL-PCT ROUNDED =                    08610000
086200                 PV-WORKING-PCT * 100                             08620000
086300     ELSE                                                         08630000
086400         MOVE 0        TO PV-P2L-PHYSICAL-PCT                     08640000
086500     END-IF.                                                      08650000
086600                                                                  08660000
086601                                                                  08660101
086610*----------------------------------------------------------------*08661002
086620*                                                                *08662001
086630*----------------------------------------------------------------*08663002
086800 2200-SUM-DISTHD-P2L.                                             08680000
086900                                                                  08690000
087000     MOVE 0      TO PV-DISTHD-P2L.                                08700000
087100                                                                  08710000
087200     EXEC SQL                                                     08720000
087300         SELECT SUM(P2L_CART_CNT)                                 08730000
087400         INTO   :PV-DISTHD-P2L                                    08740000
087500         FROM                                                     08750000
087600              TDISTHD                                             08760000
087700         WHERE OPER_UNT_ID           = :XLT00010-LOC-NBR          08770000
087800           AND DATE(CRE_TMST)        = :COCNTL-BTCH-PRC-DTE       08780000
087900           AND UCC128_DAT_USG_CDE    IN ('N','I')                 08790000
088000     END-EXEC.                                                    08800000
088100                                                                  08810000
088200     EVALUATE TRUE                                                08820000
088300         WHEN SQLCODE = +0                                        08830000
088400             CONTINUE                                             08840000
088500         WHEN SQLCODE = -305                                      08850000
088600             MOVE 0    TO PV-DISTHD-P2L                           08860000
088700         WHEN SQLCODE < ZERO                                      08870000
088800         WHEN SQLCODE > ZERO                                      08880000
088900         WHEN SQLWARN0 NOT = SPACE                                08890000
089000             MOVE '2200-SUM-DISTHD-P2L'                           08900000
089100                                      TO PV-PARAGRAPH             08910000
089200             MOVE 'SUM'               TO PV-DB2-FUNCTION          08920000
089300             PERFORM 9100-SQL-ABEND                               08930000
089400     END-EVALUATE.                                                08940000
089500                                                                  08950001
089510                                                                  08951001
089520*----------------------------------------------------------------*08952002
089530*                                                                *08953001
089540*----------------------------------------------------------------*08954002
089700 3000-PRINT-DETAIL-LINE.                                          08970000
089800                                                                  08980001
089900     MOVE XLT00010-LOC-NBR         TO DL1-OPER-UNT.               08990000
090000     MOVE XLT00010-LOC-NM          TO DL1-OPER-DESC.              09000000
090100     MOVE PV-TOT-CTNS-RECEIVED     TO DL1-TOT-CARTN-RECVD.        09010000
090200     MOVE PV-TOT-CTNS-CHECKIN      TO DL1-TOT-CARTN-CHCKIN.       09020000
090300     MOVE PV-TOT-CTNS-PHYSICAL     TO DL1-TOT-CARTN-PHYSCL.       09030000
090400     MOVE PV-TOT-SML               TO DL1-SML-TOTAL.              09040000
090500     MOVE PV-OUTBOUND-ASN          TO DL1-SML-CKECKIN.            09050000
090600     MOVE PV-OUTBOUND-CPS          TO DL1-SML-PHYSICAL.           09060000
090700     MOVE PV-OUTBOUND-SMO          TO DL1-SML-SMOOTHING.          09070000
090800     MOVE PV-TOT-P2L               TO DL1-P2L-TOTAL.              09080000
090900     MOVE PV-SULBXF-P2L            TO DL1-P2L-CHECKIN.            09090000
091000     MOVE PV-DISTHD-P2L            TO DL1-P2L-PHYSICAL.           09100000
091100                                                                  09110001
091200     MOVE PV-UCC128-PCT            TO DL2-TOT-CRT-CHKIN-PCT.      09120000
091300     MOVE PV-PHYSICAL-PCT          TO DL2-TOT-CRT-PHYSCL-PCT.     09130000
091400     MOVE PV-SML-PCT               TO DL2-SML-TOTAL-PCT.          09140000
091500     MOVE PV-SML-CHECKIN-PCT       TO DL2-SML-CKECKIN-PCT.        09150000
091600     MOVE PV-SML-PHYSICAL-PCT      TO DL2-SML-PHYSICAL-PCT.       09160000
091700     MOVE PV-SML-SMOOTHING-PCT     TO DL2-SML-SMOOTHING-PCT.      09170000
091800     MOVE PV-P2L-SML-PCT           TO DL2-P2L-TOTAL-PCT.          09180000
091900     MOVE PV-P2L-CHECKIN-PCT       TO DL2-P2L-CHECKIN-PCT.        09190000
092000     MOVE PV-P2L-PHYSICAL-PCT      TO DL2-P2L-PHYSICAL-PCT.       09200000
092100                                                                  09210000
092300     ADD +3 TO PV-LINE-COUNT.                                     09230000
092400     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         09240000
092500         PERFORM 1300-PAGE-BREAK                                  09250000
092600     END-IF.                                                      09260000
092700                                                                  09270001
092800     WRITE REPORT-RECORD                                          09280000
092900       FROM DETAIL-LINE1                                          09290000
093000         AFTER ADVANCING 2 LINE.                                  09300000
093100                                                                  09310001
093200     WRITE REPORT-RECORD                                          09320000
093300       FROM DETAIL-LINE2                                          09330000
093400         AFTER ADVANCING 1 LINE.                                  09340000
093500                                                                  09350001
093600                                                                  09360001
093700*----------------------------------------------------------------*09370002
093710*                                                                *09371001
093720*----------------------------------------------------------------*09372002
093800 3100-PRINT-CORP-DETAIL-LINE.                                     09380000
093900                                                                  09390001
094000     MOVE 0                         TO DL1-OPER-UNT.              09400000
094100     MOVE 'CORPORATE TOTALS'        TO DL1-OPER-DESC.             09410000
094200     MOVE PV-TOT-CTNS-RECEIVED-CORP TO DL1-TOT-CARTN-RECVD.       09420000
094300     MOVE PV-TOT-CTNS-CHECKIN-CORP  TO DL1-TOT-CARTN-CHCKIN.      09430000
094400     MOVE PV-TOT-CTNS-PHYSICAL-CORP TO DL1-TOT-CARTN-PHYSCL.      09440000
094500     MOVE PV-TOT-SML-CORP           TO DL1-SML-TOTAL.             09450000
094600     MOVE PV-OUTBOUND-ASN-CORP      TO DL1-SML-CKECKIN.           09460000
094700     MOVE PV-OUTBOUND-CPS-CORP      TO DL1-SML-PHYSICAL.          09470000
094800     MOVE PV-OUTBOUND-SMO-CORP      TO DL1-SML-SMOOTHING.         09480000
094900     MOVE PV-TOT-P2L-CORP           TO DL1-P2L-TOTAL.             09490000
095000     MOVE PV-SULBXF-P2L-CORP        TO DL1-P2L-CHECKIN.           09500000
095100     MOVE PV-DISTHD-P2L-CORP        TO DL1-P2L-PHYSICAL.          09510000
095200                                                                  09520001
095300     MOVE PV-UCC128-PCT             TO DL2-TOT-CRT-CHKIN-PCT.     09530000
095400     MOVE PV-PHYSICAL-PCT           TO DL2-TOT-CRT-PHYSCL-PCT.    09540000
095500     MOVE PV-SML-PCT                TO DL2-SML-TOTAL-PCT.         09550000
095600     MOVE PV-SML-CHECKIN-PCT        TO DL2-SML-CKECKIN-PCT.       09560000
095700     MOVE PV-SML-PHYSICAL-PCT       TO DL2-SML-PHYSICAL-PCT.      09570000
095800     MOVE PV-SML-SMOOTHING-PCT      TO DL2-SML-SMOOTHING-PCT.     09580000
095900     MOVE PV-P2L-SML-PCT            TO DL2-P2L-TOTAL-PCT.         09590000
096000     MOVE PV-P2L-CHECKIN-PCT        TO DL2-P2L-CHECKIN-PCT.       09600000
096100     MOVE PV-P2L-PHYSICAL-PCT       TO DL2-P2L-PHYSICAL-PCT.      09610000
096200                                                                  09620000
096400     ADD +5 TO PV-LINE-COUNT.                                     09640000
096500     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         09650000
096600         PERFORM 1300-PAGE-BREAK                                  09660000
096700     END-IF.                                                      09670000
096800                                                                  09680001
096900     WRITE REPORT-RECORD                                          09690000
097000       FROM DETAIL-LINE1                                          09700000
097100         AFTER ADVANCING 2 LINES.                                 09710000
097200                                                                  09720001
097300     WRITE REPORT-RECORD                                          09730000
097400       FROM DETAIL-LINE2                                          09740000
097500         AFTER ADVANCING 1 LINE.                                  09750000
097600                                                                  09760001
097700     WRITE REPORT-RECORD                                          09770000
097800       FROM END-OF-REPORT-LINE                                    09780000
097900         AFTER ADVANCING 2 LINES.                                 09790000
098000                                                                  09800000
098010*----------------------------------------------------------------*09801002
098020*                                                                *09802001
098030*----------------------------------------------------------------*09803002
098100 4000-WRITE-OUTPUT-RECORD.                                        09810000
098110                                                                  09811001
098200     MOVE XLT00010-LOC-NBR         TO SU059-OPER-UNT-ID.          09820000
098300     MOVE COCNTL-BTCH-PRC-DTE      TO SU059-DATE.                 09830000
098400     MOVE DTATTR-FSCL-YR-NBR       TO SU059-FISCAL-YEAR.          09840000
098500     MOVE DTATTR-FSCL-MN-NBR       TO SU059-FISCAL-MONTH.         09850000
098600     MOVE DTATTR-FSCL-WK-NBR       TO SU059-FISCAL-WEEK.          09860000
098700     MOVE DTATTR-SEA-DESC          TO SU059-SEASON.               09870000
098800     MOVE PV-TOT-CTNS-RECEIVED     TO SU059-TOT-CTNS-RECEIVED.    09880000
098900     MOVE PV-TOT-CTNS-CHECKIN      TO SU059-TOT-CTNS-CHECKIN.     09890000
099000     MOVE PV-TOT-CTNS-PHYSICAL     TO SU059-TOT-CTNS-PHYSICAL.    09900000
099100     MOVE PV-TOT-SML               TO SU059-TOT-SML.              09910000
099200     MOVE PV-OUTBOUND-ASN          TO SU059-OUTBOUND-ASN.         09920000
099300     MOVE PV-OUTBOUND-CPS          TO SU059-OUTBOUND-CPS.         09930000
099400     MOVE PV-OUTBOUND-SMO          TO SU059-OUTBOUND-SMO.         09940000
099500     MOVE PV-TOT-P2L               TO SU059-TOT-P2L.              09950000
099600     MOVE PV-SULBXF-P2L            TO SU059-SULBXF-P2L.           09960000
099700     MOVE PV-DISTHD-P2L            TO SU059-DISTHD-P2L.           09970000
099800     WRITE OUTPUT-RECORD                                          09980000
099900       FROM SU059-RECORD.                                         09990000
100000                                                                  10000001
100010                                                                  10001001
100020*----------------------------------------------------------------*10002002
100030*                                                                *10003001
100040*----------------------------------------------------------------*10004002
100100 5000-OPEN-OUTBOUND-CSR.                                          10010000
100200                                                                  10020000
100300     EXEC SQL                                                     10030000
100400         OPEN  SUT_OTBOUND_CSR                                    10040000
100500     END-EXEC.                                                    10050000
100600                                                                  10060000
100700     EVALUATE TRUE                                                10070000
100800         WHEN SQLCODE = +0                                        10080000
100900             SET PS-NOT-END-OUTBOUND-CURSOR TO TRUE               10090000
101000         WHEN SQLCODE < ZERO                                      10100000
101100         WHEN SQLCODE > ZERO                                      10110000
101200         WHEN SQLWARN0 NOT = SPACE                                10120000
101300             MOVE '5000-OPEN-OUTBOUND-CSR'                        10130000
101400                                      TO PV-PARAGRAPH             10140000
101500             MOVE 'OPEN'              TO PV-DB2-FUNCTION          10150000
101600             PERFORM 9100-SQL-ABEND                               10160000
101700     END-EVALUATE.                                                10170000
101800                                                                  10180000
101801                                                                  10180101
101810*----------------------------------------------------------------*10181002
101820*                                                                *10182001
101830*----------------------------------------------------------------*10183002
101900 5100-FETCH-OUTBOUND-CURSOR.                                      10190000
102000                                                                  10200000
102100     EXEC SQL                                                     10210000
102200         FETCH SUT_OTBOUND_CSR                                    10220000
102300         INTO  :PV-OUTBOUND-COUNT                                 10230000
102400             , :SUT00024-ORGN-LOC-NBR                             10240000
102500             , :SUT00024-CART-SRC-CDE                             10250000
102600     END-EXEC.                                                    10260000
102700                                                                  10270000
102800     EVALUATE TRUE                                                10280000
102900         WHEN SQLCODE = +0                                        10290000
103000             CONTINUE                                             10300000
103100         WHEN SQLCODE = +100                                      10310000
103200             SET PS-END-OUTBOUND-CURSOR TO TRUE                   10320000
103300         WHEN SQLCODE < ZERO                                      10330000
103400         WHEN SQLCODE > ZERO                                      10340000
103500         WHEN SQLWARN0 NOT = SPACE                                10350000
103600             MOVE '5100-FETCH-OUTBOUND-CURSOR'                    10360000
103700                                      TO PV-PARAGRAPH             10370000
103800             MOVE 'FETCH'             TO PV-DB2-FUNCTION          10380000
103900             PERFORM 9100-SQL-ABEND                               10390000
104000     END-EVALUATE.                                                10400000
104100                                                                  10410000
104110                                                                  10411002
104120*----------------------------------------------------------------*10412002
104130*                                                                *10413002
104140*----------------------------------------------------------------*10414002
104200 5200-CLOSE-OUTBOUND-CURSOR.                                      10420000
104300                                                                  10430000
104400     EXEC SQL                                                     10440000
104500         CLOSE SUT_OTBOUND_CSR                                    10450000
104600     END-EXEC.                                                    10460000
104700     EVALUATE TRUE                                                10470000
104800         WHEN SQLCODE = +0                                        10480000
104900             CONTINUE                                             10490000
105000         WHEN SQLCODE < ZERO                                      10500000
105100         WHEN SQLCODE > ZERO                                      10510000
105200         WHEN SQLWARN0 NOT = SPACE                                10520000
105300             MOVE '5200-CLOSE-OUTBOUND-CURSOR'                    10530000
105400                                      TO PV-PARAGRAPH             10540000
105500             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          10550000
105600             PERFORM 9100-SQL-ABEND                               10560000
105700     END-EVALUATE.                                                10570000
105800                                                                  10580000
105900                                                                  10590000
105910*----------------------------------------------------------------*10591002
105920*                                                                *10592001
105930*----------------------------------------------------------------*10593002
106000 6000-OPEN-P2L-CHECKIN-CSR.                                       10600000
106100                                                                  10610000
106200     EXEC SQL                                                     10620000
106300         OPEN  P2L_CHECKIN_CSR                                    10630000
106400     END-EXEC.                                                    10640000
106500                                                                  10650000
106600     EVALUATE TRUE                                                10660000
106700         WHEN SQLCODE = +0                                        10670000
106800             SET PS-NOT-END-P2L-CHECKIN-CURSOR TO TRUE            10680000
106900         WHEN SQLCODE < ZERO                                      10690000
107000         WHEN SQLCODE > ZERO                                      10700000
107100         WHEN SQLWARN0 NOT = SPACE                                10710000
107200             MOVE '6000-OPEN-P2L-CHECKIN-CSR'                     10720000
107300                                      TO PV-PARAGRAPH             10730000
107400             MOVE 'OPEN'              TO PV-DB2-FUNCTION          10740000
107500             PERFORM 9100-SQL-ABEND                               10750000
107600     END-EVALUATE.                                                10760000
107700                                                                  10770000
107710                                                                  10771001
107720*----------------------------------------------------------------*10772002
107730*                                                                *10773001
107740*----------------------------------------------------------------*10774002
107800 6100-FETCH-P2L-CHECKIN-CURSOR.                                   10780000
107900                                                                  10790000
108000     EXEC SQL                                                     10800000
108100         FETCH P2L_CHECKIN_CSR                                    10810000
108200         INTO   :PV-SULBXF-COUNT                                  10820000
108300            ,   :SHUNLO-OPER-UNT-ID                               10830000
108400     END-EXEC.                                                    10840000
108500                                                                  10850000
108600     EVALUATE TRUE                                                10860000
108700         WHEN SQLCODE = +0                                        10870000
108800             CONTINUE                                             10880000
108900         WHEN SQLCODE = +100                                      10890000
109000             SET PS-END-P2L-CHECKIN-CURSOR TO TRUE                10900000
109100         WHEN SQLCODE < ZERO                                      10910000
109200         WHEN SQLCODE > ZERO                                      10920000
109300         WHEN SQLWARN0 NOT = SPACE                                10930000
109400             MOVE '6100-FETCH-P2L-CHECKIN-CURSOR'                 10940000
109500                                      TO PV-PARAGRAPH             10950000
109600             MOVE 'FETCH'             TO PV-DB2-FUNCTION          10960000
109700             PERFORM 9100-SQL-ABEND                               10970000
109800     END-EVALUATE.                                                10980000
109900                                                                  10990000
109910                                                                  10991001
109920*----------------------------------------------------------------*10992002
109930*                                                                *10993001
109940*----------------------------------------------------------------*10994002
110000 6200-CLOSE-P2L-CHECKIN-CURSOR.                                   11000000
110100                                                                  11010000
110200     EXEC SQL                                                     11020000
110300         CLOSE P2L_CHECKIN_CSR                                    11030000
110400     END-EXEC.                                                    11040000
110500     EVALUATE TRUE                                                11050000
110600         WHEN SQLCODE = +0                                        11060000
110700             CONTINUE                                             11070000
110800         WHEN SQLCODE < ZERO                                      11080000
110900         WHEN SQLCODE > ZERO                                      11090000
111000         WHEN SQLWARN0 NOT = SPACE                                11100000
111100             MOVE '6200-CLOSE-P2L-CHECKIN-CURSOR'                 11110000
111200                                      TO PV-PARAGRAPH             11120000
111300             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          11130000
111400             PERFORM 9100-SQL-ABEND                               11140000
111500     END-EVALUATE.                                                11150000
111600                                                                  11160000
111700                                                                  11170001
111710*----------------------------------------------------------------*11171002
111720*                                                                *11172001
111730*----------------------------------------------------------------*11173002
111800 7000-OPEN-DC-CURSOR.                                             11180000
111900                                                                  11190000
112000     EXEC SQL                                                     11200000
112100         OPEN  DC_CSR                                             11210000
112200     END-EXEC.                                                    11220000
112300                                                                  11230000
112400     EVALUATE TRUE                                                11240000
112500         WHEN SQLCODE = +0                                        11250000
112600             SET PS-NOT-END-DC-CURSOR TO TRUE                     11260000
112700         WHEN SQLCODE < ZERO                                      11270000
112800         WHEN SQLCODE > ZERO                                      11280000
112900         WHEN SQLWARN0 NOT = SPACE                                11290000
113000             MOVE '7000-OPEN-DC-CURSOR'                           11300000
113100                                      TO PV-PARAGRAPH             11310000
113200             MOVE 'OPEN'              TO PV-DB2-FUNCTION          11320000
113300             PERFORM 9100-SQL-ABEND                               11330000
113400     END-EVALUATE.                                                11340000
113500                                                                  11350000
113510                                                                  11351001
113520*----------------------------------------------------------------*11352002
113530*                                                                *11353001
113540*----------------------------------------------------------------*11354002
113600 7100-FETCH-DC-CURSOR.                                            11360000
113700                                                                  11370000
113800     EXEC SQL                                                     11380000
113900         FETCH DC_CSR                                             11390000
114000          INTO :XLT00010-LOC-NBR                                  11400000
114100            ,  :XLT00010-LOC-NM                                   11410000
114200     END-EXEC.                                                    11420000
114300                                                                  11430000
114400     EVALUATE TRUE                                                11440000
114500         WHEN SQLCODE = +0                                        11450000
114600             CONTINUE                                             11460000
114700         WHEN SQLCODE = +100                                      11470000
114800             SET PS-END-DC-CURSOR   TO TRUE                       11480000
114900         WHEN SQLCODE < ZERO                                      11490000
115000         WHEN SQLCODE > ZERO                                      11500000
115100         WHEN SQLWARN0 NOT = SPACE                                11510000
115200             MOVE '7100-FETCH-DC-CURSOR'                          11520000
115300                                      TO PV-PARAGRAPH             11530000
115400             MOVE 'FETCH'             TO PV-DB2-FUNCTION          11540000
115500             PERFORM 9100-SQL-ABEND                               11550000
115600     END-EVALUATE.                                                11560000
115700                                                                  11570000
115710                                                                  11571001
115720*----------------------------------------------------------------*11572002
115730*                                                                *11573001
115740*----------------------------------------------------------------*11574002
115800 7200-CLOSE-DC-CURSOR.                                            11580000
115900                                                                  11590000
116000     EXEC SQL                                                     11600000
116100         CLOSE DC_CSR                                             11610000
116200     END-EXEC.                                                    11620000
116300     EVALUATE TRUE                                                11630000
116400         WHEN SQLCODE = +0                                        11640000
116500             CONTINUE                                             11650000
116600         WHEN SQLCODE < ZERO                                      11660000
116700         WHEN SQLCODE > ZERO                                      11670000
116800         WHEN SQLWARN0 NOT = SPACE                                11680000
116900             MOVE '7200-CLOSE-DC-CURSOR'                          11690000
117000                                      TO PV-PARAGRAPH             11700000
117100             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          11710000
117200             PERFORM 9100-SQL-ABEND                               11720000
117300     END-EVALUATE.                                                11730000
117400                                                                  11740000
117410                                                                  11741001
117420*----------------------------------------------------------------*11742002
117430*                                                                *11743001
117440*----------------------------------------------------------------*11744002
117500 8000-READ-CONTROL-REC.                                           11750000
117600                                                                  11760000
117700     READ CONTROL-FILE INTO                                       11770000
117800           PV-CONTROL-REC                                         11780000
117900     AT END                                                       11790000
118000         CONTINUE                                                 11800000
118100     NOT AT END                                                   11810000
118200         DISPLAY 'DATE CONTROL CARD:'                             11820000
118300         DISPLAY PV-CONTROL-REC                                   11830000
118400         DISPLAY SPACES                                           11840000
118500     END-READ.                                                    11850000
118600                                                                  11860000
118610                                                                  11861001
118620*----------------------------------------------------------------*11862002
118630*                                                                *11863001
118640*----------------------------------------------------------------*11864002
118700 9100-SQL-ABEND.                                                  11870000
118710                                                                  11871001
118800     MOVE SQLCODE                     TO SQLCODE2.                11880000
118900     MOVE SQLERRD(3)                  TO SQLERRD3.                11890000
119000                                                                  11900000
119100     DISPLAY '** ABEND **         ** = SQLERROR'.                 11910000
119200     DISPLAY '** PROGRAM   ** = ' PC-SUKRP078.                    11920000
119300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   11930000
119400     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11940000
119500                                                                  11950000
119600     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                11960000
119700     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                11970000
119800     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 11980000
119900     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                11990000
120000                                                                  12000000
120100                                                                  12010000
120200     MOVE +4013                       TO ABEND-CODE.              12020000
120300     CALL 'ILBOABN0' USING ABEND-CODE.                            12030000
