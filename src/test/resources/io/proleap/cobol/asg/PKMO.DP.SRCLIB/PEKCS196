000100*-----------------------*                                         00010094
000200 IDENTIFICATION DIVISION.                                         00020094
000300*-----------------------*                                         00030094
000400 PROGRAM-ID.    PEKCS196.                                         00040094
000500 AUTHOR.        AMY REILAND.                                      00050094
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060094
000700 DATE-WRITTEN.  AUGUST 1993.                                      00070094
000800 DATE-COMPILED.                                                   00080094
000900                                                                  00090094
001000*---------------------------------------------------------------* 00100094
001100*    Q196 - IN-STORE PRICE CHANGE DETAIL ADD/UPDATE             * 00110094
001200*                                                               * 00120094
001300*    THIS PROGRAM PROVIDES A LIST OF ALL THE IN-STORE DOCUMENT  * 00130094
001400*    DETAIL LINES FOR A SPECIFIC STORE DOCUMENT.  LINES CAN     * 00140094
001500*    BE ADDED, DELETED OR UPDATED.                              * 00150094
001600*    IN ORDER TO DELETE A LINE, THE USER MUST SPACE OUT THE     * 00160094
001700*    DEPARTMENT NUMBER ON A LINE.                               * 00170094
001800*---------------------------------------------------------------* 00180094
001900*    10/28/93 - A.REILAND                                       * 00190094
002000*       ADD AN EDIT TO ENSURE THE QUANTITY IS >= 1.             * 00200094
002100*---------------------------------------------------------------* 00210094
002200*    11/11/93 - A.REILAND - WR 2593                             * 00220094
002300*       CHANGE THE PROGRAM TO DISPLAY THE RENUMBERED SKU IF     * 00230094
002400*       THE SKU ENTERED IS NOT FOUND.  IF A RENUMBERED SKU      * 00240094
002500*       IS NOT FOUND, IT IS AN INVALID SKU NUMBER.              * 00250094
002600*       THIS CHANGE IS BEING DONE BECAUSE THERE ARE TICKETS ON  * 00260094
002700*       OLD MERCHANDISE WHICH HAVE SKUS THAT EXISTED BEFORE A   * 00270094
002800*       RENUMBER WAS DONE, AND NOW THAT SKU IS DELETED OFF THE  * 00280094
002900*       SKU TABLE.                                              * 00290094
003000*       A NEW COLUMN WAS ADDED TO THE HEADER TABLE WHICH WILL   * 00300094
003100*       HOLD THE NUMBER OF PAGES REQUESTED TO PRINT PER         * 00310094
003200*       DOCUMENT.  A WARNING WILL BE DISPLAYED BY THIS PROGRAM  * 00320094
003300*       IF THE NUMBER OF PAGES THEY ENTER IS NOT EQUAL TO THE   * 00330094
003400*       NUMBER OF PAGES PRODUCED WHEN THE DOCUMENT WAS ADDED.   * 00340094
003500*---------------------------------------------------------------* 00350094
003600*    01/11/93 - A.REILAND -                                     * 00360094
003700*       MODIFY THE MESSAGE WHICH WILL DISPLAY IF THE CHECK      * 00370094
003800*       DIGIT IS INVALID TO 'INVALID CHECK DIGIT - 414' INSTEAD * 00380094
003900*       OF 'INVALID UPC - 100'.                                 * 00390094
004000*       DISPLAY AN ERROR IS THE EFFECTIVE DATE IS A FUTURE DATE.* 00400094
004100*       IT MUST BE A DATE EQUAL TO OR LESS THAN THE CURRENT     * 00410094
004200*       DATE.  IF NOT, WHEN PASSED TO LEDGER, THE RECORDS WILL  * 00420094
004300*       BE DROPPED BY THE EDIT.                                 * 00430094
004400*---------------------------------------------------------------* 00440094
004500* 12/03/96 - TCM -  WR NO. 3904                                 * 00450094
004600*    - REPLACE ALL "++INCLUDE" REFERENCES WITH "COPY"           * 00460094
004700*      REFERENCES, PER STANDARDS                                * 00470094
004800*    - ADD RETURN OF STRPPC-RSN-CDE TO SELECT IN                * 00480094
004900*      8050-VALIDATE-STORE-DOC                                  * 00490094
005000*    - DO NOT ALLOW REASON CODE "65" (RETURN TO VENDOR) PERM    * 00500094
005100*      IN-STORE DOCUMENTS TO BE PROCESSED BY THIS PROGRAM       * 00510094
005200*---------------------------------------------------------------* 00520094
005300* 09/04/97 - TCM -  WR NO. P000111022                           * 00530094
005400*    - CHANGE FIELD SIZE FROM PIC 9(5)V9(2) TO PIC 9(4)V9(2),   * 00540094
005500*      TO MATCH THE FIELD SIZE ON THE LEDGER FILE FOR:          * 00550094
005600*      ASC-ORIGINAL-PRICE, ASC-NEW-PRICE, ASC-PRICE-DIFF,       * 00560094
005700*      LQW-ORIGINAL-PRICE, LQW-NEW-PRICE, LQW-PRICE-DIFF        * 00570094
005800*    - CHANGE "DPKUT100" (NUMERIC EDIT) FOR ABOVE ASC- FIELDS   * 00580094
005900*      TO DP010I-MAXIMUM-DIGITS = 4                             * 00590094
006000*---------------------------------------------------------------* 00600094
006100* 12/22/99 - DAVE COLOMBO - COMPUWARE  WR NO. 20195             * 00610094
006200*    - ADD RCP (REGIONAL CLEARANCE PRICING) MODIFICATIONS.      * 00620094
006300*---------------------------------------------------------------* 00630094
006400* 02/18/2000 - JACK KRAMER WR20195 (RCP)                        * 00640094
006500*  --- MADE DATE ROUTINE CHANGES TO CONFORM TO Y2K STANDARDS:   * 00650094
006600*    - INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56      * 00660094
006700*      BEFORE ALL CALLS                                         * 00670094
006800*    - REMOVED DPG51-SYSTEM-DATE                                * 00680094
006900*    - REPLACE PC-CALENDAR-PGM WITH DP500-KOHLS-CALENDAR-ROUTINE* 00690094
007000*---------------------------------------------------------------* 00700094
007100* 04/10/2000 - JACK KRAMER IR# 426948                           * 00710094
007200*  --- TEST PV-HOLD-REASON-CODE TO BE NUMERIC BEFORE MOVING IT  * 00720094
007300*      TO P0E049-WORKING-INSTR-RSN-CDE IN 3200-RESET-ATTRIBUTES.* 00730094
007400*      IF A '.' WAS ENTERED INTO THE REASON CODE BE MISTAKE,    * 00740094
007500*      IT CAUSED AN 'ASRA' ABEND.                               * 00750094
007600*---------------------------------------------------------------* 00760094
007700* 10/19/2000 - JACK KRAMER IR# 524547                           * 00770094
007800*  --- RECOMPILE ONLY - TO GET SOURCE CODE SUPPORT IN ABENDAID *  00780094
007900*---------------------------------------------------------------* 00790094
008000* 10/19/2000 - JACK KRAMER IR# 524547                           * 00800094
008100*  - CHANGED THE LOGIC IN PARAGRAPH 3100-SET-SUBSCRIPTS TO      * 00810094
008200*    PERFORM THE SUBTRACT UNTIL ASC-ITEM-SUB IS NOT GREATER     * 00820094
008300*    THAN THE NUMBER OF LINES PER PANEL.                        * 00830094
008400*    SAME CHANGE WAS MADE IN PARAGRAPH 4400-                    * 00840094
008500*    THIS IS TO TRY TO PREVENT THE ASRA ABENDS THAT HAVE        * 00850094
008600*    BEEN OCCURRING. IN THE ABENDS, THE BLOCK SUBSCRIPT IS      * 00860094
008700*    2 AND THE ITEM SUBSCRIPT IS 11 (OUT OF BOUNDS).            * 00870094
008800*----------------------------------------------------------------*00880094
008900* 02/09/01 - JFK -  WR NO. 21963                                 *00890094
009000* ADDED RF CONTINUED CLEARANCE AND RETURN TO VENDOR SHORT DESCR. *00900094
009100* DO NOT ALLOW RF CONTINUED CLEARANCE DOCUMENTS TO BE UPDATED.   *00910094
009200* DO NOT ALLOW THE REASON CODE TO BE CHANGED TO AN RF CONTINUED  *00920094
009300* CLEARANCE OR A RETURN TO VENDOR REASON CODE.                   *00930094
009400* ALSO REMOVED THE CHANGES PUT IN ON 10/19/200 SINCE THEY DID NOT*00940094
009500* SOLVE THE ASRA PROBLEM.                                        *00950094
009600*---------------------------------------------------------------* 00960094
009700* 04/04/01 - TCM -  WR NO. P000398674                           * 00970094
009800*    - IN 6600-CHECK-TOTAL-QUANTITY ADD CODE TO CHECK THAT      * 00980094
009900*      PRICE/QUANTITY IS ZEROS OR NON-ZEROS FOR ALL LINES, NOT  * 00990094
010000*      JUST THOSE DISPLAYED, ON AN INVENTORY MISSED MARKDOWN    * 01000094
010100*      DOCUMENT                                                 * 01010094
010200*---------------------------------------------------------------* 01020094
010300*---------------------------------------------------------------* 01030094
010400* 02/03/03 - SUKUMAR, IGSI          - WR NO W24472              * 01040094
010500*    - FOR NI-SKU CONVERSION, 3 DIGIT SEQUENCE NUMBER IS        * 01050094
010600*      REPLACED BY 8 DIGIT SKU NUMBER.                          * 01060094
010700*---------------------------------------------------------------* 01070094
010800* 07/09/03 - LINDA MOYER            - WR NO P000564433          * 01080094
010900*    - FIX 8450 TO INCLUDE END EFF DATE ON TUPC.                * 01090094
011000*---------------------------------------------------------------* 01100094
011100* 11/06/03 - TODD C. MICHALEK       - WR NO WR25757             * 01110094
011200*    - NIS CHANGES ALLOWED SKU/SEQ 999 TO BE A VALID/ENTERABLE  * 01120094
011300*      SKU, IN 3300-EDIT-SELECTIONS, AND 3320-MOVE-SKU CHANGE   * 01130094
011400*      THIS BACK TO NOT ALLOW SKU/SEQ 999 TO BE A               * 01140094
011500*      VALID/ENTERABLE SKU                                      * 01150094
011600*    - REMOVE TPPCCTL COPYBOOK, NO LONGER BEING USED IN THE     * 01160094
011700*      PROGRAM                                                  * 01170094
011800*---------------------------------------------------------------* 01180094
011900* 01/06/04 - TODD C. MICHALEK       - WR NO WR24472             * 01190094
012000*    - IN 3300-EDIT-SELECTIONS CHANGE INITIALIZE                * 01200094
012100*      PS-ENTER-MISSED-MKDN-DATA-SW TO SET                      * 01210094
012200*      PS-DONT-ENTER-MISSED-MKDN-DATA TO TRUE.  INITIALIZATION  * 01220094
012300*      SET THE SWITCH TO SPACE.  BEFORE THE NIS CHANGES, THIS   * 01230094
012400*      SPACED SWITCH WAS ALWAYS SET TO Y/N IN PROCESSING.  THE  * 01240094
012500*      NIS CHANGES ALLOWED A SPACE TO BE PROCESSED, CAUSING     * 01250094
012600*      UNEXPECTED RESULTS IN PROCESSING '175'                   * 01260094
012700*      (PE049-IS-INVENTORY-MISSED-RSN AND PE049-MARKDOWN)       * 01270094
012800*      IN-STORE DOCUMENTS.                                      * 01280094
012900*---------------------------------------------------------------* 01290094
013000* 02/11/05 - TODD C. MICHALEK       - WR NO WR27559             * 01300094
013100*    - CHANGED ALL STORE NUMBER LENGTH REFERENCES FROM 3 TO 4   * 01310094
013200*      DIGITS IN LENGTH                                         * 01320094
013300*    - REPLACED TSTR000 STORE TABLE CALL(S) WITH STORE TABLE    * 01330094
013400*      CALL(S) TO XST_LOC                                       * 01340094
013500*    - CHANGED THE FILLER REDEFINES DP020-VARIABLE-COMMAREA     * 01350094
013600*      FILLER LENGTH AND THE APPROPRIATE MNEMONIC LENGTH        * 01360094
013700*    - REMOVED THE OPERCO_NBR FIELD FROM ALL IN-STORE PERM TABLE* 01370094
013800*      CALLS                                                    * 01380094
013900*    - ADDED THE NEW REASON CODE ("87") FOR                     * 01390094
014000*      "COSMETICS TESTERS ONLY" IN-STORE DOCUMENTS              * 01400094
014100*---------------------------------------------------------------* 01410094
014200* W28543  05-02-2005 ROD JANSSEN MISSED MARKDOWN/MISSED MARKUP    01420094
014300*                                ENHANCEMENTS                     01430094
014400*         **  ADJUST THE PERM INSTORE MAINTENANCE SCREENS TO NOT  01440094
014500*             ADD/UPDATE/CANCEL FUNCTIONALITY FOR INVENTORY       01450094
014600*             MISSED MARKDOWNS.                                   01460094
014700*----------------------------------------------------------------*01470094
014800* 10/26/05 - TCM -  WR NO. 28048                                 *01480094
014900*    - ADDED THE NEW REASON CODE ("89") FOR                      *01490094
015000*      "MARK OUT-OF-STOCK - SALVAGE" IN-STORE DOCUMENTS          *01500094
015100*----------------------------------------------------------------*01510094
015200* DATE  02/29/2012                                              * 01520094
015300*  CHANGE MADE:                                                 * 01530094
015400*    - EXPAND AMOUNT FIELD FROM 4 DIGIT TO 5 DIGITS             * 01540094
015500*  MADE BY: JALAJ KUMAR             IR #: SR3403                * 01550094
015600*---------------------------------------------------------------* 01560094
015610* 09/14/2021 - GERMAN BANDA - CHG0261678                          01561097
015620* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         01562095
015630*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   01563095
015640*              MAKING THE CALL DYNAMIC VS STATIC                  01564095
015650*---------------------------------------------------------------* 01565095
CICS  *  CHANGED 10/18/2022    BY BARB SCHULTZ    WR: CHG0276658        01566099
CICS  *                                                                 01567098
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL     01568099
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      01569098
CICS  *-----------------------------------------------------------------01569198
015600*  CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369        01569299
015600*  REMOVED COPYBOOK FOR UPC CHECK DIGIT ROUTINE                   01569599
015600*-----------------------------------------------------------------01569699
015700 ENVIRONMENT DIVISION.                                            01570094
015800                                                                  01580094
015900 DATA DIVISION.                                                   01590094
016000                                                                  01600094
016100 WORKING-STORAGE SECTION.                                         01610094
016200                                                                  01620094
016300 01  DK-DB2-KEYS.                                                 01630094
016400     15  DK-CURRENT-DATE-ISO            PIC  X(10)  VALUE SPACE.  01640094
016500     15  DK-EDITED-TIME-HMS             PIC  X(08)  VALUE SPACES. 01650094
016600     15  DK-DOC-NBR                     PIC S9(07)  VALUE ZEROS   01660094
016700                                                    COMP-3.       01670094
016800     15  DK-OPERATING-COMPANY           PIC  X(02)  VALUE SPACE.  01680094
016900     15  DK-ROW-NBR                     PIC S9(04)  VALUE ZEROS   01690094
017000                                                    COMP.         01700094
017100     15  DK-SKU-NBR                     PIC  X(08)  VALUE SPACE.  01710094
017200     15  DK-STORE-NBR                   PIC S9(04)  VALUE ZEROS   01720094
017300                                                    COMP.         01730094
017400     15  DK-UPC-CODE                    PIC S9(15)V VALUE ZERO    01740094
017500                                                    COMP-3.       01750094
017600     15  DK-USER-ID                     PIC  X(10)  VALUE SPACE.  01760094
017700                                                                  01770094
017800 01  PC-PROGRAM-CONSTANTS.                                        01780094
017900     05  PC-MDSELV-CDE                   PIC X(03)   VALUE 'SCL'. 01790094
018000     05  PC-OPERCO-NBR                   PIC X(02)   VALUE '03'.  01800094
018100     05  PC-APLSYS-CDE                   PIC X(02)   VALUE 'PE'.  01810094
018200     05  PC-ALL-ZERO-UPC-CODE           PIC S9(15)  VALUE +0      01820094
018300                                                    COMP-3.       01830094
018400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         01840094
018500                                                    'PE196A  '.   01850094
018600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         01860094
018700                                                    'PEKM196 '.   01870094
018800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         01880094
018900                                                    'PEKCS196'.   01890094
019000     05  PC-INTER-APPL-CODES.                                     01900094
019100         10  PC-INTER-APPL-CRIT-SPEC    PIC  X(01)  VALUE '1'.    01910094
019200         10  PC-INTER-APPL-LIST         PIC  X(01)  VALUE '2'.    01920094
019300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     01930094
019400                                                    COMP SYNC.    01940094
019500     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01950094
019600                                                    COMP SYNC.    01960094
019700     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01970094
019800                                                    +1000000      01980094
019900                                                    COMP-3.       01990094
020000     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       02000094
020100                                                    COMP-3.       02010094
020200     05  PC-MAX-TOTAL-QUANTITY          PIC  9(05)  VALUE 99999.  02020094
020300     05  PC-PERM-SYSTEM                 PIC  X(02)  VALUE 'PE'.   02030094
020400     05  PC-QUEUE-SEQ.                                            02040094
020500         10  PC-LIST-QUEUE-SEQ          PIC  9(01)  VALUE 1.      02050094
020600         10  PC-ORIG-QUEUE-SEQ          PIC  9(01)  VALUE 2.      02060094
020700         10  PC-HOLD-QUEUE-SEQ          PIC  9(01)  VALUE 3.      02070094
020800     05  PC-RENUMBERED-STATUS           PIC S9(03)  VALUE +98.    02080094
020900     05  PC-SUBCLASS                    PIC  X(03)  VALUE 'SCL'.  02090094
021000     05  PC-5                           PIC S9(04)  VALUE +5      02100094
021100                                                    COMP.         02110094
021200*                                                                 02120094
021300     05  PC-TSYMSG-NUMBERS.                                       02130094
021400         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  02140094
021500         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  02150094
021600         10  PC-TSYMSG-00009            PIC  9(05)  VALUE 00009.  02160094
021700         10  PC-TSYMSG-00010            PIC  9(05)  VALUE 00010.  02170094
021800         10  PC-TSYMSG-00022            PIC  9(05)  VALUE 00022.  02180094
021900         10  PC-TSYMSG-00026            PIC  9(05)  VALUE 00026.  02190094
022000         10  PC-TSYMSG-00027            PIC  9(05)  VALUE 00027.  02200094
022100         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  02210094
022200         10  PC-TSYMSG-00046            PIC  9(05)  VALUE 00046.  02220094
022300         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  02230094
022400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  02240094
022500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  02250094
022600         10  PC-TSYMSG-00073            PIC  9(05)  VALUE 00073.  02260094
022700         10  PC-TSYMSG-00100            PIC  9(05)  VALUE 00100.  02270094
022800         10  PC-TSYMSG-00110            PIC  9(05)  VALUE 00110.  02280094
022900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  02290094
023000         10  PC-TSYMSG-00283            PIC  9(05)  VALUE 00283.  02300094
023100         10  PC-TSYMSG-00284            PIC  9(05)  VALUE 00284.  02310094
023200         10  PC-TSYMSG-00292            PIC  9(05)  VALUE 00292.  02320094
023300         10  PC-TSYMSG-00343            PIC  9(05)  VALUE 00343.  02330094
023400         10  PC-TSYMSG-00396            PIC  9(05)  VALUE 00396.  02340094
023500         10  PC-TSYMSG-00401            PIC  9(05)  VALUE 00401.  02350094
023600         10  PC-TSYMSG-00414            PIC  9(05)  VALUE 00414.  02360094
023700         10  PC-TSYMSG-00507            PIC  9(05)  VALUE 00507.  02370094
023800         10  PC-TSYMSG-00527            PIC  9(05)  VALUE 00527.  02380094
023900         10  PC-TSYMSG-00600            PIC  9(05)  VALUE 00600.  02390094
024000         10  PC-TSYMSG-00602            PIC  9(05)  VALUE 00602.  02400094
024100         10  PC-TSYMSG-00603            PIC  9(05)  VALUE 00603.  02410094
024200         10  PC-TSYMSG-00611            PIC  9(05)  VALUE 00611.  02420094
024300         10  PC-TSYMSG-00626            PIC  9(05)  VALUE 00626.  02430094
024400         10  PC-TSYMSG-00642            PIC  9(05)  VALUE 00642.  02440094
024500         10  PC-TSYMSG-00667            PIC  9(05)  VALUE 00667.  02450094
024600         10  PC-TSYMSG-00979            PIC  9(05)  VALUE 00979.  02460094
024700         10  PC-TSYMSG-00980            PIC  9(05)  VALUE 00980.  02470094
024800         10  PC-TSYMSG-01005            PIC  9(05)  VALUE 01005.  02480094
024900*                                                                 02490094
025000 01  PS-PROGRAM-SWITCHES.                                         02500094
025100     05  PS-CHECK-FOR-DELETED-LINES-SW  PIC  X(01)  VALUE 'N'.    02510094
025200         88  PS-CHECK-FOR-DELETED-LINES             VALUE 'Y'.    02520094
025300         88  PS-NO-CHECK-FOR-DELETED-LINES          VALUE 'N'.    02530094
025400     05  PS-CLASS-NOT-ENTERED-VALID-SW  PIC  X(01)  VALUE 'N'.    02540094
025500         88  PS-CLASS-ENTERED-VALID                 VALUE 'Y'.    02550094
025600         88  PS-CLASS-NOT-ENTERED-VALID             VALUE 'N'.    02560094
025700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02570094
025800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02580094
025900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02590094
026000     05  PS-DEPT-NOT-ENTERED-VALID-SW   PIC  X(01)  VALUE 'N'.    02600094
026100         88  PS-DEPT-ENTERED-VALID                  VALUE 'Y'.    02610094
026200         88  PS-DEPT-NOT-ENTERED-VALID              VALUE 'N'.    02620094
026300     05  PS-EFF-DATE-SW                 PIC  X(01)  VALUE 'N'.    02630094
026400         88  PS-EFF-DATE-ENTERED                    VALUE 'Y'.    02640094
026500         88  PS-EFF-DATE-NOT-ENTERED                VALUE 'N'.    02650094
026600     05  PS-EFF-MM-SW                   PIC  X(01)  VALUE 'N'.    02660094
026700         88  PS-EFF-MM-ENTERED                      VALUE 'Y'.    02670094
026800         88  PS-EFF-MM-NOT-ENTERED                  VALUE 'N'.    02680094
026900     05  PS-EFF-DD-SW                   PIC  X(01)  VALUE 'N'.    02690094
027000         88  PS-EFF-DD-ENTERED                      VALUE 'Y'.    02700094
027100         88  PS-EFF-DD-NOT-ENTERED                  VALUE 'N'.    02710094
027200     05  PS-EFF-YY-SW                   PIC  X(01)  VALUE 'N'.    02720094
027300         88  PS-EFF-YY-ENTERED                      VALUE 'Y'.    02730094
027400         88  PS-EFF-YY-NOT-ENTERED                  VALUE 'N'.    02740094
027500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    02750094
027600         88  PS-NO-ERROR                            VALUE 'N'.    02760094
027700         88  PS-ERROR                               VALUE 'Y'.    02770094
027800     05  PS-WARNING-SW                  PIC  X(01)  VALUE 'N'.    02780094
027900         88  PS-NO-WARNING                          VALUE 'N'.    02790094
028000         88  PS-WARNING                             VALUE 'Y'.    02800094
028100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02810094
028200         88  PS-LIST-END                            VALUE 'Y'.    02820094
028300         88  PS-NO-LIST-END                         VALUE 'N'.    02830094
028400     05  PS-RSN-CDE-SW                  PIC  X(01)  VALUE 'N'.    02840094
028500         88  PS-VALID-RSN-CDE                       VALUE 'Y'.    02850094
028600         88  PS-INVALID-RSN-CDE                     VALUE 'N'.    02860094
028700     05  PS-SKU-NOT-ENTERED-VALID-SW    PIC  X(01)  VALUE 'N'.    02870094
028800         88  PS-SKU-ENTERED-VALID                   VALUE 'Y'.    02880094
028900         88  PS-SKU-NOT-ENTERED-VALID               VALUE 'N'.    02890094
029000     05  PS-TYPE-CDE-SW                 PIC  X(01)  VALUE 'N'.    02900094
029100         88  PS-VALID-TYPE-CDE                      VALUE 'Y'.    02910094
029200         88  PS-INVALID-TYPE-CDE                    VALUE 'N'.    02920094
029300     05  PS-UPC-NOT-ENTERED-VALID-SW    PIC  X(01)  VALUE 'N'.    02930094
029400         88  PS-UPC-ENTERED-VALID                   VALUE 'Y'.    02940094
029500         88  PS-UPC-NOT-ENTERED-VALID               VALUE 'N'.    02950094
029600     05  PS-UPDATE-PERFORMED-SW         PIC  X(01)  VALUE 'N'.    02960094
029700         88  PS-UPDATE-PERFORMED                    VALUE 'Y'.    02970094
029800         88  PS-NO-UPDATE-PERFORMED                 VALUE 'N'.    02980094
029900     05  PS-VALID-UPC-SW                PIC  X(01)  VALUE 'N'.    02990094
030000         88  PS-VALID-UPC                           VALUE 'Y'.    03000094
030100         88  PS-INVALID-UPC                         VALUE 'N'.    03010094
030200     05  PS-ENTER-MISSED-MKDN-DATA-SW   PIC  X      VALUE SPACE.  03020094
030300         88  PS-ENTER-MISSED-MKDN-DATA              VALUE 'Y'.    03030094
030400         88  PS-DONT-ENTER-MISSED-MKDN-DATA         VALUE 'N'.    03040094
030500     05  PS-SKU-FOUND-SW                PIC  X(01)  VALUE 'N'.    03050094
030600         88  PS-SKU-FOUND                           VALUE 'Y'.    03060094
030700     05  PS-VALID-DEPT-CLASS-SW         PIC  X(01)  VALUE 'N'.    03070094
030800         88  PS-VALID-DEPT-CLASS                    VALUE 'Y'.    03080094
030900         88  PS-INVALID-DEPT-CLASS                  VALUE 'N'.    03090094
031000*                                                                 03100094
031100 01  PV-PROGRAM-VARIABLES.                                        03110094
031200     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03120094
031300                                                    COMP SYNC.    03130094
031400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03140094
031500                                                    COMP-3.       03150094
031600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03160094
031700                                                    COMP SYNC.    03170094
031800     05  PV-HOLD-BLOCK-MODIFIED         PIC  X(01)  VALUE SPACES. 03180094
031900     05  PV-HOLD-BLOCK-TO-REDISPLAY     PIC S9(04)  VALUE +0      03190094
032000                                                    COMP SYNC.    03200094
032100     05  PV-HOLD-GREG-DATE.                                       03210094
032200         10  PV-HOLD-GREG-MM            PIC  9(02)  VALUE ZEROS.  03220094
032300         10  FILLER                     PIC  X(01)  VALUE '/'.    03230094
032400         10  PV-HOLD-GREG-DD            PIC  9(02)  VALUE ZEROS.  03240094
032500         10  FILLER                     PIC  X(01)  VALUE '/'.    03250094
032600         10  PV-HOLD-GREG-YY            PIC  9(02)  VALUE ZEROS.  03260094
032700     05  PV-HOLD-ISO-DATE.                                        03270094
032800         10  PV-HOLD-ISO-CC             PIC  9(02)  VALUE ZEROS.  03280094
032900         10  PV-HOLD-ISO-YY             PIC  9(02)  VALUE ZEROS.  03290094
033000         10  FILLER                     PIC  X(01)  VALUE SPACES. 03300094
033100         10  PV-HOLD-ISO-MM             PIC  9(02)  VALUE ZEROS.  03310094
033200         10  FILLER                     PIC  X(01)  VALUE SPACES. 03320094
033300         10  PV-HOLD-ISO-DD             PIC  9(02)  VALUE ZEROS.  03330094
033400     05  PV-HOLD-ITEM-SUB               PIC S9(04)  VALUE +0      03340094
033500                                                    COMP SYNC.    03350094
033600     05  PV-HOLD-LIST-ITEM-NUMBER       PIC S9(04)  VALUE +0      03360094
033700                                                    COMP SYNC.    03370094
033800     05  PV-HOLD-TYPE-REASON-CODE.                                03380094
033900         10  PV-HOLD-TYPE-CODE          PIC  9(01)  VALUE ZERO.   03390094
034000         10  PV-HOLD-REASON-CODE        PIC  9(02)  VALUE ZERO.   03400094
034100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03410094
034200                                                    COMP-3.       03420094
034300     05  PV-LINE-COUNTER                PIC  9(03)  VALUE  0.     03430094
034400     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03440094
034500                                                    COMP SYNC.    03450094
034600     05  PV-MAX-LINES-PER-DOC           PIC S9(03)  VALUE +0      03460094
034700                                                    COMP-3.       03470094
034800     05  PV-PAGE-REMAINDER              PIC S9(02)  VALUE +0      03480094
034900                                                    COMP.         03490094
035000     05  PV-PRICE-DIFF                  PIC S9(5)V9(02)           03500094
035100                                                    VALUE +0.     03510094
035200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      03520094
035300                                                    COMP-3.       03530094
035400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03540094
035500                                                    COMP SYNC.    03550094
035600                                                                  03560094
035700     05  PV-MAJ-CLASS-X.                                          03570094
035800         10 FILLER                      PIC X(02)   VALUE ZEROS.  03580094
035900         10 PV-MAJ-CL-3                 PIC X       VALUE ZEROS.  03590094
036000         10 FILLER                      PIC X       VALUE ZEROS.  03600094
036100     05  PV-MAJ-CLASS REDEFINES PV-MAJ-CLASS-X                    03610094
036200                                        PIC 9(04).                03620094
036300     05  PV-MAJ-CL-NBR.                                           03630094
036400         10 PV-MAJ-CL-NBR-1             PIC X        VALUE SPACES.03640094
036500         10 PV-MAJ-CL-NBR-2             PIC X        VALUE SPACES.03650094
036600     05  PV-SUB-CL-NBR.                                           03660094
036700         10 PV-SUB-CL-NBR-1             PIC X        VALUE SPACES.03670094
036800         10 PV-SUB-CL-NBR-2-3           PIC X(02)    VALUE SPACES.03680094
036900     05  PV-TEMP-SKU                    PIC 9(08).                03690094
037000     05  PV-TEMP-DEPT                   PIC 9(04).                03700094
037100     05  PV-TEMP-SUBCLASS               PIC 9(04).                03710094
037200     05  PV-RENUMBERED-SKU              PIC  X(08).               03720094
037300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03730094
037400                                                    COMP SYNC.    03740094
037500     05  PV-ROWS-WRITTEN-TO-LQW         PIC S9(09)  VALUE +0      03750094
037600                                                    COMP-3.       03760094
037700     05  PV-SPPCDT-ROW-NBR-NI           PIC S9(04)  VALUE +0      03770094
037800                                                    COMP.         03780094
037900     05  PV-SUB                         PIC S9(04)  VALUE +0      03790094
038000                                                    COMP SYNC.    03800094
038100     05  PV-SYS-CURR-FIRST-FISCAL-DAY   PIC  X(10)  VALUE SPACES. 03810094
038200     05  PV-SYS-CURR-FISCAL-YEAR-NBR    PIC  9(02)  VALUE ZEROS.  03820094
038300     05  PV-SYS-CURR-FISCAL-PER-NBR     PIC  9(02)  VALUE ZEROS.  03830094
038400     05  PV-SYS-PREV-FISCAL-YEAR-NBR    PIC  9(02)  VALUE ZEROS.  03840094
038500     05  PV-SYS-PREV-FISCAL-PER-NBR     PIC  9(02)  VALUE ZEROS.  03850094
038600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(04)  VALUE +0      03860094
038700                                                    COMP SYNC.    03870094
038800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      03880094
038900                                                    COMP-3.       03890094
039000     05  PV-TOTAL-QUANTITY              PIC S9(09)  VALUE +0      03900094
039100                                                    COMP.         03910094
039200     05  PV-TOTAL-LINES                 PIC S9(09)  VALUE +0      03920094
039300                                                    COMP.         03930094
039400     05  PV-TOTAL-PAGES-ENTERED         PIC S9(09)  VALUE +0      03940094
039500                                                    COMP.         03950094
039600     05  PV-UPC-CODE                    PIC S9(15)V VALUE +0      03960094
039700                                                    COMP-3.       03970094
039800     05  PV-WORK-SKU                    PIC  9(08)  VALUE ZERO.   03980094
039900     05  PV-MKDN-QUANTITY               PIC  9(09)  VALUE ZERO.   03990094
040000*                                                                 04000094
040100 EJECT                                                            04010094
040800*----------------------------------------------------------------*04080094
040900*    CURRENT DATE AND TIME COPYBOOK.                             *04090094
041000*----------------------------------------------------------------*04100094
041100     COPY DPWS017.                                                04110094
041200*                                                                 04120094
041300 EJECT                                                            04130094
041400*----------------------------------------------------------------*04140094
041500*  DATE VALIDATION CALLING PARAMETER LIST                        *04150094
041600*----------------------------------------------------------------*04160094
041700     COPY DPWS500.                                                04170094
041800*                                                                 04180094
041900 EJECT                                                            04190094
042000*----------------------------------------------------------------*04200094
042100*   PERMANENT PRICE CHANGE CONSTANTS AND WORK AREAS              *04210094
042200*----------------------------------------------------------------*04220094
042300     COPY PEWS049.                                                04230094
042400*                                                                 04240094
042500 EJECT                                                            04250094
042600*----------------------------------------------------------------*04260094
042700*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *04270094
042800*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *04280094
042900*   APPLICATION-SPECIFIC COMMAREA.                               *04290094
043000*----------------------------------------------------------------*04300094
043100 01  LQW-ITEM-SUB                       PIC S9(04)  VALUE +0      04310094
043200                                                    COMP SYNC.    04320094
043300 01  LQW-BLOCK-NUMBER                   PIC S9(04)  VALUE +0      04330094
043400                                                    COMP SYNC.    04340094
043500 01  LQW-HIGHEST-BLOCK-WRITTEN          PIC S9(04)  VALUE +0      04350094
043600                                                    COMP SYNC.    04360094
043700*                                                                 04370094
043800 01  LQW-BLOCK-ENTRIES.                                           04380094
043900     05  LQW-BLOCK-MODIFIED-SW          PIC  X(01)  VALUE SPACE.  04390094
044000         88  LQW-BLOCK-MODIFIED                     VALUE 'Y'.    04400094
044100     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           04410094
044200                                        INDEXED BY LQW-IDX.       04420094
044300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04430094
044400         10  LQW-COMPARE-KEY.                                     04440094
044500             15  LQW-DEPT-NBR           PIC  X(04).               04450094
044600             15  LQW-MAJ-CLASS-NBR      PIC  X(04).               04460094
044700             15  LQW-CLASS-NBR          PIC  X(04).               04470094
044800             15  LQW-SKU-NBR            PIC  X(08).               04480094
044900         10  LQW-ROW-NBR                PIC S9(04)  COMP.         04490094
045000         10  LQW-SKU-CHANGED-SW         PIC  X(01).               04500094
045100             88  LQW-SKU-CHANGED                    VALUE 'Y'.    04510094
045200             88  LQW-SKU-NOT-CHANGED                VALUE ' '.    04520094
045300         10  LQW-UPC                    PIC  X(13).               04530094
045400         10  LQW-UPC-CHANGED-SW         PIC  X(01).               04540094
045500             88  LQW-UPC-CHANGED                    VALUE 'Y'.    04550094
045600             88  LQW-UPC-NOT-CHANGED                VALUE ' '.    04560094
045700         10  LQW-ITEM-NBR               PIC S9(15)  COMP-3.       04570094
045800         10  LQW-PRICE-CHANGED-SW       PIC  X(01).               04580094
045900             88  LQW-PRICE-CHANGED                  VALUE 'Y'.    04590094
046000             88  LQW-PRICE-NOT-CHANGED              VALUE ' '.    04600094
046100         10  LQW-ORIG-PRICE-ERROR-SW    PIC  X(01).               04610094
046200             88  LQW-ORIG-PRICE-ERROR               VALUE 'Y'.    04620094
046300             88  LQW-NO-ORIG-PRICE-ERROR            VALUE ' '.    04630094
046400         10  LQW-ORIGINAL-PRICE-DISP    PIC  X(08).               04640094
046500         10  LQW-ORIGINAL-PRICE         PIC  9(05)V9(2).          04650094
046600         10  LQW-NEW-PRICE-ERROR-SW     PIC  X(01).               04660094
046700             88  LQW-NEW-PRICE-ERROR                VALUE 'Y'.    04670094
046800             88  LQW-NEW-PRICE-ERROR                VALUE ' '.    04680094
046900         10  LQW-NEW-PRICE-DISP         PIC  X(08).               04690094
047000         10  LQW-NEW-PRICE              PIC  9(05)V9(2).          04700094
047100         10  LQW-PRICE-DIFF-ERROR-SW    PIC  X(01).               04710094
047200             88  LQW-PRICE-DIFF-ERROR               VALUE 'Y'.    04720094
047300             88  LQW-NO-PRICE-DIFF-ERROR            VALUE ' '.    04730094
047400         10  LQW-PRICE-DIFF-DISP        PIC  X(08).               04740094
047500         10  LQW-PRICE-DIFF             PIC  9(05)V9(2).          04750094
047600         10  LQW-QUANTITY-CHANGED-SW    PIC  X(01).               04760094
047700             88  LQW-QUANTITY-CHANGED               VALUE 'Y'.    04770094
047800             88  LQW-QUANTITY-NOT-CHANGED           VALUE 'N'.    04780094
047900         10  LQW-QUANTITY               PIC  X(09).               04790094
048000         10  LQW-QUANTITY-N  REDEFINES  LQW-QUANTITY              04800094
048100                                        PIC  9(09).               04810094
048200 SKIP1                                                            04820094
048300*---------------------------------------------------------------* 04830094
048400*  THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING THE    * 04840094
048500*  SELECTED LIST ITEMS TO BE PROCESSED BY                       * 04850094
048600*---------------------------------------------------------------* 04860094
048700     COPY PEWS067.                                                04870094
048800 SKIP1                                                            04880094
048900*---------------------------------------------------------------* 04890094
049000*    MAP REDEFINES                                              * 04900094
049100*---------------------------------------------------------------* 04910094
049200     COPY PEKM196.                                                04920094
049300*                                                                 04930094
049400 01  MR-OCCURS-LAYOUT                   REDEFINES  PE196AO.       04940094
049500     05  FILLER                         PIC X(239).               04950094
049600     05  MR-TOTAL-QUANTITY-AREA.                                  04960094
049700         10  MR-TOTAL-QUANTITYL         PIC S9(04) COMP.          04970094
049800         10  MR-TOTAL-QUANTITYA         PIC  X(01).               04980094
049900         10  MR-TOTAL-QUANTITYC         PIC  X(01).               04990094
050000         10  MR-TOTAL-QUANTITYH         PIC  X(01).               05000094
050100         10  MR-TOTAL-QUANTITY.                                   05010094
050200             15  MR-TOTAL-QUANTITY-N    PIC  ZZZ,ZZ9.             05020094
050300                                                                  05030094
050400     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          05040094
050500         10  MR-FIRST-LINEL             PIC S9(04) COMP.          05050094
050600         10  MR-FIRST-LINEA             PIC  X(01).               05060094
050700         10  MR-FIRST-LINEC             PIC  X(01).               05070094
050800         10  MR-FIRST-LINEH             PIC  X(01).               05080094
050900         10  MR-FIRST-LINE              PIC  X(03).               05090094
051000                                                                  05100094
051100         10  MR-SKUL                    PIC S9(04) COMP.          05110094
051200         10  MR-SKUA                    PIC  X(01).               05120094
051300         10  MR-SKUC                    PIC  X(01).               05130094
051400         10  MR-SKUH                    PIC  X(01).               05140094
051500         10  MR-SKU                     PIC  X(08).               05150094
051600                                                                  05160094
051700         10  MR-UPCL                    PIC S9(04) COMP.          05170094
051800         10  MR-UPCA                    PIC  X(01).               05180094
051900         10  MR-UPCC                    PIC  X(01).               05190094
052000         10  MR-UPCH                    PIC  X(01).               05200094
052100         10  MR-UPC.                                              05210094
052200             15 MR-UPC-N                PIC  9(13).               05220094
052300                                                                  05230094
052400         10  MR-ORIG-PRICEL             PIC S9(04) COMP.          05240094
052500         10  MR-ORIG-PRICEA             PIC  X(01).               05250094
052600         10  MR-ORIG-PRICEC             PIC  X(01).               05260094
052700         10  MR-ORIG-PRICEH             PIC  X(01).               05270094
052800         10  MR-ORIG-PRICE.                                       05280094
052900             15  MR-ORIG-PRICE-N        PIC  ZZZZZ.99.            05290094
053000                                                                  05300094
053100         10  MR-NEW-PRICEL              PIC S9(04) COMP.          05310094
053200         10  MR-NEW-PRICEA              PIC  X(01).               05320094
053300         10  MR-NEW-PRICEC              PIC  X(01).               05330094
053400         10  MR-NEW-PRICEH              PIC  X(01).               05340094
053500         10  MR-NEW-PRICE.                                        05350094
053600             15  MR-NEW-PRICE-N         PIC  ZZZZZ.99.            05360094
053700                                                                  05370094
053800         10  MR-PRICE-DIFFL             PIC S9(04) COMP.          05380094
053900         10  MR-PRICE-DIFFA             PIC  X(01).               05390094
054000         10  MR-PRICE-DIFFC             PIC  X(01).               05400094
054100         10  MR-PRICE-DIFFH             PIC  X(01).               05410094
054200         10  MR-PRICE-DIFF.                                       05420094
054300             15  MR-PRICE-DIFF-N        PIC  ZZZZZ.99.            05430094
054400                                                                  05440094
054500         10  MR-QUANTITYL               PIC S9(04) COMP.          05450094
054600         10  MR-QUANTITYA               PIC  X(01).               05460094
054700         10  MR-QUANTITYC               PIC  X(01).               05470094
054800         10  MR-QUANTITYH               PIC  X(01).               05480094
054900         10  MR-QUANTITY.                                         05490094
055000             15  MR-QUANTITY-N          PIC  ZZZ,ZZ9.             05500094
055100                                                                  05510094
055200         10  MR-LAST-LINEL              PIC S9(04) COMP.          05520094
055300         10  MR-LAST-LINEA              PIC  X(01).               05530094
055400         10  MR-LAST-LINEC              PIC  X(01).               05540094
055500         10  MR-LAST-LINEH              PIC  X(01).               05550094
055600         10  MR-LAST-LINE               PIC  X(03).               05560094
055700*                                                                 05570094
055800 EJECT                                                            05580094
055900*---------------------------------------------------------------* 05590094
056000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05600094
056100*---------------------------------------------------------------* 05610094
056200     COPY DPWS015.                                                05620094
056300*                                                                 05630094
056400 EJECT                                                            05640094
056500*---------------------------------------------------------------* 05650094
056600*    FUNCTION KEYS COPYBOOK.                                    * 05660094
056700*---------------------------------------------------------------* 05670094
056800     COPY DPWS016.                                                05680094
056900 SKIP1                                                            05690094
057000*---------------------------------------------------------------* 05700094
057100*    NUMERIC EDIT LAYOUT.                                       * 05710094
057200*---------------------------------------------------------------* 05720094
057300     COPY DPWS010I.                                               05730094
057400 SKIP1                                                            05740094
057500*---------------------------------------------------------------* 05750094
CICS  * PARAMETERS FOR CALLING CICS ARCHITECTURE API.                 * 05760098
057700*---------------------------------------------------------------* 05770094
057800     COPY DPWS030.                                                05780094
CICS       COPY DPWS930.                                                05781098
057900 SKIP1                                                            05790094
058000*---------------------------------------------------------------* 05800094
058100*    STANDARD COMMAREA.                                         * 05810094
058200*---------------------------------------------------------------* 05820094
058300     COPY DPWS020.                                                05830094
058400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05840094
058500 SKIP1                                                            05850094
058600*---------------------------------------------------------------* 05860094
058700* INTER-APPLICATION COMMAREA.                                   * 05870094
058800*   PEWS064 - IS THE INPUT LAYOUT THAT IS PASSED FROM           * 05880094
058900*             PEKCS190 - CRITERIA SPEC                          * 05890094
059000*                                                               * 05900094
059100*   PEWS066 - IS THE INPUT LAYOUT THAT IS PASSED FROM           * 05910094
059200*             PEKCS195 - ENTRY LIST                             * 05920094
059300*---------------------------------------------------------------* 05930094
059400         10  INTER-APPL-COMMAREA        PIC X(200).               05940094
059500     COPY PEWS064.                                                05950094
059600     COPY PEWS066.                                                05960094
059700 SKIP1                                                            05970094
059800*---------------------------------------------------------------* 05980094
059900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05990094
060000*---------------------------------------------------------------* 06000094
060100         10  ASC-SPECIFIC-COMMAREA.                               06010094
060200             15  ASC-LIST-KEYS.                                   06020094
060300                 20  ASC-KEY-STORE-NBR               PIC  X(04).  06030094
060400                 20  ASC-KEY-STORE-NBR-N REDEFINES                06040094
060500                     ASC-KEY-STORE-NBR               PIC  9(04).  06050094
060600                 20  ASC-KEY-DOC-NBR.                             06060094
060700                     25  ASC-KEY-DOC-NBR-N           PIC  9(07).  06070094
060800             15  ASC-STORE-NAME                      PIC  X(25).  06080094
060900             15  ASC-ISSUED-DATE                     PIC  X(08).  06090094
061000             15  ASC-REASON-CODE                     PIC  X(03).  06100094
061100             15  FILLER  REDEFINES  ASC-REASON-CODE.              06110094
061200                 20  ASC-REASON-CODE-N               PIC  9(03).  06120094
061300             15  ASC-ORIGINAL-REASON-CODE.                        06130094
061400                 20  ASC-ORIG-TYPE-CDE               PIC  X(01).  06140094
061500                 20  ASC-ORIG-REASON-CDE             PIC  X(02).  06150094
061600             15  ASC-TYPE-DESC                       PIC  X(10).  06160094
061700             15  ASC-REASON-DESC                     PIC  X(12).  06170094
061800             15  ASC-STATUS-CODE                     PIC  X(02).  06180094
061900             15  ASC-STATUS-DESC                     PIC  X(12).  06190094
062000             15  ASC-EFFECTIVE-NAME                  PIC  X(30).  06200094
062100             15  ASC-EFFECTIVE-DATE-ISO              PIC  X(10).  06210094
062200             15  ASC-EFFECTIVE-DATE.                              06220094
062300                 20  ASC-EFFECTIVE-MM                PIC  X(02).  06230094
062400                 20  ASC-EFFECTIVE-DD                PIC  X(02).  06240094
062500                 20  ASC-EFFECTIVE-YY                PIC  X(02).  06250094
062600             15  ASC-EFFECTIVE-DATE-N  REDEFINES                  06260094
062700                                       ASC-EFFECTIVE-DATE.        06270094
062800                 20  ASC-EFFECTIVE-MM-N              PIC  9(02).  06280094
062900                 20  ASC-EFFECTIVE-DD-N              PIC  9(02).  06290094
063000                 20  ASC-EFFECTIVE-YY-N              PIC  9(02).  06300094
063100             15  ASC-EFF-DATE-ENTERED-SW             PIC  X(01).  06310094
063200                 88  ASC-EFF-DATE-ENTERED            VALUE 'Y'.   06320094
063300                 88  ASC-EFF-DATE-NOT-ENTERED        VALUE 'N'.   06330094
063400             15  ASC-DEPT-AREA                       PIC  X(40).  06340094
063500             15  ASC-TOTAL-QUANTITY                  PIC  X(09).  06350094
063600             15  ASC-TOTAL-QUANTITY-N  REDEFINES                  06360094
063700                         ASC-TOTAL-QUANTITY          PIC  9(09).  06370094
063800             15  ASC-PAGES-TO-PRINT                  PIC S9(04)   06380094
063900                                                     COMP.        06390094
064000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06400094
064100                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06410094
064200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06420094
064300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06430094
064400                                                                  06440094
064500                 20  ASC-ITEM-ARRAY.                              06450094
064600                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        06460094
064700                         30  ASC-LIST-ITEM-NUMBER                 06470094
064800                                                     PIC S9(09)   06480094
064900                                                     COMP-3.      06490094
065000                         30  ASC-COMPARE-KEY.                     06500094
065100                             35  ASC-DEPT-NBR        PIC  X(04).  06510094
065200                             35  ASC-MAJ-CLASS-NBR   PIC  X(04).  06520094
065300                             35  ASC-CLASS-NBR       PIC  X(04).  06530094
065400                             35  ASC-SKU-NBR         PIC  X(08).  06540094
065500                         30  ASC-ROW-NBR             PIC S9(04)   06550094
065600                                                     COMP.        06560094
065700                         30  ASC-SKU-CHANGED-SW      PIC  X(01).  06570094
065800                             88  ASC-SKU-CHANGED     VALUE 'Y'.   06580094
065900                             88  ASC-SKU-NOT-CHANGED VALUE ' '.   06590094
066000                         30  ASC-UPC                 PIC  X(13).  06600094
066100                         30  ASC-UPC-N  REDEFINES  ASC-UPC        06610094
066200                                                     PIC  9(13).  06620094
066300                         30  ASC-UPC-CHANGED-SW      PIC  X(01).  06630094
066400                             88  ASC-UPC-CHANGED     VALUE 'Y'.   06640094
066500                             88  ASC-UPC-NOT-CHANGED VALUE ' '.   06650094
066600                         30  ASC-ITEM-NBR            PIC S9(15)   06660094
066700                                                     COMP-3.      06670094
066800                         30  ASC-PRICE-CHANGED-SW    PIC  X(01).  06680094
066900                             88  ASC-PRICE-CHANGED   VALUE 'Y'.   06690094
067000                             88  ASC-PRICE-NOT-CHANGED            06700094
067100                                                     VALUE ' '.   06710094
067200                         30  ASC-ORIGINAL-PRICE-ERROR-SW          06720094
067300                                                     PIC  X(01).  06730094
067400                             88  ASC-ORIGINAL-PRICE-ERROR         06740094
067500                                                     VALUE 'Y'.   06750094
067600                             88  ASC-NO-ORIGINAL-PRICE-ERROR      06760094
067700                                                     VALUE ' '.   06770094
067800                         30  ASC-ORIGINAL-PRICE-VARIABLES.        06780094
067900                             35  ASC-ORIGINAL-PRICE-DISP          06790094
068000                                                     PIC X(08).   06800094
068100                             35  ASC-ORIGINAL-PRICE-Z  REDEFINES  06810094
068200                                 ASC-ORIGINAL-PRICE-DISP          06820094
068300                                                     PIC          06830094
068400                                                    Z,ZZZ.99.     06840094
068500                             35  ASC-ORIGINAL-PRICE  PIC          06850094
068600                                                     9(5)V9(2).   06860094
068700                         30  ASC-NEW-PRICE-ERROR-SW               06870094
068800                                                     PIC  X(01).  06880094
068900                             88  ASC-NEW-PRICE-ERROR              06890094
069000                                                     VALUE 'Y'.   06900094
069100                             88  ASC-NO-NEW-PRICE-ERROR           06910094
069200                                                     VALUE ' '.   06920094
069300                         30  ASC-NEW-PRICE-VARIABLES.             06930094
069400                             35  ASC-NEW-PRICE-DISP  PIC X(08).   06940094
069500                             35  ASC-NEW-PRICE-Z  REDEFINES       06950094
069600                                 ASC-NEW-PRICE-DISP  PIC          06960094
069700                                                    Z,ZZZ.99.     06970094
069800                             35  ASC-NEW-PRICE       PIC          06980094
069900                                                    9(5)V9(2).    06990094
070000                         30  ASC-PRICE-DIFF-ERROR-SW              07000094
070100                                                     PIC  X(01).  07010094
070200                             88  ASC-PRICE-DIFF-ERROR             07020094
070300                                                     VALUE 'Y'.   07030094
070400                             88  ASC-NO-PRICE-DIFF-ERROR          07040094
070500                                                     VALUE ' '.   07050094
070600                         30  ASC-PRICE-DIFF-VARIABLES.            07060094
070700                             35  ASC-PRICE-DIFF-DISP PIC X(08).   07070094
070800                             35  ASC-PRICE-DIFF-Z  REDEFINES      07080094
070900                                 ASC-PRICE-DIFF-DISP PIC          07090094
071000                                                    Z,ZZZ.99.     07100094
071100                             35  ASC-PRICE-DIFF      PIC          07110094
071200                                                     9(5)V9(2).   07120094
071300                         30  ASC-QUANTITY-CHANGED-SW PIC  X(01).  07130094
071400                             88  ASC-QUANTITY-CHANGED             07140094
071500                                                     VALUE 'Y'.   07150094
071600                             88  ASC-QUANTITY-NOT-CHANGED         07160094
071700                                                     VALUE ' '.   07170094
071800                         30  ASC-QUANTITY            PIC X(09).   07180094
071900                         30  ASC-QUANTITY-N  REDEFINES            07190094
072000                                            ASC-QUANTITY          07200094
072100                                                     PIC          07210094
072200                                                     9(09).       07220094
072300                                                                  07230094
072400             15 ASC-LAST-LIST-ITEM-NUMBER            PIC S9(09)   07240094
072500                                                     COMP-3.      07250094
072600             15  ASC-BLK-SUB                         PIC S9(04)   07260094
072700                                                          COMP    07270094
072800                                                          SYNC.   07280094
072900             15  ASC-ITEM-SUB                        PIC S9(04)   07290094
073000                                                          COMP    07300094
073100                                                          SYNC.   07310094
073200             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(09)   07320094
073300                                                          COMP-3. 07330094
073400             15  ASC-SEL-SUB                         PIC S9(04)   07340094
073500                                                          COMP    07350094
073600                                                          SYNC.   07360094
073700             15  ASC-SEL-ITEM                        PIC S9(04)   07370094
073800                                                          COMP    07380094
073900                                                          SYNC.   07390094
074000             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   07400094
074100                                                          COMP-3. 07410094
074200             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   07420094
074300                                                          COMP-3. 07430094
074400             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   07440094
074500                                                          COMP-3. 07450094
074600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   07460094
074700                                                          COMP-3. 07470094
074800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   07480094
074900                                                          COMP-3. 07490094
075000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   07500094
075100                                                          COMP    07510094
075200                                                          SYNC.   07520094
075300             15  ASC-ORIG-HIGHEST-BLOCK-WRITTEN      PIC S9(04)   07530094
075400                                                          COMP    07540094
075500                                                          SYNC.   07550094
075600             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07560094
075700                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07570094
075800                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07580094
075900             15  ASC-LIST-QUEUE-NAME.                             07590094
076000                 20  ASC-LIST-TERM-ID                PIC  X(04).  07600094
076100                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07610094
076200                                                          COMP-3. 07620094
076300                 20  ASC-LIST-SEQ                    PIC  9(01).  07630094
076400             15  ASC-SEL-QUEUE-NAME.                              07640094
076500                 20  ASC-SEL-TERM-ID                 PIC  X(04).  07650094
076600                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   07660094
076700                                                          COMP-3. 07670094
076800                 20  ASC-SEL-SEQ                     PIC  9(01).  07680094
076900             15  ASC-ORIG-QUEUE-NAME.                             07690094
077000                 20  ASC-ORIG-TERM-ID                PIC  X(04).  07700094
077100                 20  ASC-ORIG-TASK-NUMBER            PIC S9(05)   07710094
077200                                                          COMP-3. 07720094
077300                 20  ASC-ORIG-SEQ                    PIC  9(01).  07730094
077400             15  ASC-HOLD-QUEUE-NAME.                             07740094
077500                 20  ASC-HOLD-TERM-ID                PIC  X(04).  07750094
077600                 20  ASC-HOLD-TASK-NUMBER            PIC S9(05)   07760094
077700                                                          COMP-3. 07770094
077800                 20  ASC-HOLD-SEQ                    PIC  9(01).  07780094
077900                                                                  07790094
078000             15  ASC-NO-ITEMS-IN-TEMP-ST-SW          PIC  X.      07800094
078100                 88  ASC-ITEMS-IN-TEMP-ST            VALUE ' '.   07810094
078200                 88  ASC-NO-ITEMS-IN-TEMP-ST         VALUE 'N'.   07820094
078300             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  07830094
078400                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   07840094
078500             15  ASC-DATA-UPDATED-IND                PIC  X(01).  07850094
078600                 88  ASC-DATA-UPDATED                VALUE 'Y'.   07860094
078700                 88  ASC-DATA-NOT-UPDATED            VALUE ' '.   07870094
078800             15  ASC-PF20-PRESSED-IND                PIC  X(01).  07880094
078900                 88  ASC-PF20-PRESSED                VALUE 'Y'.   07890094
079000                 88  ASC-PF20-NOT-PRESSED            VALUE ' '.   07900094
079100             15  ASC-PF19-PRESSED-IND                PIC  X(01).  07910094
079200                 88  ASC-PF19-PRESSED                VALUE 'Y'.   07920094
079300                 88  ASC-PF19-NOT-PRESSED            VALUE ' '.   07930094
079400             15  ASC-LOCAL-FUNC-01-PRESSED-IND       PIC  X(01).  07940094
079500                 88  ASC-LOCAL-FUNC-01-PRESSED       VALUE 'Y'.   07950094
079600                 88  ASC-LOCAL-FUNC-01-NOT-PRESSED   VALUE ' '.   07960094
079700         10  FILLER                                  PIC          07970094
079800                                                     X(415).      07980094
079900*                                                                 07990094
080000 EJECT                                                            08000094
080100*---------------------------------------------------------------* 08010094
080200*    ABEND PROCESSING COPYBOOK.                                 * 08020094
080300*---------------------------------------------------------------* 08030094
080400     COPY DPWS013.                                                08040094
080500*                                                                 08050094
080600 EJECT                                                            08060094
080700*---------------------------------------------------------------* 08070094
080800*    DB2 AREA FOR MBS APPLICATION AVAILABILITY TABLE            * 08080094
080900*---------------------------------------------------------------* 08090094
081000     EXEC SQL                                                     08100094
081100          INCLUDE TAPLAVL                                         08110094
081200     END-EXEC.                                                    08120094
081300*---------------------------------------------------------------* 08130094
081400*    DB2 AREA FOR MBS MERCHANDISE AREA TABLE                    * 08140094
081500*---------------------------------------------------------------* 08150094
081600     EXEC SQL                                                     08160094
081700          INCLUDE TMDSEAR                                         08170094
081800     END-EXEC.                                                    08180094
081900*---------------------------------------------------------------* 08190094
082000*    DB2 AREA FOR UPC TABLE                                     * 08200094
082100*---------------------------------------------------------------* 08210094
082200     EXEC SQL                                                     08220094
082300          INCLUDE TUPC                                            08230094
082400     END-EXEC.                                                    08240094
082500*---------------------------------------------------------------* 08250094
082600*    DB2 AREA FOR UPC PHYSICAL LOCATION STATUS                  * 08260094
082700*---------------------------------------------------------------* 08270094
082800     EXEC SQL                                                     08280094
082900          INCLUDE TUPCPLS                                         08290094
083000     END-EXEC.                                                    08300094
083100*---------------------------------------------------------------* 08310094
083200*    DB2 AREA FOR SKU TABLE                                     * 08320094
083300*---------------------------------------------------------------* 08330094
083400     EXEC SQL                                                     08340094
083500          INCLUDE TSK                                             08350094
083600     END-EXEC.                                                    08360094
083700*---------------------------------------------------------------* 08370094
083800*    DB2 AREA FOR IN-STORE HEADER TABLE                         * 08380094
083900*---------------------------------------------------------------* 08390094
084000     EXEC SQL                                                     08400094
084100          INCLUDE TSTRPPC                                         08410094
084200     END-EXEC.                                                    08420094
084300*---------------------------------------------------------------* 08430094
084400*    DB2 AREA FOR IN-STORE DETAIL TABLE                         * 08440094
084500*---------------------------------------------------------------* 08450094
084600     EXEC SQL                                                     08460094
084700          INCLUDE TSPPCDT                                         08470094
084800     END-EXEC.                                                    08480094
084900*---------------------------------------------------------------* 08490094
085000*    SELLING AND CUSTOMER SERVICE LOCATION TABLE                * 08500094
085100*---------------------------------------------------------------* 08510094
085200     EXEC SQL                                                     08520094
085300          INCLUDE XST00001                                        08530094
085400     END-EXEC.                                                    08540094
085500***************************************************************** 08550094
085600*                                                   WR# 24472   * 08560094
085700*    DB2 AREA FOR SKU CROSS-REFERENCE INFO                      * 08570094
085800*---------------------------------------------------------------* 08580094
085900     EXEC SQL                                                     08590094
086000          INCLUDE TSKXREF                                         08600094
086100     END-EXEC.                                                    08610094
086200*---------------------------------------------------------------* 08620094
086300*    DB2 AREA FOR COMMUNICATIONS                                * 08630094
086400*---------------------------------------------------------------* 08640094
086500     EXEC SQL                                                     08650094
086600          INCLUDE SQLCA                                           08660094
086700     END-EXEC.                                                    08670094
086800*---------------------------------------------------------------* 08680094
086900*    IN-STORE DETAIL LIST CURSOR                                * 08690094
087000*---------------------------------------------------------------* 08700094
087100     EXEC SQL                                                     08710094
087200          DECLARE DETAIL-CSR CURSOR                               08720094
087300          FOR SELECT                                              08730094
087400              SKU_NBR                                             08740094
087500            , ROW_NBR                                             08750094
087600            , ACTL_PR_CHG_QTY                                     08760094
087700            , OLD_PR                                              08770094
087800            , NEW_PR                                              08780094
087900            , ACTL_PR_CHG_AMT                                     08790094
088000            , UPC_NBR                                             08800094
088100            , ITEM_NBR                                            08810094
088200          FROM TSPPCDT                                            08820094
088300          WHERE (DEST_LOC_NBR = :SPPCDT-DEST-LOC-NBR              08830094
088400            AND  DOC_NBR      = :SPPCDT-DOC-NBR)                  08840094
088500          ORDER BY                                                08850094
088600                ROW_NBR                                           08860094
088700     END-EXEC.                                                    08870094
088800                                                                  08880094
088900*                                                                 08890094
089000 EJECT                                                            08900094
089100*                                                                 08910094
089200 EJECT                                                            08920094
089300 LINKAGE SECTION.                                                 08930094
089400                                                                  08940094
089500 01  DFHCOMMAREA.                                                 08950094
089600     05  FILLER                         OCCURS  1 TO 4072 TIMES   08960094
089700                                        DEPENDING ON EIBCALEN.    08970094
089800         10  FILLER                     PIC X.                    08980094
089900                                                                  08990094
090000 EJECT                                                            09000094
090100 PROCEDURE DIVISION.                                              09010094
090200******************************************************************09020094
090300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09030094
090400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09040094
090500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09050094
090600******************************************************************09060094
090700 0000-MAIN-MODULE.                                                09070094
090800     INITIALIZE DP030-CICS-API-FIELDS.                            09080094
090900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09090094
091000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09100094
091100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09110094
091200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09120094
091300     MOVE LENGTH OF PE196AI        TO DP030-MAP-LENGTH (1).       09130094
091400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09140094
091500     PERFORM 0001-CALL-CICS-ARCH-API.                             09150094
091600*                                                                 09160094
091700     PERFORM 1000-CONTROL-PROCESSING                              09170094
091800*                                                                 09180094
091900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09190094
092000     PERFORM 0001-CALL-CICS-ARCH-API.                             09200094
092100                                                                  09210094
092200******************************************************************09220094
092300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09230094
092400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **09240094
092500******************************************************************09250094
092600 0001-CALL-CICS-ARCH-API.                                         09260094
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09270098
092800                                    DFHCOMMAREA                   09280098
092900                                    DP030-CICS-API-FIELDS         09290098
093000                                    DP020-STANDARD-COMMAREA       09300098
093100                                    PE196AI.                      09310098
093200*                                                                 09320094
093300     IF  DP030-RC-CALL-SUCCESSFUL                                 09330094
093400         CONTINUE                                                 09340094
093500     ELSE                                                         09350094
093600         SET DP013-NO-ROLLBACK                                    09360094
093700             DP013-XCTL-DISPLAY-RESTART                           09370094
093800             DP013-CICS-ABEND      TO TRUE                        09380094
093900         MOVE 'BEFORE 0000-MAIN-MODULE'                           09390094
094000                                   TO DP013-PARAGRAPH             09400094
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O09410098
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09420098
094300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09430094
094400         PERFORM DP013-0000-PROCESS-ABEND                         09440094
094500     END-IF.                                                      09450094
094600*----------------------------------------------------------------*09460094
094700* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09470094
094800* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09480094
094900*                                                                *09490094
095000* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09500094
095100*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09510094
095200*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09520094
095300*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09530094
095400*----------------------------------------------------------------*09540094
095500                                                                  09550094
095600 1000-CONTROL-PROCESSING.                                         09560094
095700                                                                  09570094
095800     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       09580094
095900     SET DP017-EDITED-YMD-DATE-DASH-1                             09590094
096000         DP017-EDITED-YMD-DATE-DASH-2                             09600094
096100                                  TO TRUE.                        09610094
096200     MOVE DP017-EDITED-DATE-YYYYMMDD                              09620094
096300                                 TO DK-CURRENT-DATE-ISO.          09630094
096400     MOVE DP017-EDITED-TIME-HMS  TO DK-EDITED-TIME-HMS.           09640094
096500     MOVE DP020-OPERATING-COMPANY                                 09650094
096600                                 TO DK-OPERATING-COMPANY.         09660094
096700     MOVE DP020-USERID           TO DK-USER-ID.                   09670094
096800     EVALUATE TRUE                                                09680094
096900         WHEN DP020-NEXT-ACT-INITIAL                              09690094
097000             INITIALIZE ASC-SPECIFIC-COMMAREA                     09700094
097100             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09710094
097200                                      ASC-ORIG-TERM-ID            09720094
097300                                      ASC-HOLD-TERM-ID            09730094
097400             MOVE DP020-SRC-TASK-NUMBER                           09740094
097500                                   TO ASC-LIST-TASK-NUMBER        09750094
097600                                      ASC-ORIG-TASK-NUMBER        09760094
097700                                      ASC-HOLD-TASK-NUMBER        09770094
097800             MOVE PC-LIST-QUEUE-SEQ                               09780094
097900                                   TO ASC-LIST-SEQ                09790094
098000             MOVE PC-HOLD-QUEUE-SEQ                               09800094
098100                                   TO ASC-HOLD-SEQ                09810094
098200             MOVE PC-ORIG-QUEUE-SEQ                               09820094
098300                                   TO ASC-ORIG-SEQ                09830094
098400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09840094
098500             IF  PS-NO-ERROR                                      09850094
098600                 PERFORM 4000-BUILD-INITIAL-PANEL                 09860094
098700             END-IF                                               09870094
098800                                                                  09880094
098900         WHEN DP020-NEXT-ACT-READ-MAP                             09890094
099000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09900094
099100                                   TO PV-TOP-ITEM                 09910094
099200             PERFORM 2000-PROCESS-PANEL                           09920094
099300                                                                  09930094
099400         WHEN DP020-NEXT-ACT-RETURN                               09940094
099500             MOVE ASC-KEY-STORE-NBR-N                             09950094
099600                                   TO DK-STORE-NBR                09960094
099700             MOVE ASC-KEY-DOC-NBR-N                               09970094
099800                                   TO DK-DOC-NBR                  09980094
099900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09990094
100000                                   TO PV-TOP-ITEM                 10000094
100100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10010094
100200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10020094
100300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10030094
100400                                                                  10040094
100500         WHEN OTHER                                               10050094
100600             SET DP013-LOGIC-ABEND TO TRUE                        10060094
100700             SET DP013-NO-ROLLBACK TO TRUE                        10070094
100800             MOVE '1000-CONTROL-PROCESSING'                       10080094
100900                                   TO DP013-PARAGRAPH             10090094
101000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10100094
101100                                   TO DP013-MESSAGE-TEXT(1)       10110094
101200             PERFORM DP013-0000-PROCESS-ABEND                     10120094
101300     END-EVALUATE.                                                10130094
101400                                                                  10140094
101500 EJECT                                                            10150094
101600*----------------------------------------------------------------*10160094
101700* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10170094
101800* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10180094
101900*----------------------------------------------------------------*10190094
102000                                                                  10200094
102100 1100-PROCESS-INTER-APPL-COMM.                                    10210094
102200                                                                  10220094
102300     SET PS-COMMAREA-VALID         TO TRUE.                       10230094
102400     EVALUATE DP020-INT-APPL-FORMAT-IND                           10240094
102500         WHEN PC-INTER-APPL-CRIT-SPEC                             10250094
102600             IF PE064-STORE-NUMBER = SPACES                       10260094
102700*     --- STORE NUMBER REQUIRED FOR REQUESTED FUNCTION ---        10270094
102800                 MOVE PC-TSYMSG-00507                             10280094
102900                                 TO DP020-MSG-NUMBER              10290094
103000                 SET DP020-MSG-FATAL                              10300094
103100                     DP020-NEXT-ACT-APPL-ERROR                    10310094
103200                     PS-ERROR    TO TRUE                          10320094
103300             ELSE                                                 10330094
103400                 MOVE PE064-STORE-NUMBER                          10340094
103500                                 TO ASC-KEY-STORE-NBR             10350094
103600                                    DK-STORE-NBR                  10360094
103700                 MOVE PE064-STORE-NAME                            10370094
103800                                 TO ASC-STORE-NAME                10380094
103900                 IF PE064-DOCUMENT-NUMBER = SPACES                10390094
104000*----PC-TSYMSG-00026 - DOCUMENT NUMBER IS REQUIRED FOR THE        10400094
104100*----                  REQUESTED FUNCTION                         10410094
104200                     MOVE PC-TSYMSG-00026                         10420094
104300                                 TO DP020-MSG-NUMBER              10430094
104400                     SET DP020-MSG-FATAL                          10440094
104500                         DP020-NEXT-ACT-APPL-ERROR                10450094
104600                         PS-ERROR TO TRUE                         10460094
104700                 ELSE                                             10470094
104800                     MOVE PE064-DOCUMENT-NUMBER                   10480094
104900                                 TO ASC-KEY-DOC-NBR               10490094
105000                     MOVE ASC-KEY-DOC-NBR-N                       10500094
105100                                 TO DK-DOC-NBR                    10510094
105200                     PERFORM 8050-VALIDATE-STORE-DOC              10520094
105300                     IF SQLCODE = 0                               10530094
105400                         MOVE STRPPC-RSN-CDE                      10540094
105500                                 TO PE049-WORKING-INSTR-RSN-CDE   10550094
105600                         IF ((STRPPC-STATUS-CDE =                 10560094
105700                              PE049-IS-AVAILABLE-STATUS-CDE OR    10570094
105800                              PE049-IS-CNTS-ENTER-STATUS-CDE OR   10580094
105900                              PE049-IS-GENERATED-STATUS-CDE OR    10590094
106000                              PE049-IS-DELINQUENT-STATUS-CDE) AND 10600094
106100                              NOT PE049-IS-RTN-TO-VNDR-RSN    AND 10610094
106200                           NOT PE049-IS-INVENTORY-MISSED-RSN  AND 10620094
106300                              NOT PE049-IS-RF-ZERO-OUT-RSN)       10630094
106400                             CONTINUE                             10640094
106500                         ELSE                                     10650094
106600                             SET PS-ERROR                         10660094
106700                                 DP020-MSG-FATAL                  10670094
106800                                 DP020-NEXT-ACT-APPL-ERROR        10680094
106900                                   TO TRUE                        10690094
107000*          --- DOCUMENT IN INVALID STATUS FOR THIS FUNCTION ---   10700094
107100                             MOVE PC-TSYMSG-00027                 10710094
107200                                   TO DP020-MSG-NUMBER            10720094
107300                         END-IF                                   10730094
107400                     ELSE                                         10740094
107500                         SET PS-ERROR                             10750094
107600                             DP020-MSG-FATAL                      10760094
107700                             DP020-NEXT-ACT-APPL-ERROR            10770094
107800                                   TO TRUE                        10780094
107900*          --- DOCUMENT WAS NOT ISSUED TO THAT LOCATION     ---   10790094
108000                             MOVE PC-TSYMSG-00283                 10800094
108100                                   TO DP020-MSG-NUMBER            10810094
108200                                                                  10820094
108300                     END-IF                                       10830094
108400                 END-IF                                           10840094
108500             END-IF                                               10850094
108600                                                                  10860094
108700         WHEN PC-INTER-APPL-LIST                                  10870094
108800             SET ASC-USE-SELECTION-QUEUE                          10880094
108900                                 TO TRUE                          10890094
109000             MOVE PE066-NUMBER-OF-SELECTED-ITEMS                  10900094
109100                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  10910094
109200             MOVE PE066-SEL-QUEUE-NAME                            10920094
109300                                 TO ASC-SEL-QUEUE-NAME            10930094
109400             MOVE PE066-NUMBER-OF-TS-ITEMS                        10940094
109500                                 TO ASC-NUMBER-OF-TS-ITEMS        10950094
109600             MOVE PE067-MAX-ITEMS                                 10960094
109700                                 TO ASC-SEL-SUB                   10970094
109800             MOVE +0             TO ASC-SEL-ITEM                  10980094
109900             PERFORM 8000-GET-NEXT-DOCUMENT                       10990094
110000     END-EVALUATE.                                                11000094
110100*                                                                 11010094
110200 EJECT                                                            11020094
110300*----------------------------------------------------------------*11030094
110400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11040094
110500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11050094
110600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11060094
110700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11070094
110800* FUNCTION KEYS CAN GET THIS FAR.                                *11080094
110900*----------------------------------------------------------------*11090094
111000                                                                  11100094
111100 2000-PROCESS-PANEL.                                              11110094
111200     MOVE ASC-KEY-STORE-NBR-N      TO DK-STORE-NBR.               11120094
111300     MOVE ASC-KEY-DOC-NBR-N        TO DK-DOC-NBR.                 11130094
111400     EVALUATE TRUE                                                11140094
111500         WHEN DP020-SRC-AID = DP016-CLEAR                         11150094
111600             SET ASC-PF19-NOT-PRESSED                             11160094
111700                 ASC-PF20-NOT-PRESSED                             11170094
111800                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            11180094
111900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11190094
112000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11200094
112100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11210094
112200                                                                  11220094
112300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11230094
112400             SET ASC-PF19-NOT-PRESSED                             11240094
112500                 ASC-PF20-NOT-PRESSED                             11250094
112600                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            11260094
112700             PERFORM 7000-DELETE-LIST-QUEUE                       11270094
112800             PERFORM 7025-DELETE-ORIG-QUEUE                       11280094
112900             MOVE ASC-KEY-STORE-NBR-N                             11290094
113000                                   TO DK-STORE-NBR                11300094
113100             MOVE ASC-KEY-DOC-NBR-N                               11310094
113200                                   TO DK-DOC-NBR                  11320094
113300             IF  PS-NO-ERROR                                      11330094
113400                 PERFORM 4000-BUILD-INITIAL-PANEL                 11340094
113500             END-IF                                               11350094
113600                                                                  11360094
113700         WHEN DP020-FK-PREV-SELECTION(DP020-SRC-AID)              11370094
113800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11380094
113900             SET ASC-PF20-NOT-PRESSED                             11390094
114000                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            11400094
114100             IF ASC-USE-SELECTION-QUEUE                           11410094
114200                 IF (ASC-DATA-NOT-UPDATED                         11420094
114300                  OR ASC-PF19-PRESSED)                            11430094
114400                     SET ASC-PF19-NOT-PRESSED                     11440094
114500                         ASC-DATA-NOT-UPDATED TO TRUE             11450094
114600                     PERFORM 8005-GET-PREV-DOCUMENT               11460094
114700                     PERFORM 3200-RESET-ATTRIBUTES                11470094
114800                     IF PS-LIST-END                               11480094
114900*     --- TOP OF LIST ---                                         11490094
115000                         MOVE PC-TSYMSG-00069                     11500094
115100                                   TO DP020-MSG-NUMBER            11510094
115200                         SET DP020-MSG-INFORMATIONAL              11520094
115300                                   TO TRUE                        11530094
115400                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11540094
115500                         SET PS-NO-LIST-END                       11550094
115600                                   TO TRUE                        11560094
115700                     ELSE                                         11570094
115800                         PERFORM 7000-DELETE-LIST-QUEUE           11580094
115900                         PERFORM 7025-DELETE-ORIG-QUEUE           11590094
116000                         PERFORM 4000-BUILD-INITIAL-PANEL         11600094
116100                     END-IF                                       11610094
116200                 ELSE                                             11620094
116300*     --- DATA UPDATED PRESS KEY AGAIN TO ABORT UPDATE ---        11630094
116400                     SET ASC-PF19-PRESSED TO TRUE                 11640094
116500                     MOVE PC-TSYMSG-00284                         11650094
116600                                   TO DP020-MSG-NUMBER            11660094
116700                     SET DP020-MSG-WARNING                        11670094
116800                                   TO TRUE                        11680094
116900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11690094
117000                 END-IF                                           11700094
117100             ELSE                                                 11710094
117200*     --- TOP OF LIST ---                                         11720094
117300                 MOVE PC-TSYMSG-00069                             11730094
117400                                   TO DP020-MSG-NUMBER            11740094
117500                 SET DP020-MSG-INFORMATIONAL                      11750094
117600                                   TO TRUE                        11760094
117700             END-IF                                               11770094
117800                                                                  11780094
117900                                                                  11790094
118000         WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              11800094
118100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11810094
118200             SET ASC-PF19-NOT-PRESSED                             11820094
118300                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            11830094
118400             IF ASC-USE-SELECTION-QUEUE                           11840094
118500                 IF (ASC-DATA-NOT-UPDATED                         11850094
118600                  OR ASC-PF20-PRESSED)                            11860094
118700                     SET ASC-PF20-NOT-PRESSED                     11870094
118800                         ASC-DATA-NOT-UPDATED TO TRUE             11880094
118900                     PERFORM 8000-GET-NEXT-DOCUMENT               11890094
119000                     PERFORM 3200-RESET-ATTRIBUTES                11900094
119100                     IF PS-NO-ERROR                               11910094
119200                         IF PS-LIST-END                           11920094
119300*     --- BOTTOM OF LIST ---                                      11930094
119400                             MOVE PC-TSYMSG-00070                 11940094
119500                                   TO DP020-MSG-NUMBER            11950094
119600                             SET DP020-MSG-INFORMATIONAL          11960094
119700                                   TO TRUE                        11970094
119800                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 11980094
119900                             SET PS-NO-LIST-END                   11990094
120000                                   TO TRUE                        12000094
120100                         ELSE                                     12010094
120200                             PERFORM 7000-DELETE-LIST-QUEUE       12020094
120300                             PERFORM 7025-DELETE-ORIG-QUEUE       12030094
120400                             PERFORM 4000-BUILD-INITIAL-PANEL     12040094
120500                         END-IF                                   12050094
120600                     END-IF                                       12060094
120700                 ELSE                                             12070094
120800*     --- DATA UPDATED PRESS KEY AGAIN TO ABORT UPDATE ---        12080094
120900                     SET ASC-PF20-PRESSED TO TRUE                 12090094
121000                     MOVE PC-TSYMSG-00284                         12100094
121100                                   TO DP020-MSG-NUMBER            12110094
121200                     SET DP020-MSG-WARNING                        12120094
121300                                   TO TRUE                        12130094
121400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12140094
121500                 END-IF                                           12150094
121600             ELSE                                                 12160094
121700*     --- BOTTOM OF LIST ---                                      12170094
121800                 MOVE PC-TSYMSG-00070                             12180094
121900                                   TO DP020-MSG-NUMBER            12190094
122000                 SET DP020-MSG-INFORMATIONAL                      12200094
122100                                   TO TRUE                        12210094
122200             END-IF                                               12220094
122300                                                                  12230094
122400         WHEN OTHER                                               12240094
122500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12250094
122600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12260094
122700             PERFORM 2100-CHECK-FUNCTION-KEY                      12270094
122800     END-EVALUATE.                                                12280094
122900*                                                                 12290094
123000 EJECT                                                            12300094
123100*----------------------------------------------------------------*12310094
123200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12320094
123300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12330094
123400* CICS ARCHITECTURE API.                                         *12340094
123500*----------------------------------------------------------------*12350094
123600 2100-CHECK-FUNCTION-KEY.                                         12360094
123700     EVALUATE TRUE                                                12370094
123800         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               12380094
123900             SET ASC-PF19-NOT-PRESSED                             12390094
124000                 ASC-PF20-NOT-PRESSED                             12400094
124100                 PS-NO-UPDATE-PERFORMED                           12410094
124200                 PS-NO-WARNING     TO TRUE                        12420094
124300             IF PS-NO-ERROR                                       12430094
124400                 SET DP013-ROLLBACK                               12440094
124500                                   TO TRUE                        12450094
124600                 PERFORM 6600-CHECK-TOTAL-QUANTITY                12460094
124700                 IF PS-NO-ERROR                                   12470094
124800                     SET ASC-LOCAL-FUNC-01-PRESSED                12480094
124900                                                 TO TRUE          12490094
125000                     MOVE +0      TO PV-TOTAL-PAGES-ENTERED       12500094
125100                     IF PV-TOTAL-LINES > 0                        12510094
125200                         DIVIDE PV-TOTAL-LINES                    12520094
125300                             BY    PC-ITEMS-PER-PANEL             12530094
125400                         GIVING    PV-TOTAL-PAGES-ENTERED         12540094
125500                         REMAINDER PV-PAGE-REMAINDER              12550094
125600                         IF PV-PAGE-REMAINDER > 0                 12560094
125700                            ADD +1     TO PV-TOTAL-PAGES-ENTERED  12570094
125800                         END-IF                                   12580094
125900                     ELSE                                         12590094
126000                         MOVE 0        TO PV-TOTAL-PAGES-ENTERED  12600094
126100                     END-IF                                       12610094
126200                     IF PV-TOTAL-PAGES-ENTERED                    12620094
126300                                         < ASC-PAGES-TO-PRINT     12630094
126400                         SET PS-WARNING                           12640094
126500                             DP020-MSG-WARNING      TO TRUE       12650094
126600*     --- TOTAL PAGES ENTERED LESS THAN THE TOTAL PAGES ASSIGNED  12660094
126700*     --- TO THE DOCUMENT                                         12670094
126800                         MOVE ASC-PAGES-TO-PRINT                  12680094
126900                                   TO DP020-MSG-TEXT              12690094
127000                         MOVE PC-TSYMSG-00667                     12700094
127100                                   TO DP020-MSG-NUMBER            12710094
127200                     END-IF                                       12720094
127300                 END-IF                                           12730094
127400                 IF (PS-NO-ERROR                                  12740094
127500                 AND PS-NO-WARNING)                               12750094
127600                     PERFORM 6200-APPLY-DETAIL-CHANGES            12760094
127700                     PERFORM 6900-APPLY-HEADER-CHANGES            12770094
127800                     IF PS-NO-UPDATE-PERFORMED                    12780094
127900                         MOVE PC-TSYMSG-00046                     12790094
128000                                   TO DP020-MSG-NUMBER            12800094
128100                         SET DP020-MSG-INFORMATIONAL              12810094
128200                                   TO TRUE                        12820094
128300                     ELSE                                         12830094
128400                         MOVE PC-TSYMSG-00059                     12840094
128500                                   TO DP020-MSG-NUMBER            12850094
128600                         SET DP020-MSG-INFORMATIONAL              12860094
128700                                   TO TRUE                        12870094
128800                         IF ASC-USE-SELECTION-QUEUE               12880094
128900                             PERFORM 9100-READ-SEL-QUEUE          12890094
129000                             SET PE067-UPD (ASC-SEL-SUB)          12900094
129100                                   TO TRUE                        12910094
129200                             PERFORM 9200-REWRITE-SEL-QUEUE       12920094
129300                         END-IF                                   12930094
129400                         PERFORM 7000-DELETE-LIST-QUEUE           12940094
129500                         PERFORM 7025-DELETE-ORIG-QUEUE           12950094
129600                     END-IF                                       12960094
129700                     MOVE ASC-KEY-STORE-NBR-N                     12970094
129800                                   TO DK-STORE-NBR                12980094
129900                     MOVE ASC-KEY-DOC-NBR-N                       12990094
130000                                   TO DK-DOC-NBR                  13000094
130100                     PERFORM 4000-BUILD-INITIAL-PANEL             13010094
130200                 ELSE                                             13020094
130300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13030094
130400                 END-IF                                           13040094
130500             ELSE                                                 13050094
130600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13060094
130700             END-IF                                               13070094
130800                                                                  13080094
130900         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     13090094
131000             SET ASC-PF19-NOT-PRESSED                             13100094
131100                 ASC-PF20-NOT-PRESSED                             13110094
131200                 PS-NO-UPDATE-PERFORMED                           13120094
131300                 PS-NO-WARNING     TO TRUE                        13130094
131400             IF PS-NO-ERROR                                       13140094
131500                 IF ASC-LOCAL-FUNC-01-PRESSED                     13150094
131600                     SET ASC-LOCAL-FUNC-01-NOT-PRESSED            13160094
131700                                   TO TRUE                        13170094
131800                 ELSE                                             13180094
131900                     SET PS-ERROR                                 13190094
132000                         DP020-MSG-FATAL                          13200094
132100                                   TO TRUE                        13210094
132200                     MOVE PC-TSYMSG-00045                         13220094
132300                                   TO DP020-MSG-NUMBER            13230094
132400*     --- INVALID FUNCTION KEY ---                                13240094
132500                 END-IF                                           13250094
132600                 IF PS-NO-ERROR                                   13260094
132700                     SET DP013-ROLLBACK                           13270094
132800                                   TO TRUE                        13280094
132900                     PERFORM 6600-CHECK-TOTAL-QUANTITY            13290094
133000                 END-IF                                           13300094
133100                 IF PS-NO-ERROR                                   13310094
133200                     PERFORM 6200-APPLY-DETAIL-CHANGES            13320094
133300                     PERFORM 6900-APPLY-HEADER-CHANGES            13330094
133400                     IF PS-NO-UPDATE-PERFORMED                    13340094
133500                         MOVE PC-TSYMSG-00046                     13350094
133600                                   TO DP020-MSG-NUMBER            13360094
133700                         SET DP020-MSG-INFORMATIONAL              13370094
133800                                   TO TRUE                        13380094
133900                     ELSE                                         13390094
134000                         MOVE PC-TSYMSG-00059                     13400094
134100                                   TO DP020-MSG-NUMBER            13410094
134200                         SET DP020-MSG-INFORMATIONAL              13420094
134300                                   TO TRUE                        13430094
134400                         IF ASC-USE-SELECTION-QUEUE               13440094
134500                             PERFORM 9100-READ-SEL-QUEUE          13450094
134600                             SET PE067-UPD (ASC-SEL-SUB)          13460094
134700                                   TO TRUE                        13470094
134800                             PERFORM 9200-REWRITE-SEL-QUEUE       13480094
134900                         END-IF                                   13490094
135000                         PERFORM 7000-DELETE-LIST-QUEUE           13500094
135100                         PERFORM 7025-DELETE-ORIG-QUEUE           13510094
135200                     END-IF                                       13520094
135300                     MOVE ASC-KEY-STORE-NBR-N                     13530094
135400                                   TO DK-STORE-NBR                13540094
135500                     MOVE ASC-KEY-DOC-NBR-N                       13550094
135600                                   TO DK-DOC-NBR                  13560094
135700                     PERFORM 4000-BUILD-INITIAL-PANEL             13570094
135800                 ELSE                                             13580094
135900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13590094
136000                 END-IF                                           13600094
136100             ELSE                                                 13610094
136200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13620094
136300             END-IF                                               13630094
136400                                                                  13640094
136500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13650094
136600             SET ASC-PF19-NOT-PRESSED                             13660094
136700                 ASC-PF20-NOT-PRESSED                             13670094
136800                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            13680094
136900             IF PS-NO-ERROR                                       13690094
137000                 MOVE +1           TO PV-TOP-ITEM                 13700094
137100                 IF ((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)    13710094
137200                 AND PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)     13720094
137300                 AND ASC-LIST-ITEM-NUMBER (1 1) NOT = ZEROS       13730094
137400                 AND ASC-LIST-ITEM-NUMBER (2 1) NOT = ZEROS)      13740094
137500                 OR PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1))     13750094
137600                     IF ASC-ITEMS-IN-TEMP-ST                      13760094
137700                         MOVE +1   TO ASC-BLK-SUB                 13770094
137800                         PERFORM 5100-WRITE-TEMP-STORAGE          13780094
137900                         ADD +1    TO ASC-BLK-SUB                 13790094
138000                         PERFORM 5100-WRITE-TEMP-STORAGE          13800094
138100                         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL 13810094
138200                             GIVING PV-BLOCK-NUMBER               13820094
138300                             REMAINDER PV-REMAINDER               13830094
138400                         IF PV-REMAINDER > ZERO                   13840094
138500                             ADD +1 TO PV-BLOCK-NUMBER            13850094
138600                         END-IF                                   13860094
138700                         MOVE +1   TO ASC-BLK-SUB                 13870094
138800                         PERFORM 7100-READ-TEMP-STORAGE           13880094
138900                         ADD +1    TO ASC-BLK-SUB                 13890094
139000                                              PV-BLOCK-NUMBER     13900094
139100                         PERFORM 7100-READ-TEMP-STORAGE           13910094
139200                     END-IF                                       13920094
139300                 END-IF                                           13930094
139400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13940094
139500             END-IF                                               13950094
139600                                                                  13960094
139700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13970094
139800             SET ASC-PF19-NOT-PRESSED                             13980094
139900                 ASC-PF20-NOT-PRESSED                             13990094
140000                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            14000094
140100             IF PS-NO-ERROR                                       14010094
140200                 PERFORM 2110-BROWSE-BACKWARD                     14020094
140300             END-IF                                               14030094
140400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14040094
140500                                                                  14050094
140600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14060094
140700             SET ASC-PF19-NOT-PRESSED                             14070094
140800                 ASC-PF20-NOT-PRESSED                             14080094
140900                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            14090094
141000             IF PS-NO-ERROR                                       14100094
141100                 PERFORM 2120-BROWSE-FORWARD                      14110094
141200             END-IF                                               14120094
141300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14130094
141400                                                                  14140094
141500         WHEN DP020-SRC-AID = DP016-ENTER                         14150094
141600             SET ASC-PF19-NOT-PRESSED                             14160094
141700                 ASC-PF20-NOT-PRESSED                             14170094
141800                 ASC-LOCAL-FUNC-01-NOT-PRESSED TO TRUE            14180094
141900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14190094
142000                                                                  14200094
142100         WHEN OTHER                                               14210094
142200             SET DP013-NO-ROLLBACK                                14220094
142300                 DP013-XCTL-DISPLAY-RESTART                       14230094
142400                 DP013-CICS-ABEND  TO TRUE                        14240094
142500             MOVE '2100-CHECK-FUNCTION-KEY'                       14250094
142600                                   TO DP013-PARAGRAPH             14260094
142700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14270094
142800                                   TO DP013-MESSAGE-TEXT (1)      14280094
142900             PERFORM DP013-0000-PROCESS-ABEND                     14290094
143000     END-EVALUATE.                                                14300094
143100*                                                                 14310094
143200 EJECT                                                            14320094
143300*----------------------------------------------------------------*14330094
143400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14340094
143500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14350094
143600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14360094
143700*    MESSAGE.                                                    *14370094
143800*----------------------------------------------------------------*14380094
143900                                                                  14390094
144000 2110-BROWSE-BACKWARD.                                            14400094
144100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14410094
144200         GIVING PV-TOP-ITEM.                                      14420094
144300*                                                                 14430094
144400     IF  ((PV-TOP-ITEM < +1)                                      14440094
144500       OR (PV-TOP-ITEM = +1))                                     14450094
144600         MOVE +1                   TO PV-TOP-ITEM                 14460094
144700*     --- TOP OF LIST ---                                         14470094
144800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14480094
144900         SET DP020-MSG-INFORMATIONAL TO TRUE                      14490094
145000     END-IF.                                                      14500094
145100*                                                                 14510094
145200     IF  PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)                 14520094
145300         IF ASC-ITEMS-IN-TEMP-ST                                  14530094
145400             MOVE +1               TO ASC-BLK-SUB                 14540094
145500             PERFORM 5100-WRITE-TEMP-STORAGE                      14550094
145600             ADD +1                TO ASC-BLK-SUB                 14560094
145700             PERFORM 5100-WRITE-TEMP-STORAGE                      14570094
145800             MOVE +1               TO ASC-BLK-SUB                 14580094
145900             MOVE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)                 14590094
146000                                   TO ASC-BLOCK-ENTRIES           14600094
146100                                   (PC-MAX-BLOCKS-IN-ARRAY)       14610094
146200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             14620094
146300                 GIVING PV-BLOCK-NUMBER                           14630094
146400                 REMAINDER PV-REMAINDER                           14640094
146500             IF  PV-REMAINDER > ZERO                              14650094
146600                 ADD +1            TO PV-BLOCK-NUMBER             14660094
146700             END-IF                                               14670094
146800             PERFORM 7100-READ-TEMP-STORAGE                       14680094
146900         END-IF                                                   14690094
147000     END-IF.                                                      14700094
147100*                                                                 14710094
147200 EJECT                                                            14720094
147300*----------------------------------------------------------------*14730094
147400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14740094
147500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14750094
147600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14760094
147700*----------------------------------------------------------------*14770094
147800                                                                  14780094
147900 2120-BROWSE-FORWARD.                                             14790094
148000                                                                  14800094
148100     COMPUTE PV-MAX-LINES-PER-DOC = (PC-ITEMS-PER-PANEL *         14810094
148200                                     ASC-PAGES-TO-PRINT).         14820094
148300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14830094
148400         GIVING PV-TOP-ITEM.                                      14840094
148500     IF  PV-TOP-ITEM > PV-MAX-LINES-PER-DOC                       14850094
148600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14860094
148700                                   TO PV-TOP-ITEM                 14870094
148800*     --- BOTTOM OF LIST ---                                      14880094
148900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14890094
149000         SET DP020-MSG-INFORMATIONAL                              14900094
149100                                   TO TRUE                        14910094
149200     ELSE                                                         14920094
149300         IF ASC-SKU-NBR (ASC-BLK-SUB 10) = SPACES                 14930094
149400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        14940094
149500                                   TO PV-TOP-ITEM                 14950094
149600*     --- BOTTOM OF LIST ---                                      14960094
149700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14970094
149800             SET DP020-MSG-INFORMATIONAL                          14980094
149900                                   TO TRUE                        14990094
150000         ELSE                                                     15000094
150100             COMPUTE PV-BOTTOM-ITEM =                             15010094
150200                 PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1             15020094
150300             IF  PV-BOTTOM-ITEM > PV-MAX-LINES-PER-DOC            15030094
150400*     --- BOTTOM OF LIST ---                                      15040094
150500                 MOVE PC-TSYMSG-00070                             15050094
150600                                   TO DP020-MSG-NUMBER            15060094
150700                 SET DP020-MSG-INFORMATIONAL                      15070094
150800                                   TO TRUE                        15080094
150900             END-IF                                               15090094
151000         END-IF                                                   15100094
151100     END-IF.                                                      15110094
151200     IF  (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)                15120094
151300      AND PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)                15130094
151400      AND ASC-LIST-ITEM-NUMBER (1 1) NOT = ZEROS                  15140094
151500      AND ASC-LIST-ITEM-NUMBER (2 1) NOT = ZEROS)                 15150094
151600         IF ASC-ITEMS-IN-TEMP-ST                                  15160094
151700             MOVE +1               TO ASC-BLK-SUB                 15170094
151800             PERFORM 5100-WRITE-TEMP-STORAGE                      15180094
151900             MOVE ASC-BLOCK-ENTRIES (PC-MAX-BLOCKS-IN-ARRAY)      15190094
152000                                   TO ASC-BLOCK-ENTRIES           15200094
152100                                      (ASC-BLK-SUB)               15210094
152200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             15220094
152300                 GIVING PV-BLOCK-NUMBER                           15230094
152400                 REMAINDER PV-REMAINDER                           15240094
152500             IF  PV-REMAINDER > ZERO                              15250094
152600                 ADD +1            TO PV-BLOCK-NUMBER             15260094
152700             END-IF                                               15270094
152800             ADD +1                TO ASC-BLK-SUB                 15280094
152900             PERFORM 7100-READ-TEMP-STORAGE                       15290094
153000         END-IF                                                   15300094
153100     END-IF.                                                      15310094
153200*                                                                 15320094
153300 EJECT                                                            15330094
153400*----------------------------------------------------------------*15340094
153500*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *15350094
153600*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *15360094
153700*----------------------------------------------------------------*15370094
153800 2200-MOVE-SCREEN-TO-COMMAREA.                                    15380094
153900                                                                  15390094
154000     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15400094
154100     MOVE +1                       TO PV-SUB.                     15410094
154200     IF  ARSNL  > ZERO                                            15420094
154300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15430094
154400             ASC-DATA-UPDATED      TO TRUE                        15440094
154500         MOVE ARSNI                TO ASC-REASON-CODE             15450094
154600     ELSE                                                         15460094
154700         IF  ARSNA = DP015-ERASE-EOF                              15470094
154800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 15480094
154900                 ASC-DATA-UPDATED  TO TRUE                        15490094
155000             MOVE SPACE            TO ASC-REASON-CODE             15500094
155100         END-IF                                                   15510094
155200     END-IF.                                                      15520094
155300*                                                                 15530094
155400     IF  AEFFNML > ZERO                                           15540094
155500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15550094
155600             ASC-DATA-UPDATED      TO TRUE                        15560094
155700         MOVE AEFFNMI              TO ASC-EFFECTIVE-NAME          15570094
155800     ELSE                                                         15580094
155900         IF  AEFFNMA = DP015-ERASE-EOF                            15590094
156000             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 15600094
156100                 ASC-DATA-UPDATED  TO TRUE                        15610094
156200             MOVE SPACE            TO ASC-EFFECTIVE-NAME          15620094
156300         END-IF                                                   15630094
156400     END-IF.                                                      15640094
156500*                                                                 15650094
156600     IF  AEFFMML > ZERO                                           15660094
156700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15670094
156800             ASC-DATA-UPDATED      TO TRUE                        15680094
156900         MOVE AEFFMMI              TO ASC-EFFECTIVE-MM            15690094
157000     ELSE                                                         15700094
157100         IF  AEFFMMA = DP015-ERASE-EOF                            15710094
157200             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 15720094
157300                 ASC-DATA-UPDATED  TO TRUE                        15730094
157400             MOVE SPACE            TO ASC-EFFECTIVE-MM            15740094
157500         END-IF                                                   15750094
157600     END-IF.                                                      15760094
157700*                                                                 15770094
157800     IF  AEFFDDL > ZERO                                           15780094
157900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15790094
158000             ASC-DATA-UPDATED      TO TRUE                        15800094
158100         MOVE AEFFDDI              TO ASC-EFFECTIVE-DD            15810094
158200     ELSE                                                         15820094
158300         IF  AEFFDDA = DP015-ERASE-EOF                            15830094
158400             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 15840094
158500                 ASC-DATA-UPDATED  TO TRUE                        15850094
158600             MOVE SPACE            TO ASC-EFFECTIVE-DD            15860094
158700         END-IF                                                   15870094
158800     END-IF.                                                      15880094
158900*                                                                 15890094
159000     IF  AEFFYYL > ZERO                                           15900094
159100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15910094
159200             ASC-DATA-UPDATED      TO TRUE                        15920094
159300         MOVE AEFFYYI              TO ASC-EFFECTIVE-YY            15930094
159400     ELSE                                                         15940094
159500         IF  AEFFYYA = DP015-ERASE-EOF                            15950094
159600             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 15960094
159700                 ASC-DATA-UPDATED  TO TRUE                        15970094
159800             MOVE SPACE            TO ASC-EFFECTIVE-YY            15980094
159900         END-IF                                                   15990094
160000     END-IF.                                                      16000094
160100*                                                                 16010094
160200     IF  ADPTARL > ZERO                                           16020094
160300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16030094
160400             ASC-DATA-UPDATED      TO TRUE                        16040094
160500         MOVE ADPTARI              TO ASC-DEPT-AREA               16050094
160600     ELSE                                                         16060094
160700         IF  ADPTARA = DP015-ERASE-EOF                            16070094
160800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 16080094
160900                 ASC-DATA-UPDATED  TO TRUE                        16090094
161000             MOVE SPACE            TO ASC-DEPT-AREA               16100094
161100         END-IF                                                   16110094
161200     END-IF.                                                      16120094
161300*                                                                 16130094
161400     IF  ATOTQTYL > ZERO                                          16140094
161500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16150094
161600             ASC-DATA-UPDATED      TO TRUE                        16160094
161700         MOVE ATOTQTYI             TO ASC-TOTAL-QUANTITY          16170094
161800     ELSE                                                         16180094
161900         IF  ATOTQTYA = DP015-ERASE-EOF                           16190094
162000             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 16200094
162100                 ASC-DATA-UPDATED  TO TRUE                        16210094
162200             MOVE SPACE            TO ASC-TOTAL-QUANTITY          16220094
162300         END-IF                                                   16230094
162400     END-IF.                                                      16240094
162500*                                                                 16250094
162600     PERFORM 3100-SET-SUBSCRIPTS.                                 16260094
162700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16270094
162800         VARYING PV-SUB                                           16280094
162900         FROM 1 BY 1                                              16290094
163000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16300094
163100*                                                                 16310094
163200 EJECT                                                            16320094
163300*----------------------------------------------------------------*16330094
163400*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *16340094
163500*----------------------------------------------------------------*16350094
163600 2210-MOVE-LINES-TO-COMMAREA.                                     16360094
163700*                                                                 16370094
163800     IF  MR-SKUL (PV-SUB) > ZERO                                  16380094
163900         MOVE MR-SKU (PV-SUB)      TO ASC-SKU-NBR                 16390094
164000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16400094
164100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16410094
164200             ASC-SKU-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)          16420094
164300             ASC-DATA-UPDATED      TO TRUE                        16430094
164400     ELSE                                                         16440094
164500         IF  MR-SKUA (PV-SUB) = DP015-ERASE-EOF                   16450094
164600             MOVE SPACE            TO ASC-SKU-NBR                 16460094
164700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16470094
164800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 16480094
164900                 ASC-SKU-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)      16490094
165000                 ASC-DATA-UPDATED  TO TRUE                        16500094
165100         END-IF                                                   16510094
165200     END-IF.                                                      16520094
165300*                                                                 16530094
165400     IF  MR-UPCL (PV-SUB) > ZERO                                  16540094
165500         MOVE MR-UPC (PV-SUB)      TO ASC-UPC                     16550094
165600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16560094
165700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16570094
165800             ASC-UPC-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)          16580094
165900             ASC-DATA-UPDATED      TO TRUE                        16590094
166000     ELSE                                                         16600094
166100         IF  MR-UPCA (PV-SUB) = DP015-ERASE-EOF                   16610094
166200             MOVE SPACE            TO ASC-UPC                     16620094
166300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16630094
166400             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 16640094
166500                 ASC-UPC-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)      16650094
166600                 ASC-DATA-UPDATED  TO TRUE                        16660094
166700         END-IF                                                   16670094
166800     END-IF.                                                      16680094
166900*                                                                 16690094
167000     IF  MR-ORIG-PRICEL (PV-SUB) > ZERO                           16700094
167100         MOVE MR-ORIG-PRICE (PV-SUB)                              16710094
167200                                   TO ASC-ORIGINAL-PRICE-DISP     16720094
167300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16730094
167400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16740094
167500             ASC-PRICE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)        16750094
167600             ASC-DATA-UPDATED      TO TRUE                        16760094
167700     ELSE                                                         16770094
167800         IF  MR-ORIG-PRICEA (PV-SUB) = DP015-ERASE-EOF            16780094
167900             MOVE SPACE            TO ASC-ORIGINAL-PRICE-DISP     16790094
168000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16800094
168100             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 16810094
168200                 ASC-PRICE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)    16820094
168300                 ASC-DATA-UPDATED  TO TRUE                        16830094
168400         END-IF                                                   16840094
168500     END-IF.                                                      16850094
168600*                                                                 16860094
168700     IF  MR-NEW-PRICEL (PV-SUB) > ZERO                            16870094
168800         MOVE MR-NEW-PRICE (PV-SUB)                               16880094
168900                                   TO ASC-NEW-PRICE-DISP          16890094
169000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16900094
169100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16910094
169200             ASC-PRICE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)        16920094
169300             ASC-DATA-UPDATED      TO TRUE                        16930094
169400     ELSE                                                         16940094
169500         IF  MR-NEW-PRICEA (PV-SUB) = DP015-ERASE-EOF             16950094
169600             MOVE SPACE            TO ASC-NEW-PRICE-DISP          16960094
169700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16970094
169800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 16980094
169900                 ASC-PRICE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)    16990094
170000                 ASC-DATA-UPDATED  TO TRUE                        17000094
170100         END-IF                                                   17010094
170200     END-IF.                                                      17020094
170300*                                                                 17030094
170400     IF  MR-PRICE-DIFFL (PV-SUB) > ZERO                           17040094
170500         MOVE MR-PRICE-DIFF (PV-SUB)                              17050094
170600                                   TO ASC-PRICE-DIFF-DISP         17060094
170700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17070094
170800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     17080094
170900             ASC-PRICE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)        17090094
171000             ASC-DATA-UPDATED      TO TRUE                        17100094
171100     ELSE                                                         17110094
171200         IF  MR-PRICE-DIFFA (PV-SUB) = DP015-ERASE-EOF            17120094
171300             MOVE SPACE            TO ASC-PRICE-DIFF-DISP         17130094
171400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17140094
171500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 17150094
171600                 ASC-PRICE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)    17160094
171700                 ASC-DATA-UPDATED  TO TRUE                        17170094
171800         END-IF                                                   17180094
171900     END-IF.                                                      17190094
172000*                                                                 17200094
172100     IF  MR-QUANTITYL (PV-SUB) > ZERO                             17210094
172200         MOVE MR-QUANTITY (PV-SUB)                                17220094
172300                                   TO ASC-QUANTITY                17230094
172400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17240094
172500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     17250094
172600             ASC-QUANTITY-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)     17260094
172700             ASC-DATA-UPDATED      TO TRUE                        17270094
172800     ELSE                                                         17280094
172900         IF  MR-QUANTITYA (PV-SUB) = DP015-ERASE-EOF              17290094
173000             MOVE SPACE            TO ASC-QUANTITY                17300094
173100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17310094
173200             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 17320094
173300                 ASC-QUANTITY-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB) 17330094
173400                 ASC-DATA-UPDATED  TO TRUE                        17340094
173500         END-IF                                                   17350094
173600     END-IF.                                                      17360094
173700     IF (ASC-SKU-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)              17370094
173800     OR  ASC-UPC-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)              17380094
173900     OR  ASC-PRICE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)            17390094
174000     OR  ASC-QUANTITY-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB))        17400094
174100         IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)       17410094
174200                                                        = ZEROS   17420094
174300             ADD +1                TO ASC-LAST-LIST-ITEM-NUMBER   17430094
174400             MOVE ASC-LAST-LIST-ITEM-NUMBER                       17440094
174500                                   TO ASC-LIST-ITEM-NUMBER        17450094
174600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17460094
174700         END-IF                                                   17470094
174800     END-IF.                                                      17480094
174900*                                                                 17490094
175000     ADD +1                        TO ASC-ITEM-SUB.               17500094
175100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17510094
175200         ADD +1                    TO ASC-BLK-SUB                 17520094
175300         MOVE +1                   TO ASC-ITEM-SUB                17530094
175400     END-IF.                                                      17540094
175500*                                                                 17550094
175600 EJECT                                                            17560094
175700*----------------------------------------------------------------*17570094
175800*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *17580094
175900*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *17590094
176000*----------------------------------------------------------------*17600094
176100 3000-EDIT-DATA-IN-COMMAREA.                                      17610094
176200     SET PS-NO-ERROR               TO TRUE.                       17620094
176300     PERFORM 3200-RESET-ATTRIBUTES.                               17630094
176400                                                                  17640094
176500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17650094
176600                                                                  17660094
176700     PERFORM 3025-EDIT-HEADER-INFO.                               17670094
176800                                                                  17680094
176900**                                                                17690094
177000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17700094
177100* EDITTING IS DONE FROM THE BOTTOM UP.                            17710094
177200**                                                                17720094
177300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17730094
177400             ASC-ITEMS-DISPLAYED - 1.                             17740094
177500                                                                  17750094
177600     IF  PE049-IS-INVENTORY-MISSED-RSN                            17760094
177700     AND PE049-MARKDOWN                                           17770094
177800         CONTINUE                                                 17780094
177900     ELSE                                                         17790094
178000         PERFORM 3075-EDIT-SKU-UPC                                17800094
178100     END-IF.                                                      17810094
178200                                                                  17820094
178300     PERFORM 3100-SET-SUBSCRIPTS.                                 17830094
178400     PERFORM 3300-EDIT-SELECTIONS                                 17840094
178500         VARYING PV-SUB                                           17850094
178600         FROM PV-SUB BY -1                                        17860094
178700         UNTIL PV-SUB < +1                                        17870094
178800             IF PS-NO-ERROR                                       17880094
178900                 PERFORM 5100-WRITE-TEMP-STORAGE                  17890094
179000             END-IF.                                              17900094
179100     IF PS-ERROR                                                  17910094
179200         SET DP020-MSG-FATAL                                      17920094
179300             DP030-SET-CURSOR-APPL-1 TO TRUE                      17930094
179400     END-IF.                                                      17940094
179500*                                                                 17950094
179600 EJECT                                                            17960094
179700*----------------------------------------------------------------*17970094
179800*  EDIT ALL OF THE HEADER INFORMATION ON THE SCREEN AS IT        *17980094
179900*  RESIDES IN THE COMMAREA (EDITTING IS NOT DONE AGAINST THE     *17990094
180000*  SCREEN DIRECTLY).                                             *18000094
180100*----------------------------------------------------------------*18010094
180200 3025-EDIT-HEADER-INFO.                                           18020094
180300*                                                                 18030094
180400     IF  ASC-TOTAL-QUANTITY NOT > SPACE                           18040094
180500         SET PS-ERROR                                             18050094
180600             DP020-MSG-FATAL                                      18060094
180700             DP030-SET-CURSOR-APPL-1 TO TRUE                      18070094
180800*----PC-TSYMSG-00007 - REQUIRED ENTRY                             18080094
180900         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            18090094
181000         MOVE DP015-UNP-ALP-BRT-OFF                               18100094
181100                                   TO MR-TOTAL-QUANTITYA          18110094
181200         MOVE DP015-RED            TO MR-TOTAL-QUANTITYC          18120094
181300         MOVE DP015-REVERSE        TO MR-TOTAL-QUANTITYH          18130094
181400         MOVE -1                   TO MR-TOTAL-QUANTITYL          18140094
181500     ELSE                                                         18150094
181600         MOVE ASC-TOTAL-QUANTITY   TO DP010I-UNEDITED-FIELD       18160094
181700         MOVE LENGTH OF ASC-TOTAL-QUANTITY                        18170094
181800                                   TO DP010I-MAXIMUM-DIGITS       18180094
181900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     18190094
182000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18200094
182110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18211096
182120                         USING DP010I-NUMERIC-EDIT-AREA           18212096
182200         IF  DP010I-ERROR-DETECTED                                18220094
182300             SET PS-ERROR                                         18230094
182400                 DP020-MSG-FATAL                                  18240094
182500                 DP030-SET-CURSOR-APPL-1 TO TRUE                  18250094
182600*----PC-TSYMSG-00008 - MUST BE NUMERIC                            18260094
182700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18270094
182800             MOVE DP015-UNP-ALP-BRT-OFF                           18280094
182900                                   TO MR-TOTAL-QUANTITYA          18290094
183000             MOVE DP015-RED        TO MR-TOTAL-QUANTITYC          18300094
183100             MOVE DP015-REVERSE    TO MR-TOTAL-QUANTITYH          18310094
183200             MOVE -1               TO MR-TOTAL-QUANTITYL          18320094
183300         ELSE                                                     18330094
183400             MOVE DP010I-NUMERIC-FIELD                            18340094
183500                                   TO ASC-TOTAL-QUANTITY-N        18350094
183600         END-IF                                                   18360094
183700     END-IF.                                                      18370094
183800*                                                                 18380094
183900     IF  PE049-IS-INVENTORY-MISSED-RSN                            18390094
184000     AND PE049-MARKDOWN                                           18400094
184100         CONTINUE                                                 18410094
184200     ELSE                                                         18420094
184300         IF  ASC-DEPT-AREA NOT > SPACE                            18430094
184400             SET PS-ERROR                                         18440094
184500                 DP020-MSG-FATAL                                  18450094
184600                 DP030-SET-CURSOR-APPL-1 TO TRUE                  18460094
184700*----PC-TSYMSG-00007 - REQUIRED ENTRY                             18470094
184800             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            18480094
184900             MOVE DP015-UNP-ALP-BRT-OFF                           18490094
185000                                   TO ADPTARA                     18500094
185100             MOVE DP015-RED        TO ADPTARC                     18510094
185200             MOVE DP015-REVERSE    TO ADPTARH                     18520094
185300             MOVE -1               TO ADPTARL                     18530094
185400         END-IF                                                   18540094
185500     END-IF.                                                      18550094
185600*                                                                 18560094
185700     IF  PE049-IS-INVENTORY-MISSED-RSN                            18570094
185800     AND PE049-MARKDOWN                                           18580094
185900         CONTINUE                                                 18590094
186000     ELSE                                                         18600094
186100         PERFORM 3050-EDIT-EFF-DATE                               18610094
186200     END-IF.                                                      18620094
186300*                                                                 18630094
186400     IF  ASC-EFFECTIVE-NAME NOT > SPACE                           18640094
186500         SET PS-ERROR                                             18650094
186600             DP020-MSG-FATAL                                      18660094
186700             DP030-SET-CURSOR-APPL-1 TO TRUE                      18670094
186800*----PC-TSYMSG-00007 - REQUIRED ENTRY                             18680094
186900         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            18690094
187000         MOVE DP015-UNP-ALP-BRT-OFF                               18700094
187100                                   TO AEFFNMA                     18710094
187200         MOVE DP015-RED            TO AEFFNMC                     18720094
187300         MOVE DP015-REVERSE        TO AEFFNMH                     18730094
187400         MOVE -1                   TO AEFFNML                     18740094
187500     END-IF.                                                      18750094
187600*                                                                 18760094
187700     IF  ASC-REASON-CODE > SPACE                                  18770094
187800         MOVE ASC-REASON-CODE      TO DP010I-UNEDITED-FIELD       18780094
187900         MOVE LENGTH OF ASC-REASON-CODE                           18790094
188000                                   TO DP010I-MAXIMUM-DIGITS       18800094
188100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     18810094
188200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18820094
188310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18831096
188320                         USING DP010I-NUMERIC-EDIT-AREA           18832096
188400         IF  DP010I-ERROR-DETECTED                                18840094
188500             SET PS-ERROR                                         18850094
188600                 DP020-MSG-FATAL                                  18860094
188700                 DP030-SET-CURSOR-APPL-1 TO TRUE                  18870094
188800*----PC-TSYMSG-00008 - MUST BE NUMERIC                            18880094
188900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18890094
189000             MOVE SPACES           TO ASC-REASON-DESC             18900094
189100                                      ASC-TYPE-DESC               18910094
189200             MOVE DP015-UNP-ALP-BRT-OFF                           18920094
189300                                   TO ARSNA                       18930094
189400             MOVE DP015-RED        TO ARSNC                       18940094
189500             MOVE DP015-REVERSE    TO ARSNH                       18950094
189600             MOVE -1               TO ARSNL                       18960094
189700         ELSE                                                     18970094
189800             MOVE DP010I-NUMERIC-FIELD                            18980094
189900                                   TO ASC-REASON-CODE-N           18990094
190000             PERFORM 8999-GET-REASON-DESC                         19000094
190100             IF (ASC-ORIG-REASON-CDE NOT =                        19010094
190200                       PE049-INV-MISSD-RSN-CODE                   19020094
190300                   AND PE049-IS-INVENTORY-MISSED-RSN)    OR       19030094
190400                (ASC-ORIG-REASON-CDE NOT =                        19040094
190500                       PE049-RF-ZERO-OUT-RSN-CODE                 19050094
190600                   AND PE049-IS-RF-ZERO-OUT-RSN)         OR       19060094
190700                (ASC-ORIG-REASON-CDE NOT =                        19070094
190800                       PE049-RTN-TO-VNDR-RSN-CODE                 19080094
190900                   AND PE049-IS-RTN-TO-VNDR-RSN)         OR       19090094
191000                (ASC-ORIG-REASON-CDE NOT =                        19100094
191100                       PE049-ZERO-OUT-RSN-CODE                    19110094
191200                   AND PE049-IS-ZERO-OUT-RSN)            OR       19120094
191300                (ASC-ORIG-REASON-CDE NOT =                        19130094
191400                       PE049-CUST-RTN-RSN-CODE                    19140094
191500                   AND PE049-IS-CUSTOMER-RET-RSN)                 19150094
191600                     SET PS-ERROR                                 19160094
191700                         DP020-MSG-FATAL                          19170094
191800                         DP030-SET-CURSOR-APPL-1                  19180094
191900                                   TO TRUE                        19190094
192000*----PC-TSYMSG-00022 - REASON CODE IS NOT VALID FOR THE PRICE     19200094
192100*----                  CHANGE TYPE                                19210094
192200                     MOVE PC-TSYMSG-00022                         19220094
192300                                   TO DP020-MSG-NUMBER            19230094
192400                     MOVE DP015-UNP-ALP-BRT-OFF                   19240094
192500                                   TO ARSNA                       19250094
192600                     MOVE DP015-RED                               19260094
192700                                   TO ARSNC                       19270094
192800                     MOVE DP015-REVERSE                           19280094
192900                                   TO ARSNH                       19290094
193000                     MOVE -1       TO ARSNL                       19300094
193100*                END-IF                                           19310094
193200             END-IF                                               19320094
193300         END-IF                                                   19330094
193400     ELSE                                                         19340094
193500         SET PS-ERROR                                             19350094
193600             DP020-MSG-FATAL                                      19360094
193700             DP030-SET-CURSOR-APPL-1 TO TRUE                      19370094
193800*----PC-TSYMSG-00007 - REQUIRED ENTRY                             19380094
193900         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                19390094
194000         MOVE DP015-UNP-ALP-BRT-OFF                               19400094
194100                                   TO ARSNA                       19410094
194200         MOVE DP015-RED            TO ARSNC                       19420094
194300         MOVE DP015-REVERSE        TO ARSNH                       19430094
194400         MOVE -1                   TO ARSNL                       19440094
194500         MOVE SPACES               TO ASC-REASON-DESC             19450094
194600                                      ASC-TYPE-DESC               19460094
194700     END-IF.                                                      19470094
194800*                                                                 19480094
194900 EJECT                                                            19490094
195000*----------------------------------------------------------------*19500094
195100*    THE EFFECTIVE DATE IS ONLY EDITTED WHEN IT IS NOT GENERATED *19510094
195200*    THRU THE INVENTORY MISSED MARKDOWNS BATCH PROCESSING.       *19520094
195300*----------------------------------------------------------------*19530094
195400                                                                  19540094
195500 3050-EDIT-EFF-DATE.                                              19550094
195600                                                                  19560094
195700     SET PS-EFF-DATE-NOT-ENTERED                                  19570094
195800         PS-EFF-MM-NOT-ENTERED                                    19580094
195900         PS-EFF-DD-NOT-ENTERED                                    19590094
196000         PS-EFF-YY-NOT-ENTERED     TO TRUE.                       19600094
196100     IF  ASC-EFFECTIVE-MM > SPACE                                 19610094
196200         MOVE ASC-EFFECTIVE-MM     TO DP010I-UNEDITED-FIELD       19620094
196300         MOVE LENGTH OF ASC-EFFECTIVE-MM                          19630094
196400                                   TO DP010I-MAXIMUM-DIGITS       19640094
196500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     19650094
196600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19660094
196710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19671096
196720                         USING DP010I-NUMERIC-EDIT-AREA           19672096
196800         IF  DP010I-ERROR-DETECTED                                19680094
196900             SET PS-ERROR                                         19690094
197000                 DP020-MSG-FATAL                                  19700094
197100                 DP030-SET-CURSOR-APPL-1 TO TRUE                  19710094
197200*----PC-TSYMSG-00008 - MUST BE NUMERIC                            19720094
197300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19730094
197400             MOVE DP015-UNP-ALP-BRT-OFF                           19740094
197500                                   TO AEFFMMA                     19750094
197600             MOVE DP015-RED        TO AEFFMMC                     19760094
197700             MOVE DP015-REVERSE    TO AEFFMMH                     19770094
197800             MOVE -1               TO AEFFMML                     19780094
197900         ELSE                                                     19790094
198000             MOVE DP010I-NUMERIC-FIELD                            19800094
198100                                   TO ASC-EFFECTIVE-MM-N          19810094
198200             SET PS-EFF-MM-ENTERED                                19820094
198300                                   TO TRUE                        19830094
198400         END-IF                                                   19840094
198500     END-IF.                                                      19850094
198600*                                                                 19860094
198700     IF  ASC-EFFECTIVE-DD > SPACE                                 19870094
198800         MOVE ASC-EFFECTIVE-DD     TO DP010I-UNEDITED-FIELD       19880094
198900         MOVE LENGTH OF ASC-EFFECTIVE-DD                          19890094
199000                                   TO DP010I-MAXIMUM-DIGITS       19900094
199100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     19910094
199200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19920094
199310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19931096
199320                         USING DP010I-NUMERIC-EDIT-AREA           19932096
199400         IF  DP010I-ERROR-DETECTED                                19940094
199500             SET PS-ERROR                                         19950094
199600                 DP020-MSG-FATAL                                  19960094
199700                 DP030-SET-CURSOR-APPL-1 TO TRUE                  19970094
199800*----PC-TSYMSG-00008 - MUST BE NUMERIC                            19980094
199900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19990094
200000             MOVE DP015-UNP-ALP-BRT-OFF                           20000094
200100                                   TO AEFFDDA                     20010094
200200             MOVE DP015-RED        TO AEFFDDC                     20020094
200300             MOVE DP015-REVERSE    TO AEFFDDH                     20030094
200400             MOVE -1               TO AEFFDDL                     20040094
200500         ELSE                                                     20050094
200600             MOVE DP010I-NUMERIC-FIELD                            20060094
200700                                   TO ASC-EFFECTIVE-DD-N          20070094
200800             SET PS-EFF-DD-ENTERED                                20080094
200900                                   TO TRUE                        20090094
201000         END-IF                                                   20100094
201100     END-IF.                                                      20110094
201200*                                                                 20120094
201300     IF  ASC-EFFECTIVE-YY > SPACE                                 20130094
201400         MOVE ASC-EFFECTIVE-YY     TO DP010I-UNEDITED-FIELD       20140094
201500         MOVE LENGTH OF ASC-EFFECTIVE-YY                          20150094
201600                                   TO DP010I-MAXIMUM-DIGITS       20160094
201700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     20170094
201800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  20180094
201910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20191096
201920                         USING DP010I-NUMERIC-EDIT-AREA           20192096
202000         IF  DP010I-ERROR-DETECTED                                20200094
202100             SET PS-ERROR                                         20210094
202200                 DP020-MSG-FATAL                                  20220094
202300                 DP030-SET-CURSOR-APPL-1 TO TRUE                  20230094
202400*----PC-TSYMSG-00008 - MUST BE NUMERIC                            20240094
202500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20250094
202600             MOVE DP015-UNP-ALP-BRT-OFF                           20260094
202700                                   TO AEFFYYA                     20270094
202800             MOVE DP015-RED        TO AEFFYYC                     20280094
202900             MOVE DP015-REVERSE    TO AEFFYYH                     20290094
203000             MOVE -1               TO AEFFYYL                     20300094
203100         ELSE                                                     20310094
203200             MOVE DP010I-NUMERIC-FIELD                            20320094
203300                                   TO ASC-EFFECTIVE-YY-N          20330094
203400             SET PS-EFF-YY-ENTERED                                20340094
203500                                   TO TRUE                        20350094
203600         END-IF                                                   20360094
203700     END-IF.                                                      20370094
203800                                                                  20380094
203900                                                                  20390094
204000     IF (PS-EFF-MM-ENTERED                                        20400094
204100     AND PS-EFF-DD-ENTERED                                        20410094
204200     AND PS-EFF-YY-ENTERED)                                       20420094
204300         SET PS-EFF-DATE-ENTERED TO TRUE                          20430094
204400     ELSE                                                         20440094
204500         IF (PS-EFF-MM-NOT-ENTERED                                20450094
204600         OR  PS-EFF-DD-NOT-ENTERED                                20460094
204700         OR  PS-EFF-YY-NOT-ENTERED)                               20470094
204800             SET PS-ERROR                                         20480094
204900                 DP020-MSG-FATAL                                  20490094
205000                 DP030-SET-CURSOR-APPL-1 TO TRUE                  20500094
205100*----PC-TSYMSG-00009 - INVALID DATE                               20510094
205200             MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER            20520094
205300             MOVE DP015-UNP-ALP-BRT-OFF                           20530094
205400                                   TO AEFFMMA                     20540094
205500                                      AEFFDDA                     20550094
205600                                      AEFFYYA                     20560094
205700             MOVE DP015-RED        TO AEFFMMC                     20570094
205800                                      AEFFDDC                     20580094
205900                                      AEFFYYC                     20590094
206000             MOVE DP015-REVERSE    TO AEFFMMH                     20600094
206100                                      AEFFDDH                     20610094
206200                                      AEFFYYH                     20620094
206300             MOVE -1               TO AEFFMML                     20630094
206400         END-IF                                                   20640094
206500     END-IF.                                                      20650094
206600                                                                  20660094
206700*                                                                 20670094
206800*  DETERMINE THE SYSTEM DATES CURRENT AND PREV FISCAL MONTH/YEAR  20680094
206900*  THE PREV FISCAL MONTH/YEAR WILL BE DETERMINED BY SUBTRACTING 1 20690094
207000*  FROM THE FIRST DAY OF THE CURRENT FISCAL MONTH.                20700094
207100*                                                                 20710094
207200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              20720094
207300     SET DPG51-FISCAL-454-CALENDAR                                20730094
207400         DPG51-DO-NOT-INCR-DECR-DATE                              20740094
207500         DPG52-LK-DTE-ISO          TO TRUE.                       20750094
207600     MOVE DP017-CURRENT-DATE-YYYYMMDD                             20760094
207700                                   TO DPG52-LK-DATE-INPUT.        20770094
207800*    MOVE DP017-CURRENT-DATE-YMD   TO DPG51-SYSTEM-DATE.          20780094
207900                                                                  20790094
208000     CALL DP500-KOHLS-CALENDAR-ROUTINE USING                      20800094
208100                                DPG51 DPG52                       20810094
208200                                DPG53 DPG54                       20820094
208300                                DPG55 DPG56.                      20830094
208400                                                                  20840094
208500     IF DPG54-DATE-VALID                                          20850094
208600         MOVE DPG56-FISCAL-YEAR-NBR                               20860094
208700                                   TO PV-SYS-CURR-FISCAL-YEAR-NBR 20870094
208800         MOVE DPG56-FISCAL-PERIOD-NBR                             20880094
208900                                   TO PV-SYS-CURR-FISCAL-PER-NBR  20890094
209000         MOVE DPG56-FIRST-FP-DB2-ISO-FMT                          20900094
209100                                   TO PV-SYS-CURR-FIRST-FISCAL-DAY20910094
209200         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           20920094
209300         SET DPG51-FISCAL-454-CALENDAR                            20930094
209400             DPG51-DECREMENT-DATE                                 20940094
209500             DPG52-LK-DTE-ISO-FMT  TO TRUE                        20950094
209600         MOVE 1                    TO DPG51-INCR-DECR-DAYS-9      20960094
209700         MOVE PV-SYS-CURR-FIRST-FISCAL-DAY                        20970094
209800                                   TO DPG52-LK-DATE-INPUT         20980094
209900*        MOVE DP017-CURRENT-DATE-YMD                              20990094
210000*                                  TO DPG51-SYSTEM-DATE           21000094
210100                                                                  21010094
210200         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  21020094
210300                                    DPG51 DPG52                   21030094
210400                                    DPG53 DPG54                   21040094
210500                                    DPG55 DPG56                   21050094
210600                                                                  21060094
210700         IF DPG54-DATE-VALID                                      21070094
210800             MOVE DPG56-FISCAL-YEAR-NBR                           21080094
210900                                   TO PV-SYS-PREV-FISCAL-YEAR-NBR 21090094
211000             MOVE DPG56-FISCAL-PERIOD-NBR                         21100094
211100                                   TO PV-SYS-PREV-FISCAL-PER-NBR  21110094
211200         ELSE                                                     21120094
211300             SET DP013-OTHER-ABEND                                21130094
211400                 DP013-ROLLBACK    TO TRUE                        21140094
211500             MOVE '3025-EDIT-HEADER-INFO'                         21150094
211600                                   TO DP013-PARAGRAPH             21160094
211700             MOVE SQLCA            TO DP013-SQLCA                 21170094
211800             MOVE DPG54-ERROR-MESSAGE                             21180094
211900                                   TO DP013-MESSAGE-TEXT(1)       21190094
212000             MOVE 'FIND SYS PREV FISCAL DATES'                    21200094
212100                                   TO DP013-MESSAGE-TEXT(2)       21210094
212200             PERFORM DP013-0000-PROCESS-ABEND                     21220094
212300         END-IF                                                   21230094
212400     ELSE                                                         21240094
212500         SET DP013-OTHER-ABEND                                    21250094
212600             DP013-ROLLBACK        TO TRUE                        21260094
212700         MOVE '3025-EDIT-HEADER-INFO'                             21270094
212800                                   TO DP013-PARAGRAPH             21280094
212900         MOVE SQLCA                TO DP013-SQLCA                 21290094
213000         MOVE DPG54-ERROR-MESSAGE  TO DP013-MESSAGE-TEXT(1)       21300094
213100         MOVE 'FIND SYS CURR FISCAL DATES'                        21310094
213200                                   TO DP013-MESSAGE-TEXT(2)       21320094
213300         PERFORM DP013-0000-PROCESS-ABEND                         21330094
213400     END-IF.                                                      21340094
213500                                                                  21350094
213600     IF PS-EFF-DATE-ENTERED                                       21360094
213700         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           21370094
213800*        MOVE DP017-CURRENT-DATE-YMD                              21380094
213900*                                  TO DPG51-SYSTEM-DATE           21390094
214000         MOVE ASC-EFFECTIVE-DATE   TO DPG52-LK-DATE-INPUT         21400094
214100         SET DPG52-LK-DTE-GREG                                    21410094
214200             DPG51-FISCAL-454-CALENDAR                            21420094
214300             DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                  21430094
214400         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  21440094
214500                                    DPG51 DPG52                   21450094
214600                                    DPG53 DPG54                   21460094
214700                                    DPG55 DPG56                   21470094
214800         EVALUATE TRUE                                            21480094
214900             WHEN DPG54-SEVERE-ERROR                              21490094
215000             WHEN DPG54-DATE-INVALID                              21500094
215100                 SET PS-ERROR                                     21510094
215200                     DP020-MSG-FATAL                              21520094
215300                     DP030-SET-CURSOR-APPL-1                      21530094
215400                     PS-EFF-DATE-NOT-ENTERED                      21540094
215500                                   TO TRUE                        21550094
215600*----PC-TSYMSG-00009 - INVALID DATE                               21560094
215700                 MOVE PC-TSYMSG-00009                             21570094
215800                                   TO DP020-MSG-NUMBER            21580094
215900                 MOVE DP015-UNP-ALP-BRT-OFF                       21590094
216000                                   TO AEFFMMA                     21600094
216100                                      AEFFDDA                     21610094
216200                                      AEFFYYA                     21620094
216300                 MOVE DP015-RED    TO AEFFMMC                     21630094
216400                                      AEFFDDC                     21640094
216500                                      AEFFYYC                     21650094
216600                 MOVE DP015-REVERSE                               21660094
216700                                   TO AEFFMMH                     21670094
216800                                      AEFFDDH                     21680094
216900                                      AEFFYYH                     21690094
217000                 MOVE -1           TO AEFFMML                     21700094
217100             WHEN OTHER                                           21710094
217200                 MOVE DPG55-GREG-DATE                             21720094
217300                                   TO ASC-EFFECTIVE-DATE          21730094
217400                 MOVE DPG55-DB2-ISO-DATE-FMT                      21740094
217500                                   TO ASC-EFFECTIVE-DATE-ISO      21750094
217600*                                                                 21760094
217700*  THE COMPLETED BY DATE MUST BE WITHIN THE CURRENT OR LAST FISCAL21770094
217800*  YEAR/MONTH.                                                    21780094
217900*                                                                 21790094
218000                 IF  (DPG56-FISCAL-YEAR-NBR =                     21800094
218100                                   PV-SYS-CURR-FISCAL-YEAR-NBR    21810094
218200                 AND  DPG56-FISCAL-PERIOD-NBR =                   21820094
218300                                   PV-SYS-CURR-FISCAL-PER-NBR)    21830094
218400                     CONTINUE                                     21840094
218500                 ELSE                                             21850094
218600                     IF  (DPG56-FISCAL-YEAR-NBR =                 21860094
218700                               PV-SYS-PREV-FISCAL-YEAR-NBR        21870094
218800                     AND  DPG56-FISCAL-PERIOD-NBR =               21880094
218900                               PV-SYS-PREV-FISCAL-PER-NBR)        21890094
219000                         CONTINUE                                 21900094
219100                     ELSE                                         21910094
219200                         SET PS-ERROR                             21920094
219300                             DP030-SET-CURSOR-APPL-1              21930094
219400                             PS-EFF-DATE-NOT-ENTERED              21940094
219500                             DP020-MSG-FATAL TO TRUE              21950094
219600                         MOVE PC-TSYMSG-00292                     21960094
219700                                      TO DP020-MSG-NUMBER         21970094
219800                         MOVE DP015-UNP-NUM-BRT-OFF               21980094
219900                                      TO AEFFMMA                  21990094
220000                                         AEFFDDA                  22000094
220100                                         AEFFYYA                  22010094
220200                         MOVE DP015-RED                           22020094
220300                                      TO AEFFMMC                  22030094
220400                                         AEFFDDC                  22040094
220500                                         AEFFYYC                  22050094
220600                         MOVE DP015-REVERSE                       22060094
220700                                      TO AEFFMMH                  22070094
220800                                         AEFFDDH                  22080094
220900                                         AEFFYYH                  22090094
221000                         MOVE -1  TO AEFFMML                      22100094
221100                     END-IF                                       22110094
221200                 END-IF                                           22120094
221300         END-EVALUATE                                             22130094
221400     END-IF.                                                      22140094
221500*                                                                 22150094
221600*  THE COMPLETED BY DATE CANNOT BE A FUTURE DATE.  IF IT IS, WHEN 22160094
221700*  PASSED TO LEDGER, WILL BE DROPPED BY THE EDITS                 22170094
221800*                                                                 22180094
221900     IF PS-EFF-DATE-ENTERED                                       22190094
222000         IF ASC-EFFECTIVE-DATE-ISO > DP017-EDITED-DATE-YYYYMMDD   22200094
222100             SET PS-ERROR                                         22210094
222200                 DP030-SET-CURSOR-APPL-1                          22220094
222300                 PS-EFF-DATE-NOT-ENTERED                          22230094
222400                 DP020-MSG-FATAL   TO TRUE                        22240094
222500             MOVE PC-TSYMSG-00396  TO DP020-MSG-NUMBER            22250094
222600             MOVE DP015-UNP-NUM-BRT-OFF                           22260094
222700                                   TO AEFFMMA                     22270094
222800                                      AEFFDDA                     22280094
222900                                      AEFFYYA                     22290094
223000             MOVE DP015-RED        TO AEFFMMC                     22300094
223100                                      AEFFDDC                     22310094
223200                                      AEFFYYC                     22320094
223300             MOVE DP015-REVERSE    TO AEFFMMH                     22330094
223400                                      AEFFDDH                     22340094
223500                                      AEFFYYH                     22350094
223600             MOVE -1               TO AEFFMML                     22360094
223700         END-IF                                                   22370094
223800     END-IF.                                                      22380094
223900                                                                  22390094
224000*                                                                 22400094
224100 EJECT                                                            22410094
224200*----------------------------------------------------------------*22420094
224300*  THE SKU AND UPC ARE ONLY EDITED WHEN THEY WERE NOT GENERATED  *22430094
224400*  THRU THE INVENTORY MISSED MARKDOWNS BATCH PROCESSING.         *22440094
224500*----------------------------------------------------------------*22450094
224600                                                                  22460094
224700 3075-EDIT-SKU-UPC.                                               22470094
224800                                                                  22480094
224900     PERFORM 3100-SET-SUBSCRIPTS.                                 22490094
225000     SET PS-NO-CHECK-FOR-DELETED-LINES                            22500094
225100                                   TO TRUE.                       22510094
225200     PERFORM                                                      22520094
225300         VARYING ASC-ITEM-SUB                                     22530094
225400         FROM 1 BY 1                                              22540094
225500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                  22550094
225600             IF (ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES  22560094
225700             AND ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES)     22570094
225800                 IF (ASC-SKU-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB)   22580094
225900                 OR  ASC-UPC-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB))  22590094
226000                     SET PS-CHECK-FOR-DELETED-LINES               22600094
226100                                   TO TRUE                        22610094
226200                 ELSE                                             22620094
226300                     MOVE ASC-ITEM-SUB TO PV-HOLD-ITEM-SUB        22630094
226400                     ADD +1            TO PV-HOLD-ITEM-SUB        22640094
226500                     IF PV-HOLD-ITEM-SUB > PC-ITEMS-PER-PANEL     22650094
226600                         CONTINUE                                 22660094
226700                     ELSE                                         22670094
226800                         IF (ASC-SKU-NBR                          22680094
226900                         (ASC-BLK-SUB PV-HOLD-ITEM-SUB) = SPACES  22690094
227000                         AND ASC-UPC                              22700094
227100                         (ASC-BLK-SUB PV-HOLD-ITEM-SUB) = SPACES) 22710094
227200                             CONTINUE                             22720094
227300                         ELSE                                     22730094
227400*  THIS MEANS THAT THEY SKIPPED ONE LINE WHEN ENTERING THE LINES  22740094
227500                             SET PS-CHECK-FOR-DELETED-LINES       22750094
227600                                   TO TRUE                        22760094
227700                         END-IF                                   22770094
227800                     END-IF                                       22780094
227900                 END-IF                                           22790094
228000             END-IF                                               22800094
228100     END-PERFORM.                                                 22810094
228200                                                                  22820094
228300     MOVE +1                       TO ASC-ITEM-SUB                22830094
228400     IF PS-CHECK-FOR-DELETED-LINES                                22840094
228500         PERFORM 6000-CHECK-FOR-DELETED-LINES                     22850094
228600         IF PV-ROWS-WRITTEN-TO-LQW = +0                           22860094
228700             MOVE +0               TO ASC-LAST-LIST-ITEM-NUMBER   22870094
228800         END-IF                                                   22880094
228900     END-IF.                                                      22890094
229000 EJECT                                                            22900094
229100*----------------------------------------------------------------*22910094
229200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *22920094
229300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*22930094
229400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *22940094
229500*                                                                *22950094
229600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *22960094
229700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *22970094
229800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *22980094
229900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *22990094
230000*----------------------------------------------------------------*23000094
230100                                                                  23010094
230200 3100-SET-SUBSCRIPTS.                                             23020094
230300                                                                  23030094
230400     COMPUTE ASC-ITEM-SUB =                                       23040094
230500         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        23050094
230600                                                                  23060094
230700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         23070094
336500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            33650094
336600                                                                  33660094
336700         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               33670094
336800     ELSE                                                         33680094
336900         MOVE +1                     TO ASC-BLK-SUB               33690094
337000     END-IF.                                                      33700094
337100*                                                                 33710094
337200 EJECT                                                            33720094
337300*----------------------------------------------------------------*33730094
337400*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *33740094
337500*----------------------------------------------------------------*33750094
337600                                                                  33760094
337700 3200-RESET-ATTRIBUTES.                                           33770094
337800                                                                  33780094
337900     MOVE ASC-REASON-CODE          TO PV-HOLD-TYPE-REASON-CODE.   33790094
338000     IF PV-HOLD-REASON-CODE IS NUMERIC                            33800094
338100         MOVE PV-HOLD-REASON-CODE  TO PE049-WORKING-INSTR-RSN-CDE 33810094
338200     END-IF.                                                      33820094
338300     MOVE PV-HOLD-TYPE-CODE        TO PE049-WORKING-TYPE-CDE.     33830094
338400     MOVE ASC-STATUS-CODE          TO                             33840094
338500                                   PE049-WORKING-INSTR-STATUS-CDE.33850094
338600                                                                  33860094
338700     IF  PE049-IS-INVENTORY-MISSED-RSN                            33870094
338800     AND PE049-MARKDOWN                                           33880094
338900         MOVE DP015-PRO-NOR-OFF    TO ARSNA                       33890094
339000                                      AEFFMMA                     33900094
339100                                      AEFFDDA                     33910094
339200                                      AEFFYYA                     33920094
339300                                      ADPTARA                     33930094
339400         MOVE DP015-BLUE           TO ARSNC                       33940094
339500                                      AEFFMMC                     33950094
339600                                      AEFFDDC                     33960094
339700                                      AEFFYYC                     33970094
339800                                      ADPTARC                     33980094
339900         MOVE DP015-HL-OFF         TO ARSNH                       33990094
340000                                      AEFFMMH                     34000094
340100                                      AEFFDDH                     34010094
340200                                      AEFFYYH                     34020094
340300                                      ADPTARH                     34030094
340400         PERFORM                                                  34040094
340500             VARYING PV-SUB                                       34050094
340600             FROM 1 BY 1                                          34060094
340700             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    34070094
340800             MOVE DP015-PRO-NOR-OFF TO                            34080094
340900                                      MR-SKUA   (PV-SUB)          34090094
341000                                      MR-UPCA   (PV-SUB)          34100094
341100             MOVE DP015-BLUE       TO MR-SKUC   (PV-SUB)          34110094
341200                                      MR-UPCC   (PV-SUB)          34120094
341300             MOVE DP015-HL-OFF     TO MR-SKUH   (PV-SUB)          34130094
341400                                      MR-UPCH   (PV-SUB)          34140094
341500         END-PERFORM                                              34150094
341600     ELSE                                                         34160094
341700         MOVE DP015-UNP-ALP-NOR-OFF                               34170094
341800                                   TO ARSNA                       34180094
341900                                      AEFFMMA                     34190094
342000                                      AEFFDDA                     34200094
342100                                      AEFFYYA                     34210094
342200                                      ADPTARA                     34220094
342300         MOVE DP015-GREEN          TO ARSNC                       34230094
342400                                      AEFFMMC                     34240094
342500                                      AEFFDDC                     34250094
342600                                      AEFFYYC                     34260094
342700                                      ADPTARC                     34270094
342800         MOVE DP015-UNDERLINE      TO ARSNH                       34280094
342900                                      AEFFMMH                     34290094
343000                                      AEFFDDH                     34300094
343100                                      AEFFYYH                     34310094
343200                                      ADPTARH                     34320094
343300         PERFORM                                                  34330094
343400             VARYING PV-SUB                                       34340094
343500             FROM 1 BY 1                                          34350094
343600             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    34360094
343700             MOVE DP015-UNP-ALP-NOR-OFF TO                        34370094
343800                                      MR-SKUA   (PV-SUB)          34380094
343900                                      MR-UPCA   (PV-SUB)          34390094
344000             MOVE DP015-GREEN      TO MR-SKUC   (PV-SUB)          34400094
344100                                      MR-UPCC   (PV-SUB)          34410094
344200             MOVE DP015-UNDERLINE  TO MR-SKUH   (PV-SUB)          34420094
344300                                      MR-UPCH   (PV-SUB)          34430094
344400         END-PERFORM                                              34440094
344500     END-IF.                                                      34450094
344600                                                                  34460094
344700     MOVE DP015-UNP-ALP-NOR-OFF    TO MR-TOTAL-QUANTITYA          34470094
344800                                      AEFFNMA.                    34480094
344900     MOVE DP015-GREEN              TO MR-TOTAL-QUANTITYC          34490094
345000                                      AEFFNMC.                    34500094
345100     MOVE DP015-UNDERLINE          TO MR-TOTAL-QUANTITYH          34510094
345200                                      AEFFNMH.                    34520094
345300*                                                                 34530094
345400     PERFORM                                                      34540094
345500         VARYING PV-SUB                                           34550094
345600         FROM 1 BY 1                                              34560094
345700         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        34570094
345800         MOVE DP015-UNP-ALP-NOR-OFF                               34580094
345900                                   TO MR-ORIG-PRICEA (PV-SUB)     34590094
346000                                      MR-NEW-PRICEA  (PV-SUB)     34600094
346100                                      MR-PRICE-DIFFA (PV-SUB)     34610094
346200                                      MR-QUANTITYA   (PV-SUB)     34620094
346300         MOVE DP015-GREEN          TO MR-ORIG-PRICEC (PV-SUB)     34630094
346400                                      MR-NEW-PRICEC  (PV-SUB)     34640094
346500                                      MR-PRICE-DIFFC (PV-SUB)     34650094
346600                                      MR-QUANTITYC   (PV-SUB)     34660094
346700         MOVE DP015-UNDERLINE      TO MR-ORIG-PRICEH (PV-SUB)     34670094
346800                                      MR-NEW-PRICEH  (PV-SUB)     34680094
346900                                      MR-PRICE-DIFFH (PV-SUB)     34690094
347000                                      MR-QUANTITYH   (PV-SUB)     34700094
347100     END-PERFORM.                                                 34710094
347200*                                                                 34720094
347300 EJECT                                                            34730094
347400*----------------------------------------------------------------*34740094
347500*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *34750094
347600*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *34760094
347700*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *34770094
347800*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *34780094
347900*----------------------------------------------------------------*34790094
348000 3300-EDIT-SELECTIONS.                                            34800094
348100     SET PS-SKU-NOT-ENTERED-VALID                                 34810094
348200         PS-UPC-NOT-ENTERED-VALID  TO TRUE.                       34820094
348300     MOVE ASC-REASON-CODE          TO PV-HOLD-TYPE-REASON-CODE.   34830094
348400                                                                  34840094
348500     IF ASC-SKU-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB)                34850094
348600        IF ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES        34860094
348700           IF ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZEROS  34870094
348800               MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)        34880094
348900                                  TO DP010I-UNEDITED-FIELD        34890094
349000               MOVE LENGTH OF ASC-SKU-NBR                         34900094
349100                             (ASC-BLK-SUB ASC-ITEM-SUB)           34910094
349200                                     TO DP010I-MAXIMUM-DIGITS     34920094
349300               MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS   34930094
349400               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE            34940094
349510               CALL DP010I-NUMERIC-EDIT-ROUTINE                   34951096
349520                         USING DP010I-NUMERIC-EDIT-AREA           34952096
349600               IF  DP010I-ERROR-DETECTED                          34960094
349700                   IF PS-NO-ERROR                                 34970094
349800                      SET PS-ERROR TO TRUE                        34980094
349900*----PC-TSYMSG-00008 - MUST BE NUMERIC                            34990094
350000                      MOVE PC-TSYMSG-00008                        35000094
350100                                     TO DP020-MSG-NUMBER          35010094
350200                       MOVE -1       TO MR-SKUL (PV-SUB)          35020094
350300                   END-IF                                         35030094
350400                   MOVE DP015-UNP-ALP-BRT-OFF                     35040094
350500                                     TO MR-SKUA (PV-SUB)          35050094
350600                   MOVE DP015-RED    TO MR-SKUC (PV-SUB)          35060094
350700                   MOVE DP015-REVERSE                             35070094
350800                                     TO MR-SKUH (PV-SUB)          35080094
350900               ELSE                                               35090094
351000                   MOVE DP010I-NUMERIC-FIELD                      35100094
351100                                     TO PV-WORK-SKU               35110094
351200                   MOVE PV-WORK-SKU  TO ASC-SKU-NBR               35120094
351300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35130094
351400                   IF ASC-SKU-NBR(ASC-BLK-SUB ASC-ITEM-SUB)       35140094
351500                       (6:3) = 000                                35150094
351600                      PERFORM 8460-VALIDATE-DEPT-CLASS            35160094
351700                      IF PS-VALID-DEPT-CLASS                      35170094
351800                         SET PS-SKU-ENTERED-VALID TO TRUE         35180094
351900                      ELSE                                        35190094
352000                         IF PS-NO-ERROR                           35200094
352100                            SET PS-ERROR TO TRUE                  35210094
352200*----PC-TSYMSG-00110 - DEPT/CLASS DOESN'T EXIST                   35220094
352300                            MOVE PC-TSYMSG-00110                  35230094
352400                               TO DP020-MSG-NUMBER                35240094
352500                            MOVE -1 TO MR-SKUL (PV-SUB)           35250094
352600                         END-IF                                   35260094
352700                         MOVE DP015-UNP-ALP-BRT-OFF               35270094
352800                               TO MR-SKUA (PV-SUB)                35280094
352900                         MOVE DP015-RED     TO MR-SKUC (PV-SUB)   35290094
353000                         MOVE DP015-REVERSE TO MR-SKUH (PV-SUB)   35300094
353100                      END-IF                                      35310094
353200                   ELSE                                           35320094
353300                         SET PS-SKU-ENTERED-VALID TO TRUE         35330094
353400                   END-IF                                         35340094
353500               END-IF                                             35350094
353600           ELSE                                                   35360094
353700              IF PS-NO-ERROR                                      35370094
353800                 SET PS-ERROR TO TRUE                             35380094
353900*----PC-TSYMSG-00110 - DEPT/CLASS DOESN'T EXIST                   35390094
354000                 MOVE PC-TSYMSG-00110                             35400094
354100                              TO DP020-MSG-NUMBER                 35410094
354200                 MOVE -1 TO MR-SKUL (PV-SUB)                      35420094
354300                 MOVE DP015-UNP-ALP-BRT-OFF                       35430094
354400                              TO MR-SKUA (PV-SUB)                 35440094
354500                 MOVE DP015-RED     TO MR-SKUC (PV-SUB)           35450094
354600                 MOVE DP015-REVERSE TO MR-SKUH (PV-SUB)           35460094
354700              END-IF                                              35470094
354800           END-IF                                                 35480094
354900        END-IF                                                    35490094
355000     ELSE                                                         35500094
355100        IF ASC-SKU-NBR                                            35510094
355200           (ASC-BLK-SUB ASC-ITEM-SUB) (6:3) = 000                 35520094
355300           PERFORM 8460-VALIDATE-DEPT-CLASS                       35530094
355400           IF PS-VALID-DEPT-CLASS                                 35540094
355500              SET PS-SKU-ENTERED-VALID TO TRUE                    35550094
355600           END-IF                                                 35560094
355700        ELSE                                                      35570094
355800          IF ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES      35580094
355900             SET PS-SKU-ENTERED-VALID TO TRUE                     35590094
356000           END-IF                                                 35600094
356100        END-IF                                                    35610094
356200     END-IF.                                                      35620094
356300                                                                  35630094
356400     IF ASC-UPC-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB) OR             35640094
356500        ASC-SKU-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB)                35650094
356600        SET PS-UPC-ENTERED-VALID TO TRUE                          35660094
356700        MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)                   35670094
356800                        TO DP010I-UNEDITED-FIELD                  35680094
356900        MOVE LENGTH OF ASC-UPC                                    35690094
357000                        (ASC-BLK-SUB ASC-ITEM-SUB)                35700094
357100                        TO DP010I-MAXIMUM-DIGITS                  35710094
357200        MOVE ZERO       TO DP010I-MAXIMUM-DECIMALS                35720094
357300        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   35730094
357410        CALL DP010I-NUMERIC-EDIT-ROUTINE                          35741096
357420                         USING DP010I-NUMERIC-EDIT-AREA           35742096
357500        IF PS-SKU-ENTERED-VALID                                   35750094
357600           IF DP010I-ERROR-DETECTED                               35760094
357700              IF PS-NO-ERROR                                      35770094
357800                 SET PS-ERROR TO TRUE                             35780094
357900*----PC-TSYMSG-00008 - MUST BE NUMERIC                            35790094
358000                 MOVE PC-TSYMSG-00008                             35800094
358100                       TO DP020-MSG-NUMBER                        35810094
358200                 MOVE -1       TO MR-UPCL (PV-SUB)                35820094
358300              END-IF                                              35830094
358400              MOVE DP015-UNP-ALP-BRT-OFF                          35840094
358500                       TO MR-UPCA (PV-SUB)                        35850094
358600              MOVE DP015-RED    TO MR-UPCC (PV-SUB)               35860094
358700              MOVE DP015-REVERSE                                  35870094
358800                       TO MR-UPCH (PV-SUB)                        35880094
358900           ELSE                                                   35890094
359000              INITIALIZE SKXREF-SKU                               35900094
359100                         SKXREF-ITM-NBR                           35910094
359200                         UPC-UPC-NBR                              35920094
359300              PERFORM 3320-MOVE-SKU                               35930094
359400           END-IF                                                 35940094
359500        ELSE                                                      35950094
359600           IF ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES     35960094
359700              MOVE DP010I-NUM-FIELD-13-DIG-4-DEC                  35970094
359800                   TO ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)        35980094
359900                      UPC-UPC-NBR                                 35990094
360000              SET PS-INVALID-UPC TO TRUE                          36000094
360100              PERFORM 8450-DETERMINE-SKU                          36010094
360200              IF PS-VALID-UPC                                     36020094
360300                 SET PS-UPC-ENTERED-VALID TO TRUE                 36030094
360400                PERFORM 3320-MOVE-SKU                             36040094
360500              END-IF                                              36050094
360600           END-IF                                                 36060094
360700        END-IF                                                    36070094
360800     END-IF.                                                      36080094
360900                                                                  36090094
361000     IF (ASC-PRICE-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB)             36100094
361100     AND PS-UPC-NOT-ENTERED-VALID                                 36110094
361200     AND PS-SKU-NOT-ENTERED-VALID)                                36120094
361300         IF (ASC-ORIGINAL-PRICE-DISP                              36130094
361400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36140094
361500                                                     = SPACES     36150094
361600         AND ASC-NEW-PRICE-DISP  (ASC-BLK-SUB ASC-ITEM-SUB)       36160094
361700                                                     = SPACES     36170094
361800         AND ASC-PRICE-DIFF-DISP (ASC-BLK-SUB ASC-ITEM-SUB)       36180094
361900                                                     = SPACES)    36190094
362000             SET ASC-PRICE-NOT-CHANGED                            36200094
362100                         (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE       36210094
362200         ELSE                                                     36220094
362300             IF PS-NO-ERROR                                       36230094
362400                 SET PS-ERROR TO TRUE                             36240094
362500*----PC-TSYMSG-00007 - REQUIRED ENTRY                             36250094
362600                 MOVE PC-TSYMSG-00007                             36260094
362700                                   TO DP020-MSG-NUMBER            36270094
362800                 MOVE -1           TO MR-SKUL (PV-SUB)            36280094
362900                 MOVE DP015-UNP-ALP-BRT-OFF                       36290094
363000                                   TO MR-SKUA (PV-SUB)            36300094
363100                                      MR-UPCA (PV-SUB)            36310094
363200                 MOVE DP015-RED    TO MR-SKUC (PV-SUB)            36320094
363300                                      MR-UPCC (PV-SUB)            36330094
363400                 MOVE DP015-REVERSE                               36340094
363500                                   TO MR-SKUH (PV-SUB)            36350094
363600                                      MR-UPCH (PV-SUB)            36360094
363700             END-IF                                               36370094
363800         END-IF                                                   36380094
363900     END-IF.                                                      36390094
364000                                                                  36400094
364100     SET PS-DONT-ENTER-MISSED-MKDN-DATA                           36410094
364200                                  TO TRUE.                        36420094
364300                                                                  36430094
364400     IF  (PS-UPC-ENTERED-VALID                                    36440094
364500      OR (ASC-PRICE-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB)))          36450094
364600         IF ASC-ORIGINAL-PRICE-DISP (ASC-BLK-SUB ASC-ITEM-SUB)    36460094
364700                                                      > SPACES    36470094
364800             MOVE ASC-ORIGINAL-PRICE-DISP                         36480094
364900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36490094
365000                                   TO DP010I-UNEDITED-FIELD       36500094
365100             MOVE PC-5             TO DP010I-MAXIMUM-DIGITS       36510094
365200             MOVE +2               TO DP010I-MAXIMUM-DECIMALS     36520094
365300             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              36530094
365400             CALL DP010I-NUMERIC-EDIT-ROUTINE                     36540096
365410                         USING DP010I-NUMERIC-EDIT-AREA           36541096
365500             IF  DP010I-ERROR-DETECTED                            36550094
365600                 IF PS-NO-ERROR                                   36560094
365700                     SET PS-ERROR TO TRUE                         36570094
365800*----PC-TSYMSG-00343 - MUST BE NUMERIC, NON-NEGATIVE, AND WITHIN  36580094
365900*----                  THE SIZE CONSTRAINT                        36590094
366000                     MOVE PC-TSYMSG-00343                         36600094
366100                                   TO DP020-MSG-NUMBER            36610094
366200                     MOVE -1       TO MR-ORIG-PRICEL (PV-SUB)     36620094
366300                 END-IF                                           36630094
366400                 SET ASC-ORIGINAL-PRICE-ERROR                     36640094
366500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36650094
366600                                   TO TRUE                        36660094
366700                 MOVE DP015-UNP-ALP-BRT-OFF                       36670094
366800                                   TO MR-ORIG-PRICEA (PV-SUB)     36680094
366900                 MOVE DP015-RED    TO MR-ORIG-PRICEC (PV-SUB)     36690094
367000                 MOVE DP015-REVERSE                               36700094
367100                                   TO MR-ORIG-PRICEH (PV-SUB)     36710094
367200             ELSE                                                 36720094
367300                 SET ASC-NO-ORIGINAL-PRICE-ERROR                  36730094
367400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36740094
367500                                   TO TRUE                        36750094
367600                 MOVE DP010I-NUMERIC-FIELD                        36760094
367700                                   TO ASC-ORIGINAL-PRICE          36770094
367800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36780094
367900                 IF  PE049-IS-INVENTORY-MISSED-RSN                36790094
368000                 AND PE049-MARKDOWN                               36800094
368100                     IF ASC-ORIGINAL-PRICE                        36810094
368200                                        (ASC-BLK-SUB ASC-ITEM-SUB)36820094
368300                        = ZERO                                    36830094
368400                         SET PS-DONT-ENTER-MISSED-MKDN-DATA       36840094
368500                                                           TO TRUE36850094
368600                     ELSE                                         36860094
368700                         SET PS-ENTER-MISSED-MKDN-DATA     TO TRUE36870094
368800                         PERFORM 8900-SELECT-CURRENT-RETAIL       36880094
368900                         IF TSK-REGN-PRIC-IND = 'Y'               36890094
369000                             PERFORM 8910-SELECT-REGN-RETAIL      36900094
369100                         END-IF                                   36910094
369200                         IF ASC-ORIGINAL-PRICE                    36920094
369300                                        (ASC-BLK-SUB ASC-ITEM-SUB)36930094
369400                             > TSK-CUR-UNIT-RTL-AMT               36940094
369500                             CONTINUE                             36950094
369600                         ELSE                                     36960094
369700                             IF PS-NO-ERROR                       36970094
369800                                 SET PS-ERROR TO TRUE             36980094
369900* --- ORIG RETAIL LESS/EQUAL TO CURR RETAIL;REFER TO INV MANUAL   36990094
370000                                 MOVE PC-TSYMSG-00979             37000094
370100                                        TO DP020-MSG-NUMBER       37010094
370200                                 MOVE -1                          37020094
370300                                        TO MR-ORIG-PRICEL (PV-SUB)37030094
370400                             END-IF                               37040094
370500                             MOVE DP015-UNP-ALP-BRT-OFF           37050094
370600                                   TO MR-ORIG-PRICEA (PV-SUB)     37060094
370700                             MOVE DP015-RED                       37070094
370800                                        TO MR-ORIG-PRICEC (PV-SUB)37080094
370900                             MOVE DP015-REVERSE                   37090094
371000                                        TO MR-ORIG-PRICEH (PV-SUB)37100094
371100                         END-IF                                   37110094
371200                     END-IF                                       37120094
371300                 END-IF                                           37130094
371400             END-IF                                               37140094
371500         ELSE                                                     37150094
371600             SET ASC-ORIGINAL-PRICE-ERROR                         37160094
371700                                (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE37170094
371800             IF  PE049-IS-INVENTORY-MISSED-RSN                    37180094
371900             AND PE049-MARKDOWN                                   37190094
372000                 MOVE ZERO TO ASC-ORIGINAL-PRICE                  37200094
372100                                (ASC-BLK-SUB ASC-ITEM-SUB)        37210094
372200                 SET PS-DONT-ENTER-MISSED-MKDN-DATA TO TRUE       37220094
372300             ELSE                                                 37230094
372400                 IF PS-NO-ERROR                                   37240094
372500                     SET PS-ERROR TO TRUE                         37250094
372600*----PC-TSYMSG-00007 - REQUIRED ENTRY                             37260094
372700                     MOVE PC-TSYMSG-00007                         37270094
372800                                   TO DP020-MSG-NUMBER            37280094
372900                     MOVE -1       TO MR-ORIG-PRICEL (PV-SUB)     37290094
373000                 END-IF                                           37300094
373100                 MOVE DP015-UNP-ALP-BRT-OFF                       37310094
373200                                   TO MR-ORIG-PRICEA (PV-SUB)     37320094
373300                 MOVE DP015-RED    TO MR-ORIG-PRICEC (PV-SUB)     37330094
373400                 MOVE DP015-REVERSE                               37340094
373500                                   TO MR-ORIG-PRICEH (PV-SUB)     37350094
373600             END-IF                                               37360094
373700         END-IF                                                   37370094
373800*                                                                 37380094
373900         IF ASC-NEW-PRICE-DISP (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES37390094
374000             MOVE ASC-NEW-PRICE-DISP (ASC-BLK-SUB ASC-ITEM-SUB)   37400094
374100                                   TO DP010I-UNEDITED-FIELD       37410094
374200*            MOVE PC-4             TO DP010I-MAXIMUM-DIGITS       37420094
374300             MOVE PC-5             TO DP010I-MAXIMUM-DIGITS       37430094
374400             MOVE +2               TO DP010I-MAXIMUM-DECIMALS     37440094
374500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              37450094
374600             CALL DP010I-NUMERIC-EDIT-ROUTINE                     37460096
374610                         USING DP010I-NUMERIC-EDIT-AREA           37461096
374700             IF  DP010I-ERROR-DETECTED                            37470094
374800                 IF PS-NO-ERROR                                   37480094
374900                     SET PS-ERROR TO TRUE                         37490094
375000*----PC-TSYMSG-00343 - MUST BE NUMERIC, NON-NEGATIVE, AND WITHIN  37500094
375100*----                  THE SIZE CONSTRAINT                        37510094
375200                     MOVE PC-TSYMSG-00343 TO DP020-MSG-NUMBER     37520094
375300                     MOVE -1             TO MR-NEW-PRICEL (PV-SUB)37530094
375400                 END-IF                                           37540094
375500                 SET ASC-NEW-PRICE-ERROR                          37550094
375600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 37560094
375700                                    TO TRUE                       37570094
375800                 MOVE DP015-UNP-ALP-BRT-OFF                       37580094
375900                                    TO MR-NEW-PRICEA (PV-SUB)     37590094
376000                 MOVE DP015-RED     TO MR-NEW-PRICEC (PV-SUB)     37600094
376100                 MOVE DP015-REVERSE TO MR-NEW-PRICEH (PV-SUB)     37610094
376200             ELSE                                                 37620094
376300                 SET ASC-NO-NEW-PRICE-ERROR                       37630094
376400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   37640094
376500                                   TO TRUE                        37650094
376600                 MOVE DP010I-NUMERIC-FIELD                        37660094
376700                                   TO ASC-NEW-PRICE               37670094
376800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   37680094
376900                 IF  PE049-IS-INVENTORY-MISSED-RSN                37690094
377000                 AND PE049-MARKDOWN                               37700094
377100                     IF PS-ENTER-MISSED-MKDN-DATA                 37710094
377200                         IF ASC-NEW-PRICE                         37720094
377300                                        (ASC-BLK-SUB ASC-ITEM-SUB)37730094
377400                            = ZERO                                37740094
377500                             IF PS-NO-ERROR                       37750094
377600                                 SET PS-ERROR TO TRUE             37760094
377700*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     37770094
377800                                     MOVE PC-TSYMSG-00980         37780094
377900                                               TO DP020-MSG-NUMBER37790094
378000                                     MOVE -1                      37800094
378100                                         TO MR-NEW-PRICEL (PV-SUB)37810094
378200                             END-IF                               37820094
378300                             MOVE DP015-UNP-ALP-BRT-OFF           37830094
378400                                   TO MR-NEW-PRICEA (PV-SUB)      37840094
378500                             MOVE DP015-RED                       37850094
378600                                   TO MR-NEW-PRICEC (PV-SUB)      37860094
378700                             MOVE DP015-REVERSE                   37870094
378800                                   TO MR-NEW-PRICEH (PV-SUB)      37880094
378900                         END-IF                                   37890094
379000                     ELSE                                         37900094
379100                         IF PS-DONT-ENTER-MISSED-MKDN-DATA        37910094
379200                             IF ASC-NEW-PRICE                     37920094
379300                                        (ASC-BLK-SUB ASC-ITEM-SUB)37930094
379400                                NOT = ZERO                        37940094
379500                                 IF PS-NO-ERROR                   37950094
379600                                     SET PS-ERROR TO TRUE         37960094
379700*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     37970094
379800                                         MOVE PC-TSYMSG-00980     37980094
379900                                               TO DP020-MSG-NUMBER37990094
380000                                         MOVE -1                  38000094
380100                                         TO MR-NEW-PRICEL (PV-SUB)38010094
380200                                 END-IF                           38020094
380300                                 MOVE DP015-UNP-ALP-BRT-OFF       38030094
380400                                   TO MR-NEW-PRICEA (PV-SUB)      38040094
380500                                 MOVE DP015-RED                   38050094
380600                                   TO MR-NEW-PRICEC (PV-SUB)      38060094
380700                                 MOVE DP015-REVERSE               38070094
380800                                   TO MR-NEW-PRICEH (PV-SUB)      38080094
380900                             END-IF                               38090094
381000                         END-IF                                   38100094
381100                     END-IF                                       38110094
381200                 END-IF                                           38120094
381300             END-IF                                               38130094
381400         ELSE                                                     38140094
381500             SET ASC-NEW-PRICE-ERROR                              38150094
381600                         (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE       38160094
381700             IF  PE049-IS-INVENTORY-MISSED-RSN                    38170094
381800             AND PE049-MARKDOWN                                   38180094
381900                 IF PS-DONT-ENTER-MISSED-MKDN-DATA                38190094
382000                     MOVE ZERO     TO ASC-NEW-PRICE               38200094
382100                                        (ASC-BLK-SUB ASC-ITEM-SUB)38210094
382200                 ELSE                                             38220094
382300                     IF PS-NO-ERROR                               38230094
382400                         SET PS-ERROR TO TRUE                     38240094
382500*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     38250094
382600                         MOVE PC-TSYMSG-00980                     38260094
382700                                       TO DP020-MSG-NUMBER        38270094
382800                         MOVE -1       TO MR-NEW-PRICEL (PV-SUB)  38280094
382900                     END-IF                                       38290094
383000                     MOVE DP015-UNP-ALP-BRT-OFF                   38300094
383100                                        TO MR-NEW-PRICEA (PV-SUB) 38310094
383200                     MOVE DP015-RED     TO MR-NEW-PRICEC (PV-SUB) 38320094
383300                     MOVE DP015-REVERSE TO MR-NEW-PRICEH (PV-SUB) 38330094
383400                 END-IF                                           38340094
383500             ELSE                                                 38350094
383600                 IF PS-NO-ERROR                                   38360094
383700                     SET PS-ERROR TO TRUE                         38370094
383800*----PC-TSYMSG-00007 - REQUIRED ENTRY                             38380094
383900                     MOVE PC-TSYMSG-00007                         38390094
384000                                   TO DP020-MSG-NUMBER            38400094
384100                     MOVE -1       TO MR-NEW-PRICEL (PV-SUB)      38410094
384200                 END-IF                                           38420094
384300                 MOVE DP015-UNP-ALP-BRT-OFF                       38430094
384400                                    TO MR-NEW-PRICEA (PV-SUB)     38440094
384500                 MOVE DP015-RED     TO MR-NEW-PRICEC (PV-SUB)     38450094
384600                 MOVE DP015-REVERSE TO MR-NEW-PRICEH (PV-SUB)     38460094
384700             END-IF                                               38470094
384800         END-IF                                                   38480094
384900*                                                                 38490094
385000         IF (ASC-NO-ORIGINAL-PRICE-ERROR                          38500094
385100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   38510094
385200         AND ASC-NO-NEW-PRICE-ERROR  (ASC-BLK-SUB ASC-ITEM-SUB))  38520094
385300             MOVE ASC-REASON-CODE      TO PV-HOLD-TYPE-REASON-CODE38530094
385400             MOVE PV-HOLD-TYPE-CODE    TO PE049-WORKING-TYPE-CDE  38540094
385500             EVALUATE TRUE                                        38550094
385600                 WHEN PE049-MARKDOWN                              38560094
385700                 WHEN PE049-MARKUP-CANCEL                         38570094
385800                     IF ASC-ORIGINAL-PRICE                        38580094
385900                                        (ASC-BLK-SUB ASC-ITEM-SUB)38590094
386000                      < ASC-NEW-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)  38600094
386100                         IF PS-NO-ERROR                           38610094
386200                             SET PS-ERROR TO TRUE                 38620094
386300* --- PRICE ERROR ---                                             38630094
386400                             MOVE PC-TSYMSG-00600                 38640094
386500                                   TO DP020-MSG-NUMBER            38650094
386600                             MOVE -1   TO MR-NEW-PRICEL (PV-SUB)  38660094
386700                         END-IF                                   38670094
386800                         MOVE DP015-UNP-ALP-BRT-OFF               38680094
386900                                   TO MR-NEW-PRICEA (PV-SUB)      38690094
387000                         MOVE DP015-RED                           38700094
387100                                   TO MR-NEW-PRICEC (PV-SUB)      38710094
387200                         MOVE DP015-REVERSE                       38720094
387300                                   TO MR-NEW-PRICEH (PV-SUB)      38730094
387400                     END-IF                                       38740094
387500                 WHEN PE049-MARKUP                                38750094
387600                 WHEN PE049-MARKDOWN-CANCEL                       38760094
387700                     IF ASC-ORIGINAL-PRICE                        38770094
387800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38780094
387900                      > ASC-NEW-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)  38790094
388000                         IF PS-NO-ERROR                           38800094
388100                             SET PS-ERROR TO TRUE                 38810094
388200* --- PRICE ERROR ---                                             38820094
388300                             MOVE PC-TSYMSG-00602                 38830094
388400                                   TO DP020-MSG-NUMBER            38840094
388500                             MOVE -1   TO MR-NEW-PRICEL (PV-SUB)  38850094
388600                         END-IF                                   38860094
388700                         MOVE DP015-UNP-ALP-BRT-OFF               38870094
388800                                   TO MR-NEW-PRICEA (PV-SUB)      38880094
388900                         MOVE DP015-RED                           38890094
389000                                   TO MR-NEW-PRICEC (PV-SUB)      38900094
389100                         MOVE DP015-REVERSE                       38910094
389200                                   TO MR-NEW-PRICEH (PV-SUB)      38920094
389300                     END-IF                                       38930094
389400             END-EVALUATE                                         38940094
389500         END-IF                                                   38950094
389600                                                                  38960094
389700         IF ASC-PRICE-DIFF-DISP (ASC-BLK-SUB ASC-ITEM-SUB) > SPACE38970094
389800             MOVE ASC-PRICE-DIFF-DISP (ASC-BLK-SUB ASC-ITEM-SUB)  38980094
389900                                   TO DP010I-UNEDITED-FIELD       38990094
390000             MOVE PC-5             TO DP010I-MAXIMUM-DIGITS       39000094
390100             MOVE +2               TO DP010I-MAXIMUM-DECIMALS     39010094
390200             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              39020094
390300             CALL DP010I-NUMERIC-EDIT-ROUTINE                     39030096
390310                         USING DP010I-NUMERIC-EDIT-AREA           39031096
390400             IF  DP010I-ERROR-DETECTED                            39040094
390500                 IF PS-NO-ERROR                                   39050094
390600                     SET PS-ERROR TO TRUE                         39060094
390700*----PC-TSYMSG-00343 - MUST BE NUMERIC, NON-NEGATIVE, AND WITHIN  39070094
390800*----                  THE SIZE CONSTRAINT                        39080094
390900                     MOVE PC-TSYMSG-00343                         39090094
391000                                   TO DP020-MSG-NUMBER            39100094
391100                     MOVE -1       TO MR-PRICE-DIFFL (PV-SUB)     39110094
391200                 END-IF                                           39120094
391300                 SET ASC-PRICE-DIFF-ERROR                         39130094
391400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39140094
391500                                   TO TRUE                        39150094
391600                 MOVE DP015-UNP-ALP-BRT-OFF                       39160094
391700                                   TO MR-PRICE-DIFFA (PV-SUB)     39170094
391800                 MOVE DP015-RED    TO MR-PRICE-DIFFC (PV-SUB)     39180094
391900                 MOVE DP015-REVERSE                               39190094
392000                                   TO MR-PRICE-DIFFH (PV-SUB)     39200094
392100             ELSE                                                 39210094
392200                 SET ASC-NO-PRICE-DIFF-ERROR                      39220094
392300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39230094
392400                                   TO TRUE                        39240094
392500                 MOVE DP010I-NUMERIC-FIELD                        39250094
392600                                   TO ASC-PRICE-DIFF              39260094
392700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   39270094
392800                 IF  PE049-IS-INVENTORY-MISSED-RSN                39280094
392900                 AND PE049-MARKDOWN                               39290094
393000                     IF PS-ENTER-MISSED-MKDN-DATA                 39300094
393100                         IF ASC-PRICE-DIFF                        39310094
393200                                        (ASC-BLK-SUB ASC-ITEM-SUB)39320094
393300                            = ZERO                                39330094
393400                             IF PS-NO-ERROR                       39340094
393500                                 SET PS-ERROR TO TRUE             39350094
393600*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     39360094
393700                                 MOVE PC-TSYMSG-00980             39370094
393800                                           TO DP020-MSG-NUMBER    39380094
393900                                 MOVE -1 TO                       39390094
394000                                           MR-PRICE-DIFFL (PV-SUB)39400094
394100                             END-IF                               39410094
394200                             MOVE DP015-UNP-ALP-BRT-OFF           39420094
394300                                        TO MR-PRICE-DIFFA (PV-SUB)39430094
394400                             MOVE DP015-RED                       39440094
394500                                        TO MR-PRICE-DIFFC (PV-SUB)39450094
394600                             MOVE DP015-REVERSE                   39460094
394700                                        TO MR-PRICE-DIFFH (PV-SUB)39470094
394800                         ELSE                                     39480094
394900                             IF (ASC-NO-ORIGINAL-PRICE-ERROR      39490094
395000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   39500094
395100                             AND ASC-NO-NEW-PRICE-ERROR           39510094
395200                                     (ASC-BLK-SUB ASC-ITEM-SUB))  39520094
395300                                 COMPUTE PV-PRICE-DIFF =          39530094
395400                                       ASC-ORIGINAL-PRICE         39540094
395500                                        (ASC-BLK-SUB ASC-ITEM-SUB)39550094
395600                                     - ASC-NEW-PRICE              39560094
395700                                        (ASC-BLK-SUB ASC-ITEM-SUB)39570094
395800                                 IF PV-PRICE-DIFF < 0             39580094
395900                                     COMPUTE PV-PRICE-DIFF        39590094
396000                                         = PV-PRICE-DIFF * -1     39600094
396100                                 END-IF                           39610094
396200                                 IF PV-PRICE-DIFF NOT =           39620094
396300                                     ASC-PRICE-DIFF               39630094
396400                                        (ASC-BLK-SUB ASC-ITEM-SUB)39640094
396500                                     IF PS-NO-ERROR               39650094
396600                                         SET PS-ERROR TO TRUE     39660094
396700*                                        --- PRICE DIFF ERROR --- 39670094
396800                                         MOVE PC-TSYMSG-00603     39680094
396900                                           TO DP020-MSG-NUMBER    39690094
397000                                         MOVE -1 TO               39700094
397100                                           MR-PRICE-DIFFL (PV-SUB)39710094
397200                                     END-IF                       39720094
397300                                     SET ASC-PRICE-DIFF-ERROR     39730094
397400                                        (ASC-BLK-SUB ASC-ITEM-SUB)39740094
397500                                         TO TRUE                  39750094
397600                                     MOVE DP015-UNP-ALP-BRT-OFF   39760094
397700                                        TO MR-PRICE-DIFFA (PV-SUB)39770094
397800                                     MOVE DP015-RED               39780094
397900                                        TO MR-PRICE-DIFFC (PV-SUB)39790094
398000                                     MOVE DP015-REVERSE           39800094
398100                                        TO MR-PRICE-DIFFH (PV-SUB)39810094
398200                                 END-IF                           39820094
398300                             END-IF                               39830094
398400                         END-IF                                   39840094
398500                     ELSE                                         39850094
398600                         IF PS-DONT-ENTER-MISSED-MKDN-DATA        39860094
398700                             IF ASC-PRICE-DIFF                    39870094
398800                                        (ASC-BLK-SUB ASC-ITEM-SUB)39880094
398900                                NOT = ZERO                        39890094
399000                                 IF PS-NO-ERROR                   39900094
399100                                     SET PS-ERROR TO TRUE         39910094
399200*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     39920094
399300                                     MOVE PC-TSYMSG-00980         39930094
399400                                           TO DP020-MSG-NUMBER    39940094
399500                                     MOVE -1 TO                   39950094
399600                                           MR-PRICE-DIFFL (PV-SUB)39960094
399700                                 END-IF                           39970094
399800                                 MOVE DP015-UNP-ALP-BRT-OFF       39980094
399900                                        TO MR-PRICE-DIFFA (PV-SUB)39990094
400000                                 MOVE DP015-RED                   40000094
400100                                        TO MR-PRICE-DIFFC (PV-SUB)40010094
400200                                 MOVE DP015-REVERSE               40020094
400300                                        TO MR-PRICE-DIFFH (PV-SUB)40030094
400400                             END-IF                               40040094
400500                         ELSE                                     40050094
400600                             IF (ASC-NO-ORIGINAL-PRICE-ERROR      40060094
400700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40070094
400800                             AND ASC-NO-NEW-PRICE-ERROR           40080094
400900                                     (ASC-BLK-SUB ASC-ITEM-SUB))  40090094
401000                                 COMPUTE PV-PRICE-DIFF =          40100094
401100                                       ASC-ORIGINAL-PRICE         40110094
401200                                        (ASC-BLK-SUB ASC-ITEM-SUB)40120094
401300                                     - ASC-NEW-PRICE              40130094
401400                                        (ASC-BLK-SUB ASC-ITEM-SUB)40140094
401500                                 IF PV-PRICE-DIFF < 0             40150094
401600                                     COMPUTE PV-PRICE-DIFF        40160094
401700                                         = PV-PRICE-DIFF * -1     40170094
401800                                 END-IF                           40180094
401900                                 IF PV-PRICE-DIFF NOT =           40190094
402000                                     ASC-PRICE-DIFF               40200094
402100                                        (ASC-BLK-SUB ASC-ITEM-SUB)40210094
402200                                     IF PS-NO-ERROR               40220094
402300                                         SET PS-ERROR TO TRUE     40230094
402400*                                        --- PRICE DIFF ERROR --- 40240094
402500                                         MOVE PC-TSYMSG-00603     40250094
402600                                           TO DP020-MSG-NUMBER    40260094
402700                                         MOVE -1 TO               40270094
402800                                           MR-PRICE-DIFFL (PV-SUB)40280094
402900                                     END-IF                       40290094
403000                                     SET ASC-PRICE-DIFF-ERROR     40300094
403100                                        (ASC-BLK-SUB ASC-ITEM-SUB)40310094
403200                                         TO TRUE                  40320094
403300                                     MOVE DP015-UNP-ALP-BRT-OFF   40330094
403400                                        TO MR-PRICE-DIFFA (PV-SUB)40340094
403500                                     MOVE DP015-RED               40350094
403600                                        TO MR-PRICE-DIFFC (PV-SUB)40360094
403700                                     MOVE DP015-REVERSE           40370094
403800                                        TO MR-PRICE-DIFFH (PV-SUB)40380094
403900                                 END-IF                           40390094
404000                                 IF ASC-PRICE-DIFF                40400094
404100                                        (ASC-BLK-SUB ASC-ITEM-SUB)40410094
404200                                     = ZERO                       40420094
404300                                     IF PS-NO-ERROR               40430094
404400                                         SET PS-ERROR TO TRUE     40440094
404500*----PC-TSYMSG-00010 - CANNOT BE ZERO                             40450094
404600                                         MOVE PC-TSYMSG-00010     40460094
404700                                               TO DP020-MSG-NUMBER40470094
404800                                         MOVE -1 TO               40480094
404900                                           MR-PRICE-DIFFL (PV-SUB)40490094
405000                                     END-IF                       40500094
405100                                     SET ASC-PRICE-DIFF-ERROR     40510094
405200                                        (ASC-BLK-SUB ASC-ITEM-SUB)40520094
405300                                         TO TRUE                  40530094
405400                                     MOVE DP015-UNP-ALP-BRT-OFF   40540094
405500                                        TO MR-PRICE-DIFFA (PV-SUB)40550094
405600                                     MOVE DP015-RED               40560094
405700                                        TO MR-PRICE-DIFFC (PV-SUB)40570094
405800                                     MOVE DP015-REVERSE           40580094
405900                                        TO MR-PRICE-DIFFH (PV-SUB)40590094
406000                                 END-IF                           40600094
406100                             END-IF                               40610094
406200                         END-IF                                   40620094
406300                     END-IF                                       40630094
406400                 ELSE                                             40640094
406500                     IF (ASC-NO-ORIGINAL-PRICE-ERROR              40650094
406600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40660094
406700                     AND ASC-NO-NEW-PRICE-ERROR                   40670094
406800                                     (ASC-BLK-SUB ASC-ITEM-SUB))  40680094
406900                        COMPUTE PV-PRICE-DIFF = ASC-ORIGINAL-PRICE40690094
407000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40700094
407100                                           - ASC-NEW-PRICE        40710094
407200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40720094
407300                        IF PV-PRICE-DIFF < 0                      40730094
407400                             COMPUTE PV-PRICE-DIFF                40740094
407500                                        = PV-PRICE-DIFF * -1      40750094
407600                        END-IF                                    40760094
407700                        IF PV-PRICE-DIFF  NOT = ASC-PRICE-DIFF    40770094
407800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40780094
407900                             IF PS-NO-ERROR                       40790094
408000                                 SET PS-ERROR TO TRUE             40800094
408100* --- PRICE DIFF ERROR ---                                        40810094
408200                                 MOVE PC-TSYMSG-00603             40820094
408300                                       TO DP020-MSG-NUMBER        40830094
408400                                 MOVE -1                          40840094
408500                                       TO MR-PRICE-DIFFL (PV-SUB) 40850094
408600                             END-IF                               40860094
408700                             SET ASC-PRICE-DIFF-ERROR             40870094
408800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40880094
408900                                   TO TRUE                        40890094
409000                             MOVE DP015-UNP-ALP-BRT-OFF           40900094
409100                                   TO MR-PRICE-DIFFA (PV-SUB)     40910094
409200                             MOVE DP015-RED                       40920094
409300                                   TO MR-PRICE-DIFFC (PV-SUB)     40930094
409400                             MOVE DP015-REVERSE                   40940094
409500                                   TO MR-PRICE-DIFFH (PV-SUB)     40950094
409600                        END-IF                                    40960094
409700                         IF ASC-PRICE-DIFF                        40970094
409800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40980094
409900                                                = ZERO            40990094
410000                             IF PS-NO-ERROR                       41000094
410100                                 SET PS-ERROR TO TRUE             41010094
410200*----PC-TSYMSG-00010 - CANNOT BE ZERO                             41020094
410300                                 MOVE PC-TSYMSG-00010             41030094
410400                                       TO DP020-MSG-NUMBER        41040094
410500                                 MOVE -1                          41050094
410600                                       TO MR-PRICE-DIFFL (PV-SUB) 41060094
410700                             END-IF                               41070094
410800                             SET ASC-PRICE-DIFF-ERROR             41080094
410900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   41090094
411000                                   TO TRUE                        41100094
411100                             MOVE DP015-UNP-ALP-BRT-OFF           41110094
411200                                   TO MR-PRICE-DIFFA (PV-SUB)     41120094
411300                             MOVE DP015-RED                       41130094
411400                                   TO MR-PRICE-DIFFC (PV-SUB)     41140094
411500                             MOVE DP015-REVERSE                   41150094
411600                                   TO MR-PRICE-DIFFH (PV-SUB)     41160094
411700                         END-IF                                   41170094
411800                     END-IF                                       41180094
411900                 END-IF                                           41190094
412000             END-IF                                               41200094
412100         ELSE                                                     41210094
412200             SET ASC-PRICE-DIFF-ERROR                             41220094
412300                    (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE            41230094
412400             IF  PE049-IS-INVENTORY-MISSED-RSN                    41240094
412500             AND PE049-MARKDOWN                                   41250094
412600                 IF PS-DONT-ENTER-MISSED-MKDN-DATA                41260094
412700                     CONTINUE                                     41270094
412800                 ELSE                                             41280094
412900                     IF PS-NO-ERROR                               41290094
413000                         SET PS-ERROR TO TRUE                     41300094
413100*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     41310094
413200                         MOVE PC-TSYMSG-00980                     41320094
413300                                       TO DP020-MSG-NUMBER        41330094
413400                         MOVE -1       TO MR-PRICE-DIFFL (PV-SUB) 41340094
413500                     END-IF                                       41350094
413600                     MOVE DP015-UNP-ALP-BRT-OFF                   41360094
413700                                        TO MR-PRICE-DIFFA (PV-SUB)41370094
413800                     MOVE DP015-RED     TO MR-PRICE-DIFFC (PV-SUB)41380094
413900                     MOVE DP015-REVERSE TO MR-PRICE-DIFFH (PV-SUB)41390094
414000                 END-IF                                           41400094
414100             ELSE                                                 41410094
414200                 IF PS-NO-ERROR                                   41420094
414300                     SET PS-ERROR TO TRUE                         41430094
414400*----PC-TSYMSG-00007 - REQUIRED ENTRY                             41440094
414500                     MOVE PC-TSYMSG-00007                         41450094
414600                                   TO DP020-MSG-NUMBER            41460094
414700                     MOVE -1       TO MR-PRICE-DIFFL (PV-SUB)     41470094
414800                 END-IF                                           41480094
414900                 MOVE DP015-UNP-ALP-BRT-OFF                       41490094
415000                                   TO MR-PRICE-DIFFA (PV-SUB)     41500094
415100                 MOVE DP015-RED    TO MR-PRICE-DIFFC (PV-SUB)     41510094
415200                 MOVE DP015-REVERSE                               41520094
415300                                   TO MR-PRICE-DIFFH (PV-SUB)     41530094
415400             END-IF                                               41540094
415500         END-IF                                                   41550094
415600     END-IF.                                                      41560094
415700*                                                                 41570094
415800     IF (ASC-QUANTITY-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB)          41580094
415900     AND PS-UPC-NOT-ENTERED-VALID                                 41590094
416000     AND PS-SKU-NOT-ENTERED-VALID)                                41600094
416100         IF ASC-QUANTITY (ASC-BLK-SUB ASC-ITEM-SUB)  = SPACES     41610094
416200             SET ASC-QUANTITY-NOT-CHANGED                         41620094
416300                         (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE       41630094
416400         ELSE                                                     41640094
416500             IF PS-NO-ERROR                                       41650094
416600                 SET PS-ERROR TO TRUE                             41660094
416700*----PC-TSYMSG-00007 - REQUIRED ENTRY                             41670094
416800                 MOVE PC-TSYMSG-00007                             41680094
416900                                   TO DP020-MSG-NUMBER            41690094
417000                 MOVE -1           TO MR-SKUL (PV-SUB)            41700094
417100             END-IF                                               41710094
417200             MOVE DP015-UNP-ALP-BRT-OFF                           41720094
417300                                   TO MR-SKUA (PV-SUB)            41730094
417400                                      MR-UPCA (PV-SUB)            41740094
417500             MOVE DP015-RED        TO MR-SKUC (PV-SUB)            41750094
417600                                      MR-UPCC (PV-SUB)            41760094
417700             MOVE DP015-REVERSE    TO MR-SKUH (PV-SUB)            41770094
417800                                      MR-UPCH (PV-SUB)            41780094
417900         END-IF                                                   41790094
418000     END-IF.                                                      41800094
418100                                                                  41810094
418200     IF  (PS-UPC-ENTERED-VALID                                    41820094
418300      OR (ASC-PRICE-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB))           41830094
418400      OR (ASC-QUANTITY-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB)))       41840094
418500         IF ASC-QUANTITY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES      41850094
418600             MOVE ASC-QUANTITY (ASC-BLK-SUB ASC-ITEM-SUB)         41860094
418700                                   TO DP010I-UNEDITED-FIELD       41870094
418800             MOVE LENGTH OF ASC-QUANTITY                          41880094
418900                                (ASC-BLK-SUB ASC-ITEM-SUB)        41890094
419000                                   TO DP010I-MAXIMUM-DIGITS       41900094
419100             MOVE +0               TO DP010I-MAXIMUM-DECIMALS     41910094
419200             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              41920094
419300             CALL DP010I-NUMERIC-EDIT-ROUTINE                     41930096
419310                         USING DP010I-NUMERIC-EDIT-AREA           41931096
419400             IF  DP010I-ERROR-DETECTED                            41940094
419500                 IF PS-NO-ERROR                                   41950094
419600                     SET PS-ERROR TO TRUE                         41960094
419700*----PC-TSYMSG-00008 - MUST BE NUMERIC                            41970094
419800                     MOVE PC-TSYMSG-00008                         41980094
419900                                   TO DP020-MSG-NUMBER            41990094
420000                     MOVE -1       TO MR-QUANTITYL (PV-SUB)       42000094
420100                 END-IF                                           42010094
420200                 MOVE DP015-UNP-ALP-BRT-OFF                       42020094
420300                                   TO MR-QUANTITYA (PV-SUB)       42030094
420400                 MOVE DP015-RED    TO MR-QUANTITYC (PV-SUB)       42040094
420500                 MOVE DP015-REVERSE                               42050094
420600                                   TO MR-QUANTITYH (PV-SUB)       42060094
420700             ELSE                                                 42070094
420800                 MOVE DP010I-NUMERIC-FIELD                        42080094
420900                                   TO ASC-QUANTITY-N              42090094
421000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   42100094
421100                 IF  PE049-IS-INVENTORY-MISSED-RSN                42110094
421200                 AND PE049-MARKDOWN                               42120094
421300                     IF PS-ENTER-MISSED-MKDN-DATA                 42130094
421400                         IF ASC-QUANTITY-N                        42140094
421500                                        (ASC-BLK-SUB ASC-ITEM-SUB)42150094
421600                            = ZERO                                42160094
421700                             IF PS-NO-ERROR                       42170094
421800                                 SET PS-ERROR TO TRUE             42180094
421900*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     42190094
422000                                 MOVE PC-TSYMSG-00980             42200094
422100                                           TO DP020-MSG-NUMBER    42210094
422200                                 MOVE -1                          42220094
422300                                          TO MR-QUANTITYL (PV-SUB)42230094
422400                             END-IF                               42240094
422500                             MOVE DP015-UNP-ALP-BRT-OFF           42250094
422600                                   TO MR-QUANTITYA (PV-SUB)       42260094
422700                             MOVE DP015-RED                       42270094
422800                                   TO MR-QUANTITYC (PV-SUB)       42280094
422900                             MOVE DP015-REVERSE                   42290094
423000                                   TO MR-QUANTITYH (PV-SUB)       42300094
423100                         ELSE                                     42310094
423200                             IF ASC-QUANTITY-N                    42320094
423300                                  (ASC-BLK-SUB ASC-ITEM-SUB)  < 1 42330094
423400                                 IF PS-NO-ERROR                   42340094
423500                                     SET PS-ERROR TO TRUE         42350094
423600*     --- QUANTITY MUST BE GREATER THAN OR EQUAL TO 1 ---         42360094
423700                                     MOVE PC-TSYMSG-00642         42370094
423800                                           TO DP020-MSG-NUMBER    42380094
423900                                     MOVE -1                      42390094
424000                                          TO MR-QUANTITYL (PV-SUB)42400094
424100                                 END-IF                           42410094
424200                                 MOVE DP015-UNP-ALP-BRT-OFF       42420094
424300                                   TO MR-QUANTITYA (PV-SUB)       42430094
424400                                 MOVE DP015-RED                   42440094
424500                                   TO MR-QUANTITYC (PV-SUB)       42450094
424600                                 MOVE DP015-REVERSE               42460094
424700                                   TO MR-QUANTITYH (PV-SUB)       42470094
424800                             END-IF                               42480094
424900                         END-IF                                   42490094
425000                     ELSE                                         42500094
425100                         IF PS-DONT-ENTER-MISSED-MKDN-DATA        42510094
425200                             IF ASC-QUANTITY-N                    42520094
425300                                        (ASC-BLK-SUB ASC-ITEM-SUB)42530094
425400                                NOT = ZERO                        42540094
425500                                 IF PS-NO-ERROR                   42550094
425600                                     SET PS-ERROR TO TRUE         42560094
425700*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     42570094
425800                                     MOVE PC-TSYMSG-00980         42580094
425900                                           TO DP020-MSG-NUMBER    42590094
426000                                     MOVE -1                      42600094
426100                                          TO MR-QUANTITYL (PV-SUB)42610094
426200                                 END-IF                           42620094
426300                                 MOVE DP015-UNP-ALP-BRT-OFF       42630094
426400                                   TO MR-QUANTITYA (PV-SUB)       42640094
426500                                 MOVE DP015-RED                   42650094
426600                                   TO MR-QUANTITYC (PV-SUB)       42660094
426700                                 MOVE DP015-REVERSE               42670094
426800                                   TO MR-QUANTITYH (PV-SUB)       42680094
426900                             END-IF                               42690094
427000                         ELSE                                     42700094
427100                             IF ASC-QUANTITY-N                    42710094
427200                                  (ASC-BLK-SUB ASC-ITEM-SUB)  < 1 42720094
427300                                 IF PS-NO-ERROR                   42730094
427400                                     SET PS-ERROR TO TRUE         42740094
427500*     --- QUANTITY MUST BE GREATER THAN OR EQUAL TO 1 ---         42750094
427600                                     MOVE PC-TSYMSG-00642         42760094
427700                                           TO DP020-MSG-NUMBER    42770094
427800                                     MOVE -1                      42780094
427900                                          TO MR-QUANTITYL (PV-SUB)42790094
428000                                 END-IF                           42800094
428100                                 MOVE DP015-UNP-ALP-BRT-OFF       42810094
428200                                   TO MR-QUANTITYA (PV-SUB)       42820094
428300                                 MOVE DP015-RED                   42830094
428400                                   TO MR-QUANTITYC (PV-SUB)       42840094
428500                                 MOVE DP015-REVERSE               42850094
428600                                   TO MR-QUANTITYH (PV-SUB)       42860094
428700                             END-IF                               42870094
428800                         END-IF                                   42880094
428900                     END-IF                                       42890094
429000                 ELSE                                             42900094
429100                     IF ASC-QUANTITY-N (ASC-BLK-SUB ASC-ITEM-SUB) 42910094
429200                                                              < 1 42920094
429300                         IF PS-NO-ERROR                           42930094
429400                             SET PS-ERROR TO TRUE                 42940094
429500*     --- QUANTITY MUST BE GREATER THAN OR EQUAL TO 1 ---         42950094
429600                             MOVE PC-TSYMSG-00642                 42960094
429700                                   TO DP020-MSG-NUMBER            42970094
429800                             MOVE -1                              42980094
429900                                   TO MR-QUANTITYL (PV-SUB)       42990094
430000                         END-IF                                   43000094
430100                         MOVE DP015-UNP-ALP-BRT-OFF               43010094
430200                                   TO MR-QUANTITYA (PV-SUB)       43020094
430300                         MOVE DP015-RED                           43030094
430400                                   TO MR-QUANTITYC (PV-SUB)       43040094
430500                         MOVE DP015-REVERSE                       43050094
430600                                   TO MR-QUANTITYH (PV-SUB)       43060094
430700                     END-IF                                       43070094
430800                 END-IF                                           43080094
430900             END-IF                                               43090094
431000         ELSE                                                     43100094
431100             IF  PE049-IS-INVENTORY-MISSED-RSN                    43110094
431200             AND PE049-MARKDOWN                                   43120094
431300                 IF PS-DONT-ENTER-MISSED-MKDN-DATA                43130094
431400                     CONTINUE                                     43140094
431500                 ELSE                                             43150094
431600                     IF PS-NO-ERROR                               43160094
431700                         SET PS-ERROR TO TRUE                     43170094
431800*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     43180094
431900                         MOVE PC-TSYMSG-00980                     43190094
432000                                       TO DP020-MSG-NUMBER        43200094
432100                         MOVE -1       TO MR-QUANTITYL (PV-SUB)   43210094
432200                     END-IF                                       43220094
432300                     MOVE DP015-UNP-ALP-BRT-OFF                   43230094
432400                                        TO MR-QUANTITYA   (PV-SUB)43240094
432500                     MOVE DP015-RED     TO MR-QUANTITYC   (PV-SUB)43250094
432600                     MOVE DP015-REVERSE TO MR-QUANTITYH   (PV-SUB)43260094
432700                 END-IF                                           43270094
432800             ELSE                                                 43280094
432900                 IF PS-NO-ERROR                                   43290094
433000                     SET PS-ERROR TO TRUE                         43300094
433100*----PC-TSYMSG-00007 - REQUIRED ENTRY                             43310094
433200                     MOVE PC-TSYMSG-00007                         43320094
433300                                       TO DP020-MSG-NUMBER        43330094
433400                     MOVE -1           TO MR-QUANTITYL (PV-SUB)   43340094
433500                 END-IF                                           43350094
433600                 MOVE DP015-UNP-ALP-BRT-OFF                       43360094
433700                                       TO MR-QUANTITYA (PV-SUB)   43370094
433800                 MOVE DP015-RED        TO MR-QUANTITYC (PV-SUB)   43380094
433900                 MOVE DP015-REVERSE    TO MR-QUANTITYH (PV-SUB)   43390094
434000             END-IF                                               43400094
434100         END-IF                                                   43410094
434200     END-IF.                                                      43420094
434300                                                                  43430094
434400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 43440094
434500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               43450094
434600*                                                                 43460094
434700 EJECT                                                            43470094
434800*----------------------------------------------------------------*43480094
434900*    DETERMINE WHICH SKU INFORMATION TO MOVE                     *43490094
435000*                                                                 43500094
435100*----------------------------------------------------------------*43510094
435200 3320-MOVE-SKU.                                                   43520094
435300     IF ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES           43530094
435400        MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) TO SKXREF-SKU 43540094
435500                                                   PV-TEMP-SKU    43550094
435600     ELSE                                                         43560094
435700        MOVE SKXREF-SKU TO PV-TEMP-SKU                            43570094
435800     END-IF.                                                      43580094
435900     IF PV-TEMP-SKU (6:3) NOT = 000                               43590094
436000        PERFORM 8300-RETRIEVE-UPC                                 43600094
436100        IF SQLCODE = +100                                         43610094
436200           IF PS-NO-ERROR                                         43620094
436300              SET PS-ERROR TO TRUE                                43630094
436400*     --- SKU DOES NOT EXIST ---                                  43640094
436500              MOVE PC-TSYMSG-00073                                43650094
436600                        TO DP020-MSG-NUMBER                       43660094
436700              MOVE -1      TO MR-SKUL (PV-SUB)                    43670094
436800           END-IF                                                 43680094
436900           MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SKUA (PV-SUB)        43690094
437000           MOVE DP015-RED TO MR-SKUC (PV-SUB)                     43700094
437100           MOVE DP015-REVERSE TO MR-SKUH (PV-SUB)                 43710094
437200        ELSE                                                      43720094
437300           MOVE UPC-UPC-NBR    TO ASC-UPC-N                       43730094
437400                               (ASC-BLK-SUB ASC-ITEM-SUB)         43740094
437500           MOVE SKXREF-ITM-NBR TO ASC-ITEM-NBR                    43750094
437600                               (ASC-BLK-SUB ASC-ITEM-SUB)         43760094
437700           PERFORM 8450-DETERMINE-SKU                             43770094
437800        END-IF                                                    43780094
437900        MOVE SKXREF-DEPT  TO PV-TEMP-DEPT                         43790094
438000        MOVE PV-TEMP-DEPT TO ASC-DEPT-NBR                         43800094
438100                           (ASC-BLK-SUB ASC-ITEM-SUB)             43810094
438200        MOVE SKXREF-SUBCLASS  TO PV-TEMP-SUBCLASS                 43820094
438300        MOVE PV-TEMP-SUBCLASS TO ASC-CLASS-NBR                    43830094
438400                              (ASC-BLK-SUB ASC-ITEM-SUB)          43840094
438500        MOVE SKXREF-CLASS     TO PV-MAJ-CLASS                     43850094
438600                              ASC-MAJ-CLASS-NBR                   43860094
438700                              (ASC-BLK-SUB ASC-ITEM-SUB)          43870094
438800        MOVE SKXREF-SKU       TO ASC-SKU-NBR                      43880094
438900                              (ASC-BLK-SUB ASC-ITEM-SUB)          43890094
439000        MOVE +0   TO ASC-ROW-NBR                                  43900094
439100                              (ASC-BLK-SUB ASC-ITEM-SUB)          43910094
439200     ELSE                                                         43920094
439300        MOVE PV-TEMP-SKU (1:3)  TO PV-TEMP-DEPT                   43930094
439400        MOVE PV-TEMP-DEPT       TO ASC-DEPT-NBR                   43940094
439500                               (ASC-BLK-SUB ASC-ITEM-SUB)         43950094
439600        MOVE PV-TEMP-SKU (4:2)                                    43960094
439700                               TO PV-TEMP-SUBCLASS                43970094
439800        MOVE PV-TEMP-SUBCLASS  TO ASC-CLASS-NBR                   43980094
439900                               (ASC-BLK-SUB ASC-ITEM-SUB)         43990094
440000        MOVE PV-TEMP-SKU (4:1) TO PV-MAJ-CL-3                     44000094
440100        MOVE PV-MAJ-CLASS      TO ASC-MAJ-CLASS-NBR               44010094
440200                               (ASC-BLK-SUB ASC-ITEM-SUB)         44020094
440300        MOVE +0                TO ASC-UPC-N                       44030094
440400                               (ASC-BLK-SUB ASC-ITEM-SUB)         44040094
440500        MOVE +0                TO ASC-ITEM-NBR                    44050094
440600                               (ASC-BLK-SUB ASC-ITEM-SUB)         44060094
440700        MOVE +0                TO ASC-ROW-NBR                     44070094
440800                               (ASC-BLK-SUB ASC-ITEM-SUB)         44080094
440900     END-IF.                                                      44090094
441000*                                                                 44100094
441100 EJECT                                                            44110094
441200*----------------------------------------------------------------*44120094
441300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *44130094
441400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *44140094
441500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *44150094
441600*    DISPLAY THE PANEL TO USER.                                  *44160094
441700*----------------------------------------------------------------*44170094
441800                                                                  44180094
441900 4000-BUILD-INITIAL-PANEL.                                        44190094
442000                                                                  44200094
442100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            44210094
442200                                 ASC-BLOCK-ENTRIES (2).           44220094
442300     MOVE +1                 TO ASC-BLK-SUB.                      44230094
442400     SET ASC-DATA-NOT-UPDATED                                     44240094
442500         ASC-ITEMS-LEFT-ON-DB                                     44250094
442600                             TO TRUE.                             44260094
442700                                                                  44270094
442800     MOVE +0                 TO ASC-ITEM-SUB                      44280094
442900                                ASC-NUMBER-OF-ITEMS-READ          44290094
443000                                ASC-NUMBER-OF-SELECTED-ITEMS      44300094
443100                                ASC-HIGHEST-BLOCK-WRITTEN         44310094
443200                                ASC-ORIG-HIGHEST-BLOCK-WRITTEN    44320094
443300                                ASC-ITEM-AT-TOP-OF-PANEL.         44330094
443400                                                                  44340094
443500     PERFORM 8210-OPEN-CURSOR.                                    44350094
443600                                                                  44360094
443700     PERFORM 4300-READ-ITEMS-FROM-DB.                             44370094
443800                                                                  44380094
443900     PERFORM 8220-CLOSE-CURSOR.                                   44390094
444000                                                                  44400094
444100     MOVE +1                 TO  PV-TOP-ITEM.                     44410094
444200                                                                  44420094
444300     PERFORM 3200-RESET-ATTRIBUTES.                               44430094
444400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        44440094
444500*                                                                 44450094
444600 EJECT                                                            44460094
444700*----------------------------------------------------------------*44470094
444800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *44480094
444900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *44490094
445000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *44500094
445100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *44510094
445200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *44520094
445300*                                                                *44530094
445400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *44540094
445500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *44550094
445600*    UPON INITIALIZATION.                                        *44560094
445700*----------------------------------------------------------------*44570094
445800                                                                  44580094
445900 4300-READ-ITEMS-FROM-DB.                                         44590094
446000                                                                  44600094
446100     PERFORM 8100-GET-HEADER-INFO.                                44610094
446200*                                                                 44620094
446300     IF STRPPC-EFF-DTE = PE049-DEFAULT-DATE                       44630094
446400         MOVE SPACES               TO ASC-EFFECTIVE-DATE          44640094
446500     ELSE                                                         44650094
446600         MOVE STRPPC-EFF-DTE       TO ASC-EFFECTIVE-DATE-ISO      44660094
446700                                      PV-HOLD-ISO-DATE            44670094
446800         MOVE PV-HOLD-ISO-MM       TO ASC-EFFECTIVE-MM            44680094
446900         MOVE PV-HOLD-ISO-DD       TO ASC-EFFECTIVE-DD            44690094
447000         MOVE PV-HOLD-ISO-YY       TO ASC-EFFECTIVE-YY            44700094
447100     END-IF.                                                      44710094
447200     MOVE STRPPC-PR-CHG-CPL-NAME   TO ASC-EFFECTIVE-NAME.         44720094
447300     MOVE STRPPC-DEPT-AREA-DEST    TO ASC-DEPT-AREA.              44730094
447400     MOVE STRPPC-CRE-DTE           TO PV-HOLD-ISO-DATE.           44740094
447500     MOVE PV-HOLD-ISO-MM           TO PV-HOLD-GREG-MM.            44750094
447600     MOVE PV-HOLD-ISO-DD           TO PV-HOLD-GREG-DD.            44760094
447700     MOVE PV-HOLD-ISO-YY           TO PV-HOLD-GREG-YY.            44770094
447800     MOVE PV-HOLD-GREG-DATE        TO ASC-ISSUED-DATE.            44780094
447900     MOVE STRPPC-TYP-CDE           TO PV-HOLD-TYPE-CODE.          44790094
448000     MOVE STRPPC-RSN-CDE           TO PV-HOLD-REASON-CODE.        44800094
448100     MOVE STRPPC-PGS-TO-PRT-NBR    TO ASC-PAGES-TO-PRINT.         44810094
448200*                                                                 44820094
448300     IF (STRPPC-TYP-CDE = ZEROS                                   44830094
448400     AND STRPPC-RSN-CDE = ZEROS)                                  44840094
448500         MOVE SPACES               TO ASC-REASON-CODE             44850094
448600                                      ASC-REASON-DESC             44860094
448700     ELSE                                                         44870094
448800         MOVE PV-HOLD-TYPE-REASON-CODE                            44880094
448900                                   TO ASC-REASON-CODE             44890094
449000                                      ASC-ORIGINAL-REASON-CODE    44900094
449100         PERFORM 8999-GET-REASON-DESC                             44910094
449200     END-IF.                                                      44920094
449300*                                                                 44930094
449400     MOVE STRPPC-STATUS-CDE        TO ASC-STATUS-CODE.            44940094
449500*                                                                 44950094
449600     EVALUATE TRUE                                                44960094
449700         WHEN STRPPC-STATUS-CDE                                   44970094
449800                         = PE049-IS-AVAILABLE-STATUS-CDE          44980094
449900             MOVE PE049-AVAILABLE-STATUS-DESC                     44990094
450000                                   TO ASC-STATUS-DESC             45000094
450100         WHEN STRPPC-STATUS-CDE                                   45010094
450200                         = PE049-IS-CNTS-ENTER-STATUS-CDE         45020094
450300             MOVE PE049-CNTS-ENTERED-STATUS-DESC                  45030094
450400                                   TO ASC-STATUS-DESC             45040094
450500         WHEN STRPPC-STATUS-CDE                                   45050094
450600                         = PE049-IS-DELINQUENT-STATUS-CDE         45060094
450700             MOVE PE049-DELINQUENT-STATUS-DESC                    45070094
450800                                   TO ASC-STATUS-DESC             45080094
450900         WHEN STRPPC-STATUS-CDE                                   45090094
451000                         = PE049-IS-GENERATED-STATUS-CDE          45100094
451100             MOVE PE049-GENERATED-STATUS-DESC                     45110094
451200                                   TO ASC-STATUS-DESC             45120094
451300         WHEN STRPPC-STATUS-CDE                                   45130094
451400                         = PE049-IS-CANCELLED-STATUS-CDE          45140094
451500             MOVE PE049-CANCELLED-STATUS-DESC                     45150094
451600                                   TO ASC-STATUS-DESC             45160094
451700         WHEN STRPPC-STATUS-CDE                                   45170094
451800                         = PE049-IS-COMPLETED-STATUS-CDE          45180094
451900             MOVE PE049-COMPLETE-STATUS-DESC                      45190094
452000                                   TO ASC-STATUS-DESC             45200094
452100         WHEN STRPPC-STATUS-CDE                                   45210094
452200                         = PE049-IS-HISTORY-STATUS-CDE            45220094
452300             MOVE PE049-HISTORY-STATUS-DESC                       45230094
452400                                   TO ASC-STATUS-DESC             45240094
452500         WHEN OTHER                                               45250094
452600             MOVE SPACES           TO ASC-STATUS-DESC             45260094
452700     END-EVALUATE.                                                45270094
452800     MOVE SPACES                   TO ASC-TOTAL-QUANTITY.         45280094
452900     MOVE +0                       TO PV-TOTAL-QUANTITY.          45290094
453000*                                                                 45300094
453100     PERFORM                                                      45310094
453200         VARYING PV-READ-COUNT                                    45320094
453300         FROM 1 BY 1                                              45330094
453400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    45340094
453500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         45350094
453600                                                                  45360094
453700         PERFORM 8200-FETCH-DETAIL-CURSOR                         45370094
453800                                                                  45380094
453900         IF  ASC-ITEMS-LEFT-ON-DB                                 45390094
454000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                45400094
454100                 ADD +1            TO ASC-ITEM-SUB                45410094
454200             ELSE                                                 45420094
454300                 ADD +1            TO ASC-BLK-SUB                 45430094
454400                 MOVE +1           TO ASC-ITEM-SUB                45440094
454500                                                                  45450094
454600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         45460094
454700                     MOVE +1       TO ASC-BLK-SUB                 45470094
454800                     SET ASC-BLOCK-MODIFIED (1)                   45480094
454900                                   TO TRUE                        45490094
455000                     PERFORM 5200-WRITE-TEMP-STORAGE-ORIG         45500094
455100                     MOVE ASC-BLOCK-ENTRIES                       45510094
455200                               (PC-MAX-BLOCKS-IN-ARRAY)           45520094
455300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 45530094
455400                     ADD +1        TO ASC-BLK-SUB                 45540094
455500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   45550094
455600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      45560094
455700                                   TO TRUE                        45570094
455800                 END-IF                                           45580094
455900             END-IF                                               45590094
456000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    45600094
456100             MOVE ASC-NUMBER-OF-ITEMS-READ                        45610094
456200                                   TO ASC-LIST-ITEM-NUMBER        45620094
456300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45630094
456400             MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) 45640094
456500                                   TO ASC-LAST-LIST-ITEM-NUMBER   45650094
456600             MOVE SPPCDT-SKU-NBR   TO ASC-SKU-NBR                 45660094
456700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45670094
456800             MOVE SPPCDT-ROW-NBR   TO ASC-ROW-NBR                 45680094
456900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45690094
457000             MOVE SPPCDT-UPC-NBR   TO ASC-UPC-N                   45700094
457100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45710094
457200             MOVE SPPCDT-ITEM-NBR  TO ASC-ITEM-NBR                45720094
457300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45730094
457400             MOVE SPPCDT-OLD-PR    TO ASC-ORIGINAL-PRICE          45740094
457500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45750094
457600                                      ASC-ORIGINAL-PRICE-Z        45760094
457700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45770094
457800             MOVE SPPCDT-NEW-PR    TO ASC-NEW-PRICE               45780094
457900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45790094
458000                                      ASC-NEW-PRICE-Z             45800094
458100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45810094
458200             COMPUTE PV-PRICE-DIFF =                              45820094
458300                                   SPPCDT-OLD-PR - SPPCDT-NEW-PR  45830094
458400             IF PV-PRICE-DIFF < 0                                 45840094
458500                 COMPUTE PV-PRICE-DIFF                            45850094
458600                                        = PV-PRICE-DIFF * -1      45860094
458700             END-IF                                               45870094
458800             MOVE PV-PRICE-DIFF    TO ASC-PRICE-DIFF              45880094
458900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45890094
459000                                      ASC-PRICE-DIFF-Z            45900094
459100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45910094
459200             MOVE SPPCDT-ACTL-PR-CHG-QTY                          45920094
459300                                   TO ASC-QUANTITY-N              45930094
459400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45940094
459500             COMPUTE PV-TOTAL-QUANTITY =                          45950094
459600                  SPPCDT-ACTL-PR-CHG-QTY + PV-TOTAL-QUANTITY      45960094
459700         END-IF                                                   45970094
459800     END-PERFORM.                                                 45980094
459900*                                                                 45990094
460000     IF STRPPC-STATUS-CDE = PE049-IS-CNTS-ENTER-STATUS-CDE        46000094
460100         MOVE PV-TOTAL-QUANTITY    TO ASC-TOTAL-QUANTITY-N        46010094
460200     ELSE                                                         46020094
460300         IF PV-TOTAL-QUANTITY > ZERO                              46030094
460400             MOVE PV-TOTAL-QUANTITY                               46040094
460500                                   TO ASC-TOTAL-QUANTITY-N        46050094
460600         END-IF                                                   46060094
460700     END-IF.                                                      46070094
460800                                                                  46080094
460900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          46090094
461000         MOVE +1                   TO ASC-BLK-SUB                 46100094
461100         PERFORM 5200-WRITE-TEMP-STORAGE-ORIG                     46110094
461200         ADD +1                    TO ASC-BLK-SUB                 46120094
461300         PERFORM 5200-WRITE-TEMP-STORAGE-ORIG                     46130094
461400                                                                  46140094
461500         MOVE 1                    TO ASC-BLK-SUB                 46150094
461600                                      PV-BLOCK-NUMBER             46160094
461700         PERFORM 7100-READ-TEMP-STORAGE                           46170094
461800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             46180094
461900             MOVE 2                TO ASC-BLK-SUB                 46190094
462000                                      PV-BLOCK-NUMBER             46200094
462100             PERFORM 7100-READ-TEMP-STORAGE                       46210094
462200         END-IF                                                   46220094
462300     ELSE                                                         46230094
462400         SET ASC-NO-ITEMS-IN-TEMP-ST                              46240094
462500                                   TO TRUE                        46250094
462600         MOVE +1                   TO ASC-LIST-ITEM-NUMBER (1 1)  46260094
462700                                      ASC-LAST-LIST-ITEM-NUMBER   46270094
462800     END-IF.                                                      46280094
462900*                                                                 46290094
463000 EJECT                                                            46300094
463100*----------------------------------------------------------------*46310094
463200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *46320094
463300*----------------------------------------------------------------*46330094
463400                                                                  46340094
463500 4400-MOVE-COMMAREA-TO-SCREEN.                                    46350094
463600     MOVE ASC-KEY-STORE-NBR        TO ASTRNO.                     46360094
463700     MOVE ASC-STORE-NAME           TO ASTRNMO.                    46370094
463800     MOVE ASC-KEY-DOC-NBR          TO ADOCNO.                     46380094
463900     MOVE ASC-ISSUED-DATE          TO AISSDTEO.                   46390094
464000     MOVE ASC-REASON-CODE          TO ARSNO.                      46400094
464100     MOVE ASC-TYPE-DESC            TO ATYPDO.                     46410094
464200     MOVE ASC-REASON-DESC          TO ARSNDO.                     46420094
464300     MOVE ASC-STATUS-CODE          TO ASTATO.                     46430094
464400     MOVE ASC-STATUS-DESC          TO ASTATDO.                    46440094
464500     MOVE ASC-EFFECTIVE-NAME       TO AEFFNMO.                    46450094
464600     MOVE ASC-EFFECTIVE-MM         TO AEFFMMO.                    46460094
464700     MOVE ASC-EFFECTIVE-DD         TO AEFFDDO.                    46470094
464800     MOVE ASC-EFFECTIVE-YY         TO AEFFYYO.                    46480094
464900     MOVE ASC-DEPT-AREA            TO ADPTARO.                    46490094
465000     IF ASC-TOTAL-QUANTITY-N NUMERIC                              46500094
465100         MOVE ASC-TOTAL-QUANTITY-N TO MR-TOTAL-QUANTITY-N         46510094
465200     ELSE                                                         46520094
465300         MOVE ASC-TOTAL-QUANTITY   TO MR-TOTAL-QUANTITY           46530094
465400     END-IF.                                                      46540094
465500     MOVE +1            TO ASC-BLK-SUB.                           46550094
465600     IF ASC-LIST-ITEM-NUMBER (1 1) = +0                           46560094
465700         MOVE +1                   TO ASC-ITEM-SUB                46570094
465800     ELSE                                                         46580094
465900         COMPUTE ASC-ITEM-SUB =                                   46590094
466000             (PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1) + 1)       46600094
466100     END-IF.                                                      46610094
466200*                                                                 46620094
466300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        46630094
466301         ADD +1         TO ASC-BLK-SUB                            46630194
466302         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            46630294
466303     END-IF.                                                      46630394
466304*                                                                 46630494
466305     MOVE PV-TOP-ITEM              TO PV-LINE-COUNTER             46630594
466306     PERFORM                                                      46630694
466307       VARYING PV-SUB                                             46630794
466308       FROM 1 BY 1                                                46630894
466309       UNTIL PV-SUB > PC-ITEMS-PER-PANEL                          46630994
466310         MOVE PV-LINE-COUNTER      TO MR-FIRST-LINE (PV-SUB)      46631094
466320                                      MR-LAST-LINE (PV-SUB)       46632094
466330         ADD +1                    TO PV-LINE-COUNTER             46633094
466340     END-PERFORM.                                                 46634094
466350*                                                                 46635094
466360     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           46636094
466370         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                46637094
466380     PERFORM 4420-FORMAT-LIST-LINES                               46638094
466390         VARYING PV-SUB                                           46639094
466400         FROM 1 BY 1                                              46640094
466500         UNTIL PV-SUB > PC-ITEMS-PER-PANEL.                       46650094
466600*                                                                 46660094
466700     IF PS-NO-ERROR                                               46670094
466800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      46680094
466900         IF  PE049-IS-INVENTORY-MISSED-RSN                        46690094
467000         AND PE049-MARKDOWN                                       46700094
467100             IF ASC-EFFECTIVE-NAME = SPACES                       46710094
467200                 MOVE -1           TO AEFFNML                     46720094
467300             ELSE                                                 46730094
467400                 MOVE -1           TO MR-ORIG-PRICEL (1)          46740094
467500             END-IF                                               46750094
467600         ELSE                                                     46760094
467700             IF ASC-STATUS-CODE = PE049-IS-CNTS-ENTER-STATUS-CDE  46770094
467800                 MOVE -1           TO MR-SKUL (1)                 46780094
467900             ELSE                                                 46790094
468000                 IF ASC-REASON-CODE = SPACES                      46800094
468100                     MOVE -1       TO ARSNL                       46810094
468200                 ELSE                                             46820094
468300                     IF ASC-EFFECTIVE-NAME = SPACES               46830094
468400                         MOVE -1   TO AEFFNML                     46840094
468500                     ELSE                                         46850094
468600                         MOVE -1   TO MR-SKUL (1)                 46860094
468700                     END-IF                                       46870094
468800                 END-IF                                           46880094
468900             END-IF                                               46890094
469000         END-IF                                                   46900094
469100     END-IF.                                                      46910094
469200*                                                                 46920094
469300     COMPUTE ASC-ITEMS-DISPLAYED =                                46930094
469400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          46940094
469500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL.   46950094
469600*                                                                 46960094
469700     IF  DP020-MSG-NUMBER-X = SPACE                               46970094
469800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  46980094
469900*     --- MORE ITEMS TO DISPLAY ----                              46990094
470000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            47000094
470100             SET DP020-MSG-INFORMATIONAL TO TRUE                  47010094
470200         END-IF                                                   47020094
470300     END-IF.                                                      47030094
470400*                                                                 47040094
470500 EJECT                                                            47050094
470600*----------------------------------------------------------------*47060094
470700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *47070094
470800*----------------------------------------------------------------*47080094
470900                                                                  47090094
471000 4420-FORMAT-LIST-LINES.                                          47100094
471100*                                                                 47110094
471200     IF (ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES          47120094
471300     AND ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES              47130094
471400     AND ASC-ORIGINAL-PRICE-DISP (ASC-BLK-SUB ASC-ITEM-SUB)       47140094
471500                                            = SPACES              47150094
471600     AND ASC-NEW-PRICE-DISP (ASC-BLK-SUB ASC-ITEM-SUB)            47160094
471700                                            = SPACES              47170094
471800     AND ASC-PRICE-DIFF-DISP (ASC-BLK-SUB ASC-ITEM-SUB)           47180094
471900                                            = SPACES              47190094
472000     AND (ASC-QUANTITY (ASC-BLK-SUB ASC-ITEM-SUB)                 47200094
472100                                            = SPACES OR ZEROS))   47210094
472200         MOVE SPACES             TO MR-SKU (PV-SUB)               47220094
472300                                    MR-UPC (PV-SUB)               47230094
472400                                    MR-ORIG-PRICE (PV-SUB)        47240094
472500                                    MR-NEW-PRICE (PV-SUB)         47250094
472600                                    MR-PRICE-DIFF (PV-SUB)        47260094
472700                                    MR-QUANTITY (PV-SUB)          47270094
472800         IF  PE049-IS-INVENTORY-MISSED-RSN                        47280094
472900         AND PE049-MARKDOWN                                       47290094
473000             MOVE DP015-PRO-NOR-OFF                               47300094
473100                                 TO MR-ORIG-PRICEA (PV-SUB)       47310094
473200                                    MR-NEW-PRICEA  (PV-SUB)       47320094
473300                                    MR-PRICE-DIFFA (PV-SUB)       47330094
473400                                    MR-QUANTITYA   (PV-SUB)       47340094
473500             MOVE DP015-BLUE     TO MR-ORIG-PRICEC (PV-SUB)       47350094
473600                                    MR-NEW-PRICEC  (PV-SUB)       47360094
473700                                    MR-PRICE-DIFFC (PV-SUB)       47370094
473800                                    MR-QUANTITYC   (PV-SUB)       47380094
473900             MOVE DP015-HL-OFF   TO MR-ORIG-PRICEH (PV-SUB)       47390094
474000                                    MR-NEW-PRICEH  (PV-SUB)       47400094
474100                                    MR-PRICE-DIFFH (PV-SUB)       47410094
474200                                    MR-QUANTITYH   (PV-SUB)       47420094
474300             MOVE SPACES         TO MR-FIRST-LINE  (PV-SUB)       47430094
474400                                    MR-LAST-LINE   (PV-SUB)       47440094
474500         END-IF                                                   47450094
474600     ELSE                                                         47460094
474700         MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)              47470094
474800                                 TO MR-SKU (PV-SUB)               47480094
474900         IF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) NUMERIC            47490094
475000             MOVE ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)            47500094
475100                                 TO MR-UPC-N (PV-SUB)             47510094
475200         ELSE                                                     47520094
475300             MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)              47530094
475400                                 TO MR-UPC (PV-SUB)               47540094
475500         END-IF                                                   47550094
475600         IF ASC-ORIGINAL-PRICE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)   47560094
475700             MOVE ASC-ORIGINAL-PRICE-DISP                         47570094
475800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   47580094
475900                                 TO MR-ORIG-PRICE (PV-SUB)        47590094
476000         ELSE                                                     47600094
476100             MOVE ASC-ORIGINAL-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)   47610094
476200                                 TO MR-ORIG-PRICE-N (PV-SUB)      47620094
476300         END-IF                                                   47630094
476400         IF ASC-NEW-PRICE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)        47640094
476500             MOVE ASC-NEW-PRICE-DISP                              47650094
476600                                (ASC-BLK-SUB ASC-ITEM-SUB)        47660094
476700                                 TO MR-NEW-PRICE (PV-SUB)         47670094
476800         ELSE                                                     47680094
476900             MOVE ASC-NEW-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)        47690094
477000                                 TO MR-NEW-PRICE-N (PV-SUB)       47700094
477100         END-IF                                                   47710094
477200         IF ASC-PRICE-DIFF-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)       47720094
477300             MOVE ASC-PRICE-DIFF-DISP                             47730094
477400                                 (ASC-BLK-SUB ASC-ITEM-SUB)       47740094
477500                                 TO MR-PRICE-DIFF (PV-SUB)        47750094
477600         ELSE                                                     47760094
477700             MOVE ASC-PRICE-DIFF (ASC-BLK-SUB ASC-ITEM-SUB)       47770094
477800                                 TO MR-PRICE-DIFF-N (PV-SUB)      47780094
477900         END-IF                                                   47790094
478000         IF ASC-QUANTITY (ASC-BLK-SUB ASC-ITEM-SUB) NUMERIC       47800094
478100              MOVE ASC-QUANTITY-N (ASC-BLK-SUB ASC-ITEM-SUB)      47810094
478200                                 TO MR-QUANTITY-N (PV-SUB)        47820094
478300         ELSE                                                     47830094
478400             MOVE ASC-QUANTITY (ASC-BLK-SUB ASC-ITEM-SUB)         47840094
478500                                 TO MR-QUANTITY (PV-SUB)          47850094
478600         END-IF                                                   47860094
478700     END-IF.                                                      47870094
478800*                                                                 47880094
478900     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)           47890094
479000                                                    = ZEROS       47900094
479100         ADD +1                    TO ASC-LAST-LIST-ITEM-NUMBER   47910094
479200         MOVE ASC-LAST-LIST-ITEM-NUMBER                           47920094
479300                                   TO ASC-LIST-ITEM-NUMBER        47930094
479400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   47940094
479500     END-IF.                                                      47950094
479600*                                                                 47960094
479700     ADD +1   TO ASC-ITEM-SUB.                                    47970094
479800*                                                                 47980094
479900 EJECT                                                            47990094
480000*----------------------------------------------------------------*48000094
480100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *48010094
480200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *48020094
480300*----------------------------------------------------------------*48030094
480400                                                                  48040094
480500 5100-WRITE-TEMP-STORAGE.                                         48050094
480600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     48060094
480700                                   TO PV-LIST-ITEM-NUMBER.        48070094
480800     COMPUTE PV-BLOCK-NUMBER =                                    48080094
480900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    48090094
481000                                                                  48100094
481100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             48110094
481200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             48120094
481300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      48130094
481400             PERFORM 7200-REWRITE-ASC-LISTQ                       48140094
481500         END-IF                                                   48150094
481600     ELSE                                                         48160094
481700         PERFORM 7225-WRITE-ASC-LISTQ                             48170094
481800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   48180094
481900                                                                  48190094
482000         SET ASC-ITEMS-IN-TEMP-ST  TO TRUE                        48200094
482100     END-IF.                                                      48210094
482200                                                                  48220094
482300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             48230094
482400*                                                                 48240094
482500 EJECT                                                            48250094
482600*----------------------------------------------------------------*48260094
482700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *48270094
482800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *48280094
482900*----------------------------------------------------------------*48290094
483000                                                                  48300094
483100 5200-WRITE-TEMP-STORAGE-ORIG.                                    48310094
483200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     48320094
483300                                   TO PV-LIST-ITEM-NUMBER.        48330094
483400     COMPUTE PV-BLOCK-NUMBER =                                    48340094
483500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    48350094
483600                                                                  48360094
483700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             48370094
483800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             48380094
483900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      48390094
484000             PERFORM 7200-REWRITE-ASC-LISTQ                       48400094
484100         END-IF                                                   48410094
484200     ELSE                                                         48420094
484300         PERFORM 7225-WRITE-ASC-LISTQ                             48430094
484400         PERFORM 7250-WRITE-ORIG-ASC-LISTQ                        48440094
484500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   48450094
484600                                 ASC-ORIG-HIGHEST-BLOCK-WRITTEN   48460094
484700                                                                  48470094
484800         SET ASC-ITEMS-IN-TEMP-ST  TO TRUE                        48480094
484900     END-IF.                                                      48490094
485000                                                                  48500094
485100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             48510094
485200*                                                                 48520094
485300 EJECT                                                            48530094
485400*----------------------------------------------------------------*48540094
485500*  DETERMINE IF ANY LINES WERE DELETED, AND IF SO, MOVE THE      *48550094
485600*  LINES UP.                                                     *48560094
485700*----------------------------------------------------------------*48570094
485800 6000-CHECK-FOR-DELETED-LINES.                                    48580094
485900     PERFORM 7050-DELETE-HOLD-QUEUE.                              48590094
486000     MOVE +0                       TO LQW-BLOCK-NUMBER            48600094
486100                                      PV-ROWS-WRITTEN-TO-LQW.     48610094
486200     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    48620094
486300                                   TO PV-LIST-ITEM-NUMBER.        48630094
486400     COMPUTE PV-BLOCK-NUMBER =                                    48640094
486500      1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).       48650094
486600     MOVE PV-BLOCK-NUMBER          TO PV-HOLD-BLOCK-TO-REDISPLAY. 48660094
486700     MOVE ASC-BLOCK-MODIFIED-SW (ASC-BLK-SUB)                     48670094
486800                                   TO PV-HOLD-BLOCK-MODIFIED.     48680094
486900*                                                                 48690094
487000     IF PV-BLOCK-NUMBER > 1                                       48700094
487100         PERFORM                                                  48710094
487200           VARYING LQW-BLOCK-NUMBER                               48720094
487300           FROM 1 BY 1                                            48730094
487400           UNTIL LQW-BLOCK-NUMBER = PV-BLOCK-NUMBER               48740094
487500             PERFORM 7125-READ-TS-INTO-LQW                        48750094
487600             PERFORM 7275-WRITE-HOLD-ASC-LISTQ                    48760094
487700             ADD PC-ITEMS-PER-PANEL                               48770094
487800                                   TO PV-ROWS-WRITTEN-TO-LQW      48780094
487900         END-PERFORM                                              48790094
488000         SUBTRACT +1 FROM LQW-BLOCK-NUMBER                        48800094
488100     END-IF.                                                      48810094
488200*                                                                 48820094
488300     INITIALIZE LQW-BLOCK-ENTRIES.                                48830094
488400     MOVE +0                       TO LQW-ITEM-SUB.               48840094
488500     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)         48850094
488600                                   TO PV-HOLD-LIST-ITEM-NUMBER.   48860094
488700     PERFORM 6100-MOVE-ASC-TO-LQW.                                48870094
488800*                                                                 48880094
488900     ADD +1                        TO ASC-BLK-SUB                 48890094
489000                                      PV-BLOCK-NUMBER.            48900094
489100     IF PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN               48910094
489200         CONTINUE                                                 48920094
489300     ELSE                                                         48930094
489400         IF ASC-BLK-SUB = PC-MAX-BLOCKS-IN-ARRAY                  48940094
489500             PERFORM 6100-MOVE-ASC-TO-LQW                         48950094
489600             ADD +1                TO PV-BLOCK-NUMBER             48960094
489700             IF PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN       48970094
489800                 CONTINUE                                         48980094
489900             ELSE                                                 48990094
490000                 PERFORM                                          49000094
490100                   VARYING PV-BLOCK-NUMBER                        49010094
490200                   FROM PV-BLOCK-NUMBER BY 1                      49020094
490300                   UNTIL PV-BLOCK-NUMBER >                        49030094
490400                                       ASC-HIGHEST-BLOCK-WRITTEN  49040094
490500                     MOVE +1       TO ASC-BLK-SUB                 49050094
490600                     PERFORM 7100-READ-TEMP-STORAGE               49060094
490700                     PERFORM 6100-MOVE-ASC-TO-LQW                 49070094
490800                 END-PERFORM                                      49080094
490900             END-IF                                               49090094
491000         ELSE                                                     49100094
491100             PERFORM                                              49110094
491200               VARYING PV-BLOCK-NUMBER                            49120094
491300               FROM PV-BLOCK-NUMBER BY 1                          49130094
491400               UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN  49140094
491500                 MOVE +1           TO ASC-BLK-SUB                 49150094
491600                 PERFORM 7100-READ-TEMP-STORAGE                   49160094
491700                 PERFORM 6100-MOVE-ASC-TO-LQW                     49170094
491800             END-PERFORM                                          49180094
491900         END-IF                                                   49190094
492000     END-IF.                                                      49200094
492100*                                                                 49210094
492200     PERFORM 7275-WRITE-HOLD-ASC-LISTQ.                           49220094
492300*                                                                 49230094
492400     PERFORM 7000-DELETE-LIST-QUEUE.                              49240094
492500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  49250094
492600     INITIALIZE ASC-BLOCK-ENTRIES (1)                             49260094
492700                ASC-BLOCK-ENTRIES (2).                            49270094
492800*                                                                 49280094
492900     PERFORM                                                      49290094
493000       VARYING PV-TEMP-BLOCK-NUMBER                               49300094
493100       FROM 1 BY 1                                                49310094
493200       UNTIL PV-TEMP-BLOCK-NUMBER > LQW-HIGHEST-BLOCK-WRITTEN     49320094
493300         MOVE +1                   TO ASC-BLK-SUB                 49330094
493400         PERFORM 7150-READ-LQW-INTO-TS                            49340094
493500*                                                                 49350094
493600         MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                 49360094
493700                                   TO PV-LIST-ITEM-NUMBER         49370094
493800         COMPUTE PV-BLOCK-NUMBER =                                49380094
493900             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL) 49390094
494000                                                                  49400094
494100         PERFORM 7225-WRITE-ASC-LISTQ                             49410094
494200         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   49420094
494300                                                                  49430094
494400     END-PERFORM.                                                 49440094
494500*                                                                 49450094
494600     IF ASC-HIGHEST-BLOCK-WRITTEN > 0                             49460094
494700         IF PV-HOLD-BLOCK-TO-REDISPLAY > ASC-HIGHEST-BLOCK-WRITTEN49470094
494800             PERFORM                                              49480094
494900               UNTIL PV-HOLD-BLOCK-TO-REDISPLAY <=                49490094
495000                                         ASC-HIGHEST-BLOCK-WRITTEN49500094
495100                 SUBTRACT +1       FROM PV-HOLD-BLOCK-TO-REDISPLAY49510094
495200             END-PERFORM                                          49520094
495300         END-IF                                                   49530094
495400         MOVE +1                   TO ASC-BLK-SUB                 49540094
495500         MOVE PV-HOLD-BLOCK-TO-REDISPLAY                          49550094
495600                                   TO PV-BLOCK-NUMBER             49560094
495700         PERFORM 7100-READ-TEMP-STORAGE                           49570094
495800         MOVE PV-HOLD-BLOCK-MODIFIED                              49580094
495900                                   TO ASC-BLOCK-MODIFIED-SW       49590094
496000                                     (ASC-BLK-SUB)                49600094
496100         ADD +1                    TO PV-BLOCK-NUMBER             49610094
496200         IF PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN           49620094
496300             CONTINUE                                             49630094
496400         ELSE                                                     49640094
496500             ADD +1                TO ASC-BLK-SUB                 49650094
496600             PERFORM 7100-READ-TEMP-STORAGE                       49660094
496700         END-IF                                                   49670094
496800     END-IF.                                                      49680094
496900*                                                                 49690094
497000 EJECT                                                            49700094
497100*----------------------------------------------------------------*49710094
497200*  MOVE THE LIST ASC TO THE HOLD ASC IN ORDER TO REMOVE THE     **49720094
497300*  DELETED LINES.  A LINE WILL BE DELETED BY SPACING OUT THE    **49730094
497400*  DEPT AND UPC.                                                  49740094
497500*----------------------------------------------------------------*49750094
497600 6100-MOVE-ASC-TO-LQW.                                            49760094
497700     PERFORM                                                      49770094
497800       VARYING ASC-ITEM-SUB                                       49780094
497900       FROM 1 BY 1                                                49790094
498000       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                    49800094
498100         IF (ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES      49810094
498200          OR ASC-UPC      (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)    49820094
498300             MOVE PV-HOLD-LIST-ITEM-NUMBER                        49830094
498400                                   TO ASC-LAST-LIST-ITEM-NUMBER   49840094
498500                                      ASC-LIST-ITEM-NUMBER        49850094
498600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   49860094
498700             ADD +1                TO LQW-ITEM-SUB                49870094
498800             IF LQW-ITEM-SUB > PC-ITEMS-PER-PANEL                 49880094
498900                 ADD +1            TO LQW-BLOCK-NUMBER            49890094
499000                 PERFORM 7275-WRITE-HOLD-ASC-LISTQ                49900094
499100                 INITIALIZE LQW-BLOCK-ENTRIES                     49910094
499200                 MOVE +1           TO LQW-ITEM-SUB                49920094
499300             END-IF                                               49930094
499400             MOVE ASC-ITEM-ENTRIES (ASC-BLK-SUB ASC-ITEM-SUB)     49940094
499500                                   TO LQW-ITEM-ENTRIES            49950094
499600                                      (LQW-ITEM-SUB)              49960094
499700             SET LQW-BLOCK-MODIFIED                               49970094
499800                                   TO TRUE                        49980094
499900             ADD +1                TO PV-HOLD-LIST-ITEM-NUMBER    49990094
500000                                      PV-ROWS-WRITTEN-TO-LQW      50000094
500100         END-IF                                                   50010094
500200     END-PERFORM.                                                 50020094
500300*                                                                 50030094
500400 EJECT                                                            50040094
500500*----------------------------------------------------------------*50050094
500600*  DETERMINE IF A LINE SHOULD BE ADDED, UPDATED BASED ON THE     *50060094
500700*  ORIGINAL DETAIL LINES.  ALSO DETERMINE IF AN ORIGINAL LINE    *50070094
500800*  SHOULD BE DELETED.                                            *50080094
500900*----------------------------------------------------------------*50090094
501000 6200-APPLY-DETAIL-CHANGES.                                       50100094
501100     MOVE +1                       TO PV-TEMP-BLOCK-NUMBER.       50110094
501200     IF ASC-ORIG-HIGHEST-BLOCK-WRITTEN > 0                        50120094
501300         PERFORM 7175-READ-ORIG-LISTQ                             50130094
501400     ELSE                                                         50140094
501500         INITIALIZE LQW-BLOCK-ENTRIES                             50150094
501600     END-IF.                                                      50160094
501700*                                                                 50170094
501800     MOVE +1                       TO ASC-BLK-SUB                 50180094
501900                                      ASC-ITEM-SUB                50190094
502000                                      LQW-ITEM-SUB                50200094
502100                                      PV-BLOCK-NUMBER.            50210094
502200     PERFORM 7100-READ-TEMP-STORAGE.                              50220094
502300     PERFORM 6250-MATCH-NEW-TO-OLD                                50230094
502400       UNTIL ((LQW-COMPARE-KEY (LQW-ITEM-SUB) = SPACES            50240094
502500         AND  ASC-COMPARE-KEY (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES)50250094
502600          OR  PV-TEMP-BLOCK-NUMBER >                              50260094
502700                                   ASC-ORIG-HIGHEST-BLOCK-WRITTEN 50270094
502800          OR  PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN).       50280094
502900*                                                                 50290094
503000     IF (LQW-COMPARE-KEY (LQW-ITEM-SUB) = SPACES                  50300094
503100     AND ASC-COMPARE-KEY (ASC-BLK-SUB ASC-ITEM-SUB) = SPACE)      50310094
503200         CONTINUE                                                 50320094
503300     ELSE                                                         50330094
503400         IF LQW-COMPARE-KEY (LQW-ITEM-SUB) = SPACES               50340094
503500             PERFORM                                              50350094
503600               UNTIL (PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN 50360094
503700                  OR ASC-COMPARE-KEY (ASC-BLK-SUB ASC-ITEM-SUB)   50370094
503800                                      = SPACES)                   50380094
503900                 PERFORM 6300-PROCESS-NEW-LINE-ADD                50390094
504000                 ADD +1            TO ASC-ITEM-SUB                50400094
504100                 IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL             50410094
504200                     MOVE +1       TO ASC-BLK-SUB                 50420094
504300                                      ASC-ITEM-SUB                50430094
504400                     ADD +1        TO PV-BLOCK-NUMBER             50440094
504500                     IF PV-BLOCK-NUMBER >                         50450094
504600                                       ASC-HIGHEST-BLOCK-WRITTEN  50460094
504700                         INITIALIZE ASC-BLOCK-ENTRIES             50470094
504800                                                     (ASC-BLK-SUB)50480094
504900                     ELSE                                         50490094
505000                         PERFORM 7100-READ-TEMP-STORAGE           50500094
505100                     END-IF                                       50510094
505200                 END-IF                                           50520094
505300             END-PERFORM                                          50530094
505400         ELSE                                                     50540094
505500             PERFORM                                              50550094
505600               UNTIL (PV-TEMP-BLOCK-NUMBER >                      50560094
505700                                   ASC-ORIG-HIGHEST-BLOCK-WRITTEN 50570094
505800                  OR LQW-COMPARE-KEY (LQW-ITEM-SUB) = SPACES)     50580094
505900                 PERFORM 6400-PROCESS-ORIG-LINE-DELETE            50590094
506000                 ADD +1            TO LQW-ITEM-SUB                50600094
506100                 IF LQW-ITEM-SUB > PC-ITEMS-PER-PANEL             50610094
506200                     MOVE +1       TO LQW-ITEM-SUB                50620094
506300                     ADD +1        TO PV-TEMP-BLOCK-NUMBER        50630094
506400                     IF PV-TEMP-BLOCK-NUMBER >                    50640094
506500                                   ASC-ORIG-HIGHEST-BLOCK-WRITTEN 50650094
506600                         INITIALIZE LQW-BLOCK-ENTRIES             50660094
506700                     ELSE                                         50670094
506800                         PERFORM 7175-READ-ORIG-LISTQ             50680094
506900                     END-IF                                       50690094
507000                 END-IF                                           50700094
507100             END-PERFORM                                          50710094
507200         END-IF                                                   50720094
507300     END-IF.                                                      50730094
507400*                                                                 50740094
507500 EJECT                                                            50750094
507600*----------------------------------------------------------------*50760094
507700*  MATCH THE NEW TEMP STORAGE TO THE ORIGINAL TEMP STORAGE TO    *50770094
507800*  DETERMINE WHAT SHOULD BE ADDED, UPDATED OR DELETED.           *50780094
507900*----------------------------------------------------------------*50790094
508000 6250-MATCH-NEW-TO-OLD.                                           50800094
508100     EVALUATE TRUE                                                50810094
508200         WHEN (ASC-COMPARE-KEY (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES50820094
508300          AND  ASC-ROW-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = ZEROS)    50830094
508400             PERFORM 6400-PROCESS-ORIG-LINE-DELETE                50840094
508500             ADD +1                TO LQW-ITEM-SUB                50850094
508600                                                                  50860094
508700         WHEN LQW-ROW-NBR (LQW-ITEM-SUB) = ZEROS                  50870094
508800             PERFORM 6300-PROCESS-NEW-LINE-ADD                    50880094
508900             ADD +1                TO ASC-ITEM-SUB                50890094
509000                                                                  50900094
509100         WHEN (LQW-ROW-NBR (LQW-ITEM-SUB) = ASC-ROW-NBR           50910094
509200                                    (ASC-BLK-SUB ASC-ITEM-SUB)    50920094
509300          AND  LQW-ROW-NBR (LQW-ITEM-SUB) NOT = ZEROS)            50930094
509400             PERFORM 6500-PROCESS-LINE-UPDATE                     50940094
509500             ADD +1                TO ASC-ITEM-SUB                50950094
509600                                      LQW-ITEM-SUB                50960094
509700                                                                  50970094
509800         WHEN (ASC-COMPARE-KEY (ASC-BLK-SUB ASC-ITEM-SUB)         50980094
509900                                                      NOT = SPACES50990094
510000          AND  ASC-ROW-NBR (ASC-BLK-SUB ASC-ITEM-SUB) = ZEROS)    51000094
510100             PERFORM 6300-PROCESS-NEW-LINE-ADD                    51010094
510200             ADD +1                TO ASC-ITEM-SUB                51020094
510300                                                                  51030094
510400         WHEN (ASC-ROW-NBR (ASC-BLK-SUB ASC-ITEM-SUB) >           51040094
510500               LQW-ROW-NBR (LQW-ITEM-SUB))                        51050094
510600             PERFORM 6400-PROCESS-ORIG-LINE-DELETE                51060094
510700             ADD +1                TO LQW-ITEM-SUB                51070094
510800     END-EVALUATE.                                                51080094
510900*                                                                 51090094
511000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         51100094
511100         MOVE +1                   TO ASC-BLK-SUB                 51110094
511200                                      ASC-ITEM-SUB                51120094
511300         ADD +1                    TO PV-BLOCK-NUMBER             51130094
511400         IF PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN           51140094
511500             INITIALIZE ASC-BLOCK-ENTRIES  (ASC-BLK-SUB)          51150094
511600         ELSE                                                     51160094
511700             PERFORM 7100-READ-TEMP-STORAGE                       51170094
511800         END-IF                                                   51180094
511900     END-IF.                                                      51190094
512000*                                                                 51200094
512100     IF LQW-ITEM-SUB > PC-ITEMS-PER-PANEL                         51210094
512200         MOVE +1                   TO LQW-ITEM-SUB                51220094
512300         ADD +1                    TO PV-TEMP-BLOCK-NUMBER        51230094
512400         IF PV-TEMP-BLOCK-NUMBER >                                51240094
512500                       ASC-ORIG-HIGHEST-BLOCK-WRITTEN             51250094
512600             INITIALIZE LQW-BLOCK-ENTRIES                         51260094
512700         ELSE                                                     51270094
512800             PERFORM 7175-READ-ORIG-LISTQ                         51280094
512900         END-IF                                                   51290094
513000     END-IF.                                                      51300094
513100*                                                                 51310094
513200 EJECT                                                            51320094
513300*----------------------------------------------------------------*51330094
513400*  ADD ALL THE NEW LINES TO THE DETAIL TABLE.                    *51340094
513500*----------------------------------------------------------------*51350094
513600 6300-PROCESS-NEW-LINE-ADD.                                       51360094
513700     MOVE ASC-KEY-STORE-NBR        TO SPPCDT-DEST-LOC-NBR.        51370094
513800     MOVE ASC-KEY-DOC-NBR-N        TO SPPCDT-DOC-NBR.             51380094
513900     PERFORM 6350-GET-NEXT-ROW-NBR.                               51390094
514000     MOVE ASC-DEPT-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                 51400094
514100                                   TO SPPCDT-DEPT-NBR.            51410094
514200     MOVE ASC-CLASS-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                51420094
514300                                   TO SPPCDT-SUB-CL-NBR.          51430094
514400     MOVE ASC-MAJ-CLASS-NBR (ASC-BLK-SUB ASC-ITEM-SUB)            51440094
514500                                   TO SPPCDT-MAJ-CL-NBR.          51450094
514600     MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                  51460094
514700                                   TO SPPCDT-SKU-NBR.             51470094
514800     MOVE ASC-QUANTITY-N (ASC-BLK-SUB ASC-ITEM-SUB)               51480094
514900                                   TO SPPCDT-ACTL-PR-CHG-QTY.     51490094
515000     COMPUTE PV-PRICE-DIFF = ASC-ORIGINAL-PRICE                   51500094
515100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     51510094
515200                           - ASC-NEW-PRICE                        51520094
515300                                   (ASC-BLK-SUB ASC-ITEM-SUB).    51530094
515400     COMPUTE SPPCDT-ACTL-PR-CHG-AMT =                             51540094
515500        (PV-PRICE-DIFF * ASC-QUANTITY-N                           51550094
515600                         (ASC-BLK-SUB ASC-ITEM-SUB)).             51560094
515700     MOVE ASC-ORIGINAL-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)           51570094
515800                                   TO SPPCDT-OLD-PR.              51580094
515900     MOVE ASC-NEW-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)                51590094
516000                                   TO SPPCDT-NEW-PR.              51600094
516100     MOVE ASC-UPC-N (ASC-BLK-SUB ASC-ITEM-SUB)                    51610094
516200                                   TO SPPCDT-UPC-NBR.             51620094
516300     MOVE ASC-ITEM-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                 51630094
516400                                   TO SPPCDT-ITEM-NBR.            51640094
516500                                                                  51650094
516600     PERFORM 8500-INSERT-DETAIL-LINE.                             51660094
516700     SET PS-UPDATE-PERFORMED       TO TRUE.                       51670094
516800*                                                                 51680094
516900 EJECT                                                            51690094
517000*----------------------------------------------------------------*51700094
517100*  GET THE HIGHEST ROW NUMBER FOR A PARTICULAR STORE/DOC AND     *51710094
517200*  ADD 1 TO IT TO GET THE NEXT ROW NUMBER.                       *51720094
517300*----------------------------------------------------------------*51730094
517400 6350-GET-NEXT-ROW-NBR.                                           51740094
517500     INITIALIZE PV-SPPCDT-ROW-NBR-NI.                             51750094
517600*                                                                 51760094
517700     EXEC SQL                                                     51770094
517800         SELECT MAX(ROW_NBR)                                      51780094
517900           INTO :SPPCDT-ROW-NBR:PV-SPPCDT-ROW-NBR-NI              51790094
518000           FROM TSPPCDT                                           51800094
518100          WHERE (DEST_LOC_NBR = :DK-STORE-NBR                     51810094
518200            AND  DOC_NBR      = :DK-DOC-NBR)                      51820094
518300     END-EXEC                                                     51830094
518400                                                                  51840094
518500     EVALUATE TRUE                                                51850094
518600         WHEN SQLCODE = ZERO                                      51860094
518700             CONTINUE                                             51870094
518800         WHEN SQLWARN0 NOT = SPACES                               51880094
518900         WHEN SQLCODE < ZERO                                      51890094
519000         WHEN SQLCODE > ZERO                                      51900094
519100             MOVE '6350-GET-NEXT-ROW-NBR'                         51910094
519200                                   TO DP013-PARAGRAPH             51920094
519300             MOVE 'DELETE A ROW FROM THE DETAIL TABLE'            51930094
519400                                   TO DP013-MESSAGE-TEXT (1)      51940094
519500             MOVE SQLCA            TO DP013-SQLCA                 51950094
519600             MOVE 'TSPPCDT'        TO DP013-DB2-TABLE-NAME (1)    51960094
519700             SET DP013-DB2-ABEND                                  51970094
519800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               51980094
519900             PERFORM DP013-0000-PROCESS-ABEND                     51990094
520000     END-EVALUATE.                                                52000094
520100*                                                                 52010094
520200     IF PV-SPPCDT-ROW-NBR-NI = -1                                 52020094
520300         MOVE +1                   TO SPPCDT-ROW-NBR              52030094
520400     ELSE                                                         52040094
520500         ADD +1                    TO SPPCDT-ROW-NBR              52050094
520600     END-IF.                                                      52060094
520700*                                                                 52070094
520800 EJECT                                                            52080094
520900*----------------------------------------------------------------*52090094
521000*  DELETE THE ROW FROM THE DETAIL TABLE.                         *52100094
521100*----------------------------------------------------------------*52110094
521200 6400-PROCESS-ORIG-LINE-DELETE.                                   52120094
521300     MOVE LQW-SKU-NBR (LQW-ITEM-SUB)                              52130094
521400                                   TO DK-SKU-NBR.                 52140094
521500     MOVE LQW-ROW-NBR (LQW-ITEM-SUB)                              52150094
521600                                   TO DK-ROW-NBR.                 52160094
521700     PERFORM 8600-DELETE-DETAIL-LINE.                             52170094
521800     SET PS-UPDATE-PERFORMED       TO TRUE.                       52180094
521900*                                                                 52190094
522000 EJECT                                                            52200094
522100*----------------------------------------------------------------*52210094
522200*  DELETE THE ROW FROM THE DETAIL TABLE.                         *52220094
522300*----------------------------------------------------------------*52230094
522400 6500-PROCESS-LINE-UPDATE.                                        52240094
522500     IF (ASC-QUANTITY-N (ASC-BLK-SUB ASC-ITEM-SUB) =              52250094
522600                                   LQW-QUANTITY-N (LQW-ITEM-SUB)  52260094
522700     AND ASC-ORIGINAL-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) =          52270094
522800                               LQW-ORIGINAL-PRICE (LQW-ITEM-SUB)  52280094
522900     AND ASC-NEW-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) =               52290094
523000                               LQW-NEW-PRICE (LQW-ITEM-SUB))      52300094
523100         CONTINUE                                                 52310094
523200     ELSE                                                         52320094
523300         PERFORM 6550-PREPARE-LAYOUT-FOR-UPDATE                   52330094
523400         PERFORM 8700-UPDATE-DETAIL-LINE                          52340094
523500         SET PS-UPDATE-PERFORMED   TO TRUE                        52350094
523600     END-IF.                                                      52360094
523700*                                                                 52370094
523800 EJECT                                                            52380094
523900*----------------------------------------------------------------*52390094
524000*  DETERMINE IF THE TOTAL QUANTITY FIELD IS CORRECT BASED ON THE *52400094
524100*  QUANTITIES ENTERED.                                           *52410094
524200*----------------------------------------------------------------*52420094
524300 6600-CHECK-TOTAL-QUANTITY.                                       52430094
524400                                                                  52440094
524500     MOVE +0                       TO PV-TOTAL-QUANTITY           52450094
524600                                      PV-TOTAL-LINES.             52460094
524700     PERFORM                                                      52470094
524800       VARYING LQW-BLOCK-NUMBER                                   52480094
524900       FROM 1 BY 1                                                52490094
525000       UNTIL LQW-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         52500094
525100                                                                  52510094
525200         PERFORM 7125-READ-TS-INTO-LQW                            52520094
525300                                                                  52530094
525400         MOVE 1                    TO LQW-ITEM-SUB                52540094
525500         PERFORM                                                  52550094
525600           VARYING LQW-ITEM-SUB                                   52560094
525700           FROM 1 BY 1                                            52570094
525800           UNTIL LQW-ITEM-SUB > PC-ITEMS-PER-PANEL                52580094
525900             IF LQW-SKU-NBR (LQW-ITEM-SUB) = SPACES               52590094
526000                 CONTINUE                                         52600094
526100             ELSE                                                 52610094
526200                 ADD LQW-QUANTITY-N (LQW-ITEM-SUB)                52620094
526300                                   TO PV-TOTAL-QUANTITY           52630094
526400                 ADD +1            TO PV-TOTAL-LINES              52640094
526500                 IF PE049-IS-INVENTORY-MISSED-RSN AND             52650094
526600                    PE049-MARKDOWN                                52660094
526700                     IF (LQW-NEW-PRICE (LQW-ITEM-SUB) > 0 AND     52670094
526800                         LQW-QUANTITY-N (LQW-ITEM-SUB) > 0) OR    52680094
526900                        (LQW-NEW-PRICE (LQW-ITEM-SUB) = 0 AND     52690094
527000                         LQW-QUANTITY-N (LQW-ITEM-SUB) = 0)       52700094
527100                         CONTINUE                                 52710094
527200                     ELSE                                         52720094
527300                         SET PS-ERROR                             52730094
527400                             DP020-MSG-FATAL                      52740094
527500                                 TO TRUE                          52750094
527600*  --- PRICE/QTY MUST ALL BE ZERO OR NON-ZERO                     52760094
527700                         MOVE PC-TSYMSG-00980                     52770094
527800                                 TO DP020-MSG-NUMBER              52780094
527900                     END-IF                                       52790094
528000                 END-IF                                           52800094
528100             END-IF                                               52810094
528200         END-PERFORM                                              52820094
528300     END-PERFORM.                                                 52830094
528400                                                                  52840094
528500     IF ASC-TOTAL-QUANTITY-N = PV-TOTAL-QUANTITY                  52850094
528600         IF PV-TOTAL-QUANTITY > PC-MAX-TOTAL-QUANTITY             52860094
528700             SET PS-ERROR                                         52870094
528800                 DP020-MSG-FATAL                                  52880094
528900                 DP030-SET-CURSOR-APPL-1 TO TRUE                  52890094
529000*     --- TOTAL QUANTITY GREATER THAN THE MAX QUANTITY ---        52900094
529100             MOVE PC-TSYMSG-00626  TO DP020-MSG-NUMBER            52910094
529200             MOVE DP015-UNP-ALP-BRT-OFF                           52920094
529300                                   TO MR-TOTAL-QUANTITYA          52930094
529400             MOVE DP015-RED        TO MR-TOTAL-QUANTITYC          52940094
529500             MOVE DP015-REVERSE    TO MR-TOTAL-QUANTITYH          52950094
529600             MOVE -1               TO MR-TOTAL-QUANTITYL          52960094
529700         END-IF                                                   52970094
529800     ELSE                                                         52980094
529900         SET PS-ERROR                                             52990094
530000             DP020-MSG-FATAL                                      53000094
530100             DP030-SET-CURSOR-APPL-1 TO TRUE                      53010094
530200*     --- TOTAL QUANTITY DOES NOT EQUAL DETAIL QUANTITIES ---     53020094
530300         MOVE PC-TSYMSG-00611      TO DP020-MSG-NUMBER            53030094
530400         MOVE DP015-UNP-ALP-BRT-OFF                               53040094
530500                                   TO MR-TOTAL-QUANTITYA          53050094
530600         MOVE DP015-RED            TO MR-TOTAL-QUANTITYC          53060094
530700         MOVE DP015-REVERSE        TO MR-TOTAL-QUANTITYH          53070094
530800         MOVE -1                   TO MR-TOTAL-QUANTITYL          53080094
530900     END-IF.                                                      53090094
531000                                                                  53100094
531100                                                                  53110094
531200*                                                                 53120094
531300 EJECT                                                            53130094
531400*----------------------------------------------------------------*53140094
531500*  PREPARE THE DETAIL LINE FOR UPDATE.                           *53150094
531600*----------------------------------------------------------------*53160094
531700 6550-PREPARE-LAYOUT-FOR-UPDATE.                                  53170094
531800     MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                  53180094
531900                                   TO DK-SKU-NBR.                 53190094
532000     MOVE ASC-ROW-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                  53200094
532100                                   TO DK-ROW-NBR.                 53210094
532200     MOVE ASC-QUANTITY-N (ASC-BLK-SUB ASC-ITEM-SUB)               53220094
532300                                   TO SPPCDT-ACTL-PR-CHG-QTY.     53230094
532400     MOVE ASC-ORIGINAL-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)           53240094
532500                                   TO SPPCDT-OLD-PR.              53250094
532600     MOVE ASC-NEW-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)                53260094
532700                                   TO SPPCDT-NEW-PR.              53270094
532800     COMPUTE PV-PRICE-DIFF = ASC-ORIGINAL-PRICE                   53280094
532900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     53290094
533000                           - ASC-NEW-PRICE                        53300094
533100                                   (ASC-BLK-SUB ASC-ITEM-SUB).    53310094
533200     COMPUTE SPPCDT-ACTL-PR-CHG-AMT =                             53320094
533300        (PV-PRICE-DIFF * ASC-QUANTITY-N                           53330094
533400                        (ASC-BLK-SUB ASC-ITEM-SUB)).              53340094
533500*                                                                 53350094
533600 EJECT                                                            53360094
533700*----------------------------------------------------------------*53370094
533800*  UPDATE THE HEADER TABLE WITH CHANGES.                         *53380094
533900*----------------------------------------------------------------*53390094
534000 6900-APPLY-HEADER-CHANGES.                                       53400094
534100     IF (ASC-STATUS-CODE = PE049-IS-AVAILABLE-STATUS-CDE          53410094
534200      OR ASC-STATUS-CODE = PE049-IS-DELINQUENT-STATUS-CDE         53420094
534300      OR ASC-STATUS-CODE = PE049-IS-GENERATED-STATUS-CDE)         53430094
534400         MOVE PE049-IS-CNTS-ENTER-STATUS-CDE                      53440094
534500                                   TO STRPPC-STATUS-CDE           53450094
534600         MOVE ASC-STATUS-CODE      TO STRPPC-PREV-STATUS-CDE      53460094
534700         MOVE ASC-REASON-CODE      TO PV-HOLD-TYPE-REASON-CODE    53470094
534800         PERFORM 6925-PREPARE-HEADER-FOR-UPDATE                   53480094
534900         PERFORM 8150-UPDATE-HEADER                               53490094
535000         SET PS-UPDATE-PERFORMED   TO TRUE                        53500094
535100     ELSE                                                         53510094
535200         MOVE ASC-REASON-CODE      TO PV-HOLD-TYPE-REASON-CODE    53520094
535300         PERFORM 8100-GET-HEADER-INFO                             53530094
535400         IF (ASC-EFFECTIVE-NAME  = STRPPC-PR-CHG-CPL-NAME         53540094
535500         AND ASC-EFFECTIVE-DATE-ISO                               53550094
535600                                 = STRPPC-EFF-DTE                 53560094
535700         AND PV-HOLD-TYPE-CODE   = STRPPC-TYP-CDE                 53570094
535800         AND PV-HOLD-REASON-CODE = STRPPC-RSN-CDE                 53580094
535900         AND ASC-DEPT-AREA       = STRPPC-DEPT-AREA-DEST)         53590094
536000           CONTINUE                                               53600094
536100         ELSE                                                     53610094
536200             PERFORM 6925-PREPARE-HEADER-FOR-UPDATE               53620094
536300             PERFORM 8150-UPDATE-HEADER                           53630094
536400             SET PS-UPDATE-PERFORMED   TO TRUE                    53640094
536500         END-IF                                                   53650094
536600     END-IF.                                                      53660094
536700*                                                                 53670094
536800 EJECT                                                            53680094
536900*----------------------------------------------------------------*53690094
537000*  MOVE THE UPDATED HEADER FIELDS TO THE TABLE FOR UPDATE.       *53700094
537100*----------------------------------------------------------------*53710094
537200 6925-PREPARE-HEADER-FOR-UPDATE.                                  53720094
537300     MOVE ASC-EFFECTIVE-NAME       TO STRPPC-PR-CHG-CPL-NAME.     53730094
537400     MOVE ASC-EFFECTIVE-DATE-ISO   TO STRPPC-EFF-DTE.             53740094
537500     MOVE PV-HOLD-TYPE-CODE        TO STRPPC-TYP-CDE.             53750094
537600     MOVE PV-HOLD-REASON-CODE      TO STRPPC-RSN-CDE.             53760094
537700     MOVE ASC-DEPT-AREA            TO STRPPC-DEPT-AREA-DEST.      53770094
537800     MOVE DK-CURRENT-DATE-ISO      TO STRPPC-ENTR-DTE.            53780094
537900     MOVE DK-EDITED-TIME-HMS       TO STRPPC-ENTR-TIME.           53790094
538000     MOVE DK-USER-ID               TO STRPPC-ENTR-ID.             53800094
538100*                                                                 53810094
538200 EJECT                                                            53820094
538300*----------------------------------------------------------------*53830094
538400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *53840094
538500*----------------------------------------------------------------*53850094
538600 7000-DELETE-LIST-QUEUE.                                          53860094
538700                                                                  53870094
538800     EXEC CICS                                                    53880094
538900         DELETEQ TS                                               53890094
539000             QUEUE (ASC-LIST-QUEUE-NAME)                          53900094
539100             RESP  (PV-CICS-RESP)                                 53910094
539200     END-EXEC.                                                    53920094
539300                                                                  53930094
539400     IF (PV-CICS-RESP = DFHRESP(NORMAL)                           53940094
539500     OR  PV-CICS-RESP = DFHRESP(QIDERR))                          53950094
539600         CONTINUE                                                 53960094
539700     ELSE                                                         53970094
539800         SET DP013-CICS-ABEND      TO TRUE                        53980094
539900         SET DP013-NO-ROLLBACK     TO TRUE                        53990094
540000                                                                  54000094
540100         MOVE '7000-DELETE-LIST-QUEUE'                            54010094
540200                                   TO DP013-PARAGRAPH             54020094
540300         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    54030094
540400                                   TO DP013-MESSAGE-TEXT (1)      54040094
540500         PERFORM DP013-0000-PROCESS-ABEND                         54050094
540600     END-IF.                                                      54060094
540700                                                                  54070094
540800     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  54080094
540900*                                                                 54090094
541000 EJECT                                                            54100094
541100*----------------------------------------------------------------*54110094
541200*  DELETE THE ORIGINAL ITEMS TEMP STORAGE QUEUE.                 *54120094
541300*----------------------------------------------------------------*54130094
541400 7025-DELETE-ORIG-QUEUE.                                          54140094
541500                                                                  54150094
541600     EXEC CICS                                                    54160094
541700         DELETEQ TS                                               54170094
541800             QUEUE (ASC-ORIG-QUEUE-NAME)                          54180094
541900             RESP  (PV-CICS-RESP)                                 54190094
542000     END-EXEC.                                                    54200094
542100                                                                  54210094
542200     IF (PV-CICS-RESP = DFHRESP(NORMAL)                           54220094
542300     OR  PV-CICS-RESP = DFHRESP(QIDERR))                          54230094
542400         CONTINUE                                                 54240094
542500     ELSE                                                         54250094
542600         SET DP013-CICS-ABEND      TO TRUE                        54260094
542700         SET DP013-NO-ROLLBACK     TO TRUE                        54270094
542800                                                                  54280094
542900         MOVE '7025-DELETE-ORIG-QUEUE'                            54290094
543000                                   TO DP013-PARAGRAPH             54300094
543100         MOVE 'ERROR TRYING TO DELETE ORIG TEMP STORAGE QUEUE'    54310094
543200                                   TO DP013-MESSAGE-TEXT (1)      54320094
543300         PERFORM DP013-0000-PROCESS-ABEND                         54330094
543400     END-IF.                                                      54340094
543500     MOVE +0                       TO                             54350094
543600                                 ASC-ORIG-HIGHEST-BLOCK-WRITTEN.  54360094
543700*                                                                 54370094
543800 EJECT                                                            54380094
543900*----------------------------------------------------------------*54390094
544000*  DELETE THE HOLD ITEMS TEMP STORAGE QUEUE.                     *54400094
544100*----------------------------------------------------------------*54410094
544200 7050-DELETE-HOLD-QUEUE.                                          54420094
544300                                                                  54430094
544400     EXEC CICS                                                    54440094
544500         DELETEQ TS                                               54450094
544600             QUEUE (ASC-HOLD-QUEUE-NAME)                          54460094
544700             RESP  (PV-CICS-RESP)                                 54470094
544800     END-EXEC.                                                    54480094
544900                                                                  54490094
545000     IF (PV-CICS-RESP = DFHRESP(NORMAL)                           54500094
545100     OR  PV-CICS-RESP = DFHRESP(QIDERR))                          54510094
545200         CONTINUE                                                 54520094
545300     ELSE                                                         54530094
545400         SET DP013-CICS-ABEND      TO TRUE                        54540094
545500         SET DP013-NO-ROLLBACK     TO TRUE                        54550094
545600                                                                  54560094
545700         MOVE '7050-DELETE-HOLD-QUEUE'                            54570094
545800                                   TO DP013-PARAGRAPH             54580094
545900         MOVE 'ERROR TRYING TO DELETE HOLD TEMP STORAGE QUEUE'    54590094
546000                                   TO DP013-MESSAGE-TEXT (1)      54600094
546100         PERFORM DP013-0000-PROCESS-ABEND                         54610094
546200     END-IF.                                                      54620094
546300*                                                                 54630094
546400 EJECT                                                            54640094
546500*----------------------------------------------------------------*54650094
546600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *54660094
546700*----------------------------------------------------------------*54670094
546800                                                                  54680094
546900 7100-READ-TEMP-STORAGE.                                          54690094
547000                                                                  54700094
547100     EXEC CICS                                                    54710094
547200         READQ TS                                                 54720094
547300             QUEUE (ASC-LIST-QUEUE-NAME)                          54730094
547400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               54740094
547500             ITEM  (PV-BLOCK-NUMBER)                              54750094
547600             RESP  (PV-CICS-RESP)                                 54760094
547700     END-EXEC.                                                    54770094
547800                                                                  54780094
547900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       54790094
548000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     54800094
548100         CONTINUE                                                 54810094
548200     ELSE                                                         54820094
548300         SET DP013-CICS-ABEND     TO TRUE                         54830094
548400         SET DP013-NO-ROLLBACK    TO TRUE                         54840094
548500         MOVE '7100-READ-TEMP-STORAGE'                            54850094
548600                                  TO DP013-PARAGRAPH              54860094
548700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      54870094
548800                                  TO DP013-MESSAGE-TEXT(1)        54880094
548900         PERFORM DP013-0000-PROCESS-ABEND                         54890094
549000     END-IF.                                                      54900094
549100                                                                  54910094
549200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             54920094
549300*                                                                 54930094
549400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         54940094
549500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               54950094
549600     END-IF.                                                      54960094
549700*                                                                 54970094
549800 EJECT                                                            54980094
549900*----------------------------------------------------------------*54990094
550000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE HOLD LQW.      *55000094
550100*----------------------------------------------------------------*55010094
550200                                                                  55020094
550300 7125-READ-TS-INTO-LQW.                                           55030094
550400                                                                  55040094
550500     EXEC CICS                                                    55050094
550600         READQ TS                                                 55060094
550700             QUEUE (ASC-LIST-QUEUE-NAME)                          55070094
550800             INTO  (LQW-BLOCK-ENTRIES)                            55080094
550900             ITEM  (LQW-BLOCK-NUMBER)                             55090094
551000             RESP  (PV-CICS-RESP)                                 55100094
551100     END-EXEC.                                                    55110094
551200                                                                  55120094
551300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       55130094
551400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     55140094
551500         CONTINUE                                                 55150094
551600     ELSE                                                         55160094
551700         SET DP013-CICS-ABEND     TO TRUE                         55170094
551800         SET DP013-NO-ROLLBACK    TO TRUE                         55180094
551900         MOVE '7125-READ-TS-INTO-LQW'                             55190094
552000                                  TO DP013-PARAGRAPH              55200094
552100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      55210094
552200                                  TO DP013-MESSAGE-TEXT(1)        55220094
552300         PERFORM DP013-0000-PROCESS-ABEND                         55230094
552400     END-IF.                                                      55240094
552500*                                                                 55250094
552600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         55260094
552700         INITIALIZE LQW-BLOCK-ENTRIES                             55270094
552800     END-IF.                                                      55280094
552900*                                                                 55290094
553000 EJECT                                                            55300094
553100*----------------------------------------------------------------*55310094
553200*    READ A BLOCK FROM HOLD TEMP STORAGE INTO THE ASC TEMP       *55320094
553300*    STORAGE.                                                    *55330094
553400*----------------------------------------------------------------*55340094
553500                                                                  55350094
553600 7150-READ-LQW-INTO-TS.                                           55360094
553700                                                                  55370094
553800     EXEC CICS                                                    55380094
553900         READQ TS                                                 55390094
554000             QUEUE (ASC-HOLD-QUEUE-NAME)                          55400094
554100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               55410094
554200             ITEM  (PV-TEMP-BLOCK-NUMBER)                         55420094
554300             RESP  (PV-CICS-RESP)                                 55430094
554400     END-EXEC.                                                    55440094
554500                                                                  55450094
554600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       55460094
554700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     55470094
554800         CONTINUE                                                 55480094
554900     ELSE                                                         55490094
555000         SET DP013-CICS-ABEND     TO TRUE                         55500094
555100         SET DP013-NO-ROLLBACK    TO TRUE                         55510094
555200         MOVE '7150-READ-LQW-INTO-TS'                             55520094
555300                                  TO DP013-PARAGRAPH              55530094
555400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      55540094
555500                                  TO DP013-MESSAGE-TEXT(1)        55550094
555600         PERFORM DP013-0000-PROCESS-ABEND                         55560094
555700     END-IF.                                                      55570094
555800*                                                                 55580094
555900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         55590094
556000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               55600094
556100     END-IF.                                                      55610094
556200*                                                                 55620094
556300 EJECT                                                            55630094
556400*----------------------------------------------------------------*55640094
556500*    READ A BLOCK FROM THE ORIGINAL TEMP STORAGE QUEUE INTO THE  *55650094
556600*    HOLD AREA.                                                  *55660094
556700*----------------------------------------------------------------*55670094
556800                                                                  55680094
556900 7175-READ-ORIG-LISTQ.                                            55690094
557000                                                                  55700094
557100     EXEC CICS                                                    55710094
557200         READQ TS                                                 55720094
557300             QUEUE (ASC-ORIG-QUEUE-NAME)                          55730094
557400             INTO  (LQW-BLOCK-ENTRIES)                            55740094
557500             ITEM  (PV-TEMP-BLOCK-NUMBER)                         55750094
557600             RESP  (PV-CICS-RESP)                                 55760094
557700     END-EXEC.                                                    55770094
557800                                                                  55780094
557900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       55790094
558000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     55800094
558100         CONTINUE                                                 55810094
558200     ELSE                                                         55820094
558300         SET DP013-CICS-ABEND     TO TRUE                         55830094
558400         SET DP013-NO-ROLLBACK    TO TRUE                         55840094
558500         MOVE '7175-READ-ORIG-LISTQ'                              55850094
558600                                  TO DP013-PARAGRAPH              55860094
558700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      55870094
558800                                  TO DP013-MESSAGE-TEXT(1)        55880094
558900         PERFORM DP013-0000-PROCESS-ABEND                         55890094
559000     END-IF.                                                      55900094
559100                                                                  55910094
559200*                                                                 55920094
559300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         55930094
559400         INITIALIZE LQW-BLOCK-ENTRIES                             55940094
559500     END-IF.                                                      55950094
559600*                                                                 55960094
559700 EJECT                                                            55970094
559800*----------------------------------------------------------------*55980094
559900*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *55990094
560000*  SPECIFIC COMMAREA.                                            *56000094
560100*----------------------------------------------------------------*56010094
560200 7200-REWRITE-ASC-LISTQ.                                          56020094
560300     EXEC CICS                                                    56030094
560400         WRITEQ TS                                                56040094
560500             QUEUE (ASC-LIST-QUEUE-NAME)                          56050094
560600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56060094
560700             ITEM  (PV-BLOCK-NUMBER)                              56070094
560800             REWRITE                                              56080094
560900             RESP  (PV-CICS-RESP)                                 56090094
561000     END-EXEC.                                                    56100094
561100                                                                  56110094
561200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           56120094
561300         CONTINUE                                                 56130094
561400     ELSE                                                         56140094
561500         SET DP013-CICS-ABEND            TO TRUE                  56150094
561600         SET DP013-NO-ROLLBACK           TO TRUE                  56160094
561700         MOVE '7200-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       56170094
561800         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     56180094
561900                                         TO DP013-MESSAGE-TEXT(1) 56190094
562000         PERFORM DP013-0000-PROCESS-ABEND                         56200094
562100     END-IF.                                                      56210094
562200*                                                                 56220094
562300 EJECT                                                            56230094
562400*----------------------------------------------------------------*56240094
562500*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *56250094
562600*  SPECIFIC COMMAREA.                                            *56260094
562700*----------------------------------------------------------------*56270094
562800 7225-WRITE-ASC-LISTQ.                                            56280094
562900     EXEC CICS                                                    56290094
563000         WRITEQ TS                                                56300094
563100             QUEUE (ASC-LIST-QUEUE-NAME)                          56310094
563200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56320094
563300             ITEM  (PV-BLOCK-NUMBER)                              56330094
563400             RESP  (PV-CICS-RESP)                                 56340094
563500     END-EXEC.                                                    56350094
563600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      56360094
563700         SET DP013-CICS-ABEND      TO TRUE                        56370094
563800         SET DP013-NO-ROLLBACK     TO TRUE                        56380094
563900         MOVE '7225-WRITE-ASC-LISTQ'                              56390094
564000                                   TO DP013-PARAGRAPH             56400094
564100         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE QUEUE'            56410094
564200                                   TO DP013-MESSAGE-TEXT(1)       56420094
564300         PERFORM DP013-0000-PROCESS-ABEND                         56430094
564400     END-IF.                                                      56440094
564500*                                                                 56450094
564600 EJECT                                                            56460094
564700*----------------------------------------------------------------*56470094
564800*  WRITE THE LIST TEMP STORAGE QUEUE INTO A HOLD ORIGINAL TSQ    *56480094
564900*----------------------------------------------------------------*56490094
565000 7250-WRITE-ORIG-ASC-LISTQ.                                       56500094
565100     EXEC CICS                                                    56510094
565200         WRITEQ TS                                                56520094
565300             QUEUE (ASC-ORIG-QUEUE-NAME)                          56530094
565400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56540094
565500             ITEM  (PV-BLOCK-NUMBER)                              56550094
565600             RESP  (PV-CICS-RESP)                                 56560094
565700     END-EXEC.                                                    56570094
565800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      56580094
565900         SET DP013-CICS-ABEND      TO TRUE                        56590094
566000         SET DP013-NO-ROLLBACK     TO TRUE                        56600094
566100         MOVE '7250-WRITE-ORIG-ASC-LISTQ'                         56610094
566200                                   TO DP013-PARAGRAPH             56620094
566300         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE QUEUE'            56630094
566400                                   TO DP013-MESSAGE-TEXT(1)       56640094
566500         PERFORM DP013-0000-PROCESS-ABEND                         56650094
566600     END-IF.                                                      56660094
566700*                                                                 56670094
566800 EJECT                                                            56680094
566900*----------------------------------------------------------------*56690094
567000*  WRITE THE LIST HOLD TEMP STORAGE QUEUE                        *56700094
567100*----------------------------------------------------------------*56710094
567200 7275-WRITE-HOLD-ASC-LISTQ.                                       56720094
567300     MOVE LQW-LIST-ITEM-NUMBER(1)  TO PV-LIST-ITEM-NUMBER.        56730094
567400     COMPUTE PV-TEMP-BLOCK-NUMBER =                               56740094
567500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    56750094
567600                                                                  56760094
567700     IF (PV-TEMP-BLOCK-NUMBER < LQW-HIGHEST-BLOCK-WRITTEN)        56770094
567800     OR (PV-TEMP-BLOCK-NUMBER = LQW-HIGHEST-BLOCK-WRITTEN)        56780094
567900         IF  LQW-BLOCK-MODIFIED                                   56790094
568000             EXEC CICS                                            56800094
568100                 WRITEQ TS                                        56810094
568200                     QUEUE (ASC-HOLD-QUEUE-NAME)                  56820094
568300                     FROM  (LQW-BLOCK-ENTRIES)                    56830094
568400                     ITEM  (LQW-BLOCK-NUMBER)                     56840094
568500                     REWRITE                                      56850094
568600                     RESP  (PV-CICS-RESP)                         56860094
568700             END-EXEC                                             56870094
568800                                                                  56880094
568900             IF  PV-CICS-RESP = DFHRESP(NORMAL)                   56890094
569000                 CONTINUE                                         56900094
569100             ELSE                                                 56910094
569200                 SET DP013-CICS-ABEND                             56920094
569300                     DP013-NO-ROLLBACK                            56930094
569400                                   TO TRUE                        56940094
569500                 MOVE '7275-WRITE-HOLD-ASC-LISTQ'                 56950094
569600                                   TO DP013-PARAGRAPH             56960094
569700                 MOVE                                             56970094
569800                 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'  56980094
569900                                   TO DP013-MESSAGE-TEXT(1)       56990094
570000                 PERFORM DP013-0000-PROCESS-ABEND                 57000094
570100             END-IF                                               57010094
570200         END-IF                                                   57020094
570300     ELSE                                                         57030094
570400         EXEC CICS                                                57040094
570500             WRITEQ TS                                            57050094
570600                 QUEUE (ASC-HOLD-QUEUE-NAME)                      57060094
570700                 FROM  (LQW-BLOCK-ENTRIES)                        57070094
570800                 ITEM  (LQW-BLOCK-NUMBER)                         57080094
570900                 RESP  (PV-CICS-RESP)                             57090094
571000         END-EXEC                                                 57100094
571100         IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                  57110094
571200             SET DP013-CICS-ABEND  TO TRUE                        57120094
571300             SET DP013-NO-ROLLBACK TO TRUE                        57130094
571400             MOVE '7275-WRITE-HOLD-ASC-LISTQ'                     57140094
571500                                   TO DP013-PARAGRAPH             57150094
571600             MOVE 'ATTEMPTING TO WRITE TEMP STORAGE QUEUE'        57160094
571700                                   TO DP013-MESSAGE-TEXT(1)       57170094
571800             PERFORM DP013-0000-PROCESS-ABEND                     57180094
571900         END-IF                                                   57190094
572000         ADD +1                    TO LQW-HIGHEST-BLOCK-WRITTEN   57200094
572100     END-IF.                                                      57210094
572200                                                                  57220094
572300*                                                                 57230094
572400 EJECT                                                            57240094
572500*----------------------------------------------------------------*57250094
572600*  GET THE DOCUMENT NUMBER (KEY) OF THE NEXT SELECTED           **57260094
572700*  OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **57270094
572800*----------------------------------------------------------------*57280094
572900 8000-GET-NEXT-DOCUMENT.                                          57290094
573000     ADD +1                        TO ASC-SEL-SUB.                57300094
573100     IF  ASC-SEL-SUB > PE067-MAX-ITEMS                            57310094
573200         ADD +1                    TO ASC-SEL-ITEM                57320094
573300         MOVE +1                   TO ASC-SEL-SUB                 57330094
573400     END-IF.                                                      57340094
573500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                57350094
573600         PERFORM 9100-READ-SEL-QUEUE                              57360094
573700         IF  PE067-ITEM (ASC-SEL-SUB) > ZERO                      57370094
573800             MOVE PE067-STORE-NUMBER (ASC-SEL-SUB)                57380094
573900                                   TO ASC-KEY-STORE-NBR           57390094
574000             MOVE ASC-KEY-STORE-NBR-N                             57400094
574100                                   TO DK-STORE-NBR                57410094
574200                                      XST00001-LOC-NBR            57420094
574300             MOVE PE067-DOCUMENT-NUMBER (ASC-SEL-SUB)             57430094
574400                                   TO ASC-KEY-DOC-NBR-N           57440094
574500                                      DK-DOC-NBR                  57450094
574600             PERFORM 8025-GET-STORE-NAME                          57460094
574700             IF SQLCODE = 0                                       57470094
574800                 MOVE XST00001-LOC-NM                             57480094
574900                                   TO ASC-STORE-NAME              57490094
575000             ELSE                                                 57500094
575100                 MOVE SPACES       TO ASC-STORE-NAME              57510094
575200             END-IF                                               57520094
575300             PERFORM 8050-VALIDATE-STORE-DOC                      57530094
575400             MOVE STRPPC-RSN-CDE TO PE049-WORKING-INSTR-RSN-CDE   57540094
575500             IF ((STRPPC-STATUS-CDE =                             57550094
575600                  PE049-IS-AVAILABLE-STATUS-CDE OR                57560094
575700                  PE049-IS-CNTS-ENTER-STATUS-CDE OR               57570094
575800                  PE049-IS-GENERATED-STATUS-CDE OR                57580094
575900                  PE049-IS-DELINQUENT-STATUS-CDE) AND             57590094
576000                  NOT PE049-IS-RTN-TO-VNDR-RSN    AND             57600094
576100                  NOT PE049-IS-INVENTORY-MISSED-RSN  AND          57610094
576200                  NOT PE049-IS-RF-ZERO-OUT-RSN)                   57620094
576300                 SET PE067-INQ (ASC-SEL-SUB)                      57630094
576400                                   TO TRUE                        57640094
576500             ELSE                                                 57650094
576600                 SET PS-ERROR                                     57660094
576700                     DP020-MSG-FATAL                              57670094
576800                     DP020-NEXT-ACT-APPL-ERROR                    57680094
576900                                   TO TRUE                        57690094
577000*     --- DOCUMENT IN INVALID STATUS FOR THIS FUNCTION ---        57700094
577100                 MOVE PC-TSYMSG-00027                             57710094
577200                                   TO DP020-MSG-NUMBER            57720094
577300                 SET PE067-ERR (ASC-SEL-SUB)                      57730094
577400                                   TO TRUE                        57740094
577500             END-IF                                               57750094
577600             PERFORM 9200-REWRITE-SEL-QUEUE                       57760094
577700         ELSE                                                     57770094
577800             SUBTRACT +1 FROM ASC-SEL-SUB                         57780094
577900*     --- BOTTOM OF LIST ---                                      57790094
578000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            57800094
578100             SET DP020-MSG-INFORMATIONAL                          57810094
578200                 PS-LIST-END       TO TRUE                        57820094
578300         END-IF                                                   57830094
578400     ELSE                                                         57840094
578500         SUBTRACT +1 FROM ASC-SEL-ITEM                            57850094
578600         MOVE PE067-MAX-ITEMS      TO ASC-SEL-SUB                 57860094
578700*     --- BOTTOM OF LIST ---                                      57870094
578800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            57880094
578900         SET DP020-MSG-INFORMATIONAL                              57890094
579000             PS-LIST-END           TO TRUE                        57900094
579100     END-IF.                                                      57910094
579200*                                                                 57920094
579300 EJECT                                                            57930094
579400*----------------------------------------------------------------*57940094
579500*  GET THE DOCUMENT NUMBER (KEY) OF THE PREVIOUS SELECTED       **57950094
579600*  OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **57960094
579700*----------------------------------------------------------------*57970094
579800 8005-GET-PREV-DOCUMENT.                                          57980094
579900     SUBTRACT +1                   FROM ASC-SEL-SUB.              57990094
580000     IF  ASC-SEL-SUB < +1                                         58000094
580100         SUBTRACT +1               FROM ASC-SEL-ITEM              58010094
580200         MOVE PE067-MAX-ITEMS      TO ASC-SEL-SUB                 58020094
580300     END-IF.                                                      58030094
580400                                                                  58040094
580500     IF  ASC-SEL-ITEM > ZERO                                      58050094
580600         PERFORM 9100-READ-SEL-QUEUE                              58060094
580700         MOVE PE067-STORE-NUMBER (ASC-SEL-SUB)                    58070094
580800                                   TO ASC-KEY-STORE-NBR           58080094
580900         MOVE ASC-KEY-STORE-NBR-N  TO DK-STORE-NBR                58090094
581000                                      XST00001-LOC-NBR            58100094
581100         MOVE PE067-DOCUMENT-NUMBER (ASC-SEL-SUB)                 58110094
581200                                   TO ASC-KEY-DOC-NBR-N           58120094
581300                                      DK-DOC-NBR                  58130094
581400         PERFORM 8025-GET-STORE-NAME                              58140094
581500         IF SQLCODE = 0                                           58150094
581600             MOVE XST00001-LOC-NM  TO ASC-STORE-NAME              58160094
581700         ELSE                                                     58170094
581800             MOVE SPACES           TO ASC-STORE-NAME              58180094
581900         END-IF                                                   58190094
582000         PERFORM 8050-VALIDATE-STORE-DOC                          58200094
582100         MOVE STRPPC-RSN-CDE     TO PE049-WORKING-INSTR-RSN-CDE   58210094
582200         IF ((STRPPC-STATUS-CDE =                                 58220094
582300              PE049-IS-AVAILABLE-STATUS-CDE OR                    58230094
582400              PE049-IS-CNTS-ENTER-STATUS-CDE OR                   58240094
582500              PE049-IS-GENERATED-STATUS-CDE OR                    58250094
582600              PE049-IS-DELINQUENT-STATUS-CDE) AND                 58260094
582700              NOT PE049-IS-RTN-TO-VNDR-RSN    AND                 58270094
582800              NOT PE049-IS-INVENTORY-MISSED-RSN  AND              58280094
582900              NOT PE049-IS-RF-ZERO-OUT-RSN)                       58290094
583000             CONTINUE                                             58300094
583100         ELSE                                                     58310094
583200             SET PS-ERROR                                         58320094
583300                 DP020-MSG-FATAL                                  58330094
583400                 DP020-NEXT-ACT-APPL-ERROR                        58340094
583500                                   TO TRUE                        58350094
583600*     --- DOCUMENT IN INVALID STATUS FOR THIS FUNCTION ---        58360094
583700             MOVE PC-TSYMSG-00027                                 58370094
583800                                   TO DP020-MSG-NUMBER            58380094
583900         END-IF                                                   58390094
584000     ELSE                                                         58400094
584100         MOVE +1                   TO ASC-SEL-ITEM                58410094
584200                                      ASC-SEL-SUB                 58420094
584300*     --- TOP OF LIST ---                                         58430094
584400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            58440094
584500         SET DP020-MSG-INFORMATIONAL                              58450094
584600             PS-LIST-END           TO TRUE                        58460094
584700     END-IF.                                                      58470094
584800*                                                                 58480094
584900 EJECT                                                            58490094
585000*----------------------------------------------------------------*58500094
585100* GET THE STORE NAME FOR THE ITEMS PASSED FROM THE STORE LIST    *58510094
585200*----------------------------------------------------------------*58520094
585300*                                                                 58530094
585400 8025-GET-STORE-NAME.                                             58540094
585500     PERFORM                                                      58550094
585600         WITH TEST AFTER                                          58560094
585700         VARYING PV-RETRY-COUNTER                                 58570094
585800         FROM 1 BY 1                                              58580094
585900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58590094
586000                   OR (SQLCODE = ZERO)                            58600094
586100                   OR (SQLCODE = +100))                           58610094
586200*                                                                 58620094
586300         EXEC SQL                                                 58630094
586400             SELECT LOC_NM                                        58640094
586500             INTO :XST00001-LOC-NM                                58650094
586600             FROM XST_LOC                                         58660094
586700             WHERE LOC_NBR = :XST00001-LOC-NBR                    58670094
586800         END-EXEC                                                 58680094
586900                                                                  58690094
587000         EVALUATE TRUE                                            58700094
587100             WHEN SQLCODE = ZERO                                  58710094
587200             WHEN SQLCODE = -911                                  58720094
587300             WHEN SQLCODE = -913                                  58730094
587400             WHEN SQLCODE = +100                                  58740094
587500                 CONTINUE                                         58750094
587600             WHEN SQLWARN0 NOT = SPACES                           58760094
587700             WHEN SQLCODE < ZERO                                  58770094
587800             WHEN SQLCODE > ZERO                                  58780094
587900                 MOVE '8025-GET-STORE-NAME'                       58790094
588000                                   TO DP013-PARAGRAPH             58800094
588100                 MOVE 'SELECT THE STORE NAME'                     58810094
588200                                   TO DP013-MESSAGE-TEXT (1)      58820094
588300                 MOVE SQLCA        TO DP013-SQLCA                 58830094
588400                 MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)    58840094
588500                 SET DP013-DB2-ABEND                              58850094
588600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           58860094
588700                 PERFORM DP013-0000-PROCESS-ABEND                 58870094
588800         END-EVALUATE                                             58880094
588900     END-PERFORM.                                                 58890094
589000*                                                                 58900094
589100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        58910094
589200         MOVE '8025-GET-STORE-NAME'                               58920094
589300                                   TO DP013-PARAGRAPH             58930094
589400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     58940094
589500                                   TO DP013-MESSAGE-TEXT (1)      58950094
589600         MOVE 'STORE NAME'         TO DP013-MESSAGE-TEXT (2)      58960094
589700         MOVE SQLCA                TO DP013-SQLCA                 58970094
589800         MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (1)    58980094
589900         SET DP013-DB2-ABEND                                      58990094
590000             DP013-XCTL-DISPLAY-RESTART                           59000094
590100                                   TO TRUE                        59010094
590200         PERFORM DP013-0000-PROCESS-ABEND                         59020094
590300     END-IF.                                                      59030094
590400*                                                                 59040094
590500 EJECT                                                            59050094
590600*----------------------------------------------------------------*59060094
590700* DETERMINE IF THE STORE AND DOCUMENT PASSED TO THE LIST WAS     *59070094
590800* VALID.                                                         *59080094
590900*----------------------------------------------------------------*59090094
591000                                                                  59100094
591100 8050-VALIDATE-STORE-DOC.                                         59110094
591200                                                                  59120094
591300     INITIALIZE DCLTSTRPPC.                                       59130094
591400                                                                  59140094
591500     PERFORM                                                      59150094
591600         WITH TEST AFTER                                          59160094
591700         VARYING PV-RETRY-COUNTER                                 59170094
591800         FROM 1 BY 1                                              59180094
591900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59190094
592000                 OR (SQLCODE      = ZERO)                         59200094
592100                 OR (SQLCODE      = +100))                        59210094
592200         EXEC SQL                                                 59220094
592300             SELECT STATUS_CDE,                                   59230094
592400                    RSN_CDE                                       59240094
592500             INTO  :STRPPC-STATUS-CDE,                            59250094
592600                   :STRPPC-RSN-CDE                                59260094
592700             FROM  TSTRPPC                                        59270094
592800             WHERE (DEST_LOC_NBR  = :DK-STORE-NBR                 59280094
592900               AND  DOC_NBR       = :DK-DOC-NBR                   59290094
593000               AND  DOC_TYP_CDE   = :PE049-STORE-DOC-TYPE-CDE)    59300094
593100         END-EXEC                                                 59310094
593200                                                                  59320094
593300         EVALUATE TRUE                                            59330094
593400             WHEN SQLCODE = ZERO                                  59340094
593500             WHEN SQLCODE = +100                                  59350094
593600             WHEN SQLCODE = -911                                  59360094
593700             WHEN SQLCODE = -913                                  59370094
593800                 CONTINUE                                         59380094
593900             WHEN SQLWARN0 NOT = SPACES                           59390094
594000             WHEN SQLCODE < ZERO                                  59400094
594100             WHEN SQLCODE > ZERO                                  59410094
594200                 MOVE '8050-VALIDATE-STORE-DOC'                   59420094
594300                                   TO DP013-PARAGRAPH             59430094
594400                 MOVE 'VALIDATE THE STORE/DOC IS ON TSTRPPC'      59440094
594500                                   TO DP013-MESSAGE-TEXT (1)      59450094
594600                 MOVE SQLCA        TO DP013-SQLCA                 59460094
594700                 SET DP013-DB2-ABEND                              59470094
594800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           59480094
594900                 PERFORM DP013-0000-PROCESS-ABEND                 59490094
595000         END-EVALUATE                                             59500094
595100     END-PERFORM.                                                 59510094
595200*                                                                 59520094
595300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        59530094
595400         MOVE '8050-VALIDATE-STORE-DOC'                           59540094
595500                                   TO DP013-PARAGRAPH             59550094
595600         MOVE 'MAX RETRIES EXCEEDED - TSTRPPC FETCH STR/DOC'      59560094
595700                                   TO DP013-MESSAGE-TEXT (1)      59570094
595800         MOVE SQLCA                TO DP013-SQLCA                 59580094
595900         SET DP013-DB2-ABEND                                      59590094
596000             DP013-XCTL-DISPLAY-RESTART                           59600094
596100                                   TO TRUE                        59610094
596200         PERFORM DP013-0000-PROCESS-ABEND                         59620094
596300     END-IF.                                                      59630094
596400*                                                                 59640094
596500 EJECT                                                            59650094
596600*----------------------------------------------------------------*59660094
596700* GET THE HEADER INFORMATION FROM THE IN-STORE HEADER TABLE.     *59670094
596800*----------------------------------------------------------------*59680094
596900                                                                  59690094
597000 8100-GET-HEADER-INFO.                                            59700094
597100                                                                  59710094
597200     PERFORM                                                      59720094
597300         WITH TEST AFTER                                          59730094
597400         VARYING PV-RETRY-COUNTER                                 59740094
597500         FROM 1 BY 1                                              59750094
597600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59760094
597700                 OR (SQLCODE      = ZERO)                         59770094
597800                 OR (SQLCODE      = +100))                        59780094
597900         EXEC SQL                                                 59790094
598000             SELECT EFF_DTE                                       59800094
598100                  , PR_CHG_CPL_NAME                               59810094
598200                  , RSN_CDE                                       59820094
598300                  , TYP_CDE                                       59830094
598400                  , STATUS_CDE                                    59840094
598500                  , DEPT_AREA_DEST                                59850094
598600                  , CRE_DTE                                       59860094
598700                  , PGS_TO_PRT_NBR                                59870094
598800             INTO  :STRPPC-EFF-DTE                                59880094
598900                 , :STRPPC-PR-CHG-CPL-NAME                        59890094
599000                 , :STRPPC-RSN-CDE                                59900094
599100                 , :STRPPC-TYP-CDE                                59910094
599200                 , :STRPPC-STATUS-CDE                             59920094
599300                 , :STRPPC-DEPT-AREA-DEST                         59930094
599400                 , :STRPPC-CRE-DTE                                59940094
599500                 , :STRPPC-PGS-TO-PRT-NBR                         59950094
599600             FROM  TSTRPPC                                        59960094
599700             WHERE (DEST_LOC_NBR  = :DK-STORE-NBR                 59970094
599800               AND  DOC_NBR       = :DK-DOC-NBR                   59980094
599900               AND  DOC_TYP_CDE   = :PE049-STORE-DOC-TYPE-CDE)    59990094
600000         END-EXEC                                                 60000094
600100                                                                  60010094
600200         EVALUATE TRUE                                            60020094
600300             WHEN SQLCODE = ZERO                                  60030094
600400             WHEN SQLCODE = -911                                  60040094
600500             WHEN SQLCODE = -913                                  60050094
600600                 CONTINUE                                         60060094
600700             WHEN SQLWARN0 NOT = SPACES                           60070094
600800             WHEN SQLCODE < ZERO                                  60080094
600900             WHEN SQLCODE > ZERO                                  60090094
601000                 MOVE '8100-GET-HEADER-INFO'                      60100094
601100                                   TO DP013-PARAGRAPH             60110094
601200                 MOVE 'GET THE HEADER INFO FROM TSTRPPC'          60120094
601300                                   TO DP013-MESSAGE-TEXT (1)      60130094
601400                 MOVE SQLCA        TO DP013-SQLCA                 60140094
601500                 SET DP013-DB2-ABEND                              60150094
601600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           60160094
601700                 PERFORM DP013-0000-PROCESS-ABEND                 60170094
601800         END-EVALUATE                                             60180094
601900     END-PERFORM.                                                 60190094
602000*                                                                 60200094
602100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60210094
602200         MOVE '8100-GET-HEADER-INFO'                              60220094
602300                                   TO DP013-PARAGRAPH             60230094
602400         MOVE 'MAX RETRIES EXCEEDED - TSTRPPC FETCH STR/DOC'      60240094
602500                                   TO DP013-MESSAGE-TEXT (1)      60250094
602600         MOVE SQLCA                TO DP013-SQLCA                 60260094
602700         SET DP013-DB2-ABEND                                      60270094
602800             DP013-XCTL-DISPLAY-RESTART                           60280094
602900                                   TO TRUE                        60290094
603000         PERFORM DP013-0000-PROCESS-ABEND                         60300094
603100     END-IF.                                                      60310094
603200*                                                                 60320094
603300 EJECT                                                            60330094
603400*----------------------------------------------------------------*60340094
603500* UPDATE THE HEADER INFORMATION.                                 *60350094
603600*----------------------------------------------------------------*60360094
603700                                                                  60370094
603800 8150-UPDATE-HEADER.                                              60380094
603900     PERFORM                                                      60390094
604000         WITH TEST AFTER                                          60400094
604100         VARYING PV-RETRY-COUNTER                                 60410094
604200         FROM 1 BY 1                                              60420094
604300         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 60430094
604400                   OR  SQLCODE = ZERO)                            60440094
604500*                                                                 60450094
604600         EXEC SQL                                                 60460094
604700             UPDATE TSTRPPC                                       60470094
604800                SET EFF_DTE         = :STRPPC-EFF-DTE             60480094
604900                  , PR_CHG_CPL_NAME = :STRPPC-PR-CHG-CPL-NAME     60490094
605000                  , RSN_CDE         = :STRPPC-RSN-CDE             60500094
605100                  , TYP_CDE         = :STRPPC-TYP-CDE             60510094
605200                  , STATUS_CDE      = :STRPPC-STATUS-CDE          60520094
605300                  , PREV_STATUS_CDE = :STRPPC-PREV-STATUS-CDE     60530094
605400                  , DEPT_AREA_DEST  = :STRPPC-DEPT-AREA-DEST      60540094
605500                  , ENTR_DTE        = :STRPPC-ENTR-DTE            60550094
605600                  , ENTR_TIME       = :STRPPC-ENTR-TIME           60560094
605700                  , ENTR_ID         = :STRPPC-ENTR-ID             60570094
605800              WHERE (DEST_LOC_NBR = :DK-STORE-NBR                 60580094
605900                AND  DOC_NBR      = :DK-DOC-NBR                   60590094
606000                AND  DOC_TYP_CDE  = :PE049-STORE-DOC-TYPE-CDE)    60600094
606100         END-EXEC                                                 60610094
606200                                                                  60620094
606300         EVALUATE TRUE                                            60630094
606400             WHEN SQLCODE = ZERO                                  60640094
606500             WHEN SQLCODE = -911                                  60650094
606600             WHEN SQLCODE = -913                                  60660094
606700                 CONTINUE                                         60670094
606800             WHEN SQLWARN0 NOT = SPACES                           60680094
606900             WHEN SQLCODE < ZERO                                  60690094
607000             WHEN SQLCODE > ZERO                                  60700094
607100                 MOVE '8150-UPDATE-HEADER'                        60710094
607200                                   TO DP013-PARAGRAPH             60720094
607300                 MOVE 'UPDATE A ROW ON THE HEADER TABLE'          60730094
607400                                   TO DP013-MESSAGE-TEXT (1)      60740094
607500                 MOVE SQLCA        TO DP013-SQLCA                 60750094
607600                 MOVE 'TSTRPPC'    TO DP013-DB2-TABLE-NAME (1)    60760094
607700                 SET DP013-DB2-ABEND                              60770094
607800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           60780094
607900                 PERFORM DP013-0000-PROCESS-ABEND                 60790094
608000         END-EVALUATE                                             60800094
608100     END-PERFORM.                                                 60810094
608200*                                                                 60820094
608300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60830094
608400         MOVE '8150-UPDATE-HEADER' TO DP013-PARAGRAPH             60840094
608500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     60850094
608600                                   TO DP013-MESSAGE-TEXT (1)      60860094
608700         MOVE SQLCA                TO DP013-SQLCA                 60870094
608800         MOVE 'TSTRPPC'            TO DP013-DB2-TABLE-NAME (1)    60880094
608900         SET DP013-DB2-ABEND                                      60890094
609000             DP013-XCTL-DISPLAY-RESTART                           60900094
609100                                   TO TRUE                        60910094
609200         PERFORM DP013-0000-PROCESS-ABEND                         60920094
609300     END-IF.                                                      60930094
609400                                                                  60940094
609500*                                                                 60950094
609600 EJECT                                                            60960094
609700*----------------------------------------------------------------*60970094
609800*    FETCH THE IN-STORE DETAIL CURSOR.                           *60980094
609900*----------------------------------------------------------------*60990094
610000                                                                  61000094
610100 8200-FETCH-DETAIL-CURSOR.                                        61010094
610200                                                                  61020094
610300      EXEC SQL                                                    61030094
610400           FETCH DETAIL-CSR                                       61040094
610500           INTO  :SPPCDT-SKU-NBR                                  61050094
610600               , :SPPCDT-ROW-NBR                                  61060094
610700               , :SPPCDT-ACTL-PR-CHG-QTY                          61070094
610800               , :SPPCDT-OLD-PR                                   61080094
610900               , :SPPCDT-NEW-PR                                   61090094
611000               , :SPPCDT-ACTL-PR-CHG-AMT                          61100094
611100               , :SPPCDT-UPC-NBR                                  61110094
611200               , :SPPCDT-ITEM-NBR                                 61120094
611300      END-EXEC.                                                   61130094
611400*                                                                 61140094
611500     EVALUATE TRUE                                                61150094
611600         WHEN SQLCODE = ZERO                                      61160094
611700         WHEN SQLCODE = +100                                      61170094
611800              CONTINUE                                            61180094
611900         WHEN SQLWARN0 NOT = SPACE                                61190094
612000         WHEN SQLCODE NOT = ZERO                                  61200094
612100              MOVE '8200-FETCH-DETAIL-CURSOR'                     61210094
612200                               TO DP013-PARAGRAPH                 61220094
612300              MOVE 'FETCH IN-STORE DETAIL CURSOR'                 61230094
612400                               TO DP013-MESSAGE-TEXT (1)          61240094
612500              MOVE SQLCA       TO DP013-SQLCA                     61250094
612600              SET DP013-DB2-ABEND                                 61260094
612700                               TO TRUE                            61270094
612800              PERFORM DP013-0000-PROCESS-ABEND                    61280094
612900     END-EVALUATE.                                                61290094
613000                                                                  61300094
613100     IF  SQLCODE EQUAL +100                                       61310094
613200         SET ASC-NO-ITEMS-LEFT-ON-DB                              61320094
613300                                   TO TRUE                        61330094
613400     END-IF.                                                      61340094
613500*                                                                 61350094
613600 EJECT                                                            61360094
613700*----------------------------------------------------------------*61370094
613800* OPEN THE INSTORE DOCUMENT DETAIL CURSOR.                       *61380094
613900*----------------------------------------------------------------*61390094
614000                                                                  61400094
614100 8210-OPEN-CURSOR.                                                61410094
614200                                                                  61420094
614300     INITIALIZE DCLTSPPCDT.                                       61430094
614400     MOVE DK-STORE-NBR           TO SPPCDT-DEST-LOC-NBR           61440094
614500     MOVE DK-DOC-NBR             TO SPPCDT-DOC-NBR                61450094
614600     EXEC SQL                                                     61460094
614700          OPEN DETAIL-CSR                                         61470094
614800     END-EXEC.                                                    61480094
614900*                                                                 61490094
615000     EVALUATE TRUE                                                61500094
615100         WHEN SQLCODE = ZERO                                      61510094
615200             CONTINUE                                             61520094
615300         WHEN SQLWARN0 NOT = SPACES                               61530094
615400         WHEN SQLCODE < ZERO                                      61540094
615500         WHEN SQLCODE > ZERO                                      61550094
615600             MOVE '8210-OPEN-CURSOR'                              61560094
615700                                 TO DP013-PARAGRAPH               61570094
615800             MOVE 'OPEN IN-STORE DETAIL CURSOR - '                61580094
615900                                 TO DP013-MESSAGE-TEXT (1)        61590094
616000             MOVE 'TSPPCDT '     TO DP013-DB2-TABLE-NAME (1)      61600094
616100             MOVE SQLCA          TO DP013-SQLCA                   61610094
616200             SET DP013-DB2-ABEND                                  61620094
616300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               61630094
616400             PERFORM DP013-0000-PROCESS-ABEND                     61640094
616500     END-EVALUATE.                                                61650094
616600*                                                                 61660094
616700 EJECT                                                            61670094
616800*----------------------------------------------------------------*61680094
616900* CLOSE THE INSTORE DOCUMENT DETAIL CURSOR.                      *61690094
617000*----------------------------------------------------------------*61700094
617100                                                                  61710094
617200 8220-CLOSE-CURSOR.                                               61720094
617300                                                                  61730094
617400     EXEC SQL                                                     61740094
617500          CLOSE DETAIL-CSR                                        61750094
617600     END-EXEC.                                                    61760094
617700*                                                                 61770094
617800     EVALUATE TRUE                                                61780094
617900         WHEN SQLCODE = ZERO                                      61790094
618000             CONTINUE                                             61800094
618100         WHEN SQLWARN0 NOT = SPACES                               61810094
618200         WHEN SQLCODE < ZERO                                      61820094
618300         WHEN SQLCODE > ZERO                                      61830094
618400             MOVE '8220-CLOSE-CURSOR'                             61840094
618500                                 TO DP013-PARAGRAPH               61850094
618600             MOVE 'CLOSE IN-STORE DETAIL CURSOR '                 61860094
618700                                 TO DP013-MESSAGE-TEXT (1)        61870094
618800             MOVE 'TSPPCDT '     TO DP013-DB2-TABLE-NAME (1)      61880094
618900             MOVE SQLCA          TO DP013-SQLCA                   61890094
619000             SET DP013-DB2-ABEND                                  61900094
619100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               61910094
619200             PERFORM DP013-0000-PROCESS-ABEND                     61920094
619300     END-EVALUATE.                                                61930094
619400*                                                                 61940094
619500 EJECT                                                            61950094
619600*----------------------------------------------------------------*61960094
619700*    VALIDATE THE SKU ENTERED.                                   *61970094
619800*    RETRIEVE UPC FROM TUPC TABLE FOR THE ENTERED SKU.           *61980094
619900*----------------------------------------------------------------*61990094
620000 8300-RETRIEVE-UPC.                                               62000094
620100                                                                  62010094
620200     PERFORM                                                      62020094
620300         WITH TEST AFTER                                          62030094
620400         VARYING PV-RETRY-COUNTER                                 62040094
620500         FROM 1 BY 1                                              62050094
620600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               62060094
620700                   OR (SQLCODE = ZERO)                            62070094
620800                   OR (SQLCODE = +100))                           62080094
620900*                                                                 62090094
621000         EXEC SQL                                                 62100094
621100             SELECT                                               62110094
621200                    A.UPC_NBR                                     62120094
621300                  , C.SKU                                         62130094
621400                  , C.ITM_NBR                                     62140094
621500             INTO                                                 62150094
621600                    :UPC-UPC-NBR                                  62160094
621700                  , :SKXREF-SKU                                   62170094
621800                  , :SKXREF-ITM-NBR                               62180094
621900             FROM                                                 62190094
622000                    TUPC A                                        62200094
622100                  , TSKXREF B                                     62210094
622200                  , TSKXREF C                                     62220094
622300             WHERE (B.SKU          = :SKXREF-SKU                  62230094
622400               AND  A.INTR_UPC_ID  = B.INTR_UPC_ID                62240094
622500               AND  A.INTR_UPC_ID  = C.INTR_UPC_ID                62250094
622600               AND  A.UPC_TYP_CDE  = 'I'                          62260094
622700               AND  C.SKU_STAT_CDE <> '98')                       62270094
622800         END-EXEC                                                 62280094
622900                                                                  62290094
623000         EVALUATE TRUE                                            62300094
623100             WHEN SQLCODE = ZERO                                  62310094
623200             WHEN SQLCODE = -911                                  62320094
623300             WHEN SQLCODE = -913                                  62330094
623400             WHEN SQLCODE = +100                                  62340094
623500                 CONTINUE                                         62350094
623600             WHEN SQLWARN0 NOT = SPACES                           62360094
623700             WHEN SQLCODE < ZERO                                  62370094
623800             WHEN SQLCODE > ZERO                                  62380094
623900                 MOVE '8300-RETRIRVE-UPC'                         62390094
624000                                   TO DP013-PARAGRAPH             62400094
624100                 MOVE 'SELECT THE UPC NUMBER'                     62410094
624200                                   TO DP013-MESSAGE-TEXT (1)      62420094
624300                 MOVE SQLCA        TO DP013-SQLCA                 62430094
624400                 MOVE 'TUPC   '    TO DP013-DB2-TABLE-NAME (1)    62440094
624500                 MOVE 'TSKXREF'    TO DP013-DB2-TABLE-NAME (2)    62450094
624600                 SET DP013-DB2-ABEND                              62460094
624700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           62470094
624800                 PERFORM DP013-0000-PROCESS-ABEND                 62480094
624900         END-EVALUATE                                             62490094
625000     END-PERFORM.                                                 62500094
625100*                                                                 62510094
625200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        62520094
625300         MOVE '8300-RETRIEVE-UPC'  TO DP013-PARAGRAPH             62530094
625400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     62540094
625500                                   TO DP013-MESSAGE-TEXT (1)      62550094
625600         MOVE 'UPC NUMBER'         TO DP013-MESSAGE-TEXT (2)      62560094
625700         MOVE SQLCA                TO DP013-SQLCA                 62570094
625800         MOVE 'TUPC   '            TO DP013-DB2-TABLE-NAME (1)    62580094
625900         MOVE 'TSKXREF'            TO DP013-DB2-TABLE-NAME (2)    62590094
626000         SET DP013-DB2-ABEND                                      62600094
626100             DP013-XCTL-DISPLAY-RESTART                           62610094
626200                                   TO TRUE                        62620094
626300         PERFORM DP013-0000-PROCESS-ABEND                         62630094
626400     END-IF.                                                      62640094
626500*                                                                 62650094
626600 EJECT                                                            62660094
626700*----------------------------------------------------------------*62670094
626800*    GET THE SKU NUMBER BASED ON THE UPC ENTERED.                *62680094
626900*----------------------------------------------------------------*62690094
627000 8450-DETERMINE-SKU.                                              62700094
627100     INITIALIZE DCLTSKXREF.                                       62710094
627200     PERFORM                                                      62720094
627300         WITH TEST AFTER                                          62730094
627400         VARYING PV-RETRY-COUNTER                                 62740094
627500         FROM 1 BY 1                                              62750094
627600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               62760094
627700                   OR (SQLCODE = ZERO)                            62770094
627800                   OR (SQLCODE = +100))                           62780094
627900*                                                                 62790094
628000         EXEC SQL                                                 62800094
628100            SELECT X.DEPT                                         62810094
628200                  , X.CLASS                                       62820094
628300                  , X.SUBCLASS                                    62830094
628400                  , X.SKU                                         62840094
628500                  , X.ITM_NBR                                     62850094
628600             INTO   :SKXREF-DEPT                                  62860094
628700                  , :SKXREF-CLASS                                 62870094
628800                  , :SKXREF-SUBCLASS                              62880094
628900                  , :SKXREF-SKU                                   62890094
629000                  , :SKXREF-ITM-NBR                               62900094
629100             FROM   TUPC A                                        62910094
629200                  , TSKXREF X                                     62920094
629300             WHERE  UPC_NBR        = :UPC-UPC-NBR                 62930094
629400               AND  A.INTR_UPC_ID  = X.INTR_UPC_ID                62940094
629500               AND  X.SKU_STAT_CDE <> '98'                        62950094
629600               AND  A.EFF_END_DTE IS NULL                         62960094
629700         END-EXEC                                                 62970094
629800                                                                  62980094
629900         EVALUATE TRUE                                            62990094
630000             WHEN SQLCODE = ZERO                                  63000094
630100                 SET PS-VALID-UPC TO TRUE                         63010094
630200             WHEN SQLCODE = -911                                  63020094
630300             WHEN SQLCODE = -913                                  63030094
630400                 CONTINUE                                         63040094
630500             WHEN SQLCODE = +100                                  63050094
630600                 IF PS-NO-ERROR                                   63060094
630700                     SET PS-ERROR                                 63070094
630800                         DP020-MSG-FATAL                          63080094
630900                         DP030-SET-CURSOR-APPL-1 TO TRUE          63090094
631000*     --- UPC NOT FOUND ---                                       63100094
631100                     MOVE PC-TSYMSG-00100                         63110094
631200                                   TO DP020-MSG-NUMBER            63120094
631300                     MOVE -1       TO MR-UPCL (PV-SUB)            63130094
631400                 END-IF                                           63140094
631500                 SET PS-INVALID-UPC TO TRUE                       63150094
631600                 MOVE DP015-UNP-ALP-BRT-OFF                       63160094
631700                                   TO MR-UPCA (PV-SUB)            63170094
631800                 MOVE DP015-RED    TO MR-UPCC (PV-SUB)            63180094
631900                 MOVE DP015-REVERSE                               63190094
632000                                   TO MR-UPCH (PV-SUB)            63200094
632100             WHEN SQLWARN0 NOT = SPACES                           63210094
632200             WHEN SQLCODE < ZERO                                  63220094
632300             WHEN SQLCODE > ZERO                                  63230094
632400                 MOVE '8450-DETERMINE-SKU'                        63240094
632500                                   TO DP013-PARAGRAPH             63250094
632600                 MOVE 'DETERMINE SKU NBR FROM UPC'                63260094
632700                                   TO DP013-MESSAGE-TEXT (1)      63270094
632800                 MOVE SQLCA        TO DP013-SQLCA                 63280094
632900                 MOVE 'TUPC   '    TO DP013-DB2-TABLE-NAME (1)    63290094
633000                 MOVE 'TSKXREF'    TO DP013-DB2-TABLE-NAME (2)    63300094
633100                 SET DP013-DB2-ABEND                              63310094
633200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           63320094
633300                 PERFORM DP013-0000-PROCESS-ABEND                 63330094
633400         END-EVALUATE                                             63340094
633500     END-PERFORM.                                                 63350094
633600*                                                                 63360094
633700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        63370094
633800         MOVE '8450-DETERMINE-SKU' TO DP013-PARAGRAPH             63380094
633900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     63390094
634000                                   TO DP013-MESSAGE-TEXT (1)      63400094
634100         MOVE 'SKU'                TO DP013-MESSAGE-TEXT (2)      63410094
634200         MOVE SQLCA                TO DP013-SQLCA                 63420094
634300         MOVE 'TUPC   '            TO DP013-DB2-TABLE-NAME (1)    63430094
634400         MOVE 'TSKXREF'            TO DP013-DB2-TABLE-NAME (2)    63440094
634500         SET DP013-DB2-ABEND                                      63450094
634600             DP013-XCTL-DISPLAY-RESTART                           63460094
634700                                   TO TRUE                        63470094
634800         PERFORM DP013-0000-PROCESS-ABEND                         63480094
634900     END-IF.                                                      63490094
635000*                                                                 63500094
635100 EJECT                                                            63510094
635200*----------------------------------------------------------------*63520094
635300*    VALIDATE DEPT AND CLASS OFF OF MBS                          *63530094
635400*----------------------------------------------------------------*63540094
635500 8460-VALIDATE-DEPT-CLASS.                                        63550094
635600     SET PS-INVALID-DEPT-CLASS TO TRUE                            63560094
635700     MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) (1:3)            63570094
635800              TO MDSEAR-DEPT-NBR                                  63580094
635900     MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) (4:2)            63590094
636000              TO PV-MAJ-CL-NBR                                    63600094
636100                 PV-SUB-CL-NBR-2-3                                63610094
636200     MOVE '0' TO PV-MAJ-CL-NBR-2                                  63620094
636300                 PV-SUB-CL-NBR-1                                  63630094
636400     MOVE PV-SUB-CL-NBR     TO MDSEAR-SUB-CL-NBR                  63640094
636500     MOVE PV-MAJ-CL-NBR     TO MDSEAR-MAJ-CL-NBR                  63650094
636600     PERFORM                                                      63660094
636700         WITH TEST AFTER                                          63670094
636800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     63680094
636900         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                63690094
637000             OR (SQLCODE = 0)                                     63700094
637100             OR (SQLCODE = +100)                                  63710094
637200                                                                  63720094
637300             EXEC SQL                                             63730094
637400                 SELECT     A.DEPT_NBR                            63740094
637500                      ,     A.MAJ_CL_NBR                          63750094
637600                      ,     A.SUB_CL_NBR                          63760094
637700                   INTO    :MDSEAR-DEPT-NBR                       63770094
637800                      ,    :MDSEAR-MAJ-CL-NBR                     63780094
637900                      ,    :MDSEAR-SUB-CL-NBR                     63790094
638000                   FROM     TMDSEAR A                             63800094
638100                      ,     TAPLAVL B                             63810094
638200                  WHERE    (A.DEPT_NBR    = :MDSEAR-DEPT-NBR)     63820094
638300                    AND    (A.MAJ_CL_NBR  = :MDSEAR-MAJ-CL-NBR)   63830094
638400                    AND    (A.SUB_CL_NBR  = :MDSEAR-SUB-CL-NBR)   63840094
638500                    AND    (A.MDSELV_CDE  = :PC-MDSELV-CDE)       63850094
638600                    AND    (A.OPERCO_NBR  = :PC-OPERCO-NBR)       63860094
638700                    AND    (B.APLSYS_CDE  = :PC-APLSYS-CDE)       63870094
638800                    AND    (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)       63880094
638900                    AND    (CURRENT DATE     BETWEEN              63890094
639000                            CHAR(B.MDSEAR_STRT_DTE,ISO)  AND      63900094
639100                            CHAR(B.MDSEAR_END_DTE,ISO))           63910094
639200                    AND    (CURRENT DATE     BETWEEN              63920094
639300                            CHAR(A.STRT_DTE,ISO)         AND      63930094
639400                            CHAR(A.END_DTE,ISO))                  63940094
639500             END-EXEC                                             63950094
639600                                                                  63960094
639700         EVALUATE TRUE                                            63970094
639800             WHEN SQLCODE = 0                                     63980094
639900                 SET PS-VALID-DEPT-CLASS  TO TRUE                 63990094
640000             WHEN SQLCODE = +100                                  64000094
640100                 SET PS-INVALID-DEPT-CLASS TO TRUE                64010094
640200             WHEN SQLCODE = -911                                  64020094
640300             WHEN SQLCODE = -913                                  64030094
640400                 CONTINUE                                         64040094
640500             WHEN SQLWARN0 NOT = SPACES                           64050094
640600             WHEN SQLCODE < ZERO                                  64060094
640700             WHEN SQLCODE > ZERO                                  64070094
640800                 MOVE '8460-VALIDATE-DEPT-CLASS'                  64080094
640900                                   TO DP013-PARAGRAPH             64090094
641000                 MOVE 'VALIDATING DEPT CLASS OF MBS'              64100094
641100                                   TO DP013-MESSAGE-TEXT (1)      64110094
641200                 MOVE SQLCA        TO DP013-SQLCA                 64120094
641300                 MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    64130094
641400                 MOVE 'TAPLVAL'    TO DP013-DB2-TABLE-NAME (2)    64140094
641500                 SET DP013-DB2-ABEND                              64150094
641600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           64160094
641700                 PERFORM DP013-0000-PROCESS-ABEND                 64170094
641800                 PERFORM DP013-0000-PROCESS-ABEND                 64180094
641900         END-EVALUATE                                             64190094
642000                                                                  64200094
642100     END-PERFORM.                                                 64210094
642200                                                                  64220094
642300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        64230094
642400         MOVE '8460-VALIDATE-DEPT-CLASS'  TO DP013-PARAGRAPH      64240094
642500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     64250094
642600                                   TO DP013-MESSAGE-TEXT (1)      64260094
642700         MOVE 'DEPT CL NBR'        TO DP013-MESSAGE-TEXT (2)      64270094
642800         MOVE SQLCA                TO DP013-SQLCA                 64280094
642900         MOVE 'TMDSEAR'            TO DP013-DB2-TABLE-NAME (1)    64290094
643000         MOVE 'TAPLAVL'            TO DP013-DB2-TABLE-NAME (2)    64300094
643100         SET DP013-DB2-ABEND                                      64310094
643200             DP013-XCTL-DISPLAY-RESTART                           64320094
643300                                   TO TRUE                        64330094
643400         PERFORM DP013-0000-PROCESS-ABEND                         64340094
643500     END-IF.                                                      64350094
643600*                                                                 64360094
643700 EJECT                                                            64370094
643800*----------------------------------------------------------------*64380094
643900*    INSERT A ROW INTO THE DETAIL TABLE.                         *64390094
644000*----------------------------------------------------------------*64400094
644100 8500-INSERT-DETAIL-LINE.                                         64410094
644200     PERFORM                                                      64420094
644300         WITH TEST AFTER                                          64430094
644400         VARYING PV-RETRY-COUNTER                                 64440094
644500         FROM 1 BY 1                                              64450094
644600         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 64460094
644700                   OR  SQLCODE = ZERO)                            64470094
644800*                                                                 64480094
644900         EXEC SQL                                                 64490094
645000             INSERT INTO TSPPCDT                                  64500094
645100                  (DEST_LOC_NBR                                   64510094
645200                  , DOC_NBR                                       64520094
645300                  , DEPT_NBR                                      64530094
645400                  , SUB_CL_NBR                                    64540094
645500                  , MAJ_CL_NBR                                    64550094
645600                  , SKU_NBR                                       64560094
645700                  , ROW_NBR                                       64570094
645800                  , ACTL_PR_CHG_QTY                               64580094
645900                  , OLD_PR                                        64590094
646000                  , NEW_PR                                        64600094
646100                  , ACTL_PR_CHG_AMT                               64610094
646200                  , UPC_NBR                                       64620094
646300                  , ITEM_NBR)                                     64630094
646400           VALUES ( :SPPCDT-DEST-LOC-NBR                          64640094
646500                  , :SPPCDT-DOC-NBR                               64650094
646600                  , :SPPCDT-DEPT-NBR                              64660094
646700                  , :SPPCDT-SUB-CL-NBR                            64670094
646800                  , :SPPCDT-MAJ-CL-NBR                            64680094
646900                  , :SPPCDT-SKU-NBR                               64690094
647000                  , :SPPCDT-ROW-NBR                               64700094
647100                  , :SPPCDT-ACTL-PR-CHG-QTY                       64710094
647200                  , :SPPCDT-OLD-PR                                64720094
647300                  , :SPPCDT-NEW-PR                                64730094
647400                  , :SPPCDT-ACTL-PR-CHG-AMT                       64740094
647500                  , :SPPCDT-UPC-NBR                               64750094
647600                  , :SPPCDT-ITEM-NBR)                             64760094
647700         END-EXEC                                                 64770094
647800                                                                  64780094
647900         EVALUATE TRUE                                            64790094
648000             WHEN SQLCODE = ZERO                                  64800094
648100             WHEN SQLCODE = -911                                  64810094
648200             WHEN SQLCODE = -913                                  64820094
648300                 CONTINUE                                         64830094
648400             WHEN SQLWARN0 NOT = SPACES                           64840094
648500             WHEN SQLCODE < ZERO                                  64850094
648600             WHEN SQLCODE > ZERO                                  64860094
648700                 MOVE '8500-INSERT-DETAIL-LINE'                   64870094
648800                                   TO DP013-PARAGRAPH             64880094
648900                 MOVE 'INSERT A ROW INTO THE DETAIL TABLE'        64890094
649000                                   TO DP013-MESSAGE-TEXT (1)      64900094
649100                 MOVE SQLCA        TO DP013-SQLCA                 64910094
649200                 MOVE 'TSPPCDT'    TO DP013-DB2-TABLE-NAME (1)    64920094
649300                 SET DP013-DB2-ABEND                              64930094
649400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           64940094
649500                 PERFORM DP013-0000-PROCESS-ABEND                 64950094
649600         END-EVALUATE                                             64960094
649700     END-PERFORM.                                                 64970094
649800*                                                                 64980094
649900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        64990094
650000         MOVE '8500-INSERT-DETAIL-LINE'                           65000094
650100                                   TO DP013-PARAGRAPH             65010094
650200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     65020094
650300                                   TO DP013-MESSAGE-TEXT (1)      65030094
650400         MOVE SQLCA                TO DP013-SQLCA                 65040094
650500         MOVE 'TSPPCDT'            TO DP013-DB2-TABLE-NAME (1)    65050094
650600         SET DP013-DB2-ABEND                                      65060094
650700             DP013-XCTL-DISPLAY-RESTART                           65070094
650800                                   TO TRUE                        65080094
650900         PERFORM DP013-0000-PROCESS-ABEND                         65090094
651000     END-IF.                                                      65100094
651100*                                                                 65110094
651200 EJECT                                                            65120094
651300*----------------------------------------------------------------*65130094
651400*    DELETE A ROW FROM THE DETAIL TABLE.                         *65140094
651500*----------------------------------------------------------------*65150094
651600 8600-DELETE-DETAIL-LINE.                                         65160094
651700     PERFORM                                                      65170094
651800         WITH TEST AFTER                                          65180094
651900         VARYING PV-RETRY-COUNTER                                 65190094
652000         FROM 1 BY 1                                              65200094
652100         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 65210094
652200                   OR  SQLCODE = ZERO)                            65220094
652300         MOVE  DK-STORE-NBR          TO  SPPCDT-DEST-LOC-NBR      65230094
652400         MOVE  DK-DOC-NBR            TO  SPPCDT-DOC-NBR           65240094
652500         MOVE  DK-SKU-NBR            TO  SPPCDT-SKU-NBR           65250094
652600         MOVE  DK-ROW-NBR            TO  SPPCDT-ROW-NBR           65260094
652700*                                                                 65270094
652800         EXEC SQL                                                 65280094
652900             DELETE                                               65290094
653000               FROM TSPPCDT                                       65300094
653100              WHERE (DEST_LOC_NBR = :SPPCDT-DEST-LOC-NBR          65310094
653200                AND  DOC_NBR      = :SPPCDT-DOC-NBR               65320094
653300                AND  SKU_NBR      = :SPPCDT-SKU-NBR               65330094
653400                AND  ROW_NBR      = :SPPCDT-ROW-NBR)              65340094
653500         END-EXEC                                                 65350094
653600                                                                  65360094
653700         EVALUATE TRUE                                            65370094
653800             WHEN SQLCODE = ZERO                                  65380094
653900             WHEN SQLCODE = -911                                  65390094
654000             WHEN SQLCODE = -913                                  65400094
654100                 CONTINUE                                         65410094
654200             WHEN SQLWARN0 NOT = SPACES                           65420094
654300             WHEN SQLCODE < ZERO                                  65430094
654400             WHEN SQLCODE > ZERO                                  65440094
654500                 MOVE '8600-DELETE-DETAIL-LINE'                   65450094
654600                                   TO DP013-PARAGRAPH             65460094
654700                 MOVE 'DELETE A ROW FROM THE DETAIL TABLE'        65470094
654800                                   TO DP013-MESSAGE-TEXT (1)      65480094
654900                 MOVE SQLCA        TO DP013-SQLCA                 65490094
655000                 MOVE 'TSPPCDT'    TO DP013-DB2-TABLE-NAME (1)    65500094
655100                 SET DP013-DB2-ABEND                              65510094
655200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           65520094
655300                 PERFORM DP013-0000-PROCESS-ABEND                 65530094
655400         END-EVALUATE                                             65540094
655500     END-PERFORM.                                                 65550094
655600*                                                                 65560094
655700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        65570094
655800         MOVE '8600-DELETE-DETAIL-LINE'                           65580094
655900                                   TO DP013-PARAGRAPH             65590094
656000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO DELETE'     65600094
656100                                   TO DP013-MESSAGE-TEXT (1)      65610094
656200         MOVE SQLCA                TO DP013-SQLCA                 65620094
656300         MOVE 'TSPPCDT'            TO DP013-DB2-TABLE-NAME (1)    65630094
656400         SET DP013-DB2-ABEND                                      65640094
656500             DP013-XCTL-DISPLAY-RESTART                           65650094
656600                                   TO TRUE                        65660094
656700         PERFORM DP013-0000-PROCESS-ABEND                         65670094
656800     END-IF.                                                      65680094
656900*                                                                 65690094
657000 EJECT                                                            65700094
657100*----------------------------------------------------------------*65710094
657200*    UPDATE A ROW ON THE DETAIL TABLE.                           *65720094
657300*----------------------------------------------------------------*65730094
657400 8700-UPDATE-DETAIL-LINE.                                         65740094
657500     PERFORM                                                      65750094
657600         WITH TEST AFTER                                          65760094
657700         VARYING PV-RETRY-COUNTER                                 65770094
657800         FROM 1 BY 1                                              65780094
657900         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 65790094
658000                   OR  SQLCODE = ZERO)                            65800094
658100         MOVE  DK-STORE-NBR          TO SPPCDT-DEST-LOC-NBR       65810094
658200         MOVE  DK-DOC-NBR            TO SPPCDT-DOC-NBR            65820094
658300         MOVE  DK-SKU-NBR            TO SPPCDT-SKU-NBR            65830094
658400         MOVE  DK-ROW-NBR            TO SPPCDT-ROW-NBR            65840094
658500*                                                                 65850094
658600         EXEC SQL                                                 65860094
658700             UPDATE TSPPCDT                                       65870094
658800                SET ACTL_PR_CHG_QTY = :SPPCDT-ACTL-PR-CHG-QTY     65880094
658900                  , OLD_PR          = :SPPCDT-OLD-PR              65890094
659000                  , NEW_PR          = :SPPCDT-NEW-PR              65900094
659100                  , ACTL_PR_CHG_AMT = :SPPCDT-ACTL-PR-CHG-AMT     65910094
659200              WHERE (DEST_LOC_NBR = :SPPCDT-DEST-LOC-NBR          65920094
659300                AND  DOC_NBR      = :SPPCDT-DOC-NBR               65930094
659400                AND  SKU_NBR      = :SPPCDT-SKU-NBR               65940094
659500                AND  ROW_NBR      = :SPPCDT-ROW-NBR)              65950094
659600         END-EXEC                                                 65960094
659700                                                                  65970094
659800         EVALUATE TRUE                                            65980094
659900             WHEN SQLCODE = ZERO                                  65990094
660000             WHEN SQLCODE = -911                                  66000094
660100             WHEN SQLCODE = -913                                  66010094
660200                 CONTINUE                                         66020094
660300             WHEN SQLWARN0 NOT = SPACES                           66030094
660400             WHEN SQLCODE < ZERO                                  66040094
660500             WHEN SQLCODE > ZERO                                  66050094
660600                 MOVE '8700-UPDATE-DETAIL-LINE'                   66060094
660700                                   TO DP013-PARAGRAPH             66070094
660800                 MOVE 'UPDATE A ROW INTO THE DETAIL TABLE'        66080094
660900                                   TO DP013-MESSAGE-TEXT (1)      66090094
661000                 MOVE SQLCA        TO DP013-SQLCA                 66100094
661100                 MOVE 'TSPPCDT'    TO DP013-DB2-TABLE-NAME (1)    66110094
661200                 SET DP013-DB2-ABEND                              66120094
661300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           66130094
661400                 PERFORM DP013-0000-PROCESS-ABEND                 66140094
661500         END-EVALUATE                                             66150094
661600     END-PERFORM.                                                 66160094
661700*                                                                 66170094
661800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        66180094
661900         MOVE '8700-UPDATE-DETAIL-LINE'                           66190094
662000                                   TO DP013-PARAGRAPH             66200094
662100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     66210094
662200                                   TO DP013-MESSAGE-TEXT (1)      66220094
662300         MOVE SQLCA                TO DP013-SQLCA                 66230094
662400         MOVE 'TSPPCDT'            TO DP013-DB2-TABLE-NAME (1)    66240094
662500         SET DP013-DB2-ABEND                                      66250094
662600             DP013-XCTL-DISPLAY-RESTART                           66260094
662700                                   TO TRUE                        66270094
662800         PERFORM DP013-0000-PROCESS-ABEND                         66280094
662900     END-IF.                                                      66290094
663000*                                                                 66300094
663100 EJECT                                                            66310094
663200*----------------------------------------------------------------*66320094
663300*    DETERMINE IF THE SKU ENTERED IS A RENUMBERED SKU.  IF IT    *66330094
663400*    IS, A MESSAGE WILL BE DISPLAYED INDICATING THE SKU WHICH    *66340094
663500*    SHOULD BE ENTERED.                                          *66350094
663600*----------------------------------------------------------------*66360094
663700*                                                                 66370094
663800 EJECT                                                            66380094
663900*----------------------------------------------------------------*66390094
664000*    SELECT THE CURRENT RETAIL PRICE FROM THE SKU TABLE          *66400094
664100*----------------------------------------------------------------*66410094
664200 8900-SELECT-CURRENT-RETAIL.                                      66420094
664300                                                                  66430094
664400     MOVE ASC-SKU-NBR   (ASC-BLK-SUB ASC-ITEM-SUB)                66440094
664500                                   TO SKXREF-SKU.                 66450094
664600     MOVE ZEROS                    TO TSK-CUR-UNIT-RTL-AMT.       66460094
664700                                                                  66470094
664800     PERFORM                                                      66480094
664900         WITH TEST AFTER                                          66490094
665000         VARYING PV-RETRY-COUNTER                                 66500094
665100         FROM 1 BY 1                                              66510094
665200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               66520094
665300                   OR (SQLCODE = ZERO)                            66530094
665400                   OR (SQLCODE = +100))                           66540094
665500                                                                  66550094
665600         EXEC SQL                                                 66560094
665700             SELECT CUR_UNIT_RTL_AMT                              66570094
665800                   ,REGN_PRIC_IND                                 66580094
665900             INTO :TSK-CUR-UNIT-RTL-AMT                           66590094
666000                 ,:TSK-REGN-PRIC-IND                              66600094
666100             FROM TSK A,                                          66610094
666200                  TSKXREF X                                       66620094
666300             WHERE (X.SKU         = :SKXREF-SKU                   66630094
666400               AND A.ITEM_NMBR    = X.ITM_NBR                     66640094
666500               AND SKU_STAT_CDE   > '00')                         66650094
666600         END-EXEC                                                 66660094
666700                                                                  66670094
666800         EVALUATE TRUE                                            66680094
666900             WHEN SQLCODE = ZERO                                  66690094
667000             WHEN SQLCODE = -911                                  66700094
667100             WHEN SQLCODE = -913                                  66710094
667200             WHEN SQLCODE = +100                                  66720094
667300                 CONTINUE                                         66730094
667400             WHEN SQLWARN0 NOT = SPACES                           66740094
667500             WHEN SQLCODE < ZERO                                  66750094
667600             WHEN SQLCODE > ZERO                                  66760094
667700                 MOVE '8900-SELECT-CURRENT-RETAIL'                66770094
667800                                   TO DP013-PARAGRAPH             66780094
667900                 MOVE 'SELECT THE CURRENT UNIT RETAIL'            66790094
668000                                   TO DP013-MESSAGE-TEXT (1)      66800094
668100                 MOVE SQLCA        TO DP013-SQLCA                 66810094
668200                 MOVE 'TSK    '    TO DP013-DB2-TABLE-NAME (1)    66820094
668300                 SET DP013-DB2-ABEND                              66830094
668400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           66840094
668500                 PERFORM DP013-0000-PROCESS-ABEND                 66850094
668600         END-EVALUATE                                             66860094
668700     END-PERFORM.                                                 66870094
668800                                                                  66880094
668900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        66890094
669000         MOVE '8900-SELECT-CURRENT-RETAIL'                        66900094
669100                                   TO DP013-PARAGRAPH             66910094
669200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     66920094
669300                                   TO DP013-MESSAGE-TEXT (1)      66930094
669400         MOVE 'CURRENT UNIT RTL'   TO DP013-MESSAGE-TEXT (2)      66940094
669500         MOVE SQLCA                TO DP013-SQLCA                 66950094
669600         MOVE 'TSK    '            TO DP013-DB2-TABLE-NAME (1)    66960094
669700         SET DP013-DB2-ABEND                                      66970094
669800             DP013-XCTL-DISPLAY-RESTART                           66980094
669900                                   TO TRUE                        66990094
670000         PERFORM DP013-0000-PROCESS-ABEND                         67000094
670100     END-IF.                                                      67010094
670200*                                                                 67020094
670300 EJECT                                                            67030094
670400*----------------------------------------------------------------*67040094
670500*    SELECT THE REGIONAL CLEARANCE RETAIL PRICE FROM THE         *67050094
670600*    UPC PHYSICAL LOCATION STATUS TABLE                          *67060094
670700*----------------------------------------------------------------*67070094
670800 8910-SELECT-REGN-RETAIL.                                         67080094
670900                                                                  67090094
671000     MOVE ASC-ITEM-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                 67100094
671100                                   TO UPCPLS-ITM-NBR.             67110094
671200     MOVE ASC-KEY-STORE-NBR-N      TO UPCPLS-STR-NBR.             67120094
671300     PERFORM                                                      67130094
671400         WITH TEST AFTER                                          67140094
671500         VARYING PV-RETRY-COUNTER                                 67150094
671600         FROM 1 BY 1                                              67160094
671700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67170094
671800                   OR (SQLCODE = ZERO)                            67180094
671900                   OR (SQLCODE = +100))                           67190094
672000                                                                  67200094
672100         EXEC SQL                                                 67210094
672200             SELECT  UNT_RTL_AMT                                  67220094
672300               INTO :UPCPLS-UNT-RTL-AMT                           67230094
672400               FROM  TUPCPLS                                      67240094
672500              WHERE  STR_NBR        = :UPCPLS-STR-NBR             67250094
672600                AND  ITM_NBR        = :UPCPLS-ITM-NBR             67260094
672700                AND  EFF_BEG_TMST  <= CURRENT TIMESTAMP           67270094
672800                AND  (EFF_END_TMST  > CURRENT TIMESTAMP           67280094
672900                 OR   EFF_END_TMST IS NULL)                       67290094
673000         END-EXEC                                                 67300094
673100                                                                  67310094
673200         EVALUATE TRUE                                            67320094
673300             WHEN SQLCODE = ZERO                                  67330094
673400                 MOVE UPCPLS-UNT-RTL-AMT                          67340094
673500                                   TO TSK-CUR-UNIT-RTL-AMT        67350094
673600             WHEN SQLCODE = -911                                  67360094
673700             WHEN SQLCODE = -913                                  67370094
673800             WHEN SQLCODE = +100                                  67380094
673900                 CONTINUE                                         67390094
674000             WHEN SQLWARN0 NOT = SPACES                           67400094
674100             WHEN SQLCODE < ZERO                                  67410094
674200             WHEN SQLCODE > ZERO                                  67420094
674300                 MOVE '8910-SELECT-REGN-RETAIL'                   67430094
674400                                   TO DP013-PARAGRAPH             67440094
674500                 MOVE 'SELECT THE REGN CLEARANCE PRICE'           67450094
674600                                   TO DP013-MESSAGE-TEXT (1)      67460094
674700                 MOVE SQLCA        TO DP013-SQLCA                 67470094
674800                 MOVE 'TUPCPLS'    TO DP013-DB2-TABLE-NAME (1)    67480094
674900                 SET DP013-DB2-ABEND                              67490094
675000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           67500094
675100                 PERFORM DP013-0000-PROCESS-ABEND                 67510094
675200         END-EVALUATE                                             67520094
675300     END-PERFORM.                                                 67530094
675400                                                                  67540094
675500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        67550094
675600         MOVE '8910-SELECT-REGN-RETAIL'                           67560094
675700                                   TO DP013-PARAGRAPH             67570094
675800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     67580094
675900                                   TO DP013-MESSAGE-TEXT (1)      67590094
676000         MOVE 'REGN CLR UNIT RTL'  TO DP013-MESSAGE-TEXT (2)      67600094
676100         MOVE SQLCA                TO DP013-SQLCA                 67610094
676200         MOVE 'TUPCPLS'            TO DP013-DB2-TABLE-NAME (1)    67620094
676300         SET DP013-DB2-ABEND                                      67630094
676400             DP013-XCTL-DISPLAY-RESTART                           67640094
676500                                   TO TRUE                        67650094
676600         PERFORM DP013-0000-PROCESS-ABEND                         67660094
676700     END-IF.                                                      67670094
676800*                                                                 67680094
676900 EJECT                                                            67690094
677000*----------------------------------------------------------------*67700094
677100*    VALIDATE THE REASON AND TYPE CODE.  IF VALID, RETRIEVE      *67710094
677200*    THE REASON AND TYPE DESCRIPTION ASSOCIATED WITH THE REASON  *67720094
677300*    ENTERED.                                                    *67730094
677400*----------------------------------------------------------------*67740094
677500 8999-GET-REASON-DESC.                                            67750094
677600     MOVE PE049-INSTR-RSN-VALUE-TABLE                             67760094
677700                                     TO PE049-INSTR-RSN-TABLE.    67770094
677800     SET PS-VALID-TYPE-CDE                                        67780094
677900         PS-VALID-RSN-CDE            TO TRUE.                     67790094
678000     MOVE ASC-REASON-CODE-N          TO PV-HOLD-TYPE-REASON-CODE. 67800094
678100                                                                  67810094
678200     MOVE PV-HOLD-TYPE-CODE          TO PE049-WORKING-TYPE-CDE.   67820094
678300     IF PE049-VALID-TYPE-CDE                                      67830094
678400         SET PS-VALID-TYPE-CDE       TO TRUE                      67840094
678500     ELSE                                                         67850094
678600         SET PS-INVALID-TYPE-CDE     TO TRUE                      67860094
678700         SET PS-ERROR                                             67870094
678800             DP020-MSG-FATAL                                      67880094
678900             DP030-SET-CURSOR-APPL-1 TO TRUE                      67890094
679000*     --- TYPE CODE INVALID ---                                   67900094
679100         MOVE PC-TSYMSG-00527        TO DP020-MSG-NUMBER          67910094
679200         MOVE SPACES                 TO ASC-TYPE-DESC             67920094
679300         MOVE DP015-UNP-ALP-BRT-OFF  TO ARSNA                     67930094
679400         MOVE DP015-RED              TO ARSNC                     67940094
679500         MOVE DP015-REVERSE          TO ARSNH                     67950094
679600         MOVE -1                     TO ARSNL                     67960094
679700     END-IF.                                                      67970094
679800*                                                                 67980094
679900     MOVE PV-HOLD-REASON-CODE        TO                           67990094
680000                                     PE049-WORKING-INSTR-RSN-CDE. 68000094
680100     IF PE049-IS-VALID-RSN                                        68010094
680200         SET PS-VALID-RSN-CDE        TO TRUE                      68020094
680300     ELSE                                                         68030094
680400         SET PS-INVALID-RSN-CDE      TO TRUE                      68040094
680500         SET PS-ERROR                                             68050094
680600             DP020-MSG-FATAL                                      68060094
680700             DP030-SET-CURSOR-APPL-1 TO TRUE                      68070094
680800*----PC-TSYMSG-00022 - REASON CODE IS NOT VALID FOR THE PRICE     68080094
680900*----                  CHANGE TYPE                                68090094
681000         MOVE PC-TSYMSG-00022        TO DP020-MSG-NUMBER          68100094
681100         MOVE SPACES                 TO ASC-REASON-DESC           68110094
681200         MOVE DP015-UNP-ALP-BRT-OFF  TO ARSNA                     68120094
681300         MOVE DP015-RED              TO ARSNC                     68130094
681400         MOVE DP015-REVERSE          TO ARSNH                     68140094
681500         MOVE -1                     TO ARSNL                     68150094
681600     END-IF.                                                      68160094
681700                                                                  68170094
681800     IF (PS-VALID-RSN-CDE                                         68180094
681900     AND PS-VALID-TYPE-CDE)                                       68190094
682000         SET PE049-TYPE-IDX                                       68200094
682100             PE049-RSN-IDX  TO 1                                  68210094
682200         SEARCH PE049-TYPE-CODE-TABLE                             68220094
682300             AT END                                               68230094
682400                 SET PS-INVALID-TYPE-CDE TO TRUE                  68240094
682500                 SET PS-ERROR                                     68250094
682600                     DP020-MSG-FATAL                              68260094
682700                     DP030-SET-CURSOR-APPL-1 TO TRUE              68270094
682800*     --- TYPE CODE INVALID ---                                   68280094
682900                 MOVE PC-TSYMSG-00527                             68290094
683000                                     TO DP020-MSG-NUMBER          68300094
683100                 MOVE SPACES         TO ASC-TYPE-DESC             68310094
683200                 MOVE DP015-UNP-ALP-BRT-OFF                       68320094
683300                                     TO ARSNA                     68330094
683400                 MOVE DP015-RED      TO ARSNC                     68340094
683500                 MOVE DP015-REVERSE  TO ARSNH                     68350094
683600                 MOVE -1             TO ARSNL                     68360094
683700             WHEN PE049-TYPE-CODE (PE049-TYPE-IDX) =              68370094
683800                                     PV-HOLD-TYPE-CODE            68380094
683900                 SET PS-VALID-TYPE-CDE TO TRUE                    68390094
684000                 MOVE PV-HOLD-TYPE-CODE                           68400094
684100                                     TO PE049-WORKING-TYPE-CDE    68410094
684200                 EVALUATE TRUE                                    68420094
684300                     WHEN PE049-MARKDOWN                          68430094
684400                         MOVE PE049-SHORT-MKDN-DESC1              68440094
684500                                     TO ASC-TYPE-DESC             68450094
684600                     WHEN PE049-MARKUP                            68460094
684700                         MOVE PE049-SHORT-MKUP-DESC1              68470094
684800                                     TO ASC-TYPE-DESC             68480094
684900                     WHEN PE049-MARKDOWN-CANCEL                   68490094
685000                         MOVE PE049-SHORT-MKDN-CANCEL-DESC        68500094
685100                                     TO ASC-TYPE-DESC             68510094
685200                     WHEN PE049-MARKUP-CANCEL                     68520094
685300                         MOVE PE049-SHORT-MKUP-CANCEL-DESC        68530094
685400                                     TO ASC-TYPE-DESC             68540094
685500                     WHEN OTHER                                   68550094
685600                         MOVE SPACES TO ASC-TYPE-DESC             68560094
685700                 END-EVALUATE                                     68570094
685800         END-SEARCH                                               68580094
685900                                                                  68590094
686000         IF PS-VALID-TYPE-CDE                                     68600094
686100             SEARCH PE049-REASON-CODE-TABLE                       68610094
686200                 AT END                                           68620094
686300                     SET PS-INVALID-RSN-CDE TO TRUE               68630094
686400                     SET PS-ERROR                                 68640094
686500                         DP020-MSG-FATAL                          68650094
686600                         DP030-SET-CURSOR-APPL-1                  68660094
686700                                     TO TRUE                      68670094
686800*----PC-TSYMSG-00022 - REASON CODE IS NOT VALID FOR THE PRICE     68680094
686900*----                  CHANGE TYPE                                68690094
687000                     MOVE PC-TSYMSG-00022                         68700094
687100                                     TO DP020-MSG-NUMBER          68710094
687200                     MOVE SPACES     TO ASC-REASON-DESC           68720094
687300                     MOVE DP015-UNP-ALP-BRT-OFF                   68730094
687400                                     TO ARSNA                     68740094
687500                     MOVE DP015-RED  TO ARSNC                     68750094
687600                     MOVE DP015-REVERSE                           68760094
687700                                     TO ARSNH                     68770094
687800                     MOVE -1         TO ARSNL                     68780094
687900                 WHEN PE049-REASON-CODE                           68790094
688000                             (PE049-TYPE-IDX PE049-RSN-IDX)       68800094
688100                                       = PV-HOLD-REASON-CODE      68810094
688200                     SET PS-VALID-RSN-CDE TO TRUE                 68820094
688300                     MOVE PV-HOLD-REASON-CODE                     68830094
688400                                    TO PE049-WORKING-INSTR-RSN-CDE68840094
688500                     EVALUATE TRUE                                68850094
688600                         WHEN PE049-IS-ZERO-OUT-RSN               68860094
688700                             MOVE PE049-IS-SHORT-ZERO-OUT-DESC    68870094
688800                                     TO ASC-REASON-DESC           68880094
688900                         WHEN PE049-IS-RF-ZERO-OUT-RSN            68890094
689000                             MOVE PE049-IS-SHORT-RF-ZERO-OUT      68900094
689100                                     TO ASC-REASON-DESC           68910094
689200                         WHEN PE049-IS-RTN-TO-VNDR-RSN            68920094
689300                             MOVE PE049-IS-SHORT-RTN-TO-VNDR      68930094
689400                                     TO ASC-REASON-DESC           68940094
689500                         WHEN PE049-IS-CORRECTION-RSN             68950094
689600                             MOVE PE049-IS-SHORT-CORRECTION-DESC  68960094
689700                                     TO ASC-REASON-DESC           68970094
689800                         WHEN PE049-IS-BUYER-GEN-MISSED-RSN       68980094
689900                             MOVE PE049-IS-SHORT-BYR-MISSED-DESC  68990094
690000                                     TO ASC-REASON-DESC           69000094
690100                         WHEN PE049-IS-CUSTOMER-RET-RSN           69010094
690200                             MOVE PE049-IS-SHORT-CUST-RET-DESC    69020094
690300                                     TO ASC-REASON-DESC           69030094
690400                         WHEN PE049-IS-KNOWN-THEFT-RSN            69040094
690500                             MOVE PE049-IS-SHORT-THEFT-DESC       69050094
690600                                     TO ASC-REASON-DESC           69060094
690700                         WHEN PE049-IS-INSTR-DAMAGE-RSN           69070094
690800                             MOVE PE049-IS-SHORT-INSTR-DMG-DESC   69080094
690900                                     TO ASC-REASON-DESC           69090094
691000                         WHEN PE049-IS-COSMETICS-TESTER-RSN       69100094
691100                             MOVE PE049-IS-SHORT-CSMTCS-TST-DESC  69110094
691200                                     TO ASC-REASON-DESC           69120094
691300                         WHEN PE049-IS-MOS-SALVAGE-RSN            69130094
691400                             MOVE PE049-IS-SHORT-MOS-SALVAGE      69140094
691500                                     TO ASC-REASON-DESC           69150094
691600                         WHEN PE049-IS-FINANCIAL-ADJ-RSN          69160094
691700                             MOVE PE049-IS-SHORT-FIN-ADJ-DESC     69170094
691800                                     TO ASC-REASON-DESC           69180094
691900                         WHEN PE049-IS-INVENTORY-MISSED-RSN       69190094
692000                             MOVE PE049-IS-SHORT-POSS-INV-MSSD    69200094
692100                                     TO ASC-REASON-DESC           69210094
692200                         WHEN OTHER                               69220094
692300                             MOVE SPACES TO ASC-REASON-DESC       69230094
692400                     END-EVALUATE                                 69240094
692500             END-SEARCH                                           69250094
692600         END-IF                                                   69260094
692700     END-IF.                                                      69270094
692800*                                                                 69280094
692900 EJECT                                                            69290094
693000*----------------------------------------------------------------*69300094
693100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *69310094
693200*----------------------------------------------------------------*69320094
693300                                                                  69330094
693400 9100-READ-SEL-QUEUE.                                             69340094
693500     EXEC CICS                                                    69350094
693600         READQ TS                                                 69360094
693700             QUEUE (ASC-SEL-QUEUE-NAME)                           69370094
693800             INTO  (PE067-DOCUMENT-SEL-REC)                       69380094
693900             ITEM  (ASC-SEL-ITEM)                                 69390094
694000             RESP  (PV-CICS-RESP)                                 69400094
694100     END-EXEC.                                                    69410094
694200                                                                  69420094
694300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       69430094
694400         CONTINUE                                                 69440094
694500     ELSE                                                         69450094
694600         SET DP013-LOGIC-ABEND                                    69460094
694700             DP013-NO-ROLLBACK     TO TRUE                        69470094
694800         MOVE '9100-READ-SEL-QUEUE'                               69480094
694900                                   TO DP013-PARAGRAPH             69490094
695000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   69500094
695100                                   TO DP013-MESSAGE-TEXT (1)      69510094
695200         PERFORM DP013-0000-PROCESS-ABEND                         69520094
695300     END-IF.                                                      69530094
695400*                                                                 69540094
695500 EJECT                                                            69550094
695600*----------------------------------------------------------------*69560094
695700* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *69570094
695800*----------------------------------------------------------------*69580094
695900 9200-REWRITE-SEL-QUEUE.                                          69590094
696000     EXEC CICS                                                    69600094
696100          WRITEQ TS                                               69610094
696200              QUEUE  (ASC-SEL-QUEUE-NAME)                         69620094
696300              FROM   (PE067-DOCUMENT-SEL-REC)                     69630094
696400              ITEM   (ASC-SEL-ITEM)                               69640094
696500              RESP   (PV-CICS-RESP)                               69650094
696600              REWRITE                                             69660094
696700     END-EXEC.                                                    69670094
696800                                                                  69680094
696900     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   69690094
697000         SET DP013-CICS-ABEND                                     69700094
697100             DP013-NO-ROLLBACK     TO TRUE                        69710094
697200         MOVE '9200-REWRITE-SEL-QUEUE'                            69720094
697300                                   TO DP013-PARAGRAPH             69730094
697400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   69740094
697500                                   TO DP013-MESSAGE-TEXT (1)      69750094
697600         PERFORM DP013-0000-PROCESS-ABEND                         69760094
697700     END-IF.                                                      69770094
697800*----------------------------------------------------------------*69780094
697900*    DATE PROCESSOR MODULE                                       *69790094
698000*----------------------------------------------------------------*69800094
698100                                                                  69810094
698200     COPY DPPD017.                                                69820094
698300*                                                                 69830094
698400 EJECT                                                            69840094
698500*----------------------------------------------------------------*69850094
698600*    ABEND PROCESSOR MODULE                                      *69860094
698700*----------------------------------------------------------------*69870094
698800     COPY DPPD013.                                                69880094
