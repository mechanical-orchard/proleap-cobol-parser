000100 IDENTIFICATION DIVISION.                                         00010035
000200 PROGRAM-ID.     DSKUT409.                                        00020035
000300 AUTHOR.         RICHARD MOORE.                                   00030035
000400 DATE-WRITTEN.   12/30/98.                                        00040035
000500 DATE-COMPILED.                                                   00050035
000600*************************************************************     00060035
000700*    COBOL II WITH DB2    -  QA VERSION                     *     00070035
000800*                                                           *     00080035
000900*    DELETE GROUP 3 DATA                                    *     00090035
001000*                                                           *     00100035
001100*************************************************************     00110035
001200* CHANGE LOG:                                               *     00120035
001300*                                                           *     00130035
001400* 08/10/2022  JEAN KURK                  CHG0272895         *     00140035
001400*             REMOVE TABLES TIMBKVS, TIMKBUP, TAUBKVS,      *     00141035
001400*             TAUBKUP, TIMRCVS, TIMRCUP, TAURCUP, TAURCVS   *     00142035
004510* 04/10/2022  JEAN KURK                  CHG0286696         *     00142136
001400*             RECOMPILE FOR UPDATED COPYBOOKS               *     00142236
001500*************************************************************     00143035
001600                                                                  00144035
001700 ENVIRONMENT DIVISION.                                            00145035
001800                                                                  00146035
001900 INPUT-OUTPUT SECTION.                                            00147035
002000                                                                  00148035
002100 FILE-CONTROL.                                                    00149035
002200                                                                  00150035
002300     SELECT PO-NBR-FILE                                           00160035
002400         ASSIGN         TO UT-S-PO01.                             00170035
002500     SELECT TBLE-FILE                                             00180035
002600         ASSIGN         TO UT-S-TBL01.                            00190035
002700     SELECT CONTROL-FILE                                          00200035
002800         ASSIGN         TO UT-S-CTL01.                            00210035
002900                                                                  00220035
003000 DATA DIVISION.                                                   00230035
003010                                                                  00240035
003011 FILE SECTION.                                                    00250035
003012******************************************************************00260035
003013     COPY DSFD001.                                                00270035
003014                                                                  00280035
003015 WORKING-STORAGE SECTION.                                         00290035
003016                                                                  00300035
003017 01  PC-CONSTANTS.                                                00301035
003018     05  PC-90                       PIC S9(04)    COMP           00301135
003019                                                   VALUE 90.      00301235
003020     05  PC-A                        PIC  X(01)    VALUE 'A'.     00301335
003021     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00301435
003022     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   00301535
003023     05  PC-KHL                      PIC  X(03)    VALUE 'KHL'.   00301635
003024     05  PC-PRDCHK                   PIC  X(06)    VALUE 'PRDCHK'.00301735
003026     05  PC-PARM-TEXT                PIC  X(25)    VALUE          00301835
003027         'LOWER LEVEL ONLY         '.                             00301935
003028     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00302035
003029         'DSKUT409'.                                              00302135
003030                                                                  00302235
003031 01  WS-LOCAL-SERVER.                                             00302335
003032     05  WS-SUBSYS                   PIC X(04)  VALUE SPACES.     00302435
003033     05  FILLER                      PIC X(12)  VALUE SPACES.     00302535
003034******************************************************************00302635
003035     COPY DSWS08Q.                                                00302735
003036******************************************************************00302835
003037     COPY DSWS009.                                                00302935
003038******************************************************************00303035
003039     COPY DSWS10Q.                                                00303135
003040******************************************************************00303235
003050     COPY DPWS004.                                                00303335
003060******************************************************************00303435
003070*                                                                 00303535
003080*    USED IS DSPD002                                              00303635
003081     COPY DSRD002.                                                00303735
003082******************************************************************00303835
003083*  COMMUNICATIONS AREA FOR PROD TO TEST UTILITIES                 00303935
003084******************************************************************00304035
003085     COPY DSWS11Q.                                                00305035
003086*                                                                 00306035
003087******************************************************************00307035
003088*LINKAGE SECTION.                                                 00308035
003089******************************************************************00308135
003090*                                                                 00308235
003100 PROCEDURE DIVISION.                                              00308335
003200                                                                  00308435
003300 A100-MAINLINE.                                                   00308535
003410                                                                  00308635
003411     DISPLAY SPACES                                               00308735
003412     DISPLAY ' *** DSKUT409 ***'                                  00308835
003413     DISPLAY SPACES                                               00308935
003414                                                                  00309035
003420     PERFORM 1100-GET-DB2-INSTANCE.                               00310035
003430     PERFORM 1200-CHECK-IF-PRODUCTION.                            00320035
003440                                                                  00330035
003500     SET DS009-D-PGM TO TRUE.                                     00340035
003600     PERFORM DS002-INITIAL-PROCESSING.                            00350035
003700     PERFORM B100-PROCESSING                                      00360035
003800         UNTIL TABLE-EOF.                                         00370035
003900     PERFORM DS002-END-OF-JOB.                                    00380035
004000                                                                  00390035
004100     GOBACK.                                                      00400035
004200 EJECT                                                            00410035
004300***************************************************************** 00420035
004400*     FOR EACH TABLE, DELETE ANY EXISTING DATA AND THEN DELETE    00430035
004500*     THE DATA FROM THE FILE.                                     00440035
004600***************************************************************** 00450035
004700 B100-PROCESSING.                                                 00460035
004800*                                                                 00470035
004900     READ TBLE-FILE                                               00480035
005000         AT END SET TABLE-EOF TO TRUE.                            00490035
005100     IF NOT-TABLE-EOF                                             00500035
005200        MOVE TBLE-DATA-SIZE TO DS009-TBLE-DATA-SIZE               00510035
005300        MOVE TBLE-NAME  TO DS009-PROCESS-TABLE                    00520035
005400        MOVE TBLE-KEYS  TO DS009-PKYS                             00530035
005500        PERFORM DS002-DO-PROCESS                                  00540035
005600        IF DS009-DO-PROCESS                                       00550035
005700        DISPLAY '**********************************'              00560035
005800        DISPLAY DS009-PROCESS-TABLE                               00570035
005900        EVALUATE TRUE                                             00580035
006000         WHEN DS009-PROCESS-TABLE = 'TIMCNPO'                     00590035
006100             MOVE TBLE-DATA-ITEM TO WS-IMCNPO                     00600035
006200             MOVE WS-IMCNPO-PO-NBR  TO HOLD-PO-NBR                00610035
006300             DISPLAY HOLD-PO-NBR                                  00620035
006400             DISPLAY WS-IMCNPO                                    00630035
006500             PERFORM R100-DELETE                                  00640035
006600         WHEN DS009-PROCESS-TABLE = 'TIMBKPO'                     00650035
006700             MOVE TBLE-DATA-ITEM TO WS-IMBKPO                     00660035
006800             MOVE WS-IMBKPO-PO-NBR  TO HOLD-PO-NBR                00670035
006900             DISPLAY HOLD-PO-NBR                                  00680035
007000             DISPLAY WS-IMBKPO                                    00690035
007100             PERFORM R100-DELETE                                  00700035
007200*        WHEN DS009-PROCESS-TABLE = 'TIMBKVS'                     00710035
007300*            MOVE TBLE-DATA-ITEM TO WS-IMBKVS                     00720035
007400*            MOVE WS-IMBKVS-PO-NBR  TO HOLD-PO-NBR                00730035
007500*            DISPLAY HOLD-PO-NBR                                  00740035
007600*            DISPLAY WS-IMBKVS                                    00750035
007700*            PERFORM R100-DELETE                                  00760035
007800*        WHEN DS009-PROCESS-TABLE = 'TIMBKUP'                     00770035
007900*            MOVE TBLE-DATA-ITEM TO WS-IMBKUP                     00780035
008000*            MOVE WS-IMBKUP-PO-NBR  TO HOLD-PO-NBR                00790035
008100*            DISPLAY HOLD-PO-NBR                                  00800035
008200*            DISPLAY WS-IMBKUP                                    00810035
008300*            PERFORM R100-DELETE                                  00820035
008400         WHEN DS009-PROCESS-TABLE = 'TIMRCPO'                     00830035
008500             MOVE TBLE-DATA-ITEM TO WS-IMRCPO                     00840035
008600             MOVE WS-IMRCPO-PO-NBR  TO HOLD-PO-NBR                00850035
008700             DISPLAY HOLD-PO-NBR                                  00860035
008800             DISPLAY WS-IMRCPO                                    00870035
008900             PERFORM R100-DELETE                                  00880035
009000*        WHEN DS009-PROCESS-TABLE = 'TIMRCUP'                     00890035
009100*            MOVE TBLE-DATA-ITEM TO WS-IMRCUP                     00900035
009200*            MOVE WS-IMRCUP-PO-NBR  TO HOLD-PO-NBR                00910035
009300*            DISPLAY HOLD-PO-NBR                                  00920035
009400*            DISPLAY WS-IMRCUP                                    00930035
009500*            PERFORM R100-DELETE                                  00940035
009600*        WHEN DS009-PROCESS-TABLE = 'TIMRCVS'                     00950035
009700*            MOVE TBLE-DATA-ITEM TO WS-IMRCVS                     00960035
009800*            MOVE WS-IMRCVS-PO-NBR  TO HOLD-PO-NBR                00970035
009900*            DISPLAY HOLD-PO-NBR                                  00980035
010000*            DISPLAY WS-IMRCVS                                    00990035
010100*            PERFORM R100-DELETE                                  01000035
010200         WHEN DS009-PROCESS-TABLE = 'TIMCNTK'                     01010035
010300             MOVE TBLE-DATA-ITEM TO WS-IMCNTK                     01020035
010400             MOVE WS-IMCNTK-CONTNR-ID  TO HOLD-CONTNR-ID          01030035
010500             DISPLAY HOLD-CONTNR-ID                               01040035
010600             DISPLAY WS-IMCNTK                                    01050035
010700             PERFORM R100-DELETE                                  01060035
010800         WHEN DS009-PROCESS-TABLE = 'TIMCNUP'                     01070035
010900             MOVE TBLE-DATA-ITEM TO WS-IMCNUP                     01080035
011000             MOVE WS-IMCNUP-CONTNR-ID  TO HOLD-CONTNR-ID          01090035
011100             MOVE WS-IMCNUP-PO-NBR  TO HOLD-PO-NBR                01100035
011100*            MOVE WS-IMRCVS-PO-NBR  TO HOLD-PO-NBR                01110035
011200             DISPLAY HOLD-CONTNR-ID ' TIMCNUP '                   01120035
011300             DISPLAY HOLD-PO-NBR                                  01130035
011400             DISPLAY WS-IMCNUP                                    01140035
011500             PERFORM R100-DELETE                                  01150035
011600         WHEN DS009-PROCESS-TABLE = 'TIMCSEN'                     01160035
011700             MOVE TBLE-DATA-ITEM         TO WS-IMCSEN             01170035
011800             MOVE WS-IMCSEN-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01180035
011900             DISPLAY HOLD-CSTM-ENTR-ID                            01190035
012000             DISPLAY WS-IMCSEN                                    01200035
012100             PERFORM R100-DELETE                                  01210035
012200         WHEN DS009-PROCESS-TABLE = 'TIMCSBL'                     01220035
012300             MOVE TBLE-DATA-ITEM         TO WS-IMCSBL             01230035
012400             MOVE WS-IMCSBL-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01240035
012500             DISPLAY HOLD-CSTM-ENTR-ID                            01250035
012600             DISPLAY WS-IMCSBL                                    01260035
012700             PERFORM R100-DELETE                                  01270035
012800         WHEN DS009-PROCESS-TABLE = 'TIMCSCN'                     01280035
012900             MOVE TBLE-DATA-ITEM         TO WS-IMCSCN             01290035
013000             MOVE WS-IMCSCN-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01300035
013100             DISPLAY HOLD-CSTM-ENTR-ID                            01310035
013200             DISPLAY WS-IMCSCN                                    01320035
013300             PERFORM R100-DELETE                                  01330035
013400         WHEN DS009-PROCESS-TABLE = 'TIMCSPO'                     01340035
013500             MOVE TBLE-DATA-ITEM         TO WS-IMCSPO             01350035
013600             MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID     01360035
013700             DISPLAY HOLD-CSTM-ENTR-ID                            01370035
013800             DISPLAY WS-IMCSPO                                    01380035
013900             PERFORM R100-DELETE                                  01390035
014000         WHEN DS009-PROCESS-TABLE = 'TAUCSEN'                     01400035
014100             MOVE TBLE-DATA-ITEM          TO WS-AUCSEN            01410035
014200             MOVE WS-AUCSEN-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01420035
014300             DISPLAY HOLD-CSTM-ENTR-ID                            01430035
014400             DISPLAY WS-AUCSEN                                    01440035
014500             PERFORM R100-DELETE                                  01450035
014600         WHEN DS009-PROCESS-TABLE = 'TAUCSBL'                     01460035
014700             MOVE TBLE-DATA-ITEM          TO WS-AUCSBL            01470035
014800             MOVE WS-AUCSBL-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01480035
014900             DISPLAY HOLD-CSTM-ENTR-ID                            01490035
015000             DISPLAY WS-AUCSBL                                    01500035
015100             PERFORM R100-DELETE                                  01510035
015200         WHEN DS009-PROCESS-TABLE = 'TAUCSCN'                     01520035
015300             MOVE TBLE-DATA-ITEM          TO WS-AUCSCN            01530035
015400             MOVE WS-AUCSCN-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01540035
015500             DISPLAY HOLD-CSTM-ENTR-ID                            01550035
015600             DISPLAY WS-AUCSCN                                    01560035
015700             PERFORM R100-DELETE                                  01570035
015800         WHEN DS009-PROCESS-TABLE = 'TAUCSPO'                     01580035
015900             MOVE TBLE-DATA-ITEM          TO WS-AUCSPO            01590035
016000             MOVE WS-AUCSPO-CSTM-ENTR-ID  TO HOLD-CSTM-ENTR-ID    01600035
016100             DISPLAY HOLD-CSTM-ENTR-ID                            01610035
016200             DISPLAY WS-AUCSPO                                    01620035
016300             PERFORM R100-DELETE                                  01630035
016400         WHEN DS009-PROCESS-TABLE = 'TAURCPO'                     01640035
016500             MOVE TBLE-DATA-ITEM          TO WS-AURCPO            01650035
016600             MOVE WS-AURCPO-PO-NBR        TO HOLD-PO-NBR          01660035
016700             DISPLAY HOLD-PO-NBR                                  01670035
016800             DISPLAY WS-AURCPO                                    01680035
016900             PERFORM R100-DELETE                                  01690035
017000*        WHEN DS009-PROCESS-TABLE = 'TAURCVS'                     01700035
017100*            MOVE TBLE-DATA-ITEM          TO WS-AURCVS            01710035
017200*            MOVE WS-AURCVS-PO-NBR        TO HOLD-PO-NBR          01720035
017300*            DISPLAY HOLD-PO-NBR                                  01730035
017400*            DISPLAY WS-AURCVS                                    01740035
017500*            PERFORM R100-DELETE                                  01750035
017600*        WHEN DS009-PROCESS-TABLE = 'TAURCUP'                     01760035
017700*            MOVE TBLE-DATA-ITEM          TO WS-AURCUP            01770035
017800*            MOVE WS-AURCUP-PO-NBR        TO HOLD-PO-NBR          01780035
017900*            DISPLAY HOLD-PO-NBR                                  01790035
018000*            DISPLAY WS-AURCUP                                    01800035
018100*            PERFORM R100-DELETE                                  01810035
018200         WHEN DS009-PROCESS-TABLE = 'TAUBKPO'                     01820035
018300             MOVE TBLE-DATA-ITEM          TO WS-AUBKPO            01830035
018400             MOVE WS-AUBKPO-PO-NBR        TO HOLD-PO-NBR          01840035
018500             DISPLAY HOLD-PO-NBR                                  01850035
018600             DISPLAY WS-AUBKPO                                    01860035
018700             PERFORM R100-DELETE                                  01870035
018800*        WHEN DS009-PROCESS-TABLE = 'TAUBKVS'                     01880035
018900*            MOVE TBLE-DATA-ITEM          TO WS-AUBKVS            01890035
019000*            MOVE WS-AUBKVS-PO-NBR        TO HOLD-PO-NBR          01900035
019100*            DISPLAY HOLD-PO-NBR                                  01910035
019200*            DISPLAY WS-AUBKVS                                    01920035
019300*            PERFORM R100-DELETE                                  01930035
019400*        WHEN DS009-PROCESS-TABLE = 'TAUBKUP'                     01940035
019500*            MOVE TBLE-DATA-ITEM          TO WS-AUBKUP            01950035
019600*            MOVE WS-AUBKUP-PO-NBR        TO HOLD-PO-NBR          01960035
019700*            DISPLAY HOLD-PO-NBR                                  01970035
019800*            DISPLAY WS-AUBKUP                                    01980035
019900*            PERFORM R100-DELETE                                  01990035
020000         WHEN DS009-PROCESS-TABLE = 'TAUCNPO'                     02000035
020100             MOVE TBLE-DATA-ITEM          TO WS-AUCNPO            02010035
020200             MOVE WS-AUCNPO-PO-NBR        TO HOLD-PO-NBR          02020035
020300             DISPLAY HOLD-PO-NBR                                  02030035
020400             DISPLAY WS-AUCNPO                                    02040035
020500             PERFORM R100-DELETE                                  02050035
020600         WHEN DS009-PROCESS-TABLE = 'TAUCNUP'                     02060035
020700             MOVE TBLE-DATA-ITEM          TO WS-AUCNUP            02070035
020800             MOVE WS-AUCNUP-PO-NBR        TO HOLD-PO-NBR          02080035
020900             DISPLAY HOLD-PO-NBR                                  02090035
021000             DISPLAY WS-AUCNUP                                    02100035
021100             PERFORM R100-DELETE                                  02110035
021200         WHEN DS009-PROCESS-TABLE = 'TAUCNTK'                     02120035
021300             MOVE TBLE-DATA-ITEM           TO WS-AUCNTK           02130035
021400             MOVE WS-AUCNTK-CONTNR-ID      TO HOLD-CONTNR-ID      02140035
021500             MOVE WS-AUCNTK-CONTNR-SEQ-NBR TO HOLD-CONTNR-SEQ-NBR 02150035
021600             DISPLAY HOLD-CONTNR-ID                               02160035
021700             DISPLAY HOLD-CONTNR-SEQ-NBR                          02170035
021800             DISPLAY WS-AUCNTK                                    02180035
021900             PERFORM R100-DELETE                                  02190035
022000         WHEN DS009-PROCESS-TABLE = 'TELCPO'                      02200035
022100             MOVE TBLE-DATA-ITEM          TO WS-ELCPO             02210035
022200             MOVE WS-ELCPO-PO-NBR         TO HOLD-PO-NBR          02220035
022300             DISPLAY HOLD-PO-NBR                                  02230035
022400             DISPLAY WS-ELCPO                                     02240035
022500             PERFORM R100-DELETE                                  02250035
022600         WHEN DS009-PROCESS-TABLE = 'TELCVS'                      02260035
022700             MOVE TBLE-DATA-ITEM          TO WS-ELCVS             02270035
022800             MOVE WS-ELCVS-PO-NBR         TO HOLD-PO-NBR          02280035
022900             DISPLAY HOLD-PO-NBR                                  02290035
023000             DISPLAY WS-ELCVS                                     02300035
023100             PERFORM R100-DELETE                                  02310035
023200         WHEN DS009-PROCESS-TABLE = 'TVSCPT'                      02320035
023300             MOVE TBLE-DATA-ITEM          TO WS-VSCPT             02330035
023400             MOVE WS-VSCPT-PO-NBR         TO HOLD-PO-NBR          02340035
023500             DISPLAY HOLD-PO-NBR                                  02350035
023600             DISPLAY WS-VSCPT                                     02360035
023700             PERFORM R100-DELETE                                  02370035
023800         WHEN DS009-PROCESS-TABLE = 'TIMCNRL'                     02380035
023900             MOVE TBLE-DATA-ITEM           TO WS-IMCNRL           02390035
024000             MOVE WS-IMCNRL-PO-NBR         TO HOLD-PO-NBR         02400035
024100             MOVE WS-IMCNRL-CONTNR-ID      TO HOLD-CONTNR-ID      02410035
024200             MOVE WS-IMCNRL-CONTNR-SEQ-NBR TO HOLD-CONTNR-SEQ-NBR 02420035
024300             DISPLAY HOLD-CONTNR-ID ' TIMCNRL '                   02430035
024400             DISPLAY HOLD-CONTNR-SEQ-NBR                          02440035
024500             DISPLAY HOLD-PO-NBR                                  02450035
024600             DISPLAY WS-IMCNRL                                    02460035
024700             PERFORM R100-DELETE                                  02470035
024800         WHEN DS009-PROCESS-TABLE = 'TAUCNRL'                     02480035
024900             MOVE TBLE-DATA-ITEM           TO WS-AUCNRL           02490035
025000             MOVE WS-AUCNRL-PO-NBR         TO HOLD-PO-NBR         02500035
025100             MOVE WS-AUCNRL-CONTNR-ID      TO HOLD-CONTNR-ID      02510035
025200             MOVE WS-AUCNRL-CONTNR-SEQ-NBR TO HOLD-CONTNR-SEQ-NBR 02520035
025300             DISPLAY HOLD-CONTNR-ID ' TAUCNRL '                   02530035
025400             DISPLAY HOLD-CONTNR-SEQ-NBR                          02540035
025500             DISPLAY HOLD-PO-NBR                                  02550035
025600             DISPLAY WS-AUCNRL                                    02560035
025700             PERFORM R100-DELETE                                  02570035
025800         END-EVALUATE                                             02580035
025900         DISPLAY 'DELETE RETURN SQLCODE:' SQLCODE                 02590035
026000         DISPLAY 'NUMBER OF ROWS DELETED:' SQLERRD (3)            02600035
026100         IF DS009-UPDATE-COUNT > DS009-COMMIT-COUNT               02610035
026200            EXEC SQL                                              02620035
026300                COMMIT                                            02630035
026400            END-EXEC                                              02640035
026500            IF SQLCODE NOT = ZERO                                 02650035
026600               PERFORM DS002-SQL-ABEND-COMMIT                     02660035
026700            END-IF                                                02670035
026800            MOVE +0  TO DS009-UPDATE-COUNT                        02680035
026900            DISPLAY 'COMMIT TAKEN AFTER RECORD: '                 02690035
027000                                      DS009-TUPDATE-COUNT         02700035
027100         END-IF                                                   02710035
027200         ADD SQLERRD(3) TO DS009-UPDATE-COUNT                     02720035
027300         ADD SQLERRD(3) TO DS009-TUPDATE-COUNT                    02730035
027400        END-IF                                                    02740035
027500     END-IF.                                                      02750035
027600 EJECT                                                            02760035
027700***************************************************************** 02770035
027800*     DELETE PARAGRAPH                                          * 02780035
027900***************************************************************** 02790035
028000 R100-DELETE.                                                     02800035
028100     PERFORM WITH TEST AFTER                                      02810035
028200             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              02820035
028300             UNTIL   DS009-RETRY-COUNTER > 3 OR                   02830035
028400                     SQLCODE = ZERO OR +100                       02840035
028500                                                                  02850035
028600         EVALUATE TRUE                                            02860035
028700           WHEN DS009-PROCESS-TABLE = 'TIMCNPO'                   02870035
028800             EXEC SQL                                             02880035
028900                DELETE FROM TIMCNPO                               02890035
029000                WHERE PO_NBR = :HOLD-PO-NBR                       02900035
029100             END-EXEC                                             02910035
029200           WHEN DS009-PROCESS-TABLE = 'TIMBKPO'                   02920035
029300             EXEC SQL                                             02930035
029400                DELETE FROM TIMBKPO                               02940035
029500                WHERE PO_NBR = :HOLD-PO-NBR                       02950035
029600             END-EXEC                                             02960035
029700*          WHEN DS009-PROCESS-TABLE = 'TIMBKVS'                   02970035
029800*            EXEC SQL                                             02980035
029900*               DELETE FROM TIMBKVS                               02990035
030000*               WHERE PO_NBR = :HOLD-PO-NBR                       03000035
030100*            END-EXEC                                             03010035
030200*          WHEN DS009-PROCESS-TABLE = 'TIMBKUP'                   03020035
030300*            EXEC SQL                                             03030035
030400*               DELETE FROM TIMBKUP                               03040035
030500*               WHERE PO_NBR = :HOLD-PO-NBR                       03050035
030600*            END-EXEC                                             03060035
030700           WHEN DS009-PROCESS-TABLE = 'TIMRCPO'                   03070035
030800             EXEC SQL                                             03080035
030900                DELETE FROM TIMRCPO                               03090035
031000                WHERE PO_NBR = :HOLD-PO-NBR                       03100035
031100             END-EXEC                                             03110035
031200*          WHEN DS009-PROCESS-TABLE = 'TIMRCUP'                   03120035
031300*            EXEC SQL                                             03130035
031400*               DELETE FROM TIMRCUP                               03140035
031500*               WHERE PO_NBR = :HOLD-PO-NBR                       03150035
031600*            END-EXEC                                             03160035
031700*          WHEN DS009-PROCESS-TABLE = 'TIMRCVS'                   03170035
031800*            EXEC SQL                                             03180035
031900*               DELETE FROM TIMRCVS                               03190035
032000*               WHERE PO_NBR = :HOLD-PO-NBR                       03200035
032100*            END-EXEC                                             03210035
032200           WHEN DS009-PROCESS-TABLE = 'TIMCNTK'                   03220035
032300             EXEC SQL                                             03230035
032400                DELETE FROM TIMCNTK                               03240035
032500                WHERE CONTNR_ID  = :HOLD-CONTNR-ID                03250035
032600             END-EXEC                                             03260035
032700           WHEN DS009-PROCESS-TABLE = 'TIMCNUP'                   03270035
032800             EXEC SQL                                             03280035
032900                DELETE FROM TIMCNUP                               03290035
033000                WHERE CONTNR_ID = :HOLD-CONTNR-ID                 03300035
033100                AND   PO_NBR    = :HOLD-PO-NBR                    03310035
033200             END-EXEC                                             03320035
033300           WHEN DS009-PROCESS-TABLE = 'TIMCSEN'                   03330035
033400             EXEC SQL                                             03340035
033500                DELETE FROM TIMCSEN                               03350035
033600                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03360035
033700             END-EXEC                                             03370035
033800           WHEN DS009-PROCESS-TABLE = 'TIMCSBL'                   03380035
033900             EXEC SQL                                             03390035
034000                DELETE FROM TIMCSBL                               03400035
034100                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03410035
034200             END-EXEC                                             03420035
034300           WHEN DS009-PROCESS-TABLE = 'TIMCSCN'                   03430035
034400             EXEC SQL                                             03440035
034500                DELETE FROM TIMCSCN                               03450035
034600                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03460035
034700             END-EXEC                                             03470035
034800           WHEN DS009-PROCESS-TABLE = 'TIMCSPO'                   03480035
034900             EXEC SQL                                             03490035
035000                DELETE FROM TIMCSPO                               03500035
035100                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03510035
035200             END-EXEC                                             03520035
035300           WHEN DS009-PROCESS-TABLE = 'TAUCSEN'                   03530035
035400             EXEC SQL                                             03540035
035500                DELETE FROM TAUCSEN                               03550035
035600                WHERE CSTM_ENTR_ID  = :HOLD-CSTM-ENTR-ID          03560035
035700             END-EXEC                                             03570035
035800           WHEN DS009-PROCESS-TABLE = 'TAUCSBL'                   03580035
035900             EXEC SQL                                             03590035
036000                DELETE FROM TAUCSBL                               03600035
036100                WHERE CSTM_ENTR_ID = :HOLD-CSTM-ENTR-ID           03610035
036200             END-EXEC                                             03620035
036300           WHEN DS009-PROCESS-TABLE = 'TAUCSCN'                   03630035
036400             EXEC SQL                                             03640035
036500                DELETE FROM TAUCSCN                               03650035
036600                WHERE CSTM_ENTR_ID = :HOLD-CSTM-ENTR-ID           03660035
036700             END-EXEC                                             03670035
036800           WHEN DS009-PROCESS-TABLE = 'TAUCSPO'                   03680035
036900             EXEC SQL                                             03690035
037000                DELETE FROM TAUCSPO                               03700035
037100                WHERE CSTM_ENTR_ID = :HOLD-CSTM-ENTR-ID           03710035
037200             END-EXEC                                             03720035
037300           WHEN DS009-PROCESS-TABLE = 'TAURCPO'                   03730035
037400             EXEC SQL                                             03740035
037500                DELETE FROM TAURCPO                               03750035
037600                WHERE PO_NBR       = :HOLD-PO-NBR                 03760035
037700             END-EXEC                                             03770035
037800*          WHEN DS009-PROCESS-TABLE = 'TAURCVS'                   03780035
037900*            EXEC SQL                                             03790035
038000*               DELETE FROM TAURCVS                               03800035
038100*               WHERE PO_NBR       = :HOLD-PO-NBR                 03810035
038200*            END-EXEC                                             03820035
038300*          WHEN DS009-PROCESS-TABLE = 'TAURCUP'                   03830035
038400*            EXEC SQL                                             03840035
038500*               DELETE FROM TAURCUP                               03850035
038600*               WHERE PO_NBR       = :HOLD-PO-NBR                 03860035
038700*            END-EXEC                                             03870035
038800           WHEN DS009-PROCESS-TABLE = 'TAUBKPO'                   03880035
038900             EXEC SQL                                             03890035
039000                DELETE FROM TAUBKPO                               03900035
039100                WHERE PO_NBR       = :HOLD-PO-NBR                 03910035
039200             END-EXEC                                             03920035
039300*          WHEN DS009-PROCESS-TABLE = 'TAUBKVS'                   03930035
039400*            EXEC SQL                                             03940035
039500*               DELETE FROM TAUBKVS                               03950035
039600*               WHERE PO_NBR       = :HOLD-PO-NBR                 03960035
039700*            END-EXEC                                             03970035
039800*          WHEN DS009-PROCESS-TABLE = 'TAUBKUP'                   03980035
039810*            EXEC SQL                                             03981035
039820*               DELETE FROM TAUBKUP                               03982035
039830*               WHERE PO_NBR       = :HOLD-PO-NBR                 03983035
039840*            END-EXEC                                             03984035
039850           WHEN DS009-PROCESS-TABLE = 'TAUCNPO'                   03985035
039860             EXEC SQL                                             03986035
039870                DELETE FROM TAUCNPO                               03987035
039880                WHERE PO_NBR       = :HOLD-PO-NBR                 03988035
039890             END-EXEC                                             03989035
039900           WHEN DS009-PROCESS-TABLE = 'TAUCNUP'                   03990035
039910             EXEC SQL                                             03991035
039920                DELETE FROM TAUCNUP                               03992035
039930                WHERE PO_NBR       = :HOLD-PO-NBR                 03993035
039940             END-EXEC                                             03994035
039950           WHEN DS009-PROCESS-TABLE = 'TAUCNTK'                   03995035
039960             EXEC SQL                                             03996035
039970                DELETE FROM TAUCNTK                               03997035
039980                WHERE CONTNR_ID      = :HOLD-CONTNR-ID            03998035
039990                AND   CONTNR_SEQ_NBR = :HOLD-CONTNR-SEQ-NBR       03999035
039991             END-EXEC                                             03999135
039992           WHEN DS009-PROCESS-TABLE = 'TELCPO'                    03999235
039993             EXEC SQL                                             03999335
039994                DELETE FROM TELCPO                                03999435
039995                WHERE PO_NBR       = :HOLD-PO-NBR                 03999535
039996             END-EXEC                                             03999635
039997           WHEN DS009-PROCESS-TABLE = 'TELCVS'                    03999735
039998             EXEC SQL                                             03999835
039999                DELETE FROM TELCVS                                03999935
040000                WHERE PO_NBR       = :HOLD-PO-NBR                 04000035
040010             END-EXEC                                             04001035
040020           WHEN DS009-PROCESS-TABLE = 'TVSCPT'                    04002035
040030             EXEC SQL                                             04003035
040040                DELETE FROM TVSCPT                                04004035
040041                WHERE PO_NBR       = :HOLD-PO-NBR                 04004135
040042             END-EXEC                                             04004235
040043           WHEN DS009-PROCESS-TABLE = 'TIMCNRL'                   04004335
040044             EXEC SQL                                             04004435
040045                DELETE FROM TIMCNRL                               04004535
040046                WHERE CONTNR_ID      = :HOLD-CONTNR-ID            04004635
040047                AND   CONTNR_SEQ_NBR = :HOLD-CONTNR-SEQ-NBR       04004735
040048                AND   PO_NBR         = :HOLD-PO-NBR               04004835
040049             END-EXEC                                             04004935
040050           WHEN DS009-PROCESS-TABLE = 'TAUCNRL'                   04005035
040060             EXEC SQL                                             04006035
040070                DELETE FROM TAUCNRL                               04007035
040080                WHERE CONTNR_ID      = :HOLD-CONTNR-ID            04008035
040090                AND   CONTNR_SEQ_NBR = :HOLD-CONTNR-SEQ-NBR       04009035
040091                AND   PO_NBR         = :HOLD-PO-NBR               04009135
040092             END-EXEC                                             04009235
040093         END-EVALUATE                                             04009335
040094     END-PERFORM.                                                 04009435
040095     PERFORM DS002-SQL-ABEND-DELETE.                              04009535
040096 EJECT                                                            04009635
040097                                                                  04009735
040098 1100-GET-DB2-INSTANCE.                                           04009835
040099                                                                  04009935
040100     MOVE '1100-GET-DB2-INSTANCE'                                 04010035
040101          TO DS009-PARAGRAPH.                                     04010135
040102     MOVE 'GET DB2 INSTANCE'                                      04010235
040103          TO DS009-OPERATION.                                     04010335
040104                                                                  04010435
040105     EXEC SQL                                                     04010535
040106         SELECT CURRENT SERVER INTO :WS-LOCAL-SERVER              04010635
040107             FROM SYSIBM.SYSDUMMY1 WITH UR                        04010735
040108     END-EXEC.                                                    04010835
040109                                                                  04010935
040110     EVALUATE TRUE                                                04011035
040111         WHEN SQLCODE = +0                                        04011135
040112             CONTINUE                                             04011235
040113         WHEN SQLWARN0 NOT = SPACES                               04011335
040114         WHEN SQLCODE < +0                                        04011435
040115         WHEN SQLCODE > +0                                        04011535
040116             PERFORM DS002-SQL-ERROR                              04011635
040117     END-EVALUATE.                                                04011735
040118*                                                                 04011835
040119 1200-CHECK-IF-PRODUCTION.                                        04011935
040120                                                                  04012035
040121     MOVE '1200-CHECK-IF-PRODUCTION'                              04012135
040122          TO DS009-PARAGRAPH.                                     04012235
040123     MOVE 'SELECT PRDCHK TKRPRPM '                                04012335
040124          TO DS009-OPERATION.                                     04012435
040125                                                                  04012535
040126     EXEC SQL                                                     04012635
040127       SELECT FUNC_TXT                                            04012735
040128         INTO :KRPRPM-FUNC-TXT                                    04012835
040129       FROM   TKRPRPM                                             04012935
040130       WHERE  SYS_PRC_FUNC_CDE  = :PC-PRDCHK                      04013035
040131         AND  INTFC_SYS_CDE     = :PC-KHL                         04013135
040132         AND  LOC_ID            = :PC-90                          04013235
040133         AND  FUNC_TXT          = :PC-PARM-TEXT                   04013335
040134     END-EXEC                                                     04013435
040135                                                                  04013535
040136     EVALUATE TRUE                                                04013635
040137         WHEN SQLCODE = +0                                        04013735
040138             CONTINUE                                             04013835
040139         WHEN SQLCODE = +100                                      04013935
040140             DISPLAY '*******************************************'04014035
040141             DISPLAY '** ABEND - DO NOT RUN THIS DSKUT409 PROGRAM'04014135
040142             DISPLAY '** ABEND - AGAINST PRODUCTION'              04014235
040143             DISPLAY '** ABEND - THIS SHOULD ONLY EVER BE'        04014335
040144             DISPLAY '** ABEND - RUN AGAINST TEST DATA'           04014435
040145             DISPLAY '*******************************************'04014535
040146             DISPLAY '** ABEND - THIS RUN IS GOING AGAINST'       04014635
040147             DISPLAY '** ABEND - DB2 INSTANCE:  '                 04014735
040148                     WS-LOCAL-SERVER                              04014835
040149             DISPLAY '*******************************************'04014935
040150             PERFORM DS002-SQL-ERROR                              04015035
040151                                                                  04015135
040152         WHEN SQLWARN0 NOT = SPACES                               04015235
040153         WHEN SQLCODE < +0                                        04015335
040154         WHEN SQLCODE > +0                                        04015435
040155             PERFORM DS002-SQL-ERROR                              04015535
040156     END-EVALUATE.                                                04015635
040157                                                                  04015735
040158***************************************************************** 04015835
040159*     PRODUCTION - TO - TEST STANDARD PARAGRAPHS                * 04015935
040160***************************************************************** 04016035
040200     COPY DSPD02Q.                                                04017035
