000100 IDENTIFICATION DIVISION.                                                 
000200 PROGRAM-ID.      XIKUP001.                                               
000300 AUTHOR.          JEFF ROUBIK.                                            
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                                
000500 DATE-WRITTEN.    JANUARY 2004.                                           
000600                                                                          
000700*****************************************************************         
000800*  POPULATE LOCATION DATA TABLE XIT_LOC TABLE FROM 3 FLAT FILE            
000900*  EXTRACTS OF RMS STORE DATA.                                            
000910*                                                                         
000911*** THIS PROGRAM IS USED IN PRODUCTION TO UPDATE THE TEST, QA,            
000920*** LEARN AND PRODUCTION TABLES.  AS A RESULT, IT NEEDS TO BE             
000930*** BOUND SPECIALLY BY A DBA AFTER PROMOTION TO PRODUCTION.               
001000*****************************************************************         
001100*---------------------------------------------------------------          
001200*    WR/PITS#     DATE        DESCRIPTION                                 
001300*    --------   ----------   ---------------------------------            
001400*    WR26187    01/13/2004   COPIED FROM XMKUP013, XMKUP014 &             
001500*                            XMKUP015 (MERGED) AND MODIFIED               
001600*                            FOR XI DOMAIN.                               
001700*---------------------------------------------------------------          
001800 ENVIRONMENT DIVISION.                                                    
001900 CONFIGURATION SECTION.                                                   
002000                                                                          
002100 SOURCE-COMPUTER.       IBM-3090.                                         
002200 OBJECT-COMPUTER.       IBM-3090.                                         
002300                                                                          
002400 INPUT-OUTPUT SECTION.                                                    
002500                                                                          
002600 FILE-CONTROL.                                                            
002700                                                                          
002800     SELECT STORE-FILE      ASSIGN TO INP01.                              
002900     SELECT WAREHOUSE-FILE  ASSIGN TO INP02.                              
003000     SELECT OUTLOC-FILE     ASSIGN TO INP03.                              
003100                                                                          
003200                                                                          
003300 DATA DIVISION.                                                           
003400 FILE SECTION.                                                            
003500                                                                          
003600 FD  STORE-FILE                                                           
003700     RECORDING MODE IS F                                                  
003800     BLOCK CONTAINS 0 RECORDS                                             
003900     LABEL RECORDS ARE STANDARD.                                          
004000                                                                          
004100 01  STORE-RECORD      PIC X(687).                                        
004200                                                                          
004300 FD  WAREHOUSE-FILE                                                       
004400     RECORDING MODE IS F                                                  
004500     BLOCK CONTAINS 0 RECORDS                                             
004600     LABEL RECORDS ARE STANDARD.                                          
004700                                                                          
004800 01  WAREHOUSE-RECORD  PIC X(192).                                        
004900                                                                          
005000 FD  OUTLOC-FILE                                                          
005100     RECORDING MODE IS F                                                  
005200     BLOCK CONTAINS 0 RECORDS                                             
005300     LABEL RECORDS ARE STANDARD.                                          
005400                                                                          
005500 01  OUTLOC-RECORD     PIC X(194).                                        
005600                                                                          
005700 WORKING-STORAGE SECTION.                                                 
005800******************************************************************        
005900* PROGRAM CONSTANTS                                                       
006000******************************************************************        
006100 01  PA-PROGRAM-ACCUMULATORS.                                             
006200     05  PA-RECORDS-READ          PIC 9(07) VALUE ZERO.                   
006300     05  PA-ROWS-INSERTED         PIC 9(07) VALUE ZERO.                   
006400                                                                          
006500 01  PC-PROGRAM-CONSTANTS.                                                
006600     05  PC-RETRY-MAX                PIC 9(01)  VALUE 5.                  
006700                                                                          
006800     05  PC-PGM-NAME                  PIC X(08)      VALUE                
006900         'XIKUP001'.                                                      
007000     05  PC-DEFAULT-DATE             PIC X(10)       VALUE                
007100         '9999-09-09'.                                                    
007200                                                                          
007300******************************************************************        
007400* PROGRAM SWITCHES                                                        
007500******************************************************************        
007600 01  PS-PROCESS-SWITCHES.                                                 
007700     05  PS-END-OF-STORE-SW           PIC X(01)      VALUE 'N'.           
007800         88  PS-NOT-END-STORE                        VALUE 'N'.           
007900         88  PS-END-OF-STORE                         VALUE 'Y'.           
008000     05  PS-END-OF-WHSE-SW            PIC X(01)      VALUE 'N'.           
008100         88  PS-NOT-END-WHSE                         VALUE 'N'.           
008200         88  PS-END-OF-WHSE                          VALUE 'Y'.           
008300     05  PS-END-OF-OUTLOC-SW          PIC X(01)      VALUE 'N'.           
008400         88  PS-NOT-END-OUTLOC                       VALUE 'N'.           
008500         88  PS-END-OF-OUTLOC                        VALUE 'Y'.           
008600     05  PS-PROCESS-CONTINUE-SW       PIC X(01)      VALUE 'Y'.           
008700         88  PS-PROCESS-CONTINUE                     VALUE 'Y'.           
008800         88  PS-PROCESS-COMPLETE                     VALUE 'N'.           
008900                                                                          
009000******************************************************************        
009100* PROGRAM VARIABLES                                                       
009200******************************************************************        
009300 01  PV-PROGRAM-VARIABLES.                                                
009400     05  ABEND-CODE                     PIC S9(04) VALUE +0.              
009500     05  PV-RETRY-COUNTER               PIC  9(01)  VALUE ZEROS.          
009600     05  PV-PARAGRAPH                   PIC  X(50).                       
009700     05  PV-MESSAGE                     PIC  X(50).                       
009800     05  PV-LOC-MEDN-AGE.                                                 
009900         10  PV-LOC-MEDN-AGE-NBR-NUM    PIC 9(02).                        
010000         10  FILLER                     PIC X(01).                        
010100         10  PV-LOC-MEDN-AGE-NBR-DEC    PIC 9(02).                        
010200     05  PV-LOC-MEDN-AGE-WHOLE.                                           
010300         10  PV-LOC-MEDN-AGE-NBR-1      PIC 9(02).                        
010400         10  PV-LOC-MEDN-AGE-NBR-2      PIC 9(02).                        
010500     05  PV-LOC-MEDN-AGE-NBR            PIC 9(02)V99.                     
010600******************************************************************        
010700**COPYBOOKS                                                               
010800******************************************************************        
010900*----------------------------------------------------------------*        
011000* RECORD LAYOUT FOR INPUT LOCATION FILES                                  
011100*----------------------------------------------------------------*        
011200     COPY HORD013.                                                        
011300     COPY HORD014.                                                        
011400     COPY HORD015.                                                        
011500*----------------------------------------------------------------*        
011600*    STANDARD DB2 ERROR HANDLING AREA                            *        
011700*----------------------------------------------------------------*        
011800     COPY DPWS004.                                                        
011900*----------------------------------------------------------------*        
012000*    STANDARD DB2 DCLGEN FOR THE LOCATION TABLE (XIT_LOC)        *        
012100*----------------------------------------------------------------*        
012200     EXEC SQL                                                             
012300         INCLUDE XIT00000                                                 
012400     END-EXEC.                                                            
012500*----------------------------------------------------------------*        
012600*    STANDARD DB2 COMMUNICATIONS AREA                            *        
012700*----------------------------------------------------------------*        
012800     EXEC SQL                                                             
012900         INCLUDE SQLCA                                                    
013000     END-EXEC.                                                            
013100                                                                          
013200                                                                          
013300 PROCEDURE DIVISION.                                                      
013400                                                                          
013500     PERFORM 4000-EMPTY-XIT-LOC.                                          
013600                                                                          
013700     OPEN INPUT  STORE-FILE.                                              
013800     PERFORM 1010-READ-STORE-FILE.                                        
013900     PERFORM 2010-PROCESS-STORE                                           
014000         UNTIL PS-END-OF-STORE.                                           
014100     CLOSE STORE-FILE.                                                    
014200                                                                          
014300     OPEN INPUT  WAREHOUSE-FILE.                                          
014400     PERFORM 1020-READ-WHSE-FILE.                                         
014500     PERFORM 2020-PROCESS-WHSE                                            
014600         UNTIL PS-END-OF-WHSE.                                            
014700     CLOSE WAREHOUSE-FILE.                                                
014800                                                                          
014900     OPEN INPUT  OUTLOC-FILE.                                             
015000     PERFORM 1030-READ-OUTLOC-FILE.                                       
015100     PERFORM 2030-PROCESS-OUTLOC                                          
015200         UNTIL PS-END-OF-OUTLOC.                                          
015300     CLOSE OUTLOC-FILE.                                                   
015400                                                                          
015500     DISPLAY 'INPUT RECORDS READ: ' PA-RECORDS-READ.                      
015600     DISPLAY 'ROWS INSERTED:      ' PA-ROWS-INSERTED.                     
015700                                                                          
015800     GOBACK.                                                              
015900                                                                          
016000                                                                          
016100 1010-READ-STORE-FILE.                                                    
016200                                                                          
016300     READ STORE-FILE INTO HO013-LOCATION-DATA                             
016400        AT END                                                            
016500           SET PS-END-OF-STORE TO TRUE.                                   
016600                                                                          
016700     IF PS-END-OF-STORE                                                   
016800         CONTINUE                                                         
016900     ELSE                                                                 
017000         ADD 1 TO PA-RECORDS-READ                                         
017100     END-IF.                                                              
017200                                                                          
017300 1020-READ-WHSE-FILE.                                                     
017400                                                                          
017500     READ WAREHOUSE-FILE INTO HO014-WH-DATA                               
017600        AT END                                                            
017700           SET PS-END-OF-WHSE TO TRUE.                                    
017800                                                                          
017900     IF PS-END-OF-WHSE                                                    
018000         CONTINUE                                                         
018100     ELSE                                                                 
018200         ADD 1 TO PA-RECORDS-READ                                         
018300     END-IF.                                                              
018400                                                                          
018500 1030-READ-OUTLOC-FILE.                                                   
018600                                                                          
018700     READ OUTLOC-FILE INTO HO015-OUTLOC-DATA                              
018800        AT END                                                            
018900           SET PS-END-OF-OUTLOC TO TRUE.                                  
019000                                                                          
019100     IF PS-END-OF-OUTLOC                                                  
019200         CONTINUE                                                         
019300     ELSE                                                                 
019400         ADD 1 TO PA-RECORDS-READ                                         
019500     END-IF.                                                              
019600                                                                          
019700                                                                          
019800 2010-PROCESS-STORE.                                                      
019900                                                                          
020000     INITIALIZE DCLXIT00000.                                              
020100     MOVE HO013-LOC-NBR              TO XIT00000-LOC-NBR.                 
020200     IF HO013-LOC-REPLT-STR-NBR NUMERIC                                   
020300         MOVE HO013-LOC-REPLT-STR-NBR TO XIT00000-REPLT-STR-NBR           
020400     END-IF.                                                              
020500     MOVE HO013-LOC-DIST-NBR         TO XIT00000-DIST-NBR.                
020600     MOVE HO013-LOC-TYP-CDE          TO XIT00000-LOC-TYP-CDE.             
020700     MOVE HO013-LOC-NM               TO XIT00000-LOC-NM.                  
020800     MOVE HO013-LOC-5-ABBR-NM        TO XIT00000-LOC-5-ABBR-NM.           
020900     MOVE HO013-LOC-LNE-1-ADDR       TO XIT00000-LNE-1-ADDR.              
021000     MOVE HO013-LOC-LNE-2-ADDR       TO XIT00000-LNE-2-ADDR.              
021100     MOVE HO013-LOC-CITY             TO XIT00000-CTY-NM.                  
021200     MOVE HO013-LOC-ST-CDE           TO XIT00000-ST-CDE.                  
021300     MOVE HO013-LOC-ZIP-10-CDE       TO XIT00000-ZIP-10-CDE.              
021400     MOVE HO013-LOC-PHONE-NUMBER     TO XIT00000-PHN-NBR.                 
021500     MOVE HO013-LOC-MGR-NM           TO XIT00000-MGR-NM.                  
021600     MOVE HO013-LOC-DST-IND          TO XIT00000-DST-IND.                 
021700     MOVE HO013-LOC-E-BUS-IND        TO XIT00000-E-BUS-IND.               
021800     MOVE HO013-LOC-FMT-CDE          TO XIT00000-FMT-CDE.                 
021900     MOVE HO013-LOC-STD-TM-ZN-CDE    TO XIT00000-STD-TM-ZN-CDE.           
022000     MOVE HO013-LOC-SLS-INCL-DTE-CDE TO XIT00000-SLS-INCL-DTE-CDE.        
022100     MOVE ZEROES                     TO XIT00000-POS-RGST-BNK-QTY.        
022200     MOVE HO013-LOC-TOT-SLG-SQ-FTG-QTY TO                                 
022300          XIT00000-TOT-SLG-SQ-FTG-QTY.                                    
022400     MOVE HO013-LOC-TOT-SQ-FTG-QTY   TO XIT00000-TOT-SQ-FTG-QTY.          
022500     MOVE HO013-LOC-STP-ORD-DAYS-QTY TO XIT00000-STP-ORD-DAYS-QTY.        
022600     MOVE HO013-LOC-STRT-ORD-DAYS-QTY TO                                  
022700          XIT00000-STRT-ORD-DAYS-QTY.                                     
022800                                                                          
022900     MOVE HO013-LOC-MEDN-AGE-NBR     TO PV-LOC-MEDN-AGE.                  
023000     MOVE PV-LOC-MEDN-AGE-NBR-NUM    TO PV-LOC-MEDN-AGE-NBR-1.            
023100     MOVE PV-LOC-MEDN-AGE-NBR-DEC    TO PV-LOC-MEDN-AGE-NBR-2.            
023200     MOVE PV-LOC-MEDN-AGE-WHOLE      TO PV-LOC-MEDN-AGE-NBR.              
023300     MOVE PV-LOC-MEDN-AGE-NBR        TO XIT00000-MEDN-AGE-NBR.            
023400                                                                          
023500     MOVE HO013-LOC-EST-HH-INCM-AMT  TO XIT00000-EST-HH-INCM-AMT.         
023600     MOVE HO013-LOC-EXTD-MALL-NM     TO XIT00000-EXTD-MALL-NM.            
023700     MOVE HO013-LOC-IN-STR-PRCHG-IND TO XIT00000-IN-STR-PRCHG-IND.        
023800     MOVE HO013-LOC-PRCHG-IND        TO XIT00000-PRCHG-CRE-IND.           
023900                                                                          
024000     IF HO013-LOC-OPEN-DATE = SPACES                                      
024100         MOVE PC-DEFAULT-DATE     TO XIT00000-OPN-DTE                     
024200     ELSE                                                                 
024300         MOVE HO013-LOC-OPEN-DATE TO XIT00000-OPN-DTE                     
024400     END-IF.                                                              
024500                                                                          
024600     IF HO013-LOC-CLOSE-DATE = SPACES                                     
024700         MOVE PC-DEFAULT-DATE      TO XIT00000-CLO-DTE                    
024800     ELSE                                                                 
024900         MOVE HO013-LOC-CLOSE-DATE TO XIT00000-CLO-DTE                    
025000     END-IF.                                                              
025100                                                                          
025200     IF HO013-LOC-FINCL-CLO-DTE = SPACES                                  
025300         MOVE PC-DEFAULT-DATE         TO XIT00000-FINCL-CLO-DTE           
025400     ELSE                                                                 
025500         MOVE HO013-LOC-FINCL-CLO-DTE TO XIT00000-FINCL-CLO-DTE           
025600     END-IF.                                                              
025700                                                                          
025800     IF HO013-LOC-MN-SLS-INCL-DTE = SPACES                                
025900         MOVE PC-DEFAULT-DATE           TO                                
026000              XIT00000-MN-SLS-INCL-DTE                                    
026100     ELSE                                                                 
026200         MOVE HO013-LOC-MN-SLS-INCL-DTE TO                                
026300              XIT00000-MN-SLS-INCL-DTE                                    
026400     END-IF.                                                              
026500                                                                          
026600     IF HO013-LOC-YR-SLS-INCL-DTE = SPACES                                
026700         MOVE PC-DEFAULT-DATE           TO                                
026800              XIT00000-YR-SLS-INCL-DTE                                    
026900     ELSE                                                                 
027000         MOVE HO013-LOC-YR-SLS-INCL-DTE TO                                
027100              XIT00000-YR-SLS-INCL-DTE                                    
027200     END-IF.                                                              
027300     IF HO013-LOC-QTR-SLS-INCL-DTE = SPACES                               
027400         MOVE PC-DEFAULT-DATE           TO                                
027500              XIT00000-QTR-SLS-INCL-DTE                                   
027600     ELSE                                                                 
027700         MOVE HO013-LOC-QTR-SLS-INCL-DTE TO                               
027800              XIT00000-QTR-SLS-INCL-DTE                                   
027900     END-IF.                                                              
028000                                                                          
028100     IF HO013-LOC-SEA-SLS-INCL-DTE = SPACES                               
028200         MOVE PC-DEFAULT-DATE            TO                               
028300              XIT00000-SEA-SLS-INCL-DTE                                   
028400     ELSE                                                                 
028500         MOVE HO013-LOC-SEA-SLS-INCL-DTE TO                               
028600              XIT00000-SEA-SLS-INCL-DTE                                   
028700     END-IF.                                                              
028800                                                                          
028900     IF HO013-LOC-OCPNC-DTE = SPACES                                      
029000         MOVE PC-DEFAULT-DATE     TO XIT00000-OCPNC-DTE                   
029100     ELSE                                                                 
029200         MOVE HO013-LOC-OCPNC-DTE TO XIT00000-OCPNC-DTE                   
029300     END-IF.                                                              
029400                                                                          
029500     IF HO013-LOC-GRND-OPN-DTE = SPACES                                   
029600         MOVE PC-DEFAULT-DATE        TO XIT00000-GRND-OPN-DTE             
029700     ELSE                                                                 
029800         MOVE HO013-LOC-GRND-OPN-DTE TO XIT00000-GRND-OPN-DTE             
029900     END-IF.                                                              
030000                                                                          
030100     IF HO013-LOC-ACQR-DTE = SPACES                                       
030200         MOVE PC-DEFAULT-DATE        TO XIT00000-ACQR-DTE                 
030300     ELSE                                                                 
030400         MOVE HO013-LOC-ACQR-DTE     TO XIT00000-ACQR-DTE                 
030500     END-IF.                                                              
030600                                                                          
030700     IF HO013-LOC-REMDL-DTE = SPACES                                      
030800         MOVE PC-DEFAULT-DATE        TO XIT00000-RMDL-DTE                 
030900     ELSE                                                                 
031000         MOVE HO013-LOC-REMDL-DTE    TO XIT00000-RMDL-DTE                 
031100     END-IF.                                                              
031200                                                                          
031300     PERFORM 3010-INSERT-STORE.                                           
031400     PERFORM 1010-READ-STORE-FILE.                                        
031500                                                                          
031600 2020-PROCESS-WHSE.                                                       
031700     INITIALIZE DCLXIT00000.                                              
031800     MOVE HO014-WH-NBR               TO XIT00000-LOC-NBR.                 
031900     MOVE HO014-WH-TYP-CDE           TO XIT00000-LOC-TYP-CDE.             
032000     MOVE HO014-WH-NM                TO XIT00000-LOC-NM.                  
032100     MOVE HO014-WH-5-ABBR-NM         TO XIT00000-LOC-5-ABBR-NM.           
032200     MOVE HO014-WH-LNE-1-ADDR        TO XIT00000-LNE-1-ADDR.              
032300     MOVE HO014-WH-LNE-2-ADDR        TO XIT00000-LNE-2-ADDR.              
032400     MOVE HO014-WH-CITY              TO XIT00000-CTY-NM.                  
032500     MOVE HO014-WH-ST-CDE            TO XIT00000-ST-CDE.                  
032600     MOVE HO014-WH-ZIP-10-CDE        TO XIT00000-ZIP-10-CDE.              
032700     MOVE HO014-WH-DST-IND           TO XIT00000-DST-IND.                 
032800     MOVE HO014-WH-E-BUS-IND         TO XIT00000-E-BUS-IND.               
032900     MOVE HO014-WH-IN-STR-PRCHG-IND  TO XIT00000-IN-STR-PRCHG-IND.        
033000     MOVE HO014-WH-PRCHG-IND         TO XIT00000-PRCHG-CRE-IND.           
033100                                                                          
033200     IF HO014-WH-OPEN-DATE = SPACES                                       
033300       MOVE PC-DEFAULT-DATE TO XIT00000-OPN-DTE                           
033400     ELSE                                                                 
033500       MOVE HO014-WH-OPEN-DATE TO XIT00000-OPN-DTE                        
033600     END-IF.                                                              
033700                                                                          
033800     IF HO014-WH-CLOSE-DATE = SPACES                                      
033900       MOVE PC-DEFAULT-DATE TO XIT00000-CLO-DTE                           
034000     ELSE                                                                 
034100       MOVE HO014-WH-CLOSE-DATE TO XIT00000-CLO-DTE                       
034200     END-IF.                                                              
034300                                                                          
034400     IF HO014-WH-OCPNC-DTE = SPACES                                       
034500       MOVE PC-DEFAULT-DATE TO XIT00000-OCPNC-DTE                         
034600     ELSE                                                                 
034700       MOVE HO014-WH-OCPNC-DTE TO XIT00000-OCPNC-DTE                      
034800     END-IF.                                                              
034900                                                                          
035000     PERFORM 3020-INSERT-WHSE.                                            
035100     PERFORM 1020-READ-WHSE-FILE.                                         
035200                                                                          
035300 2030-PROCESS-OUTLOC.                                                     
035400     INITIALIZE DCLXIT00000.                                              
035500     MOVE HO015-OUTLC-ID-2-5         TO XIT00000-LOC-NBR.                 
035600     MOVE HO015-OTLC-TYPE            TO XIT00000-LOC-TYP-CDE.             
035700     MOVE HO015-OTLC-DESC            TO XIT00000-LOC-NM.                  
035800     MOVE HO015-OTLC-LOC-5-ABBR-NM   TO XIT00000-LOC-5-ABBR-NM.           
035900     MOVE HO015-OTLC-LNE-1-ADDR      TO XIT00000-LNE-1-ADDR.              
036000     MOVE HO015-OTLC-LNE-2-ADDR      TO XIT00000-LNE-2-ADDR.              
036100     MOVE HO015-OTLC-CTY-NM          TO XIT00000-CTY-NM.                  
036200     MOVE HO015-OTLC-ST-CDE          TO XIT00000-ST-CDE.                  
036300     MOVE HO015-OTLC-ZIP-10-CDE      TO XIT00000-ZIP-10-CDE.              
036400     MOVE HO015-OTLC-PHN-NBR         TO XIT00000-PHN-NBR.                 
036500     IF HO015-OTLC-OPN-DTE = SPACES                                       
036600       MOVE PC-DEFAULT-DATE TO XIT00000-OPN-DTE                           
036700     ELSE                                                                 
036800       MOVE HO015-OTLC-OPN-DTE TO XIT00000-OPN-DTE                        
036900     END-IF.                                                              
037000     IF HO015-OTLC-CLO-DTE = SPACES                                       
037100       MOVE PC-DEFAULT-DATE TO XIT00000-CLO-DTE                           
037200     ELSE                                                                 
037300       MOVE HO015-OTLC-CLO-DTE TO XIT00000-CLO-DTE                        
037400     END-IF.                                                              
037500                                                                          
037600     PERFORM 3030-INSERT-OUTLOC.                                          
037700     PERFORM 1030-READ-OUTLOC-FILE.                                       
037800                                                                          
037900                                                                          
038000 3010-INSERT-STORE.                                                       
038100     PERFORM WITH TEST AFTER                                              
038200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
038300           UNTIL PV-RETRY-COUNTER > PC-RETRY-MAX                          
038400              OR SQLCODE = 0                                              
038500              OR PS-PROCESS-COMPLETE                                      
038600       EXEC SQL                                                           
038700         INSERT INTO XIT_LOC                                              
038800             ( LOC_NBR                                                    
038900             , REPLT_STR_NBR                                              
039000             , DIST_NBR                                                   
039100             , LOC_TYP_CDE                                                
039200             , LOC_NM                                                     
039300             , LOC_5_ABBR_NM                                              
039400             , LNE_1_ADDR                                                 
039500             , LNE_2_ADDR                                                 
039600             , CTY_NM                                                     
039700             , ST_CDE                                                     
039800             , ZIP_10_CDE                                                 
039900             , OPN_DTE                                                    
040000             , CLO_DTE                                                    
040100             , PHN_NBR                                                    
040200             , MGR_NM                                                     
040300             , FINCL_CLO_DTE                                              
040400             , MN_SLS_INCL_DTE                                            
040500             , YR_SLS_INCL_DTE                                            
040600             , OCPNC_DTE                                                  
040700             , POS_RGST_BNK_QTY                                           
040800             , DST_IND                                                    
040900             , E_BUS_IND                                                  
041000             , FMT_CDE                                                    
041100             , STD_TM_ZN_CDE                                              
041200             , SLS_INCL_DTE_CDE                                           
041300             , TOT_SLG_SQ_FTG_QTY                                         
041400             , TOT_SQ_FTG_QTY                                             
041500             , STP_ORD_DAYS_QTY                                           
041600             , STRT_ORD_DAYS_QTY                                          
041700             , ACQR_DTE                                                   
041800             , RMDL_DTE                                                   
041900             , MEDN_AGE_NBR                                               
042000             , EST_HH_INCM_AMT                                            
042100             , QTR_SLS_INCL_DTE                                           
042200             , SEA_SLS_INCL_DTE                                           
042300             , EXTD_MALL_NM                                               
042400             , GRND_OPN_DTE                                               
042500             , PRCHG_CRE_IND                                              
042600             , IN_STR_PRCHG_IND                                           
042700             , LAST_UPD_TMST)                                             
042800    VALUES                                                                
042900           ( : XIT00000-LOC-NBR                                           
043000           , : XIT00000-REPLT-STR-NBR                                     
043100           , : XIT00000-DIST-NBR                                          
043200           , : XIT00000-LOC-TYP-CDE                                       
043300           , : XIT00000-LOC-NM                                            
043400           , : XIT00000-LOC-5-ABBR-NM                                     
043500           , : XIT00000-LNE-1-ADDR                                        
043600           , : XIT00000-LNE-2-ADDR                                        
043700           , : XIT00000-CTY-NM                                            
043800           , : XIT00000-ST-CDE                                            
043900           , : XIT00000-ZIP-10-CDE                                        
044000           , : XIT00000-OPN-DTE                                           
044100           , : XIT00000-CLO-DTE                                           
044200           , : XIT00000-PHN-NBR                                           
044300           , : XIT00000-MGR-NM                                            
044400           , : XIT00000-FINCL-CLO-DTE                                     
044500           , : XIT00000-MN-SLS-INCL-DTE                                   
044600           , : XIT00000-YR-SLS-INCL-DTE                                   
044700           , : XIT00000-OCPNC-DTE                                         
044800           , : XIT00000-POS-RGST-BNK-QTY                                  
044900           , : XIT00000-DST-IND                                           
045000           , : XIT00000-E-BUS-IND                                         
045100           , : XIT00000-FMT-CDE                                           
045200           , : XIT00000-STD-TM-ZN-CDE                                     
045300           , : XIT00000-SLS-INCL-DTE-CDE                                  
045400           , : XIT00000-TOT-SLG-SQ-FTG-QTY                                
045500           , : XIT00000-TOT-SQ-FTG-QTY                                    
045600           , : XIT00000-STP-ORD-DAYS-QTY                                  
045700           , : XIT00000-STRT-ORD-DAYS-QTY                                 
045800           , : XIT00000-ACQR-DTE                                          
045900           , : XIT00000-RMDL-DTE                                          
046000           , : XIT00000-MEDN-AGE-NBR                                      
046100           , : XIT00000-EST-HH-INCM-AMT                                   
046200           , : XIT00000-QTR-SLS-INCL-DTE                                  
046300           , : XIT00000-SEA-SLS-INCL-DTE                                  
046400           , : XIT00000-EXTD-MALL-NM                                      
046500           , : XIT00000-GRND-OPN-DTE                                      
046600           , : XIT00000-PRCHG-CRE-IND                                     
046700           , : XIT00000-IN-STR-PRCHG-IND                                  
046800           , CURRENT TIMESTAMP)                                           
046900       END-EXEC                                                           
047000       EVALUATE TRUE                                                      
047100           WHEN SQLCODE = -911                                            
047200           WHEN SQLCODE = -913                                            
047300               CONTINUE                                                   
047400           WHEN SQLCODE = 0                                               
047500               ADD 1 TO PA-ROWS-INSERTED                                  
047600           WHEN SQLWARN0 NOT = SPACE                                      
047700           WHEN SQLCODE NOT =  ZERO                                       
047800               SET PS-PROCESS-COMPLETE TO TRUE                            
047900       END-EVALUATE                                                       
048000     END-PERFORM.                                                         
048100     IF SQLCODE NOT = ZERO                                                
048200         MOVE '3010-INSERT-STORE' TO PV-PARAGRAPH                         
048300         MOVE 'BAD SQLCODE FOR INSERT XIT_LOC'                            
048400                       TO  PV-MESSAGE                                     
048500         PERFORM 9900-PROCESS-DB2-ERROR                                   
048600     END-IF.                                                              
048700     SET PS-PROCESS-CONTINUE     TO TRUE.                                 
048800                                                                          
048900 3020-INSERT-WHSE.                                                        
049000     PERFORM WITH TEST AFTER                                              
049100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
049200           UNTIL PV-RETRY-COUNTER > PC-RETRY-MAX                          
049300              OR SQLCODE = 0                                              
049400              OR PS-PROCESS-COMPLETE                                      
049500       EXEC SQL                                                           
049600         INSERT INTO XIT_LOC                                              
049700             ( LOC_NBR                                                    
049800             , LOC_TYP_CDE                                                
049900             , LOC_NM                                                     
050000             , LOC_5_ABBR_NM                                              
050100             , LNE_1_ADDR                                                 
050200             , LNE_2_ADDR                                                 
050300             , CTY_NM                                                     
050400             , ST_CDE                                                     
050500             , ZIP_10_CDE                                                 
050600             , OPN_DTE                                                    
050700             , CLO_DTE                                                    
050800             , OCPNC_DTE                                                  
050900             , DST_IND                                                    
051000             , E_BUS_IND                                                  
051100             , PRCHG_CRE_IND                                              
051200             , IN_STR_PRCHG_IND                                           
051300             , LAST_UPD_TMST)                                             
051400    VALUES                                                                
051500           ( : XIT00000-LOC-NBR                                           
051600           , : XIT00000-LOC-TYP-CDE                                       
051700           , : XIT00000-LOC-NM                                            
051800           , : XIT00000-LOC-5-ABBR-NM                                     
051900           , : XIT00000-LNE-1-ADDR                                        
052000           , : XIT00000-LNE-2-ADDR                                        
052100           , : XIT00000-CTY-NM                                            
052200           , : XIT00000-ST-CDE                                            
052300           , : XIT00000-ZIP-10-CDE                                        
052400           , : XIT00000-OPN-DTE                                           
052500           , : XIT00000-CLO-DTE                                           
052600           , : XIT00000-OCPNC-DTE                                         
052700           , : XIT00000-DST-IND                                           
052800           , : XIT00000-E-BUS-IND                                         
052900           , : XIT00000-PRCHG-CRE-IND                                     
053000           , : XIT00000-IN-STR-PRCHG-IND                                  
053100           , CURRENT TIMESTAMP)                                           
053200       END-EXEC                                                           
053300       EVALUATE TRUE                                                      
053400           WHEN SQLCODE = -911                                            
053500           WHEN SQLCODE = -913                                            
053600               CONTINUE                                                   
053700           WHEN SQLCODE = 0                                               
053800               ADD 1 TO PA-ROWS-INSERTED                                  
053900           WHEN SQLWARN0 NOT = SPACE                                      
054000           WHEN SQLCODE NOT =  ZERO                                       
054100               SET PS-PROCESS-COMPLETE TO TRUE                            
054200       END-EVALUATE                                                       
054300     END-PERFORM.                                                         
054400                                                                          
054500     IF SQLCODE NOT = ZERO                                                
054600         MOVE '3020-INSERT-WHSE' TO PV-PARAGRAPH                          
054700         MOVE 'BAD SQLCODE FOR INSERT XIT_LOC'                            
054800                       TO  PV-MESSAGE                                     
054900         PERFORM 9900-PROCESS-DB2-ERROR                                   
055000     END-IF.                                                              
055100     SET PS-PROCESS-CONTINUE     TO TRUE.                                 
055200                                                                          
055300 3030-INSERT-OUTLOC.                                                      
055400     PERFORM WITH TEST AFTER                                              
055500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
055600           UNTIL PV-RETRY-COUNTER > PC-RETRY-MAX                          
055700              OR SQLCODE = 0                                              
055800              OR PS-PROCESS-COMPLETE                                      
055900                                                                          
056000       EXEC SQL                                                           
056100         INSERT INTO XIT_LOC                                              
056200             ( LOC_NBR                                                    
056300             , LOC_TYP_CDE                                                
056400             , LOC_NM                                                     
056500             , LOC_5_ABBR_NM                                              
056600             , LNE_1_ADDR                                                 
056700             , LNE_2_ADDR                                                 
056800             , CTY_NM                                                     
056900             , ST_CDE                                                     
057000             , ZIP_10_CDE                                                 
057100             , OPN_DTE                                                    
057200             , CLO_DTE                                                    
057300             , PHN_NBR                                                    
057400             , LAST_UPD_TMST)                                             
057500    VALUES                                                                
057600           ( : XIT00000-LOC-NBR                                           
057700           , : XIT00000-LOC-TYP-CDE                                       
057800           , : XIT00000-LOC-NM                                            
057900           , : XIT00000-LOC-5-ABBR-NM                                     
058000           , : XIT00000-LNE-1-ADDR                                        
058100           , : XIT00000-LNE-2-ADDR                                        
058200           , : XIT00000-CTY-NM                                            
058300           , : XIT00000-ST-CDE                                            
058400           , : XIT00000-ZIP-10-CDE                                        
058500           , : XIT00000-OPN-DTE                                           
058600           , : XIT00000-CLO-DTE                                           
058700           , : XIT00000-PHN-NBR                                           
058800           , CURRENT TIMESTAMP)                                           
058900       END-EXEC                                                           
059000       EVALUATE TRUE                                                      
059100           WHEN SQLCODE = -911                                            
059200           WHEN SQLCODE = -913                                            
059300               CONTINUE                                                   
059400           WHEN SQLCODE = 0                                               
059500               ADD 1 TO PA-ROWS-INSERTED                                  
059600           WHEN SQLWARN0 NOT = SPACE                                      
059700           WHEN SQLCODE NOT =  ZERO                                       
059800               SET PS-PROCESS-COMPLETE TO TRUE                            
059900       END-EVALUATE                                                       
060000     END-PERFORM.                                                         
060100     IF SQLCODE NOT = ZERO                                                
060200         MOVE '3030-INSERT-OUTLOC' TO PV-PARAGRAPH                        
060300         MOVE 'BAD SQLCODE FOR INSERT XIT_LOC'                            
060400                       TO  PV-MESSAGE                                     
060500         PERFORM 9900-PROCESS-DB2-ERROR                                   
060600     END-IF.                                                              
060700     SET PS-PROCESS-CONTINUE     TO TRUE.                                 
060800                                                                          
060900                                                                          
061000 4000-EMPTY-XIT-LOC.                                                      
061100     PERFORM WITH TEST AFTER                                              
061200         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
061300           UNTIL PV-RETRY-COUNTER > PC-RETRY-MAX                          
061400              OR SQLCODE = 0                                              
061500              OR PS-PROCESS-COMPLETE                                      
061600       EXEC SQL                                                           
061700         DELETE                                                           
061800           FROM XIT_LOC                                                   
061900       END-EXEC                                                           
062000                                                                          
062100        EVALUATE TRUE                                                     
062200            WHEN SQLCODE = 100                                            
062300            WHEN SQLCODE = 0                                              
062400                CONTINUE                                                  
062500            WHEN SQLWARN0 NOT = SPACE                                     
062600            WHEN SQLCODE  NOT = ZERO                                      
062700                SET PS-PROCESS-COMPLETE TO TRUE                           
062800        END-EVALUATE                                                      
062900     END-PERFORM.                                                         
063000     IF  SQLCODE NOT = 0                                                  
063100     AND SQLCODE NOT = 100                                                
063200         MOVE '4000-EMPTY-XIT-LOC' TO PV-PARAGRAPH                        
063300         MOVE 'BAD SQLCODE FOR DELETE XIT_LOC'                            
063400                       TO  PV-MESSAGE                                     
063500         PERFORM 9900-PROCESS-DB2-ERROR                                   
063600     END-IF.                                                              
063700     SET PS-PROCESS-CONTINUE     TO TRUE.                                 
063800                                                                          
063900                                                                          
064000                                                                          
064100*----------------------------------------------------------------*        
064200*  FORMAT A DB2 ERROR MESSAGE                                    *        
064300*----------------------------------------------------------------*        
064400                                                                          
064500 9900-PROCESS-DB2-ERROR.                                                  
064600                                                                          
064700     DISPLAY '***************************************************'        
064800     DISPLAY '**  ERROR     **'.                                          
064900     DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                          
065000     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH.                         
065100     DISPLAY '**  MESSAGE   **  = ' PV-MESSAGE.                           
065200*                                                                         
065300*  ROUTINE TO CONVERT THE SQLCA INTO A READABLE FORMAT, USING             
065400*  THE CALLED MODULE DSNTIAR.                                             
065500*                                                                         
065600     COPY DPPD004.                                                        
065700                                                                          
065800     MOVE +4013 TO ABEND-CODE.                                            
065900     CALL 'ILBOABN0' USING ABEND-CODE.                                    
