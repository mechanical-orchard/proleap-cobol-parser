000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             DLKRP002.                                00020001
000300 AUTHOR.                 AYAN SARKAR.                             00030001
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           JUNE, 2016.                              00050042
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000710****************************************************************  00071004
000800* THIS PROGRAM WILL PRODUCE THE 'DAILY LABOR EVENTS REPORTS'      00080004
000900****************************************************************  00090004
001000                                                                  00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200 CONFIGURATION SECTION.                                           00120000
001300 SOURCE-COMPUTER.        IBM-3090.                                00130011
001400 OBJECT-COMPUTER.        IBM-3090.                                00140011
001500 INPUT-OUTPUT SECTION.                                            00150000
001600 FILE-CONTROL.                                                    00160000
001700                                                                  00170000
002100     SELECT  LABOR-EVNTS-XTRCT1                                   00210011
002200         ASSIGN TO INP01.                                         00220011
002300                                                                  00230000
002310     SELECT  LABOR-EVNTS-XTRCT2                                   00231020
002320         ASSIGN TO INP02.                                         00232020
002330                                                                  00233004
002340     SELECT  REPORT-FILE1                                         00234004
002350         ASSIGN TO RPT01.                                         00235004
002360                                                                  00236004
002370     SELECT  REPORT-FILE2                                         00237020
002380         ASSIGN TO RPT02.                                         00238020
002390                                                                  00239004
002400 DATA DIVISION.                                                   00240000
002500 FILE SECTION.                                                    00250000
003200                                                                  00320000
003300 FD  LABOR-EVNTS-XTRCT1                                           00330011
003400     RECORDING MODE IS F                                          00340011
003500     LABEL RECORDS ARE STANDARD                                   00350011
003600     BLOCK CONTAINS 0 RECORDS.                                    00360011
003700 01  LABOR-EVNTS-XTRCT-RECORD1        PIC X(150).                 00370037
003710                                                                  00371004
003720 FD  LABOR-EVNTS-XTRCT2                                           00372020
003730     RECORDING MODE IS F                                          00373020
003740     LABEL RECORDS ARE STANDARD                                   00374020
003750     BLOCK CONTAINS 0 RECORDS.                                    00375020
003760 01  LABOR-EVNTS-XTRCT-RECORD2        PIC X(148).                 00376030
003770                                                                  00377004
003780 FD  REPORT-FILE1                                                 00378004
003790     RECORDING MODE IS F                                          00379004
003791     LABEL RECORDS ARE STANDARD                                   00379104
003792     BLOCK CONTAINS 0 RECORDS.                                    00379204
003793 01  REPORT-RECORD1                   PIC X(200).                 00379304
003794                                                                  00379404
003795 FD  REPORT-FILE2                                                 00379520
003796     RECORDING MODE IS F                                          00379620
003797     LABEL RECORDS ARE STANDARD                                   00379720
003798     BLOCK CONTAINS 0 RECORDS.                                    00379820
003799 01  REPORT-RECORD2                   PIC X(200).                 00379920
003800/                                                                 00380000
003900 WORKING-STORAGE SECTION.                                         00390000
004000 01  PS-SWITCHES.                                                 00400000
004210     05  PS-KOHLS-USR-ID-SW           PIC X(01) VALUE SPACE.      00421001
004220         88  PS-KOHLS-USR-ID                    VALUE 'K'.        00422000
004230         88  PS-TMP-USR-ID                      VALUE 'T'.        00423000
004240     05  PS-EOF-EVNTS-XTRCT1-SW       PIC X(01) VALUE 'N'.        00424011
004250         88  PS-EOF-EVNTS-XTRCT1-YES            VALUE 'Y'.        00425011
004260         88  PS-EOF-EVNTS-XTRCT1-NO             VALUE 'N'.        00426011
004270     05  PS-EOF-EVNTS-XTRCT2-SW       PIC X(01) VALUE 'N'.        00427011
004280         88  PS-EOF-EVNTS-XTRCT2-YES            VALUE 'Y'.        00428011
004290         88  PS-EOF-EVNTS-XTRCT2-NO             VALUE 'N'.        00429011
004300                                                                  00430000
004400 01  DK-DB-KEYS.                                                  00440000
004500     05  DK-STORE-NBR                 PIC S9(04) COMP VALUE ZERO. 00450000
004600     05  DK-LINE-NBR                  PIC S9(09) COMP VALUE ZERO. 00460000
004700                                                                  00470000
004800 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00480000
004900                                                 COMP SYNC.       00490000
005000     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00500000
005100                                                                  00510000
005101 01  PD-PROCESSING-DATE.                                          00510100
005110     05  PD-PROCESS-DATE              PIC X(10) VALUE SPACES.     00511000
005120     05  PD-PROCESS-DATE-8            PIC X(08) VALUE SPACES.     00512000
005130                                                                  00513000
005200 01  SD-SYSTEM-DATE.                                              00520000
005300     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00530000
005400     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00540000
005500     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00550000
005600                                                                  00560000
005700 01  ST-SYSTEM-TIME.                                              00570000
005800     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00580000
005900     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00590000
006000     05  FILLER                     PIC  9(04)   VALUE ZERO.      00600000
006100                                                                  00610000
006200 01  PV-VARIABLES.                                                00620000
006800     05  PV-PAGE-COUNT                PIC S9(07) COMP-3           00680005
006900                                                 VALUE ZERO.      00690005
007000     05  PV-LINES-USED                PIC S9(04) COMP-3           00700005
007100                                                 VALUE ZERO.      00710005
007800     05  PV-SAVE-DC-NBR               PIC 9(04) VALUE ZEROES.     00780011
007900     05  PV-SAVE-USER-ID              PIC X(08) VALUE SPACES.     00790011
008000     05  PV-SAVE-EVENT-TEXT           PIC X(40) VALUE SPACES.     00800022
008100     05  PV-SAVE-EVENT-ACTION-TEXT    PIC X(40) VALUE SPACES.     00810022
009100     05  PV-DTL-LNE-EVNT-CNT          PIC 9(06) VALUE ZEROES.     00910036
009200     05  PV-TOTAL-EVENT-COUNT         PIC 9(08) VALUE ZEROES.     00920036
012001                                                                  01200100
012002 01  PC-CONSTANTS.                                                01200200
012003     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'DLKRP002'. 01200301
012004     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE 75.  01200411
012006                                                                  01200600
012007***  STANDARD REPORT HEADER FOR 200 COLUMN REPORT                 01200700
012008     COPY DPWS200O.                                               01200800
012009                                                                  01200900
012700 01  HL-HEADING-LINE-1-RPT-1.                                     01270005
012800     05  FILLER                      PIC  X(58)  VALUE SPACES.    01280003
012900     05  FILLER                      PIC  X(44)  VALUE            01290003
013000      'DAILY COUNT OF LABOR EVENTS BY USER BY HOUR '.             01300003
013001     05  FILLER                      PIC  X(39)  VALUE            01300103
013002      '(HOUR OF THE DAY IS CENTRAL TIME ZONE) '.                  01300203
013003     05  FILLER                      PIC  X(59)  VALUE SPACES.    01300303
013011 01  HL-HEADING-LINE-2.                                           01301134
013012     05  FILLER                      PIC  X(02) VALUE  SPACES.    01301221
013013     05  FILLER                      PIC  X(03) VALUE             01301321
013014         'DC '.                                                   01301421
013015     05  HL2-DC-NBR                  PIC  9(04).                  01301521
013016     05  FILLER                      PIC  X(01) VALUE  SPACES.    01301621
013017     05  FILLER                      PIC  X(40) VALUE  SPACES.    01301721
013018     05  FILLER                      PIC  X(40) VALUE  SPACES.    01301821
013019     05  FILLER                      PIC  X(40) VALUE  SPACES.    01301921
013020     05  FILLER                      PIC  X(40) VALUE  SPACES.    01302021
013030     05  FILLER                      PIC  X(30) VALUE  SPACES.    01303021
013036 01  HL-HEADING-LINE-3-RPT-1.                                     01303634
013037     05  FILLER                      PIC  X(66) VALUE  SPACES.    01303731
013040     05  FILLER                      PIC  X(04) VALUE             01304005
013041         'HOUR'.                                                  01304105
013042     05  FILLER                      PIC  X(44) VALUE  SPACES.    01304220
013044     05  FILLER                      PIC  X(45) VALUE  SPACES.    01304420
013045     05  FILLER                      PIC  X(41) VALUE  SPACES.    01304531
013046 01  HL-HEADING-LINE-4-RPT-1.                                     01304634
013047     05  FILLER                      PIC  X(68) VALUE  SPACES.    01304731
013050     05  FILLER                      PIC  X(02) VALUE             01305005
013060         'OF'.                                                    01306005
013061     05  FILLER                      PIC  X(44) VALUE  SPACES.    01306120
013062     05  FILLER                      PIC  X(45) VALUE  SPACES.    01306220
013063     05  FILLER                      PIC  X(41) VALUE  SPACES.    01306331
013070 01  HL-HEADING-LINE-5-RPT-1.                                     01307034
013072     05  FILLER                      PIC  X(04) VALUE             01307205
013073         '  DC'.                                                  01307305
013074     05  FILLER                      PIC  X(01) VALUE  SPACES.    01307405
013075     05  FILLER                      PIC  X(08) VALUE  SPACES.    01307532
013077     05  FILLER                      PIC  X(01) VALUE  SPACES.    01307720
013080     05  FILLER                      PIC  X(40) VALUE  SPACES.    01308030
013086     05  FILLER                      PIC  X(01) VALUE  SPACES.    01308620
013087     05  FILLER                      PIC  X(10) VALUE  SPACES.    01308720
013088     05  FILLER                      PIC  X(01) VALUE  SPACES.    01308820
013089     05  FILLER                      PIC  X(04) VALUE             01308920
013090         ' THE'.                                                  01309020
013091     05  FILLER                      PIC  X(01) VALUE  SPACES.    01309120
013092     05  FILLER                      PIC  X(05) VALUE             01309220
013093         'EVENT'.                                                 01309320
013094     05  FILLER                      PIC  X(35) VALUE  SPACES.    01309420
013095     05  FILLER                      PIC  X(01) VALUE  SPACES.    01309520
013096     05  FILLER                      PIC  X(06) VALUE             01309634
013097         'ACTION'.                                                01309734
013098     05  FILLER                      PIC  X(34) VALUE  SPACES.    01309834
013099     05  FILLER                      PIC  X(01) VALUE  SPACES.    01309920
013101     05  FILLER                      PIC  X(07) VALUE             01310138
013110         ' EVENT '.                                               01311038
013111     05  FILLER                      PIC  X(01) VALUE  SPACES.    01311130
013114     05  FILLER                      PIC  X(39) VALUE  SPACES.    01311438
013115 01  HL-HEADING-LINE-6-RPT-1.                                     01311534
013116     05  FILLER                      PIC  X(04) VALUE             01311620
013117         ' NBR'.                                                  01311720
013118     05  FILLER                      PIC  X(01) VALUE  SPACES.    01311805
013119     05  FILLER                      PIC  X(08) VALUE             01311932
013120         'USER-ID '.                                              01312032
013121     05  FILLER                      PIC  X(01) VALUE  SPACES.    01312120
013122     05  FILLER                      PIC  X(04) VALUE             01312205
013123         'NAME'.                                                  01312305
013124     05  FILLER                      PIC  X(36) VALUE  SPACES.    01312420
013129     05  FILLER                      PIC  X(01) VALUE  SPACES.    01312920
013130     05  FILLER                      PIC  X(10) VALUE             01313020
013131         'DATE      '.                                            01313120
013132     05  FILLER                      PIC  X(01) VALUE  SPACES.    01313220
013133     05  FILLER                      PIC  X(04) VALUE             01313320
013134         ' DAY'.                                                  01313420
013135     05  FILLER                      PIC  X(01) VALUE  SPACES.    01313520
013136     05  FILLER                      PIC  X(04) VALUE             01313620
013137         'TEXT'.                                                  01313720
013138     05  FILLER                      PIC  X(36) VALUE  SPACES.    01313820
013139     05  FILLER                      PIC  X(01) VALUE  SPACES.    01313920
013140     05  FILLER                      PIC  X(04) VALUE             01314020
013141         'TEXT'.                                                  01314120
013142     05  FILLER                      PIC  X(36) VALUE  SPACES.    01314220
013143     05  FILLER                      PIC  X(01) VALUE  SPACES.    01314320
013144     05  FILLER                      PIC  X(07) VALUE             01314438
013150         ' COUNT '.                                               01315038
013160     05  FILLER                      PIC  X(01) VALUE  SPACES.    01316030
013190     05  FILLER                      PIC  X(39) VALUE  SPACES.    01319038
013209 01  HL-HEADING-LINE-7-RPT-1.                                     01320934
013211     05  FILLER                      PIC  X(04) VALUE             01321105
013212         '----'.                                                  01321205
013213     05  FILLER                      PIC  X(01) VALUE  SPACES.    01321305
013214     05  FILLER                      PIC  X(08) VALUE             01321405
013215         '--------'.                                              01321505
013216     05  FILLER                      PIC  X(01) VALUE  SPACES.    01321605
013217     05  FILLER                      PIC  X(20) VALUE             01321705
013218         '--------------------'.                                  01321805
013219     05  FILLER                      PIC  X(20) VALUE             01321905
013220         '--------------------'.                                  01322005
013226     05  FILLER                      PIC  X(01) VALUE  SPACES.    01322605
013227     05  FILLER                      PIC  X(10) VALUE             01322705
013228         '----------'.                                            01322805
013229     05  FILLER                      PIC  X(01) VALUE  SPACES.    01322905
013230     05  FILLER                      PIC  X(04) VALUE             01323005
013231         '----'.                                                  01323105
013232     05  FILLER                      PIC  X(01) VALUE  SPACES.    01323205
013233     05  FILLER                      PIC  X(20) VALUE             01323305
013234         '--------------------'.                                  01323405
013235     05  FILLER                      PIC  X(20) VALUE             01323505
013236         '--------------------'.                                  01323605
013239     05  FILLER                      PIC  X(01) VALUE  SPACES.    01323905
013240     05  FILLER                      PIC  X(20) VALUE             01324005
013241         '--------------------'.                                  01324105
013242     05  FILLER                      PIC  X(20) VALUE             01324205
013243         '--------------------'.                                  01324305
013246     05  FILLER                      PIC  X(01) VALUE  SPACES.    01324605
013247     05  FILLER                      PIC  X(06) VALUE             01324738
013249         '------'.                                                01324938
013250     05  FILLER                      PIC  X(41) VALUE  SPACES.    01325038
023720                                                                  02372000
023730* AFTER THIS                                                      02373034
023740                                                                  02374034
023750 01  HL-HEADING-LINE-1-RPT-2.                                     02375034
023760     05  FILLER                      PIC  X(82)  VALUE SPACES.    02376034
023770     05  FILLER                      PIC  X(35)  VALUE            02377034
023780      'DAILY COUNT OF LABOR EVENTS BY USER'.                      02378034
023790     05  FILLER                      PIC  X(83)  VALUE SPACES.    02379034
023793 01  HL-HEADING-LINE-3-RPT-2.                                     02379334
023794     05  FILLER                      PIC  X(04) VALUE             02379434
023795         '  DC'.                                                  02379534
023796     05  FILLER                      PIC  X(01) VALUE  SPACES.    02379634
023797     05  FILLER                      PIC  X(08) VALUE  SPACES.    02379734
023798     05  FILLER                      PIC  X(01) VALUE  SPACES.    02379834
023799     05  FILLER                      PIC  X(40) VALUE  SPACES.    02379934
023800     05  FILLER                      PIC  X(01) VALUE  SPACES.    02380034
023810     05  FILLER                      PIC  X(10) VALUE  SPACES.    02381034
023820     05  FILLER                      PIC  X(01) VALUE  SPACES.    02382034
023860     05  FILLER                      PIC  X(05) VALUE             02386034
023870         'EVENT'.                                                 02387034
023880     05  FILLER                      PIC  X(35) VALUE  SPACES.    02388034
023890     05  FILLER                      PIC  X(01) VALUE  SPACES.    02389034
023891     05  FILLER                      PIC  X(06) VALUE             02389134
023892         'ACTION'.                                                02389234
023893     05  FILLER                      PIC  X(34) VALUE  SPACES.    02389334
023894     05  FILLER                      PIC  X(01) VALUE  SPACES.    02389434
023895     05  FILLER                      PIC  X(07) VALUE             02389536
023896         ' EVENT '.                                               02389636
023897     05  FILLER                      PIC  X(01) VALUE  SPACES.    02389734
023898     05  FILLER                      PIC  X(44) VALUE  SPACES.    02389836
023899 01  HL-HEADING-LINE-4-RPT-2.                                     02389934
023900     05  FILLER                      PIC  X(04) VALUE             02390034
023910         ' NBR'.                                                  02391034
023920     05  FILLER                      PIC  X(01) VALUE  SPACES.    02392034
023930     05  FILLER                      PIC  X(08) VALUE             02393034
023940         'USER-ID '.                                              02394034
023950     05  FILLER                      PIC  X(01) VALUE  SPACES.    02395034
023960     05  FILLER                      PIC  X(04) VALUE             02396034
023970         'NAME'.                                                  02397034
023980     05  FILLER                      PIC  X(36) VALUE  SPACES.    02398034
023990     05  FILLER                      PIC  X(01) VALUE  SPACES.    02399034
023991     05  FILLER                      PIC  X(10) VALUE             02399134
023992         'DATE      '.                                            02399234
023993     05  FILLER                      PIC  X(01) VALUE  SPACES.    02399334
023997     05  FILLER                      PIC  X(04) VALUE             02399734
023998         'TEXT'.                                                  02399834
023999     05  FILLER                      PIC  X(36) VALUE  SPACES.    02399934
024000     05  FILLER                      PIC  X(01) VALUE  SPACES.    02400034
024010     05  FILLER                      PIC  X(04) VALUE             02401034
024020         'TEXT'.                                                  02402034
024030     05  FILLER                      PIC  X(36) VALUE  SPACES.    02403034
024040     05  FILLER                      PIC  X(01) VALUE  SPACES.    02404034
024050     05  FILLER                      PIC  X(07) VALUE             02405036
024060         ' COUNT '.                                               02406036
024070     05  FILLER                      PIC  X(01) VALUE  SPACES.    02407034
024080     05  FILLER                      PIC  X(44) VALUE  SPACES.    02408036
024090 01  HL-HEADING-LINE-5-RPT-2.                                     02409034
024091     05  FILLER                      PIC  X(04) VALUE             02409134
024092         '----'.                                                  02409234
024093     05  FILLER                      PIC  X(01) VALUE  SPACES.    02409334
024094     05  FILLER                      PIC  X(08) VALUE             02409434
024095         '--------'.                                              02409534
024096     05  FILLER                      PIC  X(01) VALUE  SPACES.    02409634
024097     05  FILLER                      PIC  X(20) VALUE             02409734
024098         '--------------------'.                                  02409834
024099     05  FILLER                      PIC  X(20) VALUE             02409934
024100         '--------------------'.                                  02410034
024110     05  FILLER                      PIC  X(01) VALUE  SPACES.    02411034
024120     05  FILLER                      PIC  X(10) VALUE             02412034
024130         '----------'.                                            02413034
024140     05  FILLER                      PIC  X(01) VALUE  SPACES.    02414034
024180     05  FILLER                      PIC  X(20) VALUE             02418034
024190         '--------------------'.                                  02419034
024191     05  FILLER                      PIC  X(20) VALUE             02419134
024192         '--------------------'.                                  02419234
024193     05  FILLER                      PIC  X(01) VALUE  SPACES.    02419334
024194     05  FILLER                      PIC  X(20) VALUE             02419434
024195         '--------------------'.                                  02419534
024196     05  FILLER                      PIC  X(20) VALUE             02419634
024197         '--------------------'.                                  02419734
024198     05  FILLER                      PIC  X(01) VALUE  SPACES.    02419834
024199     05  FILLER                      PIC  X(06) VALUE             02419938
024200         '------'.                                                02420036
024201     05  FILLER                      PIC  X(46) VALUE  SPACES.    02420136
024202                                                                  02420234
024205 01  DL-DETAIL-LINE-RPT-1.                                        02420534
024206     05  DL-DC-NBR-RPT-1             PIC  ZZ99.                   02420634
024207     05  FILLER                      PIC  X(01) VALUE  SPACES.    02420734
024208     05  DL-USER-ID-RPT-1            PIC  X(08).                  02420834
024209     05  FILLER                      PIC  X(01) VALUE  SPACES.    02420934
024210     05  DL-USER-NAME-RPT-1          PIC  X(40).                  02421034
025500     05  FILLER                      PIC  X(01) VALUE  SPACES.    02550000
025600     05  DL-DATE-RPT-1               PIC  X(10).                  02560034
025801     05  FILLER                      PIC  X(03) VALUE  SPACES.    02580129
025802     05  DL-HOUR-OF-THE-DAY-RPT-1    PIC  9(02) VALUE  ZEROES.    02580234
025803     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580300
025804     05  DL-EVENT-TEXT-RPT-1         PIC  X(40).                  02580434
025805     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580500
025806     05  DL-EVENT-ACTION-TEXT-RPT-1  PIC  X(40).                  02580634
025808     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580800
025809     05  DL-EVENT-COUNT-RPT-1        PIC  ZZZZZ9.                 02580940
025810     05  FILLER                      PIC  X(41) VALUE  SPACES.    02581040
025820                                                                  02582005
025830 01  DL-DETAIL-LINE-RPT-2.                                        02583034
025840     05  DL-DC-NBR-RPT-2             PIC  ZZ99.                   02584034
025850     05  FILLER                      PIC  X(01) VALUE  SPACES.    02585034
025860     05  DL-USER-ID-RPT-2            PIC  X(08).                  02586034
025870     05  FILLER                      PIC  X(01) VALUE  SPACES.    02587034
025880     05  DL-USER-NAME-RPT-2          PIC  X(40).                  02588034
025890     05  FILLER                      PIC  X(01) VALUE  SPACES.    02589034
025900     05  DL-DATE-RPT-2               PIC  X(10).                  02590034
026200     05  FILLER                      PIC  X(01) VALUE  SPACES.    02620034
026300     05  DL-EVENT-TEXT-RPT-2         PIC  X(40).                  02630034
026400     05  FILLER                      PIC  X(01) VALUE  SPACES.    02640034
026500     05  DL-EVENT-ACTION-TEXT-RPT-2  PIC  X(40).                  02650034
026600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02660034
026700     05  DL-EVENT-COUNT-RPT-2        PIC  ZZZZZ9.                 02670036
026800     05  FILLER                      PIC  X(46) VALUE  SPACES.    02680036
026900                                                                  02690034
028200 01  EP-EMPTY-REPORT-LINE.                                        02820000
028300     05  FILLER                       PIC X(54)  VALUE SPACES.    02830000
028400     05  FILLER                       PIC X(25)  VALUE            02840000
028500         '******* NO DATA *********'.                             02850000
028600     05  FILLER                       PIC X(54)  VALUE SPACES.    02860000
028700 01  DL-BLANK-LINE                    PIC X(200) VALUE SPACES.    02870000
028710 01  DL-TOTAL-LINE.                                               02871021
028720     05  FILLER                       PIC X(20)  VALUE SPACES.    02872012
028730     05  FILLER                       PIC X(10)  VALUE            02873012
028740         'USER-ID : '.                                            02874012
028741     05  DL-TOTAL-LNE-USR             PIC X(08)  VALUE SPACES.    02874121
028750     05  FILLER                       PIC X(02)  VALUE SPACES.    02875012
028751     05  FILLER                       PIC X(20)  VALUE            02875115
028752         'LABOR EVENT COUNT : '.                                  02875215
028760     05  DL-TOTAL-EVNT-CNT            PIC ZZZZZZZ9.               02876021
028770     05  FILLER                       PIC X(132) VALUE SPACES.    02877015
028800                                                                  02880000
028900 01  END-OF-REPORT-LINE.                                          02890000
029000     05  FILLER                  PIC  X(74)    VALUE SPACES.      02900000
029100     05  FILLER                  PIC  X(45)    VALUE              02910000
029200          '*******   E N D   O F   R E P O R T   *******'.        02920000
029300     05  FILLER                  PIC  X(81)    VALUE SPACES.      02930020
029400/                                                                 02940000
029410****************************************************************  02941004
029500* INPUT FILE LAYOUT                                               02950004
029501****************************************************************  02950100
036900     COPY DLRD020.                                                03690004
036910                                                                  03691004
037000****************************************************************  03700000
037100 PROCEDURE DIVISION.                                              03710000
037200****************************************************************  03720000
037300 0000-MAINLINE.                                                   03730000
037496                                                                  03749622
037500     PERFORM 1000-INITIALIZE                                      03750000
037600                                                                  03760000
037601     PERFORM 1100-READ-LABOR-EVNTS-XTRCT1.                        03760111
037602     MOVE DL020-DC-LOC-NBR            TO PV-SAVE-DC-NBR.          03760222
037603     MOVE DL020-USER-ID               TO PV-SAVE-USER-ID.         03760322
037610     PERFORM 8100-WRITE-MAIN-HEADINGS-RPT1                        03761011
037900     PERFORM 2000-PROCESS-EVNTS-XTRCT1                            03790011
037901       UNTIL PS-EOF-EVNTS-XTRCT1-YES.                             03790113
037902     PERFORM 8300-WRITE-TOTAL-LINE                                03790227
037903                                                                  03790311
037904     INITIALIZE DL020-LBR-EVNT-RECORD                             03790420
037905                PV-SAVE-DC-NBR                                    03790522
037906                PV-SAVE-USER-ID                                   03790622
037907                PV-SAVE-EVENT-TEXT                                03790722
037908                PV-SAVE-EVENT-ACTION-TEXT                         03790822
037909                PV-TOTAL-EVENT-COUNT                              03790923
037910                PV-PAGE-COUNT.                                    03791023
037911                                                                  03791123
037912     PERFORM 1200-READ-LABOR-EVNTS-XTRCT2.                        03791223
037913     MOVE LABOR-EVNTS-XTRCT-RECORD2(1:4)   TO PV-SAVE-DC-NBR      03791337
037914     MOVE LABOR-EVNTS-XTRCT-RECORD2(5:8)   TO PV-SAVE-USER-ID     03791437
037917     PERFORM 8500-WRITE-MAIN-HEADINGS-RPT2                        03791723
037918     PERFORM 3000-PROCESS-EVNTS-XTRCT2                            03791823
037919       UNTIL PS-EOF-EVNTS-XTRCT2-YES.                             03791923
037920     PERFORM 8700-WRITE-TOTAL-LINE                                03792028
037921                                                                  03792123
037930     PERFORM 9000-EOJ.                                            03793013
038000                                                                  03800013
038200     STOP RUN.                                                    03820000
038310*                                                                 03831005
038320****************************************************************  03832005
038400 1000-INITIALIZE.                                                 03840000
038410****************************************************************  03841005
038420*                                                                 03842005
038600     DISPLAY PC-CURRENT-PROGRAM-NAME ' STARTED'                   03860012
038800                                                                  03880000
038801     SET PS-EOF-EVNTS-XTRCT1-NO                                   03880113
038802         PS-EOF-EVNTS-XTRCT2-NO  TO TRUE                          03880213
038810                                                                  03881011
038900     OPEN INPUT  LABOR-EVNTS-XTRCT1                               03890020
038910                 LABOR-EVNTS-XTRCT2.                              03891020
038911                                                                  03891111
038920     OPEN OUTPUT REPORT-FILE1                                     03892020
038930                 REPORT-FILE2.                                    03893020
038940                                                                  03894004
039100     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03910000
039200     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03920000
039300                                                                  03930000
039400     MOVE SD-SYSTEM-DATE-YY      TO DP200O-RUN-YEAR.              03940000
039500     MOVE SD-SYSTEM-DATE-MM      TO DP200O-RUN-MONTH.             03950000
039600     MOVE SD-SYSTEM-DATE-DD      TO DP200O-RUN-DAY.               03960000
039700     MOVE ST-SYSTEM-HOUR         TO DP200O-RUN-HOUR.              03970000
039800     MOVE ST-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.            03980000
039900                                                                  03990000
040000     MOVE PC-CURRENT-PROGRAM-NAME                                 04000000
040100                                 TO DP200O-PROGRAM-NAME.          04010000
040200     MOVE 1                      TO DP200O-PAGE-NUMBER.           04020041
040400                                                                  04040011
040900*                                                                 04090005
041700******************************************************************04170000
041800 1100-READ-LABOR-EVNTS-XTRCT1.                                    04180011
041900******************************************************************04190000
041910*                                                                 04191011
042000     READ LABOR-EVNTS-XTRCT1 INTO DL020-LBR-EVNT-RECORD           04200011
061201       AT END                                                     06120111
061202          SET PS-EOF-EVNTS-XTRCT1-YES   TO TRUE.                  06120213
061203*                                                                 06120311
061204******************************************************************06120411
061205 1200-READ-LABOR-EVNTS-XTRCT2.                                    06120520
061206******************************************************************06120611
061207                                                                  06120720
061208     READ LABOR-EVNTS-XTRCT2                                      06120837
061209       AT END                                                     06120920
061210          SET PS-EOF-EVNTS-XTRCT2-YES   TO TRUE.                  06121020
061211*                                                                 06121111
061220******************************************************************06122011
061230 2000-PROCESS-EVNTS-XTRCT1.                                       06123011
061240******************************************************************06124011
061241*                                                                 06124112
061250     INITIALIZE DL-DETAIL-LINE-RPT-1.                             06125034
061251                                                                  06125111
061252     IF DL020-DC-LOC-NBR = PV-SAVE-DC-NBR                         06125211
061253        IF PV-LINES-USED >= PC-END-OF-PAGE                        06125313
061255           PERFORM 8100-WRITE-MAIN-HEADINGS-RPT1                  06125513
061257        END-IF                                                    06125713
061259        IF DL020-USER-ID = PV-SAVE-USER-ID                        06125920
061260           PERFORM 5000-PREPARE-REPORT-DATA-RPT-1                 06126034
061261           PERFORM 8200-WRITE-DETAIL-LINE                         06126121
061262        ELSE                                                      06126220
061263           PERFORM 8300-WRITE-TOTAL-LINE                          06126321
061264           PERFORM 8400-WRITE-EMPTY-LINE                          06126421
061265           MOVE ZEROES                TO PV-TOTAL-EVENT-COUNT     06126520
061266           MOVE DL020-USER-ID         TO PV-SAVE-USER-ID          06126620
061267           PERFORM 5000-PREPARE-REPORT-DATA-RPT-1                 06126734
061268           PERFORM 8200-WRITE-DETAIL-LINE                         06126821
061269        END-IF                                                    06126920
061270     ELSE                                                         06127019
061271        IF PV-LINES-USED < PC-END-OF-PAGE AND                     06127120
061272           DL020-USER-ID NOT = PV-SAVE-USER-ID                    06127220
061273           PERFORM 8300-WRITE-TOTAL-LINE                          06127321
061274           MOVE ZEROES                TO PV-TOTAL-EVENT-COUNT     06127420
061275           MOVE DL020-USER-ID         TO PV-SAVE-USER-ID          06127520
061276           MOVE DL020-DC-LOC-NBR      TO PV-SAVE-DC-NBR           06127620
061277           PERFORM 8100-WRITE-MAIN-HEADINGS-RPT1                  06127720
061278        ELSE                                                      06127820
061280           MOVE DL020-DC-LOC-NBR      TO PV-SAVE-DC-NBR           06128020
061281           PERFORM 8100-WRITE-MAIN-HEADINGS-RPT1                  06128120
061282        END-IF                                                    06128220
061283        PERFORM 5000-PREPARE-REPORT-DATA-RPT-1                    06128334
061284        PERFORM 8200-WRITE-DETAIL-LINE                            06128421
061285     END-IF                                                       06128519
061290     PERFORM 1100-READ-LABOR-EVNTS-XTRCT1.                        06129022
061291*                                                                 06129120
061292******************************************************************06129220
061293 3000-PROCESS-EVNTS-XTRCT2.                                       06129320
061294******************************************************************06129420
061295*                                                                 06129520
061296     INITIALIZE DL-DETAIL-LINE-RPT-2.                             06129634
061297                                                                  06129720
061298     IF LABOR-EVNTS-XTRCT-RECORD2(1:4) = PV-SAVE-DC-NBR           06129837
061299        IF PV-LINES-USED >= PC-END-OF-PAGE                        06129920
061300           PERFORM 8500-WRITE-MAIN-HEADINGS-RPT2                  06130021
061310        END-IF                                                    06131020
061320        IF LABOR-EVNTS-XTRCT-RECORD2(5:8)  = PV-SAVE-USER-ID      06132037
061332           PERFORM 5100-PREPARE-REPORT-DATA-RPT-2                 06133237
061333           PERFORM 8600-WRITE-DETAIL-LINE                         06133337
061350        ELSE                                                      06135020
061360           PERFORM 8700-WRITE-TOTAL-LINE                          06136022
061370           PERFORM 8800-WRITE-EMPTY-LINE                          06137022
061380           MOVE ZEROES                TO PV-TOTAL-EVENT-COUNT     06138020
061381           MOVE LABOR-EVNTS-XTRCT-RECORD2(1:4)  TO PV-SAVE-DC-NBR 06138137
061382           MOVE LABOR-EVNTS-XTRCT-RECORD2(5:8)  TO PV-SAVE-USER-ID06138237
061395           PERFORM 5100-PREPARE-REPORT-DATA-RPT-2                 06139534
061396           PERFORM 8600-WRITE-DETAIL-LINE                         06139622
061397        END-IF                                                    06139720
061398     ELSE                                                         06139820
061399        IF PV-LINES-USED < PC-END-OF-PAGE AND                     06139920
061400           LABOR-EVNTS-XTRCT-RECORD2(5:8) NOT = PV-SAVE-USER-ID   06140037
061407           PERFORM 8700-WRITE-TOTAL-LINE                          06140722
061408           MOVE LABOR-EVNTS-XTRCT-RECORD2(1:4)  TO PV-SAVE-DC-NBR 06140837
061409           MOVE LABOR-EVNTS-XTRCT-RECORD2(5:8)  TO PV-SAVE-USER-ID06140937
061410           MOVE ZEROES                TO PV-TOTAL-EVENT-COUNT     06141020
061414           PERFORM 8500-WRITE-MAIN-HEADINGS-RPT2                  06141421
061420        ELSE                                                      06142020
061431           MOVE LABOR-EVNTS-XTRCT-RECORD2(1:4)  TO PV-SAVE-DC-NBR 06143137
061440           PERFORM 8500-WRITE-MAIN-HEADINGS-RPT2                  06144021
061450        END-IF                                                    06145020
061460        PERFORM 5100-PREPARE-REPORT-DATA-RPT-2                    06146034
061470        PERFORM 8600-WRITE-DETAIL-LINE                            06147022
061480     END-IF                                                       06148020
061490     PERFORM 1200-READ-LABOR-EVNTS-XTRCT2.                        06149022
061500*                                                                 06150020
071824******************************************************************07182420
071825 5000-PREPARE-REPORT-DATA-RPT-1.                                  07182534
071826******************************************************************07182620
071827*                                                                 07182720
071828     MOVE DL020-DC-LOC-NBR           TO DL-DC-NBR-RPT-1           07182834
071829     MOVE DL020-USER-ID              TO DL-USER-ID-RPT-1          07182934
071830     MOVE DL020-USER-NAME            TO DL-USER-NAME-RPT-1        07183034
071832     MOVE DL020-EVENT-DATE           TO DL-DATE-RPT-1             07183234
071833     MOVE DL020-EVENT-DATE-HOUR      TO DL-HOUR-OF-THE-DAY-RPT-1  07183334
071834     MOVE DL020-EVENT-TEXT           TO DL-EVENT-TEXT-RPT-1       07183434
071835     MOVE DL020-EVENT-ACTION-TEXT    TO DL-EVENT-ACTION-TEXT-RPT-107183534
071836     MOVE DL020-EVENT-COUNT          TO DL-EVENT-COUNT-RPT-1      07183634
071837                                                                  07183720
071838     COMPUTE PV-TOTAL-EVENT-COUNT =   PV-TOTAL-EVENT-COUNT        07183820
071839                                    + DL020-EVENT-COUNT.          07183920
071840*                                                                 07184034
071841******************************************************************07184134
071842 5100-PREPARE-REPORT-DATA-RPT-2.                                  07184234
071843******************************************************************07184334
071844*                                                                 07184434
071845     MOVE LABOR-EVNTS-XTRCT-RECORD2(1:4)    TO DL-DC-NBR-RPT-2    07184537
071846     MOVE LABOR-EVNTS-XTRCT-RECORD2(5:8)    TO DL-USER-ID-RPT-2   07184637
071847     MOVE LABOR-EVNTS-XTRCT-RECORD2(13:40)  TO DL-USER-NAME-RPT-2 07184737
071848     MOVE LABOR-EVNTS-XTRCT-RECORD2(53:10)  TO DL-DATE-RPT-2      07184837
071850     MOVE LABOR-EVNTS-XTRCT-RECORD2(63:40)  TO DL-EVENT-TEXT-RPT-207185037
071851     MOVE LABOR-EVNTS-XTRCT-RECORD2(103:40) TO                    07185137
071852                                        DL-EVENT-ACTION-TEXT-RPT-207185237
071853     MOVE LABOR-EVNTS-XTRCT-RECORD2(143:6) TO DL-EVENT-COUNT-RPT-207185337
071854                                              PV-DTL-LNE-EVNT-CNT 07185438
071855                                                                  07185537
071856     COMPUTE PV-TOTAL-EVENT-COUNT =   PV-TOTAL-EVENT-COUNT        07185637
071857                                    + PV-DTL-LNE-EVNT-CNT.        07185737
071858*                                                                 07185837
071859******************************************************************07185937
071860 8100-WRITE-MAIN-HEADINGS-RPT1.                                   07186037
071861******************************************************************07186137
071870*                                                                 07187012
072000     ADD 1                            TO PV-PAGE-COUNT.           07200000
072100     MOVE 1                           TO DP200O-REPORT-NUMBER.    07210041
072110     MOVE PV-PAGE-COUNT               TO DP200O-PAGE-NUMBER.      07211041
072200     MOVE ZERO                        TO PV-LINES-USED.           07220011
072210     MOVE DL020-DC-LOC-NBR            TO HL2-DC-NBR.              07221020
072300                                                                  07230000
072400     WRITE REPORT-RECORD1 FROM DP200O-STANDRD-HEADER-200-COLS     07240006
072500                 AFTER ADVANCING PAGE                             07250000
072600                                                                  07260000
072700     WRITE REPORT-RECORD1 FROM HL-HEADING-LINE-1-RPT-1            07270006
072800        AFTER ADVANCING 2 LINES.                                  07280000
073500     WRITE REPORT-RECORD1 FROM HL-HEADING-LINE-2                  07350034
073600        AFTER ADVANCING 1 LINES.                                  07360000
073601     WRITE REPORT-RECORD1 FROM HL-HEADING-LINE-3-RPT-1            07360134
073602        AFTER ADVANCING 1 LINES.                                  07360200
073603     WRITE REPORT-RECORD1 FROM HL-HEADING-LINE-4-RPT-1            07360334
073604        AFTER ADVANCING 1 LINES.                                  07360400
073605     WRITE REPORT-RECORD1 FROM HL-HEADING-LINE-5-RPT-1            07360534
073606        AFTER ADVANCING 1 LINES.                                  07360600
073610     WRITE REPORT-RECORD1 FROM HL-HEADING-LINE-6-RPT-1            07361034
073620        AFTER ADVANCING 1 LINES.                                  07362000
073630     WRITE REPORT-RECORD1 FROM HL-HEADING-LINE-7-RPT-1            07363034
073640        AFTER ADVANCING 1 LINES.                                  07364016
073700     ADD 7                            TO PV-LINES-USED.           07370016
073710*                                                                 07371011
073720******************************************************************07372011
073730 8200-WRITE-DETAIL-LINE.                                          07373021
073740******************************************************************07374011
073750*                                                                 07375011
073751     WRITE REPORT-RECORD1 FROM DL-DETAIL-LINE-RPT-1               07375134
073752        AFTER ADVANCING 1 LINES.                                  07375212
073753     ADD 1                            TO PV-LINES-USED.           07375312
073754*                                                                 07375412
073755******************************************************************07375512
073756 8300-WRITE-TOTAL-LINE.                                           07375621
073757******************************************************************07375712
073758*                                                                 07375812
073759     MOVE PV-SAVE-USER-ID             TO DL-TOTAL-LNE-USR         07375921
073760     MOVE PV-TOTAL-EVENT-COUNT        TO DL-TOTAL-EVNT-CNT        07376021
073761                                                                  07376112
073762     WRITE REPORT-RECORD1 FROM DL-TOTAL-LINE                      07376221
073763        AFTER ADVANCING 1 LINES.                                  07376312
073764     ADD 1                            TO PV-LINES-USED.           07376412
073765*                                                                 07376512
073767******************************************************************07376712
073768 8400-WRITE-EMPTY-LINE.                                           07376821
073769******************************************************************07376912
073770*                                                                 07377012
073774     WRITE REPORT-RECORD1 FROM DL-BLANK-LINE                      07377412
073775        AFTER ADVANCING 1 LINES.                                  07377512
073776     ADD 1                            TO PV-LINES-USED.           07377612
073777*                                                                 07377712
073778******************************************************************07377812
073779 8500-WRITE-MAIN-HEADINGS-RPT2.                                   07377921
073780******************************************************************07378012
073781*                                                                 07378112
073782     ADD 1                            TO PV-PAGE-COUNT.           07378220
073783     MOVE 2                           TO DP200O-REPORT-NUMBER.    07378341
073784     MOVE PV-PAGE-COUNT               TO DP200O-PAGE-NUMBER.      07378441
073785     MOVE ZERO                        TO PV-LINES-USED.           07378541
073786     MOVE LABOR-EVNTS-XTRCT-RECORD2(1:4)                          07378641
073787                                      TO HL2-DC-NBR.              07378741
073788                                                                  07378841
073789     WRITE REPORT-RECORD2 FROM DP200O-STANDRD-HEADER-200-COLS     07378941
073790                 AFTER ADVANCING PAGE                             07379041
073791                                                                  07379141
073792     WRITE REPORT-RECORD2 FROM HL-HEADING-LINE-1-RPT-2            07379241
073793        AFTER ADVANCING 2 LINES.                                  07379341
073794     WRITE REPORT-RECORD2 FROM HL-HEADING-LINE-2                  07379441
073795        AFTER ADVANCING 1 LINES.                                  07379541
073796     WRITE REPORT-RECORD2 FROM DL-BLANK-LINE                      07379641
073797        AFTER ADVANCING 1 LINES.                                  07379741
073798     WRITE REPORT-RECORD2 FROM HL-HEADING-LINE-3-RPT-2            07379841
073799        AFTER ADVANCING 1 LINES.                                  07379941
073800     WRITE REPORT-RECORD2 FROM HL-HEADING-LINE-4-RPT-2            07380041
073801        AFTER ADVANCING 1 LINES.                                  07380141
073802     WRITE REPORT-RECORD2 FROM HL-HEADING-LINE-5-RPT-2            07380241
073803        AFTER ADVANCING 1 LINES.                                  07380341
073804     ADD 6                            TO PV-LINES-USED.           07380439
073805*                                                                 07380521
073807******************************************************************07380722
073808 8600-WRITE-DETAIL-LINE.                                          07380822
073809******************************************************************07380922
073810*                                                                 07381022
073820     WRITE REPORT-RECORD2 FROM DL-DETAIL-LINE-RPT-2               07382034
073830        AFTER ADVANCING 1 LINES.                                  07383022
073840     ADD 1                            TO PV-LINES-USED.           07384022
073841*                                                                 07384122
073842******************************************************************07384222
073843 8700-WRITE-TOTAL-LINE.                                           07384322
073844******************************************************************07384422
073845*                                                                 07384522
073846     MOVE PV-SAVE-USER-ID             TO DL-TOTAL-LNE-USR         07384622
073847     MOVE PV-TOTAL-EVENT-COUNT        TO DL-TOTAL-EVNT-CNT        07384722
073848                                                                  07384822
073849     WRITE REPORT-RECORD2 FROM DL-TOTAL-LINE                      07384922
073850        AFTER ADVANCING 1 LINES.                                  07385022
073851     ADD 1                            TO PV-LINES-USED.           07385122
073852*                                                                 07385222
073853******************************************************************07385322
073854 8800-WRITE-EMPTY-LINE.                                           07385422
073855******************************************************************07385522
073856*                                                                 07385622
073857     WRITE REPORT-RECORD2 FROM DL-BLANK-LINE                      07385722
073858        AFTER ADVANCING 1 LINES.                                  07385822
073859     ADD 1                            TO PV-LINES-USED.           07385922
073860*                                                                 07386022
073870*                                                                 07387022
074720******************************************************************07472011
074800 9000-EOJ.                                                        07480000
074810******************************************************************07481011
074900                                                                  07490000
075000     WRITE REPORT-RECORD1                                         07500005
075100       FROM END-OF-REPORT-LINE                                    07510000
075200         AFTER ADVANCING 2 LINES.                                 07520000
075300                                                                  07530000
075310     WRITE REPORT-RECORD2                                         07531021
075320       FROM END-OF-REPORT-LINE                                    07532021
075330         AFTER ADVANCING 2 LINES.                                 07533021
075340                                                                  07534011
075400     CLOSE REPORT-FILE1                                           07540021
075500           REPORT-FILE2.                                          07550021
075810*                                                                 07581021
075820******************************************************************07582021
075900 9100-ABEND.                                                      07590000
075910******************************************************************07591021
075920*                                                                 07592021
076200     CLOSE REPORT-FILE1                                           07620021
076210           REPORT-FILE1.                                          07621021
076300                                                                  07630000
076400     MOVE +4013                       TO ABEND-CODE.              07640000
076500     CALL 'ILBOABN0' USING ABEND-CODE.                            07650000
076600*                                                                 07660005
