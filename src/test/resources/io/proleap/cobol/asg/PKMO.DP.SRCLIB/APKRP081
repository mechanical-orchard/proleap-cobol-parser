000100*-----------------------*                                         00010027
000200 IDENTIFICATION DIVISION.                                         00020027
000300*-----------------------*                                         00030066
000400                                                                  00040065
000500 PROGRAM-ID.     APKRP081.                                        00050027
000600                                                                  00060065
000700 AUTHOR.         CHRIS KUNSTMANN IBS.                             00070027
000800                                                                  00080065
000900 DATE-WRITTEN.   07/27/1998.                                      00090027
001000 DATE-COMPILED.                                                   00100027
001100                                                                  00110065
001200*---------------------------------------------------------------* 00120027
001300*    COBOL II / DB2                                             * 00130037
001400*                                                               * 00140027
001500*          IMPORT PO COST VARIANCE REPORT PROGRAM.              * 00150027
001600*                                                               * 00160027
001700* THE PURPOSE OF THIS PROGRAM IS TO PRODUCE A REPORT OF IMPORT  * 00170027
001800* PO'S WITH COST VARIANCE INFORMATION. THE REPORT TYPE CODE ON  * 00180027
001900* INPUT FILE WILL DETERMINE WHICH REPORT TITLE TO USE. THIS     * 00190027
002000* VARIES DEPENDING ON WHEN THE PROGRAM IS RUNNING.              * 00200027
002100*                                                               * 00210036
002200*  IF THE REPORT LINE SEQUENCE ASSIGNED IN APKUT080 IS CHANGED, * 00220036
002300* LOGIC IN B200-PROCESS-IMPORT-FILE WILL BE IMPACTED.           * 00230036
002400*---------------------------------------------------------------* 00240027
002500*                                                               * 00250027
002600* DB2 TABLES:                                                   * 00260027
002700*  1. IMPORT FREE ON BOARD TABLE           (TIMFOB)             * 00270027
002800*  2. MERCHANDISE AREA TABLE               (TMDSEAR)            * 00280027
002900*                                                               * 00290027
003000* INPUT:                                                        * 00300027
003100*                                                               * 00310027
003200*  1. IMPORT PO COST VARIANCE REPORT DATA  (APRD036)            * 00320027
003300*                                                               * 00330027
003400* OUTPUT:                                                       * 00340027
003500*                                                               * 00350027
003600*  1. IMPORT PO COST VARIANCE REPORT                            * 00360027
003700*                                                               * 00370027
003800*---------------------------------------------------------------* 00380027
003900*   CHANGES:                                                    * 00390027
004000*   7/27/98   CHRIS KUNSTMANN, IBS.      WR4164                 * 00400027
004100*       INITIAL VERSION.                                        * 00410027
004200*                                                               * 00420058
004300* 12/08/1999 JILL JUEL                       WR/IR #: WR6041    * 00430058
004400*            - MODIFIED THE CHECK ON THE DATE ROUTINE TO        * 00440058
004500*              CONFORM WITH Y2K STANDARDS BY ADDING             * 00450058
004600*              DPG54-WARNING-ERROR.                             * 00460058
004700*                                                               * 00470058
004800* 12/08/1999 MIKE BESKE                      WR/IR #: WR20529   * 00480059
004900*            - CHANGED THE CODE AP036-RPT-LINE-SEQ TO CHECK FOR * 00490059
005000*              VALUES = TO M1 AND N1 INSTEAD OF L1 AND M1 RE-   * 00500059
005100*              SPECTIVELY.  THIS WAS DUE TO THE ADDITION OF A   * 00510059
005200*              NEW CHARGE CODE: ROY (ROYALTY).  THESE VALUES FOR* 00520059
005300*              AP036-RPT-LINE-SEQ ARE ASSIGNED IN APKUT080.     * 00530059
005400*                                                               * 00540059
005500* 02/01/2000 MIKE BESKE                      WR/IR #: WR20556   * 00550060
005600*            - CHANGED THE CODE TO USE PC-PO-PER-PAGE-MAX AS A  * 00560060
005700*              WAY TO CONTROL HOW MANY PO NUMBERS PRINT ON A    * 00570060
005800*              PAGE.  ONE PO WILL PRINT PER PAGE FOR THE IMPORT * 00580060
005900*              POS POSTED TO THE JOURNAL.  THE IMPORT POS WITH  * 00590060
006000*              VERFIED RECEIPTS WILL PRINT 2 POS PER PAGE.      * 00600060
006100*                                                               * 00610060
006200* 05/08/2000 W A EHMKE                       WR/IR #: WR20557   * 00620064
006300*            - CHANGED THE CODE TO MOVE AP036-EST-UNT-COST &    * 00630064
006400*              AP036-INV-UNT-COST THE D2 FIELDS.  ADD THESE     * 00640064
006500*              VALUES TO PV-VARIABLES FOR PROCESSING AT TOTAL   * 00650064
006600*              TIME.                                            * 00660064
006700*              PROCESS NEW TOTALS TO THE T1 LINE.               * 00670064
006800*                                                               * 00680064
006900* 05/10/2000 W A EHMKE                       WR/IR #: WR20876   * 00690068
007000*            - CHANGED THE CODE TO GENERATE A PAGE BREAK ON     * 00700068
007100*              VENDOR CHANGE WHEN PRINTING THE RECEIVING PO     * 00710068
007200*              REPORT.  CURRENTLY THEY ARE PRINTING ON A        * 00720068
007300*              STANDARD 2 PER PAGE BASIS.  THEY WILL CONTINUE   * 00730068
007400*              TO PRINT 2 PER PAGE UNTIL A VENDOR BREAK OCCURS. * 00740068
007500*                                                               * 00750068
007600* 05/23/2000 W A EHMKE                       WR/IR #: WR20876   * 00760073
007700*            - CHANGED THE CODE TO UPGRADE A PAGE BREAK ON     *  00770073
007800*              VENDOR CHANGE WHEN PRINTING THE RECEIVING PO     * 00780073
007900*              REPORT.  CURRENTLY THEY ARE PRINTING ON A        * 00790073
008000*              STANDARD 2 PER PAGE BASIS.  THEY WILL CONTINUE   * 00800073
008100*              TO PRINT 2 PER PAGE UNTIL A VENDOR BREAK OCCURS. * 00810073
008200*              THIS REPORT IS BEING PRINTED IN DUPLEX. THE CODE * 00820073
008300*              IS BEING UPGRADED SO THAT IF A VENDOR ENDS ON AN * 00830073
008400*              ODD PAGE # 1, 3, 5 ETC. THE EVEN SIDE OF THE     * 00840073
008500*              DUPLEX PAGE IS GIVEN A HEADING LINE AND A PAGE # * 00850073
008600*              & OTHERWISE LEFT BLANK. A PAGE BREAK THEN OCCURS * 00860073
008700*              INSURRING THAT THE MEW VENDOR NUMBER STARTS ON A * 00870073
008800*              SEPARATE ODD PAGE #.                             * 00880073
008900*                                                               * 00890073
009000* 08/08/2002 COLBY HANGER EXPENSE PROCESSING.  RECOMPILE FROM   * 00900077
009100*            PRODUCTION TO INCORPORATE COPYBOOK CHANGES.        * 00910074
009200*        BY: KEVIN CATLIN                   WR#: 23254          * 00920076
009300*                                                               * 00930078
009400* 11/04/2002 COLBY DATING PROCESS.  ADDED NEW HEADING FOR NEW   * 00940080
009500*            REPORT TYPE OF AUTO JOURNALIZE.  LOGIC MODIFIED IN * 00950078
009600*            PARAGRAPH B100 TO LOAD THIS NEW HEADING.           * 00960078
009700*        BY: KEVIN CATLIN                   WR#: 23750          * 00970078
009800*                                                               * 00980081
009900* 12/09/2002 ADDED NEW HEADING FOR NEW REPORT TYPE OF COLBY     * 00990092
010000*            POS WITH VERIFIED RECEIPTS GROUPED BY OTB PERIOD.  * 01000081
010100*            MODIFIED PARAGRAPH B100 TO LOAD THIS NEW HEADING.  * 01010081
010200*            ADDED BREAK LOGIC FOR THIS NEW REPORT SO THAT IT   * 01020087
010300*            WILL BREAK ON OTB PERIOD.  PARAGRAPHS MODIFIED ARE * 01030088
010400*            B200 AND R100.  CHANGED WORDING ON RECEIVING       * 01040090
010500*            HEADING TO REFLECT NON-COLBY IMPORT POS.           * 01050090
010600*        BY: KEVIN CATLIN                   WR#: 22835          * 01060081
010700*                                                               * 01070093
010800*DATE  01/21/2005                                               * 01080093
010900*    CHANGE MADE: CHANGED 'COLBY' IN TWO REPORT TITLES TO NOW BE* 01090093
011000*    'LI & FUNG'.  THIS IS THE PARENT COMPANY OF COLBY.         * 01100093
011100*    MADE BY: MIKE BESKE              WR/IR #: WR28114          * 01110093
011160*                                                               * 01116095
011170* DATE  03/16/2009                                              * 01117096
011180*     CHANGE MADE: RECOMPILE FOR ADDITION OF DMA-NBR TO APRD036 * 01118095
011190*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR31546         * 01119095
011160*                                                               * 01119199
011170* DATE  05/11/2023                                              * 01119299
011180*     CHANGE MADE: FIX PAGE BREAK LOGIC                       6 * 01119399
011190*     MADE BY: JEAN KURK               WR/IR #: CHG0288297      * 01119499
011200*---------------------------------------------------------------* 01120078
011300                                                                  01130059
011400     EJECT                                                        01140065
011500                                                                  01150065
011600 ENVIRONMENT DIVISION.                                            01160059
011700                                                                  01170065
011800 CONFIGURATION SECTION.                                           01180058
011900                                                                  01190065
012000 SOURCE-COMPUTER.    IBM-3090.                                    01200027
012100                                                                  01210065
012200 OBJECT-COMPUTER.    IBM-3090.                                    01220027
012300                                                                  01230027
012400 INPUT-OUTPUT SECTION.                                            01240027
012500                                                                  01250065
012600 FILE-CONTROL.                                                    01260027
012700                                                                  01270027
012800     SELECT IMPORT-REPORT-FILE   ASSIGN TO UT-S-INP01.            01280027
012900     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            01290027
013000                                                                  01300027
013100     EJECT                                                        01310065
013200                                                                  01320027
013300 DATA DIVISION.                                                   01330027
013400                                                                  01340065
013500 FILE SECTION.                                                    01350027
013600                                                                  01360027
013700 FD  IMPORT-REPORT-FILE                                           01370027
013800     RECORDING MODE IS F                                          01380027
013900     LABEL RECORDS ARE STANDARD                                   01390027
014000     BLOCK CONTAINS 0 RECORDS                                     01400027
014100     DATA RECORD IS IMPORT-REPORT-REC.                            01410027
014200 01  IMPORT-REPORT-REC           PIC  X(170).                     01420040
014300                                                                  01430027
014400                                                                  01440065
014500 FD  REPORT-FILE                                                  01450027
014600     RECORDING MODE IS F                                          01460027
014700     LABEL RECORDS ARE STANDARD                                   01470027
014800     BLOCK CONTAINS 0 RECORDS                                     01480027
014900     DATA RECORD IS REPORT-REC.                                   01490027
015000 01  REPORT-REC                  PIC  X(200).                     01500040
015100                                                                  01510027
015200     EJECT                                                        01520065
015300                                                                  01530065
015400 WORKING-STORAGE SECTION.                                         01540027
015500                                                                  01550065
015600 01  PROGRAM-CONSTANTS.                                           01560027
015700                                                                  01570065
015800     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP081'. 01580027
015900                                                                  01590065
016000     05  PC-RCVING-HEADING       PIC  X(57)     VALUE             01600093
016100     '     NON-LI & FUNG IMPORT POS WITH VERIFIED RECEIPTS     '. 01610093
016200                                                                  01620065
016300     05  PC-POSTING-HEADING      PIC  X(57)     VALUE             01630093
016400     '         IMPORT PURCHASE ORDERS POSTED TO JOURNAL        '. 01640093
016500                                                                  01650065
016600     05  PC-AUTOJRNL-HEADING     PIC  X(57)     VALUE             01660093
016700     '       IMPORT POS RELEASED FOR AUTO JOURNALIZATION       '. 01670093
016800                                                                  01680078
016900     05  PC-OTB-RCVING-HEADING   PIC  X(57)     VALUE             01690093
017000     'LI & FUNG IMPORT POS WITH VERIFIED RECEIPTS BY OTB PERIOD'. 01700093
017100                                                                  01710081
017200     05  PC-DASH-LIT             PIC  X(37)     VALUE             01720093
017300         '------------------------------'.                        01730027
017400                                                                  01740065
017500     05  PC-PO-PER-PAGE-MAX      PIC S999       VALUE ZEROS.      01750066
017600                                                                  01760066
017700                                                                  01770027
017800     EJECT                                                        01780065
017900                                                                  01790065
018000 01  PROGRAM-VARIABLES.                                           01800027
018100                                                                  01810067
018200     05  PV-CURRENT-DATE.                                         01820027
018300         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      01830027
018400         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      01840027
018500         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      01850027
018600                                                                  01860067
018700     05  PV-CURRENT-TIME.                                         01870027
018800         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     01880027
018900         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     01890027
019000         10  FILLER              PIC  9(02)     VALUE ZEROES.     01900027
019100                                                                  01910067
019200     05  PV-PO-NBR               PIC  X(09)     VALUE SPACES.     01920027
019300     05  PV-PO-NBR-N             REDEFINES      PV-PO-NBR         01930027
019400                                 PIC  9(09).                      01940027
019500     05  PV-FOB-CDE              PIC  X(03)     VALUE SPACES.     01950027
019600     05  PV-FOB-NAME             PIC  X(30)     VALUE SPACES.     01960027
019700     05  PV-DEPT-NBR             PIC  X(03)     VALUE SPACES.     01970027
019800     05  PV-DEPT-DESC            PIC  X(25)     VALUE SPACES.     01980027
019900     05  PV-AP036-OTB-PER-HOLD   PIC  X(06)     VALUE SPACES.     01990086
020000     05  PV-AP036-VENDOR-NAME-HOLD PIC X(30)    VALUE SPACES.     02000086
020100     05  PV-INV-RCV-UNITS        PIC S9(9)      VALUE ZEROES.     02010027
020200     05  PV-RCV-VAR-PCT          PIC S999V99999 VALUE ZEROES.     02020027
020300     05  PV-INV-QTY-VAR-PCT      PIC S999V99999 VALUE ZEROES.     02030027
020400     05  PV-INV-RCV-VAR-PCT      PIC S999V99999 VALUE ZEROES.     02040027
020500     05  PV-EST-UNT-COST         PIC S999V9999  VALUE ZEROES.     02050062
020600     05  PV-INV-UNT-COST         PIC S999V9999  VALUE ZEROES.     02060062
020700     05  PV-PO-ELC-COST-AMT      PIC S9(11)V99  VALUE ZEROES.     02070027
020800     05  PV-INV-RCV-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     02080027
020900     05  PV-LC-INV-RCV-AMT       PIC S9(11)V99  VALUE ZEROES.     02090027
021000     05  PV-PO-INV-COST-AMT      PIC S9(11)V99  VALUE ZEROES.     02100027
021100     05  PV-PO-INV-RCV-AMT       PIC S9(11)V99  VALUE ZEROES.     02110027
021200                                                                  02120027
021300     05  PV-DB2-DATE             PIC  X(10)     VALUE SPACES.     02130027
021400     05  PV-DISPLAY-DATE         PIC  X(10)     VALUE SPACES.     02140027
021500                                                                  02150027
021600     EJECT                                                        02160065
021700                                                                  02170065
021800 01  PV-RETRY-COUNTER            PIC S9(4) COMP VALUE ZERO.       02180027
021900                                                                  02190027
022000 01  PV-PROCESS-COUNTERS.                                         02200027
022100     05  PV-READ-COUNT           PIC  9(08)     VALUE ZEROES.     02210027
022200     05  PV-PO-READ-COUNT        PIC  9(08)     VALUE ZEROES.     02220027
022300     05  PV-PO-PRINTED-COUNT     PIC  9(08)     VALUE ZEROES.     02230027
022400                                                                  02240027
022500 01  PV-REPORT-CONTROLS.                                          02250027
022600     05  PV-LINE-SKIP            PIC S999       VALUE ZEROES.     02260027
022700     05  PV-PO-PER-PAGE          PIC S999       VALUE +999.       02270027
022800*    05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     02280070
022900     05  PV-PAGE-COUNT           PIC  9(05)     VALUE ZEROES.     02290070
022900     05  PV-ON-PAGE              PIC  9         VALUE 0.          02291099
023000     05  PV-QUOTIENT             PIC  9(05)     VALUE ZEROES.     02300070
023100     05  PV-REMAINDER            PIC  9(05)     VALUE ZEROES.     02310070
023200                                                                  02320027
023300 01  PROGRAM-SWITCHES.                                            02330027
023400                                                                  02340065
023500     05  PS-PO-EOF-SW            PIC  X         VALUE 'N'.        02350027
023600         88  PS-PO-NOT-EOF                      VALUE 'N'.        02360034
023700         88  PS-PO-EOF                          VALUE 'Y'.        02370034
023800                                                                  02380027
023900     05  PS-PO-FIRST-READ-SWT    PIC  X         VALUE 'Y'.        02390083
024000         88  PS-PO-FIRST-READ-YES               VALUE 'Y'.        02400065
024100         88  PS-PO-FIRST-READ-NO                VALUE 'N'.        02410065
024200                                                                  02420065
024300     EJECT                                                        02430065
024400                                                                  02440065
024500*----------------------------------------------------------------*02450027
024600*  INPUT RECORD LAYOUT                                            02460027
024700*----------------------------------------------------------------*02470027
024800     COPY APRD036.                                                02480093
024900                                                                  02490027
025000     EJECT                                                        02500065
025100                                                                  02510065
025200*----------------------------------------------------------------*02520027
025300*  STANDARD HEADER LAYOUT                                         02530027
025400*----------------------------------------------------------------*02540027
025500     COPY DPWS200O.                                               02550093
025600                                                                  02560027
025700     EJECT                                                        02570065
025800                                                                  02580065
025900*----------------------------------------------------------------*02590027
026000*  REPORT LAYOUT                                                  02600027
026100*----------------------------------------------------------------*02610027
026200                                                                  02620027
026300 01  H2-HEADER2.                                                  02630027
026400     05  FILLER                  PIC  X(72)     VALUE SPACES.     02640093
026500     05  H2-TITLE                PIC  X(57)     VALUE SPACES.     02650093
026600     05  FILLER                  PIC  X(71)     VALUE SPACES.     02660093
026700                                                                  02670027
026800     EJECT                                                        02680065
026900                                                                  02690065
027000 01  H3-HEADER3.                                                  02700035
027100     05  FILLER                  PIC   X(15)    VALUE             02710027
027200         '  VENDOR NAME: '.                                       02720027
027300     05  H3-VENDOR-NAME          PIC   X(30)    VALUE SPACES.     02730027
027400     05  FILLER                  PIC   X(12)    VALUE SPACES.     02740027
027500     05  FILLER                  PIC   X(15)    VALUE             02750027
027600         'VENDOR NUMBER: '.                                       02760027
027700     05  H3-VENDOR-NUMBER        PIC   X(9)     VALUE SPACES.     02770027
027800     05  FILLER                  PIC   X(12)    VALUE SPACES.     02780027
027900     05  FILLER                  PIC   X(6)     VALUE 'DEPT: '.   02790027
028000     05  H3-DEPT-NUMBER          PIC   XXX      VALUE SPACES.     02800027
028100     05  FILLER                  PIC   X        VALUE SPACES.     02810027
028200     05  H3-DEPT-NAME            PIC   X(25)    VALUE SPACES.     02820027
028300     05  FILLER                  PIC   X(08)    VALUE SPACES.     02830027
028400     05  FILLER                  PIC   X(15)    VALUE             02840027
028500         '1ST  VERIFIED: '.                                       02850027
028600     05  H3-1ST-VERIFIED         PIC   X(10)    VALUE SPACES.     02860027
028700     05  FILLER                  PIC   X(11)    VALUE SPACES.     02870027
028800     05  FILLER                  PIC   X(12)    VALUE             02880027
028900         '% RECEIVED: '.                                          02890027
029000     05  H3-PCT-RECEIVED         PIC   ZZ9.99   VALUE ZEROES.     02900027
029100     05  FILLER                  PIC   X        VALUE '%'.        02910027
029200     05  FILLER                  PIC   X(09)    VALUE SPACES.     02920027
029300                                                                  02930027
029400     EJECT                                                        02940065
029500                                                                  02950065
029600 01  H4-HEADER4.                                                  02960035
029700     05  FILLER                  PIC   X(15)    VALUE             02970027
029800         '  PO NUMBER  : '.                                       02980027
029900     05  H4-PO-NUMBER            PIC   Z(9)     VALUE SPACES.     02990027
030000     05  FILLER                  PIC   X(10)    VALUE SPACES.     03000027
030100     05  FILLER                  PIC   X(11)    VALUE             03010027
030200         'PO STATUS: '.                                           03020027
030300     05  H4-PO-STATUS            PIC   XX       VALUE SPACES.     03030027
030400     05  FILLER                  PIC   X(10)    VALUE SPACES.     03040027
030500     05  FILLER                  PIC   X(11)    VALUE             03050027
030600         'FOB POINT: '.                                           03060027
030700     05  H4-FOB-POINT            PIC   X(24)    VALUE SPACES.     03070027
030800     05  FILLER                  PIC   X(15)    VALUE             03080027
030900         ' 1ST INVOICED: '.                                       03090027
031000     05  H4-1ST-INVOICED         PIC   X(10)    VALUE SPACES.     03100027
031100     05  FILLER                  PIC   X(19)    VALUE SPACES.     03110027
031200     05  FILLER                  PIC   X(15)    VALUE             03120027
031300         'LAST VERIFIED: '.                                       03130027
031400     05  H4-LAST-VERIFIED        PIC   X(10)    VALUE SPACES.     03140032
031500     05  FILLER                  PIC   X(11)    VALUE SPACES.     03150027
031600     05  FILLER                  PIC   X(12)    VALUE             03160027
031700         'OTB PERIOD: '.                                          03170027
031800     05  H4-OTB-PERIOD.                                           03180050
031900         10  H4-OTB-MONTH        PIC   X(03)    VALUE SPACES.     03190050
032000         10  H4-OTB-COMMA        PIC   X(02)    VALUE ', '.       03200050
032100         10  H4-OTB-YEAR         PIC   X(04)    VALUE SPACES.     03210050
032200     05  FILLER                  PIC   X(07)    VALUE SPACES.     03220027
032300                                                                  03230027
032400     EJECT                                                        03240065
032500                                                                  03250065
032600 01  H5-HEADER5.                                                  03260035
032700     05  FILLER                  PIC   X(38)    VALUE SPACES.     03270027
032800     05  FILLER                  PIC   X(8)     VALUE             03280027
032900         'PURCHASE'.                                              03290027
033000     05  FILLER                  PIC   X(11)    VALUE SPACES.     03300027
033100     05  FILLER                  PIC   X(9)     VALUE             03310027
033200         'ESTIMATED'.                                             03320027
033300     05  FILLER                  PIC   X(8)     VALUE SPACES.     03330030
033400     05  FILLER                  PIC   X(8)     VALUE 'COST PER'. 03340029
033500     05  FILLER                  PIC   X(08)    VALUE SPACES.     03350030
033600     05  FILLER                  PIC   X(6)     VALUE 'PO VS.'.   03360027
033700     05  FILLER                  PIC   X(12)    VALUE SPACES.     03370027
033800     05  FILLER                  PIC   X(8)     VALUE             03380027
033900         'VERIFIED'.                                              03390027
034000     05  FILLER                  PIC   X(28)    VALUE SPACES.     03400031
034100     05  FILLER                  PIC   X(08)    VALUE             03410027
034200         'COST PER'.                                              03420027
034300     05  FILLER                  PIC   X(04)    VALUE SPACES.     03430031
034400     05  FILLER                  PIC   X(03)    VALUE 'PCT'.      03440027
034500     05  FILLER                  PIC   X(07)    VALUE SPACES.     03450027
034600     05  FILLER                  PIC   X(03)    VALUE 'PCT'.      03460027
034700     05  FILLER                  PIC   X(09)    VALUE SPACES.     03470027
034800     05  FILLER                  PIC   X(11)    VALUE             03480027
034900         'INVOICED VS'.                                           03490027
035000     05  FILLER                  PIC   X(07)    VALUE SPACES.     03500027
035100     05  FILLER                  PIC   X(03)    VALUE 'PCT'.      03510027
035200     05  FILLER                  PIC   X(03)    VALUE SPACES.     03520027
035300                                                                  03530027
035400     EJECT                                                        03540065
035500                                                                  03550065
035600 01  H6-HEADER6.                                                  03560027
035700     05  FILLER                  PIC   X(26)    VALUE             03570027
035800         '     COMPONENT DESCRIPTION'.                            03580027
035900     05  FILLER                  PIC   X(13)    VALUE SPACES.     03590027
036000     05  FILLER                  PIC   X(05)    VALUE 'ORDER'.    03600027
036100     05  FILLER                  PIC   X(12)    VALUE SPACES.     03610027
036200     05  FILLER                  PIC   X(11)    VALUE             03620027
036300         'LANDED COST'.                                           03630027
036400     05  FILLER                  PIC   X(09)    VALUE SPACES.     03640030
036500     05  FILLER                  PIC   X(04)    VALUE 'UNIT'.     03650029
036600     05  FILLER                  PIC   X(11)    VALUE SPACES.     03660031
036700     05  FILLER                  PIC   X(03)    VALUE 'ELC'.      03670027
036800     05  FILLER                  PIC   X(14)    VALUE SPACES.     03680027
036900     05  FILLER                  PIC   X(08)    VALUE 'RECEIPTS'. 03690027
037000     05  FILLER                  PIC   X(12)    VALUE SPACES.     03700027
037100     05  FILLER                  PIC   X(08)    VALUE 'INVOICED'. 03710027
037200     05  FILLER                  PIC   X(10)    VALUE SPACES.     03720031
037300     05  FILLER                  PIC   X(04)    VALUE 'UNIT'.     03730027
037400     05  FILLER                  PIC   X(05)    VALUE SPACES.     03740031
037500     05  FILLER                  PIC   X(05)    VALUE 'TO FC'.    03750027
037600     05  FILLER                  PIC   X(05)    VALUE SPACES.     03760027
037700     05  FILLER                  PIC   X(05)    VALUE 'TO LC'.    03770027
037800     05  FILLER                  PIC   X(09)    VALUE SPACES.     03780027
037900     05  FILLER                  PIC   X(08)    VALUE 'VERIFIED'. 03790027
038000     05  FILLER                  PIC   X(09)    VALUE SPACES.     03800027
038100     05  FILLER                  PIC   X(03)    VALUE 'VAR'.      03810027
038200     05  FILLER                  PIC   X(01)    VALUE SPACES.     03820027
038300                                                                  03830027
038400     EJECT                                                        03840065
038500                                                                  03850065
038600 01  H7-DASHLINE.                                                 03860027
038700     05  FILLER                  PIC   X(01)    VALUE SPACES.     03870027
038800     05  H7-DASH1                PIC   X(30)    VALUE             03880027
038900         '------------------------------'.                        03890027
039000     05  FILLER                  PIC   X(02)    VALUE SPACES.     03900027
039100     05  H7-DASH2                PIC   X(18)    VALUE             03910027
039200         '------------------'.                                    03920027
039300     05  FILLER                  PIC   X(02)    VALUE SPACES.     03930027
039400     05  H7-DASH3                PIC   X(18)    VALUE             03940027
039500         '------------------'.                                    03950027
039600     05  FILLER                  PIC   X(02)    VALUE SPACES.     03960027
039700     05  H7-DASH4                PIC   X(09)    VALUE             03970027
039800         '---------'.                                             03980027
039900     05  FILLER                  PIC   X(01)    VALUE SPACES.     03990027
040000     05  H7-DASH5                PIC   X(18)    VALUE             04000027
040100         '------------------'.                                    04010027
040200     05  FILLER                  PIC   X(02)    VALUE SPACES.     04020027
040300     05  H7-DASH6                PIC   X(18)    VALUE             04030027
040400         '------------------'.                                    04040027
040500     05  FILLER                  PIC   X(02)    VALUE SPACES.     04050027
040600     05  FILLER                  PIC   X(18)    VALUE             04060027
040700         '------------------'.                                    04070027
040800     05  FILLER                  PIC   X(02)    VALUE SPACES.     04080027
040900     05  H7-DASH7                PIC   X(09)    VALUE             04090027
041000         '---------'.                                             04100027
041100     05  FILLER                  PIC   X(02)    VALUE SPACES.     04110027
041200     05  H7-DASH8                PIC   X(08)    VALUE             04120027
041300         '--------'.                                              04130027
041400     05  FILLER                  PIC   X(02)    VALUE SPACES.     04140027
041500     05  H7-DASH9                PIC   X(08)    VALUE             04150027
041600         '--------'.                                              04160027
041700     05  FILLER                  PIC   X(01)    VALUE SPACES.     04170027
041800     05  FILLER                  PIC   X(18)    VALUE             04180027
041900         '------------------'.                                    04190027
042000     05  FILLER                  PIC   X(01)    VALUE SPACES.     04200027
042100     05  H7-DASH10               PIC   X(08)    VALUE             04210027
042200         '--------'.                                              04220027
042300                                                                  04230027
042400     EJECT                                                        04240065
042500                                                                  04250065
042600 01  D1-DETAIL1.                                                  04260035
042700     05  FILLER                  PIC   X(7)     VALUE ' UNITS'.   04270027
042800     05  FILLER                  PIC   X(30)    VALUE SPACES.     04280027
042900     05  D1-PO-UNITS             PIC   ZZZ,ZZZ,ZZ9                04290027
043000                                                VALUE ZEROES.     04300027
043100     05  FILLER                  PIC   X(9)     VALUE SPACES.     04310027
043200     05  D1-ELC-UNITS            PIC   ZZZ,ZZZ,ZZ9                04320027
043300                                                VALUE ZEROES.     04330027
043400     05  FILLER                  PIC   X(39)    VALUE SPACES.     04340027
043500     05  D1-RCV-UNITS            PIC   ZZZ,ZZZ,ZZ9                04350027
043600                                                VALUE ZEROES.     04360027
043700     05  FILLER                  PIC   X(9)     VALUE SPACES.     04370027
043800     05  D1-INV-UNITS            PIC   ZZZ,ZZZ,ZZ9                04380027
043900                                                VALUE ZEROES.     04390027
044000     05  FILLER                  PIC   X(39)    VALUE SPACES.     04400027
044100     05  D1-RCV-VAR-UNITS        PIC   ---,---,--9                04410041
044200                                                VALUE ZEROES.     04420027
044300     05  FILLER                  PIC   X(4)     VALUE SPACES.     04430027
044400     05  D1-PCT-VAR              PIC   ---9.99  VALUE ZEROES.     04440027
044500     05  FILLER                  PIC   X        VALUE '%'.        04450027
044600                                                                  04460027
044700     EJECT                                                        04470065
044800                                                                  04480065
044900 01  D2-DETAIL2.                                                  04490027
045000     05  FILLER                  PIC   X        VALUE SPACES.     04500027
045100     05  D2-COMPNT-DESC          PIC   X(30)    VALUE SPACES.     04510027
045200     05  FILLER                  PIC   XX       VALUE SPACES.     04520027
045300     05  D2-PO-COST-ALPHA        PIC   X(18)    VALUE SPACES.     04530027
045400     05  D2-PO-COST-EDIT         REDEFINES      D2-PO-COST-ALPHA. 04540027
045500         10  D2-PO-COST          PIC   --,---,---,--9.99.         04550027
045600         10  D2-PO-COST-RP       PIC   X.                         04560027
045700     05  FILLER                  PIC   XX       VALUE SPACES.     04570027
045800     05  D2-ELC-COST-ALPHA       PIC   X(18)    VALUE SPACES.     04580027
045900     05  D2-ELC-COST-EDIT        REDEFINES      D2-ELC-COST-ALPHA.04590027
046000         10  D2-ELC-COST         PIC   --,---,---,--9.99.         04600027
046100         10  D2-ELC-COST-RP      PIC   X.                         04610027
046200     05  FILLER                  PIC   XX       VALUE SPACES.     04620027
046300     05  D2-ELC-COST-UNIT-ALPHA  PIC   X(09)    VALUE SPACES.     04630027
046400     05  D2-ELC-COST-UNIT-EDIT   REDEFINES D2-ELC-COST-UNIT-ALPHA.04640027
046500         10  D2-ELC-COST-UNIT    PIC   --9.9999.                  04650027
046600         10  D2-ELC-COST-UNIT-RP PIC   X.                         04660027
046700     05  FILLER                  PIC   X        VALUE SPACES.     04670027
046800     05  D2-PO-ELC-VAR-ALPHA     PIC   X(18)    VALUE SPACES.     04680027
046900     05  D2-PO-ELC-VAR-EDIT      REDEFINES    D2-PO-ELC-VAR-ALPHA.04690027
047000         10  D2-PO-ELC-VAR       PIC   --,---,---,--9.99.         04700027
047100         10  D2-PO-ELC-VAR-RP    PIC   X.                         04710027
047200     05  FILLER                  PIC   XX       VALUE SPACES.     04720027
047300     05  D2-RCV-COST-ALPHA       PIC   X(18)    VALUE SPACES.     04730027
047400     05  D2-RCV-COST-EDIT        REDEFINES      D2-RCV-COST-ALPHA.04740027
047500         10  D2-RCV-COST         PIC   --,---,---,--9.99.         04750027
047600         10  D2-RCV-COST-RP      PIC   X.                         04760027
047700     05  FILLER                  PIC   XX       VALUE SPACES.     04770027
047800     05  D2-INV-COST             PIC   --,---,---,--9.99          04780027
047900                                                VALUE ZEROES.     04790027
048000     05  D2-INV-COST-RP          PIC   X        VALUE SPACES.     04800027
048100     05  FILLER                  PIC   XX       VALUE SPACES.     04810027
048200     05  D2-INV-COST-UNIT-ALPHA  PIC   X(9)     VALUE SPACES.     04820027
048300     05  D2-INV-COST-UNIT-EDIT   REDEFINES D2-INV-COST-UNIT-ALPHA.04830027
048400         10  D2-INV-COST-UNIT    PIC   --9.9999.                  04840027
048500         10  D2-INV-COST-UNIT-RP PIC   X.                         04850027
048600     05  FILLER                  PIC   XX       VALUE SPACES.     04860027
048700     05  D2-PCT-TO-FC-ALPHA      PIC   X(8)     VALUE SPACES.     04870027
048800     05  D2-PCT-TO-FC-EDIT       REDEFINES     D2-PCT-TO-FC-ALPHA.04880027
048900         10  D2-PCT-TO-FC        PIC   -9.9999.                   04890027
049000         10  D2-PCT-TO-FC-RP     PIC   X.                         04900027
049100     05  FILLER                  PIC   XX       VALUE SPACES.     04910027
049200     05  D2-PCT-TO-LC-ALPHA      PIC   X(8)     VALUE SPACES.     04920027
049300     05  D2-PCT-TO-LC-EDIT       REDEFINES     D2-PCT-TO-LC-ALPHA.04930027
049400         10  D2-PCT-TO-LC        PIC   -9.9999.                   04940027
049500         10  D2-PCT-TO-LC-RP     PIC   X.                         04950027
049600     05  FILLER                  PIC   X        VALUE SPACES.     04960027
049700     05  D2-INV-RCV-VAR          PIC   --,---,---,--9.99          04970027
049800                                                VALUE ZEROES.     04980027
049900     05  D2-INV-RCV-VAR-RP       PIC   X        VALUE SPACES.     04990027
050000     05  FILLER                  PIC   X        VALUE SPACES.     05000027
050100     05  D2-PCT-VAR-ALPHA        PIC   X(8)     VALUE SPACES.     05010027
050200     05  D2-PCT-VAR-EDIT         REDEFINES      D2-PCT-VAR-ALPHA. 05020027
050300         10  D2-PCT-VAR          PIC   ---9.99.                   05030027
050400         10  D2-PCT-VAR-SYMBOL   PIC   X.                         05040027
050500                                                                  05050027
050600     EJECT                                                        05060065
050700                                                                  05070065
050800 01  T1-TOTAL1.                                                   05080027
050900     05  FILLER                  PIC   X        VALUE SPACES.     05090027
051000     05  T1-COMPNT-DESC          PIC   X(30)    VALUE SPACES.     05100027
051100     05  FILLER                  PIC   X(41)    VALUE SPACES.     05110061
051200     05  T1-EST-UNT-COST         PIC   --9.9999 VALUE ZEROES.     05120061
051300     05  T1-EST-UNT-COST-RP      PIC   X        VALUE SPACES.     05130061
051400     05  FILLER                  PIC   X(42)    VALUE SPACES.     05140061
051500     05  T1-INV-COST             PIC   --,---,---,--9.99          05150027
051600                                                VALUE ZEROES.     05160027
051700     05  T1-INV-COST-RP          PIC   X        VALUE SPACES.     05170027
051800     05  FILLER                  PIC   X(01)    VALUE SPACES.     05180061
051900     05  T1-INV-UNT-COST         PIC   --9.9999 VALUE ZEROES.     05190061
052000     05  T1-INV-UNT-COST-RP      PIC   X        VALUE SPACES.     05200061
052100     05  FILLER                  PIC   X(22)    VALUE SPACES.     05210061
052200     05  T1-INV-RCV-VAR          PIC   --,---,---,--9.99          05220027
052300                                                VALUE ZEROES.     05230027
052400     05  T1-INV-RCV-VAR-RP       PIC   X        VALUE SPACES.     05240027
052500     05  FILLER                  PIC   X(09)    VALUE SPACES.     05250027
052600                                                                  05260027
052700     EJECT                                                        05270065
052800                                                                  05280027
052900 01  END-OF-REPORT.                                               05290027
053000     05  FILLER                  PIC  X(81)   VALUE SPACES.       05300027
053100     05  FILLER                  PIC  X(37)   VALUE               05310027
053200         '**********  END OF REPORT  **********'.                 05320027
053300     05  FILLER                  PIC  X(82)   VALUE SPACES.       05330027
053400                                                                  05340027
053500     EJECT                                                        05350066
053600                                                                  05360066
053700*----------------------------------------------------------------*05370066
053800* WORKING STORAGE FOR DATE ROUTINE                                05380066
053900*----------------------------------------------------------------*05390066
054000                                                                  05400068
054100     COPY DPWS500.                                                05410093
054200                                                                  05420066
054300     EJECT                                                        05430066
054400                                                                  05440066
054500*-----------------------------------------------------------      05450035
054600*    SQL COMMUNICATIONS AREA DCLGEN                               05460027
054700*-----------------------------------------------------------      05470035
054800                                                                  05480066
054900     EXEC SQL                                                     05490027
055000         INCLUDE SQLCA                                            05500027
055100     END-EXEC.                                                    05510027
055200                                                                  05520035
055300     EJECT                                                        05530065
055400                                                                  05540065
055500*-----------------------------------------------------------      05550027
055600*    TIMFOB DCLGEN                                                05560027
055700*-----------------------------------------------------------      05570027
055800                                                                  05580068
055900     EXEC SQL                                                     05590027
056000         INCLUDE TIMFOB                                           05600027
056100     END-EXEC.                                                    05610027
056200                                                                  05620035
056300     EJECT                                                        05630065
056400                                                                  05640065
056500*-----------------------------------------------------------      05650027
056600*    TMDSEAR DCLGEN                                               05660027
056700*-----------------------------------------------------------      05670027
056800                                                                  05680068
056900     EXEC SQL                                                     05690027
057000         INCLUDE TMDSEAR                                          05700027
057100     END-EXEC.                                                    05710027
057200                                                                  05720035
057300     EJECT                                                        05730065
057400                                                                  05740065
057500*-----------------------------------------------------------      05750027
057600*  ABEND DATA AREAS                                               05760027
057700*-----------------------------------------------------------      05770027
057800                                                                  05780068
057900 01  ABEND-CODE                  PIC S9(4)      VALUE ZEROES      05790027
058000                                 COMP           SYNC.             05800027
058100                                                                  05810027
058200     88  AC-ANY-ERROR                           VALUE +4001       05820027
058300                                                THRU  +4019.      05830027
058400     88  AC-INVALID-KEY-WRITE                   VALUE +4001.      05840027
058500     88  AC-INVALID-KEY-READ                    VALUE +4002.      05850027
058600     88  AC-INVALID-CONTROL-CARD                VALUE +4003.      05860027
058700     88  AC-TABLE-OVERFLOW                      VALUE +4004.      05870027
058800     88  AC-OPEN-FILE-ERROR                     VALUE +4005.      05880027
058900     88  AC-CLOSE-FILE-ERROR                    VALUE +4006.      05890027
059000     88  AC-SEQUENCE-ERROR                      VALUE +4007.      05900027
059100     88  AC-INVALID-DATA                        VALUE +4008.      05910027
059200     88  AC-INVALID-KEYPUNCH                    VALUE +4009.      05920027
059300     88  AC-INTERNAL-SORT-ERROR                 VALUE +4012.      05930027
059400     88  AC-DB2-ERROR                           VALUE +4013.      05940027
059500     88  AC-DPWS500-DATE-ERROR                  VALUE +4019.      05950027
059600                                                                  05960027
059700     EJECT                                                        05970065
059800                                                                  05980027
059900 01  ABEND-AREAS.                                                 05990027
060000     05  AA-ABEND-LIT            PIC  X(40)  VALUE                06000027
060100             '*****       ABEND'.                                 06010027
060200     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                06020027
060300             '*****   PROGRAM: APKRP081'.                         06030027
060400     05  AA-PARAGRAPH-LIT.                                        06040027
060500         10  FILLER              PIC  X(17)  VALUE                06050027
060600             '***** PARAGRAPH: '.                                 06060027
060700         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        06070027
060800     05  AA-MESSAGE-LINE.                                         06080027
060900         10  FILLER              PIC  X(06)  VALUE '*****'.       06090027
061000         10  AA-MESSAGE.                                          06100027
061100             15 AA-MESS-1        PIC  X(30)  VALUE SPACES.        06110027
061200             15 AA-MESS-2        PIC  X(97)  VALUE SPACES.        06120027
061300     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                06130027
061400             '*****    DB2 ERROR'.                                06140027
061500     05  AA-DB2-OPERATION-LIT.                                    06150027
061600         10  FILLER              PIC  X(17)  VALUE                06160027
061700             '***** OPERATION: '.                                 06170027
061800         10  AA-DB2-OPERATION.                                    06180027
061900             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        06190027
062000             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        06200027
062100     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        06210027
062200     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        06220027
062300     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        06230027
062400                                                                  06240027
062500     EJECT                                                        06250065
062600                                                                  06260065
062700*-----------------------------------------------------------      06270027
062800*  SQLCA FORMATTED MESSAGE AREA                                   06280027
062900*-----------------------------------------------------------      06290027
063000                                                                  06300068
063100     COPY DPWS004.                                                06310027
063200                                                                  06320027
063300 01  FILLER                      PIC  X(25)  VALUE                06330027
063400     '** END OF APKRP081 W/S **'.                                 06340027
063500                                                                  06350027
063600     EJECT                                                        06360065
063700                                                                  06370065
063800 PROCEDURE DIVISION.                                              06380027
063900                                                                  06390065
064000 A100-MAIN.                                                       06400027
064100                                                                  06410027
064200     PERFORM B100-INITIALIZE.                                     06420027
064300                                                                  06430027
064400     PERFORM B200-PROCESS-IMPORT-FILE                             06440027
064500         UNTIL PS-PO-EOF.                                         06450027
064600                                                                  06460027
064700     PERFORM B300-END-OF-PROGRAM.                                 06470027
064800                                                                  06480027
064900     GOBACK.                                                      06490027
065000                                                                  06500027
065100     EJECT                                                        06510065
065200                                                                  06520027
065300 B100-INITIALIZE.                                                 06530035
065400                                                                  06540068
065500*----------------------------------------------------------------*06550027
065600*    INITIALIZATION PROCESSING                                   *06560027
065700*                                                                *06570035
065800*    - OPEN FILES.                                               *06580035
065900*    - FORMAT PAGE HEADINGS.                                     *06590035
066000*    - READ INPUT FILE.                                          *06600035
066100*    - FORMAT REPORT TITLE TO HEADING LINE.                      *06610035
066200*    - PROCESS HEADER RECORD DATA.                               *06620035
066300*----------------------------------------------------------------*06630027
066400                                                                  06640027
066500     OPEN INPUT  IMPORT-REPORT-FILE                               06650027
066600          OUTPUT REPORT-FILE.                                     06660027
066700                                                                  06670027
066800     ACCEPT PV-CURRENT-DATE FROM DATE.                            06680027
066900                                                                  06690065
067000     MOVE PV-CURRENT-MONTH       TO DP200O-RUN-MONTH.             06700027
067100     MOVE PV-CURRENT-DAY         TO DP200O-RUN-DAY.               06710027
067200     MOVE PV-CURRENT-YEAR        TO DP200O-RUN-YEAR.              06720027
067300                                                                  06730027
067400     ACCEPT PV-CURRENT-TIME FROM TIME.                            06740027
067500                                                                  06750068
067600     MOVE PV-CURRENT-HOUR        TO DP200O-RUN-HOUR.              06760027
067700     MOVE PV-CURRENT-MINUTE      TO DP200O-RUN-MINUTE.            06770027
067800                                                                  06780065
067900     MOVE PC-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.          06790027
068000     MOVE 1                      TO DP200O-REPORT-NUMBER.         06800027
068100                                                                  06810027
068200     PERFORM R100-READ-INPUT.                                     06820027
068300                                                                  06830065
068400     IF PS-PO-EOF                                                 06840027
068500         DISPLAY ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'    06850027
068600     END-IF.                                                      06860034
068700                                                                  06870034
068800     IF AP036-POSTING-RPT                                         06880027
068900         MOVE PC-POSTING-HEADING TO H2-TITLE                      06890027
069000         MOVE 1                  TO PC-PO-PER-PAGE-MAX            06900066
069100     END-IF.                                                      06910065
069200                                                                  06920065
069300     IF AP036-RCVING-RPT                                          06930065
069400         MOVE PC-RCVING-HEADING  TO H2-TITLE                      06940047
069500         MOVE 2                  TO PC-PO-PER-PAGE-MAX            06950066
069600     END-IF.                                                      06960034
069700                                                                  06970027
069800     IF AP036-AUTO-JRNLD-RPT                                      06980078
069900         MOVE PC-AUTOJRNL-HEADING  TO H2-TITLE                    06990078
070000         MOVE 2                    TO PC-PO-PER-PAGE-MAX          07000078
070100     END-IF.                                                      07010078
070200                                                                  07020078
070300     IF AP036-OTB-RCVING-RPT                                      07030081
070400         MOVE PC-OTB-RCVING-HEADING TO H2-TITLE                   07040081
070500         MOVE 2                     TO PC-PO-PER-PAGE-MAX         07050081
070600     END-IF.                                                      07060081
070700                                                                  07070081
070800     IF PS-PO-NOT-EOF                                             07080034
074000         PERFORM W100-WRITE-HEADINGS                              07091099
070900         PERFORM C100-PROCESS-HEADER                              07092099
071000     END-IF.                                                      07100065
071100                                                                  07110065
071200     EJECT                                                        07120065
071300                                                                  07130027
071400 B200-PROCESS-IMPORT-FILE.                                        07140035
071500                                                                  07150065
071600*----------------------------------------------------------------*07160027
071700*    PROCESS IMPORT FILE.                                        *07170035
071800*                                                                *07180035
071900*    - IF NEW PO, PRINT DETAIL LINES FOR LAST PO, AND PROCESS    *07190035
072000*       NEW PO HEADER DATA.                                      *07200035
072100*                                                                *07210065
072200*    - PROCESS DETAIL DATA DEPENDING ON RPT LINE SEQ             *07220035
072300*       AND PRINT THE DETAIL REPORT LINE.                        *07230035
072400*                                                                *07240065
072500*    - READ THE IMPORT FILE.                                     *07250035
072600*----------------------------------------------------------------*07260027
072700                                                                  07270027
072800*    - IF NEW PO, PRINT DETAIL LINES FOR LAST PO, AND PROCESS    *07280035
072900*       NEW PO HEADER DATA.                                      *07290035
073000                                                                  07300065
073100     IF AP036-PO-NBR NOT = PV-PO-NBR                              07310027
073200         IF AP036-HEADER                                          07320027
073201*            PRINT BLANK LINE                                     07321099
073300             MOVE SPACES         TO REPORT-REC                    07330027
073400             MOVE +4             TO PV-LINE-SKIP                  07340027
073500             PERFORM W300-PRINT-DETAIL                            07350099
073600             IF PC-PO-PER-PAGE-MAX = 2                            07360066
073700                 IF AP036-VENDOR-NAME = PV-AP036-VENDOR-NAME-HOLD 07370067
073800                    OR (AP036-OTB-RCVING-RPT AND                  07380086
073900                        AP036-OTB-PER-NBR = PV-AP036-OTB-PER-HOLD)07390086
074000                     IF PV-ON-PAGE = 2                            07401099
074000                         PERFORM W100-WRITE-HEADINGS              07401299
074000                         PERFORM C100-PROCESS-HEADER              07401399
073500                         MOVE 1 TO PV-ON-PAGE                     07401499
074000                     ELSE                                         07401699
141100*                        PERFORM W200-WRITE-PO-HEADINGS           07401799
141100                         PERFORM C100-PROCESS-HEADER              07401899
074000                     END-IF                                       07402199
074000*                    PERFORM C100-PROCESS-HEADER                  07403099
074100                 ELSE                                             07410067
074200                     IF AP036-OTB-RCVING-RPT                      07420086
074300****------>  BREAK LOGIC ON OTB PERIOD FOR THIS REPORT            07430087
074400                        MOVE AP036-OTB-PER-NBR TO                 07440086
074500                                        PV-AP036-OTB-PER-HOLD     07450086
074600                     ELSE                                         07460086
074700                        MOVE AP036-VENDOR-NAME TO                 07470086
074800                                    PV-AP036-VENDOR-NAME-HOLD     07480086
074900                     END-IF                                       07490086
074000                     PERFORM W100-WRITE-HEADINGS                  07492199
076400                     PERFORM C100-PROCESS-HEADER                  07492299
073500                     MOVE 1 TO PV-ON-PAGE                         07492399
076600                 END-IF                                           07492499
                                                                        07493099
075000*                    DIVIDE PV-PAGE-COUNT BY 2 GIVING             07500099
075100*                        PV-QUOTIENT                              07510099
075200*                        REMAINDER PV-REMAINDER                   07520099
075300*                        INITIALIZE REPORT-REC                    07530099
075400*                    IF PV-REMAINDER NOT = ZEROES                 07540099
075500*                        ADD 1 TO PV-PAGE-COUNT                   07550099
075600*                        MOVE PV-PAGE-COUNT TO DP200O-PAGE-NUMBER 07560099
075700*                        WRITE REPORT-REC                         07570099
075800*                              FROM DP200O-STANDRD-HEADER-200-COLS07580099
075900*                                   AFTER ADVANCING PAGE          07590099
076000*                        MOVE +2 TO PV-PO-PER-PAGE                07600099
076100*                        PERFORM C100-PROCESS-HEADER              07610099
076200*                    ELSE                                         07620099
076300*                        MOVE +2 TO PV-PO-PER-PAGE                07630099
076400*                        PERFORM C100-PROCESS-HEADER              07640099
076500*                    END-IF                                       07650099
076600*                END-IF                                           07660099
076700             ELSE                                                 07670066
076702*                ONLY 1 PO PER PAGE, SO PRINT NEW HEADER          07671099
074000                 PERFORM W100-WRITE-HEADINGS                      07681099
076800                 PERFORM C100-PROCESS-HEADER                      07682099
076900             END-IF                                               07690067
077000         END-IF                                                   07700066
077100     END-IF.                                                      07710027
077200                                                                  07720027
077300     IF AP036-DETAIL                                              07730027
077400                                                                  07740065
077500*    - PROCESS DETAIL DATA DEPENDING ON RPT LINE SEQ             *07750035
077600*       AND PRINT THE DETAIL REPORT LINE.                        *07760035
077700                                                                  07770065
077800         MOVE AP036-COMPONENT-DESC                                07780027
077900                                 TO D2-COMPNT-DESC                07790027
078000         IF AP036-RPT-LINE-SEQ = 'M1'                             07800056
078100*                                  'LANDED COST    '              07810027
078200             PERFORM C250-PROCESS-TOTAL-LC                        07820061
078300         ELSE                                                     07830027
078400             IF AP036-RPT-LINE-SEQ = 'N1'                         07840056
078500*                                  'LANDED COST LOAD - INTERNAL'  07850027
078600                 PERFORM C300-PROCESS-LCL                         07860027
078700             ELSE                                                 07870027
078800                 PERFORM C200-PROCESS-COMPONENTS                  07880027
078900             END-IF                                               07890027
079000         END-IF                                                   07900027
079100         PERFORM W300-PRINT-DETAIL                                07910027
079200     END-IF.                                                      07920027
079300                                                                  07930027
079400*    - READ THE IMPORT FILE.                                     *07940035
079500                                                                  07950065
079600     PERFORM R100-READ-INPUT.                                     07960027
079700                                                                  07970027
079800     EJECT                                                        07980065
079900                                                                  07990027
080000 B300-END-OF-PROGRAM.                                             08000038
080100                                                                  08010065
080200*----------------------------------------------------------------*08020027
080300*  END OF PROGRAM                                                 08030027
080400*----------------------------------------------------------------*08040027
080500                                                                  08050027
080600     WRITE REPORT-REC FROM END-OF-REPORT AFTER 2.                 08060027
080700                                                                  08070027
080800     DISPLAY '** END OF APKRP081 PROCESSING **'.                  08080027
080900     DISPLAY '** PO''S READ             = ' PV-PO-READ-COUNT.     08090027
081000     DISPLAY '** TOTAL RECORDS READ    = ' PV-READ-COUNT.         08100027
081100     DISPLAY ' ' .                                                08110027
081200     DISPLAY '** PO''S PRINTED          = ' PV-PO-PRINTED-COUNT.  08120027
081300                                                                  08130027
081400     CLOSE IMPORT-REPORT-FILE                                     08140027
081500           REPORT-FILE.                                           08150027
081600                                                                  08160027
081700     EJECT                                                        08170065
081800                                                                  08180027
081900 C100-PROCESS-HEADER.                                             08190027
082000                                                                  08200065
082100*----------------------------------------------------------------*08210027
082200*    PROCESS HEADER RECORD.                                      *08220035
082300*                                                                *08230035
082400*    - SET UP SAVED FIELDS FOR THE NEW PO.                       *08240035
082500*    - GET DB2 DATA FOR REPORT.                                  *08250035
082600*    - FORMAT HEADER DATA TO THE REPORT HEADINGS, DETAIL LINES.  *08260035
082700*----------------------------------------------------------------*08270027
082800                                                                  08280027
082900     MOVE AP036-PO-NBR           TO PV-PO-NBR.                    08290027
083000     MOVE AP036-FOB-CDE          TO PV-FOB-CDE.                   08300027
083100     MOVE AP036-DEPT-NBR         TO PV-DEPT-NBR.                  08310027
083200                                                                  08320038
083300*    - GET DB2 DATA FOR REPORT.                                  *08330038
083400                                                                  08340065
083500     PERFORM S100-GET-FOB-NAME.                                   08350027
083600     PERFORM S200-GET-DEPT-DESC.                                  08360027
083700                                                                  08370038
083800*    - FORMAT HEADER DATA TO THE REPORT HEADINGS, DETAIL LINES.   08380035
083900                                                                  08390065
084000     PERFORM F100-FORMAT-HEADER.                                  08400027
084100                                                                  08410027
084200     EJECT                                                        08420065
084300                                                                  08430027
084400 C200-PROCESS-COMPONENTS.                                         08440035
084500                                                                  08450065
084600*----------------------------------------------------------------*08460027
084700*    PROCESS DETAIL DATA (COMPONENTS).                           *08470035
084800*                                                                *08480035
084900*    - FORMAT DATA TO DETAIL REPORT LINE.                        *08490035
085000*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *08500035
085100*       COMPUTE VARIANCES AND ACCUMULATE FOR THE LANDED COST     *08510038
085200*       TOTAL.                                                   *08520038
085300*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *08530038
085400*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *08540038
085500*----------------------------------------------------------------*08550027
085600                                                                  08560027
085700*    - FORMAT DATA TO DETAIL REPORT LINE.                        *08570035
085800*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *08580035
085900*       COMPUTE VARIANCES AND ACCUMULATE FOR THE LANDED COST     *08590038
086000*       TOTAL.                                                   *08600038
086100                                                                  08610065
086200     IF AP036-PO-COST-AMT = ZEROES                                08620027
086300         MOVE SPACES             TO D2-PO-COST-ALPHA              08630027
086400     ELSE                                                         08640027
086500         MOVE AP036-PO-COST-AMT  TO D2-PO-COST                    08650027
086600         IF AP036-PO-COST-AMT < ZERO                              08660027
086700             INSPECT D2-PO-COST                                   08670027
086800               REPLACING ALL '-' BY '('                           08680027
086900             MOVE ')'            TO D2-PO-COST-RP                 08690027
087000         ELSE                                                     08700027
087100             MOVE ' '            TO D2-PO-COST-RP                 08710027
087200         END-IF                                                   08720027
087300     END-IF.                                                      08730027
087400                                                                  08740065
087500     MOVE AP036-EST-COST-AMT     TO D2-ELC-COST.                  08750027
087600                                                                  08760065
087700     IF AP036-EST-COST-AMT < ZERO                                 08770027
087800         INSPECT D2-ELC-COST                                      08780027
087900           REPLACING ALL '-' BY '('                               08790027
088000         MOVE ')'                TO D2-ELC-COST-RP                08800027
088100     ELSE                                                         08810027
088200         MOVE ' '                TO D2-ELC-COST-RP                08820027
088300     END-IF.                                                      08830027
088400                                                                  08840068
088500     MOVE AP036-EST-UNT-COST     TO D2-ELC-COST-UNIT.             08850027
088600                                                                  08860068
088700     IF AP036-EST-UNT-COST < ZERO                                 08870027
088800         INSPECT D2-ELC-COST-UNIT                                 08880027
088900           REPLACING ALL '-' BY '('                               08890027
089000         MOVE ')'                TO D2-ELC-COST-UNIT-RP           08900027
089100     ELSE                                                         08910027
089200         MOVE ' '                TO D2-ELC-COST-UNIT-RP           08920027
089300     END-IF.                                                      08930027
089400                                                                  08940027
089500     IF AP036-PO-COST-AMT > ZEROES                                08950027
089600         COMPUTE PV-PO-ELC-COST-AMT =                             08960027
089700            ( AP036-PO-COST-AMT - AP036-EST-COST-AMT )            08970027
089800         MOVE PV-PO-ELC-COST-AMT TO D2-PO-ELC-VAR                 08980027
089900         IF PV-PO-ELC-COST-AMT < ZERO                             08990027
090000             INSPECT D2-PO-ELC-VAR                                09000027
090100               REPLACING ALL '-' BY '('                           09010027
090200             MOVE ')'            TO D2-PO-ELC-VAR-RP              09020027
090300         ELSE                                                     09030027
090400             MOVE ' '            TO D2-PO-ELC-VAR-RP              09040027
090500         END-IF                                                   09050027
090600     ELSE                                                         09060027
090700         MOVE ZEROES             TO PV-PO-ELC-COST-AMT            09070027
090800         MOVE SPACES             TO D2-PO-ELC-VAR-ALPHA           09080027
090900     END-IF.                                                      09090027
091000                                                                  09100027
091100     MOVE AP036-RCV-COST-AMT     TO D2-RCV-COST.                  09110027
091200                                                                  09120068
091300     IF AP036-RCV-COST-AMT < ZERO                                 09130027
091400         INSPECT D2-RCV-COST                                      09140027
091500           REPLACING ALL '-' BY '('                               09150027
091600         MOVE ')'                TO D2-RCV-COST-RP                09160027
091700     ELSE                                                         09170027
091800         MOVE ' '                TO D2-RCV-COST-RP                09180027
091900     END-IF.                                                      09190027
092000                                                                  09200027
092100     MOVE AP036-INV-COST-AMT     TO D2-INV-COST.                  09210027
092200                                                                  09220065
092300     IF AP036-INV-COST-AMT < ZERO                                 09230027
092400         INSPECT D2-INV-COST                                      09240027
092500           REPLACING ALL '-' BY '('                               09250027
092600         MOVE ')'                TO D2-INV-COST-RP                09260027
092700     ELSE                                                         09270027
092800         MOVE ' '                TO D2-INV-COST-RP                09280027
092900     END-IF.                                                      09290027
093000                                                                  09300027
093100     MOVE AP036-INV-UNT-COST     TO D2-INV-COST-UNIT.             09310027
093200                                                                  09320065
093300     IF AP036-INV-UNT-COST < ZERO                                 09330027
093400         INSPECT D2-INV-COST-UNIT                                 09340027
093500           REPLACING ALL '-' BY '('                               09350027
093600         MOVE ')'                TO D2-INV-COST-UNIT-RP           09360027
093700     ELSE                                                         09370027
093800         MOVE ' '                TO D2-INV-COST-UNIT-RP           09380027
093900     END-IF.                                                      09390027
094000                                                                  09400027
094100     MOVE AP036-INV-PCT-TO-FC    TO D2-PCT-TO-FC.                 09410027
094200                                                                  09420065
094300     IF AP036-INV-PCT-TO-FC < ZERO                                09430027
094400         INSPECT D2-PCT-TO-FC                                     09440035
094500           REPLACING ALL '-' BY '('                               09450027
094600         MOVE ')'                TO D2-PCT-TO-FC-RP               09460027
094700     ELSE                                                         09470027
094800         MOVE ' '                TO D2-PCT-TO-FC-RP               09480027
094900     END-IF.                                                      09490027
095000                                                                  09500027
095100     MOVE AP036-INV-PCT-TO-LC    TO D2-PCT-TO-LC.                 09510027
095200                                                                  09520065
095300     IF AP036-INV-PCT-TO-LC < ZERO                                09530027
095400         INSPECT D2-PCT-TO-LC                                     09540027
095500           REPLACING ALL '-' BY '('                               09550027
095600         MOVE ')'                TO D2-PCT-TO-LC-RP               09560027
095700     ELSE                                                         09570027
095800         MOVE ' '                TO D2-PCT-TO-LC-RP               09580027
095900     END-IF.                                                      09590027
096000                                                                  09600027
096100     COMPUTE PV-INV-RCV-COST-AMT =                                09610027
096200        ( AP036-INV-COST-AMT - AP036-RCV-COST-AMT ).              09620027
096300                                                                  09630065
096400     ADD PV-INV-RCV-COST-AMT     TO PV-LC-INV-RCV-AMT.            09640027
096500                                                                  09650065
096600     MOVE PV-INV-RCV-COST-AMT    TO D2-INV-RCV-VAR.               09660027
096700                                                                  09670065
096800     IF PV-INV-RCV-COST-AMT < ZERO                                09680027
096900         INSPECT D2-INV-RCV-VAR                                   09690027
097000           REPLACING ALL '-' BY '('                               09700027
097100         MOVE ')'                TO D2-INV-RCV-VAR-RP             09710027
097200     ELSE                                                         09720027
097300         MOVE ' '                TO D2-INV-RCV-VAR-RP             09730027
097400     END-IF.                                                      09740027
097500                                                                  09750027
097600     IF AP036-INV-COST-AMT NOT = ZEROES                           09760045
097700         COMPUTE PV-INV-RCV-VAR-PCT = ( ( PV-INV-RCV-COST-AMT     09770045
097800            / AP036-INV-COST-AMT ) * 100 ) + .005                 09780045
097900     ELSE                                                         09790045
098000         IF PV-INV-RCV-COST-AMT = ZEROES                          09800045
098100             MOVE ZEROES         TO PV-INV-RCV-VAR-PCT            09810045
098200         ELSE                                                     09820045
098300             IF PV-INV-RCV-COST-AMT < ZEROES                      09830045
098400                 MOVE -100.00000 TO PV-INV-RCV-VAR-PCT            09840045
098500             ELSE                                                 09850045
098600                 MOVE 100.00000  TO PV-INV-RCV-VAR-PCT            09860045
098700             END-IF                                               09870045
098800         END-IF                                                   09880045
098900     END-IF.                                                      09890045
099000                                                                  09900065
099100     MOVE PV-INV-RCV-VAR-PCT     TO D2-PCT-VAR.                   09910027
099200     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            09920027
099300                                                                  09930027
099400*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *09940035
099500*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *09950036
099600                                                                  09960065
099700     MOVE D2-DETAIL2             TO REPORT-REC.                   09970027
099800     MOVE +1                     TO PV-LINE-SKIP.                 09980027
099900                                                                  09990027
100000     EJECT                                                        10000065
100100                                                                  10010027
100200 C250-PROCESS-TOTAL-LC.                                           10020027
100300                                                                  10030065
100400*----------------------------------------------------------------*10040027
100500* PROCESS THE 'TOT' RECORD (LANDED COST) HERE                    *10050035
100600*                                                                *10060035
100700*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *10070035
100800*    - FORMAT DATA TO DETAIL REPORT LINE.                        *10080035
100900*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10090035
101000*    - COMPUTE ESTIMATED LANDED COST VARIANCE.                   *10100035
101100*    - COMPUTE INVOICE RECEIVING VARIANCE PERCENT.               *10110035
101200*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *10120035
101300*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *10130036
101400*----------------------------------------------------------------*10140027
101500                                                                  10150027
101600*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *10160035
101700*    MOVE SPACES                 TO H7-DASH4   H7-DASH7           10170061
101800                                                                  10180065
101900     MOVE SPACES                 TO                               10190061
102000             H7-DASH6   H7-DASH2    H7-DASH8   H7-DASH9           10200027
102100                                    H7-DASH5   H7-DASH10.         10210027
102200                                                                  10220065
102300     MOVE H7-DASHLINE            TO REPORT-REC.                   10230027
102400                                                                  10240065
102500     MOVE +1                     TO PV-LINE-SKIP.                 10250027
102600                                                                  10260065
102700     PERFORM W300-PRINT-DETAIL.                                   10270027
102800                                                                  10280027
102900*    - FORMAT DATA TO DETAIL REPORT LINE.                        *10290035
103000*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10300035
103100                                                                  10310061
103200     IF AP036-PO-COST-AMT = ZEROES                                10320027
103300         MOVE SPACES             TO D2-PO-COST-ALPHA              10330027
103400     ELSE                                                         10340027
103500         MOVE AP036-PO-COST-AMT  TO D2-PO-COST                    10350027
103600         IF AP036-PO-COST-AMT < ZERO                              10360027
103700             INSPECT D2-PO-COST                                   10370027
103800               REPLACING ALL '-' BY '('                           10380027
103900             MOVE ')'            TO D2-PO-COST-RP                 10390027
104000         ELSE                                                     10400027
104100             MOVE ' '            TO D2-PO-COST-RP                 10410027
104200         END-IF                                                   10420027
104300     END-IF.                                                      10430027
104400                                                                  10440061
104500     MOVE AP036-EST-COST-AMT     TO D2-ELC-COST.                  10450027
104600                                                                  10460065
104700     IF AP036-EST-COST-AMT < ZERO                                 10470027
104800         INSPECT D2-ELC-COST                                      10480027
104900           REPLACING ALL '-' BY '('                               10490027
105000         MOVE ')'                TO D2-ELC-COST-RP                10500027
105100     ELSE                                                         10510027
105200         MOVE ' '                TO D2-ELC-COST-RP                10520027
105300     END-IF.                                                      10530027
105400                                                                  10540027
105500     MOVE SPACES                 TO D2-ELC-COST-UNIT-ALPHA.       10550027
105600                                                                  10560027
105700     MOVE AP036-EST-UNT-COST     TO D2-ELC-COST-UNIT.             10570061
105800     ADD  AP036-EST-UNT-COST     TO PV-EST-UNT-COST.              10580061
105900                                                                  10590065
106000     IF AP036-EST-UNT-COST < ZERO                                 10600061
106100         INSPECT D2-ELC-COST-UNIT                                 10610061
106200           REPLACING ALL '-' BY '('                               10620061
106300         MOVE ')'                TO D2-ELC-COST-UNIT-RP           10630061
106400     ELSE                                                         10640061
106500         MOVE ' '                TO D2-ELC-COST-UNIT-RP           10650061
106600     END-IF.                                                      10660061
106700                                                                  10670061
106800*    - COMPUTE ESTIMATED LANDED COST VARIANCE.                   *10680035
106900                                                                  10690065
107000     IF AP036-PO-COST-AMT > ZEROES                                10700027
107100         COMPUTE PV-PO-ELC-COST-AMT =                             10710027
107200            ( AP036-PO-COST-AMT - AP036-EST-COST-AMT )            10720027
107300         MOVE PV-PO-ELC-COST-AMT TO D2-PO-ELC-VAR                 10730027
107400         IF PV-PO-ELC-COST-AMT < ZERO                             10740027
107500             INSPECT D2-PO-ELC-VAR                                10750027
107600               REPLACING ALL '-' BY '('                           10760027
107700             MOVE ')'            TO D2-PO-ELC-VAR-RP              10770027
107800         ELSE                                                     10780027
107900             MOVE ' '            TO D2-PO-ELC-VAR-RP              10790027
108000         END-IF                                                   10800027
108100     ELSE                                                         10810027
108200         MOVE ZEROES             TO PV-PO-ELC-COST-AMT            10820027
108300         MOVE SPACES             TO D2-PO-ELC-VAR-ALPHA           10830027
108400     END-IF.                                                      10840027
108500                                                                  10850027
108600     MOVE AP036-RCV-COST-AMT     TO D2-RCV-COST.                  10860027
108700                                                                  10870065
108800     IF AP036-RCV-COST-AMT < ZERO                                 10880027
108900         INSPECT D2-RCV-COST                                      10890027
109000           REPLACING ALL '-' BY '('                               10900027
109100         MOVE ')'                TO D2-RCV-COST-RP                10910027
109200     ELSE                                                         10920027
109300         MOVE ' '                TO D2-RCV-COST-RP                10930027
109400     END-IF.                                                      10940027
109500                                                                  10950065
109600     MOVE AP036-INV-COST-AMT     TO D2-INV-COST                   10960027
109700                                    PV-PO-INV-COST-AMT.           10970027
109800                                                                  10980065
109900     IF AP036-INV-COST-AMT < ZERO                                 10990027
110000         INSPECT D2-INV-COST                                      11000027
110100           REPLACING ALL '-' BY '('                               11010027
110200         MOVE ')'                TO D2-INV-COST-RP                11020027
110300     ELSE                                                         11030027
110400         MOVE ' '                TO D2-INV-COST-RP                11040027
110500     END-IF.                                                      11050027
110600                                                                  11060027
110700     MOVE SPACES                 TO D2-INV-COST-UNIT-ALPHA.       11070063
110800                                                                  11080063
110900     MOVE AP036-INV-UNT-COST     TO D2-INV-COST-UNIT.             11090061
111000     ADD  AP036-INV-UNT-COST     TO PV-INV-UNT-COST.              11100061
111100                                                                  11110065
111200     IF AP036-INV-UNT-COST < ZERO                                 11120061
111300         INSPECT D2-INV-COST-UNIT                                 11130061
111400           REPLACING ALL '-' BY '('                               11140061
111500         MOVE ')'                TO D2-INV-COST-UNIT-RP           11150061
111600     ELSE                                                         11160061
111700         MOVE ' '                TO D2-INV-COST-UNIT-RP           11170061
111800     END-IF.                                                      11180061
111900                                                                  11190061
112000*    MOVE SPACES                 TO D2-INV-COST-UNIT-ALPHA        11200063
112100                                                                  11210065
112200     MOVE SPACES                 TO D2-PCT-TO-FC-ALPHA            11220063
112300                                    D2-PCT-TO-LC-ALPHA.           11230027
112400                                                                  11240027
112500     MOVE PV-LC-INV-RCV-AMT      TO D2-INV-RCV-VAR                11250027
112600                                    PV-PO-INV-RCV-AMT.            11260027
112700                                                                  11270068
112800     IF PV-LC-INV-RCV-AMT < ZERO                                  11280027
112900         INSPECT D2-INV-RCV-VAR                                   11290027
113000           REPLACING ALL '-' BY '('                               11300027
113100         MOVE ')'                TO D2-INV-RCV-VAR-RP             11310027
113200     ELSE                                                         11320027
113300         MOVE ' '                TO D2-INV-RCV-VAR-RP             11330027
113400     END-IF.                                                      11340027
113500                                                                  11350027
113600*    - COMPUTE INVOICE RECEIVING VARIANCE PERCENT.               *11360035
113700                                                                  11370065
113800     IF AP036-INV-COST-AMT NOT = ZEROES                           11380045
113900         COMPUTE PV-INV-RCV-VAR-PCT = ( ( PV-LC-INV-RCV-AMT       11390027
114000            / AP036-INV-COST-AMT ) * 100 ) + .005                 11400027
114100     ELSE                                                         11410027
114200         IF PV-LC-INV-RCV-AMT = ZEROES                            11420045
114300             MOVE ZEROES         TO PV-INV-RCV-VAR-PCT            11430045
114400         ELSE                                                     11440044
114500             IF PV-LC-INV-RCV-AMT < ZEROES                        11450045
114600                 MOVE -100.00000 TO PV-INV-RCV-VAR-PCT            11460045
114700             ELSE                                                 11470045
114800                 MOVE 100.00000  TO PV-INV-RCV-VAR-PCT            11480045
114900             END-IF                                               11490045
115000         END-IF                                                   11500045
115100     END-IF.                                                      11510044
115200                                                                  11520065
115300     MOVE PV-INV-RCV-VAR-PCT     TO D2-PCT-VAR.                   11530027
115400     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            11540027
115500                                                                  11550027
115600*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *11560035
115700*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *11570036
115800                                                                  11580065
115900     MOVE D2-DETAIL2             TO REPORT-REC.                   11590027
116000     MOVE +1                     TO PV-LINE-SKIP.                 11600027
116100                                                                  11610027
116200     MOVE ZEROES                 TO PV-LC-INV-RCV-AMT.            11620027
116300                                                                  11630027
116400     EJECT                                                        11640065
116500                                                                  11650027
116600 C300-PROCESS-LCL.                                                11660027
116700                                                                  11670065
116800*----------------------------------------------------------------*11680027
116900* PROCESS THE LCL RECORD HERE                                     11690027
117000*                                                                *11700035
117100*    - FORMAT DATA TO DETAIL REPORT LINE.                        *11710035
117200*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *11720036
117300*    - MOVE THE DETAIL LINE TO THE REPORT RECORD AND PRINT.      *11730036
117400*                                                                *11740036
117500*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *11750036
117600*                                                                *11760036
117700*    - FORMAT PO TOTAL DATA TO DETAIL REPORT LINE.               *11770036
117800*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *11780036
117900*    - COMPUTE INVOICE COST AND INVOICE RECEIVING VARIANCE.      *11790036
118000*    - MOVE THE TOTAL LINE TO THE REPORT RECORD.                 *11800036
118100*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *11810036
118200*----------------------------------------------------------------*11820035
118300                                                                  11830027
118400*    - FORMAT DATA TO DETAIL REPORT LINE.                        *11840036
118500*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *11850036
118600                                                                  11860065
118700     MOVE SPACES                 TO D2-PO-COST-ALPHA              11870027
118800                                    D2-ELC-COST-ALPHA             11880027
118900                                    D2-ELC-COST-UNIT-ALPHA        11890027
119000                                    D2-PO-ELC-VAR-ALPHA           11900027
119100                                    D2-RCV-COST-ALPHA             11910027
119200                                    D2-INV-COST-UNIT-ALPHA        11920027
119300                                    D2-PCT-TO-FC-ALPHA            11930027
119400                                    D2-PCT-VAR-ALPHA.             11940027
119500                                                                  11950027
119600     MOVE AP036-INV-COST-AMT     TO D2-INV-COST                   11960027
119700                                    D2-INV-RCV-VAR.               11970027
119800                                                                  11980065
119900     IF AP036-INV-COST-AMT < ZERO                                 11990027
120000         INSPECT D2-INV-COST                                      12000027
120100           REPLACING ALL '-' BY '('                               12010027
120200         INSPECT D2-INV-RCV-VAR                                   12020027
120300           REPLACING ALL '-' BY '('                               12030027
120400         MOVE ')'                TO D2-INV-COST-RP                12040027
120500                                    D2-INV-RCV-VAR-RP             12050027
120600     ELSE                                                         12060027
120700         MOVE ' '                TO D2-INV-COST-RP                12070027
120800                                    D2-INV-RCV-VAR-RP             12080027
120900     END-IF.                                                      12090027
121000                                                                  12100027
121100     MOVE AP036-INV-PCT-TO-LC    TO D2-PCT-TO-LC.                 12110027
121200                                                                  12120065
121300     IF AP036-INV-PCT-TO-LC < ZERO                                12130027
121400         INSPECT D2-PCT-TO-LC                                     12140027
121500           REPLACING ALL '-' BY '('                               12150027
121600         MOVE ')'                TO D2-PCT-TO-LC-RP               12160027
121700     ELSE                                                         12170027
121800         MOVE ' '                TO D2-PCT-TO-LC-RP               12180027
121900     END-IF.                                                      12190027
122000                                                                  12200027
122100*    - MOVE THE DETAIL LINE TO THE REPORT RECORD AND PRINT.      *12210036
122200                                                                  12220065
122300     MOVE D2-DETAIL2             TO REPORT-REC.                   12230027
122400     MOVE +2                     TO PV-LINE-SKIP.                 12240027
122500                                                                  12250065
122600     PERFORM W300-PRINT-DETAIL.                                   12260027
122700                                                                  12270027
122800*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *12280036
122900                                                                  12290065
123000     MOVE SPACES                 TO H7-DASH1                      12300027
123100         H7-DASH3                                                 12310027
123200              H7-DASH2   H7-DASH4   H7-DASH5   H7-DASH6           12320027
123300              H7-DASH7   H7-DASH8   H7-DASH9   H7-DASH10.         12330066
123400                                                                  12340065
123500     MOVE H7-DASHLINE            TO REPORT-REC.                   12350027
123600     MOVE +1                     TO PV-LINE-SKIP.                 12360027
123700                                                                  12370065
123800     PERFORM W300-PRINT-DETAIL.                                   12380027
123900                                                                  12390027
124000                                                                  12400027
124100*    - FORMAT PO TOTAL DATA TO DETAIL REPORT LINE.               *12410036
124200*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *12420036
124300                                                                  12430065
124400     MOVE SPACES                 TO T1-COMPNT-DESC.               12440027
124500     MOVE 'TOTAL PO COST '       TO T1-COMPNT-DESC.               12450027
124600                                                                  12460027
124700     MOVE PV-EST-UNT-COST       TO T1-EST-UNT-COST.               12470062
124800                                                                  12480065
124900     IF PV-EST-UNT-COST < ZERO                                    12490061
125000         INSPECT T1-EST-UNT-COST                                  12500062
125100           REPLACING ALL '-' BY '('                               12510061
125200         MOVE ')'                TO T1-EST-UNT-COST-RP            12520061
125300     ELSE                                                         12530061
125400         MOVE ' '                TO T1-EST-UNT-COST-RP            12540061
125500     END-IF.                                                      12550061
125600                                                                  12560061
125700                                                                  12570061
125800*    - COMPUTE INVOICE COST AND INVOICE RECEIVING VARIANCE.      *12580036
125900                                                                  12590065
126000     COMPUTE PV-PO-INV-COST-AMT =                                 12600027
126100         ( PV-PO-INV-COST-AMT + AP036-INV-COST-AMT )              12610027
126200     MOVE PV-PO-INV-COST-AMT     TO T1-INV-COST.                  12620027
126300                                                                  12630065
126400     IF PV-PO-INV-COST-AMT < ZERO                                 12640027
126500         INSPECT T1-INV-COST                                      12650027
126600           REPLACING ALL '-' BY '('                               12660027
126700         MOVE ')'                TO T1-INV-COST-RP                12670027
126800     ELSE                                                         12680027
126900         MOVE ' '                TO T1-INV-COST-RP                12690027
127000     END-IF.                                                      12700027
127100                                                                  12710027
127200                                                                  12720061
127300     MOVE PV-INV-UNT-COST       TO T1-INV-UNT-COST.               12730062
127400                                                                  12740065
127500     IF PV-INV-UNT-COST < ZERO                                    12750061
127600         INSPECT T1-INV-UNT-COST                                  12760062
127700           REPLACING ALL '-' BY '('                               12770061
127800         MOVE ')'                TO T1-INV-UNT-COST-RP            12780061
127900     ELSE                                                         12790061
128000         MOVE ' '                TO T1-INV-UNT-COST-RP            12800061
128100     END-IF.                                                      12810061
128200                                                                  12820061
128300     COMPUTE PV-PO-INV-RCV-AMT =                                  12830027
128400         ( PV-PO-INV-RCV-AMT + AP036-INV-COST-AMT ).              12840027
128500                                                                  12850065
128600     MOVE PV-PO-INV-RCV-AMT      TO T1-INV-RCV-VAR.               12860027
128700                                                                  12870065
128800     IF PV-PO-INV-RCV-AMT < ZERO                                  12880027
128900         INSPECT T1-INV-RCV-VAR                                   12890027
129000           REPLACING ALL '-' BY '('                               12900027
129100         MOVE ')'                TO T1-INV-RCV-VAR-RP             12910027
129200     ELSE                                                         12920027
129300         MOVE ' '                TO T1-INV-RCV-VAR-RP             12930027
129400     END-IF.                                                      12940027
129500                                                                  12950027
129600*    - MOVE THE TOTAL LINE TO THE REPORT RECORD.                 *12960036
129700*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *12970036
129800                                                                  12980065
129900     MOVE T1-TOTAL1              TO REPORT-REC.                   12990027
130000     MOVE +2                     TO PV-LINE-SKIP.                 13000027
130100                                                                  13010027
130200     INITIALIZE PV-EST-UNT-COST                                   13020062
130300                PV-INV-UNT-COST.                                  13030062
130400                                                                  13040027
130500     EJECT                                                        13050065
130600                                                                  13060065
130700 F100-FORMAT-HEADER.                                              13070027
130800                                                                  13080065
130900*----------------------------------------------------------------*13090027
131000*    FORMAT HEADER DATA TO THE REPORT HEADINGS, DETAIL LINES.    *13100035
131100*                                                                *13110035
131200*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *13120035
131300*    - FORMAT HEADER DATA TO REPORT HEADING LINES.               *13130035
131400*    - FORMAT HEADER DATA TO DETAIL LINES.                       *13140035
131500*    - WRITE PO HEADINGS.                                        *13150035
131600*----------------------------------------------------------------*13160027
131700                                                                  13170027
131800*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *13180036
131900                                                                  13190065
132000*    IF PV-PO-PER-PAGE >= PC-PO-PER-PAGE-MAX                      13200099
132100*        PERFORM W100-WRITE-HEADINGS                              13210099
132200*    END-IF.                                                      13220099
132300                                                                  13230065
132400*    ADD +1                      TO PV-PO-PER-PAGE                13240099
132500*                                   PV-PO-PRINTED-COUNT.          13250099
132500     ADD +1                      TO PV-PO-PRINTED-COUNT.          13251099
132600                                                                  13260027
132700*    - FORMAT HEADER DATA TO REPORT HEADING LINES.               *13270036
132800                                                                  13280067
132900     MOVE AP036-VENDOR-NAME      TO H3-VENDOR-NAME.               13290027
133000     MOVE AP036-VENDOR-NBR       TO H3-VENDOR-NUMBER.             13300027
133100     MOVE PV-DEPT-NBR            TO H3-DEPT-NUMBER.               13310027
133200     MOVE PV-DEPT-DESC           TO H3-DEPT-NAME.                 13320027
133300                                                                  13330027
133400     MOVE AP036-1ST-VERFYD-DTE   TO PV-DB2-DATE.                  13340027
133500                                                                  13350067
133600     PERFORM F120-REFORMAT-DATE.                                  13360027
133700                                                                  13370067
133800     MOVE PV-DISPLAY-DATE        TO H3-1ST-VERIFIED.              13380027
133900                                                                  13390027
134000     IF AP036-PO-UNT-QTY > ZEROES                                 13400027
134100         COMPUTE PV-RCV-VAR-PCT = ( ( AP036-RCV-UNT-QTY /         13410027
134200                          AP036-PO-UNT-QTY ) * 100 ) + .005       13420027
134300     ELSE                                                         13430027
134400         MOVE ZEROES             TO PV-RCV-VAR-PCT                13440027
134500     END-IF.                                                      13450027
134600                                                                  13460067
134700     MOVE PV-RCV-VAR-PCT         TO H3-PCT-RECEIVED.              13470027
134800                                                                  13480027
134900     MOVE PV-PO-NBR-N            TO H4-PO-NUMBER.                 13490027
135000     MOVE AP036-PO-STATUS-CDE    TO H4-PO-STATUS.                 13500027
135100     MOVE PV-FOB-NAME            TO H4-FOB-POINT.                 13510027
135200                                                                  13520027
135300     IF AP036-1ST-INVC-DTE = SPACES                               13530049
135400         MOVE SPACES             TO H4-1ST-INVOICED               13540049
135500     ELSE                                                         13550049
135600         MOVE AP036-1ST-INVC-DTE TO PV-DB2-DATE                   13560049
135700         PERFORM F120-REFORMAT-DATE                               13570049
135800         MOVE PV-DISPLAY-DATE    TO H4-1ST-INVOICED               13580049
135900     END-IF.                                                      13590049
136000                                                                  13600027
136100     MOVE AP036-LAST-VERFYD-DTE  TO PV-DB2-DATE.                  13610032
136200                                                                  13620066
136300     PERFORM F120-REFORMAT-DATE.                                  13630032
136400                                                                  13640066
136500     MOVE PV-DISPLAY-DATE        TO H4-LAST-VERIFIED.             13650032
136600                                                                  13660032
136700     IF AP036-OTB-PER-NBR NOT = SPACES                            13670050
136800         PERFORM F150-PROCESS-OTB-PER                             13680027
136900     ELSE                                                         13690027
137000         MOVE SPACES             TO H4-OTB-MONTH                  13700027
137100              H4-OTB-COMMA          H4-OTB-YEAR                   13710050
137200     END-IF.                                                      13720027
137300                                                                  13730027
137400*    - FORMAT HEADER DATA TO DETAIL LINES.                       *13740036
137500                                                                  13750066
137600     MOVE AP036-PO-UNT-QTY       TO D1-PO-UNITS                   13760027
137700                                    D1-ELC-UNITS.                 13770027
137800                                                                  13780066
137900     MOVE AP036-RCV-UNT-QTY      TO D1-RCV-UNITS.                 13790027
138000     MOVE AP036-INV-UNT-QTY      TO D1-INV-UNITS.                 13800027
138100                                                                  13810066
138200     COMPUTE PV-INV-RCV-UNITS =                                   13820027
138300        ( AP036-INV-UNT-QTY - AP036-RCV-UNT-QTY ).                13830027
138400                                                                  13840066
138500     MOVE PV-INV-RCV-UNITS       TO D1-RCV-VAR-UNITS.             13850027
138600                                                                  13860045
138700     IF AP036-INV-UNT-QTY NOT = ZEROES                            13870046
138800         COMPUTE PV-INV-QTY-VAR-PCT = ( ( PV-INV-RCV-UNITS        13880027
138900            / AP036-INV-UNT-QTY ) * 100 ) + .005                  13890027
139000     ELSE                                                         13900027
139100         IF PV-INV-RCV-UNITS = ZEROES                             13910045
139200             MOVE ZEROES         TO PV-INV-QTY-VAR-PCT            13920045
139300         ELSE                                                     13930045
139400             IF PV-INV-RCV-UNITS < ZEROES                         13940045
139500                 MOVE -100.00000 TO PV-INV-QTY-VAR-PCT            13950045
139600             ELSE                                                 13960045
139700                 MOVE 100.00000  TO PV-INV-QTY-VAR-PCT            13970045
139800             END-IF                                               13980045
139900         END-IF                                                   13990045
140000     END-IF.                                                      14000044
140100                                                                  14010066
140200     MOVE PV-INV-QTY-VAR-PCT     TO D1-PCT-VAR.                   14020027
140300                                                                  14030027
140400     MOVE PC-DASH-LIT            TO H7-DASH1                      14040027
140500         H7-DASH3                                                 14050027
140600              H7-DASH2   H7-DASH4   H7-DASH5   H7-DASH6           14060027
140700              H7-DASH7   H7-DASH8   H7-DASH9   H7-DASH10.         14070066
140800                                                                  14080027
140900*    - WRITE PO HEADINGS.                                        *14090035
141000                                                                  14100066
141100     PERFORM W200-WRITE-PO-HEADINGS.                              14110027
141200                                                                  14120027
141300     EJECT                                                        14130066
141400                                                                  14140027
141500 F120-REFORMAT-DATE.                                              14150027
141600                                                                  14160066
141700*----------------------------------------------------------------*14170027
141800*    FORMAT DB2 DATES AS MM/DD/CCYY WITH CALENDAR ROUTINE.       *14180035
141900*----------------------------------------------------------------*14190027
142000                                                                  14200027
142100     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         14210027
142200                                                                  14220066
142300     ACCEPT DPG51-SYSTEM-DATE       FROM DATE.                    14230027
142400                                                                  14240027
142500     SET DPG52-LK-DTE-ISO-FMT                                     14250027
142600         DPG51-FISCAL-JAN-DEC-F2                                  14260053
142700         DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   14270027
142800                                                                  14280066
142900     MOVE PV-DB2-DATE            TO DPG52-LK-DATE-INPUT.          14290027
143000                                                                  14300027
143100     CALL DP500-KOHLS-CALENDAR-ROUTINE                            14310027
143200         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               14320027
143300                                                                  14330027
143400     IF (DPG54-SEVERE-ERROR OR                                    14340027
143500         DPG54-WARNING-ERROR)                                     14350055
143600         DISPLAY ' '                                              14360068
143700         DISPLAY '******************************************'     14370068
143800         DISPLAY 'PO NUMBER WITH BAD DATA = ' PV-PO-NBR-N         14380068
143900         DISPLAY 'PV-DB2-DATE  = ' PV-DB2-DATE                    14390027
144000         MOVE 'F120-REFORMAT-DATE   ' TO  AA-PARAGRAPH-NAME       14400027
144100         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE'              14410027
144200                                 TO AA-MESSAGE                    14420027
144300         DISPLAY '******************************************'     14430068
144400         SET AC-DPWS500-DATE-ERROR  TO TRUE                       14440027
144500         PERFORM Z999-ABEND                                       14450027
144600     ELSE                                                         14460027
144700         MOVE DPG55-GREG-CC-DATE-FMT                              14470027
144800                                 TO PV-DISPLAY-DATE               14480027
144900     END-IF.                                                      14490027
145000                                                                  14500027
145100                                                                  14510027
145200 F150-PROCESS-OTB-PER.                                            14520027
145300                                                                  14530068
145400*----------------------------------------------------------------*14540027
145500*    USING THE CALENDAR ROUTINE TO GET THE 3-CHARACTER           *14550027
145600*    ABBREVIATION.                                               *14560027
145700*----------------------------------------------------------------*14570027
145800                                                                  14580027
145900     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         14590027
146000                                                                  14600066
146100     ACCEPT DPG51-SYSTEM-DATE       FROM DATE.                    14610027
146200                                                                  14620027
146300     SET DPG52-LK-DTE-FISC-PRD-CC      TO TRUE.                   14630027
146400     SET DPG51-FISCAL-JAN-DEC-F2       TO TRUE.                   14640051
146500     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   14650027
146600                                                                  14660027
146700     MOVE AP036-OTB-PER-NBR      TO DPG52-LK-DATE-INPUT.          14670027
146800                                                                  14680027
146900     CALL DP500-KOHLS-CALENDAR-ROUTINE                            14690027
147000         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               14700027
147100                                                                  14710027
147200     IF (DPG54-SEVERE-ERROR OR                                    14720027
147300         DPG54-WARNING-ERROR)                                     14730055
147400         DISPLAY ' '                                              14740068
147500         DISPLAY '*****************************************'      14750068
147600         DISPLAY 'PO NUMBER WITH BAD DATA = ' PV-PO-NBR-N         14760068
147700         DISPLAY 'AP036-OTB-PER-NBR = ' AP036-OTB-PER-NBR         14770027
147800         MOVE 'F150-PROCESS-OTB-PER ' TO  AA-PARAGRAPH-NAME       14780027
147900         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE'              14790027
148000                                    TO AA-MESSAGE                 14800027
148100         DISPLAY '*****************************************'      14810068
148200         SET AC-DPWS500-DATE-ERROR  TO TRUE                       14820027
148300         PERFORM Z999-ABEND                                       14830027
148400     ELSE                                                         14840027
148500         MOVE DPG56-FISCAL-PERIOD-NAME-ABBR3                      14850027
148600                                 TO H4-OTB-MONTH                  14860027
148700         MOVE ', '               TO H4-OTB-COMMA                  14870050
148800         MOVE AP036-OTB-PER-NBR  TO H4-OTB-YEAR                   14880027
148900     END-IF.                                                      14890027
149000                                                                  14900027
149100     EJECT                                                        14910066
149200                                                                  14920027
149300 R100-READ-INPUT.                                                 14930027
149400                                                                  14940066
149500*----------------------------------------------------------------*14950027
149600*  READ IMPORT FILE.                                             *14960036
149700*----------------------------------------------------------------*14970027
149800                                                                  14980027
149900     READ IMPORT-REPORT-FILE INTO AP036-IMPORT-REPORT-RECORD      14990033
150000         AT END                                                   15000027
150100             SET PS-PO-EOF TO TRUE.                               15010027
150200                                                                  15020027
150300     IF PS-PO-NOT-EOF                                             15030034
150400         ADD 1                   TO PV-READ-COUNT                 15040027
150500         IF AP036-HEADER                                          15050027
150600             ADD 1               TO PV-PO-READ-COUNT              15060027
150700         END-IF                                                   15070027
150800         IF AP036-HEADER                                          15080067
150900             IF PS-PO-FIRST-READ-YES                              15090067
151000                 SET PS-PO-FIRST-READ-NO TO TRUE                  15100067
151100                 IF AP036-OTB-RCVING-RPT                          15110086
151200****------>  BREAK LOGIC ON OTB PERIOD FOR THIS REPORT            15120087
151300                    MOVE AP036-OTB-PER-NBR TO                     15130086
151400                         PV-AP036-OTB-PER-HOLD                    15140086
151500                 ELSE                                             15150086
151600                    MOVE AP036-VENDOR-NAME TO                     15160086
151700                         PV-AP036-VENDOR-NAME-HOLD                15170086
151800                 END-IF                                           15180086
151900             END-IF                                               15190086
152000         END-IF                                                   15200067
152100     END-IF.                                                      15210066
152200                                                                  15220066
152300     EJECT                                                        15230066
152400                                                                  15240027
152500 S100-GET-FOB-NAME.                                               15250027
152600                                                                  15260066
152700*----------------------------------------------------------------*15270027
152800*   RETRIEVES THE FOB NAME FOR THE PO BEING PROCESSED             15280027
152900*----------------------------------------------------------------*15290027
153000                                                                  15300027
153100     INITIALIZE  DCLTIMFOB.                                       15310027
153200                                                                  15320027
153300     PERFORM WITH TEST AFTER                                      15330027
153400             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 15340027
153500             UNTIL   PV-RETRY-COUNTER > 3  OR                     15350027
153600                     SQLCODE = ZERO OR                            15360027
153700                     SQLCODE = +100                               15370027
153800                                                                  15380027
153900         EXEC SQL                                                 15390027
154000             SELECT FOB_CTY_NM                                    15400027
154100             INTO   :IMFOB-FOB-CTY-NM                             15410027
154200             FROM   TIMFOB                                        15420027
154300             WHERE  FOB_CDE    =  :PV-FOB-CDE                     15430027
154400         END-EXEC                                                 15440027
154500                                                                  15450027
154600         EVALUATE TRUE                                            15460027
154700           WHEN SQLCODE = ZERO                                    15470027
154800             MOVE IMFOB-FOB-CTY-NM TO PV-FOB-NAME                 15480027
154900                                                                  15490027
155000           WHEN SQLCODE = +100                                    15500027
155100             MOVE 'NO CITY NAME FOUND '                           15510027
155200                                 TO PV-FOB-NAME                   15520027
155300                                                                  15530027
155400           WHEN SQLWARN0 NOT = SPACES                             15540027
155500           WHEN SQLCODE NOT  = ZERO                               15550027
155600             DISPLAY 'PO NUMBER: ' PV-PO-NBR-N                    15560050
155700             DISPLAY 'FOB CODE: ' PV-FOB-CDE                      15570027
155800             MOVE 'S100-GET-FOB-NAME'                             15580027
155900                                 TO AA-PARAGRAPH-NAME             15590027
156000             MOVE 'UNSUCCESSFUL SELECT'                           15600027
156100                                 TO AA-DB2-OPERATION              15610027
156200             MOVE 'TIMFOB'       TO AA-DB2-TABLE-1                15620027
156300             INITIALIZE             AA-DB2-TABLE-2                15630027
156400                                    AA-DB2-TABLE-3                15640027
156500             PERFORM Z999-DB2-ABEND                               15650027
156600         END-EVALUATE                                             15660027
156700     END-PERFORM.                                                 15670027
156800                                                                  15680027
156900     IF PV-RETRY-COUNTER > 3                                      15690027
157000         MOVE 'S100-GET-FOB-NAME'                                 15700027
157100                                 TO AA-PARAGRAPH-NAME             15710027
157200         MOVE 'MAX RETRIES EXCEEDED ON SELECT IMFOB'              15720027
157300                                 TO AA-DB2-OPERATION              15730027
157400         PERFORM Z999-DB2-ABEND                                   15740027
157500     END-IF.                                                      15750027
157600                                                                  15760027
157700     EJECT                                                        15770066
157800                                                                  15780027
157900 S200-GET-DEPT-DESC.                                              15790027
158000                                                                  15800066
158100*----------------------------------------------------------------*15810027
158200*   RETRIEVES THE DEPT NAME FOR THE PO BEING PROCESSED            15820027
158300*----------------------------------------------------------------*15830027
158400                                                                  15840027
158500     INITIALIZE DCLTMDSEAR.                                       15850027
158600                                                                  15860027
158700     PERFORM WITH TEST AFTER                                      15870027
158800             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 15880027
158900             UNTIL   PV-RETRY-COUNTER > 3  OR                     15890027
159000                     SQLCODE = ZERO OR                            15900027
159100                     SQLCODE = +100                               15910027
159200                                                                  15920027
159300         EXEC SQL                                                 15930027
159400             SELECT MDSEAR_DESC                                   15940027
159500             INTO   :MDSEAR-DESC                                  15950027
159600             FROM   TMDSEAR                                       15960027
159700             WHERE  DEPT_NBR   =  :PV-DEPT-NBR                    15970027
159800             AND   MDSELV_CDE   = 'DPT'                           15980027
159900             AND   STRT_DTE    <= CURRENT DATE                    15990027
160000             AND   END_DTE     >= CURRENT DATE                    16000027
160100         END-EXEC                                                 16010027
160200                                                                  16020027
160300         EVALUATE TRUE                                            16030027
160400           WHEN SQLCODE = ZERO                                    16040027
160500             MOVE MDSEAR-DESC    TO PV-DEPT-DESC                  16050027
160600                                                                  16060027
160700           WHEN SQLCODE = +100                                    16070027
160800             MOVE 'NO DEPT DESC FOUND '                           16080027
160900                                 TO PV-DEPT-DESC                  16090027
161000                                                                  16100027
161100           WHEN SQLWARN0 NOT = SPACES                             16110027
161200           WHEN SQLCODE NOT  = ZERO                               16120027
161300             DISPLAY 'PO NUMBER: ' PV-PO-NBR-N                    16130050
161400             DISPLAY 'DEPT NBR: ' PV-DEPT-NBR                     16140027
161500             MOVE 'S200-GET-DEPT-DESC'                            16150027
161600                                 TO AA-PARAGRAPH-NAME             16160027
161700             MOVE 'UNSUCCESSFUL SELECT'                           16170027
161800                                 TO AA-DB2-OPERATION              16180027
161900             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                16190027
162000             INITIALIZE             AA-DB2-TABLE-2                16200027
162100                                    AA-DB2-TABLE-3                16210027
162200             PERFORM Z999-DB2-ABEND                               16220027
162300         END-EVALUATE                                             16230027
162400     END-PERFORM.                                                 16240027
162500                                                                  16250027
162600     IF PV-RETRY-COUNTER > 3                                      16260027
162700         MOVE 'S200-GET-DEPT-DESC            '                    16270027
162800                                 TO AA-PARAGRAPH-NAME             16280027
162900         MOVE 'MAX RETRIES EXCEEDED ON SELECT MDSEAR'             16290027
163000                                 TO AA-DB2-OPERATION              16300027
163100         PERFORM Z999-DB2-ABEND                                   16310027
163200     END-IF.                                                      16320027
163300                                                                  16330027
163400     EJECT                                                        16340066
163500                                                                  16350027
163600 W100-WRITE-HEADINGS.                                             16360027
163700                                                                  16370066
163800*----------------------------------------------------------------*16380027
163900*  WRITE PAGE HEADING LINES.                                     *16390035
164000*----------------------------------------------------------------*16400027
164100                                                                  16410027
164200     ADD +1                      TO PV-PAGE-COUNT.                16420027
164300     MOVE PV-PAGE-COUNT          TO DP200O-PAGE-NUMBER            16430027
164400                                                                  16440027
164500* HEADING LINE 1 (STANDARD)                                       16450027
164600                                                                  16460066
164700     WRITE REPORT-REC FROM DP200O-STANDRD-HEADER-200-COLS         16470027
164800       AFTER ADVANCING PAGE.                                      16480027
164900                                                                  16490027
165000     WRITE REPORT-REC FROM H2-HEADER2                             16500027
165100       AFTER ADVANCING +1 LINES.                                  16510027
165200                                                                  16520066
165300*    MOVE ZEROES                 TO PV-PO-PER-PAGE.               16530099
165400                                                                  16540027
165500     EJECT                                                        16550066
165600                                                                  16560027
165700 W200-WRITE-PO-HEADINGS.                                          16570035
165800                                                                  16580066
165900*----------------------------------------------------------------*16590027
166000*    WRITE PO HEADINGS.                                          *16600035
166100*                                                                *16610035
166200*    - WRITE PO HEADINGS.                                        *16620035
166300*    - WRITE FIRST DETAIL LINE WITH HEADER RECORD DATA.          *16630036
166400*----------------------------------------------------------------*16640027
166500                                                                  16650027
166600     WRITE REPORT-REC FROM H3-HEADER3                             16660027
166700       AFTER ADVANCING +2 LINES.                                  16670027
166800                                                                  16680066
166900     WRITE REPORT-REC FROM H4-HEADER4                             16690027
167000       AFTER ADVANCING +1 LINES.                                  16700027
167100                                                                  16710027
167200     WRITE REPORT-REC FROM H5-HEADER5                             16720027
167300       AFTER ADVANCING +3 LINES.                                  16730027
167400                                                                  16740066
167500     WRITE REPORT-REC FROM H6-HEADER6                             16750027
167600       AFTER ADVANCING +1 LINES.                                  16760027
167700                                                                  16770066
167800     WRITE REPORT-REC FROM H7-DASHLINE                            16780027
167900       AFTER ADVANCING +1 LINES.                                  16790027
168000                                                                  16800027
168100*    - WRITE FIRST DETAIL LINE WITH HEADER RECORD DATA.           16810036
168200                                                                  16820066
168300     WRITE REPORT-REC FROM D1-DETAIL1                             16830027
168400       AFTER ADVANCING +2 LINES.                                  16840027
168500                                                                  16850027
168600     MOVE SPACES                 TO H7-DASH1.                     16860027
168700                                                                  16870066
168800     WRITE REPORT-REC FROM H7-DASHLINE                            16880027
168900       AFTER ADVANCING +2 LINES.                                  16890027
169000                                                                  16900027
073500     ADD 1 TO PV-ON-PAGE.                                         16901099
169100     EJECT                                                        16910066
169200                                                                  16920027
169300 W300-PRINT-DETAIL.                                               16930027
169400                                                                  16940066
169500*----------------------------------------------------------------*16950027
169600*  PRINTS PO DETAIL LINES.                                        16960036
169700*----------------------------------------------------------------*16970027
169800                                                                  16980027
169900     WRITE REPORT-REC                                             16990027
170000       AFTER ADVANCING PV-LINE-SKIP LINES.                        17000027
170100                                                                  17010027
170200     INITIALIZE REPORT-REC.                                       17020027
170300                                                                  17030027
170400     EJECT                                                        17040066
170500                                                                  17050027
170600 Z999-DB2-ABEND.                                                  17060027
170700                                                                  17070066
170800*----------------------------------------------------------------*17080027
170900*    ABEND ROUTINE                                               *17090027
171000*----------------------------------------------------------------*17100027
171100                                                                  17110027
171200     CLOSE IMPORT-REPORT-FILE                                     17120027
171300           REPORT-FILE.                                           17130027
171400                                                                  17140066
171500     DISPLAY AA-ABEND-LIT.                                        17150027
171600                                                                  17160066
171700     DISPLAY AA-MESSAGE-LINE.                                     17170027
171800                                                                  17180066
171900     DISPLAY AA-DB2-ERROR-LIT.                                    17190027
172000                                                                  17200066
172100     DISPLAY AA-PROGRAM-LIT.                                      17210027
172200                                                                  17220066
172300     DISPLAY AA-PARAGRAPH-LIT.                                    17230027
172400                                                                  17240066
172500     DISPLAY AA-DB2-OPERATION-LIT.                                17250027
172600                                                                  17260066
172700     DISPLAY AA-DB2-TABLE-1.                                      17270027
172800                                                                  17280066
172900     DISPLAY AA-DB2-TABLE-2.                                      17290027
173000                                                                  17300066
173100     DISPLAY AA-DB2-TABLE-3.                                      17310027
173200                                                                  17320066
173300     SET AC-DB2-ERROR TO TRUE.                                    17330027
173400                                                                  17340027
173500     COPY DPPD004.                                                17350027
173600                                                                  17360027
173700     CALL 'ILBOABN0' USING ABEND-CODE.                            17370027
173800                                                                  17380027
173900                                                                  17390027
174000 Z999-ABEND.                                                      17400027
174100                                                                  17410066
174200*----------------------------------------------------------------*17420027
174300*    ABEND ROUTINE                                               *17430027
174400*----------------------------------------------------------------*17440027
174500                                                                  17450039
174600     CLOSE IMPORT-REPORT-FILE                                     17460027
174700           REPORT-FILE.                                           17470027
174800                                                                  17480066
174900     DISPLAY AA-ABEND-LIT.                                        17490027
175000                                                                  17500066
175100     DISPLAY AA-PROGRAM-LIT.                                      17510027
175200                                                                  17520066
175300     DISPLAY AA-PARAGRAPH-LIT.                                    17530027
175400                                                                  17540066
175500     DISPLAY AA-MESSAGE-LINE.                                     17550027
175600                                                                  17560027
175700     CALL 'ILBOABN0' USING ABEND-CODE.                            17570027
175800                                                                  17580066
175900*                                                                 17590066
176000******************************************************************17600066
