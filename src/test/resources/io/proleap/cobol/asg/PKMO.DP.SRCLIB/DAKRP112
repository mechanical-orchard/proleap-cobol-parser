       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.           DAKRP112.                                  00030000
       AUTHOR.               JILL LIN.                                  00040000
       INSTALLATION.         KOHLS DEPARTMENT STORES.                   00050000
       DATE-WRITTEN.         MAY 2006.                                  00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ***************************************************************** 00090000
      *  PROGRAM NARRATIVE:                                           * 00100000
      *  THIS PROGRAM READS AN EXTRACT CREATED FROM DAKUT313 AND      * 00110000
      *  CREATES A REPORT OF DEBIT ALLOWANCE AVAILABLE VENDOR FUNDING * 00120000
      *  REMAINING AVAILABLE COST DOLLAR BALANCES FOR CURRENT AND     * 00120100
      *  PREVIOUS FISCAL QUARTER. THIS PROGRAM RUNS DAILY.            * 00120200
      ***************************************************************** 00120300
      *                                                               * 00120400
      *    WR/PITS#     DATE        DESCRIPTION                       * 00120500
      *    --------   ----------   ---------------------------------  * 00120600
      ***************************************************************** 00120700
      *                                                                 00120800
       ENVIRONMENT DIVISION.                                            00120900
                                                                        00121000
       CONFIGURATION SECTION.                                           00122000
                                                                        00123000
       SOURCE-COMPUTER.                        IBM-3090.                00124000
       OBJECT-COMPUTER.                        IBM-3090.                00125000
                                                                        00126000
       INPUT-OUTPUT SECTION.                                            00127000
                                                                        00128000
       FILE-CONTROL.                                                    00129000
                                                                        00130000
           SELECT  INPUT-FILE                ASSIGN TO INP01.           00140000
           SELECT  REPORT-FILE               ASSIGN TO RPT01.           00150000
                                                                        00160000
      ******************************************************************00170000
       DATA DIVISION.                                                   00180000
      ******************************************************************00190000
                                                                        00200000
       FILE SECTION.                                                    00210000
      *                                                                 00220000
       FD  INPUT-FILE                                                   00230000
           LABEL RECORDS ARE STANDARD                                   00240000
           RECORDING MODE IS F                                          00250000
           BLOCK CONTAINS 0 RECORDS.                                    00260000
       01  INPUT-FILE-REC             PIC X(165).                       00270003
                                                                        00280000
       FD  REPORT-FILE                                                  00290000
           RECORDING MODE F                                             00300000
           LABEL RECORDS OMITTED                                        00310000
           BLOCK CONTAINS  0 RECORDS.                                   00320000
       01  REPORT-RECORD.                                               00330000
           05  REPORT-LINE            PIC X(132).                       00340000
      *                                                                 00350000
       WORKING-STORAGE SECTION.                                         00360000
                                                                        00370000
       01  PA-PROGRAM-ACCUMULATORS.                                     00380000
           05  PA-LINE-NO             PIC S9(03)    COMP-3 VALUE ZEROES.00390000
           05  PA-PAGE-COUNT          PIC S9(05)    COMP-3 VALUE ZEROES.00400000
           05  PA-TOTAL-READ          PIC S9(09)    COMP-3 VALUE ZEROES.00410000
           05  PA-TTL-OFF-BALANCE     PIC S9(11)V99 COMP-3 VALUE ZEROES.00430000
           05  PA-TTL-CRRNT-VND-FUND  PIC S9(11)V99 COMP-3 VALUE ZEROES.00440000
           05  PA-TTL-PREV-VND-FUND   PIC S9(11)V99 COMP-3 VALUE ZEROES.00450000
           05  PA-GTL-OFF-BALANCE     PIC S9(11)V99 COMP-3 VALUE ZEROES.00451017
           05  PA-GTL-CRRNT-VND-FUND  PIC S9(11)V99 COMP-3 VALUE ZEROES.00452017
           05  PA-GTL-PREV-VND-FUND   PIC S9(11)V99 COMP-3 VALUE ZEROES.00453017
                                                                        00460000
       01  PC-CONSTANTS.                                                00470000
           05  PC-DAKRP112-PGM            PIC  X(08)   VALUE 'DAKRP112'.00480000
           05  PC-MAX-LINES               PIC S9(03)   VALUE 62.        00490016
           05  PC-DASH                    PIC  X(01)   VALUE '-'.       00500000
                                                                        00510000
       01  PM-PROGRAM-MESSAGES.                                         00520000
           05  PM-NO-INPUT-MSG.                                         00530000
               10 FILLER                  PIC  X(55)    VALUE SPACES.   00540000
               10 FILLER                  PIC  X(22)    VALUE           00550000
               '=====> NO INPUT <====='.                                00560000
               10 FILLER                  PIC  X(55)    VALUE SPACES.   00570000
           05  PM-END-RPT-MSG.                                          00580000
               10 FILLER                  PIC  X(52)    VALUE SPACES.   00590000
               10 FILLER                  PIC  X(27)    VALUE           00600000
               '* * *  END OF REPORT  * * *'.                           00610000
               10 FILLER                  PIC  X(53)    VALUE SPACES.   00620000
                                                                        00630000
       01  PS-SWITCHES.                                                 00640000
           05  PS-EOF-EXTRACT-SWITCH      PIC  X(01)    VALUE 'N'.      00650000
               88  PS-EOF-EXTRACT                       VALUE 'Y'.      00660000
           05  PS-FST-REC-SWITCH          PIC  X(01)    VALUE 'N'.      00670000
               88  PS-FST-REC-PROCESSED                 VALUE 'Y'.      00680000
                                                                        00690000
       01  PV-VARIABLES.                                                00700000
           05  PV-DISP-NUMBER             PIC Z,ZZZ,ZZ9.                00710000
           05  PV-HOLD-GMM                PIC X(02)     VALUE SPACES.   00720000
           05  PV-HOLD-DMM                PIC X(02)     VALUE SPACES.   00730000
           05  PV-HOLD-VND-NAME           PIC X(30)     VALUE SPACES.   00750015
           05  PV-HOLD-DEPT-NBR           PIC X(03)     VALUE SPACES.   00760000
           05  PV-TODAYS-DATE-FORMATTED.                                00761011
               10 PV-YEAR                 PIC 99        VALUE ZEROES.   00763013
               10 PV-MONTH                PIC 99        VALUE ZEROES.   00765013
               10 PV-DAY                  PIC 99        VALUE ZEROES.   00767013
       01  PV-ABEND-CODE     COMP  SYNC   PIC S9(04)    VALUE +0000.    00768021
           88  ABEND-4001-SEQUENCE-ERROR                VALUE +4001.    00769021
      ***************************************************************** 00770000
      *  KOHL'S STANDARD FIRST HEADING LINE                             00780000
      ***************************************************************** 00790000
           COPY DPWS132O.                                               00800000
                                                                        00810000
       01  H2-HEADING2.                                                 00820000
           05  FILLER                     PIC X(45) VALUE SPACES.       00830000
           05  H2-HEADING-TITLE           PIC X(42) VALUE               00840000
           'PROFIT ASSISTANCE/AD COOP FUNDING BY DMM  '.                00850000
           05  FILLER                     PIC X(45) VALUE SPACES.       00860000
                                                                        00870000
       01  H3-HEADING3.                                                 00880000
           05  FILLER                     PIC X(52) VALUE SPACES.       00890000
           05  H3-HEADING-TITLE           PIC X(29) VALUE               00900000
           'AGING OF OUTSTANDING BALANCES'.                             00910000
           05  FILLER                     PIC X(51) VALUE SPACES.       00920000
                                                                        00930000
       01  H4-HEADING4.                                                 00940000
           05  FILLER                     PIC X(02) VALUE SPACES.       00950000
           05  FILLER                     PIC X(07) VALUE 'GMM:   '.    00960016
           05  FILLER                     PIC 9(01) VALUE ZEROES.       00961016
           05  H4-GMM-NUMBER              PIC 9(02) VALUE ZEROES.       00962005
           05  FILLER                     PIC X(01) VALUE SPACE.        00980000
           05  H4-GMM-NAME                PIC X(31) VALUE SPACES.       00981020
           05  FILLER                     PIC X(88) VALUE SPACES.       01011016
       01  HH4-HOLD-HEADING4              PIC X(132) VALUE SPACES.      01030000
                                                                        01040000
       01  H5-HEADING5.                                                 01050000
           05  FILLER                     PIC X(02) VALUE SPACES.       01060000
           05  FILLER                     PIC X(07) VALUE 'DMM:   '.    01061016
           05  FILLER                     PIC 9(01) VALUE ZEROES.       01062016
           05  H5-DMM-NUMBER              PIC 9(02) VALUE ZEROES.       01072005
           05  FILLER                     PIC X(01) VALUE SPACE.        01090000
           05  H5-DMM-NAME                PIC X(31) VALUE SPACES.       01091020
           05  FILLER                     PIC X(88) VALUE SPACES.       01121016
       01  HH5-HOLD-HEADING5              PIC X(132) VALUE SPACES.      01140000
                                                                        01150000
       01  DH1-DETAIL-HEADING1.                                         01270000
           05  FILLER                     PIC X(58) VALUE SPACES.       01280000
           05  FILLER                     PIC X(17) VALUE 'OFF INVOICE'.01290019
           05  FILLER                     PIC X(04) VALUE SPACES.       01300000
           05  FILLER                     PIC X(17) VALUE 'CURRENT'.    01310019
           05  FILLER                     PIC X(04) VALUE SPACES.       01320000
           05  FILLER                     PIC X(17) VALUE 'PREVIOUS'.   01330019
           05  FILLER                     PIC X(05) VALUE SPACES.       01340019
                                                                        01350000
       01  DH2-DETAIL-HEADING2.                                         01360000
           05  FILLER                     PIC X(02) VALUE SPACES.       01370000
           05  FILLER                     PIC X(30) VALUE 'VENDOR'.     01380000
           05  FILLER                     PIC X(04) VALUE SPACES.       01390000
           05  FILLER                     PIC X(10) VALUE 'VENDOR #'.   01400000
           05  FILLER                     PIC X(04) VALUE SPACES.       01410000
           05  FILLER                     PIC X(04) VALUE 'DEPT'.       01420000
           05  FILLER                     PIC X(04) VALUE SPACES.       01430000
           05  FILLER                     PIC X(17) VALUE 'BALANCE'.    01440019
           05  FILLER                     PIC X(04) VALUE SPACES.       01450000
           05  FILLER                     PIC X(17) VALUE 'QTR'.        01460019
           05  FILLER                     PIC X(04) VALUE SPACES.       01470000
           05  FILLER                     PIC X(17) VALUE 'QTRS'.       01480019
           05  FILLER                     PIC X(05) VALUE SPACES.       01490019
                                                                        01500000
       01  DH3-DETAIL-HEADING3.                                         01510000
           05  FILLER                     PIC X(02) VALUE SPACES.       01520000
           05  FILLER                     PIC X(30) VALUE               01521004
               '------------------------------'.                        01522004
           05  FILLER                     PIC X(04) VALUE SPACES.       01540000
           05  FILLER                     PIC X(10) VALUE '----------'. 01541004
           05  FILLER                     PIC X(04) VALUE SPACES.       01560000
           05  FILLER                     PIC X(04) VALUE '----'.       01561004
           05  FILLER                     PIC X(04) VALUE SPACES.       01580000
           05  FILLER                     PIC X(17) VALUE               01581019
               '-----------------'.                                     01582019
           05  FILLER                     PIC X(04) VALUE SPACES.       01600000
           05  FILLER                     PIC X(17) VALUE               01601019
               '-----------------'.                                     01602019
           05  FILLER                     PIC X(04) VALUE SPACES.       01620000
           05  FILLER                     PIC X(17) VALUE               01621019
               '-----------------'.                                     01622019
           05  FILLER                     PIC X(05) VALUE SPACES.       01640019
                                                                        01650000
       01  DL1-DETAIL-LINE1.                                            01660000
           05  FILLER                     PIC X(02) VALUE SPACES.       01670000
           05  DL1-VENDOR-NAME            PIC X(30) VALUE SPACES.       01680000
           05  FILLER                     PIC X(04) VALUE SPACES.       01690000
           05  DL1-VENDOR-NUMBER          PIC X(10) VALUE ZEROES.       01700000
           05  FILLER                     PIC X(05) VALUE SPACES.       01701005
           05  DL1-DEPT-NUMBER            PIC 9(03) VALUE ZEROES.       01702005
           05  FILLER                     PIC X(04) VALUE SPACES.       01730000
           05  DL1-OFF-INVOICE-BAL        PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01740019
           05  FILLER                     PIC X(04) VALUE SPACES.       01750000
           05  DL1-CURRENT-QTR            PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01760019
           05  FILLER                     PIC X(04) VALUE SPACES.       01770000
           05  DL1-PREVIOUS-QTR           PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01780019
           05  FILLER                     PIC X(05) VALUE SPACES.       01790019
                                                                        01800000
       01  TL1-TOTAL-LINE1.                                             01810000
           05  FILLER                     PIC X(02) VALUE SPACES.       01820000
           05  TL1-TOTAL-DESC             PIC X(11) VALUE 'DMM TOTAL  '.01821017
           05  FILLER                     PIC X(45) VALUE SPACES.       01840000
           05  TL1-OFF-INVOICE-BAL        PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01850019
           05  FILLER                     PIC X(04) VALUE SPACES.       01860000
           05  TL1-CURRENT-QTR            PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01870019
           05  FILLER                     PIC X(04) VALUE SPACES.       01880000
           05  TL1-PREVIOUS-QTR           PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01890019
           05  FILLER                     PIC X(05) VALUE SPACES.       01900019
                                                                        01910000
      ****************************************************************  01920000
      * DARD106 COPYBOOK                                                01930000
      ****************************************************************  01940000
           COPY DARD106.                                                01950000
                                                                        01960000
      *                                                                 01970000
       PROCEDURE DIVISION.                                              01980000
                                                                        01990000
      ******************************************************************02000000
      * 0000-DAKRP112.                                                  02010000
      ******************************************************************02020000
       0000-DAKRP112.                                                   02030000
                                                                        02040000
           PERFORM 1000-INITIALIZE                                      02050000
                                                                        02060000
           PERFORM 2000-PROCESS-EXTRACT                                 02070000
               UNTIL PS-EOF-EXTRACT.                                    02080000
                                                                        02090000
           PERFORM 5000-PRINT-DMM-TOTALS.                               02090117
                                                                        02090217
           PERFORM 8100-PRINT-GRAND-TOTALS.                             02091017
                                                                        02092017
           PERFORM 9900-EOJ.                                            02100000
                                                                        02110000
           GOBACK.                                                      02120000
                                                                        02130000
      ******************************************************************02140000
      * 1000-INITIALIZE.                                                02150000
      ******************************************************************02160000
       1000-INITIALIZE.                                                 02170000
                                                                        02180000
           OPEN INPUT  INPUT-FILE.                                      02190000
           OPEN OUTPUT REPORT-FILE.                                     02200000
                                                                        02210000
           PERFORM 9000-READ-EXTRACT.                                   02220000
           IF PS-EOF-EXTRACT                                            02230000
               DISPLAY 'NO DA INPUT -- REPORT WILL BE EMPTY'            02240000
           END-IF.                                                      02250000
                                                                        02260000
      ******************************************************************02270000
      * 2000-PROCESS-EXTRACT.                                           02280000
      ******************************************************************02290000
       2000-PROCESS-EXTRACT.                                            02300000
                                                                        02310000
           IF PS-FST-REC-PROCESSED                                      02320000
               IF DA106-GMM = PV-HOLD-GMM                               02330000
                   AND DA106-DMM = PV-HOLD-DMM                          02340000
                   PERFORM 3000-ACCUM-DMM-TOTALS                        02360001
                   PERFORM 4000-PRINT-DETAIL-LINE                       02370000
               ELSE                                                     02380000
                   PERFORM 5000-PRINT-DMM-TOTALS                        02400001
                   PERFORM 5200-INIT-DMM-TOTALS                         02420001
                   PERFORM 6000-WRITE-REPORT-HEADING                    02421006
                   PERFORM 3000-ACCUM-DMM-TOTALS                        02421114
                   PERFORM 4000-PRINT-DETAIL-LINE                       02422007
               END-IF                                                   02430000
           ELSE                                                         02440000
               PERFORM 6000-WRITE-REPORT-HEADING                        02460000
               MOVE DA106-CRRNT-AVL-COST-AMT TO PA-TTL-CRRNT-VND-FUND   02470000
                                                PA-GTL-CRRNT-VND-FUND   02471017
               MOVE DA106-PREV-AVL-COST-AMT  TO PA-TTL-PREV-VND-FUND    02480000
                                                PA-GTL-PREV-VND-FUND    02481017
               PERFORM 4000-PRINT-DETAIL-LINE                           02490000
               MOVE 'Y' TO PS-FST-REC-SWITCH                            02491006
           END-IF.                                                      02500000
                                                                        02510000
           PERFORM 3200-HOLD-DA106-RECORD.                              02520000
           PERFORM 9000-READ-EXTRACT.                                   02530000
                                                                        02540000
      ******************************************************************02550000
      * 3000-ACCUM-DMM-TOTALS.                                          02560001
      ******************************************************************02570000
       3000-ACCUM-DMM-TOTALS.                                           02580001
           COMPUTE PA-TTL-CRRNT-VND-FUND =                              02590000
               DA106-CRRNT-AVL-COST-AMT + PA-TTL-CRRNT-VND-FUND.        02600000
           COMPUTE PA-TTL-PREV-VND-FUND =                               02610000
               DA106-PREV-AVL-COST-AMT + PA-TTL-PREV-VND-FUND.          02620000
           COMPUTE PA-GTL-CRRNT-VND-FUND =                              02621017
               DA106-CRRNT-AVL-COST-AMT + PA-GTL-CRRNT-VND-FUND.        02622017
           COMPUTE PA-GTL-PREV-VND-FUND =                               02623017
               DA106-PREV-AVL-COST-AMT + PA-GTL-PREV-VND-FUND.          02624017
                                                                        02630000
      ******************************************************************02640000
      * 3200-HOLD-DA106-RECORD.                                         02650000
      ******************************************************************02660000
       3200-HOLD-DA106-RECORD.                                          02670000
           MOVE DA106-GMM         TO PV-HOLD-GMM.                       02680015
           MOVE DA106-DMM         TO PV-HOLD-DMM.                       02690015
           MOVE DA106-VENDOR-NAME TO PV-HOLD-VND-NAME.                  02710015
           MOVE DA106-DEPT-NBR    TO PV-HOLD-DEPT-NBR.                  02720015
                                                                        02730000
      ******************************************************************02740000
      * 4000-PRINT-DETAIL-LINE.                                         02750000
      ******************************************************************02760000
       4000-PRINT-DETAIL-LINE.                                          02770000
           COMPUTE PA-TTL-OFF-BALANCE =                                 02780000
               DA106-CRRNT-AVL-COST-AMT + DA106-PREV-AVL-COST-AMT.      02790000
                                                                        02800000
           IF DA106-VENDOR-NAME = PV-HOLD-VND-NAME                      02810015
               IF DA106-DEPT-NBR = PV-HOLD-DEPT-NBR                     02820000
                   DISPLAY '** ABEND **'                                02821021
                   DISPLAY '** PROGRAM DAKRP111 **'                     02822021
                   DISPLAY '** INCORRECT SORTING SEQUENCE'              02823021
                   MOVE +4001 TO PV-ABEND-CODE                          02824021
                   PERFORM 9999-ABEND                                   02825021
               ELSE                                                     02840000
                   MOVE SPACES                   TO DL1-VENDOR-NAME     02850000
                   MOVE SPACES                   TO DL1-VENDOR-NUMBER   02860000
                   MOVE DA106-DEPT-NBR           TO DL1-DEPT-NUMBER     02880001
                   MOVE PA-TTL-OFF-BALANCE       TO DL1-OFF-INVOICE-BAL 02890000
                   MOVE DA106-CRRNT-AVL-COST-AMT TO DL1-CURRENT-QTR     02900000
                   MOVE DA106-PREV-AVL-COST-AMT  TO DL1-PREVIOUS-QTR    02910000
                   PERFORM 7000-WRITE-REPORT-LINE                       02920000
               END-IF                                                   02930000
           ELSE                                                         02940000
               IF PS-FST-REC-PROCESSED                                  02950000
                   PERFORM 7200-WRITE-BLANK-LINE                        02960000
               END-IF                                                   02970000
               MOVE DA106-VENDOR-NAME        TO DL1-VENDOR-NAME         02980000
               MOVE DA106-VENDOR-NBR         TO DL1-VENDOR-NUMBER       03000001
               MOVE DA106-DEPT-NBR           TO DL1-DEPT-NUMBER         03010001
               MOVE PA-TTL-OFF-BALANCE       TO DL1-OFF-INVOICE-BAL     03030000
               MOVE DA106-CRRNT-AVL-COST-AMT TO DL1-CURRENT-QTR         03040000
               MOVE DA106-PREV-AVL-COST-AMT  TO DL1-PREVIOUS-QTR        03050000
               PERFORM 7000-WRITE-REPORT-LINE                           03060000
           END-IF.                                                      03070000
                                                                        03080000
      ******************************************************************03090000
      * 5000-PRINT-DMM-TOTALS.                                          03100001
      ******************************************************************03110000
       5000-PRINT-DMM-TOTALS.                                           03110118
                                                                        03111018
           PERFORM 7200-WRITE-BLANK-LINE 2 TIMES.                       03112018
                                                                        03130000
           COMPUTE PA-TTL-OFF-BALANCE =                                 03140000
               PA-TTL-CRRNT-VND-FUND + PA-TTL-PREV-VND-FUND.            03150000
                                                                        03160000
           MOVE PA-TTL-OFF-BALANCE    TO TL1-OFF-INVOICE-BAL.           03170000
           MOVE PA-TTL-CRRNT-VND-FUND TO TL1-CURRENT-QTR.               03180000
           MOVE PA-TTL-PREV-VND-FUND  TO TL1-PREVIOUS-QTR.              03190000
           PERFORM 8000-WRITE-TOTAL-LINE.                               03200000
                                                                        03210000
           PERFORM 7200-WRITE-BLANK-LINE 3 TIMES.                       03211018
                                                                        03212018
      ******************************************************************03220000
      * 5200-INIT-DMM-TOTALS.                                           03230001
      ******************************************************************03240000
       5200-INIT-DMM-TOTALS.                                            03250001
           MOVE ZEROES TO PA-TTL-OFF-BALANCE                            03260000
                          PA-TTL-CRRNT-VND-FUND                         03270000
                          PA-TTL-PREV-VND-FUND.                         03280000
                                                                        03290000
      ******************************************************************03300000
      * 6000-WRITE-REPORT-HEADING                                      *03310000
      ******************************************************************03320000
       6000-WRITE-REPORT-HEADING.                                       03330000
                                                                        03340000
      * HEADING LINE1                                                   03350000
           MOVE ZEROES                         TO PA-LINE-NO.           03360000
           ADD 1                               TO PA-PAGE-COUNT.        03370000
           ACCEPT PV-TODAYS-DATE-FORMATTED     FROM DATE.               03371009
           MOVE PV-YEAR                        TO DP132O-RUN-YEAR.      03372009
           MOVE PV-MONTH                       TO DP132O-RUN-MONTH.     03373009
           MOVE PV-DAY                         TO DP132O-RUN-DAY.       03374009
           MOVE SPACES                         TO DP132O-RUN-TIME.      03375013
           MOVE PA-PAGE-COUNT                  TO DP132O-PAGE-NUMBER.   03380000
           MOVE PC-DAKRP112-PGM                TO DP132O-PROGRAM-NAME.  03381012
           MOVE '1'                            TO DP132O-REPORT-NUMBER. 03382009
           MOVE DP132O-STANDRD-HEADER-132-COLS TO REPORT-RECORD.        03390000
           WRITE REPORT-RECORD                                          03400000
               AFTER ADVANCING PAGE.                                    03410000
                                                                        03420000
      * HEADING LINE2                                                   03460000
           MOVE H2-HEADING2 TO REPORT-RECORD.                           03470000
           WRITE REPORT-RECORD                                          03480000
               AFTER ADVANCING 1 LINE.                                  03490000
                                                                        03500000
      * HEADING LINE3                                                   03510000
           MOVE H3-HEADING3 TO REPORT-RECORD.                           03520000
           WRITE REPORT-RECORD                                          03530000
               AFTER ADVANCING 1 LINES.                                 03540000
                                                                        03550000
      * HEADING LINE4                                                   03560000
           IF DA106-GMM EQUAL SPACES                                    03561005
               MOVE ZEROES TO H4-GMM-NUMBER                             03562005
           ELSE                                                         03563005
               MOVE DA106-GMM TO H4-GMM-NUMBER                          03564005
           END-IF.                                                      03565005
                                                                        03566020
           MOVE SPACES TO H4-GMM-NAME.                                  03566122
           STRING DA106-GMM-FIR-NAME  DELIMITED BY SPACES               03567020
                  ' '                 DELIMITED BY SIZE                 03568020
                  DA106-GMM-LAST-NAME DELIMITED BY SPACES               03569020
                  INTO H4-GMM-NAME                                      03570020
           END-STRING.                                                  03571020
                                                                        03600000
           MOVE H4-HEADING4 TO REPORT-RECORD                            03610000
                               HH4-HOLD-HEADING4.                       03620000
           WRITE REPORT-RECORD                                          03630000
               AFTER ADVANCING 1 LINES.                                 03640000
                                                                        03650000
      * HEADING LINE5                                                   03660000
           IF DA106-DMM EQUAL SPACES                                    03661005
               MOVE ZEROES TO H5-DMM-NUMBER                             03662005
           ELSE                                                         03663005
               MOVE DA106-DMM TO H5-DMM-NUMBER                          03664005
           END-IF.                                                      03665005
                                                                        03666020
           MOVE SPACES TO H5-DMM-NAME.                                  03666122
           STRING DA106-DMM-FIR-NAME  DELIMITED BY SPACES               03667020
                  ' '                 DELIMITED BY SIZE                 03668020
                  DA106-DMM-LAST-NAME DELIMITED BY SPACES               03669020
                  INTO H5-DMM-NAME                                      03670020
           END-STRING.                                                  03671020
                                                                        03700000
           MOVE H5-HEADING5 TO REPORT-RECORD                            03710000
                               HH5-HOLD-HEADING5.                       03720000
           WRITE REPORT-RECORD                                          03730000
               AFTER ADVANCING 1 LINES.                                 03740000
                                                                        03750000
      * DETAIL HEADING1                                                 03860000
           MOVE DH1-DETAIL-HEADING1 TO REPORT-RECORD.                   03870000
           WRITE REPORT-RECORD                                          03880000
               AFTER ADVANCING 1 LINES.                                 03890000
                                                                        03900000
      * DETAIL HEADING2                                                 03910000
           MOVE DH2-DETAIL-HEADING2 TO REPORT-RECORD.                   03920000
           WRITE REPORT-RECORD                                          03930000
               AFTER ADVANCING 1 LINES.                                 03940000
                                                                        03950000
      * DETAIL HEADING DASH LINE                                        03960000
           MOVE DH3-DETAIL-HEADING3 TO REPORT-RECORD.                   03970000
           WRITE REPORT-RECORD                                          03980000
               AFTER ADVANCING 1 LINES.                                 03990000
                                                                        04000000
           MOVE 8 TO PA-LINE-NO.                                        04010001
                                                                        04020000
      ******************************************************************04030000
      * 6200-WRITE-SV-RPT-HEADING                                      *04040000
      ******************************************************************04050000
       6200-WRITE-SV-RPT-HEADING.                                       04060000
                                                                        04070000
      * HEADING LINE1                                                   04080000
           MOVE ZEROES                         TO PA-LINE-NO.           04090000
           ADD 1                               TO PA-PAGE-COUNT.        04100000
           MOVE PA-PAGE-COUNT                  TO DP132O-PAGE-NUMBER.   04110000
           MOVE DP132O-STANDRD-HEADER-132-COLS TO REPORT-RECORD.        04120000
           WRITE REPORT-RECORD                                          04130000
               AFTER ADVANCING PAGE.                                    04140000
                                                                        04150000
      * HEADING LINE2                                                   04190000
           MOVE H2-HEADING2 TO REPORT-RECORD.                           04200000
           WRITE REPORT-RECORD                                          04210000
               AFTER ADVANCING 1 LINE.                                  04220000
                                                                        04230000
      * HEADING LINE3                                                   04240000
           MOVE H3-HEADING3 TO REPORT-RECORD.                           04250000
           WRITE REPORT-RECORD                                          04260000
               AFTER ADVANCING 1 LINES.                                 04270000
                                                                        04280000
      * HEADING LINE4                                                   04290000
           MOVE HH4-HOLD-HEADING4 TO REPORT-RECORD.                     04300000
           WRITE REPORT-RECORD                                          04310000
               AFTER ADVANCING 1 LINES.                                 04320000
                                                                        04330000
      * HEADING LINE5                                                   04340000
           MOVE HH5-HOLD-HEADING5 TO REPORT-RECORD.                     04350000
           WRITE REPORT-RECORD                                          04360000
               AFTER ADVANCING 1 LINES.                                 04370000
                                                                        04380000
      * DETAIL HEADING1                                                 04440000
           MOVE DH1-DETAIL-HEADING1 TO REPORT-RECORD.                   04450000
           WRITE REPORT-RECORD                                          04460000
               AFTER ADVANCING 1 LINES.                                 04470000
                                                                        04480000
      * DETAIL HEADING2                                                 04490000
           MOVE DH2-DETAIL-HEADING2 TO REPORT-RECORD.                   04500000
           WRITE REPORT-RECORD                                          04510000
               AFTER ADVANCING 1 LINES.                                 04520000
                                                                        04530000
      * DETAIL HEADING DASH LINE                                        04540000
           MOVE DH3-DETAIL-HEADING3 TO REPORT-RECORD.                   04550000
           WRITE REPORT-RECORD                                          04560000
               AFTER ADVANCING 1 LINES.                                 04570000
                                                                        04580000
           MOVE 8 TO PA-LINE-NO.                                        04590001
                                                                        04600008
      * KEEP THE VENDOR NAME AND NUMBER FOR SAVE HEADING                04600108
           MOVE DA106-VENDOR-NAME        TO DL1-VENDOR-NAME.            04601008
           MOVE DA106-VENDOR-NBR         TO DL1-VENDOR-NUMBER.          04602008
                                                                        04603008
      ******************************************************************04610000
      * 7000-WRITE-REPORT-LINE.                                         04620000
      ******************************************************************04630000
       7000-WRITE-REPORT-LINE.                                          04640000
                                                                        04650000
           IF PA-LINE-NO > PC-MAX-LINES                                 04660000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04670000
           END-IF.                                                      04680000
                                                                        04690000
           WRITE REPORT-RECORD FROM DL1-DETAIL-LINE1                    04700000
                  AFTER ADVANCING 1 LINES.                              04710000
           ADD 1 TO PA-LINE-NO.                                         04720000
                                                                        04730000
      ******************************************************************04740000
      * 7200-WRITE-BLANK-LINE.                                          04750000
      ******************************************************************04760000
       7200-WRITE-BLANK-LINE.                                           04770000
                                                                        04780000
           IF PA-LINE-NO > PC-MAX-LINES                                 04790000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04800000
           END-IF.                                                      04810000
                                                                        04820000
           MOVE SPACES TO REPORT-RECORD.                                04830000
           WRITE REPORT-RECORD                                          04840000
               AFTER ADVANCING 1 LINES.                                 04850000
                                                                        04860000
           ADD 1 TO PA-LINE-NO.                                         04870000
                                                                        04880000
      ******************************************************************04890000
      * 8000-WRITE-TOTAL-LINE.                                          04900000
      ******************************************************************04910000
       8000-WRITE-TOTAL-LINE.                                           04920000
                                                                        04930000
           IF PA-LINE-NO > PC-MAX-LINES                                 04940000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04950000
           END-IF.                                                      04960000
                                                                        04970000
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE1                     04980000
                  AFTER ADVANCING 2 LINES.                              04990006
           ADD 2 TO PA-LINE-NO.                                         05000006
                                                                        05010000
      ******************************************************************05011017
      * 8100-PRINT-GRAND-TOTALS.                                        05012017
      ******************************************************************05013017
       8100-PRINT-GRAND-TOTALS.                                         05014017
                                                                        05015017
           COMPUTE PA-GTL-OFF-BALANCE =                                 05016017
               PA-GTL-CRRNT-VND-FUND + PA-GTL-PREV-VND-FUND.            05017017
                                                                        05018017
           MOVE 'GRAND TOTAL'         TO TL1-TOTAL-DESC.                05019017
           MOVE PA-GTL-OFF-BALANCE    TO TL1-OFF-INVOICE-BAL.           05019117
           MOVE PA-GTL-CRRNT-VND-FUND TO TL1-CURRENT-QTR.               05019217
           MOVE PA-GTL-PREV-VND-FUND  TO TL1-PREVIOUS-QTR.              05019317
           PERFORM 8000-WRITE-TOTAL-LINE.                               05019417
                                                                        05019517
      *************************************************************     05020000
      *  9000-READ-EXTRACT.                                       *     05030000
      *************************************************************     05040000
       9000-READ-EXTRACT.                                               05050000
           READ INPUT-FILE INTO DA106-AVL-VND-FUND-REC                  05060000
               AT END                                                   05070000
                   SET PS-EOF-EXTRACT TO TRUE                           05080000
               NOT AT END                                               05090000
                   ADD 1 TO PA-TOTAL-READ                               05100000
           END-READ.                                                    05110000
                                                                        05120000
      *************************************************************     05130000
      *  9900-EOJ IS PERFORMED FROM 0000-DAKRP112.                *     05140000
      *************************************************************     05150000
       9900-EOJ.                                                        05160000
                                                                        05170000
           IF PA-TOTAL-READ = ZERO                                      05180000
               WRITE REPORT-RECORD FROM PM-NO-INPUT-MSG                 05190002
                   AFTER ADVANCING 5 LINES                              05200002
           END-IF.                                                      05210000
                                                                        05220000
           WRITE REPORT-RECORD FROM PM-END-RPT-MSG                      05230000
                AFTER ADVANCING 5 LINES                                 05240000
                                                                        05250000
           CLOSE INPUT-FILE.                                            05260000
           CLOSE REPORT-FILE.                                           05270000
                                                                        05280000
           DISPLAY SPACES.                                              05290000
           MOVE PA-TOTAL-READ        TO PV-DISP-NUMBER.                 05300000
           DISPLAY 'RECS READ    =    ' PV-DISP-NUMBER.                 05310000
                                                                        05320000
      *************************************************************     05330021
      * 9999-ABEND.                                               *     05340021
      *************************************************************     05350021
       9999-ABEND.                                                      05360021
                                                                        05370021
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        05380021
                                                                        05390021
