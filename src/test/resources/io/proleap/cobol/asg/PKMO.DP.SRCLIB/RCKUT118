000700***************************************************************** 00010001
000800 IDENTIFICATION DIVISION.                                         00020001
000900***************************************************************** 00030001
001000 PROGRAM-ID.             RCKUT118.                                00040001
001100 AUTHOR.                 PATRICK BURKE.                           00050001
001200 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
001300 DATE-WRITTEN.           JANUARY 2003.                            00070001
001400 DATE-COMPILED.                                                   00080001
001500*                                                                 00090001
001600***************************************************************** 00100001
001910* THIS PROGRAM CREATES SUMMARIZING RECEIVER LEVEL DATA AT THE     00110001
001920* VENDOR LEVEL. THE OUTPUT FROM THIS PROGRAM WILL BE RCRD063      00120001
001930* AND BE USED IN RCKRP036 TO CREATE THE VENDOR LEVEL SUMMARY      00130001
001940* REPORT.                                                         00140001
002000***************************************************************** 00150001
002100 ENVIRONMENT DIVISION.                                            00160001
002200***************************************************************** 00170001
002300 CONFIGURATION SECTION.                                           00180001
002400 SOURCE-COMPUTER.                        IBM-3090.                00190001
002500 OBJECT-COMPUTER.                        IBM-3090.                00200001
002600 INPUT-OUTPUT SECTION.                                            00210001
002700 FILE-CONTROL.                                                    00220001
002800                                                                  00230001
002900     SELECT EXTRACT-FILE                                          00240007
003000         ASSIGN TO INP01.                                         00250001
003100                                                                  00260001
003500     SELECT OUTPUT-FILE                                           00270002
003600         ASSIGN TO OUT01.                                         00280002
003700                                                                  00290001
003800***************************************************************** 00300001
003900 DATA DIVISION.                                                   00310001
004000***************************************************************** 00320001
004100 FILE SECTION.                                                    00330001
004200                                                                  00340001
004300 FD  EXTRACT-FILE                                                 00350007
004400     RECORDING MODE IS F                                          00360001
004500     LABEL RECORDS ARE STANDARD                                   00370001
004600     BLOCK CONTAINS 0 RECORDS.                                    00380001
004700 01  EXTRACT-RECORD                   PIC X(250).                 00390007
004800                                                                  00400001
005500 FD  OUTPUT-FILE                                                  00410002
005600     RECORDING MODE IS F                                          00420001
005700     BLOCK CONTAINS 0 RECORDS.                                    00430001
005800 01  OUTPUT-RECORD                    PIC X(650).                 00440007
005900/                                                                 00450001
006000***************************************************************** 00460001
006100 WORKING-STORAGE SECTION.                                         00470001
006200***************************************************************** 00480001
006300*                                                                 00490001
006400**************************************************************    00500001
006500*  CONTROL CARD LAYOUT.                                           00510001
006600**************************************************************    00520001
006700*    COPY RCWS239.                                                00530001
006800/                                                                 00540001
006900**************************************************************    00550001
007000 01  CC-CONTROL-CARD.                                             00560001
007100     05  CC-CONSTANT              PIC  X(07)      VALUE SPACE.    00570001
007200     05  FILLER                   PIC  X(01)      VALUE SPACE.    00580001
007300     05  CC-OVERRIDE-IND          PIC  X(01).                     00590001
007400         88  CC-OVERRIDE-YES                      VALUE 'Y'.      00600001
007500         88  CC-OVERRIDE-NO                       VALUE 'N'.      00610001
007600     05  CC-FISCAL-YY             PIC  X(04).                     00620001
007700     05  CC-FISCAL-MM             PIC  X(02).                     00630001
007800     05  FILLER                   PIC  X(65)      VALUE SPACE.    00640001
007900                                                                  00650001
008000**************************************************************    00660001
008100 01  PS-SWITCHES.                                                 00670001
008200     05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00680001
008300         88  PS-PRINT-DETAILS                   VALUE 'Y'.        00690001
008400         88  PS-NOT-PRINT-DETAILS               VALUE 'N'.        00700001
008500     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00710001
008600         88  PS-END-OF-INPUT                    VALUE 'Y'.        00720001
008700         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00730001
008800     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00740001
008900         88  PS-NEW-PAGE                        VALUE 'Y'.        00750001
009000         88  PS-SAME-PAGE                       VALUE 'N'.        00760001
009100     05  PS-OPER-ALL-SW               PIC X(01) VALUE 'N'.        00770001
009200         88  PS-OPER-ALL                        VALUE 'Y'.        00780001
009300     05  PS-PRINT-LINE-SW             PIC X(01) VALUE 'N'.        00790001
009400         88  PS-PRINT-LINE                      VALUE 'Y'.        00800001
009500     05  PS-CRSDCK-SW                 PIC X(01) VALUE 'N'.        00810001
009600         88  PS-CRSDCK-YES                      VALUE 'Y'.        00820001
009700         88  PS-CRSDCK-NO                       VALUE 'N'.        00830001
009800     05  PS-B-RECORD-SW               PIC X(01) VALUE 'N'.        00840001
009900         88  PS-END-B-RECORD                    VALUE 'Y'.        00850001
010000         88  PS-NOT-END-B-RECORD                VALUE 'N'.        00860001
010100     05  PS-D-RECORD-SW               PIC X(01) VALUE 'N'.        00870001
010200         88  PS-END-D-RECORD                    VALUE 'Y'.        00880001
010300         88  PS-NOT-END-D-RECORD                VALUE 'N'.        00890001
010400     05  PS-END-TABLE-SW              PIC X(01) VALUE 'N'.        00900001
010500         88  PS-END-TABLE                       VALUE 'Y'.        00910001
010600         88  PS-END-TABLE-NO                    VALUE 'N'.        00920001
010700     05  PS-ECOMM-SW                  PIC X(01) VALUE 'N'.        00930001
010800         88  PS-ECOMM-YES                       VALUE 'Y'.        00940001
010900         88  PS-ECOMM-NO                        VALUE 'N'.        00950001
011000     05  PS-SUMMARY-SW                PIC X(01) VALUE 'N'.        00960001
011100         88  PS-SUMMARY-YES                     VALUE 'Y'.        00970001
011200         88  PS-SUMMARY-NO                      VALUE 'N'.        00980001
011300     05  PS-CURR-PREV-SW              PIC X(01) VALUE 'N'.        00990001
011400         88  PS-CURRENT                         VALUE 'Y'.        01000001
011500         88  PS-PREVIOUS                        VALUE 'N'.        01010001
011600                                                                  01020001
011700 01  PV-DATE-RECORD.                                              01030001
011800     05  PV-KEY-DATE                 PIC X(10).                   01040001
011900     05  PV-KEY-YYYYMMDD.                                         01050001
012000         10  PV-KEY-YYYY             PIC X(04).                   01060001
012100         10  FILLER                  PIC X(01) VALUE '-'.         01070001
012200         10  PV-KEY-MM               PIC X(02).                   01080001
012300         10  FILLER                  PIC X(01) VALUE '-'.         01090001
012400         10  PV-KEY-DD               PIC X(02) VALUE '01'.        01100001
012500     05  PV-MN-END-DTE.                                           01110001
012600         10  PV-MN-END-YYYY          PIC X(04).                   01120001
012700         10  FILLER                  PIC X(01).                   01130001
012800         10  PV-MN-END-MM            PIC X(02).                   01140001
012900         10  FILLER                  PIC X(01).                   01150001
013000         10  PV-MN-END-DD            PIC X(02).                   01160001
013100                                                                  01170001
013200     05  PV-FISCAL-YEAR              PIC X(04).                   01180001
013300     05  PV-FISCAL-MONTH             PIC X(02).                   01190001
013400                                                                  01200001
013500     05  PV-START1.                                               01210001
013600         10  PV-START-DATE1              PIC  X(10).              01220001
013700         10  PV-START-TIME1              PIC  X(16)  VALUE        01230001
013800                   '-00.00.00.000000'.                            01240001
013900     05  PV-START-TMST1 REDEFINES PV-START1 PIC X(26).            01250001
014000                                                                  01260001
014100     05  PV-END1.                                                 01270001
014200         10  PV-END-DATE1                 PIC  X(10).             01280001
014300         10  PV-END-TIME1                 PIC  X(16)  VALUE       01290001
014400                   '-23.59.59.999999'.                            01300001
014500     05  PV-END-TMST1 REDEFINES PV-END1    PIC  X(26).            01310001
014600                                                                  01320001
014700     05  PV-START2.                                               01330001
014800         10  PV-START-DATE2              PIC  X(10).              01340001
014900         10  PV-START-TIME2              PIC  X(16)  VALUE        01350001
015000                   '-00.00.00.000000'.                            01360001
015100     05  PV-START-TMST2 REDEFINES PV-START2 PIC X(26).            01370001
015200                                                                  01380001
015300     05  PV-END2.                                                 01390001
015400         10  PV-END-DATE2                 PIC  X(10).             01400001
015500         10  PV-END-TIME2                 PIC  X(16)  VALUE       01410001
015600                   '-23.59.59.999999'.                            01420001
015700     05  PV-END-TMST2 REDEFINES PV-END2    PIC  X(26).            01430001
015800                                                                  01440001
015900     05  PV-FISCAL-YYYY              PIC X(04) VALUE SPACES.      01450001
016000     05  PV-START-RPT-DATE           PIC X(10).                   01460001
016100     05  PV-END-RPT-DATE             PIC X(10).                   01470001
016200     05  PV-FROM-DATE                PIC X(10).                   01480001
016300     05  PV-TO-DATE                  PIC X(10).                   01490001
016400     05  PV-PREV-FROM-DATE           PIC X(10).                   01500001
016500     05  PV-PREV-TO-DATE             PIC X(10).                   01510001
016600                                                                  01520001
016700     05  PV-DIVIDEND                 PIC 9(03)V9999999.           01530001
016800                                                                  01540001
016900 01  SD-SYSTEM-DATE.                                              01550001
017000     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      01560001
017100     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      01570001
017200     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      01580001
017300                                                                  01590001
017400 01  ST-SYSTEM-TIME.                                              01600001
017500     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      01610001
017600     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      01620001
017700     05  FILLER                     PIC  9(04)   VALUE ZERO.      01630001
017800                                                                  01640001
017900**************************************************************    01650001
018000 01  PV-VARIABLES.                                                01660001
018100     05  PV-READ-COUNT-1              PIC S9(7) COMP-3            01670001
018200                                                VALUE ZERO.       01680001
018300     05  PV-READ-COUNT-2              PIC S9(7) COMP-3            01690001
018400                                                VALUE ZERO.       01700001
018500     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            01710001
018600                                                VALUE ZERO.       01720001
018700     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01730001
018800                                                VALUE ZERO.       01740001
018900     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01750001
019000                                                VALUE ZERO.       01760001
019100     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01770001
019200                                                 COMP SYNC.       01780001
019300     05  PV-SPACE-COUNT               PIC S9(05) VALUE ZERO       01790001
019400                                                 COMP-3.          01800001
019500     05  PV-CHAR-COUNT                PIC S9(05) VALUE ZERO       01810001
019600                                                 COMP-3.          01820001
019700     05  PV-REMAINDER                 PIC S9(05) VALUE ZERO       01830001
019800                                                 COMP-3.          01840001
019900     05  PV-RESULT                    PIC S9(05)V99 VALUE ZERO    01850001
020000                                                 COMP-3.          01860001
020100     05  PV-DEPT                      PIC 9(03) VALUE ZEROS.      01870001
020200     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01880001
020300     05  PV-PREV-STORE-NAME           PIC X(25) VALUE SPACES.     01890001
020400     05  PV-ORD-NBR                   PIC S9(09) COMP.            01900001
020500     05  PV-PREV-ORD-NBR              PIC S9(09) COMP.            01910001
020600     05  PV-PREV-ORD-NBR-MM           PIC S9(09) COMP.            01920001
020700     05  PV-REC-SEQ-NBR               PIC S9(09) COMP.            01930001
020800     05  PV-PREV-REC-SEQ-NBR          PIC S9(09) COMP.            01940001
020900     05  PV-OPER-UNT-ID               PIC S9(04) COMP.            01950001
021000     05  PV-PREV-OPER-UNT-ID          PIC S9(04) COMP.            01960001
021100     05  PV-SAVE-OPER-UNT-ID          PIC S9(04) COMP.            01970001
021200     05  PV-DC-OPER                   PIC S9(04) COMP.            01980001
021300     05  PV-PREV-PROCESS-AREA         PIC X(06) VALUE SPACES.     01990001
021400     05  PV-PREV-PROCESS-GROUP        PIC X(06) VALUE SPACES.     02000001
021500     05  PV-UNIT-RETAIL               PIC X(14) VALUE SPACES.     02010001
021600     05  PV-OPER-DESC                 PIC X(05) VALUE SPACES.     02020001
021700     05  PV-STORE-CODE                PIC X(01) VALUE SPACES.     02030001
021800     05  PV-EXTENDED-RETAIL           PIC S9(12)V99.              02040001
021900     05  PV-EXTENDED-RETAIL-Z         PIC ZZZ,ZZZ,ZZZ.ZZ-         02050001
022000                                                 VALUE ZEROS.     02060001
022100     05  PV-UNT-WRKD-QTY              PIC S9(09) COMP.            02070001
022110     05  PV-ENT-ID                    PIC S9(09) COMP.            02080008
022120     05  PV-PREV-ENT-ID               PIC S9(09) COMP.            02090008
022130     05  PV-ENT-NAME                  PIC  X(30) VALUE SPACES.    02100008
022140     05  PV-PREV-ENT-NAME             PIC  X(30) VALUE SPACES.    02110008
022150     05  PV-P12MN-SLSRNK-NBR          PIC S9(04) COMP.            02120008
022160     05  PV-PREV-P12MN-SLSRNK-NBR     PIC S9(04) COMP.            02130008
022200                                                                  02140001
022300     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     02150001
022400     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     02160001
022500     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              02170001
022600                                                                  02180001
022700     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     02190001
022800     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     02200001
022900     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    02210001
023000     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    02220001
023100     05  PV-DB2-YEAR                  PIC S9(08) COMP             02230001
023200                                          VALUE ZERO.             02240001
023300     05  PV-DB2-MONTH                 PIC S9(08) COMP             02250001
023400                                          VALUE ZERO.             02260001
023500     05  PV-DB2-DAY                   PIC S9(08) COMP             02270001
023600                                          VALUE ZERO.             02280001
023700     05  PV-DB2-HOUR                  PIC S9(08) COMP             02290001
023800                                          VALUE ZERO.             02300001
023900     05  PV-DB2-MINUTE                PIC S9(08) COMP             02310001
024000                                          VALUE ZERO.             02320001
024100     05  PV-DB2-SECOND                PIC S9(08) COMP             02330001
024200                                          VALUE ZERO.             02340001
024300                                                                  02350001
024400     05  PV-DIVIDEND-X                PIC S9(12)V99 VALUE +0.     02360001
024500     05  PV-CURR-PERCENT              PIC S9(03)V99 VALUE +0      02370001
024600                                                 COMP.            02380001
024700     05  PV-PREV-PERCENT              PIC S9(03)V99 VALUE +0      02390001
024800                                                 COMP.            02400001
024900     05  PV-DIFF-PERCENT              PIC S9(03)V99 VALUE +0      02410001
025000                                                 COMP.            02420001
025100/                                                                 02430001
025200******************************************************************02440001
025300 01  PV-FORMAT-DATE.                                              02450001
025400     05  PV-FORMAT-CCYY           PIC  X(04)   VALUE SPACES.      02460001
025500     05  FILLER                   PIC  X(01)   VALUE '/'.         02470001
025600     05  PV-FORMAT-MM             PIC  X(02)   VALUE SPACES.      02480001
025700     05  FILLER                   PIC  X(01)   VALUE '/'.         02490001
025800     05  PV-FORMAT-DD             PIC  X(02)   VALUE SPACES.      02500001
025900                                                                  02510001
026000 01  PV-ABEND-FIELDS.                                             02520001
026100     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02530001
026200                                                 COMP SYNC.       02540001
026300     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKUT118'.02550008
026400     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02560001
026500     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    02570001
026600     05  PV-ABEND-STRUCTURE-1         PIC  X(8)  VALUE SPACES.    02580001
026700     05  PV-ABEND-STRUCTURE-2         PIC  X(8)  VALUE SPACES.    02590001
026800     05  PV-ABEND-STRUCTURE-3         PIC  X(8)  VALUE SPACES.    02600001
026900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02610001
027000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02620001
027100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02630001
027200/                                                                 02640001
027300 01  PC-CONSTANTS.                                                02650001
027400     05  PC-RCKUT118                  PIC X(08) VALUE 'RCKUT118'. 02660008
027500     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'RCKUT118'. 02670008
027600     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02680001
027700     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02690001
027800                                                COMP-3.           02700001
027900******************************************************************02710001
028000 01  PV-YTD-TOTALS.                                               02720001
028100     05  PV-NBR-RCVRS-VRFD-YTD        PIC S9(12) VALUE +0.        02730001
028200     05  PV-NBR-LINES-VRFD-YTD        PIC S9(12) VALUE +0.        02740001
028300     05  PV-NBR-POS-YTD               PIC S9(12) VALUE +0.        02750001
028400     05  PV-AVG-RCVRS-PER-PO-YTD      PIC S9(04)V9 VALUE +0.      02760001
028500     05  PV-AVG-LINES-PER-REC-YTD     PIC S9(04)V9 VALUE +0.      02770001
028600                                                                  02780001
028700     05  PV-PACK-BY-STORE-YTD         PIC S9(12) VALUE +0.        02790001
028800     05  PV-INNER-PRE-PACK-YTD        PIC S9(12) VALUE +0.        02800001
028900     05  PV-MULTI-SKU-PRE-PACK-YTD    PIC S9(12) VALUE +0.        02810001
029000     05  PV-SINGLE-SKU-PRE-PACK-YTD   PIC S9(12) VALUE +0.        02820001
029100     05  PV-CASEPACK-YTD              PIC S9(12) VALUE +0.        02830001
029200     05  PV-BULKPACK-YTD              PIC S9(12) VALUE +0.        02840001
029300                                                                  02850001
029400     05  PV-EXPTED-CART-CNT-YTD       PIC S9(18) VALUE +0.        02860001
029500     05  PV-ACTL-CART-CNT-YTD         PIC S9(18) VALUE +0.        02870001
029600     05  PV-DIFF-CART-CNT-YTD         PIC S9(18) VALUE +0.        02880001
029700                                                                  02890001
029800     05  PV-EXPTED-ITM-QTY-YTD        PIC S9(17) VALUE +0.        02900001
029900     05  PV-VERIFY-ITM-QTY-YTD        PIC S9(17) VALUE +0.        02910001
030000     05  PV-AP-VERIFY-ITM-QTY-YTD     PIC S9(17) VALUE +0.        02920001
030100     05  PV-DIFF-ITM-QTY-YTD          PIC S9(17) VALUE +0.        02930001
030200     05  PV-QTY-ADJ-INT-VRFY-YTD      PIC S9(17) VALUE +0.        02940001
030300                                                                  02950001
030400     05  PV-EXPTED-EXT-RETAIL-YTD     PIC S9(15)V99 VALUE +0.     02960001
030500     05  PV-VERIFY-EXT-RETAIL-YTD     PIC S9(15)V99 VALUE +0.     02970001
030600     05  PV-AP-VERIFY-EXT-RETAIL-YTD  PIC S9(15)V99 VALUE +0.     02980001
030700     05  PV-DIFF-EXT-RETAIL-YTD       PIC S9(15)V99 VALUE +0.     02990001
030800     05  PV-EXT-RTL-ADJ-INT-VRFY-YTD  PIC S9(15)V99 VALUE +0.     03000001
030900                                                                  03010001
031000     05  PV-EXPD-VS-ACTL-OVRG-YTD     PIC S9(15)V99 VALUE +0.     03020001
031100     05  PV-EXPD-VS-ACTL-SHTG-YTD     PIC S9(15)V99 VALUE +0.     03030001
031200     05  PV-VARIANCE-OVR-SHRT-YTD     PIC S9(15)V99 VALUE +0.     03040001
031300                                                                  03050001
031400     05  PV-NBR-RCVR-OVR-CRTNS-YTD     PIC S9(12) VALUE +0.       03060001
031500     05  PV-NBR-RCVR-SHRT-CRTNS-YTD    PIC S9(12) VALUE +0.       03070001
031600     05  PV-NBR-RCVR-NODIFF-CRTNS-YTD  PIC S9(12) VALUE +0.       03080001
031700                                                                  03090001
031800     05  PV-NBR-RCVR-OVR-UNITS-YTD     PIC S9(12) VALUE +0.       03100001
031900     05  PV-NBR-RCVR-SHRT-UNITS-YTD    PIC S9(12) VALUE +0.       03110001
032000     05  PV-NBR-RCVR-NODIFF-UNITS-YTD  PIC S9(12) VALUE +0.       03120001
032100                                                                  03130001
032200     05  PV-NBR-RCVR-OVR-RTL-YTD       PIC S9(12) VALUE +0.       03140001
032300     05  PV-NBR-RCVR-SHRT-RTL-YTD      PIC S9(12) VALUE +0.       03150001
032400     05  PV-NBR-RCVR-NODIFF-RTL-YTD    PIC S9(12) VALUE +0.       03160001
032500                                                                  03170001
032600     05  PV-NBR-LINE-OVR-UNITS-YTD     PIC S9(12) VALUE +0.       03180001
032700     05  PV-NBR-LINE-SHRT-UNITS-YTD    PIC S9(12) VALUE +0.       03190001
032800     05  PV-NBR-LINE-NODIFF-UNITS-YTD  PIC S9(12) VALUE +0.       03200001
032900                                                                  03210001
033000     05  PV-NBR-LINE-OVR-RTL-YTD       PIC S9(12) VALUE +0.       03220001
033100     05  PV-NBR-LINE-SHRT-RTL-YTD      PIC S9(12) VALUE +0.       03230001
033200     05  PV-NBR-LINE-NODIFF-RTL-YTD    PIC S9(12) VALUE +0.       03240001
033201                                                                  03250005
033210     05  PV-EXP-V-ACT-OVER-PCT-YTD     PIC S9(05)V9999 VALUE +0.  03260006
033220     05  PV-EXP-V-ACT-SHRT-PCT-YTD     PIC S9(05)V9999 VALUE +0.  03270006
033300/                                                                 03280001
033400******************************************************************03290001
033500 01  PV-MONTH-TOTALS.                                             03300001
033600     05  PV-NBR-RCVRS-VRFD-MM         PIC S9(12) VALUE +0.        03310001
033700     05  PV-NBR-LINES-VRFD-MM         PIC S9(12) VALUE +0.        03320001
033800     05  PV-NBR-POS-MM                PIC S9(12) VALUE +0.        03330001
033900     05  PV-AVG-RCVRS-PER-PO-MM       PIC S9(04)V9 VALUE +0.      03340001
034000     05  PV-AVG-LINES-PER-REC-MM      PIC S9(04)V9 VALUE +0.      03350001
034100                                                                  03360001
034200     05  PV-PACK-BY-STORE-MM          PIC S9(12) VALUE +0.        03370001
034300     05  PV-INNER-PRE-PACK-MM         PIC S9(12) VALUE +0.        03380001
034400     05  PV-MULTI-SKU-PRE-PACK-MM     PIC S9(12) VALUE +0.        03390001
034500     05  PV-SINGLE-SKU-PRE-PACK-MM    PIC S9(12) VALUE +0.        03400001
034600     05  PV-CASEPACK-MM               PIC S9(12) VALUE +0.        03410001
034700     05  PV-BULKPACK-MM               PIC S9(12) VALUE +0.        03420001
034800                                                                  03430001
034900     05  PV-EXPTED-CART-CNT-MM        PIC S9(18) VALUE +0.        03440001
035000     05  PV-ACTL-CART-CNT-MM          PIC S9(18) VALUE +0.        03450001
035100     05  PV-DIFF-CART-CNT-MM          PIC S9(18) VALUE +0.        03460001
035200                                                                  03470001
035300     05  PV-EXPTED-ITM-QTY-MM         PIC S9(17) VALUE +0.        03480001
035400     05  PV-VERIFY-ITM-QTY-MM         PIC S9(17) VALUE +0.        03490001
035500     05  PV-AP-VERIFY-ITM-QTY-MM      PIC S9(17) VALUE +0.        03500001
035600     05  PV-DIFF-ITM-QTY-MM           PIC S9(17) VALUE +0.        03510001
035700     05  PV-QTY-ADJ-INT-VRFY-MM       PIC S9(17) VALUE +0.        03520001
035800                                                                  03530001
035900     05  PV-EXPTED-EXT-RETAIL-MM      PIC S9(15)V99 VALUE +0.     03540001
036000     05  PV-VERIFY-EXT-RETAIL-MM      PIC S9(15)V99 VALUE +0.     03550001
036100     05  PV-AP-VERIFY-EXT-RETAIL-MM   PIC S9(15)V99 VALUE +0.     03560001
036200     05  PV-DIFF-EXT-RETAIL-MM        PIC S9(15)V99 VALUE +0.     03570001
036300     05  PV-EXT-RTL-ADJ-INT-VRFY-MM   PIC S9(15)V99 VALUE +0.     03580001
036400                                                                  03590001
036500     05  PV-EXPD-VS-ACTL-OVRG-MM      PIC S9(15)V99 VALUE +0.     03600001
036600     05  PV-EXPD-VS-ACTL-SHTG-MM      PIC S9(15)V99 VALUE +0.     03610001
036700     05  PV-VARIANCE-OVR-SHRT-MM      PIC S9(15)V99 VALUE +0.     03620001
036800                                                                  03630001
036900     05  PV-NBR-RCVR-OVR-CRTNS-MM      PIC S9(12) VALUE +0.       03640001
037000     05  PV-NBR-RCVR-SHRT-CRTNS-MM     PIC S9(12) VALUE +0.       03650001
037100     05  PV-NBR-RCVR-NODIFF-CRTNS-MM   PIC S9(12) VALUE +0.       03660001
037200                                                                  03670001
037300     05  PV-NBR-RCVR-OVR-UNITS-MM      PIC S9(12) VALUE +0.       03680001
037400     05  PV-NBR-RCVR-SHRT-UNITS-MM     PIC S9(12) VALUE +0.       03690001
037500     05  PV-NBR-RCVR-NODIFF-UNITS-MM   PIC S9(12) VALUE +0.       03700001
037600                                                                  03710001
037700     05  PV-NBR-RCVR-OVR-RTL-MM        PIC S9(12) VALUE +0.       03720001
037800     05  PV-NBR-RCVR-SHRT-RTL-MM       PIC S9(12) VALUE +0.       03730001
037900     05  PV-NBR-RCVR-NODIFF-RTL-MM     PIC S9(12) VALUE +0.       03740001
038000                                                                  03750001
038100     05  PV-NBR-LINE-OVR-UNITS-MM      PIC S9(12) VALUE +0.       03760001
038200     05  PV-NBR-LINE-SHRT-UNITS-MM     PIC S9(12) VALUE +0.       03770001
038300     05  PV-NBR-LINE-NODIFF-UNITS-MM   PIC S9(12) VALUE +0.       03780001
038400                                                                  03790001
038500     05  PV-NBR-LINE-OVR-RTL-MM        PIC S9(12) VALUE +0.       03800001
038600     05  PV-NBR-LINE-SHRT-RTL-MM       PIC S9(12) VALUE +0.       03810001
038700     05  PV-NBR-LINE-NODIFF-RTL-MM     PIC S9(12) VALUE +0.       03820001
038701                                                                  03830005
038710     05  PV-EXP-V-ACT-OVER-PCT-MM      PIC S9(05)V9999 VALUE +0.  03840006
038720     05  PV-EXP-V-ACT-SHRT-PCT-MM      PIC S9(05)V9999 VALUE +0.  03850006
120000/                                                                 03860001
120100******************************************************************03870001
120200*  COPYBOOK USED BY MBS SYSTEM                                    03880001
120300******************************************************************03890001
120400     COPY DPWS003.                                                03900001
120500*                                                                 03910001
120600******************************************************************03920001
120700*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03930001
120800******************************************************************03940001
120900     COPY DPWS024.                                                03950023
121000/                                                                 03960001
121100******************************************************************03970001
121200*  DB2 FORMATTED MESSAGE AREA                                     03980001
121300******************************************************************03990001
121400     COPY DPWS004.                                                04000001
121500/                                                                 04010001
121600******************************************************************04020001
121700* CORPORATE DATE ROUTINES                                         04030001
121800******************************************************************04040001
121900     COPY DPWS500.                                                04050001
122000/                                                                 04060001
122100******************************************************************04070001
122200*  RECORD LAYOUT FOR INPUT FILE                                   04080001
122300******************************************************************04090001
122400     COPY RCRD062.                                                04100001
122500/                                                                 04110001
122510******************************************************************04120007
122520*  RECORD LAYOUT FOR OUTPUT FILE                                  04130007
122530******************************************************************04140007
122540     COPY RCRD063.                                                04150007
122550/                                                                 04160007
122600******************************************************************04170001
122700*   DB2 SQL COMMUNICATION AREA                                    04180001
122800******************************************************************04190001
122900     EXEC SQL                                                     04200001
123000         INCLUDE SQLCA                                            04210001
123100     END-EXEC.                                                    04220001
123200*                                                                 04230001
123300     COPY SQLCA2.                                                 04240001
123400*                                                                 04250001
124100/                                                                 04260001
124200****************************************************************  04270001
124300*  DATE TABLE.                                                    04280001
124400****************************************************************  04290001
124500     EXEC SQL                                                     04300001
124600         INCLUDE TDTATTR                                          04310001
124700     END-EXEC.                                                    04320001
124800/                                                                 04330001
124900******************************************************************04340001
125000*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE COMPANY CONTROL    04350001
125100*  TABLE                                                          04360001
125200******************************************************************04370001
125300     EXEC SQL                                                     04380001
125400          INCLUDE TCOCNTL                                         04390001
125500     END-EXEC.                                                    04400001
125600*                                                                 04410001
125700******************************************************************04420001
125800 PROCEDURE DIVISION.                                              04430001
125900******************************************************************04440001
126000 0000-MAINLINE.                                                   04450001
126100                                                                  04460001
126200     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           04470001
126300     PERFORM 1100-VALIDATE-CONTROL-CARD.                          04480001
126400                                                                  04490001
126500     OPEN INPUT  EXTRACT-FILE                                     04500007
126700     OPEN OUTPUT OUTPUT-FILE                                      04510002
126800                                                                  04520001
126900     PERFORM 2100-READ-EXTRACT-1                                  04530001
127000     PERFORM 1000-INITIALIZE                                      04540001
127100     PERFORM 2000-PROCESS-EXTRACT-1                               04550001
127200         UNTIL PS-END-OF-INPUT                                    04560001
127500     PERFORM 1460-AVG-AND-QTY-TOTALS                              04570001
127600     PERFORM 2900-BUILD-DETAILS                                   04580001
127700     PERFORM 3000-WRITE-OUTPUT                                    04590008
128900     PERFORM 9000-EOJ.                                            04600001
129000                                                                  04610001
129100     GOBACK.                                                      04620001
129200                                                                  04630001
129300******************************************************************04640001
129400 1000-INITIALIZE.                                                 04650001
129500******************************************************************04660001
129600*                                                                 04670001
129700* LOAD SYSTEM DATE INTO HEADINGS                                  04680001
129800     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04690001
129900     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04700001
130000                                                                  04710001
131200     MOVE PV-FISCAL-YEAR      TO PV-KEY-YYYY.                     04720012
131400     MOVE RC062-FISCAL-MM     TO PV-KEY-MM.                       04730012
131500     MOVE PV-KEY-YYYYMMDD     TO PV-KEY-DATE.                     04740015
131600                                                                  04750015
131700     MOVE PV-OPER-UNT-ID      TO PV-PREV-OPER-UNT-ID.             04760001
131800     MOVE PV-STORE-NAME       TO PV-PREV-STORE-NAME.              04770001
131810     MOVE PV-ENT-ID           TO PV-PREV-ENT-ID.                  04780013
131820     MOVE PV-ENT-NAME         TO PV-PREV-ENT-NAME.                04790015
131830     MOVE PV-P12MN-SLSRNK-NBR TO PV-PREV-P12MN-SLSRNK-NBR.        04800015
131900*                                                                 04810001
132000******************************************************************04820001
132100*                                                                 04830001
132200******************************************************************04840001
132300 1100-VALIDATE-CONTROL-CARD.                                      04850001
132400                                                                  04860001
132500     IF  CC-CONSTANT = 'CONTROL'                                  04870001
132600         CONTINUE                                                 04880001
132700     ELSE                                                         04890001
132800         DISPLAY '** ABEND **'                                    04900001
132900         DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME     04910001
133000         DISPLAY '** PARAGRAPH ** = 1100-VALIDATE-CONTROL-CARD'   04920001
133100         DISPLAY '** CONTROL CONSTANT INVALID'                    04930001
133200         DISPLAY '** CONTROL CONSTANT = ' CC-CONSTANT             04940001
133300         DISPLAY '** CHANGE TO CONTROL'                           04950001
133400         MOVE +4003              TO PV-ABEND-CODE                 04960001
133500         CALL 'ILBOABN0' USING PV-ABEND-CODE                      04970001
133600     END-IF.                                                      04980001
133700                                                                  04990001
133800     IF  CC-OVERRIDE-NO                                           05000001
133900         PERFORM 7200-SELECT-TCOCNTL                              05010001
134000         PERFORM 7300-SELECT-TDTATTR                              05020001
134100     ELSE                                                         05030001
134200         PERFORM 7400-SELECT-TDTATTR.                             05040001
134300                                                                  05050001
134400     DISPLAY '** FISCAL YEAR = ' PV-FISCAL-YEAR.                  05060001
134500     DISPLAY '** FISCAL MONTH = ' PV-FISCAL-MONTH.                05070001
134600     DISPLAY '** END DATE = ' DTATTR-FSCL-MN-END-DTE.             05080001
134700                                                                  05090001
134800     MOVE DTATTR-FSCL-MN-END-DTE TO PV-MN-END-DTE.                05100001
134900*    MOVE PV-MN-END-YYYY         TO HL2-YYYY.                     05110015
135000*    MOVE PV-MN-END-MM           TO HL2-MM.                       05120015
135100*    MOVE PV-MN-END-DD           TO HL2-DD.                       05130015
135200                                                                  05140001
135300/                                                                 05150001
135400***************************************************************** 05160001
135500* SELECT MONTH-ENDING DATE FROM TDTATTR.                          05170001
135600***************************************************************** 05180001
135700 1150-SELECT-MONTH-END-DATE.                                      05190001
135800                                                                  05200001
135900         EXEC SQL                                                 05210001
136000           SELECT FSCL_MN_END_DTE                                 05220001
136100             INTO :DTATTR-FSCL-MN-END-DTE                         05230001
136200           FROM TDTATTR                                           05240001
136300             WHERE FSCL_MN_NBR = :PV-KEY-MM                       05250001
136400               AND FSCL_YR_NBR = :PV-KEY-YYYY                     05260001
136500         END-EXEC                                                 05270001
136600                                                                  05280001
136700     EVALUATE TRUE                                                05290001
136800         WHEN SQLCODE = ZERO                                      05300001
136900         WHEN SQLCODE = -811                                      05310001
137000             MOVE DTATTR-FSCL-MN-END-DTE TO PV-MN-END-DTE         05320001
137400         WHEN SQLCODE = +100                                      05330001
137500             CONTINUE                                             05340001
137600         WHEN SQLCODE < ZERO                                      05350001
137700             DISPLAY '** ABEND - RCKUT118 **'                     05360008
137800             DISPLAY '** 1150-SELECT-CURR-DATES **'               05370001
137900             PERFORM 9200-SQL-ABEND                               05380001
138000         WHEN SQLCODE > ZERO                                      05390001
138100         WHEN SQLWARN0 NOT = SPACES                               05400001
138200             DISPLAY '** ABEND - RCKUT118 **'                     05410008
138300             DISPLAY '** 1150-SELECT-CURR-DATES **'               05420001
138400             PERFORM 9300-SQL-WARNING                             05430001
138500     END-EVALUATE.                                                05440001
138600/                                                                 05450001
142500***************************************************************** 05460001
142600* DO PROCESSING FOR MONTHLY INFORMATION.                          05470001
142700***************************************************************** 05480001
142800 1400-PROCESS-MONTHLY.                                            05490001
142900*                                                                 05500001
143500                                                                  05510001
143501     IF PV-ORD-NBR   =  PV-PREV-ORD-NBR-MM                        05520020
143502         CONTINUE                                                 05530019
143503     ELSE                                                         05540019
143504         ADD 1                 TO PV-NBR-POS-MM                   05550019
143505         MOVE PV-ORD-NBR       TO PV-PREV-ORD-NBR-MM.             05560020
143506                                                                  05570019
143600     ADD RC062-NBR-RCVR           TO PV-NBR-RCVRS-VRFD-MM         05580001
143700     ADD RC062-NBR-LINE           TO PV-NBR-LINES-VRFD-MM         05590001
143800     PERFORM 1510-PROCESS-PKGNG-CDE-MONTH.                        05600001
143900     ADD RC062-EXPTED-CART-CNT    TO PV-EXPTED-CART-CNT-MM        05610001
144000     ADD RC062-ACTL-CART-CNT      TO PV-ACTL-CART-CNT-MM          05620001
144100     ADD RC062-DIFF-CART-CNT      TO PV-DIFF-CART-CNT-MM          05630001
144200                                                                  05640001
144300     ADD RC062-EXPTED-ITM-QTY     TO PV-EXPTED-ITM-QTY-MM         05650001
144400     ADD RC062-VERIFY-ITM-QTY     TO PV-VERIFY-ITM-QTY-MM         05660001
144500     ADD RC062-AP-VERIFY-ITM-QTY  TO PV-AP-VERIFY-ITM-QTY-MM      05670001
144600     ADD RC062-DIFF-ITM-QTY       TO PV-DIFF-ITM-QTY-MM           05680001
144700                                                                  05690001
144800     ADD RC062-EXPTED-EXT-RETAIL  TO PV-EXPTED-EXT-RETAIL-MM      05700001
144900     ADD RC062-VERIFY-EXT-RETAIL  TO PV-VERIFY-EXT-RETAIL-MM      05710001
145000     ADD RC062-AP-VERIFY-EXT-RETAIL                               05720001
145100                               TO PV-AP-VERIFY-EXT-RETAIL-MM      05730001
145200     ADD RC062-DIFF-EXT-RETAIL    TO PV-DIFF-EXT-RETAIL-MM        05740001
145300                                                                  05750001
145400     ADD RC062-NBR-RCVR-SHRT-CRTNS                                05760001
145500                               TO PV-NBR-RCVR-SHRT-CRTNS-MM       05770001
145600     ADD RC062-NBR-RCVR-OVR-CRTNS TO PV-NBR-RCVR-OVR-CRTNS-MM     05780001
145700     SUBTRACT RC062-NBR-RCVR-SHRT-CRTNS                           05790001
145800              RC062-NBR-RCVR-OVR-CRTNS                            05800001
145900                 FROM RC062-NBR-RCVR                              05810001
146000                    GIVING PV-DIVIDEND-X                          05820001
146100     ADD PV-DIVIDEND-X            TO PV-NBR-RCVR-NODIFF-CRTNS-MM  05830001
146200                                                                  05840001
146300     ADD RC062-NBR-RCVR-SHRT-UNITS                                05850001
146400                                   TO PV-NBR-RCVR-SHRT-UNITS-MM   05860001
146500     ADD RC062-NBR-RCVR-OVR-UNITS  TO PV-NBR-RCVR-OVR-UNITS-MM    05870001
146600     SUBTRACT RC062-NBR-RCVR-SHRT-UNITS                           05880001
146700              RC062-NBR-RCVR-OVR-UNITS                            05890001
146800                 FROM RC062-NBR-RCVR                              05900001
146900                    GIVING PV-DIVIDEND-X                          05910001
147000     ADD PV-DIVIDEND-X            TO PV-NBR-RCVR-NODIFF-UNITS-MM  05920001
147100                                                                  05930001
147200     ADD RC062-NBR-RCVR-SHRT-RTL   TO PV-NBR-RCVR-SHRT-RTL-MM     05940001
147300     ADD RC062-NBR-RCVR-OVR-RTL    TO PV-NBR-RCVR-OVR-RTL-MM      05950001
147400     SUBTRACT RC062-NBR-RCVR-SHRT-RTL                             05960001
147500              RC062-NBR-RCVR-OVR-RTL                              05970001
147600                 FROM RC062-NBR-RCVR                              05980001
147700                    GIVING PV-DIVIDEND-X                          05990001
147800     ADD PV-DIVIDEND-X            TO PV-NBR-RCVR-NODIFF-RTL-MM    06000001
147900                                                                  06010001
148000     ADD RC062-NBR-LINE-SHRT-UNITS                                06020001
148100                                   TO PV-NBR-LINE-SHRT-UNITS-MM   06030001
148200     ADD RC062-NBR-LINE-OVR-UNITS  TO PV-NBR-LINE-OVR-UNITS-MM    06040001
148300     SUBTRACT RC062-NBR-LINE-SHRT-UNITS                           06050001
148400              RC062-NBR-LINE-OVR-UNITS                            06060001
148500                 FROM RC062-NBR-LINE                              06070001
148600                    GIVING PV-DIVIDEND-X                          06080001
148700     ADD PV-DIVIDEND-X            TO PV-NBR-LINE-NODIFF-UNITS-MM  06090001
148800                                                                  06100001
148900     ADD RC062-NBR-LINE-VRFY-RTL-SHRT  TO PV-NBR-LINE-SHRT-RTL-MM 06110001
149000     ADD RC062-NBR-LINE-VRFY-RTL-OVR   TO PV-NBR-LINE-OVR-RTL-MM  06120001
149100     SUBTRACT RC062-NBR-LINE-VRFY-RTL-SHRT                        06130001
149200              RC062-NBR-LINE-VRFY-RTL-OVR                         06140001
149300                 FROM RC062-NBR-LINE                              06150001
149400                    GIVING PV-DIVIDEND-X                          06160001
149500     ADD PV-DIVIDEND-X            TO PV-NBR-LINE-NODIFF-RTL-MM.   06170001
149600                                                                  06180001
149700     IF RC062-AP-VERIFY-EXT-RETAIL > RC062-EXPTED-EXT-RETAIL      06190001
149800        SUBTRACT RC062-EXPTED-EXT-RETAIL                          06200001
149900                 FROM RC062-AP-VERIFY-EXT-RETAIL                  06210001
150000                    GIVING PV-DIVIDEND-X                          06220001
150100     ADD PV-DIVIDEND-X            TO PV-EXPD-VS-ACTL-OVRG-MM.     06230001
150200                                                                  06240001
150300     IF RC062-EXPTED-EXT-RETAIL > RC062-AP-VERIFY-EXT-RETAIL      06250001
150400        SUBTRACT RC062-AP-VERIFY-EXT-RETAIL                       06260001
150500                 FROM RC062-EXPTED-EXT-RETAIL                     06270001
150600                    GIVING PV-DIVIDEND-X                          06280001
150700     ADD PV-DIVIDEND-X            TO PV-EXPD-VS-ACTL-SHTG-MM.     06290001
150800                                                                  06300001
150900/                                                                 06310001
151000***************************************************************** 06320001
151100* CHECK IF CURRENT PO IS EQUAL PREVIOUS PO. IF IT IS ADD TO       06330001
151200* RECEIVER TOTALS, ADD NUMBER OF LINES TO LINE TOTALS, DETERMINE  06340001
151300* PACKAGING TOTAL TYPE AND ADD TO DC TOTALS.                      06350001
151400***************************************************************** 06360001
151500 1450-PROCESS-YTD.                                                06370001
151600*                                                                 06380001
152200                                                                  06390001
152201     IF PV-ORD-NBR   =  PV-PREV-ORD-NBR                           06400019
152202         CONTINUE                                                 06410019
152203     ELSE                                                         06420019
152204         ADD 1                 TO PV-NBR-POS-YTD                  06430019
152205         MOVE PV-ORD-NBR       TO PV-PREV-ORD-NBR.                06440019
152206                                                                  06450019
152300     ADD RC062-NBR-RCVR           TO PV-NBR-RCVRS-VRFD-YTD        06460001
152400     ADD RC062-NBR-LINE           TO PV-NBR-LINES-VRFD-YTD        06470001
152500     PERFORM 1500-PROCESS-PKGNG-CDE-YTD                           06480001
152600     ADD RC062-EXPTED-CART-CNT    TO PV-EXPTED-CART-CNT-YTD       06490001
152700     ADD RC062-ACTL-CART-CNT      TO PV-ACTL-CART-CNT-YTD         06500001
152800     ADD RC062-DIFF-CART-CNT      TO PV-DIFF-CART-CNT-YTD         06510001
152900                                                                  06520001
153000     ADD RC062-EXPTED-ITM-QTY     TO PV-EXPTED-ITM-QTY-YTD        06530001
153100     ADD RC062-VERIFY-ITM-QTY     TO PV-VERIFY-ITM-QTY-YTD        06540001
153200     ADD RC062-AP-VERIFY-ITM-QTY  TO PV-AP-VERIFY-ITM-QTY-YTD     06550001
153300     ADD RC062-DIFF-ITM-QTY       TO PV-DIFF-ITM-QTY-YTD          06560001
153400                                                                  06570001
153500     ADD RC062-EXPTED-EXT-RETAIL  TO PV-EXPTED-EXT-RETAIL-YTD     06580001
153600     ADD RC062-VERIFY-EXT-RETAIL  TO PV-VERIFY-EXT-RETAIL-YTD     06590001
153700     ADD RC062-AP-VERIFY-EXT-RETAIL                               06600001
153800                               TO PV-AP-VERIFY-EXT-RETAIL-YTD     06610001
153900     ADD RC062-DIFF-EXT-RETAIL    TO PV-DIFF-EXT-RETAIL-YTD       06620001
154000                                                                  06630001
154100     ADD RC062-NBR-RCVR-SHRT-CRTNS                                06640001
154200                               TO PV-NBR-RCVR-SHRT-CRTNS-YTD      06650001
154300     ADD RC062-NBR-RCVR-OVR-CRTNS TO PV-NBR-RCVR-OVR-CRTNS-YTD    06660001
154400     SUBTRACT RC062-NBR-RCVR-SHRT-CRTNS                           06670001
154500              RC062-NBR-RCVR-OVR-CRTNS                            06680001
154600                 FROM RC062-NBR-RCVR                              06690001
154700                    GIVING PV-DIVIDEND-X                          06700001
154800     ADD PV-DIVIDEND-X            TO PV-NBR-RCVR-NODIFF-CRTNS-YTD 06710001
154900                                                                  06720001
155000     ADD RC062-NBR-RCVR-SHRT-UNITS                                06730001
155100                              TO PV-NBR-RCVR-SHRT-UNITS-YTD       06740001
155200     ADD RC062-NBR-RCVR-OVR-UNITS                                 06750001
155300                              TO PV-NBR-RCVR-OVR-UNITS-YTD        06760001
155400     SUBTRACT RC062-NBR-RCVR-SHRT-UNITS                           06770001
155500              RC062-NBR-RCVR-OVR-UNITS                            06780001
155600                 FROM RC062-NBR-RCVR                              06790001
155700                    GIVING PV-DIVIDEND-X                          06800001
155800     ADD PV-DIVIDEND-X            TO PV-NBR-RCVR-NODIFF-UNITS-YTD 06810001
155900                                                                  06820001
156000     ADD RC062-NBR-RCVR-SHRT-RTL   TO PV-NBR-RCVR-SHRT-RTL-YTD    06830001
156100     ADD RC062-NBR-RCVR-OVR-RTL    TO PV-NBR-RCVR-OVR-RTL-YTD     06840001
156200     SUBTRACT RC062-NBR-RCVR-SHRT-RTL                             06850001
156300              RC062-NBR-RCVR-OVR-RTL                              06860001
156400                 FROM RC062-NBR-RCVR                              06870001
156500                    GIVING PV-DIVIDEND-X                          06880001
156600     ADD PV-DIVIDEND-X            TO PV-NBR-RCVR-NODIFF-RTL-YTD   06890001
156700                                                                  06900001
156800     ADD RC062-NBR-LINE-SHRT-UNITS                                06910001
156900                              TO PV-NBR-LINE-SHRT-UNITS-YTD       06920001
157000     ADD RC062-NBR-LINE-OVR-UNITS                                 06930001
157100                              TO PV-NBR-LINE-OVR-UNITS-YTD        06940001
157200     SUBTRACT RC062-NBR-LINE-SHRT-UNITS                           06950001
157300              RC062-NBR-LINE-OVR-UNITS                            06960001
157400                 FROM RC062-NBR-LINE                              06970001
157500                    GIVING PV-DIVIDEND-X                          06980001
157600     ADD PV-DIVIDEND-X            TO PV-NBR-LINE-NODIFF-UNITS-YTD 06990001
157700                                                                  07000001
157800     ADD RC062-NBR-LINE-VRFY-RTL-SHRT                             07010001
157900                              TO PV-NBR-LINE-SHRT-RTL-YTD         07020001
158000     ADD RC062-NBR-LINE-VRFY-RTL-OVR                              07030001
158100                              TO PV-NBR-LINE-OVR-RTL-YTD          07040001
158200     SUBTRACT RC062-NBR-LINE-VRFY-RTL-SHRT                        07050001
158300              RC062-NBR-LINE-VRFY-RTL-OVR                         07060001
158400                 FROM RC062-NBR-LINE                              07070001
158500                    GIVING PV-DIVIDEND-X                          07080001
158600     ADD PV-DIVIDEND-X            TO PV-NBR-LINE-NODIFF-RTL-YTD.  07090001
158700                                                                  07100001
158800     IF RC062-AP-VERIFY-EXT-RETAIL > RC062-EXPTED-EXT-RETAIL      07110001
158900        SUBTRACT RC062-EXPTED-EXT-RETAIL                          07120001
159000                 FROM RC062-AP-VERIFY-EXT-RETAIL                  07130001
159100                    GIVING PV-DIVIDEND-X                          07140001
159200        ADD PV-DIVIDEND-X       TO PV-EXPD-VS-ACTL-OVRG-YTD       07150001
159300     END-IF.                                                      07160001
159400                                                                  07170001
159500     IF RC062-EXPTED-EXT-RETAIL > RC062-AP-VERIFY-EXT-RETAIL      07180001
159600        SUBTRACT RC062-AP-VERIFY-EXT-RETAIL                       07190001
159700                 FROM RC062-EXPTED-EXT-RETAIL                     07200001
159800                    GIVING PV-DIVIDEND-X                          07210001
159900        ADD PV-DIVIDEND-X       TO PV-EXPD-VS-ACTL-SHTG-YTD       07220001
160000     END-IF.                                                      07230001
160100                                                                  07240001
160200/                                                                 07250001
160300***************************************************************** 07260001
160400* DETERMINE AVERAGE RECEIVERS PER PO.                             07270001
160500***************************************************************** 07280001
160600 1460-AVG-AND-QTY-TOTALS.                                         07290001
160700*                                                                 07300001
160800     IF PV-NBR-POS-YTD        > ZERO                              07310001
160900      DIVIDE PV-NBR-RCVRS-VRFD-YTD    BY PV-NBR-POS-YTD           07320001
161000         GIVING PV-AVG-RCVRS-PER-PO-YTD ROUNDED                   07330001
161100     ELSE                                                         07340001
161200           MOVE ZEROS  TO  PV-AVG-RCVRS-PER-PO-YTD                07350001
161300     END-IF.                                                      07360001
161400                                                                  07370001
161500     IF PV-NBR-POS-MM         > ZERO                              07380001
161600      DIVIDE PV-NBR-RCVRS-VRFD-MM     BY PV-NBR-POS-MM            07390001
161700         GIVING PV-AVG-RCVRS-PER-PO-MM ROUNDED                    07400001
161800     ELSE                                                         07410001
161900           MOVE ZEROS  TO  PV-AVG-RCVRS-PER-PO-MM                 07420001
162000     END-IF.                                                      07430001
162100                                                                  07440001
162200     IF PV-NBR-RCVRS-VRFD-YTD   > ZERO                            07450001
162300         DIVIDE PV-NBR-LINES-VRFD-YTD    BY PV-NBR-RCVRS-VRFD-YTD 07460001
162400           GIVING PV-AVG-LINES-PER-REC-YTD ROUNDED                07470001
162500     ELSE                                                         07480001
162600           MOVE ZEROS  TO  PV-AVG-LINES-PER-REC-YTD               07490001
162700     END-IF.                                                      07500001
162800                                                                  07510001
162900     IF PV-NBR-RCVRS-VRFD-MM    > ZERO                            07520001
163000         DIVIDE PV-NBR-LINES-VRFD-MM     BY PV-NBR-RCVRS-VRFD-MM  07530001
163100           GIVING PV-AVG-LINES-PER-REC-MM ROUNDED                 07540001
163200     ELSE                                                         07550001
163300           MOVE ZEROS  TO  PV-AVG-LINES-PER-REC-MM                07560001
163400     END-IF.                                                      07570001
163500                                                                  07580001
163600     SUBTRACT PV-AP-VERIFY-ITM-QTY-MM FROM PV-VERIFY-ITM-QTY-MM   07590001
163700           GIVING PV-QTY-ADJ-INT-VRFY-MM                          07600001
163800     SUBTRACT PV-AP-VERIFY-ITM-QTY-YTD FROM PV-VERIFY-ITM-QTY-YTD 07610001
163900           GIVING PV-QTY-ADJ-INT-VRFY-YTD                         07620001
164000                                                                  07630001
164100     SUBTRACT PV-AP-VERIFY-EXT-RETAIL-MM                          07640001
164200                                   FROM PV-VERIFY-EXT-RETAIL-MM   07650001
164300           GIVING PV-EXT-RTL-ADJ-INT-VRFY-MM                      07660001
164400     SUBTRACT PV-AP-VERIFY-EXT-RETAIL-YTD                         07670001
164500                                   FROM PV-VERIFY-EXT-RETAIL-YTD  07680001
164600           GIVING PV-EXT-RTL-ADJ-INT-VRFY-YTD.                    07690001
164700                                                                  07700001
164800     ADD PV-EXPD-VS-ACTL-OVRG-MM  TO PV-EXPD-VS-ACTL-SHTG-MM      07710001
164900                    GIVING PV-VARIANCE-OVR-SHRT-MM.               07720001
165000     ADD PV-EXPD-VS-ACTL-OVRG-YTD TO PV-EXPD-VS-ACTL-SHTG-YTD     07730001
165100                    GIVING PV-VARIANCE-OVR-SHRT-YTD.              07740001
165200/                                                                 07750001
165300***************************************************************** 07760001
165400* IDENTIFY RC062-PKGNG-CDE ON INPUT FILE AND PER DC CALCULATE     07770001
165500*  YEAR-TO-DATE RECEIVER TOTALS.                                  07780001
165600***************************************************************** 07790001
165700 1500-PROCESS-PKGNG-CDE-YTD.                                      07800001
165800*                                                                 07810001
165900     EVALUATE TRUE                                                07820001
166000        WHEN RC062-BULK-PACK                                      07830001
166100            ADD RC062-NBR-RCVR   TO PV-BULKPACK-YTD               07840001
166200                                                                  07850001
166300        WHEN RC062-CASEPACK                                       07860001
166400            ADD RC062-NBR-RCVR   TO PV-CASEPACK-YTD               07870001
166500                                                                  07880001
166600        WHEN RC062-INNER-PRE-PACK                                 07890001
166700            ADD RC062-NBR-RCVR   TO PV-INNER-PRE-PACK-YTD         07900001
166800                                                                  07910001
166900        WHEN RC062-MULTI-SKU-PRE-PACK                             07920001
167000            ADD RC062-NBR-RCVR   TO PV-MULTI-SKU-PRE-PACK-YTD     07930001
167100                                                                  07940001
167200        WHEN RC062-SINGLE-SKU-PRE-PACK                            07950001
167300            ADD RC062-NBR-RCVR   TO PV-SINGLE-SKU-PRE-PACK-YTD    07960001
167400                                                                  07970001
167500        WHEN RC062-PACK-BY-STORE                                  07980001
167600            ADD RC062-NBR-RCVR   TO PV-PACK-BY-STORE-YTD          07990001
167700                                                                  08000001
167800     END-EVALUATE.                                                08010001
167900/                                                                 08020001
168000***************************************************************** 08030001
168100* IDENTIFY RC062-PKGNG-CDE ON INPUT FILE AND PER DC CALCULATE     08040001
168200*  MONTHLY RECEIVER TOTALS.                                       08050001
168300***************************************************************** 08060001
168400 1510-PROCESS-PKGNG-CDE-MONTH.                                    08070001
168500*                                                                 08080001
168600     EVALUATE TRUE                                                08090001
168700        WHEN RC062-BULK-PACK                                      08100001
168800            ADD RC062-NBR-RCVR   TO PV-BULKPACK-MM                08110001
168900                                                                  08120001
169000        WHEN RC062-CASEPACK                                       08130001
169100            ADD RC062-NBR-RCVR   TO PV-CASEPACK-MM                08140001
169200                                                                  08150001
169300        WHEN RC062-INNER-PRE-PACK                                 08160001
169400            ADD RC062-NBR-RCVR   TO PV-INNER-PRE-PACK-MM          08170001
169500                                                                  08180001
169600        WHEN RC062-MULTI-SKU-PRE-PACK                             08190001
169700            ADD RC062-NBR-RCVR   TO PV-MULTI-SKU-PRE-PACK-MM      08200001
169800                                                                  08210001
169900        WHEN RC062-SINGLE-SKU-PRE-PACK                            08220001
170000            ADD RC062-NBR-RCVR   TO PV-SINGLE-SKU-PRE-PACK-MM     08230001
170100                                                                  08240001
170200        WHEN RC062-PACK-BY-STORE                                  08250001
170300            ADD RC062-NBR-RCVR   TO PV-PACK-BY-STORE-MM           08260001
170400                                                                  08270001
170500     END-EVALUATE.                                                08280001
170600/                                                                 08290001
170700***************************************************************** 08300001
170800* INITIALIZE AREA TOTALS.                                         08310001
170900***************************************************************** 08320001
171000 1550-INITIALIZE-TOTALS.                                          08330001
171100*                                                                 08340001
171200     INITIALIZE     PV-YTD-TOTALS                                 08350001
171300                    PV-MONTH-TOTALS.                              08360001
171400/                                                                 08370001
171500******************************************************************08380001
171600* PROCESS DETAIL RECORDS                                          08390007
171700******************************************************************08400001
171800 2000-PROCESS-EXTRACT-1.                                          08410001
171900*                                                                 08420001
172000     IF RC062-FISCAL-MM  >  PV-FISCAL-MONTH                       08430001
172100         CONTINUE                                                 08440001
172200     ELSE                                                         08450001
172310         IF PV-ENT-ID       = PV-PREV-ENT-ID                      08460003
172400             PERFORM 1450-PROCESS-YTD                             08470001
172500             PERFORM 2200-CHECK-FISCAL-MONTH                      08480001
172600         ELSE                                                     08490001
172900             PERFORM 1460-AVG-AND-QTY-TOTALS                      08500001
173000             PERFORM 2900-BUILD-DETAILS                           08510001
173100             PERFORM 3000-WRITE-OUTPUT                            08520008
173200             PERFORM 1550-INITIALIZE-TOTALS                       08530001
173300             MOVE PV-ENT-ID           TO PV-PREV-ENT-ID           08540022
173310             MOVE PV-ENT-NAME         TO PV-PREV-ENT-NAME         08550022
173320             MOVE PV-P12MN-SLSRNK-NBR TO PV-PREV-P12MN-SLSRNK-NBR 08560022
173400             PERFORM 1450-PROCESS-YTD                             08570001
173500             PERFORM 2200-CHECK-FISCAL-MONTH                      08580001
173600         END-IF                                                   08590001
173700     END-IF.                                                      08600001
173800                                                                  08610001
173900     PERFORM 2100-READ-EXTRACT-1.                                 08620001
174000*                                                                 08630001
174100******************************************************************08640001
174200*  READ NEXT INPUT FILE RECORD.                                   08650001
174300******************************************************************08660001
174400 2100-READ-EXTRACT-1.                                             08670001
174500                                                                  08680001
174600     READ EXTRACT-FILE   INTO RCRD062-RCVR-LNE-EXTRACT            08690007
174700        AT END                                                    08700001
174800           SET PS-END-OF-INPUT TO TRUE                            08710001
174900        NOT AT END                                                08720001
175000           ADD +1                        TO PV-READ-COUNT-1       08730001
175001           IF RC062-ENT-ID > ZEROS                                08740009
175010               MOVE RC062-ENT-ID        TO PV-ENT-ID              08750008
175020               MOVE RC062-ENT-NAME      TO PV-ENT-NAME            08760008
175030               MOVE RC062-P12MN-SLSRNK-NBR                        08770008
175040                                        TO PV-P12MN-SLSRNK-NBR    08780008
175050           END-IF                                                 08790008
175200           MOVE RC062-ORD-NBR           TO PV-ORD-NBR             08800008
175300           MOVE RC062-REC-SEQ-NBR       TO PV-REC-SEQ-NBR         08810008
175310           MOVE RC062-CURR-OPER-UNT-ID  TO PV-OPER-UNT-ID         08820008
175400     END-READ.                                                    08830001
175500/                                                                 08840001
175600******************************************************************08850001
175700* COMPARE FISCAL MONTH ON EXTRACT AGAINST FISCAL MONTH ON CONTROL 08860003
175800* CARD. PROCESS FOR MONTH REQUESTED. ONLY DO YTD PROCESSING FOR   08870001
175900* MONTHS PREVIOUS TO ALLOW FOR REPORTING FOR ANY MONTH.           08880001
176000* DO NOT ADD TO YTD IF FISCAL MONTH IS GREATER THAN PV-FISCAL-MM. 08890001
176100******************************************************************08900001
176200 2200-CHECK-FISCAL-MONTH.                                         08910001
176300*                                                                 08920001
176400     IF RC062-FISCAL-MM =  PV-FISCAL-MONTH                        08930001
176500         PERFORM 1400-PROCESS-MONTHLY                             08940001
176600     END-IF.                                                      08950001
176700/                                                                 08960001
179700******************************************************************08970001
179800*  BUILD DETAIL LINES.                                            08980001
179900******************************************************************08990001
180000 2900-BUILD-DETAILS.                                              09000001
180100*                                                                 09010001
180200     MOVE PV-NBR-RCVRS-VRFD-MM    TO RC063-NBR-RCVR-VRFD-MM.      09020003
180300     MOVE PV-NBR-RCVRS-VRFD-YTD   TO RC063-NBR-RCVR-VRFD-YTD.     09030003
180400     MOVE PV-NBR-LINES-VRFD-MM    TO RC063-NBR-LINE-VRFD-MM.      09040003
180500     MOVE PV-NBR-LINES-VRFD-YTD   TO RC063-NBR-LINE-VRFD-YTD.     09050003
180600     MOVE PV-NBR-POS-MM           TO RC063-NBR-PO-VRFD-MM.        09060003
180700     MOVE PV-NBR-POS-YTD          TO RC063-NBR-PO-VRFD-YTD.       09070003
181200     MOVE PV-PACK-BY-STORE-MM     TO RC063-NBR-PBS-RCVR-VRFD-MM.  09080003
181300     MOVE PV-PACK-BY-STORE-YTD    TO RC063-NBR-PBS-RCVR-VRFD-YTD. 09090003
181400     MOVE PV-INNER-PRE-PACK-MM    TO RC063-NBR-IPP-RCVR-VRFD-MM.  09100003
181500     MOVE PV-INNER-PRE-PACK-YTD   TO RC063-NBR-IPP-RCVR-VRFD-YTD. 09110003
181600     MOVE PV-MULTI-SKU-PRE-PACK-MM  TO RC063-NBR-MPP-RCVR-VRFD-MM.09120003
181700     MOVE PV-MULTI-SKU-PRE-PACK-YTD                               09130003
181710                                   TO RC063-NBR-MPP-RCVR-VRFD-YTD.09140003
181800     MOVE PV-SINGLE-SKU-PRE-PACK-MM TO RC063-NBR-SPP-RCVR-VRFD-MM.09150003
181900     MOVE PV-SINGLE-SKU-PRE-PACK-YTD                              09160003
181910                                   TO RC063-NBR-SPP-RCVR-VRFD-YTD.09170003
182000     MOVE PV-CASEPACK-MM           TO RC063-NBR-CSP-RCVR-VRFD-MM. 09180003
182100     MOVE PV-CASEPACK-YTD          TO RC063-NBR-CSP-RCVR-VRFD-YTD.09190003
182200     MOVE PV-BULKPACK-MM           TO RC063-NBR-BLK-RCVR-VRFD-MM. 09200003
182300     MOVE PV-BULKPACK-YTD          TO RC063-NBR-BLK-RCVR-VRFD-YTD.09210003
182400     MOVE PV-EXPTED-CART-CNT-MM    TO RC063-EXP-CART-COUNT-MM.    09220004
182500     MOVE PV-EXPTED-CART-CNT-YTD   TO RC063-EXP-CART-COUNT-YTD.   09230004
182600     MOVE PV-ACTL-CART-CNT-MM      TO RC063-ACT-CART-COUNT-MM.    09240004
182700     MOVE PV-ACTL-CART-CNT-YTD     TO RC063-ACT-CART-COUNT-YTD.   09250004
182800     MOVE PV-DIFF-CART-CNT-MM      TO RC063-DIF-CART-COUNT-MM.    09260004
182900     MOVE PV-DIFF-CART-CNT-YTD     TO RC063-DIF-CART-COUNT-YTD.   09270004
183000     MOVE PV-EXPTED-ITM-QTY-MM     TO RC063-EXP-ITEM-QTY-MM.      09280004
183100     MOVE PV-EXPTED-ITM-QTY-YTD    TO RC063-EXP-ITEM-QTY-YTD.     09290004
183200     MOVE PV-VERIFY-ITM-QTY-MM     TO RC063-INT-ITEM-QTY-MM.      09300004
183300     MOVE PV-VERIFY-ITM-QTY-YTD    TO RC063-INT-ITEM-QTY-YTD.     09310004
183400     MOVE PV-AP-VERIFY-ITM-QTY-MM  TO RC063-FNL-ITEM-QTY-MM.      09320004
183500     MOVE PV-AP-VERIFY-ITM-QTY-YTD TO RC063-FNL-ITEM-QTY-YTD.     09330004
183600     MOVE PV-DIFF-ITM-QTY-MM       TO RC063-FNL-DIF-ITEM-QTY-MM.  09340004
183700     MOVE PV-DIFF-ITM-QTY-YTD      TO RC063-FNL-DIF-ITEM-QTY-YTD. 09350004
183800     MOVE PV-QTY-ADJ-INT-VRFY-MM   TO RC063-FNL-ADJ-ITEM-QTY-MM.  09360004
183900     MOVE PV-QTY-ADJ-INT-VRFY-YTD  TO RC063-FNL-ADJ-ITEM-QTY-YTD. 09370004
184000                                                                  09380001
184100     MOVE PV-EXPTED-EXT-RETAIL-MM  TO RC063-EXP-ITEM-RTL-MM.      09390004
184200     MOVE PV-EXPTED-EXT-RETAIL-YTD TO RC063-EXP-ITEM-RTL-YTD.     09400004
184300     MOVE PV-VERIFY-EXT-RETAIL-MM  TO RC063-INT-ITEM-RTL-MM.      09410004
184400     MOVE PV-VERIFY-EXT-RETAIL-YTD TO RC063-INT-ITEM-RTL-YTD.     09420004
184500     MOVE PV-AP-VERIFY-EXT-RETAIL-MM                              09430001
184600                                   TO RC063-FNL-ITEM-RTL-MM.      09440004
184700     MOVE PV-AP-VERIFY-EXT-RETAIL-YTD                             09450001
184800                                   TO RC063-FNL-ITEM-RTL-YTD.     09460004
184900     MOVE PV-DIFF-EXT-RETAIL-MM    TO RC063-FNL-DIF-ITEM-RTL-MM.  09470004
185000     MOVE PV-DIFF-EXT-RETAIL-YTD   TO RC063-FNL-DIF-ITEM-RTL-YTD. 09480004
185100     MOVE PV-EXT-RTL-ADJ-INT-VRFY-MM TO RC063-FNL-ADJ-ITEM-RTL-MM.09490004
185200     MOVE PV-EXT-RTL-ADJ-INT-VRFY-YTD                             09500004
185210                                   TO RC063-FNL-ADJ-ITEM-RTL-YTD. 09510004
185300     MOVE PV-EXPD-VS-ACTL-OVRG-MM  TO RC063-EXP-V-ACT-OVER-RTL-MM.09520004
185400     MOVE PV-EXPD-VS-ACTL-OVRG-YTD                                09530004
185410                                  TO RC063-EXP-V-ACT-OVER-RTL-YTD.09540004
185500     MOVE PV-EXPD-VS-ACTL-SHTG-MM  TO RC063-EXP-V-ACT-SHRT-RTL-MM.09550004
185600     MOVE PV-EXPD-VS-ACTL-SHTG-YTD                                09560004
185610                                  TO RC063-EXP-V-ACT-SHRT-RTL-YTD.09570004
185620     MOVE PV-VARIANCE-OVR-SHRT-MM  TO RC063-EXP-V-ACT-GRSS-RTL-MM.09580016
185630     MOVE PV-VARIANCE-OVR-SHRT-YTD                                09590016
185640                                  TO RC063-EXP-V-ACT-GRSS-RTL-YTD.09600016
185900     MOVE PV-NBR-RCVR-OVR-CRTNS-MM TO RC063-NBR-RCVR-CART-OVR-MM. 09610004
186000     MOVE PV-NBR-RCVR-OVR-CRTNS-YTD                               09620004
186010                                   TO RC063-NBR-RCVR-CART-OVR-YTD.09630004
186100     MOVE PV-NBR-RCVR-SHRT-CRTNS-MM TO RC063-NBR-RCVR-CART-SHR-MM.09640004
186200     MOVE PV-NBR-RCVR-SHRT-CRTNS-YTD                              09650004
186210                                   TO RC063-NBR-RCVR-CART-SHR-YTD.09660004
186300     MOVE PV-NBR-RCVR-NODIFF-CRTNS-MM                             09670001
186400                                   TO RC063-NBR-RCVR-CART-EQL-MM. 09680004
186500     MOVE PV-NBR-RCVR-NODIFF-CRTNS-YTD                            09690001
186600                                   TO RC063-NBR-RCVR-CART-EQL-YTD.09700004
186700     MOVE PV-NBR-RCVR-OVR-UNITS-MM TO RC063-NBR-RCVR-QTY-OVR-MM.  09710004
186800     MOVE PV-NBR-RCVR-OVR-UNITS-YTD TO RC063-NBR-RCVR-QTY-OVR-YTD.09720004
186900     MOVE PV-NBR-RCVR-SHRT-UNITS-MM TO RC063-NBR-RCVR-QTY-SHR-MM. 09730004
187000     MOVE PV-NBR-RCVR-SHRT-UNITS-YTD                              09740004
187010                                    TO RC063-NBR-RCVR-QTY-SHR-YTD.09750004
187100     MOVE PV-NBR-RCVR-NODIFF-UNITS-MM                             09760001
187200                                    TO RC063-NBR-RCVR-QTY-EQL-MM. 09770004
187300     MOVE PV-NBR-RCVR-NODIFF-UNITS-YTD                            09780001
187400                                    TO RC063-NBR-RCVR-QTY-EQL-YTD.09790004
187700     MOVE PV-NBR-RCVR-OVR-RTL-MM TO RC063-NBR-RCVR-RTL-OVR-MM.    09800005
187800     MOVE PV-NBR-RCVR-OVR-RTL-YTD TO RC063-NBR-RCVR-RTL-OVR-YTD.  09810005
187810     MOVE PV-NBR-RCVR-SHRT-RTL-MM TO RC063-NBR-RCVR-RTL-SHR-MM.   09820005
187820     MOVE PV-NBR-RCVR-SHRT-RTL-YTD TO RC063-NBR-RCVR-RTL-SHR-YTD. 09830005
187900     MOVE PV-NBR-RCVR-NODIFF-RTL-MM TO RC063-NBR-RCVR-RTL-EQL-MM. 09840005
188100     MOVE PV-NBR-RCVR-NODIFF-RTL-YTD                              09850005
188200                                    TO RC063-NBR-RCVR-RTL-EQL-YTD.09860005
188300     MOVE PV-NBR-LINE-OVR-UNITS-MM TO RC063-NBR-LINE-QTY-OVR-MM.  09870005
188400     MOVE PV-NBR-LINE-OVR-UNITS-YTD TO RC063-NBR-LINE-QTY-OVR-YTD.09880005
188500     MOVE PV-NBR-LINE-SHRT-UNITS-MM TO RC063-NBR-LINE-QTY-SHR-MM. 09890005
188600     MOVE PV-NBR-LINE-SHRT-UNITS-YTD                              09900005
188610                                    TO RC063-NBR-LINE-QTY-SHR-YTD.09910005
188700     MOVE PV-NBR-LINE-NODIFF-UNITS-MM                             09920001
188800                                    TO RC063-NBR-LINE-QTY-EQL-MM. 09930005
188900     MOVE PV-NBR-LINE-NODIFF-UNITS-YTD                            09940001
189000                                    TO RC063-NBR-LINE-QTY-EQL-YTD.09950005
189100                                                                  09960001
189200     MOVE PV-NBR-LINE-OVR-RTL-MM TO RC063-NBR-LINE-RTL-OVR-MM.    09970005
189300     MOVE PV-NBR-LINE-OVR-RTL-YTD TO RC063-NBR-LINE-RTL-OVR-YTD.  09980005
189400     MOVE PV-NBR-LINE-SHRT-RTL-MM TO RC063-NBR-LINE-RTL-SHR-MM.   09990005
189500     MOVE PV-NBR-LINE-SHRT-RTL-YTD TO RC063-NBR-LINE-RTL-SHR-YTD. 10000005
189600     MOVE PV-NBR-LINE-NODIFF-RTL-MM TO RC063-NBR-LINE-RTL-EQL-MM. 10010005
189800     MOVE PV-NBR-LINE-NODIFF-RTL-YTD                              10020001
189900                                   TO RC063-NBR-LINE-RTL-EQL-YTD. 10030005
190000                                                                  10040001
190010     MOVE PV-PREV-ENT-ID           TO RC063-ENT-ID.               10050008
190020     MOVE PV-PREV-ENT-NAME         TO RC063-ENT-NAME.             10060008
190021     MOVE PV-PREV-P12MN-SLSRNK-NBR TO RC063-P12MN-SLSRNK-NBR.     10070008
190022     MOVE PV-FISCAL-YEAR           TO RC063-FISCAL-YYYY.          10080015
190023     MOVE PV-FISCAL-MONTH          TO RC063-FISCAL-MM.            10090015
190024     MOVE PV-MN-END-YYYY           TO RPT-MONTH-END-YYYY.         10100015
190025     MOVE PV-MN-END-MM             TO RPT-MONTH-END-MM.           10110015
190026     MOVE PV-MN-END-DD             TO RPT-MONTH-END-DD.           10120015
190030                                                                  10130008
190100     PERFORM 5000-DETERMINE-PERCENTS.                             10140001
190101     MOVE PV-EXP-V-ACT-OVER-PCT-MM TO RC063-EXP-V-ACT-OVER-PCT-MM.10150016
190110*    MOVE PV-EXP-V-ACT-OVER-PCT-YTD                               10160016
190111*                                TO RC063-EXP-V-ACT-OVER-PCT-YTD. 10170016
190112     MOVE PV-EXP-V-ACT-SHRT-PCT-MM TO RC063-EXP-V-ACT-SHRT-PCT-MM.10180016
190113*    MOVE PV-EXP-V-ACT-SHRT-PCT-YTD                               10190016
190114*                                TO RC063-EXP-V-ACT-SHRT-PCT-YTD. 10200016
190200/                                                                 10210001
190300******************************************************************10220001
190400 3000-WRITE-OUTPUT.                                               10230008
190500******************************************************************10240001
190600*                                                                 10250008
190700     WRITE OUTPUT-RECORD                                          10260008
190800      FROM RCRD063-VND-RCVR-SUMMARY.                              10270008
190810                                                                  10280008
190900     ADD +1 TO PV-WRITE-COUNT.                                    10290009
202600/                                                                 10300008
203500***************************************************************** 10310001
203600*  FIGURE PECENTAGES.                                             10320001
203700***************************************************************** 10330001
203800 5000-DETERMINE-PERCENTS.                                         10340001
228700*                                                                 10350001
228800* PERCENT FOR EXPECTED VS ACTUAL RETAIL OVERAGE VERIFIED          10360001
228900*                                                                 10370001
229000        IF PV-EXPTED-EXT-RETAIL-MM  > ZERO                        10380001
229100          DIVIDE PV-EXPD-VS-ACTL-OVRG-MM                          10390001
229200                                   BY PV-EXPTED-EXT-RETAIL-MM     10400001
229300            GIVING PV-DIVIDEND ROUNDED                            10410001
229400          MULTIPLY PV-DIVIDEND BY 100                             10420001
229500            GIVING PV-EXP-V-ACT-OVER-PCT-MM                       10430005
229600        ELSE                                                      10440001
229700              MOVE ZEROES  TO  PV-DIVIDEND                        10450001
229800                               PV-EXP-V-ACT-OVER-PCT-MM           10460005
229900        END-IF.                                                   10470001
230000                                                                  10480001
230100        IF PV-EXPTED-EXT-RETAIL-YTD  > ZERO                       10490001
230200          DIVIDE PV-EXPD-VS-ACTL-OVRG-YTD                         10500001
230300                                     BY PV-EXPTED-EXT-RETAIL-YTD  10510001
230400            GIVING PV-DIVIDEND ROUNDED                            10520001
230500          MULTIPLY PV-DIVIDEND BY 100                             10530001
230600            GIVING PV-EXP-V-ACT-OVER-PCT-YTD                      10540005
230700        ELSE                                                      10550001
230800              MOVE ZEROES  TO  PV-DIVIDEND                        10560001
230900                               PV-EXP-V-ACT-OVER-PCT-YTD          10570005
231000        END-IF.                                                   10580001
231100*                                                                 10590001
231200* PERCENT FOR EXPECTED VS ACTUAL RETAIL SHORTAGE VERIFIED         10600001
231300*                                                                 10610001
231400        IF PV-EXPTED-EXT-RETAIL-MM  > ZERO                        10620001
231500          DIVIDE PV-EXPD-VS-ACTL-SHTG-MM                          10630001
231600                                   BY PV-EXPTED-EXT-RETAIL-MM     10640001
231700            GIVING PV-DIVIDEND ROUNDED                            10650001
231800          MULTIPLY PV-DIVIDEND BY 100                             10660001
231900            GIVING PV-EXP-V-ACT-SHRT-PCT-MM                       10670005
232000        ELSE                                                      10680001
232100              MOVE ZEROES  TO  PV-DIVIDEND                        10690001
232200                               PV-EXP-V-ACT-SHRT-PCT-MM           10700005
232300        END-IF.                                                   10710001
232400                                                                  10720001
232500        IF PV-EXPTED-EXT-RETAIL-YTD  > ZERO                       10730001
232600          DIVIDE PV-EXPD-VS-ACTL-SHTG-YTD                         10740001
232700                                     BY PV-EXPTED-EXT-RETAIL-YTD  10750001
232800            GIVING PV-DIVIDEND ROUNDED                            10760001
232900          MULTIPLY PV-DIVIDEND BY 100                             10770001
233000            GIVING PV-EXP-V-ACT-SHRT-PCT-YTD                      10780005
233100        ELSE                                                      10790001
233200              MOVE ZEROES  TO  PV-DIVIDEND                        10800001
233300                               PV-EXP-V-ACT-SHRT-PCT-YTD          10810005
233400        END-IF.                                                   10820001
270300*                                                                 10830001
270400******************************************************************10840001
270500* WHEN CC-OVERRIDE-NO USE THIS SELECT TO BATCH PROCESSING DATE    10850001
270600* TO USE IN 7300-SELECT-TDTATTR TO GET FISCAL YEAR, MONTH AND     10860001
270700* MONTH END DATE.                                                 10870001
270800******************************************************************10880001
270900 7200-SELECT-TCOCNTL.                                             10890001
271000*                                                                 10900001
271100     EXEC SQL                                                     10910001
271200         SELECT                                                   10920001
271300                (BTCH_PRC_DTE - 14 DAYS)                          10930001
271400         INTO  :COCNTL-BTCH-PRC-DTE                               10940001
271500         FROM TCOCNTL                                             10950001
271600         WHERE OPER_UNT_ID = 90                                   10960001
271700     END-EXEC                                                     10970001
271800                                                                  10980001
271900     EVALUATE TRUE                                                10990001
272000         WHEN SQLCODE = +0                                        11000001
272100         WHEN SQLCODE = +100                                      11010001
272200         WHEN SQLCODE = -811                                      11020001
272300             CONTINUE                                             11030001
272400         WHEN SQLCODE < ZERO                                      11040001
272500             MOVE '7200-SELECT-TCOCNTL'                           11050001
272600                                     TO PV-ABEND-PARAGRAPH        11060001
272700             MOVE 'SELECT'         TO PV-DB2-FUNCTION             11070001
272800             PERFORM 9200-SQL-ABEND                               11080001
272900         WHEN SQLCODE > ZERO                                      11090001
273000         WHEN SQLWARN0 NOT = SPACES                               11100001
273100             MOVE '7200-SELECT-TCOCNTL'                           11110001
273200                                      TO PV-ABEND-PARAGRAPH       11120001
273300             MOVE 'SELECT'         TO PV-DB2-FUNCTION             11130001
273400             PERFORM 9300-SQL-WARNING                             11140001
273500     END-EVALUATE.                                                11150001
273600/                                                                 11160001
273700******************************************************************11170001
273800* WHEN CC-OVERRIDE-NO USE THIS SELECT TO GET FISCAL YEAR, FISCAL  11180001
273900* MONTH AND MONTH END DATE                                        11190001
274000******************************************************************11200001
274100 7300-SELECT-TDTATTR.                                             11210001
274200*                                                                 11220001
274300     EXEC SQL                                                     11230001
274400         SELECT                                                   11240001
274500                 FSCL_YR_NBR                                      11250001
274600               , FSCL_MN_NBR                                      11260001
274700               , FSCL_MN_END_DTE                                  11270001
274800         INTO   :PV-FISCAL-YEAR                                   11280001
274900               ,:PV-FISCAL-MONTH                                  11290001
275000               ,:DTATTR-FSCL-MN-END-DTE                           11300001
275100         FROM TDTATTR                                             11310001
275200         WHERE KY_DTE  = :COCNTL-BTCH-PRC-DTE                     11320001
275300     END-EXEC                                                     11330001
275400                                                                  11340001
275500     EVALUATE TRUE                                                11350001
275600         WHEN SQLCODE = +0                                        11360001
275700             CONTINUE                                             11370001
275800         WHEN SQLCODE = +100                                      11380001
275900         WHEN SQLCODE = -811                                      11390001
276000         WHEN SQLCODE < ZERO                                      11400001
276100             MOVE '7300-SELECT-TDTATTR'                           11410001
276200                                      TO PV-ABEND-PARAGRAPH       11420001
276300             MOVE 'SELECT'          TO PV-DB2-FUNCTION            11430001
276400             PERFORM 9200-SQL-ABEND                               11440001
276500         WHEN SQLCODE > ZERO                                      11450001
276600         WHEN SQLWARN0 NOT = SPACES                               11460001
276700             MOVE '7300-SELECT-TDTATTR'                           11470001
276800                                      TO PV-ABEND-PARAGRAPH       11480001
276900             MOVE 'SELECT'          TO PV-DB2-FUNCTION            11490001
277000             PERFORM 9300-SQL-WARNING                             11500001
277100     END-EVALUATE.                                                11510001
277200/                                                                 11520001
277300******************************************************************11530001
277400* WHEN CC-OVERRIDE-YES USE THIS SELECT TO GET MONTH END DATE.     11540001
277500* CC-FISCAL-MM AND CC-FISCAL-YY ARE ALREADY POPULATED IN THIS CASE11550001
277600******************************************************************11560001
277700 7400-SELECT-TDTATTR.                                             11570001
277800*                                                                 11580001
277900     EXEC SQL                                                     11590001
278000         SELECT                                                   11600001
278100                 FSCL_MN_END_DTE                                  11610001
278200         INTO   :DTATTR-FSCL-MN-END-DTE                           11620001
278300         FROM TDTATTR                                             11630001
278400         WHERE FSCL_YR_NBR = :CC-FISCAL-YY                        11640001
278500           AND FSCL_MN_NBR = :CC-FISCAL-MM                        11650001
278600     END-EXEC.                                                    11660001
278700                                                                  11670001
278800     EVALUATE TRUE                                                11680001
278900         WHEN SQLCODE = +0                                        11690001
279000         WHEN SQLCODE = -811                                      11700001
279100         WHEN SQLCODE = +100                                      11710001
279200             MOVE CC-FISCAL-YY      TO  PV-FISCAL-YEAR            11720001
279300             MOVE CC-FISCAL-MM      TO  PV-FISCAL-MONTH           11730001
279400         WHEN SQLCODE < ZERO                                      11740001
279500             MOVE '7400-SELECT-TDTATTR'                           11750001
279600                                      TO PV-ABEND-PARAGRAPH       11760001
279700             MOVE 'SELECT'            TO PV-DB2-FUNCTION          11770001
279800             PERFORM 9200-SQL-ABEND                               11780001
279900         WHEN SQLCODE > ZERO                                      11790001
280000         WHEN SQLWARN0 NOT = SPACES                               11800001
280100             MOVE '7400-SELECT-TDTATTR'                           11810001
280200                                      TO PV-ABEND-PARAGRAPH       11820001
280300             MOVE 'SELECT'            TO PV-DB2-FUNCTION          11830001
280400             PERFORM 9300-SQL-WARNING                             11840001
280500     END-EVALUATE.                                                11850001
280600/                                                                 11860001
284400******************************************************************11870001
284500 9000-EOJ.                                                        11880001
284600******************************************************************11890001
284700*                                                                 11900001
285100*CLOSE FILES.                                                     11910001
285200     CLOSE EXTRACT-FILE                                           11920007
285400     CLOSE OUTPUT-FILE.                                           11930002
285500/                                                                 11940001
285600******************************************************************11950001
285700 9200-SQL-ABEND.                                                  11960001
285800******************************************************************11970001
285900                                                                  11980001
286000     MOVE SQLCODE                     TO SQLCODE2.                11990001
286100     MOVE SQLERRD(3)                  TO SQLERRD3.                12000001
286200                                                                  12010001
286300     DISPLAY '** ABEND **         ** = SQLERROR'.                 12020001
286400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        12030001
286500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   12040001
286600     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                12050001
286700     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     12060001
286800     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     12070001
286900     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     12080001
287000                                                                  12090001
287100     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                12100001
287200     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                12110001
287300     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 12120001
287400     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                12130001
287500                                                                  12140001
287600                                                                  12150001
287700     MOVE +4013                       TO PV-ABEND-CODE.           12160001
287800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12170001
287900                                                                  12180001
288000******************************************************************12190001
288100 9300-SQL-WARNING.                                                12200001
288200******************************************************************12210001
288300                                                                  12220001
288400     DISPLAY '9300-SQL-WARNING'.                                  12230001
288500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        12240001
288600     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   12250001
288700     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                12260001
288800                                                                  12270001
288900     MOVE SQLCODE                     TO SQLCODE2.                12280001
289000     MOVE SQLERRD(3)                  TO SQLERRD3.                12290001
289100     DISPLAY '** ABEND **       ** = SQLWARNING'.                 12300001
289200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  12310001
289300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  12320001
289400     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  12330001
289500     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  12340001
289600     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  12350001
289700     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  12360001
289800     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  12370001
289900     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  12380001
290000     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  12390001
290100     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  12400001
290200                                                                  12410001
290300     MOVE +4013                       TO PV-ABEND-CODE.           12420001
290400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12430001
290500*                                                                 12440001
290600******************************************************************12450001
290700*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       12460001
290800******************************************************************12470001
290900 9400-ABEND.                                                      12480001
291000*                                                                 12490001
291100     DISPLAY '***************************'.                       12500001
291200     DISPLAY '**       ABEND           **'.                       12510001
291300     DISPLAY '**  IN PROGRAM RCKUT118  **'.                       12520008
291400     DISPLAY '***************************'.                       12530001
291500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH.             12540001
291600     DISPLAY '**   ERROR         ** = ' DP003-RETURN-MSG.         12550001
291700     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       12560001
291800     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       12570001
291900                                                                  12580001
292000     MOVE +4014                  TO PV-ABEND-CODE.                12590001
292100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12600001
292200*                                                                 12610001
292300******************************************************************12620001
