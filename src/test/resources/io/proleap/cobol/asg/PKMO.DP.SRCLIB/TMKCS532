000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    TMKCS532.                                         00040000
000500 AUTHOR.        VIRGENE LENNEMAN.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  05-09-98.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E532 - PO NOTIFICATION/TROUBLE LIST PROGRAM - DIST. CENTER * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM WILL PRODUCE A LIST OF NOTIFICATION AND       * 00130000
001400*    TROUBLE RECORDS FOR EITHER A SINGLE PO OR MULTIPLE PO'S.   * 00140000
001500*                                                               * 00150000
001600*    THE APPROPRIATE PROGRAM IS INVOKED WHEN THE OPERATOR       * 00160000
001700*    ENTERS  ONE OR MORE ITEMS AND PRESSES A FUNCTION KEY.      * 00170000
001800*                                                               * 00180000
001900*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN   * 00190000
002000*    ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE  * 00200000
002100*    LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE      * 00210000
002200*    UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE   * 00220000
002300*    IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.    * 00230000
002400***************************************************************** 00240000
002410*    CHANGES:                                                   * 00241018
002420*    09/03/2013 MADE BY: CHERI PARMLEY   CHG#0061291            * 00242000
002430*    CHANGED RCVRMNT FROM F21 TO F15                            * 00243000
002440*    ADDED SEL-ALL F21                                          * 00244000
002450*    ADDED POCTNLST F19 (GOES TO CARTON LIST)                   * 00245000
002451***************************************************************** 00245105
002452*    09/09/2013 MADE BY: CHERI PARMLEY   CHG#0061964            * 00245205
002453*    DUE TO ISSUE WITH F21 (ABENDING WITH QUEUE ISSUE) F15 AND  * 00245305
002454*    F21 WERE BACKED OUT OF THE PREVIOUS CHANGE. F19 DID REMAIN.* 00245405
002455*    THIS CHANGE INCLUDES FIX OF BUG THAT WAS FOUND IN PARA     * 00245505
002456*    5200-FILL-SEL-QUEUE-RECORD-R IT WAS WRITING TO INCORRECT   * 00245605
002457*    QUEUE. THIS WAS EXISTING BUG IN PROGRAM.                   * 00245705
002458*    SECOND FIX WAS MADE WHERE F24 WAS NOT UN-SELECTING UPON PF3* 00245805
002459*    BACK FROM THE DETAIL SCREEN. THIS HAPPENED IN PARA         * 00245905
002460*    6000-REFRESH-PANEL-FROM-TEMP WHERE THE LAST 2 LINES WERE   * 00246005
002461*    DROPPED WHEN POCTNLIST CODE WAS INSTALLED IN PRIOR CHANGE. * 00246105
002462***************************************************************** 00246207
002463*    10/08/2014 MADE BY: VENKATSUBBU (COGNIZANT)  CHG#0061964   * 00246307
002464*    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#   * 00246407
002465*    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 10/08/2014      * 00246509
002466***************************************************************** 00246615
002484* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00248415
002485* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00248515
002486* MAKING THE CALL DYNAMIC VS STATIC.                              00248615
002488***************************************************************** 00248815
002489* CHANGED 08/16/2022    BY BARB SCHULTZ    WR: CHG0273427         00248917
002490* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00249017
002491* MAKING THE CALL DYNAMIC VS STATIC.                              00249117
002492***************************************************************** 00249216
002493* CHANGED 11/09/2022    BY JIM HUNTER      WR: CHG0278008         00249318
002494* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00249418
002495* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00249518
002496*-----------------------------------------------------------------00249618
002497 EJECT                                                            00249716
002498 ENVIRONMENT DIVISION.                                            00249816
002499                                                                  00249916
002500 DATA DIVISION.                                                   00250000
002600                                                                  00260000
002700 WORKING-STORAGE SECTION.                                         00270000
002800                                                                  00280000
002900*----------------------------------------------------------------*00290000
003000*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *00300000
003100*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *00310000
003200*----------------------------------------------------------------*00320000
003300                                                                  00330000
003400     COPY RCWS013.                                                00340000
003500/                                                                 00350000
003600     COPY PCWS016.                                                00360000
003700*CLP 09/03/13 BEGIN                                               00370000
003800     COPY SUWS010.                                                00380000
003900*CLP 09/03/13 END                                                 00390000
004000/                                                                 00400000
004100     COPY DSWS002.                                                00410000
004200                                                                  00420000
004300 01  DK-DB2-KEYS.                                                 00430000
004400     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP.         00440000
004500     05  DK-OPER-UNT-ID-LOW             PIC S9(04)  COMP.         00450000
004600     05  DK-OPER-UNT-ID-HIGH            PIC S9(04)  COMP.         00460000
004700     05  DK-DEPT-NBR                    PIC  X(03).               00470000
004800     05  DK-DEPT-LOW                    PIC  X(03).               00480000
004900     05  DK-DEPT-HIGH                   PIC  X(03).               00490000
005000     05  DK-BUYER-NBR                   PIC  X(03).               00500000
005100     05  DK-BUYER-NBR-N                 REDEFINES                 00510000
005200         DK-BUYER-NBR                   PIC  9(03).               00520000
005300     05  DK-PO-NBR                      PIC S9(09)  COMP.         00530000
005400     05  DK-PO-NBR-LOW                  PIC S9(09)  COMP.         00540000
005500     05  DK-PO-NBR-HIGH                 PIC S9(09)  COMP.         00550000
005600     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP.         00560000
005700     05  DK-REC-SEQ-NBR-LOW             PIC S9(09)  COMP.         00570000
005800     05  DK-REC-SEQ-NBR-HIGH            PIC S9(09)  COMP.         00580000
005900     05  DK-RESP-AREA-1                 PIC  X(01).               00590000
006000     05  DK-RESP-AREA-2                 PIC  X(01).               00600000
006100     05  DK-RESP-AREA-3                 PIC  X(01).               00610000
006200     05  DK-TRBL-RSN-LOW                PIC S9(04)  COMP.         00620000
006300     05  DK-TRBL-RSN-HIGH               PIC S9(04)  COMP.         00630000
006400     05  DK-TRBL-RSN-CDE                PIC S9(04)  COMP.         00640000
006500     05  DK-NOTIF-STAT-1                PIC  X(01).               00650000
006600     05  DK-NOTIF-STAT-2                PIC  X(01).               00660000
006700     05  DK-NOTIF-STAT-3                PIC  X(01).               00670000
006800     05  DK-NOTIF-STAT-4                PIC  X(01).               00680000
006900     05  DK-LOW-REC-TMST                PIC  X(26)  VALUE SPACES. 00690000
007000     05  DK-HIGH-REC-TMST               PIC  X(26)  VALUE SPACES. 00700000
007100     05  DK-VENDOR-NAME                 PIC  X(30).               00710000
007200     05  DK-ENT-ID                      PIC S9(09)  COMP.         00720000
007210     05  DK-SEASET-YR-1                 PIC  X(04).               00721023
007220     05  DK-SEASET-YR-2                 PIC  X(04).               00722023
007230     05  DK-SEASET-YR-3                 PIC  X(04).               00723023
007240     05  DK-SEASET-YR-4                 PIC  X(04).               00724023
007250     05  DK-SEASET-YR-5                 PIC  X(04).               00725023
007260     05  DK-SEASET-YR-6                 PIC  X(04).               00726023
007270     05  DK-SEASET-SHRT-NM-1            PIC  X(05).               00727023
007280     05  DK-SEASET-SHRT-NM-2            PIC  X(05).               00728023
007290     05  DK-SEASET-SHRT-NM-3            PIC  X(05).               00729023
007291     05  DK-SEASET-SHRT-NM-4            PIC  X(05).               00729123
007292     05  DK-SEASET-SHRT-NM-5            PIC  X(05).               00729223
007293     05  DK-SEASET-SHRT-NM-6            PIC  X(05).               00729323
007300                                                                  00730000
007400 01  PC-PROGRAM-CONSTANTS.                                        00740000
007500     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00750000
007600                                                    'TM532A  '.   00760000
007700     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00770000
007800                                                    'TMKM532 '.   00780000
007900     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00790000
008000                                                    'TMKCS532'.   00800000
008100     05  PC-TMKCS520                    PIC  X(08)  VALUE         00810000
008200                                                    'TMKCS520'.   00820000
008500     05  PC-TMKUP501-RTN              PIC X(08)  VALUE            00850000
008510                                                       'TMKUP501'.00851000
008520     05  PC-TMKUP501-LENGTH           PIC S9(04) VALUE +800       00852000
008530                                                   COMP.          00853000
008540     05  PC-CORPORATE-OFFICE            PIC S9(04)  VALUE +0090.  00854000
008550     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00855000
008560     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00856000
008570     05  PC-ENTERED-USING-IND           PIC  X(01).               00857000
008580         88  PC-CRIT-SPEC-FORMAT              VALUE '1'.          00858000
008590         88  PC-ENTERED-USING-PO-PO011        VALUE '2'.          00859000
008600         88  PC-ENTERED-USING-PO-PO017        VALUE '3'.          00860000
008700         88  PC-ENTERED-USING-PO-PO013        VALUE '4'.          00870000
008800         88  PC-ENTERED-USING-PO-RC012        VALUE '5'.          00880000
008900         88  PC-ENTERED-USING-PO-RC015        VALUE '6', 'A'.     00890000
009000         88  PC-ENTERED-USING-PO-TR001        VALUE '7'.          00900000
009100         88  PC-ENTERED-USING-PO-PC000        VALUE '8'.          00910000
009200         88  PC-ENTERED-USING-PO-DS604        VALUE '9'.          00920000
009300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00930000
009400                                                    COMP SYNC.    00940000
009500     05  PC-ITEMS-PER-PANEL-COMP3       PIC S9(09)  VALUE +13     00950000
009600                                                    COMP-3.       00960000
009700     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00970000
009800                                                    COMP SYNC.    00980000
009900     05  PC-MAX-TABLE-ENTRIES           PIC S9(04)  VALUE +20     00990000
010000                                                    COMP SYNC.    01000000
010100     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         01010000
010200                                                    +1000000      01020000
010300                                                    COMP-3.       01030000
010400     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      01040000
010500                                                    COMP SYNC.    01050000
010600     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       01060000
010700                                                    COMP-3.       01070000
010800     05  PC-NINE                        PIC  X(01)  VALUE '9'.    01080000
010900     05  PC-000000000                   PIC S9(09)  VALUE         01090000
011000                                                    +000000000    01100000
011100                                                    COMP.         01110000
011200     05  PC-999999999                   PIC S9(09)  VALUE         01120000
011300                                                    +999999999    01130000
011400                                                    COMP.         01140000
011500     05  PC-NOT-FOUND                   PIC  X(15)  VALUE         01150000
011600            '** NOT FOUND **'.                                    01160000
011700     05  PC-MULTI-BUYERS                PIC  X(15)  VALUE         01170000
011800            'MULTIPLE BUYERS'.                                    01180000
011900     05  PC-MULTI-ANALYSTS              PIC  X(17)  VALUE         01190000
012000            'MULTIPLE ANALYSTS'.                                  01200000
012100     05  PC-ALL                         PIC  X(03)  VALUE 'ALL'.  01210000
012200     05  PC-ACTIVE-STATUS               PIC  X(01)  VALUE 'A'.    01220000
012300     05  PC-NEW-TROUBLE                 PIC  X(01)  VALUE 'N'.    01230000
012400     05  PC-IN-PROCESS-TROUBLE          PIC  X(01)  VALUE 'I'.    01240000
012500     05  PC-RESOLVED-TROUBLE            PIC  X(01)  VALUE 'R'.    01250000
012600     05  PC-ACKNOWLEDGED-TROUBLE        PIC  X(01)  VALUE 'A'.    01260000
012700     05  PC-BUY-ANALYST-DC-SW           PIC  X(01)  VALUE 'A'.    01270000
012800     05  PC-BUYER                       PIC  X(01)  VALUE 'B'.    01280000
012900     05  PC-ANALYST                     PIC  X(01)  VALUE 'A'.    01290000
013000     05  PC-BUYER-ANALYST-DC            PIC  X(01)  VALUE 'D'.    01300000
013100     05  PC-SLASH                       PIC  X(01)  VALUE '/'.    01310000
013200     05  PC-SPACE                       PIC  X(01)  VALUE ' '.    01320000
013300     05  PC-TYPE-CODE-LONG-NAME         PIC  X(02)  VALUE '01'.   01330000
013400     05  PC-TYPE-CODE-SHORT-NAME        PIC  X(02)  VALUE '04'.   01340000
013500     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  01350000
013600     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  01360000
013700     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  01370000
013800     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  01380000
013900     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    01390000
014000     05  PC-DUMMY-DB2-DATE-LOW          PIC  X(26)  VALUE         01400000
014100         '0001-01-01-00.00.00.000000'.                            01410000
014200     05  PC-DUMMY-DB2-DATE-HIGH         PIC  X(26)  VALUE         01420000
014300         '9999-09-09-09.09.09.999999'.                            01430000
014400     05  PC-DUMMY-DB2-DATE              PIC  X(26)  VALUE         01440000
014500         '9999-09-09-09.09.09.999999'.                            01450000
014600     05  PC-DUMMY-DATE                  PIC  X(10)  VALUE         01460000
014700                                        '9999-09-09'.             01470000
014800     05  PC-DC-CHECKED-MSG              PIC  X(10)  VALUE         01480000
014900         'DC CHECKED'.                                            01490000
015000                                                                  01500000
015100     05  PC-TSYMSG-NUMBERS.                                       01510000
015200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01520000
015300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01530000
015400         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01540000
015500*        ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION     01550000
015600         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01560000
015700         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01570000
015800         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01580000
015900         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01590000
016000         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01600000
016100         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01610000
016200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01620000
016300         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01630000
016400         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01640000
016500         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01650000
016600         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01660000
016700         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01670000
016800                                                                  01680000
016900         10  PC-TSYMSG-00938            PIC  9(05)  VALUE 00938.  01690000
017000*        TROUBLE/NOTIF HAS ALREADY BEEN RESOLVED                  01700000
017100                                                                  01710000
017200         10  PC-TSYMSG-00986            PIC  9(05)  VALUE 00986.  01720000
017300*        NOTIF/TROUBLE LIST-BY-LINE SCREEN MUST BE USED           01730000
017400                                                                  01740000
017500         10  PC-TSYMSG-00994            PIC  9(05)  VALUE 00994.  01750000
017600*        TABLE LIMITS EXCEEDED, RESULTS COULD BE INACCURATE,      01760000
017700*        CONTACT HELP DESK                                        01770000
017800                                                                  01780000
017900         10  PC-TSYMSG-01025            PIC  9(05)  VALUE 01025.  01790000
018000*        TROUBLE RESOLUTION NOT REQUIRED                          01800000
018100                                                                  01810000
018200         10  PC-TSYMSG-01029            PIC  9(05)  VALUE 01029.  01820000
018300*        DEPARTMENT, BUYER, OR PO NBR REQUIRED FOR LIST           01830000
018400                                                                  01840000
018500         10  PC-TSYMSG-01030            PIC  9(05)  VALUE 01030.  01850000
018600*        INVALID TROUBLE SELECTION REASON ENTERED                 01860000
018700                                                                  01870000
018800         10  PC-TSYMSG-01031            PIC  9(05)  VALUE 01031.  01880000
018900*        TROUBLE MUST BE RESOLVED MANUALLY                        01890000
019000                                                                  01900000
019100         10  PC-TSYMSG-01032            PIC  9(05)  VALUE 01032.  01910000
019200*        RECORD IS ALREADY IN PROCESS                             01920000
019300                                                                  01930000
019400         10  PC-TSYMSG-01033            PIC  9(05)  VALUE 01033.  01940000
019500*        RECORD IS RESOLVED - IN-PROCESS REQUEST INVALID          01950000
019600                                                                  01960000
019700         10  PC-TSYMSG-01034            PIC  9(05)  VALUE 01034.  01970000
019800*        SOME UNRESOLVED TROUBLE STILL EXISTS                     01980000
019900                                                                  01990000
020000         10  PC-TSYMSG-01036            PIC  9(05)  VALUE 01036.  02000000
020100*        NOTIFICATION/TROUBLE IS ACKNOWLEDGED - CAN NOT RESOLVE   02010000
020200                                                                  02020000
020300         10  PC-TSYMSG-03248            PIC  9(05)  VALUE 03248.  02030000
020400*        GO TO AUTO STORE UNIT ADJUST TO ACKNOWLEDGE FAIL         02040000
020500*        STORE ADJUST TROUBLE                                     02050000
020600                                                                  02060000
020700         10  PC-TSYMSG-01037            PIC  9(05)  VALUE 01037.  02070000
020800*        RECORD IS NOT RESOLVED - CANNOT ACKNOWLEDGE              02080000
020900                                                                  02090000
021000         10  PC-TSYMSG-01038            PIC  9(05)  VALUE 01038.  02100000
021100*        NOTIFICATION/TROUBLE NOT FOUND                           02110000
021200                                                                  02120000
021300         10  PC-TSYMSG-01089            PIC  9(05)  VALUE 01089.  02130000
021400*        NOTIFICATION/TROUBLE NOT AVAILABLE                       02140000
021500                                                                  02150000
021600         10  PC-TSYMSG-01839            PIC  9(05)  VALUE 01839.  02160000
021700*        NOTIFICATION/TROUBLE IS ACKNOWLEDGED - CAN NOT           02170000
021800*        ACKNOWLEDGE                                              02180000
021900                                                                  02190000
022000         10  PC-TSYMSG-02184            PIC  9(05)  VALUE 02184.  02200000
022100*        INVALID FUNCTION FOR PREPACK RECEIVERS                   02210000
022200         10  PC-TSYMSG-02192            PIC  9(05)  VALUE 02192.  02220000
022300*        REC SEQ NBR NOT FOUND                                    02230000
022400         10  PC-TSYMSG-03383            PIC  9(05)  VALUE 03383.  02240000
022500*        ACKNOWLEDGE WAS DONE MANUALLY, NO REDISTRO WAS PERFORMED 02250000
022600                                                                  02260000
022700 01  PS-PROGRAM-SWITCHES.                                         02270000
022800     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02280000
022900         88  PS-LIST-END                            VALUE 'Y'.    02290000
023000         88  PS-NO-LIST-END                         VALUE 'N'.    02300000
023100     05  PS-AUTO-AUTOACKNL-IND          PIC  X(01)  VALUE 'N'.    02310000
023200         88  PS-AUTO-AUTOACKNL-IND-YES              VALUE 'Y'.    02320000
023300         88  PV-AUTO-AUTOACKNL-IND-NO               VALUE 'N'.    02330000
023400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02340000
023500         88  PS-NO-ERROR                            VALUE 'Y'.    02350000
023600         88  PS-ERROR                               VALUE 'N'.    02360000
023700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02370000
023800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02380000
023900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02390000
024000     05  PS-PO-NBR-ENTERED-SW           PIC  X(01)  VALUE 'N'.    02400000
024100         88  PS-PO-NBR-ENTERED                      VALUE 'Y'.    02410000
024200         88  PS-PO-NBR-NOT-ENTERED                  VALUE 'N'.    02420000
024300     05  PS-TRBL-RSN-LOADED-SW          PIC  X(01)  VALUE 'N'.    02430000
024400         88  PS-TRBL-RSN-LOADED                     VALUE 'Y'.    02440000
024500         88  PS-TRBL-RSN-NOT-LOADED                 VALUE 'N'.    02450000
024600     05  PS-DISPLAY-LINE-SW             PIC  X(01)  VALUE 'Y'.    02460000
024700         88  PS-DISPLAY-TROUBLE-LINE                VALUE 'Y'.    02470000
024800         88  PS-DO-NOT-DISPLAY-TROUBLE-LINE         VALUE 'N'.    02480000
024900     05  PS-PROCESS-LINE-SW             PIC  X(01)  VALUE 'Y'.    02490000
025000         88  PS-PROCESS-TROUBLE-LINE                VALUE 'Y'.    02500000
025100         88  PS-DO-NOT-PROCESS-LINE                 VALUE 'N'.    02510000
025200     05  PS-RESOLVE-REQUEST-SW          PIC  X(01)  VALUE 'N'.    02520000
025300         88  PS-RESOLVE-REQUEST                     VALUE 'Y'.    02530000
025400         88  PS-NOT-A-RESOLVE-REQUEST               VALUE 'N'.    02540000
025500     05  PS-DC-CHEK-REQUEST-SW          PIC  X(01)  VALUE 'N'.    02550000
025600         88  PS-DC-CHEK-REQUEST                     VALUE 'Y'.    02560000
025700     05  PS-FIRST-TIME-SW               PIC  X(01)  VALUE 'Y'.    02570000
025800         88  PS-FIRST-TIME                          VALUE 'Y'.    02580000
025900         88  PS-NOT-FIRST-TIME                      VALUE 'N'.    02590000
026000     05  PS-ITEMS-LEFT-SW               PIC  X(01)  VALUE 'Y'.    02600000
026100         88  PS-TRBL-NOTIF-ITEMS-LEFT               VALUE 'Y'.    02610000
026200         88  PS-NO-TRBL-NOTIF-ITEMS-LEFT            VALUE 'N'.    02620000
026300     05  PS-TRBL-DTL-EXISTS-SW          PIC  X(01)  VALUE 'N'.    02630000
026400         88  PS-TRBL-DTL-EXISTS                     VALUE 'Y'.    02640000
026500         88  PS-NO-TRBL-DTL-EXISTS                  VALUE 'N'.    02650000
026600     05  PS-PREPACK-RCVR-SW             PIC  X(01)  VALUE 'N'.    02660000
026700         88  PS-PREPACK-RCVR-YES                    VALUE 'Y'.    02670000
026800         88  PS-PREPACK-RCVR-NO                     VALUE 'N'.    02680000
026900     05  PS-USE-CSR-SW                  PIC  X(02)  VALUE ' '.    02690000
027000**** LIST SEQ. BY ARRIVAL DATE                                    02700000
027100         88  PS-USE-OPER-UNT-ARR-CSR           VALUE 'OA'.        02710000
027110         88  PS-USE-OPER-UNT-ARR-INCL-CSR      VALUE 'OI'.        02711027
027120         88  PS-USE-OPER-UNT-ARR-EXCL-CSR      VALUE 'OX'.        02712027
027200         88  PS-USE-DEPT-ARR-CSR               VALUE 'DA'.        02720000
027210         88  PS-USE-DEPT-ARR-INCL-CSR          VALUE 'DI'.        02721027
027220         88  PS-USE-DEPT-ARR-EXCL-CSR          VALUE 'DX'.        02722027
027300         88  PS-USE-BYR-ARR-CSR                VALUE 'BA'.        02730000
027310         88  PS-USE-BYR-ARR-INCL-CSR           VALUE 'B1'.        02731027
027320         88  PS-USE-BYR-ARR-EXCL-CSR           VALUE 'BX'.        02732027
027400         88  PS-USE-PORCVR-ARR-CSR             VALUE 'PA'.        02740000
027410         88  PS-USE-PORCVR-ARR-INCL-CSR        VALUE 'PI'.        02741029
027420         88  PS-USE-PORCVR-ARR-EXCL-CSR        VALUE 'PX'.        02742029
027500**** LIST SEQ. BY OLDEST TO NEWEST TROUBLE                        02750000
027600         88  PS-USE-OPER-UNT-TRB-CSR           VALUE 'OT'.        02760000
027610         88  PS-USE-OPER-UNT-TRB-INCL-CSR      VALUE 'OI'.        02761027
027620         88  PS-USE-OPER-UNT-TRB-EXCL-CSR      VALUE 'OX'.        02762027
027700         88  PS-USE-DEPT-TRB-CSR               VALUE 'DT'.        02770000
027710         88  PS-USE-DEPT-TRB-INCL-CSR          VALUE 'DI'.        02771027
027720         88  PS-USE-DEPT-TRB-EXCL-CSR          VALUE 'DX'.        02772027
027800         88  PS-USE-BYR-TRB-CSR                VALUE 'BT'.        02780000
027810         88  PS-USE-BYR-TRB-INCL-CSR           VALUE 'BI'.        02781028
027820         88  PS-USE-BYR-TRB-EXCL-CSR           VALUE 'BX'.        02782027
027900         88  PS-USE-PORCVR-TRB-CSR             VALUE 'PT'.        02790000
027910         88  PS-USE-PORCVR-TRB-INCL-CSR        VALUE 'PI'.        02791027
027920         88  PS-USE-PORCVR-TRB-EXCL-CSR        VALUE 'PX'.        02792027
028000*                                                                 02800000
028100 01  PV-PROGRAM-VARIABLES.                                        02810000
028200     05  PV-PO-RECEIVER.                                          02820030
028300         10  PV-PO-NBR-Z                PIC Z(9).                 02830030
028400         10  PV-PO-RCVR-DASH            PIC X(1)  VALUE '-'.      02840030
028500         10  PV-RECEIVER                PIC 999.                  02850030
028600     05  PV-PO-RECEIVER-P.                                        02860030
028700         10  PV-PO-NBR-P                PIC 9(8).                 02870030
028800         10  PV-PO-RCVR-DASH-P          PIC X(1)  VALUE '-'.      02880030
028810         10  PV-RECEIVER-P              PIC 999.                  02881030
028820     05  PV-NBR-SELECTED-ON-PREV-LIST   PIC S9(09)        COMP-3. 02882000
028830     05  PV-SUB                         PIC S9(04)  VALUE +0      02883000
028840                                                    COMP SYNC.    02884000
028850     05  PV-SUB-COMP3                   PIC S9(09)  VALUE +0      02885000
028860                                                    COMP-3.       02886000
028870     05  PV-ASC-ITEM-SUB-COMP3          PIC S9(09)  VALUE +0      02887000
028880                                                    COMP-3.       02888000
028890     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02889000
028900                                                    COMP SYNC.    02890000
029000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02900000
029100                                                    COMP-3.       02910000
029200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02920000
029300                                                    COMP-3.       02930000
029400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02940000
029500                                                    COMP-3.       02950000
029600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02960000
029700                                                    COMP-3.       02970000
029800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02980000
029900                                                    COMP-3.       02990000
030000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03000000
030100                                                    COMP-3.       03010000
030200     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03020000
030300                                                    COMP SYNC.    03030000
030400     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03040000
030500                                                    COMP SYNC.    03050000
030600     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      03060000
030700                                                    COMP SYNC.    03070000
030800     05  PV-ITEM                        PIC S9(04)  VALUE +0      03080000
030900                                                    COMP SYNC.    03090000
031000     05  PV-ITEM-COMP3                  PIC S9(09)  VALUE +0      03100000
031100                                                    COMP-3.       03110000
031200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03120000
031300                                                    COMP SYNC.    03130000
031400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03140000
031500                                                    COMP SYNC.    03150000
031600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03160000
031700                                                    COMP SYNC.    03170000
031800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03180000
031900                                                    COMP SYNC.    03190000
032000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03200000
032100                                                    COMP SYNC.    03210000
032200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03220000
032300                                                    COMP SYNC.    03230000
032400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03240000
032500                                                    COMP SYNC.    03250000
032600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03260000
032700                                                    COMP SYNC.    03270000
032800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03280000
032900                                                    COMP SYNC.    03290000
033000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03300000
033100                                                    COMP SYNC.    03310000
033200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03320000
033300                                                    COMP SYNC.    03330000
033400     05  PV-TRBL-RSN-SUB                PIC S9(04)  VALUE +0      03340000
033500                                                    COMP SYNC.    03350000
033600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03360000
033700                                                    COMP SYNC.    03370000
033800     05  PV-PREV-REC-SEQ-NBR            PIC S9(09)  VALUE +0      03380000
033900                                                    COMP SYNC.    03390000
034000     05  PV-UNRESOLVED-TROUBLE-COUNT    PIC S9(09)  VALUE +0      03400000
034100                                                    COMP-3.       03410000
034200     05  PV-NOT-ACK-CNT                 PIC S9(09)  VALUE +0      03420000
034300                                                    COMP-3.       03430000
034400     05  PV-PREV-PO-NBR                 PIC S9(09)  VALUE +0      03440000
034500                                                    COMP SYNC.    03450000
034600     05  PV-PREV-DEPT-NBR               PIC  X(03)  VALUE SPACES. 03460000
034700     05  PV-TRBL-REASON-LOW             PIC  X(03)  VALUE SPACES. 03470000
034800     05  PV-TRBL-REASON-HIGH            PIC  X(03)  VALUE SPACES. 03480000
034900     05  PV-PO-NBR                      PIC  9(08)  VALUE ZEROS.  03490000
035000     05  PV-MAX-RESP-DATE               PIC  X(26)  VALUE SPACES. 03500000
035010*TV 10/08/2014 CHANGE STARTS                                      03501009
035100     05  PV-ERROR-PO-NBR                PIC  9(08)  VALUE ZEROS.  03510006
035110*TV 10/08/2014 CHANGE ENDS                                        03511009
035200     05  PV-ERROR-REC-SEQ-NBR           PIC  9(04)  VALUE ZEROS.  03520000
035300     05  PV-ERROR-PO-LNE-NBR            PIC  9(04)  VALUE ZEROS.  03530000
035400     05  PV-ERROR-PACK-ID               PIC  9(04)  VALUE ZEROS.  03540000
035500     05  PV-ERROR-NOTIF-NBR             PIC  9(09)  VALUE ZEROS.  03550000
035600     05  PV-ERROR-TRBL-RSN-CDE          PIC  9(04)  VALUE ZEROS.  03560000
035700     05  PV-TIMESTAMP                   PIC  X(26)  VALUE SPACES. 03570000
035800     05  PV-TIMESTAMP-R                 REDEFINES                 03580000
035900         PV-TIMESTAMP.                                            03590000
036000         10  PV-TIMESTAMP-YEAR          PIC  9(04).               03600000
036100         10  FILLER                     PIC  X(01).               03610000
036200         10  PV-TIMESTAMP-MONTH         PIC  9(02).               03620000
036300         10  FILLER                     PIC  X(01).               03630000
036400         10  PV-TIMESTAMP-DAY           PIC  9(02).               03640000
036500         10  FILLER                     PIC  X(01).               03650000
036600         10  PV-TIMESTAMP-HOUR          PIC  9(02).               03660000
036700         10  FILLER                     PIC  X(01).               03670000
036800         10  PV-TIMESTAMP-MINUTE        PIC  9(02).               03680000
036900         10  FILLER                     PIC  X(01).               03690000
037000         10  PV-TIMESTAMP-SECONDS       PIC  9(02).               03700000
037100         10  FILLER                     PIC  X(01).               03710000
037200         10  PV-TIMESTAMP-MILLISECONDS  PIC  9(06).               03720000
037300     05  PV-FIRST-NAME.                                           03730000
037400         10 PV-FIRST-NAME-BYTE OCCURS 12 TIMES INDEXED BY INX1    03740000
037500                                        PIC X(01).                03750000
037600     05  PV-LAST-NAME.                                            03760000
037700         10 PV-LAST-NAME-BYTE  OCCURS 18 TIMES INDEXED BY INX2    03770000
037800                                        PIC X(01).                03780000
037900     05  PV-NAME.                                                 03790000
038000         10 PV-NAME-BYTE       OCCURS 30 TIMES INDEXED BY INX3    03800000
038100                                        PIC X(01).                03810000
038200     05  PV-UNPACK-OPER-UNT-ID          PIC  9(04) VALUE ZERO.    03820000
038300     05  PV-LOC-5-NM.                                             03830000
038400         10 PV-DC                       PIC  X(02) VALUE SPACES.  03840000
038500         10 FILLER                      PIC  X(01) VALUE SPACES.  03850000
038600         10 PV-DC-NME                   PIC  X(02) VALUE SPACES.  03860000
038700     05  PV-LOC-4-CHAR-NM.                                        03870000
038800         10 PV-DC-NME-4                 PIC  X(02) VALUE SPACES.  03880000
038900         10 PV-DC-4                     PIC  X(02) VALUE SPACES.  03890000
039000     05  PV-STORE-X.                                              03900000
039100         10  PV-STORE-N                 PIC  9(04) VALUE ZERO.    03910000
039200*                                                                 03920000
039300 01  TR-TROUBLE-REASON-TABLE.                                     03930000
039400     05  TR-TROUBLE-REASON-ENTRY        OCCURS 20 TIMES           03940000
039500                                        INDEXED BY TR-TRBL-IDX.   03950000
039600         10  TR-TROUBLE-REASON          PIC  X(04)  VALUE SPACES. 03960000
039700         10  TR-TROUBLE-REASON-N        REDEFINES                 03970000
039800             TR-TROUBLE-REASON          PIC  9(04).               03980000
039900*                                                                 03990000
040000******************************************************************04000000
040100*  LOGISTICS DOMAIN LOCATION MODULE (XLKUT071)                    04010000
040200******************************************************************04020000
040300     COPY XLWS071.                                                04030000
040400*                                                                 04040000
040500******************************************************************04050000
040600**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **04060000
040700**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **04070000
040800**  APPLICATION-SPECIFIC COMMAREA.                              **04080000
040900******************************************************************04090000
041000 01  LQW-LIST-QUEUE-WORK-AREA.                                    04100000
041100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04110000
041200     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           04120000
041300                                        INDEXED BY LQW-IDX.       04130000
041400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04140000
041500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04150000
041600         10  LQW-SELECTED-SW            PIC  X(01).               04160000
041700             88  LQW-SELECT                         VALUE 'S'.    04170000
041800             88  LQW-DESELECT                       VALUE ' '.    04180000
041900         10  LQW-ACTION                 PIC  X(03).               04190000
042000             88  LQW-ERROR                          VALUE 'ERR'.  04200000
042100             88  LQW-INQUIRE                        VALUE 'INQ'.  04210000
042200             88  LQW-UPDATE                         VALUE 'UPD'.  04220000
042300         10  LQW-NOTIF-NBR              PIC S9(09)  COMP.         04230000
042400         10  LQW-OPER-UNT-ID            PIC S9(04)  COMP.         04240000
042500         10  LQW-FCLTY-ID               PIC S9(04)  COMP.         04250000
042600         10  LQW-DEPT                   PIC  9(03).               04260000
042610*TV 10/08/2014 CHANGE STARTS                                      04261009
042700         10  LQW-PO-NBR                 PIC  9(08).               04270006
042710*TV 10/08/2014 CHANGE ENDS                                        04271009
042800         10  LQW-RCVR-SEQ-NBR           PIC  9(04).               04280000
042900         10  LQW-PO-LNE-NBR             PIC  9(04).               04290000
043000         10  LQW-PREPK-ID               PIC  9(04).               04300000
043100         10  LQW-ENT-ID                 PIC S9(09)  COMP.         04310000
043200         10  LQW-VENDOR-SHORT-NME       PIC  X(10).               04320000
043300         10  LQW-FCLTY-SHORT-NME        PIC  X(04).               04330000
043400         10  LQW-TROUBLE-REASON-CDE     PIC S9(04)  COMP.         04340000
043500         10  LQW-TROUBLE-REASON-DESC    PIC  X(10).               04350000
043600         10  LQW-TROUBLE-RESP-RES-IND   PIC  X(01).               04360000
043700             88  LQW-RESOLVE-NOT-REQUIRED           VALUE ' '.    04370000
043800             88  LQW-RESOLVE-TRBL-AUTO              VALUE 'A'.    04380000
043900             88  LQW-RESOLVE-TRBL-MANUAL            VALUE 'M'.    04390000
044000             88  LQW-RESOLVE-TRBL-BOTH-AUTO-MAN     VALUE 'B'.    04400000
044100         10  LQW-TROUBLE-REASON-LVL     PIC  X(01).               04410000
044200             88  LQW-TROUBLE-PO-LEVEL               VALUE 'P'.    04420000
044300             88  LQW-TROUBLE-PACK-LEVEL             VALUE 'M'.    04430000
044400             88  LQW-TROUBLE-LINE-LEVEL             VALUE ' '     04440000
044500                                                          'L'     04450000
044600                                                          'S'     04460000
044700                                                          'X'.    04470000
044800         10  LQW-ARRIVAL-DATE-TIME      PIC  X(08).               04480000
044900         10  LQW-NOTIFICATION-DATE-TIME PIC  X(08).               04490000
045000         10  LQW-RESPONSE-DATE-TIME     PIC  X(08).               04500000
045100         10  LQW-TRBL-DTL-EXISTS-SW     PIC  X(01).               04510000
045200         10  LQW-TRBL-RESOLVED-SW       PIC  X(01).               04520000
045300             88  LQW-TRBL-RESOLVED                  VALUE 'Y'.    04530000
045400         10  LQW-TRBL-ACK-SW            PIC  X(01).               04540000
045500             88  LQW-TRBL-ACK                       VALUE 'Y'.    04550000
045600             88  LQW-TRBL-NOT-ACK                   VALUE 'N'.    04560000
045700                                                                  04570000
045800                                                                  04580000
045900*---------------------------------------------------------------* 04590000
046000*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 04600000
046100*---------------------------------------------------------------* 04610000
046200                                                                  04620000
046300     COPY TMWS002.                                                04630000
046400                                                                  04640000
046500                                                                  04650000
046600*---------------------------------------------------------------* 04660000
046700*  RECORD LAYOUT FOR THE PO INQUIRY AND UPDATE SELECTION TEMP   * 04670000
046800*  STORAGE QUEUE                                                * 04680000
046900*---------------------------------------------------------------* 04690000
047000                                                                  04700000
047100     COPY POWS012.                                                04710000
047200                                                                  04720000
047300*---------------------------------------------------------------* 04730000
047400*  SELECTION QUEUE LAYOUT                                       * 04740000
047500*---------------------------------------------------------------* 04750000
047600     COPY SUWS039.                                                04760000
047700                                                                  04770000
047800                                                                  04780000
047900*---------------------------------------------------------------* 04790000
048000*    MAP LAYOUT                                                 * 04800000
048100*---------------------------------------------------------------* 04810000
048200                                                                  04820000
048300     COPY TMKM532.                                                04830000
048400*                                                                 04840000
048500 01  MR-OCCURS-LAYOUT                   REDEFINES  TM532AO.       04850000
048600     05  FILLER                         PIC X(42).                04860039
048700     05  FILLER.                                                  04870000
048800         10  MR-BYR-NBRL                PIC S9(04) COMP.          04880000
048900         10  MR-BYR-NBRA                PIC X(01).                04890000
049000         10  MR-BYR-NBRC                PIC X(01).                04900000
049100         10  MR-BYR-NBRH                PIC X(01).                04910048
049200         10  MR-BYR-NBR                 PIC X(03).                04920000
049300     05  FILLER.                                                  04930000
049400         10  MR-BYR-NMEL                PIC S9(04) COMP.          04940000
049500         10  MR-BYR-NMEA                PIC X(01).                04950000
049600         10  MR-BYR-NMEC                PIC X(01).                04960000
049700         10  MR-BYR-NMEH                PIC X(01).                04970000
049800         10  MR-BYR-NME                 PIC X(25).                04980000
049900     05  FILLER.                                                  04990048
049901         10  MR-SETDESCL                PIC S9(04) COMP.          04990148
049902         10  MR-SETDESCA                PIC X(01).                04990248
049903         10  MR-SETDESCC                PIC X(01).                04990348
049904         10  MR-SETDESCH                PIC X(01).                04990448
049905         10  MR-SETDESC                 PIC X(07).                04990548
049910     05  FILLER.                                                  04991043
049920         10  MR-SETYR01L                PIC S9(04) COMP.          04992043
049930         10  MR-SETYR01A                PIC X(01).                04993043
049940         10  MR-SETYR01C                PIC X(01).                04994043
049950         10  MR-SETYR01H                PIC X(01).                04995043
049960         10  MR-SETYR01                 PIC X(04).                04996043
049970     05  FILLER.                                                  04997043
049980         10  MR-SETYR02L                PIC S9(04) COMP.          04998043
049990         10  MR-SETYR02A                PIC X(01).                04999043
049991         10  MR-SETYR02C                PIC X(01).                04999143
049992         10  MR-SETYR02H                PIC X(01).                04999243
049993         10  MR-SETYR02                 PIC X(04).                04999343
049994     05  FILLER.                                                  04999443
049995         10  MR-SETYR03L                PIC S9(04) COMP.          04999543
049996         10  MR-SETYR03A                PIC X(01).                04999643
049997         10  MR-SETYR03C                PIC X(01).                04999743
049998         10  MR-SETYR03H                PIC X(01).                04999843
049999         10  MR-SETYR03                 PIC X(04).                04999943
050000     05  FILLER.                                                  05000043
050001         10  MR-SETYR04L                PIC S9(04) COMP.          05000143
050002         10  MR-SETYR04A                PIC X(01).                05000243
050003         10  MR-SETYR04C                PIC X(01).                05000343
050004         10  MR-SETYR04H                PIC X(01).                05000443
050005         10  MR-SETYR04                 PIC X(04).                05000543
050006     05  FILLER.                                                  05000643
050007         10  MR-SETYR05L                PIC S9(04) COMP.          05000743
050008         10  MR-SETYR05A                PIC X(01).                05000843
050009         10  MR-SETYR05C                PIC X(01).                05000943
050010         10  MR-SETYR05H                PIC X(01).                05001043
050011         10  MR-SETYR05                 PIC X(04).                05001143
050012     05  FILLER.                                                  05001243
050013         10  MR-SETYR06L                PIC S9(04) COMP.          05001343
050014         10  MR-SETYR06A                PIC X(01).                05001443
050015         10  MR-SETYR06C                PIC X(01).                05001543
050016         10  MR-SETYR06H                PIC X(01).                05001643
050017         10  MR-SETYR06                 PIC X(04).                05001743
050020     05  FILLER.                                                  05002000
050100         10  MR-ANL-NMEL                PIC S9(04) COMP.          05010000
050200         10  MR-ANL-NMEA                PIC X(01).                05020000
050300         10  MR-ANL-NMEC                PIC X(01).                05030000
050400         10  MR-ANL-NMEH                PIC X(01).                05040000
050500         10  MR-ANL-NME                 PIC X(25).                05050000
050511     05  FILLER.                                                  05051143
050512         10  MR-SETDES2L                PIC S9(04) COMP.          05051248
050513         10  MR-SETDES2A                PIC X(01).                05051348
050514         10  MR-SETDES2C                PIC X(01).                05051448
050515         10  MR-SETDES2H                PIC X(01).                05051548
050516         10  MR-SETDES2                 PIC X(04).                05051648
050520     05  FILLER.                                                  05052043
050530         10  MR-SETCD01L                PIC S9(04) COMP.          05053043
050540         10  MR-SETCD01A                PIC X(01).                05054043
050550         10  MR-SETCD01C                PIC X(01).                05055043
050560         10  MR-SETCD01H                PIC X(01).                05056043
050570         10  MR-SETCD01                 PIC X(05).                05057043
050580     05  FILLER.                                                  05058043
050590         10  MR-SETCD02L                PIC S9(04) COMP.          05059043
050591         10  MR-SETCD02A                PIC X(01).                05059143
050592         10  MR-SETCD02C                PIC X(01).                05059243
050593         10  MR-SETCD02H                PIC X(01).                05059343
050594         10  MR-SETCD02                 PIC X(05).                05059443
050595     05  FILLER.                                                  05059543
050596         10  MR-SETCD03L                PIC S9(04) COMP.          05059643
050597         10  MR-SETCD03A                PIC X(01).                05059743
050598         10  MR-SETCD03C                PIC X(01).                05059843
050599         10  MR-SETCD03H                PIC X(01).                05059943
050600         10  MR-SETCD03                 PIC X(05).                05060043
050601     05  FILLER.                                                  05060143
050602         10  MR-SETCD04L                PIC S9(04) COMP.          05060243
050603         10  MR-SETCD04A                PIC X(01).                05060343
050604         10  MR-SETCD04C                PIC X(01).                05060443
050605         10  MR-SETCD04H                PIC X(01).                05060543
050606         10  MR-SETCD04                 PIC X(05).                05060643
050607     05  FILLER.                                                  05060743
050608         10  MR-SETCD05L                PIC S9(04) COMP.          05060843
050609         10  MR-SETCD05A                PIC X(01).                05060943
050610         10  MR-SETCD05C                PIC X(01).                05061043
050611         10  MR-SETCD05H                PIC X(01).                05061143
050612         10  MR-SETCD05                 PIC X(05).                05061243
050613     05  FILLER.                                                  05061343
050614         10  MR-SETCD06L                PIC S9(04) COMP.          05061443
050615         10  MR-SETCD06A                PIC X(01).                05061543
050616         10  MR-SETCD06C                PIC X(01).                05061643
050617         10  MR-SETCD06H                PIC X(01).                05061743
050618         10  MR-SETCD06                 PIC X(05).                05061843
050620     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          05062000
050700         10  MR-SELECTL                 PIC S9(04) COMP.          05070000
050800         10  MR-SELECTA                 PIC  X(01).               05080000
050900         10  MR-SELECTC                 PIC  X(01).               05090000
051000         10  MR-SELECTH                 PIC  X(01).               05100000
051100         10  MR-SELECTI                 PIC  X(01).               05110000
051200                                                                  05120000
051300         10  MR-ACTIONL                 PIC S9(04) COMP.          05130000
051400         10  MR-ACTIONA                 PIC  X(01).               05140000
051500         10  MR-ACTIONC                 PIC  X(01).               05150000
051600         10  MR-ACTIONH                 PIC  X(01).               05160000
051700         10  MR-ACTION                  PIC  X(03).               05170000
051800                                                                  05180000
051900         10  MR-DEPTL                   PIC S9(04) COMP.          05190000
052000         10  MR-DEPTA                   PIC  X(01).               05200000
052100         10  MR-DEPTC                   PIC  X(01).               05210000
052200         10  MR-DEPTH                   PIC  X(01).               05220000
052300         10  MR-DEPT.                                             05230000
052400             15  MR-DEPT-N              PIC  9(03).               05240000
052500                                                                  05250000
052600         10  MR-PO-NBRL                 PIC S9(04) COMP.          05260000
052700         10  MR-PO-NBRA                 PIC  X(01).               05270000
052800         10  MR-PO-NBRC                 PIC  X(01).               05280000
052900         10  MR-PO-NBRH                 PIC  X(01).               05290000
053000         10  MR-PO-NBR.                                           05300000
053010*TV 10/08/2014 CHANGE STARTS                                      05301009
053100             15  MR-PO-NBR-N            PIC  Z(08).               05310010
053200*TV 10/08/2014 CHANGE ENDS                                        05320009
053210                                                                  05321006
053300         10  MR-RCVR-SEQ-NBRL           PIC S9(04) COMP.          05330000
053400         10  MR-RCVR-SEQ-NBRA           PIC  X(01).               05340000
053500         10  MR-RCVR-SEQ-NBRC           PIC  X(01).               05350000
053600         10  MR-RCVR-SEQ-NBRH           PIC  X(01).               05360000
053700         10  MR-RCVR-SEQ-NBR.                                     05370000
053800             15  MR-RCVR-SEQ-NBR-N      PIC  9(04).               05380000
053900                                                                  05390000
054000         10  MR-VENDOR-NMEL             PIC S9(04) COMP.          05400000
054100         10  MR-VENDOR-NMEA             PIC  X(01).               05410000
054200         10  MR-VENDOR-NMEC             PIC  X(01).               05420000
054300         10  MR-VENDOR-NMEH             PIC  X(01).               05430000
054400         10  MR-VENDOR-NME              PIC  X(10).               05440000
054500                                                                  05450000
054600         10  MR-FCLTY-SHORT-NMEL        PIC S9(04) COMP.          05460000
054700         10  MR-FCLTY-SHORT-NMEA        PIC  X(01).               05470000
054800         10  MR-FCLTY-SHORT-NMEC        PIC  X(01).               05480000
054900         10  MR-FCLTY-SHORT-NMEH        PIC  X(01).               05490000
055000         10  MR-FCLTY-SHORT-NME         PIC  X(04).               05500000
055100                                                                  05510000
055200         10  MR-TROUBLE-REASONL         PIC S9(04) COMP.          05520000
055300         10  MR-TROUBLE-REASONA         PIC  X(01).               05530000
055400         10  MR-TROUBLE-REASONC         PIC  X(01).               05540000
055500         10  MR-TROUBLE-REASONH         PIC  X(01).               05550000
055600         10  MR-TROUBLE-REASON          PIC  X(10).               05560000
055700                                                                  05570000
055800         10  MR-ARRIVAL-DATE-TIMEL      PIC S9(04) COMP.          05580000
055900         10  MR-ARRIVAL-DATE-TIMEA      PIC  X(01).               05590000
056000         10  MR-ARRIVAL-DATE-TIMEC      PIC  X(01).               05600000
056100         10  MR-ARRIVAL-DATE-TIMEH      PIC  X(01).               05610000
056200         10  MR-ARRIVAL-DATE-TIME       PIC  X(08).               05620000
056300                                                                  05630000
056400         10  MR-NOTIFICATION-DATE-TIMEL PIC S9(04) COMP.          05640000
056500         10  MR-NOTIFICATION-DATE-TIMEA PIC  X(01).               05650000
056600         10  MR-NOTIFICATION-DATE-TIMEC PIC  X(01).               05660000
056700         10  MR-NOTIFICATION-DATE-TIMEH PIC  X(01).               05670000
056800         10  MR-NOTIFICATION-DATE-TIME  PIC  X(08).               05680000
056900                                                                  05690000
057000         10  MR-RESPONSE-DATE-TIMEL     PIC S9(04) COMP.          05700000
057100         10  MR-RESPONSE-DATE-TIMEA     PIC  X(01).               05710000
057200         10  MR-RESPONSE-DATE-TIMEC     PIC  X(01).               05720000
057300         10  MR-RESPONSE-DATE-TIMEH     PIC  X(01).               05730000
057400         10  MR-RESPONSE-DATE-TIME      PIC  X(08).               05740000
057500                                                                  05750000
057600     EJECT                                                        05760000
057700*---------------------------------------------------------------* 05770000
057800*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05780000
057900*---------------------------------------------------------------* 05790000
058000                                                                  05800000
058100     COPY DPWS015.                                                05810000
058200                                                                  05820000
058300*---------------------------------------------------------------* 05830000
058400*    FUNCTION KEYS COPYBOOK.                                    * 05840000
058500*---------------------------------------------------------------* 05850000
058600                                                                  05860000
058700     COPY DPWS016.                                                05870000
058800                                                                  05880000
058900*---------------------------------------------------------------* 05890000
059000*    NUMERIC EDIT LAYOUT.                                       * 05900000
059100*---------------------------------------------------------------* 05910000
059200                                                                  05920000
059300     COPY DPWS010I.                                               05930000
059400 EJECT                                                            05940000
059500*---------------------------------------------------------------* 05950000
059600*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 05960018
059700*---------------------------------------------------------------* 05970000
059800                                                                  05980000
059900     COPY DPWS030.                                                05990000
059910     COPY DPWS930.                                                05991018
060000 EJECT                                                            06000000
060100*---------------------------------------------------------------* 06010000
060200*    PARAMETERS FOR CALLING THE TROUBLE CENTRAL PROCESSING      * 06020000
060300*    MODULE (TMKCS520).                                         * 06030000
060400*---------------------------------------------------------------* 06040000
060500                                                                  06050000
060600     COPY TMWS500.                                                06060000
060700*---------------------------------------------------------------* 06070000
060800*    PARAMETERS FOR CALLING THE UPDATE TO RCT_AUTOACKNL_TRBL   *  06080000
060900*    MODULE (TMKUP501).                                         * 06090000
061000*---------------------------------------------------------------* 06100000
061100                                                                  06110000
061110     COPY TMRD007.                                                06111000
061120 EJECT                                                            06112000
061130*---------------------------------------------------------------* 06113000
061140*    STANDARD COMMAREA.                                         * 06114000
061150*---------------------------------------------------------------* 06115000
061160                                                                  06116000
061170     COPY DPWS020.                                                06117000
061180     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06118000
061190                                                                  06119000
061200*---------------------------------------------------------------* 06120000
061300* INTER-APPLICATION COMMAREA.                                   * 06130000
061400*   TMWS005 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 06140000
061500*             SPEC SCREEN FOR THE DISTRIBUTION CENTERS          * 06150000
061600*---------------------------------------------------------------* 06160000
061700                                                                  06170000
061800         10  INTER-APPL-COMM-AREA       PIC X(200).               06180000
061900     COPY TMWS005.                                                06190000
062000     COPY POWS011.                                                06200000
062100     COPY POWS017.                                                06210000
062200     COPY POWS013.                                                06220000
062300     COPY RCWS012.                                                06230000
062400     COPY RCWS015.                                                06240000
062500     COPY PCWS000.                                                06250000
062600     COPY TRWS001.                                                06260000
062700     COPY DSWS003.                                                06270000
062800     COPY RCWS800.                                                06280000
062900     COPY SUWS038.                                                06290000
063000*CLP 09/03/13 BEGIN                                               06300000
063100     COPY SUWS009.                                                06310000
063200*CLP 09/03/13 END                                                 06320000
063300                                                                  06330000
063400*---------------------------------------------------------------* 06340000
063500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06350000
063600*---------------------------------------------------------------* 06360000
063700         10  ASC-SPECIFIC-COMMAREA.                               06370000
063800             15  ASC-LOCAL-GO-DESTINATION            PIC X(01).   06380000
063900                 88  ASC-STAYING-WITHIN-TROUBLE      VALUE ' '.   06390000
064000                 88  ASC-GOING-TO-PO                 VALUE '1'.   06400000
064100                 88  ASC-RETURNING-FROM-PO           VALUE '1'.   06410000
064210                 88  ASC-RCVRMNT                     VALUE '2'.   06421001
064300                 88  ASC-UNITADJ                     VALUE '2'.   06430000
064400*CLP 09/03/13 BEGIN                                               06440000
064500                 88  ASC-POCTNLST                    VALUE '5'.   06450000
064600*CLP 09/03/13 END                                                 06460000
064700                 88  ASC-RETURNING-FROM-RCPCKLST     VALUE 'B'.   06470000
064800                 88  ASC-RCPCKLST                    VALUE 'B'.   06480000
064900             15  ASC-KEY-FIELDS.                                  06490000
065000                 20  ASC-KEY-OPER-UNT-ID             PIC 9(04).   06500000
065100                 20  ASC-KEY-FCLTY-ID                PIC 9(04).   06510000
065200                 20  ASC-KEY-PO-NBR                  PIC 9(08).   06520000
065300                 20  ASC-KEY-DEPT                    PIC X(03).   06530000
065400                 20  ASC-KEY-BUYER                   PIC 9(02).   06540000
065500                 20  ASC-KEY-DMM                     PIC 9(02).   06550000
065600                 20  ASC-SAVE-OPER-UNT-ID            PIC 9(04).   06560000
065700                 20  ASC-LIST-SEQ-SW                 PIC X(01).   06570000
065800                     88  ASC-LS-ARRIVAL              VALUE 'A'.   06580000
065900                     88  ASC-LS-OLDEST-TRBL          VALUE 'O'.   06590000
066000                 20  ASC-RESPONSIBILITY-AREA-SW      PIC X(01).   06600000
066100                     88  ASC-RA-BUY-ANALYST-SW       VALUE 'Y'.   06610000
066200                     88  ASC-RA-BUY-ANALYST-DC-SW    VALUE 'A'.   06620000
066300                     88  ASC-RA-DC-SW                VALUE 'D'.   06630000
066400                 20  ASC-RESPONSIBILITY-AREA.                     06640000
066500                     25  ASC-RA-BUYER               PIC X(01).    06650000
066600                     25  ASC-RA-ANALYST             PIC X(01).    06660000
066700                     25  ASC-RA-BUYER-ANALYST       PIC X(01).    06670000
066800                     25  ASC-RA-DC                  PIC X(01).    06680000
066900                 20  ASC-KEY-ENT-ID                  PIC 9(09).   06690000
067000                 20  ASC-TRBL-REASON-LOW             PIC 9(03).   06700000
067100                 20  ASC-TRBL-REASON-HIGH            PIC 9(03).   06710000
067200                 20  ASC-NOTIF-STAT                  PIC X(01).   06720000
067300                     88  ASC-ALL-NOTIF-STATS         VALUE ' '.   06730000
067400                     88  ASC-RESOLVD-STAT-ONLY       VALUE 'R'.   06740000
067500                     88  ASC-UNRSLVD-STAT-ONLY       VALUE 'U'.   06750000
067600                 20  ASC-RCVR-STATUS-SW              PIC X(01).   06760000
067700                     88  ASC-RCVR-STAT-ARR-ENR       VALUE 'B'.   06770000
067800                     88  ASC-RCVR-STAT-ARRIVED       VALUE 'A'.   06780000
067900                     88  ASC-RCVR-STAT-ENROUTE       VALUE 'E'.   06790000
068000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06800000
068100                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06810000
068200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06820000
068300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06830000
068400                 20  ASC-ITEM-ARRAY.                              06840000
068500                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        06850000
068600                         30  ASC-LIST-ITEM-NUMBER                 06860000
068700                                                     PIC S9(09)   06870000
068800                                                     COMP-3.      06880000
068900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06890000
069000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06900000
069100                             88  ASC-TEMP-SELECT     VALUE 'S'.   06910000
069200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06920000
069300                             88  ASC-TEMP-END        VALUE 'E'.   06930000
069400                         30  ASC-SELECTED-SW         PIC  X(01).  06940000
069500                             88  ASC-NO-SELECT       VALUE ' '.   06950000
069600                             88  ASC-SELECT          VALUE 'S'.   06960000
069700                             88  ASC-BEGIN           VALUE 'B'.   06970000
069800                             88  ASC-END             VALUE 'E'.   06980000
069900                         30  ASC-ACTION              PIC  X(03).  06990000
070000                         30  ASC-NOTIF-NBR           PIC S9(09)   07000000
070100                                                          COMP.   07010000
070200                         30  ASC-OPER-UNT-ID         PIC S9(04)   07020000
070300                                                          COMP.   07030000
070400                         30  ASC-FCLTY-ID            PIC S9(04)   07040000
070500                                                          COMP.   07050000
070600                         30  ASC-DEPT-NBR            PIC  9(03).  07060000
070610*TV 10/08/2014 CHANGE STARTS                                      07061009
070700                         30  ASC-PO-NBR-N            PIC  9(08).  07070006
070710*TV 10/08/2014 CHANGE ENDS                                        07071009
070800                         30  ASC-RCVR-SEQ-NBR-N      PIC  9(04).  07080000
070900                         30  ASC-PO-LNE-NBR-N        PIC  9(04).  07090000
071000                         30  ASC-PREPK-ID-N          PIC  9(04).  07100000
071100                         30  ASC-ENT-ID              PIC S9(09)   07110000
071200                                                          COMP.   07120000
071300                         30  ASC-VENDOR-SHORT-NME    PIC  X(10).  07130000
071400                         30  ASC-FCLTY-NME           PIC  X(04).  07140000
071500                         30  ASC-TROUBLE-REASON-CDE  PIC S9(04)   07150000
071600                                                          COMP.   07160000
071700                         30  ASC-TROUBLE-REASON-DESC PIC  X(10).  07170000
071800                         30  ASC-TROUBLE-RESP-RES-IND             07180000
071900                                                     PIC  X(01).  07190000
072000                         30  ASC-TROUBLE-REASON-LVL  PIC  X(01).  07200000
072100                         30  ASC-ARRIVAL-DATE-TIME   PIC  X(08).  07210000
072200                         30  ASC-NOTIFICATION-DATE-TIME           07220000
072300                                                     PIC  X(08).  07230000
072400                         30  ASC-RESPONSE-DATE-TIME  PIC  X(08).  07240000
072500                         30  ASC-TRBL-DTL-EXISTS-SW  PIC  X(01).  07250000
072600                             88  ASC-TRBL-DTL-EXISTS VALUE 'Y'.   07260000
072700                             88  ASC-NO-TRBL-DTL-EXISTS           07270000
072800                                                     VALUE 'N'.   07280000
072900                         30  ASC-TRBL-RESOLVED-SW    PIC  X(01).  07290000
073000                             88  ASC-TRBL-RESOLVED   VALUE 'Y'.   07300000
073100                             88  ASC-TRBL-NOT-RESOLVED            07310000
073200                                                     VALUE 'N'.   07320000
073300                         30  ASC-TRBL-ACK-SW         PIC  X(01).  07330000
073400                             88  ASC-TRBL-ACK        VALUE 'Y'.   07340000
073500                             88  ASC-TRBL-NOT-ACK    VALUE 'N'.   07350000
073600             15  ASC-BLK-SUB                         PIC S9(04)   07360000
073700                                                          COMP    07370000
073800                                                          SYNC.   07380000
073900             15  ASC-SEL-SUB                         PIC S9(04)   07390000
074000                                                         COMP.    07400000
074100             15  ASC-SEL-ITEM                        PIC S9(04)   07410000
074200                                                         COMP.    07420000
074300             15  ASC-ITEM-SUB                        PIC S9(04)   07430000
074400                                                          COMP    07440000
074500                                                          SYNC.   07450000
074600             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   07460000
074700                                                          COMP-3. 07470000
074800             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   07480000
074900                                                          COMP-3. 07490000
075000             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   07500000
075100                                                          COMP-3. 07510000
075200             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   07520000
075300                                                          COMP-3. 07530000
075400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   07540000
075500                                                          COMP-3. 07550000
075600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   07560000
075700                                                          COMP-3. 07570000
075800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   07580000
075900                                                          COMP    07590000
076000                                                          SYNC.   07600000
076100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   07610000
076200                                                          COMP-3. 07620000
076300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   07630000
076400                                                          COMP-3. 07640000
076500             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07650000
076600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07660000
076700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07670000
076800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  07680000
076900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07690000
077000                 88  ASC-UPDATE-TSQ2                 VALUE '2'.   07700000
077100                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07710000
077200             15  ASC-LIST-QUEUE-NAME.                             07720000
077300                 20  ASC-LIST-TERM-ID                PIC  X(04).  07730000
077400                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07740000
077500                                                          COMP-3. 07750000
077600                 20  ASC-LIST-SEQ                    PIC  9(01).  07760000
077700             15  ASC-SEL-QUEUE-OUT.                               07770000
077800                 20  ASC-SEL-TERM-ID                 PIC  X(04).  07780000
077900                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   07790000
078000                                                          COMP-3. 07800000
078100                 20  ASC-SEL-SEQ                     PIC  9(01).  07810000
078200             15  ASC-SEL-QUEUE-IN                    PIC  X(08).  07820000
078300             15  ASC-START-ITEM-REQUEST.                          07830000
078400                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  07840000
078500             15  ASC-KEY-REC-SEQ-NBR           PIC S9(09) COMP.   07850000
078600             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(01).   07860000
078700                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   07870000
078800             15  ASC-SOURCE-PROG-IND                 PIC X(01).   07880000
078900                 88  ASC-FROM-RC015                  VALUE '1'.   07890000
079000                 88  ASC-FROM-PC000                  VALUE '2'.   07900000
079100                 88  ASC-FROM-DS604                  VALUE '3'.   07910000
079200             15  ASC-BYR-NBR                         PIC X(03).   07920000
079300             15  ASC-BYR-NME                         PIC X(25).   07930000
079400             15  ASC-ANL-NME                         PIC X(25).   07940000
079500             15  ASC-BYR-ANL-NME-SW                  PIC X(01).   07950000
079600                 88  ASC-BYR-ANL-NME                 VALUE 'Y'.   07960000
079700                 88  ASC-NO-BYR-ANL-NME              VALUE 'N'.   07970000
079701*                                                                 07970120
079703             15  ASC-INCLD-SET                 PIC X(001).        07970321
079704                 88  ASC-INCLD-SET-CDE               VALUE 'S'.   07970421
079706             15  ASC-EXCLD-SET                 PIC X(001).        07970621
079707                 88  ASC-EXCLD-SET-CDE               VALUE 'S'.   07970721
079710             15  ASC-SET-CODE-1                PIC X(005).        07971021
079711             15  ASC-SET-YEAR-1                PIC X(004).        07971121
079712             15  ASC-SET-CODE-2                PIC X(005).        07971221
079713             15  ASC-SET-YEAR-2                PIC X(004).        07971321
079714             15  ASC-SET-CODE-3                PIC X(005).        07971421
079715             15  ASC-SET-YEAR-3                PIC X(004).        07971521
079716             15  ASC-SET-CODE-4                PIC X(005).        07971621
079717             15  ASC-SET-YEAR-4                PIC X(004).        07971721
079718             15  ASC-SET-CODE-5                PIC X(005).        07971821
079719             15  ASC-SET-YEAR-5                PIC X(004).        07971921
079720             15  ASC-SET-CODE-6                PIC X(005).        07972021
079721             15  ASC-SET-YEAR-6                PIC X(004).        07972121
079730             15  FILLER                        PIC X(13).         07973021
079800                                                                  07980000
079900*---------------------------------------------------------------* 07990000
080000*    ABEND PROCESSING COPYBOOK.                                 * 08000000
080100*---------------------------------------------------------------* 08010000
080200                                                                  08020000
080300     COPY DPWS013.                                                08030000
080400                                                                  08040000
080500*---------------------------------------------------------------* 08050000
080600*      -TROUBLE REASON CODES TABLE  - PROGRAM ID level          * 08060000
080700*---------------------------------------------------------------* 08070000
080800     EXEC SQL                                                     08080000
080900          INCLUDE TTRBRCN                                         08090000
081000     END-EXEC.                                                    08100000
081100                                                                  08110000
081200*---------------------------------------------------------------* 08120000
081300*    DB2 AREA FOR TTRBNTF - TROUBLE NOTIFICATION                * 08130000
081400*---------------------------------------------------------------* 08140000
081500     EXEC SQL                                                     08150000
081600          INCLUDE TTRBNTF                                         08160000
081700     END-EXEC.                                                    08170000
081800*---------------------------------------------------------------* 08180000
081900*    DB2 AREA FOR TTRBRSN - TROUBLE REASON                      * 08190000
082000*---------------------------------------------------------------* 08200000
082100     EXEC SQL                                                     08210000
082200          INCLUDE TTRBRSN                                         08220000
082300     END-EXEC.                                                    08230000
082400*---------------------------------------------------------------* 08240000
082500*    DB2 AREA FOR TRECEIV - RECEIVER                            * 08250000
082600*---------------------------------------------------------------* 08260000
082700     EXEC SQL                                                     08270000
082800          INCLUDE TRECEIV                                         08280000
082900     END-EXEC.                                                    08290000
083000*---------------------------------------------------------------* 08300000
083100*    DB2 AREA FOR TENTNME - ENTITY NAME                         * 08310000
083200*---------------------------------------------------------------* 08320000
083300     EXEC SQL                                                     08330000
083400          INCLUDE TENTNME                                         08340000
083500     END-EXEC.                                                    08350000
083600*---------------------------------------------------------------* 08360000
083700*    DB2 AREA FOR TPURCHS - PURCHASE ORDER HEADER TABLE         * 08370000
083800*---------------------------------------------------------------* 08380000
083900     EXEC SQL                                                     08390000
084000          INCLUDE TPURCHS                                         08400000
084100     END-EXEC.                                                    08410000
084200*---------------------------------------------------------------* 08420000
084300*    DB2 AREA FOR TMDSEAR - MERCHANDISE AREA TABLE              * 08430000
084400*---------------------------------------------------------------* 08440000
084500     EXEC SQL                                                     08450000
084600          INCLUDE TMDSEAR                                         08460000
084700     END-EXEC.                                                    08470000
084800*---------------------------------------------------------------* 08480000
084900*    DB2 AREA FOR TRSPBAR - RESPONSIBILITY AREA TABLE           * 08490000
085000*---------------------------------------------------------------* 08500000
085100     EXEC SQL                                                     08510000
085200          INCLUDE TRSPBAR                                         08520000
085300     END-EXEC.                                                    08530000
085400*---------------------------------------------------------------* 08540000
085500*    DB2 AREA FOR TSHPTPO - SHIPPED PO TABLE                    * 08550000
085600*---------------------------------------------------------------* 08560000
085700     EXEC SQL                                                     08570000
085800          INCLUDE TSHPTPO                                         08580000
085900     END-EXEC.                                                    08590000
086000*---------------------------------------------------------------* 08600000
086100*    DB2 AREA FOR TSHIPMT - SHIPMENT TABLE                      * 08610000
086200*---------------------------------------------------------------* 08620000
086300     EXEC SQL                                                     08630000
086400          INCLUDE TSHIPMT                                         08640000
086500     END-EXEC.                                                    08650000
086600*---------------------------------------------------------------* 08660000
086700*    DB2 AREA FOR COMMUNICATIONS                                * 08670000
086800*---------------------------------------------------------------* 08680000
086900     EXEC SQL                                                     08690000
087000          INCLUDE SQLCA                                           08700000
087100     END-EXEC.                                                    08710000
087200                                                                  08720000
087300*  THE "EXISTS" CHECK WAS ADDED TO THE CURSORS BELOW BECAUSE THERE08730000
087400*  ARE SOME DC'S THAT ARE PROCESSING MERCHANDISE FOR OTHER DC'S.  08740000
087500*  THE TROUBLE IS BEING CREATED WITH A LOCATION FOR THE DC THAT IS08750000
087600*  PROCESSING THE MERCHANDISE.  ALL OF THE TROUBLE REASON CODES   08760000
087700*  THAT CAN BE CREATED WITH THE PROCESSING DC' OPER ARE ENTERED   08770000
087800*  IN THE TTRBRCN TABLE WITH A RPT_PGM_NM VALUE OF 'TMKCS521'.    08780000
087900*                                                                 08790000
088000*---------------------------------------------------------------* 08800000
088100*    OPERATING UNIT CURSOR  FOR A SPECIFIED OPERATING UNIT      * 08810000
088200*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 08820000
088300*    THE CURSOR.                                                * 08830000
088400*    THE RESULTS OF THIS CURSOR WILL BE IN ARRIVAL DATE SEQ.    * 08840000
088500*---------------------------------------------------------------* 08850000
088600                                                                  08860000
088700     EXEC SQL                                                     08870000
088800          DECLARE OPER-UNT-BY-ARRIV CURSOR                        08880000
088900          FOR SELECT                                              08890000
089000                    A.NOTIF_NBR                                   08900000
089100                  , A.OPER_UNT_ID                                 08910000
089200                  , A.FCLTY_ID                                    08920000
089300                  , A.DEPT_NBR                                    08930000
089400                  , A.ENT_ID                                      08940000
089500                  , A.PO_NBR                                      08950000
089600                  , A.PO_LNE_NBR                                  08960000
089700                  , A.PREPK_ID                                    08970000
089800                  , A.REC_SEQ_NBR                                 08980000
089900                  , A.TRBL_RSN_CDE                                08990000
090000                  , A.NOTIF_TMST                                  09000000
090100                  , A.RESOLVED_IND                                09010000
090200                  , A.RESOLVED_TMST                               09020000
090300                  , A.ACKNOWLG_TMST                               09030000
090400                  , B.TRBL_SHT_DESC                               09040000
090500                  , B.RESP_RES_IND                                09050000
090600                  , B.TRBL_LVL_IND                                09060000
090700                  , B.RSLV_RSPNT_CDE                              09070000
090800                  , C.REC_TMST                                    09080000
090900                  , C.CRE_TMST                                    09090000
091000          FROM                                                    09100000
091100                TTRBNTF A                                         09110000
091200              , TTRBRSN B                                         09120000
091300              , TRECEIV C                                         09130000
091400         WHERE                                                    09140000
091500                C.ORD_NBR             =  A.PO_NBR                 09150000
091600           AND  ((C.OPER_UNT_ID       =  A.OPER_UNT_ID) OR        09160000
091700                 (C.OPER_UNT_ID      <>  A.OPER_UNT_ID AND        09170000
091800                  EXISTS(SELECT 1 FROM TTRBRCN D                  09180000
091900                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  09190000
092000                            AND D.RPT_PGM_NM   =  'TMKCS521')))   09200000
092100           AND C.FCLTY_ID             =  A.FCLTY_ID               09210000
092200           AND C.ML_POST_TMST      =  '9999-09-09-09.09.09.999999'09220000
092300           AND C.REC_SEQ_NBR          =  A.REC_SEQ_NBR            09230000
092400           AND A.TRBL_RSN_CDE         =  B.TRBL_RSN_CDE           09240000
092500           AND C.CURR_OPER_UNT_ID     =  :DK-OPER-UNT-ID          09250000
092600           AND A.FCLTY_ID             =  1                        09260000
092700           AND C.ORD_NBR        BETWEEN :DK-PO-NBR-LOW            09270000
092800                                    AND :DK-PO-NBR-HIGH           09280000
092900           AND C.STATUS_CDE          IN ('CM', 'IP')              09290000
093000           AND A.TRBL_RSN_CDE   BETWEEN :DK-TRBL-RSN-LOW          09300000
093100                                    AND :DK-TRBL-RSN-HIGH         09310000
093200           AND A.RESOLVED_IND        IN (:DK-NOTIF-STAT-1         09320000
093300                                       , :DK-NOTIF-STAT-2         09330000
093400                                       , :DK-NOTIF-STAT-3         09340000
093500                                       , :DK-NOTIF-STAT-4)        09350000
093600           AND B.NOTIF_IND            =  'T'                      09360000
093700           AND C.REC_TMST       BETWEEN :DK-LOW-REC-TMST          09370000
093800                                    AND :DK-HIGH-REC-TMST         09380000
093900       ORDER BY 19                                                09390000
094000              , 20                                                09400000
094100              , 6                                                 09410000
094200              , 9                                                 09420000
094300              , 10                                                09430000
094310         WITH UR                                                  09431024
094400     END-EXEC.                                                    09440000
094500                                                                  09450000
094510     EXEC SQL                                                     09451024
094520          DECLARE OPER-UNT-BY-ARRIV-INCL-SET CURSOR               09452024
094530          FOR SELECT                                              09453024
094540                    A.NOTIF_NBR                                   09454024
094550                  , A.OPER_UNT_ID                                 09455024
094560                  , A.FCLTY_ID                                    09456024
094570                  , A.DEPT_NBR                                    09457024
094580                  , A.ENT_ID                                      09458024
094590                  , A.PO_NBR                                      09459024
094591                  , A.PO_LNE_NBR                                  09459124
094592                  , A.PREPK_ID                                    09459224
094593                  , A.REC_SEQ_NBR                                 09459324
094594                  , A.TRBL_RSN_CDE                                09459424
094595                  , A.NOTIF_TMST                                  09459524
094596                  , A.RESOLVED_IND                                09459624
094597                  , A.RESOLVED_TMST                               09459724
094598                  , A.ACKNOWLG_TMST                               09459824
094599                  , B.TRBL_SHT_DESC                               09459924
094600                  , B.RESP_RES_IND                                09460024
094601                  , B.TRBL_LVL_IND                                09460124
094602                  , B.RSLV_RSPNT_CDE                              09460224
094603                  , C.REC_TMST                                    09460324
094604                  , C.CRE_TMST                                    09460424
094605          FROM                                                    09460524
094606                TTRBNTF A                                         09460624
094607              , TTRBRSN B                                         09460724
094608              , TRECEIV C                                         09460824
094609              , TPURCHS P                                         09460924
094610         WHERE                                                    09461024
094611                C.ORD_NBR             =  A.PO_NBR                 09461124
094612           AND  ((C.OPER_UNT_ID       =  A.OPER_UNT_ID) OR        09461224
094613                 (C.OPER_UNT_ID      <>  A.OPER_UNT_ID AND        09461324
094614                  EXISTS(SELECT 1 FROM TTRBRCN D                  09461424
094615                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  09461524
094616                            AND D.RPT_PGM_NM   =  'TMKCS521')))   09461624
094617           AND C.FCLTY_ID             =  A.FCLTY_ID               09461724
094618           AND C.ML_POST_TMST      =  '9999-09-09-09.09.09.999999'09461824
094619           AND C.REC_SEQ_NBR          =  A.REC_SEQ_NBR            09461924
094620           AND A.TRBL_RSN_CDE         =  B.TRBL_RSN_CDE           09462024
094621           AND C.CURR_OPER_UNT_ID     =  :DK-OPER-UNT-ID          09462124
094622           AND A.FCLTY_ID             =  1                        09462224
094623           AND C.ORD_NBR        BETWEEN :DK-PO-NBR-LOW            09462324
094624                                    AND :DK-PO-NBR-HIGH           09462424
094625           AND C.STATUS_CDE          IN ('CM', 'IP')              09462524
094626           AND A.TRBL_RSN_CDE   BETWEEN :DK-TRBL-RSN-LOW          09462624
094627                                    AND :DK-TRBL-RSN-HIGH         09462724
094628           AND A.RESOLVED_IND        IN (:DK-NOTIF-STAT-1         09462824
094629                                       , :DK-NOTIF-STAT-2         09462924
094630                                       , :DK-NOTIF-STAT-3         09463024
094631                                       , :DK-NOTIF-STAT-4)        09463124
094632           AND B.NOTIF_IND            =  'T'                      09463224
094633           AND C.REC_TMST       BETWEEN :DK-LOW-REC-TMST          09463324
094634                                    AND :DK-HIGH-REC-TMST         09463424
094635           AND C.ORD_NBR           =  P.PO_NBR                    09463524
094636           AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS            09463624
094637           AND ((P.SEASET_YR       = :DK-SEASET-YR-1 AND          09463724
094638                 P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-1)  OR    09463824
094639                (P.SEASET_YR       = :DK-SEASET-YR-2 AND          09463924
094640                 P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-2)  OR    09464024
094641                (P.SEASET_YR       = :DK-SEASET-YR-3 AND          09464124
094642                 P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-3)  OR    09464224
094643                (P.SEASET_YR       = :DK-SEASET-YR-4 AND          09464324
094644                 P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-4)  OR    09464424
094645                (P.SEASET_YR       = :DK-SEASET-YR-5 AND          09464524
094646                 P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-5)  OR    09464624
094647                (P.SEASET_YR       = :DK-SEASET-YR-6 AND          09464724
094648                 P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)        09464824
094649               )                                                  09464924
094652       ORDER BY 19                                                09465224
094653              , 20                                                09465324
094654              , 6                                                 09465424
094655              , 9                                                 09465524
094656              , 10                                                09465624
094657         WITH UR                                                  09465724
094658     END-EXEC.                                                    09465824
094659                                                                  09465924
094660                                                                  09466024
094661     EXEC SQL                                                     09466124
094662          DECLARE OPER-UNT-BY-ARRIV-EXCL-SET CURSOR               09466224
094663          FOR SELECT                                              09466324
094664                    A.NOTIF_NBR                                   09466424
094665                  , A.OPER_UNT_ID                                 09466524
094666                  , A.FCLTY_ID                                    09466624
094667                  , A.DEPT_NBR                                    09466724
094668                  , A.ENT_ID                                      09466824
094669                  , A.PO_NBR                                      09466924
094670                  , A.PO_LNE_NBR                                  09467024
094671                  , A.PREPK_ID                                    09467124
094672                  , A.REC_SEQ_NBR                                 09467224
094673                  , A.TRBL_RSN_CDE                                09467324
094674                  , A.NOTIF_TMST                                  09467424
094675                  , A.RESOLVED_IND                                09467524
094676                  , A.RESOLVED_TMST                               09467624
094677                  , A.ACKNOWLG_TMST                               09467724
094678                  , B.TRBL_SHT_DESC                               09467824
094679                  , B.RESP_RES_IND                                09467924
094680                  , B.TRBL_LVL_IND                                09468024
094681                  , B.RSLV_RSPNT_CDE                              09468124
094682                  , C.REC_TMST                                    09468224
094683                  , C.CRE_TMST                                    09468324
094684          FROM                                                    09468424
094685                TTRBNTF A                                         09468524
094686              , TTRBRSN B                                         09468624
094687              , TRECEIV C                                         09468724
094688              , TPURCHS P                                         09468824
094689         WHERE                                                    09468924
094690                C.ORD_NBR             =  A.PO_NBR                 09469024
094691           AND  ((C.OPER_UNT_ID       =  A.OPER_UNT_ID) OR        09469124
094692                 (C.OPER_UNT_ID      <>  A.OPER_UNT_ID AND        09469224
094693                  EXISTS(SELECT 1 FROM TTRBRCN D                  09469324
094694                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  09469424
094695                            AND D.RPT_PGM_NM   =  'TMKCS521')))   09469524
094696           AND C.FCLTY_ID             =  A.FCLTY_ID               09469624
094697           AND C.ML_POST_TMST      =  '9999-09-09-09.09.09.999999'09469724
094698           AND C.REC_SEQ_NBR          =  A.REC_SEQ_NBR            09469824
094699           AND A.TRBL_RSN_CDE         =  B.TRBL_RSN_CDE           09469924
094700           AND C.CURR_OPER_UNT_ID     =  :DK-OPER-UNT-ID          09470024
094701           AND A.FCLTY_ID             =  1                        09470124
094702           AND C.ORD_NBR        BETWEEN :DK-PO-NBR-LOW            09470224
094703                                    AND :DK-PO-NBR-HIGH           09470324
094704           AND C.STATUS_CDE          IN ('CM', 'IP')              09470424
094705           AND A.TRBL_RSN_CDE   BETWEEN :DK-TRBL-RSN-LOW          09470524
094706                                    AND :DK-TRBL-RSN-HIGH         09470624
094707           AND A.RESOLVED_IND        IN (:DK-NOTIF-STAT-1         09470724
094708                                       , :DK-NOTIF-STAT-2         09470824
094709                                       , :DK-NOTIF-STAT-3         09470924
094710                                       , :DK-NOTIF-STAT-4)        09471024
094711           AND B.NOTIF_IND            =  'T'                      09471124
094712           AND C.REC_TMST       BETWEEN :DK-LOW-REC-TMST          09471224
094713                                    AND :DK-HIGH-REC-TMST         09471324
094714           AND C.ORD_NBR           =  P.PO_NBR                    09471424
094715           AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS            09471524
094716           AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND       09471624
094717                     P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR  09471724
094718                    (P.SEASET_YR      = :DK-SEASET-YR-2 AND       09471824
094719                     P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR  09471924
094720                    (P.SEASET_YR      = :DK-SEASET-YR-3 AND       09472024
094721                     P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR  09472124
094722                    (P.SEASET_YR      = :DK-SEASET-YR-4 AND       09472224
094723                     P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR  09472324
094724                    (P.SEASET_YR      = :DK-SEASET-YR-5 AND       09472424
094725                     P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR  09472524
094726                    (P.SEASET_YR      = :DK-SEASET-YR-6 AND       09472624
094727                     P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-6)     09472724
094728               )                                                  09472824
094729       ORDER BY 19                                                09472924
094730              , 20                                                09473024
094731              , 6                                                 09473124
094732              , 9                                                 09473224
094733              , 10                                                09473324
094734         WITH UR                                                  09473424
094735     END-EXEC.                                                    09473524
094736                                                                  09473624
094737*---------------------------------------------------------------* 09473700
094740*    DEPARTMENT CURSOR FOR A SPECIFIED DEPARTMENT               * 09474000
094800*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 09480000
094900*    THE CURSOR.                                                * 09490000
095000*    THE RESULTS OF THIS CURSOR WILL BE IN ARRIVAL DATE SEQ.    * 09500000
095100*---------------------------------------------------------------* 09510000
095200                                                                  09520000
095300     EXEC SQL                                                     09530000
095400          DECLARE DEPT-BY-ARRIVAL CURSOR                          09540000
095500          FOR SELECT                                              09550000
095600                    A.NOTIF_NBR                                   09560000
095700                  , A.OPER_UNT_ID                                 09570000
095800                  , A.FCLTY_ID                                    09580000
095900                  , A.DEPT_NBR                                    09590000
096000                  , A.ENT_ID                                      09600000
096100                  , A.PO_NBR                                      09610000
096200                  , A.PO_LNE_NBR                                  09620000
096300                  , A.PREPK_ID                                    09630000
096400                  , A.REC_SEQ_NBR                                 09640000
096500                  , A.TRBL_RSN_CDE                                09650000
096600                  , A.NOTIF_TMST                                  09660000
096700                  , A.RESOLVED_IND                                09670000
096800                  , A.RESOLVED_TMST                               09680000
096900                  , A.ACKNOWLG_TMST                               09690000
097000                  , B.TRBL_SHT_DESC                               09700000
097100                  , B.RESP_RES_IND                                09710000
097200                  , B.TRBL_LVL_IND                                09720000
097300                  , B.RSLV_RSPNT_CDE                              09730000
097400                  , C.REC_TMST                                    09740000
097500                  , C.CRE_TMST                                    09750000
097600          FROM                                                    09760000
097700                TTRBNTF A                                         09770000
097800              , TTRBRSN B                                         09780000
097900              , TRECEIV C                                         09790000
098000         WHERE                                                    09800000
098100                C.ORD_NBR                =  A.PO_NBR              09810000
098200            AND C.ML_POST_TMST     =  '9999-09-09-09.09.09.999999'09820000
098300            AND C.REC_SEQ_NBR            =  A.REC_SEQ_NBR         09830000
098400            AND ((C.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     09840000
098500                 (C.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     09850000
098600                  EXISTS(SELECT 1 FROM TTRBRCN D                  09860000
098700                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  09870000
098800                            AND D.RPT_PGM_NM   =  'TMKCS521')))   09880000
098900            AND C.FCLTY_ID               =  A.FCLTY_ID            09890000
099000            AND B.TRBL_RSN_CDE           =  A.TRBL_RSN_CDE        09900000
099100            AND C.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-LOW    09910000
099200                                       AND :DK-OPER-UNT-ID-HIGH   09920000
099300            AND A.FCLTY_ID               = 1                      09930000
099400            AND A.DEPT_NBR               = :DK-DEPT-LOW           09940000
099500            AND A.PO_NBR           BETWEEN :DK-PO-NBR-LOW         09950000
099600                                       AND :DK-PO-NBR-HIGH        09960000
099700            AND A.TRBL_RSN_CDE     BETWEEN :DK-TRBL-RSN-LOW       09970000
099800                                       AND :DK-TRBL-RSN-HIGH      09980000
099900            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      09990000
100000                                          , :DK-NOTIF-STAT-2      10000000
100100                                          , :DK-NOTIF-STAT-3      10010000
100200                                          , :DK-NOTIF-STAT-4)     10020000
100300            AND B.NOTIF_IND              = 'T'                    10030000
100400            AND C.STATUS_CDE            IN ('CM', 'IP')           10040000
100500            AND C.REC_TMST         BETWEEN :DK-LOW-REC-TMST       10050000
100600                                       AND :DK-HIGH-REC-TMST      10060000
100700       ORDER BY 19                                                10070000
100800              , 20                                                10080000
100900              , 6                                                 10090000
101000              , 9                                                 10100000
101100              , 10                                                10110000
101110         WITH UR                                                  10111024
101200     END-EXEC.                                                    10120000
101300                                                                  10130000
101320     EXEC SQL                                                     10132024
101330          DECLARE DEPT-BY-ARRIVAL-INCL-SET CURSOR                 10133024
101340          FOR SELECT                                              10134024
101350                    A.NOTIF_NBR                                   10135024
101360                  , A.OPER_UNT_ID                                 10136024
101370                  , A.FCLTY_ID                                    10137024
101380                  , A.DEPT_NBR                                    10138024
101390                  , A.ENT_ID                                      10139024
101391                  , A.PO_NBR                                      10139124
101392                  , A.PO_LNE_NBR                                  10139224
101393                  , A.PREPK_ID                                    10139324
101394                  , A.REC_SEQ_NBR                                 10139424
101395                  , A.TRBL_RSN_CDE                                10139524
101396                  , A.NOTIF_TMST                                  10139624
101397                  , A.RESOLVED_IND                                10139724
101398                  , A.RESOLVED_TMST                               10139824
101399                  , A.ACKNOWLG_TMST                               10139924
101400                  , B.TRBL_SHT_DESC                               10140024
101401                  , B.RESP_RES_IND                                10140124
101402                  , B.TRBL_LVL_IND                                10140224
101403                  , B.RSLV_RSPNT_CDE                              10140324
101404                  , C.REC_TMST                                    10140424
101405                  , C.CRE_TMST                                    10140524
101406          FROM                                                    10140624
101407                TTRBNTF A                                         10140724
101408              , TTRBRSN B                                         10140824
101409              , TRECEIV C                                         10140924
101410              , TPURCHS P                                         10141024
101411         WHERE                                                    10141124
101412                C.ORD_NBR                =  A.PO_NBR              10141224
101413            AND C.ML_POST_TMST     =  '9999-09-09-09.09.09.999999'10141324
101414            AND C.REC_SEQ_NBR            =  A.REC_SEQ_NBR         10141424
101415            AND ((C.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     10141524
101416                 (C.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     10141624
101417                  EXISTS(SELECT 1 FROM TTRBRCN D                  10141724
101418                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  10141824
101419                            AND D.RPT_PGM_NM   =  'TMKCS521')))   10141924
101420            AND C.FCLTY_ID               =  A.FCLTY_ID            10142024
101421            AND B.TRBL_RSN_CDE           =  A.TRBL_RSN_CDE        10142124
101422            AND C.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-LOW    10142224
101423                                       AND :DK-OPER-UNT-ID-HIGH   10142324
101424            AND A.FCLTY_ID               = 1                      10142424
101425            AND A.DEPT_NBR               = :DK-DEPT-LOW           10142524
101426            AND A.PO_NBR           BETWEEN :DK-PO-NBR-LOW         10142624
101427                                       AND :DK-PO-NBR-HIGH        10142724
101428            AND A.TRBL_RSN_CDE     BETWEEN :DK-TRBL-RSN-LOW       10142824
101429                                       AND :DK-TRBL-RSN-HIGH      10142924
101430            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      10143024
101431                                          , :DK-NOTIF-STAT-2      10143124
101432                                          , :DK-NOTIF-STAT-3      10143224
101433                                          , :DK-NOTIF-STAT-4)     10143324
101434            AND B.NOTIF_IND              = 'T'                    10143424
101435            AND C.STATUS_CDE            IN ('CM', 'IP')           10143524
101436            AND C.REC_TMST         BETWEEN :DK-LOW-REC-TMST       10143624
101437                                       AND :DK-HIGH-REC-TMST      10143724
101438            AND C.ORD_NBR           =  P.PO_NBR                   10143824
101439            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           10143924
101440            AND ((P.SEASET_YR       = :DK-SEASET-YR-1 AND         10144024
101441                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-1) OR    10144124
101442                 (P.SEASET_YR       = :DK-SEASET-YR-2 AND         10144224
101443                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-2) OR    10144324
101444                 (P.SEASET_YR       = :DK-SEASET-YR-3 AND         10144424
101445                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-3) OR    10144524
101446                 (P.SEASET_YR       = :DK-SEASET-YR-4 AND         10144624
101447                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-4) OR    10144724
101448                 (P.SEASET_YR       = :DK-SEASET-YR-5 AND         10144824
101449                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-5) OR    10144924
101450                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         10145024
101451                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       10145124
101452               )                                                  10145224
101453       ORDER BY 19                                                10145324
101454              , 20                                                10145424
101455              , 6                                                 10145524
101456              , 9                                                 10145624
101457              , 10                                                10145724
101458         WITH UR                                                  10145824
101459     END-EXEC.                                                    10145924
101460                                                                  10146024
101461     EXEC SQL                                                     10146124
101462          DECLARE DEPT-BY-ARRIVAL-EXCL-SET CURSOR                 10146224
101463          FOR SELECT                                              10146324
101464                    A.NOTIF_NBR                                   10146424
101465                  , A.OPER_UNT_ID                                 10146524
101466                  , A.FCLTY_ID                                    10146624
101467                  , A.DEPT_NBR                                    10146724
101468                  , A.ENT_ID                                      10146824
101469                  , A.PO_NBR                                      10146924
101470                  , A.PO_LNE_NBR                                  10147024
101471                  , A.PREPK_ID                                    10147124
101472                  , A.REC_SEQ_NBR                                 10147224
101473                  , A.TRBL_RSN_CDE                                10147324
101474                  , A.NOTIF_TMST                                  10147424
101475                  , A.RESOLVED_IND                                10147524
101476                  , A.RESOLVED_TMST                               10147624
101477                  , A.ACKNOWLG_TMST                               10147724
101478                  , B.TRBL_SHT_DESC                               10147824
101479                  , B.RESP_RES_IND                                10147924
101480                  , B.TRBL_LVL_IND                                10148024
101481                  , B.RSLV_RSPNT_CDE                              10148124
101482                  , C.REC_TMST                                    10148224
101483                  , C.CRE_TMST                                    10148324
101484          FROM                                                    10148424
101485                TTRBNTF A                                         10148524
101486              , TTRBRSN B                                         10148624
101487              , TRECEIV C                                         10148724
101488              , TPURCHS P                                         10148824
101489         WHERE                                                    10148924
101490                C.ORD_NBR                =  A.PO_NBR              10149024
101491            AND C.ML_POST_TMST     =  '9999-09-09-09.09.09.999999'10149124
101492            AND C.REC_SEQ_NBR            =  A.REC_SEQ_NBR         10149224
101493            AND ((C.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     10149324
101494                 (C.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     10149424
101495                  EXISTS(SELECT 1 FROM TTRBRCN D                  10149524
101496                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  10149624
101497                            AND D.RPT_PGM_NM   =  'TMKCS521')))   10149724
101498            AND C.FCLTY_ID               =  A.FCLTY_ID            10149824
101499            AND B.TRBL_RSN_CDE           =  A.TRBL_RSN_CDE        10149924
101500            AND C.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-LOW    10150024
101501                                       AND :DK-OPER-UNT-ID-HIGH   10150124
101502            AND A.FCLTY_ID               = 1                      10150224
101503            AND A.DEPT_NBR               = :DK-DEPT-LOW           10150324
101504            AND A.PO_NBR           BETWEEN :DK-PO-NBR-LOW         10150424
101505                                       AND :DK-PO-NBR-HIGH        10150524
101506            AND A.TRBL_RSN_CDE     BETWEEN :DK-TRBL-RSN-LOW       10150624
101507                                       AND :DK-TRBL-RSN-HIGH      10150724
101508            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      10150824
101509                                          , :DK-NOTIF-STAT-2      10150924
101510                                          , :DK-NOTIF-STAT-3      10151024
101511                                          , :DK-NOTIF-STAT-4)     10151124
101512            AND B.NOTIF_IND              = 'T'                    10151224
101513            AND C.STATUS_CDE            IN ('CM', 'IP')           10151324
101514            AND C.REC_TMST         BETWEEN :DK-LOW-REC-TMST       10151424
101515                                       AND :DK-HIGH-REC-TMST      10151524
101516            AND C.ORD_NBR           =  P.PO_NBR                   10151624
101517            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           10151724
101518            AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND      10151824
101519                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR 10151924
101520                     (P.SEASET_YR      = :DK-SEASET-YR-2 AND      10152024
101521                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR 10152124
101522                     (P.SEASET_YR      = :DK-SEASET-YR-3 AND      10152224
101523                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR 10152324
101524                     (P.SEASET_YR      = :DK-SEASET-YR-4 AND      10152424
101525                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR 10152526
101526                     (P.SEASET_YR      = :DK-SEASET-YR-5 AND      10152624
101527                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR 10152724
101528                     (P.SEASET_YR      = :DK-SEASET-YR-6 AND      10152824
101529                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-6)    10152924
101530               )                                                  10153024
101531       ORDER BY 19                                                10153124
101532              , 20                                                10153224
101533              , 6                                                 10153324
101534              , 9                                                 10153424
101535              , 10                                                10153524
101536         WITH UR                                                  10153624
101537     END-EXEC.                                                    10153724
101538                                                                  10153824
101539*---------------------------------------------------------------* 10153900
101540*    BUYER CURSOR FOR A SPECIFIED BUYER                         * 10154000
101600*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10160000
101700*    THE CURSOR.                                                * 10170000
101800*    THE RESULTS OF THIS CURSOR WILL BE IN ARRIVAL DATE SEQ.    * 10180000
101900*---------------------------------------------------------------* 10190000
102000                                                                  10200000
102100     EXEC SQL                                                     10210000
102200          DECLARE BUYER-BY-ARRIVAL CURSOR                         10220000
102300          FOR SELECT                                              10230000
102400                    A.NOTIF_NBR                                   10240000
102500                  , A.OPER_UNT_ID                                 10250000
102600                  , A.FCLTY_ID                                    10260000
102700                  , A.DEPT_NBR                                    10270000
102800                  , A.ENT_ID                                      10280000
102900                  , A.PO_NBR                                      10290000
103000                  , A.PO_LNE_NBR                                  10300000
103100                  , A.PREPK_ID                                    10310000
103200                  , A.REC_SEQ_NBR                                 10320000
103300                  , A.TRBL_RSN_CDE                                10330000
103400                  , A.NOTIF_TMST                                  10340000
103500                  , A.RESOLVED_IND                                10350000
103600                  , A.RESOLVED_TMST                               10360000
103700                  , A.ACKNOWLG_TMST                               10370000
103800                  , C.TRBL_SHT_DESC                               10380000
103900                  , C.RESP_RES_IND                                10390000
104000                  , C.TRBL_LVL_IND                                10400000
104100                  , C.RSLV_RSPNT_CDE                              10410000
104200                  , D.REC_TMST                                    10420000
104300                  , D.CRE_TMST                                    10430000
104400          FROM                                                    10440000
104500                TTRBNTF A                                         10450000
104600              , TMDSEAR B                                         10460000
104700              , TTRBRSN C                                         10470000
104800              , TRECEIV D                                         10480000
104900         WHERE                                                    10490000
105000                D.ORD_NBR                =  A.PO_NBR              10500000
105100            AND ((D.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     10510000
105200                 (D.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     10520000
105300                  EXISTS(SELECT 1 FROM TTRBRCN E                  10530000
105400                          WHERE A.TRBL_RSN_CDE =  E.TRBL_RSN_CDE  10540000
105500                            AND E.RPT_PGM_NM   =  'TMKCS521')))   10550000
105600            AND D.FCLTY_ID               =  A.FCLTY_ID            10560000
105700            AND D.ML_POST_TMST      = '9999-09-09-09.09.09.999999'10570000
105800            AND D.REC_SEQ_NBR            =  A.REC_SEQ_NBR         10580000
105900            AND A.TRBL_RSN_CDE           =  C.TRBL_RSN_CDE        10590000
106000            AND B.DEPT_NBR               =  A.DEPT_NBR            10600000
106100            AND B.BYR_NBR                =  :DK-BUYER-NBR         10610000
106200            AND B.MDSELV_CDE             =  'DPT'                 10620000
106300            AND B.OPERCO_NBR             =  '03'                  10630000
106400            AND B.STRT_DTE              <=  CURRENT DATE          10640000
106500            AND B.END_DTE               >=  CURRENT DATE          10650000
106600            AND D.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   10660000
106700                                       AND  :DK-OPER-UNT-ID-HIGH  10670000
106800            AND A.FCLTY_ID               =  1                     10680000
106900            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        10690000
107000                                       AND  :DK-PO-NBR-HIGH       10700000
107100            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      10710000
107200                                       AND  :DK-TRBL-RSN-HIGH     10720000
107300            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      10730000
107400                                          , :DK-NOTIF-STAT-2      10740000
107500                                          , :DK-NOTIF-STAT-3      10750000
107600                                          , :DK-NOTIF-STAT-4)     10760000
107700            AND C.NOTIF_IND              =  'T'                   10770000
107800            AND D.STATUS_CDE            IN  ('CM', 'IP')          10780000
107900            AND D.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      10790000
108000                                       AND  :DK-HIGH-REC-TMST     10800000
108100       ORDER BY 19                                                10810000
108200              , 20                                                10820000
108300              , 6                                                 10830000
108400              , 9                                                 10840000
108500              , 10                                                10850000
108510         WITH UR                                                  10851024
108600     END-EXEC.                                                    10860000
108610                                                                  10861024
108620     EXEC SQL                                                     10862024
108630          DECLARE BUYER-BY-ARRIVAL-INCL-SET CURSOR                10863024
108640          FOR SELECT                                              10864024
108650                    A.NOTIF_NBR                                   10865024
108660                  , A.OPER_UNT_ID                                 10866024
108670                  , A.FCLTY_ID                                    10867024
108680                  , A.DEPT_NBR                                    10868024
108690                  , A.ENT_ID                                      10869024
108691                  , A.PO_NBR                                      10869124
108692                  , A.PO_LNE_NBR                                  10869224
108693                  , A.PREPK_ID                                    10869324
108694                  , A.REC_SEQ_NBR                                 10869424
108695                  , A.TRBL_RSN_CDE                                10869524
108696                  , A.NOTIF_TMST                                  10869624
108697                  , A.RESOLVED_IND                                10869724
108698                  , A.RESOLVED_TMST                               10869824
108699                  , A.ACKNOWLG_TMST                               10869924
108700                  , C.TRBL_SHT_DESC                               10870024
108701                  , C.RESP_RES_IND                                10870124
108702                  , C.TRBL_LVL_IND                                10870224
108703                  , C.RSLV_RSPNT_CDE                              10870324
108704                  , D.REC_TMST                                    10870424
108705                  , D.CRE_TMST                                    10870524
108706          FROM                                                    10870624
108707                TTRBNTF A                                         10870724
108708              , TMDSEAR B                                         10870824
108709              , TTRBRSN C                                         10870924
108710              , TRECEIV D                                         10871024
108711              , TPURCHS P                                         10871124
108712         WHERE                                                    10871224
108713                D.ORD_NBR                =  A.PO_NBR              10871324
108714            AND ((D.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     10871424
108715                 (D.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     10871524
108716                  EXISTS(SELECT 1 FROM TTRBRCN E                  10871624
108717                          WHERE A.TRBL_RSN_CDE =  E.TRBL_RSN_CDE  10871724
108718                            AND E.RPT_PGM_NM   =  'TMKCS521')))   10871824
108719            AND D.FCLTY_ID               =  A.FCLTY_ID            10871924
108720            AND D.ML_POST_TMST      = '9999-09-09-09.09.09.999999'10872024
108721            AND D.REC_SEQ_NBR            =  A.REC_SEQ_NBR         10872124
108722            AND A.TRBL_RSN_CDE           =  C.TRBL_RSN_CDE        10872224
108723            AND B.DEPT_NBR               =  A.DEPT_NBR            10872324
108724            AND B.BYR_NBR                =  :DK-BUYER-NBR         10872424
108725            AND B.MDSELV_CDE             =  'DPT'                 10872524
108726            AND B.OPERCO_NBR             =  '03'                  10872624
108727            AND B.STRT_DTE              <=  CURRENT DATE          10872724
108728            AND B.END_DTE               >=  CURRENT DATE          10872824
108729            AND D.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   10872924
108730                                       AND  :DK-OPER-UNT-ID-HIGH  10873024
108731            AND A.FCLTY_ID               =  1                     10873124
108732            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        10873224
108733                                       AND  :DK-PO-NBR-HIGH       10873324
108734            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      10873424
108735                                       AND  :DK-TRBL-RSN-HIGH     10873524
108736            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      10873624
108737                                          , :DK-NOTIF-STAT-2      10873724
108738                                          , :DK-NOTIF-STAT-3      10873824
108739                                          , :DK-NOTIF-STAT-4)     10873924
108740            AND C.NOTIF_IND              =  'T'                   10874024
108741            AND D.STATUS_CDE            IN  ('CM', 'IP')          10874124
108742            AND D.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      10874224
108743                                       AND  :DK-HIGH-REC-TMST     10874324
108744            AND D.ORD_NBR           =  P.PO_NBR                   10874424
108745            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           10874524
108746            AND ((P.SEASET_YR       = :DK-SEASET-YR-1 AND         10874624
108747                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-1) OR    10874724
108748                 (P.SEASET_YR       = :DK-SEASET-YR-2 AND         10874824
108749                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-2) OR    10874924
108750                 (P.SEASET_YR       = :DK-SEASET-YR-3 AND         10875024
108751                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-3) OR    10875124
108752                 (P.SEASET_YR       = :DK-SEASET-YR-4 AND         10875224
108753                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-4) OR    10875324
108754                 (P.SEASET_YR       = :DK-SEASET-YR-5 AND         10875424
108755                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-5) OR    10875524
108756                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         10875624
108757                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       10875724
108758               )                                                  10875824
108759       ORDER BY 19                                                10875924
108760              , 20                                                10876024
108761              , 6                                                 10876124
108762              , 9                                                 10876224
108763              , 10                                                10876324
108764         WITH UR                                                  10876424
108765     END-EXEC.                                                    10876524
108770                                                                  10877024
108780     EXEC SQL                                                     10878024
108790          DECLARE BUYER-BY-ARRIVAL-EXCL-SET CURSOR                10879024
108791          FOR SELECT                                              10879124
108792                    A.NOTIF_NBR                                   10879224
108793                  , A.OPER_UNT_ID                                 10879324
108794                  , A.FCLTY_ID                                    10879424
108795                  , A.DEPT_NBR                                    10879524
108796                  , A.ENT_ID                                      10879624
108797                  , A.PO_NBR                                      10879724
108798                  , A.PO_LNE_NBR                                  10879824
108799                  , A.PREPK_ID                                    10879924
108800                  , A.REC_SEQ_NBR                                 10880024
108801                  , A.TRBL_RSN_CDE                                10880124
108802                  , A.NOTIF_TMST                                  10880224
108803                  , A.RESOLVED_IND                                10880324
108804                  , A.RESOLVED_TMST                               10880424
108805                  , A.ACKNOWLG_TMST                               10880524
108806                  , C.TRBL_SHT_DESC                               10880624
108807                  , C.RESP_RES_IND                                10880724
108808                  , C.TRBL_LVL_IND                                10880824
108809                  , C.RSLV_RSPNT_CDE                              10880924
108810                  , D.REC_TMST                                    10881024
108811                  , D.CRE_TMST                                    10881124
108812          FROM                                                    10881224
108813                TTRBNTF A                                         10881324
108814              , TMDSEAR B                                         10881424
108815              , TTRBRSN C                                         10881524
108816              , TRECEIV D                                         10881624
108817              , TPURCHS P                                         10881724
108818         WHERE                                                    10881824
108819                D.ORD_NBR                =  A.PO_NBR              10881924
108820            AND ((D.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     10882024
108821                 (D.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     10882124
108822                  EXISTS(SELECT 1 FROM TTRBRCN E                  10882224
108823                          WHERE A.TRBL_RSN_CDE =  E.TRBL_RSN_CDE  10882324
108824                            AND E.RPT_PGM_NM   =  'TMKCS521')))   10882424
108825            AND D.FCLTY_ID               =  A.FCLTY_ID            10882524
108826            AND D.ML_POST_TMST      = '9999-09-09-09.09.09.999999'10882624
108827            AND D.REC_SEQ_NBR            =  A.REC_SEQ_NBR         10882724
108828            AND A.TRBL_RSN_CDE           =  C.TRBL_RSN_CDE        10882824
108829            AND B.DEPT_NBR               =  A.DEPT_NBR            10882924
108830            AND B.BYR_NBR                =  :DK-BUYER-NBR         10883024
108831            AND B.MDSELV_CDE             =  'DPT'                 10883124
108832            AND B.OPERCO_NBR             =  '03'                  10883224
108833            AND B.STRT_DTE              <=  CURRENT DATE          10883324
108834            AND B.END_DTE               >=  CURRENT DATE          10883424
108835            AND D.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   10883524
108836                                       AND  :DK-OPER-UNT-ID-HIGH  10883624
108837            AND A.FCLTY_ID               =  1                     10883724
108838            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        10883824
108839                                       AND  :DK-PO-NBR-HIGH       10883924
108840            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      10884024
108841                                       AND  :DK-TRBL-RSN-HIGH     10884124
108842            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      10884224
108843                                          , :DK-NOTIF-STAT-2      10884324
108844                                          , :DK-NOTIF-STAT-3      10884424
108845                                          , :DK-NOTIF-STAT-4)     10884524
108846            AND C.NOTIF_IND              =  'T'                   10884624
108847            AND D.STATUS_CDE            IN  ('CM', 'IP')          10884724
108848            AND D.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      10884824
108849                                       AND  :DK-HIGH-REC-TMST     10884924
108850            AND D.ORD_NBR           =  P.PO_NBR                   10885024
108851            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           10885124
108852            AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND      10885224
108853                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR 10885324
108854                     (P.SEASET_YR      = :DK-SEASET-YR-2 AND      10885424
108855                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR 10885524
108856                     (P.SEASET_YR      = :DK-SEASET-YR-3 AND      10885624
108857                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR 10885724
108858                     (P.SEASET_YR      = :DK-SEASET-YR-4 AND      10885824
108859                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR 10885924
108860                     (P.SEASET_YR      = :DK-SEASET-YR-5 AND      10886024
108861                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR 10886124
108862                     (P.SEASET_YR      = :DK-SEASET-YR-6 AND      10886224
108863                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-6)    10886324
108864                   )                                              10886424
108865       ORDER BY 19                                                10886524
108866              , 20                                                10886624
108867              , 6                                                 10886724
108868              , 9                                                 10886824
108869              , 10                                                10886924
108870         WITH UR                                                  10887024
108871     END-EXEC.                                                    10887124
108872                                                                  10887224
108880*---------------------------------------------------------------* 10888000
108900*    PO / RCVR CURSOR FOR A SPECIFIED PO OR PO/RECEIVER         * 10890000
109000*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 10900000
109100*    THE CURSOR.                                                * 10910000
109200*    THE RESULTS OF THIS CURSOR WILL BE IN ARRIVAL DATE SEQ.    * 10920000
109300*---------------------------------------------------------------* 10930000
109400                                                                  10940000
109500     EXEC SQL                                                     10950000
109600          DECLARE PORCVR-BY-ARRIVAL CURSOR                        10960000
109700          FOR SELECT                                              10970000
109800                    A.NOTIF_NBR                                   10980000
109900                  , A.OPER_UNT_ID                                 10990000
110000                  , A.FCLTY_ID                                    11000000
110100                  , A.DEPT_NBR                                    11010000
110200                  , A.ENT_ID                                      11020000
110300                  , A.PO_NBR                                      11030000
110400                  , A.PO_LNE_NBR                                  11040000
110500                  , A.PREPK_ID                                    11050000
110600                  , A.REC_SEQ_NBR                                 11060000
110700                  , A.TRBL_RSN_CDE                                11070000
110800                  , A.NOTIF_TMST                                  11080000
110900                  , A.RESOLVED_IND                                11090000
111000                  , A.RESOLVED_TMST                               11100000
111100                  , A.ACKNOWLG_TMST                               11110000
111200                  , B.TRBL_SHT_DESC                               11120000
111300                  , B.RESP_RES_IND                                11130000
111400                  , B.TRBL_LVL_IND                                11140000
111500                  , B.RSLV_RSPNT_CDE                              11150000
111600                  , C.REC_TMST                                    11160000
111700                  , C.CRE_TMST                                    11170000
111800          FROM                                                    11180000
111900                TTRBNTF A                                         11190000
112000              , TTRBRSN B                                         11200000
112100              , TRECEIV C                                         11210000
112200         WHERE                                                    11220000
112300                 C.ORD_NBR                 = A.PO_NBR             11230000
112400             AND C.REC_SEQ_NBR             = A.REC_SEQ_NBR        11240000
112600             AND A.TRBL_RSN_CDE            = B.TRBL_RSN_CDE       11260000
113000             AND A.PO_NBR                  = :DK-PO-NBR           11300000
113100             AND A.REC_SEQ_NBR       BETWEEN :DK-REC-SEQ-NBR-LOW  11310000
113200                                         AND :DK-REC-SEQ-NBR-HIGH 11320000
113300             AND A.TRBL_RSN_CDE      BETWEEN :DK-TRBL-RSN-LOW     11330000
113400                                         AND :DK-TRBL-RSN-HIGH    11340000
113500             AND A.RESOLVED_IND           IN (:DK-NOTIF-STAT-1    11350000
113600                                            , :DK-NOTIF-STAT-2    11360000
113700                                            , :DK-NOTIF-STAT-3    11370000
113800                                            , :DK-NOTIF-STAT-4)   11380000
113900             AND C.REC_TMST          BETWEEN :DK-LOW-REC-TMST     11390000
114000                                         AND :DK-HIGH-REC-TMST    11400000
114100       ORDER BY 19                                                11410000
114200              , 20                                                11420000
114300              , 6                                                 11430000
114400              , 9                                                 11440000
114500              , 10                                                11450000
114510         WITH UR                                                  11451024
114600     END-EXEC.                                                    11460000
114610                                                                  11461024
114620     EXEC SQL                                                     11462024
114630          DECLARE PORCVR-BY-ARRIVAL-INCL-SET CURSOR               11463024
114640          FOR SELECT                                              11464024
114650                    A.NOTIF_NBR                                   11465024
114660                  , A.OPER_UNT_ID                                 11466024
114670                  , A.FCLTY_ID                                    11467024
114680                  , A.DEPT_NBR                                    11468024
114690                  , A.ENT_ID                                      11469024
114691                  , A.PO_NBR                                      11469124
114692                  , A.PO_LNE_NBR                                  11469224
114693                  , A.PREPK_ID                                    11469324
114694                  , A.REC_SEQ_NBR                                 11469424
114695                  , A.TRBL_RSN_CDE                                11469524
114696                  , A.NOTIF_TMST                                  11469624
114697                  , A.RESOLVED_IND                                11469724
114698                  , A.RESOLVED_TMST                               11469824
114699                  , A.ACKNOWLG_TMST                               11469924
114700                  , B.TRBL_SHT_DESC                               11470024
114701                  , B.RESP_RES_IND                                11470124
114702                  , B.TRBL_LVL_IND                                11470224
114703                  , B.RSLV_RSPNT_CDE                              11470324
114704                  , C.REC_TMST                                    11470424
114705                  , C.CRE_TMST                                    11470524
114706          FROM                                                    11470624
114707                TTRBNTF A                                         11470724
114708              , TTRBRSN B                                         11470824
114709              , TRECEIV C                                         11470924
114710              , TPURCHS P                                         11471024
114711         WHERE                                                    11471124
114712                 C.ORD_NBR                 = A.PO_NBR             11471224
114713             AND C.REC_SEQ_NBR             = A.REC_SEQ_NBR        11471324
114714             AND A.TRBL_RSN_CDE            = B.TRBL_RSN_CDE       11471424
114715             AND A.PO_NBR                  = :DK-PO-NBR           11471524
114716             AND A.REC_SEQ_NBR       BETWEEN :DK-REC-SEQ-NBR-LOW  11471624
114717                                         AND :DK-REC-SEQ-NBR-HIGH 11471724
114718             AND A.TRBL_RSN_CDE      BETWEEN :DK-TRBL-RSN-LOW     11471824
114719                                         AND :DK-TRBL-RSN-HIGH    11471924
114720             AND A.RESOLVED_IND           IN (:DK-NOTIF-STAT-1    11472024
114721                                            , :DK-NOTIF-STAT-2    11472124
114722                                            , :DK-NOTIF-STAT-3    11472224
114723                                            , :DK-NOTIF-STAT-4)   11472324
114724             AND C.REC_TMST          BETWEEN :DK-LOW-REC-TMST     11472424
114725                                         AND :DK-HIGH-REC-TMST    11472524
114726            AND C.ORD_NBR           =  P.PO_NBR                   11472624
114727            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           11472724
114728            AND ((P.SEASET_YR       = :DK-SEASET-YR-1 AND         11472824
114729                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-1) OR    11472924
114730                 (P.SEASET_YR       = :DK-SEASET-YR-2 AND         11473024
114731                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-2) OR    11473124
114732                 (P.SEASET_YR       = :DK-SEASET-YR-3 AND         11473224
114733                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-3) OR    11473324
114734                 (P.SEASET_YR       = :DK-SEASET-YR-4 AND         11473424
114735                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-4) OR    11473524
114736                 (P.SEASET_YR       = :DK-SEASET-YR-5 AND         11473624
114737                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-5) OR    11473726
114738                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         11473824
114739                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       11473924
114740               )                                                  11474024
114741       ORDER BY 19                                                11474124
114742              , 20                                                11474224
114743              , 6                                                 11474324
114744              , 9                                                 11474424
114745              , 10                                                11474524
114746         WITH UR                                                  11474624
114747     END-EXEC.                                                    11474724
114750                                                                  11475000
114760     EXEC SQL                                                     11476024
114770          DECLARE PORCVR-BY-ARRIVAL-EXCL-SET CURSOR               11477024
114780          FOR SELECT                                              11478024
114790                    A.NOTIF_NBR                                   11479024
114791                  , A.OPER_UNT_ID                                 11479124
114792                  , A.FCLTY_ID                                    11479224
114793                  , A.DEPT_NBR                                    11479324
114794                  , A.ENT_ID                                      11479424
114795                  , A.PO_NBR                                      11479524
114796                  , A.PO_LNE_NBR                                  11479624
114797                  , A.PREPK_ID                                    11479724
114798                  , A.REC_SEQ_NBR                                 11479824
114799                  , A.TRBL_RSN_CDE                                11479924
114800                  , A.NOTIF_TMST                                  11480024
114801                  , A.RESOLVED_IND                                11480124
114802                  , A.RESOLVED_TMST                               11480224
114803                  , A.ACKNOWLG_TMST                               11480324
114804                  , B.TRBL_SHT_DESC                               11480424
114805                  , B.RESP_RES_IND                                11480524
114806                  , B.TRBL_LVL_IND                                11480624
114807                  , B.RSLV_RSPNT_CDE                              11480724
114808                  , C.REC_TMST                                    11480824
114809                  , C.CRE_TMST                                    11480924
114810          FROM                                                    11481024
114811                TTRBNTF A                                         11481124
114812              , TTRBRSN B                                         11481224
114813              , TRECEIV C                                         11481324
114814              , TPURCHS P                                         11481424
114815         WHERE                                                    11481524
114816                 C.ORD_NBR                 = A.PO_NBR             11481624
114817             AND C.REC_SEQ_NBR             = A.REC_SEQ_NBR        11481724
114818             AND A.TRBL_RSN_CDE            = B.TRBL_RSN_CDE       11481824
114819             AND A.PO_NBR                  = :DK-PO-NBR           11481924
114820             AND A.REC_SEQ_NBR       BETWEEN :DK-REC-SEQ-NBR-LOW  11482024
114821                                         AND :DK-REC-SEQ-NBR-HIGH 11482124
114822             AND A.TRBL_RSN_CDE      BETWEEN :DK-TRBL-RSN-LOW     11482224
114823                                         AND :DK-TRBL-RSN-HIGH    11482324
114824             AND A.RESOLVED_IND           IN (:DK-NOTIF-STAT-1    11482424
114825                                            , :DK-NOTIF-STAT-2    11482524
114826                                            , :DK-NOTIF-STAT-3    11482624
114827                                            , :DK-NOTIF-STAT-4)   11482724
114828             AND C.REC_TMST          BETWEEN :DK-LOW-REC-TMST     11482824
114829                                         AND :DK-HIGH-REC-TMST    11482924
114830            AND C.ORD_NBR           =  P.PO_NBR                   11483024
114831            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           11483124
114832            AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND      11483224
114833                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR 11483324
114834                     (P.SEASET_YR      = :DK-SEASET-YR-2 AND      11483424
114835                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR 11483524
114836                     (P.SEASET_YR      = :DK-SEASET-YR-3 AND      11483624
114837                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR 11483724
114838                     (P.SEASET_YR      = :DK-SEASET-YR-4 AND      11483824
114839                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR 11483924
114840                     (P.SEASET_YR      = :DK-SEASET-YR-5 AND      11484024
114841                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR 11484124
114842                     (P.SEASET_YR      = :DK-SEASET-YR-6 AND      11484224
114843                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-6)    11484324
114844                   )                                              11484424
114845       ORDER BY 19                                                11484524
114846              , 20                                                11484624
114847              , 6                                                 11484724
114848              , 9                                                 11484824
114849              , 10                                                11484924
114850         WITH UR                                                  11485024
114851     END-EXEC.                                                    11485124
114852                                                                  11485224
114860***************************************************************** 11486000
114900*---------------------------------------------------------------* 11490000
115000*    OPERATING UNIT CURSOR  FOR A SPECIFIED OPERATING UNIT      * 11500000
115100*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 11510000
115200*    THE CURSOR.                                                * 11520000
115300*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 11530000
115400*---------------------------------------------------------------* 11540000
115500                                                                  11550000
115600     EXEC SQL                                                     11560000
115700          DECLARE OPER-UNT-BY-TRBL CURSOR                         11570000
115800          FOR SELECT                                              11580000
115900                    A.NOTIF_NBR                                   11590000
116000                  , A.OPER_UNT_ID                                 11600000
116100                  , A.FCLTY_ID                                    11610000
116200                  , A.DEPT_NBR                                    11620000
116300                  , A.ENT_ID                                      11630000
116400                  , A.PO_NBR                                      11640000
116500                  , A.PO_LNE_NBR                                  11650000
116600                  , A.PREPK_ID                                    11660000
116700                  , A.REC_SEQ_NBR                                 11670000
116800                  , A.TRBL_RSN_CDE                                11680000
116900                  , A.NOTIF_TMST                                  11690000
117000                  , A.RESOLVED_IND                                11700000
117100                  , A.RESOLVED_TMST                               11710000
117200                  , A.ACKNOWLG_TMST                               11720000
117300                  , B.TRBL_SHT_DESC                               11730000
117400                  , B.RESP_RES_IND                                11740000
117500                  , B.TRBL_LVL_IND                                11750000
117600                  , B.RSLV_RSPNT_CDE                              11760000
117700                  , C.REC_TMST                                    11770000
117800                  , C.CRE_TMST                                    11780000
117900          FROM                                                    11790000
118000                TTRBNTF A                                         11800000
118100              , TTRBRSN B                                         11810000
118200              , TRECEIV C                                         11820000
118300         WHERE                                                    11830000
118400             C.ORD_NBR             = A.PO_NBR                     11840000
118500         AND C.ML_POST_TMST        = '9999-09-09-09.09.09.999999' 11850000
118600         AND C.REC_SEQ_NBR         =  A.REC_SEQ_NBR               11860000
118700         AND ((C.OPER_UNT_ID       =  A.OPER_UNT_ID) OR           11870000
118800              (C.OPER_UNT_ID      <>  A.OPER_UNT_ID AND           11880000
118900               EXISTS(SELECT 1 FROM TTRBRCN D                     11890000
119000                       WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE     11900000
119100                         AND D.RPT_PGM_NM   =  'TMKCS521')))      11910000
119200         AND C.FCLTY_ID            =  A.FCLTY_ID                  11920000
119300         AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE              11930000
119400         AND C.CURR_OPER_UNT_ID    =  :DK-OPER-UNT-ID             11940000
119500         AND A.FCLTY_ID            =  1                           11950000
119600         AND C.ORD_NBR       BETWEEN  :DK-PO-NBR-LOW              11960000
119700                                 AND  :DK-PO-NBR-HIGH             11970000
119800         AND C.STATUS_CDE         IN ('CM', 'IP')                 11980000
119900         AND A.TRBL_RSN_CDE  BETWEEN  :DK-TRBL-RSN-LOW            11990000
120000                                 AND  :DK-TRBL-RSN-HIGH           12000000
120100         AND A.RESOLVED_IND       IN (:DK-NOTIF-STAT-1            12010000
120200                                    , :DK-NOTIF-STAT-2            12020000
120300                                    , :DK-NOTIF-STAT-3            12030000
120400                                    , :DK-NOTIF-STAT-4)           12040000
120500         AND B.NOTIF_IND           =  'T'                         12050000
120600         AND C.REC_TMST      BETWEEN  :DK-LOW-REC-TMST            12060000
120700                                 AND  :DK-HIGH-REC-TMST           12070000
120800       ORDER BY 11                                                12080000
120900              , 20                                                12090000
121000              , 6                                                 12100000
121100              , 9                                                 12110000
121200              , 10                                                12120000
121210         WITH UR                                                  12121024
121300     END-EXEC.                                                    12130000
121310                                                                  12131024
121320     EXEC SQL                                                     12132024
121330          DECLARE OPER-UNT-BY-TRBL-INCL-SET CURSOR                12133024
121340          FOR SELECT                                              12134024
121350                    A.NOTIF_NBR                                   12135024
121360                  , A.OPER_UNT_ID                                 12136024
121370                  , A.FCLTY_ID                                    12137024
121380                  , A.DEPT_NBR                                    12138024
121390                  , A.ENT_ID                                      12139024
121391                  , A.PO_NBR                                      12139124
121392                  , A.PO_LNE_NBR                                  12139224
121393                  , A.PREPK_ID                                    12139324
121394                  , A.REC_SEQ_NBR                                 12139424
121395                  , A.TRBL_RSN_CDE                                12139524
121396                  , A.NOTIF_TMST                                  12139624
121397                  , A.RESOLVED_IND                                12139724
121398                  , A.RESOLVED_TMST                               12139824
121399                  , A.ACKNOWLG_TMST                               12139924
121400                  , B.TRBL_SHT_DESC                               12140024
121401                  , B.RESP_RES_IND                                12140124
121402                  , B.TRBL_LVL_IND                                12140224
121403                  , B.RSLV_RSPNT_CDE                              12140324
121404                  , C.REC_TMST                                    12140424
121405                  , C.CRE_TMST                                    12140524
121406          FROM                                                    12140624
121407                TTRBNTF A                                         12140724
121408              , TTRBRSN B                                         12140824
121409              , TRECEIV C                                         12140924
121410              , TPURCHS P                                         12141024
121411         WHERE                                                    12141124
121412             C.ORD_NBR             = A.PO_NBR                     12141224
121413         AND C.ML_POST_TMST        = '9999-09-09-09.09.09.999999' 12141324
121414         AND C.REC_SEQ_NBR         =  A.REC_SEQ_NBR               12141424
121415         AND ((C.OPER_UNT_ID       =  A.OPER_UNT_ID) OR           12141524
121416              (C.OPER_UNT_ID      <>  A.OPER_UNT_ID AND           12141624
121417               EXISTS(SELECT 1 FROM TTRBRCN D                     12141724
121418                       WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE     12141824
121419                         AND D.RPT_PGM_NM   =  'TMKCS521')))      12141924
121420         AND C.FCLTY_ID            =  A.FCLTY_ID                  12142024
121421         AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE              12142124
121422         AND C.CURR_OPER_UNT_ID    =  :DK-OPER-UNT-ID             12142224
121423         AND A.FCLTY_ID            =  1                           12142324
121424         AND C.ORD_NBR       BETWEEN  :DK-PO-NBR-LOW              12142424
121425                                 AND  :DK-PO-NBR-HIGH             12142524
121426         AND C.STATUS_CDE         IN ('CM', 'IP')                 12142624
121427         AND A.TRBL_RSN_CDE  BETWEEN  :DK-TRBL-RSN-LOW            12142724
121428                                 AND  :DK-TRBL-RSN-HIGH           12142824
121429         AND A.RESOLVED_IND       IN (:DK-NOTIF-STAT-1            12142924
121430                                    , :DK-NOTIF-STAT-2            12143024
121431                                    , :DK-NOTIF-STAT-3            12143124
121432                                    , :DK-NOTIF-STAT-4)           12143224
121433         AND B.NOTIF_IND           =  'T'                         12143324
121434         AND C.REC_TMST      BETWEEN  :DK-LOW-REC-TMST            12143424
121435                                 AND  :DK-HIGH-REC-TMST           12143524
121436         AND C.ORD_NBR           =  P.PO_NBR                      12143625
121437         AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS              12143725
121438         AND ((P.SEASET_YR       = :DK-SEASET-YR-1 AND            12143825
121439               P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-1) OR       12143925
121440              (P.SEASET_YR       = :DK-SEASET-YR-2 AND            12144025
121441               P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-2) OR       12144125
121442              (P.SEASET_YR       = :DK-SEASET-YR-3 AND            12144225
121443               P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-3) OR       12144325
121444              (P.SEASET_YR       = :DK-SEASET-YR-4 AND            12144425
121445               P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-4) OR       12144525
121446              (P.SEASET_YR       = :DK-SEASET-YR-5 AND            12144625
121447               P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-5) OR       12144725
121448               (P.SEASET_YR       = :DK-SEASET-YR-6 AND           12144825
121449               P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)          12144925
121450            )                                                     12145025
121451       ORDER BY 11                                                12145124
121452              , 20                                                12145224
121453              , 6                                                 12145324
121454              , 9                                                 12145424
121455              , 10                                                12145524
121456         WITH UR                                                  12145624
121457     END-EXEC.                                                    12145724
121458                                                                  12145825
121459     EXEC SQL                                                     12145925
121460          DECLARE OPER-UNT-BY-TRBL-EXCL-SET CURSOR                12146025
121461          FOR SELECT                                              12146125
121462                    A.NOTIF_NBR                                   12146225
121463                  , A.OPER_UNT_ID                                 12146325
121464                  , A.FCLTY_ID                                    12146425
121465                  , A.DEPT_NBR                                    12146525
121466                  , A.ENT_ID                                      12146625
121467                  , A.PO_NBR                                      12146725
121468                  , A.PO_LNE_NBR                                  12146825
121469                  , A.PREPK_ID                                    12146925
121470                  , A.REC_SEQ_NBR                                 12147025
121471                  , A.TRBL_RSN_CDE                                12147125
121472                  , A.NOTIF_TMST                                  12147225
121473                  , A.RESOLVED_IND                                12147325
121474                  , A.RESOLVED_TMST                               12147425
121475                  , A.ACKNOWLG_TMST                               12147525
121476                  , B.TRBL_SHT_DESC                               12147625
121477                  , B.RESP_RES_IND                                12147725
121478                  , B.TRBL_LVL_IND                                12147825
121479                  , B.RSLV_RSPNT_CDE                              12147925
121480                  , C.REC_TMST                                    12148025
121481                  , C.CRE_TMST                                    12148125
121482          FROM                                                    12148225
121483                TTRBNTF A                                         12148325
121484              , TTRBRSN B                                         12148425
121485              , TRECEIV C                                         12148525
121486              , TPURCHS P                                         12148625
121487         WHERE                                                    12148725
121488             C.ORD_NBR             = A.PO_NBR                     12148825
121489         AND C.ML_POST_TMST        = '9999-09-09-09.09.09.999999' 12148925
121490         AND C.REC_SEQ_NBR         =  A.REC_SEQ_NBR               12149025
121491         AND ((C.OPER_UNT_ID       =  A.OPER_UNT_ID) OR           12149125
121492              (C.OPER_UNT_ID      <>  A.OPER_UNT_ID AND           12149225
121493               EXISTS(SELECT 1 FROM TTRBRCN D                     12149325
121494                       WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE     12149425
121495                         AND D.RPT_PGM_NM   =  'TMKCS521')))      12149525
121496         AND C.FCLTY_ID            =  A.FCLTY_ID                  12149625
121497         AND A.TRBL_RSN_CDE        =  B.TRBL_RSN_CDE              12149725
121498         AND C.CURR_OPER_UNT_ID    =  :DK-OPER-UNT-ID             12149825
121499         AND A.FCLTY_ID            =  1                           12149925
121500         AND C.ORD_NBR       BETWEEN  :DK-PO-NBR-LOW              12150025
121501                                 AND  :DK-PO-NBR-HIGH             12150125
121502         AND C.STATUS_CDE         IN ('CM', 'IP')                 12150225
121503         AND A.TRBL_RSN_CDE  BETWEEN  :DK-TRBL-RSN-LOW            12150325
121504                                 AND  :DK-TRBL-RSN-HIGH           12150425
121505         AND A.RESOLVED_IND       IN (:DK-NOTIF-STAT-1            12150525
121506                                    , :DK-NOTIF-STAT-2            12150625
121507                                    , :DK-NOTIF-STAT-3            12150725
121508                                    , :DK-NOTIF-STAT-4)           12150825
121509         AND B.NOTIF_IND           =  'T'                         12150925
121510         AND C.REC_TMST      BETWEEN  :DK-LOW-REC-TMST            12151025
121511                                 AND  :DK-HIGH-REC-TMST           12151125
121512         AND C.ORD_NBR           =  P.PO_NBR                      12151225
121513         AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS              12151325
121514         AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND         12151425
121515                   P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR    12151525
121516                  (P.SEASET_YR      = :DK-SEASET-YR-2 AND         12151625
121517                   P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR    12151725
121518                  (P.SEASET_YR      = :DK-SEASET-YR-3 AND         12151825
121519                   P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR    12151925
121520                  (P.SEASET_YR      = :DK-SEASET-YR-4 AND         12152025
121521                   P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR    12152125
121522                  (P.SEASET_YR      = :DK-SEASET-YR-5 AND         12152225
121523                   P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR    12152325
121524                  (P.SEASET_YR       = :DK-SEASET-YR-6 AND        12152425
121525                   P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)      12152525
121526                 )                                                12152625
121527       ORDER BY 11                                                12152725
121528              , 20                                                12152825
121529              , 6                                                 12152925
121530              , 9                                                 12153025
121531              , 10                                                12153125
121532         WITH UR                                                  12153225
121533     END-EXEC.                                                    12153325
121534                                                                  12153400
121540*---------------------------------------------------------------* 12154000
121600*    DEPARTMENT CURSOR FOR A SPECIFIED DEPARTMENT               * 12160000
121700*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 12170000
121800*    THE CURSOR.                                                * 12180000
121900*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 12190000
122000*---------------------------------------------------------------* 12200000
122100                                                                  12210000
122200     EXEC SQL                                                     12220000
122300          DECLARE DEPT-BY-TRBL CURSOR                             12230000
122400          FOR SELECT                                              12240000
122500                    A.NOTIF_NBR                                   12250000
122600                  , A.OPER_UNT_ID                                 12260000
122700                  , A.FCLTY_ID                                    12270000
122800                  , A.DEPT_NBR                                    12280000
122900                  , A.ENT_ID                                      12290000
123000                  , A.PO_NBR                                      12300000
123100                  , A.PO_LNE_NBR                                  12310000
123200                  , A.PREPK_ID                                    12320000
123300                  , A.REC_SEQ_NBR                                 12330000
123400                  , A.TRBL_RSN_CDE                                12340000
123500                  , A.NOTIF_TMST                                  12350000
123600                  , A.RESOLVED_IND                                12360000
123700                  , A.RESOLVED_TMST                               12370000
123800                  , A.ACKNOWLG_TMST                               12380000
123900                  , B.TRBL_SHT_DESC                               12390000
124000                  , B.RESP_RES_IND                                12400000
124100                  , B.TRBL_LVL_IND                                12410000
124200                  , B.RSLV_RSPNT_CDE                              12420000
124300                  , C.REC_TMST                                    12430000
124400                  , C.CRE_TMST                                    12440000
124500          FROM                                                    12450000
124600                TTRBNTF A                                         12460000
124700              , TTRBRSN B                                         12470000
124800              , TRECEIV C                                         12480000
124900         WHERE                                                    12490000
125000                C.ORD_NBR                =  A.PO_NBR              12500000
125100            AND C.ML_POST_TMST      = '9999-09-09-09.09.09.999999'12510000
125200            AND A.REC_SEQ_NBR            =  C.REC_SEQ_NBR         12520000
125300            AND ((C.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     12530000
125400                 (C.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     12540000
125500                  EXISTS(SELECT 1 FROM TTRBRCN D                  12550000
125600                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  12560000
125700                            AND D.RPT_PGM_NM   =  'TMKCS521')))   12570000
125800            AND C.FCLTY_ID               =  A.FCLTY_ID            12580000
125900            AND A.TRBL_RSN_CDE           =  B.TRBL_RSN_CDE        12590000
126000            AND C.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   12600000
126100                                       AND  :DK-OPER-UNT-ID-HIGH  12610000
126200            AND A.FCLTY_ID               =  1                     12620000
126300            AND A.DEPT_NBR               =  :DK-DEPT-LOW          12630000
126400            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        12640000
126500                                       AND  :DK-PO-NBR-HIGH       12650000
126600            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      12660000
126700                                       AND  :DK-TRBL-RSN-HIGH     12670000
126800            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      12680000
126900                                          , :DK-NOTIF-STAT-2      12690000
127000                                          , :DK-NOTIF-STAT-3      12700000
127100                                          , :DK-NOTIF-STAT-4)     12710000
127200            AND B.NOTIF_IND              =  'T'                   12720000
127300            AND C.STATUS_CDE            IN ('CM', 'IP')           12730000
127400            AND C.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      12740000
127500                                       AND  :DK-HIGH-REC-TMST     12750000
127600       ORDER BY 11                                                12760000
127700              , 20                                                12770000
127800              , 6                                                 12780000
127900              , 9                                                 12790000
128000              , 10                                                12800000
128010         WITH UR                                                  12801025
128100     END-EXEC.                                                    12810000
128110                                                                  12811025
128120     EXEC SQL                                                     12812025
128130          DECLARE DEPT-BY-TRBL-INCL-SET CURSOR                    12813025
128140          FOR SELECT                                              12814025
128150                    A.NOTIF_NBR                                   12815025
128160                  , A.OPER_UNT_ID                                 12816025
128170                  , A.FCLTY_ID                                    12817025
128180                  , A.DEPT_NBR                                    12818025
128190                  , A.ENT_ID                                      12819025
128191                  , A.PO_NBR                                      12819125
128192                  , A.PO_LNE_NBR                                  12819225
128193                  , A.PREPK_ID                                    12819325
128194                  , A.REC_SEQ_NBR                                 12819425
128195                  , A.TRBL_RSN_CDE                                12819525
128196                  , A.NOTIF_TMST                                  12819625
128197                  , A.RESOLVED_IND                                12819725
128198                  , A.RESOLVED_TMST                               12819825
128199                  , A.ACKNOWLG_TMST                               12819925
128200                  , B.TRBL_SHT_DESC                               12820025
128201                  , B.RESP_RES_IND                                12820125
128202                  , B.TRBL_LVL_IND                                12820225
128203                  , B.RSLV_RSPNT_CDE                              12820325
128204                  , C.REC_TMST                                    12820425
128205                  , C.CRE_TMST                                    12820525
128206          FROM                                                    12820625
128207                TTRBNTF A                                         12820725
128208              , TTRBRSN B                                         12820825
128209              , TRECEIV C                                         12820925
128210              , TPURCHS P                                         12821025
128211         WHERE                                                    12821125
128212                C.ORD_NBR                =  A.PO_NBR              12821225
128213            AND C.ML_POST_TMST      = '9999-09-09-09.09.09.999999'12821325
128214            AND A.REC_SEQ_NBR            =  C.REC_SEQ_NBR         12821425
128215            AND ((C.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     12821525
128216                 (C.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     12821625
128217                  EXISTS(SELECT 1 FROM TTRBRCN D                  12821725
128218                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  12821825
128219                            AND D.RPT_PGM_NM   =  'TMKCS521')))   12821925
128220            AND C.FCLTY_ID               =  A.FCLTY_ID            12822025
128221            AND A.TRBL_RSN_CDE           =  B.TRBL_RSN_CDE        12822125
128222            AND C.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   12822225
128223                                       AND  :DK-OPER-UNT-ID-HIGH  12822325
128224            AND A.FCLTY_ID               =  1                     12822425
128225            AND A.DEPT_NBR               =  :DK-DEPT-LOW          12822525
128226            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        12822625
128227                                       AND  :DK-PO-NBR-HIGH       12822725
128228            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      12822825
128229                                       AND  :DK-TRBL-RSN-HIGH     12822925
128230            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      12823025
128231                                          , :DK-NOTIF-STAT-2      12823125
128232                                          , :DK-NOTIF-STAT-3      12823225
128233                                          , :DK-NOTIF-STAT-4)     12823325
128234            AND B.NOTIF_IND              =  'T'                   12823425
128235            AND C.STATUS_CDE            IN ('CM', 'IP')           12823525
128236            AND C.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      12823625
128237                                       AND  :DK-HIGH-REC-TMST     12823725
128238            AND C.ORD_NBR           =  P.PO_NBR                   12823825
128239            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           12823925
128240            AND ((P.SEASET_YR      = :DK-SEASET-YR-1 AND          12824025
128241                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR     12824125
128242                 (P.SEASET_YR      = :DK-SEASET-YR-2 AND          12824225
128243                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR     12824325
128244                 (P.SEASET_YR      = :DK-SEASET-YR-3 AND          12824425
128245                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR     12824525
128246                 (P.SEASET_YR      = :DK-SEASET-YR-4 AND          12824625
128247                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR     12824725
128248                 (P.SEASET_YR      = :DK-SEASET-YR-5 AND          12824825
128249                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR     12824925
128250                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         12825025
128251                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       12825125
128252                )                                                 12825225
128253       ORDER BY 11                                                12825325
128254              , 20                                                12825425
128255              , 6                                                 12825525
128256              , 9                                                 12825625
128257              , 10                                                12825725
128258         WITH UR                                                  12825825
128259     END-EXEC.                                                    12825925
128260                                                                  12826025
128261     EXEC SQL                                                     12826125
128262          DECLARE DEPT-BY-TRBL-EXCL-SET CURSOR                    12826225
128263          FOR SELECT                                              12826325
128264                    A.NOTIF_NBR                                   12826425
128265                  , A.OPER_UNT_ID                                 12826525
128266                  , A.FCLTY_ID                                    12826625
128267                  , A.DEPT_NBR                                    12826725
128268                  , A.ENT_ID                                      12826825
128269                  , A.PO_NBR                                      12826925
128270                  , A.PO_LNE_NBR                                  12827025
128271                  , A.PREPK_ID                                    12827125
128272                  , A.REC_SEQ_NBR                                 12827225
128273                  , A.TRBL_RSN_CDE                                12827325
128274                  , A.NOTIF_TMST                                  12827425
128275                  , A.RESOLVED_IND                                12827525
128276                  , A.RESOLVED_TMST                               12827625
128277                  , A.ACKNOWLG_TMST                               12827725
128278                  , B.TRBL_SHT_DESC                               12827825
128279                  , B.RESP_RES_IND                                12827925
128280                  , B.TRBL_LVL_IND                                12828025
128281                  , B.RSLV_RSPNT_CDE                              12828125
128282                  , C.REC_TMST                                    12828225
128283                  , C.CRE_TMST                                    12828325
128284          FROM                                                    12828425
128285                TTRBNTF A                                         12828525
128286              , TTRBRSN B                                         12828625
128287              , TRECEIV C                                         12828725
128288              , TPURCHS P                                         12828825
128289         WHERE                                                    12828925
128290                C.ORD_NBR                =  A.PO_NBR              12829025
128291            AND C.ML_POST_TMST      = '9999-09-09-09.09.09.999999'12829125
128292            AND A.REC_SEQ_NBR            =  C.REC_SEQ_NBR         12829225
128293            AND ((C.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     12829325
128294                 (C.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     12829425
128295                  EXISTS(SELECT 1 FROM TTRBRCN D                  12829525
128296                          WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE  12829625
128297                            AND D.RPT_PGM_NM   =  'TMKCS521')))   12829725
128298            AND C.FCLTY_ID               =  A.FCLTY_ID            12829825
128299            AND A.TRBL_RSN_CDE           =  B.TRBL_RSN_CDE        12829925
128300            AND C.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   12830025
128301                                       AND  :DK-OPER-UNT-ID-HIGH  12830125
128302            AND A.FCLTY_ID               =  1                     12830225
128303            AND A.DEPT_NBR               =  :DK-DEPT-LOW          12830325
128304            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        12830425
128305                                       AND  :DK-PO-NBR-HIGH       12830525
128306            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      12830625
128307                                       AND  :DK-TRBL-RSN-HIGH     12830725
128308            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      12830825
128309                                          , :DK-NOTIF-STAT-2      12830925
128310                                          , :DK-NOTIF-STAT-3      12831025
128311                                          , :DK-NOTIF-STAT-4)     12831125
128312            AND B.NOTIF_IND              =  'T'                   12831225
128313            AND C.STATUS_CDE            IN ('CM', 'IP')           12831325
128314            AND C.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      12831425
128315                                       AND  :DK-HIGH-REC-TMST     12831525
128316            AND C.ORD_NBR           =  P.PO_NBR                   12831625
128317            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           12831725
128318            AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND      12831825
128319                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR 12831925
128320                     (P.SEASET_YR      = :DK-SEASET-YR-2 AND      12832025
128321                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR 12832125
128322                     (P.SEASET_YR      = :DK-SEASET-YR-3 AND      12832225
128323                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR 12832325
128324                     (P.SEASET_YR      = :DK-SEASET-YR-4 AND      12832425
128325                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR 12832525
128326                     (P.SEASET_YR      = :DK-SEASET-YR-5 AND      12832625
128327                      P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR 12832725
128328                     (P.SEASET_YR       = :DK-SEASET-YR-6 AND     12832825
128329                      P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)   12832925
128330                    )                                             12833025
128331       ORDER BY 11                                                12833125
128332              , 20                                                12833225
128333              , 6                                                 12833325
128334              , 9                                                 12833425
128335              , 10                                                12833525
128336         WITH UR                                                  12833625
128337     END-EXEC.                                                    12833725
128338                                                                  12833800
128340*---------------------------------------------------------------* 12834000
128400*    BUYER CURSOR FOR A SPECIFIED BUYER                         * 12840000
128500*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 12850000
128600*    THE CURSOR.                                                * 12860000
128700*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 12870000
128800*---------------------------------------------------------------* 12880000
128900                                                                  12890000
129000     EXEC SQL                                                     12900000
129100          DECLARE BUYER-BY-TRBL CURSOR                            12910000
129200          FOR SELECT                                              12920000
129300                    A.NOTIF_NBR                                   12930000
129400                  , A.OPER_UNT_ID                                 12940000
129500                  , A.FCLTY_ID                                    12950000
129600                  , A.DEPT_NBR                                    12960000
129700                  , A.ENT_ID                                      12970000
129800                  , A.PO_NBR                                      12980000
129900                  , A.PO_LNE_NBR                                  12990000
130000                  , A.PREPK_ID                                    13000000
130100                  , A.REC_SEQ_NBR                                 13010000
130200                  , A.TRBL_RSN_CDE                                13020000
130300                  , A.NOTIF_TMST                                  13030000
130400                  , A.RESOLVED_IND                                13040000
130500                  , A.RESOLVED_TMST                               13050000
130600                  , A.ACKNOWLG_TMST                               13060000
130700                  , C.TRBL_SHT_DESC                               13070000
130800                  , C.RESP_RES_IND                                13080000
130900                  , C.TRBL_LVL_IND                                13090000
131000                  , C.RSLV_RSPNT_CDE                              13100000
131100                  , D.REC_TMST                                    13110000
131200                  , D.CRE_TMST                                    13120000
131300          FROM                                                    13130000
131400                TTRBNTF A                                         13140000
131500              , TMDSEAR B                                         13150000
131600              , TTRBRSN C                                         13160000
131700              , TRECEIV D                                         13170000
131800         WHERE                                                    13180000
131900                D.ORD_NBR                =  A.PO_NBR              13190000
132000            AND D.ML_POST_TMST  = '9999-09-09-09.09.09.999999'    13200000
132100            AND D.REC_SEQ_NBR            =  A.REC_SEQ_NBR         13210000
132200            AND ((D.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     13220000
132300                 (D.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     13230000
132400                  EXISTS(SELECT 1 FROM TTRBRCN E                  13240000
132500                          WHERE A.TRBL_RSN_CDE =  E.TRBL_RSN_CDE  13250000
132600                            AND E.RPT_PGM_NM   =  'TMKCS521')))   13260000
132700            AND D.OPER_UNT_ID            =  A.OPER_UNT_ID         13270000
132800            AND D.FCLTY_ID               =  A.FCLTY_ID            13280000
132900            AND A.TRBL_RSN_CDE           =  C.TRBL_RSN_CDE        13290000
133000            AND B.BYR_NBR                =  :DK-BUYER-NBR         13300000
133100            AND B.MDSELV_CDE             =  'DPT'                 13310000
133200            AND B.OPERCO_NBR             =  '03'                  13320000
133300            AND B.STRT_DTE              <=  CURRENT DATE          13330000
133400            AND B.END_DTE               >=  CURRENT DATE          13340000
133500            AND B.DEPT_NBR               =  A.DEPT_NBR            13350000
133600            AND D.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   13360000
133700                                       AND  :DK-OPER-UNT-ID-HIGH  13370000
133800            AND A.FCLTY_ID               =  1                     13380000
133900            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        13390000
134000                                       AND  :DK-PO-NBR-HIGH       13400000
134100            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      13410000
134200                                       AND  :DK-TRBL-RSN-HIGH     13420000
134300            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      13430000
134400                                          , :DK-NOTIF-STAT-2      13440000
134500                                          , :DK-NOTIF-STAT-3      13450000
134600                                          , :DK-NOTIF-STAT-4)     13460000
134700            AND C.NOTIF_IND              =  'T'                   13470000
134800            AND D.STATUS_CDE            IN ('CM', 'IP')           13480000
134900            AND D.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      13490000
135000                                       AND  :DK-HIGH-REC-TMST     13500000
135100       ORDER BY 11                                                13510000
135200              , 20                                                13520000
135300              , 6                                                 13530000
135400              , 9                                                 13540000
135500              , 10                                                13550000
135510         WITH UR                                                  13551025
135600     END-EXEC.                                                    13560000
135610                                                                  13561025
135620     EXEC SQL                                                     13562025
135630          DECLARE BUYER-BY-TRBL-INCL-SET CURSOR                   13563025
135640          FOR SELECT                                              13564025
135650                    A.NOTIF_NBR                                   13565025
135660                  , A.OPER_UNT_ID                                 13566025
135670                  , A.FCLTY_ID                                    13567025
135680                  , A.DEPT_NBR                                    13568025
135690                  , A.ENT_ID                                      13569025
135691                  , A.PO_NBR                                      13569125
135692                  , A.PO_LNE_NBR                                  13569225
135693                  , A.PREPK_ID                                    13569325
135694                  , A.REC_SEQ_NBR                                 13569425
135695                  , A.TRBL_RSN_CDE                                13569525
135696                  , A.NOTIF_TMST                                  13569625
135697                  , A.RESOLVED_IND                                13569725
135698                  , A.RESOLVED_TMST                               13569825
135699                  , A.ACKNOWLG_TMST                               13569925
135700                  , C.TRBL_SHT_DESC                               13570025
135701                  , C.RESP_RES_IND                                13570125
135702                  , C.TRBL_LVL_IND                                13570225
135703                  , C.RSLV_RSPNT_CDE                              13570325
135704                  , D.REC_TMST                                    13570425
135705                  , D.CRE_TMST                                    13570525
135706          FROM                                                    13570625
135707                TTRBNTF A                                         13570725
135708              , TMDSEAR B                                         13570825
135709              , TTRBRSN C                                         13570925
135710              , TRECEIV D                                         13571025
135711              , TPURCHS P                                         13571125
135712         WHERE                                                    13571225
135713                D.ORD_NBR                =  A.PO_NBR              13571325
135714            AND D.ML_POST_TMST  = '9999-09-09-09.09.09.999999'    13571425
135715            AND D.REC_SEQ_NBR            =  A.REC_SEQ_NBR         13571525
135716            AND ((D.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     13571625
135717                 (D.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     13571725
135718                  EXISTS(SELECT 1 FROM TTRBRCN E                  13571825
135719                          WHERE A.TRBL_RSN_CDE =  E.TRBL_RSN_CDE  13571925
135720                            AND E.RPT_PGM_NM   =  'TMKCS521')))   13572025
135721            AND D.OPER_UNT_ID            =  A.OPER_UNT_ID         13572125
135722            AND D.FCLTY_ID               =  A.FCLTY_ID            13572225
135723            AND A.TRBL_RSN_CDE           =  C.TRBL_RSN_CDE        13572325
135724            AND B.BYR_NBR                =  :DK-BUYER-NBR         13572425
135725            AND B.MDSELV_CDE             =  'DPT'                 13572525
135726            AND B.OPERCO_NBR             =  '03'                  13572625
135727            AND B.STRT_DTE              <=  CURRENT DATE          13572725
135728            AND B.END_DTE               >=  CURRENT DATE          13572825
135729            AND B.DEPT_NBR               =  A.DEPT_NBR            13572925
135730            AND D.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   13573025
135731                                       AND  :DK-OPER-UNT-ID-HIGH  13573125
135732            AND A.FCLTY_ID               =  1                     13573225
135733            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        13573325
135734                                       AND  :DK-PO-NBR-HIGH       13573425
135735            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      13573525
135736                                       AND  :DK-TRBL-RSN-HIGH     13573625
135737            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      13573725
135738                                          , :DK-NOTIF-STAT-2      13573825
135739                                          , :DK-NOTIF-STAT-3      13573925
135740                                          , :DK-NOTIF-STAT-4)     13574025
135741            AND C.NOTIF_IND              =  'T'                   13574125
135742            AND D.STATUS_CDE            IN ('CM', 'IP')           13574225
135743            AND D.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      13574325
135744                                       AND  :DK-HIGH-REC-TMST     13574425
135745            AND D.ORD_NBR           =  P.PO_NBR                   13574525
135746            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           13574625
135747            AND ((P.SEASET_YR      = :DK-SEASET-YR-1 AND          13574725
135748                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR     13574825
135749                 (P.SEASET_YR      = :DK-SEASET-YR-2 AND          13574925
135750                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR     13575025
135751                 (P.SEASET_YR      = :DK-SEASET-YR-3 AND          13575125
135752                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR     13575225
135753                 (P.SEASET_YR      = :DK-SEASET-YR-4 AND          13575325
135754                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR     13575425
135755                 (P.SEASET_YR      = :DK-SEASET-YR-5 AND          13575525
135756                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR     13575625
135757                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         13575725
135758                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       13575825
135759                )                                                 13575925
135760       ORDER BY 11                                                13576025
135761              , 20                                                13576125
135762              , 6                                                 13576225
135763              , 9                                                 13576325
135764              , 10                                                13576425
135765         WITH UR                                                  13576525
135766     END-EXEC.                                                    13576625
135767                                                                  13576725
135768     EXEC SQL                                                     13576825
135769          DECLARE BUYER-BY-TRBL-EXCL-SET CURSOR                   13576925
135770          FOR SELECT                                              13577025
135771                    A.NOTIF_NBR                                   13577125
135772                  , A.OPER_UNT_ID                                 13577225
135773                  , A.FCLTY_ID                                    13577325
135774                  , A.DEPT_NBR                                    13577425
135775                  , A.ENT_ID                                      13577525
135776                  , A.PO_NBR                                      13577625
135777                  , A.PO_LNE_NBR                                  13577725
135778                  , A.PREPK_ID                                    13577825
135779                  , A.REC_SEQ_NBR                                 13577925
135780                  , A.TRBL_RSN_CDE                                13578025
135781                  , A.NOTIF_TMST                                  13578125
135782                  , A.RESOLVED_IND                                13578225
135783                  , A.RESOLVED_TMST                               13578325
135784                  , A.ACKNOWLG_TMST                               13578425
135785                  , C.TRBL_SHT_DESC                               13578525
135786                  , C.RESP_RES_IND                                13578625
135787                  , C.TRBL_LVL_IND                                13578725
135788                  , C.RSLV_RSPNT_CDE                              13578825
135789                  , D.REC_TMST                                    13578925
135790                  , D.CRE_TMST                                    13579025
135791          FROM                                                    13579125
135792                TTRBNTF A                                         13579225
135793              , TMDSEAR B                                         13579325
135794              , TTRBRSN C                                         13579425
135795              , TRECEIV D                                         13579525
135796              , TPURCHS P                                         13579625
135797         WHERE                                                    13579725
135798                D.ORD_NBR                =  A.PO_NBR              13579825
135799            AND D.ML_POST_TMST  = '9999-09-09-09.09.09.999999'    13579925
135800            AND D.REC_SEQ_NBR            =  A.REC_SEQ_NBR         13580025
135801            AND ((D.OPER_UNT_ID          =  A.OPER_UNT_ID) OR     13580125
135802                 (D.OPER_UNT_ID         <>  A.OPER_UNT_ID AND     13580225
135803                  EXISTS(SELECT 1 FROM TTRBRCN E                  13580325
135804                          WHERE A.TRBL_RSN_CDE =  E.TRBL_RSN_CDE  13580425
135805                            AND E.RPT_PGM_NM   =  'TMKCS521')))   13580525
135806            AND D.OPER_UNT_ID            =  A.OPER_UNT_ID         13580625
135807            AND D.FCLTY_ID               =  A.FCLTY_ID            13580725
135808            AND A.TRBL_RSN_CDE           =  C.TRBL_RSN_CDE        13580825
135809            AND B.BYR_NBR                =  :DK-BUYER-NBR         13580925
135810            AND B.MDSELV_CDE             =  'DPT'                 13581025
135811            AND B.OPERCO_NBR             =  '03'                  13581125
135812            AND B.STRT_DTE              <=  CURRENT DATE          13581225
135813            AND B.END_DTE               >=  CURRENT DATE          13581325
135814            AND B.DEPT_NBR               =  A.DEPT_NBR            13581425
135815            AND D.CURR_OPER_UNT_ID BETWEEN  :DK-OPER-UNT-ID-LOW   13581525
135816                                       AND  :DK-OPER-UNT-ID-HIGH  13581625
135817            AND A.FCLTY_ID               =  1                     13581725
135818            AND A.PO_NBR           BETWEEN  :DK-PO-NBR-LOW        13581825
135819                                       AND  :DK-PO-NBR-HIGH       13581925
135820            AND A.TRBL_RSN_CDE     BETWEEN  :DK-TRBL-RSN-LOW      13582025
135821                                       AND  :DK-TRBL-RSN-HIGH     13582125
135822            AND A.RESOLVED_IND          IN (:DK-NOTIF-STAT-1      13582225
135823                                          , :DK-NOTIF-STAT-2      13582325
135824                                          , :DK-NOTIF-STAT-3      13582425
135825                                          , :DK-NOTIF-STAT-4)     13582525
135826            AND C.NOTIF_IND              =  'T'                   13582625
135827            AND D.STATUS_CDE            IN ('CM', 'IP')           13582725
135828            AND D.REC_TMST         BETWEEN  :DK-LOW-REC-TMST      13582825
135829                                       AND  :DK-HIGH-REC-TMST     13582925
135830            AND D.ORD_NBR           =  P.PO_NBR                   13583025
135831            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           13583125
135832            AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND      13583225
135833                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR     13583325
135834                 (P.SEASET_YR      = :DK-SEASET-YR-2 AND          13583425
135835                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR     13583525
135836                 (P.SEASET_YR      = :DK-SEASET-YR-3 AND          13583625
135837                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR     13583725
135838                 (P.SEASET_YR      = :DK-SEASET-YR-4 AND          13583825
135839                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR     13583925
135840                 (P.SEASET_YR      = :DK-SEASET-YR-5 AND          13584025
135841                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR     13584125
135842                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         13584225
135843                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       13584325
135844                )                                                 13584425
135845       ORDER BY 11                                                13584525
135846              , 20                                                13584625
135847              , 6                                                 13584725
135848              , 9                                                 13584825
135849              , 10                                                13584925
135850         WITH UR                                                  13585025
135851     END-EXEC.                                                    13585125
135852                                                                  13585200
135860*---------------------------------------------------------------* 13586000
135900*    PO / RCVR CURSOR FOR A SPECIFIED PO OR PO/RECEIVER         * 13590000
136000*    ALL FILTERS ARE APPLIED HERE TO MINIMIZE THE SIZE OF       * 13600000
136100*    THE CURSOR.                                                * 13610000
136200*    THE RESULTS OF THIS CURSOR WILL BE IN OLDEST TO NEWEST TRBL* 13620000
136300*---------------------------------------------------------------* 13630000
136400                                                                  13640000
136500     EXEC SQL                                                     13650000
136600          DECLARE PORCVR-BY-TRBL CURSOR                           13660000
136700          FOR SELECT                                              13670000
136800                    A.NOTIF_NBR                                   13680000
136900                  , A.OPER_UNT_ID                                 13690000
137000                  , A.FCLTY_ID                                    13700000
137100                  , A.DEPT_NBR                                    13710000
137200                  , A.ENT_ID                                      13720000
137300                  , A.PO_NBR                                      13730000
137400                  , A.PO_LNE_NBR                                  13740000
137500                  , A.PREPK_ID                                    13750000
137600                  , A.REC_SEQ_NBR                                 13760000
137700                  , A.TRBL_RSN_CDE                                13770000
137800                  , A.NOTIF_TMST                                  13780000
137900                  , A.RESOLVED_IND                                13790000
138000                  , A.RESOLVED_TMST                               13800000
138100                  , A.ACKNOWLG_TMST                               13810000
138200                  , B.TRBL_SHT_DESC                               13820000
138300                  , B.RESP_RES_IND                                13830000
138400                  , B.TRBL_LVL_IND                                13840000
138500                  , B.RSLV_RSPNT_CDE                              13850000
138600                  , C.REC_TMST                                    13860000
138700                  , C.CRE_TMST                                    13870000
138800          FROM                                                    13880000
138900                TTRBNTF A                                         13890000
139000              , TTRBRSN B                                         13900000
139100              , TRECEIV C                                         13910000
139200         WHERE                                                    13920000
139300                 C.ORD_NBR                 =  A.PO_NBR            13930000
139400             AND C.REC_SEQ_NBR             =  A.REC_SEQ_NBR       13940000
139500             AND ((C.OPER_UNT_ID           =  A.OPER_UNT_ID) OR   13950000
139600                  (C.OPER_UNT_ID          <>  A.OPER_UNT_ID AND   13960000
139700                   EXISTS(SELECT 1 FROM TTRBRCN D                 13970000
139800                           WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE 13980000
139900                             AND D.RPT_PGM_NM   =  'TMKCS521')))  13990000
140000             AND C.FCLTY_ID                =  A.FCLTY_ID          14000000
140100             AND A.TRBL_RSN_CDE            =  B.TRBL_RSN_CDE      14010000
140200             AND C.CURR_OPER_UNT_ID  BETWEEN  :DK-OPER-UNT-ID-LOW 14020000
140300                                         AND  :DK-OPER-UNT-ID-HIGH14030000
140400             AND A.FCLTY_ID                =  1                   14040000
140500             AND A.PO_NBR                  =  :DK-PO-NBR          14050000
140600             AND A.REC_SEQ_NBR       BETWEEN  :DK-REC-SEQ-NBR-LOW 14060000
140700                                         AND  :DK-REC-SEQ-NBR-HIGH14070000
140800             AND A.TRBL_RSN_CDE      BETWEEN  :DK-TRBL-RSN-LOW    14080000
140900                                         AND  :DK-TRBL-RSN-HIGH   14090000
141000             AND A.RESOLVED_IND           IN (:DK-NOTIF-STAT-1    14100000
141100                                            , :DK-NOTIF-STAT-2    14110000
141200                                            , :DK-NOTIF-STAT-3    14120000
141300                                            , :DK-NOTIF-STAT-4)   14130000
141400             AND C.REC_TMST          BETWEEN  :DK-LOW-REC-TMST    14140000
141500                                         AND  :DK-HIGH-REC-TMST   14150000
141600       ORDER BY 11                                                14160000
141700              , 20                                                14170000
141800              , 6                                                 14180000
141900              , 9                                                 14190000
142000              , 10                                                14200000
142100     END-EXEC.                                                    14210000
142200                                                                  14220000
142220     EXEC SQL                                                     14222025
142230          DECLARE PORCVR-BY-TRBL-INCL-SET CURSOR                  14223025
142240          FOR SELECT                                              14224025
142250                    A.NOTIF_NBR                                   14225025
142260                  , A.OPER_UNT_ID                                 14226025
142270                  , A.FCLTY_ID                                    14227025
142280                  , A.DEPT_NBR                                    14228025
142290                  , A.ENT_ID                                      14229025
142291                  , A.PO_NBR                                      14229125
142292                  , A.PO_LNE_NBR                                  14229225
142293                  , A.PREPK_ID                                    14229325
142294                  , A.REC_SEQ_NBR                                 14229425
142295                  , A.TRBL_RSN_CDE                                14229525
142296                  , A.NOTIF_TMST                                  14229625
142297                  , A.RESOLVED_IND                                14229725
142298                  , A.RESOLVED_TMST                               14229825
142299                  , A.ACKNOWLG_TMST                               14229925
142300                  , B.TRBL_SHT_DESC                               14230025
142301                  , B.RESP_RES_IND                                14230125
142302                  , B.TRBL_LVL_IND                                14230225
142303                  , B.RSLV_RSPNT_CDE                              14230325
142304                  , C.REC_TMST                                    14230425
142305                  , C.CRE_TMST                                    14230525
142306          FROM                                                    14230625
142307                TTRBNTF A                                         14230725
142308              , TTRBRSN B                                         14230825
142309              , TRECEIV C                                         14230925
142310              , TPURCHS P                                         14231026
142311         WHERE                                                    14231125
142312                 C.ORD_NBR                 =  A.PO_NBR            14231225
142313             AND C.REC_SEQ_NBR             =  A.REC_SEQ_NBR       14231325
142314             AND ((C.OPER_UNT_ID           =  A.OPER_UNT_ID) OR   14231425
142315                  (C.OPER_UNT_ID          <>  A.OPER_UNT_ID AND   14231525
142316                   EXISTS(SELECT 1 FROM TTRBRCN D                 14231625
142317                           WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE 14231725
142318                             AND D.RPT_PGM_NM   =  'TMKCS521')))  14231825
142319             AND C.FCLTY_ID                =  A.FCLTY_ID          14231925
142320             AND A.TRBL_RSN_CDE            =  B.TRBL_RSN_CDE      14232025
142321             AND C.CURR_OPER_UNT_ID  BETWEEN  :DK-OPER-UNT-ID-LOW 14232125
142322                                         AND  :DK-OPER-UNT-ID-HIGH14232225
142323             AND A.FCLTY_ID                =  1                   14232325
142324             AND A.PO_NBR                  =  :DK-PO-NBR          14232425
142325             AND A.REC_SEQ_NBR       BETWEEN  :DK-REC-SEQ-NBR-LOW 14232525
142326                                         AND  :DK-REC-SEQ-NBR-HIGH14232625
142327             AND A.TRBL_RSN_CDE      BETWEEN  :DK-TRBL-RSN-LOW    14232725
142328                                         AND  :DK-TRBL-RSN-HIGH   14232825
142329             AND A.RESOLVED_IND           IN (:DK-NOTIF-STAT-1    14232925
142330                                            , :DK-NOTIF-STAT-2    14233025
142331                                            , :DK-NOTIF-STAT-3    14233125
142332                                            , :DK-NOTIF-STAT-4)   14233225
142333             AND C.REC_TMST          BETWEEN  :DK-LOW-REC-TMST    14233325
142334                                         AND  :DK-HIGH-REC-TMST   14233425
142335            AND C.ORD_NBR           =  P.PO_NBR                   14233525
142336            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           14233625
142337            AND ((P.SEASET_YR      = :DK-SEASET-YR-1 AND          14233725
142338                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR     14233825
142339                 (P.SEASET_YR      = :DK-SEASET-YR-2 AND          14233925
142340                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR     14234025
142341                 (P.SEASET_YR      = :DK-SEASET-YR-3 AND          14234125
142342                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR     14234225
142343                 (P.SEASET_YR      = :DK-SEASET-YR-4 AND          14234325
142344                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR     14234425
142345                 (P.SEASET_YR      = :DK-SEASET-YR-5 AND          14234525
142346                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR     14234625
142347                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         14234725
142348                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       14234825
142349                )                                                 14234925
142350       ORDER BY 11                                                14235025
142351              , 20                                                14235125
142352              , 6                                                 14235225
142353              , 9                                                 14235325
142354              , 10                                                14235425
142355         WITH UR                                                  14235525
142356     END-EXEC.                                                    14235625
142357                                                                  14235725
142358     EXEC SQL                                                     14235825
142359          DECLARE PORCVR-BY-TRBL-EXCL-SET CURSOR                  14235925
142360          FOR SELECT                                              14236025
142361                    A.NOTIF_NBR                                   14236125
142362                  , A.OPER_UNT_ID                                 14236225
142363                  , A.FCLTY_ID                                    14236325
142364                  , A.DEPT_NBR                                    14236425
142365                  , A.ENT_ID                                      14236525
142366                  , A.PO_NBR                                      14236625
142367                  , A.PO_LNE_NBR                                  14236725
142368                  , A.PREPK_ID                                    14236825
142369                  , A.REC_SEQ_NBR                                 14236925
142370                  , A.TRBL_RSN_CDE                                14237025
142371                  , A.NOTIF_TMST                                  14237125
142372                  , A.RESOLVED_IND                                14237225
142373                  , A.RESOLVED_TMST                               14237325
142374                  , A.ACKNOWLG_TMST                               14237425
142375                  , B.TRBL_SHT_DESC                               14237525
142376                  , B.RESP_RES_IND                                14237625
142377                  , B.TRBL_LVL_IND                                14237725
142378                  , B.RSLV_RSPNT_CDE                              14237825
142379                  , C.REC_TMST                                    14237925
142380                  , C.CRE_TMST                                    14238025
142381          FROM                                                    14238125
142382                TTRBNTF A                                         14238225
142383              , TTRBRSN B                                         14238325
142384              , TRECEIV C                                         14238425
142385              , TPURCHS P                                         14238526
142386         WHERE                                                    14238625
142387                 C.ORD_NBR                 =  A.PO_NBR            14238725
142388             AND C.REC_SEQ_NBR             =  A.REC_SEQ_NBR       14238825
142389             AND ((C.OPER_UNT_ID           =  A.OPER_UNT_ID) OR   14238925
142390                  (C.OPER_UNT_ID          <>  A.OPER_UNT_ID AND   14239025
142391                   EXISTS(SELECT 1 FROM TTRBRCN D                 14239125
142392                           WHERE A.TRBL_RSN_CDE =  D.TRBL_RSN_CDE 14239225
142393                             AND D.RPT_PGM_NM   =  'TMKCS521')))  14239325
142394             AND C.FCLTY_ID                =  A.FCLTY_ID          14239425
142395             AND A.TRBL_RSN_CDE            =  B.TRBL_RSN_CDE      14239525
142396             AND C.CURR_OPER_UNT_ID  BETWEEN  :DK-OPER-UNT-ID-LOW 14239625
142397                                         AND  :DK-OPER-UNT-ID-HIGH14239725
142398             AND A.FCLTY_ID                =  1                   14239825
142399             AND A.PO_NBR                  =  :DK-PO-NBR          14239925
142400             AND A.REC_SEQ_NBR       BETWEEN  :DK-REC-SEQ-NBR-LOW 14240025
142401                                         AND  :DK-REC-SEQ-NBR-HIGH14240125
142402             AND A.TRBL_RSN_CDE      BETWEEN  :DK-TRBL-RSN-LOW    14240225
142403                                         AND  :DK-TRBL-RSN-HIGH   14240325
142404             AND A.RESOLVED_IND           IN (:DK-NOTIF-STAT-1    14240425
142405                                            , :DK-NOTIF-STAT-2    14240525
142406                                            , :DK-NOTIF-STAT-3    14240625
142407                                            , :DK-NOTIF-STAT-4)   14240725
142408             AND C.REC_TMST          BETWEEN  :DK-LOW-REC-TMST    14240825
142409                                         AND  :DK-HIGH-REC-TMST   14240925
142410            AND C.ORD_NBR           =  P.PO_NBR                   14241025
142411            AND P.VER_STATUS_CDE    = :PC-ACTIVE-STATUS           14241125
142412            AND NOT ((P.SEASET_YR      = :DK-SEASET-YR-1 AND      14241225
142413                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-1) OR     14241325
142414                 (P.SEASET_YR      = :DK-SEASET-YR-2 AND          14241425
142415                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-2) OR     14241525
142416                 (P.SEASET_YR      = :DK-SEASET-YR-3 AND          14241625
142417                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-3) OR     14241725
142418                 (P.SEASET_YR      = :DK-SEASET-YR-4 AND          14241825
142419                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-4) OR     14241925
142420                 (P.SEASET_YR      = :DK-SEASET-YR-5 AND          14242025
142421                  P.SEASET_SHRT_NM = :DK-SEASET-SHRT-NM-5) OR     14242125
142422                 (P.SEASET_YR       = :DK-SEASET-YR-6 AND         14242225
142423                  P.SEASET_SHRT_NM  = :DK-SEASET-SHRT-NM-6)       14242325
142424                )                                                 14242425
142425       ORDER BY 11                                                14242525
142426              , 20                                                14242625
142427              , 6                                                 14242725
142428              , 9                                                 14242825
142429              , 10                                                14242925
142430         WITH UR                                                  14243025
142431     END-EXEC.                                                    14243125
142432                                                                  14243225
142433***************************************************************** 14243300
142440**  THE FOLLOWING CURSOR IS USED TO GET THE ANALYST NAME          14244000
142500***************************************************************** 14250000
142600     EXEC SQL                                                     14260000
142700         DECLARE ANALYST-CSR  CURSOR                              14270000
142800         FOR SELECT                                               14280000
142900                  B.WORKER_STRT_DTE                               14290000
143000                 ,B.WORKER_FIR_NAME                               14300000
143100                 ,B.WORKER_LAST_NAME                              14310000
143200            FROM TMDSEAR A                                        14320000
143300                ,TRSPBAR B                                        14330000
143400             WHERE B.MDSEAR_DKEY     = A.MDSEAR_DKEY              14340000
143500               AND A.OPERCO_NBR      = '03'                       14350000
143600               AND A.MDSELV_CDE      = 'DPT'                      14360000
143700               AND A.DEPT_NBR        = :DK-DEPT-NBR               14370000
143800               AND A.STRT_DTE       <= CURRENT DATE               14380000
143900               AND A.END_DTE        >= CURRENT DATE               14390000
144000               AND B.RSPLVL_CDE      = 'ANL'                      14400000
144100               AND B.WORKER_STRT_DTE <= CURRENT DATE              14410000
144200               AND B.WORKER_END_DTE  >  CURRENT DATE              14420000
144300            ORDER BY WORKER_STRT_DTE DESC                         14430000
144400     END-EXEC.                                                    14440000
144500                                                                  14450000
144600                                                                  14460000
144700                                                                  14470000
144800 LINKAGE SECTION.                                                 14480000
144900                                                                  14490000
145000 01  DFHCOMMAREA.                                                 14500000
145100     05  FILLER                         OCCURS  1 TO 4072 TIMES   14510000
145200                                        DEPENDING ON EIBCALEN.    14520000
145300         10  FILLER                     PIC X.                    14530000
145400                                                                  14540000
145500                                                                  14550000
145600 PROCEDURE DIVISION.                                              14560000
145700******************************************************************14570000
145800**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **14580000
145900**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **14590000
146000**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **14600000
146100******************************************************************14610000
146200 0000-MAIN-MODULE.                                                14620000
146300     INITIALIZE DP030-CICS-API-FIELDS.                            14630000
146400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       14640000
146500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          14650000
146600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         14660000
146700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       14670000
146800     MOVE LENGTH OF TM532AI        TO DP030-MAP-LENGTH (1).       14680000
146900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     14690000
147000     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       14700000
147100*                                                                 14710000
147200     PERFORM 0001-CALL-CICS-ARCH-API.                             14720000
147300     PERFORM 1000-CONTROL-PROCESSING                              14730000
147400*                                                                 14740000
147500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     14750000
147600     PERFORM 0001-CALL-CICS-ARCH-API.                             14760000
147700                                                                  14770000
147800******************************************************************14780000
147900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **14790000
148000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **14800000
148100******************************************************************14810000
148200 0001-CALL-CICS-ARCH-API.                                         14820000
148300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      14830018
148400                                    DFHCOMMAREA                   14840018
148500                                    DP030-CICS-API-FIELDS         14850018
148600                                    DP020-STANDARD-COMMAREA       14860018
148700                                    TM532AI.                      14870018
148800*                                                                 14880000
148900     IF DP030-RC-CALL-SUCCESSFUL OR DP030-RC-APPL-ERROR           14890000
149000         CONTINUE                                                 14900000
149100     ELSE                                                         14910000
149200         SET DP013-NO-ROLLBACK                                    14920000
149300             DP013-XCTL-DISPLAY-RESTART                           14930000
149400             DP013-CICS-ABEND      TO TRUE                        14940000
149500         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        14950000
149510         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O14951018
149520-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      14952018
149800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      14980000
149900         PERFORM DP013-0000-PROCESS-ABEND                         14990000
150000     END-IF.                                                      15000000
150100                                                                  15010000
150200*----------------------------------------------------------------*15020000
150300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *15030000
150400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *15040000
150500*                                                                *15050000
150600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *15060000
150700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *15070000
150800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *15080000
150900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *15090000
151000*----------------------------------------------------------------*15100000
151100 1000-CONTROL-PROCESSING.                                         15110000
151200     EVALUATE TRUE                                                15120000
151300         WHEN DP030-RC-APPL-ERROR                                 15130000
151400             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         15140000
151500             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                15150000
151600             IF (ASC-RETURNING-FROM-PO OR                         15160000
151700                 ASC-RETURNING-FROM-RCPCKLST)                     15170000
151800                 PERFORM 2140-DESELECT-ALL-ITEMS                  15180000
151900                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             15190000
152000             ELSE                                                 15200000
152100                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             15210000
152200             END-IF                                               15220000
152300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   15230000
152400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15240000
152500                                                                  15250000
152600         WHEN DP020-NEXT-ACT-INITIAL                              15260000
152700             INITIALIZE ASC-SPECIFIC-COMMAREA                     15270000
152800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            15280000
152900                                      ASC-SEL-TERM-ID             15290000
153000             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   15300000
153100                                           ASC-SEL-TASK-NUMBER    15310000
153200             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               15320000
153300             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 15330000
153400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 15340000
153500                                                                  15350000
153600             IF  PS-COMMAREA-NOT-VALID                            15360000
153700                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            15370000
153800             ELSE                                                 15380000
153900                 PERFORM 4000-BUILD-INITIAL-PANEL                 15390000
154000             END-IF                                               15400000
154100                                                                  15410000
154200         WHEN DP020-NEXT-ACT-READ-MAP                             15420000
154300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         15430000
154400             PERFORM 2000-PROCESS-PANEL                           15440000
154500                                                                  15450000
154600         WHEN DP020-NEXT-ACT-RETURN                               15460000
154700             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         15470000
154800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    15480000
154900             IF  ASC-RETURNING-FROM-PO                            15490000
155000                 PERFORM 2140-DESELECT-ALL-ITEMS                  15500000
155100             ELSE                                                 15510000
155200                 PERFORM 6000-REFRESH-PANEL-FROM-TEMP             15520000
155300             END-IF                                               15530000
155400             IF PS-NO-ERROR                                       15540000
155500                PERFORM 7000-FORMAT-COMMAREA-PCK                  15550000
155600             END-IF                                               15560000
155700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   15570000
155800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15580000
155900                                                                  15590000
156000         WHEN OTHER                                               15600000
156100             SET DP013-LOGIC-ABEND TO TRUE                        15610000
156200             SET DP013-NO-ROLLBACK TO TRUE                        15620000
156300             MOVE '1000-CONTROL-PROCESSING'                       15630000
156400                                   TO DP013-PARAGRAPH             15640000
156500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    15650000
156600                                   TO DP013-MESSAGE-TEXT(1)       15660000
156700             PERFORM DP013-0000-PROCESS-ABEND                     15670000
156800     END-EVALUATE.                                                15680000
156900                                                                  15690000
157000*----------------------------------------------------------------*15700000
157100* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *15710000
157200* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *15720000
157300*----------------------------------------------------------------*15730000
157400 1100-PROCESS-INTER-APPL-COMM.                                    15740000
157500     SET PS-COMMAREA-VALID         TO TRUE.                       15750000
157600     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     15760000
157700                                                                  15770000
157800     MOVE DP020-INT-APPL-FORMAT-IND TO PC-ENTERED-USING-IND.      15780000
157900     EVALUATE TRUE                                                15790000
158000**** COMING FROM THE CRIT SPEC SCREEN  *************************  15800000
158100         WHEN PC-CRIT-SPEC-FORMAT                                 15810000
158200             IF  TM005-TRBL-REASON > SPACES                       15820000
158300                 IF  TM005-TRBL-REASON = PC-ALL                   15830000
158400                     MOVE ZEROS       TO ASC-TRBL-REASON-LOW      15840000
158500                     MOVE +999        TO ASC-TRBL-REASON-HIGH     15850000
158600                 ELSE                                             15860000
158700                     MOVE TM005-TRBL-REASON                       15870000
158800                                  TO PV-TRBL-REASON-LOW           15880000
158900                                     PV-TRBL-REASON-HIGH          15890000
159000                     INSPECT PV-TRBL-REASON-LOW                   15900000
159100                         REPLACING ALL '*' BY ZEROS               15910000
159200                     INSPECT PV-TRBL-REASON-HIGH                  15920000
159300                         REPLACING ALL '*' BY PC-NINE             15930000
159400                     IF (PV-TRBL-REASON-LOW NUMERIC)  AND         15940000
159500                        (PV-TRBL-REASON-HIGH NUMERIC)             15950000
159600                         MOVE PV-TRBL-REASON-LOW                  15960000
159700                                  TO ASC-TRBL-REASON-LOW          15970000
159800                         MOVE PV-TRBL-REASON-HIGH                 15980000
159900                                  TO ASC-TRBL-REASON-HIGH         15990000
160000                     ELSE                                         16000000
160100                         MOVE PC-TSYMSG-01030                     16010000
160200                                  TO DP020-MSG-NUMBER             16020000
160300                         SET PS-ERROR                             16030000
160400                             PS-COMMAREA-NOT-VALID                16040000
160500                             DP020-MSG-FATAL TO TRUE              16050000
160600                     END-IF                                       16060000
160700                 END-IF                                           16070000
160800             ELSE                                                 16080000
160900                 MOVE ZEROS       TO ASC-TRBL-REASON-LOW          16090000
161000                                     ASC-TRBL-REASON-HIGH         16100000
161100             END-IF                                               16110000
161200                                                                  16120000
161300             IF  PS-NO-ERROR                                      16130000
161400                 MOVE TM005-OPER-UNT-ID TO ASC-KEY-OPER-UNT-ID    16140000
161500                                           ASC-SAVE-OPER-UNT-ID   16150000
161600                 MOVE TM005-FCLTY-ID    TO ASC-KEY-FCLTY-ID       16160000
161700                 MOVE TM005-DEPT           TO ASC-KEY-DEPT        16170000
161800                 MOVE TM005-BUYER          TO ASC-KEY-BUYER       16180000
161900                 MOVE TM005-PO-NBR-N       TO ASC-KEY-PO-NBR      16190000
162000                 MOVE TM005-RCVR-SEQ-NBR-N TO ASC-KEY-REC-SEQ-NBR 16200000
162100                 MOVE TM005-LIST-SEQ-SW    TO ASC-LIST-SEQ-SW     16210000
162200                 MOVE TM005-RESPONSIBILITY-AREA-SW                16220000
162300                                    TO ASC-RESPONSIBILITY-AREA-SW 16230000
162400                 MOVE TM005-RA-BUYER       TO ASC-RA-BUYER        16240000
162500                 MOVE TM005-RA-ANALYST     TO ASC-RA-ANALYST      16250000
162600                 MOVE TM005-RA-DC          TO ASC-RA-DC           16260000
162700                 MOVE TM005-NOTIF-STATUS   TO ASC-NOTIF-STAT      16270000
162800                 MOVE TM005-RCVR-STATUS-SW TO ASC-RCVR-STATUS-SW  16280000
162810                                                                  16281022
162811                 MOVE TM005-INCLD-SET     TO  ASC-INCLD-SET       16281122
162812                 MOVE TM005-EXCLD-SET     TO  ASC-EXCLD-SET       16281222
162813                 MOVE TM005-SET-CODE-1    TO  ASC-SET-CODE-1      16281322
162815                 MOVE TM005-SET-YEAR-1    TO  ASC-SET-YEAR-1      16281547
162817                 MOVE TM005-SET-CODE-2    TO  ASC-SET-CODE-2      16281745
162819                 MOVE TM005-SET-YEAR-2    TO  ASC-SET-YEAR-2      16281945
162821                 MOVE TM005-SET-CODE-3    TO  ASC-SET-CODE-3      16282145
162822                 MOVE TM005-SET-YEAR-3    TO  ASC-SET-YEAR-3      16282245
162824                 MOVE TM005-SET-CODE-4    TO  ASC-SET-CODE-4      16282445
162825                 MOVE TM005-SET-YEAR-4    TO  ASC-SET-YEAR-4      16282545
162827                 MOVE TM005-SET-CODE-5    TO  ASC-SET-CODE-5      16282745
162828                 MOVE TM005-SET-YEAR-5    TO  ASC-SET-YEAR-5      16282845
162830                 MOVE TM005-SET-CODE-6    TO  ASC-SET-CODE-6      16283045
162831                 MOVE TM005-SET-YEAR-6    TO  ASC-SET-YEAR-6      16283145
162850                                                                  16285046
162900             END-IF                                               16290000
163000         WHEN PC-ENTERED-USING-PO-PO013                           16300000
163100**** USED WHEN GOING TO PO INQUIRY ************************       16310000
163200************* SCREEN FROM THIS LIST SCREEN  ***************       16320000
163300             MOVE PO013-PO-NBR      TO ASC-KEY-PO-NBR             16330000
163400         WHEN PC-ENTERED-USING-PO-PO017                           16340000
163500**** USED WHEN COMING FROM THE PO INQUIRY  SCREEN  ********       16350000
163600             MOVE PO017-PO-NBR      TO ASC-KEY-PO-NBR             16360000
163700             MOVE PO017-DEPT-NBR    TO ASC-KEY-DEPT               16370000
163800             MOVE +1                TO ASC-KEY-FCLTY-ID           16380000
163900             MOVE PC-BUY-ANALYST-DC-SW                            16390000
164000                                    TO ASC-RESPONSIBILITY-AREA-SW 16400000
164100             MOVE PC-BUYER          TO ASC-RA-BUYER               16410000
164200             MOVE PC-ANALYST        TO ASC-RA-ANALYST             16420000
164300             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                16430000
164400             SET ASC-ALL-NOTIF-STATS                              16440000
164500                 ASC-RCVR-STAT-ARR-ENR                            16450000
164600                 ASC-LS-ARRIVAL     TO TRUE                       16460000
164700             MOVE +999              TO ASC-TRBL-REASON-HIGH       16470000
164800             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        16480000
164900                                       ASC-SAVE-OPER-UNT-ID       16490000
165000         WHEN PC-ENTERED-USING-PO-RC012                           16500000
165100**** USED WHEN COMING FROM THE PACK SLIP HEADER ADD, ******       16510000
165200**** RCVG RECEIVER ADD, RCVG PO/RECEIVER INQUIRY,    ******       16520000
165300**** RCVG RECEIVER CRIT SPEC, RC-PACK SLIP CRIT SPEC,******       16530000
165400**** RCVG RECEIVER UPDATE, PC-P2L/CASEPACK SPLIT CRIT,*****       16540000
165500**** PC-P2L/CASEPACK CREATE LABEL, RECEIVER MAINT    ******       16550000
165600             MOVE RC012-PO-NBR      TO ASC-KEY-PO-NBR             16560000
165700             MOVE RC012-REC-SEQ-NBR TO ASC-KEY-REC-SEQ-NBR        16570000
165800             IF RC012-PO-NBR > ZERO AND                           16580000
165900                 RC012-REC-SEQ-NBR > ZERO                         16590000
166000                 MOVE +0000       TO ASC-KEY-OPER-UNT-ID          16600000
166100                 MOVE RC012-OPER-UNT-ID TO                        16610000
166200                                     ASC-SAVE-OPER-UNT-ID         16620000
166300             ELSE                                                 16630000
166400                 IF RC012-PO-NBR > ZERO AND                       16640000
166500                     RC012-REC-SEQ-NBR = ZERO AND                 16650000
166600                     RC012-OPER-UNT-ID = ZERO                     16660000
166700                     MOVE +0000   TO ASC-KEY-OPER-UNT-ID          16670000
166800                     MOVE RC012-OPER-UNT-ID TO                    16680000
166900                                     ASC-SAVE-OPER-UNT-ID         16690000
167000                 ELSE                                             16700000
167100                     IF RC012-PO-NBR > ZERO AND                   16710000
167200                         RC012-REC-SEQ-NBR = ZERO AND             16720000
167300                         RC012-OPER-UNT-ID > ZERO                 16730000
167400                          MOVE RC012-OPER-UNT-ID TO               16740000
167500                                   ASC-KEY-OPER-UNT-ID            16750000
167600                                   ASC-SAVE-OPER-UNT-ID           16760000
167700                     END-IF                                       16770000
167800                 END-IF                                           16780000
167900             END-IF                                               16790000
168000             MOVE +1                TO ASC-KEY-FCLTY-ID           16800000
168100             MOVE PC-BUY-ANALYST-DC-SW                            16810000
168200                                    TO ASC-RESPONSIBILITY-AREA-SW 16820000
168300             MOVE PC-BUYER          TO ASC-RA-BUYER               16830000
168400             MOVE PC-ANALYST        TO ASC-RA-ANALYST             16840000
168500             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                16850000
168600             SET ASC-ALL-NOTIF-STATS                              16860000
168700                 ASC-RCVR-STAT-ARR-ENR                            16870000
168800                 ASC-LS-ARRIVAL     TO TRUE                       16880000
168900             MOVE +999              TO ASC-TRBL-REASON-HIGH       16890000
169000         WHEN PC-ENTERED-USING-PO-TR001                           16900000
169100**** USED WHEN COMING FROM THE RC-ADVANCE RECEIVER ADD ****       16910000
169110*TV 10/08/2014 CHANGE STARTS                                      16911011
169200             MOVE TR001-PO-NBR      TO ASC-KEY-PO-NBR             16920011
169210*TV 10/08/2014 CHANGE ends                                        16921011
169300             MOVE TR001-REC-SEQ-NBR TO ASC-KEY-REC-SEQ-NBR        16930000
169400             MOVE +1                TO ASC-KEY-FCLTY-ID           16940000
169500             MOVE PC-BUY-ANALYST-DC-SW                            16950000
169600                                    TO ASC-RESPONSIBILITY-AREA-SW 16960000
169700             MOVE PC-BUYER          TO ASC-RA-BUYER               16970000
169800             MOVE PC-ANALYST        TO ASC-RA-ANALYST             16980000
169900             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                16990000
170000             SET ASC-ALL-NOTIF-STATS                              17000000
170100                 ASC-RCVR-STAT-ARR-ENR                            17010000
170200                 ASC-LS-ARRIVAL     TO TRUE                       17020000
170300             MOVE +999              TO ASC-TRBL-REASON-HIGH       17030000
170400             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        17040000
170500                                       ASC-SAVE-OPER-UNT-ID       17050000
170600         WHEN PC-ENTERED-USING-PO-RC015                           17060000
170700**** USED WHEN COMING FROM THE RC-PACK TO LIGHT VERIFY,****       17070000
170800**** RCVG RECEIVER LIST, RCVR PO/RCVR LIST BY TRAILER  ****       17080000
170900           IF RC015-NUMBER-OF-SELECTED-ITEMS > ZERO               17090000
171000             SET ASC-USE-SELECTION-QUEUE                          17100000
171100                 ASC-FROM-RC015     TO TRUE                       17110000
171200             MOVE RC015-NUMBER-OF-SELECTED-ITEMS                  17120000
171300                          TO ASC-NUMBER-OF-SELECTED-ITEMS         17130000
171400             MOVE RC015-NUMBER-OF-TS-ITEMS                        17140000
171500                          TO ASC-NUMBER-OF-TS-ITEMS               17150000
171600             MOVE RC015-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-IN        17160000
171700             PERFORM 1120-PREPARE-LIST-ENTRY                      17170000
171800             IF  ASC-OPER-UNT-ID                                  17180000
171900                    (ASC-BLK-SUB  ASC-SEL-SUB) = ZEROES           17190000
172000                AND ASC-FCLTY-ID                                  17200000
172100                    (ASC-BLK-SUB  ASC-SEL-SUB) = ZEROES           17210000
172200                MOVE RC015-OPER-UNT-ID                            17220000
172300                    TO ASC-OPER-UNT-ID (ASC-BLK-SUB  ASC-SEL-SUB) 17230000
172400                       ASC-KEY-OPER-UNT-ID                        17240000
172500                       ASC-SAVE-OPER-UNT-ID                       17250000
172600                MOVE RC015-FCLTY-ID                               17260000
172700                    TO  ASC-FCLTY-ID (ASC-BLK-SUB  ASC-SEL-SUB)   17270000
172800                        ASC-KEY-FCLTY-ID                          17280000
172900             END-IF                                               17290000
173000           ELSE                                                   17300000
173100               SET DP030-OVERRIDE-GO TO TRUE                      17310000
173200               MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER           17320000
173300               SET DP020-MSG-WARNING                              17330000
173400                   DP020-NEXT-ACT-APPL-ERROR                      17340000
173500                   PS-COMMAREA-NOT-VALID TO TRUE                  17350000
173600          END-IF                                                  17360000
173700         WHEN PC-ENTERED-USING-PO-PC000                           17370000
173800**** USED WHEN COMING FROM THE WORK ORDER RECEIVER LIST****       17380000
173900           IF PC000-NUMBER-OF-SELECTED-ITEMS > ZERO               17390000
174000             SET ASC-USE-SELECTION-QUEUE                          17400000
174100                 ASC-FROM-PC000     TO TRUE                       17410000
174200             MOVE PC000-NUMBER-OF-SELECTED-ITEMS                  17420000
174300                          TO ASC-NUMBER-OF-SELECTED-ITEMS         17430000
174400             MOVE PC000-NUMBER-OF-TS-ITEMS                        17440000
174500                          TO ASC-NUMBER-OF-TS-ITEMS               17450000
174600             MOVE PC000-SEL-QUEUE-NAME                            17460000
174700                          TO ASC-SEL-QUEUE-IN                     17470000
174800             PERFORM 1130-PREPARE-LIST-ENTRY                      17480000
174900           ELSE                                                   17490000
175000               SET DP030-OVERRIDE-GO TO TRUE                      17500000
175100               MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER           17510000
175200               SET DP020-MSG-WARNING                              17520000
175300                   DP020-NEXT-ACT-APPL-ERROR TO TRUE              17530000
175400          END-IF                                                  17540000
175500         WHEN PC-ENTERED-USING-PO-DS604                           17550000
175600**** USED WHEN COMING FROM THE DS-TRIP-PO/RECEIVER LIST****       17560000
175700           IF DS003-NUMBER-OF-SELECTED-ITEMS > ZERO               17570000
175800             SET ASC-USE-SELECTION-QUEUE                          17580000
175900                 ASC-FROM-DS604     TO TRUE                       17590000
176000             MOVE DS003-NUMBER-OF-SELECTED-ITEMS                  17600000
176100                          TO ASC-NUMBER-OF-SELECTED-ITEMS         17610000
176200             MOVE DS003-NUMBER-OF-TS-ITEMS                        17620000
176300                          TO ASC-NUMBER-OF-TS-ITEMS               17630000
176400             MOVE DS003-SEL-QUEUE-NAME                            17640000
176500                          TO ASC-SEL-QUEUE-IN                     17650000
176600             PERFORM 1140-PREPARE-LIST-ENTRY                      17660000
176700           ELSE                                                   17670000
176800               SET DP030-OVERRIDE-GO TO TRUE                      17680000
176900               MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER           17690000
177000               SET DP020-MSG-WARNING                              17700000
177100                   DP020-NEXT-ACT-APPL-ERROR TO TRUE              17710000
177200          END-IF                                                  17720000
177300     END-EVALUATE.                                                17730000
177400                                                                  17740000
177500*----------------------------------------------------------------*17750000
177600*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *17760000
177700*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *17770000
177800*----------------------------------------------------------------*17780000
177900 1120-PREPARE-LIST-ENTRY.                                         17790000
178000     MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB.                    17800000
178100     MOVE ZERO                 TO ASC-SEL-ITEM.                   17810000
178200     MOVE ZERO                 TO ASC-BLK-SUB.                    17820000
178300     PERFORM 2110-GET-RC13-RECORD.                                17830000
178400                                                                  17840000
178500*----------------------------------------------------------------*17850000
178600*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *17860000
178700*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *17870000
178800*----------------------------------------------------------------*17880000
178900 1130-PREPARE-LIST-ENTRY.                                         17890000
179000     MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB.                    17900000
179100     MOVE ZERO                 TO ASC-SEL-ITEM.                   17910000
179200     MOVE ZERO                 TO ASC-BLK-SUB.                    17920000
179300     PERFORM 2120-GET-PC16-RECORD.                                17930000
179400                                                                  17940000
179500*----------------------------------------------------------------*17950000
179600*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *17960000
179700*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *17970000
179800*----------------------------------------------------------------*17980000
179900 1140-PREPARE-LIST-ENTRY.                                         17990000
180000     MOVE DS002-MAX-ITEMS      TO ASC-SEL-SUB.                    18000000
180100     MOVE ZERO                 TO ASC-SEL-ITEM.                   18010000
180200     MOVE ZERO                 TO ASC-BLK-SUB.                    18020000
180300     PERFORM 2130-GET-DS02-RECORD.                                18030000
180400                                                                  18040000
180500*----------------------------------------------------------------*18050000
180600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *18060000
180700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *18070000
180800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *18080000
180900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *18090000
181000* FUNCTION KEYS CAN GET THIS FAR.                                *18100000
181100*----------------------------------------------------------------*18110000
181200 2000-PROCESS-PANEL.                                              18120000
181300     EVALUATE TRUE                                                18130000
181400         WHEN DP020-SRC-AID = DP016-CLEAR                         18140000
181500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    18150000
181600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18160000
181700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18170000
181800                                                                  18180000
181900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    18190000
182000             PERFORM 2050-DELETE-LIST-QUEUE                       18200000
182100             PERFORM 4000-BUILD-INITIAL-PANEL                     18210000
182200                                                                  18220000
182300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             18230000
182400             IF ASC-USE-SELECTION-QUEUE                           18240000
182500                 INITIALIZE ASC-KEY-FIELDS                        18250000
182600                 EVALUATE TRUE                                    18260000
182700                     WHEN ASC-FROM-RC015                          18270000
182800                         PERFORM 2110-GET-RC13-RECORD             18280000
182900                     WHEN ASC-FROM-PC000                          18290000
183000                         PERFORM 2120-GET-PC16-RECORD             18300000
183100                     WHEN ASC-FROM-DS604                          18310000
183200                         PERFORM 2130-GET-DS02-RECORD             18320000
183300                 END-EVALUATE                                     18330000
183400                 IF PS-LIST-END                                   18340000
183500                    SET PS-NO-LIST-END TO TRUE                    18350000
183600                 ELSE                                             18360000
183700                     PERFORM 2050-DELETE-LIST-QUEUE               18370000
183800                     PERFORM 4000-BUILD-INITIAL-PANEL             18380000
183900                 END-IF                                           18390000
184000              ELSE                                                18400000
184100*                --- BOTTOM OF LIST ---                           18410000
184200                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         18420000
184300                 SET DP020-MSG-INFORMATIONAL TO TRUE              18430000
184400              END-IF                                              18440000
184500                                                                  18450000
184600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             18460000
184700             IF ASC-USE-SELECTION-QUEUE                           18470000
184800                 INITIALIZE ASC-KEY-FIELDS                        18480000
184900                 EVALUATE TRUE                                    18490000
185000                     WHEN ASC-FROM-RC015                          18500000
185100                         PERFORM 2115-GET-PREV-RC13-RECORD        18510000
185200                     WHEN ASC-FROM-PC000                          18520000
185300                         PERFORM 2125-GET-PREV-PC16-RECORD        18530000
185400                     WHEN ASC-FROM-DS604                          18540000
185500                         PERFORM 2135-GET-PREV-DS02-RECORD        18550000
185600                 END-EVALUATE                                     18560000
185700                 IF PS-LIST-END                                   18570000
185800                    SET PS-NO-LIST-END TO TRUE                    18580000
185900                 ELSE                                             18590000
186000                     PERFORM 2050-DELETE-LIST-QUEUE               18600000
186100                     PERFORM 4000-BUILD-INITIAL-PANEL             18610000
186200                 END-IF                                           18620000
186300             ELSE                                                 18630000
186400*                --- TOP OF LIST ---                              18640000
186500                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         18650000
186600                 SET DP020-MSG-INFORMATIONAL TO TRUE              18660000
186700              END-IF                                              18670000
186800                                                                  18680000
186900         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    18690000
187000             PERFORM 2140-DESELECT-ALL-ITEMS                      18700000
187100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18710000
187200                                                                  18720000
187300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  18730000
187400             PERFORM 2150-SELECT-ALL-ITEMS                        18740000
187500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18750000
187600                                                                  18760000
187700         WHEN OTHER                                               18770000
187800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 18780000
187900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   18790000
188000             IF  PS-NO-ERROR                                      18800000
188100                 SET DP030-CONTINUE-GO TO TRUE                    18810000
188200                 PERFORM 2100-CHECK-FUNCTION-KEY                  18820000
188300             ELSE                                                 18830000
188400                 SET DP030-OVERRIDE-GO TO TRUE                    18840000
188500             END-IF                                               18850000
188600     END-EVALUATE.                                                18860000
188700                                                                  18870000
188800*----------------------------------------------------------------*18880000
188900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *18890000
189000*----------------------------------------------------------------*18900000
189100 2050-DELETE-LIST-QUEUE.                                          18910000
189200     EXEC CICS                                                    18920000
189300         DELETEQ TS                                               18930000
189400             QUEUE (ASC-LIST-QUEUE-NAME)                          18940000
189500             RESP  (PV-CICS-RESP)                                 18950000
189600     END-EXEC.                                                    18960000
189700                                                                  18970000
189800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       18980000
189900        (PV-CICS-RESP = DFHRESP(QIDERR))                          18990000
190000         CONTINUE                                                 19000000
190100     ELSE                                                         19010000
190200         SET DP013-CICS-ABEND      TO TRUE                        19020000
190300         SET DP013-NO-ROLLBACK     TO TRUE                        19030000
190400         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         19040000
190500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    19050000
190600                                   TO DP013-MESSAGE-TEXT (1)      19060000
190700         PERFORM DP013-0000-PROCESS-ABEND                         19070000
190800     END-IF.                                                      19080000
190900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  19090000
191000                                                                  19100000
191100*----------------------------------------------------------------*19110000
191200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*19120000
191300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *19130000
191400* CICS ARCHITECTURE API.                                         *19140000
191500*----------------------------------------------------------------*19150000
191600 2100-CHECK-FUNCTION-KEY.                                         19160000
191700     EVALUATE TRUE                                                19170000
191800         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               19180000
191900*             --- ACKNOWLEDGE FUNCTION KEY ---                    19190000
192000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              19200000
192100                 INITIALIZE TM500-FIELDS                          19210000
192200                 SET TM500-ACKNOWLEDGE                            19220000
192300                     TM500-NO-DETAILS TO TRUE                     19230000
192400                 MOVE DP020-USERID TO TM500-ACKNOWLG-UID          19240000
192500                 PERFORM 5050-PREPARE-TO-PROCESS-TRBL             19250000
192600                 IF  NOT PS-ERROR                                 19260000
192700                     IF PS-AUTO-AUTOACKNL-IND-YES                 19270000
192800                        MOVE PC-TSYMSG-03383                      19280000
192900                                           TO DP020-MSG-NUMBER    19290000
193000                     ELSE                                         19300000
193100                        MOVE PC-TSYMSG-00059                      19310000
193200                                           TO DP020-MSG-NUMBER    19320000
193300                     END-IF                                       19330000
193400                     SET DP020-MSG-INFORMATIONAL TO TRUE          19340000
193500                     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM 19350000
193600                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   19360000
193700                                                                  19370000
193800                     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL     19380000
193900                         GIVING PV-BLOCK-NUMBER                   19390000
194000                         REMAINDER PV-REMAINDER                   19400000
194100                     IF  PV-REMAINDER > ZERO                      19410000
194200                         ADD +1 TO PV-BLOCK-NUMBER                19420000
194300                     END-IF                                       19430000
194400                                                                  19440000
194500                     MOVE +1    TO ASC-BLK-SUB                    19450000
194600                     PERFORM 4410-READ-TEMP-STORAGE               19460000
194700                     ADD +1     TO ASC-BLK-SUB                    19470000
194800                                   PV-BLOCK-NUMBER                19480000
194900                     PERFORM 4410-READ-TEMP-STORAGE               19490000
195000                 ELSE                                             19500000
195100                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                19510000
195200                                   TO  PV-TOP-ITEM                19520000
195300                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   19530000
195400                     MOVE +1       TO  ASC-BLK-SUB                19540000
195500                     PERFORM 4410-READ-TEMP-STORAGE               19550000
195600                     ADD +1        TO  ASC-BLK-SUB                19560000
195700                                       PV-BLOCK-NUMBER            19570000
195800                     PERFORM 4410-READ-TEMP-STORAGE               19580000
195900                 END-IF                                           19590000
196000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19600000
196100             ELSE                                                 19610000
196200                 SET DP030-OVERRIDE-GO TO TRUE                    19620000
196300                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         19630000
196400                 SET DP020-MSG-WARNING TO TRUE                    19640000
196500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19650000
196600             END-IF                                               19660000
196700         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               19670000
196800*             ---     PO INQUIRY  KEY ---                         19680000
196900         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               19690000
197000*             ---      PO UPDATE  KEY ---                         19700000
197100             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               19710000
197200                 INITIALIZE PO013-INTER-APPL-COMMAREA             19720000
197300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                19730000
197400                         TO PO013-NUMBER-OF-SELECTED-ITEMS        19740000
197500                 PERFORM 5025-PREPARE-SEL-QUEUE-FOR-PO            19750000
197600                 IF PS-ERROR                                      19760000
197700                     MOVE ASC-ITEM-AT-TOP-OF-PANEL                19770000
197800                         TO PV-TOP-ITEM                           19780000
197900                     MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL        19790000
198000                     MOVE +1 TO ASC-BLK-SUB                       19800000
198100                     PERFORM 4410-READ-TEMP-STORAGE               19810000
198200                     ADD +1 TO  ASC-BLK-SUB                       19820000
198300                                PV-BLOCK-NUMBER                   19830000
198400                     PERFORM 4410-READ-TEMP-STORAGE               19840000
198500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         19850000
198600                     SET DP030-OVERRIDE-GO                        19860000
198700                         DP020-MSG-WARNING TO TRUE                19870000
198800                 END-IF                                           19880000
198900             ELSE                                                 19890000
199000                 SET DP030-OVERRIDE-GO TO TRUE                    19900000
199100                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        19910000
199200                 SET DP020-MSG-WARNING TO TRUE                    19920000
199300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             19930000
199400             END-IF                                               19940000
199500         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               19950000
199600*             --- DC CHKD FUNCTION KEY ---                        19960000
199700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              19970000
199800                 INITIALIZE TM500-FIELDS                          19980000
199900                 SET TM500-IN-PROCESS                             19990000
200000                     TM500-ADD-DETAILS                            20000000
200100                     PS-DC-CHEK-REQUEST TO TRUE                   20010000
200200                 MOVE DP020-USERID TO TM500-NOTIF-UID             20020000
200300                                      TM500-CRE-UID               20030000
200400                 MOVE PC-DC-CHECKED-MSG TO TM500-FREEFORM-TEXT    20040000
200500                 PERFORM 5050-PREPARE-TO-PROCESS-TRBL             20050000
200600                 IF NOT PS-ERROR                                  20060000
200700                     MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER     20070000
200800                     SET DP020-MSG-INFORMATIONAL TO TRUE          20080000
200900                     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO  PV-TOP-ITEM20090000
201000                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   20100000
201100                                                                  20110000
201200                     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL     20120000
201300                         GIVING PV-BLOCK-NUMBER                   20130000
201400                         REMAINDER PV-REMAINDER                   20140000
201500                     IF  PV-REMAINDER > ZERO                      20150000
201600                         ADD +1 TO PV-BLOCK-NUMBER                20160000
201700                     END-IF                                       20170000
201800                                                                  20180000
201900                     MOVE +1    TO ASC-BLK-SUB                    20190000
202000                     PERFORM 4410-READ-TEMP-STORAGE               20200000
202100                     ADD +1     TO ASC-BLK-SUB                    20210000
202200                                   PV-BLOCK-NUMBER                20220000
202300                     PERFORM 4410-READ-TEMP-STORAGE               20230000
202400                 ELSE                                             20240000
202500                     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM 20250000
202600                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   20260000
202700                     MOVE +1       TO  ASC-BLK-SUB                20270000
202800                     PERFORM 4410-READ-TEMP-STORAGE               20280000
202900                     ADD +1        TO  ASC-BLK-SUB                20290000
203000                                       PV-BLOCK-NUMBER            20300000
203100                     PERFORM 4410-READ-TEMP-STORAGE               20310000
203200                 END-IF                                           20320000
203300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             20330000
203400             ELSE                                                 20340000
203500                 SET DP030-OVERRIDE-GO TO TRUE                    20350000
203600                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         20360000
203700                 SET DP020-MSG-WARNING TO TRUE                    20370000
203800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             20380000
203900             END-IF                                               20390000
204000         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               20400000
204100*             --- RESPOND/RESOLVE FUNCTION KEY ---                20410000
204200         WHEN DP020-FK-LOCAL-FUNC-08(DP020-SRC-AID)               20420000
204300*             --- LINE ITM FUNCTION KEY ---                       20430000
204400         WHEN DP020-FK-LOCAL-FUNC-09(DP020-SRC-AID)               20440000
204500*             --- DETAILS FUNCTION KEY ---                        20450000
204600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              20460000
204700                 INITIALIZE TM005-INTER-APPL-COMMAREA             20470000
204800                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                20480000
204900                         TO TM005-NUMBER-OF-SELECTED-ITEMS        20490000
205000                 PERFORM 5000-PREPARE-SEL-QUEUE                   20500000
205100             ELSE                                                 20510000
205200                 SET DP030-OVERRIDE-GO TO TRUE                    20520000
205300                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        20530000
205400                 SET DP020-MSG-WARNING TO TRUE                    20540000
205500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             20550000
205600             END-IF                                               20560000
205700         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               20570000
205800*             --- RESOLVE FUCTION KEY ---                         20580000
205900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              20590000
206000                 INITIALIZE TM500-FIELDS                          20600000
206100                 SET TM500-RESOLVE-AUTO                           20610000
206200                     TM500-NO-DETAILS                             20620000
206300                     PS-RESOLVE-REQUEST TO TRUE                   20630000
206400                 MOVE PC-CURRENT-PROGRAM-NAME TO TM500-NOTIF-UID  20640000
206500                 MOVE DP020-USERID TO TM500-RESOLVED-UID          20650000
206600                 PERFORM 5050-PREPARE-TO-PROCESS-TRBL             20660000
206700                 IF  NOT PS-ERROR                                 20670000
206800                     IF  TM500-DUPLICATE-TROUBLE                  20680000
206900                         CONTINUE                                 20690000
207000                     ELSE                                         20700000
207100                         MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER 20710000
207200                     END-IF                                       20720000
207300                     SET DP020-MSG-INFORMATIONAL   TO TRUE        20730000
207400                     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM 20740000
207500                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   20750000
207600                                                                  20760000
207700                     DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL     20770000
207800                         GIVING PV-BLOCK-NUMBER                   20780000
207900                         REMAINDER PV-REMAINDER                   20790000
208000                     IF  PV-REMAINDER > ZERO                      20800000
208100                         ADD +1 TO PV-BLOCK-NUMBER                20810000
208200                     END-IF                                       20820000
208300                                                                  20830000
208400                     MOVE +1    TO ASC-BLK-SUB                    20840000
208500                     PERFORM 4410-READ-TEMP-STORAGE               20850000
208600                     ADD +1     TO ASC-BLK-SUB                    20860000
208700                                   PV-BLOCK-NUMBER                20870000
208800                     PERFORM 4410-READ-TEMP-STORAGE               20880000
208900                 ELSE                                             20890000
209000                     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM 20900000
209100                     MOVE ZERO     TO  ASC-ITEM-AT-TOP-OF-PANEL   20910000
209200                     MOVE +1       TO  ASC-BLK-SUB                20920000
209300                     PERFORM 4410-READ-TEMP-STORAGE               20930000
209400                     ADD +1        TO  ASC-BLK-SUB                20940000
209500                                       PV-BLOCK-NUMBER            20950000
209600                     PERFORM 4410-READ-TEMP-STORAGE               20960000
209700                 END-IF                                           20970000
209800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             20980000
209900             ELSE                                                 20990000
210000                 SET DP030-OVERRIDE-GO TO TRUE                    21000000
210100                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        21010000
210200                 SET DP020-MSG-WARNING TO TRUE                    21020000
210300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             21030000
210400             END-IF                                               21040000
210500                                                                  21050000
210600         WHEN DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)               21060000
210700*             --- RCVRMNT FUCTION KEY ---                         21070000
210800         WHEN DP020-FK-LOCAL-FUNC-10(DP020-SRC-AID)               21080000
210900*             --- RCITMLST FUCTION KEY ---                        21090000
211000             IF ASC-NUMBER-OF-SELECTED-ITEMS NOT > ZERO           21100000
211100                 SET DP030-OVERRIDE-GO TO TRUE                    21110000
211200                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        21120000
211300                 SET DP020-MSG-WARNING TO TRUE                    21130000
211400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             21140000
211500             ELSE                                                 21150000
211700                 IF DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)         21170000
211800                   INITIALIZE RC015-INTER-APPL-COMMAREA           21180000
211900                   SET ASC-RCVRMNT TO TRUE                        21190000
212000                   MOVE ASC-NUMBER-OF-SELECTED-ITEMS              21200000
212100                     TO RC015-NUMBER-OF-SELECTED-ITEMS            21210000
212200                   MOVE ASC-KEY-PO-NBR  TO RC015-PO-NBR           21220000
212300                   MOVE ASC-KEY-REC-SEQ-NBR TO RC015-REC-SEQ-NBR  21230000
212400                   MOVE ASC-KEY-OPER-UNT-ID TO RC015-OPER-UNT-ID  21240000
212500                   MOVE ASC-KEY-FCLTY-ID TO RC015-FCLTY-ID        21250000
212600                   PERFORM 5000-PREPARE-SEL-QUEUE-R               21260000
212700                   SET ASC-FROM-RC015 TO TRUE                     21270000
212800                   PERFORM 7000-FORMAT-COMMAREA                   21280000
212900                 END-IF                                           21290000
213000                 IF DP020-FK-LOCAL-FUNC-10(DP020-SRC-AID)         21300000
213100                     IF ASC-NUMBER-OF-SELECTED-ITEMS > +1         21310000
213200                       SET DP030-OVERRIDE-GO TO TRUE              21320000
213300                       MOVE PC-TSYMSG-00047 TO DP020-MSG-NUMBER   21330000
213400                       SET DP020-MSG-WARNING TO TRUE              21340000
213500                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       21350000
213600                     ELSE                                         21360000
213700                       PERFORM 2160-CHECK-TRECEIV-PKGNG-CDE       21370000
213800                       IF RECEIV-PKGNG-CDE = 'M' OR 'I'           21380000
213900                           SET DP030-OVERRIDE-GO   TO TRUE        21390000
214000                           SET DP020-MSG-FATAL     TO TRUE        21400000
214100                           SET PS-PREPACK-RCVR-YES TO TRUE        21410000
214200                           MOVE PC-TSYMSG-02184                   21420000
214300                                       TO DP020-MSG-NUMBER        21430000
214400                       ELSE                                       21440000
214500                           INITIALIZE RC015-INTER-APPL-COMMAREA   21450000
214600                           SET ASC-RCVRMNT TO TRUE                21460000
214700                           MOVE ASC-NUMBER-OF-SELECTED-ITEMS      21470000
214800                             TO RC015-NUMBER-OF-SELECTED-ITEMS    21480000
214900                           MOVE ASC-KEY-PO-NBR TO RC015-PO-NBR    21490000
215000                           MOVE ASC-KEY-REC-SEQ-NBR               21500000
215100                             TO RC015-REC-SEQ-NBR                 21510000
215200                           MOVE ASC-KEY-OPER-UNT-ID               21520000
215300                             TO RC015-OPER-UNT-ID                 21530000
215400                           MOVE ASC-KEY-FCLTY-ID                  21540000
215500                             TO RC015-FCLTY-ID                    21550000
215600                           PERFORM 5000-PREPARE-SEL-QUEUE-R       21560000
215700                           SET ASC-FROM-RC015 TO TRUE             21570000
215800                           PERFORM 7000-FORMAT-COMMAREA           21580000
215900                       END-IF                                     21590000
216000                     END-IF                                       21600000
216100                 END-IF                                           21610000
216200               END-IF                                             21620000
216300                                                                  21630000
216400         WHEN DP020-FK-LOCAL-FUNC-11(DP020-SRC-AID)               21640000
216500*             --- SULADJDT STORE UNIT ADJ TRAN LIST  ---          21650000
216600***???       SET ASC-UPDATE-TSQ2   TO TRUE                        21660000
216700             IF ASC-NUMBER-OF-SELECTED-ITEMS NOT > ZERO           21670000
216800                 SET DP030-OVERRIDE-GO TO TRUE                    21680000
216900                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        21690000
217000                 SET DP020-MSG-WARNING TO TRUE                    21700000
217100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             21710000
217200             ELSE                                                 21720000
217300                 INITIALIZE SU038-INTER-APPL-COMMAREA             21730000
217400                 SET ASC-UNITADJ TO TRUE                          21740000
217500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                21750000
217600                            TO SU038-NUMBER-OF-SELECTED-ITEMS     21760000
217700                 MOVE ASC-KEY-OPER-UNT-ID TO SU038-OPER-UNT-ID    21770000
217800                 MOVE SPACES            TO SU038-OPER-NAME        21780000
217900                 MOVE 'A'               TO SU038-UNT-ADJ-TYP      21790000
218000                 MOVE 'F'               TO SU038-FAIL-SUCCSS      21800000
218100                 PERFORM 5010-PREPARE-SEL-QUEUE                   21810000
218200             END-IF                                               21820000
218300*CLP 09/03/13 BEGIN                                               21830000
218400         WHEN DP020-FK-LOCAL-FUNC-12(DP020-SRC-AID)               21840000
218500*    F19      --- POCTNLST LIST  ---                              21850000
218600             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               21860000
218700                 INITIALIZE SU009-INTER-APPL-COMMAREA             21870000
218800                 SET ASC-POCTNLST TO TRUE                         21880000
218900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                21890000
219000                            TO SU009-NUMBER-OF-SELECTED-ITEMS     21900000
219100                 MOVE ASC-KEY-OPER-UNT-ID TO SU009-OPER-UNT-ID    21910000
219200                 MOVE ASC-KEY-PO-NBR      TO SU009-PO-RCVR        21920000
219300                 PERFORM 5000-PREPARE-SEL-QUEUE                   21930000
219400             ELSE                                                 21940000
219500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             21950000
219600                 SET DP030-OVERRIDE-GO TO TRUE                    21960000
219700                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        21970000
219800             END-IF                                               21980000
219900*CLP 09/03/13 END                                                 21990000
220000                                                                  22000000
220100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  22010000
220200             MOVE +1       TO PV-TOP-ITEM                         22020000
220300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22030000
220400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   22040000
220500             PERFORM 2110-BROWSE-BACKWARD                         22050000
220600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22060000
220700         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   22070000
220800             PERFORM 2120-BROWSE-FORWARD                          22080000
220900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22090000
221000         WHEN DP020-SRC-AID = DP016-ENTER                         22100000
221100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   22110000
221200             IF PS-ERROR                                          22120000
221300                 CONTINUE                                         22130000
221400             ELSE                                                 22140000
221500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             22150000
221600             END-IF                                               22160000
221700         WHEN OTHER                                               22170000
221800             SET DP013-NO-ROLLBACK                                22180000
221900                 DP013-XCTL-DISPLAY-RESTART                       22190000
222000                 DP013-CICS-ABEND  TO TRUE                        22200000
222100             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    22210000
222200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      22220000
222300                                   TO DP013-MESSAGE-TEXT (1)      22230000
222400             PERFORM DP013-0000-PROCESS-ABEND                     22240000
222500     END-EVALUATE.                                                22250000
222600                                                                  22260000
222700*----------------------------------------------------------------*22270000
222800*    GET THE RECEIVER NUMBER (KEY) OF THE NEXT SELECTED OBJECT   *22280000
222900*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *22290000
223000*----------------------------------------------------------------*22300000
223100 2110-GET-RC13-RECORD.                                            22310000
223200     ADD +1                     TO ASC-SEL-SUB                    22320000
223300     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            22330000
223400         ADD +1                  TO ASC-SEL-ITEM                  22340000
223500         MOVE +1                 TO ASC-SEL-SUB                   22350000
223600         ADD +1                  TO ASC-BLK-SUB                   22360000
223700     END-IF.                                                      22370000
223800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                22380000
223900         PERFORM 9100-READ-SEL-QUEUE                              22390000
224000         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      22400000
224100             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      22410000
224200                                 TO ASC-KEY-PO-NBR                22420000
224300                     ASC-PO-NBR-N (ASC-BLK-SUB  ASC-SEL-SUB)      22430000
224400             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 22440000
224500                                 TO ASC-RCVR-SEQ-NBR-N            22450000
224600                                       (ASC-BLK-SUB ASC-SEL-SUB)  22460000
224700             MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)    22470000
224800                                 TO ASC-KEY-REC-SEQ-NBR           22480000
224900             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 22490000
225000                   TO ASC-OPER-UNT-ID (ASC-BLK-SUB ASC-SEL-SUB)   22500000
225100                      ASC-KEY-OPER-UNT-ID                         22510000
225200             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    22520000
225300                      TO ASC-FCLTY-ID (ASC-BLK-SUB ASC-SEL-SUB)   22530000
225400                         ASC-KEY-FCLTY-ID                         22540000
225500             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  22550000
225600             PERFORM 9200-REWRITE-SEL-QUEUE                       22560000
225700                                                                  22570000
225800             MOVE PC-BUY-ANALYST-DC-SW                            22580000
225900                                    TO ASC-RESPONSIBILITY-AREA-SW 22590000
226000             MOVE PC-BUYER          TO ASC-RA-BUYER               22600000
226100             MOVE PC-ANALYST        TO ASC-RA-ANALYST             22610000
226200             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                22620000
226300             SET ASC-ALL-NOTIF-STATS                              22630000
226400                 ASC-RCVR-STAT-ARR-ENR                            22640000
226500                 ASC-LS-ARRIVAL     TO TRUE                       22650000
226600             MOVE +999              TO ASC-TRBL-REASON-HIGH       22660000
226700             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        22670000
226800                                       ASC-SAVE-OPER-UNT-ID       22680000
226900         ELSE                                                     22690000
227000             SUBTRACT +1 FROM ASC-SEL-SUB                         22700000
227100*            --- BOTTOM OF LIST ---                               22710000
227200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            22720000
227300             SET DP020-MSG-INFORMATIONAL                          22730000
227400                 PS-LIST-END TO TRUE                              22740000
227500         END-IF                                                   22750000
227600     ELSE                                                         22760000
227700         SUBTRACT +1 FROM ASC-BLK-SUB                             22770000
227800         SUBTRACT +1 FROM ASC-SEL-ITEM                            22780000
227900         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 22790000
228000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            22800000
228100         SET DP020-MSG-INFORMATIONAL                              22810000
228200                 PS-LIST-END TO TRUE                              22820000
228300     END-IF.                                                      22830000
228400                                                                  22840000
228500 2115-GET-PREV-RC13-RECORD.                                       22850000
228600     SUBTRACT +1 FROM ASC-SEL-SUB.                                22860000
228700     IF  ASC-SEL-SUB < +1                                         22870000
228800         SUBTRACT +1 FROM ASC-BLK-SUB                             22880000
228900         SUBTRACT +1 FROM ASC-SEL-ITEM                            22890000
229000         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 22900000
229100     END-IF.                                                      22910000
229200                                                                  22920000
229300     IF  ASC-BLK-SUB > ZERO                                       22930000
229400         PERFORM 9100-READ-SEL-QUEUE                              22940000
229500         MOVE RC013-PO-NBR (ASC-SEL-SUB)                          22950000
229600                             TO ASC-KEY-PO-NBR                    22960000
229700                 ASC-PO-NBR-N (ASC-BLK-SUB  ASC-SEL-SUB)          22970000
229800         MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                     22980000
229900                             TO ASC-RCVR-SEQ-NBR-N                22990000
230000                                   (ASC-BLK-SUB ASC-SEL-SUB)      23000000
230100         MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)        23010000
230200                             TO ASC-KEY-REC-SEQ-NBR               23020000
230300         MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                     23030000
230400               TO ASC-OPER-UNT-ID (ASC-BLK-SUB ASC-SEL-SUB)       23040000
230500                  ASC-KEY-OPER-UNT-ID                             23050000
230600                  ASC-SAVE-OPER-UNT-ID                            23060000
230700         MOVE RC013-FCLTY-ID    (ASC-SEL-SUB)                     23070000
230800                  TO ASC-FCLTY-ID (ASC-BLK-SUB ASC-SEL-SUB)       23080000
230900                     ASC-KEY-FCLTY-ID                             23090000
231000         SET RC013-INQ (ASC-SEL-SUB)                              23100000
231100                             TO TRUE                              23110000
231200         PERFORM 9200-REWRITE-SEL-QUEUE                           23120000
231300         MOVE PC-BUY-ANALYST-DC-SW                                23130000
231400                                TO ASC-RESPONSIBILITY-AREA-SW     23140000
231500         MOVE PC-BUYER          TO ASC-RA-BUYER                   23150000
231600         MOVE PC-ANALYST        TO ASC-RA-ANALYST                 23160000
231700         MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                    23170000
231800         SET ASC-ALL-NOTIF-STATS                                  23180000
231900             ASC-RCVR-STAT-ARR-ENR                                23190000
232000             ASC-LS-ARRIVAL     TO TRUE                           23200000
232100             MOVE +999              TO ASC-TRBL-REASON-HIGH       23210000
232200             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        23220000
232300                                       ASC-SAVE-OPER-UNT-ID       23230000
232400     ELSE                                                         23240000
232500         MOVE +1                TO ASC-BLK-SUB                    23250000
232600                                   ASC-SEL-SUB                    23260000
232700                                   ASC-SEL-ITEM                   23270000
232800*        --- TOP OF LIST ---                                      23280000
232900         MOVE PC-TSYMSG-00069   TO DP020-MSG-NUMBER               23290000
233000         SET DP020-MSG-INFORMATIONAL                              23300000
233100                 PS-LIST-END TO TRUE                              23310000
233200     END-IF.                                                      23320000
233300                                                                  23330000
233400*----------------------------------------------------------------*23340000
233500*    GET THE RECEIVER NUMBER (KEY) OF THE NEXT SELECTED OBJECT   *23350000
233600*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *23360000
233700*----------------------------------------------------------------*23370000
233800 2120-GET-PC16-RECORD.                                            23380000
233900     ADD +1                     TO ASC-SEL-SUB                    23390000
234000     IF  ASC-SEL-SUB > PC016-MAX-ITEMS                            23400000
234100         ADD +1                 TO ASC-SEL-ITEM                   23410000
234200         MOVE +1                TO ASC-SEL-SUB                    23420000
234300         ADD +1                 TO ASC-BLK-SUB                    23430000
234400     END-IF.                                                      23440000
234500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                23450000
234600         PERFORM 9300-READ-SEL-QUEUE                              23460000
234700         IF  PC016-ITEM (ASC-SEL-SUB) > ZERO                      23470000
234800             MOVE PC016-PO-NBR   (ASC-SEL-SUB)                    23480000
234900                                    TO DP010I-UNEDITED-FIELD      23490000
234910*TV 10/08/2014 CHANGE STARTS                                      23491014
235000             MOVE +8                TO DP010I-MAXIMUM-DIGITS      23500012
235010*TV 10/08/2014 CHANGE ends                                        23501014
235100             MOVE +0                TO DP010I-MAXIMUM-DECIMALS    23510000
235200                                                                  23520000
235300             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              23530000
235410             CALL DP010I-NUMERIC-EDIT-ROUTINE                     23541017
235420                  USING DP010I-NUMERIC-EDIT-AREA                  23542017
235500             IF DP010I-ERROR-DETECTED                             23550000
235600                CONTINUE                                          23560000
235700             ELSE                                                 23570000
235800                 MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR           23580000
235900             END-IF                                               23590000
236000             MOVE PV-PO-NBR                                       23600000
236100                  TO ASC-PO-NBR-N (ASC-BLK-SUB  ASC-SEL-SUB)      23610000
236200             MOVE ASC-PO-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)          23620000
236300                     TO ASC-KEY-PO-NBR                            23630000
236400             MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)               23640000
236500                                 TO ASC-RCVR-SEQ-NBR-N            23650000
236600                                       (ASC-BLK-SUB ASC-SEL-SUB)  23660000
236700             MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)    23670000
236800                                 TO ASC-KEY-REC-SEQ-NBR           23680000
236900             MOVE PC016-OPER-UNT-ID (ASC-SEL-SUB)                 23690000
237000                   TO ASC-OPER-UNT-ID (ASC-BLK-SUB ASC-SEL-SUB)   23700000
237100                      ASC-KEY-OPER-UNT-ID                         23710000
237200                      ASC-SAVE-OPER-UNT-ID                        23720000
237300             MOVE PC016-FCLTY-ID    (ASC-SEL-SUB)                 23730000
237400                      TO ASC-FCLTY-ID (ASC-BLK-SUB ASC-SEL-SUB)   23740000
237500                         ASC-KEY-FCLTY-ID                         23750000
237600             SET PC016-INQ (ASC-SEL-SUB) TO TRUE                  23760000
237700             PERFORM 9400-REWRITE-SEL-QUEUE                       23770000
237800             MOVE PC-BUY-ANALYST-DC-SW                            23780000
237900                                    TO ASC-RESPONSIBILITY-AREA-SW 23790000
238000             MOVE PC-BUYER          TO ASC-RA-BUYER               23800000
238100             MOVE PC-ANALYST        TO ASC-RA-ANALYST             23810000
238200             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                23820000
238300             SET ASC-ALL-NOTIF-STATS                              23830000
238400                 ASC-RCVR-STAT-ARR-ENR                            23840000
238500                 ASC-LS-ARRIVAL     TO TRUE                       23850000
238600             MOVE +999              TO ASC-TRBL-REASON-HIGH       23860000
238700             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        23870000
238800                                       ASC-SAVE-OPER-UNT-ID       23880000
238900         ELSE                                                     23890000
239000             SUBTRACT +1 FROM ASC-SEL-SUB                         23900000
239100*            --- BOTTOM OF LIST ---                               23910000
239200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            23920000
239300             SET DP020-MSG-INFORMATIONAL                          23930000
239400                 PS-LIST-END       TO TRUE                        23940000
239500         END-IF                                                   23950000
239600     ELSE                                                         23960000
239700         SUBTRACT +1 FROM ASC-BLK-SUB                             23970000
239800         SUBTRACT +1 FROM ASC-SEL-ITEM                            23980000
239900         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 23990000
240000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            24000000
240100         SET DP020-MSG-INFORMATIONAL                              24010000
240200                 PS-LIST-END       TO TRUE                        24020000
240300     END-IF.                                                      24030000
240400                                                                  24040000
240500 2125-GET-PREV-PC16-RECORD.                                       24050000
240600     SUBTRACT +1 FROM ASC-SEL-SUB.                                24060000
240700     IF  ASC-SEL-SUB < +1                                         24070000
240800         SUBTRACT +1 FROM ASC-BLK-SUB                             24080000
240900         SUBTRACT +1 FROM ASC-SEL-ITEM                            24090000
241000         MOVE PC016-MAX-ITEMS   TO ASC-SEL-SUB                    24100000
241100     END-IF.                                                      24110000
241200                                                                  24120000
241300     IF  ASC-BLK-SUB > ZERO                                       24130000
241400         PERFORM 9300-READ-SEL-QUEUE                              24140000
241500         MOVE PC016-PO-NBR   (ASC-SEL-SUB)                        24150000
241600                                TO DP010I-UNEDITED-FIELD          24160000
241610*TV 10/08/2014 CHANGE STARTS                                      24161014
241700         MOVE +8                TO DP010I-MAXIMUM-DIGITS          24170012
241710*TV 10/08/2014 CHANGE ends                                        24171014
241800         MOVE +0                TO DP010I-MAXIMUM-DECIMALS        24180000
241900                                                                  24190000
242000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  24200000
242110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         24211017
242120              USING DP010I-NUMERIC-EDIT-AREA                      24212017
242200         IF DP010I-ERROR-DETECTED                                 24220000
242300            CONTINUE                                              24230000
242400         ELSE                                                     24240000
242500             MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR               24250000
242600         END-IF                                                   24260000
242700         MOVE PV-PO-NBR                                           24270000
242800              TO ASC-PO-NBR-N (ASC-BLK-SUB  ASC-SEL-SUB)          24280000
242900         MOVE ASC-PO-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)              24290000
243000                 TO ASC-KEY-PO-NBR                                24300000
243100         MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)                   24310000
243200                             TO ASC-RCVR-SEQ-NBR-N                24320000
243300                                   (ASC-BLK-SUB ASC-SEL-SUB)      24330000
243400         MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)        24340000
243500                             TO ASC-KEY-REC-SEQ-NBR               24350000
243600         MOVE PC016-OPER-UNT-ID (ASC-SEL-SUB)                     24360000
243700               TO ASC-OPER-UNT-ID (ASC-BLK-SUB ASC-SEL-SUB)       24370000
243800                  ASC-KEY-OPER-UNT-ID                             24380000
243900                  ASC-SAVE-OPER-UNT-ID                            24390000
244000         MOVE PC016-FCLTY-ID  (ASC-SEL-SUB)                       24400000
244100                  TO ASC-FCLTY-ID (ASC-BLK-SUB ASC-SEL-SUB)       24410000
244200                     ASC-KEY-FCLTY-ID                             24420000
244300         SET PC016-INQ (ASC-SEL-SUB)                              24430000
244400                             TO TRUE                              24440000
244500         PERFORM 9400-REWRITE-SEL-QUEUE                           24450000
244600             MOVE PC-BUY-ANALYST-DC-SW                            24460000
244700                                    TO ASC-RESPONSIBILITY-AREA-SW 24470000
244800             MOVE PC-BUYER          TO ASC-RA-BUYER               24480000
244900             MOVE PC-ANALYST        TO ASC-RA-ANALYST             24490000
245000             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                24500000
245100             SET ASC-ALL-NOTIF-STATS                              24510000
245200                 ASC-RCVR-STAT-ARR-ENR                            24520000
245300                 ASC-LS-ARRIVAL     TO TRUE                       24530000
245400             MOVE +999              TO ASC-TRBL-REASON-HIGH       24540000
245500             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        24550000
245600                                       ASC-SAVE-OPER-UNT-ID       24560000
245700     ELSE                                                         24570000
245800         MOVE +1                    TO ASC-BLK-SUB                24580000
245900                                       ASC-SEL-SUB                24590000
246000                                       ASC-SEL-ITEM               24600000
246100*        --- TOP OF LIST ---                                      24610000
246200         MOVE PC-TSYMSG-00069       TO DP020-MSG-NUMBER           24620000
246300         SET DP020-MSG-INFORMATIONAL                              24630000
246400                 PS-LIST-END        TO TRUE                       24640000
246500     END-IF.                                                      24650000
246600                                                                  24660000
246700*----------------------------------------------------------------*24670000
246800*    GET THE RECEIVER NUMBER (KEY) OF THE NEXT SELECTED OBJECT   *24680000
246900*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *24690000
247000*----------------------------------------------------------------*24700000
247100 2130-GET-DS02-RECORD.                                            24710000
247200     ADD +1                      TO ASC-SEL-SUB                   24720000
247300     IF  ASC-SEL-SUB > DS002-MAX-ITEMS                            24730000
247400         ADD +1                   TO ASC-SEL-ITEM                 24740000
247500         MOVE +1                  TO ASC-SEL-SUB                  24750000
247600         ADD +1                   TO ASC-BLK-SUB                  24760000
247700     END-IF.                                                      24770000
247800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                24780000
247900         PERFORM 9500-READ-SEL-QUEUE                              24790000
248000         IF  DS002-ITEM (ASC-SEL-SUB) > ZERO                      24800000
248010*TV 10/08/2014 CHANGE STARTS                                      24801014
248100             MOVE DS002-PO-RCVR  (ASC-SEL-SUB) (1:8)              24810013
248200                                    TO DP010I-UNEDITED-FIELD      24820000
248300             MOVE +8                TO DP010I-MAXIMUM-DIGITS      24830013
248310*TV 10/08/2014 CHANGE ends                                        24831014
248400             MOVE +0                TO DP010I-MAXIMUM-DECIMALS    24840000
248500                                                                  24850000
248600             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              24860000
248710             CALL DP010I-NUMERIC-EDIT-ROUTINE                     24871017
248720                  USING DP010I-NUMERIC-EDIT-AREA                  24872017
248800             IF DP010I-ERROR-DETECTED                             24880000
248900                CONTINUE                                          24890000
249000             ELSE                                                 24900000
249100                 MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR           24910000
249200             END-IF                                               24920000
249300             MOVE PV-PO-NBR                                       24930000
249400                  TO ASC-PO-NBR-N (ASC-BLK-SUB  ASC-SEL-SUB)      24940000
249500             MOVE ASC-PO-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)          24950000
249600                     TO ASC-KEY-PO-NBR                            24960000
249700             MOVE DS002-PO-RCVR  (ASC-SEL-SUB) (9:4)              24970000
249800                                   TO ASC-RCVR-SEQ-NBR-N          24980000
249900                                       (ASC-BLK-SUB ASC-SEL-SUB)  24990000
250000             MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)    25000000
250100                                   TO ASC-KEY-REC-SEQ-NBR         25010000
250200             SET DS002-INQ (ASC-SEL-SUB) TO TRUE                  25020000
250300             PERFORM 9600-REWRITE-SEL-QUEUE                       25030000
250400             MOVE PC-BUY-ANALYST-DC-SW                            25040000
250500                                    TO ASC-RESPONSIBILITY-AREA-SW 25050000
250600             MOVE PC-BUYER          TO ASC-RA-BUYER               25060000
250700             MOVE PC-ANALYST        TO ASC-RA-ANALYST             25070000
250800             MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                25080000
250900             SET ASC-ALL-NOTIF-STATS                              25090000
251000                 ASC-RCVR-STAT-ARR-ENR                            25100000
251100                 ASC-LS-ARRIVAL     TO TRUE                       25110000
251200             MOVE +999              TO ASC-TRBL-REASON-HIGH       25120000
251300             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        25130000
251400                                       ASC-SAVE-OPER-UNT-ID       25140000
251500         ELSE                                                     25150000
251600             SUBTRACT +1 FROM ASC-SEL-SUB                         25160000
251700*            --- BOTTOM OF LIST ---                               25170000
251800             MOVE PC-TSYMSG-00070   TO DP020-MSG-NUMBER           25180000
251900             SET DP020-MSG-INFORMATIONAL                          25190000
252000                 PS-LIST-END        TO TRUE                       25200000
252100         END-IF                                                   25210000
252200     ELSE                                                         25220000
252300         SUBTRACT +1 FROM ASC-BLK-SUB                             25230000
252400         SUBTRACT +1 FROM ASC-SEL-ITEM                            25240000
252500         MOVE DS002-MAX-ITEMS       TO ASC-SEL-SUB                25250000
252600         MOVE PC-TSYMSG-00070       TO DP020-MSG-NUMBER           25260000
252700         SET DP020-MSG-INFORMATIONAL                              25270000
252800                 PS-LIST-END        TO TRUE                       25280000
252900     END-IF.                                                      25290000
253000                                                                  25300000
253100 2135-GET-PREV-DS02-RECORD.                                       25310000
253200     SUBTRACT +1 FROM ASC-SEL-SUB.                                25320000
253300     IF  ASC-SEL-SUB < +1                                         25330000
253400         SUBTRACT +1 FROM ASC-BLK-SUB                             25340000
253500         SUBTRACT +1 FROM ASC-SEL-ITEM                            25350000
253600         MOVE DS002-MAX-ITEMS       TO ASC-SEL-SUB                25360000
253700     END-IF.                                                      25370000
253800                                                                  25380000
253900     IF  ASC-BLK-SUB > ZERO                                       25390000
254000         PERFORM 9500-READ-SEL-QUEUE                              25400000
254010*TV 10/08/2014 CHANGE STARTS                                      25401014
254100         MOVE DS002-PO-RCVR  (ASC-SEL-SUB) (1:8)                  25410013
254200                                TO DP010I-UNEDITED-FIELD          25420000
254300         MOVE +8                TO DP010I-MAXIMUM-DIGITS          25430013
254310*TV 10/08/2014 CHANGE ends                                        25431014
254400         MOVE +0                TO DP010I-MAXIMUM-DECIMALS        25440000
254500                                                                  25450000
254600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  25460000
254710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         25471017
254720              USING DP010I-NUMERIC-EDIT-AREA                      25472017
254800         IF DP010I-ERROR-DETECTED                                 25480000
254900            CONTINUE                                              25490000
255000         ELSE                                                     25500000
255100             MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR               25510000
255200         END-IF                                                   25520000
255300         MOVE PV-PO-NBR                                           25530000
255400              TO ASC-PO-NBR-N (ASC-BLK-SUB  ASC-SEL-SUB)          25540000
255500         MOVE ASC-PO-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)              25550000
255600                 TO ASC-KEY-PO-NBR                                25560000
255700         MOVE DS002-PO-RCVR  (ASC-SEL-SUB) (9:4)                  25570000
255800                             TO ASC-RCVR-SEQ-NBR-N                25580000
255900                                   (ASC-BLK-SUB ASC-SEL-SUB)      25590000
256000         MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-SEL-SUB)        25600000
256100                             TO ASC-KEY-REC-SEQ-NBR               25610000
256200         SET DS002-INQ (ASC-SEL-SUB) TO TRUE                      25620000
256300         PERFORM 9600-REWRITE-SEL-QUEUE                           25630000
256400         MOVE PC-BUY-ANALYST-DC-SW                                25640000
256500                                TO ASC-RESPONSIBILITY-AREA-SW     25650000
256600         MOVE PC-BUYER          TO ASC-RA-BUYER                   25660000
256700         MOVE PC-ANALYST        TO ASC-RA-ANALYST                 25670000
256800         MOVE PC-BUYER-ANALYST-DC TO ASC-RA-DC                    25680000
256900         SET ASC-ALL-NOTIF-STATS                                  25690000
257000             ASC-RCVR-STAT-ARR-ENR                                25700000
257100             ASC-LS-ARRIVAL     TO TRUE                           25710000
257200             MOVE +999              TO ASC-TRBL-REASON-HIGH       25720000
257300             MOVE +0000             TO ASC-KEY-OPER-UNT-ID        25730000
257400                                       ASC-SAVE-OPER-UNT-ID       25740000
257500     ELSE                                                         25750000
257600         MOVE +1                    TO ASC-BLK-SUB                25760000
257700                                       ASC-SEL-SUB                25770000
257800                                       ASC-SEL-ITEM               25780000
257900*        --- TOP OF LIST ---                                      25790000
258000         MOVE PC-TSYMSG-00069       TO DP020-MSG-NUMBER           25800000
258100         SET DP020-MSG-INFORMATIONAL                              25810000
258200                 PS-LIST-END        TO TRUE                       25820000
258300     END-IF.                                                      25830000
258400                                                                  25840000
258500*----------------------------------------------------------------*25850000
258600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *25860000
258700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *25870000
258800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *25880000
258900*    MESSAGE.                                                    *25890000
259000*----------------------------------------------------------------*25900000
259100 2110-BROWSE-BACKWARD.                                            25910000
259200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    25920000
259300         GIVING PV-TOP-ITEM.                                      25930000
259400                                                                  25940000
259500     IF  ((PV-TOP-ITEM < +1)                                      25950000
259600       OR (PV-TOP-ITEM = +1))                                     25960000
259700         MOVE +1                   TO PV-TOP-ITEM                 25970000
259800*        -- TOP OF LIST --                                        25980000
259900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            25990000
260000         SET DP020-MSG-INFORMATIONAL TO TRUE                      26000000
260100     END-IF.                                                      26010000
260200                                                                  26020000
260300*----------------------------------------------------------------*26030000
260400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *26040000
260500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *26050000
260600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *26060000
260700*----------------------------------------------------------------*26070000
260800 2120-BROWSE-FORWARD.                                             26080000
260900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              26090000
261000         GIVING PV-TOP-ITEM.                                      26100000
261100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   26110000
261200         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             26120000
261300*        -- BOTTOM OF LIST --                                     26130000
261400         MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER          26140000
261500         SET DP020-MSG-INFORMATIONAL TO TRUE                      26150000
261600     ELSE                                                         26160000
261700         COMPUTE PV-BOTTOM-ITEM =                                 26170000
261800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 26180000
261900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            26190000
262000*            -- BOTTOM OF LIST --                                 26200000
262100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            26210000
262200             SET DP020-MSG-INFORMATIONAL TO TRUE                  26220000
262300         END-IF                                                   26230000
262400     END-IF.                                                      26240000
262500                                                                  26250000
262600*----------------------------------------------------------------*26260000
262700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *26270000
262800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *26280000
262900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *26290000
263000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *26300000
263100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *26310000
263200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *26320000
263300*----------------------------------------------------------------*26330000
263400 2130-CHECK-FOR-JUMP-BROWSE.                                      26340000
263500     SET PS-NO-ERROR               TO TRUE.                       26350000
263600     IF (ASC-START-ITEM-REQUEST = SPACE)                          26360000
263700         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             26370000
263800     ELSE                                                         26380000
263900         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     26390000
264000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       26400000
264100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     26410000
264200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  26420000
264320         CALL DP010I-NUMERIC-EDIT-ROUTINE                         26432017
264330              USING DP010I-NUMERIC-EDIT-AREA                      26433017
264400                                                                  26440000
264500         IF  NOT DP010I-ERROR-DETECTED                            26450000
264600             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N26460000
264700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  26470000
264800                 IF  ASC-START-ITEM-REQUEST-N >                   26480000
264900                                          ASC-NUMBER-OF-ITEMS-READ26490000
265000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         26500000
265100                     COMPUTE PV-TOP-ITEM =                        26510000
265200                             ASC-NUMBER-OF-ITEMS-READ             26520000
265300                             - PC-ITEMS-PER-PANEL + 1             26530000
265400                     IF  PV-TOP-ITEM < +1                         26540000
265500                         MOVE +1   TO PV-TOP-ITEM                 26550000
265600                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 26560000
265700                         SET DP020-MSG-INFORMATIONAL TO TRUE      26570000
265800                     END-IF                                       26580000
265900                 ELSE                                             26590000
266000                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 26600000
266100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      26610000
266200                     COMPUTE PV-BOTTOM-ITEM =                     26620000
266300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     26630000
266400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ26640000
266500*                        -- BOTTOM OF LIST --                     26650000
266600                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 26660000
266700                         SET DP020-MSG-INFORMATIONAL TO TRUE      26670000
266800                     END-IF                                       26680000
266900                 END-IF                                           26690000
267000             ELSE                                                 26700000
267100*                --- VALUE OUT OF RANGE ----                      26710000
267200                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         26720000
267300                 MOVE -1           TO ASTRTITL                    26730000
267400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              26740000
267500                 MOVE DP015-REVERSE TO ASTRTITH                   26750000
267600                 MOVE DP015-RED    TO ASTRTITC                    26760000
267700                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           26770000
267800                 SET DP020-MSG-FATAL TO TRUE                      26780000
267900                 SET PS-ERROR      TO TRUE                        26790000
268000             END-IF                                               26800000
268100         ELSE                                                     26810000
268200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            26820000
268300             MOVE -1               TO ASTRTITL                    26830000
268400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  26840000
268500             MOVE DP015-REVERSE    TO ASTRTITH                    26850000
268600             MOVE DP015-RED        TO ASTRTITC                    26860000
268700             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               26870000
268800             SET DP020-MSG-FATAL   TO TRUE                        26880000
268900             SET PS-ERROR          TO TRUE                        26890000
269000         END-IF                                                   26900000
269100     END-IF.                                                      26910000
269200                                                                  26920000
269300*----------------------------------------------------------------*26930000
269400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *26940000
269500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *26950000
269600*----------------------------------------------------------------*26960000
269700 2140-DESELECT-ALL-ITEMS.                                         26970000
269800     MOVE +1                       TO ASC-BLK-SUB.                26980000
269900                                                                  26990000
270000     PERFORM 2141-CLEAR-SELECTED-INDS                             27000000
270100         VARYING ASC-ITEM-SUB                                     27010000
270200         FROM 1 BY 1                                              27020000
270300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27030000
270400                                                                  27040000
270500     ADD +1                        TO ASC-BLK-SUB.                27050000
270600                                                                  27060000
270700     PERFORM 2141-CLEAR-SELECTED-INDS                             27070000
270800         VARYING ASC-ITEM-SUB                                     27080000
270900         FROM 1 BY 1                                              27090000
271000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27100000
271100                                                                  27110000
271200     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       27120000
271300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            27130000
271400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27140000
271500                                                                  27150000
271600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     27160000
271700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      27170000
271800         MOVE +1                   TO ASC-BLK-SUB                 27180000
271900         PERFORM 5100-WRITE-TEMP-STORAGE                          27190000
272000         MOVE +1                   TO PV-BLOCK-NUMBER             27200000
272100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         27210000
272200             PV-FIRST-BLOCK-IN-ARRAY - 1                          27220000
272300         PERFORM                                                  27230000
272400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       27240000
272500                                                                  27250000
272600             PERFORM 4410-READ-TEMP-STORAGE                       27260000
272700             PERFORM 2141-CLEAR-SELECTED-INDS                     27270000
272800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 27280000
272900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27290000
273000             PERFORM 5100-WRITE-TEMP-STORAGE                      27300000
273100             ADD +1                TO PV-BLOCK-NUMBER             27310000
273200         END-PERFORM                                              27320000
273300                                                                  27330000
273400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         27340000
273500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     27350000
273600                                                                  27360000
273700         PERFORM                                                  27370000
273800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       27380000
273900                   ASC-HIGHEST-BLOCK-WRITTEN                      27390000
274000             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       27400000
274100             PERFORM 4410-READ-TEMP-STORAGE                       27410000
274200             PERFORM 2141-CLEAR-SELECTED-INDS                     27420000
274300                 VARYING ASC-ITEM-SUB                             27430000
274400                 FROM 1 BY 1                                      27440000
274500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27450000
274600             PERFORM 5100-WRITE-TEMP-STORAGE                      27460000
274700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      27470000
274800         END-PERFORM                                              27480000
274900                                                                  27490000
275000         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          27500000
275100         PERFORM 4410-READ-TEMP-STORAGE                           27510000
275200     END-IF.                                                      27520000
275300                                                                  27530000
275400     MOVE +0           TO ASC-NUMBER-OF-SELECTED-ITEMS.           27540000
275500     MOVE +0           TO ASC-START-OF-SELECTED-RANGE.            27550000
275600     MOVE +0           TO ASC-END-OF-SELECTED-RANGE.              27560000
275700                                                                  27570000
275800*----------------------------------------------------------------*27580000
275900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *27590000
276000*----------------------------------------------------------------*27600000
276100 2141-CLEAR-SELECTED-INDS.                                        27610000
276200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           27620000
276300             NOT EQUAL ZERO                                       27630000
276400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27640000
276500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27650000
276600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    27660000
276700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          27670000
276800         END-IF                                                   27680000
276900     END-IF.                                                      27690000
277000                                                                  27700000
277100*----------------------------------------------------------------*27710000
277200*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *27720000
277300*  FOR ALL ITEMS.                                                *27730000
277400*----------------------------------------------------------------*27740000
277500 2150-SELECT-ALL-ITEMS.                                           27750000
277600     MOVE +1                       TO ASC-BLK-SUB.                27760000
277700                                                                  27770000
277800     PERFORM 2151-SET-SELECTED-INDS                               27780000
277900         VARYING ASC-ITEM-SUB                                     27790000
278000         FROM 1 BY 1                                              27800000
278100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27810000
278200                                                                  27820000
278300     ADD +1                        TO ASC-BLK-SUB.                27830000
278400                                                                  27840000
278500     PERFORM 2151-SET-SELECTED-INDS                               27850000
278600         VARYING ASC-ITEM-SUB                                     27860000
278700         FROM 1 BY 1                                              27870000
278800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27880000
278900                                                                  27890000
279000     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       27900000
279100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            27910000
279200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27920000
279300                                                                  27930000
279400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     27940000
279500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    27950000
279600         MOVE +1                   TO ASC-BLK-SUB                 27960000
279700         PERFORM 5100-WRITE-TEMP-STORAGE                          27970000
279800         MOVE +1                   TO PV-BLOCK-NUMBER             27980000
279900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         27990000
280000             PV-FIRST-BLOCK-IN-ARRAY - 1                          28000000
280100                                                                  28010000
280200         PERFORM                                                  28020000
280300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       28030000
280400             PERFORM 4410-READ-TEMP-STORAGE                       28040000
280500             PERFORM 2151-SET-SELECTED-INDS                       28050000
280600                 VARYING ASC-ITEM-SUB                             28060000
280700                 FROM 1 BY 1                                      28070000
280800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          28080000
280900             PERFORM 5100-WRITE-TEMP-STORAGE                      28090000
281000             ADD +1                TO PV-BLOCK-NUMBER             28100000
281100         END-PERFORM                                              28110000
281200                                                                  28120000
281300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         28130000
281400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     28140000
281500                                                                  28150000
281600         PERFORM                                                  28160000
281700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       28170000
281800                   ASC-HIGHEST-BLOCK-WRITTEN                      28180000
281900             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       28190000
282000             PERFORM 4410-READ-TEMP-STORAGE                       28200000
282100             PERFORM 2151-SET-SELECTED-INDS                       28210000
282200                 VARYING ASC-ITEM-SUB                             28220000
282300                 FROM 1 BY 1                                      28230000
282400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          28240000
282500             PERFORM 5100-WRITE-TEMP-STORAGE                      28250000
282600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      28260000
282700         END-PERFORM                                              28270000
282800                                                                  28280000
282900         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          28290000
283000         PERFORM 4410-READ-TEMP-STORAGE                           28300000
283100     END-IF.                                                      28310000
283200                                                                  28320000
283300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             28330000
283400                       ASC-NUMBER-OF-SELECTED-ITEMS.              28340000
283500                                                                  28350000
283600*----------------------------------------------------------------*28360000
283700*    MARK EACH ITEM AS BEING SELECTED.                           *28370000
283800*----------------------------------------------------------------*28380000
283900 2151-SET-SELECTED-INDS.                                          28390000
284000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           28400000
284100             NOT EQUAL ZERO                                       28410000
284200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             28420000
284300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             28430000
284400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        28440000
284500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          28450000
284600         END-IF                                                   28460000
284700     END-IF.                                                      28470000
284800                                                                  28480000
284900******************************************************************28490000
285000 2160-CHECK-TRECEIV-PKGNG-CDE.                                    28500000
285100                                                                  28510000
285200     INITIALIZE DCLTRECEIV.                                       28520000
285300                                                                  28530000
285400     MOVE ASC-KEY-PO-NBR TO DK-PO-NBR.                            28540000
285500                                                                  28550000
285600*USE 'LINE' REC-SEQ-NBR!!!                                        28560000
285700     MOVE ZEROES TO DK-REC-SEQ-NBR.                               28570000
285800     PERFORM 2165-SET-REC-SEQ-NBR.                                28580000
285900                                                                  28590000
286000     IF DK-REC-SEQ-NBR NOT > ZERO                                 28600000
286100         SET DP030-OVERRIDE-GO   TO TRUE                          28610000
286200         SET DP020-MSG-FATAL     TO TRUE                          28620000
286300         SET PS-PREPACK-RCVR-YES TO TRUE                          28630000
286400         MOVE PC-TSYMSG-02192    TO DP020-MSG-NUMBER              28640000
286500     ELSE                                                         28650000
286600*        PERFORM 2161-SELECT-RECEIV-PKGNG-CDE                     28660000
286700         CONTINUE                                                 28670000
286800     END-IF.                                                      28680000
286900                                                                  28690000
287000******************************************************************28700000
287100 2161-SELECT-RECEIV-PKGNG-CDE.                                    28710000
287200                                                                  28720000
287300     EXEC SQL                                                     28730000
287400         SELECT PKGNG_CDE                                         28740000
287500           INTO :RECEIV-PKGNG-CDE                                 28750000
287600           FROM TRECEIV                                           28760000
287700          WHERE ORD_NBR        = :DK-PO-NBR                       28770000
287800            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  28780000
287900     END-EXEC.                                                    28790000
288000                                                                  28800000
288100     EVALUATE TRUE                                                28810000
288200       WHEN SQLCODE = ZERO                                        28820000
288300           CONTINUE                                               28830000
288400                                                                  28840000
288500       WHEN SQLWARN0 NOT = SPACE                                  28850000
288600       WHEN SQLCODE  NOT = ZERO                                   28860000
288700           MOVE '2161-SELECT-RECEIV-PKGNG-CDE' TO DP013-PARAGRAPH 28870000
288800           MOVE 'SELECT TRECEIV' TO DP013-MESSAGE-TEXT (1)        28880000
288900                                                                  28890000
289000           MOVE DK-PO-NBR        TO PV-ERROR-PO-NBR               28900000
289100           MOVE DK-REC-SEQ-NBR   TO PV-ERROR-REC-SEQ-NBR          28910000
289200           STRING ' RCVR: '            DELIMITED BY SIZE          28920000
289300                  PV-ERROR-PO-NBR      DELIMITED BY SIZE          28930000
289400                  '-'                  DELIMITED BY SIZE          28940000
289500                  PV-ERROR-REC-SEQ-NBR DELIMITED BY SIZE          28950000
289600                               INTO DP013-MESSAGE-TEXT (2)        28960000
289700           MOVE SQLCA            TO DP013-SQLCA                   28970000
289800           MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (1)      28980000
289900           SET DP013-DB2-ABEND   TO TRUE                          28990000
290000           PERFORM DP013-0000-PROCESS-ABEND                       29000000
290100     END-EVALUATE.                                                29010000
290200                                                                  29020000
290300******************************************************************29030000
290400 2165-SET-REC-SEQ-NBR.                                            29040000
290500                                                                  29050000
290600     IF DK-REC-SEQ-NBR NOT > ZERO                                 29060000
290700         MOVE +1 TO ASC-BLK-SUB                                   29070000
290800         PERFORM 2166-CHECK-SELECTED                              29080000
290900           VARYING ASC-ITEM-SUB FROM 1 BY 1                       29090000
291000             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              29100000
291100     END-IF.                                                      29110000
291200                                                                  29120000
291300     IF DK-REC-SEQ-NBR NOT > ZERO                                 29130000
291400         ADD +1 TO ASC-BLK-SUB                                    29140000
291500         PERFORM 2166-CHECK-SELECTED                              29150000
291600           VARYING ASC-ITEM-SUB FROM 1 BY 1                       29160000
291700             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              29170000
291800     END-IF.                                                      29180000
291900                                                                  29190000
292000     IF DK-REC-SEQ-NBR NOT > ZERO                                 29200000
292100         MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER    29210000
292200         COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1                      29220000
292300                                    + ((PV-LIST-ITEM-NUMBER - 1)  29230000
292400                                    / PC-ITEMS-PER-PANEL)         29240000
292500                                                                  29250000
292600         IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1)                    29260000
292700           OR (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)29270000
292800             MOVE +1 TO ASC-BLK-SUB                               29280000
292900             PERFORM 5100-WRITE-TEMP-STORAGE                      29290000
293000             MOVE +1 TO PV-BLOCK-NUMBER                           29300000
293100             COMPUTE PV-PREV-BLOCK-IN-ARRAY =                     29310000
293200                                  PV-FIRST-BLOCK-IN-ARRAY - 1     29320000
293300                                                                  29330000
293400             PERFORM                                              29340000
293500               UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY     29350000
293600                  OR DK-REC-SEQ-NBR > ZERO                        29360000
293700                                                                  29370000
293800                 PERFORM 4410-READ-TEMP-STORAGE                   29380000
293900                 PERFORM 2166-CHECK-SELECTED                      29390000
294000                   VARYING ASC-ITEM-SUB FROM 1 BY 1               29400000
294100                     UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL      29410000
294200                 PERFORM 5100-WRITE-TEMP-STORAGE                  29420000
294300                 ADD +1 TO PV-BLOCK-NUMBER                        29430000
294400             END-PERFORM                                          29440000
294500                                                                  29450000
294600             COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                     29460000
294700                 PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY 29470000
294800                                                                  29480000
294900             PERFORM                                              29490000
295000               UNTIL PV-NEXT-BLOCK-IN-ARRAY >                     29500000
295100                     ASC-HIGHEST-BLOCK-WRITTEN                    29510000
295200                  OR DK-REC-SEQ-NBR > ZERO                        29520000
295300                                                                  29530000
295400                 MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER   29540000
295500                 PERFORM 4410-READ-TEMP-STORAGE                   29550000
295600                 PERFORM 2166-CHECK-SELECTED                      29560000
295700                   VARYING ASC-ITEM-SUB FROM 1 BY 1               29570000
295800                     UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL      29580000
295900                 PERFORM 5100-WRITE-TEMP-STORAGE                  29590000
296000                 ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                 29600000
296100             END-PERFORM                                          29610000
296200                                                                  29620000
296300             MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      29630000
296400             PERFORM 4410-READ-TEMP-STORAGE                       29640000
296500         END-IF                                                   29650000
296600     END-IF.                                                      29660000
296700                                                                  29670000
296800*----------------------------------------------------------------*29680000
296900*    IF ITEM SELECTED, USE REC-SEQ-NBR.                          *29690000
297000*----------------------------------------------------------------*29700000
297100 2166-CHECK-SELECTED.                                             29710000
297200     IF ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)                      29720000
297300         MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)       29730000
297400           TO DK-REC-SEQ-NBR                                      29740000
297500     END-IF.                                                      29750000
297600                                                                  29760000
297700******************************************************************29770000
297800** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **29780000
297900** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **29790000
298000******************************************************************29800000
298100 2200-MOVE-SCREEN-TO-COMMAREA.                                    29810000
298200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             29820000
298300     MOVE +1                       TO PV-SUB.                     29830000
298400                                                                  29840000
298500     PERFORM 3100-SET-SUBSCRIPTS.                                 29850000
298600     IF  ASTRTITL > ZERO                                          29860000
298700         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          29870000
298800     ELSE                                                         29880000
298900         IF  ASTRTITF = DP015-ERASE-EOF                           29890000
299000             INITIALIZE ASC-START-ITEM-REQUEST                    29900000
299100         END-IF                                                   29910000
299200     END-IF.                                                      29920000
299300     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          29930000
299400         VARYING PV-SUB                                           29940000
299500         FROM 1 BY 1                                              29950000
299600         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      29960000
299700                                                                  29970000
299800******************************************************************29980000
299900** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**29990000
300000******************************************************************30000000
300100 2210-MOVE-LINES-TO-COMMAREA.                                     30010000
300200     IF  MR-SELECTL (PV-SUB) > ZERO                               30020000
300300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             30030000
300400         MOVE MR-SELECTI (PV-SUB) TO ASC-TEMP-SELECTED-SW         30040000
300500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      30050000
300600     ELSE                                                         30060000
300700         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                30070000
300800             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         30080000
300900             MOVE SPACE        TO ASC-TEMP-SELECTED-SW            30090000
301000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      30100000
301100         END-IF                                                   30110000
301200     END-IF.                                                      30120000
301300     ADD +1                    TO ASC-ITEM-SUB.                   30130000
301400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30140000
301500         ADD +1                TO ASC-BLK-SUB                     30150000
301600         MOVE +1               TO ASC-ITEM-SUB                    30160000
301700     END-IF.                                                      30170000
301800                                                                  30180000
301900                                                                  30190000
302000******************************************************************30200000
302100** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **30210000
302200** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **30220000
302300******************************************************************30230000
302400 3000-EDIT-DATA-IN-COMMAREA.                                      30240000
302500     SET PS-NO-ERROR               TO TRUE.                       30250000
302600     PERFORM 3200-RESET-ATTRIBUTES.                               30260000
302700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     30270000
302800**                                                                30280000
302900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              30290000
303000* EDITTING IS DONE FROM THE BOTTOM UP.                            30300000
303100**                                                                30310000
303200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       30320000
303300         ASC-ITEMS-DISPLAYED - 1.                                 30330000
303400     PERFORM 3100-SET-SUBSCRIPTS.                                 30340000
303500     PERFORM 3300-EDIT-SELECTIONS                                 30350000
303600         VARYING PV-SUB                                           30360000
303700         FROM PV-SUB BY -1                                        30370000
303800         UNTIL PV-SUB < +1                                        30380000
303900                                                                  30390000
304000     IF  PS-NO-ERROR                                              30400000
304100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        30410000
304200     END-IF.                                                      30420000
304300                                                                  30430000
304400     IF  ((PS-NO-ERROR)                                           30440000
304500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   30450000
304600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    30460000
304700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  30470000
304800     END-IF.                                                      30480000
304900                                                                  30490000
305000*----------------------------------------------------------------*30500000
305100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *30510000
305200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*30520000
305300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *30530000
305400*                                                                *30540000
305500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *30550000
305600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *30560000
305700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *30570000
305800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *30580000
305900*----------------------------------------------------------------*30590000
306000 3100-SET-SUBSCRIPTS.                                             30600000
306100     COMPUTE PV-ASC-ITEM-SUB-COMP3 =                              30610000
306200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        30620000
306300     MOVE PV-ASC-ITEM-SUB-COMP3 TO ASC-ITEM-SUB                   30630000
306400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         30640000
306500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30650000
306600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               30660000
306700     ELSE                                                         30670000
306800         MOVE +1                     TO ASC-BLK-SUB               30680000
306900     END-IF.                                                      30690000
307000                                                                  30700000
307100******************************************************************30710000
307200** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **30720000
307300******************************************************************30730000
307400 3200-RESET-ATTRIBUTES.                                           30740000
307500     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   30750000
307600     MOVE DP015-GREEN              TO ASTRTITC.                   30760000
307700     MOVE DP015-UNDERLINE          TO ASTRTITH.                   30770000
307800                                                                  30780000
307900     PERFORM                                                      30790000
308000         VARYING PV-SUB                                           30800000
308100          FROM 1 BY 1                                             30810000
308200         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        30820000
308300         MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)        30830000
308400         MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)        30840000
308500         MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)        30850000
308600     END-PERFORM.                                                 30860000
308700                                                                  30870000
308800                                                                  30880000
308900******************************************************************30890000
309000** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **30900000
309100** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **30910000
309200** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **30920000
309300** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **30930000
309400******************************************************************30940000
309500 3300-EDIT-SELECTIONS.                                            30950000
309600     EVALUATE TRUE                                                30960000
309700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     30970000
309800             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         30980000
309900                 CONTINUE                                         30990000
310000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         31000000
310100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        31010000
310200                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   31020000
310300                 MOVE ASC-TEMP-SELECTED-SW                        31030000
310400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31040000
310500                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  31050000
310600             END-IF                                               31060000
310700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     31070000
310800                 = SPACE                                          31080000
310900             EVALUATE TRUE                                        31090000
311000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       31100000
311100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS31110000
311200                     MOVE SPACE TO ASC-SELECTED-SW                31120000
311300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31130000
311400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        31140000
311500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    31150000
311600                     MOVE SPACE TO ASC-SELECTED-SW                31160000
311700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31170000
311800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          31180000
311900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      31190000
312000                     MOVE SPACE TO ASC-SELECTED-SW                31200000
312100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31210000
312200             END-EVALUATE                                         31220000
312300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           31230000
312400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            31240000
312500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    31250000
312600             END-IF                                               31260000
312700             PERFORM 3310-EDIT-RANGE                              31270000
312800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             31280000
312900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            31290000
313000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    31300000
313100             END-IF                                               31310000
313200             PERFORM 3310-EDIT-RANGE                              31320000
313300         WHEN OTHER                                               31330000
313400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           31340000
313500             SET DP020-MSG-FATAL    TO TRUE                       31350000
313600             MOVE -1                TO MR-SELECTL (PV-SUB)        31360000
313700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  31370000
313800             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        31380000
313900             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        31390000
314000             SET PS-ERROR TO TRUE                                 31400000
314100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            31410000
314200                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     31420000
314300                 MOVE SPACE         TO ASC-SELECTED-SW            31430000
314400                                        (ASC-BLK-SUB ASC-ITEM-SUB)31440000
314500             END-IF                                               31450000
314600     END-EVALUATE.                                                31460000
314700                                                                  31470000
314800     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 31480000
314900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               31490000
315000     IF  ASC-BLK-SUB = 2                                          31500000
315100        IF ASC-ITEM-SUB < 1                                       31510000
315200            SUBTRACT +1 FROM ASC-BLK-SUB                          31520000
315300            MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB             31530000
315400         END-IF                                                   31540000
315500     END-IF.                                                      31550000
315600                                                                  31560000
315700******************************************************************31570000
315800** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **31580000
315900** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **31590000
316000** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**31600000
316100** THE ENDING.                                                  **31610000
316200******************************************************************31620000
316300 3310-EDIT-RANGE.                                                 31630000
316400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                31640000
316500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   31650000
316600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)31660000
316700                                   TO ASC-SELECTED-SW             31670000
316800                                        (ASC-BLK-SUB ASC-ITEM-SUB)31680000
316900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 31690000
317000         ELSE                                                     31700000
317100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     31710000
317200                 CONTINUE                                         31720000
317300             ELSE                                                 31730000
317400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        31740000
317500                 MOVE PC-TSYMSG-00054 TO DP020-MSG-NUMBER         31750000
317600                 SET DP020-MSG-FATAL TO TRUE                      31760000
317700                 MOVE -1           TO MR-SELECTL (PV-SUB)         31770000
317800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              31780000
317900                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         31790000
318000                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      31800000
318100                 SET PS-ERROR      TO TRUE                        31810000
318200             END-IF                                               31820000
318300         END-IF                                                   31830000
318400     ELSE                                                         31840000
318500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     31850000
318600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 31860000
318700                  TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)   31870000
318800             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   31880000
318900         ELSE                                                     31890000
319000             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       31900000
319100                 CONTINUE                                         31910000
319200             ELSE                                                 31920000
319300*                -- ONLY ONE END-OF-RANGE ALLOWED --              31930000
319400                 MOVE PC-TSYMSG-00055 TO DP020-MSG-NUMBER         31940000
319500                 SET DP020-MSG-FATAL TO TRUE                      31950000
319600                 MOVE -1           TO MR-SELECTL (PV-SUB)         31960000
319700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              31970000
319800                 SET PS-ERROR      TO TRUE                        31980000
319900             END-IF                                               31990000
320000         END-IF                                                   32000000
320100     END-IF.                                                      32010000
320200                                                                  32020000
320300******************************************************************32030000
320400** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **32040000
320500** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **32050000
320600******************************************************************32060000
320700 3400-CHECK-RANGE-SEQUENCE.                                       32070000
320800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       32080000
320900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      32090000
321000       AND  ASC-START-OF-SELECTED-RANGE >                         32100000
321100                                    ASC-END-OF-SELECTED-RANGE     32110000
321200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                32120000
321300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 32130000
321400         SET DP020-MSG-FATAL TO TRUE                              32140000
321500         SET PS-ERROR TO TRUE                                     32150000
321600         PERFORM 3410-POSITION-AT-ERROR                           32160000
321700     END-IF.                                                      32170000
321800                                                                  32180000
321900******************************************************************32190000
322000** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **32200000
322100** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **32210000
322200** SHOULD BE POSITIONED ON A RANGE ERROR.                       **32220000
322300******************************************************************32230000
322400 3410-POSITION-AT-ERROR.                                          32240000
322500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         32250000
322600     COMPUTE PV-SUB-COMP3 = ASC-START-OF-SELECTED-RANGE           32260000
322700                    - PV-TOP-ITEM + 1.                            32270000
322800     MOVE PV-SUB-COMP3 TO PV-SUB.                                 32280000
322900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32290000
323000         CONTINUE                                                 32300000
323100     ELSE                                                         32310000
323200         MOVE -1                   TO MR-SELECTL (PV-SUB)         32320000
323300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         32330000
323400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         32340000
323500     END-IF.                                                      32350000
323600                                                                  32360000
323700     COMPUTE PV-SUB-COMP3 = ASC-END-OF-SELECTED-RANGE             32370000
323800                    - PV-TOP-ITEM + 1.                            32380000
323900     MOVE PV-SUB-COMP3 TO PV-SUB.                                 32390000
324000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32400000
324100         CONTINUE                                                 32410000
324200     ELSE                                                         32420000
324300         MOVE -1                   TO MR-SELECTL (PV-SUB)         32430000
324400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         32440000
324500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         32450000
324600     END-IF.                                                      32460000
324700                                                                  32470000
324800*----------------------------------------------------------------*32480000
324900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *32490000
325000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *32500000
325100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *32510000
325200*----------------------------------------------------------------*32520000
325300 3500-MARK-RANGE-AS-SELECTED.                                     32530000
325400     MOVE +1                       TO  ASC-BLK-SUB.               32540000
325500     PERFORM 3510-MARK-SELECTED-INDS                              32550000
325600         VARYING ASC-ITEM-SUB                                     32560000
325700         FROM 1 BY 1                                              32570000
325800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 32580000
325900                                                                  32590000
326000     ADD +1                        TO ASC-BLK-SUB.                32600000
326100     PERFORM 3510-MARK-SELECTED-INDS                              32610000
326200         VARYING ASC-ITEM-SUB                                     32620000
326300         FROM 1 BY 1                                              32630000
326400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 32640000
326500                                                                  32650000
326600     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       32660000
326700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            32670000
326800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         32680000
326900               PC-ITEMS-PER-PANEL).                               32690000
327000                                                                  32700000
327100     MOVE ASC-START-OF-SELECTED-RANGE                             32710000
327200                                   TO PV-START-OF-SELECTED-RANGE. 32720000
327300     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        32730000
327400          ((PV-START-OF-SELECTED-RANGE - 1) / PC-ITEMS-PER-PANEL).32740000
327500                                                                  32750000
327600     MOVE ASC-END-OF-SELECTED-RANGE TO  PV-END-OF-SELECTED-RANGE. 32760000
327700     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         32770000
327800         ((PV-END-OF-SELECTED-RANGE - 1) / PC-ITEMS-PER-PANEL).   32780000
327900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             32790000
328000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             32800000
328100                                                                  32810000
328200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    32820000
328300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        32830000
328400         MOVE +1                   TO ASC-BLK-SUB                 32840000
328500         PERFORM 5100-WRITE-TEMP-STORAGE                          32850000
328600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         32860000
328700             PV-FIRST-BLOCK-IN-ARRAY - 1                          32870000
328800                                                                  32880000
328900         PERFORM                                                  32890000
329000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      32900000
329100                   PV-PREV-BLOCK-IN-ARRAY                         32910000
329200             MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER      32920000
329300             PERFORM 4410-READ-TEMP-STORAGE                       32930000
329400             PERFORM 3510-MARK-SELECTED-INDS                      32940000
329500                 VARYING ASC-ITEM-SUB                             32950000
329600                 FROM 1 BY 1                                      32960000
329700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          32970000
329800             PERFORM 5100-WRITE-TEMP-STORAGE                      32980000
329900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     32990000
330000         END-PERFORM                                              33000000
330100                                                                  33010000
330200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         33020000
330300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     33030000
330400         PERFORM                                                  33040000
330500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       33050000
330600                   PV-LAST-BLOCK-IN-RANGE                         33060000
330700             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       33070000
330800             PERFORM 4410-READ-TEMP-STORAGE                       33080000
330900             PERFORM 3510-MARK-SELECTED-INDS                      33090000
331000                 VARYING ASC-ITEM-SUB                             33100000
331100                 FROM 1 BY 1                                      33110000
331200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          33120000
331300             PERFORM 5100-WRITE-TEMP-STORAGE                      33130000
331400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      33140000
331500         END-PERFORM                                              33150000
331600                                                                  33160000
331700         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          33170000
331800         PERFORM 4410-READ-TEMP-STORAGE                           33180000
331900     END-IF.                                                      33190000
332000                                                                  33200000
332100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 33210000
332200                                      ASC-END-OF-SELECTED-RANGE.  33220000
332300                                                                  33230000
332400*----------------------------------------------------------------*33240000
332500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *33250000
332600*----------------------------------------------------------------*33260000
332700 3510-MARK-SELECTED-INDS.                                         33270000
332800     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         33280000
332900         ASC-START-OF-SELECTED-RANGE)                             33290000
333000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         33300000
333100         ASC-START-OF-SELECTED-RANGE)                             33310000
333200                                                                  33320000
333300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     33330000
333400             ASC-END-OF-SELECTED-RANGE)                           33340000
333500         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     33350000
333600             ASC-END-OF-SELECTED-RANGE)                           33360000
333700                                                                  33370000
333800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          33380000
333900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   33390000
334000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   33400000
334100                     ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE      33410000
334200                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    33420000
334300             END-IF                                               33430000
334400         END-IF                                                   33440000
334500     END-IF.                                                      33450000
334600                                                                  33460000
334700*----------------------------------------------------------------*33470000
334800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *33480000
334900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *33490000
335000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *33500000
335100*    DISPLAY THE PANEL TO USER.                                  *33510000
335200*----------------------------------------------------------------*33520000
335300 4000-BUILD-INITIAL-PANEL.                                        33530000
335400     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             33540000
335500                                ASC-BLOCK-ENTRIES (2).            33550000
335600     MOVE +1                 TO ASC-BLK-SUB.                      33560000
335700     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            33570000
335800                                                                  33580000
335900     MOVE +0                 TO ASC-ITEM-SUB                      33590000
336000                                ASC-NUMBER-OF-ITEMS-READ          33600000
336100                                ASC-NUMBER-OF-SELECTED-ITEMS      33610000
336200                                ASC-HIGHEST-BLOCK-WRITTEN         33620000
336300                                ASC-START-OF-SELECTED-RANGE       33630000
336400                                ASC-END-OF-SELECTED-RANGE         33640000
336500                                ASC-ITEM-AT-TOP-OF-PANEL.         33650000
336600     PERFORM 4100-PREPARE-CURSOR.                                 33660000
336700                                                                  33670000
336800**** BASED ON THE SELECTED LIST SEQUENCE OPEN APPROPRIATE CSR     33680000
336900**** EITHER ARRIVAL DATE SEQ. OR OLDEST TO NEWEST TRBL SEQ.       33690000
337000     EVALUATE TRUE                                                33700000
337100**** LIST SEQUENCE BY ARRIVAL DATE                                33710000
337200         WHEN PS-USE-OPER-UNT-ARR-CSR                             33720000
337300             PERFORM 4005-OPEN-OPER-UNIT-ARR-CSR                  33730000
337400             IF SQLCODE           = -913                          33740000
337500                 PERFORM 9910-SQL-913-RETURN                      33750000
337600             END-IF                                               33760000
337610         WHEN PS-USE-OPER-UNT-ARR-INCL-CSR                        33761031
337620             PERFORM 4005-OPEN-OPER-UNIT-ARR-INCL                 33762034
337630             IF SQLCODE           = -913                          33763031
337640                 PERFORM 9910-SQL-913-RETURN                      33764031
337650             END-IF                                               33765031
337660         WHEN PS-USE-OPER-UNT-ARR-EXCL-CSR                        33766031
337670             PERFORM 4005-OPEN-OPER-UNIT-ARR-EXCL                 33767034
337680             IF SQLCODE           = -913                          33768031
337690                 PERFORM 9910-SQL-913-RETURN                      33769031
337691             END-IF                                               33769131
337700         WHEN PS-USE-DEPT-ARR-CSR                                 33770000
337800             PERFORM 4010-OPEN-DEPT-ARR-CSR                       33780000
337900             IF SQLCODE           = -913                          33790000
338000                 PERFORM 9910-SQL-913-RETURN                      33800000
338100             END-IF                                               33810000
338110         WHEN PS-USE-DEPT-ARR-INCL-CSR                            33811031
338120             PERFORM 4010-OPEN-DEPT-ARR-INCL-CSR                  33812031
338130             IF SQLCODE           = -913                          33813031
338140                 PERFORM 9910-SQL-913-RETURN                      33814031
338150             END-IF                                               33815031
338160         WHEN PS-USE-DEPT-ARR-EXCL-CSR                            33816031
338170             PERFORM 4010-OPEN-DEPT-ARR-EXCL-CSR                  33817031
338180             IF SQLCODE           = -913                          33818031
338190                 PERFORM 9910-SQL-913-RETURN                      33819031
338191             END-IF                                               33819131
338200         WHEN PS-USE-BYR-ARR-CSR                                  33820000
338300             PERFORM 4015-OPEN-BYR-ARR-CSR                        33830000
338400             IF SQLCODE           = -913                          33840000
338500                 PERFORM 9910-SQL-913-RETURN                      33850000
338600             END-IF                                               33860000
338610         WHEN PS-USE-BYR-ARR-INCL-CSR                             33861031
338620             PERFORM 4015-OPEN-BYR-ARR-INCL-CSR                   33862031
338630             IF SQLCODE           = -913                          33863031
338640                 PERFORM 9910-SQL-913-RETURN                      33864031
338650             END-IF                                               33865031
338660         WHEN PS-USE-BYR-ARR-EXCL-CSR                             33866031
338670             PERFORM 4015-OPEN-BYR-ARR-EXCL-CSR                   33867031
338680             IF SQLCODE           = -913                          33868031
338690                 PERFORM 9910-SQL-913-RETURN                      33869031
338691             END-IF                                               33869131
338700         WHEN PS-USE-PORCVR-ARR-CSR                               33870000
338800             PERFORM 4025-OPEN-PO-RCVR-ARR-CSR                    33880000
338900             IF SQLCODE           = -913                          33890000
339000                 PERFORM 9900-SQL-913-RETURN                      33900000
339100             END-IF                                               33910000
339110         WHEN PS-USE-PORCVR-ARR-INCL-CSR                          33911031
339120             PERFORM 4025-OPEN-PO-RCVR-ARR-INCL-CSR               33912031
339130             IF SQLCODE           = -913                          33913031
339140                 PERFORM 9900-SQL-913-RETURN                      33914031
339150             END-IF                                               33915031
339160         WHEN PS-USE-PORCVR-ARR-EXCL-CSR                          33916031
339170             PERFORM 4025-OPEN-PO-RCVR-ARR-EXCL-CSR               33917031
339180             IF SQLCODE           = -913                          33918031
339190                 PERFORM 9900-SQL-913-RETURN                      33919031
339191             END-IF                                               33919131
339200**** LIST SEQUENCE BY OLDEST TO NEWEST TROUBLE                    33920000
339300         WHEN PS-USE-OPER-UNT-TRB-CSR                             33930000
339400             PERFORM 4030-OPEN-OPER-UNIT-TRB-CSR                  33940000
339500             IF SQLCODE           = -913                          33950000
339600                 PERFORM 9910-SQL-913-RETURN                      33960000
339700             END-IF                                               33970000
339710         WHEN PS-USE-OPER-UNT-TRB-INCL-CSR                        33971031
339720             PERFORM 4030-OPEN-OPER-UNIT-TRB-INCL                 33972034
339730             IF SQLCODE           = -913                          33973031
339740                 PERFORM 9910-SQL-913-RETURN                      33974031
339750             END-IF                                               33975031
339760         WHEN PS-USE-OPER-UNT-TRB-EXCL-CSR                        33976031
339770             PERFORM 4030-OPEN-OPER-UNIT-TRB-EXCL                 33977034
339780             IF SQLCODE           = -913                          33978031
339790                 PERFORM 9910-SQL-913-RETURN                      33979031
339791             END-IF                                               33979131
339792         WHEN PS-USE-DEPT-TRB-CSR                                 33979231
339793             PERFORM 4035-OPEN-DEPT-TRB-CSR                       33979331
339794             IF SQLCODE           = -913                          33979431
339795                 PERFORM 9910-SQL-913-RETURN                      33979531
339796             END-IF                                               33979631
339797         WHEN PS-USE-DEPT-TRB-INCL-CSR                            33979731
339798             PERFORM 4035-OPEN-DEPT-TRB-INCL-CSR                  33979831
339799             IF SQLCODE           = -913                          33979931
339800                 PERFORM 9910-SQL-913-RETURN                      33980031
339801             END-IF                                               33980131
339810         WHEN PS-USE-DEPT-TRB-EXCL-CSR                            33981031
339900             PERFORM 4035-OPEN-DEPT-TRB-EXCL-CSR                  33990031
340000             IF SQLCODE           = -913                          34000000
340100                 PERFORM 9910-SQL-913-RETURN                      34010000
340200             END-IF                                               34020000
340300         WHEN PS-USE-BYR-TRB-CSR                                  34030000
340400             PERFORM 4040-OPEN-BYR-TRB-CSR                        34040000
340500             IF SQLCODE           = -913                          34050000
340600                 PERFORM 9910-SQL-913-RETURN                      34060000
340700             END-IF                                               34070000
340710         WHEN PS-USE-BYR-TRB-INCL-CSR                             34071031
340720             PERFORM 4040-OPEN-BYR-TRB-INCL-CSR                   34072031
340730             IF SQLCODE           = -913                          34073031
340740                 PERFORM 9910-SQL-913-RETURN                      34074031
340750             END-IF                                               34075031
340760         WHEN PS-USE-BYR-TRB-EXCL-CSR                             34076031
340770             PERFORM 4040-OPEN-BYR-TRB-EXCL-CSR                   34077031
340780             IF SQLCODE           = -913                          34078031
340790                 PERFORM 9910-SQL-913-RETURN                      34079031
340791             END-IF                                               34079131
340800         WHEN PS-USE-PORCVR-TRB-CSR                               34080000
340900             PERFORM 4047-OPEN-PO-RCVR-TRB-CSR                    34090000
341000             IF SQLCODE           = -913                          34100000
341100                 PERFORM 9900-SQL-913-RETURN                      34110000
341200             END-IF                                               34120000
341210         WHEN PS-USE-PORCVR-TRB-INCL-CSR                          34121031
341220             PERFORM 4047-OPEN-PO-RCVR-TRB-INCL-CSR               34122031
341230             IF SQLCODE           = -913                          34123031
341240                 PERFORM 9900-SQL-913-RETURN                      34124031
341250             END-IF                                               34125031
341260         WHEN PS-USE-PORCVR-TRB-EXCL-CSR                          34126031
341270             PERFORM 4047-OPEN-PO-RCVR-TRB-EXCL-CSR               34127031
341280             IF SQLCODE           = -913                          34128031
341290                 PERFORM 9900-SQL-913-RETURN                      34129031
341291             END-IF                                               34129131
341300     END-EVALUATE.                                                34130000
341400                                                                  34140000
341500     PERFORM 4300-READ-TROUBLE-NOTIF-FOR-PO.                      34150000
341600                                                                  34160000
341700**** BASED ON THE SELECTED LIST SEQUENCE CLOSE APPROPRIATE CSR    34170000
341800     EVALUATE TRUE                                                34180000
341900**** LIST SEQUENCE BY ARRIVAL DATE                                34190000
342000         WHEN PS-USE-OPER-UNT-ARR-CSR                             34200000
342100             PERFORM 4050-CLOSE-OPER-UNIT-ARR-CSR                 34210000
342200             IF SQLCODE           = -913                          34220000
342300                 PERFORM 9910-SQL-913-RETURN                      34230000
342400             END-IF                                               34240000
342410         WHEN PS-USE-OPER-UNT-ARR-INCL-CSR                        34241032
342420             PERFORM 4050-CLOSE-OPER-UNIT-ARR-INCL                34242034
342430             IF SQLCODE           = -913                          34243031
342440                 PERFORM 9910-SQL-913-RETURN                      34244031
342450             END-IF                                               34245031
342460         WHEN PS-USE-OPER-UNT-ARR-EXCL-CSR                        34246031
342470             PERFORM 4050-CLOSE-OPER-UNIT-ARR-EXCL                34247034
342480             IF SQLCODE           = -913                          34248031
342490                 PERFORM 9910-SQL-913-RETURN                      34249031
342491             END-IF                                               34249131
342500         WHEN PS-USE-DEPT-ARR-CSR                                 34250000
342600             PERFORM 4055-CLOSE-DEPT-ARR-CSR                      34260000
342700             IF SQLCODE           = -913                          34270000
342800                 PERFORM 9910-SQL-913-RETURN                      34280000
342900             END-IF                                               34290000
342910         WHEN PS-USE-DEPT-ARR-INCL-CSR                            34291031
342920             PERFORM 4055-CLOSE-DEPT-ARR-INCL-CSR                 34292031
342930             IF SQLCODE           = -913                          34293031
342940                 PERFORM 9910-SQL-913-RETURN                      34294031
342950             END-IF                                               34295031
342960         WHEN PS-USE-DEPT-ARR-EXCL-CSR                            34296031
342970             PERFORM 4055-CLOSE-DEPT-ARR-EXCL-CSR                 34297031
342980             IF SQLCODE           = -913                          34298031
342990                 PERFORM 9910-SQL-913-RETURN                      34299031
342991             END-IF                                               34299131
343000         WHEN PS-USE-BYR-ARR-CSR                                  34300000
343100             PERFORM 4060-CLOSE-BYR-ARR-CSR                       34310000
343200             IF SQLCODE           = -913                          34320000
343300                 PERFORM 9910-SQL-913-RETURN                      34330000
343400             END-IF                                               34340000
343410         WHEN PS-USE-BYR-ARR-INCL-CSR                             34341031
343420             PERFORM 4060-CLOSE-BYR-ARR-INCL-CSR                  34342031
343430             IF SQLCODE           = -913                          34343031
343440                 PERFORM 9910-SQL-913-RETURN                      34344031
343450             END-IF                                               34345031
343460         WHEN PS-USE-BYR-ARR-EXCL-CSR                             34346031
343470             PERFORM 4060-CLOSE-BYR-ARR-EXCL-CSR                  34347031
343480             IF SQLCODE           = -913                          34348031
343490                 PERFORM 9910-SQL-913-RETURN                      34349031
343491             END-IF                                               34349131
343500         WHEN PS-USE-PORCVR-ARR-CSR                               34350000
343600             PERFORM 4070-CLOSE-PO-RCVR-ARR-CSR                   34360000
343700             IF SQLCODE           = -913                          34370000
343800                 PERFORM 9900-SQL-913-RETURN                      34380000
343900             END-IF                                               34390000
343910         WHEN PS-USE-PORCVR-ARR-INCL-CSR                          34391031
343920             PERFORM 4070-CLOSE-PO-RCVR-ARR-INCL                  34392034
343930             IF SQLCODE           = -913                          34393031
343940                 PERFORM 9900-SQL-913-RETURN                      34394031
343950             END-IF                                               34395031
343960         WHEN PS-USE-PORCVR-ARR-EXCL-CSR                          34396031
343970             PERFORM 4070-CLOSE-PO-RCVR-ARR-EXCL                  34397034
343980             IF SQLCODE           = -913                          34398031
343990                 PERFORM 9900-SQL-913-RETURN                      34399031
343991             END-IF                                               34399131
344000**** LIST SEQUENCE BY OLDEST TO NEWEST TROUBLE                    34400000
344100         WHEN PS-USE-OPER-UNT-TRB-CSR                             34410000
344200             PERFORM 4075-CLOSE-OPER-UNIT-TRB-CSR                 34420000
344300             IF SQLCODE           = -913                          34430000
344400                 PERFORM 9910-SQL-913-RETURN                      34440000
344500             END-IF                                               34450000
344510         WHEN PS-USE-OPER-UNT-TRB-INCL-CSR                        34451031
344520             PERFORM 4075-CLOSE-OPER-UNIT-TRB-INCL                34452034
344530             IF SQLCODE           = -913                          34453031
344540                 PERFORM 9910-SQL-913-RETURN                      34454031
344550             END-IF                                               34455031
344560         WHEN PS-USE-OPER-UNT-TRB-EXCL-CSR                        34456031
344570             PERFORM 4075-CLOSE-OPER-UNIT-TRB-EXCL                34457034
344580             IF SQLCODE           = -913                          34458031
344590                 PERFORM 9910-SQL-913-RETURN                      34459031
344591             END-IF                                               34459131
344600         WHEN PS-USE-DEPT-TRB-CSR                                 34460000
344700             PERFORM 4080-CLOSE-DEPT-TRB-CSR                      34470000
344800             IF SQLCODE           = -913                          34480000
344900                 PERFORM 9910-SQL-913-RETURN                      34490000
345000             END-IF                                               34500000
345010         WHEN PS-USE-DEPT-TRB-INCL-CSR                            34501031
345020             PERFORM 4080-CLOSE-DEPT-TRB-INCL-CSR                 34502031
345030             IF SQLCODE           = -913                          34503031
345040                 PERFORM 9910-SQL-913-RETURN                      34504031
345050             END-IF                                               34505031
345060         WHEN PS-USE-DEPT-TRB-EXCL-CSR                            34506031
345070             PERFORM 4080-CLOSE-DEPT-TRB-EXCL-CSR                 34507031
345080             IF SQLCODE           = -913                          34508031
345090                 PERFORM 9910-SQL-913-RETURN                      34509031
345091             END-IF                                               34509131
345100         WHEN PS-USE-BYR-TRB-CSR                                  34510000
345200             PERFORM 4085-CLOSE-BYR-TRB-CSR                       34520000
345300             IF SQLCODE           = -913                          34530000
345400                 PERFORM 9910-SQL-913-RETURN                      34540000
345500             END-IF                                               34550000
345510         WHEN PS-USE-BYR-TRB-INCL-CSR                             34551031
345520             PERFORM 4085-CLOSE-BYR-TRB-INCL-CSR                  34552031
345530             IF SQLCODE           = -913                          34553031
345540                 PERFORM 9910-SQL-913-RETURN                      34554031
345550             END-IF                                               34555031
345560         WHEN PS-USE-BYR-TRB-EXCL-CSR                             34556031
345570             PERFORM 4085-CLOSE-BYR-TRB-EXCL-CSR                  34557031
345580             IF SQLCODE           = -913                          34558031
345590                 PERFORM 9910-SQL-913-RETURN                      34559031
345591             END-IF                                               34559131
345600         WHEN PS-USE-PORCVR-TRB-CSR                               34560000
345700             PERFORM 4095-CLOSE-PO-RCVR-TRB-CSR                   34570000
345800             IF SQLCODE           = -913                          34580000
345900                 PERFORM 9900-SQL-913-RETURN                      34590000
346000             END-IF                                               34600000
346010         WHEN PS-USE-PORCVR-TRB-INCL-CSR                          34601031
346020             PERFORM 4095-CLOSE-PO-RCVR-TRB-INCL                  34602034
346030             IF SQLCODE           = -913                          34603031
346040                 PERFORM 9900-SQL-913-RETURN                      34604031
346050             END-IF                                               34605031
346060         WHEN PS-USE-PORCVR-TRB-EXCL-CSR                          34606031
346070             PERFORM 4095-CLOSE-PO-RCVR-TRB-EXCL                  34607034
346080             IF SQLCODE           = -913                          34608031
346090                 PERFORM 9900-SQL-913-RETURN                      34609031
346091             END-IF                                               34609131
346100     END-EVALUATE.                                                34610000
346200                                                                  34620000
346300     MOVE +1                   TO  PV-TOP-ITEM.                   34630000
346400                                                                  34640000
346500     EVALUATE TRUE                                                34650000
346600         WHEN PC-ENTERED-USING-PO-RC015                           34660000
346700         WHEN ASC-FROM-RC015                                      34670000
346800             MOVE RC013-SELECTED-ITEMS TO                         34680000
346900                                 PV-NBR-SELECTED-ON-PREV-LIST     34690000
347000         WHEN PC-ENTERED-USING-PO-PC000                           34700000
347100         WHEN ASC-FROM-PC000                                      34710000
347200             MOVE PC016-SELECTED-ITEMS TO                         34720000
347300                                 PV-NBR-SELECTED-ON-PREV-LIST     34730000
347400         WHEN PC-ENTERED-USING-PO-DS604                           34740000
347500         WHEN ASC-FROM-DS604                                      34750000
347600             MOVE DS002-SELECTED-ITEMS TO                         34760000
347700                                 PV-NBR-SELECTED-ON-PREV-LIST     34770000
347800         WHEN OTHER                                               34780000
347900             MOVE ZERO                 TO                         34790000
348000                                 PV-NBR-SELECTED-ON-PREV-LIST     34800000
348100     END-EVALUATE                                                 34810000
348200                                                                  34820000
348300*  07/02/2004                                                     34830000
348400     EVALUATE TRUE                                                34840000
348500         WHEN PV-NBR-SELECTED-ON-PREV-LIST > 1                    34850000
348600             IF ASC-NUMBER-OF-ITEMS-READ = ZERO                   34860000
348700                 SET DP030-SET-CURSOR-APPL-1                      34870000
348800                     DP020-MSG-FATAL  TO TRUE                     34880000
348900                 MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER         34890000
349000*                PERFORM 3000-EDIT-DATA-IN-COMMAREA               34900000
349100                 PERFORM 3200-RESET-ATTRIBUTES                    34910000
349200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34920000
349300             ELSE                                                 34930000
349400                 MOVE -1           TO MR-SELECTL (1)              34940000
349500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              34950000
349600                 PERFORM 3200-RESET-ATTRIBUTES                    34960000
349700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34970000
349800             END-IF                                               34980000
349900         WHEN OTHER                                               34990000
350000             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  35000000
350100                 SET DP020-NEXT-ACT-APPL-ERROR                    35010000
350200                     DP020-MSG-FATAL  TO  TRUE                    35020000
350300                 MOVE PC-TSYMSG-00050 TO  DP020-MSG-NUMBER        35030000
350400             ELSE                                                 35040000
350500                 MOVE -1              TO MR-SELECTL (1)           35050000
350600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              35060000
350700                 PERFORM 3200-RESET-ATTRIBUTES                    35070000
350800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             35080000
350900             END-IF                                               35090000
351000         END-EVALUATE.                                            35100000
351100                                                                  35110000
351200*----------------------------------------------------------------*35120000
351300* OPEN OPER UNT BY ARRIVAL CURSOR                                *35130000
351400*----------------------------------------------------------------*35140000
351500 4005-OPEN-OPER-UNIT-ARR-CSR.                                     35150000
351600     PERFORM                                                      35160000
351700         WITH TEST AFTER                                          35170000
351800         VARYING PV-RETRY-COUNTER                                 35180000
351900         FROM 1 BY 1                                              35190000
352000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35200000
352100                   OR (SQLCODE = ZERO))                           35210000
352200         EXEC SQL                                                 35220000
352300              OPEN OPER-UNT-BY-ARRIV                              35230000
352400         END-EXEC                                                 35240000
352500                                                                  35250000
352600         EVALUATE TRUE                                            35260000
352700             WHEN SQLCODE = ZERO                                  35270000
352800             WHEN SQLCODE = -904                                  35280000
352900             WHEN SQLCODE = -913                                  35290000
353000                 CONTINUE                                         35300000
353100             WHEN SQLWARN0 NOT = SPACES                           35310000
353200             WHEN SQLCODE < ZERO                                  35320000
353300             WHEN SQLCODE > ZERO                                  35330000
353400                 MOVE '4005-OPEN-OPER-UNIT-ARR-CSR'               35340000
353500                                   TO DP013-PARAGRAPH             35350000
353600                 MOVE 'OPEN OPER UNT ARRIVAL CURSOR    '          35360000
353700                                   TO DP013-MESSAGE-TEXT (1)      35370000
353800                 MOVE SQLCA    TO DP013-SQLCA                     35380000
353900                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35390000
354000                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35400000
354100                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      35410000
354200                 SET DP013-DB2-ABEND                              35420000
354300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35430000
354400                 PERFORM DP013-0000-PROCESS-ABEND                 35440000
354500         END-EVALUATE                                             35450000
354600     END-PERFORM.                                                 35460000
354700                                                                  35470000
354800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35480000
354900         IF SQLCODE = -913                                        35490000
355000             PERFORM 9910-SQL-913-RETURN                          35500000
355100         ELSE                                                     35510000
355200             MOVE '4005-OPEN-OPER-UNIT-ARR-CSR'                   35520000
355300                                   TO DP013-PARAGRAPH             35530000
355400             MOVE                                                 35540000
355500                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35550000
355600                                   TO DP013-MESSAGE-TEXT (1)      35560000
355700             MOVE SQLCA            TO DP013-SQLCA                 35570000
355800             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    35580000
355900             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    35590000
356000             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    35600000
356100             SET DP013-DB2-ABEND                                  35610000
356200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35620000
356300             PERFORM DP013-0000-PROCESS-ABEND                     35630000
356400         END-IF                                                   35640000
356500     END-IF.                                                      35650000
356600                                                                  35660000
356610 4005-OPEN-OPER-UNIT-ARR-INCL.                                    35661034
356620     PERFORM                                                      35662031
356630         WITH TEST AFTER                                          35663031
356640         VARYING PV-RETRY-COUNTER                                 35664031
356650         FROM 1 BY 1                                              35665031
356660         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35666031
356670                   OR (SQLCODE = ZERO))                           35667031
356680         EXEC SQL                                                 35668031
356690              OPEN OPER-UNT-BY-ARRIV-INCL-SET                     35669031
356691         END-EXEC                                                 35669131
356692                                                                  35669231
356693         EVALUATE TRUE                                            35669331
356694             WHEN SQLCODE = ZERO                                  35669431
356695             WHEN SQLCODE = -904                                  35669531
356696             WHEN SQLCODE = -913                                  35669631
356697                 CONTINUE                                         35669731
356698             WHEN SQLWARN0 NOT = SPACES                           35669831
356699             WHEN SQLCODE < ZERO                                  35669931
356700             WHEN SQLCODE > ZERO                                  35670031
356701                 MOVE '4005-OPEN-OPER-UNIT-ARR-INCL'              35670134
356702                                   TO DP013-PARAGRAPH             35670231
356703                 MOVE 'OPEN OPER UNT ARR INCL SET CSR  '          35670331
356704                                   TO DP013-MESSAGE-TEXT (1)      35670431
356705                 MOVE SQLCA    TO DP013-SQLCA                     35670531
356706                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35670631
356707                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35670731
356708                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      35670831
356709                 SET DP013-DB2-ABEND                              35670931
356710                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35671031
356711                 PERFORM DP013-0000-PROCESS-ABEND                 35671131
356712         END-EVALUATE                                             35671231
356713     END-PERFORM.                                                 35671331
356714                                                                  35671431
356715     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35671531
356716         IF SQLCODE = -913                                        35671631
356717             PERFORM 9910-SQL-913-RETURN                          35671731
356718         ELSE                                                     35671831
356719             MOVE '4005-OPEN-OPER-UNIT-ARR-INCL'                  35671934
356720                                   TO DP013-PARAGRAPH             35672031
356721             MOVE                                                 35672131
356722                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35672231
356723                                   TO DP013-MESSAGE-TEXT (1)      35672331
356724             MOVE SQLCA            TO DP013-SQLCA                 35672431
356725             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    35672531
356726             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    35672631
356727             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    35672731
356728             SET DP013-DB2-ABEND                                  35672831
356729                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35672931
356730             PERFORM DP013-0000-PROCESS-ABEND                     35673031
356731         END-IF                                                   35673131
356732     END-IF.                                                      35673231
356733                                                                  35673331
356734 4005-OPEN-OPER-UNIT-ARR-EXCL.                                    35673434
356742     PERFORM                                                      35674231
356743         WITH TEST AFTER                                          35674331
356744         VARYING PV-RETRY-COUNTER                                 35674431
356745         FROM 1 BY 1                                              35674531
356746         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35674631
356747                   OR (SQLCODE = ZERO))                           35674731
356748         EXEC SQL                                                 35674831
356749              OPEN OPER-UNT-BY-ARRIV-EXCL-SET                     35674931
356750         END-EXEC                                                 35675031
356751                                                                  35675131
356752         EVALUATE TRUE                                            35675231
356753             WHEN SQLCODE = ZERO                                  35675331
356754             WHEN SQLCODE = -904                                  35675431
356755             WHEN SQLCODE = -913                                  35675531
356756                 CONTINUE                                         35675631
356757             WHEN SQLWARN0 NOT = SPACES                           35675731
356758             WHEN SQLCODE < ZERO                                  35675831
356759             WHEN SQLCODE > ZERO                                  35675931
356760                 MOVE '4005-OPEN-OPER-UNIT-ARR-EXCL'              35676034
356761                                   TO DP013-PARAGRAPH             35676131
356762                 MOVE 'OPEN OPER UNT ARR EXCL SET CSR  '          35676231
356763                                   TO DP013-MESSAGE-TEXT (1)      35676331
356764                 MOVE SQLCA    TO DP013-SQLCA                     35676431
356765                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35676531
356766                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35676631
356767                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      35676731
356768                 SET DP013-DB2-ABEND                              35676831
356769                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35676931
356770                 PERFORM DP013-0000-PROCESS-ABEND                 35677031
356771         END-EVALUATE                                             35677131
356772     END-PERFORM.                                                 35677231
356773                                                                  35677331
356774     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35677431
356775         IF SQLCODE = -913                                        35677531
356776             PERFORM 9910-SQL-913-RETURN                          35677631
356777         ELSE                                                     35677731
356778             MOVE '4005-OPEN-OPER-UNIT-ARR-EXCL'                  35677834
356779                                   TO DP013-PARAGRAPH             35677931
356780             MOVE                                                 35678031
356781                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 35678131
356782                                   TO DP013-MESSAGE-TEXT (1)      35678231
356783             MOVE SQLCA            TO DP013-SQLCA                 35678331
356784             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    35678431
356785             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    35678531
356786             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    35678631
356787             SET DP013-DB2-ABEND                                  35678731
356788                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35678831
356789             PERFORM DP013-0000-PROCESS-ABEND                     35678931
356790         END-IF                                                   35679031
356791     END-IF.                                                      35679131
356792                                                                  35679231
356793*----------------------------------------------------------------*35679300
356800* OPEN DEPARTMENT BY ARRIVAL CURSOR                              *35680000
356900*----------------------------------------------------------------*35690000
357000 4010-OPEN-DEPT-ARR-CSR.                                          35700000
357100     PERFORM                                                      35710000
357200         WITH TEST AFTER                                          35720000
357300         VARYING PV-RETRY-COUNTER                                 35730000
357400         FROM 1 BY 1                                              35740000
357500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35750000
357600                   OR (SQLCODE = ZERO))                           35760000
357700         EXEC SQL                                                 35770000
357800              OPEN DEPT-BY-ARRIVAL                                35780000
357900         END-EXEC                                                 35790000
358000                                                                  35800000
358100         EVALUATE TRUE                                            35810000
358200             WHEN SQLCODE = ZERO                                  35820000
358300             WHEN SQLCODE = -904                                  35830000
358400             WHEN SQLCODE = -913                                  35840000
358500                 CONTINUE                                         35850000
358600             WHEN SQLWARN0 NOT = SPACES                           35860000
358700             WHEN SQLCODE < ZERO                                  35870000
358800             WHEN SQLCODE > ZERO                                  35880000
358900                 MOVE '4010-OPEN-DEPT-ARR-CSR'                    35890000
359000                                   TO DP013-PARAGRAPH             35900000
359100                 MOVE 'OPEN DEPARTMENT ARRIVAL CURSOR  '          35910000
359200                                   TO DP013-MESSAGE-TEXT (1)      35920000
359300                 MOVE SQLCA    TO DP013-SQLCA                     35930000
359400                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      35940000
359500                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      35950000
359600                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      35960000
359700                 SET DP013-DB2-ABEND                              35970000
359800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35980000
359900                 PERFORM DP013-0000-PROCESS-ABEND                 35990000
360000         END-EVALUATE                                             36000000
360100     END-PERFORM.                                                 36010000
360200                                                                  36020000
360300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36030000
360400         IF SQLCODE = -913                                        36040000
360500             PERFORM 9910-SQL-913-RETURN                          36050000
360600         ELSE                                                     36060000
360700             MOVE '4010-OPEN-DEPT-ARR-CSR'                        36070000
360800                                   TO DP013-PARAGRAPH             36080000
360900             MOVE                                                 36090000
361000                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 36100000
361100                                   TO DP013-MESSAGE-TEXT (1)      36110000
361200             MOVE SQLCA            TO DP013-SQLCA                 36120000
361300             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    36130000
361400             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    36140000
361500             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    36150000
361600             SET DP013-DB2-ABEND                                  36160000
361700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36170000
361800             PERFORM DP013-0000-PROCESS-ABEND                     36180000
361900         END-IF                                                   36190000
362000     END-IF.                                                      36200000
362100                                                                  36210000
362110 4010-OPEN-DEPT-ARR-INCL-CSR.                                     36211031
362120     PERFORM                                                      36212031
362130         WITH TEST AFTER                                          36213031
362140         VARYING PV-RETRY-COUNTER                                 36214031
362150         FROM 1 BY 1                                              36215031
362160         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36216031
362170                   OR (SQLCODE = ZERO))                           36217031
362180         EXEC SQL                                                 36218031
362190              OPEN DEPT-BY-ARRIVAL-INCL-SET                       36219031
362191         END-EXEC                                                 36219131
362192                                                                  36219231
362193         EVALUATE TRUE                                            36219331
362194             WHEN SQLCODE = ZERO                                  36219431
362195             WHEN SQLCODE = -904                                  36219531
362196             WHEN SQLCODE = -913                                  36219631
362197                 CONTINUE                                         36219731
362198             WHEN SQLWARN0 NOT = SPACES                           36219831
362199             WHEN SQLCODE < ZERO                                  36219931
362200             WHEN SQLCODE > ZERO                                  36220031
362201                 MOVE '4010-OPEN-DEPT-ARR-INCL-CSR'               36220131
362202                                   TO DP013-PARAGRAPH             36220231
362203                 MOVE 'OPEN DEPT ARR INCL SET  CURSOR  '          36220331
362204                                   TO DP013-MESSAGE-TEXT (1)      36220431
362205                 MOVE SQLCA    TO DP013-SQLCA                     36220531
362206                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      36220631
362207                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      36220731
362208                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      36220831
362209                 SET DP013-DB2-ABEND                              36220931
362210                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36221031
362211                 PERFORM DP013-0000-PROCESS-ABEND                 36221131
362212         END-EVALUATE                                             36221231
362213     END-PERFORM.                                                 36221331
362214                                                                  36221431
362215     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36221531
362216         IF SQLCODE = -913                                        36221631
362217             PERFORM 9910-SQL-913-RETURN                          36221731
362218         ELSE                                                     36221831
362219             MOVE '4010-OPEN-DEPT-ARR-INCL-CSR'                   36221931
362220                                   TO DP013-PARAGRAPH             36222031
362221             MOVE                                                 36222131
362222                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 36222231
362223                                   TO DP013-MESSAGE-TEXT (1)      36222331
362224             MOVE SQLCA            TO DP013-SQLCA                 36222431
362225             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    36222531
362226             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    36222631
362227             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    36222731
362228             SET DP013-DB2-ABEND                                  36222831
362229                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36222931
362230             PERFORM DP013-0000-PROCESS-ABEND                     36223031
362231         END-IF                                                   36223131
362232     END-IF.                                                      36223231
362233                                                                  36223331
362234 4010-OPEN-DEPT-ARR-EXCL-CSR.                                     36223431
362242     PERFORM                                                      36224231
362243         WITH TEST AFTER                                          36224331
362244         VARYING PV-RETRY-COUNTER                                 36224431
362245         FROM 1 BY 1                                              36224531
362246         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36224631
362247                   OR (SQLCODE = ZERO))                           36224731
362248         EXEC SQL                                                 36224831
362249              OPEN DEPT-BY-ARRIVAL-EXCL-SET                       36224931
362250         END-EXEC                                                 36225031
362251                                                                  36225131
362252         EVALUATE TRUE                                            36225231
362253             WHEN SQLCODE = ZERO                                  36225331
362254             WHEN SQLCODE = -904                                  36225431
362255             WHEN SQLCODE = -913                                  36225531
362256                 CONTINUE                                         36225631
362257             WHEN SQLWARN0 NOT = SPACES                           36225731
362258             WHEN SQLCODE < ZERO                                  36225831
362259             WHEN SQLCODE > ZERO                                  36225931
362260                 MOVE '4010-OPEN-DEPT-ARR-EXCL-CSR'               36226031
362261                                   TO DP013-PARAGRAPH             36226131
362262                 MOVE 'OPEN DEPT ARR EXCL SET  CURSOR  '          36226231
362263                                   TO DP013-MESSAGE-TEXT (1)      36226331
362264                 MOVE SQLCA    TO DP013-SQLCA                     36226431
362265                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      36226531
362266                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      36226631
362267                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      36226731
362268                 SET DP013-DB2-ABEND                              36226831
362269                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36226931
362270                 PERFORM DP013-0000-PROCESS-ABEND                 36227031
362271         END-EVALUATE                                             36227131
362272     END-PERFORM.                                                 36227231
362273                                                                  36227331
362274     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36227431
362275         IF SQLCODE = -913                                        36227531
362276             PERFORM 9910-SQL-913-RETURN                          36227631
362277         ELSE                                                     36227731
362278             MOVE '4010-OPEN-DEPT-ARR-EXCL-CSR'                   36227831
362279                                   TO DP013-PARAGRAPH             36227931
362280             MOVE                                                 36228031
362281                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 36228131
362282                                   TO DP013-MESSAGE-TEXT (1)      36228231
362283             MOVE SQLCA            TO DP013-SQLCA                 36228331
362284             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    36228431
362285             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    36228531
362286             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    36228631
362287             SET DP013-DB2-ABEND                                  36228731
362288                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36228831
362289             PERFORM DP013-0000-PROCESS-ABEND                     36228931
362290         END-IF                                                   36229031
362291     END-IF.                                                      36229131
362292                                                                  36229231
362293*----------------------------------------------------------------*36229300
362300* OPEN BUYER BY ARRIVAL CURSOR                                   *36230000
362400*----------------------------------------------------------------*36240000
362500 4015-OPEN-BYR-ARR-CSR.                                           36250000
362600     PERFORM                                                      36260000
362700         WITH TEST AFTER                                          36270000
362800         VARYING PV-RETRY-COUNTER                                 36280000
362900         FROM 1 BY 1                                              36290000
363000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36300000
363100                   OR (SQLCODE = ZERO))                           36310000
363200                                                                  36320000
363300         EXEC SQL                                                 36330000
363400              OPEN BUYER-BY-ARRIVAL                               36340000
363500         END-EXEC                                                 36350000
363600                                                                  36360000
363700         EVALUATE TRUE                                            36370000
363800             WHEN SQLCODE = ZERO                                  36380000
363900             WHEN SQLCODE = -904                                  36390000
364000             WHEN SQLCODE = -913                                  36400000
364100                 CONTINUE                                         36410000
364200             WHEN SQLWARN0 NOT = SPACES                           36420000
364300             WHEN SQLCODE < ZERO                                  36430000
364400             WHEN SQLCODE > ZERO                                  36440000
364500                 MOVE '4015-OPEN-BYR-ARR-CSR      '               36450000
364600                                   TO DP013-PARAGRAPH             36460000
364700                 MOVE 'OPEN TROUBLE BUYER ARRIVAL CURSOR'         36470000
364800                                   TO DP013-MESSAGE-TEXT (1)      36480000
364900                 MOVE SQLCA    TO DP013-SQLCA                     36490000
365000                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      36500000
365100                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      36510000
365200                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      36520000
365300                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (4)      36530000
365400                 SET DP013-DB2-ABEND                              36540000
365500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36550000
365600                 PERFORM DP013-0000-PROCESS-ABEND                 36560000
365700         END-EVALUATE                                             36570000
365800     END-PERFORM.                                                 36580000
365900                                                                  36590000
366000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36600000
366100         IF SQLCODE = -913                                        36610000
366200             PERFORM 9910-SQL-913-RETURN                          36620000
366300         ELSE                                                     36630000
366400             MOVE '4015-OPEN-BYR-ARR-CSR      '                   36640000
366500                                            TO DP013-PARAGRAPH    36650000
366600             MOVE                                                 36660000
366700                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 36670000
366800                                   TO DP013-MESSAGE-TEXT (1)      36680000
366900             MOVE SQLCA            TO DP013-SQLCA                 36690000
367000             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    36700000
367100             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    36710000
367200             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    36720000
367300             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    36730000
367400             SET DP013-DB2-ABEND                                  36740000
367500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36750000
367600             PERFORM DP013-0000-PROCESS-ABEND                     36760000
367700         END-IF                                                   36770000
367800     END-IF.                                                      36780000
367900                                                                  36790000
367910 4015-OPEN-BYR-ARR-INCL-CSR.                                      36791031
367920     PERFORM                                                      36792031
367930         WITH TEST AFTER                                          36793031
367940         VARYING PV-RETRY-COUNTER                                 36794031
367950         FROM 1 BY 1                                              36795031
367960         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36796031
367970                   OR (SQLCODE = ZERO))                           36797031
367980                                                                  36798031
367990         EXEC SQL                                                 36799031
367991              OPEN BUYER-BY-ARRIVAL-INCL-SET                      36799131
367992         END-EXEC                                                 36799231
367993                                                                  36799331
367994         EVALUATE TRUE                                            36799431
367995             WHEN SQLCODE = ZERO                                  36799531
367996             WHEN SQLCODE = -904                                  36799631
367997             WHEN SQLCODE = -913                                  36799731
367998                 CONTINUE                                         36799831
367999             WHEN SQLWARN0 NOT = SPACES                           36799931
368000             WHEN SQLCODE < ZERO                                  36800031
368001             WHEN SQLCODE > ZERO                                  36800131
368002                 MOVE '4015-OPEN-BYR-ARR-INCL-CSR'                36800231
368003                                   TO DP013-PARAGRAPH             36800331
368004                 MOVE 'OPEN TRBL ARR INCL SET CURSOR    '         36800431
368005                                   TO DP013-MESSAGE-TEXT (1)      36800531
368006                 MOVE SQLCA    TO DP013-SQLCA                     36800631
368007                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      36800731
368008                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      36800831
368009                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      36800931
368010                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (4)      36801031
368011                 SET DP013-DB2-ABEND                              36801131
368012                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36801231
368013                 PERFORM DP013-0000-PROCESS-ABEND                 36801331
368014         END-EVALUATE                                             36801431
368015     END-PERFORM.                                                 36801531
368016                                                                  36801631
368017     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36801731
368018         IF SQLCODE = -913                                        36801831
368019             PERFORM 9910-SQL-913-RETURN                          36801931
368020         ELSE                                                     36802031
368021             MOVE '4015-OPEN-BYR-ARR-INCL-CSR '                   36802131
368022                                            TO DP013-PARAGRAPH    36802231
368023             MOVE                                                 36802331
368024                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 36802431
368025                                   TO DP013-MESSAGE-TEXT (1)      36802531
368026             MOVE SQLCA            TO DP013-SQLCA                 36802631
368027             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    36802731
368028             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    36802831
368029             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    36802931
368030             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    36803031
368031             SET DP013-DB2-ABEND                                  36803131
368032                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36803231
368033             PERFORM DP013-0000-PROCESS-ABEND                     36803331
368034         END-IF                                                   36803431
368035     END-IF.                                                      36803531
368036                                                                  36803631
368037 4015-OPEN-BYR-ARR-EXCL-CSR.                                      36803731
368045     PERFORM                                                      36804531
368046         WITH TEST AFTER                                          36804631
368047         VARYING PV-RETRY-COUNTER                                 36804731
368048         FROM 1 BY 1                                              36804831
368049         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36804931
368050                   OR (SQLCODE = ZERO))                           36805031
368051                                                                  36805131
368052         EXEC SQL                                                 36805231
368053              OPEN BUYER-BY-ARRIVAL-EXCL-SET                      36805331
368054         END-EXEC                                                 36805431
368055                                                                  36805531
368056         EVALUATE TRUE                                            36805631
368057             WHEN SQLCODE = ZERO                                  36805731
368058             WHEN SQLCODE = -904                                  36805831
368059             WHEN SQLCODE = -913                                  36805931
368060                 CONTINUE                                         36806031
368061             WHEN SQLWARN0 NOT = SPACES                           36806131
368062             WHEN SQLCODE < ZERO                                  36806231
368063             WHEN SQLCODE > ZERO                                  36806331
368064                 MOVE '4015-OPEN-BYR-ARR-EXCL-CSR '               36806431
368065                                   TO DP013-PARAGRAPH             36806531
368066                 MOVE 'OPEN TRBL BUYER ARR EXCL SET CSR '         36806631
368067                                   TO DP013-MESSAGE-TEXT (1)      36806731
368068                 MOVE SQLCA    TO DP013-SQLCA                     36806831
368069                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      36806931
368070                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      36807031
368071                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      36807131
368072                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (4)      36807231
368073                 SET DP013-DB2-ABEND                              36807331
368074                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36807431
368075                 PERFORM DP013-0000-PROCESS-ABEND                 36807531
368076         END-EVALUATE                                             36807631
368077     END-PERFORM.                                                 36807731
368078                                                                  36807831
368079     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36807931
368080         IF SQLCODE = -913                                        36808031
368081             PERFORM 9910-SQL-913-RETURN                          36808131
368082         ELSE                                                     36808231
368083             MOVE '4015-OPEN-BYR-ARR-EXCL-CSR '                   36808331
368084                                            TO DP013-PARAGRAPH    36808431
368085             MOVE                                                 36808531
368086                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 36808631
368087                                   TO DP013-MESSAGE-TEXT (1)      36808731
368088             MOVE SQLCA            TO DP013-SQLCA                 36808831
368089             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    36808931
368090             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    36809031
368091             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    36809131
368092             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    36809231
368093             SET DP013-DB2-ABEND                                  36809331
368094                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36809431
368095             PERFORM DP013-0000-PROCESS-ABEND                     36809531
368096         END-IF                                                   36809631
368097     END-IF.                                                      36809731
368098                                                                  36809831
368099*----------------------------------------------------------------*36809900
368100* OPEN THE PO-RCVR BY ARRIVAL CURSOR                             *36810000
368200*----------------------------------------------------------------*36820000
368300 4025-OPEN-PO-RCVR-ARR-CSR.                                       36830000
368400     PERFORM                                                      36840000
368500         WITH TEST AFTER                                          36850000
368600         VARYING PV-RETRY-COUNTER                                 36860000
368700         FROM 1 BY 1                                              36870000
368800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36880000
368900                   OR (SQLCODE = ZERO))                           36890000
369000                                                                  36900000
369100         EXEC SQL                                                 36910000
369200              OPEN PORCVR-BY-ARRIVAL                              36920000
369300         END-EXEC                                                 36930000
369400                                                                  36940000
369500         EVALUATE TRUE                                            36950000
369600             WHEN SQLCODE = ZERO                                  36960000
369700             WHEN SQLCODE = -904                                  36970000
369800             WHEN SQLCODE = -913                                  36980000
369900                 CONTINUE                                         36990000
370000             WHEN SQLWARN0 NOT = SPACES                           37000000
370100             WHEN SQLCODE < ZERO                                  37010000
370200             WHEN SQLCODE > ZERO                                  37020000
370300                 MOVE '4025-OPEN-PO-RCVR-ARR-CSR'                 37030000
370400                                   TO DP013-PARAGRAPH             37040000
370500                 MOVE 'OPEN TROUBLE PO ARRIVAL CURSOR  '          37050000
370600                                   TO DP013-MESSAGE-TEXT (1)      37060000
370700                 MOVE SQLCA    TO DP013-SQLCA                     37070000
370800                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      37080000
370900                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      37090000
371000                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      37100000
371100                 SET DP013-DB2-ABEND                              37110000
371200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37120000
371300                 PERFORM DP013-0000-PROCESS-ABEND                 37130000
371400         END-EVALUATE                                             37140000
371500     END-PERFORM.                                                 37150000
371600                                                                  37160000
371700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37170000
371800         IF SQLCODE = -913                                        37180000
371900             PERFORM 9910-SQL-913-RETURN                          37190000
372000         ELSE                                                     37200000
372100             MOVE '4025-OPEN-PO-RCVR-ARR-CSR' TO DP013-PARAGRAPH  37210000
372200             MOVE                                                 37220000
372300                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 37230000
372400                                    TO DP013-MESSAGE-TEXT (1)     37240000
372500             MOVE SQLCA             TO DP013-SQLCA                37250000
372600             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   37260000
372700             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   37270000
372800             MOVE 'TRECEIV '        TO DP013-DB2-TABLE-NAME (3)   37280000
372900             SET DP013-DB2-ABEND                                  37290000
373000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37300000
373100             PERFORM DP013-0000-PROCESS-ABEND                     37310000
373200         END-IF                                                   37320000
373300     END-IF.                                                      37330000
373400                                                                  37340000
373410 4025-OPEN-PO-RCVR-ARR-INCL-CSR.                                  37341031
373420     PERFORM                                                      37342031
373430         WITH TEST AFTER                                          37343031
373440         VARYING PV-RETRY-COUNTER                                 37344031
373450         FROM 1 BY 1                                              37345031
373460         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37346031
373470                   OR (SQLCODE = ZERO))                           37347031
373480                                                                  37348031
373490         EXEC SQL                                                 37349031
373491              OPEN PORCVR-BY-ARRIVAL-INCL-SET                     37349131
373492         END-EXEC                                                 37349231
373493                                                                  37349331
373494         EVALUATE TRUE                                            37349431
373495             WHEN SQLCODE = ZERO                                  37349531
373496             WHEN SQLCODE = -904                                  37349631
373497             WHEN SQLCODE = -913                                  37349731
373498                 CONTINUE                                         37349831
373499             WHEN SQLWARN0 NOT = SPACES                           37349931
373500             WHEN SQLCODE < ZERO                                  37350031
373501             WHEN SQLCODE > ZERO                                  37350131
373502                 MOVE '4025-OPEN-PO-RCVR-ARR-INCL-CSR'            37350231
373503                                   TO DP013-PARAGRAPH             37350331
373504                 MOVE 'OPEN TRBL PO ARR INCL SET CSR   '          37350431
373505                                   TO DP013-MESSAGE-TEXT (1)      37350531
373506                 MOVE SQLCA    TO DP013-SQLCA                     37350631
373507                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      37350731
373508                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      37350831
373509                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      37350931
373510                 SET DP013-DB2-ABEND                              37351031
373511                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37351131
373512                 PERFORM DP013-0000-PROCESS-ABEND                 37351231
373513         END-EVALUATE                                             37351331
373514     END-PERFORM.                                                 37351431
373515                                                                  37351531
373516     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37351631
373517         IF SQLCODE = -913                                        37351731
373518             PERFORM 9910-SQL-913-RETURN                          37351831
373519         ELSE                                                     37351931
373520             MOVE '4025-OPEN-PO-RCVR-ARR-INCL-CSR'                37352031
373521                                           TO DP013-PARAGRAPH     37352131
373522             MOVE                                                 37352231
373523                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 37352331
373524                                    TO DP013-MESSAGE-TEXT (1)     37352431
373525             MOVE SQLCA             TO DP013-SQLCA                37352531
373526             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   37352631
373527             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   37352731
373528             MOVE 'TRECEIV '        TO DP013-DB2-TABLE-NAME (3)   37352831
373529             SET DP013-DB2-ABEND                                  37352931
373530                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37353031
373531             PERFORM DP013-0000-PROCESS-ABEND                     37353131
373532         END-IF                                                   37353231
373533     END-IF.                                                      37353331
373534                                                                  37353431
373535 4025-OPEN-PO-RCVR-ARR-EXCL-CSR.                                  37353531
373543     PERFORM                                                      37354331
373544         WITH TEST AFTER                                          37354431
373545         VARYING PV-RETRY-COUNTER                                 37354531
373546         FROM 1 BY 1                                              37354631
373547         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37354731
373548                   OR (SQLCODE = ZERO))                           37354831
373549                                                                  37354931
373550         EXEC SQL                                                 37355031
373551              OPEN PORCVR-BY-ARRIVAL-EXCL-SET                     37355131
373552         END-EXEC                                                 37355231
373553                                                                  37355331
373554         EVALUATE TRUE                                            37355431
373555             WHEN SQLCODE = ZERO                                  37355531
373556             WHEN SQLCODE = -904                                  37355631
373557             WHEN SQLCODE = -913                                  37355731
373558                 CONTINUE                                         37355831
373559             WHEN SQLWARN0 NOT = SPACES                           37355931
373560             WHEN SQLCODE < ZERO                                  37356031
373561             WHEN SQLCODE > ZERO                                  37356131
373562                 MOVE '4025-OPEN-PO-RCVR-ARR-EXCL'                37356231
373563                                   TO DP013-PARAGRAPH             37356331
373564                 MOVE 'OPEN TRBL PO ARR EXCL SET CSR   '          37356431
373565                                   TO DP013-MESSAGE-TEXT (1)      37356531
373566                 MOVE SQLCA    TO DP013-SQLCA                     37356631
373567                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      37356731
373568                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      37356831
373569                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      37356931
373570                 SET DP013-DB2-ABEND                              37357031
373571                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37357131
373572                 PERFORM DP013-0000-PROCESS-ABEND                 37357231
373573         END-EVALUATE                                             37357331
373574     END-PERFORM.                                                 37357431
373575                                                                  37357531
373576     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37357631
373577         IF SQLCODE = -913                                        37357731
373578             PERFORM 9910-SQL-913-RETURN                          37357831
373579         ELSE                                                     37357931
373580             MOVE '4025-OPEN-PO-RCVR-ARR-EXCL-CSR'                37358031
373581                                              TO DP013-PARAGRAPH  37358131
373582             MOVE                                                 37358231
373583                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 37358331
373584                                    TO DP013-MESSAGE-TEXT (1)     37358431
373585             MOVE SQLCA             TO DP013-SQLCA                37358531
373586             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   37358631
373587             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   37358731
373588             MOVE 'TRECEIV '        TO DP013-DB2-TABLE-NAME (3)   37358831
373589             SET DP013-DB2-ABEND                                  37358931
373590                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37359031
373591             PERFORM DP013-0000-PROCESS-ABEND                     37359131
373592         END-IF                                                   37359231
373593     END-IF.                                                      37359331
373594                                                                  37359431
373595*----------------------------------------------------------------*37359500
373600* OPEN OPER UNT BY OLDEST TO NEWEST TROUBLE  CURSOR              *37360000
373700*----------------------------------------------------------------*37370000
373800 4030-OPEN-OPER-UNIT-TRB-CSR.                                     37380000
373900     PERFORM                                                      37390000
374000         WITH TEST AFTER                                          37400000
374100         VARYING PV-RETRY-COUNTER                                 37410000
374200         FROM 1 BY 1                                              37420000
374300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37430000
374400                   OR (SQLCODE = ZERO))                           37440000
374500         EXEC SQL                                                 37450000
374600              OPEN OPER-UNT-BY-TRBL                               37460000
374700         END-EXEC                                                 37470000
374800                                                                  37480000
374900         EVALUATE TRUE                                            37490000
375000             WHEN SQLCODE = ZERO                                  37500000
375100             WHEN SQLCODE = -904                                  37510000
375200             WHEN SQLCODE = -913                                  37520000
375300                 CONTINUE                                         37530000
375400             WHEN SQLWARN0 NOT = SPACES                           37540000
375500             WHEN SQLCODE < ZERO                                  37550000
375600             WHEN SQLCODE > ZERO                                  37560000
375700                 MOVE '4030-CLOSE-OPER-UNIT-TRB-CSR'              37570000
375800                                   TO DP013-PARAGRAPH             37580000
375900                 MOVE 'CLOSE OPER UNT ARRIVAL CURSOR    '         37590000
376000                                   TO DP013-MESSAGE-TEXT (1)      37600000
376100                 MOVE SQLCA    TO DP013-SQLCA                     37610000
376200                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      37620000
376300                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      37630000
376400                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      37640000
376500                 SET DP013-DB2-ABEND                              37650000
376600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37660000
376700                 PERFORM DP013-0000-PROCESS-ABEND                 37670000
376800         END-EVALUATE                                             37680000
376900     END-PERFORM.                                                 37690000
377000                                                                  37700000
377100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37710000
377200         IF SQLCODE = -913                                        37720000
377300             PERFORM 9910-SQL-913-RETURN                          37730000
377400         ELSE                                                     37740000
377500             MOVE '4030-CLOSE-OPER-UNIT-TRB-CSR'                  37750000
377600                                   TO DP013-PARAGRAPH             37760000
377700             MOVE                                                 37770000
377800                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 37780000
377900                                   TO DP013-MESSAGE-TEXT (1)      37790000
378000             MOVE SQLCA            TO DP013-SQLCA                 37800000
378100             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    37810000
378200             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    37820000
378300             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    37830000
378400             SET DP013-DB2-ABEND                                  37840000
378500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37850000
378600             PERFORM DP013-0000-PROCESS-ABEND                     37860000
378700         END-IF                                                   37870000
378800     END-IF.                                                      37880000
378900                                                                  37890000
378910 4030-OPEN-OPER-UNIT-TRB-INCL.                                    37891034
378920     PERFORM                                                      37892031
378930         WITH TEST AFTER                                          37893031
378940         VARYING PV-RETRY-COUNTER                                 37894031
378950         FROM 1 BY 1                                              37895031
378960         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37896031
378970                   OR (SQLCODE = ZERO))                           37897031
378980         EXEC SQL                                                 37898031
378990              OPEN OPER-UNT-BY-TRBL-INCL-SET                      37899031
378991         END-EXEC                                                 37899131
378992                                                                  37899231
378993         EVALUATE TRUE                                            37899331
378994             WHEN SQLCODE = ZERO                                  37899431
378995             WHEN SQLCODE = -904                                  37899531
378996             WHEN SQLCODE = -913                                  37899631
378997                 CONTINUE                                         37899731
378998             WHEN SQLWARN0 NOT = SPACES                           37899831
378999             WHEN SQLCODE < ZERO                                  37899931
379000             WHEN SQLCODE > ZERO                                  37900031
379001                 MOVE '4030-CLOSE-OPER-UNIT-TRB-INCL-CSR'         37900131
379002                                   TO DP013-PARAGRAPH             37900231
379003                 MOVE 'CLOSE OPER ARR INCL SET CURSOR   '         37900331
379004                                   TO DP013-MESSAGE-TEXT (1)      37900431
379005                 MOVE SQLCA    TO DP013-SQLCA                     37900531
379006                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      37900631
379007                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      37900731
379008                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      37900831
379009                 SET DP013-DB2-ABEND                              37900931
379010                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37901031
379011                 PERFORM DP013-0000-PROCESS-ABEND                 37901131
379012         END-EVALUATE                                             37901231
379013     END-PERFORM.                                                 37901331
379014                                                                  37901431
379015     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37901531
379016         IF SQLCODE = -913                                        37901631
379017             PERFORM 9910-SQL-913-RETURN                          37901731
379018         ELSE                                                     37901831
379019             MOVE '4030-CLOSE-OPER-UNIT-TRB-INCL-CSR'             37901931
379020                                   TO DP013-PARAGRAPH             37902031
379021             MOVE                                                 37902131
379022                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 37902231
379023                                   TO DP013-MESSAGE-TEXT (1)      37902331
379024             MOVE SQLCA            TO DP013-SQLCA                 37902431
379025             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    37902531
379026             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    37902631
379027             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    37902731
379028             SET DP013-DB2-ABEND                                  37902831
379029                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37902931
379030             PERFORM DP013-0000-PROCESS-ABEND                     37903031
379031         END-IF                                                   37903131
379032     END-IF.                                                      37903231
379033                                                                  37903331
379034 4030-OPEN-OPER-UNIT-TRB-EXCL.                                    37903434
379042     PERFORM                                                      37904231
379043         WITH TEST AFTER                                          37904331
379044         VARYING PV-RETRY-COUNTER                                 37904431
379045         FROM 1 BY 1                                              37904531
379046         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37904631
379047                   OR (SQLCODE = ZERO))                           37904731
379048         EXEC SQL                                                 37904831
379049              OPEN OPER-UNT-BY-TRBL-EXCL-SET                      37904931
379050         END-EXEC                                                 37905031
379051                                                                  37905131
379052         EVALUATE TRUE                                            37905231
379053             WHEN SQLCODE = ZERO                                  37905331
379054             WHEN SQLCODE = -904                                  37905431
379055             WHEN SQLCODE = -913                                  37905531
379056                 CONTINUE                                         37905631
379057             WHEN SQLWARN0 NOT = SPACES                           37905731
379058             WHEN SQLCODE < ZERO                                  37905831
379059             WHEN SQLCODE > ZERO                                  37905931
379060                 MOVE '4030-CLOSE-OPER-UNIT-TRB-EXCL-CSR'         37906031
379061                                   TO DP013-PARAGRAPH             37906131
379062                 MOVE 'CLOSE OPER UNT ARRIVAL CURSOR    '         37906231
379063                                   TO DP013-MESSAGE-TEXT (1)      37906331
379064                 MOVE SQLCA    TO DP013-SQLCA                     37906431
379065                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      37906531
379066                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      37906631
379067                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      37906731
379068                 SET DP013-DB2-ABEND                              37906831
379069                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37906931
379070                 PERFORM DP013-0000-PROCESS-ABEND                 37907031
379071         END-EVALUATE                                             37907131
379072     END-PERFORM.                                                 37907231
379073                                                                  37907331
379074     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37907431
379075         IF SQLCODE = -913                                        37907531
379076             PERFORM 9910-SQL-913-RETURN                          37907631
379077         ELSE                                                     37907731
379078             MOVE '4030-CLOSE-OPER-UNIT-TRB-EXCL-CSR'             37907831
379079                                   TO DP013-PARAGRAPH             37907931
379080             MOVE                                                 37908031
379081                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 37908131
379082                                   TO DP013-MESSAGE-TEXT (1)      37908231
379083             MOVE SQLCA            TO DP013-SQLCA                 37908331
379084             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    37908431
379085             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    37908531
379086             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    37908631
379087             SET DP013-DB2-ABEND                                  37908731
379088                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37908831
379089             PERFORM DP013-0000-PROCESS-ABEND                     37908931
379090         END-IF                                                   37909031
379091     END-IF.                                                      37909131
379092                                                                  37909231
379093*----------------------------------------------------------------*37909300
379100* OPEN DEPARTMENT BY OLDEST TO NEWEST TROUBLE  CURSOR            *37910000
379200*----------------------------------------------------------------*37920000
379300 4035-OPEN-DEPT-TRB-CSR.                                          37930000
379400     PERFORM                                                      37940000
379500         WITH TEST AFTER                                          37950000
379600         VARYING PV-RETRY-COUNTER                                 37960000
379700         FROM 1 BY 1                                              37970000
379800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37980000
379900                   OR (SQLCODE = ZERO))                           37990000
380000         EXEC SQL                                                 38000000
380100              OPEN DEPT-BY-TRBL                                   38010000
380200         END-EXEC                                                 38020000
380300                                                                  38030000
380400         EVALUATE TRUE                                            38040000
380500             WHEN SQLCODE = ZERO                                  38050000
380600             WHEN SQLCODE = -904                                  38060000
380700             WHEN SQLCODE = -913                                  38070000
380800                 CONTINUE                                         38080000
380900             WHEN SQLWARN0 NOT = SPACES                           38090000
381000             WHEN SQLCODE < ZERO                                  38100000
381100             WHEN SQLCODE > ZERO                                  38110000
381200                 MOVE '4035-OPEN-DEPT-TRB-CSR'                    38120000
381300                                   TO DP013-PARAGRAPH             38130000
381400                 MOVE 'OPEN DEPARTMENT ARRIVAL CURSOR  '          38140000
381500                                   TO DP013-MESSAGE-TEXT (1)      38150000
381600                 MOVE SQLCA    TO DP013-SQLCA                     38160000
381700                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      38170000
381800                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      38180000
381900                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      38190000
382000                 SET DP013-DB2-ABEND                              38200000
382100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38210000
382200                 PERFORM DP013-0000-PROCESS-ABEND                 38220000
382300         END-EVALUATE                                             38230000
382400     END-PERFORM.                                                 38240000
382500                                                                  38250000
382600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38260000
382700         IF SQLCODE = -913                                        38270000
382800             PERFORM 9910-SQL-913-RETURN                          38280000
382900         ELSE                                                     38290000
383000             MOVE '4035-CLOSE-DEPT-TRB-CSR'                       38300000
383100                                   TO DP013-PARAGRAPH             38310000
383200             MOVE                                                 38320000
383300                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 38330000
383400                                   TO DP013-MESSAGE-TEXT (1)      38340000
383500             MOVE SQLCA            TO DP013-SQLCA                 38350000
383600             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    38360000
383700             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    38370000
383800             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    38380000
383900             SET DP013-DB2-ABEND                                  38390000
384000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38400000
384100             PERFORM DP013-0000-PROCESS-ABEND                     38410000
384200         END-IF                                                   38420000
384300     END-IF.                                                      38430000
384400                                                                  38440000
384410 4035-OPEN-DEPT-TRB-INCL-CSR.                                     38441034
384420     PERFORM                                                      38442031
384430         WITH TEST AFTER                                          38443031
384440         VARYING PV-RETRY-COUNTER                                 38444031
384450         FROM 1 BY 1                                              38445031
384460         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38446031
384470                   OR (SQLCODE = ZERO))                           38447031
384480         EXEC SQL                                                 38448031
384490              OPEN DEPT-BY-TRBL-INCL-SET                          38449031
384491         END-EXEC                                                 38449131
384492                                                                  38449231
384493         EVALUATE TRUE                                            38449331
384494             WHEN SQLCODE = ZERO                                  38449431
384495             WHEN SQLCODE = -904                                  38449531
384496             WHEN SQLCODE = -913                                  38449631
384497                 CONTINUE                                         38449731
384498             WHEN SQLWARN0 NOT = SPACES                           38449831
384499             WHEN SQLCODE < ZERO                                  38449931
384500             WHEN SQLCODE > ZERO                                  38450031
384501                 MOVE '4035-OPEN-DEPT-TRB-INCL-CSR'               38450131
384502                                   TO DP013-PARAGRAPH             38450231
384503                 MOVE 'OPEN DEPT ARR INCL SET  CURSOR  '          38450331
384504                                   TO DP013-MESSAGE-TEXT (1)      38450431
384505                 MOVE SQLCA    TO DP013-SQLCA                     38450531
384506                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      38450631
384507                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      38450731
384508                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      38450831
384509                 SET DP013-DB2-ABEND                              38450931
384510                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38451031
384511                 PERFORM DP013-0000-PROCESS-ABEND                 38451131
384512         END-EVALUATE                                             38451231
384513     END-PERFORM.                                                 38451331
384514                                                                  38451431
384515     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38451531
384516         IF SQLCODE = -913                                        38451631
384517             PERFORM 9910-SQL-913-RETURN                          38451731
384518         ELSE                                                     38451831
384519             MOVE '4035-CLOSE-DEPT-TRB-INCL-CSR'                  38451931
384520                                   TO DP013-PARAGRAPH             38452031
384521             MOVE                                                 38452131
384522                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 38452231
384523                                   TO DP013-MESSAGE-TEXT (1)      38452331
384524             MOVE SQLCA            TO DP013-SQLCA                 38452431
384525             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    38452531
384526             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    38452631
384527             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    38452731
384528             SET DP013-DB2-ABEND                                  38452831
384529                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38452931
384530             PERFORM DP013-0000-PROCESS-ABEND                     38453031
384531         END-IF                                                   38453131
384532     END-IF.                                                      38453231
384533                                                                  38453331
384534 4035-OPEN-DEPT-TRB-EXCL-CSR.                                     38453434
384542     PERFORM                                                      38454231
384543         WITH TEST AFTER                                          38454331
384544         VARYING PV-RETRY-COUNTER                                 38454431
384545         FROM 1 BY 1                                              38454531
384546         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38454631
384547                   OR (SQLCODE = ZERO))                           38454731
384548         EXEC SQL                                                 38454831
384549              OPEN DEPT-BY-TRBL-EXCL-SET                          38454932
384550         END-EXEC                                                 38455031
384551                                                                  38455131
384552         EVALUATE TRUE                                            38455231
384553             WHEN SQLCODE = ZERO                                  38455331
384554             WHEN SQLCODE = -904                                  38455431
384555             WHEN SQLCODE = -913                                  38455531
384556                 CONTINUE                                         38455631
384557             WHEN SQLWARN0 NOT = SPACES                           38455731
384558             WHEN SQLCODE < ZERO                                  38455831
384559             WHEN SQLCODE > ZERO                                  38455931
384560                 MOVE '4035-OPEN-DEPT-TRB-EXCL-CSR'               38456031
384561                                   TO DP013-PARAGRAPH             38456131
384562                 MOVE 'OPEN DEPT ARR EXCL SET CURSOR  '           38456231
384563                                   TO DP013-MESSAGE-TEXT (1)      38456331
384564                 MOVE SQLCA    TO DP013-SQLCA                     38456431
384565                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      38456531
384566                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      38456631
384567                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      38456731
384568                 SET DP013-DB2-ABEND                              38456831
384569                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38456931
384570                 PERFORM DP013-0000-PROCESS-ABEND                 38457031
384571         END-EVALUATE                                             38457131
384572     END-PERFORM.                                                 38457231
384573                                                                  38457331
384574     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38457431
384575         IF SQLCODE = -913                                        38457531
384576             PERFORM 9910-SQL-913-RETURN                          38457631
384577         ELSE                                                     38457731
384578             MOVE '4035-CLOSE-DEPT-TRB-EXCL-CSR'                  38457831
384579                                   TO DP013-PARAGRAPH             38457931
384580             MOVE                                                 38458031
384581                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 38458131
384582                                   TO DP013-MESSAGE-TEXT (1)      38458231
384583             MOVE SQLCA            TO DP013-SQLCA                 38458331
384584             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    38458431
384585             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (2)    38458531
384586             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (3)    38458631
384587             SET DP013-DB2-ABEND                                  38458731
384588                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38458831
384589             PERFORM DP013-0000-PROCESS-ABEND                     38458931
384590         END-IF                                                   38459031
384591     END-IF.                                                      38459131
384592                                                                  38459231
384593*----------------------------------------------------------------*38459300
384600* OPEN BUYER BY OLDEST TO NEWEST TROUBLE  CURSOR                 *38460000
384700*----------------------------------------------------------------*38470000
384800 4040-OPEN-BYR-TRB-CSR.                                           38480000
384900     PERFORM                                                      38490000
385000         WITH TEST AFTER                                          38500000
385100         VARYING PV-RETRY-COUNTER                                 38510000
385200         FROM 1 BY 1                                              38520000
385300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38530000
385400                   OR (SQLCODE = ZERO))                           38540000
385500                                                                  38550000
385600         EXEC SQL                                                 38560000
385700              OPEN BUYER-BY-TRBL                                  38570000
385800         END-EXEC                                                 38580000
385900                                                                  38590000
386000         EVALUATE TRUE                                            38600000
386100             WHEN SQLCODE = ZERO                                  38610000
386200             WHEN SQLCODE = -904                                  38620000
386300             WHEN SQLCODE = -913                                  38630000
386400                 CONTINUE                                         38640000
386500             WHEN SQLWARN0 NOT = SPACES                           38650000
386600             WHEN SQLCODE < ZERO                                  38660000
386700             WHEN SQLCODE > ZERO                                  38670000
386800                 MOVE '4015-OPEN-BYR-TRB-CSR      '               38680000
386900                                   TO DP013-PARAGRAPH             38690000
387000                 MOVE 'OPEN TROUBLE BUYER BY TRBL CURSOR'         38700000
387100                                   TO DP013-MESSAGE-TEXT (1)      38710000
387200                 MOVE SQLCA    TO DP013-SQLCA                     38720000
387300                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      38730000
387400                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      38740000
387500                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      38750000
387600                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (4)      38760000
387700                 SET DP013-DB2-ABEND                              38770000
387800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38780000
387900                 PERFORM DP013-0000-PROCESS-ABEND                 38790000
388000         END-EVALUATE                                             38800000
388100     END-PERFORM.                                                 38810000
388200                                                                  38820000
388300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38830000
388400         IF SQLCODE = -913                                        38840000
388500             PERFORM 9910-SQL-913-RETURN                          38850000
388600         ELSE                                                     38860000
388700             MOVE '4040-OPEN-BYR-TRB-CSR      '                   38870000
388800                                            TO DP013-PARAGRAPH    38880000
388900             MOVE                                                 38890000
389000                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 38900000
389100                                   TO DP013-MESSAGE-TEXT (1)      38910000
389200             MOVE SQLCA            TO DP013-SQLCA                 38920000
389300             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    38930000
389400             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    38940000
389500             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    38950000
389600             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    38960000
389700             SET DP013-DB2-ABEND                                  38970000
389800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38980000
389900             PERFORM DP013-0000-PROCESS-ABEND                     38990000
390000         END-IF                                                   39000000
390100     END-IF.                                                      39010000
390200                                                                  39020000
390210 4040-OPEN-BYR-TRB-INCL-CSR.                                      39021031
390220     PERFORM                                                      39022031
390230         WITH TEST AFTER                                          39023031
390240         VARYING PV-RETRY-COUNTER                                 39024031
390250         FROM 1 BY 1                                              39025031
390260         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39026031
390270                   OR (SQLCODE = ZERO))                           39027031
390280                                                                  39028031
390290         EXEC SQL                                                 39029031
390291              OPEN BUYER-BY-TRBL-INCL-SET                         39029131
390292         END-EXEC                                                 39029231
390293                                                                  39029331
390294         EVALUATE TRUE                                            39029431
390295             WHEN SQLCODE = ZERO                                  39029531
390296             WHEN SQLCODE = -904                                  39029631
390297             WHEN SQLCODE = -913                                  39029731
390298                 CONTINUE                                         39029831
390299             WHEN SQLWARN0 NOT = SPACES                           39029931
390300             WHEN SQLCODE < ZERO                                  39030031
390301             WHEN SQLCODE > ZERO                                  39030131
390302                 MOVE '4015-OPEN-BYR-TRB-INCL-CSR '               39030231
390303                                   TO DP013-PARAGRAPH             39030331
390304                 MOVE 'OPEN TRBL BUYR INCL SET TR CURSOR'         39030431
390305                                   TO DP013-MESSAGE-TEXT (1)      39030531
390306                 MOVE SQLCA    TO DP013-SQLCA                     39030631
390307                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      39030731
390308                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      39030831
390309                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      39030931
390310                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (4)      39031031
390311                 SET DP013-DB2-ABEND                              39031131
390312                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39031231
390313                 PERFORM DP013-0000-PROCESS-ABEND                 39031331
390314         END-EVALUATE                                             39031431
390315     END-PERFORM.                                                 39031531
390316                                                                  39031631
390317     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39031731
390318         IF SQLCODE = -913                                        39031831
390319             PERFORM 9910-SQL-913-RETURN                          39031931
390320         ELSE                                                     39032031
390321             MOVE '4040-OPEN-BYR-TRB-INCL-CSR '                   39032131
390322                                            TO DP013-PARAGRAPH    39032231
390323             MOVE                                                 39032331
390324                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 39032431
390325                                   TO DP013-MESSAGE-TEXT (1)      39032531
390326             MOVE SQLCA            TO DP013-SQLCA                 39032631
390327             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    39032731
390328             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    39032831
390329             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    39032931
390330             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    39033031
390331             SET DP013-DB2-ABEND                                  39033131
390332                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39033231
390333             PERFORM DP013-0000-PROCESS-ABEND                     39033331
390334         END-IF                                                   39033431
390335     END-IF.                                                      39033531
390336                                                                  39033631
390337 4040-OPEN-BYR-TRB-EXCL-CSR.                                      39033731
390345     PERFORM                                                      39034531
390346         WITH TEST AFTER                                          39034631
390347         VARYING PV-RETRY-COUNTER                                 39034731
390348         FROM 1 BY 1                                              39034831
390349         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39034931
390350                   OR (SQLCODE = ZERO))                           39035031
390351                                                                  39035131
390352         EXEC SQL                                                 39035231
390353              OPEN BUYER-BY-TRBL-EXCL-SET                         39035331
390354         END-EXEC                                                 39035431
390355                                                                  39035531
390356         EVALUATE TRUE                                            39035631
390357             WHEN SQLCODE = ZERO                                  39035731
390358             WHEN SQLCODE = -904                                  39035831
390359             WHEN SQLCODE = -913                                  39035931
390360                 CONTINUE                                         39036031
390361             WHEN SQLWARN0 NOT = SPACES                           39036131
390362             WHEN SQLCODE < ZERO                                  39036231
390363             WHEN SQLCODE > ZERO                                  39036331
390364                 MOVE '4015-OPEN-BYR-TRB-EXCL-CSR      '          39036431
390365                                   TO DP013-PARAGRAPH             39036531
390366                 MOVE 'OPEN TRBL BUYR EXCL SET TR CURSOR'         39036631
390367                                   TO DP013-MESSAGE-TEXT (1)      39036731
390368                 MOVE SQLCA    TO DP013-SQLCA                     39036831
390369                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      39036931
390370                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)      39037031
390371                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (3)      39037131
390372                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (4)      39037231
390373                 SET DP013-DB2-ABEND                              39037331
390374                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39037431
390375                 PERFORM DP013-0000-PROCESS-ABEND                 39037531
390376         END-EVALUATE                                             39037631
390377     END-PERFORM.                                                 39037731
390378                                                                  39037831
390379     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39037931
390380         IF SQLCODE = -913                                        39038031
390381             PERFORM 9910-SQL-913-RETURN                          39038131
390382         ELSE                                                     39038231
390383             MOVE '4040-OPEN-BYR-TRB-EXCL-CSR      '              39038331
390384                                            TO DP013-PARAGRAPH    39038431
390385             MOVE                                                 39038531
390386                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 39038631
390387                                   TO DP013-MESSAGE-TEXT (1)      39038731
390388             MOVE SQLCA            TO DP013-SQLCA                 39038831
390389             MOVE 'TTRBNTF '       TO DP013-DB2-TABLE-NAME (1)    39038931
390390             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    39039031
390391             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    39039131
390392             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    39039231
390393             SET DP013-DB2-ABEND                                  39039331
390394                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39039431
390395             PERFORM DP013-0000-PROCESS-ABEND                     39039531
390396         END-IF                                                   39039631
390397     END-IF.                                                      39039731
390398                                                                  39039831
390399*----------------------------------------------------------------*39039900
390400* OPEN THE PO-RCVR BY OLDEST TO NEWEST TROUBLE  CURSOR           *39040000
390500*----------------------------------------------------------------*39050000
390600 4047-OPEN-PO-RCVR-TRB-CSR.                                       39060000
390700     PERFORM                                                      39070000
390800         WITH TEST AFTER                                          39080000
390900         VARYING PV-RETRY-COUNTER                                 39090000
391000         FROM 1 BY 1                                              39100000
391100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39110000
391200                   OR (SQLCODE = ZERO))                           39120000
391300                                                                  39130000
391400         EXEC SQL                                                 39140000
391500              OPEN PORCVR-BY-TRBL                                 39150000
391600         END-EXEC                                                 39160000
391700                                                                  39170000
391800         EVALUATE TRUE                                            39180000
391900             WHEN SQLCODE = ZERO                                  39190000
392000             WHEN SQLCODE = -904                                  39200000
392100             WHEN SQLCODE = -913                                  39210000
392200                 CONTINUE                                         39220000
392300             WHEN SQLWARN0 NOT = SPACES                           39230000
392400             WHEN SQLCODE < ZERO                                  39240000
392500             WHEN SQLCODE > ZERO                                  39250000
392600                 MOVE '4047-OPEN-PO-RCVR-TRB-CSR'                 39260000
392700                                   TO DP013-PARAGRAPH             39270000
392800                 MOVE 'OPEN TROUBLE PO BY TRBL CURSOR  '          39280000
392900                                   TO DP013-MESSAGE-TEXT (1)      39290000
393000                 MOVE SQLCA    TO DP013-SQLCA                     39300000
393100                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      39310000
393200                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      39320000
393300                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      39330000
393400                 SET DP013-DB2-ABEND                              39340000
393500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39350000
393600                 PERFORM DP013-0000-PROCESS-ABEND                 39360000
393700         END-EVALUATE                                             39370000
393800     END-PERFORM.                                                 39380000
393900                                                                  39390000
394000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39400000
394100         IF SQLCODE = -913                                        39410000
394200             PERFORM 9910-SQL-913-RETURN                          39420000
394300         ELSE                                                     39430000
394400             MOVE '4047-OPEN-PO-RCVR-TRB-CSR' TO DP013-PARAGRAPH  39440000
394500             MOVE                                                 39450000
394600                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 39460000
394700                                    TO DP013-MESSAGE-TEXT (1)     39470000
394800             MOVE SQLCA             TO DP013-SQLCA                39480000
394900             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   39490000
395000             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   39500000
395100             MOVE 'TRECEIV '        TO DP013-DB2-TABLE-NAME (3)   39510000
395200             SET DP013-DB2-ABEND                                  39520000
395300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39530000
395400             PERFORM DP013-0000-PROCESS-ABEND                     39540000
395500         END-IF                                                   39550000
395600     END-IF.                                                      39560000
395700                                                                  39570000
395710 4047-OPEN-PO-RCVR-TRB-INCL-CSR.                                  39571031
395720     PERFORM                                                      39572031
395730         WITH TEST AFTER                                          39573031
395740         VARYING PV-RETRY-COUNTER                                 39574031
395750         FROM 1 BY 1                                              39575031
395760         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39576031
395770                   OR (SQLCODE = ZERO))                           39577031
395780                                                                  39578031
395790         EXEC SQL                                                 39579031
395791              OPEN PORCVR-BY-TRBL-INCL-SET                        39579131
395792         END-EXEC                                                 39579231
395793                                                                  39579331
395794         EVALUATE TRUE                                            39579431
395795             WHEN SQLCODE = ZERO                                  39579531
395796             WHEN SQLCODE = -904                                  39579631
395797             WHEN SQLCODE = -913                                  39579731
395798                 CONTINUE                                         39579831
395799             WHEN SQLWARN0 NOT = SPACES                           39579931
395800             WHEN SQLCODE < ZERO                                  39580031
395801             WHEN SQLCODE > ZERO                                  39580131
395802                 MOVE '4047-OPEN-PO-RCVR-TRB-INCL-CSR'            39580231
395803                                   TO DP013-PARAGRAPH             39580331
395804                 MOVE 'OPEN TRBL PO INCL SET TRBL CURSOR  '       39580431
395805                                   TO DP013-MESSAGE-TEXT (1)      39580531
395806                 MOVE SQLCA    TO DP013-SQLCA                     39580631
395807                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      39580731
395808                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      39580831
395809                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      39580931
395810                 SET DP013-DB2-ABEND                              39581031
395811                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39581131
395812                 PERFORM DP013-0000-PROCESS-ABEND                 39581231
395813         END-EVALUATE                                             39581331
395814     END-PERFORM.                                                 39581431
395815                                                                  39581531
395816     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39581631
395817         IF SQLCODE = -913                                        39581731
395818             PERFORM 9910-SQL-913-RETURN                          39581831
395819         ELSE                                                     39581931
395820             MOVE '4047-OPEN-PO-RCVR-TRB-INCL-CSR'                39582031
395821                                              TO DP013-PARAGRAPH  39582131
395822             MOVE                                                 39582231
395823                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 39582331
395824                                    TO DP013-MESSAGE-TEXT (1)     39582431
395825             MOVE SQLCA             TO DP013-SQLCA                39582531
395826             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   39582631
395827             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   39582731
395828             MOVE 'TRECEIV '        TO DP013-DB2-TABLE-NAME (3)   39582831
395829             SET DP013-DB2-ABEND                                  39582931
395830                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39583031
395831             PERFORM DP013-0000-PROCESS-ABEND                     39583131
395832         END-IF                                                   39583231
395833     END-IF.                                                      39583331
395834                                                                  39583431
395835 4047-OPEN-PO-RCVR-TRB-EXCL-CSR.                                  39583531
395843     PERFORM                                                      39584331
395844         WITH TEST AFTER                                          39584433
395845         VARYING PV-RETRY-COUNTER                                 39584531
395846         FROM 1 BY 1                                              39584631
395847         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39584731
395848                   OR (SQLCODE = ZERO))                           39584831
395849                                                                  39584931
395850         EXEC SQL                                                 39585031
395851              OPEN PORCVR-BY-TRBL-EXCL-SET                        39585132
395852         END-EXEC                                                 39585231
395853                                                                  39585331
395854         EVALUATE TRUE                                            39585431
395855             WHEN SQLCODE = ZERO                                  39585531
395856             WHEN SQLCODE = -904                                  39585631
395857             WHEN SQLCODE = -913                                  39585731
395858                 CONTINUE                                         39585831
395859             WHEN SQLWARN0 NOT = SPACES                           39585931
395860             WHEN SQLCODE < ZERO                                  39586031
395861             WHEN SQLCODE > ZERO                                  39586131
395862                 MOVE '4047-OPEN-PO-RCVR-TRB-EXCL-CSR'            39586231
395863                                   TO DP013-PARAGRAPH             39586331
395864                 MOVE 'OPEN TRBL PO EXCL SET TRBL CURSOR  '       39586431
395865                                   TO DP013-MESSAGE-TEXT (1)      39586531
395866                 MOVE SQLCA    TO DP013-SQLCA                     39586631
395867                 MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)      39586731
395868                 MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)      39586831
395869                 MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)      39586931
395870                 SET DP013-DB2-ABEND                              39587031
395871                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39587131
395872                 PERFORM DP013-0000-PROCESS-ABEND                 39587231
395873         END-EVALUATE                                             39587331
395874     END-PERFORM.                                                 39587431
395875                                                                  39587531
395876     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39587631
395877         IF SQLCODE = -913                                        39587731
395878             PERFORM 9910-SQL-913-RETURN                          39587831
395879         ELSE                                                     39587931
395880             MOVE '4047-OPEN-PO-RCVR-TRB-EXCL-CSR'                39588031
395881                                              TO DP013-PARAGRAPH  39588131
395882             MOVE                                                 39588231
395883                'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR' 39588331
395884                                    TO DP013-MESSAGE-TEXT (1)     39588431
395885             MOVE SQLCA             TO DP013-SQLCA                39588531
395886             MOVE 'TTRBNTF '        TO DP013-DB2-TABLE-NAME (1)   39588631
395887             MOVE 'TTRBRSN '        TO DP013-DB2-TABLE-NAME (2)   39588731
395888             MOVE 'TRECEIV '        TO DP013-DB2-TABLE-NAME (3)   39588831
395889             SET DP013-DB2-ABEND                                  39588931
395890                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39589031
395891             PERFORM DP013-0000-PROCESS-ABEND                     39589131
395892         END-IF                                                   39589231
395893     END-IF.                                                      39589331
395894                                                                  39589431
395895*----------------------------------------------------------------*39589500
395900* CLOSE THE OPER UNIT BY ARRIVAL DATE CURSOR                     *39590000
396000*----------------------------------------------------------------*39600000
396100 4050-CLOSE-OPER-UNIT-ARR-CSR.                                    39610000
396200     EXEC SQL                                                     39620000
396300         CLOSE OPER-UNT-BY-ARRIV                                  39630000
396400     END-EXEC                                                     39640000
396500                                                                  39650000
396600     EVALUATE TRUE                                                39660000
396700         WHEN SQLCODE = ZERO                                      39670000
396800             CONTINUE                                             39680000
396900         WHEN SQLWARN0 NOT = SPACES                               39690000
397000         WHEN SQLCODE < ZERO                                      39700000
397100         WHEN SQLCODE > ZERO                                      39710000
397200             MOVE '4050-CLOSE-OPER-UNT-ARR-CSR'                   39720000
397300                               TO DP013-PARAGRAPH                 39730000
397400             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      39740000
397500                               TO DP013-MESSAGE-TEXT (1)          39750000
397600             MOVE SQLCA        TO DP013-SQLCA                     39760000
397700             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          39770000
397800             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          39780000
397900             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          39790000
398000             SET DP013-DB2-ABEND                                  39800000
398100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39810000
398200             PERFORM DP013-0000-PROCESS-ABEND                     39820000
398300     END-EVALUATE.                                                39830000
398400                                                                  39840000
398410 4050-CLOSE-OPER-UNIT-ARR-INCL.                                   39841034
398420     EXEC SQL                                                     39842031
398430         CLOSE OPER-UNT-BY-ARRIV-INCL-SET                         39843031
398440     END-EXEC                                                     39844031
398450                                                                  39845031
398460     EVALUATE TRUE                                                39846031
398470         WHEN SQLCODE = ZERO                                      39847031
398480             CONTINUE                                             39848031
398490         WHEN SQLWARN0 NOT = SPACES                               39849031
398491         WHEN SQLCODE < ZERO                                      39849131
398492         WHEN SQLCODE > ZERO                                      39849231
398493             MOVE '4050-CLOSE-OPER-UNT-ARR-INCL-CSR'              39849331
398494                               TO DP013-PARAGRAPH                 39849431
398495             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      39849531
398496                               TO DP013-MESSAGE-TEXT (1)          39849631
398497             MOVE SQLCA        TO DP013-SQLCA                     39849731
398498             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          39849831
398499             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          39849931
398500             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          39850031
398501             SET DP013-DB2-ABEND                                  39850131
398502                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39850231
398503             PERFORM DP013-0000-PROCESS-ABEND                     39850331
398504     END-EVALUATE.                                                39850431
398505                                                                  39850531
398506 4050-CLOSE-OPER-UNIT-ARR-EXCL.                                   39850634
398514     EXEC SQL                                                     39851434
398515         CLOSE OPER-UNT-BY-ARRIV-EXCL-SET                         39851534
398516     END-EXEC                                                     39851634
398517                                                                  39851734
398518     EVALUATE TRUE                                                39851834
398519         WHEN SQLCODE = ZERO                                      39851934
398520             CONTINUE                                             39852034
398521         WHEN SQLWARN0 NOT = SPACES                               39852134
398522         WHEN SQLCODE < ZERO                                      39852234
398523         WHEN SQLCODE > ZERO                                      39852334
398524             MOVE '4050-CLOSE-OPER-UNT-ARR-EXCL-CSR'              39852434
398525                               TO DP013-PARAGRAPH                 39852534
398526             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      39852634
398527                               TO DP013-MESSAGE-TEXT (1)          39852734
398528             MOVE SQLCA        TO DP013-SQLCA                     39852834
398529             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          39852934
398530             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          39853034
398531             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          39853134
398532             SET DP013-DB2-ABEND                                  39853234
398533                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39853334
398534             PERFORM DP013-0000-PROCESS-ABEND                     39853434
398535     END-EVALUATE.                                                39853534
398536                                                                  39853634
398540*----------------------------------------------------------------*39854000
398600* CLOSE THE DEPARTMENT BY ARRIVAL DATE CURSOR                    *39860000
398700*----------------------------------------------------------------*39870000
398800 4055-CLOSE-DEPT-ARR-CSR.                                         39880034
398900     EXEC SQL                                                     39890000
399000         CLOSE DEPT-BY-ARRIVAL                                    39900034
399100     END-EXEC                                                     39910000
399200                                                                  39920000
399300     EVALUATE TRUE                                                39930000
399400         WHEN SQLCODE = ZERO                                      39940000
399500             CONTINUE                                             39950000
399600         WHEN SQLWARN0 NOT = SPACES                               39960000
399700         WHEN SQLCODE < ZERO                                      39970000
399800         WHEN SQLCODE > ZERO                                      39980000
399900             MOVE '4055-CLOSE-DEPT-ARR-CSR'                       39990034
399910                                            TO DP013-PARAGRAPH    39991031
400000             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40000000
400100                               TO DP013-MESSAGE-TEXT (1)          40010000
400200             MOVE SQLCA        TO DP013-SQLCA                     40020000
400300             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40030000
400400             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40040000
400500             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40050000
400600             SET DP013-DB2-ABEND                                  40060000
400700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40070000
400800             PERFORM DP013-0000-PROCESS-ABEND                     40080000
400900     END-EVALUATE.                                                40090000
401000                                                                  40100000
401100                                                                  40110000
401110 4055-CLOSE-DEPT-ARR-INCL-CSR.                                    40111034
401120     EXEC SQL                                                     40112034
401130         CLOSE DEPT-BY-ARRIVAL-INCL-SET                           40113034
401140     END-EXEC                                                     40114034
401150                                                                  40115034
401160     EVALUATE TRUE                                                40116034
401170         WHEN SQLCODE = ZERO                                      40117034
401180             CONTINUE                                             40118034
401190         WHEN SQLWARN0 NOT = SPACES                               40119034
401191         WHEN SQLCODE < ZERO                                      40119134
401192         WHEN SQLCODE > ZERO                                      40119234
401193             MOVE '4055-CLOSE-DEPT-ARR-INCL-CSR'                  40119334
401194                                            TO DP013-PARAGRAPH    40119434
401195             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40119534
401196                               TO DP013-MESSAGE-TEXT (1)          40119634
401197             MOVE SQLCA        TO DP013-SQLCA                     40119734
401198             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40119834
401199             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40119934
401200             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40120034
401201             SET DP013-DB2-ABEND                                  40120134
401202                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40120234
401203             PERFORM DP013-0000-PROCESS-ABEND                     40120334
401204     END-EVALUATE.                                                40120434
401205                                                                  40120534
401206                                                                  40120634
401207 4055-CLOSE-DEPT-ARR-EXCL-CSR.                                    40120734
401208     EXEC SQL                                                     40120834
401209         CLOSE DEPT-BY-ARRIVAL-EXCL-SET                           40120934
401210     END-EXEC                                                     40121034
401211                                                                  40121134
401212     EVALUATE TRUE                                                40121234
401213         WHEN SQLCODE = ZERO                                      40121334
401214             CONTINUE                                             40121434
401215         WHEN SQLWARN0 NOT = SPACES                               40121534
401216         WHEN SQLCODE < ZERO                                      40121634
401217         WHEN SQLCODE > ZERO                                      40121734
401218             MOVE '4055-CLOSE-DEPT-ARR-EXCL-CSR'                  40121834
401219                                            TO DP013-PARAGRAPH    40121934
401220             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40122034
401221                               TO DP013-MESSAGE-TEXT (1)          40122134
401222             MOVE SQLCA        TO DP013-SQLCA                     40122234
401223             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40122334
401224             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40122434
401225             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40122534
401226             SET DP013-DB2-ABEND                                  40122634
401227                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40122734
401228             PERFORM DP013-0000-PROCESS-ABEND                     40122834
401229     END-EVALUATE.                                                40122934
401230                                                                  40123034
401231                                                                  40123134
401240*----------------------------------------------------------------*40124000
401300* CLOSE THE BUYER  BY ARRIVAL CURSOR                             *40130000
401400*----------------------------------------------------------------*40140000
401500 4060-CLOSE-BYR-ARR-CSR.                                          40150000
401600     EXEC SQL                                                     40160000
401700         CLOSE BUYER-BY-ARRIVAL                                   40170000
401800     END-EXEC                                                     40180000
401900                                                                  40190000
402000     EVALUATE TRUE                                                40200000
402100         WHEN SQLCODE = ZERO                                      40210000
402200             CONTINUE                                             40220000
402300         WHEN SQLWARN0 NOT = SPACES                               40230000
402400         WHEN SQLCODE < ZERO                                      40240000
402500         WHEN SQLCODE > ZERO                                      40250000
402600             MOVE '4060-CLOSE-BYR-ARR-CSR' TO DP013-PARAGRAPH     40260000
402700             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40270000
402800                               TO DP013-MESSAGE-TEXT (1)          40280000
402900             MOVE SQLCA        TO DP013-SQLCA                     40290000
403000             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40300000
403100             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    40310000
403200             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    40320000
403300             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    40330000
403400             SET DP013-DB2-ABEND                                  40340000
403500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40350000
403600             PERFORM DP013-0000-PROCESS-ABEND                     40360000
403700     END-EVALUATE.                                                40370000
403800                                                                  40380000
403810 4060-CLOSE-BYR-ARR-INCL-CSR.                                     40381031
403820     EXEC SQL                                                     40382031
403830         CLOSE BUYER-BY-ARRIVAL-INCL-SET                          40383031
403840     END-EXEC                                                     40384031
403850                                                                  40385031
403860     EVALUATE TRUE                                                40386031
403870         WHEN SQLCODE = ZERO                                      40387031
403880             CONTINUE                                             40388031
403890         WHEN SQLWARN0 NOT = SPACES                               40389031
403891         WHEN SQLCODE < ZERO                                      40389131
403892         WHEN SQLCODE > ZERO                                      40389231
403893             MOVE '4060-CLOSE-BYR-ARR-INCL-CSR' TO DP013-PARAGRAPH40389331
403894             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40389431
403895                               TO DP013-MESSAGE-TEXT (1)          40389531
403896             MOVE SQLCA        TO DP013-SQLCA                     40389631
403897             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40389731
403898             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    40389831
403899             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    40389931
403900             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    40390031
403901             SET DP013-DB2-ABEND                                  40390131
403902                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40390231
403903             PERFORM DP013-0000-PROCESS-ABEND                     40390331
403904     END-EVALUATE.                                                40390431
403905                                                                  40390531
403906 4060-CLOSE-BYR-ARR-EXCL-CSR.                                     40390631
403907     EXEC SQL                                                     40390731
403908         CLOSE BUYER-BY-ARRIVAL-EXCL-SET                          40390831
403909     END-EXEC                                                     40390931
403910                                                                  40391031
403911     EVALUATE TRUE                                                40391131
403912         WHEN SQLCODE = ZERO                                      40391231
403913             CONTINUE                                             40391331
403914         WHEN SQLWARN0 NOT = SPACES                               40391431
403915         WHEN SQLCODE < ZERO                                      40391531
403916         WHEN SQLCODE > ZERO                                      40391631
403917             MOVE '4060-CLOSE-BYR-ARR-EXCL-CSR'                   40391731
403918                                           TO DP013-PARAGRAPH     40391831
403919             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40391931
403920                               TO DP013-MESSAGE-TEXT (1)          40392031
403921             MOVE SQLCA        TO DP013-SQLCA                     40392131
403922             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40392231
403923             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    40392331
403924             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    40392431
403925             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    40392531
403926             SET DP013-DB2-ABEND                                  40392631
403927                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40392731
403928             PERFORM DP013-0000-PROCESS-ABEND                     40392831
403929     END-EVALUATE.                                                40392931
403930                                                                  40393031
403940*----------------------------------------------------------------*40394031
404000* CLOSE THE PO/RCVR BY ARRIVAL CURSOR                            *40400000
404100*----------------------------------------------------------------*40410000
404200 4070-CLOSE-PO-RCVR-ARR-CSR.                                      40420000
404300     EXEC SQL                                                     40430000
404400         CLOSE PORCVR-BY-ARRIVAL                                  40440000
404500     END-EXEC                                                     40450000
404600                                                                  40460000
404700     EVALUATE TRUE                                                40470000
404800         WHEN SQLCODE = ZERO                                      40480000
404900             CONTINUE                                             40490000
405000         WHEN SQLWARN0 NOT = SPACES                               40500000
405100         WHEN SQLCODE < ZERO                                      40510000
405200         WHEN SQLCODE > ZERO                                      40520000
405300             MOVE '4070-CLOSE-PO-RCVR-ARR-CSR' TO DP013-PARAGRAPH 40530000
405400             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40540000
405500                               TO DP013-MESSAGE-TEXT (1)          40550000
405600             MOVE SQLCA        TO DP013-SQLCA                     40560000
405700             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40570000
405800             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40580000
405900             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40590000
406000             SET DP013-DB2-ABEND                                  40600000
406100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40610000
406200             PERFORM DP013-0000-PROCESS-ABEND                     40620000
406300     END-EVALUATE.                                                40630000
406400                                                                  40640000
406410 4070-CLOSE-PO-RCVR-ARR-INCL.                                     40641034
406420     EXEC SQL                                                     40642031
406430         CLOSE PORCVR-BY-ARRIVAL-INCL-SET                         40643031
406440     END-EXEC                                                     40644031
406450                                                                  40645031
406460     EVALUATE TRUE                                                40646031
406470         WHEN SQLCODE = ZERO                                      40647031
406480             CONTINUE                                             40648031
406490         WHEN SQLWARN0 NOT = SPACES                               40649031
406491         WHEN SQLCODE < ZERO                                      40649131
406492         WHEN SQLCODE > ZERO                                      40649231
406493             MOVE '4070-CLOSE-PO-RCVR-ARR-INCL'                   40649334
406494                                               TO DP013-PARAGRAPH 40649431
406495             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40649531
406496                               TO DP013-MESSAGE-TEXT (1)          40649631
406497             MOVE SQLCA        TO DP013-SQLCA                     40649731
406498             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40649831
406499             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40649931
406500             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40650031
406501             SET DP013-DB2-ABEND                                  40650131
406502                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40650231
406503             PERFORM DP013-0000-PROCESS-ABEND                     40650331
406504     END-EVALUATE.                                                40650431
406505                                                                  40650531
406506 4070-CLOSE-PO-RCVR-ARR-EXCL.                                     40650634
406507     EXEC SQL                                                     40650731
406508         CLOSE PORCVR-BY-ARRIVAL-EXCL-SET                         40650831
406509     END-EXEC                                                     40650931
406510                                                                  40651031
406511     EVALUATE TRUE                                                40651131
406512         WHEN SQLCODE = ZERO                                      40651231
406513             CONTINUE                                             40651331
406514         WHEN SQLWARN0 NOT = SPACES                               40651431
406515         WHEN SQLCODE < ZERO                                      40651531
406516         WHEN SQLCODE > ZERO                                      40651631
406517             MOVE '4070-CLOSE-PO-RCVR-ARR-EXCL'                   40651734
406518                                               TO DP013-PARAGRAPH 40651831
406519             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40651931
406520                               TO DP013-MESSAGE-TEXT (1)          40652031
406521             MOVE SQLCA        TO DP013-SQLCA                     40652131
406522             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40652231
406523             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40652331
406524             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40652431
406525             SET DP013-DB2-ABEND                                  40652531
406526                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40652631
406527             PERFORM DP013-0000-PROCESS-ABEND                     40652731
406528     END-EVALUATE.                                                40652831
406529                                                                  40652931
406530*----------------------------------------------------------------*40653000
406600* CLOSE THE OPER UNIT BY OLDEST TO NEWEST TROUBLE                *40660000
406700*----------------------------------------------------------------*40670000
406800 4075-CLOSE-OPER-UNIT-TRB-CSR.                                    40680000
406900     EXEC SQL                                                     40690000
407000         CLOSE OPER-UNT-BY-TRBL                                   40700000
407100     END-EXEC                                                     40710000
407200                                                                  40720000
407300     EVALUATE TRUE                                                40730000
407400         WHEN SQLCODE = ZERO                                      40740000
407500             CONTINUE                                             40750000
407600         WHEN SQLWARN0 NOT = SPACES                               40760000
407700         WHEN SQLCODE < ZERO                                      40770000
407800         WHEN SQLCODE > ZERO                                      40780000
407900             MOVE '4075-CLOSE-OPER-UNT-TRB-CSR' TO DP013-PARAGRAPH40790000
408000             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40800000
408100                               TO DP013-MESSAGE-TEXT (1)          40810000
408200             MOVE SQLCA        TO DP013-SQLCA                     40820000
408300             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40830000
408400             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40840000
408500             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40850000
408600             SET DP013-DB2-ABEND                                  40860000
408700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40870000
408800             PERFORM DP013-0000-PROCESS-ABEND                     40880000
408900     END-EVALUATE.                                                40890000
409000                                                                  40900000
409010 4075-CLOSE-OPER-UNIT-TRB-INCL.                                   40901034
409020     EXEC SQL                                                     40902031
409030         CLOSE OPER-UNT-BY-TRBL-INCL-SET                          40903031
409040     END-EXEC                                                     40904031
409050                                                                  40905031
409060     EVALUATE TRUE                                                40906031
409070         WHEN SQLCODE = ZERO                                      40907031
409080             CONTINUE                                             40908031
409090         WHEN SQLWARN0 NOT = SPACES                               40909031
409091         WHEN SQLCODE < ZERO                                      40909131
409092         WHEN SQLCODE > ZERO                                      40909231
409093             MOVE '4075-CLOSE-OPER-UNT-TRB-INCL'                  40909334
409094                                                TO DP013-PARAGRAPH40909431
409095             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40909531
409096                               TO DP013-MESSAGE-TEXT (1)          40909631
409097             MOVE SQLCA        TO DP013-SQLCA                     40909731
409098             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40909831
409099             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40909931
409100             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40910031
409101             SET DP013-DB2-ABEND                                  40910131
409102                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40910231
409103             PERFORM DP013-0000-PROCESS-ABEND                     40910331
409104     END-EVALUATE.                                                40910431
409105                                                                  40910531
409106 4075-CLOSE-OPER-UNIT-TRB-EXCL.                                   40910634
409107     EXEC SQL                                                     40910731
409108         CLOSE OPER-UNT-BY-TRBL-EXCL-SET                          40910831
409109     END-EXEC                                                     40910931
409110                                                                  40911031
409111     EVALUATE TRUE                                                40911131
409112         WHEN SQLCODE = ZERO                                      40911231
409113             CONTINUE                                             40911331
409114         WHEN SQLWARN0 NOT = SPACES                               40911431
409115         WHEN SQLCODE < ZERO                                      40911531
409116         WHEN SQLCODE > ZERO                                      40911631
409117             MOVE '4075-CLOSE-OPER-UNT-TRB-EXCL'                  40911734
409118                                                TO DP013-PARAGRAPH40911831
409119             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      40911931
409120                               TO DP013-MESSAGE-TEXT (1)          40912031
409121             MOVE SQLCA        TO DP013-SQLCA                     40912131
409122             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          40912231
409123             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          40912331
409124             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          40912431
409125             SET DP013-DB2-ABEND                                  40912531
409126                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40912631
409127             PERFORM DP013-0000-PROCESS-ABEND                     40912731
409128     END-EVALUATE.                                                40912831
409129                                                                  40912931
409130*----------------------------------------------------------------*40913000
409200* CLOSE THE DEPARTMENT BY OLDEST TO NEWEST TROUBLE               *40920000
409300*----------------------------------------------------------------*40930000
409400 4080-CLOSE-DEPT-TRB-CSR.                                         40940000
409500     EXEC SQL                                                     40950000
409600         CLOSE DEPT-BY-TRBL                                       40960000
409700     END-EXEC                                                     40970000
409800                                                                  40980000
409900     EVALUATE TRUE                                                40990000
410000         WHEN SQLCODE = ZERO                                      41000000
410100             CONTINUE                                             41010000
410200         WHEN SQLWARN0 NOT = SPACES                               41020000
410300         WHEN SQLCODE < ZERO                                      41030000
410400         WHEN SQLCODE > ZERO                                      41040000
410500             MOVE '4080-CLOSE-DEPT-TRB-CSR'                       41050000
410600                               TO DP013-PARAGRAPH                 41060000
410700             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41070000
410800                               TO DP013-MESSAGE-TEXT (1)          41080000
410900             MOVE SQLCA        TO DP013-SQLCA                     41090000
411000             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41100000
411100             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          41110000
411200             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          41120000
411300             SET DP013-DB2-ABEND                                  41130000
411400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41140000
411500             PERFORM DP013-0000-PROCESS-ABEND                     41150000
411600     END-EVALUATE.                                                41160000
411700                                                                  41170000
411800                                                                  41180000
411810 4080-CLOSE-DEPT-TRB-INCL-CSR.                                    41181031
411820     EXEC SQL                                                     41182031
411830         CLOSE DEPT-BY-TRBL-INCL-SET                              41183031
411840     END-EXEC                                                     41184031
411850                                                                  41185031
411860     EVALUATE TRUE                                                41186031
411870         WHEN SQLCODE = ZERO                                      41187031
411880             CONTINUE                                             41188031
411890         WHEN SQLWARN0 NOT = SPACES                               41189031
411891         WHEN SQLCODE < ZERO                                      41189131
411892         WHEN SQLCODE > ZERO                                      41189231
411893             MOVE '4080-CLOSE-DEPT-TRB-INCL-CSR'                  41189331
411894                               TO DP013-PARAGRAPH                 41189431
411895             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41189531
411896                               TO DP013-MESSAGE-TEXT (1)          41189631
411897             MOVE SQLCA        TO DP013-SQLCA                     41189731
411898             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41189831
411899             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          41189931
411900             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          41190031
411901             SET DP013-DB2-ABEND                                  41190131
411902                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41190231
411903             PERFORM DP013-0000-PROCESS-ABEND                     41190331
411904     END-EVALUATE.                                                41190431
411905                                                                  41190531
411906                                                                  41190631
411907 4080-CLOSE-DEPT-TRB-EXCL-CSR.                                    41190731
411908     EXEC SQL                                                     41190831
411909         CLOSE DEPT-BY-TRBL-EXCL-SET                              41190931
411910     END-EXEC                                                     41191031
411911                                                                  41191131
411912     EVALUATE TRUE                                                41191231
411913         WHEN SQLCODE = ZERO                                      41191331
411914             CONTINUE                                             41191431
411915         WHEN SQLWARN0 NOT = SPACES                               41191531
411916         WHEN SQLCODE < ZERO                                      41191631
411917         WHEN SQLCODE > ZERO                                      41191731
411918             MOVE '4080-CLOSE-DEPT-TRB-EXCL-CSR'                  41191831
411919                               TO DP013-PARAGRAPH                 41191931
411920             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41192031
411921                               TO DP013-MESSAGE-TEXT (1)          41192131
411922             MOVE SQLCA        TO DP013-SQLCA                     41192231
411923             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41192331
411924             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          41192431
411925             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          41192531
411926             SET DP013-DB2-ABEND                                  41192631
411927                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41192731
411928             PERFORM DP013-0000-PROCESS-ABEND                     41192831
411929     END-EVALUATE.                                                41192931
411930                                                                  41193031
411931                                                                  41193131
411940*----------------------------------------------------------------*41194000
412000* CLOSE THE BUYER  BY OLDEST TO NEWEST TROUBLE                   *41200000
412100*----------------------------------------------------------------*41210000
412200 4085-CLOSE-BYR-TRB-CSR.                                          41220000
412300     EXEC SQL                                                     41230000
412400         CLOSE BUYER-BY-TRBL                                      41240000
412500     END-EXEC                                                     41250000
412600                                                                  41260000
412700     EVALUATE TRUE                                                41270000
412800         WHEN SQLCODE = ZERO                                      41280000
412900             CONTINUE                                             41290000
413000         WHEN SQLWARN0 NOT = SPACES                               41300000
413100         WHEN SQLCODE < ZERO                                      41310000
413200         WHEN SQLCODE > ZERO                                      41320000
413300             MOVE '4085-CLOSE-BYR-TRB-CSR' TO DP013-PARAGRAPH     41330000
413400             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41340000
413500                               TO DP013-MESSAGE-TEXT (1)          41350000
413600             MOVE SQLCA        TO DP013-SQLCA                     41360000
413700             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41370000
413800             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    41380000
413900             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    41390000
414000             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    41400000
414100             SET DP013-DB2-ABEND                                  41410000
414200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41420000
414300             PERFORM DP013-0000-PROCESS-ABEND                     41430000
414400     END-EVALUATE.                                                41440000
414500                                                                  41450000
414510 4085-CLOSE-BYR-TRB-INCL-CSR.                                     41451032
414520     EXEC SQL                                                     41452031
414530         CLOSE BUYER-BY-TRBL-INCL-SET                             41453032
414540     END-EXEC                                                     41454031
414550                                                                  41455031
414560     EVALUATE TRUE                                                41456031
414570         WHEN SQLCODE = ZERO                                      41457031
414580             CONTINUE                                             41458031
414590         WHEN SQLWARN0 NOT = SPACES                               41459031
414591         WHEN SQLCODE < ZERO                                      41459131
414592         WHEN SQLCODE > ZERO                                      41459231
414593             MOVE '4085-CLOSE-BYR-TRB-INCL-CSR'                   41459332
414594                                           TO DP013-PARAGRAPH     41459431
414595             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41459531
414596                               TO DP013-MESSAGE-TEXT (1)          41459631
414597             MOVE SQLCA        TO DP013-SQLCA                     41459731
414598             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41459831
414599             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    41459931
414600             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    41460031
414601             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    41460131
414602             SET DP013-DB2-ABEND                                  41460231
414603                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41460331
414604             PERFORM DP013-0000-PROCESS-ABEND                     41460431
414605     END-EVALUATE.                                                41460531
414606                                                                  41460631
414607 4085-CLOSE-BYR-TRB-EXCL-CSR.                                     41460732
414608     EXEC SQL                                                     41460831
414609         CLOSE BUYER-BY-TRBL-EXCL-SET                             41460932
414610     END-EXEC                                                     41461031
414611                                                                  41461131
414612     EVALUATE TRUE                                                41461231
414613         WHEN SQLCODE = ZERO                                      41461331
414614             CONTINUE                                             41461431
414615         WHEN SQLWARN0 NOT = SPACES                               41461531
414616         WHEN SQLCODE < ZERO                                      41461631
414617         WHEN SQLCODE > ZERO                                      41461731
414618             MOVE '4085-CLOSE-BYR-TRB-EXCL-CSR'                   41461832
414619                                           TO DP013-PARAGRAPH     41461931
414620             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41462031
414621                               TO DP013-MESSAGE-TEXT (1)          41462131
414622             MOVE SQLCA        TO DP013-SQLCA                     41462231
414623             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41462331
414624             MOVE 'TMDSEAR '       TO DP013-DB2-TABLE-NAME (2)    41462431
414625             MOVE 'TTRBRSN '       TO DP013-DB2-TABLE-NAME (3)    41462531
414626             MOVE 'TRECEIV '       TO DP013-DB2-TABLE-NAME (4)    41462631
414627             SET DP013-DB2-ABEND                                  41462731
414628                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41462831
414629             PERFORM DP013-0000-PROCESS-ABEND                     41462931
414630     END-EVALUATE.                                                41463031
414631                                                                  41463131
414640*----------------------------------------------------------------*41464031
414700* CLOSE THE PO/RCVR BY OLDEST TO NEWEST TROUBLE                  *41470000
414800*----------------------------------------------------------------*41480000
414900 4095-CLOSE-PO-RCVR-TRB-CSR.                                      41490000
415000     EXEC SQL                                                     41500000
415100         CLOSE PORCVR-BY-TRBL                                     41510000
415200     END-EXEC                                                     41520000
415300                                                                  41530000
415400     EVALUATE TRUE                                                41540000
415500         WHEN SQLCODE = ZERO                                      41550000
415600             CONTINUE                                             41560000
415700         WHEN SQLWARN0 NOT = SPACES                               41570000
415800         WHEN SQLCODE < ZERO                                      41580000
415900         WHEN SQLCODE > ZERO                                      41590000
416000             MOVE '4095-CLOSE-PO-RCVR-TRB-CSR' TO DP013-PARAGRAPH 41600000
416100             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41610000
416200                               TO DP013-MESSAGE-TEXT (1)          41620000
416300             MOVE SQLCA        TO DP013-SQLCA                     41630000
416400             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41640000
416500             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          41650000
416600             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          41660000
416700             SET DP013-DB2-ABEND                                  41670000
416800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41680000
416900             PERFORM DP013-0000-PROCESS-ABEND                     41690000
417000     END-EVALUATE.                                                41700000
417100                                                                  41710000
417110 4095-CLOSE-PO-RCVR-TRB-INCL.                                     41711034
417120     EXEC SQL                                                     41712031
417130         CLOSE PORCVR-BY-TRBL-INCL-SET                            41713032
417140     END-EXEC                                                     41714031
417150                                                                  41715031
417160     EVALUATE TRUE                                                41716031
417170         WHEN SQLCODE = ZERO                                      41717031
417180             CONTINUE                                             41718031
417190         WHEN SQLWARN0 NOT = SPACES                               41719031
417191         WHEN SQLCODE < ZERO                                      41719134
417192         WHEN SQLCODE > ZERO                                      41719231
417193             MOVE '4095-CLOSE-PO-RCVR-TRB-INCL'                   41719334
417194                                               TO DP013-PARAGRAPH 41719432
417195             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41719531
417196                               TO DP013-MESSAGE-TEXT (1)          41719631
417197             MOVE SQLCA        TO DP013-SQLCA                     41719731
417198             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41719831
417199             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          41719931
417200             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          41720031
417201             SET DP013-DB2-ABEND                                  41720131
417202                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41720231
417203             PERFORM DP013-0000-PROCESS-ABEND                     41720331
417204     END-EVALUATE.                                                41720431
417205                                                                  41720531
417206 4095-CLOSE-PO-RCVR-TRB-EXCL.                                     41720634
417207     EXEC SQL                                                     41720731
417208         CLOSE PORCVR-BY-TRBL-EXCL-SET                            41720832
417209     END-EXEC                                                     41720931
417210                                                                  41721031
417211     EVALUATE TRUE                                                41721131
417212         WHEN SQLCODE = ZERO                                      41721231
417213             CONTINUE                                             41721331
417214         WHEN SQLWARN0 NOT = SPACES                               41721431
417215         WHEN SQLCODE < ZERO                                      41721531
417216         WHEN SQLCODE > ZERO                                      41721631
417217             MOVE '4095-CLOSE-PO-RCVR-TRB-EXCL'                   41721734
417218                                               TO DP013-PARAGRAPH 41721831
417219             MOVE 'CLOSE SYSTEM TROUBLE NOTIFICATION CURSOR'      41721931
417220                               TO DP013-MESSAGE-TEXT (1)          41722031
417221             MOVE SQLCA        TO DP013-SQLCA                     41722131
417222             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          41722231
417223             MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)          41722331
417224             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (3)          41722431
417225             SET DP013-DB2-ABEND                                  41722531
417226                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41722631
417227             PERFORM DP013-0000-PROCESS-ABEND                     41722731
417228     END-EVALUATE.                                                41722831
417229                                                                  41722931
417230*----------------------------------------------------------------*41723000
417300*    SET UP THE HOST VARIABLES.                                  *41730000
417400*----------------------------------------------------------------*41740000
417500 4100-PREPARE-CURSOR.                                             41750000
417600     MOVE +0000             TO DK-OPER-UNT-ID.                    41760000
417700     MOVE +0000             TO DK-OPER-UNT-ID-LOW.                41770000
417800     MOVE +9999             TO DK-OPER-UNT-ID-HIGH.               41780000
417900     MOVE '000'             TO DK-DEPT-LOW.                       41790000
418000     MOVE '999'             TO DK-DEPT-HIGH.                      41800000
418100     INITIALIZE                DK-PO-NBR                          41810000
418200                               DK-PO-NBR-LOW.                     41820000
418300     MOVE +999999999        TO DK-PO-NBR-HIGH.                    41830000
418400     MOVE +000              TO DK-TRBL-RSN-LOW.                   41840000
418500     MOVE +899              TO DK-TRBL-RSN-HIGH.                  41850000
418600     MOVE SPACES            TO DK-NOTIF-STAT-1                    41860000
418700                               DK-NOTIF-STAT-2                    41870000
418800                               DK-NOTIF-STAT-3                    41880000
418900                               DK-NOTIF-STAT-4                    41890000
419000                               DK-RESP-AREA-1                     41900000
419100                               DK-RESP-AREA-2                     41910000
419200                               DK-RESP-AREA-3.                    41920000
419300     MOVE PC-DUMMY-DB2-DATE-LOW  TO DK-LOW-REC-TMST.              41930000
419400     MOVE PC-DUMMY-DB2-DATE-HIGH TO DK-HIGH-REC-TMST.             41940000
419500                                                                  41950000
419510     IF  ASC-INCLD-SET-CDE  OR                                    41951027
419520         ASC-EXCLD-SET-CDE                                        41952027
419530         IF  ASC-SET-CODE-1  >  SPACES                            41953027
419531             MOVE  ASC-SET-CODE-1  TO  DK-SEASET-SHRT-NM-1        41953127
419532                                       DK-SEASET-SHRT-NM-2        41953227
419533                                       DK-SEASET-SHRT-NM-3        41953327
419534                                       DK-SEASET-SHRT-NM-4        41953427
419535                                       DK-SEASET-SHRT-NM-5        41953527
419536                                       DK-SEASET-SHRT-NM-6        41953627
419537             MOVE  ASC-SET-YEAR-1  TO  DK-SEASET-YR-1             41953727
419538                                       DK-SEASET-YR-2             41953827
419539                                       DK-SEASET-YR-3             41953927
419540                                       DK-SEASET-YR-4             41954027
419541                                       DK-SEASET-YR-5             41954127
419542                                       DK-SEASET-YR-6             41954227
419544         END-IF                                                   41954445
419545         IF  ASC-SET-CODE-2  >  SPACES                            41954545
419546             MOVE  ASC-SET-CODE-2  TO  DK-SEASET-SHRT-NM-2        41954645
419547                                       DK-SEASET-SHRT-NM-3        41954745
419548                                       DK-SEASET-SHRT-NM-4        41954845
419549                                       DK-SEASET-SHRT-NM-5        41954945
419550                                       DK-SEASET-SHRT-NM-6        41955045
419551             MOVE  ASC-SET-YEAR-2  TO  DK-SEASET-YR-2             41955127
419552                                       DK-SEASET-YR-3             41955227
419553                                       DK-SEASET-YR-4             41955327
419554                                       DK-SEASET-YR-5             41955427
419555                                       DK-SEASET-YR-6             41955527
419557         END-IF                                                   41955727
419558         IF  ASC-SET-CODE-3  >  SPACES                            41955827
419559             MOVE  ASC-SET-CODE-3  TO  DK-SEASET-SHRT-NM-3        41955927
419560                                       DK-SEASET-SHRT-NM-4        41956027
419561                                       DK-SEASET-SHRT-NM-5        41956127
419562                                       DK-SEASET-SHRT-NM-6        41956227
419565             MOVE  ASC-SET-YEAR-3  TO  DK-SEASET-YR-3             41956527
419566                                       DK-SEASET-YR-4             41956627
419567                                       DK-SEASET-YR-5             41956727
419568                                       DK-SEASET-YR-6             41956827
419571         END-IF                                                   41957127
419572         IF  ASC-SET-CODE-4  >  SPACES                            41957227
419573             MOVE  ASC-SET-CODE-4  TO  DK-SEASET-SHRT-NM-4        41957327
419574                                       DK-SEASET-SHRT-NM-5        41957427
419575                                       DK-SEASET-SHRT-NM-6        41957527
419579             MOVE  ASC-SET-YEAR-4  TO  DK-SEASET-YR-4             41957927
419580                                       DK-SEASET-YR-5             41958027
419581                                       DK-SEASET-YR-6             41958127
419585         END-IF                                                   41958527
419586         IF  ASC-SET-CODE-5  >  SPACES                            41958627
419587             MOVE  ASC-SET-CODE-5  TO  DK-SEASET-SHRT-NM-5        41958727
419588                                       DK-SEASET-SHRT-NM-6        41958827
419593             MOVE  ASC-SET-YEAR-5  TO  DK-SEASET-YR-5             41959327
419594                                       DK-SEASET-YR-6             41959427
419599         END-IF                                                   41959927
419600         IF  ASC-SET-CODE-6  >  SPACES                            41960027
419601             MOVE  ASC-SET-CODE-6  TO  DK-SEASET-SHRT-NM-6        41960127
419607             MOVE  ASC-SET-YEAR-6  TO  DK-SEASET-YR-6             41960727
419613         END-IF                                                   41961327
419614     END-IF.                                                      41961427
419615                                                                  41961527
419616                                                                  41961627
419620     IF ASC-KEY-OPER-UNT-ID > SPACE                               41962000
419700            AND NOT = 0                                           41970000
419800         MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID               41980000
419900                                     DK-OPER-UNT-ID-LOW           41990000
420000                                     DK-OPER-UNT-ID-HIGH          42000000
420100         SET ASC-NO-BYR-ANL-NME TO TRUE                           42010000
420200         IF ASC-LS-ARRIVAL                                        42020000
420210             IF  NOT ASC-INCLD-SET-CDE  AND                       42021027
420211                 NOT ASC-EXCLD-SET-CDE                            42021127
420212                     SET PS-USE-OPER-UNT-ARR-CSR TO TRUE          42021227
420213             ELSE                                                 42021327
420220                 IF  ASC-INCLD-SET-CDE                            42022027
420300                     SET PS-USE-OPER-UNT-ARR-INCL-CSR TO TRUE     42030027
420302                 ELSE                                             42030227
420310                      SET PS-USE-OPER-UNT-ARR-EXCL-CSR TO TRUE    42031027
420330                 END-IF                                           42033027
420340             END-IF                                               42034027
420400         ELSE                                                     42040000
420410             IF  NOT ASC-INCLD-SET-CDE  AND                       42041027
420420                 NOT ASC-EXCLD-SET-CDE                            42042027
420500                 SET PS-USE-OPER-UNT-TRB-CSR TO TRUE              42050027
420501             ELSE                                                 42050127
420502                 IF  ASC-INCLD-SET-CDE                            42050227
420510                     SET PS-USE-OPER-UNT-TRB-INCL-CSR TO TRUE     42051027
420511                 ELSE                                             42051127
420520                     SET PS-USE-OPER-UNT-TRB-EXCL-CSR TO TRUE     42052027
420521                 END-IF                                           42052127
420522             END-IF                                               42052227
420600         END-IF                                                   42060000
420700     END-IF.                                                      42070000
420800                                                                  42080000
420900     IF (ASC-KEY-DEPT > SPACES)                                   42090000
421000         MOVE ASC-KEY-DEPT  TO DK-DEPT-LOW                        42100000
421100                               DK-DEPT-HIGH                       42110000
421200         SET ASC-BYR-ANL-NME TO TRUE                              42120000
421300         IF ASC-LS-ARRIVAL                                        42130000
421310             IF  NOT ASC-INCLD-SET-CDE  AND                       42131027
421320                 NOT ASC-EXCLD-SET-CDE                            42132027
421400                 SET PS-USE-DEPT-ARR-CSR    TO TRUE               42140027
421401             ELSE                                                 42140127
421402                 IF  ASC-INCLD-SET-CDE                            42140227
421410                     SET PS-USE-DEPT-ARR-INCL-CSR    TO TRUE      42141027
421411                 ELSE                                             42141127
421420                     SET PS-USE-DEPT-ARR-EXCL-CSR    TO TRUE      42142027
421430                 END-IF                                           42143027
421440             END-IF                                               42144027
421500         ELSE                                                     42150000
421510             IF  NOT ASC-INCLD-SET-CDE  AND                       42151027
421520                 NOT ASC-EXCLD-SET-CDE                            42152027
421600                 SET PS-USE-DEPT-TRB-CSR    TO TRUE               42160027
421601             ELSE                                                 42160127
421602                 IF  ASC-INCLD-SET-CDE                            42160227
421610                     SET PS-USE-DEPT-TRB-INCL-CSR    TO TRUE      42161027
421611                 ELSE                                             42161127
421620                     SET PS-USE-DEPT-TRB-EXCL-CSR    TO TRUE      42162027
421630                 END-IF                                           42163027
421640             END-IF                                               42164027
421700         END-IF                                                   42170000
421800     END-IF.                                                      42180000
421900                                                                  42190000
422000     IF (ASC-KEY-BUYER > ZEROS)                                   42200000
422100         MOVE ASC-KEY-BUYER     TO DK-BUYER-NBR-N                 42210000
422200         SET ASC-BYR-ANL-NME TO TRUE                              42220000
422300         IF ASC-LS-ARRIVAL                                        42230000
422310             IF  NOT ASC-INCLD-SET-CDE  AND                       42231027
422320                 NOT ASC-EXCLD-SET-CDE                            42232027
422400                 SET PS-USE-BYR-ARR-CSR TO TRUE                   42240027
422401             ELSE                                                 42240127
422402                 IF  ASC-INCLD-SET-CDE                            42240227
422410                     SET PS-USE-BYR-ARR-INCL-CSR TO TRUE          42241027
422411                 ELSE                                             42241127
422420                     SET PS-USE-BYR-ARR-EXCL-CSR TO TRUE          42242027
422430                 END-IF                                           42243027
422440             END-IF                                               42244027
422500         ELSE                                                     42250000
422510             IF  NOT ASC-INCLD-SET-CDE  AND                       42251027
422520                 NOT ASC-EXCLD-SET-CDE                            42252027
422600                 SET PS-USE-BYR-TRB-CSR TO TRUE                   42260027
422601             ELSE                                                 42260127
422602                 IF  ASC-INCLD-SET-CDE                            42260227
422603                     SET PS-USE-BYR-TRB-INCL-CSR TO TRUE          42260327
422604                 ELSE                                             42260427
422610                     SET PS-USE-BYR-TRB-EXCL-CSR TO TRUE          42261027
422620                 END-IF                                           42262027
422630             END-IF                                               42263027
422700         END-IF                                                   42270000
422800     END-IF.                                                      42280000
422900                                                                  42290000
423000     IF  ASC-KEY-PO-NBR > ZERO                                    42300000
423100         MOVE ASC-KEY-PO-NBR TO DK-PO-NBR                         42310000
423200                                DK-PO-NBR-LOW                     42320000
423300                                DK-PO-NBR-HIGH                    42330000
423400         SET ASC-BYR-ANL-NME TO TRUE                              42340000
423500         IF ASC-LS-ARRIVAL                                        42350000
423510             IF  NOT ASC-INCLD-SET-CDE  AND                       42351027
423520                 NOT ASC-EXCLD-SET-CDE                            42352027
423600                 SET PS-USE-PORCVR-ARR-CSR TO TRUE                42360027
423601             ELSE                                                 42360127
423602                 IF  ASC-INCLD-SET-CDE                            42360227
423610                     SET PS-USE-PORCVR-ARR-INCL-CSR TO TRUE       42361027
423611                 ELSE                                             42361127
423620                     SET PS-USE-PORCVR-ARR-EXCL-CSR TO TRUE       42362027
423630                 END-IF                                           42363027
423700             END-IF                                               42370027
423710         ELSE                                                     42371027
423720             IF  NOT ASC-INCLD-SET-CDE  AND                       42372027
423730                 NOT ASC-EXCLD-SET-CDE                            42373027
423800                 SET PS-USE-PORCVR-TRB-CSR TO TRUE                42380027
423801             ELSE                                                 42380127
423802                 IF  ASC-INCLD-SET-CDE                            42380227
423810                     SET PS-USE-PORCVR-TRB-INCL-CSR TO TRUE       42381027
423811                 ELSE                                             42381127
423820                     SET PS-USE-PORCVR-TRB-EXCL-CSR TO TRUE       42382027
423830                 END-IF                                           42383027
423840             END-IF                                               42384027
423900         END-IF                                                   42390000
424000     END-IF.                                                      42400000
424100                                                                  42410000
424200     EVALUATE TRUE                                                42420000
424300         WHEN ASC-RA-BUY-ANALYST-SW                               42430000
424400             MOVE ASC-RA-BUYER   TO DK-RESP-AREA-1                42440000
424500             MOVE ASC-RA-ANALYST TO DK-RESP-AREA-2                42450000
424600         WHEN ASC-RA-BUY-ANALYST-DC-SW                            42460000
424700             MOVE ASC-RA-BUYER   TO DK-RESP-AREA-1                42470000
424800             MOVE ASC-RA-ANALYST TO DK-RESP-AREA-2                42480000
424900             MOVE ASC-RA-DC      TO DK-RESP-AREA-3                42490000
425000         WHEN ASC-RA-DC-SW                                        42500000
425100             MOVE ASC-RA-DC      TO DK-RESP-AREA-1                42510000
425200     END-EVALUATE.                                                42520000
425300                                                                  42530000
425400     EVALUATE TRUE                                                42540000
425500         WHEN ASC-ALL-NOTIF-STATS                                 42550000
425600             MOVE PC-NEW-TROUBLE TO DK-NOTIF-STAT-1               42560000
425700             MOVE PC-IN-PROCESS-TROUBLE TO DK-NOTIF-STAT-2        42570000
425800             MOVE PC-RESOLVED-TROUBLE TO DK-NOTIF-STAT-3          42580000
425900             MOVE PC-ACKNOWLEDGED-TROUBLE TO DK-NOTIF-STAT-4      42590000
426000         WHEN ASC-RESOLVD-STAT-ONLY                               42600000
426100             MOVE PC-RESOLVED-TROUBLE TO DK-NOTIF-STAT-1          42610000
426200         WHEN  ASC-UNRSLVD-STAT-ONLY                              42620000
426300             MOVE PC-NEW-TROUBLE TO DK-NOTIF-STAT-1               42630000
426400             MOVE PC-IN-PROCESS-TROUBLE TO DK-NOTIF-STAT-2        42640000
426500     END-EVALUATE.                                                42650000
426600                                                                  42660000
426700     IF  ASC-KEY-REC-SEQ-NBR >  ZEROS                             42670000
426800         MOVE ASC-KEY-REC-SEQ-NBR TO DK-REC-SEQ-NBR               42680000
426900                                     DK-REC-SEQ-NBR-LOW           42690000
427000                                     DK-REC-SEQ-NBR-HIGH          42700000
427100     ELSE                                                         42710000
427200         MOVE PC-000000000        TO DK-REC-SEQ-NBR               42720000
427300                                     DK-REC-SEQ-NBR-LOW           42730000
427400         MOVE PC-999999999        TO DK-REC-SEQ-NBR-HIGH          42740000
427500     END-IF.                                                      42750000
427600                                                                  42760000
427700     IF  ASC-TRBL-REASON-LOW > ZERO                               42770000
427800         MOVE ASC-TRBL-REASON-LOW TO DK-TRBL-RSN-LOW              42780000
427900     END-IF.                                                      42790000
428000     IF  ASC-TRBL-REASON-HIGH > ZERO                              42800000
428100         MOVE ASC-TRBL-REASON-HIGH  TO DK-TRBL-RSN-HIGH           42810000
428200     END-IF.                                                      42820000
428300                                                                  42830000
428400     EVALUATE TRUE                                                42840000
428500         WHEN ASC-RCVR-STAT-ARR-ENR                               42850000
428600             MOVE PC-DUMMY-DB2-DATE-LOW  TO DK-LOW-REC-TMST       42860000
428700             MOVE PC-DUMMY-DB2-DATE-HIGH TO DK-HIGH-REC-TMST      42870000
428800         WHEN ASC-RCVR-STAT-ARRIVED                               42880000
428900             MOVE PC-DUMMY-DB2-DATE-LOW  TO DK-LOW-REC-TMST       42890000
429000             EXEC SQL                                             42900000
429100                 SET :DK-HIGH-REC-TMST = CURRENT TIMESTAMP        42910000
429200             END-EXEC                                             42920000
429300         WHEN ASC-RCVR-STAT-ENROUTE                               42930000
429400             MOVE PC-DUMMY-DB2-DATE-HIGH TO DK-LOW-REC-TMST       42940000
429500                                            DK-HIGH-REC-TMST      42950000
429600     END-EVALUATE.                                                42960000
429700                                                                  42970000
429800*----------------------------------------------------------------*42980000
429900*    READ THE NOTIFICATION RECORDS FOR A SPECIFIC PO AND MOVE    *42990000
430000*    THEM INTO THE BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS    *43000000
430100*    BECOME FULL, WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE,  *43010000
430200*    MOVE THE 2ND BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND       *43020000
430300*    INITIALIZE THE 2ND BLOCK MAKING IT AVAILABLE TO BE USED.    *43030000
430400*                                                                *43040000
430500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *43050000
430600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *43060000
430700*    UPON INITIALIZATION.                                        *43070000
430800*----------------------------------------------------------------*43080000
430900 4300-READ-TROUBLE-NOTIF-FOR-PO.                                  43090000
431000     PERFORM                                                      43100000
431100         VARYING PV-READ-COUNT                                    43110000
431200         FROM 1 BY 1                                              43120000
431300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    43130000
431400            OR (PS-NO-TRBL-NOTIF-ITEMS-LEFT)                      43140000
431500            OR (PS-ERROR))                                        43150000
431600                                                                  43160000
431700         PERFORM 4310-FETCH-TROUBLE-NOTIF-ITEM                    43170000
431800                                                                  43180000
431900******************************************************************43190000
432000**  IF IT IS THE FIRST TIME THAT TROUBLE IS FETCHED USE THE DEPT  43200000
432100**  RETURNED TO GET THE BUYER NUMBER AND NAME FOR THAT DEPT AND   43210000
432200**  ALSO GET THE ANALYST NAME FOR THE DEPT. IT IS NOT NECESSARY   43220000
432300**  TO GET THE NAMES FOR EACH LINE DISPLAYED--ONCE IS ENOUGH.     43230000
432400******************************************************************43240000
432500         IF PV-READ-COUNT = 1                                     43250000
432600             MOVE TRBNTF-DEPT-NBR TO DK-DEPT-NBR                  43260000
432700             PERFORM 8000-GET-NAMES                               43270000
432800         END-IF                                                   43280000
432900                                                                  43290000
433000***************************************************************** 43300000
433100**THE FOLLOWING 'IF' STATEMENT IS USED TO MANUALLY ELIMINATE      43310000
433200** DUPLICATE TROUBLE REASONS FOR A MATCHING PO, RECEIVER AND      43320000
433300** RECEIVE TIMESTAMP FROM THE INTERNAL TABLE OF TROUBLE REASONS   43330000
433400** WHICH WILL BE DISPLAYED ON THE SCREEN. IF A TROUBLE REASON     43340000
433500** ALREADY EXISTS ON THE TABLE IT IS NOT DISPLAYED A 2ND TIME.    43350000
433600***************************************************************** 43360000
433700         IF TRBNTF-PO-NBR       = PV-PREV-PO-NBR      AND         43370000
433800             TRBNTF-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR             43380000
433900             CONTINUE                                             43390000
434000         ELSE                                                     43400000
434100             MOVE TRBNTF-PO-NBR      TO PV-PREV-PO-NBR            43410000
434200             MOVE TRBNTF-REC-SEQ-NBR TO PV-PREV-REC-SEQ-NBR       43420000
434300             INITIALIZE PV-TRBL-RSN-SUB                           43430000
434400                        TR-TROUBLE-REASON-TABLE                   43440000
434500         END-IF                                                   43450000
434600                                                                  43460000
434700         IF PS-PROCESS-TROUBLE-LINE                               43470000
434800           SET TR-TRBL-IDX TO +1                                  43480000
434900           SEARCH TR-TROUBLE-REASON-ENTRY                         43490000
435000             VARYING TR-TRBL-IDX                                  43500000
435100               AT END                                             43510000
435200                   SET PS-DISPLAY-TROUBLE-LINE TO TRUE            43520000
435300               WHEN TR-TROUBLE-REASON-N (TR-TRBL-IDX) =           43530000
435400                                        TRBNTF-TRBL-RSN-CDE       43540000
435500                   SET PS-DO-NOT-DISPLAY-TROUBLE-LINE TO TRUE     43550000
435600            END-SEARCH                                            43560000
435700         ELSE                                                     43570000
435800                 SET PS-DO-NOT-DISPLAY-TROUBLE-LINE TO TRUE       43580000
435900         END-IF                                                   43590000
436000                                                                  43600000
436100         IF  PS-DISPLAY-TROUBLE-LINE                              43610000
436200             SET PS-TRBL-RSN-NOT-LOADED   TO TRUE                 43620000
436300             PERFORM VARYING TR-TRBL-IDX                          43630000
436400               FROM 1 BY 1                                        43640000
436500                 UNTIL (TR-TRBL-IDX > PC-MAX-TABLE-ENTRIES) OR    43650000
436600                       (PS-TRBL-RSN-LOADED)                       43660000
436700                 IF  TR-TROUBLE-REASON (TR-TRBL-IDX) = SPACES     43670000
436800                     MOVE TRBNTF-TRBL-RSN-CDE                     43680000
436900                                    TO TR-TROUBLE-REASON-N        43690000
437000                                                   (TR-TRBL-IDX)  43700000
437100                     SET PS-TRBL-RSN-LOADED TO TRUE               43710000
437200                 END-IF                                           43720000
437300             END-PERFORM                                          43730000
437400         END-IF                                                   43740000
437500                                                                  43750000
437600         IF  TR-TRBL-IDX > PC-MAX-TABLE-ENTRIES                   43760000
437700             MOVE PC-TSYMSG-00994  TO DP020-MSG-NUMBER            43770000
437800             SET PS-DO-NOT-DISPLAY-TROUBLE-LINE                   43780000
437900                 DP020-NEXT-ACT-APPL-ERROR                        43790000
438000                 DP020-MSG-FATAL                                  43800000
438100                 PS-ERROR          TO  TRUE                       43810000
438200         END-IF                                                   43820000
438300                                                                  43830000
438400         IF (PS-TRBL-NOTIF-ITEMS-LEFT) AND                        43840000
438500            (PS-DISPLAY-TROUBLE-LINE)                             43850000
438600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                43860000
438700                 ADD +1            TO ASC-ITEM-SUB                43870000
438800             ELSE                                                 43880000
438900                 ADD +1            TO ASC-BLK-SUB                 43890000
439000                 MOVE +1           TO ASC-ITEM-SUB                43900000
439100                                                                  43910000
439200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         43920000
439300                     MOVE +1       TO ASC-BLK-SUB                 43930000
439400                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           43940000
439500                     PERFORM 5100-WRITE-TEMP-STORAGE              43950000
439600                     MOVE ASC-BLOCK-ENTRIES                       43960000
439700                               (PC-MAX-BLOCKS-IN-ARRAY)           43970000
439800                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 43980000
439900                     ADD +1        TO ASC-BLK-SUB                 43990000
440000                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   44000000
440100                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      44010000
440200                                   TO TRUE                        44020000
440300                 END-IF                                           44030000
440400             END-IF                                               44040000
440500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    44050000
440600             MOVE ASC-NUMBER-OF-ITEMS-READ                        44060000
440700                                   TO ASC-LIST-ITEM-NUMBER        44070000
440800                                        (ASC-BLK-SUB ASC-ITEM-SUB)44080000
440900             MOVE TRBNTF-NOTIF-NBR TO ASC-NOTIF-NBR               44090000
441000                                        (ASC-BLK-SUB ASC-ITEM-SUB)44100000
441100             MOVE TRBNTF-OPER-UNT-ID TO ASC-OPER-UNT-ID           44110000
441200                                        (ASC-BLK-SUB ASC-ITEM-SUB)44120000
441300             MOVE TRBNTF-FCLTY-ID  TO ASC-FCLTY-ID                44130000
441400                                        (ASC-BLK-SUB ASC-ITEM-SUB)44140000
441500             MOVE TRBNTF-DEPT-NBR  TO ASC-DEPT-NBR                44150000
441600                                        (ASC-BLK-SUB ASC-ITEM-SUB)44160000
441700             MOVE TRBNTF-PO-NBR    TO ASC-PO-NBR-N                44170000
441800                                        (ASC-BLK-SUB ASC-ITEM-SUB)44180000
441900             MOVE TRBNTF-REC-SEQ-NBR TO ASC-RCVR-SEQ-NBR-N        44190000
442000                                        (ASC-BLK-SUB ASC-ITEM-SUB)44200000
442100             MOVE TRBNTF-PO-LNE-NBR TO ASC-PO-LNE-NBR-N           44210000
442200                                        (ASC-BLK-SUB ASC-ITEM-SUB)44220000
442300             MOVE TRBNTF-PREPK-ID   TO ASC-PREPK-ID-N             44230000
442400                                        (ASC-BLK-SUB ASC-ITEM-SUB)44240000
442500                                                                  44250000
442600             PERFORM 4320-FETCH-VENDOR-SHORT-NAME                 44260000
442700             MOVE ENTNME-ENT-NAME-DESC TO ASC-VENDOR-SHORT-NME    44270000
442800                                        (ASC-BLK-SUB ASC-ITEM-SUB)44280000
442900             MOVE TRBNTF-ENT-ID    TO ASC-ENT-ID                  44290000
443000                                        (ASC-BLK-SUB ASC-ITEM-SUB)44300000
443100             PERFORM 4330-FETCH-LOCATION-SHT-NAME                 44310000
443200             MOVE PV-LOC-4-CHAR-NM     TO ASC-FCLTY-NME           44320000
443300                                        (ASC-BLK-SUB ASC-ITEM-SUB)44330000
443400             MOVE TRBNTF-TRBL-RSN-CDE  TO ASC-TROUBLE-REASON-CDE  44340000
443500                                        (ASC-BLK-SUB ASC-ITEM-SUB)44350000
443600             MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUBLE-REASON-DESC 44360000
443700                                        (ASC-BLK-SUB ASC-ITEM-SUB)44370000
443800             MOVE TRBRSN-RESP-RES-IND TO ASC-TROUBLE-RESP-RES-IND 44380000
443900                                        (ASC-BLK-SUB ASC-ITEM-SUB)44390000
444000             MOVE TRBRSN-TRBL-LVL-IND TO ASC-TROUBLE-REASON-LVL   44400000
444100                                        (ASC-BLK-SUB ASC-ITEM-SUB)44410000
444200             IF  RECEIV-REC-TMST = PC-DUMMY-DB2-DATE              44420000
444300                 MOVE 'ENROUTE'    TO ASC-ARRIVAL-DATE-TIME       44430000
444400                                        (ASC-BLK-SUB ASC-ITEM-SUB)44440000
444500             ELSE                                                 44450000
444600                 MOVE RECEIV-REC-TMST TO PV-TIMESTAMP             44460000
444700                 STRING PV-TIMESTAMP-MONTH  DELIMITED BY SIZE     44470000
444800                        PC-SLASH            DELIMITED BY SIZE     44480000
444900                        PV-TIMESTAMP-DAY    DELIMITED BY SIZE     44490000
445000                        PC-SPACE            DELIMITED BY SIZE     44500000
445100                        PV-TIMESTAMP-HOUR   DELIMITED BY SIZE     44510000
445200                                 INTO ASC-ARRIVAL-DATE-TIME       44520000
445300                                        (ASC-BLK-SUB ASC-ITEM-SUB)44530000
445400             END-IF                                               44540000
445500             MOVE TRBNTF-NOTIF-TMST TO PV-TIMESTAMP               44550000
445600             STRING PV-TIMESTAMP-MONTH  DELIMITED BY SIZE         44560000
445700                    PC-SLASH            DELIMITED BY SIZE         44570000
445800                    PV-TIMESTAMP-DAY    DELIMITED BY SIZE         44580000
445900                    PC-SPACE            DELIMITED BY SIZE         44590000
446000                    PV-TIMESTAMP-HOUR   DELIMITED BY SIZE         44600000
446100                                 INTO ASC-NOTIFICATION-DATE-TIME  44610000
446200                                        (ASC-BLK-SUB ASC-ITEM-SUB)44620000
446300             PERFORM 4350-FETCH-TROUBLE-DETAIL                    44630000
446400             IF  PS-TRBL-DTL-EXISTS                               44640000
446500                 SET ASC-TRBL-DTL-EXISTS                          44650000
446600                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        44660000
446700             ELSE                                                 44670000
446800                 SET ASC-NO-TRBL-DTL-EXISTS                       44680000
446900                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        44690000
447000             END-IF                                               44700000
447100             IF  TRBNTF-RESOLVED-IND = PC-NEW-TROUBLE OR          44710000
447200                                       PC-IN-PROCESS-TROUBLE      44720000
447300                 SET ASC-TRBL-NOT-RESOLVED                        44730000
447400                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        44740000
447500             ELSE                                                 44750000
447600                 INITIALIZE PV-UNRESOLVED-TROUBLE-COUNT           44760000
447700                 PERFORM 4370-COUNT-UNRESOLVED-TROUBLE            44770000
447800                 IF  PV-UNRESOLVED-TROUBLE-COUNT = 0              44780000
447900                     SET ASC-TRBL-RESOLVED                        44790000
448000                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        44800000
448100                 ELSE                                             44810000
448200                     SET ASC-TRBL-NOT-RESOLVED                    44820000
448300                        (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE        44830000
448400                 END-IF                                           44840000
448500******** IF LISTING ALL TROUBLE - CHECK FOR ACKNOWLEDGED TRBL     44850000
448600                 IF ASC-ALL-NOTIF-STATS                           44860000
448700                     INITIALIZE PV-NOT-ACK-CNT                    44870000
448800                     PERFORM 4380-COUNT-NOT-ACK                   44880000
448900                     IF  PV-NOT-ACK-CNT = 0                       44890000
449000******** ALL NOTIFICATION/TROUBLE HAS BEEN ACKNOWLEDGED FOR       44900000
449100******** SPECIFIED PO AND RCVR AND TRBL REASON                    44910000
449200                         SET ASC-TRBL-ACK                         44920000
449300                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    44930000
449400                     ELSE                                         44940000
449500                         SET ASC-TRBL-NOT-ACK                     44950000
449600                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    44960000
449700                     END-IF                                       44970000
449800                 END-IF                                           44980000
449900             END-IF                                               44990000
450000             IF  PV-TIMESTAMP = PC-DUMMY-DB2-DATE                 45000000
450100                 MOVE SPACES       TO ASC-RESPONSE-DATE-TIME      45010000
450200                                        (ASC-BLK-SUB ASC-ITEM-SUB)45020000
450300             ELSE                                                 45030000
450400                 IF ASC-ALL-NOTIF-STATS AND                       45040000
450500                    ASC-TRBL-ACK (ASC-BLK-SUB ASC-ITEM-SUB)       45050000
450600******** IF ALL NOTIFICATION/TROUBLE HAS BEEN ACKNOWLEDGED FOR    45060000
450700******** SPECIFIED PO AND RCVR AND TRBL REASON DISPLAY ACKNOWLEDGE45070000
450800******** TIMESTAMP INSTEAD OF RESOLVED TIMESTAMP                  45080000
450900                     MOVE TRBNTF-ACKNOWLG-TMST TO PV-TIMESTAMP    45090000
451000                 END-IF                                           45100000
451100                 STRING PV-TIMESTAMP-MONTH  DELIMITED BY SIZE     45110000
451200                        PC-SLASH            DELIMITED BY SIZE     45120000
451300                        PV-TIMESTAMP-DAY    DELIMITED BY SIZE     45130000
451400                        PC-SPACE            DELIMITED BY SIZE     45140000
451500                        PV-TIMESTAMP-HOUR   DELIMITED BY SIZE     45150000
451600                                 INTO ASC-RESPONSE-DATE-TIME      45160000
451700                                        (ASC-BLK-SUB ASC-ITEM-SUB)45170000
451800             END-IF                                               45180000
451900         END-IF                                                   45190000
452000     END-PERFORM.                                                 45200000
452100                                                                  45210000
452200*----------------------------------------------------------------*45220000
452300*    FETCH ALL OF THE NOTIFICATION RECORDS FOR A SPECIFIC PO.    *45230000
452400*----------------------------------------------------------------*45240000
452500 4310-FETCH-TROUBLE-NOTIF-ITEM.                                   45250000
452600     EVALUATE TRUE                                                45260000
452700       WHEN PS-USE-OPER-UNT-ARR-CSR                               45270000
452800         EXEC SQL                                                 45280000
452900              FETCH OPER-UNT-BY-ARRIV                             45290000
453000              INTO :TRBNTF-NOTIF-NBR                              45300000
453100                  , :TRBNTF-OPER-UNT-ID                           45310000
453200                  , :TRBNTF-FCLTY-ID                              45320000
453300                  , :TRBNTF-DEPT-NBR                              45330000
453400                  , :TRBNTF-ENT-ID                                45340000
453500                  , :TRBNTF-PO-NBR                                45350000
453600                  , :TRBNTF-PO-LNE-NBR                            45360000
453700                  , :TRBNTF-PREPK-ID                              45370000
453800                  , :TRBNTF-REC-SEQ-NBR                           45380000
453900                  , :TRBNTF-TRBL-RSN-CDE                          45390000
454000                  , :TRBNTF-NOTIF-TMST                            45400000
454100                  , :TRBNTF-RESOLVED-IND                          45410000
454200                  , :TRBNTF-RESOLVED-TMST                         45420000
454300                  , :TRBNTF-ACKNOWLG-TMST                         45430000
454400                  , :TRBRSN-TRBL-SHT-DESC                         45440000
454500                  , :TRBRSN-RESP-RES-IND                          45450000
454600                  , :TRBRSN-TRBL-LVL-IND                          45460000
454700                  , :TRBRSN-RSLV-RSPNT-CDE                        45470000
454800                  , :RECEIV-REC-TMST                              45480000
454900         END-EXEC                                                 45490000
454910       WHEN PS-USE-OPER-UNT-ARR-INCL-CSR                          45491034
454920         EXEC SQL                                                 45492034
454930              FETCH OPER-UNT-BY-ARRIV-INCL-SET                    45493034
454940              INTO :TRBNTF-NOTIF-NBR                              45494034
454950                  , :TRBNTF-OPER-UNT-ID                           45495034
454960                  , :TRBNTF-FCLTY-ID                              45496034
454970                  , :TRBNTF-DEPT-NBR                              45497034
454980                  , :TRBNTF-ENT-ID                                45498034
454990                  , :TRBNTF-PO-NBR                                45499034
454991                  , :TRBNTF-PO-LNE-NBR                            45499134
454992                  , :TRBNTF-PREPK-ID                              45499234
454993                  , :TRBNTF-REC-SEQ-NBR                           45499334
454994                  , :TRBNTF-TRBL-RSN-CDE                          45499434
454995                  , :TRBNTF-NOTIF-TMST                            45499534
454996                  , :TRBNTF-RESOLVED-IND                          45499634
454997                  , :TRBNTF-RESOLVED-TMST                         45499734
454998                  , :TRBNTF-ACKNOWLG-TMST                         45499834
454999                  , :TRBRSN-TRBL-SHT-DESC                         45499934
455000                  , :TRBRSN-RESP-RES-IND                          45500034
455001                  , :TRBRSN-TRBL-LVL-IND                          45500134
455002                  , :TRBRSN-RSLV-RSPNT-CDE                        45500234
455003                  , :RECEIV-REC-TMST                              45500334
455004         END-EXEC                                                 45500434
455005       WHEN PS-USE-OPER-UNT-ARR-EXCL-CSR                          45500534
455006         EXEC SQL                                                 45500634
455007              FETCH OPER-UNT-BY-ARRIV-EXCL-SET                    45500734
455008              INTO :TRBNTF-NOTIF-NBR                              45500834
455009                  , :TRBNTF-OPER-UNT-ID                           45500934
455010                  , :TRBNTF-FCLTY-ID                              45501034
455011                  , :TRBNTF-DEPT-NBR                              45501134
455012                  , :TRBNTF-ENT-ID                                45501234
455013                  , :TRBNTF-PO-NBR                                45501334
455014                  , :TRBNTF-PO-LNE-NBR                            45501434
455015                  , :TRBNTF-PREPK-ID                              45501534
455016                  , :TRBNTF-REC-SEQ-NBR                           45501634
455017                  , :TRBNTF-TRBL-RSN-CDE                          45501734
455018                  , :TRBNTF-NOTIF-TMST                            45501834
455019                  , :TRBNTF-RESOLVED-IND                          45501934
455020                  , :TRBNTF-RESOLVED-TMST                         45502034
455021                  , :TRBNTF-ACKNOWLG-TMST                         45502134
455022                  , :TRBRSN-TRBL-SHT-DESC                         45502234
455023                  , :TRBRSN-RESP-RES-IND                          45502334
455024                  , :TRBRSN-TRBL-LVL-IND                          45502434
455025                  , :TRBRSN-RSLV-RSPNT-CDE                        45502534
455026                  , :RECEIV-REC-TMST                              45502634
455027         END-EXEC                                                 45502734
455030       WHEN PS-USE-DEPT-ARR-CSR                                   45503000
455100         EXEC SQL                                                 45510000
455200              FETCH DEPT-BY-ARRIVAL                               45520000
455300              INTO :TRBNTF-NOTIF-NBR                              45530000
455400                  , :TRBNTF-OPER-UNT-ID                           45540000
455500                  , :TRBNTF-FCLTY-ID                              45550000
455600                  , :TRBNTF-DEPT-NBR                              45560000
455700                  , :TRBNTF-ENT-ID                                45570000
455800                  , :TRBNTF-PO-NBR                                45580000
455900                  , :TRBNTF-PO-LNE-NBR                            45590000
456000                  , :TRBNTF-PREPK-ID                              45600000
456100                  , :TRBNTF-REC-SEQ-NBR                           45610000
456200                  , :TRBNTF-TRBL-RSN-CDE                          45620000
456300                  , :TRBNTF-NOTIF-TMST                            45630000
456400                  , :TRBNTF-RESOLVED-IND                          45640000
456500                  , :TRBNTF-RESOLVED-TMST                         45650000
456600                  , :TRBNTF-ACKNOWLG-TMST                         45660000
456700                  , :TRBRSN-TRBL-SHT-DESC                         45670000
456800                  , :TRBRSN-RESP-RES-IND                          45680000
456900                  , :TRBRSN-TRBL-LVL-IND                          45690000
457000                  , :TRBRSN-RSLV-RSPNT-CDE                        45700000
457100                  , :RECEIV-REC-TMST                              45710000
457200         END-EXEC                                                 45720000
457210       WHEN PS-USE-DEPT-ARR-INCL-CSR                              45721034
457220         EXEC SQL                                                 45722034
457230              FETCH DEPT-BY-ARRIVAL-INCL-SET                      45723034
457240              INTO :TRBNTF-NOTIF-NBR                              45724034
457250                  , :TRBNTF-OPER-UNT-ID                           45725034
457260                  , :TRBNTF-FCLTY-ID                              45726034
457270                  , :TRBNTF-DEPT-NBR                              45727034
457280                  , :TRBNTF-ENT-ID                                45728034
457290                  , :TRBNTF-PO-NBR                                45729034
457291                  , :TRBNTF-PO-LNE-NBR                            45729134
457292                  , :TRBNTF-PREPK-ID                              45729234
457293                  , :TRBNTF-REC-SEQ-NBR                           45729334
457294                  , :TRBNTF-TRBL-RSN-CDE                          45729434
457295                  , :TRBNTF-NOTIF-TMST                            45729534
457296                  , :TRBNTF-RESOLVED-IND                          45729634
457297                  , :TRBNTF-RESOLVED-TMST                         45729734
457298                  , :TRBNTF-ACKNOWLG-TMST                         45729834
457299                  , :TRBRSN-TRBL-SHT-DESC                         45729934
457300                  , :TRBRSN-RESP-RES-IND                          45730034
457301                  , :TRBRSN-TRBL-LVL-IND                          45730134
457302                  , :TRBRSN-RSLV-RSPNT-CDE                        45730234
457303                  , :RECEIV-REC-TMST                              45730334
457304         END-EXEC                                                 45730434
457305       WHEN PS-USE-DEPT-ARR-EXCL-CSR                              45730534
457306         EXEC SQL                                                 45730634
457307              FETCH DEPT-BY-ARRIVAL-EXCL-SET                      45730734
457308              INTO :TRBNTF-NOTIF-NBR                              45730834
457309                  , :TRBNTF-OPER-UNT-ID                           45730934
457310                  , :TRBNTF-FCLTY-ID                              45731034
457311                  , :TRBNTF-DEPT-NBR                              45731134
457312                  , :TRBNTF-ENT-ID                                45731234
457313                  , :TRBNTF-PO-NBR                                45731334
457314                  , :TRBNTF-PO-LNE-NBR                            45731434
457315                  , :TRBNTF-PREPK-ID                              45731534
457316                  , :TRBNTF-REC-SEQ-NBR                           45731634
457317                  , :TRBNTF-TRBL-RSN-CDE                          45731734
457318                  , :TRBNTF-NOTIF-TMST                            45731834
457319                  , :TRBNTF-RESOLVED-IND                          45731934
457320                  , :TRBNTF-RESOLVED-TMST                         45732034
457321                  , :TRBNTF-ACKNOWLG-TMST                         45732134
457322                  , :TRBRSN-TRBL-SHT-DESC                         45732234
457323                  , :TRBRSN-RESP-RES-IND                          45732334
457324                  , :TRBRSN-TRBL-LVL-IND                          45732434
457325                  , :TRBRSN-RSLV-RSPNT-CDE                        45732534
457326                  , :RECEIV-REC-TMST                              45732634
457327         END-EXEC                                                 45732734
457330       WHEN PS-USE-BYR-ARR-CSR                                    45733000
457400         EXEC SQL                                                 45740000
457500              FETCH BUYER-BY-ARRIVAL                              45750000
457600              INTO :TRBNTF-NOTIF-NBR                              45760000
457700                  , :TRBNTF-OPER-UNT-ID                           45770000
457800                  , :TRBNTF-FCLTY-ID                              45780000
457900                  , :TRBNTF-DEPT-NBR                              45790000
458000                  , :TRBNTF-ENT-ID                                45800000
458100                  , :TRBNTF-PO-NBR                                45810000
458200                  , :TRBNTF-PO-LNE-NBR                            45820000
458300                  , :TRBNTF-PREPK-ID                              45830000
458400                  , :TRBNTF-REC-SEQ-NBR                           45840000
458500                  , :TRBNTF-TRBL-RSN-CDE                          45850000
458600                  , :TRBNTF-NOTIF-TMST                            45860000
458700                  , :TRBNTF-RESOLVED-IND                          45870000
458800                  , :TRBNTF-RESOLVED-TMST                         45880000
458900                  , :TRBNTF-ACKNOWLG-TMST                         45890000
459000                  , :TRBRSN-TRBL-SHT-DESC                         45900000
459100                  , :TRBRSN-RESP-RES-IND                          45910000
459200                  , :TRBRSN-TRBL-LVL-IND                          45920000
459300                  , :TRBRSN-RSLV-RSPNT-CDE                        45930000
459400                  , :RECEIV-REC-TMST                              45940000
459500         END-EXEC                                                 45950000
459510       WHEN PS-USE-BYR-ARR-INCL-CSR                               45951034
459520         EXEC SQL                                                 45952034
459530              FETCH BUYER-BY-ARRIVAL-INCL-SET                     45953034
459540              INTO :TRBNTF-NOTIF-NBR                              45954034
459550                  , :TRBNTF-OPER-UNT-ID                           45955034
459560                  , :TRBNTF-FCLTY-ID                              45956034
459570                  , :TRBNTF-DEPT-NBR                              45957034
459580                  , :TRBNTF-ENT-ID                                45958034
459590                  , :TRBNTF-PO-NBR                                45959034
459591                  , :TRBNTF-PO-LNE-NBR                            45959134
459592                  , :TRBNTF-PREPK-ID                              45959234
459593                  , :TRBNTF-REC-SEQ-NBR                           45959334
459594                  , :TRBNTF-TRBL-RSN-CDE                          45959434
459595                  , :TRBNTF-NOTIF-TMST                            45959534
459596                  , :TRBNTF-RESOLVED-IND                          45959634
459597                  , :TRBNTF-RESOLVED-TMST                         45959734
459598                  , :TRBNTF-ACKNOWLG-TMST                         45959834
459599                  , :TRBRSN-TRBL-SHT-DESC                         45959934
459600                  , :TRBRSN-RESP-RES-IND                          45960034
459601                  , :TRBRSN-TRBL-LVL-IND                          45960134
459602                  , :TRBRSN-RSLV-RSPNT-CDE                        45960234
459603                  , :RECEIV-REC-TMST                              45960334
459604         END-EXEC                                                 45960434
459605       WHEN PS-USE-BYR-ARR-EXCL-CSR                               45960534
459606         EXEC SQL                                                 45960634
459607              FETCH BUYER-BY-ARRIVAL-EXCL-SET                     45960734
459608              INTO :TRBNTF-NOTIF-NBR                              45960834
459609                  , :TRBNTF-OPER-UNT-ID                           45960934
459610                  , :TRBNTF-FCLTY-ID                              45961034
459611                  , :TRBNTF-DEPT-NBR                              45961134
459612                  , :TRBNTF-ENT-ID                                45961234
459613                  , :TRBNTF-PO-NBR                                45961334
459614                  , :TRBNTF-PO-LNE-NBR                            45961434
459615                  , :TRBNTF-PREPK-ID                              45961534
459616                  , :TRBNTF-REC-SEQ-NBR                           45961634
459617                  , :TRBNTF-TRBL-RSN-CDE                          45961734
459618                  , :TRBNTF-NOTIF-TMST                            45961834
459619                  , :TRBNTF-RESOLVED-IND                          45961934
459620                  , :TRBNTF-RESOLVED-TMST                         45962034
459621                  , :TRBNTF-ACKNOWLG-TMST                         45962134
459622                  , :TRBRSN-TRBL-SHT-DESC                         45962234
459623                  , :TRBRSN-RESP-RES-IND                          45962334
459624                  , :TRBRSN-TRBL-LVL-IND                          45962434
459625                  , :TRBRSN-RSLV-RSPNT-CDE                        45962534
459626                  , :RECEIV-REC-TMST                              45962634
459627         END-EXEC                                                 45962734
459630       WHEN PS-USE-PORCVR-ARR-CSR                                 45963000
459700         EXEC SQL                                                 45970000
459800              FETCH PORCVR-BY-ARRIVAL                             45980000
459900              INTO :TRBNTF-NOTIF-NBR                              45990000
460000                  , :TRBNTF-OPER-UNT-ID                           46000000
460100                  , :TRBNTF-FCLTY-ID                              46010000
460200                  , :TRBNTF-DEPT-NBR                              46020000
460300                  , :TRBNTF-ENT-ID                                46030000
460400                  , :TRBNTF-PO-NBR                                46040000
460500                  , :TRBNTF-PO-LNE-NBR                            46050000
460600                  , :TRBNTF-PREPK-ID                              46060000
460700                  , :TRBNTF-REC-SEQ-NBR                           46070000
460800                  , :TRBNTF-TRBL-RSN-CDE                          46080000
460900                  , :TRBNTF-NOTIF-TMST                            46090000
461000                  , :TRBNTF-RESOLVED-IND                          46100000
461100                  , :TRBNTF-RESOLVED-TMST                         46110000
461200                  , :TRBNTF-ACKNOWLG-TMST                         46120000
461300                  , :TRBRSN-TRBL-SHT-DESC                         46130000
461400                  , :TRBRSN-RESP-RES-IND                          46140000
461500                  , :TRBRSN-TRBL-LVL-IND                          46150000
461600                  , :TRBRSN-RSLV-RSPNT-CDE                        46160000
461700                  , :RECEIV-REC-TMST                              46170000
461800         END-EXEC                                                 46180000
461810       WHEN PS-USE-PORCVR-ARR-INCL-CSR                            46181034
461820         EXEC SQL                                                 46182034
461830              FETCH PORCVR-BY-ARRIVAL-INCL-SET                    46183034
461840              INTO :TRBNTF-NOTIF-NBR                              46184034
461850                  , :TRBNTF-OPER-UNT-ID                           46185034
461860                  , :TRBNTF-FCLTY-ID                              46186034
461870                  , :TRBNTF-DEPT-NBR                              46187034
461880                  , :TRBNTF-ENT-ID                                46188034
461890                  , :TRBNTF-PO-NBR                                46189034
461891                  , :TRBNTF-PO-LNE-NBR                            46189134
461892                  , :TRBNTF-PREPK-ID                              46189234
461893                  , :TRBNTF-REC-SEQ-NBR                           46189334
461894                  , :TRBNTF-TRBL-RSN-CDE                          46189434
461895                  , :TRBNTF-NOTIF-TMST                            46189534
461896                  , :TRBNTF-RESOLVED-IND                          46189634
461897                  , :TRBNTF-RESOLVED-TMST                         46189734
461898                  , :TRBNTF-ACKNOWLG-TMST                         46189834
461899                  , :TRBRSN-TRBL-SHT-DESC                         46189934
461900                  , :TRBRSN-RESP-RES-IND                          46190034
461901                  , :TRBRSN-TRBL-LVL-IND                          46190134
461902                  , :TRBRSN-RSLV-RSPNT-CDE                        46190234
461903                  , :RECEIV-REC-TMST                              46190334
461904         END-EXEC                                                 46190434
461905       WHEN PS-USE-PORCVR-ARR-EXCL-CSR                            46190534
461906         EXEC SQL                                                 46190634
461907              FETCH PORCVR-BY-ARRIVAL-EXCL-SET                    46190734
461908              INTO :TRBNTF-NOTIF-NBR                              46190834
461909                  , :TRBNTF-OPER-UNT-ID                           46190934
461910                  , :TRBNTF-FCLTY-ID                              46191034
461911                  , :TRBNTF-DEPT-NBR                              46191134
461912                  , :TRBNTF-ENT-ID                                46191234
461913                  , :TRBNTF-PO-NBR                                46191334
461914                  , :TRBNTF-PO-LNE-NBR                            46191434
461915                  , :TRBNTF-PREPK-ID                              46191534
461916                  , :TRBNTF-REC-SEQ-NBR                           46191634
461917                  , :TRBNTF-TRBL-RSN-CDE                          46191734
461918                  , :TRBNTF-NOTIF-TMST                            46191834
461919                  , :TRBNTF-RESOLVED-IND                          46191934
461920                  , :TRBNTF-RESOLVED-TMST                         46192034
461921                  , :TRBNTF-ACKNOWLG-TMST                         46192134
461922                  , :TRBRSN-TRBL-SHT-DESC                         46192234
461923                  , :TRBRSN-RESP-RES-IND                          46192334
461924                  , :TRBRSN-TRBL-LVL-IND                          46192434
461925                  , :TRBRSN-RSLV-RSPNT-CDE                        46192534
461926                  , :RECEIV-REC-TMST                              46192634
461927         END-EXEC                                                 46192734
461930****  FETCH BY OLDEST TO NEWEST  TROUBLE SEQUENCE                 46193000
462000       WHEN PS-USE-OPER-UNT-TRB-CSR                               46200000
462100         EXEC SQL                                                 46210000
462200              FETCH OPER-UNT-BY-TRBL                              46220000
462300              INTO :TRBNTF-NOTIF-NBR                              46230000
462400                  , :TRBNTF-OPER-UNT-ID                           46240000
462500                  , :TRBNTF-FCLTY-ID                              46250000
462600                  , :TRBNTF-DEPT-NBR                              46260000
462700                  , :TRBNTF-ENT-ID                                46270000
462800                  , :TRBNTF-PO-NBR                                46280000
462900                  , :TRBNTF-PO-LNE-NBR                            46290000
463000                  , :TRBNTF-PREPK-ID                              46300000
463100                  , :TRBNTF-REC-SEQ-NBR                           46310000
463200                  , :TRBNTF-TRBL-RSN-CDE                          46320000
463300                  , :TRBNTF-NOTIF-TMST                            46330000
463400                  , :TRBNTF-RESOLVED-IND                          46340000
463500                  , :TRBNTF-RESOLVED-TMST                         46350000
463600                  , :TRBNTF-ACKNOWLG-TMST                         46360000
463700                  , :TRBRSN-TRBL-SHT-DESC                         46370000
463800                  , :TRBRSN-RESP-RES-IND                          46380000
463900                  , :TRBRSN-TRBL-LVL-IND                          46390000
464000                  , :TRBRSN-RSLV-RSPNT-CDE                        46400000
464100                  , :RECEIV-REC-TMST                              46410000
464200         END-EXEC                                                 46420000
464210       WHEN PS-USE-OPER-UNT-TRB-INCL-CSR                          46421034
464220         EXEC SQL                                                 46422034
464230              FETCH OPER-UNT-BY-TRBL-INCL-SET                     46423034
464240              INTO :TRBNTF-NOTIF-NBR                              46424034
464250                  , :TRBNTF-OPER-UNT-ID                           46425034
464260                  , :TRBNTF-FCLTY-ID                              46426034
464270                  , :TRBNTF-DEPT-NBR                              46427034
464280                  , :TRBNTF-ENT-ID                                46428034
464290                  , :TRBNTF-PO-NBR                                46429034
464291                  , :TRBNTF-PO-LNE-NBR                            46429134
464292                  , :TRBNTF-PREPK-ID                              46429234
464293                  , :TRBNTF-REC-SEQ-NBR                           46429334
464294                  , :TRBNTF-TRBL-RSN-CDE                          46429434
464295                  , :TRBNTF-NOTIF-TMST                            46429534
464296                  , :TRBNTF-RESOLVED-IND                          46429634
464297                  , :TRBNTF-RESOLVED-TMST                         46429734
464298                  , :TRBNTF-ACKNOWLG-TMST                         46429834
464299                  , :TRBRSN-TRBL-SHT-DESC                         46429934
464300                  , :TRBRSN-RESP-RES-IND                          46430034
464301                  , :TRBRSN-TRBL-LVL-IND                          46430134
464302                  , :TRBRSN-RSLV-RSPNT-CDE                        46430234
464303                  , :RECEIV-REC-TMST                              46430334
464304         END-EXEC                                                 46430434
464305       WHEN PS-USE-OPER-UNT-TRB-EXCL-CSR                          46430534
464306         EXEC SQL                                                 46430634
464307              FETCH OPER-UNT-BY-TRBL-EXCL-SET                     46430734
464308              INTO :TRBNTF-NOTIF-NBR                              46430834
464309                  , :TRBNTF-OPER-UNT-ID                           46430934
464310                  , :TRBNTF-FCLTY-ID                              46431034
464311                  , :TRBNTF-DEPT-NBR                              46431134
464312                  , :TRBNTF-ENT-ID                                46431234
464313                  , :TRBNTF-PO-NBR                                46431334
464314                  , :TRBNTF-PO-LNE-NBR                            46431434
464315                  , :TRBNTF-PREPK-ID                              46431534
464316                  , :TRBNTF-REC-SEQ-NBR                           46431634
464317                  , :TRBNTF-TRBL-RSN-CDE                          46431734
464318                  , :TRBNTF-NOTIF-TMST                            46431834
464319                  , :TRBNTF-RESOLVED-IND                          46431934
464320                  , :TRBNTF-RESOLVED-TMST                         46432034
464321                  , :TRBNTF-ACKNOWLG-TMST                         46432134
464322                  , :TRBRSN-TRBL-SHT-DESC                         46432234
464323                  , :TRBRSN-RESP-RES-IND                          46432334
464324                  , :TRBRSN-TRBL-LVL-IND                          46432434
464325                  , :TRBRSN-RSLV-RSPNT-CDE                        46432534
464326                  , :RECEIV-REC-TMST                              46432634
464327         END-EXEC                                                 46432734
464330       WHEN PS-USE-DEPT-TRB-CSR                                   46433000
464400         EXEC SQL                                                 46440000
464500              FETCH DEPT-BY-TRBL                                  46450000
464600              INTO :TRBNTF-NOTIF-NBR                              46460000
464700                  , :TRBNTF-OPER-UNT-ID                           46470000
464800                  , :TRBNTF-FCLTY-ID                              46480000
464900                  , :TRBNTF-DEPT-NBR                              46490000
465000                  , :TRBNTF-ENT-ID                                46500000
465100                  , :TRBNTF-PO-NBR                                46510000
465200                  , :TRBNTF-PO-LNE-NBR                            46520000
465300                  , :TRBNTF-PREPK-ID                              46530000
465400                  , :TRBNTF-REC-SEQ-NBR                           46540000
465500                  , :TRBNTF-TRBL-RSN-CDE                          46550000
465600                  , :TRBNTF-NOTIF-TMST                            46560000
465700                  , :TRBNTF-RESOLVED-IND                          46570000
465800                  , :TRBNTF-RESOLVED-TMST                         46580000
465900                  , :TRBNTF-ACKNOWLG-TMST                         46590000
466000                  , :TRBRSN-TRBL-SHT-DESC                         46600000
466100                  , :TRBRSN-RESP-RES-IND                          46610000
466200                  , :TRBRSN-TRBL-LVL-IND                          46620000
466300                  , :TRBRSN-RSLV-RSPNT-CDE                        46630000
466400                  , :RECEIV-REC-TMST                              46640000
466500         END-EXEC                                                 46650000
466510       WHEN PS-USE-DEPT-TRB-INCL-CSR                              46651034
466520         EXEC SQL                                                 46652034
466530              FETCH DEPT-BY-TRBL-INCL-SET                         46653034
466540              INTO :TRBNTF-NOTIF-NBR                              46654034
466550                  , :TRBNTF-OPER-UNT-ID                           46655034
466560                  , :TRBNTF-FCLTY-ID                              46656034
466570                  , :TRBNTF-DEPT-NBR                              46657034
466580                  , :TRBNTF-ENT-ID                                46658034
466590                  , :TRBNTF-PO-NBR                                46659034
466591                  , :TRBNTF-PO-LNE-NBR                            46659134
466592                  , :TRBNTF-PREPK-ID                              46659234
466593                  , :TRBNTF-REC-SEQ-NBR                           46659334
466594                  , :TRBNTF-TRBL-RSN-CDE                          46659434
466595                  , :TRBNTF-NOTIF-TMST                            46659534
466596                  , :TRBNTF-RESOLVED-IND                          46659634
466597                  , :TRBNTF-RESOLVED-TMST                         46659734
466598                  , :TRBNTF-ACKNOWLG-TMST                         46659834
466599                  , :TRBRSN-TRBL-SHT-DESC                         46659934
466600                  , :TRBRSN-RESP-RES-IND                          46660034
466601                  , :TRBRSN-TRBL-LVL-IND                          46660134
466602                  , :TRBRSN-RSLV-RSPNT-CDE                        46660234
466603                  , :RECEIV-REC-TMST                              46660334
466604         END-EXEC                                                 46660434
466610       WHEN PS-USE-DEPT-TRB-EXCL-CSR                              46661034
466700         EXEC SQL                                                 46670000
466800              FETCH DEPT-BY-TRBL-EXCL-SET                         46680034
466900              INTO :TRBNTF-NOTIF-NBR                              46690000
467000                  , :TRBNTF-OPER-UNT-ID                           46700000
467100                  , :TRBNTF-FCLTY-ID                              46710000
467200                  , :TRBNTF-DEPT-NBR                              46720000
467300                  , :TRBNTF-ENT-ID                                46730000
467400                  , :TRBNTF-PO-NBR                                46740000
467500                  , :TRBNTF-PO-LNE-NBR                            46750000
467600                  , :TRBNTF-PREPK-ID                              46760000
467700                  , :TRBNTF-REC-SEQ-NBR                           46770000
467800                  , :TRBNTF-TRBL-RSN-CDE                          46780000
467900                  , :TRBNTF-NOTIF-TMST                            46790000
468000                  , :TRBNTF-RESOLVED-IND                          46800000
468100                  , :TRBNTF-RESOLVED-TMST                         46810000
468200                  , :TRBNTF-ACKNOWLG-TMST                         46820000
468300                  , :TRBRSN-TRBL-SHT-DESC                         46830000
468400                  , :TRBRSN-RESP-RES-IND                          46840000
468500                  , :TRBRSN-TRBL-LVL-IND                          46850000
468600                  , :TRBRSN-RSLV-RSPNT-CDE                        46860000
468700                  , :RECEIV-REC-TMST                              46870000
468800         END-EXEC                                                 46880000
468810       WHEN PS-USE-BYR-TRB-CSR                                    46881035
468820         EXEC SQL                                                 46882035
468830              FETCH BUYER-BY-TRBL                                 46883035
468840              INTO :TRBNTF-NOTIF-NBR                              46884035
468850                  , :TRBNTF-OPER-UNT-ID                           46885035
468860                  , :TRBNTF-FCLTY-ID                              46886035
468870                  , :TRBNTF-DEPT-NBR                              46887035
468880                  , :TRBNTF-ENT-ID                                46888035
468890                  , :TRBNTF-PO-NBR                                46889035
468891                  , :TRBNTF-PO-LNE-NBR                            46889135
468892                  , :TRBNTF-PREPK-ID                              46889235
468893                  , :TRBNTF-REC-SEQ-NBR                           46889335
468894                  , :TRBNTF-TRBL-RSN-CDE                          46889435
468895                  , :TRBNTF-NOTIF-TMST                            46889535
468896                  , :TRBNTF-RESOLVED-IND                          46889635
468897                  , :TRBNTF-RESOLVED-TMST                         46889735
468898                  , :TRBNTF-ACKNOWLG-TMST                         46889835
468899                  , :TRBRSN-TRBL-SHT-DESC                         46889935
468900                  , :TRBRSN-RESP-RES-IND                          46890035
468901                  , :TRBRSN-TRBL-LVL-IND                          46890135
468902                  , :TRBRSN-RSLV-RSPNT-CDE                        46890235
468903                  , :RECEIV-REC-TMST                              46890335
468904         END-EXEC                                                 46890435
468905       WHEN PS-USE-BYR-TRB-INCL-CSR                               46890535
468906         EXEC SQL                                                 46890635
468907              FETCH BUYER-BY-TRBL-INCL-SET                        46890735
468908              INTO :TRBNTF-NOTIF-NBR                              46890835
468909                  , :TRBNTF-OPER-UNT-ID                           46890935
468910                  , :TRBNTF-FCLTY-ID                              46891035
468911                  , :TRBNTF-DEPT-NBR                              46891135
468912                  , :TRBNTF-ENT-ID                                46891235
468913                  , :TRBNTF-PO-NBR                                46891335
468914                  , :TRBNTF-PO-LNE-NBR                            46891435
468915                  , :TRBNTF-PREPK-ID                              46891535
468916                  , :TRBNTF-REC-SEQ-NBR                           46891635
468917                  , :TRBNTF-TRBL-RSN-CDE                          46891735
468918                  , :TRBNTF-NOTIF-TMST                            46891835
468919                  , :TRBNTF-RESOLVED-IND                          46891935
468920                  , :TRBNTF-RESOLVED-TMST                         46892035
468921                  , :TRBNTF-ACKNOWLG-TMST                         46892135
468922                  , :TRBRSN-TRBL-SHT-DESC                         46892235
468923                  , :TRBRSN-RESP-RES-IND                          46892335
468924                  , :TRBRSN-TRBL-LVL-IND                          46892435
468925                  , :TRBRSN-RSLV-RSPNT-CDE                        46892535
468926                  , :RECEIV-REC-TMST                              46892635
468927         END-EXEC                                                 46892735
468928       WHEN PS-USE-BYR-TRB-EXCL-CSR                               46892835
468929         EXEC SQL                                                 46892935
468930              FETCH BUYER-BY-TRBL-EXCL-SET                        46893035
468931              INTO :TRBNTF-NOTIF-NBR                              46893135
468932                  , :TRBNTF-OPER-UNT-ID                           46893235
468933                  , :TRBNTF-FCLTY-ID                              46893335
468934                  , :TRBNTF-DEPT-NBR                              46893435
468935                  , :TRBNTF-ENT-ID                                46893535
468936                  , :TRBNTF-PO-NBR                                46893635
468937                  , :TRBNTF-PO-LNE-NBR                            46893735
468938                  , :TRBNTF-PREPK-ID                              46893835
468939                  , :TRBNTF-REC-SEQ-NBR                           46893935
468940                  , :TRBNTF-TRBL-RSN-CDE                          46894035
468941                  , :TRBNTF-NOTIF-TMST                            46894135
468942                  , :TRBNTF-RESOLVED-IND                          46894235
468943                  , :TRBNTF-RESOLVED-TMST                         46894335
468944                  , :TRBNTF-ACKNOWLG-TMST                         46894435
468945                  , :TRBRSN-TRBL-SHT-DESC                         46894535
468946                  , :TRBRSN-RESP-RES-IND                          46894635
468947                  , :TRBRSN-TRBL-LVL-IND                          46894735
468948                  , :TRBRSN-RSLV-RSPNT-CDE                        46894835
468949                  , :RECEIV-REC-TMST                              46894935
468950         END-EXEC                                                 46895035
468960       WHEN PS-USE-PORCVR-TRB-CSR                                 46896000
469000         EXEC SQL                                                 46900000
469100              FETCH PORCVR-BY-TRBL                                46910000
469200              INTO :TRBNTF-NOTIF-NBR                              46920000
469300                  , :TRBNTF-OPER-UNT-ID                           46930000
469400                  , :TRBNTF-FCLTY-ID                              46940000
469500                  , :TRBNTF-DEPT-NBR                              46950000
469600                  , :TRBNTF-ENT-ID                                46960036
469700                  , :TRBNTF-PO-NBR                                46970000
469800                  , :TRBNTF-PO-LNE-NBR                            46980000
469900                  , :TRBNTF-PREPK-ID                              46990000
470000                  , :TRBNTF-REC-SEQ-NBR                           47000000
470100                  , :TRBNTF-TRBL-RSN-CDE                          47010000
470200                  , :TRBNTF-NOTIF-TMST                            47020000
470300                  , :TRBNTF-RESOLVED-IND                          47030000
470400                  , :TRBNTF-RESOLVED-TMST                         47040000
470500                  , :TRBNTF-ACKNOWLG-TMST                         47050000
470600                  , :TRBRSN-TRBL-SHT-DESC                         47060000
470700                  , :TRBRSN-RESP-RES-IND                          47070000
470800                  , :TRBRSN-TRBL-LVL-IND                          47080000
470900                  , :TRBRSN-RSLV-RSPNT-CDE                        47090000
471000                  , :RECEIV-REC-TMST                              47100000
471100         END-EXEC                                                 47110000
471110       WHEN PS-USE-PORCVR-TRB-INCL-CSR                            47111034
471120         EXEC SQL                                                 47112034
471130              FETCH PORCVR-BY-TRBL-INCL-SET                       47113034
471140              INTO :TRBNTF-NOTIF-NBR                              47114034
471150                  , :TRBNTF-OPER-UNT-ID                           47115034
471160                  , :TRBNTF-FCLTY-ID                              47116034
471170                  , :TRBNTF-DEPT-NBR                              47117034
471180                  , :TRBNTF-ENT-ID                                47118034
471190                  , :TRBNTF-PO-NBR                                47119034
471191                  , :TRBNTF-PO-LNE-NBR                            47119134
471192                  , :TRBNTF-PREPK-ID                              47119234
471193                  , :TRBNTF-REC-SEQ-NBR                           47119334
471194                  , :TRBNTF-TRBL-RSN-CDE                          47119434
471195                  , :TRBNTF-NOTIF-TMST                            47119534
471196                  , :TRBNTF-RESOLVED-IND                          47119634
471197                  , :TRBNTF-RESOLVED-TMST                         47119734
471198                  , :TRBNTF-ACKNOWLG-TMST                         47119834
471199                  , :TRBRSN-TRBL-SHT-DESC                         47119934
471200                  , :TRBRSN-RESP-RES-IND                          47120034
471201                  , :TRBRSN-TRBL-LVL-IND                          47120134
471202                  , :TRBRSN-RSLV-RSPNT-CDE                        47120234
471203                  , :RECEIV-REC-TMST                              47120334
471204         END-EXEC                                                 47120434
471205       WHEN PS-USE-PORCVR-TRB-EXCL-CSR                            47120534
471206         EXEC SQL                                                 47120634
471207              FETCH PORCVR-BY-TRBL-EXCL-SET                       47120734
471208              INTO :TRBNTF-NOTIF-NBR                              47120834
471209                  , :TRBNTF-OPER-UNT-ID                           47120934
471210                  , :TRBNTF-FCLTY-ID                              47121034
471211                  , :TRBNTF-DEPT-NBR                              47121134
471212                  , :TRBNTF-ENT-ID                                47121234
471213                  , :TRBNTF-PO-NBR                                47121334
471214                  , :TRBNTF-PO-LNE-NBR                            47121434
471215                  , :TRBNTF-PREPK-ID                              47121534
471216                  , :TRBNTF-REC-SEQ-NBR                           47121634
471217                  , :TRBNTF-TRBL-RSN-CDE                          47121734
471218                  , :TRBNTF-NOTIF-TMST                            47121834
471219                  , :TRBNTF-RESOLVED-IND                          47121934
471220                  , :TRBNTF-RESOLVED-TMST                         47122034
471221                  , :TRBNTF-ACKNOWLG-TMST                         47122134
471222                  , :TRBRSN-TRBL-SHT-DESC                         47122234
471223                  , :TRBRSN-RESP-RES-IND                          47122334
471224                  , :TRBRSN-TRBL-LVL-IND                          47122434
471225                  , :TRBRSN-RSLV-RSPNT-CDE                        47122534
471226                  , :RECEIV-REC-TMST                              47122634
471227         END-EXEC                                                 47122734
471230     END-EVALUATE.                                                47123000
471300                                                                  47130000
471400     EVALUATE TRUE                                                47140000
471500         WHEN SQLCODE = ZERO                                      47150000
471600                IF TRBRSN-RSLV-RSPNT-CDE = DK-RESP-AREA-1         47160000
471700                                       OR DK-RESP-AREA-2          47170000
471800                                         OR DK-RESP-AREA-3        47180000
471900                 SET PS-PROCESS-TROUBLE-LINE TO TRUE              47190000
472000              ELSE                                                47200000
472100                 SET PS-DO-NOT-PROCESS-LINE TO TRUE               47210000
472200              END-IF                                              47220000
472300         WHEN SQLCODE = +100                                      47230000
472400              SET PS-NO-TRBL-NOTIF-ITEMS-LEFT TO TRUE             47240000
472500         WHEN SQLWARN0 NOT = SPACE                                47250000
472600         WHEN SQLCODE NOT = ZERO                                  47260000
472700              MOVE '4310-FETCH-TROUBLE-NOTIF-ITEM'                47270000
472800                               TO DP013-PARAGRAPH                 47280000
472900              MOVE 'FETCH TROUBLE NOTIFICATION CURSOR'            47290000
473000                               TO DP013-MESSAGE-TEXT (1)          47300000
473100              MOVE SQLCA       TO DP013-SQLCA                     47310000
473200              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        47320000
473300              MOVE 'TTRBRSN '  TO DP013-DB2-TABLE-NAME (2)        47330000
473400              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (3)        47340000
473500              SET DP013-DB2-ABEND TO TRUE                         47350000
473600              PERFORM DP013-0000-PROCESS-ABEND                    47360000
473700     END-EVALUATE.                                                47370000
473800                                                                  47380000
473900*----------------------------------------------------------------*47390000
474000*    RETRIEVE VENDOR SHORT NAME FROM THE ENTITY NAME TABLE FOR   *47400000
474100*    THIS NOTIFICATION RECORD.                                   *47410000
474200*----------------------------------------------------------------*47420000
474300 4320-FETCH-VENDOR-SHORT-NAME.                                    47430000
474400     PERFORM                                                      47440000
474500         WITH TEST AFTER                                          47450000
474600         VARYING PV-RETRY-COUNTER                                 47460000
474700         FROM 1 BY 1                                              47470000
474800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47480000
474900                   OR (SQLCODE = ZERO OR +100))                   47490000
475000                                                                  47500000
475100         EXEC SQL                                                 47510000
475200              SELECT ENT_NAME_DESC                                47520000
475300                INTO :ENTNME-ENT-NAME-DESC                        47530000
475400                FROM TENTNME                                      47540000
475500               WHERE ENT_ID  = :TRBNTF-ENT-ID                     47550000
475600                 AND TYPE_CDE = :PC-TYPE-CODE-SHORT-NAME          47560000
475700         END-EXEC                                                 47570000
475800                                                                  47580000
475900         EVALUATE TRUE                                            47590000
476000             WHEN SQLCODE = ZERO                                  47600000
476100             WHEN SQLCODE = -904                                  47610000
476200             WHEN SQLCODE = -913                                  47620000
476300                  CONTINUE                                        47630000
476400             WHEN SQLCODE = +100                                  47640000
476500                  MOVE SPACES    TO ENTNME-ENT-NAME-DESC          47650000
476600             WHEN SQLWARN0 NOT = SPACE                            47660000
476700             WHEN SQLCODE NOT = ZERO                              47670000
476800                  MOVE '4320-FETCH-VENDOR-SHORT-NAME'             47680000
476900                                       TO DP013-PARAGRAPH         47690000
477000                  MOVE 'FETCH VENDOR SHORT NAME INFORMATION'      47700000
477100                                       TO DP013-MESSAGE-TEXT (1)  47710000
477200                  MOVE TRBNTF-PO-NBR   TO PV-ERROR-PO-NBR         47720000
477300                  MOVE TRBNTF-REC-SEQ-NBR                         47730000
477400                                       TO PV-ERROR-REC-SEQ-NBR    47740000
477500                MOVE TRBNTF-PO-LNE-NBR TO PV-ERROR-PO-LNE-NBR     47750000
477600                MOVE TRBNTF-PREPK-ID   TO PV-ERROR-PACK-ID        47760000
477700                MOVE TRBNTF-NOTIF-NBR  TO PV-ERROR-NOTIF-NBR      47770000
477800                STRING 'RCVR: '               DELIMITED BY SIZE   47780000
477900                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   47790000
478000                     '-'                      DELIMITED BY SIZE   47800000
478100                     PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   47810000
478200                     ' PO LINE NBR: '         DELIMITED BY SIZE   47820000
478300                     PV-ERROR-PO-LNE-NBR      DELIMITED BY SIZE   47830000
478400                     ' PACK ID: '             DELIMITED BY SIZE   47840000
478500                     PV-ERROR-PACK-ID         DELIMITED BY SIZE   47850000
478600                     ' NOTIFICATION NBR: '    DELIMITED BY SIZE   47860000
478700                     PV-ERROR-NOTIF-NBR       DELIMITED BY SIZE   47870000
478800                             INTO DP013-MESSAGE-TEXT (2)          47880000
478900              MOVE SQLCA       TO DP013-SQLCA                     47890000
479000              MOVE 'TENTNME '  TO DP013-DB2-TABLE-NAME (1)        47900000
479100              SET DP013-DB2-ABEND TO TRUE                         47910000
479200              PERFORM DP013-0000-PROCESS-ABEND                    47920000
479300         END-EVALUATE                                             47930000
479400     END-PERFORM.                                                 47940000
479500                                                                  47950000
479600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47960000
479700         MOVE '4320-FETCH-VENDOR-SHORT-NAME'                      47970000
479800                                   TO DP013-PARAGRAPH             47980000
479900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     47990000
480000                                   TO DP013-MESSAGE-TEXT (1)      48000000
480100         MOVE SQLCA                TO DP013-SQLCA                 48010000
480200         MOVE 'TENTNME '           TO DP013-DB2-TABLE-NAME (1)    48020000
480300         SET DP013-DB2-ABEND                                      48030000
480400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   48040000
480500         PERFORM DP013-0000-PROCESS-ABEND                         48050000
480600     END-IF.                                                      48060000
480700                                                                  48070000
480800*----------------------------------------------------------------*48080000
480900*    RETRIEVE THE SHORT NAME LOCATION NAME FROM XLT_LOC WHICH IS  48090000
481000*    5 CHARACTERS (DC-MF). THE NAME WILL NEED TO BE MANIPULATED   48100000
481100*    FOR EXAMPLE FROM DC-MF TO MFDC IN ORDER TO FIT ON THE SCREEN 48110000
481200*    LOGISTICS DOMAIN LOCATION MODULE IS USED (XLKUT071)          48120000
481300*----------------------------------------------------------------*48130000
481400 4330-FETCH-LOCATION-SHT-NAME.                                    48140000
481500     INITIALIZE XL071-COMMAREA-REC.                               48150000
481600                                                                  48160000
481700     MOVE TRBNTF-OPER-UNT-ID    TO PV-UNPACK-OPER-UNT-ID.         48170000
481800     MOVE PV-UNPACK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         48180000
481900                                                                  48190000
482000     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    48200000
482100                                      XL071-COMMAREA              48210000
482200                                      XL071-COMMAREA-REC.         48220000
482300                                                                  48230000
482400     EVALUATE TRUE                                                48240000
482500         WHEN XL071-NO-ERRORS                                     48250000
482600             IF XL071-LOC-TYP-CDE = 'DC'                          48260000
482700                 MOVE XL071-LOC-5-ABBR-NM TO PV-LOC-5-NM          48270000
482800                 MOVE PV-DC               TO PV-DC-4              48280000
482900                 MOVE PV-DC-NME           TO PV-DC-NME-4          48290000
483000             ELSE                                                 48300000
483100                 MOVE XL071-LOCATION-NUMBER                       48310000
483200                                          TO PV-STORE-N           48320000
483300                 MOVE SPACE               TO PV-LOC-4-CHAR-NM     48330000
483400                 MOVE PV-STORE-X          TO PV-LOC-4-CHAR-NM     48340000
483500             END-IF                                               48350000
483600         WHEN XL071-LOC-NOT-FOUND                                 48360000
483700         WHEN XL071-SQLCODE-n = -904                              48370000
483800         WHEN XL071-SQLCODE-n = -913                              48380000
483900             MOVE SPACES      TO XL071-LOC-5-ABBR-NM              48390000
484000                                 PV-DC-NME-4                      48400000
484100         WHEN XL071-BAD-DB2-RETURN                                48410000
484200             MOVE '4330-FETCH-LOCATION-SHT-NAME'                  48420000
484300                              TO DP013-PARAGRAPH                  48430000
484400             MOVE 'FETCH LOCATION SHORT NAME'                     48440000
484500                              TO DP013-MESSAGE-TEXT (1)           48450000
484600             MOVE TRBNTF-PO-NBR         TO PV-ERROR-PO-NBR        48460000
484700             MOVE TRBNTF-REC-SEQ-NBR    TO PV-ERROR-REC-SEQ-NBR   48470000
484800             MOVE TRBNTF-PO-LNE-NBR     TO PV-ERROR-PO-LNE-NBR    48480000
484900             MOVE TRBNTF-PREPK-ID       TO PV-ERROR-PACK-ID       48490000
485000             MOVE TRBNTF-NOTIF-NBR      TO PV-ERROR-NOTIF-NBR     48500000
485100         STRING ' RCVR: '                     DELIMITED BY SIZE   48510000
485200                PV-ERROR-PO-NBR               DELIMITED BY SIZE   48520000
485300                '-'                           DELIMITED BY SIZE   48530000
485400                PV-ERROR-REC-SEQ-NBR          DELIMITED BY SIZE   48540000
485500                ' PO LINE NBR: '              DELIMITED BY SIZE   48550000
485600                PV-ERROR-PO-LNE-NBR           DELIMITED BY SIZE   48560000
485700                ' PACK ID: '                  DELIMITED BY SIZE   48570000
485800                PV-ERROR-PACK-ID              DELIMITED BY SIZE   48580000
485900                ' NOTIFICATION NBR: '         DELIMITED BY SIZE   48590000
486000                PV-ERROR-NOTIF-NBR            DELIMITED BY SIZE   48600000
486100                        INTO DP013-MESSAGE-TEXT (2)               48610000
486200             MOVE XL071-SQLCA    TO DP013-SQLCA                   48620000
486300             MOVE 'XLT_LOC '     TO DP013-DB2-TABLE-NAME (1)      48630000
486400             SET DP013-DB2-ABEND TO TRUE                          48640000
486500             PERFORM DP013-0000-PROCESS-ABEND                     48650000
486600     END-EVALUATE.                                                48660000
486700                                                                  48670000
486800*----------------------------------------------------------------*48680000
486900*    RETRIEVE THE TROUBLE DETAIL ROW FOR A SPECIFIC TROUBLE      *48690000
487000*    NOTIFICATION RECORD, LOOKING FOR THE ROW WITH THE MOST      *48700000
487100*    CURRENT TIMESTAMP.                                          *48710000
487200*----------------------------------------------------------------*48720000
487300 4350-FETCH-TROUBLE-DETAIL.                                       48730000
487400     INITIALIZE PV-MAX-RESP-DATE.                                 48740000
487500     PERFORM 4360-FETCH-MAX-DATE-TRBL-NOTIF                       48750000
487600                                                                  48760000
487700     IF  PV-MAX-RESP-DATE > SPACES                                48770000
487800         MOVE PV-MAX-RESP-DATE       TO PV-TIMESTAMP              48780000
487900         SET PS-TRBL-DTL-EXISTS      TO TRUE                      48790000
488000     ELSE                                                         48800000
488100         MOVE PC-DUMMY-DB2-DATE      TO PV-TIMESTAMP              48810000
488200         SET PS-NO-TRBL-DTL-EXISTS   TO TRUE                      48820000
488300     END-IF.                                                      48830000
488400                                                                  48840000
488500*----------------------------------------------------------------*48850000
488600*  RETRIEVE THE DATE OF THE MOST CURRENT TROUBLE DETAIL RECORD   *48860000
488700*----------------------------------------------------------------*48870000
488800 4360-FETCH-MAX-DATE-TRBL-NOTIF.                                  48880000
488900     PERFORM                                                      48890000
489000         WITH TEST AFTER                                          48900000
489100         VARYING PV-RETRY-COUNTER                                 48910000
489200         FROM 1 BY 1                                              48920000
489300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48930000
489400                   OR (SQLCODE = ZERO OR +100 OR -305))           48940000
489500                                                                  48950000
489600         EXEC SQL                                                 48960000
489700              SELECT MAX(LAST_DTL_CRE_TMST)                       48970000
489800                INTO :PV-MAX-RESP-DATE                            48980000
489900                FROM TTRBNTF                                      48990000
490000               WHERE OPER_UNT_ID = :TRBNTF-OPER-UNT-ID            49000000
490100                 AND FCLTY_ID  = :TRBNTF-FCLTY-ID                 49010000
490200                 AND PO_NBR    = :TRBNTF-PO-NBR                   49020000
490300                 AND REC_SEQ_NBR = :TRBNTF-REC-SEQ-NBR            49030000
490400                 AND TRBL_RSN_CDE = :TRBNTF-TRBL-RSN-CDE          49040000
490500                 AND LAST_DTL_CRE_TMST                            49050000
490600                          NOT IN ('9999-09-09-09.09.09.999999'    49060000
490700                                , '0001-01-01-00.00.00.000000')   49070000
490800         END-EXEC                                                 49080000
490900                                                                  49090000
491000         EVALUATE TRUE                                            49100000
491100             WHEN SQLCODE = ZERO                                  49110000
491200             WHEN SQLCODE = +100                                  49120000
491300             WHEN SQLCODE = -305                                  49130000
491400             WHEN SQLCODE = -904                                  49140000
491500             WHEN SQLCODE = -913                                  49150000
491600                  CONTINUE                                        49160000
491700             WHEN SQLWARN0 NOT = SPACE                            49170000
491800             WHEN SQLCODE NOT = ZERO                              49180000
491900                  MOVE '4360-FETCH-MAX-DATE-TRBL-NOTIF'           49190000
492000                                   TO DP013-PARAGRAPH             49200000
492100                  MOVE 'FETCH MOST CURRENT TROUBLE DETAIL DATE'   49210000
492200                                   TO DP013-MESSAGE-TEXT (1)      49220000
492300                  MOVE TRBNTF-PO-NBR TO PV-ERROR-PO-NBR           49230000
492400                  MOVE TRBNTF-REC-SEQ-NBR TO PV-ERROR-REC-SEQ-NBR 49240000
492500                  MOVE TRBNTF-PO-LNE-NBR TO PV-ERROR-PO-LNE-NBR   49250000
492600                  MOVE TRBNTF-PREPK-ID  TO PV-ERROR-PACK-ID       49260000
492700                  MOVE TRBNTF-NOTIF-NBR TO PV-ERROR-NOTIF-NBR     49270000
492800                  STRING ' RCVR: '            DELIMITED BY SIZE   49280000
492900                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   49290000
493000                     '-'                      DELIMITED BY SIZE   49300000
493100                     PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   49310000
493200                     ' PO LINE NBR: '         DELIMITED BY SIZE   49320000
493300                     PV-ERROR-PO-LNE-NBR      DELIMITED BY SIZE   49330000
493400                     ' PACK ID: '             DELIMITED BY SIZE   49340000
493500                     PV-ERROR-PACK-ID         DELIMITED BY SIZE   49350000
493600                     ' NOTIFICATION NBR: '    DELIMITED BY SIZE   49360000
493700                     PV-ERROR-NOTIF-NBR       DELIMITED BY SIZE   49370000
493800                                 INTO DP013-MESSAGE-TEXT (2)      49380000
493900                  MOVE SQLCA       TO DP013-SQLCA                 49390000
494000                  MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)    49400000
494100                  SET DP013-DB2-ABEND TO TRUE                     49410000
494200                  PERFORM DP013-0000-PROCESS-ABEND                49420000
494300         END-EVALUATE                                             49430000
494400     END-PERFORM.                                                 49440000
494500                                                                  49450000
494600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49460000
494700         IF SQLCODE = -913                                        49470000
494800             PERFORM 9910-SQL-913-RETURN                          49480000
494900         ELSE                                                     49490000
495000             MOVE '4360-FETCH-MAX-DATE-TRBL-NOTIF'                49500000
495100                                     TO DP013-PARAGRAPH           49510000
495200             MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT' 49520000
495300                                     TO DP013-MESSAGE-TEXT (1)    49530000
495400             MOVE SQLCA              TO DP013-SQLCA               49540000
495500             MOVE 'TTRBNTF '         TO DP013-DB2-TABLE-NAME (1)  49550000
495600             SET DP013-DB2-ABEND                                  49560000
495700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               49570000
495800             PERFORM DP013-0000-PROCESS-ABEND                     49580000
495900         END-IF                                                   49590000
496000     END-IF.                                                      49600000
496100                                                                  49610000
496200*----------------------------------------------------------------*49620000
496300*    COUNT THE NUMBER OF UNRESOLVED TROUBLE NOTIFICATION RECORDS *49630000
496400*    FOR A SPECIFIC PO, RCVR SEQ, AND TROUBLE REASON.            *49640000
496500*----------------------------------------------------------------*49650000
496600 4370-COUNT-UNRESOLVED-TROUBLE.                                   49660000
496700     PERFORM                                                      49670000
496800         WITH TEST AFTER                                          49680000
496900         VARYING PV-RETRY-COUNTER                                 49690000
497000         FROM 1 BY 1                                              49700000
497100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49710000
497200                   OR (SQLCODE = ZERO OR +100))                   49720000
497300                                                                  49730000
497400         EXEC SQL                                                 49740000
497500              SELECT COUNT(*)                                     49750000
497600                INTO :PV-UNRESOLVED-TROUBLE-COUNT                 49760000
497700                FROM TTRBNTF                                      49770000
497800               WHERE OPER_UNT_ID = :TRBNTF-OPER-UNT-ID            49780000
497900                 AND FCLTY_ID    = :TRBNTF-FCLTY-ID               49790000
498000                 AND PO_NBR      = :TRBNTF-PO-NBR                 49800000
498100                 AND REC_SEQ_NBR = :TRBNTF-REC-SEQ-NBR            49810000
498200                 AND TRBL_RSN_CDE = :TRBNTF-TRBL-RSN-CDE          49820000
498300                 AND RESOLVED_TMST = :PC-DUMMY-DB2-DATE           49830000
498400         END-EXEC                                                 49840000
498500                                                                  49850000
498600         EVALUATE TRUE                                            49860000
498700             WHEN SQLCODE = ZERO                                  49870000
498800             WHEN SQLCODE = +100                                  49880000
498900             WHEN SQLCODE = -904                                  49890000
499000             WHEN SQLCODE = -913                                  49900000
499100                  CONTINUE                                        49910000
499200             WHEN SQLWARN0 NOT = SPACE                            49920000
499300             WHEN SQLCODE NOT = ZERO                              49930000
499400                  MOVE '4370-COUNT-UNRESOLVED-TROUBLE'            49940000
499500                                   TO DP013-PARAGRAPH             49950000
499600                  MOVE 'COUNTING UNRESOLVED TROUBLE FOR:'         49960000
499700                                   TO DP013-MESSAGE-TEXT (1)      49970000
499800                  MOVE TRBNTF-PO-NBR TO  PV-ERROR-PO-NBR          49980000
499900                  MOVE TRBNTF-REC-SEQ-NBR TO PV-ERROR-REC-SEQ-NBR 49990000
500000                  MOVE TRBNTF-TRBL-RSN-CDE                        50000000
500100                                   TO PV-ERROR-TRBL-RSN-CDE       50010000
500200                  STRING ' RCVR: '            DELIMITED BY SIZE   50020000
500300                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   50030000
500400                     '-'                      DELIMITED BY SIZE   50040000
500500                     PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   50050000
500600                     ' TROUBLE REASON: '      DELIMITED BY SIZE   50060000
500700                     PV-ERROR-TRBL-RSN-CDE    DELIMITED BY SIZE   50070000
500800                             INTO DP013-MESSAGE-TEXT (2)          50080000
500900                  MOVE SQLCA   TO DP013-SQLCA                     50090000
501000                  MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)     50100000
501100                  SET DP013-DB2-ABEND TO TRUE                     50110000
501200                  PERFORM DP013-0000-PROCESS-ABEND                50120000
501300         END-EVALUATE                                             50130000
501400     END-PERFORM.                                                 50140000
501500                                                                  50150000
501600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50160000
501700         IF SQLCODE = -913                                        50170000
501800             PERFORM 9910-SQL-913-RETURN                          50180000
501900         ELSE                                                     50190000
502000             MOVE '4370-COUNT-UNRESOLVED-TROUBLE'                 50200000
502100                                     TO DP013-PARAGRAPH           50210000
502200             MOVE                                                 50220000
502300                 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'  50230000
502400                                     TO DP013-MESSAGE-TEXT (1)    50240000
502500             MOVE SQLCA              TO DP013-SQLCA               50250000
502600             MOVE 'TTRBNTF '         TO DP013-DB2-TABLE-NAME (1)  50260000
502700             SET DP013-DB2-ABEND                                  50270000
502800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               50280000
502900             PERFORM DP013-0000-PROCESS-ABEND                     50290000
503000         END-IF                                                   50300000
503100     END-IF.                                                      50310000
503200                                                                  50320000
503300*----------------------------------------------------------------*50330000
503400*    COUNT THE NUMBER OF NOT ACKNOWLEDGED TROUBLE NOTIFICATION   *50340000
503500*    RECORDS FOR A SPECIFIC PO, RCVR SEQ, AND TROUBLE REASON.    *50350000
503600*----------------------------------------------------------------*50360000
503700 4380-COUNT-NOT-ACK.                                              50370000
503800     PERFORM                                                      50380000
503900         WITH TEST AFTER                                          50390000
504000         VARYING PV-RETRY-COUNTER                                 50400000
504100         FROM 1 BY 1                                              50410000
504200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50420000
504300                   OR (SQLCODE = ZERO OR +100))                   50430000
504400                                                                  50440000
504500         EXEC SQL                                                 50450000
504600              SELECT COUNT(*)                                     50460000
504700                INTO :PV-NOT-ACK-CNT                              50470000
504800                FROM TTRBNTF                                      50480000
504900               WHERE PO_NBR      = :TRBNTF-PO-NBR                 50490000
505000                 AND REC_SEQ_NBR = :TRBNTF-REC-SEQ-NBR            50500000
505100                 AND TRBL_RSN_CDE = :TRBNTF-TRBL-RSN-CDE          50510000
505200                 AND RESOLVED_IND ^= :PC-ACKNOWLEDGED-TROUBLE     50520000
505300         END-EXEC                                                 50530000
505400                                                                  50540000
505500         EVALUATE TRUE                                            50550000
505600             WHEN SQLCODE = ZERO                                  50560000
505700             WHEN SQLCODE = +100                                  50570000
505800             WHEN SQLCODE = -904                                  50580000
505900             WHEN SQLCODE = -913                                  50590000
506000                  CONTINUE                                        50600000
506100             WHEN SQLWARN0 NOT = SPACE                            50610000
506200             WHEN SQLCODE NOT = ZERO                              50620000
506300                  MOVE '4380-COUNT-NOT-ACK ' TO DP013-PARAGRAPH   50630000
506400                  MOVE 'COUNT NOT ACKNOWLEDGED TROUBLE FOR:'      50640000
506500                                   TO DP013-MESSAGE-TEXT (1)      50650000
506600                  MOVE TRBNTF-PO-NBR TO  PV-ERROR-PO-NBR          50660000
506700                  MOVE TRBNTF-REC-SEQ-NBR TO PV-ERROR-REC-SEQ-NBR 50670000
506800                  MOVE TRBNTF-TRBL-RSN-CDE                        50680000
506900                                   TO PV-ERROR-TRBL-RSN-CDE       50690000
507000                  STRING ' RCVR: '            DELIMITED BY SIZE   50700000
507100                     PV-ERROR-PO-NBR          DELIMITED BY SIZE   50710000
507200                     '-'                      DELIMITED BY SIZE   50720000
507300                     PV-ERROR-REC-SEQ-NBR     DELIMITED BY SIZE   50730000
507400                     ' TROUBLE REASON: '      DELIMITED BY SIZE   50740000
507500                     PV-ERROR-TRBL-RSN-CDE    DELIMITED BY SIZE   50750000
507600                             INTO DP013-MESSAGE-TEXT (2)          50760000
507700                  MOVE SQLCA   TO DP013-SQLCA                     50770000
507800                  MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)     50780000
507900                  SET DP013-DB2-ABEND TO TRUE                     50790000
508000                  PERFORM DP013-0000-PROCESS-ABEND                50800000
508100         END-EVALUATE                                             50810000
508200     END-PERFORM.                                                 50820000
508300                                                                  50830000
508400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50840000
508500         IF SQLCODE = -913                                        50850000
508600             PERFORM 9910-SQL-913-RETURN                          50860000
508700         ELSE                                                     50870000
508800             MOVE '4380-COUNT-NOT-ACK' TO DP013-PARAGRAPH         50880000
508900             MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT' 50890000
509000                                     TO DP013-MESSAGE-TEXT (1)    50900000
509100             MOVE SQLCA              TO DP013-SQLCA               50910000
509200             MOVE 'TTRBNTF '         TO DP013-DB2-TABLE-NAME (1)  50920000
509300             SET DP013-DB2-ABEND                                  50930000
509400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               50940000
509500             PERFORM DP013-0000-PROCESS-ABEND                     50950000
509600         END-IF                                                   50960000
509700     END-IF.                                                      50970000
509800                                                                  50980000
509900*----------------------------------------------------------------*50990000
510000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *51000000
510100*----------------------------------------------------------------*51010000
510200 4400-MOVE-COMMAREA-TO-SCREEN.                                    51020000
510300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             51030000
510400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          51040000
510500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          51050000
510600             MOVE +1    TO ASC-BLK-SUB                            51060000
510700             PERFORM 5100-WRITE-TEMP-STORAGE                      51070000
510800             ADD +1     TO ASC-BLK-SUB                            51080000
510900             PERFORM 5100-WRITE-TEMP-STORAGE                      51090000
511000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             51100000
511100                 GIVING PV-BLOCK-NUMBER                           51110000
511200                 REMAINDER PV-REMAINDER                           51120000
511300             IF  PV-REMAINDER > ZERO                              51130000
511400                 ADD +1 TO PV-BLOCK-NUMBER                        51140000
511500             END-IF                                               51150000
511600             MOVE +1    TO ASC-BLK-SUB                            51160000
511700             PERFORM 4410-READ-TEMP-STORAGE                       51170000
511800             ADD +1     TO ASC-BLK-SUB                            51180000
511900                           PV-BLOCK-NUMBER                        51190000
512000             PERFORM 4410-READ-TEMP-STORAGE                       51200000
512100     END-IF.                                                      51210000
512200     MOVE +1            TO ASC-BLK-SUB.                           51220000
512300     COMPUTE PV-ASC-ITEM-SUB-COMP3 =                              51230000
512400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              51240000
512500         + PC-ITEMS-PER-PANEL-COMP3).                             51250000
512600     MOVE  PV-ASC-ITEM-SUB-COMP3 TO ASC-ITEM-SUB.                 51260000
512700     MOVE  PC-ITEMS-PER-PANEL-COMP3 TO PC-ITEMS-PER-PANEL.        51270000
512800                                                                  51280000
512900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        51290000
513000         ADD +1         TO ASC-BLK-SUB                            51300000
513100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            51310000
513200     END-IF.                                                      51320000
513300                                                                  51330000
513400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           51340000
513500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                51350000
513600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        51360000
513700     PERFORM 4420-FORMAT-LIST-LINES                               51370000
513800         VARYING PV-SUB                                           51380000
513900         FROM PC-ITEMS-PER-PANEL BY -1                            51390000
514000         UNTIL PV-SUB < +1.                                       51400000
514100                                                                  51410000
514200     COMPUTE ASC-ITEMS-DISPLAYED =                                51420000
514300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          51430000
514400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    51440000
514500                                      ASTRTITO.                   51450000
514600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    51460000
514700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    51470000
514800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ASELITO.                51480000
514900                                                                  51490000
515000******************************************************************51500000
515100** IF OPER UNIT CSR IS USED MOVE LITERALS "MULTIPLE BUYERS" AND   51510000
515200** "MULTIPLE ANALYSTS" TO THE NON-SCROLLABLE PART OF THE SCREEN   51520000
515300** OTHERWISE MOVE THE BUYER NBR AND NAME AND ANALYST NAME.        51530000
515400******************************************************************51540000
515500     IF ASC-NO-BYR-ANL-NME                                        51550000
515600         MOVE SPACES            TO MR-BYR-NBR                     51560000
515700         MOVE PC-MULTI-BUYERS   TO MR-BYR-NME                     51570000
515800                                   ASC-BYR-NME                    51580000
515900         MOVE PC-MULTI-ANALYSTS TO MR-ANL-NME                     51590000
516000                                   ASC-ANL-NME                    51600000
516100     ELSE                                                         51610000
516200         IF ASC-BYR-NME > SPACES                                  51620000
516300             MOVE ASC-BYR-NBR       TO MR-BYR-NBR                 51630000
516400             MOVE ASC-BYR-NME       TO MR-BYR-NME                 51640000
516500         ELSE                                                     51650000
516600             MOVE SPACES            TO MR-BYR-NBR                 51660000
516700             MOVE PC-NOT-FOUND      TO MR-BYR-NME                 51670000
516800         END-IF                                                   51680000
516900         IF ASC-ANL-NME > SPACES                                  51690000
517000             MOVE ASC-ANL-NME       TO MR-ANL-NME                 51700000
517100         ELSE                                                     51710000
517200             MOVE PC-NOT-FOUND      TO MR-ANL-NME                 51720000
517300         END-IF                                                   51730000
517400     END-IF.                                                      51740000
517500                                                                  51750000
517510     IF  ASC-INCLD-SET-CDE                                        51751042
517520         MOVE 'INCLUDE'             TO MR-SETDESC                 51752048
517521         MOVE 'SET '                TO MR-SETDES2                 51752148
517530     ELSE                                                         51753042
517531         IF  ASC-EXCLD-SET-CDE                                    51753142
517540             MOVE 'EXCLUDE'         TO MR-SETDESC                 51754049
517541             MOVE 'SET '            TO MR-SETDES2                 51754148
517550         ELSE                                                     51755042
517560             MOVE SPACES            TO MR-SETDESC                 51756043
517561                                       MR-SETDES2                 51756148
517570         END-IF                                                   51757042
517580     END-IF.                                                      51758042
517594                                                                  51759445
517595     IF  ASC-INCLD-SET-CDE  OR                                    51759545
517596         ASC-EXCLD-SET-CDE                                        51759645
517597         MOVE ASC-SET-YEAR-1        TO MR-SETYR01                 51759745
517598         MOVE ASC-SET-YEAR-2        TO MR-SETYR02                 51759845
517599         MOVE ASC-SET-YEAR-3        TO MR-SETYR03                 51759945
517600         MOVE ASC-SET-YEAR-4        TO MR-SETYR04                 51760045
517601         MOVE ASC-SET-YEAR-5        TO MR-SETYR05                 51760145
517602         MOVE ASC-SET-YEAR-6        TO MR-SETYR06                 51760245
517603         MOVE ASC-SET-CODE-1        TO MR-SETCD01                 51760345
517604         MOVE ASC-SET-CODE-2        TO MR-SETCD02                 51760447
517605         MOVE ASC-SET-CODE-3        TO MR-SETCD03                 51760545
517606         MOVE ASC-SET-CODE-4        TO MR-SETCD04                 51760645
517607         MOVE ASC-SET-CODE-5        TO MR-SETCD05                 51760745
517608         MOVE ASC-SET-CODE-6        TO MR-SETCD06                 51760845
517609     ELSE                                                         51760945
517610         MOVE SPACES                TO MR-SETYR01                 51761045
517611                                       MR-SETYR02                 51761145
517612                                       MR-SETYR03                 51761245
517613                                       MR-SETYR04                 51761345
517614                                       MR-SETYR05                 51761445
517615                                       MR-SETYR06                 51761545
517616                                       MR-SETCD01                 51761645
517617                                       MR-SETCD02                 51761745
517618                                       MR-SETCD03                 51761845
517619                                       MR-SETCD04                 51761945
517620                                       MR-SETCD05                 51762045
517621                                       MR-SETCD06                 51762145
517622     END-IF.                                                      51762245
517623                                                                  51762345
517630     IF  DP020-MSG-NUMBER-X = SPACE                               51763045
517700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  51770000
517800*            --- MORE ITEMS TO DISPLAY ----                       51780000
517900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            51790000
518000             SET DP020-MSG-INFORMATIONAL TO TRUE                  51800000
518100         END-IF                                                   51810000
518200     END-IF.                                                      51820000
518300                                                                  51830000
518400*----------------------------------------------------------------*51840000
518500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *51850000
518600*----------------------------------------------------------------*51860000
518700 4410-READ-TEMP-STORAGE.                                          51870000
518800     EXEC CICS                                                    51880000
518900         READQ TS                                                 51890000
519000             QUEUE (ASC-LIST-QUEUE-NAME)                          51900000
519100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               51910000
519200             ITEM  (PV-BLOCK-NUMBER)                              51920000
519300             RESP  (PV-CICS-RESP)                                 51930000
519400     END-EXEC.                                                    51940000
519500                                                                  51950000
519600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       51960000
519700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     51970000
519800         CONTINUE                                                 51980000
519900     ELSE                                                         51990000
520000         SET DP013-CICS-ABEND     TO TRUE                         52000000
520100         SET DP013-NO-ROLLBACK    TO TRUE                         52010000
520200         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         52020000
520300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      52030000
520400                                  TO DP013-MESSAGE-TEXT(1)        52040000
520500         PERFORM DP013-0000-PROCESS-ABEND                         52050000
520600     END-IF.                                                      52060000
520700                                                                  52070000
520800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             52080000
520900                                                                  52090000
521000     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         52100000
521100         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               52110000
521200     END-IF.                                                      52120000
521300                                                                  52130000
521400                                                                  52140000
521500*----------------------------------------------------------------*52150000
521600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *52160000
521700*----------------------------------------------------------------*52170000
521800 4420-FORMAT-LIST-LINES.                                          52180000
521900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      52190000
522000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                52200000
522100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           52210000
522200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           52220000
522300         MOVE SPACE              TO MR-SELECTI (PV-SUB)           52230000
522400                                    MR-ACTION (PV-SUB)            52240000
522500                                    MR-DEPT (PV-SUB)              52250000
522600                                    MR-PO-NBR (PV-SUB)            52260000
522700                                    MR-RCVR-SEQ-NBR (PV-SUB)      52270000
522800                                    MR-VENDOR-NME (PV-SUB)        52280000
522900                                    MR-FCLTY-SHORT-NME (PV-SUB)   52290000
523000                                    MR-TROUBLE-REASON (PV-SUB)    52300000
523100                                    MR-ARRIVAL-DATE-TIME (PV-SUB) 52310000
523200                                    MR-NOTIFICATION-DATE-TIME     52320000
523300                                                          (PV-SUB)52330000
523400                                    MR-RESPONSE-DATE-TIME (PV-SUB)52340000
523500     ELSE                                                         52350000
523600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      52360000
523700                                                   > SPACE        52370000
523800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 52380000
523900                                 TO MR-SELECTI (PV-SUB)           52390000
524000         ELSE                                                     52400000
524100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      52410000
524200                                 TO MR-SELECTI (PV-SUB)           52420000
524300         END-IF                                                   52430000
524400                                                                  52440000
524500         IF  DP030-SET-CURSOR-TRAILER                             52450000
524600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)52460000
524700                 > SPACE)                                         52470000
524800               OR (PV-SUB = 1))                                   52480000
524900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               52490000
525000                MOVE -1          TO MR-SELECTL (PV-SUB)           52500000
525100             END-IF                                               52510000
525200         END-IF                                                   52520000
525300                                                                  52530000
525400         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           52540000
525500             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           52550000
525600                                 TO MR-ACTION (PV-SUB)            52560000
525700             MOVE ASC-DEPT-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         52570000
525800                                 TO MR-DEPT-N (PV-SUB)            52580000
525900             MOVE ASC-PO-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)         52590000
526000                                 TO MR-PO-NBR-N (PV-SUB)          52600000
526100             MOVE ASC-RCVR-SEQ-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)   52610000
526200                                 TO MR-RCVR-SEQ-NBR-N (PV-SUB)    52620000
526300             MOVE ASC-VENDOR-SHORT-NME (ASC-BLK-SUB ASC-ITEM-SUB) 52630000
526400                                 TO MR-VENDOR-NME (PV-SUB)        52640000
526500             MOVE ASC-FCLTY-NME (ASC-BLK-SUB ASC-ITEM-SUB)        52650000
526600                                 TO MR-FCLTY-SHORT-NME (PV-SUB)   52660000
526700             MOVE ASC-TROUBLE-REASON-DESC                         52670000
526800                                        (ASC-BLK-SUB ASC-ITEM-SUB)52680000
526900                                 TO MR-TROUBLE-REASON (PV-SUB)    52690000
527000                                                                  52700000
527100             IF  ASC-TRBL-DTL-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)   52710000
527200                 MOVE DP015-YELLOW TO MR-TROUBLE-REASONC (PV-SUB) 52720000
527300             ELSE                                                 52730000
527400                 MOVE DP015-BLUE TO MR-TROUBLE-REASONC (PV-SUB)   52740000
527500             END-IF                                               52750000
527600                                                                  52760000
527700             MOVE ASC-ARRIVAL-DATE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)52770000
527800                                 TO MR-ARRIVAL-DATE-TIME (PV-SUB) 52780000
527900             MOVE ASC-NOTIFICATION-DATE-TIME                      52790000
528000                                        (ASC-BLK-SUB ASC-ITEM-SUB)52800000
528100                            TO MR-NOTIFICATION-DATE-TIME (PV-SUB) 52810000
528200             MOVE ASC-RESPONSE-DATE-TIME                          52820000
528300                                        (ASC-BLK-SUB ASC-ITEM-SUB)52830000
528400                                 TO MR-RESPONSE-DATE-TIME (PV-SUB)52840000
528500                                                                  52850000
528600             IF  ASC-TRBL-RESOLVED (ASC-BLK-SUB ASC-ITEM-SUB)     52860000
528700                 MOVE DP015-YELLOW                                52870000
528800                           TO MR-RESPONSE-DATE-TIMEC(PV-SUB)      52880000
528900                 IF ASC-ALL-NOTIF-STATS AND                       52890000
529000                     ASC-TRBL-ACK (ASC-BLK-SUB ASC-ITEM-SUB)      52900000
529100                     MOVE DP015-YELLOW                            52910000
529200                           TO MR-DEPTC (PV-SUB)                   52920000
529300                              MR-PO-NBRC (PV-SUB)                 52930000
529400                              MR-RCVR-SEQ-NBRC (PV-SUB)           52940000
529500                              MR-VENDOR-NMEC (PV-SUB)             52950000
529600                              MR-FCLTY-SHORT-NMEC (PV-SUB)        52960000
529700                              MR-TROUBLE-REASONC (PV-SUB)         52970000
529800                              MR-ARRIVAL-DATE-TIMEC (PV-SUB)      52980000
529900                              MR-NOTIFICATION-DATE-TIMEC (PV-SUB) 52990000
530000                              MR-RESPONSE-DATE-TIMEC (PV-SUB)     53000000
530100                 END-IF                                           53010000
530200             ELSE                                                 53020000
530300                 MOVE DP015-BLUE TO MR-RESPONSE-DATE-TIMEC(PV-SUB)53030000
530400             END-IF                                               53040000
530500         END-IF                                                   53050000
530600     END-IF.                                                      53060000
530700     SUBTRACT +1 FROM ASC-ITEM-SUB                                53070000
530800     IF  ASC-ITEM-SUB < + 1                                       53080000
530900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  53090000
531000         MOVE +1                 TO ASC-BLK-SUB                   53100000
531100     END-IF.                                                      53110000
531200                                                                  53120000
531300******************************************************************53130000
531400** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **53140000
531500** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **53150000
531600** ISSUE A WARNING.                                             **53160000
531700******************************************************************53170000
531800 4430-CHECK-FOR-BEGIN-AND-END.                                    53180000
531900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       53190000
532000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     53200000
532100*            -- NO END-OF-RANGE SPECFIED ---                      53210000
532200             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            53220000
532300             SET DP020-MSG-WARNING TO TRUE                        53230000
532400             PERFORM 4431-POSITION-AT-WARNING                     53240000
532500         END-IF                                                   53250000
532600     ELSE                                                         53260000
532700         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     53270000
532800*            -- NO BEGINNING-OF-RANGE SPECFIED ---                53280000
532900             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            53290000
533000             SET DP020-MSG-WARNING TO TRUE                        53300000
533100             PERFORM 4431-POSITION-AT-WARNING                     53310000
533200         END-IF                                                   53320000
533300     END-IF.                                                      53330000
533400                                                                  53340000
533500******************************************************************53350000
533600** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **53360000
533700** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **53370000
533800** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **53380000
533900** POSITION THE CURSOR THERE.                                   **53390000
534000******************************************************************53400000
534100 4431-POSITION-AT-WARNING.                                        53410000
534200     COMPUTE PV-SUB-COMP3 = ASC-START-OF-SELECTED-RANGE           53420000
534300                    - PV-TOP-ITEM + 1.                            53430000
534400     MOVE PV-SUB-COMP3 TO PV-SUB.                                 53440000
534500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      53450000
534600         CONTINUE                                                 53460000
534700     ELSE                                                         53470000
534800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      53480000
534900         MOVE -1                   TO MR-SELECTL (PV-SUB)         53490000
535000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         53500000
535100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         53510000
535200     END-IF.                                                      53520000
535300                                                                  53530000
535400     COMPUTE PV-SUB-COMP3 = ASC-END-OF-SELECTED-RANGE             53540000
535500                    - PV-TOP-ITEM + 1.                            53550000
535600     MOVE PV-SUB-COMP3 TO PV-SUB.                                 53560000
535700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      53570000
535800         CONTINUE                                                 53580000
535900     ELSE                                                         53590000
536000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      53600000
536100         MOVE -1                   TO MR-SELECTL (PV-SUB)         53610000
536200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         53620000
536300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         53630000
536400     END-IF.                                                      53640000
536500                                                                  53650000
536600*----------------------------------------------------------------*53660000
536700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *53670000
536800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *53680000
536900* FOR THE SELECTED ITEMS QUEUE.                                  *53690000
537000*                                                                *53700000
537100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *53710000
537200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *53720000
537300* THE ARRAY IS FULL.                                             *53730000
537400*----------------------------------------------------------------*53740000
537500 5000-PREPARE-SEL-QUEUE.                                          53750000
537600     MOVE +1                   TO  ASC-BLK-SUB.                   53760000
537700     PERFORM 5100-WRITE-TEMP-STORAGE.                             53770000
537800     ADD +1                    TO  ASC-BLK-SUB.                   53780000
537900     PERFORM 5100-WRITE-TEMP-STORAGE.                             53790000
538000                                                                  53800000
538100*CLP 09/03/13 BEGIN                                               53810000
538200     IF DP020-FK-LOCAL-FUNC-12 (DP020-SRC-AID)                    53820000
538300         MOVE ASC-SEL-QUEUE-OUT    TO  SU009-SEL-QUEUE-NAME       53830000
538400     ELSE                                                         53840000
538500         MOVE ASC-SEL-QUEUE-OUT    TO  TM005-SEL-QUEUE-NAME       53850000
538600     END-IF.                                                      53860000
538700                                                                  53870000
538800     PERFORM 6010-DELETE-SEL-QUEUE.                               53880000
538900                                                                  53890000
539000     SET ASC-UPDATE-TSQ        TO  TRUE.                          53900000
539100                                                                  53910000
539200     IF DP020-FK-LOCAL-FUNC-12 (DP020-SRC-AID)                    53920000
539300         SET SU010-IDX TO 1                                       53930000
539400         MOVE ZERO     TO SU009-NUMBER-OF-TS-ITEMS                53940000
539500         INITIALIZE SU010-SELECTED-ITEM-ARRAY                     53950000
539600                                                                  53960000
539700         PERFORM 5600-FILL-SEL-QUEUE-RECORD                       53970000
539800                VARYING PV-ITEM                                   53980000
539900                FROM 1 BY 1                                       53990000
540000                UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN   54000000
540100                                                                  54010000
540200         IF  SU010-IDX > 1                                        54020000
540300             PERFORM 5206-WRITE-SEL-QUEUE                         54030000
540400             ADD +1            TO SU009-NUMBER-OF-TS-ITEMS        54040000
540500         END-IF                                                   54050000
540600                                                                  54060000
540700     ELSE                                                         54070000
540800         SET TM002-IDX TO  1                                      54080000
540900         MOVE ZERO     TO TM005-NUMBER-OF-TS-ITEMS                54090000
541000         INITIALIZE TM002-SELECTED-ITEM-ARRAY                     54100000
541100                                                                  54110000
541200         PERFORM 5200-FILL-SEL-QUEUE-RECORD                       54120000
541300                VARYING PV-ITEM                                   54130000
541400                FROM 1 BY 1                                       54140000
541500                UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN   54150000
541600                                                                  54160000
541700         IF  TM002-IDX > 1                                        54170000
541800             PERFORM 5205-WRITE-SEL-QUEUE                         54180000
541900             ADD +1            TO TM005-NUMBER-OF-TS-ITEMS        54190000
542000         END-IF                                                   54200000
542100                                                                  54210000
542200     END-IF.                                                      54220000
542300*CLP 09/03/13 END                                                 54230000
542400*----------------------------------------------------------------*54240000
542500* PARAGRAPH 5000-PREPARE-SEL-QUEUE-R IS USED BY RCVRMNT FUNCTION *54250000
542600*                                                                *54260000
542700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *54270000
542800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *54280000
542900* FOR THE SELECTED ITEMS QUEUE.                                  *54290000
543000*                                                                *54300000
543100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *54310000
543200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *54320000
543300* THE ARRAY IS FULL.                                             *54330000
543400*----------------------------------------------------------------*54340000
543500 5000-PREPARE-SEL-QUEUE-R.                                        54350000
543600     MOVE +1                       TO ASC-BLK-SUB.                54360000
543700     PERFORM 5100-WRITE-TEMP-STORAGE.                             54370000
543800     ADD +1                        TO ASC-BLK-SUB.                54380000
543900     PERFORM 5100-WRITE-TEMP-STORAGE.                             54390000
544000                                                                  54400000
544100     MOVE ASC-SEL-QUEUE-OUT        TO RC015-SEL-QUEUE-NAME.       54410000
544200     PERFORM 6010-DELETE-SEL-QUEUE.                               54420000
544300                                                                  54430000
544400     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      54440000
544500         SET ASC-UPDATE-TSQ        TO TRUE                        54450000
544600     END-IF.                                                      54460000
544700                                                                  54470000
544800     SET RC013-IDX                 TO 1.                          54480000
544900     MOVE ZERO                     TO RC015-NUMBER-OF-TS-ITEMS.   54490000
545000     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        54500000
545100                                                                  54510000
545200     PERFORM 5200-FILL-SEL-QUEUE-RECORD-R                         54520000
545300             VARYING PV-ITEM                                      54530000
545400             FROM 1 BY 1                                          54540000
545500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     54550000
545600                                                                  54560000
545700     IF  RC013-IDX > 1                                            54570000
545800         PERFORM 5205-WRITE-SEL-QUEUE-R                           54580000
545900         ADD +1                    TO RC015-NUMBER-OF-TS-ITEMS    54590000
546000     END-IF.                                                      54600000
546100                                                                  54610000
546200*----------------------------------------------------------------*54620000
546300* PARAGRAPH 5000-PREPARE-SEL-QUEUE-PCK IS USED BY THE RCPCKLST   *54630000
546400* FUNCTION.                                                      *54640000
546500*                                                                *54650000
546600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *54660000
546700* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *54670000
546800* FOR THE SELECTED ITEMS QUEUE.                                  *54680000
546900*                                                                *54690000
547000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *54700000
547100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *54710000
547200* THE ARRAY IS FULL.                                             *54720000
547300*----------------------------------------------------------------*54730000
547400 5000-PREPARE-SEL-QUEUE-PCK.                                      54740000
547500     MOVE +1                       TO ASC-BLK-SUB.                54750000
547600     PERFORM 5100-WRITE-TEMP-STORAGE.                             54760000
547700     ADD +1                        TO ASC-BLK-SUB.                54770000
547800     PERFORM 5100-WRITE-TEMP-STORAGE.                             54780000
547900                                                                  54790000
548000     MOVE ASC-SEL-QUEUE-OUT        TO RC800-SEL-QUEUE-NAME.       54800000
548100     PERFORM 6010-DELETE-SEL-QUEUE.                               54810000
548200                                                                  54820000
548300     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      54830000
548400         SET ASC-UPDATE-TSQ2       TO TRUE                        54840000
548500     END-IF.                                                      54850000
548600                                                                  54860000
548700     PERFORM 5200-FILL-SEL-QUEUE-RECORD-PCK                       54870000
548800             VARYING PV-ITEM                                      54880000
548900             FROM 1 BY 1                                          54890000
549000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     54900000
549100                                                                  54910000
549200*----------------------------------------------------------------*54920000
549300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *54930000
549400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *54940000
549500* FOR THE SELECTED ITEMS QUEUE.                                  *54950000
549600*                                                                *54960000
549700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *54970000
549800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *54980000
549900* THE ARRAY IS FULL.                                             *54990000
550000*----------------------------------------------------------------*55000000
550100 5010-PREPARE-SEL-QUEUE.                                          55010000
550200                                                                  55020000
550300     MOVE +1                   TO  ASC-BLK-SUB.                   55030000
550400     PERFORM 5100-WRITE-TEMP-STORAGE.                             55040000
550500     ADD +1                    TO  ASC-BLK-SUB.                   55050000
550600     PERFORM 5100-WRITE-TEMP-STORAGE.                             55060000
550700                                                                  55070000
550800     MOVE ASC-SEL-QUEUE-OUT    TO  SU038-SEL-QUEUE-NAME.          55080000
550900*    PERFORM 6010-DELETE-SEL-QUEUE.                               55090000
551000                                                                  55100000
551100     SET ASC-UPDATE-TSQ        TO  TRUE.                          55110000
551200                                                                  55120000
551300     SET SU039-IDX             TO  1.                             55130000
551400     MOVE ZERO                 TO SU038-NUMBER-OF-TS-ITEMS.       55140000
551500     INITIALIZE SU039-SELECTED-ITEM-ARRAY.                        55150000
551600                                                                  55160000
551700     PERFORM 5020-FILL-SEL-QUEUE-RECORD                           55170000
551800             VARYING PV-ITEM                                      55180000
551900             FROM 1 BY 1                                          55190000
552000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     55200000
552100                                                                  55210000
552200     IF  SU039-IDX > 1                                            55220000
552300         PERFORM 5305-WRITE-SEL-QUEUE                             55230000
552400         ADD +1                TO SU038-NUMBER-OF-TS-ITEMS        55240000
552500     END-IF.                                                      55250000
552600                                                                  55260000
552700                                                                  55270000
552800 5020-FILL-SEL-QUEUE-RECORD.                                      55280000
552900                                                                  55290000
553000     PERFORM 6112-READ-LIST-QUEUE.                                55300000
553100                                                                  55310000
553200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       55320000
553300         PERFORM                                                  55330000
553400         VARYING LQW-IDX                                          55340000
553500         FROM 1 BY 1                                              55350000
553600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            55360000
553700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          55370000
553800                                                                  55380000
553900             IF  LQW-SELECT (LQW-IDX)                             55390000
554000                 MOVE LQW-PO-LNE-NBR (LQW-IDX)                    55400000
554100                                   TO SU039-LINE (SU039-IDX)      55410000
554200                                      SU038-LINE                  55420000
554300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              55430000
554400                                   TO SU039-ITEM (SU039-IDX)      55440000
554500***              MOVE LQW-TBL-CARTON-ID (LQW-IDX)                 55450000
554600***                             TO SU039-SHIPT-UNT-ID (SU039-IDX) 55460000
554700                 MOVE SPACE        TO SU039-ACTION-SW (SU039-IDX) 55470000
554800                 MOVE LQW-PO-NBR (LQW-IDX)                        55480000
554900                                        TO PV-PO-NBR-Z            55490000
555000                 MOVE LQW-RCVR-SEQ-NBR   (LQW-IDX)                55500000
555100                                        TO PV-RECEIVER            55510000
555200                 MOVE PV-PO-RECEIVER    TO SU038-PO-RCVR          55520000
555300                                         SU039-PO-RCVR (SU039-IDX)55530000
555400                 MOVE ASC-SAVE-OPER-UNT-ID                        55540000
555500                                  TO SU039-OPER-UNT-ID (SU039-IDX)55550000
555600                 SET SU039-IDX UP BY 1                            55560000
555700                 IF  SU039-IDX > SU039-MAX-ITEMS                  55570000
555800                     PERFORM 5305-WRITE-SEL-QUEUE                 55580000
555900                     ADD +1        TO SU038-NUMBER-OF-TS-ITEMS    55590000
556000                     INITIALIZE SU039-SELECTED-ITEM-ARRAY         55600000
556100                     SET SU039-IDX TO  1                          55610000
556200                 END-IF                                           55620000
556300             END-IF                                               55630000
556400         END-PERFORM                                              55640000
556500     END-IF.                                                      55650000
556600*----------------------------------------------------------------*55660000
556700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *55670000
556800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *55680000
556900* FOR THE SELECTED ITEMS QUEUE.                                  *55690000
557000*                                                                *55700000
557100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *55710000
557200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *55720000
557300* THE ARRAY IS FULL.                                             *55730000
557400*----------------------------------------------------------------*55740000
557500 5025-PREPARE-SEL-QUEUE-FOR-PO.                                   55750000
557600     MOVE +1                   TO  ASC-BLK-SUB.                   55760000
557700     PERFORM 5100-WRITE-TEMP-STORAGE.                             55770000
557800     ADD +1                    TO  ASC-BLK-SUB.                   55780000
557900     PERFORM 5100-WRITE-TEMP-STORAGE.                             55790000
558000                                                                  55800000
558100     MOVE ASC-SEL-QUEUE-OUT    TO  PO013-SEL-QUEUE-NAME.          55810000
558200     PERFORM 6010-DELETE-SEL-QUEUE.                               55820000
558300                                                                  55830000
558400     SET ASC-UPDATE-TSQ        TO  TRUE.                          55840000
558500                                                                  55850000
558600     SET PO012-IDX             TO  1.                             55860000
558700     MOVE ZERO                 TO PO013-NUMBER-OF-TS-ITEMS.       55870000
558800     INITIALIZE PO012-SELECTED-ITEM-ARRAY.                        55880000
558900                                                                  55890000
559000     PERFORM 5250-FILL-SEL-QUEUE-REC-FOR-PO                       55900000
559100             VARYING PV-ITEM                                      55910000
559200             FROM 1 BY 1                                          55920000
559300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     55930000
559400                                                                  55940000
559500     IF  PO012-IDX > 1 AND PS-NO-ERROR                            55950000
559600         PERFORM 5265-WRITE-PO-SEL-QUEUE                          55960000
559700         ADD +1                TO PO013-NUMBER-OF-TS-ITEMS        55970000
559800     END-IF.                                                      55980000
559900                                                                  55990000
560000*----------------------------------------------------------------*56000000
560100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE TO BE PROCESSED  *56010000
560200* BY THE TROUBLE CENTRAL PROCESSING ROUTINE (TMKCS520).  MOVE    *56020000
560300* ALL SELECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE     *56030000
560400* LAYOUT FOR THE SELECTED ITEMS QUEUE.                           *56040000
560500*----------------------------------------------------------------*56050000
560600 5050-PREPARE-TO-PROCESS-TRBL.                                    56060000
560700     MOVE +1                   TO  ASC-BLK-SUB.                   56070000
560800     PERFORM 5100-WRITE-TEMP-STORAGE.                             56080000
560900     ADD +1                    TO  ASC-BLK-SUB.                   56090000
561000     PERFORM 5100-WRITE-TEMP-STORAGE.                             56100000
561100     PERFORM 5300-PROCESS-TROUBLE-UPDATE                          56110000
561200             VARYING PV-ITEM                                      56120000
561300             FROM 1 BY 1                                          56130000
561400             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN      56140000
561500             OR PS-ERROR.                                         56150000
561600                                                                  56160000
561700*----------------------------------------------------------------*56170000
561800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *56180000
561900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *56190000
562000*----------------------------------------------------------------*56200000
562100 5100-WRITE-TEMP-STORAGE.                                         56210000
562200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     56220000
562300                                   TO PV-LIST-ITEM-NUMBER.        56230000
562400     COMPUTE PV-BLOCK-NUMBER =                                    56240000
562500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    56250000
562600                                                                  56260000
562700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             56270000
562800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             56280000
562900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      56290000
563000             PERFORM 5105-REWRITE-ASC-LISTQ                       56300000
563100         END-IF                                                   56310000
563200     ELSE                                                         56320000
563300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       56330000
563400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            56340000
563500         PERFORM 5110-WRITE-ASC-LISTQ                             56350000
563600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   56360000
563700     END-IF.                                                      56370000
563800                                                                  56380000
563900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             56390000
564000                                                                  56400000
564100******************************************************************56410000
564200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **56420000
564300** SPECIFIC COMMAREA.                                           **56430000
564400******************************************************************56440000
564500 5105-REWRITE-ASC-LISTQ.                                          56450000
564600     EXEC CICS                                                    56460000
564700         WRITEQ TS                                                56470000
564800             QUEUE (ASC-LIST-QUEUE-NAME)                          56480000
564900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56490000
565000             ITEM  (PV-BLOCK-NUMBER)                              56500000
565100             REWRITE                                              56510000
565200             RESP  (PV-CICS-RESP)                                 56520000
565300     END-EXEC.                                                    56530000
565400                                                                  56540000
565500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           56550000
565600         CONTINUE                                                 56560000
565700     ELSE                                                         56570000
565800         SET DP013-CICS-ABEND            TO TRUE                  56580000
565900         SET DP013-NO-ROLLBACK           TO TRUE                  56590000
566000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       56600000
566100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     56610000
566200                                         TO DP013-MESSAGE-TEXT(1) 56620000
566300         PERFORM DP013-0000-PROCESS-ABEND                         56630000
566400     END-IF.                                                      56640000
566500                                                                  56650000
566600******************************************************************56660000
566700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **56670000
566800** SPECIFIC COMMAREA.                                           **56680000
566900******************************************************************56690000
567000 5110-WRITE-ASC-LISTQ.                                            56700000
567100     EXEC CICS                                                    56710000
567200         WRITEQ TS                                                56720000
567300             QUEUE (ASC-LIST-QUEUE-NAME)                          56730000
567400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56740000
567500             ITEM  (PV-BLOCK-NUMBER)                              56750000
567600             RESP  (PV-CICS-RESP)                                 56760000
567700     END-EXEC.                                                    56770000
567800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      56780000
567900         SET DP013-CICS-ABEND      TO TRUE                        56790000
568000         SET DP013-NO-ROLLBACK     TO TRUE                        56800000
568100         MOVE '5110-WRITE-ASC-LISTQ' TO DP013-PARAGRAPH           56810000
568200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           56820000
568300                                   TO DP013-MESSAGE-TEXT(1)       56830000
568400         PERFORM DP013-0000-PROCESS-ABEND                         56840000
568500     END-IF.                                                      56850000
568600                                                                  56860000
568700*----------------------------------------------------------------*56870000
568800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *56880000
568900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *56890000
569000*----------------------------------------------------------------*56900000
569100 5200-FILL-SEL-QUEUE-RECORD.                                      56910000
569200     PERFORM 6112-READ-LIST-QUEUE.                                56920000
569300     SET ASC-STAYING-WITHIN-TROUBLE TO TRUE                       56930000
569400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       56940000
569500         PERFORM                                                  56950000
569600         VARYING LQW-IDX                                          56960000
569700         FROM 1 BY 1                                              56970000
569800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            56980000
569900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          56990000
570000                                                                  57000000
570100             IF  LQW-SELECT (LQW-IDX)                             57010000
570200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              57020000
570300                                 TO TM002-ITEM (TM002-IDX)        57030000
570400                 MOVE LQW-NOTIF-NBR (LQW-IDX)                     57040000
570500                                 TO TM002-NOTIF-NBR (TM002-IDX)   57050000
570600                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   57060000
570700                                 TO TM002-OPER-UNT-ID (TM002-IDX) 57070000
570800                 MOVE LQW-FCLTY-ID (LQW-IDX)                      57080000
570900                                 TO TM002-FCLTY-ID (TM002-IDX)    57090000
571000                 MOVE LQW-PO-NBR (LQW-IDX)                        57100000
571100                                 TO TM002-PO-NBR (TM002-IDX)      57110000
571200                 MOVE LQW-RCVR-SEQ-NBR (LQW-IDX)                  57120000
571300                                 TO TM002-RCVR-SEQ (TM002-IDX)    57130000
571400                 MOVE LQW-PO-LNE-NBR (LQW-IDX)                    57140000
571500                                 TO TM002-PO-LNE-NBR (TM002-IDX)  57150000
571600                 MOVE LQW-PREPK-ID (LQW-IDX)                      57160000
571700                                 TO TM002-PREPK-ID (TM002-IDX)    57170000
571800                 MOVE LQW-TROUBLE-REASON-CDE (LQW-IDX)            57180000
571900                                 TO TM002-TRBL-RSN-CDE (TM002-IDX)57190000
572000                 MOVE LQW-TROUBLE-REASON-LVL (LQW-IDX)            57200000
572100                                 TO TM002-TRBL-LVL-IND (TM002-IDX)57210000
572200                 MOVE SPACE        TO  TM002-ACTION-SW (TM002-IDX)57220000
572300                 SET TM002-IDX UP BY 1                            57230000
572400                 IF  TM002-IDX > TM002-MAX-ITEMS                  57240000
572500                     PERFORM 5205-WRITE-SEL-QUEUE                 57250000
572600                     ADD +1        TO TM005-NUMBER-OF-TS-ITEMS    57260000
572700                     INITIALIZE TM002-SELECTED-ITEM-ARRAY         57270000
572800                     SET TM002-IDX TO  1                          57280000
572900                 END-IF                                           57290000
573000             END-IF                                               57300000
573100         END-PERFORM                                              57310000
573200     END-IF.                                                      57320000
573300                                                                  57330000
573400*----------------------------------------------------------------*57340000
573500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *57350000
573600*----------------------------------------------------------------*57360000
573700 5205-WRITE-SEL-QUEUE.                                            57370000
573800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO TM002-SELECTED-ITEMS.   57380000
573900                                                                  57390000
574000     EXEC CICS                                                    57400000
574100          WRITEQ TS                                               57410000
574200              QUEUE (ASC-SEL-QUEUE-OUT)                           57420000
574300              FROM  (TM002-MESSAGE-SEL-REC)                       57430000
574400              ITEM  (ASC-SEL-ITEM)                                57440000
574500              RESP  (PV-CICS-RESP)                                57450000
574600     END-EXEC.                                                    57460000
574700                                                                  57470000
574800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57480000
574900         CONTINUE                                                 57490000
575000     ELSE                                                         57500000
575100         SET DP013-CICS-ABEND                                     57510000
575200             DP013-NO-ROLLBACK     TO TRUE                        57520000
575300         MOVE '5205-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           57530000
575400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          57540000
575500                                   TO DP013-MESSAGE-TEXT(1)       57550000
575600         PERFORM DP013-0000-PROCESS-ABEND                         57560000
575700     END-IF.                                                      57570000
575800                                                                  57580000
575900*----------------------------------------------------------------*57590000
576000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE. (F19)          *57600000
576100*----------------------------------------------------------------*57610000
576200 5206-WRITE-SEL-QUEUE.                                            57620000
576300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU010-SELECTED-ITEMS.   57630000
576400                                                                  57640000
576500     EXEC CICS                                                    57650000
576600          WRITEQ TS                                               57660000
576700              QUEUE (ASC-SEL-QUEUE-OUT)                           57670000
576800              FROM  (SU010-SELECT-RECORD)                         57680000
576900              ITEM  (ASC-SEL-ITEM)                                57690000
577000              RESP  (PV-CICS-RESP)                                57700000
577100     END-EXEC.                                                    57710000
577200                                                                  57720000
577300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57730000
577400         CONTINUE                                                 57740000
577500     ELSE                                                         57750000
577600         SET DP013-CICS-ABEND                                     57760000
577700             DP013-NO-ROLLBACK     TO TRUE                        57770000
577800         MOVE '5206-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           57780000
577900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          57790000
578000                                   TO DP013-MESSAGE-TEXT(1)       57800000
578100         PERFORM DP013-0000-PROCESS-ABEND                         57810000
578200     END-IF.                                                      57820000
578300                                                                  57830000
578400*----------------------------------------------------------------*57840000
578500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *57850000
578600*----------------------------------------------------------------*57860000
578700 5305-WRITE-SEL-QUEUE.                                            57870000
578800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU039-SELECTED-ITEMS.   57880000
578900                                                                  57890000
579000     EXEC CICS                                                    57900000
579100          WRITEQ TS                                               57910000
579200              QUEUE (ASC-SEL-QUEUE-OUT)                           57920000
579300              FROM  (SU039-SELECT-RECORD)                         57930000
579400              ITEM  (ASC-SEL-ITEM)                                57940000
579500              RESP  (PV-CICS-RESP)                                57950000
579600     END-EXEC.                                                    57960000
579700                                                                  57970000
579800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57980000
579900         CONTINUE                                                 57990000
580000     ELSE                                                         58000000
580100         SET DP013-CICS-ABEND                                     58010000
580200             DP013-NO-ROLLBACK     TO TRUE                        58020000
580300         MOVE '5305-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           58030000
580400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          58040000
580500                                   TO DP013-MESSAGE-TEXT(1)       58050000
580600         PERFORM DP013-0000-PROCESS-ABEND                         58060000
580700     END-IF.                                                      58070000
580800                                                                  58080000
580900*----------------------------------------------------------------*58090000
581000* 5200-FILL-SEL-QUEUE-RECORD-R USED BY RCVRMNT FUNCTION          *58100000
581100*                                                                *58110000
581200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *58120000
581300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *58130000
581400*----------------------------------------------------------------*58140000
581500 5200-FILL-SEL-QUEUE-RECORD-R.                                    58150000
581600     PERFORM 6112-READ-LIST-QUEUE.                                58160000
581700                                                                  58170000
581800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       58180000
581900         PERFORM                                                  58190000
582000         VARYING LQW-IDX                                          58200000
582100         FROM 1 BY 1                                              58210000
582200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            58220000
582300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          58230000
582400                                                                  58240000
582500             IF  LQW-SELECT (LQW-IDX)                             58250000
582600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              58260000
582700                                   TO RC013-ITEM (RC013-IDX)      58270000
582800                 MOVE LQW-RCVR-SEQ-NBR (LQW-IDX)                  58280000
582900                                   TO RC013-REC-SEQ-NBR           58290000
583000                                        (RC013-IDX)               58300000
583100                                     RC015-REC-SEQ-NBR            58310000
583200                 MOVE LQW-PO-NBR(LQW-IDX)                         58320000
583300                                   TO RC013-PO-NBR (RC013-IDX)    58330000
583400                                      RC015-PO-NBR                58340000
583500                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   58350000
583600                                   TO RC013-OPER-UNT-ID(RC013-IDX)58360000
583700                                      RC015-OPER-UNT-ID           58370000
583800                 MOVE LQW-FCLTY-ID (LQW-IDX)                      58380000
583900                                   TO RC013-FCLTY-ID(RC013-IDX)   58390000
584000                                      RC015-FCLTY-ID              58400000
584100                 MOVE LQW-ACTION (LQW-IDX)                        58410000
584200                                   TO RC013-ACTION-SW (RC013-IDX) 58420000
584300                 MOVE SPACE        TO RC013-ACTION-SW (RC013-IDX) 58430000
584400                 SET RC013-IDX UP BY 1                            58440000
584500                 IF  RC013-IDX > RC013-MAX-ITEMS                  58450000
584510*CLP 09/09/13 START                                               58451005
584600                     PERFORM 5205-WRITE-SEL-QUEUE-R               58460000
584601*CLP 09/09/13 END                                                 58460105
584700                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    58470000
584800                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         58480000
584900                     SET RC013-IDX TO 1                           58490000
585000                 END-IF                                           58500000
585100             END-IF                                               58510000
585200         END-PERFORM                                              58520000
585300     END-IF.                                                      58530000
585400                                                                  58540000
585500*----------------------------------------------------------------*58550000
585600* 5200-FILL-SEL-QUEUE-RECORD-PCK USED BY RCPCKLST FUNCTION       *58560000
585700*                                                                *58570000
585800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *58580000
585900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *58590000
586000*----------------------------------------------------------------*58600000
586100 5200-FILL-SEL-QUEUE-RECORD-PCK.                                  58610000
586200     PERFORM 6112-READ-LIST-QUEUE.                                58620000
586300                                                                  58630000
586400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       58640000
586500         PERFORM                                                  58650000
586600         VARYING LQW-IDX                                          58660000
586700         FROM 1 BY 1                                              58670000
586800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            58680000
586900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          58690000
587000                                                                  58700000
587100             IF  LQW-SELECT (LQW-IDX)                             58710000
587200                 MOVE LQW-RCVR-SEQ-NBR (LQW-IDX)                  58720000
587300                             TO RC800-REC-SEQ-NBR-N               58730000
587400                 MOVE LQW-PO-NBR(LQW-IDX)                         58740000
587500                             TO RC800-REC-NBR-N                   58750000
587600                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   58760000
587700                             TO RC800-OPER-UNIT-ID                58770000
587800                 MOVE LQW-FCLTY-ID (LQW-IDX)                      58780000
587900                             TO RC800-FACILITY-ID                 58790000
588000             END-IF                                               58800000
588100         END-PERFORM                                              58810000
588200     END-IF.                                                      58820000
588300                                                                  58830000
588400*----------------------------------------------------------------*58840000
588500*    5205-WRITE-SEL-QUEUE-R IS USED BY RCVRMNT FUNCTION          *58850000
588600*                                                                *58860000
588700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *58870000
588800*----------------------------------------------------------------*58880000
588900 5205-WRITE-SEL-QUEUE-R.                                          58890000
589000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC013-SELECTED-ITEMS.   58900000
589100                                                                  58910000
589200     EXEC CICS                                                    58920000
589300          WRITEQ TS                                               58930000
589400              QUEUE (ASC-SEL-QUEUE-OUT)                           58940000
589500              FROM  (RC013-DC-SELECT-RECORD)                      58950000
589600              ITEM  (PV-SEL-QUEUE-ITEM)                           58960000
589700              RESP  (PV-CICS-RESP)                                58970000
589800     END-EXEC.                                                    58980000
589900                                                                  58990000
590000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59000000
590100         CONTINUE                                                 59010000
590200     ELSE                                                         59020000
590300         SET DP013-CICS-ABEND      TO TRUE                        59030000
590400         SET DP013-NO-ROLLBACK     TO TRUE                        59040000
590500         MOVE '5205-WRITE-SEL-QUEUE-R' TO DP013-PARAGRAPH         59050000
590600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          59060000
590700                                   TO DP013-MESSAGE-TEXT(1)       59070000
590800         PERFORM DP013-0000-PROCESS-ABEND                         59080000
590900     END-IF.                                                      59090000
591000                                                                  59100000
591100*----------------------------------------------------------------*59110000
591200*    5205-WRITE-SEL-QUEUE-PCK IS USED BY RCPCKLST FUNCTION       *59120000
591300*                                                                *59130000
591400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *59140000
591500*----------------------------------------------------------------*59150000
591600 5205-WRITE-SEL-QUEUE-PCK.                                        59160000
591700                                                                  59170000
591800     EXEC CICS                                                    59180000
591900          WRITEQ TS                                               59190000
592000              QUEUE (ASC-SEL-QUEUE-OUT)                           59200000
592100              FROM  (RC800-INTER-APPL-COMMAREA)                   59210000
592200              ITEM  (PV-SEL-QUEUE-ITEM)                           59220000
592300              RESP  (PV-CICS-RESP)                                59230000
592400     END-EXEC.                                                    59240000
592500                                                                  59250000
592600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59260000
592700         CONTINUE                                                 59270000
592800     ELSE                                                         59280000
592900         SET DP013-CICS-ABEND      TO TRUE                        59290000
593000         SET DP013-NO-ROLLBACK     TO TRUE                        59300000
593100         MOVE '5205-WRITE-SEL-QUEUE-PCK' TO DP013-PARAGRAPH       59310000
593200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          59320000
593300                                   TO DP013-MESSAGE-TEXT(1)       59330000
593400         PERFORM DP013-0000-PROCESS-ABEND                         59340000
593500     END-IF.                                                      59350000
593600                                                                  59360000
593700*----------------------------------------------------------------*59370000
593800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *59380000
593900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *59390000
594000*----------------------------------------------------------------*59400000
594100 5250-FILL-SEL-QUEUE-REC-FOR-PO.                                  59410000
594200     PERFORM 6112-READ-LIST-QUEUE.                                59420000
594300                                                                  59430000
594400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       59440000
594500         PERFORM                                                  59450000
594600         VARYING LQW-IDX                                          59460000
594700         FROM 1 BY 1                                              59470000
594800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            59480000
594900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          59490000
595000           OR  PS-ERROR                                           59500000
595100             IF  PS-FIRST-TIME                                    59510000
595200                 SET PS-NOT-FIRST-TIME TO TRUE                    59520000
595300                 MOVE LQW-PO-NBR (LQW-IDX) TO PV-PREV-PO-NBR      59530000
595400                 MOVE LQW-DEPT   (LQW-IDX) TO PV-PREV-DEPT-NBR    59540000
595500             END-IF                                               59550000
595600                                                                  59560000
595700             IF  LQW-SELECT (LQW-IDX)                             59570000
595800                 SET ASC-GOING-TO-PO   TO TRUE                    59580000
595900                 PERFORM 5255-FETCH-TPURCHS-INFO                  59590000
596000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              59600000
596100                                   TO  PO012-ITEM(PO012-IDX)      59610000
596200                 MOVE PURCHS-DEPT-NBR                             59620000
596300                                   TO  PO013-DEPT-NBR             59630000
596400                 MOVE PURCHS-STATUS-CDE                           59640000
596500                                   TO  PO012-STATUS (PO012-IDX)   59650000
596600                 MOVE PURCHS-PO-TYP-CDE                           59660000
596700                                   TO  PO012-PO-TYPE (PO012-IDX)  59670000
596800                 PERFORM 5260-FETCH-VENDOR-LONG-NAME              59680000
596900                 IF  SQLCODE = +100                               59690000
597000                     MOVE SPACES TO PO012-VENDOR-NAME (PO012-IDX) 59700000
597100                 ELSE                                             59710000
597200                     MOVE ENTNME-ENT-NAME-DESC                    59720000
597300                                   TO  PO012-VENDOR-NAME          59730000
597400                                                    (PO012-IDX)   59740000
597500                 END-IF                                           59750000
597600                 MOVE LQW-ENT-ID (LQW-IDX) TO PO013-ENT-ID        59760000
597700                 MOVE LQW-PO-NBR (LQW-IDX)                        59770000
597800                                   TO  PO012-PO-NBR (PO012-IDX)   59780000
597900                                       PO013-PO-NBR               59790000
598000                 MOVE LQW-PO-LNE-NBR (LQW-IDX)                    59800000
598100                               TO  PO012-PO-LNE-NBR (PO012-IDX)   59810000
598200                 MOVE SPACE        TO  PO012-ACTION-SW (PO012-IDX)59820000
598300                 SET PO012-IDX UP BY 1                            59830000
598400                 IF  PO012-IDX > PO012-MAX-ITEMS                  59840000
598500                     PERFORM 5265-WRITE-PO-SEL-QUEUE              59850000
598600                     ADD +1        TO PO013-NUMBER-OF-TS-ITEMS    59860000
598700                     INITIALIZE PO012-SELECTED-ITEM-ARRAY         59870000
598800                     SET PO012-IDX TO  1                          59880000
598900                 END-IF                                           59890000
599000             END-IF                                               59900000
599100         END-PERFORM                                              59910000
599200     END-IF.                                                      59920000
599300                                                                  59930000
599400*----------------------------------------------------------------*59940000
599500*    RETRIEVE THE PURCHASE ORDER HEADER INFORMATION FOR THE      *59950000
599600*    PO ASSOCIATED WITH THE TROUBLE NOTIFICATION RECORD.         *59960000
599700*----------------------------------------------------------------*59970000
599800 5255-FETCH-TPURCHS-INFO.                                         59980000
599900     MOVE LQW-PO-NBR (LQW-IDX)  TO TRBNTF-PO-NBR.                 59990000
600000                                                                  60000000
600100     PERFORM                                                      60010000
600200         WITH TEST AFTER                                          60020000
600300         VARYING PV-RETRY-COUNTER                                 60030000
600400         FROM 1 BY 1                                              60040000
600500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               60050000
600600                   OR (SQLCODE = ZERO OR +100))                   60060000
600700                                                                  60070000
600800         EXEC SQL                                                 60080000
600900              SELECT PO_TYP_CDE                                   60090000
601000                     ,DIR_STR_IND                                 60100000
601100                     ,STATUS_CDE                                  60110000
601200                     ,DEPT_NBR                                    60120000
601300                INTO :PURCHS-PO-TYP-CDE                           60130000
601400                     ,:PURCHS-DIR-STR-IND                         60140000
601500                     ,:PURCHS-STATUS-CDE                          60150000
601600                     ,:PURCHS-DEPT-NBR                            60160000
601700                FROM TPURCHS                                      60170000
601800               WHERE PO_NBR       = :TRBNTF-PO-NBR                60180000
601900                 AND VER_STATUS_CDE = :PC-ACTIVE-STATUS           60190000
602000         END-EXEC                                                 60200000
602100                                                                  60210000
602200         EVALUATE TRUE                                            60220000
602300             WHEN SQLCODE = ZERO                                  60230000
602400             WHEN SQLCODE = -904                                  60240000
602500             WHEN SQLCODE = -913                                  60250000
602600                  CONTINUE                                        60260000
602700             WHEN SQLCODE = +100                                  60270000
602800                  MOVE SPACES  TO PURCHS-PO-TYP-CDE               60280000
602900                                  PURCHS-DIR-STR-IND              60290000
603000                                  PURCHS-STATUS-CDE               60300000
603100                                  PURCHS-DEPT-NBR                 60310000
603200             WHEN SQLWARN0 NOT = SPACE                            60320000
603300             WHEN SQLCODE NOT = ZERO                              60330000
603400                  MOVE '5255-FETCH-TPURCHS-INFO'                  60340000
603500                                   TO DP013-PARAGRAPH             60350000
603600                  MOVE 'FETCH PURCHASE ORDER INFORMATION'         60360000
603700                                   TO DP013-MESSAGE-TEXT (1)      60370000
603800                  MOVE 'FOR THE FOLLOWING PO:           '         60380000
603900                                   TO DP013-MESSAGE-TEXT (2)      60390000
604000                  MOVE TRBNTF-PO-NBR TO DP013-MESSAGE-TEXT (3)    60400000
604100                  MOVE SQLCA   TO DP013-SQLCA                     60410000
604200                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     60420000
604300                  SET DP013-DB2-ABEND TO TRUE                     60430000
604400                  PERFORM DP013-0000-PROCESS-ABEND                60440000
604500         END-EVALUATE                                             60450000
604600     END-PERFORM.                                                 60460000
604700                                                                  60470000
604800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60480000
604900         MOVE '5255-FETCH-TPURCHS-INFO' TO DP013-PARAGRAPH        60490000
605000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     60500000
605100                                   TO DP013-MESSAGE-TEXT (1)      60510000
605200         MOVE SQLCA                TO DP013-SQLCA                 60520000
605300         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    60530000
605400         SET DP013-DB2-ABEND                                      60540000
605500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   60550000
605600         PERFORM DP013-0000-PROCESS-ABEND                         60560000
605700     END-IF.                                                      60570000
605800                                                                  60580000
605900*----------------------------------------------------------------*60590000
606000*    RETRIEVE THE FULL VENDOR NAME THAT IS ASSOCIATED WITH THE   *60600000
606100*    TROUBLE NOTIFICATION RECORD.  THIS INFORMATION WILL BE USED *60610000
606200*    WHEN PERFORMING EITHER A PO INQUIRY LOOKUP OR PO UPDATE FOR *60620000
606300*    THIS SPECIFIC TROUBLE NOTIFICATION RECORD.                  *60630000
606400*----------------------------------------------------------------*60640000
606500 5260-FETCH-VENDOR-LONG-NAME.                                     60650000
606600     MOVE LQW-ENT-ID(LQW-IDX)   TO DK-ENT-ID                      60660000
606700                                                                  60670000
606800     PERFORM                                                      60680000
606900         WITH TEST AFTER                                          60690000
607000         VARYING PV-RETRY-COUNTER                                 60700000
607100         FROM 1 BY 1                                              60710000
607200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               60720000
607300                   OR (SQLCODE = ZERO OR +100))                   60730000
607400                                                                  60740000
607500         EXEC SQL                                                 60750000
607600              SELECT ENT_NAME_DESC                                60760000
607700                INTO :ENTNME-ENT-NAME-DESC                        60770000
607800                FROM TENTNME                                      60780000
607900               WHERE ENT_ID       = :DK-ENT-ID                    60790000
608000                 AND TYPE_CDE     = :PC-TYPE-CODE-LONG-NAME       60800000
608100         END-EXEC                                                 60810000
608200                                                                  60820000
608300         EVALUATE TRUE                                            60830000
608400             WHEN SQLCODE = ZERO                                  60840000
608500             WHEN SQLCODE = +100                                  60850000
608600             WHEN SQLCODE = -904                                  60860000
608700             WHEN SQLCODE = -913                                  60870000
608800                  CONTINUE                                        60880000
608900             WHEN SQLWARN0 NOT = SPACE                            60890000
609000             WHEN SQLCODE NOT = ZERO                              60900000
609100                  MOVE '5260-FETCH-VENDOR-LONG-NAME'              60910000
609200                                   TO DP013-PARAGRAPH             60920000
609300                  MOVE 'FETCH VENDOR LONG NAME          '         60930000
609400                                   TO DP013-MESSAGE-TEXT (1)      60940000
609500                  MOVE 'FOR THE FOLLOWING PO:           '         60950000
609600                                   TO DP013-MESSAGE-TEXT (2)      60960000
609700                  MOVE TRBNTF-PO-NBR TO DP013-MESSAGE-TEXT (3)    60970000
609800                  MOVE SQLCA      TO DP013-SQLCA                  60980000
609900                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)     60990000
610000                  SET DP013-DB2-ABEND TO TRUE                     61000000
610100                  PERFORM DP013-0000-PROCESS-ABEND                61010000
610200         END-EVALUATE                                             61020000
610300     END-PERFORM.                                                 61030000
610400                                                                  61040000
610500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        61050000
610600         MOVE '5260-FETCH-VENDOR-LONG-NAME' TO DP013-PARAGRAPH    61060000
610700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     61070000
610800                                   TO DP013-MESSAGE-TEXT (1)      61080000
610900         MOVE SQLCA                TO DP013-SQLCA                 61090000
611000         MOVE 'TENTNME '           TO DP013-DB2-TABLE-NAME (1)    61100000
611100         SET DP013-DB2-ABEND                                      61110000
611200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   61120000
611300         PERFORM DP013-0000-PROCESS-ABEND                         61130000
611400     END-IF.                                                      61140000
611500                                                                  61150000
611600*----------------------------------------------------------------*61160000
611700*    WRITE THE SELECTED PO ITEMS TEMP STORAGE QUEUE.             *61170000
611800*----------------------------------------------------------------*61180000
611900 5265-WRITE-PO-SEL-QUEUE.                                         61190000
612000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO PO012-SELECTED-ITEMS.   61200000
612100                                                                  61210000
612200     EXEC CICS                                                    61220000
612300          WRITEQ TS                                               61230000
612400              QUEUE (ASC-SEL-QUEUE-OUT)                           61240000
612500              FROM  (PO012-PO-SELECT-RECORD)                      61250000
612600              ITEM  (ASC-SEL-ITEM)                                61260000
612700              RESP  (PV-CICS-RESP)                                61270000
612800     END-EXEC.                                                    61280000
612900                                                                  61290000
613000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          61300000
613100         CONTINUE                                                 61310000
613200     ELSE                                                         61320000
613300         SET DP013-CICS-ABEND                                     61330000
613400             DP013-NO-ROLLBACK     TO TRUE                        61340000
613500         MOVE '5265-WRITE-SEL-QUEUE'  TO DP013-PARAGRAPH          61350000
613600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          61360000
613700                                   TO DP013-MESSAGE-TEXT(1)       61370000
613800         PERFORM DP013-0000-PROCESS-ABEND                         61380000
613900     END-IF.                                                      61390000
614000                                                                  61400000
614100*----------------------------------------------------------------*61410000
614200*    CALL THE TROUBLE CENTRAL PROCESSING ROUTINE (TMKCS520) TO   *61420000
614300*    PERFORM EITHER A RESPOND, RESOLVE, OR ACKNOWLEDGE FOR THE   *61430000
614400*    SELECTED NOTIFICATION RECORDS.  THIS PARAGRAPH IS PERFORMED *61440000
614500*    UNTIL ALL NOTIFICATION RECORDS ARE PROCESSED OR AN ERROR    *61450000
614600*    IS ENCOUNTERED.                                             *61460000
614700*----------------------------------------------------------------*61470000
614800 5300-PROCESS-TROUBLE-UPDATE.                                     61480000
614900     PERFORM 6112-READ-LIST-QUEUE.                                61490000
615000                                                                  61500000
615100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       61510000
615200         PERFORM                                                  61520000
615300         VARYING LQW-IDX                                          61530000
615400         FROM 1 BY 1                                              61540000
615500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            61550000
615600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          61560000
615700           OR  PS-ERROR                                           61570000
615800             IF  LQW-SELECT (LQW-IDX)                             61580000
615900                 MOVE LQW-NOTIF-NBR (LQW-IDX)                     61590000
616000                                TO  TM500-NOTIF-NBR               61600000
616100                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   61610000
616200                                TO  TM500-OPER-UNT-ID             61620000
616300                 MOVE LQW-FCLTY-ID (LQW-IDX) TO TM500-FCLTY-ID    61630000
616400                 MOVE LQW-PO-NBR (LQW-IDX) TO TM500-PO-NBR        61640000
616500                                              DK-PO-NBR           61650000
616600                 MOVE LQW-RCVR-SEQ-NBR (LQW-IDX)                  61660000
616700                                TO  TM500-REC-SEQ-NBR             61670000
616800                                    DK-REC-SEQ-NBR                61680000
616900                 MOVE LQW-TROUBLE-REASON-CDE (LQW-IDX)            61690000
617000                                TO  TM500-TRBL-RSN-CDE            61700000
617100                 MOVE LQW-TROUBLE-REASON-LVL (LQW-IDX)            61710000
617200                                TO  TM500-LEVEL-IND               61720000
617300                 MOVE PC-DUMMY-DATE TO TM500-VEND-SHIP-DTE        61730000
617400                                                                  61740000
617500                 IF  TM500-REC-SEQ-NBR = 0                        61750000
617600                     CONTINUE                                     61760000
617700                 ELSE                                             61770000
617800                     PERFORM 5350-FETCH-VEND-SHIP-DTE             61780000
617900                     MOVE SHIPMT-VEND-SHIP-DTE                    61790000
618000                                TO  TM500-VEND-SHIP-DTE           61800000
618100                 END-IF                                           61810000
618200                                                                  61820000
618300                 IF  PS-RESOLVE-REQUEST                           61830000
618400                     PERFORM 5301-RESOLVE-SETUP-EDITS             61840000
618500                 ELSE                                             61850000
618600                     IF TM500-PO-LEVEL                            61860000
618700                       OR TM500-PACK-LEVEL                        61870000
618800                         CONTINUE                                 61880000
618900                     ELSE                                         61890000
619000                         SET TM500-LINE-LEVEL TO TRUE             61900000
619100                     END-IF                                       61910000
619200                 END-IF                                           61920000
619300                                                                  61930000
619400                 IF  PS-NO-ERROR                                  61940000
619500                     PERFORM 5400-PROCESS-TRBL-REQUEST            61950000
619600                 END-IF                                           61960000
619700                                                                  61970000
619800                 IF  PS-NO-ERROR                                  61980000
619900                     IF  TM500-DUPLICATE-TROUBLE                  61990000
620000                         SET LQW-DESELECT (LQW-IDX)               62000000
620100                             LQW-INQUIRE  (LQW-IDX) TO TRUE       62010000
620200                         MOVE PC-TSYMSG-01034 TO DP020-MSG-NUMBER 62020000
620300                         MOVE SPACE                               62030000
620400                                TO  LQW-TEMP-SELECTED-SW (LQW-IDX)62040000
620500                         SUBTRACT 1                               62050000
620600                                FROM ASC-NUMBER-OF-SELECTED-ITEMS 62060000
620700                     ELSE                                         62070000
620800                         SET LQW-DESELECT (LQW-IDX)               62080000
620900                             LQW-UPDATE   (LQW-IDX) TO TRUE       62090000
621000                         MOVE SPACE                               62100000
621100                                TO  LQW-TEMP-SELECTED-SW (LQW-IDX)62110000
621200                         SUBTRACT 1                               62120000
621300                                FROM ASC-NUMBER-OF-SELECTED-ITEMS 62130000
621400                     END-IF                                       62140000
621500                 ELSE                                             62150000
621600                     SET LQW-ERROR (LQW-IDX) TO TRUE              62160000
621700                     EXEC CICS                                    62170000
621800                         SYNCPOINT ROLLBACK                       62180000
621900                     END-EXEC                                     62190000
622000                 END-IF                                           62200000
622100             END-IF                                               62210000
622200         END-PERFORM                                              62220000
622300     END-IF.                                                      62230000
622400                                                                  62240000
622500     MOVE PV-ITEM                TO  PV-SAVE-ITEM.                62250000
622600     PERFORM 6111-WRITE-LIST-QUEUE.                               62260000
622700                                                                  62270000
622800 5301-RESOLVE-SETUP-EDITS.                                        62280000
622900     IF (LQW-TRBL-RESOLVED (LQW-IDX))                             62290000
623000         OR  (PS-DC-CHEK-REQUEST AND LQW-TRBL-RESOLVED (LQW-IDX)) 62300000
623100         MOVE PC-TSYMSG-00938   TO DP020-MSG-NUMBER               62310000
623200         SET PS-ERROR           TO  TRUE                          62320000
623300     END-IF                                                       62330000
623400                                                                  62340000
623500     IF PS-NO-ERROR                                               62350000
623600     EVALUATE TRUE                                                62360000
623700         WHEN (LQW-RESOLVE-TRBL-AUTO (LQW-IDX)) OR                62370000
623800              (LQW-RESOLVE-TRBL-BOTH-AUTO-MAN (LQW-IDX))          62380000
623900              CONTINUE                                            62390000
624000         WHEN LQW-RESOLVE-TRBL-MANUAL (LQW-IDX)                   62400000
624100             MOVE PC-TSYMSG-01031 TO DP020-MSG-NUMBER             62410000
624200             SET PS-ERROR         TO  TRUE                        62420000
624300         WHEN OTHER                                               62430000
624400             IF TM500-TRBL-RSN-CDE = 371                          62440000
624500                MOVE PC-TSYMSG-03248 TO DP020-MSG-NUMBER          62450000
624600             ELSE                                                 62460000
624700                MOVE PC-TSYMSG-01025 TO DP020-MSG-NUMBER          62470000
624800             END-IF                                               62480000
624900             SET PS-ERROR         TO  TRUE                        62490000
625000     END-EVALUATE                                                 62500000
625100     END-IF.                                                      62510000
625200                                                                  62520000
625300     IF PS-NO-ERROR                                               62530000
625400     IF TM500-PO-LEVEL                                            62540000
625500       OR TM500-PACK-LEVEL                                        62550000
625600       OR TM500-LINE-LEVEL                                        62560000
625700         CONTINUE                                                 62570000
625800     ELSE                                                         62580000
625900         MOVE PC-TSYMSG-00986 TO DP020-MSG-NUMBER                 62590000
626000         SET PS-ERROR       TO  TRUE                              62600000
626100     END-IF.                                                      62610000
626200                                                                  62620000
626300*----------------------------------------------------------------*62630000
626400*    RETRIEVE THE VENDOR SHIP DATE ASSOCIATED WITH THE TROUBLE   *62640000
626500*    NOTIFICATION RECORD.                                        *62650000
626600*----------------------------------------------------------------*62660000
626700 5350-FETCH-VEND-SHIP-DTE.                                        62670000
626800     INITIALIZE DCLTSHIPMT.                                       62680000
626900                                                                  62690000
627000     PERFORM                                                      62700000
627100         WITH TEST AFTER                                          62710000
627200         VARYING PV-RETRY-COUNTER                                 62720000
627300         FROM 1 BY 1                                              62730000
627400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               62740000
627500                   OR (SQLCODE = ZERO OR +100))                   62750000
627600                                                                  62760000
627700         EXEC SQL                                                 62770000
627800              SELECT VEND_SHIP_DTE                                62780000
627900                INTO :SHIPMT-VEND-SHIP-DTE                        62790000
628000                FROM TSHPTPO A                                    62800000
628100                    , TSHIPMT B                                   62810000
628200               WHERE A.PO_NBR         = :DK-PO-NBR                62820000
628300                 AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR           62830000
628400                 AND A.SHIPT_ID       = B.SHIPT_ID                62840000
628500                 AND A.PRIM_SHIPT_IND = :PC-Y                     62850000
628600         END-EXEC                                                 62860000
628700                                                                  62870000
628800         EVALUATE TRUE                                            62880000
628900             WHEN SQLCODE = ZERO                                  62890000
629000             WHEN SQLCODE = -904                                  62900000
629100             WHEN SQLCODE = -913                                  62910000
629200                  CONTINUE                                        62920000
629300             WHEN SQLCODE = +100                                  62930000
629400                  MOVE PC-DUMMY-DATE TO SHIPMT-VEND-SHIP-DTE      62940000
629500             WHEN SQLWARN0 NOT = SPACE                            62950000
629600             WHEN SQLCODE NOT = ZERO                              62960000
629700                  MOVE '5350-FETCH-VEND-SHIP-DTE'                 62970000
629800                                   TO DP013-PARAGRAPH             62980000
629900                  MOVE 'FETCH VENDOR SHIP DATE'                   62990000
630000                                   TO DP013-MESSAGE-TEXT (1)      63000000
630100                  MOVE 'FOR THE FOLLOWING PO-RCVR SEQ:  '         63010000
630200                                   TO DP013-MESSAGE-TEXT (2)      63020000
630300                  MOVE DK-PO-NBR TO PV-ERROR-PO-NBR               63030000
630400                  MOVE DK-REC-SEQ-NBR TO PV-ERROR-REC-SEQ-NBR     63040000
630500                  STRING PV-ERROR-PO-NBR      DELIMITED BY SIZE   63050000
630600                         '-'                  DELIMITED BY SIZE   63060000
630700                         PV-ERROR-REC-SEQ-NBR DELIMITED BY SIZE   63070000
630800                                 INTO DP013-MESSAGE-TEXT (3)      63080000
630900                  MOVE SQLCA   TO DP013-SQLCA                     63090000
631000                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     63100000
631100                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (2)     63110000
631200                  SET DP013-DB2-ABEND TO TRUE                     63120000
631300                  PERFORM DP013-0000-PROCESS-ABEND                63130000
631400         END-EVALUATE                                             63140000
631500     END-PERFORM.                                                 63150000
631600                                                                  63160000
631700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        63170000
631800         MOVE '5350-FETCH-VEND-SHIP-DTE' TO DP013-PARAGRAPH       63180000
631900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     63190000
632000                                   TO DP013-MESSAGE-TEXT (1)      63200000
632100         MOVE SQLCA                TO DP013-SQLCA                 63210000
632200              MOVE 'TSHPTPO '  TO DP013-DB2-TABLE-NAME (1)        63220000
632300              MOVE 'TSHIPMT '  TO DP013-DB2-TABLE-NAME (2)        63230000
632400         SET DP013-DB2-ABEND                                      63240000
632500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   63250000
632600         PERFORM DP013-0000-PROCESS-ABEND                         63260000
632700     END-IF.                                                      63270000
632800                                                                  63280000
632900******************************************************************63290000
633000** CALL THE TROUBLE ROUTINE TO PROCESS THE TROUBLE NOTIFICATION **63300000
633100** RECORD.                                                      **63310000
633200******************************************************************63320000
633300 5400-PROCESS-TRBL-REQUEST.                                       63330000
633400     MOVE LENGTH OF TM500-FIELDS      TO PV-COMMAREA-LENGTH       63340000
633500     SET TM500-FROM-LIST-SCREEN       TO TRUE.                    63350000
633600                                                                  63360000
633700     EXEC CICS                                                    63370000
633800          LINK PROGRAM  (PC-TMKCS520)                             63380000
633900               COMMAREA (TM500-FIELDS)                            63390000
634000               LENGTH   (PV-COMMAREA-LENGTH)                      63400000
634100               RESP     (PV-CICS-RESP)                            63410000
634200     END-EXEC.                                                    63420000
634300                                                                  63430000
634400     EVALUATE TRUE                                                63440000
634500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     63450000
634600              CONTINUE                                            63460000
634700         WHEN OTHER                                               63470000
634800              MOVE '5400-PROCESS-TRBL-REQUEST' TO DP013-PARAGRAPH 63480000
634900                                                                  63490000
635000              MOVE 'CANNOT LINK TO TMKCS520'                      63500000
635100                                         TO DP013-MESSAGE-TEXT (1)63510000
635200              SET DP013-CICS-ABEND       TO TRUE                  63520000
635300              SET DP013-NO-ROLLBACK      TO TRUE                  63530000
635400              SET PS-ERROR               TO TRUE                  63540000
635500              PERFORM DP013-0000-PROCESS-ABEND                    63550000
635600     END-EVALUATE.                                                63560000
635700                                                                  63570000
635800     EVALUATE TRUE                                                63580000
635900         WHEN TM500-CALL-SUCCESSFUL                               63590000
636000         WHEN TM500-DUPLICATE-TROUBLE                             63600000
636100         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        63610000
636200         WHEN TM500-TPURCHS-SELECT-NOT-FND                        63620000
636300         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       63630000
636400              CONTINUE                                            63640000
636500         WHEN TM500-RECORD-IN-PROCESS                             63650000
636600              MOVE PC-TSYMSG-01032 TO DP020-MSG-NUMBER            63660000
636700              SET PS-ERROR      TO  TRUE                          63670000
636800         WHEN TM500-RECORD-RESOLVED                               63680000
636900              MOVE PC-TSYMSG-01033 TO DP020-MSG-NUMBER            63690000
637000              SET PS-ERROR      TO  TRUE                          63700000
637100         WHEN TM500-RECORD-ACKNOWLEDGED                           63710000
637200************* MOVE PC-TSYMSG-01036 TO DP020-MSG-NUMBER            63720000
637300              MOVE PC-TSYMSG-01839 TO DP020-MSG-NUMBER            63730000
637400              SET PS-ERROR      TO  TRUE                          63740000
637500         WHEN TM500-RECORD-NOT-RESOLVED                           63750000
637600              MOVE PC-TSYMSG-01037 TO DP020-MSG-NUMBER            63760000
637700              SET PS-ERROR      TO  TRUE                          63770000
637800         WHEN TM500-IN-PROC-UPDATE-NOT-FND                        63780000
637900              MOVE PC-TSYMSG-00938 TO DP020-MSG-NUMBER            63790000
638000              SET PS-ERROR      TO  TRUE                          63800000
638100         WHEN TM500-RESPOND-UPDATE-NOT-FND                        63810000
638200              MOVE PC-TSYMSG-01038 TO DP020-MSG-NUMBER            63820000
638300              SET PS-ERROR      TO  TRUE                          63830000
638400         WHEN TM500-ACKNWLG-UPDATE-NOT-FND                        63840000
638500              MOVE PC-TSYMSG-01038 TO DP020-MSG-NUMBER            63850000
638600              SET PS-ERROR      TO  TRUE                          63860000
638700         WHEN OTHER                                               63870000
638800              STRING 'NNNNN-E-'             DELIMITED BY SIZE     63880000
638900                     TM500-RETURN-MSG       DELIMITED BY SIZE     63890000
639000                     '-'                    DELIMITED BY SIZE     63900000
639100                     TM500-RETURN-CODE      DELIMITED BY SIZE     63910000
639200                     ' SQLCODE='            DELIMITED BY SIZE     63920000
639300                     TM500-SQLCODE          DELIMITED BY SIZE     63930000
639400                              INTO  DP020-MSG-MESSAGE             63940000
639500              SET PS-ERROR      TO  TRUE                          63950000
639600     END-EVALUATE.                                                63960000
639700                                                                  63970000
639800     MOVE LQW-TROUBLE-REASON-CDE (LQW-IDX)                        63980000
639900                                TO DK-TRBL-RSN-CDE.               63990000
640000                                                                  64000000
640100     PERFORM 5410-CHECK-AUTO-ACK-IND.                             64010000
640200                                                                  64020000
640300                                                                  64030000
640400                                                                  64040000
640500******************************************************************64050000
640600** WHEN RESOLVING, CHECK THE AUTO ACKNOWLEDGE INDICATOR FIRST     64060000
640700******************************************************************64070000
640800 5410-CHECK-AUTO-ACK-IND.                                         64080000
640900                                                                  64090000
641000     EXEC SQL                                                     64100000
641100         SELECT AUTOACKNL_IND                                     64110000
641200         INTO   :TRBRSN-AUTOACKNL-IND                             64120000
641300         FROM    TTRBRSN                                          64130000
641400         WHERE   TRBL_RSN_CDE       =  :DK-TRBL-RSN-CDE           64140000
641500     END-EXEC.                                                    64150000
641600                                                                  64160000
641700     EVALUATE TRUE                                                64170000
641800         WHEN SQLCODE = ZERO                                      64180000
641900              IF TRBRSN-AUTOACKNL-IND = 'Y'                       64190000
642000                 SET PS-AUTO-AUTOACKNL-IND-YES                    64200000
642100                                   TO TRUE                        64210000
642200                 PERFORM 5500-CMPLT-AUTO-ACK                      64220000
642300              ELSE                                                64230000
642400                 CONTINUE                                         64240000
642500              END-IF                                              64250000
642600         WHEN SQLCODE = +100                                      64260000
642700              CONTINUE                                            64270000
642800         WHEN SQLWARN0 NOT = SPACES                               64280000
642900         WHEN SQLCODE NOT EQUAL ZERO                              64290000
643000              MOVE '5410-CHECK-AUTO-ACK-IND'                      64300000
643100                                   TO DP013-PARAGRAPH             64310000
643200              MOVE 'SELECT THE TROUBLE REASON AUTO ACK IND'       64320000
643300                                   TO DP013-MESSAGE-TEXT (1)      64330000
643400              MOVE SQLCA           TO DP013-SQLCA                 64340000
643500              MOVE 'TTRBRSN'       TO DP013-DB2-TABLE-NAME (1)    64350000
643600              SET DP013-DB2-ABEND                                 64360000
643700                  DP013-XCTL-DISPLAY-RESTART                      64370000
643800                                   TO TRUE                        64380000
643900              PERFORM DP013-0000-PROCESS-ABEND                    64390000
644000     END-EVALUATE.                                                64400000
644100                                                                  64410000
644200*----------------------------------------------------------------*64420000
644300*    MANUAL ACKNOWLEDGE WAS DONE, SO WE WANT TO COMPLETE THE      64430000
644400*    ROW IN RCT_AUTOACKNL_TRBL FOR THE NOTIFICATION NUMBER        64440000
644500*    THAT WAS PUT IN THERE SO THAT IT DOESN'T GO THROUGH THE      64450000
644600*    BATCH PROCESS OF MANUALLY ACKNOWLEDGING AND RE-DISTRO'ING    64460000
644700*    WE HAVE TO ASSUME THAT THEY ARE GOING TO BE MANUALLY         64470000
644800*    RE-DISTRO'ING.                                               64480000
644900*----------------------------------------------------------------*64490000
645000 5500-CMPLT-AUTO-ACK.                                             64500000
645100                                                                  64510000
645200     MOVE DK-PO-NBR                  TO TM007-PO-NBR.             64520000
645300     MOVE DK-REC-SEQ-NBR             TO TM007-REC-SEQ-NBR.        64530000
645400     MOVE DK-OPER-UNT-ID             TO TM007-OPER-UNT-ID.        64540000
645500     MOVE DK-TRBL-RSN-CDE            TO TM007-TRBL-RSN-CDE.       64550000
645600     MOVE TM500-NOTIF-NBR            TO TM007-NOTIF-NBR.          64560000
645700                                                                  64570000
645800     SET TM007-UPDATE                                             64580000
645900         TM007-CMPLT-STATUS          TO TRUE.                     64590000
646000                                                                  64600000
646100     CALL PC-TMKUP501-RTN USING  DFHEIBLK                         64610000
646200                               TM007-COMMAREA                     64620000
646300                               TM007-COMMUNICATIONS-AREA          64630000
646400                                                                  64640000
646500     IF TM007-CALL-SUCCESSFUL OR                                  64650000
646600        TM007-SQLCODE = +100                                      64660000
646700        CONTINUE                                                  64670000
646800     ELSE                                                         64680000
646900        move TM007-SQLCODE          to tm500-sqlcode              64690000
647000        STRING 'NNNNN-E-'             DELIMITED BY SIZE           64700000
647100                TM007-RETURN-MSG       DELIMITED BY SIZE          64710000
647200                '-'                    DELIMITED BY SIZE          64720000
647300                TM007-RETURN-CODE      DELIMITED BY SIZE          64730000
647400                ' SQLCODE='            DELIMITED BY SIZE          64740000
647500                TM500-SQLCODE          DELIMITED BY SIZE          64750000
647600                                  INTO  DP020-MSG-MESSAGE         64760000
647700         SET PS-ERROR               TO  TRUE                      64770000
647800     END-IF.                                                      64780000
647900                                                                  64790000
648000*CLP 09/03/13 BEGIN                                               64800000
648100*  FOR POCTNLST (F19)                                             64810000
648200*----------------------------------------------------------------*64820000
648300 5600-FILL-SEL-QUEUE-RECORD.                                      64830000
648400*----------------------------------------------------------------*64840000
648500     PERFORM 6112-READ-LIST-QUEUE.                                64850000
648600                                                                  64860000
648700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        64870000
648800         PERFORM                                                  64880000
648900           VARYING LQW-IDX FROM 1 BY 1                            64890000
649000             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   64900000
649100                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          64910000
649200                                                                  64920000
649300             IF LQW-SELECT (LQW-IDX)                              64930000
649400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              64940000
649500                            TO SU010-ITEM (SU010-IDX)             64950000
649600                 MOVE LQW-PO-NBR (LQW-IDX)                        64960000
649700                                        TO PV-PO-NBR-P            64970000
649800                 MOVE LQW-RCVR-SEQ-NBR   (LQW-IDX)                64980000
649900                                        TO PV-RECEIVER-P          64990000
650000                 MOVE PV-PO-RECEIVER-P TO SU010-PO-RCVR(SU010-IDX)65000000
650100                                                                  65010000
650200                 MOVE ASC-KEY-OPER-UNT-ID                         65020000
650300                            TO SU010-OPER-UNIT-ID (SU010-IDX)     65030000
650400                                                                  65040000
650500                 SET SU010-IDX UP BY 1                            65050000
650600                 IF SU010-IDX > SU010-MAX-ITEMS                   65060000
650700                     PERFORM 5206-WRITE-SEL-QUEUE                 65070000
650800                     ADD +1  TO SU009-NUMBER-OF-TS-ITEMS          65080000
650900                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         65090000
651000                     SET SU010-IDX TO 1                           65100000
651100                 END-IF                                           65110000
651200             END-IF                                               65120000
651300         END-PERFORM                                              65130000
651400     END-IF.                                                      65140000
651500*CLP 09/03/13 END                                                 65150000
651600                                                                  65160000
651700******************************************************************65170000
651800** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **65180000
651900** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **65190000
652000** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **65200000
652100** THE USER.                                                    **65210000
652200******************************************************************65220000
652300 6000-REFRESH-PANEL-FROM-TEMP.                                    65230000
652400     IF  ASC-UPDATE-TSQ                                           65240000
652500         SET ASC-NO-TSQ-UPDATE TO TRUE                            65250000
652600         MOVE ZERO                 TO PV-SAVE-ITEM                65260000
652700                                      ASC-SEL-ITEM                65270000
652800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        65280000
652900                                   TO PV-HOLD-SELECTED-ITEMS      65290000
653000         MOVE +1                   TO PV-ITEMS-PROCESSED          65300000
653100         IF ASC-RCVRMNT                                           65310000
653200           PERFORM 6100-UPDATE-TSQ-R                              65320002
653300              UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS   65330002
653400         ELSE                                                     65340000
653500           IF ASC-UNITADJ                                         65350002
653600             PERFORM 6100-UPDATE-TSQ-U                            65360002
653700             UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS    65370002
653800           ELSE                                                   65380002
653900*CLP 09/03/13 BEGIN                                               65390000
654000              IF ASC-POCTNLST                                     65400002
654100                PERFORM 6100-UPDATE-TSQ-P                         65410002
654200                UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS 65420002
654210              ELSE                                                65421002
654211*CLP 09/03/13 END                                                 65421102
654212*CLP 09/09/13 - DROPPED THESE 2 LINES AND RE-INSERTED FOR F24     65421205
654220                PERFORM 6100-UPDATE-TSQ                           65422002
654230                UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS 65423002
654240              END-IF                                              65424002
654500           END-IF                                                 65450002
654600         END-IF                                                   65460000
654700         PERFORM 6010-DELETE-SEL-QUEUE                            65470000
654800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         65480000
654900                    ASC-BLOCK-ENTRIES (2)                         65490000
655000                                                                  65500000
655100         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 65510000
655200                GIVING PV-BLOCK-NUMBER                            65520000
655300                REMAINDER PV-REMAINDER                            65530000
655400                                                                  65540000
655500         IF  PV-REMAINDER > ZERO                                  65550000
655600             ADD +1                TO PV-BLOCK-NUMBER             65560000
655700         END-IF                                                   65570000
655800                                                                  65580000
655900         MOVE +1                   TO ASC-BLK-SUB                 65590000
656000         PERFORM 4410-READ-TEMP-STORAGE                           65600000
656100         ADD +1                    TO ASC-BLK-SUB                 65610000
656200                                      PV-BLOCK-NUMBER             65620000
656300         PERFORM 4410-READ-TEMP-STORAGE                           65630000
656400     ELSE                                                         65640000
656500         IF ASC-UPDATE-TSQ2                                       65650000
656600            SET ASC-NO-TSQ-UPDATE TO TRUE                         65660000
656700            PERFORM 2050-DELETE-LIST-QUEUE                        65670000
656800            PERFORM 4000-BUILD-INITIAL-PANEL                      65680000
656900         END-IF                                                   65690000
657000     END-IF.                                                      65700000
657100                                                                  65710000
657200*----------------------------------------------------------------*65720000
657300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *65730000
657400*----------------------------------------------------------------*65740000
657500 6010-DELETE-SEL-QUEUE.                                           65750000
657600     EXEC CICS                                                    65760000
657700         DELETEQ TS                                               65770000
657800             QUEUE (ASC-SEL-QUEUE-OUT)                            65780000
657900             RESP  (PV-CICS-RESP)                                 65790000
658000     END-EXEC.                                                    65800000
658100                                                                  65810000
658200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      65820000
658300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         65830000
658400         CONTINUE                                                 65840000
658500     ELSE                                                         65850000
658600         SET DP013-CICS-ABEND TO TRUE                             65860000
658700         SET DP013-NO-ROLLBACK TO TRUE                            65870000
658800         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          65880000
658900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         65890000
659000                        TO DP013-MESSAGE-TEXT (1)                 65900000
659100         PERFORM DP013-0000-PROCESS-ABEND                         65910000
659200     END-IF.                                                      65920000
659300                                                                  65930000
659400*----------------------------------------------------------------*65940000
659500*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *65950000
659600*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *65960000
659700*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *65970000
659800*    THE TEMP QUEUE.                                             *65980000
659900*----------------------------------------------------------------*65990000
660000 6100-UPDATE-TSQ.                                                 66000000
660100     ADD 1                     TO  ASC-SEL-ITEM.                  66010000
660200     PERFORM 6105-READ-SEL-QUEUE.                                 66020000
660300     PERFORM                                                      66030000
660400         VARYING TM002-IDX                                        66040000
660500         FROM 1 BY 1                                              66050000
660600         UNTIL ((PV-ITEMS-PROCESSED >                             66060000
660700                              PV-HOLD-SELECTED-ITEMS)             66070000
660800         OR (TM002-IDX GREATER THAN TM002-MAX-ITEMS))             66080000
660900         IF  TM002-ACTION-SW (TM002-IDX) > SPACE                  66090000
661000             PERFORM 6110-PROCESS-ITEMS                           66100000
661100         END-IF                                                   66110000
661200         ADD +1                TO PV-ITEMS-PROCESSED              66120000
661300     END-PERFORM.                                                 66130000
661400     PERFORM 6111-WRITE-LIST-QUEUE.                               66140000
661500                                                                  66150000
661600*----------------------------------------------------------------*66160000
661700*    6100-UPDATE-TSQ-R USED BY RCVRMNT FUNCTION                  *66170000
661800*                                                                *66180000
661900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *66190000
662000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *66200000
662100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *66210000
662200*    THE TEMP QUEUE.                                             *66220000
662300*----------------------------------------------------------------*66230000
662400 6100-UPDATE-TSQ-R.                                               66240000
662500     ADD 1                    TO PV-SEL-QUEUE-ITEM.               66250000
662600     PERFORM 6105-READ-SEL-QUEUE-R.                               66260000
662700                                                                  66270000
662800     PERFORM                                                      66280000
662900         VARYING RC013-IDX                                        66290000
663000         FROM 1 BY 1                                              66300000
663100         UNTIL ((PV-ITEMS-PROCESSED >                             66310000
663200                              PV-HOLD-SELECTED-ITEMS)             66320000
663300         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             66330000
663400         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  66340000
663500             PERFORM 6110-PROCESS-ITEMS-R                         66350000
663600         END-IF                                                   66360000
663700         ADD +1               TO PV-ITEMS-PROCESSED               66370000
663800     END-PERFORM.                                                 66380000
663900                                                                  66390000
664000     PERFORM 6111-WRITE-LIST-QUEUE.                               66400000
664100                                                                  66410000
664200*----------------------------------------------------------------*66420000
664300*    6100-UPDATE-TSQ-U USED BY UNITADJ FUNCTION                  *66430000
664400*                                                                *66440000
664500*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *66450000
664600*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *66460000
664700*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *66470000
664800*    THE TEMP QUEUE.                                             *66480000
664900*----------------------------------------------------------------*66490000
665000 6100-UPDATE-TSQ-U.                                               66500000
665100     ADD 1                    TO PV-SEL-QUEUE-ITEM.               66510000
665200     PERFORM 6105-READ-SEL-QUEUE-U.                               66520000
665300                                                                  66530000
665400     PERFORM                                                      66540000
665500         VARYING SU039-IDX                                        66550000
665600         FROM 1 BY 1                                              66560000
665700         UNTIL ((PV-ITEMS-PROCESSED >                             66570000
665800                              PV-HOLD-SELECTED-ITEMS)             66580000
665900         OR (SU039-IDX GREATER THAN SU039-MAX-ITEMS))             66590000
666000         IF  SU039-ACTION-SW (SU039-IDX) > SPACE                  66600000
666100             PERFORM 6110-PROCESS-ITEMS-U                         66610000
666200         END-IF                                                   66620000
666300         ADD +1               TO PV-ITEMS-PROCESSED               66630000
666400     END-PERFORM.                                                 66640000
666500                                                                  66650000
666600     PERFORM 6111-WRITE-LIST-QUEUE.                               66660000
666700                                                                  66670000
666800*CLP 09/03/13 BEGIN                                               66680000
666900*----------------------------------------------------------------*66690000
667000*    6100-UPDATE-TSQ-P USED BY POCTNLST FUNCTION                 *66700000
667100*                                                                *66710000
667200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *66720000
667300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *66730000
667400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *66740000
667500*    THE TEMP QUEUE.                                             *66750000
667600*----------------------------------------------------------------*66760000
667700 6100-UPDATE-TSQ-P.                                               66770000
667800     ADD 1                     TO  ASC-SEL-ITEM.                  66780000
667900     PERFORM 6105-READ-SEL-QUEUE-P.                               66790000
668000     PERFORM                                                      66800000
668100         VARYING SU010-IDX                                        66810000
668200         FROM 1 BY 1                                              66820000
668300         UNTIL ((PV-ITEMS-PROCESSED >                             66830000
668400                              PV-HOLD-SELECTED-ITEMS)             66840000
668500         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             66850000
668600         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  66860000
668700             PERFORM 6110-PROCESS-ITEMS-P                         66870000
668800         END-IF                                                   66880000
668900         ADD +1                TO PV-ITEMS-PROCESSED              66890000
669000     END-PERFORM.                                                 66900000
669100     PERFORM 6111-WRITE-LIST-QUEUE.                               66910000
669200                                                                  66920000
669300*CLP 09/03/13 END                                                 66930000
669400*----------------------------------------------------------------*66940000
669500*    READ THE LIST QUEUE RECORD.                                 *66950000
669600*----------------------------------------------------------------*66960000
669700 6105-READ-SEL-QUEUE.                                             66970000
669800     EXEC CICS                                                    66980000
669900          READQ TS                                                66990000
670000              QUEUE (ASC-SEL-QUEUE-OUT)                           67000000
670100              INTO  (TM002-MESSAGE-SEL-REC)                       67010000
670200              ITEM  (ASC-SEL-ITEM)                                67020000
670300              RESP  (PV-CICS-RESP)                                67030000
670400     END-EXEC.                                                    67040000
670500                                                                  67050000
670600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          67060000
670700         CONTINUE                                                 67070000
670800     ELSE                                                         67080000
670900         SET DP013-CICS-ABEND      TO  TRUE                       67090000
671000         SET DP013-NO-ROLLBACK     TO  TRUE                       67100000
671100         MOVE '6105-READ-SEL-QUEUE' TO DP013-PARAGRAPH            67110000
671200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           67120000
671300                                   TO  DP013-MESSAGE-TEXT(1)      67130000
671400         PERFORM DP013-0000-PROCESS-ABEND                         67140000
671500     END-IF.                                                      67150000
671600                                                                  67160000
671700*----------------------------------------------------------------*67170000
671800*    6105-READ-SEL-QUEUE-R USED BY RCVRMNT FUNCTION              *67180000
671900*    READ THE LIST QUEUE RECORD.                                 *67190000
672000*----------------------------------------------------------------*67200000
672100 6105-READ-SEL-QUEUE-R.                                           67210000
672200     EXEC CICS                                                    67220000
672300          READQ TS                                                67230000
672400              QUEUE (ASC-SEL-QUEUE-OUT)                           67240000
672500              INTO  (RC013-DC-SELECT-RECORD)                      67250000
672600              ITEM  (PV-SEL-QUEUE-ITEM)                           67260000
672700              RESP  (PV-CICS-RESP)                                67270000
672800     END-EXEC.                                                    67280000
672900                                                                  67290000
673000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          67300000
673100         CONTINUE                                                 67310000
673200     ELSE                                                         67320000
673300         SET DP013-CICS-ABEND      TO TRUE                        67330000
673400         SET DP013-NO-ROLLBACK     TO TRUE                        67340000
673500         MOVE '6105-READ-SEL-QUEUE-R'                             67350000
673600                                   TO DP013-PARAGRAPH             67360000
673700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           67370000
673800                                   TO DP013-MESSAGE-TEXT(1)       67380000
673900         PERFORM DP013-0000-PROCESS-ABEND                         67390000
674000     END-IF.                                                      67400000
674100                                                                  67410000
674200*----------------------------------------------------------------*67420000
674300*    6105-READ-SEL-QUEUE-U USED BY UNITADJ FUNCTION              *67430000
674400*    READ THE LIST QUEUE RECORD.                                 *67440000
674500*----------------------------------------------------------------*67450000
674600 6105-READ-SEL-QUEUE-U.                                           67460000
674700     EXEC CICS                                                    67470000
674800          READQ TS                                                67480000
674900              QUEUE (ASC-SEL-QUEUE-OUT)                           67490000
675000              INTO  (SU039-SELECT-RECORD)                         67500000
675100              ITEM  (PV-SEL-QUEUE-ITEM)                           67510000
675200              RESP  (PV-CICS-RESP)                                67520000
675300     END-EXEC.                                                    67530000
675400                                                                  67540000
675500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          67550000
675600         CONTINUE                                                 67560000
675700     ELSE                                                         67570000
675800         SET DP013-CICS-ABEND      TO TRUE                        67580000
675900         SET DP013-NO-ROLLBACK     TO TRUE                        67590000
676000         MOVE '6105-READ-SEL-QUEUE-U'                             67600000
676100                                   TO DP013-PARAGRAPH             67610000
676200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           67620000
676300                                   TO DP013-MESSAGE-TEXT(1)       67630000
676400         PERFORM DP013-0000-PROCESS-ABEND                         67640000
676500     END-IF.                                                      67650000
676600                                                                  67660000
676700*CLP 09/03/13 BEGIN                                               67670000
676800*----------------------------------------------------------------*67680000
676900*    6105-READ-SEL-QUEUE-P USED BY POCTNLST FUNCTION             *67690000
677000*    READ THE LIST QUEUE RECORD.                                 *67700000
677100*----------------------------------------------------------------*67710000
677200 6105-READ-SEL-QUEUE-P.                                           67720000
677300     EXEC CICS                                                    67730000
677400          READQ TS                                                67740000
677500              QUEUE (ASC-SEL-QUEUE-OUT)                           67750000
677600              INTO  (SU010-SELECT-RECORD)                         67760000
677700              ITEM  (ASC-SEL-ITEM)                                67770000
677800              RESP  (PV-CICS-RESP)                                67780000
677900     END-EXEC.                                                    67790000
678000                                                                  67800000
678100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          67810000
678200         CONTINUE                                                 67820000
678300     ELSE                                                         67830000
678400         SET DP013-CICS-ABEND      TO TRUE                        67840000
678500         SET DP013-NO-ROLLBACK     TO TRUE                        67850000
678600         MOVE '6105-READ-SEL-QUEUE-P'                             67860000
678700                                   TO DP013-PARAGRAPH             67870000
678800         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           67880000
678900                                   TO DP013-MESSAGE-TEXT(1)       67890000
679000         PERFORM DP013-0000-PROCESS-ABEND                         67900000
679100     END-IF.                                                      67910000
679200*CLP 09/03/13 END                                                 67920000
679300*----------------------------------------------------------------*67930000
679400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*67940000
679500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*67950000
679600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *67960000
679700*----------------------------------------------------------------*67970000
679800 6110-PROCESS-ITEMS.                                              67980000
679900     COMPUTE PV-ITEM-COMP3 = 1 + ((TM002-ITEM (TM002-IDX) - 1)    67990000
680000                     / PC-ITEMS-PER-PANEL-COMP3).                 68000000
680100     MOVE PV-ITEM-COMP3 TO PV-ITEM.                               68010000
680200                                                                  68020000
680300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           68030000
680400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          68040000
680500             PERFORM 6111-WRITE-LIST-QUEUE                        68050000
680600         END-IF                                                   68060000
680700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    68070000
680800                                                                  68080000
680900         PERFORM 6112-READ-LIST-QUEUE                             68090000
681000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               68100000
681100             CONTINUE                                             68110000
681200         END-IF                                                   68120000
681300     END-IF.                                                      68130000
681400                                                                  68140000
681500     COMPUTE PV-SUB-COMP3 = (TM002-ITEM (TM002-IDX)               68150000
681600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              68160000
681700     MOVE PV-SUB-COMP3 TO PV-SUB.                                 68170000
681800     SET LQW-DESELECT (PV-SUB) TO    TRUE                         68180000
681900     MOVE LQW-SELECTED-SW (PV-SUB)                                68190000
682000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  68200000
682100     EVALUATE TRUE                                                68210000
682200         WHEN TM002-INQ (TM002-IDX)                               68220000
682300              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             68230000
682400         WHEN TM002-UPD (TM002-IDX)                               68240000
682500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             68250000
682600         WHEN TM002-DEL (TM002-IDX)                               68260000
682700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             68270000
682800         WHEN TM002-ERR (TM002-IDX)                               68280000
682900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             68290000
683000     END-EVALUATE.                                                68300000
683100                                                                  68310000
683200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                68320000
683300                                                                  68330000
683400*----------------------------------------------------------------*68340000
683500*    6110-PROCESS-ITEMS-R USED BY RCVRMNT FUNCTION               *68350000
683600*                                                                *68360000
683700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*68370000
683800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*68380000
683900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *68390000
684000*----------------------------------------------------------------*68400000
684100 6110-PROCESS-ITEMS-R.                                            68410000
684200     COMPUTE PV-ITEM-COMP3 = 1 + ((RC013-ITEM (RC013-IDX) - 1)    68420000
684300                     / PC-ITEMS-PER-PANEL).                       68430000
684400     MOVE PV-ITEM-COMP3 TO PV-ITEM.                               68440000
684500                                                                  68450000
684600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           68460000
684700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          68470000
684800             PERFORM 6111-WRITE-LIST-QUEUE                        68480000
684900         END-IF                                                   68490000
685000         MOVE PV-ITEM              TO PV-SAVE-ITEM                68500000
685100                                                                  68510000
685200         PERFORM 6112-READ-LIST-QUEUE                             68520000
685300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               68530000
685400             CONTINUE                                             68540000
685500         END-IF                                                   68550000
685600     END-IF.                                                      68560000
685700                                                                  68570000
685800     COMPUTE PV-SUB-COMP3 = (RC013-ITEM (RC013-IDX)               68580000
685900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              68590000
686000     MOVE PV-SUB-COMP3 TO PV-SUB.                                 68600000
686100                                                                  68610000
686200     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       68620000
686300     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        68630000
686400                                     (PV-SUB).                    68640000
686500     EVALUATE TRUE                                                68650000
686600         WHEN RC013-INQ (RC013-IDX)                               68660000
686700              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         68670000
686800                                                                  68680000
686900         WHEN RC013-UPD (RC013-IDX)                               68690000
687000              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         68700000
687100                                                                  68710000
687200         WHEN RC013-DEL (RC013-IDX)                               68720000
687300              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         68730000
687400                                                                  68740000
687500         WHEN RC013-ERR (RC013-IDX)                               68750000
687600              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         68760000
687700     END-EVALUATE.                                                68770000
687800                                                                  68780000
687900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                68790000
688000                                                                  68800000
688100*----------------------------------------------------------------*68810000
688200*    6110-PROCESS-ITEMS-U USED BY UNITADJ FUNCTION               *68820000
688300*                                                                *68830000
688400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*68840000
688500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*68850000
688600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *68860000
688700*----------------------------------------------------------------*68870000
688800 6110-PROCESS-ITEMS-U.                                            68880000
688900     COMPUTE PV-ITEM-COMP3 = 1 + ((SU039-ITEM (SU039-IDX) - 1)    68890000
689000                     / PC-ITEMS-PER-PANEL).                       68900000
689100     MOVE PV-ITEM-COMP3 TO PV-ITEM.                               68910000
689200                                                                  68920000
689300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           68930000
689400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          68940000
689500             PERFORM 6111-WRITE-LIST-QUEUE                        68950000
689600         END-IF                                                   68960000
689700         MOVE PV-ITEM              TO PV-SAVE-ITEM                68970000
689800                                                                  68980000
689900         PERFORM 6112-READ-LIST-QUEUE                             68990000
690000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               69000000
690100             CONTINUE                                             69010000
690200         END-IF                                                   69020000
690300     END-IF.                                                      69030000
690400                                                                  69040000
690500     COMPUTE PV-SUB-COMP3 = (SU039-ITEM (SU039-IDX)               69050000
690600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              69060000
690700     MOVE PV-SUB-COMP3 TO PV-SUB.                                 69070000
690800                                                                  69080000
690900     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       69090000
691000     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        69100000
691100                                     (PV-SUB).                    69110000
691200     EVALUATE TRUE                                                69120000
691300         WHEN SU039-INQ (SU039-IDX)                               69130000
691400              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         69140000
691500                                                                  69150000
691600         WHEN SU039-UPD (SU039-IDX)                               69160000
691700              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         69170000
691800                                                                  69180000
691900         WHEN SU039-DEL (SU039-IDX)                               69190000
692000              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         69200000
692100                                                                  69210000
692200         WHEN SU039-ERR (SU039-IDX)                               69220000
692300              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         69230000
692400     END-EVALUATE.                                                69240000
692500                                                                  69250000
692600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                69260000
692700                                                                  69270000
692800*CLP 09/03/13 BEGIN                                               69280000
692900*----------------------------------------------------------------*69290000
693000*    6110-PROCESS-ITEMS-P USED BY POCTNLST FUNCTION              *69300000
693100*                                                                *69310000
693200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*69320000
693300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*69330000
693400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *69340000
693500*----------------------------------------------------------------*69350000
693600 6110-PROCESS-ITEMS-P.                                            69360000
693700     COMPUTE PV-ITEM-COMP3 = 1 + ((SU010-ITEM (SU010-IDX) - 1)    69370000
693800                     / PC-ITEMS-PER-PANEL).                       69380000
693900     MOVE PV-ITEM-COMP3 TO PV-ITEM.                               69390000
694000                                                                  69400000
694100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           69410000
694200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          69420000
694300             PERFORM 6111-WRITE-LIST-QUEUE                        69430000
694400         END-IF                                                   69440000
694500         MOVE PV-ITEM              TO PV-SAVE-ITEM                69450000
694600                                                                  69460000
694700         PERFORM 6112-READ-LIST-QUEUE                             69470000
694800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               69480000
694900             CONTINUE                                             69490000
695000         END-IF                                                   69500000
695100     END-IF.                                                      69510000
695200                                                                  69520000
695300     COMPUTE PV-SUB-COMP3 = (SU010-ITEM (SU010-IDX)               69530000
695400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              69540000
695500     MOVE PV-SUB-COMP3 TO PV-SUB.                                 69550000
695600                                                                  69560000
695700     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       69570000
695800     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        69580000
695900                                     (PV-SUB).                    69590000
696000     EVALUATE TRUE                                                69600000
696100         WHEN SU010-INQ (SU010-IDX)                               69610000
696200              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         69620000
696300                                                                  69630000
696400         WHEN SU010-UPD (SU010-IDX)                               69640000
696500              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         69650000
696600                                                                  69660000
696700         WHEN SU010-DEL (SU010-IDX)                               69670000
696800              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         69680000
696900                                                                  69690000
697000         WHEN SU010-ERR (SU010-IDX)                               69700000
697100              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         69710000
697200     END-EVALUATE.                                                69720000
697300                                                                  69730000
697400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                69740000
697500*----------------------------------------------------------------*69750000
697600*    WRITE THE TS QUEUE RECORD JUST UPDATED                      *69760000
697700*----------------------------------------------------------------*69770000
697800 6111-WRITE-LIST-QUEUE.                                           69780000
697900     EXEC CICS                                                    69790000
698000         WRITEQ TS                                                69800000
698100             QUEUE (ASC-LIST-QUEUE-NAME)                          69810000
698200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     69820000
698300             ITEM  (PV-SAVE-ITEM)                                 69830000
698400             REWRITE                                              69840000
698500             RESP  (PV-CICS-RESP)                                 69850000
698600     END-EXEC.                                                    69860000
698700                                                                  69870000
698800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          69880000
698900         CONTINUE                                                 69890000
699000     ELSE                                                         69900000
699100         SET DP013-CICS-ABEND  TO  TRUE                           69910000
699200         SET DP013-NO-ROLLBACK TO  TRUE                           69920000
699300         MOVE '6111-WRITE-LIST-QUEUE' TO DP013-PARAGRAPH          69930000
699400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  69940000
699500                               TO  DP013-MESSAGE-TEXT(1)          69950000
699600         PERFORM DP013-0000-PROCESS-ABEND                         69960000
699700     END-IF.                                                      69970000
699800                                                                  69980000
699900*----------------------------------------------------------------*69990000
700000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*70000000
700100*----------------------------------------------------------------*70010000
700200 6112-READ-LIST-QUEUE.                                            70020000
700300     EXEC CICS                                                    70030000
700400         READQ TS                                                 70040000
700500             QUEUE (ASC-LIST-QUEUE-NAME)                          70050000
700600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     70060000
700700             ITEM  (PV-ITEM)                                      70070000
700800             RESP  (PV-CICS-RESP)                                 70080000
700900     END-EXEC.                                                    70090000
701000                                                                  70100000
701100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          70110000
701200         CONTINUE                                                 70120000
701300     ELSE                                                         70130000
701400         SET DP013-CICS-ABEND        TO TRUE                      70140000
701500         SET DP013-NO-ROLLBACK       TO TRUE                      70150000
701600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           70160000
701700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    70170000
701800                                     TO DP013-MESSAGE-TEXT(1)     70180000
701900         PERFORM DP013-0000-PROCESS-ABEND                         70190000
702000     END-IF.                                                      70200000
702100                                                                  70210000
702200*CLP 09/03/13 END                                                 70220000
702300*----------------------------------------------------------------*70230000
702400*  7000-FORMAT-COMMAREA USED BY RCVRMNT FUNCTION                 *70240000
702500*----------------------------------------------------------------*70250000
702600 7000-FORMAT-COMMAREA.                                            70260000
702700     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            70270000
702800        MOVE 1                   TO PV-BLOCK-NUMBER               70280000
702900     ELSE                                                         70290000
703000        MOVE 2                   TO PV-BLOCK-NUMBER               70300000
703100     END-IF.                                                      70310000
703200                                                                  70320000
703300     PERFORM VARYING PV-SUB FROM 1 BY 1                           70330000
703400             UNTIL  PV-SUB > PC-ITEMS-PER-PANEL                   70340000
703500         IF  ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'      70350000
703600             MOVE ASC-PO-NBR-N (PV-BLOCK-NUMBER PV-SUB)           70360000
703700                                  TO RC015-PO-NBR                 70370000
703800             MOVE ASC-RCVR-SEQ-NBR-N (PV-BLOCK-NUMBER PV-SUB)     70380000
703900                                  TO RC015-REC-SEQ-NBR            70390000
704000             MOVE ASC-OPER-UNT-ID (PV-BLOCK-NUMBER PV-SUB)        70400000
704100                                  TO RC015-OPER-UNT-ID            70410000
704200             MOVE ASC-FCLTY-ID (PV-BLOCK-NUMBER PV-SUB)           70420000
704300                                  TO RC015-FCLTY-ID               70430000
704400             COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1              70440000
704500         END-IF                                                   70450000
704600     END-PERFORM.                                                 70460000
704700                                                                  70470000
704800*----------------------------------------------------------------*70480000
704900*  7000-FORMAT-COMMAREA-PCK USED BY RCPCKLST FUNCTION            *70490000
705000*----------------------------------------------------------------*70500000
705100 7000-FORMAT-COMMAREA-PCK.                                        70510000
705200     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            70520000
705300        MOVE 1                   TO PV-BLOCK-NUMBER               70530000
705400     ELSE                                                         70540000
705500        MOVE 2                   TO PV-BLOCK-NUMBER               70550000
705600     END-IF.                                                      70560000
705700                                                                  70570000
705800     PERFORM VARYING PV-SUB FROM 1 BY 1                           70580000
705900             UNTIL  PV-SUB > PC-ITEMS-PER-PANEL                   70590000
706000         IF  ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'      70600000
706100             MOVE ASC-PO-NBR-N (PV-BLOCK-NUMBER PV-SUB)           70610000
706200                                  TO RC800-REC-NBR-N              70620000
706300             MOVE ASC-RCVR-SEQ-NBR-N (PV-BLOCK-NUMBER PV-SUB)     70630000
706400                                  TO RC800-REC-SEQ-NBR-N          70640000
706500             MOVE ASC-OPER-UNT-ID (PV-BLOCK-NUMBER PV-SUB)        70650000
706600                                  TO RC800-OPER-UNIT-ID           70660000
706700             MOVE ASC-FCLTY-ID (PV-BLOCK-NUMBER PV-SUB)           70670000
706800                                  TO RC800-FACILITY-ID            70680000
706900             COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1              70690000
707000         END-IF                                                   70700000
707100     END-PERFORM.                                                 70710000
707200                                                                  70720000
707300*----------------------------------------------------------------*70730000
707400*  8000-GET-NAMES  - TO GET BUYER NBR AND NAME AND ANALYST NAME  *70740000
707500*----------------------------------------------------------------*70750000
707600 8000-GET-NAMES.                                                  70760000
707700     IF ASC-NO-BYR-ANL-NME                                        70770000
707800         CONTINUE                                                 70780000
707900     ELSE                                                         70790000
708000         PERFORM 8010-BYR-NME-NBR                                 70800000
708100         PERFORM 8020-OPEN-ANL-CSR                                70810000
708200         PERFORM 8030-FETCH-ANL-CSR                               70820000
708300         PERFORM 8040-CLOSE-ANL-CSR                               70830000
708400     END-IF.                                                      70840000
708500                                                                  70850000
708600******************************************************************70860000
708700* 8010-BYR-NME-NBR -- GET BUYER NAME AND NBR TO DISPLAY ON THE    70870000
708800*        LIST SCREENS                                             70880000
708900******************************************************************70890000
709000 8010-BYR-NME-NBR.                                                70900000
709100     PERFORM                                                      70910000
709200         WITH TEST AFTER                                          70920000
709300         VARYING PV-RETRY-COUNTER                                 70930000
709400         FROM 1 BY 1                                              70940000
709500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               70950000
709600                   OR (SQLCODE = ZERO OR +100 OR -811))           70960000
709700                                                                  70970000
709800         EXEC SQL                                                 70980000
709900             SELECT B.WORKER_FIR_NAME                             70990000
710000                  , B.WORKER_LAST_NAME                            71000000
710100                  , A.BYR_NBR                                     71010000
710200               INTO :RSPBAR-WORKER-FIR-NAME                       71020000
710300                  , :RSPBAR-WORKER-LAST-NAME                      71030000
710400                  , :MDSEAR-BYR-NBR                               71040000
710500               FROM                                               71050000
710600                    TMDSEAR A                                     71060000
710700                  , TRSPBAR B                                     71070000
710800              WHERE                                               71080000
710900                    A.MDSEAR_DKEY = B.MDSEAR_DKEY                 71090000
711000                AND A.OPERCO_NBR = '03'                           71100000
711100                AND A.MDSELV_CDE = 'DPT'                          71110000
711200                AND A.DEPT_NBR = :TRBNTF-DEPT-NBR                 71120000
711300                AND A.STRT_DTE <= CURRENT DATE                    71130000
711400                AND A.END_DTE >= CURRENT DATE                     71140000
711500                AND B.RSPLVL_CDE = 'BYR'                          71150000
711600                AND B.WORKER_STRT_DTE <= CURRENT DATE             71160000
711700                AND B.WORKER_END_DTE > CURRENT DATE               71170000
711800         END-EXEC                                                 71180000
711900                                                                  71190000
712000         EVALUATE TRUE                                            71200000
712100             WHEN SQLCODE = +0                                    71210000
712200             WHEN SQLCODE = -811                                  71220000
712300                 MOVE MDSEAR-BYR-NBR TO ASC-BYR-NBR               71230000
712400                 PERFORM 8050-STRING-NAME                         71240000
712500                 MOVE PV-NAME   TO ASC-BYR-NME                    71250000
712600             WHEN SQLCODE = +100                                  71260000
712700             WHEN SQLCODE = -904                                  71270000
712800             WHEN SQLCODE = -913                                  71280000
712900                 CONTINUE                                         71290000
713000             WHEN SQLWARN0 NOT = SPACE                            71300000
713100             WHEN SQLCODE     < ZERO                              71310000
713200             WHEN SQLCODE     > ZERO                              71320000
713300                 MOVE '8010-BYR-NME-NBR' TO DP013-PARAGRAPH       71330000
713400                 MOVE 'SELECT BUYER NAME AND NBR'                 71340000
713500                                 TO DP013-MESSAGE-TEXT (1)        71350000
713600                 MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)      71360000
713700                 MOVE 'TRSPBAR ' TO DP013-DB2-TABLE-NAME (2)      71370000
713800                 SET DP013-DB2-ABEND TO TRUE                      71380000
713900                 PERFORM DP013-0000-PROCESS-ABEND                 71390000
714000         END-EVALUATE                                             71400000
714100     END-PERFORM.                                                 71410000
714200                                                                  71420000
714300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        71430000
714400         MOVE '8010-BYR-NME-NBR' TO DP013-PARAGRAPH               71440000
714500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     71450000
714600                           TO DP013-MESSAGE-TEXT (1)              71460000
714700         MOVE SQLCA                    TO DP013-SQLCA             71470000
714800         MOVE 'TMDSEAR '      TO DP013-DB2-TABLE-NAME (1)         71480000
714900         MOVE 'TRSPBAR '      TO DP013-DB2-TABLE-NAME (2)         71490000
715000         SET DP013-DB2-ABEND                                      71500000
715100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   71510000
715200         PERFORM DP013-0000-PROCESS-ABEND                         71520000
715300     END-IF.                                                      71530000
715400                                                                  71540000
715500******************************************************************71550000
715600* 8020-OPEN-ANL-CSR - OPEN THE CURSOR TO GET ANALYST NAME         71560000
715700******************************************************************71570000
715800 8020-OPEN-ANL-CSR.                                               71580000
715900        EXEC SQL                                                  71590000
716000             OPEN ANALYST-CSR                                     71600000
716100        END-EXEC.                                                 71610000
716200                                                                  71620000
716300        EVALUATE TRUE                                             71630000
716400           WHEN SQLCODE = ZERO                                    71640000
716500                CONTINUE                                          71650000
716600           WHEN OTHER                                             71660000
716700               MOVE '8020-OPEN-ANL-CSR' TO DP013-PARAGRAPH        71670000
716800               MOVE 'OPEN CURSOR' TO DP013-MESSAGE-TEXT (1)       71680000
716900               MOVE 'TMDSEAR'     TO DP013-DB2-TABLE-NAME (1)     71690000
717000               MOVE 'TRSPBAR'     TO DP013-DB2-TABLE-NAME (2)     71700000
717100               SET DP013-DB2-ABEND                                71710000
717200                   DP013-XCTL-DISPLAY-RESTART TO TRUE             71720000
717300               PERFORM DP013-0000-PROCESS-ABEND                   71730000
717400        END-EVALUATE.                                             71740000
717500                                                                  71750000
717600******************************************************************71760000
717700* 8030-FETCH-ANL-CSR - FETCH THE ROW TO GET ANALYST NAME          71770000
717800******************************************************************71780000
717900 8030-FETCH-ANL-CSR.                                              71790000
718000     INITIALIZE DCLTMDSEAR.                                       71800000
718100     INITIALIZE DCLTRSPBAR.                                       71810000
718200                                                                  71820000
718300     EXEC SQL                                                     71830000
718400         FETCH ANALYST-CSR                                        71840000
718500          INTO :RSPBAR-WORKER-STRT-DTE                            71850000
718600             , :RSPBAR-WORKER-FIR-NAME                            71860000
718700             , :RSPBAR-WORKER-LAST-NAME                           71870000
718800     END-EXEC.                                                    71880000
718900                                                                  71890000
719000     EVALUATE TRUE                                                71900000
719100         WHEN SQLCODE = +0                                        71910000
719200         WHEN SQLCODE = -811                                      71920000
719300             PERFORM 8050-STRING-NAME                             71930000
719400             MOVE PV-NAME      TO ASC-ANL-NME                     71940000
719500         WHEN SQLCODE = +100                                      71950000
719600         WHEN SQLCODE = -913                                      71960000
719700             CONTINUE                                             71970000
719800         WHEN OTHER                                               71980000
719900             MOVE '8030-FETCH-ANL-CSR' TO DP013-PARAGRAPH         71990000
720000             MOVE 'FETCH ANALYST NAME'                            72000000
720100                                TO DP013-MESSAGE-TEXT (1)         72010000
720200             MOVE 'TMDSEAR'     TO DP013-DB2-TABLE-NAME (1)       72020000
720300             MOVE 'TRSPBAR'     TO DP013-DB2-TABLE-NAME (2)       72030000
720400             SET DP013-DB2-ABEND                                  72040000
720500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               72050000
720600             PERFORM DP013-0000-PROCESS-ABEND                     72060000
720700     END-EVALUATE.                                                72070000
720800                                                                  72080000
720900******************************************************************72090000
721000* 8040-CLOSE-ANL-CSR - CLOSE THE ANALYST CURSOR                   72100000
721100******************************************************************72110000
721200 8040-CLOSE-ANL-CSR.                                              72120000
721300     EXEC SQL                                                     72130000
721400         CLOSE ANALYST-CSR                                        72140000
721500     END-EXEC.                                                    72150000
721600                                                                  72160000
721700     EVALUATE TRUE                                                72170000
721800         WHEN SQLCODE = ZERO                                      72180000
721900             CONTINUE                                             72190000
722000         WHEN SQLCODE = -904                                      72200000
722100         WHEN SQLCODE = -913                                      72210000
722200             CONTINUE                                             72220000
722300         WHEN OTHER                                               72230000
722400             MOVE '8020-OPEN-ANL-CSR'                             72240000
722500                                TO DP013-PARAGRAPH                72250000
722600             MOVE 'OPEN CURSOR' TO DP013-MESSAGE-TEXT (1)         72260000
722700             MOVE 'TMDSEAR'     TO DP013-DB2-TABLE-NAME (1)       72270000
722800             MOVE 'TRSPBAR'     TO DP013-DB2-TABLE-NAME (2)       72280000
722900             SET DP013-DB2-ABEND                                  72290000
723000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               72300000
723100             PERFORM DP013-0000-PROCESS-ABEND                     72310000
723200     END-EVALUATE.                                                72320000
723300                                                                  72330000
723400 8050-STRING-NAME.                                                72340000
723500     MOVE RSPBAR-WORKER-FIR-NAME TO PV-FIRST-NAME.                72350000
723600     MOVE RSPBAR-WORKER-LAST-NAME TO PV-LAST-NAME.                72360000
723700     INITIALIZE PV-NAME.                                          72370000
723800     SET INX3 TO 1.                                               72380000
723900     PERFORM VARYING INX1 FROM 1 BY 1                             72390000
724000             UNTIL INX1 > 12                                      72400000
724100         IF PV-FIRST-NAME-BYTE (INX1) = SPACE                     72410000
724200             SET INX3 UP BY 1                                     72420000
724300             SET INX1    TO 12                                    72430000
724400         ELSE                                                     72440000
724500             MOVE PV-FIRST-NAME-BYTE (INX1) TO                    72450000
724600                 PV-NAME-BYTE (INX3)                              72460000
724700             SET INX3 UP BY 1                                     72470000
724800         END-IF                                                   72480000
724900     END-PERFORM.                                                 72490000
725000                                                                  72500000
725100     PERFORM VARYING INX2 FROM 1 BY 1                             72510000
725200             UNTIL INX2 > 18                                      72520000
725300         IF PV-LAST-NAME-BYTE (INX2) = SPACE                      72530000
725400             SET INX2    TO 18                                    72540000
725500         ELSE                                                     72550000
725600             MOVE PV-LAST-NAME-BYTE (INX2) TO                     72560000
725700                 PV-NAME-BYTE (INX3)                              72570000
725800             SET INX3 UP BY 1                                     72580000
725900         END-IF                                                   72590000
726000     END-PERFORM.                                                 72600000
726100                                                                  72610000
726200*----------------------------------------------------------------*72620000
726300*    READ THE ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE      *72630000
726400*----------------------------------------------------------------*72640000
726500 9100-READ-SEL-QUEUE.                                             72650000
726600     EXEC CICS                                                    72660000
726700         READQ TS                                                 72670000
726800             QUEUE (ASC-SEL-QUEUE-IN)                             72680000
726900             INTO  (RC013-DC-SELECT-RECORD)                       72690000
727000             ITEM  (ASC-SEL-ITEM)                                 72700000
727100             RESP  (PV-CICS-RESP)                                 72710000
727200     END-EXEC.                                                    72720000
727300                                                                  72730000
727400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       72740000
727500         CONTINUE                                                 72750000
727600     ELSE                                                         72760000
727700         SET DP013-LOGIC-ABEND                                    72770000
727800             DP013-NO-ROLLBACK      TO TRUE                       72780000
727900         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            72790000
728000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   72800000
728100                                    TO DP013-MESSAGE-TEXT (1)     72810000
728200         PERFORM DP013-0000-PROCESS-ABEND                         72820000
728300     END-IF.                                                      72830000
728400                                                                  72840000
728500*----------------------------------------------------------------*72850000
728600*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *72860000
728700*----------------------------------------------------------------*72870000
728800 9200-REWRITE-SEL-QUEUE.                                          72880000
728900     EXEC CICS                                                    72890000
729000          WRITEQ TS                                               72900000
729100              QUEUE  (ASC-SEL-QUEUE-IN)                           72910000
729200              FROM   (RC013-DC-SELECT-RECORD)                     72920000
729300              ITEM  (ASC-SEL-ITEM)                                72930000
729400              RESP   (PV-CICS-RESP)                               72940000
729500              REWRITE                                             72950000
729600     END-EXEC.                                                    72960000
729700                                                                  72970000
729800     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   72980000
729900         SET DP013-CICS-ABEND                                     72990000
730000             DP013-NO-ROLLBACK     TO TRUE                        73000000
730100         MOVE '9200-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         73010000
730200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   73020000
730300                                   TO DP013-MESSAGE-TEXT (1)      73030000
730400         PERFORM DP013-0000-PROCESS-ABEND                         73040000
730500     END-IF.                                                      73050000
730600                                                                  73060000
730700 9300-READ-SEL-QUEUE.                                             73070000
730800     EXEC CICS                                                    73080000
730900         READQ TS                                                 73090000
731000             QUEUE (ASC-SEL-QUEUE-IN)                             73100000
731100             INTO  (PC016-TS-SEL-REC)                             73110000
731200             ITEM  (ASC-SEL-ITEM)                                 73120000
731300             RESP  (PV-CICS-RESP)                                 73130000
731400     END-EXEC.                                                    73140000
731500                                                                  73150000
731600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       73160000
731700         CONTINUE                                                 73170000
731800     ELSE                                                         73180000
731900         SET DP013-LOGIC-ABEND                                    73190000
732000             DP013-NO-ROLLBACK     TO TRUE                        73200000
732100         MOVE '9300-READ-SEL-QUEUE' TO DP013-PARAGRAPH            73210000
732200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   73220000
732300                                   TO DP013-MESSAGE-TEXT (1)      73230000
732400         PERFORM DP013-0000-PROCESS-ABEND                         73240000
732500     END-IF.                                                      73250000
732600                                                                  73260000
732700*----------------------------------------------------------------*73270000
732800*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *73280000
732900*----------------------------------------------------------------*73290000
733000 9400-REWRITE-SEL-QUEUE.                                          73300000
733100     EXEC CICS                                                    73310000
733200          WRITEQ TS                                               73320000
733300              QUEUE  (ASC-SEL-QUEUE-IN)                           73330000
733400              FROM   (PC016-TS-SEL-REC)                           73340000
733500              ITEM  (ASC-SEL-ITEM)                                73350000
733600              RESP   (PV-CICS-RESP)                               73360000
733700              REWRITE                                             73370000
733800     END-EXEC.                                                    73380000
733900                                                                  73390000
734000     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   73400000
734100         SET DP013-CICS-ABEND                                     73410000
734200             DP013-NO-ROLLBACK     TO TRUE                        73420000
734300         MOVE '9400-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         73430000
734400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   73440000
734500                                   TO DP013-MESSAGE-TEXT (1)      73450000
734600         PERFORM DP013-0000-PROCESS-ABEND                         73460000
734700     END-IF.                                                      73470000
734800                                                                  73480000
734900 9500-READ-SEL-QUEUE.                                             73490000
735000     EXEC CICS                                                    73500000
735100         READQ TS                                                 73510000
735200             QUEUE (ASC-SEL-QUEUE-IN)                             73520000
735300             INTO  (DS002-PRINT-SELECT-RECORD)                    73530000
735400             ITEM  (ASC-SEL-ITEM)                                 73540000
735500             RESP  (PV-CICS-RESP)                                 73550000
735600     END-EXEC.                                                    73560000
735700                                                                  73570000
735800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       73580000
735900         CONTINUE                                                 73590000
736000     ELSE                                                         73600000
736100         SET DP013-LOGIC-ABEND                                    73610000
736200             DP013-NO-ROLLBACK     TO TRUE                        73620000
736300         MOVE '9500-READ-SEL-QUEUE' TO DP013-PARAGRAPH            73630000
736400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   73640000
736500                                   TO DP013-MESSAGE-TEXT (1)      73650000
736600         PERFORM DP013-0000-PROCESS-ABEND                         73660000
736700     END-IF.                                                      73670000
736800                                                                  73680000
736900*----------------------------------------------------------------*73690000
737000*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *73700000
737100*----------------------------------------------------------------*73710000
737200 9600-REWRITE-SEL-QUEUE.                                          73720000
737300     EXEC CICS                                                    73730000
737400          WRITEQ TS                                               73740000
737500              QUEUE  (ASC-SEL-QUEUE-IN)                           73750000
737600              FROM   (DS002-PRINT-SELECT-RECORD)                  73760000
737700              ITEM  (ASC-SEL-ITEM)                                73770000
737800              RESP   (PV-CICS-RESP)                               73780000
737900              REWRITE                                             73790000
738000     END-EXEC.                                                    73800000
738100                                                                  73810000
738200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   73820000
738300         SET DP013-CICS-ABEND                                     73830000
738400             DP013-NO-ROLLBACK     TO TRUE                        73840000
738500         MOVE '9600-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         73850000
738600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   73860000
738700                                   TO DP013-MESSAGE-TEXT (1)      73870000
738800         PERFORM DP013-0000-PROCESS-ABEND                         73880000
738900     END-IF.                                                      73890000
739000                                                                  73900000
739100*----------------------------------------------------------------*73910000
739200*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *73920000
739300*----------------------------------------------------------------*73930000
739400 9900-SQL-913-RETURN.                                             73940000
739500     PERFORM 9100-READ-SEL-QUEUE.                                 73950000
739600     MOVE SPACE TO RC013-ACTION-SW (ASC-SEL-ITEM)                 73960000
739700     PERFORM 9200-REWRITE-SEL-QUEUE.                              73970000
739800     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       73980000
739900     SET DP020-MSG-FATAL           TO  TRUE.                      73990000
740000     MOVE PC-TSYMSG-01089          TO  DP020-MSG-NUMBER.          74000000
740100     MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1).         74010000
740200     PERFORM 0001-CALL-CICS-ARCH-API.                             74020000
740300                                                                  74030000
740400 9910-SQL-913-RETURN.                                             74040000
740500     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE.                       74050000
740600     SET DP020-MSG-FATAL           TO  TRUE.                      74060000
740700     MOVE PC-TSYMSG-01089          TO  DP020-MSG-NUMBER.          74070000
740800     MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1).         74080000
740900     PERFORM 0001-CALL-CICS-ARCH-API.                             74090000
741000                                                                  74100000
741100*----------------------------------------------------------------*74110000
741200*    ABEND PROCESSOR MODULE                                      *74120000
741300*----------------------------------------------------------------*74130000
741400     COPY DPPD013.                                                74140000
