000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      SEKUT017.                                       00040000
000500 AUTHOR.          MIKE SOMMERS.                                   00050000
000600 DATE-WRITTEN.    JUNE 2002.                                      00060000
000700                                                                  00070000
000800*        READ A FORMATTED NOTES FILE OF EMPLOYEE INFORMATION      00080000
000900*        AND A RACF INFORMATION FILE.  MERGE THE INFORMATION      00090000
001000*        TO CREATE A NEW FILE.                                    00100000
001100                                                                  00110000
001200 ENVIRONMENT DIVISION.                                            00120000
001300 CONFIGURATION SECTION.                                           00130000
001400 SOURCE-COMPUTER. IBM-3090.                                       00140000
001500 OBJECT-COMPUTER. IBM-3090.                                       00150000
001600                                                                  00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800 FILE-CONTROL.                                                    00180000
001900     SELECT EMAIL-FILE                 ASSIGN TO INP01.           00190001
002000     SELECT RACF-FILE                  ASSIGN TO INP02.           00200000
002100     SELECT MERGED-FILE                ASSIGN TO OUT01.           00210000
002200     SELECT PRINT-FILE                 ASSIGN TO RPT01.           00220000
002210     SELECT PRINT-FILE-2               ASSIGN TO RPT02.           00221000
002220     EJECT                                                        00222000
002230***************                                                   00223000
002240 DATA DIVISION.                                                   00224000
002250***************                                                   00225000
002260 FILE SECTION.                                                    00226000
002270 FD  EMAIL-FILE                                                   00227001
002280                             BLOCK CONTAINS 0 RECORDS,            00228000
002290                             RECORD CONTAINS 383 CHARACTERS,      00229001
002300                             RECORDING MODE IS F,                 00230000
002400                             LABEL RECORDS ARE STANDARD,          00240000
002500                             DATA RECORD IS EMAIL-REC.            00250001
002600 01  EMAIL-REC               PIC X(383).                          00260001
002700                                                                  00270000
002800 FD  RACF-FILE                                                    00280000
002900                             BLOCK CONTAINS 0 RECORDS,            00290000
003000                             RECORD CONTAINS 200 CHARACTERS,      00300000
003100                             RECORDING MODE IS F,                 00310000
003200                             LABEL RECORDS ARE STANDARD,          00320000
003300                             DATA RECORD IS RACF-REC.             00330000
003400 01  RACF-REC                PIC X(200).                          00340000
003500                                                                  00350000
003600 FD  MERGED-FILE                                                  00360000
003700                             BLOCK CONTAINS 0 RECORDS,            00370000
003800                             RECORD CONTAINS 392 CHARACTERS,      00380001
003900                             RECORDING MODE IS F,                 00390000
004000                             LABEL RECORDS ARE STANDARD,          00400000
004100                             DATA RECORD IS MERGED-REC.           00410000
004200 01  MERGED-REC              PIC X(392).                          00420001
004300                                                                  00430000
004400 FD  PRINT-FILE                                                   00440000
004500                             BLOCK CONTAINS 0 RECORDS,            00450000
004600                             RECORD CONTAINS 150 CHARACTERS,      00460000
004700                             RECORDING MODE IS F,                 00470000
004800                             LABEL RECORDS ARE STANDARD,          00480000
004900                             DATA RECORD IS PRINT-REC.            00490000
005000 01  PRINT-REC               PIC X(150).                          00500000
005100                                                                  00510000
005200 FD  PRINT-FILE-2                                                 00520000
005300                             BLOCK CONTAINS 0 RECORDS,            00530000
005400                             RECORD CONTAINS 150 CHARACTERS,      00540000
005500                             RECORDING MODE IS F,                 00550000
005600                             LABEL RECORDS ARE STANDARD,          00560000
005700                             DATA RECORD IS PRINT-REC-2.          00570000
005800 01  PRINT-REC-2             PIC X(150).                          00580000
005900     EJECT                                                        00590000
006000*************************                                         00600000
006100 WORKING-STORAGE SECTION.                                         00610000
006200*************************                                         00620000
006300 01  RIR-RACF-INPUT-RECORD.                                       00630000
006400     05  FILLER                      PIC X(1)      VALUE SPACES.  00640000
006500     05  RIR-NAME                    PIC X(30)     VALUE SPACES.  00650000
006510     05  FILLER                      PIC X(27)     VALUE SPACES.  00651000
006520     05  RIR-LOCATION                PIC X(4)      VALUE SPACES.  00652000
006530     05  FILLER                      PIC X(1)      VALUE SPACES.  00653000
006540     05  RIR-EMPLOYEE-SSN            PIC X(9)      VALUE SPACES.  00654000
006550     05  FILLER                      PIC X(26)     VALUE SPACES.  00655000
006560     05  RIR-EMPLOYEE-USER-ID        PIC X(7)      VALUE SPACES.  00656000
006570     05  FILLER                      PIC X(82)     VALUE SPACES.  00657000
006571     05  RIR-EMPLOYEE-NBR            PIC X(7)      VALUE SPACES.  00657100
006572     05  FILLER                      PIC X(6)      VALUE SPACES.  00657200
006573                                                                  00657300
006574     COPY SERD001.                                                00657401
007400                                                                  00740000
007500 01  MOR-MERGED-OUTPUT-RECORD.                                    00750000
007600     05  MOR-EMPLOYEE-USER-ID-FIELD.                              00760000
007700         10  MOR-EMPLOYEE-USER-ID    PIC X(7)      VALUE SPACES.  00770000
007800         10  FILLER                  PIC X(1)      VALUE SPACES.  00780000
007900     05  MOR-EMPLOYEE-NBR            PIC X(7)      VALUE SPACES.  00790000
007910     05  FILLER                      PIC X(2)      VALUE SPACES.  00791000
007920     05  MOR-NAME.                                                00792000
007930         10  MOR-FIRST-NAME          PIC X(16)     VALUE SPACES.  00793000
007940         10  MOR-LAST-NAME           PIC X(20)     VALUE SPACES.  00794000
007950     05  MOR-LOCATION                PIC X(4)      VALUE SPACES.  00795000
007960     05  MOR-LOCATION-NAME           PIC X(22)     VALUE SPACES.  00796000
007970     05  MOR-JOB-TITLE               PIC X(75)     VALUE SPACES.  00797000
007980     05  MOR-WORK-PHONE              PIC X(12)     VALUE SPACES.  00798000
007990     05  MOR-CELL-PHONE              PIC X(16)     VALUE SPACES.  00799000
008000     05  MOR-PAGER-PIN               PIC X(60)     VALUE SPACES.  00800000
008100     05  MOR-WORK-EMAIL-ADDRESS      PIC X(60)     VALUE SPACES.  00810003
008200     05  MOR-SUPERVISOR              PIC X(60)     VALUE SPACES.  00820000
008300     05  MOR-MARKET                  PIC X(30)     VALUE SPACES.  00830000
008400                                                                  00840000
008500 01  RR-REPORT-RECORD.                                            00850000
008600     05  FILLER                      PIC X(1)      VALUE SPACES.  00860000
008700     05  RR-MESSAGE                  PIC X(36)     VALUE SPACES.  00870000
008800     05  FILLER                      PIC X(2)      VALUE SPACES.  00880000
008900     05  RR-EMPLOYEE-USER-ID         PIC X(7)      VALUE SPACES.  00890000
009000     05  FILLER                      PIC X(2)      VALUE SPACES.  00900000
009100     05  RR-NAME                     PIC X(36)     VALUE SPACES.  00910000
009200     05  FILLER                      PIC X(2)      VALUE SPACES.  00920000
009300     05  FILLER                      PIC X(9)      VALUE SPACES.  00930000
009400     05  FILLER                      PIC X(4)      VALUE SPACES.  00940000
009500     05  RR-EMPLOYEE-LOCATION        PIC X(4)      VALUE SPACES.  00950000
009600     05  FILLER                      PIC X(4)      VALUE SPACES.  00960000
009700     05  RR-TITLE                    PIC X(43)     VALUE SPACES.  00970000
009800                                                                  00980000
009900 01  TR1-TOTAL-RECORD-1.                                          00990000
010000     05  FILLER                      PIC X(8)      VALUE SPACES.  01000000
010100     05  FILLER                      PIC X(42)     VALUE          01010000
010200         'TOTAL RACF RECORDS WITHOUT NOTES RECORDS: '.            01020000
010300     05  TR1-RACF-MISMATCH-CNT       PIC ZZZ,ZZ9   VALUE ZEROES.  01030000
010400     05  FILLER                      PIC X(75)     VALUE SPACES.  01040000
010500                                                                  01050000
010600 01  TR2-TOTAL-RECORD-2.                                          01060000
010700     05  FILLER                      PIC X(8)      VALUE SPACES.  01070000
010800     05  FILLER                      PIC X(42)     VALUE          01080000
010900         'TOTAL NOTES RECORDS WITHOUT RACF RECORDS: '.            01090000
011000     05  TR2-EMAIL-MISMATCH-CNT      PIC ZZZ,ZZ9   VALUE ZEROES.  01100001
011010     05  FILLER                      PIC X(75)     VALUE SPACES.  01101000
011020     EJECT                                                        01102000
011030**   132 CHARACTER HEADING   **                                   01103000
011040                                                                  01104000
011050 01  HEADING-LINE1.                                               01105000
011060     05  HL1-DATE.                                                01106000
011070         10  HL1-MM                PIC 9(2)    VALUE ZEROES.      01107000
011080         10  FILLER                PIC X(1)    VALUE '-'.         01108000
011090         10  HL1-DD                PIC 9(2)    VALUE ZEROES.      01109000
011091         10  FILLER                PIC X(1)    VALUE '-'.         01109100
011092         10  HL1-YY                PIC 9(2)    VALUE ZEROES.      01109200
011093     05  FILLER                    PIC X(2)    VALUE SPACES.      01109300
011094     05  HL1-TIME.                                                01109400
011095         10  HL1-HR                PIC 9(2)    VALUE ZEROES.      01109500
011096         10  FILLER                PIC X(1)    VALUE ':'.         01109600
011097         10  HL1-MN                PIC 9(2)    VALUE ZEROES.      01109700
011098         10  FILLER                PIC X(1)    VALUE ':'.         01109800
011099         10  HL1-SC                PIC 9(2)    VALUE ZEROES.      01109900
011100     05  FILLER                    PIC X(32)   VALUE SPACES.      01110000
011200     05  FILLER                    PIC X(48)                      01120000
011300         VALUE 'K O H L '' S   D E P A R T M E N T   S T O R E S'.01130000
011400     05  FILLER                    PIC X(31)   VALUE SPACES.      01140000
011500     05  FILLER                    PIC X(9)    VALUE 'SEKUT017-'. 01150000
011600     05  HL1-RPTNO                 PIC 9(1)    VALUE 1.           01160000
011700     05  FILLER                    PIC X(7)    VALUE '  PAGE '.   01170000
011800     05  HL1-PAGE                  PIC ZZZ9    VALUE ZEROES.      01180000
011900                                                                  01190000
012000 01  HEADING-LINE2.                                               01200000
012100     05  FILLER                    PIC X(54)      VALUE SPACES.   01210000
012200     05  FILLER                    PIC X(40)      VALUE           01220000
012300         'RACF/NOTES USER ID MISMATCH AUDIT REPORT'.              01230000
012400     05  FILLER                    PIC X(56)      VALUE SPACES.   01240000
012500                                                                  01250000
012600 01  HEADING-LINE2A.                                              01260000
012700     05  FILLER                    PIC X(49)      VALUE SPACES.   01270000
012800     05  FILLER                    PIC X(50)      VALUE           01280000
012900         'CORPORATE RACF/NOTES USER ID MISMATCH AUDIT REPORT'.    01290000
013000     05  FILLER                    PIC X(51)      VALUE SPACES.   01300000
013100                                                                  01310000
013200 01  HEADING-LINE3.                                               01320000
013300     05  FILLER                    PIC X(46)      VALUE           01330000
013400         ' MESSAGE                               USER ID'.        01340000
013500     05  FILLER                    PIC X(54)      VALUE           01350000
013600         '  NAME                                             LOC'.01360000
013700     05  FILLER                    PIC X(12)      VALUE           01370000
013800         'ATION  TITLE'.                                          01380000
013900     05  FILLER                    PIC X(38)      VALUE SPACES.   01390000
014000                                                                  01400000
014100     EJECT                                                        01410000
014110 01  WSF-WORKING-STORAGE-FIELDS.                                  01411000
014120     05  WSF-PAGE-CNT-1              PIC 9(4)     VALUE ZEROES.   01412000
014130     05  WSF-PAGE-CNT-2              PIC 9(4)     VALUE ZEROES.   01413000
014140     05  WSF-LINE-CNT-1              PIC 9(2)     VALUE 80.       01414000
014150     05  WSF-LINE-CNT-2              PIC 9(2)     VALUE 80.       01415000
014160     05  WSF-STORE-NBR               PIC 9(7)     VALUE           01416000
014170                                                  9999999.        01417000
014180     05  WSF-EMAIL-MISMATCH-CNT      PIC 9(6)     VALUE ZEROES.   01418001
014190     05  WSF-RACF-MISMATCH-CNT       PIC 9(6)     VALUE ZEROES.   01419000
014200     05  WSF-0900-EMAIL-MISMATCH-CNT PIC 9(6)     VALUE ZEROES.   01420001
014300     05  WSF-0900-RACF-MISMATCH-CNT  PIC 9(6)     VALUE ZEROES.   01430000
014400     05  WSF-USER-ID                 PIC X(8)     VALUE SPACES.   01440000
014500     05  WSF-STORE-USER-ID-TK        REDEFINES WSF-USER-ID.       01450000
014600         10  FILLER                  PIC X(2).                    01460000
014700             88  WSF-STORE-USER-ID-IS-A-TK        VALUE 'TK'.     01470000
014800         10  FILLER                  PIC X(6).                    01480000
014900     05  WSF-STORE-USER-ID-3-DIGIT   REDEFINES WSF-USER-ID.       01490000
015000         10  FILLER                  PIC X(4).                    01500000
015100             88  WSF-STORE-USER-ID-3-DIGIT-PFX    VALUE 'TKST'.   01510000
015200         10  WSF-STORE-USER-ID-3-DIGIT-NBR                        01520000
015300                                     PIC X(3).                    01530000
015310         10  FILLER                  PIC X(1).                    01531000
015320     05  WSF-STORE-USER-ID-4-DIGIT   REDEFINES WSF-USER-ID.       01532000
015330         10  FILLER                  PIC X(3).                    01533000
015340             88  WSF-STORE-USER-ID-4-DIGIT-PFX    VALUE 'TKS'.    01534000
015350         10  WSF-STORE-USER-ID-4-DIGIT-NBR                        01535000
015360                                     PIC X(4).                    01536000
015370         10  FILLER                  PIC X(1).                    01537000
015380     05  WSF-DATE.                                                01538000
015381         10  WSF-YR                  PIC 9(2)     VALUE ZEROES.   01538100
015382         10  WSF-MO                  PIC 9(2)     VALUE ZEROES.   01538200
015383         10  WSF-DY                  PIC 9(2)     VALUE ZEROES.   01538300
015384     05  WSF-TIME.                                                01538400
015385         10  WSF-HR                  PIC 9(2)     VALUE ZEROES.   01538500
015386         10  WSF-MIN                 PIC 9(2)     VALUE ZEROES.   01538600
015387         10  WSF-SEC                 PIC 9(2)     VALUE ZEROES.   01538700
015388         10  WSF-HSEC                PIC 9(2)     VALUE ZEROES.   01538800
015389                                                                  01538900
015390 01  EMAIL-FILE-EOF                  PIC 9(1)     VALUE ZEROES.   01539001
015391     88  EF-EOF                                   VALUE 1.        01539102
015392 01  RACF-FILE-EOF                   PIC 9(1)     VALUE ZEROES.   01539200
015393     88  RF-EOF                                   VALUE 1.        01539302
015394                                                                  01539400
015395 01  ABEND-CODE                      PIC 9(2) COMP VALUE ZEROES.  01539500
015396     EJECT                                                        01539600
015397********************                                              01539700
015398 PROCEDURE DIVISION.                                              01539800
015399********************                                              01539900
015400     DISPLAY '****************************'                       01540000
015500     DISPLAY '** BEGIN PROGRAM SEKUT017 **'                       01550000
015600     DISPLAY '****************************'                       01560000
015700     DISPLAY ' '.                                                 01570000
015800                                                                  01580000
015900     ACCEPT WSF-TIME FROM TIME.                                   01590000
016000     ACCEPT WSF-DATE FROM DATE.                                   01600000
016100     MOVE WSF-HR TO HL1-HR.                                       01610000
016200     MOVE WSF-MIN TO HL1-MN.                                      01620000
016300     MOVE WSF-SEC TO HL1-SC.                                      01630000
016400     MOVE WSF-MO TO HL1-MM.                                       01640000
016500     MOVE WSF-DY TO HL1-DD.                                       01650000
016600     MOVE WSF-YR TO HL1-YY.                                       01660000
016700                                                                  01670000
016800     OPEN INPUT  EMAIL-FILE                                       01680001
016900                 RACF-FILE.                                       01690000
017000     OPEN OUTPUT MERGED-FILE                                      01700000
017100                 PRINT-FILE                                       01710000
017200                 PRINT-FILE-2.                                    01720000
017300                                                                  01730000
017400     PERFORM A100-READ-EMAIL-FILE.                                01740001
017500     PERFORM A200-READ-RACF-FILE.                                 01750000
017600     PERFORM B000-CHECK-EOF                                       01760000
017700         UNTIL EF-EOF.                                            01770002
017800                                                                  01780000
017900     CLOSE EMAIL-FILE                                             01790001
018000           RACF-FILE                                              01800000
018100           MERGED-FILE                                            01810000
018200           PRINT-FILE                                             01820000
018300           PRINT-FILE-2.                                          01830000
018400                                                                  01840000
018500     DISPLAY ' '.                                                 01850000
018600     DISPLAY '****************************'                       01860000
018700     DISPLAY '**  END PROGRAM SEKUT017  **'                       01870000
018800     DISPLAY '****************************'                       01880000
018900     STOP RUN.                                                    01890000
019000                                                                  01900000
019100**********************                                            01910000
019200 A100-READ-EMAIL-FILE.                                            01920001
019300**********************                                            01930000
019400     IF EF-EOF                                                    01940002
019500         CONTINUE                                                 01950000
019600     ELSE                                                         01960000
019700         READ EMAIL-FILE INTO SE001-FORMATTED-OUTPUT-RECORD       01970001
019800             AT END                                               01980000
019900                 SET EF-EOF TO TRUE                               01990002
020000                 PERFORM Y200-WRITE-TOTALS                        02000002
020100                 MOVE SPACES TO RR-REPORT-RECORD                  02010002
020200                 MOVE '** END OF REPORT **' TO RR-NAME            02020002
020300                 PERFORM Y100-WRITE-REPORT-RECORD                 02030002
020400     END-IF.                                                      02040000
020500                                                                  02050000
020600*********************                                             02060000
020700 A200-READ-RACF-FILE.                                             02070000
020800*********************                                             02080000
020900     IF RF-EOF                                                    02090000
021000         CONTINUE                                                 02100000
021100     ELSE                                                         02110000
021200         READ RACF-FILE INTO RIR-RACF-INPUT-RECORD                02120000
021300             AT END                                               02130000
021400                 SET RF-EOF TO TRUE                               02140002
021500     END-IF.                                                      02150000
021600                                                                  02160000
021700****************                                                  02170000
021800 B000-CHECK-EOF.                                                  02180000
021900****************                                                  02190000
022000     IF EF-EOF AND RF-EOF                                         02200002
022100         CONTINUE                                                 02210000
022200     ELSE                                                         02220000
022300         IF EF-EOF                                                02230002
022400             MOVE 1 TO RACF-FILE-EOF                              02240000
022500*            PERFORM A200-READ-RACF-FILE                          02250000
022600         ELSE                                                     02260000
022700             IF RF-EOF                                            02270002
022710                 PERFORM B050-CHECK-USER-ID                       02271000
022720*-               PERFORM D000-BUILD-OUTPUT-RECORD                 02272000
022730*-               MOVE ZEROES TO MOR-EMPLOYEE-NBR                  02273000
022740*-               PERFORM D100-WRITE-OUTPUT                        02274000
022750*-               PERFORM A100-READ-EMAIL-FILE                     02275001
022760             ELSE                                                 02276000
022770                 PERFORM B050-CHECK-USER-ID                       02277000
022780*                PERFORM B100-COMPARE-FILES                       02278000
022790             END-IF                                               02279000
022800         END-IF                                                   02280000
022900     END-IF.                                                      02290000
023000                                                                  02300000
023100                                                                  02310000
023200******************************************************************02320000
023300*  IF NOTES USER ID IS IN THE FORMAT TKXXXXXX, PROCESSING WILL    02330000
023400*  CONTINUE.                                                      02340000
023500*  IF THE USER ID IS THE SAME AS THE EMPLOYEE ID, THE NOTES RECORD02350000
023600*  WILL BE WRITTEN TO THE OUTPUT FILE.                            02360000
023700******************************************************************02370000
023800********************                                              02380000
023900 B050-CHECK-USER-ID.                                              02390000
024000********************                                              02400000
024001     MOVE SE001-EMPLOYEE-USER-ID TO WSF-USER-ID.                  02400101
024002     IF WSF-STORE-USER-ID-IS-A-TK                                 02400200
024003         IF RF-EOF                                                02400300
024004             MOVE ZEROES TO MOR-EMPLOYEE-NBR                      02400400
024005             PERFORM B055-SET-UP-EMAIL-REC                        02400501
024006         ELSE                                                     02400600
024007             PERFORM B100-COMPARE-FILES                           02400700
024008         END-IF                                                   02400800
024009     ELSE                                                         02400900
024010*-------------------------------                                  02401000
024011         DISPLAY 'B050-; USER ID: ' SE001-EMPLOYEE-USER-ID        02401101
024012             ', NAME: ' SE001-LAST-NAME ', LOC: '                 02401201
024013             SE001-LOCATION-NBR                                   02401301
024014*-------------------------------                                  02401400
024015         MOVE SE001-EMPLOYEE-USER-ID-STD TO MOR-EMPLOYEE-NBR      02401501
024016         PERFORM B055-SET-UP-EMAIL-REC                            02401601
024017*        PERFORM D000-BUILD-OUTPUT-RECORD                         02401700
024018*        MOVE SE001-EMPLOYEE-USER-ID-STD TO MOR-EMPLOYEE-NBR      02401801
024019*        PERFORM D100-WRITE-OUTPUT                                02401900
024020*        PERFORM A100-READ-EMAIL-FILE                             02402001
024021     END-IF.                                                      02402100
024022                                                                  02402200
024023***********************                                           02402300
024024 B055-SET-UP-EMAIL-REC.                                           02402401
024025***********************                                           02402500
024026     PERFORM D000-BUILD-OUTPUT-RECORD.                            02402600
024027     PERFORM D100-WRITE-OUTPUT.                                   02402700
024028     PERFORM A100-READ-EMAIL-FILE.                                02402801
024029                                                                  02402900
024030********************                                              02403000
024031 B100-COMPARE-FILES.                                              02403100
024032********************                                              02403200
024033*    MOVE SE001-EMPLOYEE-USER-ID TO WSF-USER-ID.                  02403301
024034     IF (((WSF-STORE-USER-ID-3-DIGIT-PFX)                         02403400
024035             AND (WSF-STORE-USER-ID-3-DIGIT-NBR NUMERIC))         02403500
024036             OR ((WSF-STORE-USER-ID-4-DIGIT-PFX)                  02403600
024037             AND (WSF-STORE-USER-ID-4-DIGIT-NBR NUMERIC)))        02403700
024038         PERFORM D000-BUILD-OUTPUT-RECORD                         02403800
024039         PERFORM D105-WRITE-OUTPUT                                02403900
024040         PERFORM A100-READ-EMAIL-FILE                             02404001
024041     ELSE                                                         02404100
024050         IF SE001-EMPLOYEE-USER-ID-STD > RIR-EMPLOYEE-USER-ID     02405001
024060             PERFORM X100-BUILD-RACF-REPORT-RECORD                02406000
024070             PERFORM A200-READ-RACF-FILE                          02407000
024080         ELSE                                                     02408000
024090             IF SE001-EMPLOYEE-USER-ID-STD < RIR-EMPLOYEE-USER-ID 02409001
024100                 PERFORM X200-BUILD-EMAIL-REPORT-RECORD           02410001
024200                 PERFORM D000-BUILD-OUTPUT-RECORD                 02420000
024300                 MOVE ZEROES TO MOR-EMPLOYEE-NBR                  02430000
024400                 PERFORM D100-WRITE-OUTPUT                        02440000
024500                 PERFORM A100-READ-EMAIL-FILE                     02450001
024600             ELSE                                                 02460000
024700                 MOVE RIR-EMPLOYEE-NBR TO MOR-EMPLOYEE-NBR        02470000
024800                 PERFORM D050-BUILD-OUTPUT-RECORD                 02480000
024900                 PERFORM D100-WRITE-OUTPUT                        02490000
025000                 PERFORM A100-READ-EMAIL-FILE                     02500001
025100                 PERFORM A200-READ-RACF-FILE                      02510000
025200             END-IF                                               02520000
025300         END-IF                                                   02530000
025400     END-IF.                                                      02540000
025500                                                                  02550000
025600                                                                  02560000
025700**************************                                        02570000
025800 D000-BUILD-OUTPUT-RECORD.                                        02580000
025900**************************                                        02590000
026000     MOVE SE001-EMPLOYEE-USER-ID-STD TO MOR-EMPLOYEE-USER-ID.     02600001
026100     MOVE SE001-LAST-NAME            TO MOR-LAST-NAME.            02610001
026200     MOVE SE001-FIRST-NAME           TO MOR-FIRST-NAME.           02620001
026300     MOVE SE001-LOCATION-NBR         TO MOR-LOCATION.             02630001
026400     MOVE SE001-LOCATION-NAME        TO MOR-LOCATION-NAME.        02640001
026500     MOVE SE001-JOB-TITLE            TO MOR-JOB-TITLE.            02650001
026600     MOVE SE001-WORK-PHONE           TO MOR-WORK-PHONE.           02660001
026700     MOVE SE001-PAGER-PIN            TO MOR-PAGER-PIN.            02670001
026800     MOVE SE001-CELL-PHONE           TO MOR-CELL-PHONE.           02680001
026900     MOVE SE001-WORK-EMAIL-ADDRESS   TO MOR-WORK-EMAIL-ADDRESS.   02690001
027000     MOVE SE001-SUPERVISOR           TO MOR-SUPERVISOR.           02700001
027100     MOVE SE001-STR-GP-TYP-DESC      TO MOR-MARKET.               02710001
027200                                                                  02720000
027300                                                                  02730000
027400**************************                                        02740000
027500 D050-BUILD-OUTPUT-RECORD.                                        02750000
027600**************************                                        02760000
027700     MOVE SE001-EMPLOYEE-USER-ID-STD TO MOR-EMPLOYEE-USER-ID.     02770001
027800     MOVE SE001-LAST-NAME            TO MOR-LAST-NAME.            02780001
027900     MOVE SE001-FIRST-NAME           TO MOR-FIRST-NAME.           02790001
028000     MOVE SE001-JOB-TITLE            TO MOR-JOB-TITLE.            02800001
028100     MOVE SE001-WORK-PHONE           TO MOR-WORK-PHONE.           02810001
028200     MOVE SE001-PAGER-PIN            TO MOR-PAGER-PIN.            02820001
028300     MOVE SE001-CELL-PHONE           TO MOR-CELL-PHONE.           02830001
028400     MOVE SE001-WORK-EMAIL-ADDRESS   TO MOR-WORK-EMAIL-ADDRESS.   02840001
028500     MOVE SE001-SUPERVISOR           TO MOR-SUPERVISOR.           02850001
028600     MOVE SE001-STR-GP-TYP-DESC      TO MOR-MARKET.               02860001
028700     IF SE001-LOCATION-NBR NOT NUMERIC                            02870001
028800         MOVE RIR-LOCATION           TO MOR-LOCATION              02880001
028900*        PERFORM D055-MOVE-LOCATION-NAME                          02890000
029000     ELSE                                                         02900000
029100         MOVE SE001-LOCATION-NBR     TO MOR-LOCATION              02910001
029200         MOVE SE001-LOCATION-NAME    TO MOR-LOCATION-NAME         02920001
029300     END-IF.                                                      02930000
029400                                                                  02940000
029500                                                                  02950000
029600*************************                                         02960000
029700 D055-MOVE-LOCATION-NAME.                                         02970000
029800*************************                                         02980000
029900*    IF RIR-LOCATION = '0085'                                     02990000
030000*        MOVE 'MENOMONEE FALLS DC' TO MOR-LOCATION-NAME           03000000
030100*    END-IF.                                                      03010000
030200*    IF RIR-LOCATION = '0810'                                     03020000
030300*        MOVE 'FINDLAY DC'         TO MOR-LOCATION-NAME           03030000
030400*    END-IF.                                                      03040000
030500*    IF RIR-LOCATION = '0830'                                     03050000
030600*        MOVE 'WINCHESTER DC'      TO MOR-LOCATION-NAME           03060000
030700*    END-IF.                                                      03070000
030800*    IF RIR-LOCATION = '0840'                                     03080000
030900*        MOVE 'BLUESPRINGS'        TO MOR-LOCATION-NAME           03090000
031000*    END-IF.                                                      03100000
031100*    IF RIR-LOCATION = '0855'                                     03110000
031200*        MOVE 'SAN BERNARDINO'     TO MOR-LOCATION-NAME           03120000
031300*    END-IF.                                                      03130000
031400*    IF RIR-LOCATION = '0860'                                     03140000
031500*        MOVE 'CORSICANA'          TO MOR-LOCATION-NAME           03150000
031600*    END-IF.                                                      03160000
031700*    IF RIR-LOCATION = '0865'                                     03170000
031800*        MOVE 'MAMAKATING'         TO MOR-LOCATION-NAME           03180000
031900*    END-IF.                                                      03190000
032000*    IF RIR-LOCATION = '0870'                                     03200000
032100*        MOVE 'EFULFILLMENT'       TO MOR-LOCATION-NAME           03210000
032200*    END-IF.                                                      03220000
032300*    IF RIR-LOCATION = '0880'                                     03230000
032310*        MOVE 'CREDIT'             TO MOR-LOCATION-NAME           03231000
032320*    END-IF.                                                      03232000
032330*    IF RIR-LOCATION = '0900'                                     03233000
032340*        MOVE 'CORPORATE'          TO MOR-LOCATION-NAME           03234000
032350*    END-IF.                                                      03235000
032360                                                                  03236000
032361                                                                  03236100
032362*******************                                               03236200
032363 D100-WRITE-OUTPUT.                                               03236300
032364*******************                                               03236400
032365     IF MOR-EMPLOYEE-NBR = ZEROES                                 03236500
032366         CONTINUE                                                 03236600
032367     ELSE                                                         03236700
032368         WRITE MERGED-REC FROM MOR-MERGED-OUTPUT-RECORD           03236800
032369     END-IF.                                                      03236900
032370                                                                  03237000
032380                                                                  03238000
032381******************************************************************03238100
032382*  THIS PARAGRAPH WILL BE EXECUTED FOR STORE RECORDS COMING IN    03238200
032383*  ON THE NOTES FILE.                                             03238300
032384******************************************************************03238400
032385*******************                                               03238500
032386 D105-WRITE-OUTPUT.                                               03238600
032387*******************                                               03238700
032388     MOVE WSF-STORE-NBR TO MOR-EMPLOYEE-NBR.                      03238800
032389     WRITE MERGED-REC FROM MOR-MERGED-OUTPUT-RECORD.              03238900
032390                                                                  03239000
032400                                                                  03240000
032401*******************************                                   03240100
032402 X100-BUILD-RACF-REPORT-RECORD.                                   03240200
032403*******************************                                   03240300
032404     ADD 1                       TO WSF-RACF-MISMATCH-CNT.        03240400
032405     MOVE 'RECORD ON RACF BUT NOT ON NOTES FOR:'                  03240500
032406                                 TO RR-MESSAGE.                   03240600
032407     MOVE RIR-EMPLOYEE-USER-ID   TO RR-EMPLOYEE-USER-ID.          03240700
032408     MOVE RIR-LOCATION           TO RR-EMPLOYEE-LOCATION.         03240800
032409     MOVE SPACES                 TO RR-TITLE.                     03240900
032410     MOVE RIR-NAME               TO RR-NAME.                      03241000
032420     PERFORM Y100-WRITE-REPORT-RECORD.                            03242000
032430     IF RIR-LOCATION = 0900                                       03243000
032440         PERFORM Y120-WRITE-REPORT-RECORD                         03244000
032450         ADD 1                   TO WSF-0900-RACF-MISMATCH-CNT    03245000
032460     END-IF.                                                      03246000
032470                                                                  03247000
032480                                                                  03248000
032490********************************                                  03249000
032500 X200-BUILD-EMAIL-REPORT-RECORD.                                  03250001
032600********************************                                  03260000
032700     ADD 1                           TO WSF-EMAIL-MISMATCH-CNT.   03270001
032800     MOVE 'RECORD ON NOTES BUT NOT ON RACF FOR:'                  03280000
032900                                     TO RR-MESSAGE.               03290001
033000     MOVE SE001-EMPLOYEE-USER-ID-STD TO RR-EMPLOYEE-USER-ID.      03300001
033100     MOVE SE001-NAME                 TO RR-NAME.                  03310001
033200     MOVE SE001-LOCATION-NBR         TO RR-EMPLOYEE-LOCATION.     03320001
033300     MOVE SE001-JOB-TITLE            TO RR-TITLE.                 03330001
033400     PERFORM Y100-WRITE-REPORT-RECORD.                            03340000
033500     IF SE001-LOCATION-NBR = '0900'                               03350001
033600         PERFORM Y120-WRITE-REPORT-RECORD                         03360000
033700         ADD 1                      TO WSF-0900-EMAIL-MISMATCH-CNT03370001
033800     END-IF.                                                      03380000
033900                                                                  03390000
034000                                                                  03400000
034100**************************                                        03410000
034200 Y100-WRITE-REPORT-RECORD.                                        03420000
034300**************************                                        03430000
034400     IF WSF-LINE-CNT-1 > 60                                       03440000
034500         PERFORM Z100-HEADINGS                                    03450000
034600     END-IF.                                                      03460000
034700     IF EF-EOF                                                    03470002
034800         MOVE SPACES TO PRINT-REC                                 03480000
034900         WRITE PRINT-REC                                          03490000
035000             AFTER ADVANCING 1 LINE                               03500000
035100     END-IF.                                                      03510000
035200     WRITE PRINT-REC FROM RR-REPORT-RECORD                        03520000
035300         AFTER ADVANCING 1 LINE.                                  03530000
035400     ADD 1 TO WSF-LINE-CNT-1.                                     03540000
035500                                                                  03550000
035600                                                                  03560000
035700**************************                                        03570000
035800 Y120-WRITE-REPORT-RECORD.                                        03580000
035900**************************                                        03590000
036000     IF WSF-LINE-CNT-2 > 60                                       03600000
036010         PERFORM Z200-HEADINGS                                    03601000
036020     END-IF.                                                      03602000
036030     IF EF-EOF                                                    03603002
036040         MOVE SPACES TO PRINT-REC                                 03604000
036050         WRITE PRINT-REC-2                                        03605000
036060             AFTER ADVANCING 1 LINE                               03606000
036070     END-IF.                                                      03607000
036080     WRITE PRINT-REC-2 FROM RR-REPORT-RECORD                      03608000
036090         AFTER ADVANCING 1 LINE.                                  03609000
036100     ADD 1 TO WSF-LINE-CNT-2.                                     03610000
036101                                                                  03610100
036102                                                                  03610200
036103*******************                                               03610300
036104 Y200-WRITE-TOTALS.                                               03610400
036105*******************                                               03610500
036106     IF WSF-LINE-CNT-1 > 54                                       03610600
036107         PERFORM Z100-HEADINGS                                    03610700
036108     END-IF.                                                      03610800
036109     MOVE SPACES TO PRINT-REC                                     03610900
036110     WRITE PRINT-REC                                              03611000
036111         AFTER ADVANCING 2 LINES.                                 03611100
036112     MOVE WSF-EMAIL-MISMATCH-CNT TO TR2-EMAIL-MISMATCH-CNT.       03611201
036113     MOVE WSF-RACF-MISMATCH-CNT TO TR1-RACF-MISMATCH-CNT.         03611300
036114     WRITE PRINT-REC FROM TR1-TOTAL-RECORD-1                      03611400
036115         AFTER ADVANCING 1 LINE.                                  03611500
036116     WRITE PRINT-REC FROM TR2-TOTAL-RECORD-2                      03611600
036117         AFTER ADVANCING 2 LINES.                                 03611700
036118     ADD 5 TO WSF-LINE-CNT-1.                                     03611800
036119                                                                  03611900
036120     IF WSF-LINE-CNT-2 > 54                                       03612000
036121         PERFORM Z200-HEADINGS                                    03612100
036122     END-IF.                                                      03612200
036123     MOVE SPACES TO PRINT-REC-2                                   03612300
036124     WRITE PRINT-REC-2                                            03612400
036125         AFTER ADVANCING 2 LINES.                                 03612500
036126     MOVE WSF-0900-EMAIL-MISMATCH-CNT TO TR2-EMAIL-MISMATCH-CNT.  03612601
036127     MOVE WSF-0900-RACF-MISMATCH-CNT TO TR1-RACF-MISMATCH-CNT.    03612700
036128     WRITE PRINT-REC-2 FROM TR1-TOTAL-RECORD-1                    03612800
036129         AFTER ADVANCING 1 LINE.                                  03612900
036130     WRITE PRINT-REC-2 FROM TR2-TOTAL-RECORD-2                    03613000
036140         AFTER ADVANCING 2 LINES.                                 03614000
036150     ADD 5 TO WSF-LINE-CNT-2.                                     03615000
036160                                                                  03616000
036170                                                                  03617000
036180***************                                                   03618000
036190 Z100-HEADINGS.                                                   03619000
036200***************                                                   03620000
036201     ADD 1                 TO WSF-PAGE-CNT-1.                     03620100
036202     MOVE WSF-PAGE-CNT-1   TO HL1-PAGE.                           03620200
036203     MOVE 1                TO HL1-RPTNO.                          03620300
036204     MOVE SPACES           TO PRINT-REC.                          03620400
036205     WRITE PRINT-REC FROM HEADING-LINE1                           03620500
036206         AFTER ADVANCING PAGE.                                    03620600
036207     WRITE PRINT-REC FROM HEADING-LINE2                           03620700
036208         AFTER ADVANCING 1 LINE.                                  03620800
036209     WRITE PRINT-REC FROM HEADING-LINE3                           03620900
036210         AFTER ADVANCING 2 LINES.                                 03621000
036220     MOVE SPACES TO PRINT-REC.                                    03622000
036230     WRITE PRINT-REC                                              03623000
036240         AFTER ADVANCING 1 LINE.                                  03624000
036250     MOVE ZEROES TO WSF-LINE-CNT-1.                               03625000
036260                                                                  03626000
036270                                                                  03627000
036280***************                                                   03628000
036290 Z200-HEADINGS.                                                   03629000
036300***************                                                   03630000
036400     ADD 1                 TO WSF-PAGE-CNT-2.                     03640000
036500     MOVE WSF-PAGE-CNT-2   TO HL1-PAGE.                           03650000
036600     MOVE 2                TO HL1-RPTNO.                          03660000
036700     MOVE SPACES           TO PRINT-REC-2.                        03670000
036800     WRITE PRINT-REC-2 FROM HEADING-LINE1                         03680000
036900         AFTER ADVANCING PAGE.                                    03690000
037000     WRITE PRINT-REC-2 FROM HEADING-LINE2A                        03700000
037100         AFTER ADVANCING 1 LINE.                                  03710000
037200     WRITE PRINT-REC-2 FROM HEADING-LINE3                         03720000
037300         AFTER ADVANCING 2 LINES.                                 03730000
037400     MOVE SPACES TO PRINT-REC-2.                                  03740000
037500     WRITE PRINT-REC-2                                            03750000
037600         AFTER ADVANCING 1 LINE.                                  03760000
037700     MOVE ZEROES TO WSF-LINE-CNT-2.                               03770000
