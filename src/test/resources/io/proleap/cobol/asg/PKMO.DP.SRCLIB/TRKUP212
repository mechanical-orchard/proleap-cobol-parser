000100 IDENTIFICATION DIVISION.                                         00010031
000200******************************************************************00020031
000300                                                                  00030031
000400 PROGRAM-ID.   TRKUP212.                                          00040031
000500 AUTHOR.       ABRAHAM IVERSON.                                   00050031
000600 INSTALLATION. KOHLS DEPARTMENT STORES.                           00060031
000700 DATE-WRITTEN. MAY, 2004.                                         00070031
000800 DATE-COMPILED.                                                   00080031
000900                                                                  00090031
001000******************************************************************00100031
001100*                                                                *00110031
001200*  READ AN INPUT FILE CONSISTING OF ALL OF THE COMPONENTS OF AN  *00120031
001300*  ASN IN THE STANDARD STRUCTURE, THE PICK AND PACK OR PACK WITH *00130031
001400*  COMPONENT ONLY STRUCTURE.  CHECK THAT ALL RECORDS ARE PRESENT *00140031
001500*  AND IN THE CORRECT ORDER, EDIT THE DATA AND PASS  IT ON TO    *00150031
001600*  LOAD PROGRAM TRKUP215, AND/OR WRITE ERROR OR WARNING          *00160031
001700*  RECORDS FOR PROGRAM TRKRP211.  IF ERRORS ARE ENCOUNTERED AT A *00170031
001800*  HIGHER LEVEL, SPIN THROUGH THE INPUT WRITING ONLY ERROR       *00180031
001900*  RECORDS UNTIL THE GROUP CHANGES.  THERE IS AN EXCEPTION FILE  *00190031
002000*  CREATED WITH THE ALL THE RECORDS FOR AN ASN THAT HAD ERRORS. * 00200031
002100*                                                                *00210031
002200*  INPUT/OUTPUT                                                  *00220031
002300*                                                                *00230031
002400*   TRRD035 - ASN INPUT RECORDS                                  *00240031
002500*                                                                *00250031
002600*   TRRD023 - EDITED FILE (OUTPUT)                               *00260031
002700*                                                                *00270031
002800*                                                                *00280031
002900*   TRRD211 - RPT FILE.  THE OUTPUT REPORT FILE WILL BE A LENGTH *00290031
003000*                        OF 254 AND CONSIST OF ERROR OR WARNING  *00300031
003100*                        RECORDS PLUS HEADER RECORDS FOR BOTH    *00310031
003200*                        THE LOAD DETAIL AND ERROR REPORTS.      *00320031
003300******************************************************************00330031
003400******************************************************************00340031
003500* CHANGE HISTORY:                                                *00350031
003600*    CHANGES                                                     *00360031
003700*     MADE BY: VENKATSUBBU (COGNIZANT)                           *00370031
003800*     DATE:    12/15/2014                                        *00380031
003900*                                                                *00390031
004000*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00400031
004100*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 12/15/2014     *00410031
004200******************************************************************00420031
004300 ENVIRONMENT DIVISION.                                            00430031
004400******************************************************************00440031
004500                                                                  00450031
004600 CONFIGURATION SECTION.                                           00460031
004700                                                                  00470031
004800 SOURCE-COMPUTER.        IBM-3090.                                00480031
004900 OBJECT-COMPUTER.        IBM-3090.                                00490031
005000                                                                  00500031
005100 INPUT-OUTPUT SECTION.                                            00510031
005200                                                                  00520031
005300 FILE-CONTROL.                                                    00530031
005400                                                                  00540031
005500     SELECT TR063-ASN-FILE                                        00550031
005600         ASSIGN TO INP01.                                         00560031
005700                                                                  00570031
005800     SELECT TR023-UPDATE-CONTAINER-FILE                           00580031
005900         ASSIGN TO OUT01.                                         00590031
006000                                                                  00600031
006100     SELECT TR211-CONTAINER-ERROR-FILE                            00610031
006200         ASSIGN TO OUT02.                                         00620031
006300                                                                  00630031
006400     SELECT TR063-EXCEPTION-FILE                                  00640031
006500         ASSIGN TO OUT03.                                         00650031
006600                                                                  00660031
006700******************************************************************00670031
006800 DATA DIVISION.                                                   00680031
006900******************************************************************00690031
007000                                                                  00700031
007100 FILE SECTION.                                                    00710031
007200                                                                  00720031
007300 FD  TR063-ASN-FILE                                               00730031
007400     RECORDING MODE IS F                                          00740031
007500     LABEL RECORDS ARE STANDARD                                   00750031
007600     BLOCK CONTAINS 0 RECORDS.                                    00760031
007700                                                                  00770031
007800 01  TR063-ASN-RECORD                PIC X(400).                  00780031
007900                                                                  00790031
008000 FD  TR023-UPDATE-CONTAINER-FILE                                  00800031
008100     RECORDING MODE IS F                                          00810031
008200     LABEL RECORDS ARE STANDARD                                   00820031
008300     BLOCK CONTAINS 0 RECORDS.                                    00830031
008400                                                                  00840031
008500 01  TR023-UPDATE-CONTAINER-RECORD   PIC X(400).                  00850031
008600                                                                  00860031
008700 FD  TR211-CONTAINER-ERROR-FILE                                   00870031
008800     RECORDING MODE IS F                                          00880031
008900     LABEL RECORDS ARE STANDARD                                   00890031
009000     BLOCK CONTAINS 0 RECORDS.                                    00900031
009100                                                                  00910031
009200 01  TR211-CONTAINER-ERROR-RECORD    PIC X(508).                  00920031
009300                                                                  00930031
009400 FD  TR063-EXCEPTION-FILE                                         00940031
009500     RECORDING MODE IS F                                          00950031
009600     LABEL RECORDS ARE STANDARD                                   00960031
009700     BLOCK CONTAINS 0 RECORDS.                                    00970031
009800                                                                  00980031
009900 01  TR063-EXCEPTION-RECORD          PIC X(400).                  00990031
010000                                                                  01000031
010100******************************************************************01010031
010200 WORKING-STORAGE SECTION.                                         01020031
010300***************************************************************   01030031
010400                                                                  01040031
010500***************************************************************** 01050031
010600*    ASN DETAIL INPUT RECORD LAYOUT                               01060031
010700***************************************************************** 01070031
010800     COPY TRRD063.                                                01080031
010900******************************************************************01090031
011000*  DB2 FORMATTED MESSAGE AREA                                     01100031
011100******************************************************************01110031
011200     COPY DPWS004.                                                01120031
011300******************************************************************01130031
011400*  CALL LIST PARAMETERS FOR THE CALENDAR ROUTINE.                 01140031
011500******************************************************************01150031
011600     COPY DPWS500.                                                01160031
011700******************************************************************01170031
011800*    CONTAINER MANIFEST LOAD COPYBOOK LAYOUT                      01180031
011900******************************************************************01190031
012000     COPY TRRD023.                                                01200031
012100******************************************************************01210031
012200*  COMMUNICATIONS AREA FOR DB2                                    01220031
012300******************************************************************01230031
012400     EXEC SQL                                                     01240031
012500          INCLUDE SQLCA                                           01250031
012600     END-EXEC.                                                    01260031
012700******************************************************************01270031
012800*  DB2 TABLE DECLARATION -  ENTERPRISE NAME TABLE.                01280031
012900*      (TENTNME)                                                  01290031
013000******************************************************************01300031
013100     EXEC SQL                                                     01310031
013200          INCLUDE TENTNME                                         01320031
013300     END-EXEC.                                                    01330031
013400******************************************************************01340031
013500*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE TABLE (TPURCHS)01350031
013600******************************************************************01360031
013700     EXEC SQL                                                     01370031
013800          INCLUDE TPURCHS                                         01380031
013900     END-EXEC.                                                    01390031
014000******************************************************************01400031
014100*  DB2 TABLE DECLARATION - TPOPRPK                                01410031
014200******************************************************************01420031
014300     EXEC SQL                                                     01430031
014400          INCLUDE TPOPRPK                                         01440031
014500     END-EXEC.                                                    01450031
014600******************************************************************01460031
014700*  DB2 TABLE DECLARATION - TUPCSKU                                01470031
014800******************************************************************01480031
014900     EXEC SQL                                                     01490031
015000          INCLUDE TUPCSKU                                         01500031
015100     END-EXEC.                                                    01510031
015200******************************************************************01520031
015300*  DB2 TABLE DECLARATION - EXTERNAL ENTITY TABLE (TSKXREF)        01530031
015400******************************************************************01540031
015500     EXEC SQL                                                     01550031
015600          INCLUDE TSKXREF                                         01560031
015700     END-EXEC.                                                    01570031
015800******************************************************************01580031
015900*  DB2 TABLE DECLARATION - TEXTENT                                01590031
016000******************************************************************01600031
016100     EXEC SQL                                                     01610031
016200          INCLUDE TEXTENT                                         01620031
016300     END-EXEC.                                                    01630031
016400******************************************************************01640031
016500*  DB2 TABLE DECLARATION                                          01650031
016600******************************************************************01660031
016700     EXEC SQL                                                     01670031
016800          INCLUDE TTRDPRT                                         01680031
016900     END-EXEC.                                                    01690031
017000******************************************************************01700031
017100*  DB2 TABLE DECLARATION                                          01710031
017200******************************************************************01720031
017300     EXEC SQL                                                     01730031
017400          INCLUDE TIMCNTL                                         01740031
017500     END-EXEC.                                                    01750031
017600******************************************************************01760031
017700*  DB2 TABLE DECLARATION - TRT_IMPRT_PRTNRFIL                     01770031
017800******************************************************************01780031
017900     EXEC SQL                                                     01790031
018000          INCLUDE TRT00004                                        01800031
018100     END-EXEC.                                                    01810031
018200******************************************************************01820031
018300*  DB2 TABLE DECLARATION - TRT_IMPRT_FILTRKNG                     01830031
018400******************************************************************01840031
018500     EXEC SQL                                                     01850031
018600          INCLUDE TRT00005                                        01860031
018700     END-EXEC.                                                    01870031
018800******************************************************************01880031
018900*  DB2 TABLE DECLARATION - TRTW_CONTNR_LOD                        01890031
019000******************************************************************01900031
019100     EXEC SQL                                                     01910031
019200          INCLUDE TRT00012                                        01920031
019300     END-EXEC.                                                    01930031
019400******************************************************************01940031
019500*  DB2 TABLE DECLARATION - SNT_DAT_CNTL                           01950031
019600******************************************************************01960031
019700     EXEC SQL                                                     01970031
019800          INCLUDE SNT00000                                        01980031
019900     END-EXEC.                                                    01990031
020000******************************************************************02000031
020100*  DB2 TABLE DECLARATION - SNT_DAT_XFER                           02010031
020200******************************************************************02020031
020300     EXEC SQL                                                     02030031
020400          INCLUDE SNT00001                                        02040031
020500     END-EXEC.                                                    02050031
020600******************************************************************02060031
020700*  DB2 TABLE DECLARATION                                          02070031
020800******************************************************************02080031
020900     EXEC SQL                                                     02090031
021000          INCLUDE XLT00003                                        02100031
021100     END-EXEC.                                                    02110031
021200******************************************************************02120031
021300*  DB2 TABLE DECLARATION                                          02130031
021400******************************************************************02140031
021500     EXEC SQL                                                     02150031
021600          INCLUDE XLT00006                                        02160031
021700     END-EXEC.                                                    02170031
021800******************************************************************02180031
021900*  DB2 TABLE DECLARATION                                          02190031
022000******************************************************************02200031
022100     EXEC SQL                                                     02210031
022200          INCLUDE XLT00008                                        02220031
022300     END-EXEC.                                                    02230031
022400******************************************************************02240031
022500*  DB2 TABLE DECLARATION                                          02250031
022600******************************************************************02260031
022700     EXEC SQL                                                     02270031
022800          INCLUDE XLT00009                                        02280031
022900     END-EXEC.                                                    02290031
023000 EJECT                                                            02300031
023100******************************************************************02310031
023200*  CONTAINER REPORT RECORD LAYOUT - EXTRACT FOR THE DETAIL AND   *02320031
023300*  ERROR REPORTS. THIS ERROR FILE WILL BE SORTED WITH THE ERRORS *02330031
023400*  FROM TRKUP215 LOAD PROGRAM TO PRODUCE THE ERROR REPORT FOR A  *02340031
023500*  PARTICULAR RUN. ONLY RECORDS WHICH PASS THE PRELIMINARY EDITS *02350031
023600*  OF THIS PROGRAM WILL BE PASSED TO THE LOAD PROGRAM TRKUP215.  *02360031
023700******************************************************************02370031
023800     COPY TRRD211.                                                02380031
023900 EJECT                                                            02390031
024000***************************************************************** 02400031
024100* CURSOR TO SELECT ALL PACK AND ITEM DATA FROM WORK TABLE         02410031
024200***************************************************************** 02420031
024300     EXEC SQL                                                     02430031
024400          DECLARE ITEM-PACK-CSR CURSOR WITH HOLD FOR              02440031
024500           SELECT   UPC_NBR                                       02450031
024600                   ,SSCC_ID                                       02460031
024700                   ,ASN_PKGNG_CDE                                 02470031
024800                   ,UNT_QTY                                       02480031
024900                   ,UPC_CBMT_QTY                                  02490031
025000                   ,UPC_WT_KGRM_QTY                               02500031
025100           FROM     TRTW_CONTNR_LOD                               02510031
025200           ORDER BY UPC_NBR                                       02520031
025300                   ,SSCC_ID                                       02530031
025400                   ,ASN_PKGNG_CDE                                 02540031
025500                   ,UNT_QTY                                       02550031
025600                   ,UPC_CBMT_QTY                                  02560031
025700                   ,UPC_WT_KGRM_QTY                               02570031
025800     END-EXEC.                                                    02580031
025900                                                                  02590031
026000***************************************************************** 02600031
026100* CURSOR TO SELECT ENT ID FOR ISA CONTROL NUMBER                  02610031
026200***************************************************************** 02620031
026300     EXEC SQL                                                     02630031
026400          DECLARE ENT-ID-CSR CURSOR WITH HOLD FOR                 02640031
026500           SELECT   DISTINCT                                      02650031
026600                    A.ENT_ID                                      02660031
026700           FROM     TENTNME A                                     02670031
026800                   ,TTRDPRT B                                     02680031
026900           WHERE    A.ENT_ID             = B.ENT_ID               02690031
027000             AND    A.TYPE_CDE           = '01'                   02700031
027100             AND    B.INACTV_DTE         = '9999-09-09'           02710031
027200             AND    B.VEND_INCHG_ID      = :TR063-ISA-ID          02720031
027300             AND    B.VEND_INCHG_ID_DESC = :TR063-ISA-ID-QUAL     02730031
027400                                                                  02740031
027500     END-EXEC.                                                    02750031
027600                                                                  02760031
027700 01  ABEND-CODE                      PIC S9(04)    VALUE +0       02770031
027800                                                   COMP SYNC.     02780031
027900 01  PA-PROGRAM-ACCUMULATORS.                                     02790031
028000     05  PA-TOTALS.                                               02800031
028100         10 PA-INPUT-COUNT            PIC  S9(13)  VALUE +0       02810031
028200                                                     COMP-3.      02820031
028300         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0       02830031
028400                                                     COMP-3.      02840031
028500         10 PA-PREV-TOTAL-ERROR-COUNT PIC  S9(13)  VALUE +0       02850031
028600                                                     COMP-3.      02860031
028700         10 PA-TOTAL-UPDATE           PIC  S9(13)  VALUE +0       02870031
028800                                                     COMP-3.      02880031
028900         10 PA-PREV-TOTAL-UPDATE      PIC  S9(13)  VALUE +0       02890031
029000                                                     COMP-3.      02900031
029100         10 PA-TOTAL-UPDATE-ISA       PIC  S9(13)  VALUE +0       02910031
029200                                                     COMP-3.      02920031
029300         10 PA-TOTAL-UPDATE-CNTR      PIC  S9(13)  VALUE +0       02930031
029400                                                     COMP-3.      02940031
029500         10 PA-TOTAL-UPDATE-CONPO     PIC  S9(13)  VALUE +0       02950031
029600                                                     COMP-3.      02960031
029700         10 PA-TOTAL-UPDATE-CONUPC    PIC  S9(13)  VALUE +0       02970031
029800                                                     COMP-3.      02980031
029900         10 PA-TOTAL-UPDATE-CNCART    PIC  S9(13)  VALUE +0       02990031
030000                                                     COMP-3.      03000031
030100         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0       03010031
030200                                                     COMP-3.      03020031
030300         10 PA-SSCC-SPACE-CNT         PIC  S9(04)  VALUE +0       03030031
030400                                                     COMP SYNC.   03040031
030500                                                                  03050031
030600 01  PS-PROGRAM-SWITCHES.                                         03060031
030700     05  PS-END-OF-ASN-SW              PIC  X(01)    VALUE 'N'.   03070031
030800         88  PS-END-OF-ASN                           VALUE 'Y'.   03080031
030900         88  PS-END-OF-ASN-NO                        VALUE 'N'.   03090031
031000     05  PS-BYPASS-IN-PROCESS-SW       PIC  X(01)    VALUE 'N'.   03100031
031100         88  PS-BYPASS-IN-PROCESS                    VALUE 'Y'.   03110031
031200         88  PS-BYPASS-IN-PROCESS-NO                 VALUE 'N'.   03120031
031300     05  PS-BYPASS-TO-NEXT-SW          PIC  X(03)    VALUE SPACES.03130031
031400         88  PS-BYPASS-TO-NEXT-ID                    VALUE 'ID '. 03140031
031500         88  PS-BYPASS-TO-NEXT-PRF                   VALUE 'PRF'. 03150031
031600         88  PS-BYPASS-TO-NEXT-MAN                   VALUE 'MAN'. 03160031
031700     05  PS-DATA-IN-ERROR-SW           PIC  X(01)    VALUE 'N'.   03170031
031800         88  PS-DATA-IN-ERROR                        VALUE 'Y'.   03180031
031900         88  PS-DATA-IN-ERROR-NO                     VALUE 'N'.   03190031
032000     05  PS-UPC-NBR-FOUND-SW           PIC  X(01)    VALUE 'N'.   03200031
032100         88  PS-UPC-NBR-FOUND                        VALUE 'Y'.   03210031
032200         88  PS-UPC-NBR-FOUND-NO                     VALUE 'N'.   03220031
032300     05  PS-PK-SKU-NBR-FOUND-SW        PIC  X(01)    VALUE 'N'.   03230031
032400         88  PS-PK-SKU-NBR-FOUND                     VALUE 'Y'.   03240031
032500         88  PS-PK-SKU-NBR-FOUND-NO                  VALUE 'N'.   03250031
032600     05  PS-PK-SKU-NOMATCH-SW          PIC  X(01)    VALUE 'N'.   03260031
032700         88  PS-PK-SKU-NOMATCH                       VALUE 'Y'.   03270031
032800         88  PS-PK-SKU-NOMATCH-NO                    VALUE 'N'.   03280031
032900     05  PS-CARTON-DATA-MISSING-SW     PIC  X(01)    VALUE 'N'.   03290031
033000         88  PS-CARTON-DATA-MISSING                  VALUE 'Y'.   03300031
033100         88  PS-CARTON-DATA-MISSING-NO               VALUE 'N'.   03310031
033200     05  PS-END-OF-ITEM-PACK-CSR-SW    PIC  X(01)    VALUE 'N'.   03320031
033300         88  PS-END-OF-ITEM-PACK-CSR                 VALUE 'Y'.   03330031
033400         88  PS-END-OF-ITEM-PACK-CSR-NO              VALUE 'N'.   03340031
033500     05  PS-END-OF-ENT-ID-SEARCH-SW    PIC  X(01)    VALUE 'N'.   03350031
033600         88  PS-END-OF-ENT-ID-SEARCH                 VALUE 'Y'.   03360031
033700         88  PS-END-OF-ENT-ID-SEARCH-NO              VALUE 'N'.   03370031
033800     05  PS-END-ID-SEGMTS-SW           PIC  X(01)    VALUE 'N'.   03380031
033900         88  PS-END-ID-SEGMTS                        VALUE 'Y'.   03390031
034000         88  PS-END-ID-SEGMTS-NO                     VALUE 'N'.   03400031
034100     05  PS-END-OF-PRF-PO-NBR-SW       PIC  X(01)    VALUE 'N'.   03410031
034200         88  PS-END-OF-PRF-PO-NBR                    VALUE 'Y'.   03420031
034300         88  PS-END-OF-PRF-PO-NBR-NO                 VALUE 'N'.   03430031
034400     05  PS-END-OF-LIN-UPC-NBR-SW       PIC  X(01)   VALUE 'N'.   03440031
034500         88  PS-END-OF-LIN-UPC-NBR                   VALUE 'Y'.   03450031
034600         88  PS-END-OF-LIN-UPC-NBR-NO                VALUE 'N'.   03460031
034700     05  PS-END-OF-MAN-NBR-SW       PIC  X(01)       VALUE 'N'.   03470031
034800         88  PS-END-OF-MAN-NBR                       VALUE 'Y'.   03480031
034900         88  PS-END-OF-MAN-NBR-NO                    VALUE 'N'.   03490031
035000     05  PS-WRITE-TO-EXCEPTION-FILE-SW PIC  X(01)    VALUE 'N'.   03500031
035100         88  PS-WRITE-TO-EXCEPTION-FILE              VALUE 'Y'.   03510031
035200         88  PS-WRITE-TO-EXCEPTION-FILE-NO           VALUE 'N'.   03520031
035300     05  PS-WRITE-ISA-REC-SW           PIC  X(01)    VALUE 'N'.   03530031
035400         88  PS-WRITE-ISA-REC                        VALUE 'Y'.   03540031
035500         88  PS-WRITE-ISA-REC-NO                     VALUE 'N'.   03550031
035600     05  PS-MTHD-AIR-LANDED-SW         PIC  X(01)    VALUE SPACE. 03560031
035700         88  PS-MTHD-AIR                             VALUE 'A'.   03570031
035800         88  PS-MTHD-LANDED                          VALUE 'L'.   03580031
035900     05  PS-PO-MATCH-SW                PIC  X(01)    VALUE 'N'.   03590031
036000         88  PS-PO-MATCH-FOUND                       VALUE 'Y'.   03600031
036100         88  PS-PO-NO-MATCH-FOUND                    VALUE 'N'.   03610031
036200     05  PS-FIRST-PRF-SW               PIC  X(01)    VALUE 'N'.   03620031
036300         88  PS-FIRST-PRF                            VALUE 'Y'.   03630031
036400         88  PS-FIRST-PRF-NO                         VALUE 'N'.   03640031
036500     05  PS-FIRST-PRF-XFER-SW          PIC  X(01)    VALUE 'N'.   03650031
036600         88  PS-FIRST-PRF-XFER                       VALUE 'Y'.   03660031
036700         88  PS-FIRST-PRF-XFER-NO                    VALUE 'N'.   03670031
036800     05  PS-FIRST-LIN-XFER-SW          PIC  X(01)    VALUE 'N'.   03680031
036900         88  PS-FIRST-LIN-XFER                       VALUE 'Y'.   03690031
037000         88  PS-FIRST-LIN-XFER-NO                    VALUE 'N'.   03700031
037100     05  PS-FIRST-LIN-SW               PIC  X(01)    VALUE 'N'.   03710031
037200         88  PS-FIRST-LIN                            VALUE 'Y'.   03720031
037300         88  PS-FIRST-LIN-NO                         VALUE 'N'.   03730031
037400     05  PS-LIN-FOUND-SW               PIC  X(01)    VALUE 'N'.   03740031
037500         88  PS-LIN-FOUND                            VALUE 'Y'.   03750031
037600         88  PS-LIN-FOUND-NO                         VALUE 'N'.   03760031
037700     05  PS-MAN-FOUND-SW               PIC  X(01)    VALUE 'N'.   03770031
037800         88  PS-MAN-FOUND                            VALUE 'Y'.   03780031
037900         88  PS-MAN-FOUND-NO                         VALUE 'N'.   03790031
038000     05  PS-BYPASS-HL-P-O-ID-SW        PIC  X(01)    VALUE 'N'.   03800031
038100         88  PS-BYPASS-HL-P-O-ID                     VALUE 'Y'.   03810031
038200         88  PS-BYPASS-HL-P-O-ID-NO                  VALUE 'N'.   03820031
038300     05  PS-COMP-ERROR-SW              PIC  X(01)    VALUE 'N'.   03830031
038400         88  PS-COMP-ERROR                           VALUE 'Y'.   03840031
038500         88  PS-COMP-ERROR-NO                        VALUE 'N'.   03850031
038600     05  PS-END-PREP-PRF-XFER-SW       PIC  X(01)    VALUE 'N'.   03860031
038700         88  PS-END-PREP-PRF-XFER                    VALUE 'Y'.   03870031
038800         88  PS-END-PREP-PRF-XFER-NO                 VALUE 'N'.   03880031
038900     05  PS-END-OF-SEARCH-SW           PIC  X(01)    VALUE 'N'.   03890031
039000         88  PS-END-OF-SEARCH                        VALUE 'Y'.   03900031
039100         88  PS-END-OF-SEARCH-NO                     VALUE 'N'.   03910031
039200     05  PS-INNER-PACK-FND-SW          PIC  X(01)    VALUE 'N'.   03920031
039300         88  PS-INNER-PACK-FND                       VALUE 'Y'.   03930031
039400         88  PS-INNER-PACK-FND-NO                    VALUE 'N'.   03940031
039500     05  PS-PRF-PO-NBR-CSR-OPEN-SW     PIC  X(01)    VALUE 'N'.   03950031
039600         88  PS-PRF-PO-NBR-CSR-OPEN                  VALUE 'Y'.   03960031
039700         88  PS-PRF-PO-NBR-CSR-OPEN-NO               VALUE 'N'.   03970031
039800*CHG0166764-START                                                 03980031
039900     05  PS-EXCEPTION-WRITTEN-SW       PIC  X(01)    VALUE 'N'.   03990031
040000         88  PS-EXCEPTION-WRITTEN                    VALUE 'Y'.   04000031
040100         88  PS-EXCEPTION-WRITTEN-NO                 VALUE 'N'.   04010031
040200*CHG0166764-END                                                   04020031
040300                                                                  04030031
040400 01  PC-PROGRAM-CONSTANTS.                                        04040031
040500     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE          04050031
040600         'TRKUP212'.                                              04060031
040700     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE          04070031
040800                                     '9999-09-09-00.00.00.000000'.04080031
040900     05  PC-DEFAULT-TMST             PIC X(26)     VALUE          04090031
041000                                     '0001-01-01-00.00.00.000000'.04100031
041100     05  PC-DEFAULT-DATE             PIC X(10)     VALUE          04110031
041200                                     '0001-01-01'.                04120031
041300     05  PC-DEFAULT-TIME             PIC X(04)     VALUE  '0000'. 04130031
041400     05  PC-DEFAULT-DTE-NO-DASHES    PIC X(08)     VALUE          04140031
041500                                     '00010101'.                  04150031
041600     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.     04160031
041700     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.     04170031
041800     05  PC-A                        PIC X(01)     VALUE 'A'.     04180031
041900     05  PC-C                        PIC X(01)     VALUE 'C'.     04190031
042000     05  PC-D                        PIC X(01)     VALUE 'D'.     04200031
042100     05  PC-I                        PIC X(01)     VALUE 'I'.     04210031
042200     05  PC-M                        PIC X(01)     VALUE 'M'.     04220031
042300     05  PC-O                        PIC X(01)     VALUE 'O'.     04230031
042400     05  PC-S                        PIC X(01)     VALUE 'S'.     04240031
042500     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.   04250031
042600     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.   04260031
042700     05  PC-NO-PACK-UPC-FOUND        PIC X(45)     VALUE          04270031
042800             'NO PACK UPC FOUND FOR PACK PO ON KOHLS SYSTEM'.     04280031
042900     05  PC-NO-COMP-UPC-FOUND        PIC X(45)     VALUE          04290031
043000             'NO COMP UPC FOUND FOR PACK PO ON KOHLS SYSTEM'.     04300031
043100     05  PC-NO-PACK-COMP-ON-ASN      PIC X(50)     VALUE          04310031
043200        'PCK COMPONENTS NOT ON ASN TBLE-CONTACT PROGRAMMING'.     04320031
043300     05  PC-NO-COMP-RATIO-ON-ASN     PIC X(41)     VALUE          04330031
043400        'NO COMPONENT UPC RATIO FOUND ON ASN TABLE'.              04340031
043500     05  PC-NO-COMP-ON-UPC-TBL       PIC X(49)     VALUE          04350031
043600        'CMPNT UPC NT ON KHL LGSTICS UPC TBL-CNTACT VENDOR'.      04360031
043700     05  PC-NO-COMP-ON-SKU-TBL       PIC X(49)     VALUE          04370031
043800        'CMPNT SKU NT ON KHL LGSTICS SKU TBL-CNTACT VENDOR'.      04380031
043900     05  PC-COMP-SENT-NE-KOHLS-CNT   PIC X(47)     VALUE          04390031
044000        'NBR OF COMPONENT UPCS FOR PACK NOT=KOHLS SYSTEM'.        04400031
044100                                                                  04410031
044200 01 PV-PROGRAM-VARIABLES.                                         04420031
044300     05  PV-PARAGRAPH-NAME           PIC X(30)     VALUE SPACES.  04430031
044400     05  PV-DB2-OPERATION-MESSAGE    PIC X(79)     VALUE SPACES.  04440031
044500     05  PV-DB2-TABLE-NAME-1         PIC X(18)     VALUE SPACES.  04450031
044600     05  PV-DB2-TABLE-NAME-2         PIC X(18)     VALUE SPACES.  04460031
044700     05  PV-DB2-TABLE-NAME-3         PIC X(18)     VALUE SPACES.  04470031
044800*CHG100672 - START                                                04480031
044900*    05  PV-COUNTER                  PIC S9(04)    VALUE +0       04490031
045000     05  PV-COUNTER                  PIC S9(09)    VALUE +0       04500031
045100                                                      COMP SYNC.  04510031
045200*CHG100672 - END                                                  04520031
045300     05  PV-TRIM-SPACE               PIC S9(04)    VALUE +0       04530031
045400                                                      COMP SYNC.  04540031
045500     05  WS-NUMERIC-4                PIC  S9(7)    VALUE 0.       04550031
045600     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0 COMP. 04560031
045700     05  PV-PREV-HL03-LVL-CDE        PIC X(2)      VALUE SPACES.  04570031
045800     05  PV-PREV-ISA-ID              PIC X(15)     VALUE SPACES.  04580031
045900     05  PV-HOLD-ISA-ID              PIC X(15)     VALUE SPACES.  04590031
046000     05  PV-RECORD-LEVEL-CDE         PIC X(2).                    04600031
046100         88  PV-ID-LEVEL                           VALUE 'ID'.    04610031
046200         88  PV-SHIPMENT-LEVEL                     VALUE 'S '.    04620031
046300         88  PV-ORDER-LEVEL                        VALUE 'O '.    04630031
046400         88  PV-PACK-LEVEL                         VALUE 'P '.    04640031
046500         88  PV-ITEM-LEVEL                         VALUE 'I '.    04650031
046600     05  PV-PREV-RECORD-LEVEL-CDE    PIC X(2).                    04660031
046700         88  PV-PREV-ID-LEVEL                      VALUE 'ID'.    04670031
046800         88  PV-PREV-SHIPMENT-LEVEL                VALUE 'S '.    04680031
046900         88  PV-PREV-ORDER-LEVEL                   VALUE 'O '.    04690031
047000         88  PV-PREV-PACK-LEVEL                    VALUE 'P '.    04700031
047100         88  PV-PREV-ITEM-LEVEL                    VALUE 'I '.    04710031
047200     05  PV-ASN-STRUCTURE            PIC X(4).                    04720031
047300         88  PV-ASN-PICK-N-PACK                    VALUE '0001'.  04730031
047400         88  PV-ASN-STANDARD-CARTON                VALUE '0002'.  04740031
047500         88  PV-ASN-STANDARD-NO-CARTON             VALUE '0004'.  04750031
047600     05  PV-PCK-COMP-ONLY-SW         PIC X(1)      VALUE 'N'.     04760031
047700         88  PV-PCK-COMP-ONLY                      VALUE 'Y'.     04770031
047800         88  PV-PCK-COMP-ONLY-NO                   VALUE 'N'.     04780031
047900     05  PV-FOUND-POPRPK-ROW-SW      PIC X(1)      VALUE 'N'.     04790031
048000         88  PV-FOUND-POPRPK-ROW                   VALUE 'Y'.     04800031
048100         88  PV-FOUND-POPRPK-ROW-NO                VALUE 'N'.     04810031
048200     05  PV-FOUND-POPRPK-UPC-SW      PIC X(1)      VALUE 'N'.     04820031
048300         88  PV-FOUND-POPRPK-UPC                   VALUE 'Y'.     04830031
048400         88  PV-FOUND-POPRPK-UPC-NO                VALUE 'N'.     04840031
048500     05  PV-PCK-WITH-COMP-SW         PIC X(1)      VALUE 'N'.     04850031
048600         88  PV-PCK-WITH-COMP                      VALUE 'Y'.     04860031
048700         88  PV-PCK-WITH-COMP-NO                   VALUE 'N'.     04870031
048800     05  PV-TOTAL-SLN04-QTY          PIC S9(7)     VALUE ZEROES   04880031
048900                                                   COMP-3.        04890031
049000     05  PV-HOLD-REC-TYP-CNTR        PIC X(400)    VALUE SPACES.  04900031
049100     05  PV-HOLD-REC-TYP-CONPO       PIC X(400)    VALUE SPACES.  04910031
049200     05  PV-HOLD-REC-TYP-CONUPC      PIC X(400)    VALUE SPACES.  04920031
049300     05  PV-HOLD-ISA-REC.                                         04930031
049400         10  FILLER                  PIC X(03)     VALUE 'ISA'.   04940031
049500         10  FILLER                  PIC X(147)    VALUE SPACES.  04950031
049600         10  PV-HOLD-ISA-FILE-ID     PIC X(09)     VALUE SPACES.  04960031
049700         10  PV-HOLD-ISA-ENT-ID      PIC 9(09)     VALUE ZEROES.  04970031
049800         10  FILLER                  PIC X(145)    VALUE SPACES.  04980031
049900         10  PV-HOLD-ISA-FILE-ID-1   PIC X(09)     VALUE SPACES.  04990031
050000         10  PV-HOLD-ISA-ENT-ID-1    PIC 9(09)     VALUE ZEROES.  05000031
050100         10  PV-HOLD-ISA-SEQ-NBR     PIC 9(06)     VALUE ZEROES.  05010031
050200         10  FILLER                  PIC X(64)     VALUE SPACES.  05020031
050300     05  PV-HOLD-TRN-TYP             PIC X(1)      VALUE SPACES.  05030031
050400     05  PV-HOLD-ISA-CNTL-NBR        PIC X(9)      VALUE SPACES.  05040031
050500     05  PV-HOLD-FILE-ID             PIC 9(9)      VALUE ZEROES.  05050031
050600     05  PV-HOLD-SHIPT-ID            PIC X(30)     VALUE SPACES.  05060031
050700     05  PV-HOLD-CONTNR-ID           PIC X(12)     VALUE SPACES.  05070031
050800     05  PV-HOLD-PO-NBR              PIC X(9)      VALUE SPACES.  05080031
050900     05  PV-HOLD-ACTL-DPRTR-DTE      PIC X(8)      VALUE SPACES.  05090031
051000     05  PV-HOLD-ACTL-DPRTR-TM       PIC X(4)      VALUE SPACES.  05100031
051100     05  PV-HOLD-DAT-SRC-ENT-ID      PIC 9(09)     VALUE ZEROES.  05110031
051200     05  PV-HOLD-HEADER-ENT-ID       PIC 9(09)     VALUE ZEROES.  05120031
051300     05  PV-HOLD-LOAD-DTE            PIC X(08)     VALUE SPACE.   05130031
051400     05  PV-HOLD-LOAD-TM             PIC X(04)     VALUE ZEROES.  05140031
051500     05  PV-HOLD-EXTL-REF-EXTENSION  PIC X(9)      VALUE SPACES.  05150031
051600     05  PV-HOLD-ERROR-TRANS-CDE     PIC X(2)      VALUE SPACES.  05160031
051700     05  PV-UPC-NBR-NON-NUMERIC      PIC X(15)     VALUE SPACES.  05170031
051800     05  PV-UPC-NBR-DISPLAY          PIC X(15)     VALUE SPACES.  05180031
051900     05  PV-SKU-NBR-DISPLAY          PIC X(15)     VALUE SPACES.  05190031
051910     05  PV-COUNT-DISPLAY            PIC ZZZ,ZZZ,ZZZ,ZZ9.         05191036
052000     05  PV-PREV-UPC-NBR-PACK        PIC 9(15)     VALUE ZEROES.  05200031
052100     05  PV-PREV-UPC-NBR-ITEM        PIC 9(15)     VALUE ZEROES.  05210031
052200     05  PV-UPC-SPACE-CNT            PIC S9(04)    VALUE +0       05220031
052300                                                      COMP SYNC.  05230031
052400     05 PV-CURRENT-TMST              PIC X(26)     VALUE SPACES.  05240031
052500     05 PV-TOTAL-CONUPC-UNT-QTY      PIC 9(09)     VALUE ZEROES.  05250031
052600     05 PV-TOTAL-CONUPC-CART-CNT     PIC 9(09)     VALUE ZEROES.  05260031
052700     05 PV-TOTAL-CONUPC-CBMT-QTY     PIC 9(09)V99  VALUE ZEROES.  05270031
052800     05 PV-TOTAL-CONUPC-KGRM-QTY     PIC 9(09)     VALUE ZEROES.  05280031
052900     05 PV-TOTAL-CONPO-UNT-QTY       PIC 9(09)     VALUE ZEROES.  05290031
053000     05 PV-TOTAL-CONPO-CART-CNT      PIC 9(09)     VALUE ZEROES.  05300031
053100     05 PV-TOTAL-CONPO-CBMT-QTY      PIC 9(09)V99  VALUE ZEROES.  05310031
053200     05 PV-TOTAL-CONPO-KGRM-QTY      PIC 9(09)     VALUE ZEROES.  05320031
053300     05 PV-TOTAL-CNTR-UNT-QTY        PIC 9(09)     VALUE ZEROES.  05330031
053400     05 PV-TOTAL-CNTR-CART-CNT       PIC 9(09)     VALUE ZEROES.  05340031
053500     05 PV-TOTAL-CNTR-CBMT-QTY       PIC 9(09)V99  VALUE ZEROES.  05350031
053600     05 PV-TOTAL-CNTR-KGRM-QTY       PIC 9(09)     VALUE ZEROES.  05360031
053700* THESE 2 FIELDS WERE ADDED TO STORE THE TOTALS FROM THE TD1      05370031
053800* SEGMENTS AT SHIPMENT LEVEL - VENDORS DO NOT CURRENTLY SEND      05380031
053900* TD1 SEGMENTS AT ITEM-LEVEL                                      05390031
054000     05 PV-SHIPM-CNTR-CBMT-QTY       PIC 9(09)V99 VALUE ZEROES.   05400031
054100     05 PV-SHIPM-CNTR-KGRM-QTY       PIC 9(09) VALUE ZEROES.      05410031
054200     05 PV-REFORMAT-TMST-DTE.                                     05420031
054300        10  PV-REFORMAT-TMST-DTE-CY  PIC X(04)     VALUE SPACES.  05430031
054400        10  PV-REFORMAT-TMST-DTE-MM  PIC X(02)     VALUE SPACES.  05440031
054500        10  PV-REFORMAT-TMST-DTE-DD  PIC X(02)     VALUE SPACES.  05450031
054600     05 PV-REFORMAT-TMST-TM.                                      05460031
054700        10  PV-REFORMAT-TMST-TM-HH   PIC X(02)     VALUE SPACES.  05470031
054800        10  PV-REFORMAT-TMST-TM-MM   PIC X(02)     VALUE SPACES.  05480031
054900     05 PV-QUANTITY-UNIT-VALUES.                                  05490031
055000        10  PV-QUANTITY-VALUE            PIC ZZZZZZZZ9            05500031
055100                                                    VALUE ZEROES. 05510031
055200        10  FILLER                       PIC X(02)  VALUE ' /'.   05520031
055300        10  PV-UNIT-VALUE                PIC ZZZZZZZZ9            05530031
055400                                             VALUE ZEROES.        05540031
055500     05 PV-PURCHS-PO-NBR                 PIC X(9) VALUE SPACES.   05550031
055600*TV 12/15/2014 CHANGE STARTS                                      05560031
055700     05 PV-SHORT-PO-NBR-ALPHA            PIC X(8) VALUE SPACES.   05570031
055800     05 PV-SHORT-PO-NBR-ALPHA-N REDEFINES                         05580031
055900        PV-SHORT-PO-NBR-ALPHA            PIC 9(8).                05590031
056000     05 PV-PURCHS-PO-NBR-S               PIC S9(9) COMP.          05600031
056100     05 PV-PURCHS-PO-NBR-N               PIC 9(9) VALUE ZEROES.   05610031
056200*TV 12/15/2014 CHANGE ENDS                                        05620031
056300     05 PV-PREP-PO-NBR                   PIC 9(9) VALUE ZEROES.   05630031
056400     05 PV-CONPO-PO-NBR                  PIC 9(9).                05640031
056500                                                                  05650031
056600     05 PV-CURR-SEQ-NBR                  PIC S9(9) COMP VALUE 0.  05660031
056700     05 PV-NEXT-SEQ-NBR                  PIC S9(9) COMP VALUE 0.  05670031
056800     05 PV-CURR-PRF-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05680031
056900     05 PV-PREV-PRF-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05690031
057000     05 PV-NEXT-PRF-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05700031
057100     05 PV-CURR-LIN-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05710031
057200     05 PV-PREV-LIN-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05720031
057300**** PKE2372 MJF 3/31/11 START                                    05730031
057400***  05 PV-NEXT-LIN-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05740031
057500     05 PV-NEXT-SEQ-AFT-LIN              PIC S9(9) COMP VALUE 0.  05750031
057600**** PKE2372 MJF 3/31/11 END                                      05760031
057700     05 PV-CURR-MAN-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05770031
057800     05 PV-CURR-MN-SEQ-NBR               PIC S9(9) COMP VALUE 0.  05780031
057900     05 PV-PREV-MAN-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05790031
058000     05 PV-NEXT-MAN-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05800031
058100     05 PV-CURR-SN1-SEQ-NBR              PIC S9(9) COMP VALUE 0.  05810031
058200     05 PV-LIN-SEQ-NBR                   PIC S9(9) COMP VALUE 0.  05820031
058300     05 PV-MAN-SEQ-NBR                   PIC S9(9) COMP VALUE 0.  05830031
058400     05 PV-DAT-XFER-CNTL-ID              PIC S9(9) COMP VALUE 0.  05840031
058500     05 PV-LIN-UPC-NBR                   PIC 9(15) COMP-3.        05850031
058600     05 PV-DAT-UPC-NBR-X                 PIC X(16).               05860031
058700     05 PV-DAT-UPC-NBR REDEFINES PV-DAT-UPC-NBR-X   PIC 9(16).    05870031
058800     05 PV-SN1-RATIO-PCKED-X             PIC X(7).                05880031
058900     05 PV-SN1-RATIO-PCKED REDEFINES PV-SN1-RATIO-PCKED-X         05890031
059000                                         PIC 9(7).                05900031
059100     05 PV-LIN-SKU                       PIC S9(8)V COMP-3.       05910031
059200     05 PV-LIN-SKU-DISPLAY               PIC S9(8).               05920031
059300     05 PV-CURR-PK-SKU                   PIC S9(8).               05930031
059400     05 PV-PREV-PK-SKU                   PIC S9(8).               05940031
059500     05 PV-LIN-INDEX                     PIC S9(8) COMP VALUE 0.  05950031
059600     05 PV-CPT-SKU-NBR-COUNT             PIC S9(8) COMP VALUE 0.  05960031
059700     05 PV-SN1-SHIP-UM-CDE               PIC X(2) VALUE SPACES.   05970031
059800     05 PV-SN1-SHIP-QTY                  PIC S9(4) COMP VALUE 0.  05980031
059900     05 PV-SN1-TOTAL-SHIP-QTY            PIC S9(8) COMP VALUE 0.  05990031
060000                                                                  06000031
060100     05 PV-WORK-CONTAINER.                                        06010031
060200        10 PV-TD302-EQUIP-INIT-CDE       PIC X(4).                06020031
060300        10 PV-TD303-EQUIP-NBR            PIC X(10).               06030031
060400     05 PV-MV-START                      PIC S9(04)  VALUE +0     06040031
060500                                                     COMP SYNC.   06050031
060600 01  PV-PRF-INFO-TABLE.                                           06060031
060700     05  PV-PRF-INFO-TABLE-ENTRIES OCCURS 20000 TIMES             06070031
060800                                INDEXED BY PO-INDX.               06080031
060900         10  PV-DAT-XFER-CNTL-ID-PREP PIC 9(09).                  06090031
061000         10  PV-PRC-LOD-SEQ-NBR-PREP  PIC 9(09).                  06100031
061100         10  PV-DAT-CTG-CDE-PREP      PIC X(03).                  06110031
061200         10  PV-PO-NBR-COMP-ONLY-PREP PIC 9(09).                  06120031
061300                                                                  06130031
061400***************************************************************** 06140031
061500* CURSOR TO SELECT ALL PRF SEGM SEQUENCE NUMBERS FOR ONE ASN      06150031
061600* ON SNT_DAT_TXT (THE SEQUECNE NO. FOR EACH PO LINE)              06160031
061700***************************************************************** 06170031
061800     EXEC SQL                                                     06180031
061900       DECLARE PRF-PO-NBR-CSR CURSOR FOR                          06190031
062000        SELECT DAT_XFER_CNTL_ID                                   06200031
062100             , PRC_LOD_SEQ_NBR                                    06210031
062200             , DAT_CTG_CDE                                        06220031
062300             , SUBSTR(LOD_DAT_TXT,4,9)                            06230031
062400          FROM SNT_DAT_XFER                                       06240031
062500         WHERE DAT_XFER_CNTL_ID = :SNT00001-DAT-XFER-CNTL-ID      06250031
062600           AND DAT_CTG_CDE      = 'PRF'                           06260031
062700           AND PRC_LOD_SEQ_NBR  > :PV-CURR-PRF-SEQ-NBR            06270031
062800     END-EXEC.                                                    06280031
062900***************************************************************** 06290031
063000* CURSOR LIN-UPC-NBR-CSR                                          06300031
063100***************************************************************** 06310031
063200     EXEC SQL                                                     06320031
063300      DECLARE LIN-UPC-NBR-CSR CURSOR WITH HOLD FOR                06330031
063400        SELECT PRC_LOD_SEQ_NBR,                                   06340031
063500               LOD_DAT_TXT                                        06350031
063600           FROM SNT_DAT_XFER                                      06360031
063700          WHERE DAT_CTG_CDE = 'LIN'                               06370031
063800           AND DAT_XFER_CNTL_ID = :SNT00001-DAT-XFER-CNTL-ID      06380031
063900           AND PRC_LOD_SEQ_NBR > :PV-CURR-SEQ-NBR                 06390031
064000           AND PRC_LOD_SEQ_NBR <= :PV-NEXT-SEQ-NBR                06400031
064100     END-EXEC                                                     06410031
064200***************************************************************** 06420031
064300* CURSOR MAN-UPC-NBR-CSR                                          06430031
064400***************************************************************** 06440031
064500     EXEC SQL                                                     06450031
064600      DECLARE MAN-UPC-NBR-CSR CURSOR WITH HOLD FOR                06460031
064700        SELECT PRC_LOD_SEQ_NBR                                    06470031
064800           FROM SNT_DAT_XFER                                      06480031
064900          WHERE DAT_CTG_CDE = 'MAN'                               06490031
065000           AND DAT_XFER_CNTL_ID = :SNT00001-DAT-XFER-CNTL-ID      06500031
065100           AND PRC_LOD_SEQ_NBR > :PV-CURR-MN-SEQ-NBR              06510031
065200           AND PRC_LOD_SEQ_NBR <= :PV-NEXT-PRF-SEQ-NBR            06520031
065300*          AND SUBSTR(LOD_DAT_TXT,4,2) = 'GM'                     06530031
065400     END-EXEC                                                     06540031
065500***************************************************************** 06550031
065600                                                                  06560031
065700                                                                  06570031
065800 01  PV-ITEM-PACK-ERROR-TABLE.                                    06580031
065900*CHG100672 - START                                                06590031
066000*    05  PV-ITEM-PACK-ERROR-TABLE-ENTRY OCCURS 20000 TIMES        06600031
066100     05  PV-ITEM-PACK-ERROR-TABLE-ENTRY OCCURS 50000 TIMES        06610031
066200                                        INDEXED BY ERR-INDEX.     06620031
066300*CHG100672 - END                                                  06630031
066400        10  PV-TABLE-ERROR-REC           PIC X(508) VALUE SPACES. 06640031
066500        10  PV-TABLE-ERROR-REC-WRITEN    PIC X(01)  VALUE 'N'.    06650031
066600                                                                  06660031
066700                                                                  06670031
066800 LINKAGE SECTION.                                                 06680031
066900 PROCEDURE DIVISION.                                              06690031
067000******************************************************************06700031
067100*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *06710031
067200******************************************************************06720031
067300 0000-PROGRAM-MAINLINE.                                           06730031
067400*    DISPLAY '0000-PROGRAM-MAINLINE'.                             06740031
067500                                                                  06750031
067600     PERFORM 1000-INITIALIZE.                                     06760031
067700                                                                  06770031
067800     PERFORM 2000-MAIN-LINE-PROCESS                               06780031
067900         UNTIL PS-END-OF-ASN.                                     06790031
068000                                                                  06800031
068100     PERFORM 8000-EOJ-ROUTINE.                                    06810031
068200     STOP RUN.                                                    06820031
068300                                                                  06830031
068400******************************************************************06840031
068500*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *06850031
068600*  JOB PROCESSES.                                                *06860031
068700******************************************************************06870031
068800 1000-INITIALIZE.                                                 06880031
068900*    DISPLAY '1000-INITIALIZE'.                                   06890031
069000                                                                  06900031
069100     OPEN INPUT TR063-ASN-FILE                                    06910031
069200          OUTPUT TR023-UPDATE-CONTAINER-FILE                      06920031
069300                 TR211-CONTAINER-ERROR-FILE                       06930031
069400                 TR063-EXCEPTION-FILE.                            06940031
069500                                                                  06950031
069600*    GET CURRENT TIMESTAMP                                        06960031
069700     PERFORM 1100-SET-CURRENT-TMST.                               06970031
069800                                                                  06980031
069900*    GET EXTENSION TO EXTERNAL REF NUMBER FROM TIMCNTL            06990031
070000     PERFORM 1200-GET-EXTL-REF-EXTENSION                          07000031
070100                                                                  07010031
070200*    PERFORM INITIAL READ                                         07020031
070300     PERFORM 6000-READ-ASN-FILE.                                  07030031
070400                                                                  07040031
070500 EJECT                                                            07050031
070600******************************************************************07060031
070700* SET THE CURRENT TIMESTAMP.                                     *07070031
070800******************************************************************07080031
070900 1100-SET-CURRENT-TMST.                                           07090031
071000*    DISPLAY '1100-SET-CURRENT-TMST'.                             07100031
071100                                                                  07110031
071200          EXEC SQL                                                07120031
071300              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP            07130031
071400          END-EXEC                                                07140031
071500                                                                  07150031
071600         EVALUATE TRUE                                            07160031
071700            WHEN SQLCODE = ZERO                                   07170031
071800               MOVE PV-CURRENT-TMST(1:4)   TO                     07180031
071900                      PV-REFORMAT-TMST-DTE-CY                     07190031
072000               MOVE PV-CURRENT-TMST(6:2)   TO                     07200031
072100                      PV-REFORMAT-TMST-DTE-MM                     07210031
072200               MOVE PV-CURRENT-TMST(9:2)   TO                     07220031
072300                      PV-REFORMAT-TMST-DTE-DD                     07230031
072400               MOVE PV-CURRENT-TMST(12:2)  TO                     07240031
072500                      PV-REFORMAT-TMST-TM-HH                      07250031
072600               MOVE PV-CURRENT-TMST(15:2)  TO                     07260031
072700                      PV-REFORMAT-TMST-TM-MM                      07270031
072800              MOVE PV-REFORMAT-TMST-DTE    TO                     07280031
072900                      PV-HOLD-LOAD-DTE                            07290031
073000              MOVE PV-REFORMAT-TMST-TM     TO                     07300031
073100                      PV-HOLD-LOAD-TM                             07310031
073200                                                                  07320031
073300             WHEN SQLWARN0 NOT EQUAL SPACE                        07330031
073400             WHEN SQLCODE NOT EQUAL ZERO                          07340031
073500                 DISPLAY '**************************************' 07350031
073600                 DISPLAY '** ABEND                            **' 07360031
073700                 DISPLAY '** PROGRAM = TRKUT210               **' 07370031
073800                 DISPLAY '** PARAGRAPH = 6600-SET-CURRENT-TMST**' 07380031
073900                 DISPLAY '** SET CURRENT TIMESTAMP            **' 07390031
074000                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST   07400031
074100                 DISPLAY '**************************************' 07410031
074200                 PERFORM 9100-USER-ABEND                          07420031
074300         END-EVALUATE.                                            07430031
074400                                                                  07440031
074500******************************************************************07450031
074600* GET EXTENSION TO EXTERNAL REF NUMBER FROM TIMCNTL              *07460031
074700******************************************************************07470031
074800 1200-GET-EXTL-REF-EXTENSION.                                     07480031
074900*    DISPLAY '1200-GET-EXTL-REF-EXTENSION.'                       07490031
075000                                                                  07500031
075100          EXEC SQL                                                07510031
075200              SELECT LNDD_XREF_SEQ_NBR                            07520031
075300              INTO :IMCNTL-LNDD-XREF-SEQ-NBR                      07530031
075400              FROM TIMCNTL                                        07540031
075500          END-EXEC                                                07550031
075600                                                                  07560031
075700     EVALUATE TRUE                                                07570031
075800         WHEN SQLCODE = ZERO                                      07580031
075900             CONTINUE                                             07590031
076000         WHEN SQLWARN0 NOT = SPACES                               07600031
076100         WHEN SQLCODE < ZERO                                      07610031
076200         WHEN SQLCODE > ZERO                                      07620031
076300             MOVE '1200-GET-EXTL-REF-EXTENSION'                   07630031
076400                                     TO PV-PARAGRAPH-NAME         07640031
076500             MOVE 'ERROR WHILE DOING SELECT'                      07650031
076600                                     TO PV-DB2-OPERATION-MESSAGE  07660031
076700             MOVE 'TIMCNTL'          TO PV-DB2-TABLE-NAME-1       07670031
076800             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       07680031
076900             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       07690031
077000             PERFORM 9100-USER-ABEND                              07700031
077100     END-EVALUATE.                                                07710031
077200                                                                  07720031
077300******************************************************************07730031
077400* MAIN PROCESSING PARAGRAPH.                                     *07740031
077500******************************************************************07750031
077600 2000-MAIN-LINE-PROCESS.                                          07760031
077700                                                                  07770031
077800*    DISPLAY '2000-MAIN-LINE-PROCESS'.                            07780031
077900*CHG0166764-START                                                 07790031
078000     IF ID-IDENTIFICATION-REC                                     07800031
078100         SET PS-EXCEPTION-WRITTEN-NO TO TRUE                      07810031
078200     END-IF.                                                      07820031
078300*CHG0166764-END                                                   07830031
078400     EVALUATE TRUE                                                07840031
078500                                                                  07850031
078600      WHEN ID-IDENTIFICATION-REC                                  07860031
078700        PERFORM 2700-PROCESS-RECORD-SEQUENCE                      07870031
078800        INITIALIZE TR023-REC-TYP-CNTR                             07880031
078900        EVALUATE TRUE                                             07890031
079000          WHEN TR063-BSN01-TRANS-CDE = '00'                       07900031
079100             MOVE 'A' TO TR023-CNTR-TRN-TYP                       07910031
079200          WHEN TR063-BSN01-TRANS-CDE = '03'                       07920031
079300             MOVE 'D' TO TR023-CNTR-TRN-TYP                       07930031
079400          WHEN TR063-BSN01-TRANS-CDE = '04'                       07940031
079500             MOVE 'C' TO TR023-CNTR-TRN-TYP                       07950031
079600          WHEN OTHER                                              07960031
079700             MOVE TR063-BSN01-TRANS-CDE                           07970031
079800                TO PV-HOLD-ERROR-TRANS-CDE                        07980031
079900        END-EVALUATE                                              07990031
080000                                                                  08000031
080100        INITIALIZE  PV-SHIPM-CNTR-CBMT-QTY                        08010031
080200                    PV-SHIPM-CNTR-KGRM-QTY                        08020031
080300        MOVE TR063-STRUC-CDE TO PV-ASN-STRUCTURE                  08030031
080400        MOVE 0 TO PV-CURR-PRF-SEQ-NBR                             08040031
080500                  PV-NEXT-PRF-SEQ-NBR                             08050031
080600        MOVE 0 TO PV-CURR-MAN-SEQ-NBR                             08060031
080700                  PV-NEXT-MAN-SEQ-NBR                             08070031
080800        MOVE 0 TO PV-CURR-SEQ-NBR                                 08080031
080900                  PV-NEXT-SEQ-NBR                                 08090031
081000        SET PV-PCK-COMP-ONLY-NO TO TRUE                           08100031
081100        SET PV-PCK-WITH-COMP-NO TO TRUE                           08110031
081200*CHG102494 - START                                                08120031
081300        MOVE TR063-DAT-XFER-CNTL TO SNT00001-DAT-XFER-CNTL-ID     08130031
081400*CHG0113654 - START                                               08140031
081500       IF PS-PRF-PO-NBR-CSR-OPEN                                  08150031
081600          PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                       08160031
081700       END-IF                                                     08170031
081800*CHG0113654 - END                                                 08180031
081900                                                                  08190031
082000        PERFORM 2600-OPEN-PRF-PO-NBR-CSR                          08200031
082100        SET PS-END-OF-PRF-PO-NBR-NO TO TRUE                       08210031
082200        PERFORM 2605-FETCH-PRF-PO-NBR-CSR                         08220031
082300           UNTIL PS-END-OF-PRF-PO-NBR                             08230031
082400        PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                         08240031
082500                                                                  08250031
082600        IF PS-DATA-IN-ERROR-NO                                    08260031
082700*CHG102494 - END                                                  08270031
082800          PERFORM 6170-DETERMINE-AIR-LANDED                       08280031
082900          PERFORM 6172-PREP-FOR-COMP-ONLY                         08290031
083000          IF PS-COMP-ERROR                                        08300031
083100            PERFORM 7600-WRITE-PACK-ITEM-WARNINGS                 08310031
083200            PERFORM 7610-WRITE-PACK-ERRORS                        08320031
083300          ELSE                                                    08330031
083400*         *** MORE PROCESSING IF REQUIRED                         08340031
083500            MOVE TR063-BSN02-SHIPT-ID      TO TR023-CNTR-SHIPT-ID 08350031
083600            PERFORM 2800-DERIVE-SRC-ENT-ID                        08360031
083700            MOVE TR063-ISA-CNTL-NBR-SEQ-ID TO PV-HOLD-FILE-ID     08370031
083800          END-IF                                                  08380031
083900*CHG102494 - START                                                08390031
084000        END-IF                                                    08400031
084100*CHG102494 - END                                                  08410031
084200                                                                  08420031
084300      WHEN HL-HIERARCHICAL-REC                                    08430031
084400           PERFORM 2700-PROCESS-RECORD-SEQUENCE                   08440031
084500                                                                  08450031
084600      WHEN PO4-ITEM-PHYSICAL-DTL-REC                              08460031
084700         AND PV-PACK-LEVEL                                        08470031
084800         AND PV-ASN-STANDARD-CARTON                               08480031
084900            IF TR063-PO414-INPK-EA-QTY EQUAL ZEROES               08490031
085000               MOVE 1 TO TR063-PO414-INPK-EA-QTY                  08500031
085100            END-IF                                                08510031
085200            COMPUTE TRT00012-UNT-QTY =                            08520031
085300              (TR063-PO401-PKG-SIZE-QTY * TR063-PO414-INPK-EA-QTY)08530031
085400                                                                  08540031
085500      WHEN TD1-CARRIER-QTY-WGHT-REC                               08550031
085600         AND PV-SHIPMENT-LEVEL                                    08560031
085700           IF TR063-TD106-WGHT-QUAL-CDE = 'G'                     08570031
085800              EVALUATE TRUE                                       08580031
085900                 WHEN TR063-TD108-UM-CDE = 'CR'                   08590031
086000                    MOVE TR063-TD107-WGHT-MSMT TO                 08600031
086100                                  TRT00012-UPC-CBMT-QTY           08610031
086200                                  PV-SHIPM-CNTR-CBMT-QTY          08620031
086300                 WHEN TR063-TD108-UM-CDE = 'KG'                   08630031
086400                    MOVE TR063-TD107-WGHT-MSMT TO                 08640031
086500                                  TRT00012-UPC-WT-KGRM-QTY        08650031
086600                                  PV-SHIPM-CNTR-KGRM-QTY          08660031
086700              END-EVALUATE                                        08670031
086800           END-IF                                                 08680031
086900                                                                  08690031
087000      WHEN TD5-CARRIER-RTE-TRNST-REC                              08700031
087100         AND PV-SHIPMENT-LEVEL                                    08710031
087200           MOVE TR063-TD504-TRANS-MTHD-CDE TO                     08720031
087300                            TR023-CNTR-TRIP-TYP-CDE-MOM           08730031
087400           IF TR023-CNTR-TRIP-TYP-CDE-MOM = 'S'                   08740031
087500              MOVE 'O' TO TR023-CNTR-TRIP-TYP-CDE-MOM             08750031
087600           END-IF                                                 08760031
087700           IF TR063-TD507-LOC-QUAL = 'PE'                         08770031
087800              MOVE TR063-TD508-LOC-ID      TO                     08780031
087900                            TR023-CNTR-DEST-POE-CDE-MOM           08790031
088000           END-IF                                                 08800031
088100                                                                  08810031
088200      WHEN TD4-CARRIER-SPECIAL-HAND                               08820031
088300         AND PV-SHIPMENT-LEVEL                                    08830031
088400           EVALUATE TRUE                                          08840031
088500              WHEN TR063-TD401-CARR-SPECIAL-HAND = 'CC ' OR 'LN ' 08850031
088600                 MOVE 'CFS' TO TR023-CNTR-ORGN-SHPD-TO-CDE        08860031
088700              WHEN TR063-TD401-CARR-SPECIAL-HAND = 'CF ' OR 'LR ' 08870031
088800                                                         OR 'CY ' 08880031
088900                 MOVE 'CY ' TO TR023-CNTR-ORGN-SHPD-TO-CDE        08890031
089000           END-EVALUATE                                           08900031
089100                                                                  08910031
089200      WHEN TD3-CARRIER-EQUIPMENT-REC                              08920031
089300         AND PV-SHIPMENT-LEVEL                                    08930031
089400           MOVE TR063-TD302-EQUIP-INIT-CDE                        08940031
089500                                   TO PV-TD302-EQUIP-INIT-CDE     08950031
089600           MOVE TR063-TD303-EQUIP-NBR TO PV-TD303-EQUIP-NBR       08960031
089700                                                                  08970031
089800                                                                  08980031
089900      WHEN REF-REFERENCE-NUMBERS-REC                              08990031
090000         AND PV-SHIPMENT-LEVEL                                    09000031
090100           EVALUATE TRUE                                          09010031
090200*             **** V3=VOYAGE NUMBER                               09020031
090300              WHEN TR063-REF01-NBR-QUAL-CDE = 'V3'                09030031
090400                 MOVE TR063-REF02-NBR TO                          09040031
090500                                      TR023-CNTR-IMPRT-TRIP-ID-MOM09050031
090600*             **** WU=VESSEL NAME                                 09060031
090700              WHEN TR063-REF01-NBR-QUAL-CDE = 'WU'                09070031
090800                 MOVE TR063-REF02-NBR TO                          09080031
090900                                      TR023-CNTR-IMP-VEH-NM-MOM   09090031
091000           END-EVALUATE                                           09100031
091100                                                                  09110031
091200      WHEN DTM-DTE-TME-REFERENCE-REC                              09120031
091300         AND PV-SHIPMENT-LEVEL                                    09130031
091400           EVALUATE TRUE                                          09140031
091500*             *** 011=SHIPPED (VESSEL DEPARTURE DATE FROM FOB)    09150031
091600              WHEN TR063-DTM01-DTE-QUAL-CDE = '011'               09160031
091700                 STRING '20' TR063-DTM02-DTE DELIMITED BY SIZE    09170031
091800                                INTO TR023-CNTR-ACTL-DPRTR-DTE-MOM09180031
091900                 MOVE TR063-DTM03-SHIP-TIME TO                    09190031
092000                                     TR023-CNTR-ACTL-DPRTR-TM-MOM 09200031
092100                                                                  09210031
092200*             *** 017=ETA (ESTIMATED TIME OF ARRIVAL IN POE)      09220031
092300              WHEN TR063-DTM01-DTE-QUAL-CDE = '017'               09230031
092400                 STRING '20' TR063-DTM02-DTE DELIMITED BY SIZE    09240031
092500                               INTO TR023-CNTR-EST-POE-DELY-DT-MOM09250031
092600                 MOVE ZEROES TO TR023-CNTR-EST-POE-DELY-TM-MOM    09260031
092700           END-EVALUATE                                           09270031
092800                                                                  09280031
092900      WHEN PRF-PURCHASE-ORDER-REF-REC                             09290031
093000         AND PV-ORDER-LEVEL                                       09300031
093100*          *** PS-FIRST-LIN=FIRST LINE SEGMENT                    09310031
093200*          *** ON A PO (FIRST UPC NBR ON PO)                      09320031
093300           SET PS-FIRST-LIN TO TRUE                               09330031
093400           SET PV-PCK-COMP-ONLY-NO TO TRUE                        09340031
093500           SET PV-PCK-WITH-COMP-NO TO TRUE                        09350031
093600*          *** RIGHT JUSTIFY NUMERIC PURCHASE ORDER               09360031
093700           IF TR063-PRF01-PO-NBR(1:9) NOT EQUAL SPACES            09370031
093800              MOVE 10 TO PV-TRIM-SPACE                            09380031
093900              PERFORM VARYING PV-COUNTER FROM 1 BY 1              09390031
094000                UNTIL TR063-PRF01-PO-NBR(PV-TRIM-SPACE:1)         09400031
094100                                                  NOT EQUAL SPACES09410031
094200                 SUBTRACT 1 FROM PV-TRIM-SPACE                    09420031
094300              END-PERFORM                                         09430031
094400              MOVE TR063-PRF01-PO-NBR(1:PV-TRIM-SPACE)            09440031
094500                                    TO TR023-CONPO-PO-NBR         09450031
094600                                       POPRPK-PO-NBR              09460031
094700                                       PURCHS-PO-NBR              09470031
094800*             DISPLAY 'PURCHS-PO-NBR ' PURCHS-PO-NBR              09480031
094900           END-IF                                                 09490031
095000                                                                  09500031
095100      WHEN MAN-MARKS-NUMBERS-REC                                  09510031
095200         AND PV-PACK-LEVEL                                        09520031
095300           MOVE TR063-MAN02-NBR TO TRT00012-SSCC-ID               09530031
095400                                                                  09540031
095500      WHEN LIN-ITEM-IDENTIFICATION-REC                            09550031
095600        AND PV-ITEM-LEVEL                                         09560031
095700        PERFORM 2200-FIND-UPC-NUMBER                              09570031
095800*       *** NEXT 'IF' WAS NUMBER 1                                09580031
095900        IF PS-UPC-NBR-FOUND                                       09590031
096000          AND TR023-CONUPC-UPC-NBR-X NOT EQUAL SPACES             09600031
096100          PERFORM 2205-RIGHT-JUSTIFY-UPC                          09610031
096200*         *** NEXT 'IF' WAS NUMBER 2                              09620031
096300          IF TR023-CONUPC-UPC-NBR(1:PV-TRIM-SPACE) IS NUMERIC     09630031
096400            MOVE TR023-CONUPC-UPC-NBR(1:PV-TRIM-SPACE)            09640031
096500                 TO TRT00012-UPC-NBR                              09650031
096600                    POPRPK-PREPK-UPC-NBR                          09660031
096700            INITIALIZE PV-UPC-NBR-NON-NUMERIC                     09670031
096800            PERFORM 2210-PROCESS-LINE-ITEM                        09680031
096900            IF PS-CARTON-DATA-MISSING                             09690031
097000              MOVE PC-WARNING        TO TR211-ERROR-TYPE          09700031
097100              MOVE 'CONUP LEVEL    ' TO TR211-DATA-IN-ERROR       09710031
097200              MOVE 'CNCART DATA MISSING' TO TR211-ERROR-MSG       09720031
097300              MOVE SPACES            TO TR211-DATA-VALUE          09730031
097400              MOVE TRT00012-UPC-NBR  TO TR211-CONUPA-UPC-NBR      09740031
097500              PERFORM 7500-WRITE-ITEM-LEVEL-ERROR                 09750031
097600            END-IF                                                09760031
097700          ELSE                                                    09770031
097800            MOVE TR023-CONUPC-UPC-NBR-X(1:PV-TRIM-SPACE)          09780031
097900                                    TO PV-UPC-NBR-NON-NUMERIC     09790031
098000          END-IF                                                  09800031
098100*         *** ABOVE 'END-IF' WAS NUMBER 2                         09810031
098200        END-IF                                                    09820031
098300*       *** ABOVE 'END-IF' WAS NUMBER 1                           09830031
098400        SET PS-CARTON-DATA-MISSING-NO TO TRUE                     09840031
098500                                                                  09850031
098600                                                                  09860031
098700      WHEN SN1-ITEM-DETAIL-REC                                    09870031
098800         AND PV-ITEM-LEVEL                                        09880031
098900           MOVE TR063-SN103-SHIP-UM-CDE TO TRT00012-ASN-PKGNG-CDE 09890031
099000           IF NOT PV-ASN-STANDARD-CARTON                          09900031
099100              MOVE TR063-SN102-SHIP-QTY TO TRT00012-UNT-QTY       09910031
099200           END-IF                                                 09920031
099300                                                                  09930031
099400      WHEN SLN-SUBITEM-DETAIL-REC                                 09940031
099500         AND PV-ITEM-LEVEL                                        09950031
099600         AND PV-ASN-PICK-N-PACK                                   09960031
099700         AND PV-PCK-COMP-ONLY-NO                                  09970031
099800*        AND PURCHS-PKGNG-CDE NOT = PC-I                          09980031
099900*        AND PURCHS-PKGNG-CDE NOT = PC-M                          09990031
100000         IF PV-PCK-WITH-COMP-NO                                   10000031
100100           SET PV-PCK-WITH-COMP TO TRUE                           10010031
100200         END-IF                                                   10020031
100300         ADD TR063-SLN04-QTY TO PV-TOTAL-SLN04-QTY                10030031
100400                                                                  10040031
100500     END-EVALUATE.                                                10050031
100600                                                                  10060031
100700     IF PS-BYPASS-IN-PROCESS-NO AND PS-END-OF-ASN-NO              10070031
100800       IF PS-BYPASS-HL-P-O-ID-NO                                  10080031
100900        PERFORM 6000-READ-ASN-FILE                                10090031
101000       ELSE                                                       10100031
101100        SET PS-BYPASS-HL-P-O-ID-NO TO TRUE                        10110031
101200       END-IF                                                     10120031
101300     END-IF.                                                      10130031
101400                                                                  10140031
101500     IF PS-END-OF-ASN-NO                                          10150031
101600        SET PS-BYPASS-IN-PROCESS-NO TO TRUE                       10160031
101700        SET PS-DATA-IN-ERROR-NO     TO TRUE                       10170031
101800     END-IF.                                                      10180031
101900                                                                  10190031
102000******************************************************************10200031
102100* FIND UPC NUMBER IN STRING                                      *10210031
102200******************************************************************10220031
102300 2200-FIND-UPC-NUMBER.                                            10230031
102400                                                                  10240031
102500***  DISPLAY '2200-FIND-UPC-NUMBER'.                              10250031
102600     SET PS-UPC-NBR-FOUND-NO TO TRUE.                             10260031
102700     PERFORM VARYING PV-COUNTER FROM 1 BY 1                       10270031
102800       UNTIL PS-UPC-NBR-FOUND                                     10280031
102900          OR PV-COUNTER > 10                                      10290031
103000******* BEG-MJMCHG-ADD CHECK FOR EAN ********                     10300031
103100        IF (TR063-LIN02-PROD-ID-QUAL-CDE(PV-COUNTER) = 'UP'       10310031
103200                             OR                                   10320031
103300            TR063-LIN02-PROD-ID-QUAL-CDE(PV-COUNTER) = 'EN')      10330031
103400******* END-MJMCHG-ADD CHECK FOR EAN ********                     10340031
103500           SET PS-UPC-NBR-FOUND TO TRUE                           10350031
103600           MOVE TR063-LIN03-PROD-ID(PV-COUNTER)                   10360031
103700                TO TR023-CONUPC-UPC-NBR-X                         10370031
103800        END-IF                                                    10380031
103900     END-PERFORM.                                                 10390031
104000                                                                  10400031
104100******************************************************************10410031
104200* RIGHT JUSTIFY UPC                                              *10420031
104300******************************************************************10430031
104400 2205-RIGHT-JUSTIFY-UPC.                                          10440031
104500                                                                  10450031
104600***  DISPLAY '2205-RIGHT-JUSTIFY-UPC'.                            10460031
104700     MOVE 16 TO PV-TRIM-SPACE.                                    10470031
104800     PERFORM VARYING PV-COUNTER FROM 1 BY 1                       10480031
104900       UNTIL TR023-CONUPC-UPC-NBR-X(PV-TRIM-SPACE:1)              10490031
105000                               NOT EQUAL SPACES                   10500031
105100           SUBTRACT 1 FROM PV-TRIM-SPACE                          10510031
105200     END-PERFORM.                                                 10520031
105300                                                                  10530031
105400******************************************************************10540031
105500* MAIN PROCESSING LINE ITEM RECORD.                              *10550031
105600******************************************************************10560031
105700 2210-PROCESS-LINE-ITEM.                                          10570031
105800                                                                  10580031
105900***  DISPLAY '2210-PROCESS-LINE-ITEM'.                            10590031
106000*    *** NEXT 'IF' WAS NUMBER 3                                   10600031
106100     IF PS-FIRST-LIN                                              10610031
106200        PERFORM 6151-DETERMIN-PACK-OR-BULK                        10620031
106300        PERFORM 2215-FIRST-LINE-ITEM                              10630031
106400     ELSE                                                         10640031
106500        IF PV-PCK-COMP-ONLY                                       10650031
106600          SET PS-COMP-ERROR-NO TO TRUE                            10660031
106700          PERFORM 2420-PCK-COMP-ONLY                              10670031
106800          IF PS-COMP-ERROR-NO                                     10680031
106900            PERFORM 6029-BYPASS-TO-NEXT-HL-P-O-ID                 10690031
107000          ELSE                                                    10700031
107100            IF PS-END-OF-ASN                                      10710031
107200              SET PS-BYPASS-IN-PROCESS-NO TO TRUE                 10720031
107300            END-IF                                                10730031
107400          END-IF                                                  10740031
107500        END-IF                                                    10750031
107600      END-IF.                                                     10760031
107700*     ********** ABOVE 'END-IF' WAS NUMBER 3                      10770031
107800                                                                  10780031
107900*     *** NEXT 23 LINES ADDED 7/22/08                             10790031
108000      IF (PURCHS-PKGNG-CDE = PC-I OR                              10800031
108100             PURCHS-PKGNG-CDE  = PC-M)                            10810031
108200         AND PV-PCK-COMP-ONLY-NO                                  10820031
108300        SET PS-INNER-PACK-FND-NO TO TRUE                          10830031
108400        PERFORM 2630-SELECT-INPK-UNT-QTY                          10840031
108500        IF PS-INNER-PACK-FND                                      10850031
108600         CONTINUE                                                 10860031
108700*        *** DISPLAY 'POPRPK-INPK-UNT-QTY '                       10870031
108800*        ***          POPRPK-INPK-UNT-QTY                         10880031
108900        ELSE                                                      10890031
109000           MOVE PC-NO-COMP-UPC-FOUND                              10900031
109100                                TO TR211-ERROR-MSG                10910031
109200           PERFORM 2220-NO-UPC-ERROR                              10920031
109300        END-IF                                                    10930031
109400      END-IF.                                                     10940031
109500                                                                  10950031
109600******************************************************************10960031
109700* DO THIS FOR THE FIRST LINE ITEM OF THE PO.                     *10970031
109800******************************************************************10980031
109900 2215-FIRST-LINE-ITEM.                                            10990031
110000                                                                  11000031
110100***  DISPLAY '2215-FIRST-LINE-ITEM'.                              11010031
110200*    *** NEXT 'IF' WAS IF NUMBER 4                                11020031
110300     IF PURCHS-PKGNG-CDE = PC-I OR PC-M                           11030031
110400        PERFORM 2350-SELECT-POPRPK-UNT-QTY                        11040031
110500        IF PV-FOUND-POPRPK-ROW-NO                                 11050031
110600           PERFORM 2400-SELECT-POPRPK-UPC                         11060031
110700           IF PV-FOUND-POPRPK-UPC                                 11070031
110800             PERFORM 2410-PACK-COMPONENTS-ONLY                    11080031
110900           ELSE                                                   11090031
111000             MOVE PC-NO-PACK-UPC-FOUND                            11100031
111100                                TO TR211-ERROR-MSG                11110031
111200             PERFORM 2220-NO-UPC-ERROR                            11120031
111300           END-IF                                                 11130031
111400        END-IF                                                    11140031
111500     END-IF.                                                      11150031
111600     SET PS-FIRST-LIN-NO TO TRUE.                                 11160031
111700                                                                  11170031
111800******************************************************************11180031
111900* NO UPC FOUND FOR THIS PO NUMBER.                               *11190031
112000*    IF NO UPC'S ARE FOUND FOR THE PO-NBR BYPASS THE REMAINDER   *11200031
112100*    OF SEGMTS AND WRITE THEM TO THE THE EXCEPTION FILE.         *11210031
112200******************************************************************11220031
112300 2220-NO-UPC-ERROR.                                               11230031
112400                                                                  11240031
112500***  DISPLAY '2220-NO-UPC-ERROR'.                                 11250031
112600                                                                  11260031
112700     SET PS-COMP-ERROR TO TRUE.                                   11270031
112800     MOVE 'E'                   TO TR211-RPT-TYP.                 11280031
112900     MOVE PC-ERROR              TO TR211-ERROR-TYPE.              11290031
113000     MOVE 'ASN PO TYPE'         TO TR211-DATA-IN-ERROR.           11300031
113100     MOVE PV-PURCHS-PO-NBR      TO TR211-DATA-VALUE.              11310031
113200     PERFORM 7300-WRITE-PO-LEVEL-ERROR.                           11320031
113300     PERFORM 6030-BYPASS-TO-NEXT-ISA-ID.                          11330031
113400                                                                  11340031
113500******************************************************************11350031
113600 2350-SELECT-POPRPK-UNT-QTY.                                      11360031
113700******************************************************************11370031
113800* ************** IF #4 DO THIS                                    11380031
113900***  DISPLAY '2350-SELECT-POPRPK-UNT-QTY'.                        11390031
114000                                                                  11400031
114100          EXEC SQL                                                11410031
114200           SELECT INPK_UNT_QTY                                    11420031
114300             INTO :POPRPK-INPK-UNT-QTY                            11430031
114400           FROM TPOPRPK                                           11440031
114500          WHERE PO_NBR     = :POPRPK-PO-NBR AND                   11450031
114600             PREPK_UPC_NBR = :POPRPK-PREPK-UPC-NBR                11460031
114700          END-EXEC.                                               11470031
114800                                                                  11480031
114900          EVALUATE TRUE                                           11490031
115000            WHEN SQLCODE = ZERO                                   11500031
115100              SET PV-PCK-COMP-ONLY-NO TO TRUE                     11510031
115200              SET PV-FOUND-POPRPK-ROW TO TRUE                     11520031
115300            WHEN SQLCODE = +100                                   11530031
115400              SET PV-FOUND-POPRPK-ROW-NO TO TRUE                  11540031
115500            WHEN SQLWARN0 NOT = SPACES                            11550031
115600            WHEN SQLCODE < ZERO                                   11560031
115700            WHEN SQLCODE > ZERO                                   11570031
115800               MOVE '2350-SELECT-POPRPK-UNT-QTY'                  11580031
115900                            TO PV-PARAGRAPH-NAME                  11590031
116000               MOVE 'ERROR WHILE DOING SELECT'                    11600031
116100                            TO PV-DB2-OPERATION-MESSAGE           11610031
116200               MOVE 'TPOPRPK'     TO PV-DB2-TABLE-NAME-1          11620031
116300               MOVE SPACES        TO PV-DB2-TABLE-NAME-2          11630031
116400               MOVE SPACES        TO PV-DB2-TABLE-NAME-3          11640031
116500               PERFORM 9100-USER-ABEND                            11650031
116600         END-EVALUATE.                                            11660031
116700*        **** ABOVE END EVAL WAS #5                               11670031
116800                                                                  11680031
116900******************************************************************11690031
117000 2400-SELECT-POPRPK-UPC.                                          11700031
117100******************************************************************11710031
117200***  DISPLAY '2400-SELECT-POPRPK-UPC'.                            11720031
117300                                                                  11730031
117400          EXEC SQL                                                11740031
117500           SELECT PREPK_UPC_NBR                                   11750031
117600             INTO :POPRPK-PREPK-UPC-NBR                           11760031
117700           FROM TPOPRPK                                           11770031
117800          WHERE PO_NBR    = :POPRPK-PO-NBR                        11780031
117900          END-EXEC.                                               11790031
118000                                                                  11800031
118100          EVALUATE TRUE                                           11810031
118200           WHEN SQLCODE = ZERO                                    11820031
118300           WHEN SQLCODE = -811                                    11830031
118400            SET PV-FOUND-POPRPK-UPC TO TRUE                       11840031
118500*           *** DISPLAY 'PO IS COMPONENTS ONLY ='                 11850031
118600*           ***                POPRPK-PO-NBR                      11860031
118700                                                                  11870031
118800           WHEN SQLCODE = +100                                    11880031
118900             SET PS-COMP-ERROR TO TRUE                            11890031
119000             SET PV-FOUND-POPRPK-UPC-NO TO TRUE                   11900031
119100                                                                  11910031
119200           WHEN SQLWARN0 NOT = SPACES                             11920031
119300           WHEN SQLCODE < ZERO                                    11930031
119400           WHEN SQLCODE > ZERO                                    11940031
119500             MOVE '2400-SELECT-POPRPK-UPC'                        11950031
119600                           TO PV-PARAGRAPH-NAME                   11960031
119700             MOVE 'ERROR WHILE DOING SELECT'                      11970031
119800                           TO PV-DB2-OPERATION-MESSAGE            11980031
119900             MOVE 'TPOPRPK' TO PV-DB2-TABLE-NAME-1                11990031
120000             MOVE SPACES    TO PV-DB2-TABLE-NAME-2                12000031
120100             MOVE SPACES   TO PV-DB2-TABLE-NAME-3                 12010031
120200             PERFORM 9100-USER-ABEND                              12020031
120300          END-EVALUATE.                                           12030031
120400                                                                  12040031
120500******************************************************************12050031
120600* DID NOT SENT PACK UPC                                          *12060031
120700******************************************************************12070031
120800 2410-PACK-COMPONENTS-ONLY.                                       12080031
120900***  DISPLAY '2410-PACK-COMPONENTS-ONLY'.                         12090031
121000                                                                  12100031
121100     SET PV-PCK-COMP-ONLY TO TRUE.                                12110031
121200*    ***DISPLAY 'PO IS COMPONENTS ONLY ='                         12120031
121300*    ***               POPRPK-PO-NBR.                             12130031
121400     SET PS-END-OF-PRF-PO-NBR-NO TO TRUE.                         12140031
121500     MOVE TR063-DAT-XFER-CNTL                                     12150031
121600         TO SNT00001-DAT-XFER-CNTL-ID.                            12160031
121700     SET PS-COMP-ERROR-NO TO TRUE.                                12170031
121800     PERFORM 2520-FIND-PO-PRC-LOD-SEQ-NBR.                        12180031
121900     PERFORM 2420-PCK-COMP-ONLY.                                  12190031
122000     IF PS-COMP-ERROR-NO                                          12200031
122100        PERFORM 6029-BYPASS-TO-NEXT-HL-P-O-ID                     12210031
122200     ELSE                                                         12220031
122300        IF PS-END-OF-ASN                                          12230031
122400          SET PS-BYPASS-IN-PROCESS-NO TO TRUE                     12240031
122500        END-IF                                                    12250031
122600     END-IF.                                                      12260031
122700                                                                  12270031
122800****************************************************************  12280031
122900 2420-PCK-COMP-ONLY.                                              12290031
123000*    DISPLAY '2420-PCK-COMP-ONLY'.                                12300031
123100                                                                  12310031
123200*    ***DISPLAY 'PV-CURR-PRF-SEQ-NBR = ' PV-CURR-PRF-SEQ-NBR.     12320031
123300                                                                  12330031
123400     IF PS-FIRST-LIN                                              12340031
123500     IF PS-END-OF-PRF-PO-NBR-NO                                   12350031
123600      PERFORM 2430-READ-PRF-POS                                   12360031
123700     END-IF                                                       12370031
123800      ELSE                                                        12380031
123900      PERFORM 2430-READ-PRF-POS.                                  12390031
124000                                                                  12400031
124100****************************************************************  12410031
124200 2430-READ-PRF-POS.                                               12420031
124300*    DISPLAY '2430-READ-PRF-POS'.                                 12430031
124400                                                                  12440031
124500     IF PS-FIRST-LIN                                              12450031
124600*AME ADDED NEXT EIGHT 7/15/08 11:30 A.M.                          12460031
124700       IF PV-PCK-COMP-ONLY                                        12470031
124800          IF PV-CURR-PRF-SEQ-NBR = ZERO                           12480031
124900             CONTINUE                                             12490031
125000          ELSE                                                    12500031
125100             COMPUTE PV-CURR-PRF-SEQ-NBR =                        12510031
125200                PV-CURR-PRF-SEQ-NBR - 1                           12520031
125300          END-IF                                                  12530031
125400       END-IF                                                     12540031
125500*      ***DISPLAY 'PV-CURR-PRF-SEQ-NBR ' PV-CURR-PRF-SEQ-NBR      12550031
125600                                                                  12560031
125700***CRQ31649-BEGIN                                                 12570031
125800       IF PS-PRF-PO-NBR-CSR-OPEN                                  12580031
125900          PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                       12590031
126000       END-IF                                                     12600031
126100***CRQ31649-END                                                   12610031
126200       PERFORM 2600-OPEN-PRF-PO-NBR-CSR                           12620031
126300       PERFORM 2610-FETCH-PRF-PO-NBR-CSR                          12630031
126400                                                                  12640031
126500*      ***DISPLAY 'NEXT-PRF-SEQ-NBR = ' PV-NEXT-PRF-SEQ-NBR       12650031
126600                                                                  12660031
126700       MOVE PV-CURR-PRF-SEQ-NBR TO PV-CURR-MN-SEQ-NBR             12670031
126800       SET PS-END-OF-MAN-NBR-NO TO TRUE                           12680031
126900     ELSE                                                         12690031
127000      MOVE PV-CURR-MAN-SEQ-NBR TO PV-CURR-MN-SEQ-NBR              12700031
127100     END-IF.                                                      12710031
127200*    ***DISPLAY 'CURR-MN-SEQ-NBR = ' PV-CURR-MN-SEQ-NBR.          12720031
127300                                                                  12730031
127400     IF PS-END-OF-MAN-NBR-NO                                      12740031
127500      PERFORM 2440-FETCH-MAN-UPC-NBR-CSR                          12750031
127600     END-IF.                                                      12760031
127700                                                                  12770031
127800****************************************************************  12780031
127900* FETCH MAN-UPC-NBR-CSR                                           12790031
128000****************************************************************  12800031
128100 2440-FETCH-MAN-UPC-NBR-CSR.                                      12810031
128200*    DISPLAY '2440-FETCH-MAN-UPC-NBR-CSR'.                        12820031
128300                                                                  12830031
128400     SET PS-MAN-FOUND-NO  TO TRUE.                                12840031
128500*AME ADDED 2 LINES BEFORE PERFORM 2640-OPEN-MAN-UPC-NBR-CSR       12850031
128600     IF PV-CURR-MN-SEQ-NBR < PV-CURR-PRF-SEQ-NBR                  12860031
128700        MOVE PV-CURR-PRF-SEQ-NBR TO PV-CURR-MN-SEQ-NBR.           12870031
128800     PERFORM 2640-OPEN-MAN-UPC-NBR-CSR.                           12880031
128900     MOVE 0 TO PV-SN1-TOTAL-SHIP-QTY.                             12890031
129000     SET PS-END-OF-LIN-UPC-NBR-NO TO TRUE.                        12900031
129100     MOVE 0 TO PV-PREV-PK-SKU                                     12910031
129200               PV-CURR-PK-SKU.                                    12920031
129300     EXEC SQL                                                     12930031
129400         FETCH MAN-UPC-NBR-CSR                                    12940031
129500           INTO :SNT00001-PRC-LOD-SEQ-NBR                         12950031
129600     END-EXEC                                                     12960031
129700                                                                  12970031
129800     EVALUATE TRUE                                                12980031
129900         WHEN SQLCODE = ZERO                                      12990031
130000          SET PS-MAN-FOUND  TO TRUE                               13000031
130100          MOVE SNT00001-PRC-LOD-SEQ-NBR TO PV-CURR-MAN-SEQ-NBR    13010031
130200         WHEN SQLCODE = +100                                      13020031
130300          IF PS-FIRST-LIN                                         13030031
130400          SET PS-COMP-ERROR TO TRUE                               13040031
130500          MOVE 'E'         TO TR211-RPT-TYP                       13050031
130600          MOVE 'MAN SEGMENT-PACKAGE' TO TR211-DATA-IN-ERROR       13060031
130700          MOVE                                                    13070031
130800          'ASN MAN SEGMNT NOT FND ON ASN TBL- CNTACT PRGMNG'      13080031
130900                TO TR211-ERROR-MSG                                13090031
131000          MOVE PV-CURR-MAN-SEQ-NBR TO TR211-DATA-VALUE            13100031
131100*    SAVE ERROR TO BE WRITEN WHEN WORK TABLE IS UNLOADED          13110031
131200          PERFORM 7400-WRITE-PACK-LEVEL-ERROR                     13120031
131300          PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                      13130031
131400          SET PS-END-OF-MAN-NBR TO TRUE                           13140031
131500          END-IF                                                  13150031
131600                                                                  13160031
131700         WHEN SQLWARN0 NOT = SPACES                               13170031
131800         WHEN SQLCODE < ZERO                                      13180031
131900         WHEN SQLCODE > ZERO                                      13190031
132000             MOVE '2440-FETCH-MAN-UPC-NBR-CSR'                    13200031
132100                                     TO PV-PARAGRAPH-NAME         13210031
132200             MOVE 'ERROR FETCHING WITH THE MAN-UPC-NBR'           13220031
132300                                     TO PV-DB2-OPERATION-MESSAGE  13230031
132400             MOVE SPACES             TO PV-DB2-TABLE-NAME-1       13240031
132500             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       13250031
132600             PERFORM 9100-USER-ABEND                              13260031
132700     END-EVALUATE                                                 13270031
132800                                                                  13280031
132900     IF PS-MAN-FOUND                                              13290031
133000     EXEC SQL                                                     13300031
133100         FETCH MAN-UPC-NBR-CSR                                    13310031
133200           INTO :SNT00001-PRC-LOD-SEQ-NBR                         13320031
133300     END-EXEC                                                     13330031
133400                                                                  13340031
133500     EVALUATE TRUE                                                13350031
133600         WHEN SQLCODE = ZERO                                      13360031
133700          MOVE SNT00001-PRC-LOD-SEQ-NBR TO PV-NEXT-MAN-SEQ-NBR    13370031
133800*      ***DISPLAY 'PV-NEXT-MAN-SEQ-NBR = ' PV-NEXT-MAN-SEQ-NBR    13380031
133900         WHEN SQLCODE = +100                                      13390031
134000          SET PS-END-OF-MAN-NBR TO TRUE                           13400031
134100          MOVE PV-NEXT-PRF-SEQ-NBR TO PV-NEXT-MAN-SEQ-NBR         13410031
134200*      ***DISPLAY 'PV-NEXT-MAN-SEQ-NBR = ' PV-NEXT-MAN-SEQ-NBR    13420031
134300         WHEN SQLWARN0 NOT = SPACES                               13430031
134400         WHEN SQLCODE < ZERO                                      13440031
134500         WHEN SQLCODE > ZERO                                      13450031
134600             MOVE '2440-FETCH-MAN-UPC-NBR-CSR'                    13460031
134700                                     TO PV-PARAGRAPH-NAME         13470031
134800             MOVE 'ERROR FETCHING 2ND MAN-UPC-NBR'                13480031
134900                                     TO PV-DB2-OPERATION-MESSAGE  13490031
135000             MOVE SPACES             TO PV-DB2-TABLE-NAME-1       13500031
135100             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       13510031
135200             PERFORM 9100-USER-ABEND                              13520031
135300     END-EVALUATE                                                 13530031
135400                                                                  13540031
135500     PERFORM 2500-PROCESS-LIN-SEGMENTS                            13550031
135600     END-IF.                                                      13560031
135700                                                                  13570031
135800     PERFORM 2650-CLOSE-MAN-UPC-NBR-CSR.                          13580031
135900                                                                  13590031
136000     MOVE PV-CURR-MAN-SEQ-NBR TO PV-CURR-MN-SEQ-NBR.              13600031
136100                                                                  13610031
136200******************************************************************13620031
136300* PROCESS LINE SEGMENTS                                           13630031
136400******************************************************************13640031
136500 2500-PROCESS-LIN-SEGMENTS.                                       13650031
136600*    DISPLAY '2500-PROCESS-LIN-SEGMENTS'.                         13660031
136700                                                                  13670031
136800     SET PS-LIN-FOUND-NO TO TRUE.                                 13680031
136900     MOVE PV-CURR-MAN-SEQ-NBR TO PV-CURR-SEQ-NBR.                 13690031
137000     MOVE PV-NEXT-MAN-SEQ-NBR TO PV-NEXT-SEQ-NBR.                 13700031
137100     MOVE 0 TO PV-LIN-INDEX.                                      13710031
137200     PERFORM 2515-OPEN-LIN-UPC-NBR-CSR.                           13720031
137300     PERFORM 2535-FETCH-LIN-UPC-NBR-CSR.                          13730031
137400     IF PS-LIN-FOUND                                              13740031
137500       PERFORM 2530-GET-LIN-COMP-ONLY                             13750031
137600             UNTIL PS-END-OF-LIN-UPC-NBR                          13760031
137700     END-IF.                                                      13770031
137800     PERFORM 2525-CLOSE-LIN-UPC-NBR-CSR.                          13780031
137900                                                                  13790031
138000     IF PS-PK-SKU-NBR-FOUND AND PS-PK-SKU-NOMATCH-NO              13800031
138100       PERFORM 2695-SELECT-SKU-COUNT                              13810031
138200     END-IF.                                                      13820031
138300                                                                  13830031
138400****************************************************************  13840031
138500* OPEN LIN-UPC-NBR-CSR                                            13850031
138600****************************************************************  13860031
138700 2515-OPEN-LIN-UPC-NBR-CSR.                                       13870031
138800*    DISPLAY '2515-OPEN-LIN-UPC-NBR-CSR'.                         13880031
138900                                                                  13890031
139000     EXEC SQL                                                     13900031
139100          OPEN LIN-UPC-NBR-CSR                                    13910031
139200     END-EXEC.                                                    13920031
139300                                                                  13930031
139400     EVALUATE TRUE                                                13940031
139500         WHEN SQLCODE = ZERO                                      13950031
139600             CONTINUE                                             13960031
139700         WHEN SQLWARN0 NOT = SPACES                               13970031
139800         WHEN SQLCODE < ZERO                                      13980031
139900         WHEN SQLCODE > ZERO                                      13990031
140000             MOVE '2515-OPEN-LIN-UPC-NBR-CSR'                     14000031
140100                                     TO PV-PARAGRAPH-NAME         14010031
140200             MOVE 'ATTEMPTING TO OPEN THE LIN-PO-NUMBER CSR'      14020031
140300                                     TO PV-DB2-OPERATION-MESSAGE  14030031
140400             MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1       14040031
140500             MOVE '       '          TO PV-DB2-TABLE-NAME-2       14050031
140600             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       14060031
140700             PERFORM 9100-USER-ABEND                              14070031
140800     END-EVALUATE.                                                14080031
140900                                                                  14090031
141000****************************************************************  14100031
141100* PREP COMPONENT ONLY PO.                                         14110031
141200* THIS WAS INSTALLED AFTER THE ORIGINAL COMPONENT ONLY CODE TO    14120031
141300* SET UP THE PO'S PV-CURR-PRF-SEQ-NBR.  THE FIELD, PRC-LOD-SEQ    14130031
141400* NUMBER IS A UNIQUE ASCENDING NUMBER THAT IDENTIFIES EACH LINE   14140031
141500* ON AN ASN ON THE SNT-DAT-XFER TABLE. IT WAS THOUGHT THAT        14150031
141600* COMPONENT ONLY PO'S WOULD ONLY BE PRESENT IN AN ASN WITH        14160031
141700* OTHER COMPONENT ONLY PO'S.  AFTERWARD WE FOUND THAT NIKE AND    14170031
141800* PERHAPS OTHER LANDED VENDORS WOULD SEND ASN'S WITH A MIXTURE    14180031
141900* OF PO'S.  THE POSSIBLITIES COULD BE COMPONENT ONLY PACK, BULK,  14190031
142000* PACK THAT'S NOT A COMPONENT ONLY OR HOPEFULLY NEVER, A PACK W/O 14200031
142100* A PACK UPC ON KOHL'S TPOPRPK.                                   14210031
142200* THE COMPONENT ONLY PO'S KEEP TRACK OF THE PRC-LOD-SEQ-NBR FOR   14220031
142300* THE PRF (PO) THE MAN (SSCC-18 CARTON ID) LIN (UPC NUMBER) OF    14230031
142400* THE PAST COMPONENT ONLY.  THE OTHER TYPES OF ASN'S DON'T NEED   14240031
142500* THIS INFO.  WE ADDED THIS PREP SO THE REST OF THE CODE DOESN'T  14250031
142600* HAVE TO BE CHANGED.                                             14260031
142700****************************************************************  14270031
142800 2520-FIND-PO-PRC-LOD-SEQ-NBR.                                    14280031
142900*    DISPLAY '2520-FIND-PO-PRC-LOD-SEQ-NBR'.                      14290031
143000                                                                  14300031
143100     SET PO-INDX                    TO 1.                         14310031
143200     SET PS-END-OF-SEARCH-NO        TO TRUE.                      14320031
143300     INITIALIZE PV-CURR-PRF-SEQ-NBR.                              14330031
143400     INITIALIZE PV-CURR-MN-SEQ-NBR.                               14340031
143500                                                                  14350031
143600     PERFORM VARYING PO-INDX FROM 1 BY 1                          14360031
143700             UNTIL PS-END-OF-SEARCH                               14370031
143800          SEARCH PV-PRF-INFO-TABLE-ENTRIES                        14380031
143900              WHEN PV-PO-NBR-COMP-ONLY-PREP(PO-INDX)=             14390031
144000                   PURCHS-PO-NBR                                  14400031
144100                   MOVE PV-PRC-LOD-SEQ-NBR-PREP(PO-INDX) TO       14410031
144200                        PV-CURR-PRF-SEQ-NBR                       14420031
144300                   MOVE PV-PRC-LOD-SEQ-NBR-PREP(PO-INDX) TO       14430031
144400                        PV-CURR-MN-SEQ-NBR                        14440031
144500                   SET PS-END-OF-SEARCH TO TRUE                   14450031
144600          END-SEARCH                                              14460031
144700*    ***DISPLAY 'PO HERE       '                                  14470031
144800*    ***DISPLAY 'PURCHS-PO-NBR ' PURCHS-PO-NBR                    14480031
144900*    ***DISPLAY 'PV-PO-NBR-COMP-ONLY-PREP(PO-INDX) '              14490031
145000*    ***         PV-PO-NBR-COMP-ONLY-PREP(PO-INDX)                14500031
145100*    ***DISPLAY 'PV-PRC-LOD-SEQ-NBR-PREP(PO-INDX) '               14510031
145200*    ***         PV-PRC-LOD-SEQ-NBR-PREP(PO-INDX)                 14520031
145300*    ***DISPLAY 'PV-CURR-PRF-SEQ-NBR ' PV-CURR-PRF-SEQ-NBR        14530031
145400*    ***DISPLAY 'PV-CURR-MN-SEQ-NBR ' PV-CURR-MN-SEQ-NBR          14540031
145500     END-PERFORM.                                                 14550031
145600                                                                  14560031
145700****************************************************************  14570031
145800* CLOSE LIN-UPC-NBR-CSR                                           14580031
145900****************************************************************  14590031
146000 2525-CLOSE-LIN-UPC-NBR-CSR.                                      14600031
146100*    DISPLAY '2525-CLOSE-LIN-UPC-NBR-CSR'.                        14610031
146200                                                                  14620031
146300         EXEC SQL                                                 14630031
146400              CLOSE LIN-UPC-NBR-CSR                               14640031
146500         END-EXEC.                                                14650031
146600                                                                  14660031
146700     EVALUATE TRUE                                                14670031
146800         WHEN SQLCODE = ZERO                                      14680031
146900             CONTINUE                                             14690031
147000         WHEN SQLWARN0 NOT = SPACES                               14700031
147100         WHEN SQLCODE < ZERO                                      14710031
147200         WHEN SQLCODE > ZERO                                      14720031
147300             MOVE '2525-CLOSE-LIN-UPC-NBR-CSR'                    14730031
147400                                     TO PV-PARAGRAPH-NAME         14740031
147500             MOVE 'ATTEMPTING TO CLOSE THE LIN-UPC-NBR-CSR'       14750031
147600                                     TO PV-DB2-OPERATION-MESSAGE  14760031
147700             MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1       14770031
147800             MOVE SPACES       TO PV-DB2-TABLE-NAME-2             14780031
147900             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       14790031
148000             PERFORM 9100-USER-ABEND                              14800031
148100     END-EVALUATE.                                                14810031
148200                                                                  14820031
148300****************************************************************  14830031
148400* PROCESS LIN-UPC-NBR-CSR FOR PACK WITH COMPONENTS ONLY           14840031
148500****************************************************************  14850031
148600 2530-GET-LIN-COMP-ONLY.                                          14860031
148700                                                                  14870031
148800     MOVE SNT00001-PRC-LOD-SEQ-NBR TO PV-CURR-LIN-SEQ-NBR         14880031
148900                                        PV-CURR-SEQ-NBR.          14890031
149000     PERFORM 2540-FIND-UPC-IN-STRING.                             14900031
149100     IF PS-UPC-NBR-FOUND                                          14910031
149200       AND PV-DAT-UPC-NBR NOT EQUAL SPACES                        14920031
149300      MOVE SNT00001-PRC-LOD-SEQ-NBR                               14930031
149400        TO PV-LIN-SEQ-NBR                                         14940031
149500      PERFORM 2545-RIGHT-JUSTIFY-SNT-UPC                          14950031
149600*     **** PKE2372 MJF 3/31/11 CHANGE #2 START                    14960031
149700***   MOVE SNT00001-PRC-LOD-SEQ-NBR TO PV-NEXT-LIN-SEQ-NBR        14970031
149800      COMPUTE PV-NEXT-SEQ-AFT-LIN =                               14980031
149900           SNT00001-PRC-LOD-SEQ-NBR + 1                           14990031
150000*     **** PKE2372 MJF 3/31/11 END                                15000031
150100      PERFORM 2555-SELECT-MISC-DATXFER                            15010031
150200      IF SQLCODE = 0                                              15020031
150300        PERFORM 2560-SELECT-INTR-UPC-ID                           15030031
150400        IF SQLCODE = 0                                            15040031
150500          PERFORM 2565-SELECT-XLT-SKU                             15050031
150600        END-IF                                                    15060031
150700      END-IF                                                      15070031
150800     END-IF.                                                      15080031
150900                                                                  15090031
151000     PERFORM 2535-FETCH-LIN-UPC-NBR-CSR.                          15100031
151100                                                                  15110031
151200***   **** PBI3484 MJF 8/31/09 CHANGE #2 START                    15120031
151300***   ADD 1 TO PV-LIN-INDEX                                       15130031
151400***                                                               15140031
151500***   SET PS-PK-SKU-NBR-FOUND-NO TO TRUE                          15150031
151600***   PERFORM 2670-FIND-PACK-SKU-NBR                              15160031
151700***   IF PS-PK-SKU-NBR-FOUND-NO                                   15170031
151800***     SET PS-PK-SKU-NOMATCH TO TRUE                             15180031
151900***     SET PS-END-OF-LIN-UPC-NBR TO TRUE                         15190031
152000***   END-IF                                                      15200031
152100***   **** PBI3484 MJF 8/31/09 CHANGE #2 END                      15210031
152200                                                                  15220031
152300****************************************************************  15230031
152400* FETCH LIN-UPC-NBR-CSR FOR PACK WITH COMPONENTS ONLY             15240031
152500****************************************************************  15250031
152600 2535-FETCH-LIN-UPC-NBR-CSR.                                      15260031
152700                                                                  15270031
152800***  DISPLAY '2535-FETCH-LIN-UPC-NBR-CSR'.                        15280031
152900                                                                  15290031
153000     EXEC SQL                                                     15300031
153100         FETCH LIN-UPC-NBR-CSR                                    15310031
153200          INTO :SNT00001-PRC-LOD-SEQ-NBR,                         15320031
153300               :SNT00001-LOD-DAT-TXT                              15330031
153400     END-EXEC.                                                    15340031
153500                                                                  15350031
153600     EVALUATE TRUE                                                15360031
153700         WHEN SQLCODE = ZERO                                      15370031
153800         SET PS-LIN-FOUND TO TRUE                                 15380031
153900                                                                  15390031
154000         WHEN SQLCODE = +100                                      15400031
154100          SET PS-END-OF-LIN-UPC-NBR  TO TRUE                      15410031
154200          MOVE PV-NEXT-MAN-SEQ-NBR TO PV-NEXT-SEQ-NBR             15420031
154300                                                                  15430031
154400          IF PS-LIN-FOUND-NO                                      15440031
154500            SET PS-COMP-ERROR TO TRUE                             15450031
154600            MOVE 'E'         TO TR211-RPT-TYP                     15460031
154700            MOVE PC-ERROR TO TR211-ERROR-TYPE                     15470031
154800            MOVE 'LIN SEGM-PACK WITH COMPS' TO TR211-DATA-IN-ERROR15480031
154900            MOVE PC-NO-PACK-COMP-ON-ASN     TO TR211-ERROR-MSG    15490031
155000            MOVE PV-PURCHS-PO-NBR   TO TR211-DATA-VALUE           15500031
155100            PERFORM 7400-WRITE-PACK-LEVEL-ERROR                   15510031
155200            PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                    15520031
155300          END-IF                                                  15530031
155400                                                                  15540031
155500         WHEN SQLCODE < ZERO                                      15550031
155600         WHEN SQLCODE > ZERO                                      15560031
155700             MOVE '2535-FETCH-LIN-UPC-NBR-CSR'                    15570031
155800                                     TO PV-PARAGRAPH-NAME         15580031
155900             MOVE 'ERROR FETCHING THE LIN-UPC-NBR'                15590031
156000                                     TO PV-DB2-OPERATION-MESSAGE  15600031
156100             MOVE SPACES             TO PV-DB2-TABLE-NAME-1       15610031
156200             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       15620031
156300             PERFORM 9100-USER-ABEND                              15630031
156400     END-EVALUATE.                                                15640031
156500                                                                  15650031
156600****************************************************************  15660031
156700* FIND THE UPC NUMBER IN THE DATA BLOB COLUMN OF TABLE SNT00001.  15670031
156800****************************************************************  15680031
156900 2540-FIND-UPC-IN-STRING.                                         15690031
157000                                                                  15700031
157100*    DISPLAY '2540-FIND-UPC-IN-STRING'.                           15710031
157200     SET PS-UPC-NBR-FOUND-NO TO TRUE.                             15720031
157300*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         15730031
157400     IF (SNT00001-LOD-DAT-TXT-TEXT(10:2) = 'UP'                   15740031
157500                    OR                                            15750031
157600         SNT00001-LOD-DAT-TXT-TEXT(10:2) = 'EN')                  15760031
157700*** END-MJMCHG-ADD CHECK FOR EAN ********                         15770031
157800      SET PS-UPC-NBR-FOUND TO TRUE                                15780031
157900      MOVE SNT00001-LOD-DAT-TXT-TEXT(12:30)                       15790031
158000           TO PV-DAT-UPC-NBR-X                                    15800031
158100     ELSE                                                         15810031
158200*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         15820031
158300     IF (SNT00001-LOD-DAT-TXT-TEXT(42:2) = 'UP'                   15830031
158400                    OR                                            15840031
158500         SNT00001-LOD-DAT-TXT-TEXT(42:2) = 'EN')                  15850031
158600*** END-MJMCHG-ADD CHECK FOR EAN ********                         15860031
158700        SET PS-UPC-NBR-FOUND TO TRUE                              15870031
158800        MOVE SNT00001-LOD-DAT-TXT-TEXT(44:30)                     15880031
158900             TO PV-DAT-UPC-NBR-X                                  15890031
159000     ELSE                                                         15900031
159100*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         15910031
159200     IF (SNT00001-LOD-DAT-TXT-TEXT(74:2) = 'UP'                   15920031
159300                    OR                                            15930031
159400        SNT00001-LOD-DAT-TXT-TEXT(74:2) = 'EN')                   15940031
159500*** END-MJMCHG-ADD CHECK FOR EAN ********                         15950031
159600        SET PS-UPC-NBR-FOUND TO TRUE                              15960031
159700        MOVE SNT00001-LOD-DAT-TXT-TEXT(76:30)                     15970031
159800             TO PV-DAT-UPC-NBR-X                                  15980031
159900     ELSE                                                         15990031
160000*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         16000031
160100      IF (SNT00001-LOD-DAT-TXT-TEXT(106:2) = 'UP'                 16010031
160200                     OR                                           16020031
160300         SNT00001-LOD-DAT-TXT-TEXT(106:2) = 'EN')                 16030031
160400*** END-MJMCHG-ADD CHECK FOR EAN ********                         16040031
160500        SET PS-UPC-NBR-FOUND TO TRUE                              16050031
160600        MOVE SNT00001-LOD-DAT-TXT-TEXT(108:30)                    16060031
160700             TO PV-DAT-UPC-NBR-X                                  16070031
160800      ELSE                                                        16080031
160900*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         16090031
161000       IF (SNT00001-LOD-DAT-TXT-TEXT(138:2) = 'UP'                16100031
161100                      OR                                          16110031
161200          SNT00001-LOD-DAT-TXT-TEXT(138:2) = 'EN')                16120031
161300*** END-MJMCHG-ADD CHECK FOR EAN ********                         16130031
161400        SET PS-UPC-NBR-FOUND TO TRUE                              16140031
161500        MOVE SNT00001-LOD-DAT-TXT-TEXT(140:30)                    16150031
161600             TO PV-DAT-UPC-NBR-X                                  16160031
161700       ELSE                                                       16170031
161800*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         16180031
161900        IF (SNT00001-LOD-DAT-TXT-TEXT(170:2) = 'UP'               16190031
162000                       OR                                         16200031
162100           SNT00001-LOD-DAT-TXT-TEXT(170:2) = 'EN')               16210031
162200*** END-MJMCHG-ADD CHECK FOR EAN ********                         16220031
162300        SET PS-UPC-NBR-FOUND TO TRUE                              16230031
162400        MOVE SNT00001-LOD-DAT-TXT-TEXT(172:30)                    16240031
162500             TO PV-DAT-UPC-NBR-X                                  16250031
162600        ELSE                                                      16260031
162700*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         16270031
162800         IF (SNT00001-LOD-DAT-TXT-TEXT(202:2) = 'UP'              16280031
162900                        OR                                        16290031
163000            SNT00001-LOD-DAT-TXT-TEXT(202:2) = 'EN')              16300031
163100*** END-MJMCHG-ADD CHECK FOR EAN ********                         16310031
163200         SET PS-UPC-NBR-FOUND TO TRUE                             16320031
163300         MOVE SNT00001-LOD-DAT-TXT-TEXT(204:30)                   16330031
163400             TO PV-DAT-UPC-NBR-X                                  16340031
163500         ELSE                                                     16350031
163600*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         16360031
163700          IF (SNT00001-LOD-DAT-TXT-TEXT(234:2) = 'UP'             16370031
163800                         OR                                       16380031
163900             SNT00001-LOD-DAT-TXT-TEXT(234:2) = 'EN')             16390031
164000*** END-MJMCHG-ADD CHECK FOR EAN ********                         16400031
164100          SET PS-UPC-NBR-FOUND TO TRUE                            16410031
164200          MOVE SNT00001-LOD-DAT-TXT-TEXT(236:30)                  16420031
164300             TO PV-DAT-UPC-NBR-X                                  16430031
164400          ELSE                                                    16440031
164500*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         16450031
164600           IF (SNT00001-LOD-DAT-TXT-TEXT(266:2) = 'UP'            16460031
164700                          OR                                      16470031
164800              SNT00001-LOD-DAT-TXT-TEXT(266:2) = 'EN')            16480031
164900*** END-MJMCHG-ADD CHECK FOR EAN ********                         16490031
165000           SET PS-UPC-NBR-FOUND TO TRUE                           16500031
165100           MOVE SNT00001-LOD-DAT-TXT-TEXT(268:30)                 16510031
165200             TO PV-DAT-UPC-NBR-X                                  16520031
165300           ELSE                                                   16530031
165400*** BEG-MJMCHG-ADD CHECK FOR EAN ********                         16540031
165500            IF (SNT00001-LOD-DAT-TXT-TEXT(298:2) = 'UP'           16550031
165600                           OR                                     16560031
165700               SNT00001-LOD-DAT-TXT-TEXT(298:2) = 'EN')           16570031
165800*** END-MJMCHG-ADD CHECK FOR EAN ********                         16580031
165900            SET PS-UPC-NBR-FOUND TO TRUE                          16590031
166000            MOVE SNT00001-LOD-DAT-TXT-TEXT(300:30)                16600031
166100             TO PV-DAT-UPC-NBR-X                                  16610031
166200              END-IF                                              16620031
166300             END-IF                                               16630031
166400            END-IF                                                16640031
166500           END-IF                                                 16650031
166600          END-IF                                                  16660031
166700         END-IF                                                   16670031
166800        END-IF                                                    16680031
166900       END-IF                                                     16690031
167000      END-IF                                                      16700031
167100     END-IF.                                                      16710031
167200                                                                  16720031
167300****************************************************************  16730031
167400* RIGHT JUSTIFY SNT00001 UPC NUMBER                               16740031
167500****************************************************************  16750031
167600 2545-RIGHT-JUSTIFY-SNT-UPC.                                      16760031
167700                                                                  16770031
167800*    DISPLAY '2545-RIGHT-JUSTIFY-SNT-UPC'.                        16780031
167900     MOVE 16 TO PV-TRIM-SPACE.                                    16790031
168000     PERFORM VARYING PV-COUNTER FROM 1 BY 1                       16800031
168100      UNTIL PV-DAT-UPC-NBR-X(PV-TRIM-SPACE:1)                     16810031
168200           NOT EQUAL SPACES                                       16820031
168300      SUBTRACT 1 FROM PV-TRIM-SPACE                               16830031
168400     END-PERFORM.                                                 16840031
168500                                                                  16850031
168600     IF PV-DAT-UPC-NBR(1:PV-TRIM-SPACE) IS NUMERIC                16860031
168700         MOVE PV-DAT-UPC-NBR(1:PV-TRIM-SPACE)                     16870031
168800                TO XLT00006-UPC-NBR                               16880031
168900          INITIALIZE PV-UPC-NBR-NON-NUMERIC                       16890031
169000     ELSE                                                         16900031
169100          MOVE PV-DAT-UPC-NBR(1:PV-TRIM-SPACE)                    16910031
169200                   TO PV-UPC-NBR-NON-NUMERIC                      16920031
169300     END-IF.                                                      16930031
169400                                                                  16940031
169500****************************************************************  16950031
169600* GET MISC FIELDS FROM SNT_DAT_XFER.                              16960031
169700****************************************************************  16970031
169800 2555-SELECT-MISC-DATXFER.                                        16980031
169900                                                                  16990031
170000     EXEC SQL                                                     17000031
170100        SELECT PRC_LOD_SEQ_NBR,                                   17010031
170200               SUBSTR(LOD_DAT_TXT,10,7),                          17020031
170300               SUBSTR(LOD_DAT_TXT,17,2)                           17030031
170400            INTO :SNT00001-PRC-LOD-SEQ-NBR,                       17040031
170500                 :PV-SN1-RATIO-PCKED-X,                           17050031
170600                 :PV-SN1-SHIP-UM-CDE                              17060031
170700           FROM SNT_DAT_XFER                                      17070031
170800          WHERE DAT_CTG_CDE = 'SN1'                               17080031
170900           AND DAT_XFER_CNTL_ID = :SNT00001-DAT-XFER-CNTL-ID      17090031
171000           AND PRC_LOD_SEQ_NBR  = :PV-NEXT-SEQ-AFT-LIN            17100031
171100     END-EXEC.                                                    17110031
171200                                                                  17120031
171300     EVALUATE TRUE                                                17130031
171400         WHEN SQLCODE = ZERO                                      17140031
171500           MOVE SNT00001-PRC-LOD-SEQ-NBR TO PV-CURR-SN1-SEQ-NBR   17150031
171600           MOVE PV-SN1-RATIO-PCKED TO PV-SN1-SHIP-QTY             17160031
171700           ADD  PV-SN1-RATIO-PCKED TO PV-SN1-TOTAL-SHIP-QTY       17170031
171800                                                                  17180031
171900         WHEN SQLCODE = +100                                      17190031
172000          SET PS-END-OF-LIN-UPC-NBR  TO TRUE                      17200031
172100          SET PS-COMP-ERROR TO TRUE                               17210031
172200          MOVE 'E'         TO TR211-RPT-TYP                       17220031
172300          MOVE PC-ERROR  TO TR211-ERROR-TYPE                      17230031
172400          MOVE 'SN1 SEGM-PACK WITH COMPS' TO TR211-DATA-IN-ERROR  17240031
172500          MOVE PC-NO-COMP-RATIO-ON-ASN    TO TR211-ERROR-MSG      17250031
172600          MOVE PV-PURCHS-PO-NBR TO TR211-DATA-VALUE               17260031
172700          PERFORM 7400-WRITE-PACK-LEVEL-ERROR                     17270031
172800          PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                      17280031
172900                                                                  17290031
173000         WHEN SQLCODE < ZERO                                      17300031
173100         WHEN SQLCODE > ZERO                                      17310031
173200             MOVE '2555-SELECT-MISC-DATXFER'                      17320031
173300                                     TO PV-PARAGRAPH-NAME         17330031
173400             MOVE 'SELECT'           TO PV-DB2-OPERATION-MESSAGE  17340031
173500             MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1       17350031
173600             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       17360031
173700             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       17370031
173800             PERFORM 9100-USER-ABEND                              17380031
173900     END-EVALUATE.                                                17390031
174000                                                                  17400031
174100****************************************************************  17410031
174200* PULL INTR_UPC_ID FROM XLT_UPC                                   17420031
174300****************************************************************  17430031
174400 2560-SELECT-INTR-UPC-ID.                                         17440031
174500                                                                  17450031
174600*    DISPLAY '2560-SELECT-INTR-UPC-ID'.                           17460031
174700                                                                  17470031
174800     EXEC SQL                                                     17480031
174900         SELECT INTR_UPC_ID                                       17490031
175000            INTO :XLT00006-INTR-UPC-ID                            17500031
175100             FROM XLT_UPC                                         17510031
175200          WHERE UPC_NBR = :XLT00006-UPC-NBR                       17520031
175300*CHG0147748 - START                                               17530031
175400            AND EDI_ORD_IND = 'Y'                                 17540031
175500*CHG0147748 - END                                                 17550031
175600     END-EXEC.                                                    17560031
175700                                                                  17570031
175800     EVALUATE TRUE                                                17580031
175900         WHEN SQLCODE = ZERO                                      17590031
176000           CONTINUE                                               17600031
176100                                                                  17610031
176200         WHEN SQLCODE = +100                                      17620031
176300*CHG0165405-START                                                 17630031
176400          PERFORM 2570-SELECT-INTR-UPC-ID                         17640031
176500*CHG0165405-END                                                   17650031
176600*         **** PKE2372 MJF 3/31/11 CHANGE #3 START                17660031
176700***       SET PS-END-OF-LIN-UPC-NBR  TO TRUE                      17670031
176800*         SET PS-COMP-ERROR TO TRUE                               17680031
176900*         MOVE 'E'         TO TR211-RPT-TYP                       17690031
177000*         MOVE PC-ERROR  TO TR211-ERROR-TYPE                      17700031
177100*         MOVE 'COMPONENT UPC' TO TR211-DATA-IN-ERROR             17710031
177200*         MOVE PC-NO-COMP-ON-UPC-TBL  TO TR211-ERROR-MSG          17720031
177300*         MOVE XLT00006-UPC-NBR TO PV-UPC-NBR-DISPLAY             17730031
177400*         MOVE PV-UPC-NBR-DISPLAY TO TR211-DATA-VALUE             17740031
177500*         PERFORM 7400-WRITE-PACK-LEVEL-ERROR                     17750031
177600*         **** PKE2372 MJF 3/31/11                                17760031
177700***       PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                      17770031
177800                                                                  17780031
177900         WHEN SQLWARN0 NOT = SPACES                               17790031
178000         WHEN SQLCODE < ZERO                                      17800031
178100         WHEN SQLCODE > ZERO                                      17810031
178200             MOVE '2560-SELECT-INTR-UPC-ID'                       17820031
178300                                     TO PV-PARAGRAPH-NAME         17830031
178400             MOVE 'ERROR WHILE DOING SELECT'                      17840031
178500                                     TO PV-DB2-OPERATION-MESSAGE  17850031
178600             MOVE 'XLT_UPC'          TO PV-DB2-TABLE-NAME-1       17860031
178700             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       17870031
178800             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       17880031
178900             PERFORM 9100-USER-ABEND                              17890031
179000      END-EVALUATE.                                               17900031
179100                                                                  17910031
179200****************************************************************  17920031
179300* PULL XLT-SKU FROM XLT_SKU.                                      17930031
179400****************************************************************  17940031
179500 2565-SELECT-XLT-SKU.                                             17950031
179600                                                                  17960031
179700*    DISPLAY '2565-SELECT-XLT-SKU'.                               17970031
179800                                                                  17980031
179900     SET PS-PK-SKU-NOMATCH-NO TO TRUE.                            17990031
180000                                                                  18000031
180100     EXEC SQL                                                     18010031
180200        SELECT SKU_NBR                                            18020031
180300           INTO :XLT00003-SKU-NBR                                 18030031
180400            FROM XLT_SKU                                          18040031
180500         WHERE INTR_UPC_ID = :XLT00006-INTR-UPC-ID                18050031
180600     END-EXEC.                                                    18060031
180700                                                                  18070031
180800     EVALUATE TRUE                                                18080031
180900         WHEN SQLCODE = ZERO                                      18090031
181000           MOVE XLT00003-SKU-NBR TO PV-LIN-SKU                    18100031
181100                                    PV-LIN-SKU-DISPLAY            18110031
181200*          *** DISPLAY 'XLT00003-SKU-NBR = ' XLT00003-SKU-NBR     18120031
181300*          **** PBI3484 MJF 8/31/09 CHANGE #1 START               18130031
181400*          **** MOVED COMMENTED LINES HERE - SEE #2 BELOW         18140031
181500           ADD 1 TO PV-LIN-INDEX                                  18150031
181600           SET PS-PK-SKU-NBR-FOUND-NO TO TRUE                     18160031
181700           PERFORM 2670-FIND-PACK-SKU-NBR                         18170031
181800           IF PS-PK-SKU-NBR-FOUND-NO                              18180031
181900             SET PS-PK-SKU-NOMATCH TO TRUE                        18190031
182000           END-IF                                                 18200031
182100*          **** PBI3484 MJF 8/31/09 CHANGE #1 END                 18210031
182200                                                                  18220031
182300         WHEN SQLCODE = +100                                      18230031
182400          SET PS-COMP-ERROR TO TRUE                               18240031
182500          MOVE 'E'         TO TR211-RPT-TYP                       18250031
182600          MOVE PC-ERROR  TO TR211-ERROR-TYPE                      18260031
182700          MOVE 'INTR UPC' TO TR211-DATA-IN-ERROR                  18270031
182800          MOVE PC-NO-COMP-ON-SKU-TBL  TO TR211-ERROR-MSG          18280031
182900          MOVE XLT00006-UPC-NBR TO PV-UPC-NBR-DISPLAY             18290031
183000          MOVE PV-UPC-NBR-DISPLAY TO TR211-DATA-VALUE             18300031
183100          PERFORM 7400-WRITE-PACK-LEVEL-ERROR                     18310031
183200*         **** PKE2372 MJF 3/31/11 CHANGE #4                      18320031
183300***       PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                      18330031
183400                                                                  18340031
183500         WHEN SQLWARN0 NOT = SPACES                               18350031
183600         WHEN SQLCODE < ZERO                                      18360031
183700         WHEN SQLCODE > ZERO                                      18370031
183800             MOVE '2565-SELECT-XLT-SKU'                           18380031
183900                                     TO PV-PARAGRAPH-NAME         18390031
184000             MOVE 'ERROR WHILE DOING SELECT'                      18400031
184100                                     TO PV-DB2-OPERATION-MESSAGE  18410031
184200             MOVE 'XLT_SKU'          TO PV-DB2-TABLE-NAME-1       18420031
184300             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       18430031
184400             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       18440031
184500             PERFORM 9100-USER-ABEND                              18450031
184600      END-EVALUATE.                                               18460031
184700                                                                  18470031
184800*CHG0165405-START                                                 18480031
184900****************************************************************  18490031
185000* PULL INTR_UPC_ID FROM XLT_UPC                                   18500031
185100****************************************************************  18510031
185200 2570-SELECT-INTR-UPC-ID.                                         18520031
185300                                                                  18530031
185400*    DISPLAY '2570-SELECT-INTR-UPC-ID'.                           18540031
185500                                                                  18550031
185600     EXEC SQL                                                     18560031
185700         SELECT INTR_UPC_ID                                       18570031
185800            INTO :XLT00006-INTR-UPC-ID                            18580031
185900             FROM XLT_UPC                                         18590031
186000          WHERE UPC_NBR = :XLT00006-UPC-NBR                       18600031
186100            AND EDI_ORD_IND = 'N'                                 18610031
186200     END-EXEC.                                                    18620031
186300                                                                  18630031
186400     EVALUATE TRUE                                                18640031
186500         WHEN SQLCODE = ZERO                                      18650031
186600           CONTINUE                                               18660031
186700                                                                  18670031
186800         WHEN SQLCODE = +100                                      18680031
186900*         **** PKE2372 MJF 3/31/11 CHANGE #3 START                18690031
187000***       SET PS-END-OF-LIN-UPC-NBR  TO TRUE                      18700031
187100          SET PS-COMP-ERROR TO TRUE                               18710031
187200          MOVE 'E'         TO TR211-RPT-TYP                       18720031
187300          MOVE PC-ERROR  TO TR211-ERROR-TYPE                      18730031
187400          MOVE 'COMPONENT UPC' TO TR211-DATA-IN-ERROR             18740031
187500          MOVE PC-NO-COMP-ON-UPC-TBL  TO TR211-ERROR-MSG          18750031
187600          MOVE XLT00006-UPC-NBR TO PV-UPC-NBR-DISPLAY             18760031
187700          MOVE PV-UPC-NBR-DISPLAY TO TR211-DATA-VALUE             18770031
187800          PERFORM 7400-WRITE-PACK-LEVEL-ERROR                     18780031
187900*         **** PKE2372 MJF 3/31/11                                18790031
188000***       PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                      18800031
188100                                                                  18810031
188200         WHEN SQLWARN0 NOT = SPACES                               18820031
188300         WHEN SQLCODE < ZERO                                      18830031
188400         WHEN SQLCODE > ZERO                                      18840031
188500             MOVE '2570-SELECT-INTR-UPC-ID'                       18850031
188600                                     TO PV-PARAGRAPH-NAME         18860031
188700             MOVE 'ERROR WHILE DOING SELECT'                      18870031
188800                                     TO PV-DB2-OPERATION-MESSAGE  18880031
188900             MOVE 'XLT_UPC'          TO PV-DB2-TABLE-NAME-1       18890031
189000             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       18900031
189100             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       18910031
189200             PERFORM 9100-USER-ABEND                              18920031
189300      END-EVALUATE.                                               18930031
189400                                                                  18940031
189500*CHG0165405-END                                                   18950031
189600****************************************************************  18960031
189700* OPEN PRF-PO-NBR-CSR                                             18970031
189800****************************************************************  18980031
189900 2600-OPEN-PRF-PO-NBR-CSR.                                        18990031
190000*    DISPLAY '2600-OPEN-PRF-PO-NBR-CSRC'.                         19000031
190100                                                                  19010031
190200     EXEC SQL                                                     19020031
190300          OPEN PRF-PO-NBR-CSR                                     19030031
190400     END-EXEC.                                                    19040031
190500                                                                  19050031
190600     EVALUATE TRUE                                                19060031
190700         WHEN SQLCODE = ZERO                                      19070031
190800*AME* 7/28/08 NEXT LINE ADDED                                     19080031
190900             SET PS-PRF-PO-NBR-CSR-OPEN TO TRUE                   19090031
191000         WHEN SQLWARN0 NOT = SPACES                               19100031
191100         WHEN SQLCODE < ZERO                                      19110031
191200         WHEN SQLCODE > ZERO                                      19120031
191300             MOVE '2600-OPEN-PRF-PO-NBR-CSR'                      19130031
191400                                     TO PV-PARAGRAPH-NAME         19140031
191500             MOVE 'ATTEMPTING TO OPEN THE PRF-PO-NUMBER CSR'      19150031
191600                                     TO PV-DB2-OPERATION-MESSAGE  19160031
191700             MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1       19170031
191800             MOVE '       '          TO PV-DB2-TABLE-NAME-2       19180031
191900             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       19190031
192000             PERFORM 9100-USER-ABEND                              19200031
192100     END-EVALUATE.                                                19210031
192200                                                                  19220031
192300*CHG102494 - START                                                19230031
192400****************************************************************  19240031
192500* RETRIEVES ALL PO'S FOR AN ASN AND CHECK IF IT IS NUMERIC.       19250031
192600* IF PO IS NOT NUMERIC THEN THE ASN IS ERRORED OUT AND IT WILL    19260031
192700* BE SKIPPED FROM PROCESSING.                                     19270031
192800****************************************************************  19280031
192900 2605-FETCH-PRF-PO-NBR-CSR.                                       19290031
193000                                                                  19300031
193100     EXEC SQL                                                     19310031
193200         FETCH PRF-PO-NBR-CSR                                     19320031
193300          INTO :SNT00001-DAT-XFER-CNTL-ID,                        19330031
193400               :SNT00001-PRC-LOD-SEQ-NBR,                         19340031
193500               :SNT00001-DAT-CTG-CDE,                             19350031
193600               :PV-PURCHS-PO-NBR                                  19360031
193700     END-EXEC                                                     19370031
193800                                                                  19380031
193900         EVALUATE TRUE                                            19390031
194000         WHEN SQLCODE = ZERO                                      19400031
194100           IF PV-PURCHS-PO-NBR NOT EQUAL SPACES                   19410031
194200              MOVE 9                       TO PV-TRIM-SPACE       19420031
194300              PERFORM VARYING PV-COUNTER FROM 1 BY 1              19430031
194400                UNTIL PV-PURCHS-PO-NBR(PV-TRIM-SPACE:1)           19440031
194500                         NOT EQUAL SPACES                         19450031
194600                 SUBTRACT 1 FROM PV-TRIM-SPACE                    19460031
194700              END-PERFORM                                         19470031
194800             IF PV-PURCHS-PO-NBR(1:PV-TRIM-SPACE) NOT NUMERIC     19480031
194900                MOVE 'INVALID PO NUMBER - CONTACT VENDOR'         19490031
195000                                           TO TR211-ERROR-MSG     19500031
195100                SET PS-DATA-IN-ERROR       TO TRUE                19510031
195200                PERFORM 2620-GET-CNTR-RECORD                      19520031
195300                MOVE 'E'                   TO TR211-RPT-TYP       19530031
195400                MOVE PC-ERROR              TO TR211-ERROR-TYPE    19540031
195500                MOVE TR023-CNTR-TRN-TYP    TO TR211-TRN-TYP       19550031
195600                MOVE 'PO NUMBER      '     TO TR211-DATA-IN-ERROR 19560031
195700                MOVE PV-PURCHS-PO-NBR(1:PV-TRIM-SPACE)            19570031
195800                                           TO TR211-DATA-VALUE    19580031
195900                MOVE TR063-ISA-CNTL-NBR-SEQ-ID                    19590031
196000                                 TO TR211-HDR-CONSOL-FIL-ID       19600031
196100                MOVE 'CONPOA'    TO TR211-REC-TYP-CONPOA-CDE      19610031
196200                MOVE '30'        TO TR211-SEQ-NBR-CONPOA          19620031
196300                MOVE SPACES      TO TR211-CONPOA-PO-ACTL-DELY-DTE 19630031
196400                MOVE ZEROES      TO TR211-CONPOA-EXTL-REF-NBR     19640031
196500                MOVE ZEROES      TO TR211-CONPOA-CART-CNT         19650031
196600                MOVE ZEROES      TO TR211-CONPOA-UNT-QTY          19660031
196700                MOVE ZEROES      TO TR211-CONPOA-CBMT-QTY         19670031
196800                MOVE ZEROES      TO TR211-CONPOA-WT-KGRM-QTY      19680031
196900                PERFORM 6200-WRITE-ERR-REPORT                     19690031
197000             END-IF                                               19700031
197100           END-IF                                                 19710031
197200                                                                  19720031
197300         WHEN SQLCODE = +100                                      19730031
197400             IF PS-DATA-IN-ERROR                                  19740031
197500                PERFORM 6000-READ-ASN-FILE                        19750031
197600                PERFORM 6010-BYPASS-TO-NEXT-ID                    19760031
197700             END-IF                                               19770031
197800             SET PS-END-OF-PRF-PO-NBR TO TRUE                     19780031
197900         WHEN SQLWARN0 NOT = SPACES                               19790031
198000         WHEN SQLCODE < ZERO                                      19800031
198100         WHEN SQLCODE > ZERO                                      19810031
198200             MOVE '2605-FETCH-PRF-PO-NBR-CSR'                     19820031
198300                                      TO PV-PARAGRAPH-NAME        19830031
198400             MOVE 'ERROR FETCHING PRF SEGM'                       19840031
198500                                      TO PV-DB2-OPERATION-MESSAGE 19850031
198600             MOVE SPACES              TO PV-DB2-TABLE-NAME-1      19860031
198700             MOVE SPACES              TO PV-DB2-TABLE-NAME-3      19870031
198800             PERFORM 9100-USER-ABEND                              19880031
198900         END-EVALUATE.                                            19890031
199000                                                                  19900031
199100*CHG102494 - END                                                  19910031
199200****************************************************************  19920031
199300* FETCH PRF-PO-NBR-CSR                                            19930031
199400****************************************************************  19940031
199500 2610-FETCH-PRF-PO-NBR-CSR.                                       19950031
199600*    DISPLAY '2610-FETCH-PRF-PO-NBR-CSR'.                         19960031
199700                                                                  19970031
199800     MOVE 'N' TO PS-PO-MATCH-SW.                                  19980031
199900                                                                  19990031
200000     EXEC SQL                                                     20000031
200100         FETCH PRF-PO-NBR-CSR                                     20010031
200200          INTO :SNT00001-DAT-XFER-CNTL-ID,                        20020031
200300               :SNT00001-PRC-LOD-SEQ-NBR,                         20030031
200400               :SNT00001-DAT-CTG-CDE,                             20040031
200500               :PV-PURCHS-PO-NBR                                  20050031
200600     END-EXEC                                                     20060031
200700                                                                  20070031
200800     EVALUATE TRUE                                                20080031
200900         WHEN SQLCODE = ZERO                                      20090031
201000          MOVE SNT00001-PRC-LOD-SEQ-NBR TO PV-CURR-PRF-SEQ-NBR    20100031
201100*          RIGHT JUSTIFY NUMERIC PURCHASE ORDER                   20110031
201200           IF PV-PURCHS-PO-NBR NOT EQUAL SPACES                   20120031
201300*          ***DISPLAY 'PV-CONPO-PO-NBR ' PV-CONPO-PO-NBR          20130031
201400*          ***DISPLAY 'PV-PURCHS-PO-NBR' PV-PURCHS-PO-NBR         20140031
201500              MOVE 9 TO PV-TRIM-SPACE                             20150031
201600              PERFORM VARYING PV-COUNTER FROM 1 BY 1              20160031
201700                UNTIL PV-PURCHS-PO-NBR(PV-TRIM-SPACE:1)           20170031
201800                         NOT EQUAL SPACES                         20180031
201900                 SUBTRACT 1 FROM PV-TRIM-SPACE                    20190031
202000              END-PERFORM                                         20200031
202100              MOVE PV-PURCHS-PO-NBR(1:PV-TRIM-SPACE)              20210031
202200                                    TO PV-CONPO-PO-NBR            20220031
202300           END-IF                                                 20230031
202400                                                                  20240031
202500          MOVE PV-CONPO-PO-NBR TO PURCHS-PO-NBR                   20250031
202600*      ***DISPLAY 'PURCHS-PO-NBR' PURCHS-PO-NBR                   20260031
202700*      ***DISPLAY 'PV-CONPO-PO-NBR ' PV-CONPO-PO-NBR              20270031
202800          SET PS-PO-MATCH-FOUND TO TRUE                           20280031
202900                                                                  20290031
203000         WHEN SQLCODE = +100                                      20300031
203100*   DISPLAY '**************************************'              20310031
203200*   DISPLAY '**SNT00001-DAT-XFER-CNTL='SNT00001-DAT-XFER-CNTL-ID  20320031
203300*   DISPLAY '** DAT_CTG_CDE      = ' DAT-CTG-CDE                  20330031
203400*   DISPLAY '**PRC_LOD_SEQ_NBR   =' PRC-LOD-SEQ-NBR               20340031
203500*   DISPLAY '**PV-CURR-PRF-SEQ-NBR=' PV-CURR-PRF-SEQ-NBR          20350031
203600*   DISPLAY '**************************************'              20360031
203700            SET PS-END-OF-PRF-PO-NBR TO TRUE                      20370031
203800            IF PS-FIRST-PRF-XFER OR PS-FIRST-LIN                  20380031
203900             SET PS-FIRST-PRF-XFER-NO TO TRUE                     20390031
204000             SET PS-COMP-ERROR TO TRUE                            20400031
204100             MOVE 'E'         TO TR211-RPT-TYP                    20410031
204200             MOVE PC-ERROR   TO TR211-ERROR-TYPE                  20420031
204300             MOVE 'PO NUMBER' TO TR211-DATA-IN-ERROR              20430031
204400             MOVE                                                 20440031
204500              'DATA NOT FOUND ON ASN TABLE-CONTACT PROGRAMMING'   20450031
204600                  TO TR211-ERROR-MSG                              20460031
204700              MOVE PV-PURCHS-PO-NBR TO TR211-DATA-VALUE           20470031
204800              PERFORM 7300-WRITE-PO-LEVEL-ERROR                   20480031
204900*    SAVE ERROR TO BE WRITEN WHEN WORK TABLE IS UNLOADED          20490031
205000              PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                  20500031
205100            END-IF                                                20510031
205200                                                                  20520031
205300         WHEN SQLWARN0 NOT = SPACES                               20530031
205400         WHEN SQLCODE < ZERO                                      20540031
205500         WHEN SQLCODE > ZERO                                      20550031
205600            MOVE '2610-FETCH-PRF-PO-NBR-CSR'                      20560031
205700                                     TO PV-PARAGRAPH-NAME         20570031
205800            MOVE 'ERROR FETCHING WITH THE PFK-PO-NBR'             20580031
205900                                     TO PV-DB2-OPERATION-MESSAGE  20590031
206000            MOVE SPACES             TO PV-DB2-TABLE-NAME-1        20600031
206100            MOVE SPACES             TO PV-DB2-TABLE-NAME-3        20610031
206200            PERFORM 9100-USER-ABEND                               20620031
206300     END-EVALUATE.                                                20630031
206400                                                                  20640031
206500     IF PS-PO-MATCH-FOUND                                         20650031
206600      IF PS-FIRST-PRF-XFER                                        20660031
206700      MOVE 0 TO PV-CURR-PRF-SEQ-NBR                               20670031
206800                                                                  20680031
206900       EXEC SQL                                                   20690031
207000          SELECT PO_TYP_CDE                                       20700031
207100          INTO :PURCHS-PO-TYP-CDE                                 20710031
207200          FROM TPURCHS                                            20720031
207300          WHERE PO_NBR = :PURCHS-PO-NBR                           20730031
207400            AND VER_STATUS_CDE = 'A'                              20740031
207500       END-EXEC                                                   20750031
207600                                                                  20760031
207700       EVALUATE TRUE                                              20770031
207800           WHEN SQLCODE = ZERO                                    20780031
207900            IF PURCHS-PO-TYP-CDE = 'IM' OR                        20790031
208000               PURCHS-PO-TYP-CDE = 'IE' OR                        20800031
208100               PURCHS-PO-TYP-CDE = 'IF'                           20810031
208200                MOVE 'A' TO TR023-CNTR-TRIP-TYP-CDE-MOM           20820031
208300            ELSE                                                  20830031
208400            IF PURCHS-PO-TYP-CDE = 'LD' OR                        20840031
208500               PURCHS-PO-TYP-CDE = 'LE' OR                        20850031
208600***            *** START RFQ 7853 **********************          20860031
208700***            *** ADD NEXT 2 LINES ALLOW ECOM POS   *****        20870031
208800               PURCHS-PO-TYP-CDE = 'IE' OR                        20880031
208900               PURCHS-PO-TYP-CDE = 'EC' OR                        20890031
209000***            ***   END RFQ 7853 **********************          20900031
209100               PURCHS-PO-TYP-CDE = 'ST'                           20910031
209200                MOVE 'O' TO TR023-CNTR-TRIP-TYP-CDE-MOM           20920031
209300            ELSE                                                  20930031
209400                SET PS-COMP-ERROR TO TRUE                         20940031
209500                MOVE 'E'         TO TR211-RPT-TYP                 20950031
209600                MOVE 'PO-TYPE-CODE' TO TR211-DATA-IN-ERROR        20960031
209700                MOVE 'PO NOT AIR OR LANDED ON KOHL''S PO'         20970031
209800                         TO TR211-ERROR-MSG                       20980031
209900                MOVE PV-PURCHS-PO-NBR TO TR211-DATA-VALUE         20990031
210000*    SAVE ERROR TO BE WRITEN WHEN WORK TABLE IS UNLOADED          21000031
210100                PERFORM 7300-WRITE-PO-LEVEL-ERROR                 21010031
210200               PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                 21020031
210300            END-IF                                                21030031
210400            END-IF                                                21040031
210500                                                                  21050031
210600           WHEN SQLCODE = +100                                    21060031
210700                  SET PS-COMP-ERROR TO TRUE                       21070031
210800                  MOVE 'E'         TO TR211-RPT-TYP               21080031
210900                  MOVE PC-ERROR     TO TR211-ERROR-TYPE           21090031
211000                  MOVE 'PO NUMBER'   TO TR211-DATA-IN-ERROR       21100031
211100                  MOVE 'PO NOT FOUND ON KOHL''S PO TABLE'         21110031
211200                       TO TR211-ERROR-MSG                         21120031
211300                  MOVE PV-PURCHS-PO-NBR TO TR211-DATA-VALUE-N     21130031
211400*    SAVE ERROR TO BE WRITEN WHEN WORK TABLE IS UNLOADED          21140031
211500               PERFORM 7300-WRITE-PO-LEVEL-ERROR                  21150031
211600               PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                 21160031
211700*CHG0112220 - START                                               21170031
211800               INITIALIZE PV-PREV-RECORD-LEVEL-CDE                21180031
211900*CHG0112220 - END                                                 21190031
212000                                                                  21200031
212100           WHEN SQLWARN0 NOT = SPACES                             21210031
212200           WHEN SQLCODE < ZERO                                    21220031
212300           WHEN SQLCODE > ZERO                                    21230031
212400                  MOVE '2610-FETCH-PRF-PO-NBR-CSR'                21240031
212500                                 TO PV-PARAGRAPH-NAME             21250031
212600                  MOVE 'ERROR WHILE DOING A SELECT'               21260031
212700                                    TO PV-DB2-OPERATION-MESSAGE   21270031
212800                  MOVE 'TPURCHS'          TO PV-DB2-TABLE-NAME-1  21280031
212900                  MOVE SPACES    TO PV-DB2-TABLE-NAME-2           21290031
213000                  MOVE SPACES    TO PV-DB2-TABLE-NAME-3           21300031
213100                  PERFORM 9100-USER-ABEND                         21310031
213200           END-EVALUATE                                           21320031
213300         END-IF                                                   21330031
213400                                                                  21340031
213500         IF PS-FIRST-PRF-XFER-NO                                  21350031
213600         EXEC SQL                                                 21360031
213700          FETCH PRF-PO-NBR-CSR                                    21370031
213800          INTO :SNT00001-DAT-XFER-CNTL-ID,                        21380031
213900               :SNT00001-PRC-LOD-SEQ-NBR,                         21390031
214000               :SNT00001-DAT-CTG-CDE,                             21400031
214100               :PV-PURCHS-PO-NBR                                  21410031
214200         END-EXEC                                                 21420031
214300                                                                  21430031
214400         EVALUATE TRUE                                            21440031
214500         WHEN SQLCODE = ZERO                                      21450031
214600          MOVE SNT00001-PRC-LOD-SEQ-NBR TO PV-NEXT-PRF-SEQ-NBR    21460031
214700*      ***DISPLAY 'PV-PURCHS-PO-NBR ' PV-PURCHS-PO-NBR            21470031
214800                                                                  21480031
214900         WHEN SQLCODE = +100                                      21490031
215000            SET PS-END-OF-PRF-PO-NBR TO TRUE                      21500031
215100            MOVE +999999999 TO PV-NEXT-PRF-SEQ-NBR                21510031
215200         WHEN SQLWARN0 NOT = SPACES                               21520031
215300         WHEN SQLCODE < ZERO                                      21530031
215400         WHEN SQLCODE > ZERO                                      21540031
215500             MOVE '2610-FETCH-PRF-PO-NBR-CSR'                     21550031
215600                                     TO PV-PARAGRAPH-NAME         21560031
215700             MOVE 'ERROR FETCHING 2ND PRF SEGM'                   21570031
215800                                     TO PV-DB2-OPERATION-MESSAGE  21580031
215900             MOVE SPACES             TO PV-DB2-TABLE-NAME-1       21590031
216000             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       21600031
216100             PERFORM 9100-USER-ABEND                              21610031
216200         END-EVALUATE                                             21620031
216300       END-IF                                                     21630031
216400        SET PS-FIRST-PRF-XFER-NO TO TRUE                          21640031
216500       END-IF.                                                    21650031
216600                                                                  21660031
216700* ***DISPLAY 'SNT00001-DAT-XFER-CNTL-ID '                         21670031
216800* ***                                  SNT00001-DAT-XFER-CNTL-ID. 21680031
216900* ***DISPLAY 'SNT00001-PRC-LOD-SEQ-NBR '                          21690031
217000* ***                                  SNT00001-PRC-LOD-SEQ-NBR.  21700031
217100* ***DISPLAY 'SNT00001-DAT-CTG-CDE '   SNT00001-DAT-CTG-CDE.      21710031
217200* ***DISPLAY 'PV-PURCHS-PO-NBR '       PV-PURCHS-PO-NBR.          21720031
217300                                                                  21730031
217400                                                                  21740031
217500****************************************************************  21750031
217600* CLOSE PFK-PO-NBR-CSR                                            21760031
217700****************************************************************  21770031
217800 2615-CLOSE-PRF-PO-NBR-CSR.                                       21780031
217900*    DISPLAY '2615-CLOSE-PRF-PO-NBR-CSR'.                         21790031
218000                                                                  21800031
218100         EXEC SQL                                                 21810031
218200              CLOSE PRF-PO-NBR-CSR                                21820031
218300         END-EXEC.                                                21830031
218400                                                                  21840031
218500     EVALUATE TRUE                                                21850031
218600         WHEN SQLCODE = ZERO                                      21860031
218700*AME* 7/28/08 NEXT LINE ADDED                                     21870031
218800             SET PS-PRF-PO-NBR-CSR-OPEN-NO TO TRUE                21880031
218900         WHEN SQLWARN0 NOT = SPACES                               21890031
219000         WHEN SQLCODE < ZERO                                      21900031
219100         WHEN SQLCODE > ZERO                                      21910031
219200             MOVE '2615-CLOSE-PRF-PO-NBR-CSR'                     21920031
219300                                     TO PV-PARAGRAPH-NAME         21930031
219400             MOVE 'ATTEMPTING TO CLOSE THE PRF-PO-NBR-CSR'        21940031
219500                                     TO PV-DB2-OPERATION-MESSAGE  21950031
219600             MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1       21960031
219700             MOVE SPACES       TO PV-DB2-TABLE-NAME-2             21970031
219800             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       21980031
219900             PERFORM 9100-USER-ABEND                              21990031
220000     END-EVALUATE.                                                22000031
220100                                                                  22010031
220200*CHG102494 - START                                                22020031
220300****************************************************************  22030031
220400* RETRIEVES THE CONTAINER NUMBER FOR NON NUMERIC PO.              22040031
220500****************************************************************  22050031
220600 2620-GET-CNTR-RECORD.                                            22060031
220700                                                                  22070031
220800     EXEC SQL                                                     22080031
220900        SELECT SUBSTR(LOD_DAT_TXT,6,14)                           22090031
221000          INTO :TR211-CONTNR-ID                                   22100031
221100          FROM SNT_DAT_XFER                                       22110031
221200         WHERE DAT_XFER_CNTL_ID = :SNT00001-DAT-XFER-CNTL-ID      22120031
221300           AND DAT_CTG_CDE      = 'TD3'                           22130031
221400           AND PRC_LOD_SEQ_NBR  > :PV-CURR-SEQ-NBR                22140031
221500     END-EXEC                                                     22150031
221600                                                                  22160031
221700         EVALUATE TRUE                                            22170031
221800         WHEN SQLCODE = ZERO                                      22180031
221900         WHEN SQLCODE = -811                                      22190031
222000         WHEN SQLCODE = +100                                      22200031
222100             CONTINUE                                             22210031
222200         WHEN SQLWARN0 NOT = SPACES                               22220031
222300         WHEN SQLCODE < ZERO                                      22230031
222400         WHEN SQLCODE > ZERO                                      22240031
222500             MOVE '2620-GET-CNTR-RECORD'                          22250031
222600                                     TO PV-PARAGRAPH-NAME         22260031
222700             MOVE 'ERROR FETCHING TD3 SEGM'                       22270031
222800                                     TO PV-DB2-OPERATION-MESSAGE  22280031
222900             MOVE SPACES             TO PV-DB2-TABLE-NAME-1       22290031
223000             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       22300031
223100             PERFORM 9100-USER-ABEND                              22310031
223200         END-EVALUATE.                                            22320031
223300                                                                  22330031
223400*CHG102494 - END                                                  22340031
223500****************************************************************  22350031
223600* SELECT INNER PACK UNIT QUANTITY                                 22360031
223700****************************************************************  22370031
223800*THIS PARAGRAPH ADDED 7/22/2008 *AME                              22380031
223900 2630-SELECT-INPK-UNT-QTY.                                        22390031
224000*    DISPLAY '2630-SELECT-INPK-UNT-QTY'.                          22400031
224100                                                                  22410031
224200     EXEC SQL                                                     22420031
224300       SELECT INPK_UNT_QTY                                        22430031
224400         INTO :POPRPK-INPK-UNT-QTY                                22440031
224500         FROM TPOPRPK                                             22450031
224600        WHERE PO_NBR        = :POPRPK-PO-NBR                      22460031
224700          AND PREPK_UPC_NBR = :POPRPK-PREPK-UPC-NBR               22470031
224800     END-EXEC                                                     22480031
224900                                                                  22490031
225000       EVALUATE TRUE                                              22500031
225100         WHEN SQLCODE = ZERO                                      22510031
225200            SET PS-INNER-PACK-FND      TO TRUE                    22520031
225300         WHEN SQLCODE = +100                                      22530031
225400            SET PS-INNER-PACK-FND-NO   TO TRUE                    22540031
225500*        ***DISPLAY 'POPRPK-PO-NBR '        POPRPK-PO-NBR         22550031
225600*        ***DISPLAY 'POPRPK-PREPK-UPC-NBR ' POPRPK-PREPK-UPC-NBR  22560031
225700                                                                  22570031
225800          WHEN SQLWARN0 NOT = SPACES                              22580031
225900          WHEN SQLCODE < ZERO                                     22590031
226000          WHEN SQLCODE > ZERO                                     22600031
226100*        ***DISPLAY 'POPRPK-PO-NBR '        POPRPK-PO-NBR         22610031
226200*        ***DISPLAY 'POPRPK-PREPK-UPC-NBR ' POPRPK-PREPK-UPC-NBR  22620031
226300            MOVE '2630-SELECT-INPK-UNT-QTY'                       22630031
226400                  TO PV-PARAGRAPH-NAME                            22640031
226500            MOVE 'ERROR WHILE SELECTING INNER PACK'               22650031
226600                  TO PV-DB2-OPERATION-MESSAGE                     22660031
226700            MOVE 'TPOPRPK'     TO PV-DB2-TABLE-NAME-1             22670031
226800            MOVE SPACES        TO PV-DB2-TABLE-NAME-2             22680031
226900            MOVE SPACES        TO PV-DB2-TABLE-NAME-3             22690031
227000            PERFORM 9100-USER-ABEND                               22700031
227100       END-EVALUATE.                                              22710031
227200****************************************************************  22720031
227300* OPEN MAN-UPC-NBR-CSR                                            22730031
227400****************************************************************  22740031
227500 2640-OPEN-MAN-UPC-NBR-CSR.                                       22750031
227600*    DISPLAY '2640-OPEN-MAN-UPC-NBR-CSR'.                         22760031
227700                                                                  22770031
227800     EXEC SQL                                                     22780031
227900          OPEN MAN-UPC-NBR-CSR                                    22790031
228000     END-EXEC.                                                    22800031
228100                                                                  22810031
228200     EVALUATE TRUE                                                22820031
228300         WHEN SQLCODE = ZERO                                      22830031
228400             CONTINUE                                             22840031
228500         WHEN SQLWARN0 NOT = SPACES                               22850031
228600         WHEN SQLCODE < ZERO                                      22860031
228700         WHEN SQLCODE > ZERO                                      22870031
228800             MOVE '2640-OPEN-MAN-UPC-NBR-CSR'                     22880031
228900                                     TO PV-PARAGRAPH-NAME         22890031
229000             MOVE 'ATTEMPTING TO OPEN THE MAN-UPC-NUMBER CSR'     22900031
229100                                     TO PV-DB2-OPERATION-MESSAGE  22910031
229200             MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1       22920031
229300             MOVE '       '          TO PV-DB2-TABLE-NAME-2       22930031
229400             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       22940031
229500             PERFORM 9100-USER-ABEND                              22950031
229600     END-EVALUATE.                                                22960031
229700                                                                  22970031
229800****************************************************************  22980031
229900* CLOSE MAN-UPC-NBR-CSR                                           22990031
230000****************************************************************  23000031
230100 2650-CLOSE-MAN-UPC-NBR-CSR.                                      23010031
230200*    DISPLAY '2650-CLOSE-MAN-UPC-NBR-CSR'.                        23020031
230300                                                                  23030031
230400         EXEC SQL                                                 23040031
230500              CLOSE MAN-UPC-NBR-CSR                               23050031
230600         END-EXEC.                                                23060031
230700                                                                  23070031
230800     EVALUATE TRUE                                                23080031
230900         WHEN SQLCODE = ZERO                                      23090031
231000             CONTINUE                                             23100031
231100         WHEN SQLWARN0 NOT = SPACES                               23110031
231200         WHEN SQLCODE < ZERO                                      23120031
231300         WHEN SQLCODE > ZERO                                      23130031
231400             MOVE '2650-CLOSE-MAN-UPC-NBR-CSR'                    23140031
231500                                     TO PV-PARAGRAPH-NAME         23150031
231600             MOVE 'ATTEMPTING TO CLOSE THE MAN-UPC-NBR-CSR'       23160031
231700                                     TO PV-DB2-OPERATION-MESSAGE  23170031
231800             MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1       23180031
231900             MOVE SPACES       TO PV-DB2-TABLE-NAME-2             23190031
232000             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       23200031
232100             PERFORM 9100-USER-ABEND                              23210031
232200     END-EVALUATE.                                                23220031
232300                                                                  23230031
232400****************************************************************  23240031
232500* FIND PK_SKU_NBR FROM XLT_PK_CPT_SKU                             23250031
232600****************************************************************  23260031
232700 2670-FIND-PACK-SKU-NBR.                                          23270031
232800*    DISPLAY '2670-FIND-PACK-SKU-NBR'.                            23280031
232900                                                                  23290031
233000     EXEC SQL                                                     23300031
233100           SELECT A.PK_SKU_NBR                                    23310031
233200             INTO :XLT00008-PK-SKU-NBR                            23320031
233300               FROM XLT_PK_CPT_SKU  A,                            23330031
233400                    TPOPRPK         B                             23340031
233500            WHERE A.PK_SKU_NBR       = B.PK_SKU_NBR  AND          23350031
233600                  B.PO_NBR           = :PURCHS-PO-NBR AND         23360031
233700                  B.PREPK_STAT_CDE   = 'A'           AND          23370031
233800                  A.CPT_SKU_NBR      = :PV-LIN-SKU   AND          23380031
233900                  A.PK_RATIO_UNT_QTY = :PV-SN1-SHIP-QTY           23390031
234000     END-EXEC                                                     23400031
234100                                                                  23410031
234200     EVALUATE TRUE                                                23420031
234300         WHEN SQLCODE = ZERO                                      23430031
234400*       ***DISPLAY 'PURCHS-PO-NBR ' PURCHS-PO-NBR                 23440031
234500*       ***DISPLAY 'PV-PREV-PK-SKU =' PV-PREV-PK-SKU              23450031
234600*       ***DISPLAY 'XLT00008-PK-SKU-NBR =' XLT00008-PK-SKU-NBR    23460031
234700           IF PV-PREV-PK-SKU = ZERO                               23470031
234800              MOVE XLT00008-PK-SKU-NBR TO PV-PREV-PK-SKU          23480031
234900           END-IF                                                 23490031
235000           IF XLT00008-PK-SKU-NBR = PV-PREV-PK-SKU                23500031
235100              SET PS-PK-SKU-NBR-FOUND TO TRUE                     23510031
235200           ELSE                                                   23520031
235300              SET PS-COMP-ERROR TO TRUE                           23530031
235400              MOVE 'E'         TO TR211-RPT-TYP                   23540031
235500              MOVE PC-ERROR TO TR211-ERROR-TYPE                   23550031
235600              MOVE PV-LIN-SKU-DISPLAY TO TR211-DATA-VALUE         23560031
235700              MOVE 'PK-SKU FOR CPT-SKU'                           23570031
235800                   TO TR211-DATA-IN-ERROR                         23580031
235900              MOVE                                                23590031
236000                'ASN COMPONENT SKU ON WRONG KOHLS PACK SKU'       23600031
236100                         TO TR211-ERROR-MSG                       23610031
236200              PERFORM 7400-WRITE-PACK-LEVEL-ERROR                 23620031
236300              PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                  23630031
236400           END-IF                                                 23640031
236500                                                                  23650031
236600         WHEN SQLCODE = +100                                      23660031
236700            SET PS-COMP-ERROR TO TRUE                             23670031
236800            MOVE 'E'         TO TR211-RPT-TYP                     23680031
236900            MOVE PC-ERROR  TO TR211-ERROR-TYPE                    23690031
237000            MOVE PV-LIN-SKU-DISPLAY TO TR211-DATA-VALUE           23700031
237100            MOVE 'CPT-SKU'                                        23710031
237200                 TO TR211-DATA-IN-ERROR                           23720031
237300            MOVE                                                  23730031
237400             'NO KOHL''S PACK SKU FOR ASN COMPONENT SKU'          23740031
237500                 TO TR211-ERROR-MSG                               23750031
237600*       ***DISPLAY '*********************************************'23760031
237700*       ***DISPLAY '***+100 2670-FIND-PACK-SKU-NBR***************'23770031
237800*       ***DISPLAY 'PURCHS-PO-NBR  ='  PURCHS-PO-NBR              23780031
237900*       ***DISPLAY 'PV-LIN-SKU     ='  PV-LIN-SKU                 23790031
238000*       **DISPLAY 'PV-SN1-SHIP-QTY='  PV-SN1-SHIP-QTY             23800031
238100*       **DISPLAY '*********************************************' 23810031
238200*AME      DISPLAY '*********************************************' 23820031
238300            PERFORM 7400-WRITE-PACK-LEVEL-ERROR                   23830031
238400            PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                    23840031
238500         WHEN SQLCODE = -811                                      23850031
238600            SET PS-COMP-ERROR TO TRUE                             23860031
238700            MOVE 'E'         TO TR211-RPT-TYP                     23870031
238800            MOVE PC-ERROR  TO TR211-ERROR-TYPE                    23880031
238900            MOVE PV-LIN-SKU-DISPLAY TO TR211-DATA-VALUE           23890031
239000            MOVE 'MORE THAN 1 CPT_SKU ON XLT_PK_CPT_SKU'          23900031
239100                 TO TR211-DATA-IN-ERROR                           23910031
239200            MOVE                                                  23920031
239300           'COMPOUND PCK FOUND, NOT PROCESSED' TO TR211-ERROR-MSG 23930031
239400            PERFORM 7400-WRITE-PACK-LEVEL-ERROR                   23940031
239500*CHG0166764-START                                                 23950031
239600            IF PS-EXCEPTION-WRITTEN-NO                            23960031
239700*CHG0166764-END                                                   23970031
239800            PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                    23980031
239900*CHG0166764-START                                                 23990031
240000            SET PS-EXCEPTION-WRITTEN TO TRUE                      24000031
240100            END-IF                                                24010031
240200*CHG0166764-END                                                   24020031
240300                                                                  24030031
240400         WHEN SQLWARN0 NOT = SPACES                               24040031
240500         WHEN SQLCODE < ZERO                                      24050031
240600         WHEN SQLCODE > ZERO                                      24060031
240700             MOVE '2670-FIND-PACK-SKU-NBR'                        24070031
240800                                     TO PV-PARAGRAPH-NAME         24080031
240900             MOVE 'ERROR WHILE DOING SELECT'                      24090031
241000                                     TO PV-DB2-OPERATION-MESSAGE  24100031
241100             MOVE 'XLT_PK_CPT_SKU'   TO PV-DB2-TABLE-NAME-1       24110031
241200             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       24120031
241300             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       24130031
241400             PERFORM 9100-USER-ABEND                              24140031
241500      END-EVALUATE.                                               24150031
241600                                                                  24160031
241700****************************************************************  24170031
241800* FIND PACK UPC_NBR FROM XLT_PK_UPC                               24180031
241900****************************************************************  24190031
242000 2680-FIND-PACK-UPC-NBR.                                          24200031
242100*    DISPLAY '2680-FIND-PACK-UPC-NBR'.                            24210031
242200                                                                  24220031
242300        EXEC SQL                                                  24230031
242400           SELECT UPC_NBR                                         24240031
242500              INTO :XLT00009-UPC-NBR                              24250031
242600               FROM XLT_PK_UPC                                    24260031
242700            WHERE PK_SKU_NBR = :XLT00008-PK-SKU-NBR               24270031
242800*CHG0147748 - START                                               24280031
242900              AND EDI_ORD_IND = 'Y'                               24290031
243000*CHG0147748 - END                                                 24300031
243100        END-EXEC                                                  24310031
243200                                                                  24320031
243300     EVALUATE TRUE                                                24330031
243400         WHEN SQLCODE = ZERO                                      24340031
243500*    SET ASN PO TYPE = '0001'                                     24350031
243600          MOVE XLT00009-UPC-NBR TO TRT00012-UPC-NBR               24360031
243700*      ***DISPLAY 'XLT00009-UPC-NBR =' XLT00009-UPC-NBR           24370031
243800          MOVE 'AS' TO TRT00012-ASN-PKGNG-CDE                     24380031
243900*         MOVE 1 TO TRT00012-UNT-QTY                              24390031
244000          MOVE PV-SN1-TOTAL-SHIP-QTY TO TRT00012-UNT-QTY          24400031
244100                                                                  24410031
244200         WHEN SQLCODE = +100                                      24420031
244300*CHG0165405-START                                                 24430031
244400          PERFORM 2685-FIND-PACK-UPC-NBR                          24440031
244500*CHG0165405-END                                                   24450031
244600*         SET PS-COMP-ERROR TO TRUE                               24460031
244700*         MOVE 'E'         TO TR211-RPT-TYP                       24470031
244800*         MOVE PC-ERROR  TO TR211-ERROR-TYPE                      24480031
244900*         MOVE 'PK-SKU-NBR' TO TR211-DATA-IN-ERROR                24490031
245000*     MOVE 'NO KOHL''S PACK UPC FOR ASN PACK UPC OR WRONG      '  24500031
245100*              TO TR211-ERROR-MSG                                 24510031
245200*         MOVE XLT00008-PK-SKU-NBR  TO PV-SKU-NBR-DISPLAY         24520031
245300*         MOVE PV-SKU-NBR-DISPLAY TO TR211-DATA-VALUE             24530031
245400*         PERFORM 7400-WRITE-PACK-LEVEL-ERROR                     24540031
245500*         PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                      24550031
245600                                                                  24560031
245700         WHEN SQLWARN0 NOT = SPACES                               24570031
245800         WHEN SQLCODE < ZERO                                      24580031
245900         WHEN SQLCODE > ZERO                                      24590031
246000             MOVE '2680-FIND-PACK-UPC-NBR'                        24600031
246100                                     TO PV-PARAGRAPH-NAME         24610031
246200             MOVE 'ERROR WHILE DOING SELECT'                      24620031
246300                                     TO PV-DB2-OPERATION-MESSAGE  24630031
246400             MOVE 'XLT_PK_UPC'       TO PV-DB2-TABLE-NAME-1       24640031
246500             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       24650031
246600             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       24660031
246700             PERFORM 9100-USER-ABEND                              24670031
246800      END-EVALUATE.                                               24680031
246900                                                                  24690031
247000*CHG0165405-START                                                 24700031
247100****************************************************************  24710031
247200* FIND PACK UPC_NBR FROM XLT_PK_UPC                               24720031
247300****************************************************************  24730031
247400 2685-FIND-PACK-UPC-NBR.                                          24740031
247500*    DISPLAY '2685-FIND-PACK-UPC-NBR'.                            24750031
247600                                                                  24760031
247700        EXEC SQL                                                  24770031
247800           SELECT UPC_NBR                                         24780031
247900              INTO :XLT00009-UPC-NBR                              24790031
248000               FROM XLT_PK_UPC                                    24800031
248100            WHERE PK_SKU_NBR = :XLT00008-PK-SKU-NBR               24810031
248200              AND EDI_ORD_IND = 'N'                               24820031
248300        END-EXEC                                                  24830031
248400                                                                  24840031
248500     EVALUATE TRUE                                                24850031
248600         WHEN SQLCODE = ZERO                                      24860031
248700*    SET ASN PO TYPE = '0001'                                     24870031
248800          MOVE XLT00009-UPC-NBR TO TRT00012-UPC-NBR               24880031
248900*      ***DISPLAY 'XLT00009-UPC-NBR =' XLT00009-UPC-NBR           24890031
249000          MOVE 'AS' TO TRT00012-ASN-PKGNG-CDE                     24900031
249100*         MOVE 1 TO TRT00012-UNT-QTY                              24910031
249200          MOVE PV-SN1-TOTAL-SHIP-QTY TO TRT00012-UNT-QTY          24920031
249300                                                                  24930031
249400         WHEN SQLCODE = +100                                      24940031
249500          SET PS-COMP-ERROR TO TRUE                               24950031
249600          MOVE 'E'         TO TR211-RPT-TYP                       24960031
249700          MOVE PC-ERROR  TO TR211-ERROR-TYPE                      24970031
249800          MOVE 'PK-SKU-NBR' TO TR211-DATA-IN-ERROR                24980031
249900      MOVE 'NO KOHL''S PACK UPC FOR ASN PACK UPC OR WRONG      '  24990031
250000               TO TR211-ERROR-MSG                                 25000031
250100          MOVE XLT00008-PK-SKU-NBR  TO PV-SKU-NBR-DISPLAY         25010031
250200          MOVE PV-SKU-NBR-DISPLAY TO TR211-DATA-VALUE             25020031
250300          PERFORM 7400-WRITE-PACK-LEVEL-ERROR                     25030031
250400          PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                      25040031
250500                                                                  25050031
250600         WHEN SQLWARN0 NOT = SPACES                               25060031
250700         WHEN SQLCODE < ZERO                                      25070031
250800         WHEN SQLCODE > ZERO                                      25080031
250900             MOVE '2685-FIND-PACK-UPC-NBR'                        25090031
251000                                     TO PV-PARAGRAPH-NAME         25100031
251100             MOVE 'ERROR WHILE DOING SELECT'                      25110031
251200                                     TO PV-DB2-OPERATION-MESSAGE  25120031
251300             MOVE 'XLT_PK_UPC'       TO PV-DB2-TABLE-NAME-1       25130031
251400             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       25140031
251500             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       25150031
251600             PERFORM 9100-USER-ABEND                              25160031
251700      END-EVALUATE.                                               25170031
251800                                                                  25180031
251900*CHG0165405-END                                                   25190031
252000******************************************************************25200031
252100* SELECT SKU COUNT TO MAKE SURE THEY SENT ENOUGH UPC RECS         25210031
252200******************************************************************25220031
252300 2695-SELECT-SKU-COUNT.                                           25230031
252400*    DISPLAY '2695-SELECT-SKU-COUNT'.                             25240031
252500                                                                  25250031
252600     EXEC SQL                                                     25260031
252700       SELECT COUNT(CPT_SKU_NBR)                                  25270031
252800           INTO :PV-CPT-SKU-NBR-COUNT                             25280031
252900            FROM XLT_PK_CPT_SKU                                   25290031
253000      WHERE                                                       25300031
253100           PK_SKU_NBR = :XLT00008-PK-SKU-NBR                      25310031
253200     END-EXEC.                                                    25320031
253300                                                                  25330031
253400     EVALUATE TRUE                                                25340031
253500         WHEN SQLCODE = ZERO                                      25350031
253600          IF PV-CPT-SKU-NBR-COUNT = PV-LIN-INDEX                  25360031
253700             PERFORM 2680-FIND-PACK-UPC-NBR                       25370031
253800           ELSE                                                   25380031
253900            SET PS-COMP-ERROR TO TRUE                             25390031
254000            MOVE 'E'         TO TR211-RPT-TYP                     25400031
254100            MOVE PC-ERROR TO TR211-ERROR-TYPE                     25410031
254200            MOVE 'PACK COMPONENTS' TO TR211-DATA-IN-ERROR         25420031
254300            MOVE PC-COMP-SENT-NE-KOHLS-CNT                        25430031
254400                                   TO TR211-ERROR-MSG             25440031
254500            MOVE XLT00008-PK-SKU-NBR TO PV-SKU-NBR-DISPLAY        25450031
254600            MOVE PV-SKU-NBR-DISPLAY  TO TR211-DATA-VALUE          25460031
254700            PERFORM 7400-WRITE-PACK-LEVEL-ERROR                   25470031
254800            SET PS-END-OF-PRF-PO-NBR TO TRUE                      25480031
254900*           **** PKE2372 MJF 3/31/11 CHANGE #4                    25490031
255000***         PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                    25500031
255100          END-IF                                                  25510031
255200                                                                  25520031
255300         WHEN SQLWARN0 NOT = SPACES                               25530031
255400         WHEN SQLCODE < ZERO                                      25540031
255500         WHEN SQLCODE > ZERO                                      25550031
255600             MOVE '2695-SELECT-SKU-COUNT'                         25560031
255700                                     TO PV-PARAGRAPH-NAME         25570031
255800             MOVE 'ERROR SELECTING XLT COUNT'                     25580031
255900                                     TO PV-DB2-OPERATION-MESSAGE  25590031
256000             MOVE 'XLT_PK_CPT_SKU'   TO PV-DB2-TABLE-NAME-1       25600031
256100             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       25610031
256200             PERFORM 9100-USER-ABEND                              25620031
256300     END-EVALUATE.                                                25630031
256400                                                                  25640031
256500******************************************************************25650031
256600* PROCESS THE HEADER LEVEL RECORD AND DETERMIN SEQUENCE.          25660031
256700******************************************************************25670031
256800 2700-PROCESS-RECORD-SEQUENCE.                                    25680031
256900*    DISPLAY '2700-PROCESS-RECORD-SEQUENCE'.                      25690031
257000                                                                  25700031
257100     EVALUATE TRUE                                                25710031
257200        WHEN PV-PREV-ID-LEVEL                                     25720031
257300           PERFORM 4000-EDIT-ID-LEVEL-DATA                        25730031
257400           EVALUATE TRUE                                          25740031
257500              WHEN PS-DATA-IN-ERROR                               25750031
257600                 PERFORM 6010-BYPASS-TO-NEXT-ID                   25760031
257700              WHEN PV-ID-LEVEL                                    25770031
257800                 MOVE PC-ERROR TO TR211-ERROR-TYPE                25780031
257900                 MOVE 'CON DATA MISSING' TO TR211-ERROR-MSG       25790031
258000                 PERFORM 7000-MISSING-LEVEL-ERROR                 25800031
258100              WHEN PV-SHIPMENT-LEVEL                              25810031
258200                 CONTINUE                                         25820031
258300              WHEN PV-ORDER-LEVEL                                 25830031
258400                 MOVE PC-ERROR TO TR211-ERROR-TYPE                25840031
258500                 MOVE 'CON DATA MISSING' TO TR211-ERROR-MSG       25850031
258600                 PERFORM 7000-MISSING-LEVEL-ERROR                 25860031
258700                 PERFORM 6010-BYPASS-TO-NEXT-ID                   25870031
258800              WHEN PV-PACK-LEVEL                                  25880031
258900                 IF PV-ASN-STANDARD-NO-CARTON                     25890031
259000                    PERFORM 6020-BYPASS-PACK-LEVEL                25900031
259100                 ELSE                                             25910031
259200                    MOVE PC-ERROR TO TR211-ERROR-TYPE             25920031
259300                    MOVE 'CON DATA MISSING' TO TR211-ERROR-MSG    25930031
259400                    PERFORM 7000-MISSING-LEVEL-ERROR              25940031
259500                    PERFORM 6010-BYPASS-TO-NEXT-ID                25950031
259600                 END-IF                                           25960031
259700              WHEN PV-ITEM-LEVEL                                  25970031
259800                 MOVE PC-ERROR TO TR211-ERROR-TYPE                25980031
259900                 MOVE 'CON DATA MISSING' TO TR211-ERROR-MSG       25990031
260000                 PERFORM 7000-MISSING-LEVEL-ERROR                 26000031
260100                 PERFORM 6010-BYPASS-TO-NEXT-ID                   26010031
260200                 CONTINUE                                         26020031
260300           END-EVALUATE                                           26030031
260400                                                                  26040031
260500        WHEN PV-PREV-SHIPMENT-LEVEL                               26050031
260600           PERFORM 4100-EDIT-SHIPMENT-LEVEL-DATA                  26060031
260700           EVALUATE TRUE                                          26070031
260800              WHEN PS-DATA-IN-ERROR                               26080031
260900                 PERFORM 6010-BYPASS-TO-NEXT-ID                   26090031
261000              WHEN PV-ID-LEVEL                                    26100031
261100                 PERFORM 6110-WRITE-CNTR-RECORD                   26110031
261200                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26120031
261300                 MOVE 'CONPO DATA MISSING' TO TR211-ERROR-MSG     26130031
261400                 PERFORM 7000-MISSING-LEVEL-ERROR                 26140031
261500              WHEN PV-SHIPMENT-LEVEL                              26150031
261600                 PERFORM 6110-WRITE-CNTR-RECORD                   26160031
261700                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26170031
261800                 MOVE 'CONPO DATA MISSING' TO TR211-ERROR-MSG     26180031
261900                 PERFORM 7000-MISSING-LEVEL-ERROR                 26190031
262000                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26200031
262100                 MOVE 'NO ISA RECORD' TO TR211-ERROR-MSG          26210031
262200                 PERFORM 7000-MISSING-LEVEL-ERROR                 26220031
262300                 PERFORM 6010-BYPASS-TO-NEXT-ID                   26230031
262400              WHEN PV-ORDER-LEVEL                                 26240031
262500                 CONTINUE                                         26250031
262600              WHEN PV-PACK-LEVEL                                  26260031
262700                 IF PV-ASN-STANDARD-NO-CARTON                     26270031
262800                    PERFORM 6020-BYPASS-PACK-LEVEL                26280031
262900                 ELSE                                             26290031
263000                   PERFORM 6110-WRITE-CNTR-RECORD                 26300031
263100                   MOVE PC-ERROR TO TR211-ERROR-TYPE              26310031
263200                   MOVE 'CONPO DATA MISSING' TO TR211-ERROR-MSG   26320031
263300                   PERFORM 7000-MISSING-LEVEL-ERROR               26330031
263400                   PERFORM 6010-BYPASS-TO-NEXT-ID                 26340031
263500                 END-IF                                           26350031
263600              WHEN PV-ITEM-LEVEL                                  26360031
263700                 PERFORM 6110-WRITE-CNTR-RECORD                   26370031
263800                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26380031
263900                 MOVE 'CONPO DATA MISSING' TO TR211-ERROR-MSG     26390031
264000                 PERFORM 7000-MISSING-LEVEL-ERROR                 26400031
264100                 PERFORM 6010-BYPASS-TO-NEXT-ID                   26410031
264200           END-EVALUATE                                           26420031
264300                                                                  26430031
264400        WHEN PV-PREV-ORDER-LEVEL                                  26440031
264500           PERFORM 4200-EDIT-PO-LEVEL-DATA                        26450031
264600           EVALUATE TRUE                                          26460031
264700              WHEN PS-DATA-IN-ERROR                               26470031
264800                 PERFORM 6110-WRITE-CNTR-RECORD                   26480031
264900                 PERFORM 6010-BYPASS-TO-NEXT-ID                   26490031
265000              WHEN PV-ID-LEVEL                                    26500031
265100                 PERFORM 6110-WRITE-CNTR-RECORD                   26510031
265200                 PERFORM 6120-WRITE-CONPO-RECORD                  26520031
265300                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26530031
265400                 MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG     26540031
265500                 PERFORM 7000-MISSING-LEVEL-ERROR                 26550031
265600              WHEN PV-SHIPMENT-LEVEL                              26560031
265700                 PERFORM 6110-WRITE-CNTR-RECORD                   26570031
265800                 PERFORM 6120-WRITE-CONPO-RECORD                  26580031
265900                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26590031
266000                 MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG     26600031
266100                 PERFORM 7000-MISSING-LEVEL-ERROR                 26610031
266200                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26620031
266300                 MOVE 'NO ISA RECORD' TO TR211-ERROR-MSG          26630031
266400                 PERFORM 7000-MISSING-LEVEL-ERROR                 26640031
266500                 PERFORM 6010-BYPASS-TO-NEXT-ID                   26650031
266600              WHEN PV-ORDER-LEVEL                                 26660031
266700                 PERFORM 6110-WRITE-CNTR-RECORD                   26670031
266800                 PERFORM 6120-WRITE-CONPO-RECORD                  26680031
266900                 MOVE PC-ERROR TO TR211-ERROR-TYPE                26690031
267000                 MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG     26700031
267100                 PERFORM 7000-MISSING-LEVEL-ERROR                 26710031
267200                 PERFORM 6010-BYPASS-TO-NEXT-ID                   26720031
267300              WHEN PV-PACK-LEVEL                                  26730031
267400                 EVALUATE TRUE                                    26740031
267500                    WHEN PV-ASN-PICK-N-PACK                       26750031
267600                       CONTINUE                                   26760031
267700                    WHEN PV-ASN-STANDARD-CARTON                   26770031
267800                      PERFORM 6110-WRITE-CNTR-RECORD              26780031
267900                      PERFORM 6120-WRITE-CONPO-RECORD             26790031
268000                      MOVE PC-ERROR TO TR211-ERROR-TYPE           26800031
268100                      MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG26810031
268200                      PERFORM 7000-MISSING-LEVEL-ERROR            26820031
268300                      PERFORM 6010-BYPASS-TO-NEXT-ID              26830031
268400                    WHEN PV-ASN-STANDARD-NO-CARTON                26840031
268500                       PERFORM 6020-BYPASS-PACK-LEVEL             26850031
268600                 END-EVALUATE                                     26860031
268700              WHEN PV-ITEM-LEVEL                                  26870031
268800               AND PV-ASN-PICK-N-PACK                             26880031
268900                 SET PS-CARTON-DATA-MISSING TO TRUE               26890031
269000           END-EVALUATE                                           26900031
269100                                                                  26910031
269200        WHEN PV-PREV-PACK-LEVEL                                   26920031
269300           EVALUATE TRUE                                          26930031
269400              WHEN PV-ID-LEVEL                                    26940031
269500                 IF PV-ASN-PICK-N-PACK                            26950031
269600                    MOVE PC-ERROR TO TR211-ERROR-TYPE             26960031
269700                    MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG  26970031
269800                    PERFORM 7000-MISSING-LEVEL-ERROR              26980031
269900                 END-IF                                           26990031
270000                 IF PV-ASN-STANDARD-CARTON                        27000031
270100                    PERFORM 4300-EDIT-PACK-LEVEL-DATA             27010031
270200                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         27020031
270300                    INITIALIZE DCLTRT00012                        27030031
270400                 END-IF                                           27040031
270500                 PERFORM 6130-WRITE-ITEM-PACK-RECORD              27050031
270600                 PERFORM 6120-WRITE-CONPO-RECORD                  27060031
270700                 PERFORM 6110-WRITE-CNTR-RECORD                   27070031
270800              WHEN PV-SHIPMENT-LEVEL                              27080031
270900                 IF PV-ASN-PICK-N-PACK                            27090031
271000                    MOVE PC-ERROR TO TR211-ERROR-TYPE             27100031
271100                    MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG  27110031
271200                    PERFORM 7000-MISSING-LEVEL-ERROR              27120031
271300                 END-IF                                           27130031
271400                 IF PV-ASN-STANDARD-CARTON                        27140031
271500                    PERFORM 4300-EDIT-PACK-LEVEL-DATA             27150031
271600                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         27160031
271700                    INITIALIZE DCLTRT00012                        27170031
271800                 END-IF                                           27180031
271900                 PERFORM 6130-WRITE-ITEM-PACK-RECORD              27190031
272000                 PERFORM 6120-WRITE-CONPO-RECORD                  27200031
272100                 PERFORM 6110-WRITE-CNTR-RECORD                   27210031
272200                 MOVE PC-ERROR TO TR211-ERROR-TYPE                27220031
272300                 MOVE 'NO ISA RECORD' TO TR211-ERROR-MSG          27230031
272400                 PERFORM 7000-MISSING-LEVEL-ERROR                 27240031
272500                 PERFORM 6010-BYPASS-TO-NEXT-ID                   27250031
272600              WHEN PV-ORDER-LEVEL                                 27260031
272700                 IF PV-ASN-STANDARD-CARTON                        27270031
272800                    PERFORM 4300-EDIT-PACK-LEVEL-DATA             27280031
272900                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         27290031
273000                    INITIALIZE DCLTRT00012                        27300031
273100                 END-IF                                           27310031
273200                 PERFORM 6130-WRITE-ITEM-PACK-RECORD              27320031
273300                 PERFORM 6120-WRITE-CONPO-RECORD                  27330031
273400                 IF PV-ASN-PICK-N-PACK                            27340031
273500                    PERFORM 6110-WRITE-CNTR-RECORD                27350031
273600                    MOVE PC-ERROR TO TR211-ERROR-TYPE             27360031
273700                    MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG  27370031
273800                    PERFORM 7000-MISSING-LEVEL-ERROR              27380031
273900                    PERFORM 6010-BYPASS-TO-NEXT-ID                27390031
274000                 END-IF                                           27400031
274100              WHEN PV-PACK-LEVEL                                  27410031
274200                 IF PV-ASN-PICK-N-PACK                            27420031
274300                    PERFORM 6130-WRITE-ITEM-PACK-RECORD           27430031
274400                    PERFORM 6120-WRITE-CONPO-RECORD               27440031
274500                    PERFORM 6110-WRITE-CNTR-RECORD                27450031
274600                    MOVE PC-ERROR             TO TR211-ERROR-TYPE 27460031
274700                    MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG  27470031
274800                    PERFORM 7000-MISSING-LEVEL-ERROR              27480031
274900                    PERFORM 6010-BYPASS-TO-NEXT-ID                27490031
275000                 ELSE                                             27500031
275100                    PERFORM 4300-EDIT-PACK-LEVEL-DATA             27510031
275200                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         27520031
275300                    INITIALIZE TRT00012-SSCC-ID                   27530031
275400                               TRT00012-UNT-QTY                   27540031
275500                 END-IF                                           27550031
275600              WHEN PV-ITEM-LEVEL                                  27560031
275700                 IF PV-ASN-STANDARD-CARTON                        27570031
275800                    PERFORM 4300-EDIT-PACK-LEVEL-DATA             27580031
275900                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         27590031
276000                    INITIALIZE TRT00012-SSCC-ID                   27600031
276100                               TRT00012-UNT-QTY                   27610031
276200                 END-IF                                           27620031
276300           END-EVALUATE                                           27630031
276400                                                                  27640031
276500        WHEN PV-PREV-ITEM-LEVEL                                   27650031
276600           PERFORM 4400-EDIT-ITEM-LEVEL-DATA                      27660031
276700           IF  PV-ASN-PICK-N-PACK                                 27670031
276800           AND PS-DATA-IN-ERROR-NO                                27680031
276900              PERFORM 4300-EDIT-PACK-LEVEL-DATA                   27690031
277000           END-IF                                                 27700031
277100           EVALUATE TRUE                                          27710031
277200              WHEN PS-DATA-IN-ERROR                               27720031
277300                 PERFORM 6130-WRITE-ITEM-PACK-RECORD              27730031
277400                 PERFORM 6120-WRITE-CONPO-RECORD                  27740031
277500                 PERFORM 6110-WRITE-CNTR-RECORD                   27750031
277600                 PERFORM 6010-BYPASS-TO-NEXT-ID                   27760031
277700              WHEN PV-ID-LEVEL                                    27770031
277800                IF PS-COMP-ERROR-NO                               27780031
277900                 PERFORM 3100-INSERT-REC-TO-WORK-TABLE            27790031
278000                END-IF                                            27800031
278100                 INITIALIZE DCLTRT00012                           27810031
278200                 PERFORM 6130-WRITE-ITEM-PACK-RECORD              27820031
278300                 PERFORM 6120-WRITE-CONPO-RECORD                  27830031
278400                 PERFORM 6110-WRITE-CNTR-RECORD                   27840031
278500                 IF PV-ASN-STANDARD-CARTON                        27850031
278600                    MOVE PC-WARNING TO TR211-ERROR-TYPE           27860031
278700                    MOVE 'CNCART DATA MISSING' TO TR211-ERROR-MSG 27870031
278800                    PERFORM 7000-MISSING-LEVEL-ERROR              27880031
278900                 END-IF                                           27890031
279000              WHEN PV-SHIPMENT-LEVEL                              27900031
279100                 PERFORM 3100-INSERT-REC-TO-WORK-TABLE            27910031
279200                 INITIALIZE DCLTRT00012                           27920031
279300                 PERFORM 6130-WRITE-ITEM-PACK-RECORD              27930031
279400                 PERFORM 6120-WRITE-CONPO-RECORD                  27940031
279500                 PERFORM 6110-WRITE-CNTR-RECORD                   27950031
279600                 IF PV-ASN-STANDARD-CARTON                        27960031
279700                    MOVE PC-WARNING TO TR211-ERROR-TYPE           27970031
279800                    MOVE 'CNCART DATA MISSING' TO TR211-ERROR-MSG 27980031
279900                    PERFORM 7000-MISSING-LEVEL-ERROR              27990031
280000                 END-IF                                           28000031
280100                 MOVE PC-ERROR TO TR211-ERROR-TYPE                28010031
280200                 MOVE 'NO ISA RECORD' TO TR211-ERROR-MSG          28020031
280300                 PERFORM 7000-MISSING-LEVEL-ERROR                 28030031
280400                 PERFORM 6010-BYPASS-TO-NEXT-ID                   28040031
280500              WHEN PV-ORDER-LEVEL                                 28050031
280600                IF PS-COMP-ERROR-NO                               28060031
280700                 PERFORM 3100-INSERT-REC-TO-WORK-TABLE            28070031
280800                END-IF                                            28080031
280900                 INITIALIZE DCLTRT00012                           28090031
281000                IF PS-COMP-ERROR-NO                               28100031
281100                 PERFORM 6130-WRITE-ITEM-PACK-RECORD              28110031
281200                 PERFORM 6120-WRITE-CONPO-RECORD                  28120031
281300                END-IF                                            28130031
281400                 IF PV-ASN-STANDARD-CARTON                        28140031
281500                    MOVE PC-WARNING TO TR211-ERROR-TYPE           28150031
281600                    MOVE 'CNCART DATA MISSING' TO TR211-ERROR-MSG 28160031
281700                    PERFORM 7000-MISSING-LEVEL-ERROR              28170031
281800                 END-IF                                           28180031
281900              WHEN PV-PACK-LEVEL                                  28190031
282000                 IF PV-ASN-PICK-N-PACK                            28200031
282100                 OR PV-ASN-STANDARD-NO-CARTON                     28210031
282200                  IF PS-COMP-ERROR-NO                             28220031
282300                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         28230031
282400                  END-IF                                          28240031
282500                    INITIALIZE DCLTRT00012                        28250031
282600                 END-IF                                           28260031
282700                 IF PV-ASN-STANDARD-NO-CARTON                     28270031
282800                    PERFORM 6020-BYPASS-PACK-LEVEL                28280031
282900                 END-IF                                           28290031
283000              WHEN PV-ITEM-LEVEL                                  28300031
283100                IF PS-COMP-ERROR-NO                               28310031
283200                 PERFORM 3100-INSERT-REC-TO-WORK-TABLE            28320031
283300                END-IF                                            28330031
283400                 INITIALIZE DCLTRT00012                           28340031
283500                 EVALUATE TRUE                                    28350031
283600                    WHEN PV-ASN-STANDARD-NO-CARTON                28360031
283700                       CONTINUE                                   28370031
283800                    WHEN PV-ASN-PICK-N-PACK                       28380031
283900                       SET PS-CARTON-DATA-MISSING TO TRUE         28390031
284000                    WHEN PV-ASN-STANDARD-CARTON                   28400031
284100                       MOVE PC-WARNING TO TR211-ERROR-TYPE        28410031
284200                       MOVE 'CNCART DATA MISSING'                 28420031
284300                                     TO TR211-ERROR-MSG           28430031
284400                       PERFORM 7000-MISSING-LEVEL-ERROR           28440031
284500                 END-EVALUATE                                     28450031
284600           END-EVALUATE                                           28460031
284700                                                                  28470031
284800     END-EVALUATE.                                                28480031
284900                                                                  28490031
285000     IF PS-DATA-IN-ERROR                                          28500031
285100        PERFORM 8100-CLEAR-WORK-TABLE                             28510031
285200     END-IF.                                                      28520031
285300                                                                  28530031
285400******************************************************************28540031
285500* GET ENT ID AND VERIFY THIS IT IS VALID                         *28550031
285600******************************************************************28560031
285700 2800-DERIVE-SRC-ENT-ID.                                          28570031
285800*    DISPLAY '2800-DERIVE-SRC-ENT-ID'.                            28580031
285900                                                                  28590031
286000     SET PS-END-OF-ENT-ID-SEARCH-NO TO TRUE.                      28600031
286100     SET PS-WRITE-ISA-REC-NO        TO TRUE.                      28610031
286200     INITIALIZE ENTNME-ENT-ID                                     28620031
286300                TR023-CNTR-DAT-SRC-ENT-ID.                        28630031
286400                                                                  28640031
286500***CRQ31649-BEGIN                                                 28650031
286600*    IF TR063-ISA-ID = PV-HOLD-ISA-ID                             28660031
286700*       MOVE PV-HOLD-DAT-SRC-ENT-ID TO TR023-CNTR-DAT-SRC-ENT-ID  28670031
286800*                                      ENTNME-ENT-ID              28680031
286900*    ELSE                                                         28690031
287000***CRQ31649-END                                                   28700031
287100        MOVE TR063-ISA-ID    TO PV-HOLD-ISA-ID                    28710031
287200        SET PS-WRITE-ISA-REC TO TRUE                              28720031
287300        PERFORM 2870-OPEN-ENT-ID-CSR                              28730031
287400        PERFORM 2850-PROCESS-ENT-ID-CSR                           28740031
287500          UNTIL PS-END-OF-ENT-ID-SEARCH                           28750031
287600        PERFORM 2890-CLOSE-ENT-ID-CSR                             28760031
287700        PERFORM 2980-WRITE-ENT-ID-TO-FILTRKNG                     28770031
287800*       WRITE ERROR FILE HEADER                                   28780031
287900        MOVE ENTNME-ENT-ID TO PV-HOLD-HEADER-ENT-ID               28790031
288000        PERFORM 7100-WRITE-ID-LEVEL-ERROR                         28800031
288100***CRQ31649-BEGIN                                                 28810031
288200*    END-IF.                                                      28820031
288300***CRQ31649-END                                                   28830031
288400                                                                  28840031
288500     IF TR023-CNTR-DAT-SRC-ENT-ID EQUAL ZEROES                    28850031
288600        PERFORM 4000-EDIT-ID-LEVEL-DATA                           28860031
288700        PERFORM 6030-BYPASS-TO-NEXT-ISA-ID                        28870031
288800        INITIALIZE PV-PREV-RECORD-LEVEL-CDE                       28880031
288900     END-IF.                                                      28890031
289000                                                                  28900031
289100****************************************************************  28910031
289200* PROCESS THE ENT ID CURSOR                                       28920031
289300****************************************************************  28930031
289400 2850-PROCESS-ENT-ID-CSR.                                         28940031
289500*    DISPLAY '2850-PROCESS-ENT-ID-CSR'.                           28950031
289600                                                                  28960031
289700     PERFORM 2880-FETCH-ENT-ID-CSR.                               28970031
289800                                                                  28980031
289900     IF PS-END-OF-ENT-ID-SEARCH-NO                                28990031
290000        PERFORM 2860-VALIDATE-ENT-ID                              29000031
290100     END-IF.                                                      29010031
290200                                                                  29020031
290300****************************************************************  29030031
290400* VALIDATE ENT ID                                                 29040031
290500****************************************************************  29050031
290600 2860-VALIDATE-ENT-ID.                                            29060031
290700*    DISPLAY '2860-VALIDATE-ENT-ID'.                              29070031
290800                                                                  29080031
290900     EXEC SQL                                                     29090031
291000          SELECT ENT_ID                                           29100031
291100          INTO   :TRT00004-ENT-ID                                 29110031
291200          FROM   TRT_IMPRT_PRTNRFIL                               29120031
291300          WHERE  ENT_ID      = :ENTNME-ENT-ID                     29130031
291400            AND  FIL_TYP_CDE = 'CN'                               29140031
291500            AND  STAT_CDE    = 'A'                                29150031
291600     END-EXEC.                                                    29160031
291700                                                                  29170031
291800     EVALUATE TRUE                                                29180031
291900         WHEN SQLCODE = ZERO                                      29190031
292000             MOVE TRT00004-ENT-ID TO TR023-CNTR-DAT-SRC-ENT-ID    29200031
292100             SET PS-END-OF-ENT-ID-SEARCH TO TRUE                  29210031
292200         WHEN SQLCODE = +100                                      29220031
292300             CONTINUE                                             29230031
292400         WHEN SQLWARN0 NOT = SPACES                               29240031
292500         WHEN SQLCODE < ZERO                                      29250031
292600         WHEN SQLCODE > ZERO                                      29260031
292700             MOVE '2860-VALIDATE-ENT-ID'                          29270031
292800                                       TO PV-PARAGRAPH-NAME       29280031
292900             MOVE 'ERROR ATTEMPTING TO SELECT'                    29290031
293000                                       TO PV-DB2-OPERATION-MESSAGE29300031
293100             MOVE 'TRT_IMPRT_PRTNRFIL' TO PV-DB2-TABLE-NAME-1     29310031
293200             MOVE SPACES               TO PV-DB2-TABLE-NAME-2     29320031
293300             MOVE SPACES               TO PV-DB2-TABLE-NAME-3     29330031
293400             PERFORM 9100-USER-ABEND                              29340031
293500     END-EVALUATE.                                                29350031
293600                                                                  29360031
293700                                                                  29370031
293800****************************************************************  29380031
293900* OPEN ENT-ID-CSR CURSOR                                          29390031
294000****************************************************************  29400031
294100 2870-OPEN-ENT-ID-CSR.                                            29410031
294200*    DISPLAY '2870-OPEN-ENT-ID-CSR'.                              29420031
294300                                                                  29430031
294400     EXEC SQL                                                     29440031
294500          OPEN ENT-ID-CSR                                         29450031
294600     END-EXEC.                                                    29460031
294700                                                                  29470031
294800     EVALUATE TRUE                                                29480031
294900         WHEN SQLCODE = ZERO                                      29490031
295000             CONTINUE                                             29500031
295100         WHEN SQLWARN0 NOT = SPACES                               29510031
295200         WHEN SQLCODE < ZERO                                      29520031
295300         WHEN SQLCODE > ZERO                                      29530031
295400             MOVE '2210-OPEN-ENT-ID-CSR'                          29540031
295500                                     TO PV-PARAGRAPH-NAME         29550031
295600             MOVE 'ATTEMPTING TO OPEN THE ENT-ID-CSR'             29560031
295700                                     TO PV-DB2-OPERATION-MESSAGE  29570031
295800             MOVE 'TENTNME'          TO PV-DB2-TABLE-NAME-1       29580031
295900             MOVE 'TTRDPRT'          TO PV-DB2-TABLE-NAME-2       29590031
296000             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       29600031
296100             PERFORM 9100-USER-ABEND                              29610031
296200     END-EVALUATE.                                                29620031
296300                                                                  29630031
296400****************************************************************  29640031
296500* FETCH ITEM-PACK-CSR                                             29650031
296600****************************************************************  29660031
296700 2880-FETCH-ENT-ID-CSR.                                           29670031
296800*    DISPLAY '2880-FETCH-ENT-ID-CSR'.                             29680031
296900                                                                  29690031
297000     EXEC SQL                                                     29700031
297100         FETCH ENT-ID-CSR                                         29710031
297200          INTO :ENTNME-ENT-ID                                     29720031
297300     END-EXEC.                                                    29730031
297400                                                                  29740031
297500     EVALUATE TRUE                                                29750031
297600         WHEN SQLCODE = ZERO                                      29760031
297700               SET PS-END-OF-ENT-ID-SEARCH-NO TO TRUE             29770031
297800         WHEN SQLCODE = +100                                      29780031
297900              SET PS-END-OF-ENT-ID-SEARCH     TO TRUE             29790031
298000         WHEN SQLWARN0 NOT = SPACES                               29800031
298100         WHEN SQLCODE < ZERO                                      29810031
298200         WHEN SQLCODE > ZERO                                      29820031
298300             MOVE '2880-FETCH-ENT-ID-CSR'                         29830031
298400                                     TO PV-PARAGRAPH-NAME         29840031
298500             MOVE 'ERROR FETCHING WITH THE ENT-ID-CSR'            29850031
298600                                     TO PV-DB2-OPERATION-MESSAGE  29860031
298700             MOVE 'TENTNME'          TO PV-DB2-TABLE-NAME-1       29870031
298800             MOVE 'TTRDPRT'          TO PV-DB2-TABLE-NAME-2       29880031
298900             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       29890031
299000             PERFORM 9100-USER-ABEND                              29900031
299100     END-EVALUATE.                                                29910031
299200 EJECT                                                            29920031
299300                                                                  29930031
299400****************************************************************  29940031
299500* CLOSE ITEM-PACK-CSR                                             29950031
299600****************************************************************  29960031
299700 2890-CLOSE-ENT-ID-CSR.                                           29970031
299800*    DISPLAY '2890-CLOSE-ENT-ID-CSR'.                             29980031
299900                                                                  29990031
300000         EXEC SQL                                                 30000031
300100              CLOSE ENT-ID-CSR                                    30010031
300200         END-EXEC.                                                30020031
300300                                                                  30030031
300400     EVALUATE TRUE                                                30040031
300500         WHEN SQLCODE = ZERO                                      30050031
300600             CONTINUE                                             30060031
300700         WHEN SQLWARN0 NOT = SPACES                               30070031
300800         WHEN SQLCODE < ZERO                                      30080031
300900         WHEN SQLCODE > ZERO                                      30090031
301000             MOVE '6230-CLOSE-ENT-ID-CSR'                         30100031
301100                                     TO PV-PARAGRAPH-NAME         30110031
301200             MOVE 'ATTEMPTING TO CLOSE THE ENT-ID-CSR'            30120031
301300                                     TO PV-DB2-OPERATION-MESSAGE  30130031
301400             MOVE 'TENTNME'          TO PV-DB2-TABLE-NAME-1       30140031
301500             MOVE 'TTRDPRT'          TO PV-DB2-TABLE-NAME-2       30150031
301600             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       30160031
301700             PERFORM 9100-USER-ABEND                              30170031
301800     END-EVALUATE.                                                30180031
301900                                                                  30190031
302000                                                                  30200031
302100******************************************************************30210031
302200* WRITE ENT ID TO TRT_IMPRT_FILTRKING TABLE                      *30220031
302300******************************************************************30230031
302400 2980-WRITE-ENT-ID-TO-FILTRKNG.                                   30240031
302500*    DISPLAY '2980-WRITE-ENT-ID-TO-FILTRKNG'.                     30250031
302600                                                                  30260031
302700     INITIALIZE DCLTRT00005                                       30270031
302800                                                                  30280031
302900     COMPUTE PA-TOTAL-UPDATE =                                    30290031
303000                (PA-TOTAL-UPDATE-CNTR + PA-TOTAL-UPDATE-CONPO +   30300031
303100                 PA-TOTAL-UPDATE-CONUPC + PA-TOTAL-UPDATE-CNCART) 30310031
303200                                                                  30320031
303300     IF PV-HOLD-DAT-SRC-ENT-ID EQUAL ZEROES                       30330031
303400     OR PA-TOTAL-UPDATE EQUAL ZEROES                              30340031
303500        CONTINUE                                                  30350031
303600     ELSE                                                         30360031
303700        MOVE PV-HOLD-DAT-SRC-ENT-ID    TO TRT00005-ENT-ID         30370031
303800        MOVE 'CN'                      TO TRT00005-FIL-TYP-CDE    30380031
303900        MOVE PV-HOLD-FILE-ID           TO TRT00005-FIL-CNTL-NBR   30390031
304000        MOVE PV-CURRENT-TMST           TO TRT00005-CRE-TMST       30400031
304100        MOVE 'T'                       TO TRT00005-PRCG-ENVR-CDE  30410031
304200        COMPUTE TRT00005-TOT-REC-LOD-QTY =                        30420031
304300                       (PA-TOTAL-UPDATE - PA-PREV-TOTAL-UPDATE)   30430031
304400        MOVE PA-TOTAL-UPDATE           TO PA-PREV-TOTAL-UPDATE    30440031
304500                                                                  30450031
304600        COMPUTE PA-PREV-TOTAL-ERROR-COUNT =                       30460031
304700               (PA-TOTAL-ERROR-COUNT - PA-PREV-TOTAL-ERROR-COUNT) 30470031
304800        IF PA-PREV-TOTAL-ERROR-COUNT EQUAL ZERO                   30480031
304900           MOVE 'S'                 TO TRT00005-LOD-STAT-CDE      30490031
305000           MOVE ZEROES              TO TRT00005-TOT-EXC-REC-QTY   30500031
305100        ELSE                                                      30510031
305200           MOVE 'E'                 TO TRT00005-LOD-STAT-CDE      30520031
305300           MOVE PA-PREV-TOTAL-ERROR-COUNT                         30530031
305400                                    TO TRT00005-TOT-EXC-REC-QTY   30540031
305500        END-IF                                                    30550031
305600        MOVE PA-TOTAL-ERROR-COUNT   TO PA-PREV-TOTAL-ERROR-COUNT  30560031
305700                                                                  30570031
305800        PERFORM 2990-INSERT-TRACKING-ROW                          30580031
305900                                                                  30590031
306000     END-IF.                                                      30600031
306100                                                                  30610031
306200******************************************************************30620031
306300* INSERT A ROW INTO TRACKING TABLE                               *30630031
306400******************************************************************30640031
306500 2990-INSERT-TRACKING-ROW.                                        30650031
306600*    DISPLAY '2990-INSERT-TRACKING-ROW'.                          30660031
306700                                                                  30670031
306800         EXEC SQL                                                 30680031
306900             INSERT INTO TRT_IMPRT_FILTRKNG                       30690031
307000                   (ENT_ID,                                       30700031
307100                    FIL_TYP_CDE,                                  30710031
307200                    FIL_CNTL_NBR,                                 30720031
307300                    CRE_TMST,                                     30730031
307400                    LOD_STAT_CDE,                                 30740031
307500                    PRCG_ENVR_CDE,                                30750031
307600                    TOT_REC_LOD_QTY,                              30760031
307700                    TOT_EXC_REC_QTY)                              30770031
307800             VALUES                                               30780031
307900                  (:TRT00005-ENT-ID,                              30790031
308000                   :TRT00005-FIL-TYP-CDE,                         30800031
308100                   :TRT00005-FIL-CNTL-NBR,                        30810031
308200                   :TRT00005-CRE-TMST,                            30820031
308300                   :TRT00005-LOD-STAT-CDE,                        30830031
308400                   :TRT00005-PRCG-ENVR-CDE,                       30840031
308500                   :TRT00005-TOT-REC-LOD-QTY,                     30850031
308600                   :TRT00005-TOT-EXC-REC-QTY)                     30860031
308700         END-EXEC                                                 30870031
308800                                                                  30880031
308900         EVALUATE TRUE                                            30890031
309000             WHEN SQLCODE = ZERO                                  30900031
309100             WHEN SQLCODE = -803                                  30910031
309200             WHEN SQLCODE = -530                                  30920031
309300                 CONTINUE                                         30930031
309400             WHEN SQLWARN0 NOT EQUAL SPACE                        30940031
309500             WHEN SQLCODE NOT EQUAL ZERO                          30950031
309600                 DISPLAY '***************************************'30960031
309700                 DISPLAY '*ABEND                                *'30970031
309800                 DISPLAY '*PROGRAM = TRKUP212                   *'30980031
309900                 DISPLAY '*PARAGRAPH = 2990-INSERT-TRACKING-ROW *'30990031
310000                 DISPLAY '*INSERT INTO TRT_IMPRT_FILTRKNG       *'31000031
310100                 DISPLAY '*  ENT ID    = ' TRT00005-ENT-ID        31010031
310200                 DISPLAY '*  CNTL NBR  = ' TRT00005-FIL-CNTL-NBR  31020031
310300                 DISPLAY             TRT00005-ENT-ID              31030031
310400                 DISPLAY             TRT00005-FIL-TYP-CDE         31040031
310500                 DISPLAY             TRT00005-FIL-CNTL-NBR        31050031
310600                 DISPLAY             TRT00005-CRE-TMST            31060031
310700                 DISPLAY             TRT00005-LOD-STAT-CDE        31070031
310800                 DISPLAY             TRT00005-PRCG-ENVR-CDE       31080031
310900                 DISPLAY             TRT00005-TOT-REC-LOD-QTY     31090031
311000                 DISPLAY             TRT00005-TOT-EXC-REC-QTY     31100031
311100                 DISPLAY '***************************************'31110031
311200                 PERFORM 9100-USER-ABEND                          31120031
311300         END-EVALUATE.                                            31130031
311400 EJECT                                                            31140031
311500                                                                  31150031
311600******************************************************************31160031
311700* INSERT A ROW INTO THE WORK TABLE                               *31170031
311800******************************************************************31180031
311900 3100-INSERT-REC-TO-WORK-TABLE.                                   31190031
312000*    DISPLAY '3100-INSERT-REC-TO-WORK-TABLE'.                     31200031
312100                                                                  31210031
312200*    IF UPC IS PACK COMPUTE UNIT QUANTITY                         31220031
312300     IF PV-PCK-COMP-ONLY-NO                                       31230031
312400      IF TRT00012-ASN-PKGNG-CDE = 'AS'                            31240031
312500       IF PV-PCK-WITH-COMP-NO                                     31250031
312600*    ***DISPLAY 'PO IS PACK '                                     31260031
312700*    ***DISPLAY 'PURCHS-PKGNG-CDE = ' PURCHS-PKGNG-CDE            31270031
312800*    ***DISPLAY 'POPRPK-INPK-UNT-QTY = ' POPRPK-INPK-UNT-QTY      31280031
312900        COMPUTE TRT00012-UNT-QTY =                                31290031
313000            (TRT00012-UNT-QTY * POPRPK-INPK-UNT-QTY)              31300031
313100       ELSE                                                       31310031
313200*    IF UPC IS PACK/WITH COMP :COMPUTE UNIT QUANTITY              31320031
313300       IF PV-TOTAL-SLN04-QTY > 0                                  31330031
313400        COMPUTE TRT00012-UNT-QTY =                                31340031
313500           (TRT00012-UNT-QTY * PV-TOTAL-SLN04-QTY)                31350031
313600       END-IF                                                     31360031
313700       IF PV-TOTAL-SLN04-QTY = 0                                  31370031
313800*  DISPLAY WARNING MESSAGE                                        31380031
313900         MOVE PC-WARNING       TO TR211-ERROR-TYPE                31390031
314000         MOVE 'CONUP LEVEL    ' TO TR211-DATA-IN-ERROR            31400031
314100         MOVE 'CNCART DATA MISSING' TO TR211-ERROR-MSG            31410031
314200         MOVE SPACES           TO TR211-DATA-VALUE                31420031
314300         MOVE TRT00012-UPC-NBR TO TR211-CONUPA-UPC-NBR            31430031
314400         PERFORM 7500-WRITE-ITEM-LEVEL-ERROR                      31440031
314500       END-IF                                                     31450031
314600     END-IF                                                       31460031
314700     END-IF.                                                      31470031
314800     INITIALIZE PV-TOTAL-SLN04-QTY.                               31480031
314900                                                                  31490031
315000         EXEC SQL                                                 31500031
315100             INSERT INTO TRTW_CONTNR_LOD                          31510031
315200                   (UPC_NBR,                                      31520031
315300                    SSCC_ID,                                      31530031
315400                    ASN_PKGNG_CDE,                                31540031
315500                    UNT_QTY,                                      31550031
315600                    UPC_CBMT_QTY,                                 31560031
315700                    UPC_WT_KGRM_QTY)                              31570031
315800             VALUES                                               31580031
315900                  (:TRT00012-UPC-NBR,                             31590031
316000                   :TRT00012-SSCC-ID,                             31600031
316100                   :TRT00012-ASN-PKGNG-CDE,                       31610031
316200                   :TRT00012-UNT-QTY,                             31620031
316300                   :TRT00012-UPC-CBMT-QTY,                        31630031
316400                   :TRT00012-UPC-WT-KGRM-QTY)                     31640031
316500         END-EXEC                                                 31650031
316600                                                                  31660031
316700         EVALUATE TRUE                                            31670031
316800             WHEN SQLCODE = ZERO                                  31680031
316900                 CONTINUE                                         31690031
317000             WHEN SQLWARN0 NOT EQUAL SPACE                        31700031
317100             WHEN SQLCODE NOT EQUAL ZERO                          31710031
317200                 DISPLAY '**************************************' 31720031
317300                 DISPLAY '*ABEND                               *' 31730031
317400                 DISPLAY '*PROGRAM = TRKUP212                  *' 31740031
317500                 DISPLAY '*PARAGRAPH = 3100-INSERT-REC-TO-WORK *' 31750031
317600                 DISPLAY '*INSERT INTO TRTW_CONTNR_LOD         *' 31760031
317700                 DISPLAY '*  UPC NBR   = ' TRT00012-UPC-NBR       31770031
317800                 DISPLAY '*  SSCC ID   = ' TRT00012-SSCC-ID       31780031
317900                 DISPLAY '**************************************' 31790031
318000                 PERFORM 9100-USER-ABEND                          31800031
318100         END-EVALUATE.                                            31810031
318200 EJECT                                                            31820031
318300******************************************************************31830031
318400* EDIT DATA AT ID LEVEL                                           31840031
318500******************************************************************31850031
318600 4000-EDIT-ID-LEVEL-DATA.                                         31860031
318700*    DISPLAY '4000-EDIT-ID-LEVEL-DATA'.                           31870031
318800                                                                  31880031
318900     SET PS-DATA-IN-ERROR-NO TO TRUE.                             31890031
319000     SET PS-UPC-NBR-FOUND-NO TO TRUE.                             31900031
319100     INITIALIZE DCLTRT00012.                                      31910031
319200                                                                  31920031
319300     IF TR023-CNTR-TRN-TYP = PC-A OR PC-C OR PC-D                 31930031
319400        MOVE TR023-CNTR-TRN-TYP TO PV-HOLD-TRN-TYP                31940031
319500     ELSE                                                         31950031
319600        MOVE PC-ERROR                   TO TR211-ERROR-TYPE       31960031
319700        MOVE 'TRAN TYPE      '          TO TR211-DATA-IN-ERROR    31970031
319800        MOVE 'INVALID TRANSACTION TYPE' TO TR211-ERROR-MSG        31980031
319900        MOVE SPACE                      TO TR211-TRN-TYP          31990031
320000        MOVE PV-HOLD-ERROR-TRANS-CDE    TO TR211-DATA-VALUE       32000031
320100        SET PS-DATA-IN-ERROR            TO TRUE                   32010031
320200        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       32020031
320300     END-IF.                                                      32030031
320400                                                                  32040031
320500     IF TR023-CNTR-DAT-SRC-ENT-ID EQUAL ZEROES                    32050031
320600        IF ENTNME-ENT-ID > 0                                      32060031
320700           MOVE 'KOHLS ENT ID   '     TO TR211-DATA-IN-ERROR      32070031
320800           MOVE 'VENDOR IS NOT A KOHLS ASN APPROVED VENDOR'       32080031
320900                                      TO TR211-ERROR-MSG          32090031
321000           PERFORM 4010-SELECT-ENT-NAME                           32100031
321100           MOVE ENTNME-ENT-NAME-DESC  TO TR211-DATA-VALUE         32110031
321200           MOVE ENTNME-ENT-ID         TO PV-HOLD-DAT-SRC-ENT-ID   32120031
321300        ELSE                                                      32130031
321400           MOVE 'VNDR INTRCHG ID'     TO TR211-DATA-IN-ERROR      32140031
321500           MOVE 'VENDOR DOES NOT HAVE A VALID KOHLS ENT-ID'       32150031
321600                                      TO TR211-ERROR-MSG          32160031
321700           MOVE TR063-ISA-ID          TO TR211-DATA-VALUE         32170031
321800        END-IF                                                    32180031
321900        MOVE PC-ERROR                 TO TR211-ERROR-TYPE         32190031
322000        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       32200031
322100     ELSE                                                         32210031
322200        MOVE TR023-CNTR-DAT-SRC-ENT-ID TO PV-HOLD-DAT-SRC-ENT-ID  32220031
322300     END-IF.                                                      32230031
322400                                                                  32240031
322500****************************************************************  32250031
322600* SELECT VENDOR ENT NAME                                          32260031
322700****************************************************************  32270031
322800 4010-SELECT-ENT-NAME.                                            32280031
322900*    DISPLAY '4010-SELECT-ENT-NAME'.                              32290031
323000                                                                  32300031
323100     EXEC SQL                                                     32310031
323200        SELECT DISTINCT ENT_NAME_DESC                             32320031
323300        INTO  :ENTNME-ENT-NAME-DESC                               32330031
323400        FROM   TENTNME EN                                         32340031
323500        WHERE  ENT_ID   = :ENTNME-ENT-ID                          32350031
323600          AND  TYPE_CDE = '01'                                    32360031
323700     END-EXEC.                                                    32370031
323800                                                                  32380031
323900     EVALUATE TRUE                                                32390031
324000         WHEN SQLCODE = ZERO                                      32400031
324100         WHEN SQLCODE = +100                                      32410031
324200             CONTINUE                                             32420031
324300         WHEN SQLWARN0 NOT = SPACES                               32430031
324400         WHEN SQLCODE < ZERO                                      32440031
324500         WHEN SQLCODE > ZERO                                      32450031
324600             MOVE '4010-SELECT-ENT-NAME'                          32460031
324700                                       TO PV-PARAGRAPH-NAME       32470031
324800             MOVE 'ERROR ATTEMPTING TO SELECT'                    32480031
324900                                       TO PV-DB2-OPERATION-MESSAGE32490031
325000             MOVE 'TENTNME'            TO PV-DB2-TABLE-NAME-1     32500031
325100             MOVE SPACES               TO PV-DB2-TABLE-NAME-2     32510031
325200             MOVE SPACES               TO PV-DB2-TABLE-NAME-3     32520031
325300             PERFORM 9100-USER-ABEND                              32530031
325400     END-EVALUATE.                                                32540031
325500                                                                  32550031
325600******************************************************************32560031
325700* EDIT DATA AT THE SHIPMENT LEVEL                                 32570031
325800******************************************************************32580031
325900 4100-EDIT-SHIPMENT-LEVEL-DATA.                                   32590031
326000***  DISPLAY '4100-EDIT-SHIPMENT-LEVEL-DATA'.                     32600031
326100                                                                  32610031
326200     MOVE 'CNTR'                 TO TR023-CNTR-REC-TYP-CDE.       32620031
326300     MOVE '10'                   TO TR023-CNTR-SEQ-NBR.           32630031
326400     MOVE SPACES                 TO TR023-CNTR-3RD-PARTY-CDE.     32640031
326500     MOVE PV-HOLD-TRN-TYP        TO TR023-CNTR-TRN-TYP.           32650031
326600     MOVE PV-HOLD-DAT-SRC-ENT-ID TO TR023-CNTR-DAT-SRC-ENT-ID.    32660031
326700     SET PS-DATA-IN-ERROR-NO     TO TRUE.                         32670031
326800     SET PS-UPC-NBR-FOUND-NO     TO TRUE.                         32680031
326900     INITIALIZE DCLTRT00012.                                      32690031
327000                                                                  32700031
327100     IF TR023-CNTR-TRIP-TYP-CDE-MOM EQUAL PC-A OR PC-O            32710031
327200        CONTINUE                                                  32720031
327300     ELSE                                                         32730031
327400        IF TR023-CNTR-TRIP-TYP-CDE-MOM EQUAL SPACES               32740031
327500           MOVE 'DATA NOT SENT'          TO TR211-ERROR-MSG       32750031
327600        ELSE                                                      32760031
327700           MOVE 'INVALID TRIP TYPE'      TO TR211-ERROR-MSG       32770031
327800        END-IF                                                    32780031
327900        MOVE PC-WARNING                  TO TR211-ERROR-TYPE      32790031
328000        MOVE 'TRIP TYP CDE   '           TO TR211-DATA-IN-ERROR   32800031
328100        MOVE TR023-CNTR-TRIP-TYP-CDE-MOM TO TR211-DATA-VALUE      32810031
328200        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       32820031
328300     END-IF.                                                      32830031
328400                                                                  32840031
328500     PERFORM 4110-EDIT-SHIP-LVL-CONTAINER                         32850031
328600     IF TR023-CNTR-CONTNR-ID EQUAL SPACES                         32860031
328700        MOVE PC-ERROR                    TO TR211-ERROR-TYPE      32870031
328800        MOVE 'CONTAINER ID   '           TO TR211-DATA-IN-ERROR   32880031
328900        MOVE 'CONTAINER NUMBER NOT SENT' TO TR211-ERROR-MSG       32890031
329000        MOVE SPACES                      TO TR211-DATA-VALUE      32900031
329100        SET PS-DATA-IN-ERROR             TO TRUE                  32910031
329200        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       32920031
329300     ELSE                                                         32930031
329400        MOVE TR023-CNTR-CONTNR-ID        TO PV-HOLD-CONTNR-ID     32940031
329500        IF TR023-CNTR-CONTNR-ID(1:1) EQUAL SPACE                  32950031
329600           MOVE PC-WARNING               TO TR211-ERROR-TYPE      32960031
329700           MOVE 'CONTAINER ID   '        TO TR211-DATA-IN-ERROR   32970031
329800           MOVE 'CONTAINER NUMBER HAS SPACE IN FIRST POSITION'    32980031
329900                                         TO TR211-ERROR-MSG       32990031
330000           MOVE TR023-CNTR-CONTNR-ID     TO TR211-DATA-VALUE      33000031
330100           PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                    33010031
330200        END-IF                                                    33020031
330300     END-IF.                                                      33030031
330400                                                                  33040031
330500     IF TR023-CNTR-ACTL-DPRTR-DTE-MOM(3:6) EQUAL SPACES           33050031
330600        MOVE PC-ERROR            TO TR211-ERROR-TYPE              33060031
330700        MOVE 'ACTL DPTR DTE  '   TO TR211-DATA-IN-ERROR           33070031
330800        MOVE 'ACTUAL DEPARTURE DATE NOT SENT'                     33080031
330900                                 TO TR211-ERROR-MSG               33090031
331000        MOVE SPACES              TO TR211-DATA-VALUE              33100031
331100        MOVE SPACES              TO TR023-CNTR-ACTL-DPRTR-DTE-MOM 33110031
331200        SET PS-DATA-IN-ERROR     TO TRUE                          33120031
331300        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       33130031
331400     ELSE                                                         33140031
331500        MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM                        33150031
331600                                  TO PV-HOLD-ACTL-DPRTR-DTE       33160031
331700        IF TR023-CNTR-ACTL-DPRTR-TM-MOM EQUAL TO SPACES           33170031
331800           MOVE ZEROES            TO TR023-CNTR-ACTL-DPRTR-TM-MOM 33180031
331900        END-IF                                                    33190031
332000        MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM TO PV-HOLD-ACTL-DPRTR-TM33200031
332100     END-IF.                                                      33210031
332200                                                                  33220031
332300     IF TR023-CNTR-EST-POE-DELY-DT-MOM(3:6) EQUAL SPACES          33230031
332400        MOVE PC-WARNING         TO TR211-ERROR-TYPE               33240031
332500        MOVE 'EST POE DELY DT'  TO TR211-DATA-IN-ERROR            33250031
332600        MOVE 'ESTIMATED POE DELIVERY DATE NOT SENT'               33260031
332700                                TO TR211-ERROR-MSG                33270031
332800        MOVE SPACES             TO TR211-DATA-VALUE               33280031
332900***     **** PKE5381 MJF 3/31/11 CHANGE #1 START                  33290031
333000***     MOVE PC-DEFAULT-DTE-NO-DASHES                             33300031
333100***                             TO TR023-CNTR-EST-POE-DELY-DT-MOM 33310031
333200        MOVE PV-HOLD-LOAD-DTE   TO TR023-CNTR-EST-POE-DELY-DT-MOM 33320031
333300***     **** PKE5381 MJF 3/31/11 CHANGE #1 END                    33330031
333400        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       33340031
333500     END-IF.                                                      33350031
333600                                                                  33360031
333700     IF TR023-CNTR-IMP-VEH-NM-MOM EQUAL SPACES                    33370031
333800        MOVE PC-WARNING         TO TR211-ERROR-TYPE               33380031
333900        MOVE 'IMP VEH NM     '  TO TR211-DATA-IN-ERROR            33390031
334000        MOVE 'DATA NOT SENT'    TO TR211-ERROR-MSG                33400031
334100        MOVE SPACES             TO TR211-DATA-VALUE               33410031
334200        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       33420031
334300     END-IF.                                                      33430031
334400                                                                  33440031
334500     IF TR023-CNTR-DEST-POE-CDE-MOM EQUAL SPACES                  33450031
334600        MOVE PC-WARNING         TO TR211-ERROR-TYPE               33460031
334700        MOVE 'DEST POE CDE   '  TO TR211-DATA-IN-ERROR            33470031
334800        MOVE 'DATA NOT SENT'    TO TR211-ERROR-MSG                33480031
334900        MOVE SPACES             TO TR211-DATA-VALUE               33490031
335000        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       33500031
335100     END-IF.                                                      33510031
335200                                                                  33520031
335300     IF TR023-CNTR-ORGN-SHPD-TO-CDE EQUAL SPACES                  33530031
335400        MOVE PC-WARNING         TO TR211-ERROR-TYPE               33540031
335500        MOVE 'ORGN SHPD TO CD'  TO TR211-DATA-IN-ERROR            33550031
335600        MOVE 'DATA NOT SENT'    TO TR211-ERROR-MSG                33560031
335700        MOVE SPACES             TO TR211-DATA-VALUE               33570031
335800        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       33580031
335900     END-IF.                                                      33590031
336000                                                                  33600031
336100     IF TR023-CNTR-IMPRT-TRIP-ID-MOM EQUAL SPACES                 33610031
336200        MOVE PC-WARNING         TO TR211-ERROR-TYPE               33620031
336300        MOVE 'IMPRT TRIP ID  '  TO TR211-DATA-IN-ERROR            33630031
336400        MOVE 'DATA NOT SENT'    TO TR211-ERROR-MSG                33640031
336500        MOVE SPACES             TO TR211-DATA-VALUE               33650031
336600        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       33660031
336700     END-IF.                                                      33670031
336800                                                                  33680031
336900* IF THERE WERE NO ERRORS ON THE RECORD SAVE IT                   33690031
337000     IF PS-DATA-IN-ERROR-NO                                       33700031
337100*       HOLD ISA RECORD                                           33710031
337200        IF PS-WRITE-ISA-REC                                       33720031
337300           INITIALIZE PV-HOLD-ISA-REC                             33730031
337400           MOVE PV-HOLD-FILE-ID        TO PV-HOLD-ISA-FILE-ID     33740031
337500                                          PV-HOLD-ISA-FILE-ID-1   33750031
337600           MOVE PV-HOLD-DAT-SRC-ENT-ID TO PV-HOLD-ISA-ENT-ID      33760031
337700                                          PV-HOLD-ISA-ENT-ID-1    33770031
337800           ADD +1                      TO PV-PROCESS-SEQ-NBR      33780031
337900           MOVE PV-PROCESS-SEQ-NBR     TO PV-HOLD-ISA-SEQ-NBR     33790031
338000        END-IF                                                    33800031
338100                                                                  33810031
338200*       HOLD SHIPMENT RECORD                                      33820031
338300        ADD +1                  TO PV-PROCESS-SEQ-NBR             33830031
338400        MOVE PV-PROCESS-SEQ-NBR TO TR023-CNTR-PROCESS-SEQ-NBR-1   33840031
338500        MOVE ZEROES             TO TR023-CNTR-PROCESS-SEQ-NBR-2   33850031
338600        ADD +1                  TO PV-PROCESS-SEQ-NBR             33860031
338700        MOVE PV-PROCESS-SEQ-NBR TO TR023-CNTR-PROCESS-SEQ-NBR-3   33870031
338800        ADD +1                  TO PV-PROCESS-SEQ-NBR             33880031
338900        MOVE PV-PROCESS-SEQ-NBR TO TR023-CNTR-PROCESS-SEQ-NBR-4   33890031
339000        MOVE TR023-REC-TYP-CNTR TO PV-HOLD-REC-TYP-CNTR           33900031
339100        INITIALIZE TR023-REC-TYP-CNTR                             33910031
339200     END-IF.                                                      33920031
339300                                                                  33930031
339400******************************************************************33940031
339500* EDIT DATA AT THE SHIPMENT LEVEL - CONTAINER ID                  33950031
339600******************************************************************33960031
339700 4110-EDIT-SHIP-LVL-CONTAINER.                                    33970031
339800                                                                  33980031
339900***  DISPLAY '4110-EDIT-SHIP-LVL-CONTAINER'.                      33990031
340000                                                                  34000031
340100     IF PV-TD302-EQUIP-INIT-CDE (1:1)  NUMERIC                    34010031
340200     OR PV-TD302-EQUIP-INIT-CDE (2:1)  NUMERIC                    34020031
340300     OR PV-TD302-EQUIP-INIT-CDE (3:1)  NUMERIC                    34030031
340400     OR PV-TD302-EQUIP-INIT-CDE (4:1)  NUMERIC                    34040031
340500        MOVE PC-WARNING              TO TR211-ERROR-TYPE          34050031
340600        MOVE 'CONTAINER ID   '       TO TR211-DATA-IN-ERROR       34060031
340700        MOVE 'CONTAINER DOES NOT BEGIN WITH 4 ALPHA CHARACTERS'   34070031
340800                                       TO TR211-ERROR-MSG         34080031
340900        MOVE PV-TD302-EQUIP-INIT-CDE    TO TR211-DATA-VALUE       34090031
341000        PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                       34100031
341100     END-IF.                                                      34110031
341200                                                                  34120031
341300*    *********************************************                34130031
341400*    **** SENDING FIELD LENGTHS = 4 + 10 = 14 ****                34140031
341500*    **** RECEIVING FIELD LENGTH = 12         ****                34150031
341600*    *********************************************                34160031
341700                                                                  34170031
341800***  **** PKE2372 MJF 3/31/11 CHANGE #1 START                     34180031
341900***  **** SKIP PAST ANY GARBAGE IN FIRST 2 CHARS                  34190031
342000     IF PV-TD302-EQUIP-INIT-CDE (1:2)                             34200031
342100                  = '00' OR '  ' OR '0 ' OR ' 0'                  34210031
342200       MOVE 3 TO PV-MV-START                                      34220031
342300     ELSE                                                         34230031
342400       MOVE 1 TO PV-MV-START                                      34240031
342500     END-IF.                                                      34250031
342600                                                                  34260031
342700     MOVE PV-WORK-CONTAINER (PV-MV-START:12)                      34270031
342800         TO TR023-CNTR-CONTNR-ID.                                 34280031
342900***  **** PKE2372 MJF 3/31/11 CHANGE #1 END                       34290031
343000                                                                  34300031
343100******************************************************************34310031
343200* EDIT DATA AT THE PO LEVEL                                       34320031
343300******************************************************************34330031
343400 4200-EDIT-PO-LEVEL-DATA.                                         34340031
343500*    DISPLAY '4200-EDIT-PO-LEVEL-DATA'.                           34350031
343600                                                                  34360031
343700     MOVE 'CONPO'            TO TR023-CNTR-REC-TYP-CDE.           34370031
343800     MOVE '20'               TO TR023-CNTR-SEQ-NBR.               34380031
343900     MOVE SPACES             TO TR023-CNTR-3RD-PARTY-CDE.         34390031
344000     SET PS-DATA-IN-ERROR-NO TO TRUE.                             34400031
344100     SET PS-UPC-NBR-FOUND-NO TO TRUE.                             34410031
344200     INITIALIZE DCLTRT00012.                                      34420031
344300     SET ERR-INDEX           TO +1.                               34430031
344400                                                                  34440031
344500     MOVE PV-HOLD-TRN-TYP        TO TR023-CONPO-TRN-TYP.          34450031
344600     MOVE PV-HOLD-CONTNR-ID      TO TR023-CONPO-CONTNR-ID.        34460031
344700     MOVE PV-HOLD-ACTL-DPRTR-DTE TO TR023-CONPO-ACTL-DPRTR-DTE.   34470031
344800     MOVE PV-HOLD-ACTL-DPRTR-TM  TO TR023-CONPO-ACTL-DPRTR-TM.    34480031
344900     MOVE PV-HOLD-DAT-SRC-ENT-ID TO TR023-CONPO-DAT-SRC-ENT-ID.   34490031
345000                                                                  34500031
345100* ***DISPLAY 'TR023-CONPO-PO-NBR ' TR023-CONPO-PO-NBR             34510031
345200                                                                  34520031
345300     IF TR023-CONPO-PO-NBR EQUAL SPACES OR ZEROS                  34530031
345400        MOVE 'PO NUMBER MISSING '     TO TR211-ERROR-MSG          34540031
345500        SET PS-DATA-IN-ERROR          TO TRUE                     34550031
345600     ELSE                                                         34560031
345700        IF TR023-CONPO-PO-NBR NOT NUMERIC                         34570031
345800           MOVE 'INVALID PO NUMBER'   TO TR211-ERROR-MSG          34580031
345900           SET PS-DATA-IN-ERROR       TO TRUE                     34590031
346000     END-IF.                                                      34600031
346100                                                                  34610031
346200     IF PS-DATA-IN-ERROR                                          34620031
346300        MOVE PC-ERROR                 TO TR211-ERROR-TYPE         34630031
346400        MOVE 'PO NUMBER      '        TO TR211-DATA-IN-ERROR      34640031
346500        MOVE TR023-CONPO-PO-NBR       TO TR211-DATA-VALUE-N       34650031
346600        PERFORM 7300-WRITE-PO-LEVEL-ERROR                         34660031
346700     ELSE                                                         34670031
346800        MOVE TR023-CONPO-PO-NBR TO PV-HOLD-PO-NBR                 34680031
346900        ADD +1                  TO PV-PROCESS-SEQ-NBR             34690031
347000        MOVE PV-PROCESS-SEQ-NBR TO TR023-CONPO-PROCESS-SEQ-NBR-1  34700031
347100        ADD +1                  TO PV-PROCESS-SEQ-NBR             34710031
347200        MOVE PV-PROCESS-SEQ-NBR TO TR023-CONPO-PROCESS-SEQ-NBR-2  34720031
347300        ADD +1                  TO PV-PROCESS-SEQ-NBR             34730031
347400        MOVE PV-PROCESS-SEQ-NBR TO TR023-CONPO-PROCESS-SEQ-NBR-3  34740031
347500        MOVE TR023-REC-TYP-CONPO TO PV-HOLD-REC-TYP-CONPO         34750031
347600        INITIALIZE TR023-REC-TYP-CNTR                             34760031
347700     END-IF.                                                      34770031
347800******************************************************************34780031
347900* EDIT DATA AT THE PACK LEVEL                                     34790031
348000******************************************************************34800031
348100 4300-EDIT-PACK-LEVEL-DATA.                                       34810031
348200*    DISPLAY '4300-EDIT-PACK-LEVEL-DATA'.                         34820031
348300                                                                  34830031
348400     SET PS-DATA-IN-ERROR-NO TO TRUE.                             34840031
348500                                                                  34850031
348600     EVALUATE TRUE                                                34860031
348700        WHEN TRT00012-SSCC-ID(3:18) EQUAL SPACES                  34870031
348800           MOVE PC-WARNING               TO TR211-ERROR-TYPE      34880031
348900           MOVE 'SSCC ID        '        TO TR211-DATA-IN-ERROR   34890031
349000           MOVE 'DATA NOT SENT'          TO TR211-ERROR-MSG       34900031
349100           MOVE SPACES                   TO TR211-DATA-VALUE      34910031
349200           PERFORM 7400-WRITE-PACK-LEVEL-ERROR                    34920031
349300                                                                  34930031
349400        WHEN TRT00012-SSCC-ID(1:2) NOT EQUAL ZEROES               34940031
349500           MOVE PC-WARNING               TO TR211-ERROR-TYPE      34950031
349600           MOVE 'SSCC ID        '        TO TR211-DATA-IN-ERROR   34960031
349700           MOVE 'INVALID DATA'           TO TR211-ERROR-MSG       34970031
349800           MOVE TRT00012-SSCC-ID         TO TR211-DATA-VALUE      34980031
349900           PERFORM 7400-WRITE-PACK-LEVEL-ERROR                    34990031
350000     END-EVALUATE.                                                35000031
350100                                                                  35010031
350200     IF TRT00012-SSCC-ID(21:28) NOT EQUAL SPACES                  35020031
350300        MOVE PC-WARNING                TO TR211-ERROR-TYPE        35030031
350400        MOVE 'SSCC ID        '         TO TR211-DATA-IN-ERROR     35040031
350500        MOVE 'INVALID DATA'            TO TR211-ERROR-MSG         35050031
350600        MOVE TRT00012-SSCC-ID(21:28)   TO TR211-DATA-VALUE        35060031
350700        MOVE SPACES                    TO TRT00012-SSCC-ID(21:28) 35070031
350800        PERFORM 7400-WRITE-PACK-LEVEL-ERROR                       35080031
350900     END-IF.                                                      35090031
351000                                                                  35100031
351100     IF TRT00012-UNT-QTY EQUAL ZEROES                             35110031
351200        MOVE PC-WARNING                TO TR211-ERROR-TYPE        35120031
351300        MOVE 'UNIT QUANTITY  '         TO TR211-DATA-IN-ERROR     35130031
351400        MOVE 'DATA NOT SENT'           TO TR211-ERROR-MSG         35140031
351500        MOVE ZERO                      TO TR211-DATA-VALUE        35150031
351600        PERFORM 7400-WRITE-PACK-LEVEL-ERROR                       35160031
351700     END-IF.                                                      35170031
351800                                                                  35180031
351900******************************************************************35190031
352000* EDIT DATA AT THE PACK LEVEL                                     35200031
352100******************************************************************35210031
352200 4400-EDIT-ITEM-LEVEL-DATA.                                       35220031
352300*    DISPLAY '4400-EDIT-ITEM-LEVEL-DATA'.                         35230031
352400                                                                  35240031
352500     SET PS-DATA-IN-ERROR-NO TO TRUE.                             35250031
352600                                                                  35260031
352700     IF PV-UPC-NBR-NON-NUMERIC NOT EQUAL SPACES                   35270031
352800        MOVE 'INVALID UPC NUMBER'     TO TR211-ERROR-MSG          35280031
352900        MOVE PV-UPC-NBR-NON-NUMERIC   TO TR211-DATA-VALUE         35290031
353000        SET PS-DATA-IN-ERROR          TO TRUE                     35300031
353100     ELSE                                                         35310031
353200        IF TRT00012-UPC-NBR EQUAL ZEROES                          35320031
353300           MOVE 'UPC NUMBER MISSING'  TO TR211-ERROR-MSG          35330031
353400           MOVE ZEROES                TO TR211-DATA-VALUE         35340031
353500           SET PS-DATA-IN-ERROR       TO TRUE                     35350031
353600        END-IF                                                    35360031
353700     END-IF.                                                      35370031
353800                                                                  35380031
353900     IF PS-DATA-IN-ERROR                                          35390031
354000        MOVE PC-ERROR                 TO TR211-ERROR-TYPE         35400031
354100        MOVE 'UPC NUMBER     '        TO TR211-DATA-IN-ERROR      35410031
354200        MOVE TRT00012-UPC-NBR         TO TR211-CONUPA-UPC-NBR     35420031
354300        PERFORM 7500-WRITE-ITEM-LEVEL-ERROR                       35430031
354400     END-IF.                                                      35440031
354500     INITIALIZE PV-UPC-NBR-NON-NUMERIC.                           35450031
354600                                                                  35460031
354700     IF TRT00012-ASN-PKGNG-CDE EQUAL 'AS' OR 'EA'                 35470031
354800        CONTINUE                                                  35480031
354900     ELSE                                                         35490031
355000        IF TRT00012-ASN-PKGNG-CDE EQUAL SPACES                    35500031
355100           MOVE 'DATA NOT SENT'          TO TR211-ERROR-MSG       35510031
355200        ELSE                                                      35520031
355300           MOVE 'UPC PKG CODE NOT VALID' TO TR211-ERROR-MSG       35530031
355400        END-IF                                                    35540031
355500        MOVE PC-WARNING                  TO TR211-ERROR-TYPE      35550031
355600        MOVE 'ASN PKG CDE    '           TO TR211-DATA-IN-ERROR   35560031
355700        MOVE TRT00012-ASN-PKGNG-CDE      TO TR211-DATA-VALUE      35570031
355800        MOVE TRT00012-UPC-NBR            TO TR211-CONUPA-UPC-NBR  35580031
355900        PERFORM 7500-WRITE-ITEM-LEVEL-ERROR                       35590031
356000     END-IF.                                                      35600031
356100                                                                  35610031
356200******************************************************************35620031
356300* READ A RECORD FROM THE CONTAINER FILE.                          35630031
356400******************************************************************35640031
356500 6000-READ-ASN-FILE.                                              35650031
356600*    DISPLAY '6000-READ-ASN-FILE'.                                35660031
356700                                                                  35670031
356800     READ TR063-ASN-FILE                                          35680031
356900         INTO TR063-ADV-SHIP-NOTICE-DTL-REC                       35690031
357000         AT END                                                   35700031
357100           SET PS-END-OF-ASN TO TRUE.                             35710031
357200                                                                  35720031
357300     IF PS-END-OF-ASN-NO                                          35730031
357310       ADD +1 TO PA-INPUT-COUNT                                   35731036
357500* SET PREVIOUS AND CURRENT RECORD LEVELS AND ASN STRUCTURE        35750031
357600       IF ID-IDENTIFICATION-REC                                   35760031
357700          MOVE PV-RECORD-LEVEL-CDE TO PV-PREV-RECORD-LEVEL-CDE    35770031
357800          MOVE 'ID'              TO PV-RECORD-LEVEL-CDE           35780031
357801          MOVE PA-INPUT-COUNT    TO PV-COUNT-DISPLAY              35780136
357802          DISPLAY ' '                                             35780236
357810          DISPLAY 'NEW ASN - ASN NUMBER: '                        35781036
357820                  TR063-BSN02-SHIPT-ID                            35782036
357830                  ' FOR EDI VEND ID: '                            35783036
357840                  TR063-EDI-VEND-ID                               35784036
357850          DISPLAY 'NEW ASN STARTED AT RECORD: '                   35785036
357860                  PV-COUNT-DISPLAY                                35786036
357900       END-IF                                                     35790031
358000       IF HL-HIERARCHICAL-REC                                     35800031
358100          MOVE PV-RECORD-LEVEL-CDE TO PV-PREV-RECORD-LEVEL-CDE    35810031
358200          MOVE TR063-LVL-CDE     TO PV-RECORD-LEVEL-CDE           35820031
358300       END-IF                                                     35830031
358500     END-IF.                                                      35850031
358600                                                                  35860031
358700******************************************************************35870031
358800* BYPASS ALL RECORDS UNTIL NEXT ID RECORD.                        35880031
358900******************************************************************35890031
359000 6010-BYPASS-TO-NEXT-ID.                                          35900031
359100*    DISPLAY '6010-BYPASS-TO-NEXT-ID'.                            35910031
359200     PERFORM 6000-READ-ASN-FILE                                   35920031
359300       UNTIL ID-IDENTIFICATION-REC                                35930031
359400          OR PS-END-OF-ASN.                                       35940031
359500     SET PS-BYPASS-IN-PROCESS TO TRUE.                            35950031
359600                                                                  35960031
359700     INITIALIZE PV-PREV-RECORD-LEVEL-CDE.                         35970031
359800                                                                  35980031
359900******************************************************************35990031
360000* BYPASS THE PACK LEVEL.                                          36000031
360100******************************************************************36010031
360200 6020-BYPASS-PACK-LEVEL.                                          36020031
360300*    DISPLAY '6020-BYPASS-PACK-LEVEL'.                            36030031
360400     PERFORM 6000-READ-ASN-FILE                                   36040031
360500       UNTIL NOT PV-PACK-LEVEL                                    36050031
360600          OR PS-END-OF-ASN.                                       36060031
360700                                                                  36070031
360800     SET PS-BYPASS-IN-PROCESS TO TRUE.                            36080031
360900                                                                  36090031
361000******************************************************************36100031
361100* BYPASS TO NEXT PO AND WRITE RECORDS TO THE EXCEPTION FILE.      36110031
361200******************************************************************36120031
361300 6025-BYPASS-WRITE-TO-NEXT-HL-O.                                  36130031
361400*    DISPLAY '6025-BYPASS-WRITE-TO-NEXT-HL-O'.                    36140031
361500                                                                  36150031
361600     SET PS-WRITE-TO-EXCEPTION-FILE TO TRUE.                      36160031
361700                                                                  36170031
361800     PERFORM 6026-WRITE-EXC-TO-NEXT-HL-O                          36180031
361900       UNTIL PS-WRITE-TO-EXCEPTION-FILE-NO.                       36190031
362000                                                                  36200031
362100     SET PS-BYPASS-IN-PROCESS TO TRUE.                            36210031
362200                                                                  36220031
362300******************************************************************36230031
362400* BYPASS TO NEXT PO AND WRITE RECORDS TO THE EXCEPTION FILE.      36240031
362500******************************************************************36250031
362600 6026-WRITE-EXC-TO-NEXT-HL-O.                                     36260031
362700*    DISPLAY '6026-WRITE-EXC-TO-NEXT-HL-O'.                       36270031
362800                                                                  36280031
362900     WRITE TR063-EXCEPTION-RECORD                                 36290031
363000      FROM TR063-ADV-SHIP-NOTICE-DTL-REC.                         36300031
363100                                                                  36310031
363200     PERFORM 6000-READ-ASN-FILE.                                  36320031
363300                                                                  36330031
363400     IF (HL-HIERARCHICAL-REC AND ORDER-LEVEL)                     36340031
363500     OR ID-IDENTIFICATION-REC                                     36350031
363600     OR PS-END-OF-ASN                                             36360031
363700        SET PS-WRITE-TO-EXCEPTION-FILE-NO TO TRUE                 36370031
363800     END-IF.                                                      36380031
363900                                                                  36390031
364000     IF ID-IDENTIFICATION-REC                                     36400031
364100        IF TR063-ISA-ID EQUAL PV-PREV-ISA-ID                      36410031
364200           SET PS-WRITE-TO-EXCEPTION-FILE TO TRUE                 36420031
364300        END-IF                                                    36430031
364400     END-IF.                                                      36440031
364500                                                                  36450031
364600******************************************************************36460031
364700* BYPASS ALL RECORDS UNTIL NEXT HL-P RECORD.                      36470031
364800******************************************************************36480031
364900 6029-BYPASS-TO-NEXT-HL-P-O-ID.                                   36490031
365000*    DISPLAY '6029-BYPASS-TO-NEXT-HL-P-O-ID'.                     36500031
365100                                                                  36510031
365200     SET PS-BYPASS-IN-PROCESS TO TRUE.                            36520031
365300                                                                  36530031
365400     PERFORM 6000-READ-ASN-FILE                                   36540031
365500       UNTIL (HL-HIERARCHICAL-REC AND PACK-LEVEL)                 36550031
365600          OR (HL-HIERARCHICAL-REC AND ORDER-LEVEL)                36560031
365700          OR ID-IDENTIFICATION-REC                                36570031
365800          OR PS-END-OF-ASN.                                       36580031
365900                                                                  36590031
366000     IF ((HL-HIERARCHICAL-REC AND ORDER-LEVEL)                    36600031
366100       OR ID-IDENTIFICATION-REC                                   36610031
366200       OR PS-END-OF-ASN)                                          36620031
366300       AND PS-PRF-PO-NBR-CSR-OPEN                                 36630031
366400       PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                          36640031
366500     END-IF.                                                      36650031
366600                                                                  36660031
366700     IF (HL-HIERARCHICAL-REC AND PACK-LEVEL)                      36670031
366800          OR (HL-HIERARCHICAL-REC AND ORDER-LEVEL)                36680031
366900          OR ID-IDENTIFICATION-REC                                36690031
367000          OR PS-END-OF-ASN                                        36700031
367100           SET PS-BYPASS-IN-PROCESS-NO TO TRUE                    36710031
367200           SET PS-BYPASS-HL-P-O-ID TO TRUE.                       36720031
367300*    INITIALIZE PV-PREV-RECORD-LEVEL-CDE.                         36730031
367400                                                                  36740031
367500******************************************************************36750031
367600* BYPASS AND WRITE RECORDS TO THE EXCEPTION FILE.                 36760031
367700******************************************************************36770031
367800 6030-BYPASS-TO-NEXT-ISA-ID.                                      36780031
367900*    DISPLAY '6030-BYPASS-TO-NEXT-ISA-ID'.                        36790031
368000                                                                  36800031
368100     MOVE TR063-ISA-ID TO PV-PREV-ISA-ID.                         36810031
368200     SET PS-WRITE-TO-EXCEPTION-FILE TO TRUE.                      36820031
368300                                                                  36830031
368400     PERFORM 6031-WRITE-EXCEPTION                                 36840031
368500***  **** PBI3484 MJF 8/31/09 CHANGE #3 START                     36850031
368600***    UNTIL PS-WRITE-TO-EXCEPTION-FILE-NO.                       36860031
368700       UNTIL PS-WRITE-TO-EXCEPTION-FILE-NO                        36870031
368800          OR PS-END-OF-ASN.                                       36880031
368900***  **** PBI3484 MJF 8/31/09 CHANGE #3 END                       36890031
369000                                                                  36900031
369100     INITIALIZE PV-PREV-ISA-ID.                                   36910031
369200     SET PS-BYPASS-IN-PROCESS TO TRUE.                            36920031
369300                                                                  36930031
369400*AME* 7/28/08 NEXT 3 LINES ADDED                                  36940031
369500     IF PS-PRF-PO-NBR-CSR-OPEN                                    36950031
369600        PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                         36960031
369700     END-IF.                                                      36970031
369800******************************************************************36980031
369900* BYPASS AND WRITE RECORDS TO THE EXCEPTION FILE.                 36990031
370000******************************************************************37000031
370100 6031-WRITE-EXCEPTION.                                            37010031
370200*    DISPLAY '6031-WRITE-EXCEPTION'.                              37020031
370300                                                                  37030031
370400     WRITE TR063-EXCEPTION-RECORD                                 37040031
370500      FROM TR063-ADV-SHIP-NOTICE-DTL-REC.                         37050031
370600                                                                  37060031
370700     PERFORM 6000-READ-ASN-FILE.                                  37070031
370800                                                                  37080031
370900     IF ID-IDENTIFICATION-REC                                     37090031
371000     OR PS-END-OF-ASN                                             37100031
371100        SET PS-WRITE-TO-EXCEPTION-FILE-NO TO TRUE                 37110031
371200     END-IF.                                                      37120031
371300                                                                  37130031
371400* ******* PBI3484 MJF PHASE 2 - 03/31/11 CHANGE #1 START          37140031
371500* ******* COMMENTED OUT 5 LINES BELOW.                            37150031
371600* ** IF ID-IDENTIFICATION-REC                                     37160031
371700* **    IF TR063-ISA-ID EQUAL PV-PREV-ISA-ID                      37170031
371800* **       SET PS-WRITE-TO-EXCEPTION-FILE TO TRUE                 37180031
371900* **    END-IF                                                    37190031
372000* ** END-IF.                                                      37200031
372100* ******* PBI3484 MJF 03/31/11 CHANGE #1 END                      37210031
372200                                                                  37220031
372300***************************************************************** 37230031
372400* WRITE UPDATE RECORD                                             37240031
372500***************************************************************** 37250031
372600 6100-WRITE-UPDATE-RECORD.                                        37260031
372700*    DISPLAY '6100-WRITE-UPDATE-RECORD'.                          37270031
372800     WRITE TR023-UPDATE-CONTAINER-RECORD FROM                     37280031
372900           TR023-REC-TYP-CNTR.                                    37290031
373000                                                                  37300031
373100***************************************************************** 37310031
373200* WRITE UPDATE RECORD                                             37320031
373300***************************************************************** 37330031
373400 6110-WRITE-CNTR-RECORD.                                          37340031
373500*    DISPLAY '6110-WRITE-CNTR-RECORD'.                            37350031
373600                                                                  37360031
373700     IF PS-WRITE-ISA-REC                                          37370031
373800        MOVE PV-HOLD-ISA-REC      TO TR023-REC-TYP-CNTR           37380031
373900        PERFORM 6100-WRITE-UPDATE-RECORD                          37390031
374000        SET PS-WRITE-ISA-REC-NO   TO TRUE                         37400031
374100     END-IF                                                       37410031
374200                                                                  37420031
374300     MOVE PV-HOLD-REC-TYP-CNTR   TO TR023-REC-TYP-CNTR.           37430031
374400     MOVE PV-HOLD-FILE-ID        TO TR023-CNTR-FILE-ID.           37440031
374500     MOVE PV-TOTAL-CNTR-UNT-QTY  TO TR023-CNTR-UNT-QTY.           37450031
374600     MOVE PV-TOTAL-CNTR-CART-CNT TO TR023-CNTR-CART-CNT.          37460031
374700     MOVE PV-SHIPM-CNTR-CBMT-QTY TO TR023-CNTR-CBMT-QTY.          37470031
374800     MOVE PV-SHIPM-CNTR-KGRM-QTY TO TR023-CNTR-WT-KGRM-QTY.       37480031
374900     MOVE PC-DEFAULT-DTE-NO-DASHES                                37490031
375000                                 TO TR023-CNTR-EST-LBD-DTE        37500031
375100                                    TR023-CNTR-EST-POE-DELY-DT-FDR37510031
375200                                    TR023-CNTR-ACTL-DPRTR-DTE-FDR.37520031
375300     MOVE PC-DEFAULT-TIME        TO TR023-CNTR-EST-LBD-TM         37530031
375400                                    TR023-CNTR-EST-POE-DELY-TM-FDR37540031
375500                                    TR023-CNTR-ACTL-DPRTR-TM-FDR. 37550031
375600                                                                  37560031
375700     INITIALIZE PV-TOTAL-CNTR-UNT-QTY                             37570031
375800                PV-TOTAL-CNTR-CART-CNT                            37580031
375900                PV-TOTAL-CNTR-CBMT-QTY                            37590031
376000                PV-TOTAL-CNTR-KGRM-QTY.                           37600031
376100                                                                  37610031
376200     ADD +1 TO PA-TOTAL-UPDATE-CNTR.                              37620031
376300     PERFORM 6100-WRITE-UPDATE-RECORD.                            37630031
376400                                                                  37640031
376500***************************************************************** 37650031
376600* WRITE UPDATE RECORD                                             37660031
376700***************************************************************** 37670031
376800 6120-WRITE-CONPO-RECORD.                                         37680031
376900*    DISPLAY '6120-WRITE-CONPO-RECORD'.                           37690031
377000                                                                  37700031
377100     MOVE PV-HOLD-REC-TYP-CONPO   TO TR023-REC-TYP-CNTR.          37710031
377200                                                                  37720031
377300     MOVE PV-HOLD-FILE-ID         TO TR023-CONPO-FILE-ID.         37730031
377400     MOVE PV-TOTAL-CONPO-UNT-QTY  TO TR023-CONPO-UNT-QTY.         37740031
377500     MOVE PV-TOTAL-CONPO-CART-CNT TO TR023-CONPO-CART-CNT.        37750031
377600     MOVE PV-TOTAL-CONPO-CBMT-QTY TO TR023-CONPO-CBMT-QTY.        37760031
377700     MOVE PV-TOTAL-CONPO-KGRM-QTY TO TR023-CONPO-WT-KGRM-QTY.     37770031
377800     MOVE PC-DEFAULT-TIME         TO TR023-CONPO-DOC-RCVD-ORGN-TM.37780031
377900     MOVE PC-DEFAULT-DTE-NO-DASHES                                37790031
378000                                 TO TR023-CONPO-DOC-RCVD-ORGN-DTE 37800031
378100                                    TR023-CONPO-PO-RCVD-DELY-DTE. 37810031
378200     INITIALIZE PV-TOTAL-CONPO-UNT-QTY                            37820031
378300                PV-TOTAL-CONPO-CART-CNT                           37830031
378400                PV-TOTAL-CONPO-CBMT-QTY                           37840031
378500                PV-TOTAL-CONPO-KGRM-QTY.                          37850031
378600                                                                  37860031
378700     IF IMCNTL-LNDD-XREF-SEQ-NBR >= 999999                        37870031
378800        MOVE 0                     TO IMCNTL-LNDD-XREF-SEQ-NBR    37880031
378900     END-IF.                                                      37890031
379000     ADD +1                        TO IMCNTL-LNDD-XREF-SEQ-NBR.   37900031
379100     MOVE IMCNTL-LNDD-XREF-SEQ-NBR TO PV-HOLD-EXTL-REF-EXTENSION. 37910031
379200     STRING TR023-CONPO-DAT-SRC-ENT-ID                            37920031
379300            PV-HOLD-EXTL-REF-EXTENSION(4:6)                       37930031
379400       DELIMITED BY SIZE INTO TR023-CONPO-EXTL-REF-NBR.           37940031
379500                                                                  37950031
379600     ADD +1                          TO PA-TOTAL-UPDATE-CONPO.    37960031
379700     PERFORM 6100-WRITE-UPDATE-RECORD.                            37970031
379800                                                                  37980031
379900***************************************************************** 37990031
380000* WRITE UPDATE RECORD                                             38000031
380100***************************************************************** 38010031
380200 6130-WRITE-ITEM-PACK-RECORD.                                     38020031
380300*    DISPLAY '6130-WRITE-ITEM-PACK-RECORD'.                       38030031
380400                                                                  38040031
380500     INITIALIZE TR023-REC-TYP-CNTR.                               38050031
380600     SET PS-END-OF-ITEM-PACK-CSR-NO TO TRUE.                      38060031
380700                                                                  38070031
380800     PERFORM 6131-OPEN-ITEM-PACK-CURSOR.                          38080031
380900                                                                  38090031
381000*    INITAIL FETCH FROM WORK TABLE                                38100031
381100     PERFORM 6132-FETCH-ITEM-PACK-CURSOR.                         38110031
381200                                                                  38120031
381300     IF PS-END-OF-ITEM-PACK-CSR-NO                                38130031
381400        PERFORM 6140-PROCESS-ITEM-PACK-CURSOR                     38140031
381500          UNTIL PS-END-OF-ITEM-PACK-CSR                           38150031
381600     END-IF.                                                      38160031
381700                                                                  38170031
381800     PERFORM 6133-CLOSE-ITEM-PACK-CURSOR.                         38180031
381900     PERFORM 7610-WRITE-PACK-ERRORS.                              38190031
382000     PERFORM 8100-CLEAR-WORK-TABLE.                               38200031
382100                                                                  38210031
382200****************************************************************  38220031
382300* OPEN DC-DROP-CSR CURSOR                                         38230031
382400****************************************************************  38240031
382500 6131-OPEN-ITEM-PACK-CURSOR.                                      38250031
382600*    DISPLAY '6131-OPEN-ITEM-PACK-CURSOR'.                        38260031
382700                                                                  38270031
382800     EXEC SQL                                                     38280031
382900          OPEN ITEM-PACK-CSR                                      38290031
383000     END-EXEC.                                                    38300031
383100                                                                  38310031
383200     EVALUATE TRUE                                                38320031
383300         WHEN SQLCODE = ZERO                                      38330031
383400             CONTINUE                                             38340031
383500         WHEN SQLWARN0 NOT = SPACES                               38350031
383600         WHEN SQLCODE < ZERO                                      38360031
383700         WHEN SQLCODE > ZERO                                      38370031
383800             MOVE '6131-OPEN-ITEM-PACK-CURSOR'                    38380031
383900                                     TO PV-PARAGRAPH-NAME         38390031
384000             MOVE 'ATTEMPTING TO OPEN THE ITEM-PACK-CSR'          38400031
384100                                     TO PV-DB2-OPERATION-MESSAGE  38410031
384200             MOVE 'TRTW_CONTNR_LOD'  TO PV-DB2-TABLE-NAME-1       38420031
384300             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       38430031
384400             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       38440031
384500             PERFORM 9100-USER-ABEND                              38450031
384600     END-EVALUATE.                                                38460031
384700                                                                  38470031
384800****************************************************************  38480031
384900* FETCH ITEM-PACK-CSR                                             38490031
385000****************************************************************  38500031
385100 6132-FETCH-ITEM-PACK-CURSOR.                                     38510031
385200*    DISPLAY '6132-FETCH-ITEM-PACK-CURSOR'.                       38520031
385300                                                                  38530031
385400     EXEC SQL                                                     38540031
385500         FETCH ITEM-PACK-CSR                                      38550031
385600          INTO :TRT00012-UPC-NBR                                  38560031
385700              ,:TRT00012-SSCC-ID                                  38570031
385800              ,:TRT00012-ASN-PKGNG-CDE                            38580031
385900              ,:TRT00012-UNT-QTY                                  38590031
386000              ,:TRT00012-UPC-CBMT-QTY                             38600031
386100              ,:TRT00012-UPC-WT-KGRM-QTY                          38610031
386200     END-EXEC.                                                    38620031
386300                                                                  38630031
386400     EVALUATE TRUE                                                38640031
386500         WHEN SQLCODE = ZERO                                      38650031
386600               CONTINUE                                           38660031
386700         WHEN SQLCODE = +100                                      38670031
386800              SET PS-END-OF-ITEM-PACK-CSR TO TRUE                 38680031
386900         WHEN SQLWARN0 NOT = SPACES                               38690031
387000         WHEN SQLCODE < ZERO                                      38700031
387100         WHEN SQLCODE > ZERO                                      38710031
387200             MOVE '4200-FETCH-DC-DROP-CSR'                        38720031
387300                                     TO PV-PARAGRAPH-NAME         38730031
387400             MOVE 'ERROR FETCHING WITH THE DC-DROP-CSR'           38740031
387500                                     TO PV-DB2-OPERATION-MESSAGE  38750031
387600             MOVE 'TRTW_CONTNR_LOD'  TO PV-DB2-TABLE-NAME-1       38760031
387700             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       38770031
387800             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       38780031
387900             PERFORM 9100-USER-ABEND                              38790031
388000     END-EVALUATE.                                                38800031
388100 EJECT                                                            38810031
388200                                                                  38820031
388300****************************************************************  38830031
388400* CLOSE ITEM-PACK-CSR                                             38840031
388500****************************************************************  38850031
388600 6133-CLOSE-ITEM-PACK-CURSOR.                                     38860031
388700*    DISPLAY '6133-CLOSE-ITEM-PACK-CURSOR'.                       38870031
388800                                                                  38880031
388900         EXEC SQL                                                 38890031
389000              CLOSE ITEM-PACK-CSR                                 38900031
389100         END-EXEC.                                                38910031
389200                                                                  38920031
389300     EVALUATE TRUE                                                38930031
389400         WHEN SQLCODE = ZERO                                      38940031
389500             CONTINUE                                             38950031
389600         WHEN SQLWARN0 NOT = SPACES                               38960031
389700         WHEN SQLCODE < ZERO                                      38970031
389800         WHEN SQLCODE > ZERO                                      38980031
389900             MOVE '6133-CLOSE-ITEM-PACK-CURSOR'                   38990031
390000                                     TO PV-PARAGRAPH-NAME         39000031
390100             MOVE 'ATTEMPTING TO CLOSE THE ITEM-PACK-CSR'         39010031
390200                                     TO PV-DB2-OPERATION-MESSAGE  39020031
390300             MOVE 'TRTW_CONTNR_LOD'  TO PV-DB2-TABLE-NAME-1       39030031
390400             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       39040031
390500             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       39050031
390600             PERFORM 9100-USER-ABEND                              39060031
390700     END-EVALUATE.                                                39070031
390800                                                                  39080031
390900***************************************************************** 39090031
391000* WRITE TO ITEM AND PACK LEVEL DATA                             * 39100031
391100***************************************************************** 39110031
391200 6140-PROCESS-ITEM-PACK-CURSOR.                                   39120031
391300*    DISPLAY '6140-PROCESS-ITEM-PACK-CURSOR'.                     39130031
391400                                                                  39140031
391500     IF TRT00012-UPC-NBR = TR023-CONUPC-UPC-NBR                   39150031
391600     AND NOT PV-ASN-STANDARD-NO-CARTON                            39160031
391700        CONTINUE                                                  39170031
391800     ELSE                                                         39180031
391900        INITIALIZE TR023-REC-TYP-CNTR                             39190031
392000        MOVE PV-HOLD-TRN-TYP        TO TR023-CONUPC-TRN-TYP       39200031
392100        MOVE 'CONUPC'               TO TR023-CONUPC-REC-TYP-CDE   39210031
392200        MOVE '40'                   TO TR023-CONUPC-SEQ-NBR       39220031
392300        MOVE SPACES                 TO TR023-CONUPC-3RD-PARTY-CDE 39230031
392400        MOVE PV-HOLD-CONTNR-ID      TO TR023-CONUPC-CONTNR-ID     39240031
392500        MOVE PV-HOLD-ACTL-DPRTR-DTE TO TR023-CONUPC-ACTL-DPRTR-DTE39250031
392600        MOVE PV-HOLD-ACTL-DPRTR-TM  TO TR023-CONUPC-ACTL-DPRTR-TM 39260031
392700        MOVE PV-HOLD-PO-NBR         TO TR023-CONUPC-PO-NBR        39270031
392800                                       PURCHS-PO-NBR              39280031
392900*    ***DISPLAY 'PURCHS-PO-NBR ' PURCHS-PO-NBR                    39290031
393000        MOVE PV-HOLD-DAT-SRC-ENT-ID TO TR023-CONUPC-DAT-SRC-ENT-ID39300031
393100        MOVE PV-HOLD-FILE-ID        TO TR023-CONUPC-FILE-ID       39310031
393200        MOVE TRT00012-UPC-NBR       TO TR023-CONUPC-UPC-NBR       39320031
393300                                       TUPCSKU-UPC-NBR            39330031
393400                                       POPRPK-PREPK-UPC-NBR       39340031
393500*AME    NEXT LINE IS NEW LINE 5/21/2008-NO UNITS FOR STD NO CARTS 39350031
393600*AME    MOVE TRT00012-UNT-QTY       TO TR023-CONUPC-UNT-QTY       39360031
393700        MOVE TRT00012-ASN-PKGNG-CDE TO TR023-CONUPC-ASN-PKG-CDE   39370031
393800        PERFORM 6150-SELECT-SKU-NBR                               39380031
393900                                                                  39390031
394000        ADD +1                   TO PV-PROCESS-SEQ-NBR            39400031
394100        MOVE PV-PROCESS-SEQ-NBR  TO TR023-CONUPC-PROCESS-SEQ-NBR-139410031
394200        ADD +1                   TO PV-PROCESS-SEQ-NBR            39420031
394300        MOVE PV-PROCESS-SEQ-NBR  TO TR023-CONUPC-PROCESS-SEQ-NBR-239430031
394400        ADD +1                   TO PV-PROCESS-SEQ-NBR            39440031
394500        MOVE PV-PROCESS-SEQ-NBR  TO TR023-CONUPC-PROCESS-SEQ-NBR-339450031
394600                                                                  39460031
394700        MOVE TR023-REC-TYP-CONUPC     TO PV-HOLD-REC-TYP-CONUPC   39470031
394800     END-IF.                                                      39480031
394900                                                                  39490031
395000*    WRITE THE CARTON RECORD                                      39500031
395100     INITIALIZE TR023-REC-TYP-CNTR.                               39510031
395200     MOVE PV-HOLD-TRN-TYP          TO TR023-CNCART-TRN-TYP.       39520031
395300     MOVE 'CNCART'                 TO TR023-CNCART-REC-TYP-CDE.   39530031
395400     MOVE '60'                     TO TR023-CNCART-SEQ-NBR.       39540031
395500     MOVE SPACES                   TO TR023-CNCART-3RD-PARTY-CDE. 39550031
395600     MOVE PV-HOLD-CONTNR-ID        TO TR023-CNCART-CONTNR-ID.     39560031
395700     MOVE PV-HOLD-ACTL-DPRTR-DTE   TO TR023-CNCART-ACTL-DPRTR-DTE.39570031
395800     MOVE PV-HOLD-ACTL-DPRTR-TM    TO TR023-CNCART-ACTL-DPRTR-TM. 39580031
395900     MOVE PV-HOLD-PO-NBR           TO TR023-CNCART-PO-NBR.        39590031
396000     MOVE PV-HOLD-DAT-SRC-ENT-ID   TO TR023-CNCART-DAT-SRC-ENT-ID.39600031
396100     MOVE PV-HOLD-FILE-ID          TO TR023-CNCART-FILE-ID.       39610031
396200     MOVE TRT00012-UPC-NBR         TO TR023-CNCART-UPC-NBR.       39620031
396300     MOVE TRT00012-SSCC-ID         TO TR023-CNCART-SSCC-NBR.      39630031
396400     MOVE TRT00012-UNT-QTY         TO TR023-CNCART-UNT-QTY.       39640031
396500                                                                  39650031
396600     ADD TR023-CNCART-UNT-QTY      TO PV-TOTAL-CONUPC-UNT-QTY.    39660031
396700     ADD TR023-CNCART-UNT-QTY      TO PV-TOTAL-CONPO-UNT-QTY.     39670031
396800     ADD TR023-CNCART-UNT-QTY      TO PV-TOTAL-CNTR-UNT-QTY.      39680031
396900                                                                  39690031
397000     IF PV-ASN-PICK-N-PACK                                        39700031
397100        ADD TRT00012-UPC-CBMT-QTY     TO PV-TOTAL-CONUPC-CBMT-QTY 39710031
397200        ADD TRT00012-UPC-WT-KGRM-QTY  TO PV-TOTAL-CONUPC-KGRM-QTY 39720031
397300     ELSE                                                         39730031
397400        MOVE TRT00012-UPC-CBMT-QTY    TO PV-TOTAL-CONUPC-CBMT-QTY 39740031
397500        MOVE TRT00012-UPC-WT-KGRM-QTY TO PV-TOTAL-CONUPC-KGRM-QTY 39750031
397600     END-IF.                                                      39760031
397700                                                                  39770031
397800     IF PV-ASN-STANDARD-NO-CARTON                                 39780031
397900        MOVE 0                   TO PV-TOTAL-CONUPC-CART-CNT      39790031
398000        MOVE 0                   TO PV-TOTAL-CONPO-CART-CNT       39800031
398100        MOVE 0                   TO PV-TOTAL-CNTR-CART-CNT        39810031
398200     ELSE                                                         39820031
398300        ADD +1                   TO PV-TOTAL-CONUPC-CART-CNT      39830031
398400        ADD +1                   TO PV-TOTAL-CONPO-CART-CNT       39840031
398500        ADD +1                   TO PV-TOTAL-CNTR-CART-CNT        39850031
398600     END-IF.                                                      39860031
398700                                                                  39870031
398800     IF TR023-CNCART-SSCC-NBR EQUAL TO SPACES                     39880031
398900     OR PV-ASN-STANDARD-NO-CARTON                                 39890031
399000        CONTINUE                                                  39900031
399100     ELSE                                                         39910031
399200        ADD +1                  TO PV-PROCESS-SEQ-NBR             39920031
399300        ADD +1                  TO PA-TOTAL-UPDATE-CNCART         39930031
399400        MOVE PV-PROCESS-SEQ-NBR TO TR023-CNCART-PROCESS-SEQ-NBR-1 39940031
399500        PERFORM 6100-WRITE-UPDATE-RECORD                          39950031
399600        PERFORM 7600-WRITE-PACK-ITEM-WARNINGS                     39960031
399700     END-IF.                                                      39970031
399800                                                                  39980031
399900*    FETCH NEXT ROW FROM WORK TABLE                               39990031
400000     PERFORM 6132-FETCH-ITEM-PACK-CURSOR.                         40000031
400100                                                                  40010031
400200*    WRITE UPC RECORD                                             40020031
400300     IF  TRT00012-UPC-NBR = TR023-CONUPC-UPC-NBR                  40030031
400400     AND PS-END-OF-ITEM-PACK-CSR-NO                               40040031
400500     AND NOT PV-ASN-STANDARD-NO-CARTON                            40050031
400600        CONTINUE                                                  40060031
400700     ELSE                                                         40070031
400800        MOVE PV-HOLD-REC-TYP-CONUPC    TO TR023-REC-TYP-CONUPC    40080031
400900        MOVE PV-TOTAL-CONUPC-KGRM-QTY  TO TR023-CONUPC-WT-KGRM-QTY40090031
401000         ADD PV-TOTAL-CONUPC-KGRM-QTY  TO PV-TOTAL-CONPO-KGRM-QTY 40100031
401100         ADD PV-TOTAL-CONUPC-KGRM-QTY  TO PV-TOTAL-CNTR-KGRM-QTY  40110031
401200        MOVE PV-TOTAL-CONUPC-CBMT-QTY  TO TR023-CONUPC-CBMT-QTY   40120031
401300         ADD PV-TOTAL-CONUPC-CBMT-QTY  TO PV-TOTAL-CONPO-CBMT-QTY 40130031
401400         ADD PV-TOTAL-CONUPC-CBMT-QTY  TO PV-TOTAL-CNTR-CBMT-QTY  40140031
401500        MOVE PV-TOTAL-CONUPC-UNT-QTY   TO TR023-CONUPC-UNT-QTY    40150031
401600        MOVE PV-TOTAL-CONUPC-CART-CNT  TO TR023-CONUPC-CART-CNT   40160031
401700                                                                  40170031
401800        IF TR023-CONUPC-CART-CNT > TR023-CONUPC-UNT-QTY           40180031
401900           MOVE PC-WARNING                TO TR211-ERROR-TYPE     40190031
402000           MOVE 'CTNS OR UNITS  '         TO TR211-DATA-IN-ERROR  40200031
402100           MOVE 'CARTONS > UNITS'         TO TR211-ERROR-MSG      40210031
402200           MOVE PV-TOTAL-CONUPC-UNT-QTY   TO PV-UNIT-VALUE        40220031
402300           MOVE PV-TOTAL-CONUPC-CART-CNT  TO PV-QUANTITY-VALUE    40230031
402400           MOVE PV-QUANTITY-UNIT-VALUES   TO TR211-DATA-VALUE     40240031
402500           MOVE TR023-CONUPC-UPC-NBR      TO TR211-CONUPA-UPC-NBR 40250031
402600           PERFORM 7500-WRITE-ITEM-LEVEL-ERROR                    40260031
402700        END-IF                                                    40270031
402800                                                                  40280031
402900        INITIALIZE PV-TOTAL-CONUPC-UNT-QTY                        40290031
403000                   PV-TOTAL-CONUPC-CART-CNT                       40300031
403100                   PV-TOTAL-CONUPC-KGRM-QTY                       40310031
403200                   PV-TOTAL-CONUPC-CBMT-QTY                       40320031
403300        ADD +1 TO PA-TOTAL-UPDATE-CONUPC                          40330031
403400        PERFORM 6100-WRITE-UPDATE-RECORD                          40340031
403500        PERFORM 7600-WRITE-PACK-ITEM-WARNINGS                     40350031
403600     END-IF.                                                      40360031
403700                                                                  40370031
403800***************************************************************** 40380031
403900* GET SKU NUMBER FROM UPC                                       * 40390031
404000***************************************************************** 40400031
404100 6150-SELECT-SKU-NBR.                                             40410031
404200*    DISPLAY '6150-SELECT-SKU-NBR'.                               40420031
404300                                                                  40430031
404400     PERFORM 6151-DETERMIN-PACK-OR-BULK.                          40440031
404500     IF PURCHS-PKGNG-CDE = PC-I OR PC-M                           40450031
404600        PERFORM 6152-SELECT-SKU-FOR-PACK                          40460031
404700     ELSE                                                         40470031
404800        PERFORM 6153-SELECT-SKU-FOR-BULK                          40480031
404900     END-IF.                                                      40490031
405000                                                                  40500031
405100***************************************************************** 40510031
405200* DETERMIN IF THE UPC IS PACK OR BULK                             40520031
405300***************************************************************** 40530031
405400 6151-DETERMIN-PACK-OR-BULK.                                      40540031
405500*    DISPLAY '6151-DETERMIN-PACK-OR-BULK'.                        40550031
405600                                                                  40560031
405700     EXEC SQL                                                     40570031
405800        SELECT PKGNG_CDE                                          40580031
405900        INTO  :PURCHS-PKGNG-CDE                                   40590031
406000        FROM   TPURCHS                                            40600031
406100        WHERE  PO_NBR = :PURCHS-PO-NBR                            40610031
406200          AND  VER_STATUS_CDE = 'A'                               40620031
406300     END-EXEC                                                     40630031
406400                                                                  40640031
406500     EVALUATE TRUE                                                40650031
406600         WHEN SQLCODE = ZERO                                      40660031
406700*         ***DISPLAY 'PURCHS-PO-NBR ' PURCHS-PO-NBR               40670031
406800*            MOVE PURCHS-PKGNG-CDE TO TR023-CONUPC-SKU            40680031
406900         WHEN SQLCODE = +100                                      40690031
407000             CONTINUE                                             40700031
407100         WHEN SQLWARN0 NOT = SPACES                               40710031
407200         WHEN SQLCODE < ZERO                                      40720031
407300         WHEN SQLCODE > ZERO                                      40730031
407400             MOVE '6151-DETERMIN-PACK-OR-BULK'                    40740031
407500                                     TO PV-PARAGRAPH-NAME         40750031
407600             MOVE 'ERROR WHILE DOING SELECT'                      40760031
407700                                     TO PV-DB2-OPERATION-MESSAGE  40770031
407800             MOVE 'TPURCHS'          TO PV-DB2-TABLE-NAME-1       40780031
407900             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       40790031
408000             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       40800031
408100             PERFORM 9100-USER-ABEND                              40810031
408200     END-EVALUATE.                                                40820031
408300                                                                  40830031
408400***************************************************************** 40840031
408500* SELECT SKU FOR PACK UPC                                         40850031
408600***************************************************************** 40860031
408700 6152-SELECT-SKU-FOR-PACK.                                        40870031
408800*    DISPLAY '6152-SELECT-SKU-FOR-PACK'.                          40880031
408900                                                                  40890031
409000     EXEC SQL                                                     40900031
409100        SELECT PK_SKU_NBR                                         40910031
409200        INTO  :POPRPK-PK-SKU-NBR                                  40920031
409300        FROM   TPOPRPK                                            40930031
409400        WHERE  PO_NBR        = :PURCHS-PO-NBR                     40940031
409500          AND  PREPK_UPC_NBR = :POPRPK-PREPK-UPC-NBR              40950031
409600     END-EXEC                                                     40960031
409700                                                                  40970031
409800     EVALUATE TRUE                                                40980031
409900         WHEN SQLCODE = ZERO                                      40990031
410000         WHEN SQLCODE = -811                                      41000031
410100             MOVE POPRPK-PK-SKU-NBR TO TR023-CONUPC-SKU           41010031
410200*         ***DISPLAY 'SQLCODE ' SQLCODE                           41020031
410300*         ***DISPLAY 'PURCHS-PO-NBR ' PURCHS-PO-NBR               41030031
410400*         ***DISPLAY 'POPRPK-PREPK-UPC-NBR ' POPRPK-PREPK-UPC-NBR 41040031
410500         WHEN SQLCODE = +100                                      41050031
410600*         ***DISPLAY 'SQLCODE ' SQLCODE                           41060031
410700*         ***DISPLAY 'PURCHS-PO-NBR ' PURCHS-PO-NBR               41070031
410800*         ***DISPLAY 'POPRPK-PREPK-UPC-NBR ' POPRPK-PREPK-UPC-NBR 41080031
410900             CONTINUE                                             41090031
411000         WHEN SQLWARN0 NOT = SPACES                               41100031
411100         WHEN SQLCODE < ZERO                                      41110031
411200         WHEN SQLCODE > ZERO                                      41120031
411300             MOVE '6152-SELECT-SKU-FOR-PACK'                      41130031
411400                                     TO PV-PARAGRAPH-NAME         41140031
411500             MOVE 'ERROR WHILE DOING SELECT'                      41150031
411600                                     TO PV-DB2-OPERATION-MESSAGE  41160031
411700             MOVE 'TPOPRPK'          TO PV-DB2-TABLE-NAME-1       41170031
411800             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       41180031
411900             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       41190031
412000             PERFORM 9100-USER-ABEND                              41200031
412100     END-EVALUATE.                                                41210031
412200                                                                  41220031
412300***************************************************************** 41230031
412400* SELECT SKU FOR BULK UPC                                         41240031
412500***************************************************************** 41250031
412600 6153-SELECT-SKU-FOR-BULK.                                        41260031
412700*    DISPLAY '6153-SELECT-SKU-FOR-BULK'.                          41270031
412800                                                                  41280031
412900     EXEC SQL                                                     41290031
413000        SELECT XREF.SKU                                           41300031
413100        INTO  :SKXREF-SKU                                         41310031
413200        FROM   TUPCSKU SKU                                        41320031
413300              ,TSKXREF XREF                                       41330031
413400        WHERE  SKU.UPC_NBR = :TUPCSKU-UPC-NBR                     41340031
413500          AND  SKU.ITEM_NBR = XREF.ITM_NBR                        41350031
413600     END-EXEC                                                     41360031
413700                                                                  41370031
413800     EVALUATE TRUE                                                41380031
413900         WHEN SQLCODE = ZERO                                      41390031
414000         WHEN SQLCODE = -811                                      41400031
414100             MOVE SKXREF-SKU         TO TR023-CONUPC-SKU          41410031
414200         WHEN SQLCODE = +100                                      41420031
414300             CONTINUE                                             41430031
414400         WHEN SQLWARN0 NOT = SPACES                               41440031
414500         WHEN SQLCODE < ZERO                                      41450031
414600         WHEN SQLCODE > ZERO                                      41460031
414700             MOVE '6153-SELECT-SKU-FOR-BULK'                      41470031
414800                                     TO PV-PARAGRAPH-NAME         41480031
414900             MOVE 'ERROR WHILE DOING SELECT'                      41490031
415000                                     TO PV-DB2-OPERATION-MESSAGE  41500031
415100             MOVE 'TPURCHS'          TO PV-DB2-TABLE-NAME-1       41510031
415200             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       41520031
415300             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       41530031
415400             PERFORM 9100-USER-ABEND                              41540031
415500     END-EVALUATE.                                                41550031
415600                                                                  41560031
415700***************************************************************** 41570031
415800* DETERMINE IF ASN-PO IS AIR OR LANDED                            41580031
415900***************************************************************** 41590031
416000 6170-DETERMINE-AIR-LANDED.                                       41600031
416100*    DISPLAY '6170-DETERMINE-AIR-LANDED'.                         41610031
416200                                                                  41620031
416300     MOVE 'Y' TO PS-FIRST-PRF-XFER-SW.                            41630031
416400     SET PS-COMP-ERROR-NO TO TRUE.                                41640031
416500     MOVE 'N' TO PS-END-OF-PRF-PO-NBR-SW.                         41650031
416600     MOVE TR063-DAT-XFER-CNTL TO SNT00001-DAT-XFER-CNTL-ID.       41660031
416700                                                                  41670031
416800***CRQ31649-BEGIN                                                 41680031
416900       IF PS-PRF-PO-NBR-CSR-OPEN                                  41690031
417000          PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                       41700031
417100       END-IF                                                     41710031
417200***CRQ31649-END                                                   41720031
417300     PERFORM 2600-OPEN-PRF-PO-NBR-CSR.                            41730031
417400                                                                  41740031
417500     PERFORM 2610-FETCH-PRF-PO-NBR-CSR                            41750031
417600             UNTIL PS-FIRST-PRF-XFER-NO.                          41760031
417700                                                                  41770031
417800     IF PS-PRF-PO-NBR-CSR-OPEN                                    41780031
417900        PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                         41790031
418000     END-IF.                                                      41800031
418100                                                                  41810031
418200****************************************************************  41820031
418300* PREP FOR COMPONENT ONLY                                         41830031
418400**AME                                                             41840031
418500****************************************************************  41850031
418600 6172-PREP-FOR-COMP-ONLY.                                         41860031
418700*    DISPLAY '6172-PREP-FOR-COMP-ONLY'.                           41870031
418800                                                                  41880031
418900***CRQ31649-BEGIN                                                 41890031
419000       IF PS-PRF-PO-NBR-CSR-OPEN                                  41900031
419100          PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                       41910031
419200       END-IF                                                     41920031
419300***CRQ31649-END                                                   41930031
419400     PERFORM 2600-OPEN-PRF-PO-NBR-CSR.                            41940031
419500                                                                  41950031
419600     SET PS-END-PREP-PRF-XFER-NO TO TRUE.                         41960031
419700                                                                  41970031
419800     PERFORM VARYING PO-INDX FROM 1 BY 1                          41980031
419900             UNTIL PS-END-PREP-PRF-XFER                           41990031
420000        PERFORM 6173-FETCH-PRF-PO-NBR-CSR                         42000031
420100        EVALUATE TRUE                                             42010031
420200           WHEN PS-END-PREP-PRF-XFER-NO                           42020031
420300              MOVE SNT00001-DAT-XFER-CNTL-ID TO                   42030031
420400                   PV-DAT-XFER-CNTL-ID-PREP(PO-INDX)              42040031
420500*          ***DISPLAY 'PV-DAT-XFER-CNTL-ID-PREP(PO-INDX)'         42050031
420600*          ***         PV-DAT-XFER-CNTL-ID-PREP(PO-INDX)          42060031
420700              MOVE SNT00001-PRC-LOD-SEQ-NBR  TO                   42070031
420800                   PV-PRC-LOD-SEQ-NBR-PREP(PO-INDX)               42080031
420900*          ***DISPLAY 'PV-PRC-LOD-SEQ-NBR-PREP(PO-INDX) '         42090031
421000*          ***     PV-PRC-LOD-SEQ-NBR-PREP(PO-INDX)               42100031
421100              MOVE SNT00001-DAT-CTG-CDE      TO                   42110031
421200                   PV-DAT-CTG-CDE-PREP(PO-INDX)                   42120031
421300*          ***DISPLAY 'PV-DAT-CTG-CDE-PREP(PO-INDX)N'X) '         42130031
421400*          ***     PV-DAT-CTG-CDE-PREP(PO-INDX)PO-INDX)           42140031
421500              MOVE PV-PREP-PO-NBR            TO                   42150031
421600                   PV-PO-NBR-COMP-ONLY-PREP(PO-INDX)              42160031
421700*          ***DISPLAY 'PV-PO-NBR-COMP-ONLY-PREP(PO-INDX) '        42170031
421800*          ***     PV-PO-NBR-COMP-ONLY-PREP(PO-INDX)              42180031
421900        END-EVALUATE                                              42190031
422000     END-PERFORM.                                                 42200031
422100                                                                  42210031
422200     IF PS-PRF-PO-NBR-CSR-OPEN                                    42220031
422300        PERFORM 2615-CLOSE-PRF-PO-NBR-CSR                         42230031
422400     END-IF.                                                      42240031
422500                                                                  42250031
422600****************************************************************  42260031
422700* FETCH PRF-PO-NBR-CSR FOR COMPONENT ONLY PREP                    42270031
422800**AME                                                             42280031
422900****************************************************************  42290031
423000 6173-FETCH-PRF-PO-NBR-CSR.                                       42300031
423100*    DISPLAY '6173-FETCH-PRF-PO-NBR-CSR'.                         42310031
423200                                                                  42320031
423300     EXEC SQL                                                     42330031
423400        FETCH PRF-PO-NBR-CSR                                      42340031
423500        INTO :SNT00001-DAT-XFER-CNTL-ID,                          42350031
423600             :SNT00001-PRC-LOD-SEQ-NBR,                           42360031
423700             :SNT00001-DAT-CTG-CDE,                               42370031
423800             :PV-PURCHS-PO-NBR-S                                  42380031
423900     END-EXEC                                                     42390031
424000                                                                  42400031
424100     EVALUATE TRUE                                                42410031
424200        WHEN SQLCODE = ZERO                                       42420031
424300*       ***DISPLAY 'SNT00001-DAT-XFER-CNTL-ID '                   42430031
424400*       ***         SNT00001-DAT-XFER-CNTL-ID                     42440031
424500*       ***DISPLAY 'SNT00001-PRC-LOD-SEQ-NBR '                    42450031
424600*       ***         SNT00001-PRC-LOD-SEQ-NBR                      42460031
424700*       ***DISPLAY 'SNT00001-DAT-CTG-CDE '                        42470031
424800*       ***         SNT00001-DAT-CTG-CDE                          42480031
424900*       ***DISPLAY 'PV-PURCHS-PO-NBR-S ' PV-PURCHS-PO-NBR-S       42490031
425000           INITIALIZE PV-PREP-PO-NBR                              42500031
425100           INITIALIZE PV-SHORT-PO-NBR-ALPHA                       42510031
425200*TV 12/15/2014 CHANGE STARTS                                      42520031
425300           MOVE PV-PURCHS-PO-NBR-S TO PV-PURCHS-PO-NBR-N          42530031
425400           MOVE PV-PURCHS-PO-NBR-N TO PV-PURCHS-PO-NBR            42540031
425500           MOVE PV-PURCHS-PO-NBR-N TO PV-SHORT-PO-NBR-ALPHA-N     42550031
425600           MOVE PV-SHORT-PO-NBR-ALPHA-N TO PV-PREP-PO-NBR         42560031
425700*TV 12/15/2014 CHANGE ENDS                                        42570031
425800*       ***DISPLAY 'PV-PREP-PO-NBR ' PV-PREP-PO-NBR               42580031
425900                                                                  42590031
426000        WHEN SQLCODE = +100                                       42600031
426100           SET PS-END-PREP-PRF-XFER TO TRUE                       42610031
426200        WHEN SQLWARN0 NOT = SPACES                                42620031
426300        WHEN SQLCODE < ZERO                                       42630031
426400        WHEN SQLCODE > ZERO                                       42640031
426500           MOVE '6173-FETCH-PRF-PO-NBR-CSR'                       42650031
426600                              TO PV-PARAGRAPH-NAME                42660031
426700           MOVE 'ERROR FETCHING PRF PO NBR CSR PREP'              42670031
426800                              TO PV-DB2-OPERATION-MESSAGE         42680031
426900           MOVE 'SNT_DAT_XFER'     TO PV-DB2-TABLE-NAME-1         42690031
427000           MOVE SPACES             TO PV-DB2-TABLE-NAME-3         42700031
427100*       ***DISPLAY 'SNT00001-DAT-XFER-CNTL-ID '                   42710031
427200*       ***         SNT00001-DAT-XFER-CNTL-ID                     42720031
427300*       ***DISPLAY 'PV-CURR-PRF-SEQ-NBR       '                   42730031
427400*       ***    PV-CURR-PRF-SEQ-NBR                                42740031
427500           PERFORM 9100-USER-ABEND                                42750031
427600     END-EVALUATE.                                                42760031
427700                                                                  42770031
427800                                                                  42780031
427900* ***DISPLAY 'SNT00001-DAT-XFER-CNTL-ID '                         42790031
428000* ***                                  SNT00001-DAT-XFER-CNTL-ID. 42800031
428100* ***DISPLAY 'SNT00001-PRC-LOD-SEQ-NBR '                          42810031
428200* ***                                  SNT00001-PRC-LOD-SEQ-NBR.  42820031
428300* ***DISPLAY 'SNT00001-DAT-CTG-CDE '   SNT00001-DAT-CTG-CDE.      42830031
428400* ***DISPLAY 'PV-PURCHS-PO-NBR '       PV-PURCHS-PO-NBR.          42840031
428500                                                                  42850031
428600***************************************************************** 42860031
428700* WRITE TO ERROR FILE.                                          * 42870031
428800***************************************************************** 42880031
428900 6200-WRITE-ERR-REPORT.                                           42890031
429000*    DISPLAY '6200-WRITE-ERR-REPORT'.                             42900031
429100                                                                  42910031
429200     IF TR211-ERROR-TYPE = 'HD1'                                  42920031
429300        CONTINUE                                                  42930031
429400     ELSE                                                         42940031
429500        ADD +1 TO PA-TOTAL-ERROR-COUNT                            42950031
429600     END-IF.                                                      42960031
429700                                                                  42970031
429800     WRITE TR211-CONTAINER-ERROR-RECORD FROM                      42980031
429900           TR211-RECORD.                                          42990031
430000                                                                  43000031
430100     INITIALIZE TR211-COMMON-FIELDS.                              43010031
430200 EJECT                                                            43020031
430300***************************************************************** 43030031
430400* CREATE ERROR MESSAGE FOR MISSING ID RECORD                    * 43040031
430500***************************************************************** 43050031
430600 7000-MISSING-LEVEL-ERROR.                                        43060031
430700*    DISPLAY '7000-MISSING-LEVEL-ERROR'.                          43070031
430800                                                                  43080031
430900     EVALUATE TRUE                                                43090031
431000        WHEN PV-PREV-ID-LEVEL                                     43100031
431100           MOVE 'ISA LEVEL      '    TO TR211-DATA-IN-ERROR       43110031
431200           MOVE SPACES               TO TR211-DATA-VALUE          43120031
431300           PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                    43130031
431400        WHEN PV-PREV-SHIPMENT-LEVEL                               43140031
431500           MOVE 'CON LEVEL      '    TO TR211-DATA-IN-ERROR       43150031
431600           MOVE SPACES               TO TR211-DATA-VALUE          43160031
431700           PERFORM 7200-WRITE-SHIP-LEVEL-ERROR                    43170031
431800        WHEN PV-PREV-ORDER-LEVEL                                  43180031
431900           MOVE 'CONPO LEVEL    '    TO TR211-DATA-IN-ERROR       43190031
432000           MOVE SPACES               TO TR211-DATA-VALUE          43200031
432100           PERFORM 7300-WRITE-PO-LEVEL-ERROR                      43210031
432200        WHEN PV-PREV-PACK-LEVEL                                   43220031
432300           MOVE 'CNCART LEVEL   '    TO TR211-DATA-IN-ERROR       43230031
432400           MOVE SPACES               TO TR211-DATA-VALUE          43240031
432500           PERFORM 7400-WRITE-PACK-LEVEL-ERROR                    43250031
432600        WHEN PV-PREV-ITEM-LEVEL                                   43260031
432700           MOVE 'CONUP LEVEL    '    TO TR211-DATA-IN-ERROR       43270031
432800           MOVE SPACES               TO TR211-DATA-VALUE          43280031
432900           MOVE TRT00012-UPC-NBR     TO TR211-CONUPA-UPC-NBR      43290031
433000           PERFORM 7500-WRITE-ITEM-LEVEL-ERROR                    43300031
433100     END-EVALUATE.                                                43310031
433200                                                                  43320031
433300***************************************************************** 43330031
433400* CREATE ERROR MESSAGE FOR MISSING SHIPMENT RECROD              * 43340031
433500***************************************************************** 43350031
433600 7100-WRITE-ID-LEVEL-ERROR.                                       43360031
433700*    DISPLAY '7100-WRITE-ID-LEVEL-ERROR'.                         43370031
433800                                                                  43380031
433900     INITIALIZE TR211-RECORD.                                     43390031
434000                                                                  43400031
434100*    WRITE ERROR REPORT HEADER                                    43410031
434200     MOVE 'E'                       TO TR211-RPT-TYP.             43420031
434300     MOVE PV-PROCESS-SEQ-NBR        TO TR211-PROCESS-SEQ-NBR.     43430031
434400     ADD  +1                        TO TR211-PROCESS-SEQ-NBR.     43440031
434500     MOVE 'HD1'                     TO TR211-ERROR-TYPE.          43450031
434600     MOVE PV-HOLD-HEADER-ENT-ID     TO TR211-DAT-SRC-ENT-ID.      43460031
434700     MOVE 'HDR   '                  TO TR211-REC-TYP-HDR-CDE.     43470031
434800     MOVE '01'                      TO TR211-SEQ-NBR-HDR.         43480031
434900     MOVE '      '                  TO TR211-3RD-PARTY-CDE-HDR.   43490031
435000     MOVE PV-HOLD-FILE-ID           TO TR211-HDR-CONSOL-FIL-ID.   43500031
435100     MOVE PV-HOLD-LOAD-DTE          TO TR211-HDR-LOAD-DTE.        43510031
435200     MOVE PV-HOLD-LOAD-TM           TO TR211-HDR-LOAD-TM.         43520031
435300     PERFORM 4010-SELECT-ENT-NAME                                 43530031
435400     MOVE ENTNME-ENT-NAME-DESC      TO TR211-HDR-CONSOL-ENTNME.   43540031
435500     PERFORM 6200-WRITE-ERR-REPORT.                               43550031
435600                                                                  43560031
435700*    WRITE DETAIL REPORT HEADER                                   43570031
435800     MOVE 'D'                       TO TR211-RPT-TYP.             43580031
435900     MOVE PV-PROCESS-SEQ-NBR        TO TR211-PROCESS-SEQ-NBR.     43590031
436000     ADD  +1                        TO TR211-PROCESS-SEQ-NBR.     43600031
436100     MOVE 'HD1'                     TO TR211-ERROR-TYPE.          43610031
436200     MOVE PV-HOLD-HEADER-ENT-ID     TO TR211-DAT-SRC-ENT-ID.      43620031
436300     PERFORM 6200-WRITE-ERR-REPORT.                               43630031
436400                                                                  43640031
436500     INITIALIZE TR211-RECORD.                                     43650031
436600                                                                  43660031
436700***************************************************************** 43670031
436800* CREATE ERROR MESSAGE FOR MISSING SHIPMENT RECROD              * 43680031
436900***************************************************************** 43690031
437000 7200-WRITE-SHIP-LEVEL-ERROR.                                     43700031
437100*    DISPLAY '7200-WRITE-SHIP-LEVEL-ERROR'.                       43710031
437200     MOVE 'E'                     TO TR211-RPT-TYP.               43720031
437300     MOVE PV-PROCESS-SEQ-NBR      TO TR211-PROCESS-SEQ-NBR.       43730031
437400     ADD  +2                      TO TR211-PROCESS-SEQ-NBR.       43740031
437500     MOVE PV-HOLD-TRN-TYP         TO TR211-TRN-TYP.               43750031
437600     MOVE TR023-CNTR-CONTNR-ID    TO TR211-CONTNR-ID.             43760031
437700     MOVE TR023-CNTR-ACTL-DPRTR-DTE-MOM                           43770031
437800                                  TO TR211-ACTL-DPRTR-DTE-MOM.    43780031
437900     MOVE TR023-CNTR-ACTL-DPRTR-TM-MOM                            43790031
438000                                  TO TR211-ACTL-DPRTR-TM-MOM.     43800031
438100     MOVE PV-HOLD-DAT-SRC-ENT-ID  TO TR211-DAT-SRC-ENT-ID.        43810031
438200     MOVE 'CVYA  '                TO TR211-REC-TYP-CVYA-CDE.      43820031
438300     MOVE '10'                    TO TR211-SEQ-NBR-CVYA.          43830031
438400     MOVE '      '                TO TR211-3RD-PARTY-CDE.         43840031
438500     MOVE TR023-CNTR-EST-POE-DELY-DT-MOM                          43850031
438600                                  TO TR211-CVYA-EST-POE-DELY-DTE. 43860031
438700     MOVE SPACES                  TO TR211-CVYA-EST-POE-DELY-TM.  43870031
438800     MOVE TR023-CNTR-IMPRT-TRIP-ID-MOM                            43880031
438900                                  TO TR211-CVYA-IMPRT-TRIP-ID.    43890031
439000     MOVE SPACES                  TO  TR211-CVYA-CARR-SCAC-ID.    43900031
439100     MOVE TR023-CNTR-IMP-VEH-NM-MOM                               43910031
439200                                  TO TR211-CVYA-IMP-VEH-NM-MOM.   43920031
439300     MOVE SPACES                  TO TR211-CVYA-ACTL-FOB-CDE-MOM. 43930031
439400     MOVE TR023-CNTR-DEST-POE-CDE-MOM                             43940031
439500                                  TO TR211-CVYA-DEST-POE-CDE-MOM. 43950031
439600     MOVE TR023-CNTR-TRIP-TYP-CDE-MOM                             43960031
439700                                  TO TR211-CVYA-TRIP-TYP-CDE-MOM. 43970031
439800     MOVE SPACES                  TO TR211-CVYA-EST-LBD-NM.       43980031
439900     MOVE SPACES                  TO TR211-CVYA-EST-LBD-DTE.      43990031
440000     MOVE SPACES                  TO TR211-CVYA-EST-LBD-TM.       44000031
440100     MOVE SPACES                  TO TR211-CVYA-POL-CDE-MOM.      44010031
440200     MOVE SPACES                  TO TR211-CVYA-POR-CDE-MOM.      44020031
440300                                                                  44030031
440400     PERFORM 6200-WRITE-ERR-REPORT.                               44040031
440500     INITIALIZE TR211-RECORD.                                     44050031
440600                                                                  44060031
440700***************************************************************** 44070031
440800* CREATE ERROR MESSAGE FOR MISSING PO RECORD                    * 44080031
440900***************************************************************** 44090031
441000 7300-WRITE-PO-LEVEL-ERROR.                                       44100031
441100*    DISPLAY '7300-WRITE-PO-LEVEL-ERROR'.                         44110031
441200     MOVE 'E'                    TO TR211-RPT-TYP.                44120031
441300     MOVE PV-PROCESS-SEQ-NBR     TO TR211-PROCESS-SEQ-NBR.        44130031
441400     ADD  +1                     TO TR211-PROCESS-SEQ-NBR.        44140031
441500     MOVE PV-HOLD-TRN-TYP        TO TR211-TRN-TYP.                44150031
441600     MOVE PV-HOLD-CONTNR-ID      TO TR211-CONTNR-ID.              44160031
441700     MOVE PV-HOLD-ACTL-DPRTR-DTE TO TR211-ACTL-DPRTR-DTE-MOM.     44170031
441800     MOVE PV-HOLD-ACTL-DPRTR-TM  TO TR211-ACTL-DPRTR-TM-MOM.      44180031
441900     MOVE PV-HOLD-DAT-SRC-ENT-ID TO TR211-DAT-SRC-ENT-ID.         44190031
442000                                                                  44200031
442100     MOVE 'CONPOA'               TO TR211-REC-TYP-CONPOA-CDE.     44210031
442200     MOVE '30'                   TO TR211-SEQ-NBR-CONPOA.         44220031
442300     MOVE '      '               TO TR211-3RD-PARTY-CDE-CONPOA.   44230031
442400     MOVE TR023-CONPO-PO-NBR     TO TR211-CONPOA-PO-NBR.          44240031
442500     MOVE SPACES                 TO TR211-CONPOA-PO-ACTL-DELY-DTE.44250031
442600     MOVE ZEROES                 TO TR211-CONPOA-EXTL-REF-NBR.    44260031
442700     MOVE ZEROES                 TO TR211-CONPOA-CART-CNT.        44270031
442800     MOVE ZEROES                 TO TR211-CONPOA-UNT-QTY.         44280031
442900     MOVE ZEROES                 TO TR211-CONPOA-CBMT-QTY.        44290031
443000     MOVE ZEROES                 TO TR211-CONPOA-WT-KGRM-QTY.     44300031
443100                                                                  44310031
443200     PERFORM 6200-WRITE-ERR-REPORT.                               44320031
443300                                                                  44330031
443400***************************************************************** 44340031
443500* CREATE ERROR MESSAGE FOR MISSING PACK RECORD                  * 44350031
443600***************************************************************** 44360031
443700 7400-WRITE-PACK-LEVEL-ERROR.                                     44370031
443800*    DISPLAY '7400-WRITE-PACK-LEVEL-ERROR'.                       44380031
443900                                                                  44390031
444000* ***DISPLAY TRT00012-UPC-NBR ' ' PV-PREV-UPC-NBR-PACK            44400031
444100* ***DISPLAY TRT00012-SSCC-ID                                     44410031
444200     IF  TRT00012-UPC-NBR = PV-PREV-UPC-NBR-PACK                  44420031
444300     AND TRT00012-SSCC-ID EQUAL SPACES                            44430031
444400        CONTINUE                                                  44440031
444500     ELSE                                                         44450031
444600        MOVE 'E'                     TO TR211-RPT-TYP             44460031
444700        MOVE PV-PROCESS-SEQ-NBR      TO TR211-PROCESS-SEQ-NBR     44470031
444800        ADD  +1                      TO TR211-PROCESS-SEQ-NBR     44480031
444900        MOVE PV-HOLD-TRN-TYP         TO TR211-TRN-TYP             44490031
445000        MOVE PV-HOLD-CONTNR-ID       TO TR211-CONTNR-ID           44500031
445100        MOVE PV-HOLD-ACTL-DPRTR-DTE  TO TR211-ACTL-DPRTR-DTE-MOM  44510031
445200        MOVE PV-HOLD-ACTL-DPRTR-TM   TO TR211-ACTL-DPRTR-TM-MOM   44520031
445300        MOVE PV-HOLD-DAT-SRC-ENT-ID  TO TR211-DAT-SRC-ENT-ID      44530031
445400                                                                  44540031
445500        MOVE 'CNCART'                TO TR211-REC-TYP-CNCART-CDE  44550031
445600        MOVE '52'                    TO TR211-SEQ-NBR-CNCART      44560031
445700        MOVE '      '                TO TR211-3RD-PARTY-CDE-CNCART44570031
445800        MOVE PV-HOLD-PO-NBR          TO TR211-CNCART-PO-NBR       44580031
445900        MOVE TRT00012-SSCC-ID        TO TR211-CNCART-SSCC-NBR     44590031
446000        MOVE TRT00012-UPC-NBR        TO TR211-CNCART-UPC-NBR      44600031
446100                                        PV-PREV-UPC-NBR-PACK      44610031
446200        MOVE TRT00012-UNT-QTY        TO TR211-CNCART-UNT-QTY      44620031
446300                                                                  44630031
446400*       SAVE ERROR TO BE WRITEN WHEN WORK TABLE IS UNLOADED       44640031
446500        MOVE TR211-RECORD TO PV-TABLE-ERROR-REC(ERR-INDEX)        44650031
446600        MOVE 'N'          TO PV-TABLE-ERROR-REC-WRITEN(ERR-INDEX) 44660031
446700        SET ERR-INDEX UP BY +1                                    44670031
446800        INITIALIZE TR211-RECORD                                   44680031
446900     END-IF.                                                      44690031
447000                                                                  44700031
447100***************************************************************** 44710031
447200* CREATE ERROR MESSAGE FOR MISSING ITEM RECORD                  * 44720031
447300***************************************************************** 44730031
447400 7500-WRITE-ITEM-LEVEL-ERROR.                                     44740031
447500*    DISPLAY '7500-WRITE-ITEM-LEVEL-ERROR'.                       44750031
447600                                                                  44760031
447700     IF  TR211-CONUPA-UPC-NBR = PV-PREV-UPC-NBR-ITEM              44770031
447800     AND TR211-ERROR-MSG      = 'CNCART DATA MISSING'             44780031
447900        CONTINUE                                                  44790031
448000     ELSE                                                         44800031
448100        MOVE TR211-CONUPA-UPC-NBR    TO PV-PREV-UPC-NBR-ITEM      44810031
448200        MOVE 'E'                     TO TR211-RPT-TYP             44820031
448300        MOVE PV-PROCESS-SEQ-NBR      TO TR211-PROCESS-SEQ-NBR     44830031
448400        ADD  +1                      TO TR211-PROCESS-SEQ-NBR     44840031
448500        MOVE PV-HOLD-TRN-TYP         TO TR211-TRN-TYP             44850031
448600        MOVE PV-HOLD-CONTNR-ID       TO TR211-CONTNR-ID           44860031
448700        MOVE PV-HOLD-ACTL-DPRTR-DTE  TO TR211-ACTL-DPRTR-DTE-MOM  44870031
448800        MOVE PV-HOLD-ACTL-DPRTR-TM   TO TR211-ACTL-DPRTR-TM-MOM   44880031
448900        MOVE PV-HOLD-DAT-SRC-ENT-ID  TO TR211-DAT-SRC-ENT-ID      44890031
449000                                                                  44900031
449100        MOVE 'CONUPA'                 TO TR211-REC-TYP-CONUPA-CDE 44910031
449200        MOVE '50'                     TO TR211-SEQ-NBR-CONUPA     44920031
449300        MOVE '      '                TO TR211-3RD-PARTY-CDE-CONUPA44930031
449400        MOVE PV-HOLD-PO-NBR           TO TR211-CONUPA-PO-NBR      44940031
449500        MOVE SPACES                   TO TR211-CONUPA-VS-NBR      44950031
449600        MOVE ZEROES                   TO TR211-CONUPA-CART-CNT    44960031
449700        MOVE SPACES                   TO TR211-CONUPA-PACK-TYPE   44970031
449800        MOVE ZEROES                   TO TR211-CONUPA-PACK-ID     44980031
449900        MOVE SPACES                   TO TR211-CONUPA-SKU-X       44990031
450000        MOVE TRT00012-ASN-PKGNG-CDE   TO TR211-CONUPA-ASN-PKG-CDE 45000031
450100        IF PV-ASN-STANDARD-CARTON                                 45010031
450200           MOVE ZEROES                TO TR211-CONUPA-UNT-QTY     45020031
450300        ELSE                                                      45030031
450400           MOVE TRT00012-UNT-QTY      TO TR211-CONUPA-UNT-QTY     45040031
450500        END-IF                                                    45050031
450600                                                                  45060031
450700*       SAVE ERROR TO BE WRITEN WHEN WORK TABLE IS UNLOADED       45070031
450800        MOVE TR211-RECORD TO PV-TABLE-ERROR-REC(ERR-INDEX)        45080031
450900        MOVE 'N'          TO PV-TABLE-ERROR-REC-WRITEN(ERR-INDEX) 45090031
451000        SET ERR-INDEX UP BY +1                                    45100031
451100        INITIALIZE TR211-RECORD                                   45110031
451200     END-IF.                                                      45120031
451300                                                                  45130031
451400***************************************************************** 45140031
451500* WRITE WARNING MESSAGES FOR PACK AND ITEM RECORDS                45150031
451600***************************************************************** 45160031
451700 7600-WRITE-PACK-ITEM-WARNINGS.                                   45170031
451800*    DISPLAY '7600-WRITE-PACK-ITEM-WARNINGS'.                     45180031
451900*    WRITE ITEM WARNING MESSAGES FOR UPC                          45190031
452000     PERFORM VARYING PV-COUNTER FROM 1 BY 1                       45200031
452100       UNTIL PV-COUNTER >= ERR-INDEX                              45210031
452200         MOVE PV-TABLE-ERROR-REC(PV-COUNTER) TO TR211-RECORD      45220031
452300         IF  TR211-REC-TYP-CONUPA-CDE = 'CONUPA'                  45230031
452400         AND TR211-CONUPA-UPC-NBR     = TR023-CONUPC-UPC-NBR      45240031
452500         AND PV-TABLE-ERROR-REC-WRITEN(PV-COUNTER) = 'N'          45250031
452600            MOVE TR023-CNTR-PROCESS-SEQ-NBR-1                     45260031
452700                     TO TR211-PROCESS-SEQ-NBR                     45270031
452800            PERFORM 6200-WRITE-ERR-REPORT                         45280031
452900            MOVE 'Y' TO PV-TABLE-ERROR-REC-WRITEN(PV-COUNTER)     45290031
453000         END-IF                                                   45300031
453100     END-PERFORM.                                                 45310031
453200                                                                  45320031
453300*    WRITE PACK WARNING MESSAGES FOR UPC                          45330031
453400     PERFORM VARYING PV-COUNTER FROM 1 BY 1                       45340031
453500       UNTIL PV-COUNTER >= ERR-INDEX                              45350031
453600         MOVE PV-TABLE-ERROR-REC(PV-COUNTER) TO TR211-RECORD      45360031
453700         IF  TR211-REC-TYP-CNCART-CDE = 'CNCART'                  45370031
453800         AND TR211-CNCART-UPC-NBR     = TR023-CNCART-UPC-NBR      45380031
453900         AND PV-TABLE-ERROR-REC-WRITEN(PV-COUNTER) = 'N'          45390031
454000            MOVE PV-TABLE-ERROR-REC(PV-COUNTER) TO TR211-RECORD   45400031
454100            MOVE TR023-CNTR-PROCESS-SEQ-NBR-1                     45410031
454200                     TO TR211-PROCESS-SEQ-NBR                     45420031
454300            PERFORM 6200-WRITE-ERR-REPORT                         45430031
454400            MOVE 'Y' TO PV-TABLE-ERROR-REC-WRITEN(PV-COUNTER)     45440031
454500         END-IF                                                   45450031
454600     END-PERFORM.                                                 45460031
454700                                                                  45470031
454800***************************************************************** 45480031
454900* WRITE ERROR MESSAGES FOR PACK RECORDS                           45490031
455000***************************************************************** 45500031
455100 7610-WRITE-PACK-ERRORS.                                          45510031
455200*    DISPLAY '7610-WRITE-PACK-ERRORS'.                            45520031
455300*    WRITE ITEM WARNING MESSAGES FOR UPC                          45530031
455400     PERFORM VARYING PV-COUNTER FROM 1 BY 1                       45540031
455500       UNTIL PV-COUNTER >= ERR-INDEX                              45550031
455600         MOVE PV-TABLE-ERROR-REC(PV-COUNTER) TO TR211-RECORD      45560031
455700         IF PV-TABLE-ERROR-REC-WRITEN(PV-COUNTER) = 'N'           45570031
455800            ADD +1                  TO PV-PROCESS-SEQ-NBR         45580031
455900            MOVE PV-PROCESS-SEQ-NBR TO TR211-PROCESS-SEQ-NBR      45590031
456000            PERFORM 6200-WRITE-ERR-REPORT                         45600031
456100         END-IF                                                   45610031
456200     END-PERFORM.                                                 45620031
456300                                                                  45630031
456400     INITIALIZE PV-ITEM-PACK-ERROR-TABLE.                         45640031
456500                                                                  45650031
456600******************************************************************45660031
456700* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *45670031
456800* JOB SUMMARY INFORMATION.                                       *45680031
456900* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *45690031
457000* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *45700031
457100* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TO LONG, THE EDI   *45710031
457200* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*45720031
457300* NO RETURN CODE OR MESSAGE IS SENT.                             *45730031
457400******************************************************************45740031
457500 8000-EOJ-ROUTINE.                                                45750031
457600*    DISPLAY '8000-EOJ-ROUTINE'.                                  45760031
457700                                                                  45770031
457800     IF PS-DATA-IN-ERROR-NO                                       45780031
457900     AND (PS-BYPASS-IN-PROCESS-NO                                 45790031
458000      OR (PV-PACK-LEVEL AND PV-ASN-STANDARD-NO-CARTON))           45800031
458100        MOVE PV-RECORD-LEVEL-CDE TO PV-PREV-RECORD-LEVEL-CDE      45810031
458200        EVALUATE TRUE                                             45820031
458300           WHEN PV-PREV-ID-LEVEL                                  45830031
458400              MOVE PC-ERROR TO TR211-ERROR-TYPE                   45840031
458500              MOVE 'CON DATA MISSING' TO TR211-ERROR-MSG          45850031
458600              PERFORM 7000-MISSING-LEVEL-ERROR                    45860031
458700           WHEN PV-PREV-SHIPMENT-LEVEL                            45870031
458800              PERFORM 6110-WRITE-CNTR-RECORD                      45880031
458900              PERFORM 6110-WRITE-CNTR-RECORD                      45890031
459000              MOVE PC-ERROR TO TR211-ERROR-TYPE                   45900031
459100              MOVE 'CONPO DATA MISSING' TO TR211-ERROR-MSG        45910031
459200              PERFORM 7000-MISSING-LEVEL-ERROR                    45920031
459300           WHEN PV-PREV-ORDER-LEVEL                               45930031
459400              PERFORM 6110-WRITE-CNTR-RECORD                      45940031
459500              PERFORM 6120-WRITE-CONPO-RECORD                     45950031
459600              MOVE PC-ERROR TO TR211-ERROR-TYPE                   45960031
459700              MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG        45970031
459800              PERFORM 7000-MISSING-LEVEL-ERROR                    45980031
459900           WHEN PV-PREV-PACK-LEVEL                                45990031
460000              IF PV-ASN-PICK-N-PACK                               46000031
460100                 MOVE PC-ERROR TO TR211-ERROR-TYPE                46010031
460200                 MOVE 'CONUP DATA MISSING' TO TR211-ERROR-MSG     46020031
460300                 PERFORM 7000-MISSING-LEVEL-ERROR                 46030031
460400              END-IF                                              46040031
460500              IF PV-ASN-STANDARD-CARTON                           46050031
460600                 PERFORM 4300-EDIT-PACK-LEVEL-DATA                46060031
460700                 PERFORM 3100-INSERT-REC-TO-WORK-TABLE            46070031
460800                 INITIALIZE DCLTRT00012                           46080031
460900              END-IF                                              46090031
461000              PERFORM 6130-WRITE-ITEM-PACK-RECORD                 46100031
461100              PERFORM 6120-WRITE-CONPO-RECORD                     46110031
461200              PERFORM 6110-WRITE-CNTR-RECORD                      46120031
461300           WHEN PV-PREV-ITEM-LEVEL                                46130031
461400              EVALUATE TRUE                                       46140031
461500                 WHEN PV-ASN-PICK-N-PACK                          46150031
461600                  AND PS-UPC-NBR-FOUND                            46160031
461700                    IF PS-COMP-ERROR-NO                           46170031
461800                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         46180031
461900                    END-IF                                        46190031
462000                    INITIALIZE DCLTRT00012                        46200031
462100                 WHEN PV-ASN-STANDARD-CARTON                      46210031
462200                    MOVE PC-WARNING            TO TR211-ERROR-TYPE46220031
462300                    MOVE 'CNCART DATA MISSING' TO TR211-ERROR-MSG 46230031
462400                    PERFORM 7000-MISSING-LEVEL-ERROR              46240031
462500                 WHEN PV-ASN-STANDARD-NO-CARTON                   46250031
462600                    PERFORM 3100-INSERT-REC-TO-WORK-TABLE         46260031
462700                    INITIALIZE DCLTRT00012                        46270031
462800              END-EVALUATE                                        46280031
462900*             IF PS-COMP-ERROR-NO                                 46290031
463000              PERFORM 6130-WRITE-ITEM-PACK-RECORD                 46300031
463100*             END-IF                                              46310031
463200              PERFORM 6120-WRITE-CONPO-RECORD                     46320031
463300              PERFORM 6110-WRITE-CNTR-RECORD                      46330031
463400        END-EVALUATE                                              46340031
463500     END-IF.                                                      46350031
463600                                                                  46360031
463700     PERFORM 2980-WRITE-ENT-ID-TO-FILTRKNG.                       46370031
463800     PERFORM 8100-CLEAR-WORK-TABLE.                               46380031
463900     PERFORM 8200-SET-EXTL-REF-EXTENSION.                         46390031
464000                                                                  46400031
464100     CLOSE TR063-ASN-FILE                                         46410031
464200           TR023-UPDATE-CONTAINER-FILE                            46420031
464300           TR211-CONTAINER-ERROR-FILE                             46430031
464400           TR063-EXCEPTION-FILE.                                  46440031
464500                                                                  46450031
464600     SUBTRACT 1 FROM PA-INPUT-COUNT.                              46460031
464700     COMPUTE PA-TOTAL-UPDATE =                                    46470031
464800               (PA-TOTAL-UPDATE-CNTR + PA-TOTAL-UPDATE-CONPO +    46480031
464900                PA-TOTAL-UPDATE-CONUPC + PA-TOTAL-UPDATE-CNCART)  46490031
465000                                                                  46500031
465100     DISPLAY '*************************************************'. 46510031
465200     DISPLAY '** TRKUP212 SUMMARY                            **'. 46520031
465300     DISPLAY '*************************************************'. 46530031
465400     DISPLAY 'TOTAL RECORDS READ     = ' PA-INPUT-COUNT.          46540031
465500     DISPLAY '*************************************************'. 46550031
465600     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.    46560031
465700     DISPLAY '*************************************************'. 46570031
465800     DISPLAY 'TOTAL UPDATE CNTR      = ' PA-TOTAL-UPDATE-CNTR.    46580031
465900     DISPLAY 'TOTAL UPDATE CONPO     = ' PA-TOTAL-UPDATE-CONPO.   46590031
466000     DISPLAY 'TOTAL UPDATE CONUPC    = ' PA-TOTAL-UPDATE-CONUPC.  46600031
466100     DISPLAY 'TOTAL UPDATE CNCART    = ' PA-TOTAL-UPDATE-CNCART.  46610031
466200     DISPLAY '                         --------------'.           46620031
466300     DISPLAY 'TOTAL UPDATE RECORDS   = ' PA-TOTAL-UPDATE.         46630031
466400     DISPLAY '*************************************************'. 46640031
466500                                                                  46650031
466600 EJECT                                                            46660031
466700                                                                  46670031
466800****************************************************************  46680031
466900* CLEAR ALL ROWS FROM WORK TABLE                                  46690031
467000****************************************************************  46700031
467100 8100-CLEAR-WORK-TABLE.                                           46710031
467200*    DISPLAY '8100-CLEAR-WORK-TABLE'.                             46720031
467300                                                                  46730031
467400         EXEC SQL                                                 46740031
467500              DELETE FROM TRTW_CONTNR_LOD                         46750031
467600         END-EXEC.                                                46760031
467700                                                                  46770031
467800     EVALUATE TRUE                                                46780031
467900         WHEN SQLCODE = ZERO                                      46790031
468000         WHEN SQLCODE = +100                                      46800031
468100             CONTINUE                                             46810031
468200         WHEN SQLWARN0 NOT = SPACES                               46820031
468300         WHEN SQLCODE < ZERO                                      46830031
468400         WHEN SQLCODE > ZERO                                      46840031
468500             MOVE '8100-CLEAR-WORK-TABLE'                         46850031
468600                                     TO PV-PARAGRAPH-NAME         46860031
468700             MOVE 'ATTEMPTING TO DELETE'                          46870031
468800                                     TO PV-DB2-OPERATION-MESSAGE  46880031
468900             MOVE 'TRTW_CONTNR_LOD'  TO PV-DB2-TABLE-NAME-1       46890031
469000             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       46900031
469100             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       46910031
469200             PERFORM 9100-USER-ABEND                              46920031
469300     END-EVALUATE.                                                46930031
469400                                                                  46940031
469500******************************************************************46950031
469600* SET EXTENSION TO EXTERNAL REF NUMBER FROM TIMCNTL              *46960031
469700******************************************************************46970031
469800 8200-SET-EXTL-REF-EXTENSION.                                     46980031
469900*    DISPLAY '8200-SET-EXTL-REF-EXTENSION'.                       46990031
470000                                                                  47000031
470100          EXEC SQL                                                47010031
470200              UPDATE TIMCNTL                                      47020031
470300              SET LNDD_XREF_SEQ_NBR = :IMCNTL-LNDD-XREF-SEQ-NBR   47030031
470400          END-EXEC                                                47040031
470500                                                                  47050031
470600     EVALUATE TRUE                                                47060031
470700         WHEN SQLCODE = ZERO                                      47070031
470800               CONTINUE                                           47080031
470900         WHEN SQLWARN0 NOT = SPACES                               47090031
471000         WHEN SQLCODE < ZERO                                      47100031
471100         WHEN SQLCODE > ZERO                                      47110031
471200             MOVE '1200-GET-EXTL-REF-EXTENSION'                   47120031
471300                                     TO PV-PARAGRAPH-NAME         47130031
471400             MOVE 'ERROR WHILE DOING SELECT'                      47140031
471500                                     TO PV-DB2-OPERATION-MESSAGE  47150031
471600             MOVE 'TIMCNTL'          TO PV-DB2-TABLE-NAME-1       47160031
471700             MOVE SPACES             TO PV-DB2-TABLE-NAME-2       47170031
471800             MOVE SPACES             TO PV-DB2-TABLE-NAME-3       47180031
471900             PERFORM 9100-USER-ABEND                              47190031
472000     END-EVALUATE.                                                47200031
472100                                                                  47210031
472200                                                                  47220031
472300******************************************************************47230031
472400* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *47240031
472500* ERROR OR WARNING CODE OCCURS.                                  *47250031
472600******************************************************************47260031
472700 9100-USER-ABEND.                                                 47270031
472800******************************************************************47280031
472900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *47290031
473000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *47300031
473100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *47310031
473200* FORMAT.                                                        *47320031
473300******************************************************************47330031
473400                                                                  47340031
473500*AME 6/4/08 ADDED DISPLAY LINES.                                  47350031
473600     DISPLAY '9100-USER-ABEND'.                                   47360031
473700     DISPLAY '** ABEND           **'.                             47370031
473800     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        47380031
473900     DISPLAY '** TABLES AFFECTED ** = ' PV-DB2-TABLE-NAME-1.      47390031
474000     DISPLAY '**                 ** = ' PV-DB2-TABLE-NAME-2.      47400031
474100     DISPLAY '**                 ** = ' PV-DB2-TABLE-NAME-3.      47410031
474200     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE. 47420031
474300                                                                  47430031
474400     COPY DPPD004.                                                47440031
474500                                                                  47450031
474600     DISPLAY '**************************************************'.47460031
474700     DISPLAY 'CNTNR ID          '  TR023-CNTR-CONTNR-ID.          47470031
474800     DISPLAY 'ACTL DPTR DTE MOM  '  TR023-CNTR-ACTL-DPRTR-DTE-MOM.47480031
474900     DISPLAY 'PV-PROCESS-SEQ-NBR  '  PV-PROCESS-SEQ-NBR.          47490031
475000     DISPLAY 'PV-PREV-ISA-ID      '  PV-PREV-ISA-ID.              47500031
475100     DISPLAY 'PV-HOLD-ISA-ID      '  PV-HOLD-ISA-ID.              47510031
475200     DISPLAY 'PV-RECORD-LEVEL-CDE ' PV-RECORD-LEVEL-CDE.          47520031
475300     DISPLAY 'PV-PREV-RECORD-LEVEL-CDE ' PV-PREV-RECORD-LEVEL-CDE.47530031
475400     DISPLAY 'PV-ASN-STRUCTURE    ' PV-ASN-STRUCTURE.             47540031
475500     DISPLAY 'PV-HOLD-TRN-TYP     ' PV-HOLD-TRN-TYP.              47550031
475600     DISPLAY 'PV-HOLD-ISA-CNTL-NBR ' PV-HOLD-ISA-CNTL-NBR.        47560031
475700     DISPLAY 'PV-HOLD-FILE-ID     ' PV-HOLD-FILE-ID.              47570031
475800     DISPLAY 'PV-HOLD-SHIPT-ID    ' PV-HOLD-SHIPT-ID.             47580031
475900     DISPLAY 'PV-HOLD-CONTNR-ID   ' PV-HOLD-CONTNR-ID.            47590031
476000     DISPLAY 'PV-HOLD-PO-NBR      ' PV-HOLD-PO-NBR.               47600031
476100     DISPLAY 'PV-HOLD-ACTL-DPRTR-DTE ' PV-HOLD-ACTL-DPRTR-DTE.    47610031
476200     DISPLAY 'PV-UPC-NBR-NON-NUMERIC ' PV-UPC-NBR-NON-NUMERIC.    47620031
476300     DISPLAY 'PV-UPC-NBR-DISPLAY '  PV-UPC-NBR-DISPLAY.           47630031
476400     DISPLAY 'PV-SKU-NBR-DISPLAY '  PV-SKU-NBR-DISPLAY.           47640031
476500     DISPLAY 'PV-PREV-UPC-NBR-PACK ' PV-PREV-UPC-NBR-PACK.        47650031
476600     DISPLAY 'PV-PREV-UPC-NBR-ITEM ' PV-PREV-UPC-NBR-ITEM.        47660031
476700     DISPLAY 'PV-LIN-UPC-NBR       ' PV-LIN-UPC-NBR.              47670031
476800     DISPLAY 'PV-DAT-UPC-NBR-X     ' PV-DAT-UPC-NBR-X.            47680031
476900     DISPLAY 'PV-DAT-UPC-NBR REDEF ' PV-DAT-UPC-NBR.              47690031
477000     DISPLAY 'PV-SN1-RATIO-PCKED-X ' PV-SN1-RATIO-PCKED-X.        47700031
477100     DISPLAY 'PV-SN1-RATIO-PCKED   ' PV-SN1-RATIO-PCKED.          47710031
477200     DISPLAY '**************************************************'.47720031
477300     DISPLAY  'TRT00012-UPC-NBR '       TRT00012-UPC-NBR.         47730031
477400     DISPLAY  'TRT00012-SSCC-ID '       TRT00012-SSCC-ID.         47740031
477500     DISPLAY  'TRT00012-ASN-PKGNG-CDE'  TRT00012-ASN-PKGNG-CDE.   47750031
477600     DISPLAY  'TRT00012-UNT-QTY'        TRT00012-UNT-QTY.         47760031
477700     DISPLAY  'TRT00012-UPC-CBMT-QTY'   TRT00012-UPC-CBMT-QTY.    47770031
477800     DISPLAY 'TRT00012-UPC-WT-KGRM-QTY ' TRT00012-UPC-WT-KGRM-QTY.47780031
477900     DISPLAY '**************************************************'.47790031
478000     MOVE +4013 TO ABEND-CODE.                                    47800031
478100     CALL 'ILBOABN0' USING ABEND-CODE.                            47810031
