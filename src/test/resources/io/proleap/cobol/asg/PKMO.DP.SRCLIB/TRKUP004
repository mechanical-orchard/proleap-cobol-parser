000100*************************                                         00010028
000200 IDENTIFICATION DIVISION.                                         00020028
000300*************************                                         00030028
000400                                                                  00040028
000500 PROGRAM-ID.      TRKUP004.                                       00050028
000600 AUTHOR.          ANNE YEKO.                                      00060028
000700 DATE-WRITTEN.    01/18/93.                                       00070028
000800                                                                  00080028
000900******************************************************************00090028
001000*  THIS IS A REWRITE OF TRKUP002 USING NEW DATABASES FOR YARD MGT*00100028
001100******************************************************************00110028
001200*                                                                *00120028
001300*  UPDATE SHIPMENT TABLE                                         *00130028
001400*                                                                *00140028
001500*  THIS PROGRAM WILL UPDATE SHIPMENT INFORMATION ON THE SHIPMENT *00150028
001600*  TABLE BASED ON CARRIER EDI SHIPMENT STATUS TRANSMISSIONS.     *00160028
001700*                                                                *00170028
001800******************************************************************00180028
001900*  12/12/11 CHRISTINE TWIEHAUS WR40574                            00190030
002000*           ADDED CAN (CARR-AUTH-ID) FROM TR001-N902-REF-NBR      00200028
002100******************************************************************00210033
001300* 11/03/14 TKMAJC7 - PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)         *00220033
001300*          CHANGES THRU OUT THE PROGRAM TO INCREASE SIZE OF PO#  *00230033
001300*          FROM 7 DIGITS TO 8 DIGITS.  TAGGED WITH *PS 11/03/2014*00240033
002100******************************************************************00250028
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00252054
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00253054
263697* MAKING THE CALL DYNAMIC VS STATIC.                              00254054
263697*---------------------------------------------------------------* 00255054
002200                                                                  00260028
002300 ENVIRONMENT DIVISION.                                            00270028
002400 CONFIGURATION SECTION.                                           00280028
002500                                                                  00290028
002600 SOURCE-COMPUTER. IBM-3090.                                       00300028
002700 OBJECT-COMPUTER. IBM-3090.                                       00310028
002800                                                                  00320028
002900 INPUT-OUTPUT SECTION.                                            00330028
003000 FILE-CONTROL.                                                    00340028
003100                                                                  00350028
003200     SELECT SHIPMENT-STATUS-FILE                                  00360028
003300         ASSIGN                  TO INP01.                        00370028
003400                                                                  00380028
003500     SELECT CONTROL-CARD-FILE                                     00390028
003600         ASSIGN                  TO INP02.                        00400028
003700                                                                  00410028
003800     SELECT SHIPMENT-ERROR-FILE                                   00420028
003900         ASSIGN                  TO OUT01.                        00430028
004000                                                                  00440028
004100     SELECT SHIPMENT-STATUS-REPORT                                00450028
004200         ASSIGN                  TO RPT01.                        00460028
004300                                                                  00470028
004400 EJECT                                                            00480028
004500***************                                                   00490028
004600 DATA DIVISION.                                                   00500028
004700***************                                                   00510028
004800 FILE SECTION.                                                    00520028
004900                                                                  00530028
005000 FD  SHIPMENT-STATUS-FILE                                         00540028
005100     RECORDING MODE F                                             00550028
005200     BLOCK CONTAINS 0 RECORDS                                     00560028
005300     RECORD CONTAINS 350 CHARACTERS                               00570028
005400     LABEL RECORDS ARE STANDARD                                   00580028
005500     DATA RECORD IS SHIPMENT-STATUS-RECORD.                       00590028
005600 01  SHIPMENT-STATUS-RECORD           PIC X(350).                 00600028
005700                                                                  00610028
005800 FD  CONTROL-CARD-FILE                                            00620028
005900     RECORDING MODE F                                             00630028
006000     BLOCK CONTAINS 0 RECORDS                                     00640028
006100     RECORD CONTAINS 80 CHARACTERS                                00650028
006200     LABEL RECORDS ARE STANDARD                                   00660028
006300     DATA RECORD IS CONTROL-CARD-RECORD.                          00670028
006400 01  CONTROL-CARD-RECORD              PIC X(80).                  00680028
006500                                                                  00690028
006600 FD  SHIPMENT-ERROR-FILE                                          00700028
006700     RECORDING MODE F                                             00710028
006800     BLOCK CONTAINS 0 RECORDS                                     00720028
006900     RECORD CONTAINS 80 CHARACTERS                                00730028
007000     LABEL RECORDS ARE STANDARD                                   00740028
007100     DATA RECORD IS SHIPMENT-ERROR-RECORD.                        00750028
007200 01  SHIPMENT-ERROR-RECORD            PIC X(80).                  00760028
007300                                                                  00770028
007400 FD  SHIPMENT-STATUS-REPORT                                       00780028
007500     RECORDING MODE F                                             00790028
007600     BLOCK CONTAINS 0 RECORDS                                     00800028
007700     RECORD CONTAINS 132 CHARACTERS                               00810028
007800     LABEL RECORDS ARE OMITTED                                    00820028
007900     DATA RECORD IS SHIPMENT-STATUS-LINE.                         00830028
008000 01  SHIPMENT-STATUS-LINE             PIC X(132).                 00840028
008100                                                                  00850028
008200 EJECT                                                            00860028
008300                                                                  00870028
008400 WORKING-STORAGE SECTION.                                         00880028
008500                                                                  00890028
008600****************************************************************  00900028
008700 01  FILLER                           PIC X(25)      VALUE        00910028
008800     'BEGINNING OF TRKUP004 W/S'.                                 00920028
008900****************************************************************  00930028
009000                                                                  00940028
009100*                                                                 00950028
009200*  STANDARD HEADER LINE - KOHLS 132 COL                           00960028
009300*                                                                 00970028
009400     COPY DPWS132O.                                               00980028
009500                                                                  00990028
009600 01  H2-HEADING-LINE2.                                            01000028
009700     05  FILLER                       PIC X(59)      VALUE SPACE. 01010028
009800     05  FILLER                       PIC X(15)      VALUE        01020028
009900         'FORECAST ERRORS'.                                       01030028
010000     05  FILLER                       PIC X(58)      VALUE SPACE. 01040028
010100                                                                  01050028
010200 01  H3-HEADING-LINE3.                                            01060028
010300     05  FILLER                       PIC X(54)      VALUE SPACE. 01070028
010400     05  FILLER                       PIC X(16)      VALUE        01080028
010500         'PROCESSING DATE '.                                      01090028
010600     05  H3-DATE                      PIC X(08)      VALUE SPACE. 01100028
010700     05  FILLER                       PIC X(54)      VALUE SPACE. 01110028
010800                                                                  01120028
010900 01  H4-HEADING-LINE4.                                            01130028
011000     05  FILLER                       PIC X(94)      VALUE        01140028
011100         'OWNER'.                                                 01150028
011200     05  FILLER                       PIC X(40)      VALUE        01160028
011300         ' DELV PKG'.                                             01170034
011400                                                                  01180028
011500 01  H5-HEADING-LINE5.                                            01190028
011600     05  FILLER                       PIC X(53)      VALUE        01200028
011700         'SCAC FREIGHT BILL NBR BILL OF LADING'.                  01210028
011800                                                                  01220028
011900     05  FILLER                       PIC X(41)      VALUE        01230028
012000         'SHIPPER NAME     PO       MANIFEST'.                    01240034
012100     05  FILLER                       PIC X(38)      VALUE        01250028
012200         ' SCAC QTY  ERROR DESCRIPTION'.                          01260034
012300                                                                  01270028
012400 01  D1-DETAIL-LINE1.                                             01280028
012500     05  D1-SCAC                      PIC X(04).                  01290028
012600     05  FILLER                       PIC X(01)      VALUE SPACES.01300028
012700     05  D1-FREIGHT-BILL              PIC X(16).                  01310028
012800     05  FILLER                       PIC X(01)      VALUE SPACES.01320028
012900     05  D1-BILL-OF-LADING            PIC X(30).                  01330028
013000     05  FILLER                       PIC X(01)      VALUE SPACES.01340028
013100     05  D1-SHIPPER                   PIC X(16).                  01350028
013200     05  FILLER                       PIC X(01)      VALUE SPACES.01360028
013300*PS 11/03/2014 CHANGE STARTS                                      01370034
013300     05  D1-PO                        PIC X(08).                  01380033
013300*PS 11/03/2014 CHANGE ENDS                                        01390034
013400     05  FILLER                       PIC X(01)      VALUE SPACES.01400028
013500     05  D1-MANIFEST                  PIC X(15).                  01410028
013600     05  FILLER                       PIC X(01)      VALUE SPACES.01420028
013700     05  D1-DELV-SCAC                 PIC X(04).                  01430028
013800     05  FILLER                       PIC X(01)      VALUE SPACES.01440028
013900     05  D1-PKG-QTY                   PIC ZZZZ.                   01450028
014000     05  FILLER                       PIC X(01)      VALUE SPACES.01460028
014100     05  D1-ERROR-DESC                PIC X(27).                  01470033
014200                                                                  01480028
014300 01  END-OF-REPORT-LINE.                                          01490028
014400     05  FILLER                       PIC X(132)     VALUE        01500028
014500         '  ** END OF REPORT **         '.                        01510028
014600                                                                  01520028
014700                                                                  01530028
014800 01  CD-CPU-DATE.                                                 01540028
014900     05  CD-CPU-DATE-YY               PIC 9(02)      VALUE ZEROS. 01550028
015000     05  CD-CPU-DATE-MM               PIC 9(02)      VALUE ZEROS. 01560028
015100     05  CD-CPU-DATE-DD               PIC 9(02)      VALUE ZEROS. 01570028
015200                                                                  01580028
015300 01  CT-CPU-TIME.                                                 01590028
015400     05  CT-CPU-TIME-HH               PIC 9(02)      VALUE ZEROS. 01600028
015500     05  CT-CPU-TIME-MM               PIC 9(02)      VALUE ZEROS. 01610028
015600     05  CT-CPU-TIME-SS               PIC 9(02)      VALUE ZEROS. 01620028
015700     05  CT-CPU-TIME-HS               PIC 9(02)      VALUE ZEROS. 01630028
015800                                                                  01640028
015900 01  PA-PROGRAM-ACCUMULATORS.                                     01650028
016000     05  PA-LINE-CNT                  PIC S9(03)     VALUE +99    01660028
016100                                                     COMP-3.      01670028
016200     05  PA-PAGE-CNT                  PIC 9(03)      VALUE ZEROS  01680028
016300                                                     COMP-3.      01690028
016400     05  PA-SHIPT-STATUS-READ         PIC S9(07)     COMP-3       01700028
016500                                                     VALUE ZERO.  01710028
016600     05  PA-ST-READ                   PIC S9(07)     COMP-3       01720028
016700                                                     VALUE ZERO.  01730028
016800     05  PA-B10-READ                  PIC S9(07)     COMP-3       01740028
016900                                                     VALUE ZERO.  01750028
017000     05  PA-N1-READ                   PIC S9(07)     COMP-3       01760028
017100                                                     VALUE ZERO.  01770028
017200     05  PA-N9-READ                   PIC S9(07)     COMP-3       01780028
017300                                                     VALUE ZERO.  01790028
017400     05  PA-Q5-READ                   PIC S9(07)     COMP-3       01800028
017500                                                     VALUE ZERO.  01810028
017600     05  PA-Q6-READ                   PIC S9(07)     COMP-3       01820028
017700                                                     VALUE ZERO.  01830028
017800     05  PA-SE-READ                   PIC S9(07)     COMP-3       01840028
017900                                                     VALUE ZERO.  01850028
018000     05  PA-SHIPMT-INSERTED           PIC S9(07)     COMP-3       01860028
018100                                                     VALUE ZERO.  01870028
018200     05  PA-SHIPST-INSERTED           PIC S9(07)     COMP-3       01880028
018300                                                     VALUE ZERO.  01890028
018400     05  PA-SHPTPO-INSERTED           PIC S9(07)     COMP-3       01900028
018500                                                     VALUE ZERO.  01910028
018600     05  PA-VEHICL-INSERTED           PIC S9(07)     COMP-3       01920028
018700                                                     VALUE ZERO.  01930028
018800     05  PA-VEHICL-DELETED            PIC S9(07)     COMP-3       01940028
018900                                                     VALUE ZERO.  01950028
019000     05  PA-VHTRIP-INSERTED           PIC S9(07)     COMP-3       01960028
019100                                                     VALUE ZERO.  01970028
019200     05  PA-TRIPST-INSERTED           PIC S9(07)     COMP-3       01980028
019300                                                     VALUE ZERO.  01990028
019400     05  PA-SHIPMT-UPDATED            PIC S9(07)     COMP-3       02000028
019500                                                     VALUE ZERO.  02010028
019600     05  PA-SHIPST-UPDATED            PIC S9(07)     COMP-3       02020028
019700                                                     VALUE ZERO.  02030028
019800     05  PA-VEHICL-UPDATED            PIC S9(07)     COMP-3       02040028
019900                                                     VALUE ZERO.  02050028
020000     05  PA-VHTRIP-UPDATED            PIC S9(07)     COMP-3       02060028
020100                                                     VALUE ZERO.  02070028
020200     05  PA-TRIPST-UPDATED            PIC S9(07)     COMP-3       02080028
020300                                                     VALUE ZERO.  02090028
020400     05  PA-ERRORS-WRITTEN            PIC S9(07)     COMP-3       02100028
020500                                                     VALUE ZERO.  02110028
020600                                                                  02120028
020700 01  PC-PROGRAM-CONTROLS.                                         02130028
020800     05  PC-ROW-NOT-FOUND             PIC S9(04)     VALUE +100   02140028
020900                                                     COMP SYNC.   02150028
021000     05  PC-NEG-803                   PIC S9(04)     VALUE -803   02160028
021100                                                     COMP SYNC.   02170028
021200     05  PC-NEG-811                   PIC S9(04)     VALUE -811   02180028
021300                                                     COMP SYNC.   02190028
021400     05  PC-NEG-904                   PIC S9(04)     VALUE -904   02200028
021500                                                     COMP SYNC.   02210028
021600     05  PC-NEG-913                   PIC S9(04)     VALUE -913   02220028
021700                                                     COMP SYNC.   02230028
021800     05  PC-NEG-911                   PIC S9(04)     VALUE -911   02240028
021900                                                     COMP SYNC.   02250028
022000     05  PC-DPKUT500                  PIC X(10)      VALUE        02260028
022100         'DPKUT500  '.                                            02270028
022200     05  PC-TRKUP004                  PIC X(08)      VALUE        02280028
022300         'TRKUP004'.                                              02290028
022400     05  PC-RCKUP006                  PIC X(08)      VALUE        02300028
022500         'RCKUP006'.                                              02310028
022600     05  PC-RANDNBR-PGM               PIC X(08)      VALUE        02320028
022700         'DPKUT902'.                                              02330051
022800     05  PC-ILBOABN0                  PIC X(10)      VALUE        02340028
022900         'ILBOABN0  '.                                            02350028
023000     05  PC-CALENDAR-TYPE             PIC X(02)      VALUE 'A0'.  02360028
023100     05  PC-MAX-LINES                 PIC S9(03)     VALUE +48    02370028
023200                                                     COMP-3.      02380028
023300     05  PC-OPERCO-NBR                PIC X(02)      VALUE '03'.  02390028
023400     05  PC-DEFAULT-PKG-CTN           PIC X(03)      VALUE 'CTN'. 02400028
023500     05  PC-DEFAULT-SHIPT-STAT-AF     PIC X(02)      VALUE 'AF'.  02410028
023600     05  PC-DEFAULT-SHIPT-STAT-EN     PIC X(02)      VALUE 'EN'.  02420028
023700     05  PC-DEFAULT-SHIPT-TYP-CDE     PIC S9(04)     VALUE +1     02430028
023800                                                     COMP.        02440028
023900     05  PC-DEFAULT-DATE              PIC X(10)      VALUE        02450028
024000                                      '0001-01-01'.               02460028
024100     05  PC-DEFAULT-TIME              PIC X(08)      VALUE        02470028
024200                                      '00.00.00'.                 02480028
024300     05  PC-01                        PIC X(02)      VALUE '01'.  02490028
024400     05  PC-AR                        PIC X(02)      VALUE 'AR'.  02500028
024500     05  PC-CE                        PIC X(02)      VALUE 'CE'.  02510028
024600     05  PC-EN                        PIC X(02)      VALUE 'EN'.  02520028
024700     05  PC-XX                        PIC X(02)      VALUE 'XX'.  02530028
024800     05  PC-TR                        PIC X(02)      VALUE 'TR'.  02540028
024900     05  PC-25                        PIC X(02)      VALUE '25'.  02550028
025000     05  PC-29                        PIC X(02)      VALUE '29'.  02560028
025100     05  PC-30                        PIC X(02)      VALUE '30'.  02570028
025200     05  PC-49                        PIC X(02)      VALUE '49'.  02580028
025300     05  PC-95                        PIC X(02)      VALUE '95'.  02590028
025400     05  PC-50                        PIC X(02)      VALUE '50'.  02600028
025500     05  PC-RCV                       PIC X(03)      VALUE 'RCV'. 02610028
025600     05  PC-A                         PIC X(01)      VALUE 'A'.   02620028
025700     05  PC-D                         PIC X(01)      VALUE 'D'.   02630028
025800     05  PC-Y                         PIC X(01)      VALUE 'Y'.   02640028
025900     05  PC-MTCH-PO-CDE               PIC X(01)      VALUE 'N'.   02650028
026000     05  PC-NEG-1                     PIC S9(03)     VALUE -1     02660028
026100                                                     COMP-3.      02670028
026200     05  PC-POS-1                     PIC S9(03)     VALUE +1     02680028
026300                                                     COMP-3.      02690028
026400     05  PC-0                         PIC S9(01)     VALUE +0.    02700028
026500     05  PC-1                         PIC S9(01)     VALUE +1.    02710028
026600     05  PC-3                         PIC S9(01)     VALUE +3.    02720028
026700     05  PC-4                         PIC S9(01)     VALUE +4.    02730028
026800     05  PC-7                         PIC S9(01)     VALUE +7.    02740028
026900     05  PC-8                         PIC S9(01)     VALUE +8.    02750028
027000     05  PC-9                         PIC S9(01)     VALUE +9.    02760028
027100     05  PC-10                        PIC S9(02)     VALUE +10.   02770028
027200     05  PC-19                        PIC S9(02)     VALUE +19.   02780028
027300     05  PC-20                        PIC S9(02)     VALUE +20.   02790028
027400     05  PC-40                        PIC S9(02)     VALUE +40.   02800028
027500     05  PC-53                        PIC S9(02)     VALUE +53.   02810028
027600     05  PC-90                        PIC S9(02)     VALUE +90.   02820028
027700     05  PC-100                       PIC S9(03)     VALUE +100.  02830028
027800     05  PC-811                       PIC S9(03)     VALUE -811.  02840028
027900     05  PC-253                       PIC S9(03)     VALUE +253.  02850028
028000     05  PC-001                       PIC  9(04)     VALUE 1.     02860028
028100     05  PC-002                       PIC  9(04)     VALUE 2.     02870028
028200     05  PC-003                       PIC  9(04)     VALUE 3.     02880028
028300     05  PC-004                       PIC  9(04)     VALUE 4.     02890028
028400     05  PC-005                       PIC  9(04)     VALUE 5.     02900028
028500     05  PC-006                       PIC  9(04)     VALUE 6.     02910028
028600     05  PC-007                       PIC  9(04)     VALUE 7.     02920028
028700     05  PC-008                       PIC  9(04)     VALUE 8.     02930028
028800     05  PC-009                       PIC  9(04)     VALUE 9.     02940028
028900     05  PC-010                       PIC  9(04)     VALUE 10.    02950028
029000     05  PC-011                       PIC  9(04)     VALUE 11.    02960028
029100     05  PC-012                       PIC  9(04)     VALUE 12.    02970028
029200     05  PC-013                       PIC  9(04)     VALUE 13.    02980028
029300     05  PC-014                       PIC  9(04)     VALUE 14.    02990028
029400     05  PC-015                       PIC  9(04)     VALUE 15.    03000028
029500     05  PC-016                       PIC  9(04)     VALUE 16.    03010028
029600     05  PC-017                       PIC  9(04)     VALUE 17.    03020028
029700     05  PC-018                       PIC  9(04)     VALUE 18.    03030028
029800     05  PC-019                       PIC  9(04)     VALUE 19.    03040028
029900     05  PC-020                       PIC  9(04)     VALUE 20.    03050028
030000     05  PC-021                       PIC  9(04)     VALUE 21.    03060028
030100     05  PC-022                       PIC  9(04)     VALUE 22.    03070028
030200     05  PC-023                       PIC  9(04)     VALUE 23.    03080028
030300     05  PC-024                       PIC  9(04)     VALUE 24.    03090028
030400     05  PC-025                       PIC  9(04)     VALUE 25.    03100028
030500     05  PC-026                       PIC  9(04)     VALUE 26.    03110028
030600     05  PC-027                       PIC  9(04)     VALUE 27.    03120028
030700     05  PC-028                       PIC  9(04)     VALUE 28.    03130028
030800     05  PC-029                       PIC  9(04)     VALUE 29.    03140028
030900     05  PC-030                       PIC  9(04)     VALUE 30.    03150028
031000     05  PC-031                       PIC  9(04)     VALUE 31.    03160028
031100     05  PC-032                       PIC  9(04)     VALUE 32.    03170028
031200     05  PC-033                       PIC  9(04)     VALUE 33.    03180028
031300     05  PC-034                       PIC  9(04)     VALUE 34.    03190028
031400     05  PC-035                       PIC  9(04)     VALUE 35.    03200028
031500     05  PC-036                       PIC  9(04)     VALUE 36.    03210028
031600     05  PC-037                       PIC  9(04)     VALUE 37.    03220028
031700     05  PC-038                       PIC  9(04)     VALUE 38.    03230028
031800     05  PC-039                       PIC  9(04)     VALUE 39.    03240028
031900     05  PC-MAX-RETRIES               PIC S9(03)     VALUE +5     03250028
032000                                                     COMP-3.      03260028
032100     05  PC-INT-ZERO                  PIC S9(9)      VALUE +0     03270028
032200                                                     COMP.        03280028
032300     05  PC-SML-ZERO                  PIC S9(4)      VALUE +0     03290028
032400                                                     COMP.        03300028
032500     05  PC-VHTRIP-STATUS-DTE         PIC X(10)      VALUE        03310028
032600                                                    '1999-99-99'. 03320028
032700     05  PC-VHTRIP-STATUS-TME         PIC X(08)      VALUE        03330028
032800                                                    '99.99.99'.   03340028
032900     05  PC-BOL-SPACES                PIC X(30)      VALUE SPACES.03350028
033000     05  PC-PRO-SPACES                PIC X(22)      VALUE SPACES.03360028
033100                                                                  03370028
033200 01  PS-PROGRAM-SWITCHES.                                         03380028
033300     05  PS-INP01-SW                  PIC X(01)      VALUE 'N'.   03390028
033400         88  PS-END-OF-INP01                         VALUE 'Y'.   03400028
033500     05  PS-PRIOR-REC-TYP-SW          PIC X(03)      VALUE '   '. 03410028
033600         88  PS-PRIOR-ST-TRANS-SET-HDR-REC           VALUE 'ST '. 03420028
033700         88  PS-PRIOR-B10-BEG-SEGMENT-REC            VALUE 'B10'. 03430028
033800         88  PS-PRIOR-N1-NAME-REC                    VALUE 'N1 '. 03440028
033900         88  PS-PRIOR-N9-REF-NBR-REC                 VALUE 'N9 '. 03450028
034000         88  PS-PRIOR-Q5-STATUS-DTL-REC              VALUE 'Q5 '. 03460028
034100         88  PS-PRIOR-Q6-SHIPT-DTL-REC               VALUE 'Q6 '. 03470028
034200         88  PS-PRIOR-SE-TRANS-SET-TRL-REC           VALUE 'SE '. 03480028
034300         88  PS-PRIOR-RECORD-NOT-READ                VALUE '   '. 03490028
034400     05  PS-EDIT-ERROR-SW             PIC X(01)      VALUE 'N'.   03500028
034500         88  PS-EDIT-ERROR-DETECTED                  VALUE 'Y'.   03510028
034600         88  PS-NO-EDIT-ERROR-DETECTED               VALUE 'N'.   03520028
034700     05  PS-UPDATE-SHIPMT-SW          PIC X(01)      VALUE 'X'.   03530028
034800         88  PS-UPDATE-SHIPMT                        VALUE 'Y'.   03540028
034900         88  PS-INSERT-SHIPMT                        VALUE 'N'.   03550028
035000         88  PS-BYPASS-SHIPMT                        VALUE 'B'.   03560028
035100         88  PS-DONT-UPDATE-SHIPMT                   VALUE 'D'.   03570028
035200     05  PS-UPDATE-SHIPST-SW          PIC X(01)      VALUE 'X'.   03580028
035300         88  PS-UPDATE-SHIPST                        VALUE 'Y'.   03590028
035400         88  PS-INSERT-SHIPST                        VALUE 'N'.   03600028
035500         88  PS-BYPASS-SHIPST                        VALUE 'B'.   03610028
035600     05  PS-UPDATE-VEHICL-SW          PIC X(01)      VALUE 'X'.   03620028
035700         88  PS-UPDATE-VEHICL                        VALUE 'Y'.   03630028
035800         88  PS-INSERT-VEHICL                        VALUE 'N'.   03640028
035900         88  PS-BYPASS-VEHICL                        VALUE 'B'.   03650028
036000         88  PS-DONT-UPDATE-VEHICL                   VALUE 'D'.   03660028
036100     05  PS-UPDATE-VHTRIP-SW          PIC X(01)      VALUE 'X'.   03670028
036200         88  PS-UPDATE-VHTRIP                        VALUE 'Y'.   03680028
036300         88  PS-INSERT-VHTRIP                        VALUE 'N'.   03690028
036400         88  PS-ADD-NEXT-VHTRIP                      VALUE 'A'.   03700028
036500         88  PS-DONT-UPDATE-VHTRIP                   VALUE 'D'.   03710028
036600     05  PS-UPDATE-TRIPST-SW          PIC X(01)      VALUE 'X'.   03720028
036700         88  PS-UPDATE-TRIPST                        VALUE 'Y'.   03730028
036800         88  PS-INSERT-TRIPST                        VALUE 'N'.   03740028
036900         88  PS-BYPASS-TRIPST                        VALUE 'B'.   03750028
037000     05  PS-UPDATE-TABLE-SW           PIC X(01)      VALUE 'X'.   03760028
037100         88  PS-UPDATE-TABLE                         VALUE 'Y'.   03770028
037200         88  PS-DONT-UPDATE-TABLE                    VALUE 'D'.   03780028
037300     05  PS-VALID-OPER-UNT-ID-SW      PIC X(01)      VALUE 'N'.   03790028
037400         88  PS-VALID-OPER-UNT-ID                    VALUE 'Y'.   03800028
037500         88  PS-INVALID-OPER-UNT-ID                  VALUE 'N'.   03810028
037600     05  PS-VALID-VENDOR-SW           PIC X(01)      VALUE 'N'.   03820028
037700         88  PS-VALID-VENDOR                         VALUE 'Y'.   03830028
037800         88  PS-INVALID-VENDOR                       VALUE 'N'.   03840028
037900     05  PS-VALID-LSD-VENDOR-SW       PIC X(01)      VALUE 'N'.   03850028
038000         88  PS-VALID-LSD-VENDOR                     VALUE 'Y'.   03860028
038100         88  PS-INVALID-LSD-VENDOR                   VALUE 'N'.   03870028
038200     05  PS-PC-038-ERROR-SW           PIC X(01)      VALUE 'N'.   03880028
038300         88  PS-PC-038-ERROR                         VALUE 'Y'.   03890028
038400         88  PS-NO-PC-038-ERROR                      VALUE 'N'.   03900028
038500     05  PS-VALID-PO-SW               PIC X(01)      VALUE 'N'.   03910028
038600         88  PS-VALID-PO                             VALUE 'Y'.   03920028
038700         88  PS-INVALID-PO                           VALUE 'N'.   03930028
038800     05  PS-BOL-AND-PRO-SW            PIC X(01)      VALUE 'Y'.   03940028
038900         88  PS-A-BOL-OR-PRO                         VALUE 'Y'.   03950028
039000         88  PS-NO-BOL-AND-PRO                       VALUE 'N'.   03960028
039100     05  PS-VALID-SHIPT-STATUS-SW     PIC X(01)      VALUE 'N'.   03970028
039200         88  PS-VALID-SHIPT-STATUS                   VALUE 'Y'.   03980028
039300         88  PS-INVALID-SHIPT-STATUS                 VALUE 'N'.   03990028
039400     05  PS-VALID-PKG-TYP-CDE-SW      PIC X(01)      VALUE 'N'.   04000028
039500         88  PS-VALID-PKG-TYP-CDE                    VALUE 'Y'.   04010028
039600         88  PS-INVALID-PKG-TYP-CDE                  VALUE 'N'.   04020028
039700     05  PS-TVHTRIP-VALID-TIMESTMP-SW PIC X(01)      VALUE 'N'.   04030028
039800         88  PS-TVHTRIP-VALID-TIMESTMP               VALUE 'Y'.   04040028
039900         88  PS-TVHTRIP-NO-TIMESTMP                  VALUE 'N'.   04050028
040000     05  PS-N104-OPER-UNT-ID-SW       PIC X(01)      VALUE 'N'.   04060028
040100         88  PS-N104-OPER-UNT-ID-FOUND               VALUE 'Y'.   04070028
040200         88  PS-N104-OPER-UNT-ID-NOT-FOUND           VALUE 'N'.   04080028
040300     05  PS-BYPASS-TRANS-SET-SW       PIC X(01)      VALUE 'N'.   04090028
040400         88  PS-BYPASS-TRANS-SET                     VALUE 'Y'.   04100028
040500         88  PS-DONT-BYPASS-TRANS-SET                VALUE 'N'.   04110028
040600     05  PS-EDI-SHIPMT-SW             PIC X(01)      VALUE 'N'.   04120028
040700         88  PS-EDI-NO-SHIPMT-MODE                   VALUES       04130028
040800                                                     ' ' 'N'.     04140028
040900         88  PS-EDI-SHIPMT-MODE                      VALUE 'Y'.   04150028
041000     05  PS-MULTIPLE-VEHICLE-SW       PIC X(01)      VALUE 'N'.   04160028
041100         88  PS-MULTIPLE-VEHICLES                    VALUE 'Y'.   04170028
041200         88  PS-NOT-MULTIPLE-VEHICLES                VALUE 'N'.   04180028
041300     05  PS-VHTRIP-VEH-CHANGED-SW     PIC X(01)      VALUE 'N'.   04190028
041400         88  PS-VHTRIP-VEH-CHANGED                   VALUE 'Y'.   04200028
041500         88  PS-VHTRIP-VEH-DIDNT-CHANGE              VALUE 'N'.   04210028
041600     05  PS-VHTRIP-SCAC-CHANGED-SW    PIC X(01)      VALUE 'N'.   04220028
041700         88  PS-VHTRIP-SCAC-CHANGED                  VALUE 'Y'.   04230028
041800         88  PS-VHTRIP-SCAC-DIDNT-CHANGE             VALUE 'N'.   04240028
041900     05  PS-END-OF-ERRORS-SW          PIC X(01)      VALUE 'N'.   04250028
042000         88  PS-END-OF-ERRORS                        VALUE 'Y'.   04260028
042100     05  PS-END-OF-PO-NBRS-SW         PIC X(01)      VALUE 'N'.   04270028
042200         88  PS-END-OF-PO-NBRS                       VALUE 'Y'.   04280028
042300     05  PS-BYPASS-UPDATES-SW         PIC X(01)      VALUE 'N'.   04290028
042400         88  PS-BYPASS-UPDATES                       VALUE 'Y'.   04300028
042500         88  PS-PROCESS-UPDATES                      VALUE 'N'.   04310028
042600     05  PS-LSD-CARR-SW               PIC X(01)      VALUE 'N'.   04320028
042700         88  PS-LSD-CARR                             VALUE 'Y'.   04330028
042800         88  PS-NOT-LSD-CARR                         VALUE 'N'.   04340028
042900     05  PS-DUPLICATE-SHIPMT-SW       PIC X(01)      VALUE 'N'.   04350028
043000         88  PS-DUPLICATE-SHIPMT                     VALUE 'Y'.   04360028
043100         88  PS-NO-DUPLICATE-SHIPMT                  VALUE 'N'.   04370028
043200     05  PS-END-OF-SHIPMT-CSR         PIC X(01)      VALUE 'N'.   04380028
043300         88  PS-END-OF-SHIPMT-CSR                    VALUE 'Y'.   04390028
043400         88  PS-NOT-END-OF-SHIPMT-CSR                VALUE 'N'.   04400028
043500     05  PS-VEHICL-UPD-NOT-TRKUP004-SW  PIC X(01)    VALUE 'N'.   04410028
043600         88  PS-VEHICL-UPD-NOT-TRKUP004              VALUE 'Y'.   04420028
043700         88  PS-VEHICL-UPD-TRKUP004                  VALUE 'N'.   04430028
043800     05  PS-SHSTYP-PRTY-ERR-SW   PIC X(01)           VALUE 'N'.   04440028
043900         88 PS-SHSTYP-PRTY-ERR                       VALUE 'Y'.   04450028
044000         88 PS-SHSTYP-NOT-PRTY-ERR                   VALUE 'N'.   04460028
044100     05  PS-TRSTYP-PRTY-CD-GT-30-SW   PIC X(01)      VALUE 'N'.   04470028
044200         88 PS-TRSTYP-PRTY-CD-GT-30                  VALUE 'Y'.   04480028
044300         88 PS-TRSTYP-PRTY-CD-LE-30                  VALUE 'N'.   04490028
044400     05  PS-SHIP-REC-MORE-THAN-ZERO-SW PIC X(01) VALUE 'N'.       04500028
044500         88 PS-SHIP-REC-MORE-THAN-ZERO           VALUE 'Y'.       04510028
044600         88 PS-SHIP-REC-EQUAL-ZERO               VALUE 'N'.       04520028
044700     05  PS-EDIT-EXCEED-WRITTEN-SW     PIC X(01) VALUE 'N'.       04530028
044800         88 PS-EXCEED-ERROR-WRITTEN              VALUE 'Y'.       04540028
044900         88 PS-EXCEED-ERROR-NOT-WRITTEN          VALUE 'N'.       04550028
045000     05  PS-TVHTRIP-ID-FOUND-SW        PIC X(01) VALUE 'N'.       04560028
045100         88 PS-TVHTRIP-ID-FOUND                  VALUE 'Y'.       04570028
045200         88 PS-TVHTRIP-ID-NOT-FOUND              VALUE 'N'.       04580028
045300     05  PS-TVEHICL-TRIP-ID-FOUND-SW   PIC X(01) VALUE 'N'.       04590028
045400         88 PS-TVEHICL-TRIP-ID-FOUND             VALUE 'Y'.       04600028
045500         88 PS-TVEHICL-TRIP-ID-NOT-FOUND         VALUE 'N'.       04610028
045600                                                                  04620028
045700 01  PV-NULLS-TABLE.                                              04630028
045800     05  PV-VHTRIP-VEH-NBR-NULL       PIC S9(04)     VALUE +0     04640028
045900                                                     COMP SYNC.   04650028
046000     05  PV-VHTRIP-EST-AR-NULL        PIC S9(4)      VALUE +0     04660028
046100                                                     COMP SYNC.   04670028
046200     05  PV-SHIPMT-EST-AR-NULL        PIC S9(4)      VALUE +0     04680028
046300                                                     COMP SYNC.   04690028
046400     05  PV-AUTRIP-VEH-NBR-NULL       PIC S9(04)     VALUE +0     04700028
046500                                                     COMP SYNC.   04710028
046600     05  PV-SHIPMT-TRIP-ID-NULL       PIC S9(04)     VALUE +0     04720028
046700                                                     COMP SYNC.   04730028
046800     05  PV-AUSHIP-TRIP-ID-NULL       PIC S9(04)     VALUE +0     04740028
046900                                                     COMP SYNC.   04750028
047000     05  PV-VEHICL-CURR-TRIP-ID-NULL  PIC S9(04)     VALUE +0     04760028
047100                                                     COMP SYNC.   04770028
047200     05  PV-VEHICL-CURR-TRIP-NULL-RED PIC +9(05).                 04780028
047300     05  PV-SHPTPO-REC-SEQ-NBR-NULL   PIC S9(04)     VALUE +0     04790028
047400                                                     COMP SYNC.   04800028
047500                                                                  04810028
047600 01  PV-PROGRAM-VARIABLES.                                        04820028
047700     05  PV-TMST                      PIC X(26)      VALUE SPACES.04830028
047800     05  PV-INDEX                     PIC 9(04).                  04840028
047900     05  PV-HOLD-TMST                 PIC X(26)      VALUE SPACES.04850028
048000     05  PV-ABEND-CODE                PIC S9(04)     VALUE ZERO   04860028
048100                                                     COMP SYNC.   04870028
048200     05  PV-RANDOM-NBR                PIC S9(09)     VALUE ZEROS  04880028
048300                                                     COMP.        04890028
048400     05  PV-SHIPT-ID                  PIC S9(09)     VALUE ZEROS  04900028
048500                                                     COMP.        04910028
048600     05  PV-TRIP-ID                   PIC S9(09)     VALUE ZEROS  04920028
048700                                                     COMP.        04930028
048800     05  PV-REC-SEQ-NBR               PIC S9(09)     VALUE ZEROS  04940028
048900                                                     COMP.        04950028
049000     05  PV-CNTL-NBR                  PIC X(09)      VALUE SPACES.04960028
049100     05  PV-CURRENT-PARA              PIC X(35)      VALUE SPACES.04970028
049200     05  PV-CARR-SCAC                 PIC X(04)      VALUE SPACES.04980028
049300     05  PV-SCAC-ID                   PIC X(04)      VALUE SPACE. 04990028
049400     05  PV-OPER-UNT-ID               PIC S9(05)     VALUE ZEROS  05000028
049500                                                     COMP.        05010028
049600     05  PV-SAVE-STATUS-CDE           PIC X(02)      VALUE SPACE. 05020028
049700     05  PV-SAVE-OPER                 PIC X(05)      VALUE SPACE. 05030028
049800     05  PV-INVALID-DELY-SCAC         PIC X(04)      VALUE SPACE. 05040028
049900     05  PV-SAVE-PKG-TYP              PIC X(03)      VALUE SPACE. 05050028
050000     05  PV-OPER-UNIT.                                            05060028
050100         10  FILLER                   OCCURS 5 TIMES.             05070028
050200             15  PV-OPER-UNIT-DIGIT   PIC X(01).                  05080028
050300     05  PV-OPER-UNIT-N  REDEFINES  PV-OPER-UNIT                  05090028
050400                                      PIC 9(05).                  05100028
050500     05  PV-FCLTY-ID                  PIC S9(04)     VALUE ZEROS  05110028
050600                                                     COMP.        05120028
050700     05  PV-FACILITY.                                             05130028
050800         10  FILLER                   OCCURS 4 TIMES.             05140028
050900             15  PV-FCLTY-ID-DIGIT    PIC X(01).                  05150028
051000     05  PV-FACILITY-N  REDEFINES  PV-FACILITY                    05160028
051100                                      PIC 9(04).                  05170028
051200     05  PV-OPER-UNT-FCLTY.                                       05180028
051300         10  FILLER                   OCCURS 9 TIMES.             05190028
051400             15  PV-OPER-UNT-FCLTY-DIGIT                          05200028
051500                                      PIC X(01).                  05210028
051600     05  PV-SHIPT-STATUS-CDE          PIC X(02)      VALUE SPACES.05220028
051700     05  PV-PKG-TYP-CDE               PIC X(03)      VALUE SPACES.05230028
051800*PS 11/03/2014 CHANGE STARTS                                      05240033
051800     05  PV-UNPK-PO                   PIC 9(08)      VALUE ZEROS. 05250033
051800*PS 11/03/2014 CHANGE ENDS                                        05260033
051900     05  PV-COMPARE-PRTY-CDE          PIC X(02)      VALUE SPACE. 05270028
052000                                                                  05280028
C98147 01  PV-VALUE1-8.                                                 05290050
C98147     05  FILLER                      PIC X(01)     VALUE SPACE.   05300050
C98147     05  PV-VALUE2-8                 PIC X(07)     VALUE SPACE.   05310050
C98147                                                                  05320050
052100 01  PW-SHIPMENT-STATUS-LINE          PIC  X(132).                05330028
052200                                                                  05340028
052300 01  PW-PROGRAM-WORKAREA.                                         05350028
052400     05  PW-RETRY-COUNTER             PIC S9(04)     VALUE +0     05360028
052500                                                     COMP SYNC.   05370028
052600     05  PW-SUB                       PIC S9(03)     COMP-3       05380028
052700                                                     VALUE ZERO.  05390028
052800     05  PW-I-SUB                     PIC S9(03)     COMP-3       05400028
052900                                                     VALUE ZERO.  05410028
053000     05  PW-O-SUB                     PIC S9(03)     COMP-3       05420028
053100                                                     VALUE ZERO.  05430028
053200     05  PW-SHIPST-SUB                PIC S9(02)     VALUE ZERO.  05440028
053300     05  PW-TRIPST-SUB                PIC S9(02)     VALUE ZERO.  05450028
053400     05  PW-SHPTPO-SUB                PIC S9(02)     VALUE ZERO.  05460028
053500     05  PW-SAVE-SHPTPO-SUB           PIC S9(02)     VALUE ZERO.  05470028
053600     05  PW-TRANS-SET-SUB             PIC S9(03)     COMP-3       05480028
053700                                                     VALUE +1.    05490028
053800     05  PW-SQLCODE                   PIC 9(06)      VALUE ZERO.  05500028
053900                                                                  05510028
054000     05  PW-INDEX                     PIC 9(04)      VALUE 1.     05520028
054100     05  PW-IDX                       PIC 9(04)      VALUE 1.     05530028
054200     05  PW-HOLD-TRANS-SET-HDR-RECORD PIC X(80)      VALUE SPACE. 05540028
054300                                                                  05550028
054400* IF THE NUMBER OF OCCURS CHANGES IN THE THE                      05560028
054500* PW-ERROR-TABLE, THE THE FOLLOWING 2 STMTS MUST CHANGE           05570028
054600* TO MATCH.                                                       05580028
054700     05  PW-MAX-ERR-TAB-ENTRIES       PIC 9(02)      VALUE 50.    05590028
054800     05  PW-MAX-ERR-TAB-ENTRIES-1     PIC 9(02)      VALUE 49.    05600028
054900     05  PW-ERROR-TABLE.                                          05610028
055000         10  PW-ERROR-NBRS OCCURS 50 TIMES.                       05620028
055100             15  PW-ERROR-NBR         PIC 9(04).                  05630028
055200***************************************************************   05640028
055300                                                                  05650028
055400 01  MSG-LINES.                                                   05660028
055500     05  MSG-01.                                                  05670028
055600         10  FILLER                   PIC X(02)      VALUE SPACES.05680028
055700         10  MSG-01-EXPLANATION       PIC X(42)      VALUE SPACES.05690028
055800         10  MSG-01-SHIPT-ID          PIC 9(11).                  05700028
055900         10  FILLER                   PIC X(11)      VALUE        05710028
056000             ', PRO-NBR: '.                                       05720028
056100         10  MSG-01-PRO-NBR           PIC X(22).                  05730028
056200         10  FILLER                   PIC X(11)      VALUE        05740028
056300             ', BOL-NBR: '.                                       05750028
056400         10  MSG-01-BOL-NBR           PIC X(30).                  05760028
056500         10  FILLER                   PIC X(03)      VALUE SPACES.05770028
056600     05  MSG-02.                                                  05780028
056700         10  FILLER                   PIC X(02)      VALUE SPACE. 05790028
056800         10  FILLER                   PIC X(08)      VALUE        05800028
056900             'HEADER: '.                                          05810028
057000         10  MSG-02-HDR-CNTL-NBR      PIC X(09).                  05820028
057100         10  FILLER                   PIC X(38)      VALUE        05830028
057200             ' HAS NO B10 BEGINNING SEGMENT RECORD. '.            05840028
057300         10  FILLER                   PIC X(39)      VALUE        05850028
057400             ' ALL RECORDS BYPASSED UNTIL NEXT HEADER'.           05860028
057500         10  FILLER                   PIC X(37)      VALUE SPACE. 05870028
057600     05  MSG-03.                                                  05880028
057700         10  FILLER                   PIC X(02)      VALUE SPACE. 05890028
057800         10  FILLER                   PIC X(09)      VALUE        05900028
057900             'SHIPMENT '.                                         05910028
058000         10  MSG-03-SHIPT-ID          PIC 9(11).                  05920028
058100         10  FILLER                   PIC X(23)      VALUE        05930028
058200             ' UPDATED  FOR PRO-NBR: '.                           05940028
058300         10  MSG-03-PRO-NBR           PIC X(22).                  05950028
058400         10  FILLER                   PIC X(10)      VALUE        05960028
058500             ' BOL-NBR: '.                                        05970028
058600         10  MSG-03-BOL-NBR           PIC X(30).                  05980028
058700         10  FILLER                   PIC X(25)      VALUE SPACE. 05990028
058800     05  MSG-04.                                                  06000028
058900         10  FILLER                   PIC X(02)      VALUE SPACE. 06010028
059000         10  FILLER                   PIC X(09)      VALUE        06020028
059100             'SHIPMENT '.                                         06030028
059200         10  MSG-04-SHIPT-ID          PIC 9(11).                  06040028
059300         10  FILLER                   PIC X(23)      VALUE        06050028
059400             ' INSERTED FOR PRO-NBR: '.                           06060028
059500         10  MSG-04-PRO-NBR           PIC X(22).                  06070028
059600         10  FILLER                   PIC X(10)      VALUE        06080028
059700             ' BOL-NBR: '.                                        06090028
059800         10  MSG-04-BOL-NBR           PIC X(30).                  06100028
059900         10  FILLER                   PIC X(25)      VALUE SPACE. 06110028
060000     05  MSG-05.                                                  06120028
060100         10  FILLER                   PIC X(02)      VALUE SPACE. 06130028
060200         10  FILLER                   PIC X(08)      VALUE        06140028
060300             'HEADER: '.                                          06150028
060400         10  MSG-05-HDR-CNTL-NBR      PIC X(09).                  06160028
060500         10  FILLER                   PIC X(22)      VALUE        06170028
060600             ' IS IN EDI TEST MODE. '.                            06180028
060700         10  FILLER                   PIC X(39)      VALUE        06190028
060800             ' ALL RECORDS BYPASSED UNTIL NEXT HEADER'.           06200028
060900         10  FILLER                   PIC X(52)      VALUE SPACE. 06210028
061000                                                                  06220028
061100 01  MSG-EXPLANATIONS.                                            06230028
061200     05  ME-001                       PIC X(28)      VALUE        06240028
061300         'W-GROSS WGHT IS NOT NUMERIC'.                           06250028
061400     05  ME-002                       PIC X(28)      VALUE        06260028
061500         'W-HDR REC WITHOUT BEGIN REC'.                           06270028
061600     05  ME-003                       PIC X(28)      VALUE        06280028
061700         'W-DATE NOT NUMERIC'.                                    06290028
061800     05  ME-004                       PIC X(28)      VALUE        06300028
061900         'W-TIME NOT NUMERIC'.                                    06310028
062000     05  ME-005                       PIC X(28)      VALUE        06320028
062100* THIS MESSAGE IS NOT USED                                        06330028
062200         'W-VEND ID NOT NUMERIC'.                                 06340028
062300     05  ME-006                       PIC X(28)      VALUE        06350028
062400         'W-DATE FORMAT IS INVALID'.                              06360028
062500     05  ME-007                       PIC X(28)      VALUE        06370028
062600         'W-TIME FORMAT IS INVALID'.                              06380028
062700     05  ME-008                       PIC X(28)      VALUE        06390028
062800         'W-TRAILER IS NOT DEPARTED'.                             06400028
062900     05  ME-009                       PIC X(28)      VALUE        06410028
063000         'W-MORE THAN 20 STATUS RCDS'.                            06420028
063100     05  ME-010                       PIC X(28)      VALUE        06430028
063200         'W-INVALID RECORD TYPE'.                                 06440028
063300     05  ME-011.                                                  06450028
063400         10  FILLER                   PIC X(23)      VALUE        06460043
063500         'W-INVALID STORE/DC - '.                                 06470028
063600         10  ME-011-OPER              PIC X(05)      VALUE SPACES.06480037
063700     05  ME-012                       PIC X(28)      VALUE        06490028
063800         'W-INVALID PO NUMBER'.                                   06500028
063900     05  ME-013.                                                  06510028
064000         10  FILLER                   PIC X(26)      VALUE        06520043
064100         'W-INVALID SHIP STATUS - '.                              06530028
064200         10  ME-013-STAT              PIC X(02)      VALUE SPACES.06540028
064300     05  ME-014                       PIC X(28)      VALUE        06550028
064400         'W-HEADER RCD MISSING'.                                  06560028
064500     05  ME-015                       PIC X(28)      VALUE        06570028
064600         'W-MORE THAN 253 RECS RCVD'.                             06580028
064700     05  ME-016.                                                  06590028
064800         10  FILLER                   PIC X(28)      VALUE        06600028
064900         'F-MISSING OPERATING UNIT'.                              06610028
065000     05  ME-017                       PIC X(28)      VALUE        06620028
065100         'W-HDR NBR NOT = TRLR NBR'.                              06630028
065200     05  ME-018                       PIC X(28)      VALUE        06640028
065300         'F-INVALID CARRIER SCAC'.                                06650028
065400     05  ME-019.                                                  06660028
065500         10  ME-019                   PIC X(23)      VALUE        06670043
065600         'W-INVALID PKG TYPE - '.                                 06680028
065700         10  ME-019-PKG-TYP           PIC X(05)      VALUE SPACES.06690028
065800     05  ME-020                       PIC X(28)      VALUE        06700028
065900         'W-SHIPMT INSRT CHGD TO UPD'.                            06710028
066000     05  ME-021                       PIC X(28)      VALUE        06720028
066100         'W-SHIPST INSRT CHGD TO UPD'.                            06730028
066200     05  ME-022                       PIC X(28)      VALUE        06740028
066300         'W-PO ALREADY EXISTS'.                                   06750028
066400     05  ME-023                       PIC X(28)      VALUE        06760028
066500         'W-INVALID DATE'.                                        06770028
066600     05  ME-024                       PIC X(28)      VALUE        06780028
066700         'W-INVALID TIME'.                                        06790028
066800     05  ME-025                       PIC X(28)      VALUE        06800028
066900         'W-MORE THAN 20 PO IN SHIPMT'.                           06810028
067000     05  ME-026                       PIC X(28)      VALUE        06820028
067100         'F-NBR ERRORS EXCEEDED LIMIT'.                           06830028
067200     05  ME-027                       PIC X(28)      VALUE        06840028
067300         'W-RANDOM NBR GENERATR ERROR'.                           06850028
067400     05  ME-028                       PIC X(28)      VALUE        06860028
067500         'W-MULTIPLE TRLRS-NO SHIPMT'.                            06870028
067600     05  ME-029                       PIC X(28)      VALUE        06880028
067700         'W-SCAC/TRLR CHGD-NO UPDATE'.                            06890028
067800     05  ME-030                       PIC X(28)      VALUE        06900028
067900         'F-214 INVALID FROM CARRIER'.                            06910028
068000     05  ME-031                       PIC X(28)      VALUE        06920028
068100         'FATAL ERROR-RECORD DROPPED'.                            06930028
068200     05  ME-032                       PIC X(28)      VALUE        06940028
068300         'F-STATUS DATA ALREADY BUILT'.                           06950028
068400     05  ME-033                       PIC X(28)      VALUE        06960028
068500         'F-214 DATA WAS BUILT BY DC'.                            06970028
068600     05  ME-034                       PIC X(28)      VALUE        06980028
068700         'F-TRLR IS ALREADY ARRIVED'.                             06990028
068800     05  ME-035                       PIC X(28)      VALUE        07000028
068900         'F-TRIP IS ENROUTE ALREADY'.                             07010028
069000     05  ME-036                       PIC X(28)      VALUE        07020028
069100         'F-RECEIVER ALREADY EXISTS'.                             07030028
069200     05  ME-037.                                                  07040036
069300         10  FILLER                   PIC X(24)      VALUE        07050043
069400         'W-INVALID DELY SCAC - '.                                07060028
069500         10  ME-037-SCAC              PIC X(04)      VALUE SPACES.07070028
069600     05  ME-038.                                                  07080028
069700         10  FILLER                   PIC X(28)      VALUE        07090028
069800         'W-MISSING DELY SCAC ID'.                                07100028
069900     05  ME-039.                                                  07110028
070000         10  FILLER                   PIC X(28)      VALUE        07120028
070100         'F-MISSING PRO AND BOL'.                                 07130028
070200 01  MSG-TABLE REDEFINES MSG-EXPLANATIONS.                        07140028
070300     05  ME-TBLE-DESC                 PIC X(28) OCCURS 39 TIMES.  07150028
070400                                                                  07160028
070500 01  TL1-TOTAL-LINE1.                                             07170028
070600     05  FILLER                       PIC X(31)      VALUE        07180028
070700         '  TRANS SET HEADERS READ (ST)  '.                       07190028
070800     05  TL1-ST-READ                  PIC ZZZ,ZZ9.                07200028
070900     05  FILLER                       PIC X(94)      VALUE SPACE. 07210028
071000                                                                  07220028
071100 01  TL2-TOTAL-LINE2.                                             07230028
071200     05  FILLER                       PIC X(31)      VALUE        07240028
071300         '  BEGINNING SEGMENTS READ (B10)'.                       07250028
071400     05  TL2-B10-READ                 PIC ZZZ,ZZ9.                07260028
071500     05  FILLER                       PIC X(94)      VALUE SPACE. 07270028
071600                                                                  07280028
071700 01  TL3-TOTAL-LINE3.                                             07290028
071800     05  FILLER                       PIC X(31)      VALUE        07300028
071900         '  NAME RECORDS READ (N1)       '.                       07310028
072000     05  TL3-N1-READ                  PIC ZZZ,ZZ9.                07320028
072100     05  FILLER                       PIC X(94)      VALUE SPACE. 07330028
072200                                                                  07340028
072300 01  TL4-TOTAL-LINE4.                                             07350028
072400     05  FILLER                       PIC X(31)      VALUE        07360028
072500         '  REFERENCE NUMBERS READ (N9)  '.                       07370028
072600     05  TL4-N9-READ                  PIC ZZZ,ZZ9.                07380028
072700     05  FILLER                       PIC X(94)      VALUE SPACE. 07390028
072800                                                                  07400028
072900 01  TL5-TOTAL-LINE5.                                             07410028
073000     05  FILLER                       PIC X(31)      VALUE        07420028
073100         '  STATUS DETAILS READ (Q5)     '.                       07430028
073200     05  TL5-Q5-READ                  PIC ZZZ,ZZ9.                07440028
073300     05  FILLER                       PIC X(94)      VALUE SPACE. 07450028
073400                                                                  07460028
073500 01  TL6-TOTAL-LINE6.                                             07470028
073600     05  FILLER                       PIC X(31)      VALUE        07480028
073700         '  SHIPMENT DETAILS READ (Q6)   '.                       07490028
073800     05  TL6-Q6-READ                  PIC ZZZ,ZZ9.                07500028
073900     05  FILLER                       PIC X(94)      VALUE SPACE. 07510028
074000                                                                  07520028
074100 01  TL7-TOTAL-LINE7.                                             07530028
074200     05  FILLER                       PIC X(31)      VALUE        07540028
074300         '  TRANSACTION VEHICLES READ(SE)'.                       07550028
074400     05  TL7-SE-READ                  PIC ZZZ,ZZ9.                07560028
074500     05  FILLER                       PIC X(94)      VALUE SPACE. 07570028
074600                                                                  07580028
074700 01  TL8-TOTAL-LINE8.                                             07590028
074800     05  FILLER                       PIC X(31)      VALUE        07600028
074900         '  SHIPMENT STATUS RECORDS READ '.                       07610028
075000     05  TL8-SHIPT-STATUS-READ        PIC ZZZ,ZZ9.                07620028
075100     05  FILLER                       PIC X(94)      VALUE SPACE. 07630028
075200                                                                  07640028
075300 01  TL9-TOTAL-LINE9.                                             07650028
075400     05  FILLER                       PIC X(31)      VALUE        07660028
075500         '  SHIPMENT TABLE INSERTS       '.                       07670028
075600     05  TL9-SHIPMT-INSERTED          PIC ZZZ,ZZ9.                07680028
075700     05  FILLER                       PIC X(94)      VALUE SPACE. 07690028
075800                                                                  07700028
075900 01  TL10-TOTAL-LINE10.                                           07710028
076000     05  FILLER                       PIC X(31)      VALUE        07720028
076100         '  SHIPMENT STATUS TABLE INSERTS'.                       07730028
076200     05  TL10-SHIPST-INSERTED         PIC ZZZ,ZZ9.                07740028
076300     05  FILLER                       PIC X(94)      VALUE SPACE. 07750028
076400                                                                  07760028
076500 01  TL11-TOTAL-LINE11.                                           07770028
076600     05  FILLER                       PIC X(31)      VALUE        07780028
076700         '  SHIPMENT/PO ASSOC. INSERTS   '.                       07790028
076800     05  TL11-SHPTPO-INSERTED         PIC ZZZ,ZZ9.                07800028
076900     05  FILLER                       PIC X(94)      VALUE SPACE. 07810028
077000                                                                  07820028
077100 01  TL12-TOTAL-LINE12.                                           07830028
077200     05  FILLER                       PIC X(31)      VALUE        07840028
077300         '  SHIPMENT VEHICL INSERTS      '.                       07850028
077400     05  TL12-VEHICL-INSERTED         PIC ZZZ,ZZ9.                07860028
077500     05  FILLER                       PIC X(94)      VALUE SPACE. 07870028
077600                                                                  07880028
077700 01  TL12A-TOTAL-LINE12.                                          07890028
077800     05  FILLER                       PIC X(31)      VALUE        07900028
077900         '  SHIPMENT VEHICL DELETES      '.                       07910028
078000     05  TL12A-VEHICL-DELETED         PIC ZZZ,ZZ9.                07920028
078100     05  FILLER                       PIC X(94)      VALUE SPACE. 07930028
078200                                                                  07940028
078300 01  TL13-TOTAL-LINE13.                                           07950028
078400     05  FILLER                       PIC X(31)      VALUE        07960028
078500         '  VEHICL TRIP INSERTS          '.                       07970028
078600     05  TL13-VHTRIP-INSERTED         PIC ZZZ,ZZ9.                07980028
078700     05  FILLER                       PIC X(94)      VALUE SPACE. 07990028
078800                                                                  08000028
078900 01  TL14-TOTAL-LINE14.                                           08010028
079000     05  FILLER                       PIC X(31)      VALUE        08020028
079100         '  TRIP STATUS TABLE INSERTS    '.                       08030028
079200     05  TL14-TRIPST-INSERTED         PIC ZZZ,ZZ9.                08040028
079300     05  FILLER                       PIC X(94)      VALUE SPACE. 08050028
079400                                                                  08060028
079500 01  TL15-TOTAL-LINE15.                                           08070028
079600     05  FILLER                       PIC X(31)      VALUE        08080028
079700         '  SHIPMENT TABLE UPDATES       '.                       08090028
079800     05  TL15-SHIPMT-UPDATED          PIC ZZZ,ZZ9.                08100028
079900     05  FILLER                       PIC X(94)      VALUE SPACE. 08110028
080000                                                                  08120028
080100 01  TL16-TOTAL-LINE16.                                           08130028
080200     05  FILLER                       PIC X(31)      VALUE        08140028
080300         '  SHIPMENT STATUS TABLE UPDATES'.                       08150028
080400     05  TL16-SHIPST-UPDATED          PIC ZZZ,ZZ9.                08160028
080500     05  FILLER                       PIC X(94)      VALUE SPACE. 08170028
080600                                                                  08180028
080700 01  TL17-TOTAL-LINE17.                                           08190028
080800     05  FILLER                       PIC X(31)      VALUE        08200028
080900         '  SHIPMENT VEHICL TABLE UPDATES'.                       08210028
081000     05  TL17-VEHICL-UPDATED          PIC ZZZ,ZZ9.                08220028
081100     05  FILLER                       PIC X(94)      VALUE SPACE. 08230028
081200                                                                  08240028
081300 01  TL18-TOTAL-LINE18.                                           08250028
081400     05  FILLER                       PIC X(31)      VALUE        08260028
081500         '  VEHICL TRIP TABLE UPDATES    '.                       08270028
081600     05  TL18-VHTRIP-UPDATED          PIC ZZZ,ZZ9.                08280028
081700     05  FILLER                       PIC X(94)      VALUE SPACE. 08290028
081800                                                                  08300028
081900 01  TL19-TOTAL-LINE19.                                           08310028
082000     05  FILLER                       PIC X(31)      VALUE        08320028
082100         '  TRIP STATUS TABLE UPDATES    '.                       08330028
082200     05  TL19-TRIPST-UPDATED          PIC ZZZ,ZZ9.                08340028
082300     05  FILLER                       PIC X(94)      VALUE SPACE. 08350028
082400                                                                  08360028
082500 01  TL20-TOTAL-LINE20.                                           08370028
082600     05  FILLER                       PIC X(31)      VALUE        08380028
082700         '  ERROR FILE RECORDS WRITTEN   '.                       08390028
082800     05  TL20-ERRORS-WRITTEN          PIC ZZZ,ZZ9.                08400028
082900     05  FILLER                       PIC X(94)      VALUE SPACE. 08410028
083000                                                                  08420028
083100 01  PW-HOLD-AREA.                                                08430028
083200     05  PW-HOLD-YYMMDD-DTE.                                      08440028
083300         10  PW-HOLD-YYMMDD-YY        PIC 9(02)      VALUE ZEROS. 08450028
083400         10  PW-HOLD-YYMMDD-MM        PIC 9(02)      VALUE ZEROS. 08460028
083500         10  PW-HOLD-YYMMDD-DD        PIC 9(02)      VALUE ZEROS. 08470028
083600     05  PW-HOLD-STATUS-DTE-CCYYMMDD.                             08480028
083700         10  PW-HOLD-STATUS-DTE-CC    PIC 9(02)      VALUE ZEROS. 08490028
083800         10  PW-HOLD-STATUS-DTE-YY    PIC 9(02)      VALUE ZEROS. 08500028
083900         10  FILLER                   PIC X(01)      VALUE '-'.   08510028
084000         10  PW-HOLD-STATUS-DTE-MM    PIC 9(02)      VALUE ZEROS. 08520028
084100         10  FILLER                   PIC X(01)      VALUE '-'.   08530028
084200         10  PW-HOLD-STATUS-DTE-DD    PIC 9(02)      VALUE ZEROS. 08540028
084300     05  PW-HOLD-STATUS-DTE-REDF  REDEFINES                       08550028
084400         PW-HOLD-STATUS-DTE-CCYYMMDD  PIC X(10).                  08560028
084500                                                                  08570028
084600     05  PW-HOLD-TIME-HHMM.                                       08580028
084700         10  PW-HOLD-HHMM-HH          PIC 9(02)      VALUE ZEROS. 08590028
084800             88  PW-HOLD-VALID-HH                    VALUES       08600028
084900                                                     00 THRU 23.  08610028
085000         10  PW-HOLD-HHMM-MM          PIC 9(02)      VALUE ZEROS. 08620028
085100             88  PW-HOLD-VALID-MM                    VALUES       08630028
085200                                                     00 THRU 59.  08640028
085300     05  PW-HOLD-STATUS-TIME-HHMMSS.                              08650028
085400         10  PW-HOLD-STATUS-TIME-HH   PIC 9(02)      VALUE ZEROS. 08660028
085500         10  FILLER                   PIC X(01)      VALUE ':'.   08670028
085600         10  PW-HOLD-STATUS-TIME-MM   PIC 9(02)      VALUE ZEROS. 08680028
085700         10  FILLER                   PIC X(01)      VALUE ':'.   08690028
085800         10  PW-HOLD-STATUS-TIME-SS   PIC 9(02)      VALUE ZEROS. 08700028
085900                                                                  08710028
086000     05  PW-HOLD-STAT-TIME-HHMMSS.                                08720028
086100         10  PW-HOLD-STAT-TIME-HH     PIC 9(02)      VALUE ZEROS. 08730028
086200         10  FILLER                   PIC X(01)      VALUE '.'.   08740028
086300         10  PW-HOLD-STAT-TIME-MM     PIC 9(02)      VALUE ZEROS. 08750028
086400         10  FILLER                   PIC X(01)      VALUE '.'.   08760028
086500         10  PW-HOLD-STAT-TIME-SS     PIC 9(02)      VALUE ZEROS. 08770028
086600                                                                  08780028
086700 01  PW-SHIPMT-RECORD.                                            08790028
086800     05  PW-SHIPMT-TRIP-ID            PIC S9(09)     VALUE +0     08800028
086900                                                     COMP.        08810028
087000     05  PW-SAVE-SHIPMT-TRIP-ID       PIC S9(09)     VALUE +0     08820028
087100                                                     COMP.        08830028
087200     05  PW-SHIPMT-SHIPT-ID           PIC S9(09)     VALUE +0     08840028
087300                                                     COMP.        08850028
087400     05  PW-SAVE-OWNER-SCAC-ID        PIC X(04)      VALUE SPACE. 08860028
087500     05  PW-SAVE-LSD-CARR-ID          PIC X(04)      VALUE SPACE. 08870028
087600     05  PW-SAVE-VHTRIP-VEH-NBR       PIC X(10)      VALUE SPACE. 08880028
087700     05  PW-SAVE-CARR-SCAC            PIC X(04)      VALUE SPACE. 08890028
087800     05  PW-SAVE-VEH-NBR              PIC X(10)      VALUE SPACE. 08900028
087900     05  PW-SHIPMT-CRT-SRC-CDE        PIC X(02)      VALUE SPACE. 08910028
088000     05  PW-SHIPMT-LAST-UPD-DTE       PIC X(10)      VALUE SPACE. 08920028
088100     05  PW-SHIPMT-LAST-UPD-TME       PIC X(08)      VALUE SPACE. 08930028
088200     05  PW-SHIPMT-LAST-UPD-UID       PIC X(08)      VALUE SPACE. 08940028
088300     05  PW-SHIPMT-ORIGIN-SCAC-ID     PIC X(04)      VALUE SPACE. 08950028
088400     05  PW-SHIPMT-PRO-SCAC-ID        PIC X(04)      VALUE SPACE. 08960028
088500     05  PW-SHIPMT-PRO-NBR            PIC X(22)      VALUE SPACE. 08970028
088600     05  PW-SHIPMT-BOL-NBR            PIC X(30)      VALUE SPACE. 08980028
088700     05  PW-SHIPMT-COMP-PRO           PIC X(22)      VALUE SPACE. 08990028
088800     05  PW-SHIPMT-COMP-BOL           PIC X(30)      VALUE SPACE. 09000028
088900     05  PW-SV-SHIPMT-COMP-PRO        PIC X(22)      VALUE SPACE. 09010028
089000     05  PW-SV-SHIPMT-COMP-BOL        PIC X(30)      VALUE SPACE. 09020028
089100     05  PW-SHIPMT-SHIPPER-NME        PIC X(20)      VALUE SPACE. 09030028
089200     05  PW-SHIPMT-SHIPT-TYP-CDE      PIC S9(04)     VALUE +0     09040028
089300                                                     COMP.        09050028
089400     05  PW-SHIPMT-EXPTED-GRO-WGHT    PIC S9(09)     VALUE +0     09060028
089500                                                     COMP.        09070028
089600     05  PW-SHIPMT-PKG-TYP-CDE        PIC X(03)      VALUE SPACE. 09080028
089700     05  PW-SHIPMT-EXPTED-PKG-QTY     PIC S9(09)     VALUE +0     09090028
089800                                                     COMP.        09100028
089900     05  PW-SHIPMT-FRGT-CHG-AMT       PIC S9(05)V99  VALUE +0     09110028
090000                                                     COMP-3.      09120028
090100     05  PW-SHIPMT-FRGT-TERMS-CDE     PIC X(01)      VALUE SPACE. 09130028
090200     05  PW-SHIPMT-EXPTED-PLT-QTY     PIC S9(9)      VALUE +0     09140028
090300                                                     COMP.        09150028
090400     05  PW-SHIPMT-EST-AR-TMST        PIC X(26)      VALUE SPACES.09160028
090500     05  PW-SHIPMT-CARR-CARTON-CNT    PIC S9(09)     VALUE +0     09170028
090600                                                     COMP-3.      09180028
090700     05  PW-SHIPMT-VEH-NBR            PIC X(10)      VALUE SPACES.09190028
090800* CLT 02-12-2011 WR40574 START                                    09200028
090900     05  PW-SHIPMT-CARR-AUTH-ID       PIC X(30)      VALUE SPACES.09210028
091000* CLT 02-12-2011 WR40574 END                                      09220028
091100                                                                  09230028
091200 01  PW-VEHICL-RECORD.                                            09240028
091300     05  PW-VEHICL-OWNER-SCAC-ID      PIC X(04)      VALUE SPACE. 09250028
091400     05  PW-VEHICL-VEH-NBR            PIC X(10)      VALUE SPACE. 09260028
091500     05  PW-VEHICL-CURR-TRIP-ID       PIC S9(09)     VALUE +0     09270028
091600                                                     COMP.        09280028
091700     05  PW-VEHICL-CRT-SRC-CDE        PIC X(02)      VALUE SPACE. 09290028
091800     05  PW-VEHICL-CURR-STATUS-CDE                                09300028
091900                                      PIC X(02)      VALUE SPACE. 09310028
092000     05  PW-VEHICL-CURR-PRTY-CDE      PIC X(02)      VALUE SPACE. 09320028
092100     05  PW-VEHICL-CURR-OPER-UNT-ID                               09330028
092200                                      PIC S9(05)     VALUE +0     09340028
092300                                                     COMP.        09350028
092400     05  PW-VEHICL-CURR-FCLTY-ID      PIC S9(04)     VALUE +0     09360028
092500                                                     COMP.        09370028
092600     05  PW-VEHICL-CURR-FAC-AREA-ID                               09380028
092700                                      PIC X(06)      VALUE SPACE. 09390028
092800     05  PW-VEHICL-CARR-SCAC-ID       PIC X(04)      VALUE SPACE. 09400028
092900                                                                  09410028
093000 01  PW-VHTRIP-RECORD.                                            09420028
093100     05  PW-VHTRIP-OWNER-SCAC-ID      PIC X(04)      VALUE SPACES.09430028
093200     05  PW-VHTRIP-VEH-NBR            PIC X(10)      VALUE SPACES.09440028
093300     05  PW-VHTRIP-TRIP-ID            PIC S9(09)     VALUE +0     09450028
093400                                                     COMP.        09460028
093500     05  PW-VHTRIP-REF-TRIP-ID        PIC S9(09)     VALUE +0     09470028
093600                                                     COMP.        09480028
093700     05  PW-VHTRIP-TRIP-BEG-DTE       PIC X(10)      VALUE SPACE. 09490028
093800     05  PW-VHTRIP-TRIP-BEG-TME       PIC X(08)      VALUE SPACE. 09500028
093900     05  PW-VHTRIP-CRT-SRC-CDE        PIC X(02)      VALUE SPACE. 09510028
094000     05  PW-VHTRIP-LAST-UPD-DTE       PIC X(10)      VALUE SPACE. 09520028
094100     05  PW-VHTRIP-LAST-UPD-TME       PIC X(08)      VALUE SPACE. 09530028
094200     05  PW-VHTRIP-LAST-UPD-UID       PIC X(08)      VALUE SPACE. 09540028
094300     05  PW-VHTRIP-MANIFEST-NBR       PIC X(15)      VALUE SPACE. 09550028
094400     05  PW-VHTRIP-PLND-TRIP-SEQ      PIC S9(04)     VALUE ZERO   09560028
094500                                                     COMP.        09570028
094600     05  PW-VHTRIP-CARR-SCAC-ID       PIC X(04)      VALUE SPACE. 09580028
094700     05  PW-VHTRIP-EST-AR-TMST.                                   09590028
094800         10  PW-VHTRIP-STATUS-DTE     PIC X(10)      VALUE SPACES.09600028
094900         10  PW-VHTRIP-D-T-DASH       PIC X(01).                  09610028
095000         10  PW-VHTRIP-STATUS-TME     PIC X(08)      VALUE SPACES.09620028
095100         10  PW-VHTRIP-D-T-MSEC       PIC X(07).                  09630028
095200                                                                  09640028
095300 01  PW-TRIPST-RECORD.                                            09650028
095400     05  PW-TRIPST-TRIP-ID            PIC S9(09)     VALUE +0     09660028
095500                                                     COMP.        09670028
095600     05  PW-TRIPST-OPER-UNT-ID        PIC S9(05)     VALUE +0     09680028
095700                                                     COMP.        09690028
095800     05  PW-TRIPST-FCLTY-ID           PIC S9(04)     VALUE +0     09700028
095900                                                     COMP.        09710028
096000     05  PW-TRIPST-FCLTY-AREA-ID      PIC X(06)      VALUE SPACE. 09720028
096100     05  PW-TRIPST-RECORD-OCCURS      OCCURS 20 TIMES.            09730028
096200         10  PW-TRIPST-TRIP-STATUS-CDE                            09740028
096300                                      PIC X(02)      VALUE SPACE. 09750028
096400         10  PW-TRIPST-STATUS-DTE     PIC X(10)      VALUE SPACE. 09760028
096500         10  PW-TRIPST-STATUS-TME     PIC X(10)      VALUE SPACE. 09770028
096600         10  PW-TRIPST-PRTY-CDE       PIC X(02)      VALUE SPACE. 09780028
096700                                                                  09790028
096800 01  PW-SHIPST-RECORD.                                            09800028
096900     05  PW-SHIPST-SHIPT-ID           PIC S9(09)     VALUE +0     09810028
097000                                                     COMP.        09820028
097100     05  PW-SHIPST-RECORD-OCCURS      OCCURS 20 TIMES.            09830028
097200         10  PW-SHIPST-SHIPT-STATUS-CDE                           09840028
097300                                      PIC X(02)      VALUE SPACE. 09850028
097400         10  PW-SHIPST-STATUS-DTE     PIC X(10)      VALUE SPACE. 09860028
097500         10  PW-SHIPST-STATUS-TME     PIC X(08)      VALUE SPACE. 09870028
097600         10  PW-SHIPST-DELAY-RSN-CDE  PIC X(03)      VALUE SPACE. 09880028
097700         10  PW-SHIPST-CARR-STATUS-CDE PIC X(02)      VALUE SPACE.09890028
097800         10  PW-SHIPST-TIME-ZONE      PIC X(02)      VALUE SPACES.09900028
097900         10  PW-SHIPST-CITY           PIC X(19)      VALUE SPACES.09910028
098000         10  PW-SHIPST-STATE          PIC X(02)      VALUE SPACES.09920028
098100         10  PW-SHIPST-LSD-CARR       PIC X(04)      VALUE SPACES.09930028
098200         10  PW-SHIPST-VEH-NBR        PIC X(10)      VALUE SPACES.09940028
098300                                                                  09950028
098400 01  PW-SHPTPO-RECORD.                                            09960028
098500     05 PW-SHPTPO-SHIPT-ID            PIC S9(09)     VALUE +0     09970028
098600                                                     COMP.        09980028
098700     05  PW-SHPTPO-RECORD-OCCURS      OCCURS 40 TIMES.            09990028
098800*PS 11/03/2014 CHANGE STARTS                                      10000033
098800         10 PW-SHPTPO-PO-NBR.                                     10010033
098900         15 PW-SHPTPO-PO-NBR-N        PIC 9(08)      VALUE ZERO.  10020033
099000                                                                  10030028
099100     05  PW-SHPTPO-PO-NBR-OCCURS      OCCURS 40 TIMES.            10040028
099200         10  PW-SAVE-PO-NBR           PIC X(08)      VALUE SPACES.10050033
098800*PS 11/03/2014 CHANGE STARTS                                      10060033
099300                                                                  10070028
099400 01  PW-SAVE-TRANSACTION-SET                         VALUE SPACES.10080028
099500     05  PW-SHIPT-STATUS-RECORD       PIC X(80)                   10090028
099600                                      OCCURS 253 TIMES.           10100028
099700                                                                  10110028
099800 01  CC-CONTROL-CARD.                                             10120028
099900     05  CC-LITERAL                   PIC X(09).                  10130028
100000         88  CC-VALID-CONTROL-CARD                   VALUE        10140028
100100             'TRKUP004 '.                                         10150028
100200     05  CC-COMMIT-NBR                PIC 9(04)      VALUE 0.     10160028
100300     05  FILLER                       PIC X(67)      VALUE SPACES.10170028
100400                                                                  10180028
100500 01  ABEND-CODE                       PIC S9(04)     VALUE +0     10190028
100600                                                     COMP SYNC.   10200028
100700     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 10210028
100800     88  ABEND-4002-READ-ERROR                       VALUE +4002. 10220028
100900     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 10230028
101000     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 10240028
101100     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 10250028
101200     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 10260028
101300     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 10270028
101400     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 10280028
101500     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 10290028
101600     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 10300028
101700                                                                  10310028
101800*                                                                 10320028
101900*  WORK AREA FOR THE FISCAL CALENDAR SUBROUTINE.                  10330028
102000*                                                                 10340028
102100     COPY DPWS500.                                                10350028
102200                                                                  10360028
102300*                                                                 10370028
102400*  WORK AREA FOR THE NUMERIC EDIT SUBROUTINE.                     10380028
102500*                                                                 10390028
102600     COPY DPWS010I.                                               10400028
102700                                                                  10410028
102800*                                                                 10420028
102900*  COPYBOOK FOR RANDOM NUMBER GENERATOR DPKUT902                  10430051
103000*                                                                 10440028
103100     COPY DPWS902.                                                10450051
103200                                                                  10460028
103300 EJECT                                                            10470028
103400*  SHIPMENT STATUS EDI TRANSMISSION FILE LAYOUT                   10480028
103500*                                                                 10490028
103600     COPY TRRD001.                                                10500028
103700                                                                  10510028
103800*  WORK AREA PASSED IN CALL TO RCKUT023                           10520028
103900*                                                                 10530028
104000     COPY RCWS023.                                                10540028
104100 EJECT                                                            10550028
104200                                                                  10560028
104300*  DB2 ERROR MESSAGE AREA                                         10570028
104400*                                                                 10580028
104500     COPY DPWS004.                                                10590028
104600 EJECT                                                            10600028
104700*                                                                 10610028
104800*  FACILITY TABLE LAYOUT                                          10620028
104900*                                                                 10630028
105000     EXEC SQL                                                     10640028
105100         INCLUDE TFACLTY                                          10650028
105200     END-EXEC.                                                    10660028
105300                                                                  10670028
105400*                                                                 10680028
105500*  CHECK POINT RESTART CONTROL                                    10690028
105600*                                                                 10700028
105700     EXEC SQL                                                     10710028
105800         INCLUDE TCKRSTCN                                         10720028
105900     END-EXEC.                                                    10730028
106000                                                                  10740028
106100 EJECT                                                            10750028
106200*                                                                 10760028
106300*  EXTERNAL ENTERPRISE TABLE LAYOUT                               10770028
106400                                                                  10780028
106500     EXEC SQL                                                     10790028
106600         INCLUDE TEXTENT                                          10800028
106700     END-EXEC.                                                    10810028
106800                                                                  10820028
106900 EJECT                                                            10830028
107000*                                                                 10840028
107100*  EXTERNAL ENTERPRISE NAME TABLE LAYOUT                          10850028
107200*                                                                 10860028
107300     EXEC SQL                                                     10870028
107400         INCLUDE TENTNME                                          10880028
107500     END-EXEC.                                                    10890028
107600                                                                  10900028
107700 EJECT                                                            10910028
107800*                                                                 10920028
107900*  PACKAGE TYPE TABLE LAYOUT                                      10930028
108000*                                                                 10940028
108100     EXEC SQL                                                     10950028
108200         INCLUDE TPKGTYP                                          10960028
108300     END-EXEC.                                                    10970028
108400                                                                  10980028
108500 EJECT                                                            10990028
108600*                                                                 11000028
108700*  SHIPMENT STATUS TYPE TABLE LAYOUT                              11010028
108800*                                                                 11020028
108900     EXEC SQL                                                     11030028
109000         INCLUDE TSHSTYP                                          11040028
109100     END-EXEC.                                                    11050028
109200                                                                  11060028
109300 EJECT                                                            11070028
109400*                                                                 11080028
109500*  SHIPMENT TABLE LAYOUT                                          11090028
109600*                                                                 11100028
109700     EXEC SQL                                                     11110028
109800         INCLUDE TSHIPMT                                          11120028
109900     END-EXEC.                                                    11130028
110000                                                                  11140028
110100 EJECT                                                            11150028
110200*                                                                 11160028
110300*  SHIPMENT STATUS TABLE LAYOUT                                   11170028
110400*                                                                 11180028
110500     EXEC SQL                                                     11190028
110600         INCLUDE TSHIPST                                          11200028
110700     END-EXEC.                                                    11210028
110800                                                                  11220028
110900 EJECT                                                            11230028
111000*                                                                 11240028
111100*  SHIPMENT/PO ASSOCIATION TABLE LAYOUT                           11250028
111200*                                                                 11260028
111300     EXEC SQL                                                     11270028
111400         INCLUDE TSHPTPO                                          11280028
111500     END-EXEC.                                                    11290028
111600                                                                  11300028
111700*                                                                 11310028
111800*  SHIPMENT/PO ASSOCIATION AUDIT TABLE LAYOUT                     11320028
111900*                                                                 11330028
112000     EXEC SQL                                                     11340028
112100         INCLUDE TAUSHPO                                          11350028
112200     END-EXEC.                                                    11360028
112300                                                                  11370028
112400 EJECT                                                            11380028
112500*                                                                 11390028
112600*  SHIPMENT VEHICLE TABLE LAYOUT                                  11400028
112700*                                                                 11410028
112800     EXEC SQL                                                     11420028
112900         INCLUDE TVEHICL                                          11430028
113000     END-EXEC.                                                    11440028
113100                                                                  11450028
113200 EJECT                                                            11460028
113300*                                                                 11470028
113400*  SHIPMENT VEHICLE TRIP TABLE LAYOUT                             11480028
113500*                                                                 11490028
113600     EXEC SQL                                                     11500028
113700         INCLUDE TVHTRIP                                          11510028
113800     END-EXEC.                                                    11520028
113900                                                                  11530028
114000 EJECT                                                            11540028
114100*                                                                 11550028
114200*  SHIPMENT VEHICLE TRIP STATUS TABLE LAYOUT                      11560028
114300*                                                                 11570028
114400     EXEC SQL                                                     11580028
114500         INCLUDE TTRIPST                                          11590028
114600     END-EXEC.                                                    11600028
114700                                                                  11610028
114800 EJECT                                                            11620028
114900*                                                                 11630028
115000*  TRIP STATUS TYPE TABLE LAYOUT                                  11640028
115100*                                                                 11650028
115200     EXEC SQL                                                     11660028
115300         INCLUDE TTRSTYP                                          11670028
115400     END-EXEC.                                                    11680028
115500                                                                  11690028
115600 EJECT                                                            11700028
115700*                                                                 11710028
115800*  PURCHASE ORDER DB2 TABLE LAYOUT                                11720028
115900*                                                                 11730028
116000     EXEC SQL                                                     11740028
116100         INCLUDE TPURCHS                                          11750028
116200     END-EXEC.                                                    11760028
116300                                                                  11770028
116400 EJECT                                                            11780028
116500*                                                                 11790028
116600*  VEHICLE AUDIT TRAIL TABLE LAYOUT                               11800028
116700*                                                                 11810028
116800     EXEC SQL                                                     11820028
116900         INCLUDE TAUVHCL                                          11830028
117000     END-EXEC.                                                    11840028
117100                                                                  11850028
117200 EJECT                                                            11860028
117300*                                                                 11870028
117400*  TRIP AUDIT TRAIL TABLE LAYOUT                                  11880028
117500*                                                                 11890028
117600     EXEC SQL                                                     11900028
117700         INCLUDE TAUTRIP                                          11910028
117800     END-EXEC.                                                    11920028
117900                                                                  11930028
118000 EJECT                                                            11940028
118100*                                                                 11950028
118200*  SHIPMENT AUDIT TRAIL TABLE LAYOUT                              11960028
118300*                                                                 11970028
118400     EXEC SQL                                                     11980028
118500         INCLUDE TAUSHIP                                          11990028
118600     END-EXEC.                                                    12000028
118700                                                                  12010028
118800 EJECT                                                            12020028
118900*                                                                 12030028
119000* DB2 COMMUNICATION AREA.                                         12040028
119100*                                                                 12050028
119200     EXEC SQL                                                     12060028
119300         INCLUDE SQLCA                                            12070028
119400     END-EXEC.                                                    12080028
119500                                                                  12090028
119600*                                                                 12100028
119700* DB2 COMMUNICATION AREA 2                                        12110028
119800*                                                                 12120028
119900     COPY SQLCA2.                                                 12130028
120000                                                                  12140028
120100***************************************************************** 12150028
120200 01  FILLER                           PIC X(08) VALUE 'END WS  '. 12160028
120300***************************************************************** 12170028
120400                                                                  12180028
120500 EJECT                                                            12190028
120600                                                                  12200028
120700***************************************************************** 12210028
120800 PROCEDURE DIVISION.                                              12220028
120900***************************************************************** 12230028
121000                                                                  12240028
121100***************************************************************** 12250028
121200*     MAINLINE                                                  * 12260028
121300*                                                               * 12270028
121400*   - MAINLINE PROCESSING                                       * 12280028
121500***************************************************************** 12290028
121600                                                                  12300028
121700 0000-MAINLINE.                                                   12310028
121800                                                                  12320028
121900     MOVE '0000-MAINLINE'        TO PV-CURRENT-PARA.              12330028
122000                                                                  12340028
122100     PERFORM 0100-PRE-PROCESSING.                                 12350028
122200                                                                  12360028
122300     PERFORM 1000-PROCESS-SHIPMENT-STATUS                         12370028
122400         UNTIL PS-END-OF-INP01.                                   12380028
122500                                                                  12390028
122600     IF PS-BYPASS-TRANS-SET                                       12400028
122700         SET PS-DONT-BYPASS-TRANS-SET                             12410028
122800                         TO TRUE                                  12420028
122900     END-IF.                                                      12430028
123000                                                                  12440028
123100     IF PS-EDI-NO-SHIPMT-MODE OR                                  12450028
123200        PS-N104-OPER-UNT-ID-NOT-FOUND OR                          12460028
123300        PS-BYPASS-UPDATES                                         12470028
123400            IF PS-EDI-NO-SHIPMT-MODE                              12480028
123500                 MOVE PC-030 TO PW-ERROR-NBR (PW-INDEX)           12490028
123600                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             12500028
123700            ELSE                                                  12510028
123800                IF PS-N104-OPER-UNT-ID-NOT-FOUND                  12520028
123900                     MOVE PC-016 TO PW-ERROR-NBR (PW-INDEX)       12530028
124000                     PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX         12540028
124100                END-IF                                            12550028
124200            END-IF                                                12560028
124300            IF PS-VEHICL-UPD-NOT-TRKUP004                         12570028
124400                 MOVE PC-033 TO PW-ERROR-NBR (PW-INDEX)           12580028
124500                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             12590028
124600            END-IF                                                12600028
124700            IF PS-SHSTYP-PRTY-ERR                                 12610028
124800                 MOVE PC-034 TO PW-ERROR-NBR (PW-INDEX)           12620028
124900                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             12630028
125000            END-IF                                                12640028
125100            IF PS-TRSTYP-PRTY-CD-GT-30                            12650028
125200                 MOVE PC-035 TO PW-ERROR-NBR (PW-INDEX)           12660028
125300                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             12670028
125400            END-IF                                                12680028
125500            IF PS-SHIP-REC-MORE-THAN-ZERO                         12690028
125600                 MOVE PC-036 TO PW-ERROR-NBR (PW-INDEX)           12700028
125700                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             12710028
125800            END-IF                                                12720028
125900            MOVE PC-031 TO PW-ERROR-NBR (PW-INDEX)                12730028
126000            PERFORM 8100-WRITE-REPORT-LINE                        12740028
126100                                                                  12750028
126200     ELSE                                                         12760028
126300         IF PS-EDIT-ERROR-DETECTED                                12770028
126400             PERFORM 8100-WRITE-REPORT-LINE                       12780028
126500             SET PS-NO-EDIT-ERROR-DETECTED                        12790028
126600                                     TO TRUE                      12800028
126700             PERFORM 1200-UPDATE-DATABASES                        12810028
126800         ELSE                                                     12820028
126900             PERFORM 1200-UPDATE-DATABASES                        12830028
127000         END-IF                                                   12840028
127100     END-IF.                                                      12850028
127200                                                                  12860028
127300     PERFORM 8000-PROCESS-TOTAL-LINES.                            12870028
127400                                                                  12880028
127500     CLOSE SHIPMENT-STATUS-FILE                                   12890028
127600           SHIPMENT-ERROR-FILE                                    12900028
127700           SHIPMENT-STATUS-REPORT.                                12910028
127800                                                                  12920028
127900     GOBACK.                                                      12930028
128000                                                                  12940028
128100 EJECT                                                            12950028
128200****************************************************************  12960028
128300*     PRE PROCESSING                                           *  12970028
128400*                                                              *  12980028
128500*   - OPEN FILES                                               *  12990028
128600*   - ACCEPT CURRENT DATE                                      *  13000028
128700*   - ACCEPT CURRENT TIME                                      *  13010028
128800*   - READ THE FIRST SHIPMENT-STATUS REC                       *  13020028
128900*   - CREATE HEADING LINES                                     *  13030028
129000****************************************************************  13040028
129100                                                                  13050028
129200 0100-PRE-PROCESSING.                                             13060028
129300                                                                  13070028
129400     MOVE '0100-PRE-PROCESSING'  TO PV-CURRENT-PARA.              13080028
129500                                                                  13090028
129600     OPEN INPUT  SHIPMENT-STATUS-FILE                             13100028
129700                 CONTROL-CARD-FILE                                13110028
129800          OUTPUT SHIPMENT-ERROR-FILE                              13120028
129900                 SHIPMENT-STATUS-REPORT.                          13130028
130000                                                                  13140028
130100     PERFORM 0200-ACCEPT-CURR-DATE-TIME.                          13150028
130200                                                                  13160028
130300     READ CONTROL-CARD-FILE                                       13170028
130400         INTO CC-CONTROL-CARD.                                    13180028
130500                                                                  13190028
130600     IF NOT CC-VALID-CONTROL-CARD                                 13200028
130700         MOVE 100                TO CC-COMMIT-NBR                 13210028
130800     END-IF.                                                      13220028
130900                                                                  13230028
131000     PERFORM 9000-READ-SHIPMENT-STATUS.                           13240028
131100                                                                  13250028
131200     IF PS-END-OF-INP01                                           13260028
131300         DISPLAY '** NO DATA TO PROCESS         **'               13270028
131400         DISPLAY '** PROGRAM = TRKUP004         **'               13280028
131500         DISPLAY '** SHIPMENT STATUS FILE EMPTY **'               13290028
131600     ELSE                                                         13300028
131700         IF TR001-ST-TRANS-SET-HDR-REC                            13310028
131800             ADD PC-1            TO PA-ST-READ                    13320028
131900             MOVE TR001-TRANS-SET-HDR-CNTL-NBR                    13330028
132000                                 TO PV-CNTL-NBR                   13340028
132100             SET PS-PRIOR-RECORD-NOT-READ                         13350028
132200                                 TO TRUE                          13360028
132300             MOVE TR001-SHIPT-STATUS-MSG-RECORD                   13370028
132400                                 TO PW-SHIPT-STATUS-RECORD        13380028
132500                                   (PW-TRANS-SET-SUB)             13390028
132600         ELSE                                                     13400028
132700             DISPLAY '** ABEND                            **'     13410028
132800             DISPLAY '** PROGRAM    = TRKUP004            **'     13420028
132900             DISPLAY '** PARAGRAPH  = 0100-PRE-PROCESSING **'     13430028
133000             DISPLAY '** INVALID RECORD SEQUENCING        **'     13440028
133100             DISPLAY '** FIRST SHIPMENT STATUS RECORD     **'     13450028
133200             DISPLAY '** IS NOT A TRANS-SET-HDR-REC       **'     13460028
133300             SET ABEND-4007-SEQUENCE-ERROR                        13470028
133400                                 TO TRUE                          13480028
133500             CALL 'ILBOABN0' USING ABEND-CODE                     13490028
133600         END-IF                                                   13500028
133700     END-IF.                                                      13510028
133800                                                                  13520028
133900     IF NOT PS-END-OF-INP01                                       13530028
134000         PERFORM 9000-READ-SHIPMENT-STATUS                        13540028
134100         IF TR001-B10-BEG-SEGMENT-REC                             13550028
134200             ADD PC-1            TO PA-B10-READ                   13560028
134300             PERFORM 1100-INITIALIZE                              13570028
134400             ADD PC-1            TO PW-TRANS-SET-SUB              13580028
134500             PERFORM 2000-SAVE-B10-DATA                           13590028
134600                                                                  13600028
134700             IF TR001-ST-TRANS-SET-HDR-REC OR                     13610028
134800                   PS-END-OF-INP01                                13620028
134900                 CONTINUE                                         13630028
135000             ELSE                                                 13640028
135100                 PERFORM 9000-READ-SHIPMENT-STATUS                13650028
135200             END-IF                                               13660028
135300         ELSE                                                     13670028
135400             DISPLAY '** ABEND                            **'     13680028
135500             DISPLAY '** PROGRAM    = TRKUP004            **'     13690028
135600             DISPLAY '** PARAGRAPH  = 0100-PRE-PROCESSING **'     13700028
135700             DISPLAY '** INVALID RECORD SEQUENCING        **'     13710028
135800             DISPLAY '** SECOND SHIPMENT STATUS RECORD    **'     13720028
135900             DISPLAY '** IS NOT A B10-BEG-SEGMENT-REC     **'     13730028
136000             SET ABEND-4007-SEQUENCE-ERROR                        13740028
136100                                 TO TRUE                          13750028
136200             CALL 'ILBOABN0' USING ABEND-CODE                     13760028
136300         END-IF                                                   13770028
136400     END-IF.                                                      13780028
136500                                                                  13790028
136600     PERFORM 9770-SELECT-TMST.                                    13800028
136700 EJECT                                                            13810028
136800***************************************************************** 13820028
136900*     ACCEPT-CURR-DATE-TIME                                     * 13830028
137000*                                                               * 13840028
137100***************************************************************** 13850028
137200                                                                  13860028
137300 0200-ACCEPT-CURR-DATE-TIME.                                      13870028
137400                                                                  13880028
137500     MOVE '0200-ACCEPT-CURR-DATE-TIME     '                       13890028
137600                                 TO PV-CURRENT-PARA.              13900028
137700                                                                  13910028
137800     ACCEPT CT-CPU-TIME FROM TIME.                                13920028
137900                                                                  13930028
138000     MOVE CT-CPU-TIME-HH         TO DP132O-RUN-HOUR.              13940028
138100     MOVE CT-CPU-TIME-MM         TO DP132O-RUN-MINUTE.            13950028
138200                                                                  13960028
138300     ACCEPT CD-CPU-DATE FROM DATE.                                13970028
138400                                                                  13980028
138500     MOVE CD-CPU-DATE-MM         TO DP132O-RUN-MONTH.             13990028
138600     MOVE CD-CPU-DATE-DD         TO DP132O-RUN-DAY.               14000028
138700     MOVE CD-CPU-DATE-YY         TO DP132O-RUN-YEAR.              14010028
138800     MOVE DP132O-RUN-DATE        TO H3-DATE.                      14020028
138900                                                                  14030028
139000 EJECT                                                            14040028
139100***************************************************************** 14050028
139200*     USING THE CURRENT DATE AND TIME, CALL THE RANDOM NUMBER   * 14060028
139300*     GENERATOR ROUTINE TO CALCULATE A NUMBER TO BE USED AS THE * 14070028
139400*     NEXT SHIPT ID ON INSERTS.  THE TRAILER KEY IS ALSO FIGURED* 14080028
139500*     IN THE SAME WAY.                                          * 14090028
139600***************************************************************** 14100028
139700                                                                  14110028
139800 0300-GET-RANDOM-NUMBER.                                          14120028
139900                                                                  14130028
140000     MOVE '0300-GET-RANDOM-NUMBER         '                       14140028
140100                                 TO PV-CURRENT-PARA.              14150028
140200                                                                  14160028
140600     CALL PC-RANDNBR-PGM USING DP902-RANDNBR-ROUTINE-FIELDS.      14200053
140600                                                                  14202053
140700                                                                  14210028
140800     IF DP902-SUCCESSFUL                                          14220051
140900         MOVE DP902-RANDOM-NUMBER                                 14230051
141000                                 TO PV-RANDOM-NBR                 14240028
141100     ELSE                                                         14250028
141200         MOVE ZEROS              TO PV-RANDOM-NBR                 14260028
141300         MOVE PC-027 TO PW-ERROR-NBR (PW-INDEX)                   14270028
141400         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     14280028
141500         SET PS-EDIT-ERROR-DETECTED                               14290028
141600                                 TO TRUE                          14300028
141700     END-IF.                                                      14310028
141800                                                                  14320028
141900 EJECT                                                            14330028
142000***************************************************************** 14340028
142100*     PROCESS SHIPMENT STATUS MESSAGE RECORDS                   * 14350028
142200*                                                               * 14360028
142300*     CONTROL THE PROCESSING OF THE SHIPMENT STATUS RECORDS.    * 14370028
142400*     THIS PROCESS WILL FORMAT AND INSERT/UPDATE THE SHIPMENT   * 14380028
142500*     STATUS RECORDS RECEIVED FROM A CARRIER INTO THE DB2       * 14390028
142600*     SHIPMENT TABLES.                                          * 14400028
142700*                                                               * 14410028
142800*     -  READ THE SHIPMENT STATUS MESSAGE FILE                  * 14420028
142900*     -  IF A BEGINNING SEGMENT RECORD IS FOUND, PROCESS        * 14430028
143000*        THE SHIPMENT STATUS MESSAGE.                           * 14440028
143100***************************************************************** 14450028
143200                                                                  14460028
143300 1000-PROCESS-SHIPMENT-STATUS.                                    14470028
143400                                                                  14480028
143500     MOVE '1000-PROCESS-SHIPMENT-STATUS   '                       14490028
143600                                 TO PV-CURRENT-PARA.              14500028
143700                                                                  14510028
143800     EVALUATE TRUE                                                14520028
143900                                                                  14530028
144000         WHEN TR001-ST-TRANS-SET-HDR-REC                          14540028
144100             ADD PC-1            TO PA-ST-READ                    14550028
144200                                                                  14560028
144300             IF PS-BYPASS-TRANS-SET                               14570028
144400                 SET PS-DONT-BYPASS-TRANS-SET                     14580028
144500                                 TO TRUE                          14590028
144600             END-IF                                               14600028
144700             IF PS-EDI-NO-SHIPMT-MODE OR                          14610028
144800                PS-N104-OPER-UNT-ID-NOT-FOUND OR                  14620028
144900                PS-BYPASS-UPDATES                                 14630028
145000                  IF PS-EDI-NO-SHIPMT-MODE                        14640028
145100                       MOVE PC-030 TO PW-ERROR-NBR (PW-INDEX)     14650028
145200                       PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX       14660028
145300                  ELSE                                            14670028
145400                      IF PS-N104-OPER-UNT-ID-NOT-FOUND            14680028
145500                           MOVE PC-016 TO PW-ERROR-NBR (PW-INDEX) 14690028
145600                           PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX   14700028
145700                      END-IF                                      14710028
145800                  END-IF                                          14720028
145900                  IF PS-VEHICL-UPD-NOT-TRKUP004                   14730028
146000                       MOVE PC-033 TO PW-ERROR-NBR (PW-INDEX)     14740028
146100                       PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX       14750028
146200                  END-IF                                          14760028
146300                  IF PS-SHSTYP-PRTY-ERR                           14770028
146400                       MOVE PC-034 TO PW-ERROR-NBR (PW-INDEX)     14780028
146500                       PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX       14790028
146600                  END-IF                                          14800028
146700                  IF PS-TRSTYP-PRTY-CD-GT-30                      14810028
146800                       MOVE PC-035 TO PW-ERROR-NBR (PW-INDEX)     14820028
146900                       PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX       14830028
147000                  END-IF                                          14840028
147100                  IF PS-SHIP-REC-MORE-THAN-ZERO                   14850028
147200                       MOVE PC-036 TO PW-ERROR-NBR (PW-INDEX)     14860028
147300                       PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX       14870028
147400                  END-IF                                          14880028
147500                  MOVE PC-031 TO PW-ERROR-NBR (PW-INDEX)          14890028
147600                  PERFORM 8100-WRITE-REPORT-LINE                  14900028
147700             ELSE                                                 14910028
147800                 IF PS-EDIT-ERROR-DETECTED                        14920028
147900                     PERFORM 8100-WRITE-REPORT-LINE               14930028
148000                     SET PS-NO-EDIT-ERROR-DETECTED                14940028
148100                                             TO TRUE              14950028
148200                     PERFORM 1200-UPDATE-DATABASES                14960028
148300                     MOVE SPACES TO PW-VHTRIP-EST-AR-TMST         14970028
148400                 ELSE                                             14980028
148500                     PERFORM 1200-UPDATE-DATABASES                14990028
148600                     MOVE SPACES TO PW-VHTRIP-EST-AR-TMST         15000028
148700                 END-IF                                           15010028
148800             END-IF                                               15020028
148900             PERFORM 1100-INITIALIZE                              15030028
149000             MOVE TR001-TRANS-SET-HDR-CNTL-NBR                    15040028
149100                                 TO PV-CNTL-NBR                   15050028
149200             MOVE TR001-SHIPT-STATUS-MSG-RECORD                   15060028
149300                                 TO PW-SHIPT-STATUS-RECORD        15070028
149400                                   (PW-TRANS-SET-SUB)             15080028
149500             ADD PC-1            TO PW-TRANS-SET-SUB              15090028
149600                                                                  15100028
149700         WHEN TR001-B10-BEG-SEGMENT-REC                           15110028
149800             ADD PC-1            TO PA-B10-READ                   15120028
149900             IF PS-PRIOR-ST-TRANS-SET-HDR-REC                     15130028
150000                 MOVE TR001-B1003-CARR-SCAC TO PV-CARR-SCAC       15140028
150100                 SET PS-NOT-LSD-CARR TO TRUE                      15150028
150200                 PERFORM 7600-VERIFY-LSD-CARR-SCAC                15160028
150300                 PERFORM 2000-SAVE-B10-DATA                       15170028
150400             ELSE                                                 15180028
150500                 MOVE PC-014 TO PW-ERROR-NBR (PW-INDEX)           15190028
150600                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             15200028
150700                 SET PS-BYPASS-TRANS-SET                          15210028
150800                     PS-EDIT-ERROR-DETECTED                       15220028
150900                                 TO TRUE                          15230028
151000                 PERFORM 6000-BYPASS-TRANS-SET                    15240028
151100                     UNTIL TR001-ST-TRANS-SET-HDR-REC OR          15250028
151200                           PS-END-OF-INP01                        15260028
151300             END-IF                                               15270028
151400                                                                  15280028
151500         WHEN TR001-N1-NAME-REC                                   15290028
151600              PERFORM 2100-SAVE-N1-DATA                           15300028
151700                                                                  15310028
151800         WHEN TR001-N9-REF-NBR-REC                                15320028
151900*MAM         IF PW-SHPTPO-SUB > PC-40                             15330028
152000             IF PW-SHPTPO-SUB = PC-40                             15340028
152100                 MOVE PC-025 TO PW-ERROR-NBR (PW-INDEX)           15350028
152200                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             15360028
152300                 SET PS-BYPASS-TRANS-SET                          15370028
152400                                 TO TRUE                          15380028
152500                 PERFORM 6000-BYPASS-TRANS-SET                    15390028
152600                     UNTIL TR001-ST-TRANS-SET-HDR-REC OR          15400028
152700                           PS-END-OF-INP01                        15410028
152800             ELSE                                                 15420028
152900                 PERFORM 2200-SAVE-N9-DATA                        15430028
153000             END-IF                                               15440028
153100                                                                  15450028
153200         WHEN TR001-Q5-STATUS-DTL-REC                             15460028
153300             IF PW-SHIPST-SUB > PC-20                             15470028
153400             OR PW-TRIPST-SUB > PC-20                             15480028
153500                 MOVE PC-009 TO PW-ERROR-NBR (PW-INDEX)           15490028
153600                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             15500028
153700                 SET PS-BYPASS-TRANS-SET                          15510028
153800                                 TO TRUE                          15520028
153900             ELSE                                                 15530028
154000                 PERFORM 2300-SAVE-Q5-DATA                        15540028
154100             END-IF                                               15550028
154200                                                                  15560028
154300         WHEN TR001-Q6-SHIPT-DTL-REC                              15570028
154400             PERFORM 2400-SAVE-Q6-DATA                            15580028
154500                                                                  15590028
154600         WHEN TR001-SE-TRANS-SET-TRL-REC                          15600028
154700             PERFORM 2500-CHECK-SE-DATA                           15610028
154800                                                                  15620028
154900         WHEN OTHER                                               15630028
155000             MOVE PC-010 TO PW-ERROR-NBR (PW-INDEX)               15640028
155100             PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                 15650028
155200             SET PS-BYPASS-TRANS-SET                              15660028
155300                                 TO TRUE                          15670028
155400                                                                  15680028
155500     END-EVALUATE.                                                15690028
155600                                                                  15700028
155700                                                                  15710028
155800     IF PS-BYPASS-TRANS-SET                                       15720028
155900         PERFORM 6000-BYPASS-TRANS-SET                            15730028
156000             UNTIL TR001-ST-TRANS-SET-HDR-REC OR                  15740028
156100                   PS-END-OF-INP01                                15750028
156200     ELSE                                                         15760028
156300     IF PW-TRANS-SET-SUB > PC-253                                 15770028
156400         MOVE PC-015 TO PW-ERROR-NBR (PW-INDEX)                   15780028
156500         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     15790028
156600         SET PS-BYPASS-TRANS-SET                                  15800028
156700                                 TO TRUE                          15810028
156800                                                                  15820028
156900         PERFORM 6000-BYPASS-TRANS-SET                            15830028
157000             UNTIL TR001-ST-TRANS-SET-HDR-REC OR                  15840028
157100                   PS-END-OF-INP01                                15850028
157200     END-IF.                                                      15860028
157300                                                                  15870028
157400     IF PS-BYPASS-TRANS-SET                                       15880028
157500         CONTINUE                                                 15890028
157600     ELSE                                                         15900028
157700         PERFORM 9000-READ-SHIPMENT-STATUS                        15910028
157800     END-IF.                                                      15920028
157900                                                                  15930028
158000     IF NOT PS-END-OF-INP01                                       15940028
158100         IF PS-PRIOR-ST-TRANS-SET-HDR-REC                         15950028
158200             IF NOT TR001-B10-BEG-SEGMENT-REC                     15960028
158300                 MOVE PC-002 TO PW-ERROR-NBR (PW-INDEX)           15970028
158400                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             15980028
158500                 SET PS-BYPASS-TRANS-SET                          15990028
158600                                 TO TRUE                          16000028
158700                                                                  16010028
158800                 PERFORM 6000-BYPASS-TRANS-SET                    16020028
158900                     UNTIL TR001-ST-TRANS-SET-HDR-REC OR          16030028
159000                           PS-END-OF-INP01                        16040028
159100             END-IF                                               16050028
159200         END-IF                                                   16060028
159300     END-IF.                                                      16070028
159400                                                                  16080028
159500 EJECT                                                            16090028
159600****************************************************************  16100028
159700*     INITIALIZATION                                           *  16110028
159800*                                                              *  16120028
159900*     -  INITIALIZE SWITCHES                                   *  16130028
160000*     -  INITIALIZE WS TRANSACTION HOLD AREAS                  *  16140028
160100****************************************************************  16150028
160200                                                                  16160028
160300 1100-INITIALIZE.                                                 16170028
160400                                                                  16180028
160500     MOVE '1100-INITIALIZE'      TO PV-CURRENT-PARA.              16190028
160600                                                                  16200028
160700     INITIALIZE PV-NULLS-TABLE.                                   16210028
160800     INITIALIZE PW-SHIPMT-RECORD.                                 16220028
160900     INITIALIZE PW-SHIPST-RECORD.                                 16230028
161000     INITIALIZE PW-SHPTPO-RECORD.                                 16240028
161100     INITIALIZE PW-TRIPST-RECORD.                                 16250028
161200     INITIALIZE PW-VEHICL-RECORD.                                 16260028
161300     INITIALIZE PW-VHTRIP-RECORD.                                 16270028
161400     INITIALIZE PW-ERROR-TABLE.                                   16280028
161500     INITIALIZE PW-INDEX.                                         16290028
161600     INITIALIZE PV-SCAC-ID.                                       16300028
161700     INITIALIZE PV-INVALID-DELY-SCAC.                             16310028
161800     INITIALIZE PS-UPDATE-SHIPMT-SW                               16320028
161900                PS-UPDATE-SHIPST-SW                               16330028
162000                PS-UPDATE-VEHICL-SW                               16340028
162100                PS-UPDATE-VHTRIP-SW                               16350028
162200                PS-UPDATE-TRIPST-SW                               16360028
162300                PS-VALID-OPER-UNT-ID-SW                           16370028
162400                PS-VALID-VENDOR-SW                                16380028
162500                PS-VALID-PO-SW                                    16390028
162600                PS-VALID-SHIPT-STATUS-SW                          16400028
162700                PS-VALID-PKG-TYP-CDE-SW                           16410028
162800                PS-TVHTRIP-VALID-TIMESTMP-SW                      16420028
162900                PS-EDI-SHIPMT-SW                                  16430028
163000                PS-VHTRIP-VEH-CHANGED-SW                          16440028
163100                PS-VHTRIP-SCAC-CHANGED-SW                         16450028
163200                PS-END-OF-ERRORS-SW                               16460028
163300                PS-END-OF-PO-NBRS-SW                              16470028
163400                PS-PC-038-ERROR-SW                                16480028
163500                PS-BOL-AND-PRO-SW                                 16490028
163600                PS-EDIT-ERROR-SW                                  16500028
163700                PS-EDIT-EXCEED-WRITTEN-SW.                        16510028
163800     SET PS-PROCESS-UPDATES                                       16520028
163900         PS-SHIP-REC-EQUAL-ZERO                                   16530028
164000         PS-TRSTYP-PRTY-CD-LE-30                                  16540028
164100         PS-SHSTYP-NOT-PRTY-ERR                                   16550028
164200         PS-VEHICL-UPD-TRKUP004 TO TRUE.                          16560028
164300                                                                  16570028
164400     MOVE SPACES TO PW-SAVE-LSD-CARR-ID.                          16580028
164500                                                                  16590028
164600     SET PS-TVHTRIP-NO-TIMESTMP  TO TRUE.                         16600028
164700     MOVE PC-1                   TO PW-SHIPST-SUB.                16610028
164800     MOVE PC-1                   TO PW-TRIPST-SUB.                16620028
164900     MOVE PC-1                   TO PW-SHPTPO-SUB.                16630028
165000     MOVE PC-1                   TO PW-SAVE-SHPTPO-SUB.           16640028
165100     MOVE PC-1                   TO PW-TRANS-SET-SUB.             16650028
165200     MOVE PC-1                   TO PW-INDEX.                     16660028
165300                                                                  16670028
165400     SET PS-N104-OPER-UNT-ID-NOT-FOUND                            16680028
165500                                 TO TRUE.                         16690028
165600     SET PS-BYPASS-VEHICL        TO TRUE.                         16700028
165700                                                                  16710028
165800 EJECT                                                            16720028
165900***************************************************************** 16730028
166000*     UPDATE DATABASES                                          * 16740028
166100*                                                               * 16750028
166200*     -  THIS PROCESS WILL PERFORM THE INSERTS OR UPDATES TO    * 16760028
166300*        THE DB2 SHIPMENT TABLES.                               * 16770028
166400***************************************************************** 16780028
166500                                                                  16790028
166600 1200-UPDATE-DATABASES.                                           16800028
166700                                                                  16810028
166800     MOVE '1200-UPDATE-DATABASES             '                    16820028
166900                                 TO PV-CURRENT-PARA.              16830028
167000                                                                  16840028
167100     IF PS-INSERT-VHTRIP OR                                       16850028
167200        PS-ADD-NEXT-VHTRIP                                        16860028
167300         PERFORM WITH TEST AFTER                                  16870028
167400             UNTIL SQLCODE = +100                                 16880028
167500             PERFORM 0300-GET-RANDOM-NUMBER                       16890028
167600             PERFORM 7775-CHECK-IF-TRIP-ID-USED                   16900028
167700         END-PERFORM                                              16910028
167800         MOVE PV-RANDOM-NBR      TO PW-VEHICL-CURR-TRIP-ID        16920028
167900                                    PW-VHTRIP-TRIP-ID             16930028
168000                                    PW-TRIPST-TRIP-ID             16940028
168100                                    PW-SHIPMT-TRIP-ID             16950028
168200     END-IF.                                                      16960028
168300     IF PW-VEHICL-CURR-TRIP-ID = ZERO                             16970028
168400         MOVE PW-SHIPMT-TRIP-ID  TO PW-VEHICL-CURR-TRIP-ID        16980028
168500         DISPLAY                                                  16990028
168600        'MOVE PW-SHIPMT-TRIP-ID  TO PW-VEHICL-CURR-TRIP-ID'       17000028
168700     END-IF.                                                      17010028
168800                                                                  17020028
168900     IF PS-INSERT-VEHICL                                          17030028
169000         PERFORM 8850-INSERT-VEHICL                               17040028
169100         PERFORM 7700-SELECT-VEHICL                               17050028
169200         IF SQLCODE = +0                                          17060028
169300             PERFORM 7950-CREATE-VEH-AUDIT-TRAIL                  17070028
169400         END-IF                                                   17080028
169500     END-IF.                                                      17090028
169600                                                                  17100028
169700     IF PS-INSERT-VHTRIP                                          17110028
169800         MOVE PW-VHTRIP-TRIP-ID TO PW-VHTRIP-REF-TRIP-ID          17120028
169900         PERFORM 8450-SET-NULLS-VHTRIP                            17130028
170000         PERFORM 8700-INSERT-VHTRIP                               17140028
170100         MOVE PW-VHTRIP-TRIP-ID  TO VHTRIP-TRIP-ID                17150028
170200         PERFORM 7750-SELECT-VHTRIP                               17160028
170300         IF SQLCODE = 0                                           17170028
170400             PERFORM 7900-CREATE-TRIP-AUDIT-TRAIL                 17180028
170500         END-IF                                                   17190028
170600     END-IF.                                                      17200028
170700                                                                  17210028
170800*   ADD ANOTHER TRIP TO THIS VEHICL                               17220028
170900     IF PS-ADD-NEXT-VHTRIP                                        17230028
171000         MOVE VHTRIP-REF-TRIP-ID TO PW-VHTRIP-REF-TRIP-ID         17240028
171100         PERFORM 8450-SET-NULLS-VHTRIP                            17250028
171200         PERFORM 8700-INSERT-VHTRIP                               17260028
171300         MOVE PW-VHTRIP-TRIP-ID  TO VHTRIP-TRIP-ID                17270028
171400         PERFORM 7750-SELECT-VHTRIP                               17280028
171500         IF SQLCODE = 0                                           17290028
171600             PERFORM 7900-CREATE-TRIP-AUDIT-TRAIL                 17300028
171700         END-IF                                                   17310028
171800     END-IF.                                                      17320028
171900                                                                  17330028
172000     IF PS-UPDATE-VEHICL                                          17340028
172100         PERFORM 8800-UPDATE-VEHICL                               17350028
172200         PERFORM 7700-SELECT-VEHICL                               17360028
172300         IF SQLCODE = +0                                          17370028
172400             PERFORM 7950-CREATE-VEH-AUDIT-TRAIL                  17380028
172500         END-IF                                                   17390028
172600         MOVE VEHICL-CURR-TRIP-ID TO PW-TRIPST-TRIP-ID            17400028
172700     END-IF.                                                      17410028
172800                                                                  17420028
172900     IF PS-UPDATE-VHTRIP                                          17430028
173000         PERFORM 8450-SET-NULLS-VHTRIP                            17440028
173100         PERFORM 8600-UPDATE-VHTRIP                               17450028
173200         PERFORM 7750-SELECT-VHTRIP                               17460028
173300         IF SQLCODE = 0                                           17470028
173400             PERFORM 7900-CREATE-TRIP-AUDIT-TRAIL                 17480028
173500         END-IF                                                   17490028
173600         MOVE PW-VHTRIP-TRIP-ID  TO PW-TRIPST-TRIP-ID             17500028
173700     END-IF.                                                      17510028
173800                                                                  17520028
173900     IF PS-DONT-UPDATE-VHTRIP                                     17530028
174000         CONTINUE                                                 17540028
174100     ELSE                                                         17550028
174200         PERFORM 8900-PROCESS-TRIPST                              17560028
174300             VARYING PW-SUB FROM 1 BY 1                           17570028
174400             UNTIL PW-SUB = PW-TRIPST-SUB                         17580028
174500     END-IF.                                                      17590028
174600                                                                  17600028
174700     IF PS-INSERT-SHIPMT                                          17610028
174800         PERFORM 1300-VERIFY-ALL-DATA-PRESENT                     17620028
174900     END-IF.                                                      17630028
175000                                                                  17640028
175100     IF PS-UPDATE-SHIPMT                                          17650028
175200         IF PW-SHPTPO-PO-NBR (1) > SPACES                         17660028
175300             PERFORM 9350-SELECT-VENDOR-NAME                      17670028
175400         END-IF                                                   17680028
175500         PERFORM 8400-SET-NULLS-SHIPMT                            17690028
175600         IF PW-SHIPMT-EST-AR-TMST = SPACES OR LOW-VALUES          17700028
175700             IF PW-VHTRIP-EST-AR-TMST = SPACES                    17710028
175800                 MOVE PC-NEG-1 TO PV-SHIPMT-EST-AR-NULL           17720028
175900                 MOVE SPACES         TO PW-SHIPMT-EST-AR-TMST     17730028
176000             ELSE                                                 17740028
176100                 MOVE PW-VHTRIP-EST-AR-TMST                       17750028
176200                                     TO PW-SHIPMT-EST-AR-TMST     17760028
176300                 MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL           17770028
176400             END-IF                                               17780028
176500         ELSE                                                     17790028
176600             IF PW-VHTRIP-EST-AR-TMST > PW-SHIPMT-EST-AR-TMST     17800028
176700                 MOVE PW-VHTRIP-EST-AR-TMST                       17810028
176800                                 TO PW-SHIPMT-EST-AR-TMST         17820028
176900                 MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL           17830028
177000             ELSE                                                 17840028
177100                 MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL           17850028
177200             END-IF                                               17860028
177300         END-IF                                                   17870028
177400         IF PV-SCAC-ID NOT = SPACES                               17880028
177500             MOVE PV-SCAC-ID TO PW-SHIPMT-PRO-SCAC-ID             17890028
177600         ELSE                                                     17900028
177700             MOVE PW-SHIPMT-PRO-SCAC-ID TO   PV-SCAC-ID           17910028
177800         END-IF                                                   17920028
177900         MOVE PW-SHIPST-VEH-NBR (1)  TO PW-SHIPMT-VEH-NBR         17930028
178000         PERFORM 9100-UPDATE-SHIPMT                               17940028
178100         PERFORM 7000-SELECT-SHIPMT                               17950028
178200         IF SQLCODE = +0                                          17960028
178300             PERFORM 7800-CREATE-SHIPMT-AUDIT-TRAIL               17970028
178400         END-IF                                                   17980028
178500         IF PW-SAVE-SHIPMT-TRIP-ID NOT = PW-SHIPMT-TRIP-ID        17990028
178600             PERFORM 9150-DELETE-VHTRIP                           18000028
178700         END-IF                                                   18010028
178800                                                                  18020028
178900         PERFORM 9300-INSERT-SHPTPO                               18030028
179000             VARYING PW-SUB FROM 1 BY 1                           18040028
179100             UNTIL PW-SUB = PW-SHPTPO-SUB                         18050028
179200                                                                  18060028
179300         PERFORM 9375-PROCESS-SHIPST                              18070028
179400             VARYING PW-SUB FROM 1 BY 1                           18080028
179500             UNTIL PW-SUB = PW-SHIPST-SUB                         18090028
179600                                                                  18100028
179700     END-IF.                                                      18110028
179800                                                                  18120028
179900     IF PS-DONT-UPDATE-SHIPMT                                     18130028
180000         PERFORM 9300-INSERT-SHPTPO                               18140028
180100             VARYING PW-SUB FROM 1 BY 1                           18150028
180200             UNTIL PW-SUB = PW-SHPTPO-SUB                         18160028
180300                                                                  18170028
180400         PERFORM 9375-PROCESS-SHIPST                              18180028
180500             VARYING PW-SUB FROM 1 BY 1                           18190028
180600             UNTIL PW-SUB = PW-SHIPST-SUB                         18200028
180700     END-IF.                                                      18210028
180800                                                                  18220028
180900     IF PS-VHTRIP-SCAC-CHANGED OR                                 18230028
181000        PS-VHTRIP-VEH-CHANGED                                     18240028
181100         IF PW-SAVE-VHTRIP-VEH-NBR > SPACES                       18250028
181200             PERFORM 8870-DELETE-VEHICL                           18260028
181300         END-IF                                                   18270028
181400     END-IF.                                                      18280028
181500                                                                  18290028
181600                                                                  18300028
181700     EXEC SQL                                                     18310028
181800        SET :PV-TMST = CURRENT TIMESTAMP                          18320028
181900     END-EXEC.                                                    18330028
182000     IF SQLCODE = +0                                              18340028
182100         IF PV-TMST > PV-HOLD-TMST                                18350028
182200             PERFORM 9750-COMMIT-RECORDS                          18360028
182300             PERFORM 9770-SELECT-TMST                             18370028
182400         END-IF                                                   18380028
182500     END-IF.                                                      18390028
182600                                                                  18400028
182700 EJECT                                                            18410028
182800***************************************************************** 18420028
182900*     PERFORM INSERT IF ALL REQUIRED DATA IS PRESENT.           * 18430028
183000*                                                               * 18440028
183100*     -  BECAUSE OF THE FOREIGN KEY RELATIONSHIPS, PKG_TYP_CDE, * 18450028
183200*        CARR_VEND_ID AND OPER_UNT-ID MUST BE FILLED IN ON AN   * 18460028
183300*        INSERT.                                                * 18470028
183400***************************************************************** 18480028
183500                                                                  18490028
183600 1300-VERIFY-ALL-DATA-PRESENT.                                    18500028
183700                                                                  18510028
183800     MOVE '1300-VERIFY-ALL-DATA-PRESENT      '                    18520028
183900                                 TO PV-CURRENT-PARA.              18530028
184000                                                                  18540028
184100     IF PW-SHIPMT-PKG-TYP-CDE = SPACES                            18550028
184200         MOVE PC-DEFAULT-PKG-CTN TO PW-SHIPMT-PKG-TYP-CDE         18560028
184300     END-IF.                                                      18570028
184400                                                                  18580028
184500     IF PS-N104-OPER-UNT-ID-NOT-FOUND                             18590028
184600         PERFORM 6100-ERROR-IN-TRANS-SET                          18600028
184700           VARYING PW-TRANS-SET-SUB                               18610028
184800              FROM 1 BY 1                                         18620028
184900             UNTIL PW-TRANS-SET-SUB > PC-253                      18630028
185000                OR PW-SHIPT-STATUS-RECORD                         18640028
185100                  (PW-TRANS-SET-SUB) = SPACES                     18650028
185200                                                                  18660028
185300         MOVE PC-016 TO PW-ERROR-NBR (PW-INDEX)                   18670028
185400         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     18680028
185500         SET PS-BYPASS-TRANS-SET                                  18690028
185600                                 TO TRUE                          18700028
185700     ELSE                                                         18710028
185800         IF PW-SHPTPO-PO-NBR (1) > SPACES                         18720028
185900             PERFORM 9350-SELECT-VENDOR-NAME                      18730028
186000         END-IF                                                   18740028
186100         PERFORM 8400-SET-NULLS-SHIPMT                            18750028
186200         IF PW-VHTRIP-EST-AR-TMST = SPACES                        18760028
186300             MOVE PC-NEG-1 TO PV-SHIPMT-EST-AR-NULL               18770028
186400             MOVE SPACES         TO PW-SHIPMT-EST-AR-TMST         18780028
186500         ELSE                                                     18790028
186600             MOVE PW-VHTRIP-EST-AR-TMST                           18800028
186700                                 TO PW-SHIPMT-EST-AR-TMST         18810028
186800             MOVE PC-POS-1 TO PV-SHIPMT-EST-AR-NULL               18820028
186900         END-IF                                                   18830028
187000                                                                  18840028
187100         IF PV-SCAC-ID NOT = SPACES                               18850028
187200             MOVE PV-SCAC-ID TO PW-SHIPMT-PRO-SCAC-ID             18860028
187300         ELSE                                                     18870028
187400             MOVE PW-SHIPMT-PRO-SCAC-ID TO   PV-SCAC-ID           18880028
187500         END-IF                                                   18890028
187600         MOVE PW-SHIPST-VEH-NBR (1)  TO PW-SHIPMT-VEH-NBR         18900028
187700         PERFORM 9200-INSERT-SHIPMT                               18910028
187800         PERFORM 7000-SELECT-SHIPMT                               18920028
187900         IF SQLCODE = +0                                          18930028
188000             PERFORM 7800-CREATE-SHIPMT-AUDIT-TRAIL               18940028
188100         END-IF                                                   18950028
188200                                                                  18960028
188300         PERFORM 9300-INSERT-SHPTPO                               18970028
188400             VARYING PW-SUB FROM 1 BY 1                           18980028
188500             UNTIL PW-SUB = PW-SHPTPO-SUB                         18990028
188600                                                                  19000028
188700         PERFORM 9375-PROCESS-SHIPST                              19010028
188800             VARYING PW-SUB FROM 1 BY 1                           19020028
188900             UNTIL PW-SUB = PW-SHIPST-SUB                         19030028
189000                                                                  19040028
189100         MOVE PW-SHIPMT-SHIPT-ID TO MSG-04-SHIPT-ID               19050028
189200         MOVE PW-SHIPMT-BOL-NBR  TO MSG-04-BOL-NBR                19060028
189300         MOVE PW-SHIPMT-PRO-NBR  TO MSG-04-PRO-NBR                19070028
189400     END-IF.                                                      19080028
189500                                                                  19090028
189600 EJECT                                                            19100028
189700***************************************************************** 19110028
189800*     SAVE B10 FIELDS                                           * 19120028
189900*                                                               * 19130028
190000*     -  SAVE B10 LEVEL FIELDS IN SHIPMT RECORD IN WS           * 19140028
190100***************************************************************** 19150028
190200                                                                  19160028
190300 2000-SAVE-B10-DATA.                                              19170028
190400                                                                  19180028
190500     MOVE '2000-SAVE-B10-DATA'   TO PV-CURRENT-PARA.              19190028
190600                                                                  19200028
190700     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           19210028
190800                                 TO PW-SHIPT-STATUS-RECORD        19220028
190900                                   (PW-TRANS-SET-SUB).            19230028
191000     ADD PC-1                    TO PW-TRANS-SET-SUB.             19240028
191100                                                                  19250028
191200     IF TR001-B1003-CARR-SCAC > SPACES                            19260028
191300         MOVE TR001-B1003-CARR-SCAC TO PV-CARR-SCAC               19270028
191400         SET PS-NOT-LSD-CARR TO TRUE                              19280028
191500         PERFORM 7600-VERIFY-LSD-CARR-SCAC                        19290028
191600     END-IF.                                                      19300028
191700     MOVE TR001-B1001-PRO-NBR    TO RC023-FREIGHT-BILL            19310028
191800                                    PW-SV-SHIPMT-COMP-PRO         19320028
191900                                    PW-SHIPMT-COMP-PRO.           19330028
192000     MOVE TR001-B1002-BOL-NBR    TO RC023-BILL-OF-LADING          19340028
192100                                    PW-SV-SHIPMT-COMP-BOL         19350028
192200                                    PW-SHIPMT-COMP-BOL.           19360031
192300     CALL RC023-FB-BOL-VEH-FORMAT USING RC023-FORMAT-DATA-AREA.   19370028
192400     MOVE RC023-FREIGHT-BILL     TO PW-SHIPMT-PRO-NBR.            19380028
192500     MOVE RC023-BILL-OF-LADING   TO PW-SHIPMT-BOL-NBR.            19390028
192600                                                                  19400028
192700     IF PW-SHIPMT-PRO-NBR = SPACES AND PW-SHIPMT-BOL-NBR = SPACES 19410028
192800       SET PS-BYPASS-UPDATES                                      19420028
192900           PS-NO-BOL-AND-PRO    TO TRUE                           19430028
193000       MOVE PC-039              TO PW-ERROR-NBR (PW-INDEX)        19440028
193100       PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                       19450028
193200     ELSE                                                         19460028
193300       SET PS-A-BOL-OR-PRO      TO TRUE.                          19470028
193400                                                                  19480028
193500     IF PS-VALID-VENDOR                                           19490028
193600         MOVE TR001-B1003-CARR-SCAC                               19500028
193700                                    TO PW-SHIPMT-PRO-SCAC-ID      19510028
193800                                       PW-SAVE-CARR-SCAC          19520028
193900                                       PW-SHIPMT-ORIGIN-SCAC-ID   19530028
194000                                       PV-SCAC-ID                 19540028
194100         SET PS-NO-DUPLICATE-SHIPMT TO TRUE                       19550028
194200         IF PS-A-BOL-OR-PRO                                       19560028
194300             PERFORM 6230-CHECK-IF-SHIPMT-EXISTS                  19570028
194400             IF PS-INSERT-SHIPMT                                  19580028
194500                 PERFORM WITH TEST AFTER                          19590028
194600                     UNTIL SQLCODE = +100                         19600028
194700                     PERFORM 0300-GET-RANDOM-NUMBER               19610028
194800                     PERFORM 7100-CHECK-IF-SHIPT-ID-USED          19620028
194900                 END-PERFORM                                      19630028
195000                 MOVE PV-RANDOM-NBR  TO PW-SHIPMT-SHIPT-ID        19640028
195100                                        PW-SHIPST-SHIPT-ID        19650028
195200                                        PW-SHPTPO-SHIPT-ID        19660028
195300             ELSE                                                 19670028
195400                 MOVE PW-SHIPMT-SHIPT-ID                          19680028
195500                                     TO PW-SHIPST-SHIPT-ID        19690028
195600                                        PW-SHPTPO-SHIPT-ID        19700028
195700             END-IF                                               19710028
195800         END-IF                                                   19720028
195900     ELSE                                                         19730028
196000         MOVE TR001-B1003-CARR-SCAC                               19740028
196100                                 TO PW-SHIPMT-ORIGIN-SCAC-ID      19750028
196200         MOVE ZEROS              TO PW-SHIPMT-SHIPT-ID            19760028
196300         SET PS-EDI-NO-SHIPMT-MODE                                19770028
196400                                 TO TRUE                          19780028
196500     END-IF.                                                      19790028
196600                                                                  19800028
196700     MOVE PW-SHIPMT-SHIPT-ID     TO MSG-01-SHIPT-ID.              19810028
196800     MOVE PW-SHIPMT-BOL-NBR      TO MSG-01-BOL-NBR.               19820028
196900     MOVE PW-SHIPMT-PRO-NBR      TO MSG-01-PRO-NBR.               19830028
197000                                                                  19840028
197100     IF PS-INVALID-VENDOR                                         19850028
197200         SET PS-BYPASS-TRANS-SET TO TRUE                          19860028
197300         PERFORM 6100-ERROR-IN-TRANS-SET                          19870028
197400           VARYING PW-TRANS-SET-SUB                               19880028
197500              FROM 1 BY 1                                         19890028
197600             UNTIL PW-TRANS-SET-SUB > PC-253                      19900028
197700                OR PW-SHIPT-STATUS-RECORD                         19910028
197800                  (PW-TRANS-SET-SUB) = SPACES                     19920028
197900                                                                  19930028
198000         PERFORM 6000-BYPASS-TRANS-SET                            19940028
198100             UNTIL TR001-ST-TRANS-SET-HDR-REC OR                  19950028
198200                   PS-END-OF-INP01                                19960028
198300                                                                  19970028
198400         MOVE PC-018 TO PW-ERROR-NBR (PW-INDEX)                   19980028
198500         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     19990028
198600         SET PS-EDIT-ERROR-DETECTED                               20000028
198700                                 TO TRUE                          20010028
198800     END-IF.                                                      20020028
198900                                                                  20030028
199000 EJECT                                                            20040028
199100***************************************************************** 20050028
199200*     SAVE N1 FIELDS                                            * 20060028
199300*                                                               * 20070028
199400*     -  SAVE N1 LEVEL FIELDS IN SHIPMT RECORD IN WS            * 20080028
199500***************************************************************** 20090028
199600                                                                  20100028
199700 2100-SAVE-N1-DATA.                                               20110028
199800                                                                  20120028
199900     MOVE '2100-SAVE-N1-DATA'    TO PV-CURRENT-PARA.              20130028
200000                                                                  20140028
200100     ADD PC-1                    TO PA-N1-READ.                   20150028
200200                                                                  20160028
200300     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           20170028
200400                                 TO PW-SHIPT-STATUS-RECORD        20180028
200500                                   (PW-TRANS-SET-SUB).            20190028
200600     ADD PC-1                    TO PW-TRANS-SET-SUB.             20200028
200700                                                                  20210028
200800     IF TR001-N101-ID-CDE-SH                                      20220028
200900         MOVE TR001-N102-SHIPR-NAME                               20230028
201000                                 TO PW-SHIPMT-SHIPPER-NME         20240028
201100     ELSE                                                         20250028
201200         IF TR001-N101-ID-CDE-ST   AND                            20260028
201300            TR001-N103-ID-QUAL-94                                 20270028
201400             PERFORM 7200-VERIFY-OPER-UNT-ID                      20280028
201500             IF PS-VALID-OPER-UNT-ID                              20290028
201600                 MOVE PV-OPER-UNT-ID                              20300028
201700                                 TO PW-VEHICL-CURR-OPER-UNT-ID    20310028
201800                                    PW-TRIPST-OPER-UNT-ID         20320028
201900                 MOVE PV-FCLTY-ID                                 20330028
202000                                 TO PW-VEHICL-CURR-FCLTY-ID       20340028
202100                                    PW-TRIPST-FCLTY-ID            20350028
202200                 SET PS-N104-OPER-UNT-ID-FOUND                    20360028
202300                                 TO TRUE                          20370028
202400             ELSE                                                 20380028
202500                 MOVE PC-011 TO PW-ERROR-NBR (PW-INDEX)           20390028
202600                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             20400028
202700                 SET PS-EDIT-ERROR-DETECTED                       20410028
202800                                 TO TRUE                          20420028
202900                 MOVE TR001-N104-OPER-UNT-ID (1:8)                20430028
203000                                 TO PV-SAVE-OPER                  20440028
203100             END-IF                                               20450028
203200         END-IF                                                   20460028
203300     END-IF.                                                      20470028
203400                                                                  20480028
203500                                                                  20490028
203600 EJECT                                                            20500028
203700***************************************************************** 20510028
203800*     SAVE N9 FIELDS                                            * 20520028
203900*                                                               * 20530028
204000*     -  SAVE N9 LEVEL FIELDS IN SHIPMT, SHPTPO AND VEHICL      * 20540028
204100*        RECORDS IN WORKING STORAGE.                            * 20550028
204200***************************************************************** 20560028
204300                                                                  20570028
204400 2200-SAVE-N9-DATA.                                               20580028
204500                                                                  20590028
204600     MOVE '2200-SAVE-N9-DATA'    TO PV-CURRENT-PARA.              20600028
204700                                                                  20610028
204800     ADD PC-1                    TO PA-N9-READ.                   20620028
204900                                                                  20630028
205000     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           20640028
205100                                 TO PW-SHIPT-STATUS-RECORD        20650028
205200                                   (PW-TRANS-SET-SUB).            20660028
205300     ADD PC-1                    TO PW-TRANS-SET-SUB.             20670028
205400                                                                  20680028
205500     IF TR001-N901-REF-NBR-MA                                     20690028
205600         MOVE TR001-N902-REF-NBR TO PW-VHTRIP-MANIFEST-NBR        20700028
205700     ELSE                                                         20710028
205800         IF TR001-N901-REF-NBR-PO                                 20720028
205900             PERFORM 7300-VERIFY-PO                               20730042
206000             IF PS-VALID-PO                                       20740028
206100                 MOVE PV-UNPK-PO TO PW-SHPTPO-PO-NBR              20750028
206200                                   (PW-SHPTPO-SUB)                20760028
206300                 ADD  PC-1       TO PW-SHPTPO-SUB                 20770028
206400             ELSE                                                 20780028
382300                 IF TR001-N902-REF-NBR (1:2) = ZEROES             20790041
C98147                    IF TR001-N902-REF-NBR (10:1) = SPACE          20800050
C98147**                    PROCESSING A 7 DIGIT PO NUMBER              20810050
C98147                       MOVE TR001-N902-REF-NBR (3:7)              20820050
C98147                                 TO PV-VALUE2-8                   20830050
C98147                       MOVE PV-VALUE1-8                           20840050
207100                                 TO PW-SAVE-PO-NBR                20850041
207200                                   (PW-SAVE-SHPTPO-SUB)           20860041
C98147                    ELSE                                          20870050
C98147**                    PROCESSING A 8 DIGIT PO NUMBER              20880050
C98147                       MOVE TR001-N902-REF-NBR (3:8)              20890050
207100                                 TO PW-SAVE-PO-NBR                20900041
207200                                   (PW-SAVE-SHPTPO-SUB)           20910041
C98147                    END-IF                                        20920050
382600                 ELSE                                             20930041
C98147                    IF TR001-N902-REF-NBR (8:1) = SPACE           20940050
C98147**                   PROCESSING A 7 DIGIT PO NUMBER               20950050
C98147                       MOVE TR001-N902-REF-NBR (1:7)              20960050
C98147                                 TO PV-VALUE2-8                   20970050
C98147                       MOVE PV-VALUE1-8                           20980050
207100                                 TO PW-SAVE-PO-NBR                20990041
207200                                   (PW-SAVE-SHPTPO-SUB)           21000041
C98147                    ELSE                                          21010050
C98147**                   PROCESSING A 8 DIGIT PO NUMBER               21020050
C98147                       MOVE TR001-N902-REF-NBR (1:8)              21030050
207100                                 TO PW-SAVE-PO-NBR                21040041
207200                                   (PW-SAVE-SHPTPO-SUB)           21050041
C98147                    END-IF                                        21060050
382900                 END-IF                                           21070041
207400                                                                  21080028
207500                 ADD  PC-1       TO PW-SAVE-SHPTPO-SUB            21090028
207600                 MOVE PC-012 TO PW-ERROR-NBR (PW-INDEX)           21100028
207700                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             21110028
207800                 SET PS-EDIT-ERROR-DETECTED                       21120028
207900                                 TO TRUE                          21130028
208000             END-IF                                               21140028
208100* CLT 02-20-2011 WR40574 START                                    21150028
208200         ELSE                                                     21160028
208300             IF TR001-N901-REF-NBR-CN                             21170028
208400                 MOVE TR001-N902-REF-NBR TO                       21180028
208500                                    PW-SHIPMT-CARR-AUTH-ID        21190028
208600             END-IF                                               21200028
208700* CLT 02-20-2011 WR40574 END                                      21210028
208800         END-IF                                                   21220028
208900     END-IF.                                                      21230028
209000                                                                  21240028
209100                                                                  21250028
209200 EJECT                                                            21260028
209300                                                                  21270028
209400***************************************************************** 21280028
209500*     THIS PARAGRAPH CHECKS TO SEE IF THE PW-INDEX HAS EXCEEDED * 21290028
209600*     THE MAXIMUM VALUE FOR THE PW-ERROR-TABLE.  IF SO, THEN 2  * 21300028
209700*     ERRORS ARE PUT INTO THE LAST 2 ENTRIES OF THE TABLE AND   * 21310028
209800*     ALL THE RECORDS FOR THIS SHIPMENT TRANSACTION ARE         * 21320028
209900*     BYPASSED.                                                 * 21330028
210000***************************************************************** 21340028
210100 2250-CHECK-ADD-1-TO-PW-INDEX.                                    21350028
210200     ADD PC-001 TO PW-INDEX.                                      21360028
210300     IF PW-INDEX NOT < PW-MAX-ERR-TAB-ENTRIES-1                   21370028
210400       MOVE PC-026 TO PW-ERROR-NBR (PW-MAX-ERR-TAB-ENTRIES-1)     21380028
210500       MOVE PC-031 TO PW-ERROR-NBR (PW-MAX-ERR-TAB-ENTRIES)       21390028
210600       IF PS-EXCEED-ERROR-WRITTEN                                 21400028
210700         NEXT SENTENCE                                            21410028
210800       ELSE                                                       21420028
210900        SET PS-BYPASS-SHIPMT TO TRUE                              21430028
211000        SET PS-BYPASS-TRANS-SET TO TRUE                           21440028
211100        DISPLAY                                                   21450028
211200        '*******************************************************' 21460028
211300        DISPLAY '*SHIPMENT BYPASSED-EXCEEDED ERROR LIMIT -'       21470028
211400        DISPLAY  PW-HOLD-TRANS-SET-HDR-RECORD                     21480028
211500        DISPLAY '*SCAC ->' PW-SHIPMT-PRO-SCAC-ID ','              21490028
211600                '*FREIGHT BILL->' PW-SHIPMT-PRO-NBR  ','          21500028
211700                '*BILL OF LADING->' PW-SHIPMT-BOL-NBR             21510028
211800        DISPLAY                                                   21520028
211900        '*******************************************************' 21530028
212000        SET PS-EXCEED-ERROR-WRITTEN TO TRUE                       21540028
212100       END-IF                                                     21550028
212200     END-IF.                                                      21560028
212300***************************************************************** 21570028
212400*     SAVE Q5 FIELDS                                            * 21580028
212500*                                                               * 21590028
212600*     -  SAVE Q5 LEVEL FIELDS IN SHIPMT AND SHIPST RECORDS IN WS* 21600028
212700***************************************************************** 21610028
212800                                                                  21620028
212900 2300-SAVE-Q5-DATA.                                               21630028
213000                                                                  21640028
213100     MOVE '2300-SAVE-Q5-DATA'    TO PV-CURRENT-PARA.              21650028
213200                                                                  21660028
213300     ADD PC-1                    TO PA-Q5-READ.                   21670028
213400                                                                  21680028
213500     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           21690028
213600                                 TO PW-SHIPT-STATUS-RECORD        21700028
213700                                   (PW-TRANS-SET-SUB).            21710028
213800     ADD PC-1                    TO PW-TRANS-SET-SUB.             21720028
213900                                                                  21730028
214000     MOVE TR001-Q501-SHIPT-STATUS-CDE                             21740028
214100                                 TO PV-SHIPT-STATUS-CDE.          21750028
214200                                                                  21760028
214300     PERFORM 7400-VERIFY-SHIPT-STATUS.                            21770028
214400                                                                  21780028
214500     IF PS-VALID-SHIPT-STATUS                                     21790028
214600         MOVE TR001-Q501-SHIPT-STATUS-CDE                         21800028
214700                                 TO PW-SHIPST-SHIPT-STATUS-CDE    21810028
214800                                   (PW-SHIPST-SUB)                21820028
214900                                    PW-TRIPST-TRIP-STATUS-CDE     21830028
215000                                   (PW-TRIPST-SUB)                21840028
215100         MOVE SHSTYP-PRTY-CDE    TO PW-VEHICL-CURR-PRTY-CDE       21850028
215200     ELSE                                                         21860028
215300         MOVE PC-DEFAULT-SHIPT-STAT-AF                            21870028
215400                                 TO PW-SHIPST-SHIPT-STATUS-CDE    21880028
215500                                   (PW-SHIPST-SUB)                21890028
215600                                    PW-TRIPST-TRIP-STATUS-CDE     21900028
215700                                   (PW-TRIPST-SUB)                21910028
215800         MOVE TR001-Q501-SHIPT-STATUS-CDE                         21920028
215900                                 TO PV-SAVE-STATUS-CDE            21930028
216000         MOVE PC-29              TO PW-VEHICL-CURR-PRTY-CDE       21940028
216100         MOVE PC-013 TO PW-ERROR-NBR (PW-INDEX)                   21950028
216200         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     21960028
216300         SET PS-EDIT-ERROR-DETECTED                               21970028
216400                                 TO TRUE                          21980028
216500     END-IF.                                                      21990028
216600                                                                  22000028
216700     IF TR001-Q502-STATUS-DATE = SPACES                           22010028
216800         CONTINUE                                                 22020028
216900     ELSE                                                         22030028
217000         IF TR001-Q502-STATUS-DATE NUMERIC                        22040028
217100             PERFORM 2350-VALIDATE-STATUS-DATE                    22050028
217200         ELSE                                                     22060028
217300             MOVE ZEROS          TO PW-SHIPST-STATUS-DTE          22070028
217400                                   (PW-SHIPST-SUB)                22080028
217500                                    PW-TRIPST-STATUS-DTE          22090028
217600                                   (PW-TRIPST-SUB)                22100028
217700             MOVE PC-003 TO PW-ERROR-NBR (PW-INDEX)               22110028
217800             PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                 22120028
217900             SET PS-EDIT-ERROR-DETECTED                           22130028
218000                                 TO TRUE                          22140028
218100         END-IF                                                   22150028
218200     END-IF.                                                      22160028
218300                                                                  22170028
218400     IF PW-SHIPST-STATUS-DTE (PW-SHIPST-SUB) = SPACES OR ZEROS    22180028
218500         MOVE CD-CPU-DATE-YY     TO PW-HOLD-STATUS-DTE-YY         22190028
218600         MOVE CD-CPU-DATE-MM     TO PW-HOLD-STATUS-DTE-MM         22200028
218700         MOVE CD-CPU-DATE-DD     TO PW-HOLD-STATUS-DTE-DD         22210028
218800         MOVE PW-HOLD-STATUS-DTE-CCYYMMDD                         22220028
218900                                 TO PW-SHIPST-STATUS-DTE          22230028
219000                                   (PW-SHIPST-SUB)                22240028
219100                                    PW-TRIPST-STATUS-DTE          22250028
219200                                   (PW-TRIPST-SUB)                22260028
219300         MOVE PC-023 TO PW-ERROR-NBR (PW-INDEX)                   22270028
219400         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     22280028
219500         SET PS-EDIT-ERROR-DETECTED                               22290028
219600                                 TO TRUE                          22300028
219700     END-IF.                                                      22310028
219800                                                                  22320028
219900     IF TR001-Q503-STATUS-TIME = SPACES                           22330028
220000         CONTINUE                                                 22340028
220100     ELSE                                                         22350028
220200         IF TR001-Q503-STATUS-TIME NUMERIC                        22360028
220300             MOVE TR001-Q503-STATUS-TIME                          22370028
220400                                 TO PW-HOLD-TIME-HHMM             22380028
220500             IF PW-HOLD-VALID-HH AND PW-HOLD-VALID-MM             22390028
220600                 MOVE PW-HOLD-HHMM-HH                             22400028
220700                                 TO PW-HOLD-STATUS-TIME-HH        22410028
220800                                    PW-HOLD-STAT-TIME-HH          22420028
220900                 MOVE PW-HOLD-HHMM-MM                             22430028
221000                                 TO PW-HOLD-STATUS-TIME-MM        22440028
221100                                    PW-HOLD-STAT-TIME-MM          22450028
221200                 MOVE PW-HOLD-STATUS-TIME-HHMMSS                  22460028
221300                                 TO PW-SHIPST-STATUS-TME          22470028
221400                                   (PW-SHIPST-SUB)                22480028
221500                                    PW-TRIPST-STATUS-TME          22490028
221600                                   (PW-TRIPST-SUB)                22500028
221700             ELSE                                                 22510028
221800                 MOVE ZEROS      TO PW-HOLD-TIME-HHMM             22520028
221900                 MOVE PC-007 TO PW-ERROR-NBR (PW-INDEX)           22530028
222000                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             22540028
222100                 SET PS-EDIT-ERROR-DETECTED                       22550028
222200                                 TO TRUE                          22560028
222300             END-IF                                               22570028
222400         ELSE                                                     22580028
222500             MOVE ZEROS          TO PW-HOLD-TIME-HHMM             22590028
222600             MOVE PC-004 TO PW-ERROR-NBR (PW-INDEX)               22600028
222700             PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                 22610028
222800             SET PS-EDIT-ERROR-DETECTED                           22620028
222900                                 TO TRUE                          22630028
223000         END-IF                                                   22640028
223100     END-IF.                                                      22650028
223200                                                                  22660028
223300     IF PW-SHIPST-STATUS-TME (PW-SHIPST-SUB) = SPACES OR ZEROS    22670028
223400         MOVE CT-CPU-TIME-HH     TO PW-HOLD-STATUS-TIME-HH        22680028
223500                                    PW-HOLD-STAT-TIME-HH          22690028
223600         MOVE CT-CPU-TIME-MM     TO PW-HOLD-STATUS-TIME-MM        22700028
223700                                    PW-HOLD-STAT-TIME-MM          22710028
223800         MOVE CT-CPU-TIME-SS     TO PW-HOLD-STATUS-TIME-SS        22720028
223900                                    PW-HOLD-STAT-TIME-SS          22730028
224000         MOVE PW-HOLD-STATUS-TIME-HHMMSS                          22740028
224100                                 TO PW-SHIPST-STATUS-TME          22750028
224200                                   (PW-SHIPST-SUB)                22760028
224300                                    PW-TRIPST-STATUS-TME          22770028
224400                                   (PW-TRIPST-SUB)                22780028
224500         MOVE PC-024 TO PW-ERROR-NBR (PW-INDEX)                   22790028
224600         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     22800028
224700         SET PS-EDIT-ERROR-DETECTED                               22810028
224800                                 TO TRUE                          22820028
224900     END-IF.                                                      22830028
225000                                                                  22840028
225100     IF TR001-Q501-SHIPT-STATUS-AG                                22850028
225200         IF TR001-Q502-STATUS-DATE NOT = SPACES AND               22860028
225300            DPG54-DATE-VALID                                      22870028
225400             MOVE PW-HOLD-STATUS-DTE-CCYYMMDD                     22880028
225500                                 TO PW-VHTRIP-STATUS-DTE          22890028
225600             MOVE '-'            TO PW-VHTRIP-D-T-DASH            22900028
225700             MOVE '.000000'      TO PW-VHTRIP-D-T-MSEC            22910028
225800             IF TR001-Q503-STATUS-TIME NOT = SPACES AND           22920028
225900                PW-HOLD-VALID-HH AND PW-HOLD-VALID-MM             22930028
226000                 MOVE PW-HOLD-STAT-TIME-HHMMSS                    22940028
226100                                 TO PW-VHTRIP-STATUS-TME          22950028
226200             ELSE                                                 22960028
226300                 MOVE '00.00.00' TO PW-VHTRIP-STATUS-TME          22970028
226400             END-IF                                               22980028
226500             SET PS-TVHTRIP-VALID-TIMESTMP TO TRUE                22990028
226600         END-IF                                                   23000028
226700     END-IF.                                                      23010028
226800                                                                  23020028
226900     MOVE TR001-Q504-TIME-ZONE TO PW-SHIPST-TIME-ZONE             23030028
227000                                   (PW-SHIPST-SUB).               23040028
227100     MOVE TR001-Q506-CITY TO PW-SHIPST-CITY                       23050028
227200                                   (PW-SHIPST-SUB).               23060028
227300     MOVE TR001-Q507-STATE TO PW-SHIPST-STATE                     23070028
227400                                   (PW-SHIPST-SUB).               23080028
227500     IF PS-VALID-SHIPT-STATUS                                     23090028
227600         MOVE TR001-Q501-SHIPT-STATUS-CDE TO                      23100028
227700                                         PW-SHIPST-CARR-STATUS-CDE23110028
227800                                   (PW-SHIPST-SUB)                23120028
227900     ELSE                                                         23130028
228000         MOVE PC-DEFAULT-SHIPT-STAT-AF TO                         23140028
228100                                         PW-SHIPST-CARR-STATUS-CDE23150028
228200                                   (PW-SHIPST-SUB)                23160028
228300     END-IF.                                                      23170028
228400                                                                  23180028
228500     MOVE TR001-Q509-LSD-CARR-ID TO PW-SHIPST-LSD-CARR            23190028
228600                                   (PW-SHIPST-SUB)                23200028
228700                                    PV-CARR-SCAC.                 23210028
228800     SET PS-LSD-CARR                                              23220028
228900         PS-VALID-LSD-VENDOR TO TRUE                              23230028
229000     PERFORM 7600-VERIFY-LSD-CARR-SCAC.                           23240028
229100                                                                  23250028
229200     IF PS-INVALID-LSD-VENDOR                                     23260028
229300       AND PV-INVALID-DELY-SCAC NOT = TR001-Q509-LSD-CARR-ID      23270028
229400        MOVE PC-037 TO PW-ERROR-NBR (PW-INDEX)                    23280028
229500        PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                      23290028
229600        SET  PS-EDIT-ERROR-DETECTED TO TRUE                       23300028
229700        MOVE TR001-Q509-LSD-CARR-ID TO PV-INVALID-DELY-SCAC       23310028
229800     END-IF.                                                      23320028
229900                                                                  23330028
230000     IF TR001-Q509-LSD-CARR-ID = SPACES                           23340028
230100      AND NOT PS-PC-038-ERROR                                     23350028
230200        MOVE PC-038 TO PW-ERROR-NBR (PW-INDEX)                    23360028
230300        PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                      23370028
230400        SET  PS-EDIT-ERROR-DETECTED                               23380028
230500             PS-PC-038-ERROR        TO TRUE                       23390028
230600     END-IF.                                                      23400028
230700                                                                  23410028
230800     MOVE TR001-Q510-VEH-NBR TO PW-SHIPST-VEH-NBR                 23420028
230900                                   (PW-SHIPST-SUB).               23430028
231000                                                                  23440028
231100     IF TR001-Q505-DELAY-RSN-CDE > SPACES                         23450028
231200         MOVE TR001-Q505-DELAY-RSN-CDE                            23460028
231300                                 TO PW-SHIPST-DELAY-RSN-CDE       23470028
231400                                   (PW-SHIPST-SUB)                23480028
231500     END-IF.                                                      23490028
231600                                                                  23500028
231700     IF TR001-Q510-VEH-NBR > SPACES                               23510028
231800         IF TR001-Q501-SHIPT-STATUS-CDE = PC-D                    23520028
231900             MOVE TR001-Q510-VEH-NBR TO RC023-VEHICLE             23530028
232000             CALL RC023-FB-BOL-VEH-FORMAT USING                   23540028
232100                                        RC023-FORMAT-DATA-AREA    23550028
232200             MOVE RC023-VEHICLE  TO PW-VEHICL-VEH-NBR             23560028
232300                                    PW-VHTRIP-VEH-NBR             23570028
232400                                    PW-SAVE-VEH-NBR               23580028
232500                                    PW-SHIPMT-VEH-NBR             23590028
232600         END-IF                                                   23600028
232700     END-IF.                                                      23610028
232800                                                                  23620028
232900     IF PW-VEHICL-VEH-NBR > SPACES                                23630028
233000         PERFORM 7700-SELECT-VEHICL                               23640028
233100         PERFORM 7710-CHECK-VEHICL-SQLCODE                        23650028
233200     ELSE                                                         23660028
233300         SET PS-BYPASS-VEHICL    TO TRUE                          23670028
233400     END-IF.                                                      23680028
233500                                                                  23690028
233600     IF PS-VALID-VENDOR AND                                       23700028
233700      PS-PROCESS-UPDATES                                          23710028
233800         IF PS-VALID-LSD-VENDOR                                   23720028
233900             MOVE PV-CARR-SCAC       TO PV-SCAC-ID                23730028
234000                                        PW-SAVE-LSD-CARR-ID       23740028
234100         ELSE                                                     23750028
234200             MOVE PW-SAVE-CARR-SCAC  TO PV-SCAC-ID                23760028
234300         END-IF                                                   23770028
234400                                                                  23780028
234500         MOVE RC023-FREIGHT-BILL     TO PW-SHIPMT-PRO-NBR         23790028
234600         MOVE RC023-BILL-OF-LADING   TO PW-SHIPMT-BOL-NBR         23800028
234700         MOVE PW-SV-SHIPMT-COMP-PRO  TO PW-SHIPMT-COMP-PRO        23810028
234800         MOVE PW-SV-SHIPMT-COMP-BOL  TO PW-SHIPMT-COMP-BOL        23820028
234900                                                                  23830028
235000         SET PS-NO-DUPLICATE-SHIPMT TO TRUE                       23840028
235100                                                                  23850028
235200         PERFORM 6230-CHECK-IF-SHIPMT-EXISTS                      23860028
235300         IF PS-INSERT-SHIPMT                                      23870028
235400             PERFORM WITH TEST AFTER                              23880028
235500                 UNTIL SQLCODE = +100                             23890028
235600                 PERFORM 0300-GET-RANDOM-NUMBER                   23900028
235700                 PERFORM 7100-CHECK-IF-SHIPT-ID-USED              23910028
235800             END-PERFORM                                          23920028
235900             MOVE PV-RANDOM-NBR  TO PW-SHIPMT-SHIPT-ID            23930028
236000                                    PW-SHIPST-SHIPT-ID            23940028
236100                                    PW-SHPTPO-SHIPT-ID            23950028
236200         ELSE                                                     23960028
236300             MOVE PW-SHIPMT-SHIPT-ID                              23970028
236400                                 TO PW-SHIPST-SHIPT-ID            23980028
236500                                    PW-SHPTPO-SHIPT-ID            23990028
236600         END-IF                                                   24000028
236700         IF TR001-Q501-SHIPT-STATUS-CDE = PC-D                    24010028
236800             IF PS-VALID-LSD-VENDOR                               24020028
236900                 MOVE TR001-Q509-LSD-CARR-ID                      24030028
237000                                 TO PW-VEHICL-OWNER-SCAC-ID       24040028
237100                                    PW-VHTRIP-OWNER-SCAC-ID       24050028
237200             END-IF                                               24060028
237300         END-IF                                                   24070028
237400     END-IF.                                                      24080028
237500                                                                  24090028
237600     IF (PS-UPDATE-VEHICL OR                                      24100028
237700         PS-DONT-UPDATE-VEHICL) AND                               24110028
237800         PS-PROCESS-UPDATES                                       24120028
237900         MOVE VEHICL-CURR-STATUS-CDE                              24130028
238000                                 TO PV-SHIPT-STATUS-CDE           24140028
238100         PERFORM 7400-VERIFY-SHIPT-STATUS                         24150028
238200                                                                  24160028
238300         EVALUATE TRUE                                            24170028
238400             WHEN PW-VEHICL-CURR-PRTY-CDE < PC-49                 24180028
238500                 MOVE PC-30      TO PV-COMPARE-PRTY-CDE           24190028
238600             WHEN PW-VEHICL-CURR-PRTY-CDE = PC-49                 24200028
238700                 MOVE PC-50      TO PV-COMPARE-PRTY-CDE           24210028
238800             WHEN OTHER                                           24220028
238900                 MOVE PW-VEHICL-CURR-PRTY-CDE                     24230028
239000                                 TO PV-COMPARE-PRTY-CDE           24240028
239100         END-EVALUATE                                             24250028
239200         IF SHSTYP-PRTY-CDE > PV-COMPARE-PRTY-CDE AND             24260028
239300           (SHSTYP-PRTY-CDE NOT = PC-95)                          24270028
239400************************************************************      24280028
239500*             '95' STATUS IS 'ET', OR END OF TRIP.                24290028
239600*             THESE VEHICL RECORDS CAN BE UPDATED                 24300028
239700************************************************************      24310028
239800             SET PS-BYPASS-VEHICL                                 24320028
239900                                 TO TRUE                          24330028
240000         END-IF                                                   24340028
240100     END-IF.                                                      24350028
240200                                                                  24360028
240300     IF (PS-UPDATE-VEHICL OR                                      24370028
240400         PS-DONT-UPDATE-VEHICL) AND                               24380028
240500         PS-PROCESS-UPDATES                                       24390028
240600         IF PS-INSERT-SHIPMT                                      24400028
240700             MOVE VEHICL-CURR-STATUS-CDE                          24410028
240800                                 TO PV-SHIPT-STATUS-CDE           24420028
240900             IF PV-VEHICL-CURR-TRIP-ID-NULL = PC-NEG-1            24430028
241000                 SET PS-INSERT-VHTRIP                             24440028
241100                                 TO TRUE                          24450028
241200             ELSE                                                 24460028
241300                 MOVE PW-VEHICL-CURR-TRIP-ID                      24470028
241400                                 TO VHTRIP-TRIP-ID                24480028
241500                                    PW-SHIPMT-TRIP-ID             24490028
241600                 SET PS-DONT-UPDATE-VHTRIP                        24500028
241700                                     TO TRUE                      24510028
241800             END-IF                                               24520028
241900         ELSE                                                     24530028
242000             IF PW-SHIPMT-TRIP-ID > 0                             24540028
242100                 MOVE PW-SHIPMT-TRIP-ID                           24550028
242200                                     TO VHTRIP-TRIP-ID            24560028
242300                 PERFORM 7750-SELECT-VHTRIP                       24570028
242400                 PERFORM 7760-CHECK-VHTRIP-SQLCODE                24580028
242500             ELSE                                                 24590028
242600                 IF PV-VEHICL-CURR-TRIP-ID-NULL = PC-NEG-1        24600028
242700                   SET PS-INSERT-VHTRIP                           24610028
242800                                 TO TRUE                          24620028
242900                 ELSE                                             24630028
243000                     MOVE PW-VEHICL-CURR-TRIP-ID                  24640028
243100                                 TO VHTRIP-TRIP-ID                24650028
243200                     PERFORM 7750-SELECT-VHTRIP                   24660028
243300                     PERFORM 7760-CHECK-VHTRIP-SQLCODE            24670028
243400                 END-IF                                           24680028
243500             END-IF                                               24690028
243600         END-IF                                                   24700028
243700     ELSE                                                         24710028
243800*  ASSUME PS-INSERT-VEHICL OR                                     24720028
243900*         PS-BYPASS-VEHICL                                        24730028
244000         IF PS-PROCESS-UPDATES                                    24740028
244100             IF PW-SHIPMT-TRIP-ID > 0                             24750028
244200                 MOVE PW-SHIPMT-TRIP-ID                           24760028
244300                                     TO VHTRIP-TRIP-ID            24770028
244400                 PERFORM 7750-SELECT-VHTRIP                       24780028
244500                 PERFORM 7760-CHECK-VHTRIP-SQLCODE                24790028
244600             ELSE                                                 24800028
244700                 SET PS-INSERT-VHTRIP                             24810028
244800                                 TO TRUE                          24820028
244900             END-IF                                               24830028
245000         ELSE                                                     24840028
245100             SET PS-DONT-UPDATE-VHTRIP TO TRUE                    24850028
245200         END-IF                                                   24860028
245300     END-IF.                                                      24870028
245400                                                                  24880028
245500     ADD  PC-1                   TO PW-SHIPST-SUB.                24890028
245600     ADD  PC-1                   TO PW-TRIPST-SUB.                24900028
245700                                                                  24910028
245800                                                                  24920028
245900***************************************************************** 24930028
246000*     VALIDATE STATUS DATE                                      * 24940028
246100*                                                               * 24950028
246200*     -  CALL THE CALENDAR ROUTINE TO SEE IF DATE WAS PASSED    * 24960028
246300*        IN PROPER YYMMDD FORMAT.                               * 24970028
246400***************************************************************** 24980028
246500                                                                  24990028
246600 2350-VALIDATE-STATUS-DATE.                                       25000028
246700                                                                  25010028
246800     MOVE '2350-VALIDATE-STATUS-DATE'                             25020028
246900                                 TO PV-CURRENT-PARA.              25030028
247000                                                                  25040028
247100     MOVE TR001-Q502-STATUS-DATE TO PW-HOLD-YYMMDD-DTE.           25050028
247200     MOVE PW-HOLD-YYMMDD-YY      TO PW-HOLD-STATUS-DTE-YY.        25060028
247300     MOVE PW-HOLD-YYMMDD-MM      TO PW-HOLD-STATUS-DTE-MM.        25070028
247400     MOVE PW-HOLD-YYMMDD-DD      TO PW-HOLD-STATUS-DTE-DD.        25080028
247500                                                                  25090028
247600     IF PW-HOLD-YYMMDD-YY > PC-90                                 25100028
247700         MOVE PC-19              TO PW-HOLD-STATUS-DTE-CC         25110028
247800     ELSE                                                         25120028
247900         MOVE PC-20              TO PW-HOLD-STATUS-DTE-CC         25130028
248000     END-IF.                                                      25140028
248100                                                                  25150028
248200     MOVE PW-HOLD-STATUS-DTE-CCYYMMDD                             25160028
248300                                 TO DPG52-LK-DATE-INPUT.          25170028
248400     MOVE CD-CPU-DATE            TO DPG51-SYSTEM-DATE.            25180028
248500                                                                  25190028
248600     SET DPG51-ACTUAL-CALENDAR-ONLY                               25200028
248700                                 TO TRUE.                         25210028
248800     SET DPG51-DO-NOT-INCR-DECR-DATE                              25220028
248900                                 TO TRUE.                         25230028
249000     SET DPG52-LK-DTE-ISO-FMT    TO TRUE.                         25240028
249100                                                                  25250028
249200     CALL PC-DPKUT500 USING DPG51 DPG52                           25260028
249300                            DPG53 DPG54                           25270028
249400                            DPG55 DPG56.                          25280028
249500                                                                  25290028
249600     IF DPG54-DATE-VALID                                          25300028
249700         MOVE PW-HOLD-STATUS-DTE-CCYYMMDD                         25310028
249800                                 TO PW-SHIPST-STATUS-DTE          25320028
249900                                   (PW-SHIPST-SUB)                25330028
250000                                    PW-TRIPST-STATUS-DTE          25340028
250100                                   (PW-TRIPST-SUB)                25350028
250200     ELSE                                                         25360028
250300         MOVE ZEROS              TO PW-SHIPST-STATUS-DTE          25370028
250400                                   (PW-SHIPST-SUB)                25380028
250500                                    PW-TRIPST-STATUS-DTE          25390028
250600                                   (PW-TRIPST-SUB)                25400028
250700         MOVE PC-006 TO PW-ERROR-NBR (PW-INDEX)                   25410028
250800         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     25420028
250900         SET PS-EDIT-ERROR-DETECTED                               25430028
251000                                 TO TRUE                          25440028
251100     END-IF.                                                      25450028
251200                                                                  25460028
251300 EJECT                                                            25470028
251400***************************************************************** 25480028
251500*     SAVE Q6 FIELDS                                            * 25490028
251600*                                                               * 25500028
251700*     -  SAVE Q6 LEVEL FIELDS IN SHIPMT RECORD IN WS            * 25510028
251800***************************************************************** 25520028
251900                                                                  25530028
252000 2400-SAVE-Q6-DATA.                                               25540028
252100                                                                  25550028
252200     MOVE '2400-SAVE-Q6-DATA'    TO PV-CURRENT-PARA.              25560028
252300                                                                  25570028
252400     ADD PC-1                    TO PA-Q6-READ.                   25580028
252500                                                                  25590028
252600     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           25600028
252700                                 TO PW-SHIPT-STATUS-RECORD        25610028
252800                                   (PW-TRANS-SET-SUB).            25620028
252900     ADD PC-1                    TO PW-TRANS-SET-SUB.             25630028
253000                                                                  25640028
253100     IF TR001-Q601-EXPTED-GRO-WGHT = SPACES                       25650028
253200         CONTINUE                                                 25660028
253300     ELSE                                                         25670028
253400         IF TR001-Q601-EXPTED-GRO-WGHT NUMERIC                    25680028
253500             MOVE TR001-Q601-EXPTED-GRO-WGHT                      25690028
253600                                 TO PW-SHIPMT-EXPTED-GRO-WGHT     25700028
253700         ELSE                                                     25710028
253800             MOVE TR001-Q601-EXPTED-GRO-WGHT                      25720028
253900                                 TO DP010I-UNEDITED-FIELD         25730028
254000             MOVE PC-8           TO DP010I-MAXIMUM-DIGITS         25740028
254100             MOVE 0              TO DP010I-MAXIMUM-DECIMALS       25750028
254200             SET DP010I-NEGATIVE-NOT-ALLOWED                      25760028
254300                                 TO TRUE                          25770028
263697             CALL DP010I-NUMERIC-EDIT-ROUTINE                     25791054
263697                 USING DP010I-NUMERIC-EDIT-AREA                   25792054
254600                                                                  25800028
254700             IF DP010I-ERROR-DETECTED                             25810028
254800                 MOVE ZEROS      TO PW-SHIPMT-EXPTED-GRO-WGHT     25820028
254900                 MOVE PC-001 TO PW-ERROR-NBR (PW-INDEX)           25830028
255000                 PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX             25840028
255100                 SET PS-EDIT-ERROR-DETECTED                       25850028
255200                                 TO TRUE                          25860028
255300             ELSE                                                 25870028
255400                 MOVE DP010I-NUMERIC-FIELD                        25880028
255500                                 TO PW-SHIPMT-EXPTED-GRO-WGHT     25890028
255600             END-IF                                               25900028
255700         END-IF                                                   25910028
255800     END-IF.                                                      25920028
255900                                                                  25930028
256000     IF TR001-Q604-EXPTED-PKG-QTY NOT NUMERIC                     25940028
256100         CONTINUE                                                 25950028
256200     ELSE                                                         25960028
256300         IF TR001-Q604-EXPTED-PKG-QTY > ZERO                      25970028
256400             MOVE TR001-Q604-EXPTED-PKG-QTY                       25980028
256500                                 TO PW-SHIPMT-CARR-CARTON-CNT     25990028
256600         END-IF                                                   26000028
256700     END-IF.                                                      26010028
256800                                                                  26020028
256900     IF TR001-Q605-PKG-TYP-CDE > SPACES                           26030028
257000         PERFORM 7500-VERIFY-PKG-TYP-CDE                          26040028
257100         IF PS-VALID-PKG-TYP-CDE                                  26050028
257200             MOVE TR001-Q605-PKG-TYP-CDE                          26060028
257300                                 TO PW-SHIPMT-PKG-TYP-CDE         26070028
257400         ELSE                                                     26080028
257500             MOVE PC-DEFAULT-PKG-CTN                              26090028
257600                                 TO PW-SHIPMT-PKG-TYP-CDE         26100028
257700             SET PS-EDIT-ERROR-DETECTED                           26110028
257800                                 TO TRUE                          26120028
257900             MOVE PC-019 TO PW-ERROR-NBR (PW-INDEX)               26130028
258000             PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                 26140028
258100             MOVE TR001-Q605-PKG-TYP-CDE TO PV-SAVE-PKG-TYP       26150028
258200         END-IF                                                   26160028
258300     END-IF.                                                      26170028
258400                                                                  26180028
258500     MOVE TR001-Q606-FRGT-TERMS-CDE                               26190028
258600                                 TO PW-SHIPMT-FRGT-TERMS-CDE.     26200028
258700                                                                  26210028
258800     IF TR001-Q607-FRGT-CHG-AMT NOT NUMERIC                       26220028
258900         MOVE ZEROS              TO PW-SHIPMT-FRGT-CHG-AMT        26230028
259000     ELSE                                                         26240028
259100         IF TR001-Q607-FRGT-CHG-AMT > ZERO                        26250028
259200             MOVE TR001-Q607-FRGT-CHG-AMT                         26260028
259300                                 TO PW-SHIPMT-FRGT-CHG-AMT        26270028
259400         END-IF                                                   26280028
259500     END-IF.                                                      26290028
259600                                                                  26300028
259700 EJECT                                                            26310028
259800***************************************************************** 26320028
259900*     CHECK SE CNTL NBR                                         * 26330028
260000*                                                               * 26340028
260100*     -  VERIFY THAT THE CONTROL NUMBER IN THE TRAILER MATCHES  * 26350028
260200*        THE CONTROL NUMBER SAVED FROM THE HEADER.              * 26360028
260300***************************************************************** 26370028
260400                                                                  26380028
260500 2500-CHECK-SE-DATA.                                              26390028
260600                                                                  26400028
260700     MOVE '2500-CHECK-SE-DATA'   TO PV-CURRENT-PARA.              26410028
260800                                                                  26420028
260900     ADD PC-1                    TO PA-SE-READ.                   26430028
261000                                                                  26440028
261100     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           26450028
261200                                 TO PW-SHIPT-STATUS-RECORD        26460028
261300                                   (PW-TRANS-SET-SUB).            26470028
261400     ADD PC-1                    TO PW-TRANS-SET-SUB.             26480028
261500                                                                  26490028
261600     IF TR001-TRANS-SET-TRL-CNTL-NBR NOT = PV-CNTL-NBR            26500028
261700         PERFORM 6100-ERROR-IN-TRANS-SET                          26510028
261800           VARYING PW-TRANS-SET-SUB                               26520028
261900              FROM 1 BY 1                                         26530028
262000             UNTIL PW-TRANS-SET-SUB > PC-253                      26540028
262100                OR PW-SHIPT-STATUS-RECORD                         26550028
262200                  (PW-TRANS-SET-SUB) = SPACES                     26560028
262300                                                                  26570028
262400         MOVE PC-017 TO PW-ERROR-NBR (PW-INDEX)                   26580028
262500         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                     26590028
262600         SET PS-BYPASS-TRANS-SET                                  26600028
262700                                 TO TRUE                          26610028
262800     END-IF.                                                      26620028
262900                                                                  26630028
263000 EJECT                                                            26640028
263100***************************************************************** 26650028
263200*     BYPASS TRANSACTION SET                                    * 26660028
263300*                                                               * 26670028
263400*     -  IF A BEGINNING SEGMENT WAS SENT WITHOUT A PRIOR HEADER * 26680028
263500*        RECORD, READ ALL RECORDS WRITING THEM TO THE ERROR     * 26690028
263600*        DATASET UNTIL A TRANSACTION TRAILER OR A NEW HEADER IS * 26700028
263700*        ENCOUNTERED.                                           * 26710028
263800***************************************************************** 26720028
263900                                                                  26730028
264000 6000-BYPASS-TRANS-SET.                                           26740028
264100                                                                  26750028
264200     MOVE '6000-BYPASS-TRANS-SET'                                 26760028
264300                                 TO PV-CURRENT-PARA.              26770028
264400                                                                  26780028
264500     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           26790028
264600                                 TO SHIPMENT-ERROR-RECORD.        26800028
264700                                                                  26810028
264800     PERFORM 9000-READ-SHIPMENT-STATUS.                           26820028
264900                                                                  26830028
265000 EJECT                                                            26840028
265100***************************************************************** 26850028
265200*     BYPASS ALL RECORDS STORED FOR THIS TRANSACTION SET        * 26860028
265300*                                                               * 26870028
265400*     -  IF A SEVERE ERROR IS FOUND, WRITE ALL RECORDS FOR THE  * 26880028
265500*        TRANSACTION SET OUT TO THE ERROR FILE.                 * 26890028
265600***************************************************************** 26900028
265700                                                                  26910028
265800 6100-ERROR-IN-TRANS-SET.                                         26920028
265900                                                                  26930028
266000     MOVE '6100-ERROR-IN-TRANS-SET'                               26940028
266100                                 TO PV-CURRENT-PARA.              26950028
266200                                                                  26960028
266300     MOVE PW-SHIPT-STATUS-RECORD (PW-TRANS-SET-SUB)               26970028
266400                                 TO SHIPMENT-ERROR-RECORD.        26980028
266500                                                                  26990028
266600 EJECT                                                            27000028
266700*--------------------------------------------------------------*  27010028
266800*                                                              *  27020028
266900*  IF  BOTH -PRO- & -BOL- ARE KNOWN                            *  27030028
267000*      - MATCH ON -PRO- -BOL- -SCAC-                           *  27040028
267100*        IF NO MATCH                                           *  27050028
267200*        - MATCH = -PRO(SPACES)- -BOL- -SCAC-                  *  27060028
267300*          IF NO MATCH                                         *  27070028
267400*             -MATCH = -PRO- -BOL(SPACES)- -SCAC-              *  27080028
267500*              IF NO MATCH - INSERT SHIPMENT                   *  27090028
267600*                                                              *  27100028
267700*  IF -PRO- KNOWN & -BOL- NOT FILLED IN                        *  27110028
267800*      -MATCH = -PRO- -BOL(SPACES)- -SCAC-                     *  27120028
267900*       IF NO MATCH - INSERT SHIPMENT                          *  27130028
268000*                                                              *  27140028
268100*  IF -PRO- NOT KNOWN & -BOL- FILLED IN                        *  27150028
268200*      -MATCH = -PRO(SPACES)- -BOL- -SCAC-                     *  27160028
268300*       IF NO MATCH - INSERT SHIPMENT                          *  27170028
268400*                                                              *  27180028
268500*--------------------------------------------------------------*  27190028
268600                                                                  27200028
268700 6230-CHECK-IF-SHIPMT-EXISTS.                                     27210028
268800     IF RC023-FREIGHT-BILL > SPACES                               27220028
268900        IF RC023-BILL-OF-LADING > SPACES                          27230028
269000*---------------------------------------------------------------- 27240028
269100*   214-PRO-NBR AND 214-BOL-NBR ARE BOTH FILLED IN                27250028
269200*---------------------------------------------------------------- 27260028
269300            PERFORM 7000-SELECT-SHIPMT                            27270028
269400            IF SQLCODE = ZERO OR                                  27280028
269500               PS-DUPLICATE-SHIPMT                                27290028
269600                PERFORM 7010-CHECK-SHIPMT-SQLCODE                 27300028
269700                MOVE SHIPMT-COMPLETE-PRO-NBR                      27310028
269800                                    TO PW-SHIPMT-COMP-PRO         27320028
269900                MOVE SHIPMT-COMPLETE-BOL-NBR                      27330028
270000                                    TO PW-SHIPMT-COMP-BOL         27340028
270100            ELSE                                                  27350028
270200                PERFORM 7030-SELECT-SHIPMT                        27360028
270300                IF SQLCODE = ZERO OR                              27370028
270400                   PS-DUPLICATE-SHIPMT                            27380028
270500                    PERFORM 7010-CHECK-SHIPMT-SQLCODE             27390028
270600                    MOVE RC023-FREIGHT-BILL                       27400028
270700                                    TO PW-SHIPMT-PRO-NBR          27410028
270800                    MOVE SHIPMT-COMPLETE-BOL-NBR                  27420028
270900                                    TO PW-SHIPMT-COMP-BOL         27430028
271000                ELSE                                              27440028
271100                    PERFORM 7060-SELECT-SHIPMT                    27450028
271200                    IF SQLCODE = ZERO OR                          27460028
271300                       PS-DUPLICATE-SHIPMT                        27470028
271400                        PERFORM 7010-CHECK-SHIPMT-SQLCODE         27480028
271500                        MOVE RC023-BILL-OF-LADING                 27490028
271600                                    TO PW-SHIPMT-BOL-NBR          27500028
271700                        MOVE SHIPMT-COMPLETE-PRO-NBR              27510028
271800                                    TO PW-SHIPMT-COMP-PRO         27520028
271900                    ELSE                                          27530028
272000                        SET PS-INSERT-SHIPMT      TO TRUE         27540028
272100                    END-IF                                        27550028
272200                END-IF                                            27560028
272300            END-IF                                                27570028
272400        ELSE                                                      27580028
272500*---------------------------------------------------------------- 27590028
272600*   214-PRO-NBR FILLED IN AND 214-BOL-NBR IS BLANK                27600028
272700*   SHIPMENT PRO FILLED IN AND SHIPMENT BOL IS BLANK AS WELL      27610028
272800*---------------------------------------------------------------- 27620028
272900          PERFORM 7060-SELECT-SHIPMT                              27630028
273000          IF SQLCODE = ZERO OR                                    27640028
273100           PS-DUPLICATE-SHIPMT                                    27650028
273200             PERFORM 7010-CHECK-SHIPMT-SQLCODE                    27660028
273300             MOVE SHIPMT-COMPLETE-PRO-NBR                         27670028
273400                       TO PW-SHIPMT-COMP-PRO                      27680028
273500             MOVE SHIPMT-COMPLETE-BOL-NBR                         27690028
273600                       TO PW-SHIPMT-COMP-BOL                      27700028
273700          ELSE                                                    27710028
273800*---------------------------------------------------------------- 27720028
273900*   214-PRO-NBR FILLED IN AND 214-BOL-NBR IS BLANK                27730028
274000*   SHIPMENT PRO FILLED IN AND SHIPMENT BOL CAN BE ANYTHING       27740028
274100*---------------------------------------------------------------- 27750028
274200            PERFORM 7062-SELECT-SHIPMT                            27760028
274300            IF SQLCODE = ZERO OR                                  27770028
274400             PS-DUPLICATE-SHIPMT                                  27780028
274500                PERFORM 7010-CHECK-SHIPMT-SQLCODE                 27790028
274600                IF PS-NO-DUPLICATE-SHIPMT                         27800028
274700                   MOVE SHIPMT-COMPLETE-PRO-NBR                   27810028
274800                          TO PW-SHIPMT-COMP-PRO                   27820028
274900                   MOVE SHIPMT-COMPLETE-BOL-NBR                   27830028
275000                          TO PW-SHIPMT-COMP-BOL                   27840028
275100                END-IF                                            27850028
275200            ELSE                                                  27860028
275300                  SET PS-INSERT-SHIPMT      TO TRUE               27870028
275400            END-IF                                                27880028
275500          END-IF                                                  27890028
275600        END-IF                                                    27900028
275700     ELSE                                                         27910028
275800        IF RC023-BILL-OF-LADING > SPACES                          27920028
275900*---------------------------------------------------------------- 27930028
276000*   214-BOL-NBR FILLED IN AND 214-PRO-NBR IS BLANK                27940028
276100*   SHIPMENT BOL FILLED IN AND SHIPMENT PRO IS BLANK              27950028
276200*---------------------------------------------------------------- 27960028
276300           PERFORM 7030-SELECT-SHIPMT                             27970028
276400           IF SQLCODE = ZERO OR                                   27980028
276500            PS-DUPLICATE-SHIPMT                                   27990028
276600              PERFORM 7010-CHECK-SHIPMT-SQLCODE                   28000028
276700              MOVE SHIPMT-COMPLETE-BOL-NBR                        28010028
276800                          TO PW-SHIPMT-COMP-BOL                   28020028
276900              MOVE SHIPMT-COMPLETE-PRO-NBR                        28030028
277000                          TO PW-SHIPMT-COMP-PRO                   28040028
277100           ELSE                                                   28050028
277200*---------------------------------------------------------------- 28060028
277300*   214-BOL-NBR FILLED IN AND 214-PRO-NBR NOT FILLED AND          28070028
277400*   SHIPMENT BOL FILLED IN AND SHIPMENT PRO CAN BE ANYTHING       28080028
277500*---------------------------------------------------------------- 28090028
277600             PERFORM 7032-SELECT-SHIPMT                           28100028
277700             IF SQLCODE = ZERO OR                                 28110028
277800              PS-DUPLICATE-SHIPMT                                 28120028
277900                 PERFORM 7010-CHECK-SHIPMT-SQLCODE                28130028
278000                 IF PS-NO-DUPLICATE-SHIPMT                        28140028
278100                    MOVE SHIPMT-COMPLETE-BOL-NBR                  28150028
278200                              TO PW-SHIPMT-COMP-BOL               28160028
278300                    MOVE SHIPMT-COMPLETE-PRO-NBR                  28170028
278400                              TO PW-SHIPMT-COMP-PRO               28180028
278500                 END-IF                                           28190028
278600             ELSE                                                 28200028
278700                 SET PS-INSERT-SHIPMT      TO TRUE                28210028
278800             END-IF                                               28220028
278900           END-IF                                                 28230028
279000        END-IF                                                    28240028
279100     END-IF.                                                      28250028
279200 EJECT                                                            28260028
279300***************************************************************** 28270028
279400*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 28280028
279500*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 28290028
279600***************************************************************** 28300028
279700                                                                  28310028
279800 7000-SELECT-SHIPMT.                                              28320028
279900                                                                  28330028
280000     MOVE '7000-SELECT-SHIPMT'   TO PV-CURRENT-PARA.              28340028
280100                                                                  28350028
280200     PERFORM                                                      28360028
280300         WITH TEST AFTER                                          28370028
280400         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     28380028
280500         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            28390028
280600                 SQLCODE = ZERO    OR                             28400028
280700                 SQLCODE = PC-100  OR                             28410028
280800                 SQLCODE = PC-NEG-811                             28420028
280900                                                                  28430028
281000* ADDED CAN (CARR-AUTH-ID) BELOW CLT 02-12-2011 WR40574           28440028
281100         EXEC SQL                                                 28450028
281200             SELECT TRIP_ID,                                      28460028
281300                    SHIPT_ID,                                     28470028
281400                    CRT_SRC_CDE,                                  28480028
281500                    LAST_UPD_DTE,                                 28490028
281600                    LAST_UPD_TME,                                 28500028
281700                    LAST_UPD_UID,                                 28510028
281800                    PRO_SCAC_ID,                                  28520028
281900                    PRO_NBR,                                      28530028
282000                    BOL_NBR,                                      28540028
282100                    SHIPPER_NME,                                  28550028
282200                    SHIPT_TYP_CDE,                                28560028
282300                    EXPTED_GRO_WGHT,                              28570028
282400                    PKG_TYP_CDE,                                  28580028
282500                    EXPTED_PKG_QTY,                               28590028
282600                    FRGT_CHG_AMT,                                 28600028
282700                    FRGT_TERMS_CDE,                               28610028
282800                    EXPTED_PLT_QTY,                               28620028
282900                    EST_AR_TMST,                                  28630028
283000                    VEND_SHIP_DTE,                                28640028
283100                    ORIG_SCAC_ID,                                 28650028
283200                    LAST_UPD_PGM_ID,                              28660028
283300                    CRE_USER_ID,                                  28670028
283400                    CARR_CART_CT,                                 28680028
283500                    CARR_LAST_UPD_DTE,                            28690028
283600                    CARR_LAST_UPD_TIME,                           28700028
283700                    VEND_CART_CT,                                 28710028
283800                    VEND_LAST_UPD_DTE,                            28720028
283900                    VEND_LAST_UPD_TIME,                           28730028
284000                    VEH_NBR,                                      28740028
284100                    AUTH_NBR,                                     28750028
284200                    AUTH_DTE,                                     28760028
284300                    CONFIRM_DTE,                                  28770028
284400                    CONFIRM_TIME,                                 28780028
284500                    COMPLETE_PRO_NBR,                             28790028
284600                    COMPLETE_BOL_NBR,                             28800028
284700                    PROCESSED_DTE,                                28810028
284800                    INVC_NBR,                                     28820028
284900                    CARR_AUTH_ID                                  28830028
285000               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    28840028
285100                    :SHIPMT-SHIPT-ID,                             28850028
285200                    :SHIPMT-CRT-SRC-CDE,                          28860028
285300                    :SHIPMT-LAST-UPD-DTE,                         28870028
285400                    :SHIPMT-LAST-UPD-TME,                         28880028
285500                    :SHIPMT-LAST-UPD-UID,                         28890028
285600                    :SHIPMT-PRO-SCAC-ID,                          28900028
285700                    :SHIPMT-PRO-NBR,                              28910028
285800                    :SHIPMT-BOL-NBR,                              28920028
285900                    :SHIPMT-SHIPPER-NME,                          28930028
286000                    :SHIPMT-SHIPT-TYP-CDE,                        28940028
286100                    :SHIPMT-EXPTED-GRO-WGHT,                      28950028
286200                    :SHIPMT-PKG-TYP-CDE,                          28960028
286300                    :SHIPMT-EXPTED-PKG-QTY,                       28970028
286400                    :SHIPMT-FRGT-CHG-AMT,                         28980028
286500                    :SHIPMT-FRGT-TERMS-CDE,                       28990028
286600                    :SHIPMT-EXPTED-PLT-QTY,                       29000028
286700                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 29010028
286800                    :SHIPMT-VEND-SHIP-DTE,                        29020028
286900                    :SHIPMT-ORIG-SCAC-ID,                         29030028
287000                    :SHIPMT-LAST-UPD-PGM-ID,                      29040028
287100                    :SHIPMT-CRE-USER-ID,                          29050028
287200                    :SHIPMT-CARR-CART-CT,                         29060028
287300                    :SHIPMT-CARR-LAST-UPD-DTE,                    29070028
287400                    :SHIPMT-CARR-LAST-UPD-TIME,                   29080028
287500                    :SHIPMT-VEND-CART-CT,                         29090028
287600                    :SHIPMT-VEND-LAST-UPD-DTE,                    29100028
287700                    :SHIPMT-VEND-LAST-UPD-TIME,                   29110028
287800                    :SHIPMT-VEH-NBR,                              29120028
287900                    :SHIPMT-AUTH-NBR,                             29130028
288000                    :SHIPMT-AUTH-DTE,                             29140028
288100                    :SHIPMT-CONFIRM-DTE,                          29150028
288200                    :SHIPMT-CONFIRM-TIME,                         29160028
288300                    :SHIPMT-COMPLETE-PRO-NBR,                     29170028
288400                    :SHIPMT-COMPLETE-BOL-NBR,                     29180028
288500                    :SHIPMT-PROCESSED-DTE,                        29190028
288600                    :SHIPMT-INVC-NBR,                             29200028
288700                    :SHIPMT-CARR-AUTH-ID                          29210028
288800               FROM TSHIPMT                                       29220028
288900              WHERE PRO_SCAC_ID      = :PV-SCAC-ID                29230028
289000                AND PRO_NBR          = :PW-SHIPMT-PRO-NBR         29240028
289100                AND BOL_NBR          = :PW-SHIPMT-BOL-NBR         29250028
289200         END-EXEC                                                 29260028
289300                                                                  29270028
289400         EVALUATE TRUE                                            29280028
289500             WHEN SQLCODE = ZERO                                  29290028
289600             WHEN SQLCODE = PC-100                                29300028
289700             WHEN SQLCODE = PC-NEG-904                            29310028
289800             WHEN SQLCODE = PC-NEG-913                            29320028
289900                 CONTINUE                                         29330028
290000                                                                  29340028
290100             WHEN SQLCODE = PC-NEG-811                            29350028
290200                 SET PS-DUPLICATE-SHIPMT TO TRUE                  29360028
290300                                                                  29370028
290400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              29380028
290500                 DISPLAY '**************************************' 29390028
290600                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 29400028
290700                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               29410028
290800                          PW-SHIPMT-PRO-NBR                       29420028
290900                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               29430028
291000                          PW-SHIPMT-BOL-NBR                       29440028
291100                 DISPLAY '**********************************'     29450028
291200                 PERFORM 9800-SQL-WARNING                         29460028
291300                                                                  29470028
291400             WHEN SQLCODE < ZERO                                  29480028
291500                 DISPLAY '**************************************' 29490028
291600                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 29500028
291700                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               29510028
291800                          PW-SHIPMT-PRO-NBR                       29520028
291900                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               29530028
292000                          PW-SHIPMT-BOL-NBR                       29540028
292100                 DISPLAY '**************************************' 29550028
292200                 PERFORM 9900-SQL-ERROR                           29560028
292300                                                                  29570028
292400         END-EVALUATE                                             29580028
292500                                                                  29590028
292600     END-PERFORM.                                                 29600028
292700                                                                  29610028
292800     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    29620028
292900         SQLCODE NOT = ZERO                                       29630028
293000         DISPLAY '**************************************'         29640028
293100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         29650028
293200         DISPLAY 'SELECT TSHIPMT                        '         29660028
293300         DISPLAY 'PW-SHIPMT-PRO-NBR:      '                       29670028
293400                  PW-SHIPMT-PRO-NBR                               29680028
293500         DISPLAY 'PW-SHIPMT-BOL-NBR:      '                       29690028
293600                  PW-SHIPMT-BOL-NBR                               29700028
293700         DISPLAY '**************************************'         29710028
293800         PERFORM 9900-SQL-ERROR                                   29720028
293900     END-IF.                                                      29730028
294000                                                                  29740028
294100 EJECT                                                            29750028
294200***************************************************************** 29760028
294300*     CHECK THE SQLCODE FROM THE SELECT OF THE TSHIPMT.  MOVE   * 29770028
294400*     FIELDS AS APPROPRIATE.                                    * 29780028
294500***************************************************************** 29790028
294600                                                                  29800028
294700 7010-CHECK-SHIPMT-SQLCODE.                                       29810028
294800                                                                  29820028
294900     MOVE '7010-CHECK-SHIPMT-SQLCODE'                             29830028
295000                                 TO PV-CURRENT-PARA.              29840028
295100                                                                  29850028
295200     EVALUATE TRUE                                                29860028
295300         WHEN SQLCODE = ZERO                                      29870028
295400             IF PV-SHIPMT-TRIP-ID-NULL = PC-NEG-1                 29880028
295500                 MOVE ZEROS      TO PW-SHIPMT-TRIP-ID             29890028
295600             ELSE                                                 29900028
295700                 MOVE SHIPMT-TRIP-ID                              29910028
295800                                 TO PW-SHIPMT-TRIP-ID             29920028
295900             END-IF                                               29930028
296000             MOVE PW-SHIPMT-TRIP-ID                               29940028
296100                                 TO PW-SAVE-SHIPMT-TRIP-ID        29950028
296200             MOVE SHIPMT-SHIPT-ID                                 29960028
296300                                 TO PW-SHIPMT-SHIPT-ID            29970028
296400             MOVE SHIPMT-CRT-SRC-CDE                              29980028
296500                                 TO PW-SHIPMT-CRT-SRC-CDE         29990028
296600             MOVE SHIPMT-LAST-UPD-DTE                             30000028
296700                                 TO PW-SHIPMT-LAST-UPD-DTE        30010028
296800             MOVE SHIPMT-LAST-UPD-TME                             30020028
296900                                 TO PW-SHIPMT-LAST-UPD-TME        30030028
297000             MOVE SHIPMT-LAST-UPD-UID                             30040028
297100                                 TO PW-SHIPMT-LAST-UPD-UID        30050028
297200             MOVE SHIPMT-PRO-SCAC-ID                              30060028
297300                                 TO PW-SHIPMT-PRO-SCAC-ID         30070028
297400             MOVE SHIPMT-PRO-NBR TO PW-SHIPMT-PRO-NBR             30080028
297500             MOVE SHIPMT-BOL-NBR TO PW-SHIPMT-BOL-NBR             30090028
297600             MOVE SHIPMT-SHIPPER-NME                              30100028
297700                                 TO PW-SHIPMT-SHIPPER-NME         30110028
297800             MOVE SHIPMT-SHIPT-TYP-CDE                            30120028
297900                                 TO PW-SHIPMT-SHIPT-TYP-CDE       30130028
298000             MOVE SHIPMT-EXPTED-GRO-WGHT                          30140028
298100                                 TO PW-SHIPMT-EXPTED-GRO-WGHT     30150028
298200             MOVE SHIPMT-PKG-TYP-CDE                              30160028
298300                                 TO PW-SHIPMT-PKG-TYP-CDE         30170028
298400             MOVE SHIPMT-EXPTED-PKG-QTY                           30180028
298500                                 TO PW-SHIPMT-EXPTED-PKG-QTY      30190028
298600             MOVE SHIPMT-FRGT-CHG-AMT                             30200028
298700                                 TO PW-SHIPMT-FRGT-CHG-AMT        30210028
298800             MOVE SHIPMT-FRGT-TERMS-CDE                           30220028
298900                                 TO PW-SHIPMT-FRGT-TERMS-CDE      30230028
299000             MOVE SHIPMT-EXPTED-PLT-QTY                           30240028
299100                                 TO PW-SHIPMT-EXPTED-PLT-QTY      30250028
299200             MOVE SHIPMT-EST-AR-TMST                              30260028
299300                                 TO PW-SHIPMT-EST-AR-TMST         30270028
299400             MOVE SHIPMT-CARR-CART-CT                             30280028
299500                                 TO PW-SHIPMT-CARR-CARTON-CNT     30290028
299600             MOVE SHIPMT-ORIG-SCAC-ID                             30300028
299700                                 TO PW-SHIPMT-ORIGIN-SCAC-ID      30310028
299800             MOVE SHIPMT-VEH-NBR TO PW-SHIPMT-VEH-NBR             30320028
299900             PERFORM 7450-SELECT-SHIP-STATUS                      30330028
300000             PERFORM 7470-SELECT-SHPTPO                           30340028
300100         WHEN SQLCODE = PC-100                                    30350028
300200         WHEN SQLCODE = PC-NEG-811                                30360028
300300             SET PS-INSERT-SHIPMT                                 30370028
300400                                 TO TRUE                          30380028
300500     END-EVALUATE.                                                30390028
300600                                                                  30400028
300700 EJECT                                                            30410028
300800***************************************************************** 30420028
300900*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 30430028
301000*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 30440028
301100***************************************************************** 30450028
301200                                                                  30460028
301300 7030-SELECT-SHIPMT.                                              30470028
301400                                                                  30480028
301500     MOVE '7030-SELECT-SHIPMT'   TO PV-CURRENT-PARA.              30490028
301600                                                                  30500028
301700     PERFORM                                                      30510028
301800         WITH TEST AFTER                                          30520028
301900         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     30530028
302000         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            30540028
302100                 SQLCODE = ZERO    OR                             30550028
302200                 SQLCODE = PC-100  OR                             30560028
302300                 SQLCODE = PC-NEG-811                             30570028
302400                                                                  30580028
302500* ADDED CAN (CARR-AUTH-ID) BELOW CLT 02-12-2011 WR40574           30590028
302600         EXEC SQL                                                 30600028
302700             SELECT TRIP_ID,                                      30610028
302800                    SHIPT_ID,                                     30620028
302900                    CRT_SRC_CDE,                                  30630028
303000                    LAST_UPD_DTE,                                 30640028
303100                    LAST_UPD_TME,                                 30650028
303200                    LAST_UPD_UID,                                 30660028
303300                    PRO_SCAC_ID,                                  30670028
303400                    PRO_NBR,                                      30680028
303500                    BOL_NBR,                                      30690028
303600                    SHIPPER_NME,                                  30700028
303700                    SHIPT_TYP_CDE,                                30710028
303800                    EXPTED_GRO_WGHT,                              30720028
303900                    PKG_TYP_CDE,                                  30730028
304000                    EXPTED_PKG_QTY,                               30740028
304100                    FRGT_CHG_AMT,                                 30750028
304200                    FRGT_TERMS_CDE,                               30760028
304300                    EXPTED_PLT_QTY,                               30770028
304400                    EST_AR_TMST,                                  30780028
304500                    VEND_SHIP_DTE,                                30790028
304600                    ORIG_SCAC_ID,                                 30800028
304700                    LAST_UPD_PGM_ID,                              30810028
304800                    CRE_USER_ID,                                  30820028
304900                    CARR_CART_CT,                                 30830028
305000                    CARR_LAST_UPD_DTE,                            30840028
305100                    CARR_LAST_UPD_TIME,                           30850028
305200                    VEND_CART_CT,                                 30860028
305300                    VEND_LAST_UPD_DTE,                            30870028
305400                    VEND_LAST_UPD_TIME,                           30880028
305500                    VEH_NBR,                                      30890028
305600                    AUTH_NBR,                                     30900028
305700                    AUTH_DTE,                                     30910028
305800                    CONFIRM_DTE,                                  30920028
305900                    CONFIRM_TIME,                                 30930028
306000                    COMPLETE_PRO_NBR,                             30940028
306100                    COMPLETE_BOL_NBR,                             30950028
306200                    PROCESSED_DTE,                                30960028
306300                    INVC_NBR,                                     30970028
306400                    CARR_AUTH_ID                                  30980028
306500               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    30990028
306600                    :SHIPMT-SHIPT-ID,                             31000028
306700                    :SHIPMT-CRT-SRC-CDE,                          31010028
306800                    :SHIPMT-LAST-UPD-DTE,                         31020028
306900                    :SHIPMT-LAST-UPD-TME,                         31030028
307000                    :SHIPMT-LAST-UPD-UID,                         31040028
307100                    :SHIPMT-PRO-SCAC-ID,                          31050028
307200                    :SHIPMT-PRO-NBR,                              31060028
307300                    :SHIPMT-BOL-NBR,                              31070028
307400                    :SHIPMT-SHIPPER-NME,                          31080028
307500                    :SHIPMT-SHIPT-TYP-CDE,                        31090028
307600                    :SHIPMT-EXPTED-GRO-WGHT,                      31100028
307700                    :SHIPMT-PKG-TYP-CDE,                          31110028
307800                    :SHIPMT-EXPTED-PKG-QTY,                       31120028
307900                    :SHIPMT-FRGT-CHG-AMT,                         31130028
308000                    :SHIPMT-FRGT-TERMS-CDE,                       31140028
308100                    :SHIPMT-EXPTED-PLT-QTY,                       31150028
308200                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 31160028
308300                    :SHIPMT-VEND-SHIP-DTE,                        31170028
308400                    :SHIPMT-ORIG-SCAC-ID,                         31180028
308500                    :SHIPMT-LAST-UPD-PGM-ID,                      31190028
308600                    :SHIPMT-CRE-USER-ID,                          31200028
308700                    :SHIPMT-CARR-CART-CT,                         31210028
308800                    :SHIPMT-CARR-LAST-UPD-DTE,                    31220028
308900                    :SHIPMT-CARR-LAST-UPD-TIME,                   31230028
309000                    :SHIPMT-VEND-CART-CT,                         31240028
309100                    :SHIPMT-VEND-LAST-UPD-DTE,                    31250028
309200                    :SHIPMT-VEND-LAST-UPD-TIME,                   31260028
309300                    :SHIPMT-VEH-NBR,                              31270028
309400                    :SHIPMT-AUTH-NBR,                             31280028
309500                    :SHIPMT-AUTH-DTE,                             31290028
309600                    :SHIPMT-CONFIRM-DTE,                          31300028
309700                    :SHIPMT-CONFIRM-TIME,                         31310028
309800                    :SHIPMT-COMPLETE-PRO-NBR,                     31320028
309900                    :SHIPMT-COMPLETE-BOL-NBR,                     31330028
310000                    :SHIPMT-PROCESSED-DTE,                        31340028
310100                    :SHIPMT-INVC-NBR,                             31350028
310200                    :SHIPMT-CARR-AUTH-ID                          31360028
310300               FROM TSHIPMT                                       31370028
310400              WHERE PRO_SCAC_ID      = :PV-SCAC-ID                31380028
310500                AND BOL_NBR          = :PW-SHIPMT-BOL-NBR         31390028
310600                AND PRO_NBR          = :PC-PRO-SPACES             31400028
310700         END-EXEC                                                 31410028
310800                                                                  31420028
310900         EVALUATE TRUE                                            31430028
311000             WHEN SQLCODE = ZERO                                  31440028
311100             WHEN SQLCODE = PC-100                                31450028
311200             WHEN SQLCODE = PC-NEG-904                            31460028
311300             WHEN SQLCODE = PC-NEG-913                            31470028
311400                 CONTINUE                                         31480028
311500                                                                  31490028
311600             WHEN SQLCODE = PC-NEG-811                            31500028
311700                 SET PS-DUPLICATE-SHIPMT TO TRUE                  31510028
311800                                                                  31520028
311900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              31530028
312000                 DISPLAY '**************************************' 31540028
312100                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 31550028
312200                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               31560028
312300                          PW-SHIPMT-PRO-NBR                       31570028
312400                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               31580028
312500                          PW-SHIPMT-BOL-NBR                       31590028
312600                 DISPLAY '**********************************'     31600028
312700                 PERFORM 9800-SQL-WARNING                         31610028
312800                                                                  31620028
312900             WHEN SQLCODE < ZERO                                  31630028
313000                 DISPLAY '**************************************' 31640028
313100                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 31650028
313200                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               31660028
313300                          PW-SHIPMT-PRO-NBR                       31670028
313400                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               31680028
313500                          PW-SHIPMT-BOL-NBR                       31690028
313600                 DISPLAY '**************************************' 31700028
313700                 PERFORM 9900-SQL-ERROR                           31710028
313800                                                                  31720028
313900         END-EVALUATE                                             31730028
314000                                                                  31740028
314100     END-PERFORM.                                                 31750028
314200                                                                  31760028
314300     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    31770028
314400         SQLCODE NOT = ZERO                                       31780028
314500         DISPLAY '**************************************'         31790028
314600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         31800028
314700         DISPLAY 'SELECT TSHIPMT                        '         31810028
314800         DISPLAY 'PW-SHIPMT-PRO-NBR:      '                       31820028
314900                  PW-SHIPMT-PRO-NBR                               31830028
315000         DISPLAY 'PW-SHIPMT-BOL-NBR:      '                       31840028
315100                  PW-SHIPMT-BOL-NBR                               31850028
315200         DISPLAY '**************************************'         31860028
315300         PERFORM 9900-SQL-ERROR                                   31870028
315400     END-IF.                                                      31880028
315500                                                                  31890028
315600 EJECT                                                            31900028
315700***************************************************************** 31910028
315800*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 31920028
315900*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 31930028
316000***************************************************************** 31940028
316100                                                                  31950028
316200 7032-SELECT-SHIPMT.                                              31960028
316300                                                                  31970028
316400     MOVE '7032-SELECT-SHIPMT'   TO PV-CURRENT-PARA.              31980028
316500                                                                  31990028
316600     PERFORM                                                      32000028
316700         WITH TEST AFTER                                          32010028
316800         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     32020028
316900         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            32030028
317000                 SQLCODE = ZERO    OR                             32040028
317100                 SQLCODE = PC-100  OR                             32050028
317200                 SQLCODE = PC-NEG-811                             32060028
317300                                                                  32070028
317400* ADDED CAN (CARR-AUTH-ID) BELOW CLT 02-12-2011 WR40574           32080028
317500         EXEC SQL                                                 32090028
317600             SELECT TRIP_ID,                                      32100028
317700                    SHIPT_ID,                                     32110028
317800                    CRT_SRC_CDE,                                  32120028
317900                    LAST_UPD_DTE,                                 32130028
318000                    LAST_UPD_TME,                                 32140028
318100                    LAST_UPD_UID,                                 32150028
318200                    PRO_SCAC_ID,                                  32160028
318300                    PRO_NBR,                                      32170028
318400                    BOL_NBR,                                      32180028
318500                    SHIPPER_NME,                                  32190028
318600                    SHIPT_TYP_CDE,                                32200028
318700                    EXPTED_GRO_WGHT,                              32210028
318800                    PKG_TYP_CDE,                                  32220028
318900                    EXPTED_PKG_QTY,                               32230028
319000                    FRGT_CHG_AMT,                                 32240028
319100                    FRGT_TERMS_CDE,                               32250028
319200                    EXPTED_PLT_QTY,                               32260028
319300                    EST_AR_TMST,                                  32270028
319400                    VEND_SHIP_DTE,                                32280028
319500                    ORIG_SCAC_ID,                                 32290028
319600                    LAST_UPD_PGM_ID,                              32300028
319700                    CRE_USER_ID,                                  32310028
319800                    CARR_CART_CT,                                 32320028
319900                    CARR_LAST_UPD_DTE,                            32330028
320000                    CARR_LAST_UPD_TIME,                           32340028
320100                    VEND_CART_CT,                                 32350028
320200                    VEND_LAST_UPD_DTE,                            32360028
320300                    VEND_LAST_UPD_TIME,                           32370028
320400                    VEH_NBR,                                      32380028
320500                    AUTH_NBR,                                     32390028
320600                    AUTH_DTE,                                     32400028
320700                    CONFIRM_DTE,                                  32410028
320800                    CONFIRM_TIME,                                 32420028
320900                    COMPLETE_PRO_NBR,                             32430028
321000                    COMPLETE_BOL_NBR,                             32440028
321100                    PROCESSED_DTE,                                32450028
321200                    INVC_NBR,                                     32460028
321300                    CARR_AUTH_ID                                  32470028
321400               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    32480028
321500                    :SHIPMT-SHIPT-ID,                             32490028
321600                    :SHIPMT-CRT-SRC-CDE,                          32500028
321700                    :SHIPMT-LAST-UPD-DTE,                         32510028
321800                    :SHIPMT-LAST-UPD-TME,                         32520028
321900                    :SHIPMT-LAST-UPD-UID,                         32530028
322000                    :SHIPMT-PRO-SCAC-ID,                          32540028
322100                    :SHIPMT-PRO-NBR,                              32550028
322200                    :SHIPMT-BOL-NBR,                              32560028
322300                    :SHIPMT-SHIPPER-NME,                          32570028
322400                    :SHIPMT-SHIPT-TYP-CDE,                        32580028
322500                    :SHIPMT-EXPTED-GRO-WGHT,                      32590028
322600                    :SHIPMT-PKG-TYP-CDE,                          32600028
322700                    :SHIPMT-EXPTED-PKG-QTY,                       32610028
322800                    :SHIPMT-FRGT-CHG-AMT,                         32620028
322900                    :SHIPMT-FRGT-TERMS-CDE,                       32630028
323000                    :SHIPMT-EXPTED-PLT-QTY,                       32640028
323100                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 32650028
323200                    :SHIPMT-VEND-SHIP-DTE,                        32660028
323300                    :SHIPMT-ORIG-SCAC-ID,                         32670028
323400                    :SHIPMT-LAST-UPD-PGM-ID,                      32680028
323500                    :SHIPMT-CRE-USER-ID,                          32690028
323600                    :SHIPMT-CARR-CART-CT,                         32700028
323700                    :SHIPMT-CARR-LAST-UPD-DTE,                    32710028
323800                    :SHIPMT-CARR-LAST-UPD-TIME,                   32720028
323900                    :SHIPMT-VEND-CART-CT,                         32730028
324000                    :SHIPMT-VEND-LAST-UPD-DTE,                    32740028
324100                    :SHIPMT-VEND-LAST-UPD-TIME,                   32750028
324200                    :SHIPMT-VEH-NBR,                              32760028
324300                    :SHIPMT-AUTH-NBR,                             32770028
324400                    :SHIPMT-AUTH-DTE,                             32780028
324500                    :SHIPMT-CONFIRM-DTE,                          32790028
324600                    :SHIPMT-CONFIRM-TIME,                         32800028
324700                    :SHIPMT-COMPLETE-PRO-NBR,                     32810028
324800                    :SHIPMT-COMPLETE-BOL-NBR,                     32820028
324900                    :SHIPMT-PROCESSED-DTE,                        32830028
325000                    :SHIPMT-INVC-NBR,                             32840028
325100                    :SHIPMT-CARR-AUTH-ID                          32850028
325200               FROM TSHIPMT                                       32860028
325300              WHERE PRO_SCAC_ID      = :PV-SCAC-ID                32870028
325400                AND BOL_NBR          = :PW-SHIPMT-BOL-NBR         32880028
325500         END-EXEC                                                 32890028
325600                                                                  32900028
325700         EVALUATE TRUE                                            32910028
325800             WHEN SQLCODE = ZERO                                  32920028
325900             WHEN SQLCODE = PC-100                                32930028
326000             WHEN SQLCODE = PC-NEG-904                            32940028
326100             WHEN SQLCODE = PC-NEG-913                            32950028
326200                 CONTINUE                                         32960028
326300                                                                  32970028
326400             WHEN SQLCODE = PC-NEG-811                            32980028
326500                 SET PS-DUPLICATE-SHIPMT TO TRUE                  32990028
326600                                                                  33000028
326700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              33010028
326800                 DISPLAY '**************************************' 33020028
326900                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 33030028
327000                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               33040028
327100                          PW-SHIPMT-PRO-NBR                       33050028
327200                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               33060028
327300                          PW-SHIPMT-BOL-NBR                       33070028
327400                 DISPLAY '**********************************'     33080028
327500                 PERFORM 9800-SQL-WARNING                         33090028
327600                                                                  33100028
327700             WHEN SQLCODE < ZERO                                  33110028
327800                 DISPLAY '**************************************' 33120028
327900                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 33130028
328000                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               33140028
328100                          PW-SHIPMT-PRO-NBR                       33150028
328200                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               33160028
328300                          PW-SHIPMT-BOL-NBR                       33170028
328400                 DISPLAY '**************************************' 33180028
328500                 PERFORM 9900-SQL-ERROR                           33190028
328600                                                                  33200028
328700         END-EVALUATE                                             33210028
328800                                                                  33220028
328900     END-PERFORM.                                                 33230028
329000                                                                  33240028
329100     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    33250028
329200         SQLCODE NOT = ZERO                                       33260028
329300         DISPLAY '**************************************'         33270028
329400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         33280028
329500         DISPLAY 'SELECT TSHIPMT                        '         33290028
329600         DISPLAY 'PW-SHIPMT-PRO-NBR:      '                       33300028
329700                  PW-SHIPMT-PRO-NBR                               33310028
329800         DISPLAY 'PW-SHIPMT-BOL-NBR:      '                       33320028
329900                  PW-SHIPMT-BOL-NBR                               33330028
330000         DISPLAY '**************************************'         33340028
330100         PERFORM 9900-SQL-ERROR                                   33350028
330200     END-IF.                                                      33360028
330300                                                                  33370028
330400 EJECT                                                            33380028
330500***************************************************************** 33390028
330600*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 33400028
330700*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 33410028
330800***************************************************************** 33420028
330900                                                                  33430028
331000 7060-SELECT-SHIPMT.                                              33440028
331100                                                                  33450028
331200     MOVE '7060-SELECT-SHIPMT'   TO PV-CURRENT-PARA.              33460028
331300                                                                  33470028
331400     PERFORM                                                      33480028
331500         WITH TEST AFTER                                          33490028
331600         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     33500028
331700         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            33510028
331800                 SQLCODE = ZERO    OR                             33520028
331900                 SQLCODE = PC-100  OR                             33530028
332000                 SQLCODE = PC-NEG-811                             33540028
332100                                                                  33550028
332200* ADDED CAN (CARR-AUTH-ID) BELOW CLT 02-12-2011 WR40574           33560028
332300         EXEC SQL                                                 33570028
332400             SELECT TRIP_ID,                                      33580028
332500                    SHIPT_ID,                                     33590028
332600                    CRT_SRC_CDE,                                  33600028
332700                    LAST_UPD_DTE,                                 33610028
332800                    LAST_UPD_TME,                                 33620028
332900                    LAST_UPD_UID,                                 33630028
333000                    PRO_SCAC_ID,                                  33640028
333100                    PRO_NBR,                                      33650028
333200                    BOL_NBR,                                      33660028
333300                    SHIPPER_NME,                                  33670028
333400                    SHIPT_TYP_CDE,                                33680028
333500                    EXPTED_GRO_WGHT,                              33690028
333600                    PKG_TYP_CDE,                                  33700028
333700                    EXPTED_PKG_QTY,                               33710028
333800                    FRGT_CHG_AMT,                                 33720028
333900                    FRGT_TERMS_CDE,                               33730028
334000                    EXPTED_PLT_QTY,                               33740028
334100                    EST_AR_TMST,                                  33750028
334200                    VEND_SHIP_DTE,                                33760028
334300                    ORIG_SCAC_ID,                                 33770028
334400                    LAST_UPD_PGM_ID,                              33780028
334500                    CRE_USER_ID,                                  33790028
334600                    CARR_CART_CT,                                 33800028
334700                    CARR_LAST_UPD_DTE,                            33810028
334800                    CARR_LAST_UPD_TIME,                           33820028
334900                    VEND_CART_CT,                                 33830028
335000                    VEND_LAST_UPD_DTE,                            33840028
335100                    VEND_LAST_UPD_TIME,                           33850028
335200                    VEH_NBR,                                      33860028
335300                    AUTH_NBR,                                     33870028
335400                    AUTH_DTE,                                     33880028
335500                    CONFIRM_DTE,                                  33890028
335600                    CONFIRM_TIME,                                 33900028
335700                    COMPLETE_PRO_NBR,                             33910028
335800                    COMPLETE_BOL_NBR,                             33920028
335900                    PROCESSED_DTE,                                33930028
336000                    INVC_NBR,                                     33940028
336100                    CARR_AUTH_ID                                  33950028
336200               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    33960028
336300                    :SHIPMT-SHIPT-ID,                             33970028
336400                    :SHIPMT-CRT-SRC-CDE,                          33980028
336500                    :SHIPMT-LAST-UPD-DTE,                         33990028
336600                    :SHIPMT-LAST-UPD-TME,                         34000028
336700                    :SHIPMT-LAST-UPD-UID,                         34010028
336800                    :SHIPMT-PRO-SCAC-ID,                          34020028
336900                    :SHIPMT-PRO-NBR,                              34030028
337000                    :SHIPMT-BOL-NBR,                              34040028
337100                    :SHIPMT-SHIPPER-NME,                          34050028
337200                    :SHIPMT-SHIPT-TYP-CDE,                        34060028
337300                    :SHIPMT-EXPTED-GRO-WGHT,                      34070028
337400                    :SHIPMT-PKG-TYP-CDE,                          34080028
337500                    :SHIPMT-EXPTED-PKG-QTY,                       34090028
337600                    :SHIPMT-FRGT-CHG-AMT,                         34100028
337700                    :SHIPMT-FRGT-TERMS-CDE,                       34110028
337800                    :SHIPMT-EXPTED-PLT-QTY,                       34120028
337900                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 34130028
338000                    :SHIPMT-VEND-SHIP-DTE,                        34140028
338100                    :SHIPMT-ORIG-SCAC-ID,                         34150028
338200                    :SHIPMT-LAST-UPD-PGM-ID,                      34160028
338300                    :SHIPMT-CRE-USER-ID,                          34170028
338400                    :SHIPMT-CARR-CART-CT,                         34180028
338500                    :SHIPMT-CARR-LAST-UPD-DTE,                    34190028
338600                    :SHIPMT-CARR-LAST-UPD-TIME,                   34200028
338700                    :SHIPMT-VEND-CART-CT,                         34210028
338800                    :SHIPMT-VEND-LAST-UPD-DTE,                    34220028
338900                    :SHIPMT-VEND-LAST-UPD-TIME,                   34230028
339000                    :SHIPMT-VEH-NBR,                              34240028
339100                    :SHIPMT-AUTH-NBR,                             34250028
339200                    :SHIPMT-AUTH-DTE,                             34260028
339300                    :SHIPMT-CONFIRM-DTE,                          34270028
339400                    :SHIPMT-CONFIRM-TIME,                         34280028
339500                    :SHIPMT-COMPLETE-PRO-NBR,                     34290028
339600                    :SHIPMT-COMPLETE-BOL-NBR,                     34300028
339700                    :SHIPMT-PROCESSED-DTE,                        34310028
339800                    :SHIPMT-INVC-NBR,                             34320028
339900                    :SHIPMT-CARR-AUTH-ID                          34330028
340000               FROM TSHIPMT                                       34340028
340100              WHERE PRO_SCAC_ID      = :PV-SCAC-ID                34350028
340200                AND PRO_NBR          = :PW-SHIPMT-PRO-NBR         34360028
340300                AND BOL_NBR          = :PC-BOL-SPACES             34370028
340400         END-EXEC                                                 34380028
340500                                                                  34390028
340600         EVALUATE TRUE                                            34400028
340700             WHEN SQLCODE = ZERO                                  34410028
340800             WHEN SQLCODE = PC-100                                34420028
340900             WHEN SQLCODE = PC-NEG-904                            34430028
341000             WHEN SQLCODE = PC-NEG-913                            34440028
341100                 CONTINUE                                         34450028
341200                                                                  34460028
341300             WHEN SQLCODE = PC-NEG-811                            34470028
341400                 SET PS-DUPLICATE-SHIPMT TO TRUE                  34480028
341500                                                                  34490028
341600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              34500028
341700                 DISPLAY '**************************************' 34510028
341800                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 34520028
341900                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               34530028
342000                          PW-SHIPMT-PRO-NBR                       34540028
342100                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               34550028
342200                          PW-SHIPMT-BOL-NBR                       34560028
342300                 DISPLAY '**********************************'     34570028
342400                 PERFORM 9800-SQL-WARNING                         34580028
342500                                                                  34590028
342600             WHEN SQLCODE < ZERO                                  34600028
342700                 DISPLAY '**************************************' 34610028
342800                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 34620028
342900                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               34630028
343000                          PW-SHIPMT-PRO-NBR                       34640028
343100                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               34650028
343200                          PW-SHIPMT-BOL-NBR                       34660028
343300                 DISPLAY '**************************************' 34670028
343400                 PERFORM 9900-SQL-ERROR                           34680028
343500                                                                  34690028
343600         END-EVALUATE                                             34700028
343700                                                                  34710028
343800     END-PERFORM.                                                 34720028
343900                                                                  34730028
344000     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    34740028
344100         SQLCODE NOT = ZERO                                       34750028
344200         DISPLAY '**************************************'         34760028
344300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         34770028
344400         DISPLAY 'SELECT TSHIPMT                        '         34780028
344500         DISPLAY 'PW-SHIPMT-PRO-NBR:      '                       34790028
344600                  PW-SHIPMT-PRO-NBR                               34800028
344700         DISPLAY 'PW-SHIPMT-BOL-NBR:      '                       34810028
344800                  PW-SHIPMT-BOL-NBR                               34820028
344900         DISPLAY '**************************************'         34830028
345000         PERFORM 9900-SQL-ERROR                                   34840028
345100     END-IF.                                                      34850028
345200                                                                  34860028
345300 EJECT                                                            34870028
345400***************************************************************** 34880028
345500*     DO A SELECT ON SHIPMT USING THE PRO-NBR TO DETERMINE IF   * 34890028
345600*     IF THE INPUT RECORD SHOULD BE AN INSERT OR AN UPDATE.     * 34900028
345700***************************************************************** 34910028
345800                                                                  34920028
345900 7062-SELECT-SHIPMT.                                              34930028
346000                                                                  34940028
346100     MOVE '7062-SELECT-SHIPMT'   TO PV-CURRENT-PARA.              34950028
346200                                                                  34960028
346300     PERFORM                                                      34970028
346400         WITH TEST AFTER                                          34980028
346500         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     34990028
346600         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            35000028
346700                 SQLCODE = ZERO    OR                             35010028
346800                 SQLCODE = PC-100  OR                             35020028
346900                 SQLCODE = PC-NEG-811                             35030028
347000                                                                  35040028
347100* ADDED CAN (CARR-AUTH-ID) BELOW CLT 02-12-2011 WR40574           35050028
347200         EXEC SQL                                                 35060028
347300             SELECT TRIP_ID,                                      35070028
347400                    SHIPT_ID,                                     35080028
347500                    CRT_SRC_CDE,                                  35090028
347600                    LAST_UPD_DTE,                                 35100028
347700                    LAST_UPD_TME,                                 35110028
347800                    LAST_UPD_UID,                                 35120028
347900                    PRO_SCAC_ID,                                  35130028
348000                    PRO_NBR,                                      35140028
348100                    BOL_NBR,                                      35150028
348200                    SHIPPER_NME,                                  35160028
348300                    SHIPT_TYP_CDE,                                35170028
348400                    EXPTED_GRO_WGHT,                              35180028
348500                    PKG_TYP_CDE,                                  35190028
348600                    EXPTED_PKG_QTY,                               35200028
348700                    FRGT_CHG_AMT,                                 35210028
348800                    FRGT_TERMS_CDE,                               35220028
348900                    EXPTED_PLT_QTY,                               35230028
349000                    EST_AR_TMST,                                  35240028
349100                    VEND_SHIP_DTE,                                35250028
349200                    ORIG_SCAC_ID,                                 35260028
349300                    LAST_UPD_PGM_ID,                              35270028
349400                    CRE_USER_ID,                                  35280028
349500                    CARR_CART_CT,                                 35290028
349600                    CARR_LAST_UPD_DTE,                            35300028
349700                    CARR_LAST_UPD_TIME,                           35310028
349800                    VEND_CART_CT,                                 35320028
349900                    VEND_LAST_UPD_DTE,                            35330028
350000                    VEND_LAST_UPD_TIME,                           35340028
350100                    VEH_NBR,                                      35350028
350200                    AUTH_NBR,                                     35360028
350300                    AUTH_DTE,                                     35370028
350400                    CONFIRM_DTE,                                  35380028
350500                    CONFIRM_TIME,                                 35390028
350600                    COMPLETE_PRO_NBR,                             35400028
350700                    COMPLETE_BOL_NBR,                             35410028
350800                    PROCESSED_DTE,                                35420028
350900                    INVC_NBR,                                     35430028
351000                    CARR_AUTH_ID                                  35440028
351100               INTO :SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,    35450028
351200                    :SHIPMT-SHIPT-ID,                             35460028
351300                    :SHIPMT-CRT-SRC-CDE,                          35470028
351400                    :SHIPMT-LAST-UPD-DTE,                         35480028
351500                    :SHIPMT-LAST-UPD-TME,                         35490028
351600                    :SHIPMT-LAST-UPD-UID,                         35500028
351700                    :SHIPMT-PRO-SCAC-ID,                          35510028
351800                    :SHIPMT-PRO-NBR,                              35520028
351900                    :SHIPMT-BOL-NBR,                              35530028
352000                    :SHIPMT-SHIPPER-NME,                          35540028
352100                    :SHIPMT-SHIPT-TYP-CDE,                        35550028
352200                    :SHIPMT-EXPTED-GRO-WGHT,                      35560028
352300                    :SHIPMT-PKG-TYP-CDE,                          35570028
352400                    :SHIPMT-EXPTED-PKG-QTY,                       35580028
352500                    :SHIPMT-FRGT-CHG-AMT,                         35590028
352600                    :SHIPMT-FRGT-TERMS-CDE,                       35600028
352700                    :SHIPMT-EXPTED-PLT-QTY,                       35610028
352800                    :SHIPMT-EST-AR-TMST   :PV-SHIPMT-EST-AR-NULL, 35620028
352900                    :SHIPMT-VEND-SHIP-DTE,                        35630028
353000                    :SHIPMT-ORIG-SCAC-ID,                         35640028
353100                    :SHIPMT-LAST-UPD-PGM-ID,                      35650028
353200                    :SHIPMT-CRE-USER-ID,                          35660028
353300                    :SHIPMT-CARR-CART-CT,                         35670028
353400                    :SHIPMT-CARR-LAST-UPD-DTE,                    35680028
353500                    :SHIPMT-CARR-LAST-UPD-TIME,                   35690028
353600                    :SHIPMT-VEND-CART-CT,                         35700028
353700                    :SHIPMT-VEND-LAST-UPD-DTE,                    35710028
353800                    :SHIPMT-VEND-LAST-UPD-TIME,                   35720028
353900                    :SHIPMT-VEH-NBR,                              35730028
354000                    :SHIPMT-AUTH-NBR,                             35740028
354100                    :SHIPMT-AUTH-DTE,                             35750028
354200                    :SHIPMT-CONFIRM-DTE,                          35760028
354300                    :SHIPMT-CONFIRM-TIME,                         35770028
354400                    :SHIPMT-COMPLETE-PRO-NBR,                     35780028
354500                    :SHIPMT-COMPLETE-BOL-NBR,                     35790028
354600                    :SHIPMT-PROCESSED-DTE,                        35800028
354700                    :SHIPMT-INVC-NBR,                             35810028
354800                    :SHIPMT-CARR-AUTH-ID                          35820028
354900               FROM TSHIPMT                                       35830028
355000              WHERE PRO_SCAC_ID      = :PV-SCAC-ID                35840028
355100                AND PRO_NBR          = :PW-SHIPMT-PRO-NBR         35850028
355200         END-EXEC                                                 35860028
355300                                                                  35870028
355400         EVALUATE TRUE                                            35880028
355500             WHEN SQLCODE = ZERO                                  35890028
355600             WHEN SQLCODE = PC-100                                35900028
355700             WHEN SQLCODE = PC-NEG-904                            35910028
355800             WHEN SQLCODE = PC-NEG-913                            35920028
355900                 CONTINUE                                         35930028
356000                                                                  35940028
356100             WHEN SQLCODE = PC-NEG-811                            35950028
356200                 SET PS-DUPLICATE-SHIPMT TO TRUE                  35960028
356300                                                                  35970028
356400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              35980028
356500                 DISPLAY '**************************************' 35990028
356600                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 36000028
356700                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               36010028
356800                          PW-SHIPMT-PRO-NBR                       36020028
356900                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               36030028
357000                          PW-SHIPMT-BOL-NBR                       36040028
357100                 DISPLAY '**********************************'     36050028
357200                 PERFORM 9800-SQL-WARNING                         36060028
357300                                                                  36070028
357400             WHEN SQLCODE < ZERO                                  36080028
357500                 DISPLAY '**************************************' 36090028
357600                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 36100028
357700                 DISPLAY 'PW-SHIPMT-PRO-NBR:      '               36110028
357800                          PW-SHIPMT-PRO-NBR                       36120028
357900                 DISPLAY 'PW-SHIPMT-BOL-NBR:      '               36130028
358000                          PW-SHIPMT-BOL-NBR                       36140028
358100                 DISPLAY '**************************************' 36150028
358200                 PERFORM 9900-SQL-ERROR                           36160028
358300                                                                  36170028
358400         END-EVALUATE                                             36180028
358500                                                                  36190028
358600     END-PERFORM.                                                 36200028
358700                                                                  36210028
358800     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    36220028
358900         SQLCODE NOT = ZERO                                       36230028
359000         DISPLAY '**************************************'         36240028
359100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         36250028
359200         DISPLAY 'SELECT TSHIPMT                        '         36260028
359300         DISPLAY 'PW-SHIPMT-PRO-NBR:      '                       36270028
359400                  PW-SHIPMT-PRO-NBR                               36280028
359500         DISPLAY 'PW-SHIPMT-BOL-NBR:      '                       36290028
359600                  PW-SHIPMT-BOL-NBR                               36300028
359700         DISPLAY '**************************************'         36310028
359800         PERFORM 9900-SQL-ERROR                                   36320028
359900     END-IF.                                                      36330028
360000                                                                  36340028
360100 EJECT                                                            36350028
360200***************************************************************** 36360028
360300*     DO A SELECT ON SHIPMT USING THE SHIPT-ID NUMBER TO SEE IF * 36370028
360400*     THE RANDOM NUMBER GENERATOR HAS ALREADY PRODUCED THIS NBR.* 36380028
360500***************************************************************** 36390028
360600                                                                  36400028
360700 7100-CHECK-IF-SHIPT-ID-USED.                                     36410028
360800                                                                  36420028
360900     MOVE '7100-CHECK-IF-SHIPT-ID-USED'                           36430028
361000                                 TO PV-CURRENT-PARA.              36440028
361100                                                                  36450028
361200     PERFORM                                                      36460028
361300         WITH TEST AFTER                                          36470028
361400         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     36480028
361500         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            36490028
361600                 SQLCODE = ZERO    OR                             36500028
361700                 SQLCODE = PC-100                                 36510028
361800                                                                  36520028
361900         EXEC SQL                                                 36530028
362000             SELECT SHIPT_ID                                      36540028
362100               INTO :PV-SHIPT-ID                                  36550028
362200               FROM TSHIPMT                                       36560028
362300              WHERE SHIPT_ID = :PV-RANDOM-NBR                     36570028
362400         END-EXEC                                                 36580028
362500                                                                  36590028
362600         EVALUATE TRUE                                            36600028
362700             WHEN SQLCODE = ZERO                                  36610028
362800             WHEN SQLCODE = PC-100                                36620028
362900             WHEN SQLCODE = PC-NEG-904                            36630028
363000             WHEN SQLCODE = PC-NEG-913                            36640028
363100                 CONTINUE                                         36650028
363200                                                                  36660028
363300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              36670028
363400                 DISPLAY '**************************************' 36680028
363500                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPMT   ' 36690028
363600                 DISPLAY 'PV-RANDOM-NBR: '  PV-RANDOM-NBR         36700028
363700                 DISPLAY '**********************************'     36710028
363800                 PERFORM 9800-SQL-WARNING                         36720028
363900                                                                  36730028
364000             WHEN SQLCODE < ZERO                                  36740028
364100                 DISPLAY '**************************************' 36750028
364200                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPMT     ' 36760028
364300                 DISPLAY 'PV-RANDOM-NBR: '  PV-RANDOM-NBR         36770028
364400                 DISPLAY '**************************************' 36780028
364500                 PERFORM 9900-SQL-ERROR                           36790028
364600                                                                  36800028
364700         END-EVALUATE                                             36810028
364800                                                                  36820028
364900     END-PERFORM.                                                 36830028
365000                                                                  36840028
365100     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    36850028
365200         SQLCODE NOT = ZERO                                       36860028
365300         DISPLAY '**************************************'         36870028
365400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         36880028
365500         DISPLAY 'SELECT TSHIPMT                        '         36890028
365600         DISPLAY 'PV-RANDOM-NBR: '  PV-RANDOM-NBR                 36900028
365700         DISPLAY '**************************************'         36910028
365800         PERFORM 9900-SQL-ERROR                                   36920028
365900     END-IF.                                                      36930028
366000                                                                  36940028
366100 EJECT                                                            36950028
366200***************************************************************** 36960028
366300*     DO A SELECT ON THE STORE TABLE TO VERIFY THAT THE STORE   * 36970028
366400*     NUMBER SENT ON THE EDI TRANSMISSION IS VALID.             * 36980028
366500***************************************************************** 36990028
366600                                                                  37000028
366700 7200-VERIFY-OPER-UNT-ID.                                         37010028
366800                                                                  37020028
366900     MOVE '7200-VERIFY-OPER-UNT-ID'                               37030028
367000                                 TO PV-CURRENT-PARA.              37040028
367100                                                                  37050028
367200     MOVE TR001-N104-OPER-UNT-ID (1:9)                            37060028
367300                                 TO PV-OPER-UNT-FCLTY.            37070028
367400     MOVE SPACES                 TO PV-OPER-UNIT                  37080028
367500                                    PV-FACILITY.                  37090028
367600     MOVE PC-1                   TO PW-I-SUB                      37100028
367700                                    PW-O-SUB.                     37110028
367800                                                                  37120028
367900     PERFORM                                                      37130028
368000         UNTIL PV-OPER-UNT-FCLTY-DIGIT (PW-I-SUB) = SPACES        37140028
368100            OR PW-I-SUB > 5                                       37150028
368200                MOVE PV-OPER-UNT-FCLTY-DIGIT (PW-I-SUB)           37160028
368300                                 TO PV-OPER-UNIT-DIGIT (PW-O-SUB) 37170028
368400                ADD PC-1         TO PW-I-SUB                      37180028
368500                                    PW-O-SUB                      37190028
368600     END-PERFORM.                                                 37200028
368700                                                                  37210028
368800     MOVE PC-1                   TO PW-O-SUB.                     37220028
368900                                                                  37230028
369000     PERFORM                                                      37240028
369100         UNTIL PW-O-SUB > 5                                       37250028
369200            OR PW-I-SUB > 9                                       37260028
369300                IF PV-OPER-UNT-FCLTY-DIGIT (PW-I-SUB) > SPACES    37270028
369400                    MOVE PV-OPER-UNT-FCLTY-DIGIT (PW-I-SUB)       37280028
369500                                 TO PV-FCLTY-ID-DIGIT (PW-O-SUB)  37290028
369600                    ADD PC-1     TO PW-O-SUB                      37300028
369700                END-IF                                            37310028
369800                ADD PC-1         TO PW-I-SUB                      37320028
369900     END-PERFORM.                                                 37330028
370000                                                                  37340028
370100     MOVE PV-OPER-UNIT           TO DP010I-UNEDITED-FIELD.        37350028
370200                                                                  37360028
370300     PERFORM 7250-CALL-NUMERIC-SUBROUTINE.                        37370028
370400                                                                  37380028
370500     MOVE DP010I-NUMERIC-FIELD   TO PV-OPER-UNT-ID                37390028
370600                                    PV-OPER-UNIT-N.               37400028
370700                                                                  37410028
370800     MOVE PV-FACILITY            TO DP010I-UNEDITED-FIELD.        37420028
370900                                                                  37430028
371000     PERFORM 7250-CALL-NUMERIC-SUBROUTINE.                        37440028
371100                                                                  37450028
371200     MOVE DP010I-NUMERIC-FIELD   TO PV-FCLTY-ID                   37460028
371300                                    PV-FACILITY-N.                37470028
371400                                                                  37480028
371500     IF PV-FCLTY-ID = ZERO                                        37490028
371600         MOVE PC-1               TO PV-FCLTY-ID                   37500028
371700                                    PV-FACILITY-N                 37510028
371800     END-IF.                                                      37520028
371900                                                                  37530028
372000     PERFORM                                                      37540028
372100         WITH TEST AFTER                                          37550028
372200         VARYING PW-RETRY-COUNTER                                 37560028
372300         FROM 1 BY 1                                              37570028
372400         UNTIL ((PW-RETRY-COUNTER > PC-MAX-RETRIES)               37580028
372500                   OR (SQLCODE = ZERO)                            37590028
372600                   OR (SQLCODE = +100)                            37600028
372700                   OR (SQLCODE = -811))                           37610028
372800                                                                  37620028
372900         EXEC SQL                                                 37630028
373000            SELECT  OPER_UNT_ID                                   37640028
373100              INTO :FACLTY-OPER-UNT-ID                            37650028
373200              FROM  TFACLTY                                       37660028
373300             WHERE  OPER_UNT_ID = :PV-OPER-UNT-ID                 37670028
373400               AND  FCLTY_ID    = :PV-FCLTY-ID                    37680028
373500         END-EXEC                                                 37690028
373600                                                                  37700028
373700         EVALUATE TRUE                                            37710028
373800             WHEN SQLCODE = ZERO                                  37720028
373900             WHEN SQLCODE = +100                                  37730028
374000             WHEN SQLCODE = -811                                  37740028
374100             WHEN SQLCODE = -904                                  37750028
374200             WHEN SQLCODE = -913                                  37760028
374300                 CONTINUE                                         37770028
374400                                                                  37780028
374500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              37790028
374600                 DISPLAY '**************************************' 37800028
374700                 DISPLAY 'WARNING ISSUED ON SELECT OF TFACLTY   ' 37810028
374800                 DISPLAY 'PV-OPER-UNT-ID: '                       37820028
374900                          PV-OPER-UNT-ID                          37830028
375000                         'PV-FCLTY-ID: '                          37840028
375100                          PV-FCLTY-ID                             37850028
375200                 DISPLAY '**********************************'     37860028
375300                 PERFORM 9800-SQL-WARNING                         37870028
375400                                                                  37880028
375500             WHEN SQLCODE < ZERO                                  37890028
375600                 DISPLAY '**************************************' 37900028
375700                 DISPLAY 'ERROR ISSUED ON SELECT OF TFACLTY     ' 37910028
375800                 DISPLAY 'PV-OPER-UNT-ID: '                       37920028
375900                          PV-OPER-UNT-ID                          37930028
376000                         'PV-FCLTY-ID: '                          37940028
376100                          PV-FCLTY-ID                             37950028
376200                 DISPLAY '**************************************' 37960028
376300                 PERFORM 9900-SQL-ERROR                           37970028
376400         END-EVALUATE                                             37980028
376500     END-PERFORM.                                                 37990028
376600                                                                  38000028
376700     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    38010028
376800         SQLCODE NOT = ZERO                                       38020028
376900         DISPLAY '**************************************'         38030028
377000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         38040028
377100         DISPLAY 'SELECT FROM TFACLTY                   '         38050028
377200         DISPLAY 'PV-OPER-UNT-ID: '                               38060028
377300                  PV-OPER-UNT-ID                                  38070028
377400                 'PV-FCLTY-ID: '                                  38080028
377500                  PV-FCLTY-ID                                     38090028
377600         DISPLAY '**************************************'         38100028
377700         PERFORM 9900-SQL-ERROR                                   38110028
377800     END-IF.                                                      38120028
377900                                                                  38130028
378000     EVALUATE TRUE                                                38140028
378100         WHEN SQLCODE = ZERO                                      38150028
378200         WHEN SQLCODE = -811                                      38160028
378300             SET PS-VALID-OPER-UNT-ID                             38170028
378400                                 TO TRUE                          38180028
378500                                                                  38190028
378600         WHEN SQLCODE = PC-100                                    38200028
378700             SET PS-INVALID-OPER-UNT-ID                           38210028
378800                                 TO TRUE                          38220028
378900                                                                  38230028
379000     END-EVALUATE.                                                38240028
379100                                                                  38250028
379200 EJECT                                                            38260028
379300***************************************************************** 38270028
379400*     CONVERT THE OPERATING UNIT AND FACILITY TO ALL NUMERIC    * 38280028
379500***************************************************************** 38290028
379600                                                                  38300028
379700 7250-CALL-NUMERIC-SUBROUTINE.                                    38310028
379800                                                                  38320028
379900     MOVE '7250-CALL-NUMERIC-SUBROUTINE'                          38330028
380000                                 TO PV-CURRENT-PARA.              38340028
380100     MOVE PC-4                   TO DP010I-MAXIMUM-DIGITS.        38350028
380200     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      38360028
380300                                                                  38370028
380400     SET DP010I-NEGATIVE-NOT-ALLOWED                              38380028
380500                                 TO TRUE.                         38390028
380600                                                                  38400028
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                             38411054
263697          USING DP010I-NUMERIC-EDIT-AREA.                         38412054
380800                                                                  38420028
380900     IF DP010I-ERROR-DETECTED                                     38430028
381000         DISPLAY 'ERROR IN CONVERTING OPER UNT/FCLTY TO NUMERIC: '38440028
381100                  DP010I-UNEDITED-FIELD                           38450028
381200     END-IF.                                                      38460028
381300                                                                  38470028
381400 EJECT                                                            38480028
381500***************************************************************** 38490028
381600*     CHECK IF PURCHASE ORDER IS NUMERIC.  IF SO CALL IMS PO DB * 38500028
381700***************************************************************** 38510028
381800                                                                  38520028
381900 7300-VERIFY-PO.                                                  38530028
382000                                                                  38540028
382100     MOVE '7300-VERIFY-PO'       TO PV-CURRENT-PARA.              38550028
382200                                                                  38560028
C98147     MOVE SPACES                 TO PV-VALUE2-8.                  38570050
382300     IF TR001-N902-REF-NBR (1:2) = ZEROES                         38580042
C98147        IF TR001-N902-REF-NBR (10:1) = SPACE                      38590050
C98147**        PROCESSING A 7 DIGIT PO NUMBER                          38600050
C98147            MOVE TR001-N902-REF-NBR (3:7)                         38610050
C98147                                 TO PV-VALUE2-8                   38620050
C98147            MOVE PV-VALUE1-8     TO DP010I-UNEDITED-FIELD         38630050
C98147         ELSE                                                     38640050
C98147**        PROCESSING A 8 DIGIT PO NUMBER                          38650050
C98147            MOVE TR001-N902-REF-NBR (3:8)                         38660050
026300                                 TO DP010I-UNEDITED-FIELD         38670040
C98147         END-IF                                                   38680050
382600     ELSE                                                         38690028
C98147        IF TR001-N902-REF-NBR (8:1) = SPACE                       38700050
C98147**        PROCESSING A 7 DIGIT PO NUMBER                          38710050
C98147            MOVE TR001-N902-REF-NBR (1:7)                         38720050
C98147                                 TO PV-VALUE2-8                   38730050
C98147            MOVE PV-VALUE1-8     TO DP010I-UNEDITED-FIELD         38740050
C98147         ELSE                                                     38750050
C98147**        PROCESSING A 8 DIGIT PO NUMBER                          38760050
C98147            MOVE TR001-N902-REF-NBR (1:8)                         38770050
026300                                 TO DP010I-UNEDITED-FIELD         38780040
C98147         END-IF                                                   38790050
382900     END-IF.                                                      38800028
383000                                                                  38810028
382400*PS 11/03/2014 CHANGE STARTS                                      38820038
383100     MOVE PC-8                   TO DP010I-MAXIMUM-DIGITS.        38830038
382400*PS 11/03/2014 CHANGE ENDS                                        38840038
383200     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      38850028
383300                                                                  38860028
383400     SET DP010I-NEGATIVE-NOT-ALLOWED                              38870028
383500                                 TO TRUE.                         38880028
383600                                                                  38890028
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                             38901054
263697          USING DP010I-NUMERIC-EDIT-AREA.                         38902054
383800                                                                  38910028
383900     IF DP010I-ERROR-DETECTED                                     38920028
384000         SET PS-INVALID-PO       TO TRUE                          38930028
384100     ELSE                                                         38940028
384200         SET PS-VALID-PO         TO TRUE                          38950028
384300         MOVE DP010I-NUMERIC-FIELD                                38960042
384400                                 TO PV-UNPK-PO                    38970028
384500         MOVE PV-UNPK-PO         TO PURCHS-PO-NBR                 38980028
384600         PERFORM 7350-VERIFY-PO                                   38990028
384700         IF PURCHS-PO-NBR = ZERO                                  39000028
384800             SET PS-INVALID-PO       TO TRUE                      39010042
384900         END-IF                                                   39020028
385000     END-IF.                                                      39030028
385100                                                                  39040028
385200 EJECT                                                            39050028
385300***************************************************************** 39060028
385400*     VERIFY THE PURCHASE ORDER EXISTS                          * 39070028
385500***************************************************************** 39080028
385600                                                                  39090028
385700 7350-VERIFY-PO.                                                  39100028
385800                                                                  39110028
385900     MOVE '7350-VERIFY-PO'       TO PV-CURRENT-PARA.              39120028
386000                                                                  39130028
386100     PERFORM                                                      39140028
386200         WITH TEST AFTER                                          39150028
386300         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     39160028
386400         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            39170028
386500                 SQLCODE = ZERO OR                                39180028
386600                 SQLCODE = PC-100                                 39190028
386700                                                                  39200028
386800         EXEC SQL                                                 39210028
386900             SELECT ENT_ID                                        39220028
387000               INTO :PURCHS-ENT-ID                                39230028
387100               FROM TPURCHS                                       39240028
387200              WHERE PO_NBR         = :PURCHS-PO-NBR               39250028
387300                AND VER_STATUS_CDE = :PC-A                        39260028
387400         END-EXEC                                                 39270028
387500                                                                  39280028
387600         EVALUATE TRUE                                            39290042
387700             WHEN SQLCODE = ZERO                                  39300028
387800             WHEN SQLCODE = PC-100                                39310028
387900             WHEN SQLCODE = PC-NEG-904                            39320028
388000             WHEN SQLCODE = PC-NEG-913                            39330028
388100                 CONTINUE                                         39340028
388200                                                                  39350028
388300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              39360028
388400                 DISPLAY '**************************************' 39370028
388500                 DISPLAY 'WARNING ISSUED ON SELECT OF TPURCHS   ' 39380028
388600                 DISPLAY 'PURCHS-PO-NBR: ' PURCHS-PO-NBR          39390028
388700                 DISPLAY '**************************************' 39400028
388800                 PERFORM 9800-SQL-WARNING                         39410028
388900                                                                  39420028
389000             WHEN SQLCODE < ZERO                                  39430028
389100                 DISPLAY '**************************************' 39440028
389200                 DISPLAY 'ERROR ISSUED ON SELECT OF TPURCHS     ' 39450028
389300                 DISPLAY 'PURCHS-PO-NBR: ' PURCHS-PO-NBR          39460028
389400                 DISPLAY '**************************************' 39470028
389500                 PERFORM 9900-SQL-ERROR                           39480028
389600                                                                  39490028
389700         END-EVALUATE                                             39500028
389800                                                                  39510028
389900     END-PERFORM.                                                 39520028
390000                                                                  39530028
390100     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    39540028
390200         SQLCODE NOT = ZERO                                       39550028
390300         DISPLAY '**************************************'         39560028
390400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         39570028
390500         DISPLAY 'SELECT TPURCHS                        '         39580028
390600         DISPLAY 'PURCHS-PO-NBR:          '                       39590028
390700                  PURCHS-PO-NBR                                   39600028
390800         DISPLAY 'PW-SHIPMT-PRO-NBR:      '                       39610028
390900                  PW-SHIPMT-PRO-NBR                               39620028
391000         DISPLAY 'PW-SHIPMT-BOL-NBR:      '                       39630028
391100                  PW-SHIPMT-BOL-NBR                               39640028
391200         DISPLAY '**************************************'         39650028
391300         PERFORM 9900-SQL-ERROR                                   39660028
391400     END-IF.                                                      39670028
391500                                                                  39680028
391600     EVALUATE TRUE                                                39690028
391700         WHEN SQLCODE = ZERO                                      39700028
391800             CONTINUE                                             39710028
391900                                                                  39720028
392000         WHEN SQLCODE = PC-100                                    39730028
392100             MOVE ZEROS          TO PURCHS-PO-NBR                 39740028
392200                                    PURCHS-ENT-ID                 39750028
392300     END-EVALUATE.                                                39760028
392400                                                                  39770028
392500 EJECT                                                            39780028
392600***************************************************************** 39790028
392700*     DO A SELECT ON THE SHSTYP TABLE TO VERIFY THAT THE        * 39800028
392800*     SHIPMENT STATUS CODE TRANSMITTED IS VALID.                * 39810028
392900***************************************************************** 39820028
393000                                                                  39830028
393100 7400-VERIFY-SHIPT-STATUS.                                        39840028
393200                                                                  39850028
393300     MOVE '7400-VERIFY-SHIPT-STATUS'                              39860028
393400                                 TO PV-CURRENT-PARA.              39870028
393500                                                                  39880028
393600     PERFORM                                                      39890028
393700         WITH TEST AFTER                                          39900028
393800         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     39910028
393900         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            39920028
394000                 SQLCODE = ZERO OR                                39930028
394100                 SQLCODE = PC-100                                 39940028
394200                                                                  39950028
394300         EXEC SQL                                                 39960028
394400             SELECT SHIPT_STATUS_CDE,                             39970028
394500                    PRTY_CDE                                      39980028
394600               INTO :SHSTYP-SHIPT-STATUS-CDE,                     39990028
394700                    :SHSTYP-PRTY-CDE                              40000028
394800               FROM TSHSTYP                                       40010028
394900              WHERE SHIPT_STATUS_CDE = :PV-SHIPT-STATUS-CDE       40020028
395000         END-EXEC                                                 40030028
395100                                                                  40040028
395200         EVALUATE TRUE                                            40050028
395300             WHEN SQLCODE = ZERO                                  40060028
395400             WHEN SQLCODE = +100                                  40070028
395500             WHEN SQLCODE = PC-NEG-904                            40080028
395600             WHEN SQLCODE = PC-NEG-913                            40090028
395700                 CONTINUE                                         40100028
395800                                                                  40110028
395900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              40120028
396000                 DISPLAY '**************************************' 40130028
396100                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHSTYP   ' 40140028
396200                 DISPLAY 'PV-SHIPT-STATUS-CDE: '                  40150028
396300                          PV-SHIPT-STATUS-CDE                     40160028
396400                 DISPLAY '**********************************'     40170028
396500                 PERFORM 9800-SQL-WARNING                         40180028
396600                                                                  40190028
396700             WHEN SQLCODE < ZERO                                  40200028
396800                 DISPLAY '**************************************' 40210028
396900                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHSTYP     ' 40220028
397000                 DISPLAY 'PV-SHIPT-STATUS-CDE: '                  40230028
397100                          PV-SHIPT-STATUS-CDE                     40240028
397200                 DISPLAY '**************************************' 40250028
397300                 PERFORM 9900-SQL-ERROR                           40260028
397400                                                                  40270028
397500         END-EVALUATE                                             40280028
397600                                                                  40290028
397700     END-PERFORM.                                                 40300028
397800                                                                  40310028
397900     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    40320028
398000         SQLCODE NOT = ZERO                                       40330028
398100         DISPLAY '**************************************'         40340028
398200         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         40350028
398300         DISPLAY 'SELECT TSHSTYP                        '         40360028
398400         DISPLAY 'PV-SHIPT-STATUS-CDE: '                          40370028
398500                  PV-SHIPT-STATUS-CDE                             40380028
398600         DISPLAY 'PW-SHIPMT-PRO-NBR:   '                          40390028
398700                  PW-SHIPMT-PRO-NBR                               40400028
398800         DISPLAY 'PW-SHIPMT-BOL-NBR:   '                          40410028
398900                  PW-SHIPMT-BOL-NBR                               40420028
399000         DISPLAY '**************************************'         40430028
399100         PERFORM 9900-SQL-ERROR                                   40440028
399200     END-IF.                                                      40450028
399300                                                                  40460028
399400     EVALUATE TRUE                                                40470028
399500         WHEN SQLCODE = ZERO                                      40480028
399600             SET PS-VALID-SHIPT-STATUS                            40490028
399700                                 TO TRUE                          40500028
399800                                                                  40510028
399900         WHEN SQLCODE = PC-100                                    40520028
400000             SET PS-INVALID-SHIPT-STATUS                          40530028
400100                                 TO TRUE                          40540028
400200     END-EVALUATE.                                                40550028
400300                                                                  40560028
400400                                                                  40570028
400500 EJECT                                                            40580028
400600***************************************************************** 40590028
400700*     DO A SELECT ON THE SHIP STATUS                            * 40600028
400800***************************************************************** 40610028
400900 7450-SELECT-SHIP-STATUS.                                         40620028
401000                                                                  40630028
401100     MOVE '7450-SELECT-SHIP-STATUS'                               40640028
401200                                 TO PV-CURRENT-PARA.              40650028
401300                                                                  40660028
401400     PERFORM                                                      40670028
401500         WITH TEST AFTER                                          40680028
401600         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     40690028
401700         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            40700028
401800                 SQLCODE = ZERO OR                                40710028
401900                 SQLCODE = PC-100                                 40720028
402000                                                                  40730028
402100         EXEC SQL                                                 40740028
402200           SELECT B.PRTY_CDE                                      40750028
402300           INTO  :SHSTYP-PRTY-CDE                                 40760028
402400           FROM   TSHIPST A                                       40770028
402500                 ,TSHSTYP B                                       40780028
402600           WHERE  A.SHIPT_ID         = :PW-SHIPMT-SHIPT-ID        40790028
402700             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         40800028
402800             AND  B.PRTY_CDE =                                    40810028
402900                  (SELECT MAX(D.PRTY_CDE)                         40820028
403000                     FROM TSHIPST C                               40830028
403100                         ,TSHSTYP D                               40840028
403200                    WHERE C.SHIPT_ID        = A.SHIPT_ID          40850028
403300                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)40860028
403310           WITH UR                                                40870032
403400         END-EXEC                                                 40880028
403500                                                                  40890028
403600         EVALUATE TRUE                                            40900028
403700             WHEN SQLCODE = ZERO                                  40910028
403800             WHEN SQLCODE = +100                                  40920028
403900             WHEN SQLCODE = PC-NEG-904                            40930028
404000             WHEN SQLCODE = PC-NEG-913                            40940028
404100                 CONTINUE                                         40950028
404200                                                                  40960028
404300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              40970028
404400                 DISPLAY '**************************************' 40980028
404500                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHSTYP   ' 40990028
404600                 DISPLAY 'PW-SHIPMT-SHIPT-ID: '                   41000028
404700                          PW-SHIPMT-SHIPT-ID                      41010028
404800                 DISPLAY '**********************************'     41020028
404900                 PERFORM 9800-SQL-WARNING                         41030028
405000                                                                  41040028
405100             WHEN SQLCODE < ZERO                                  41050028
405200                 DISPLAY '**************************************' 41060028
405300                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHSTYP     ' 41070028
405400                 DISPLAY 'PW-SHIPMT-SHIPT-ID: '                   41080028
405500                          PW-SHIPMT-SHIPT-ID                      41090028
405600                 DISPLAY '**************************************' 41100028
405700                 PERFORM 9900-SQL-ERROR                           41110028
405800                                                                  41120028
405900         END-EVALUATE                                             41130028
406000                                                                  41140028
406100     END-PERFORM.                                                 41150028
406200                                                                  41160028
406300     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    41170028
406400         SQLCODE NOT = ZERO                                       41180028
406500         DISPLAY '**************************************'         41190028
406600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         41200028
406700         DISPLAY 'SELECT TSHSTYP                        '         41210028
406800         DISPLAY 'PW-SHIPMT-SHIPT-ID: '                           41220028
406900                  PW-SHIPMT-SHIPT-ID                              41230028
407000         DISPLAY '**************************************'         41240028
407100         PERFORM 9900-SQL-ERROR                                   41250028
407200     END-IF.                                                      41260028
407300                                                                  41270028
407400     IF SQLCODE = ZERO                                            41280028
407500         IF SHSTYP-PRTY-CDE > PC-49                               41290028
407600             SET PS-DONT-UPDATE-SHIPMT                            41300028
407700                 PS-BYPASS-UPDATES                                41310028
407800                 PS-SHSTYP-PRTY-ERR                               41320028
407900                                 TO TRUE                          41330028
408000             MOVE PC-032 TO PW-ERROR-NBR (PW-INDEX)               41340028
408100             PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                 41350028
408200         ELSE                                                     41360028
408300             SET PS-UPDATE-SHIPMT                                 41370028
408400                                 TO TRUE                          41380028
408500         END-IF                                                   41390028
408600     ELSE                                                         41400028
408700         SET PS-UPDATE-SHIPMT                                     41410028
408800                             TO TRUE                              41420028
408900     END-IF.                                                      41430028
409000                                                                  41440028
409100 EJECT                                                            41450028
409200***************************************************************** 41460028
409300*     DO A SELECT ON THE SHIP PO TO SEE IF THERE IS ALREADY     * 41470028
409400*     A RECEIVER                                                * 41480028
409500***************************************************************** 41490028
409600 7470-SELECT-SHPTPO.                                              41500028
409700                                                                  41510028
409800     MOVE '7470-SELECT-SHPTPO     '                               41520028
409900                                 TO PV-CURRENT-PARA.              41530028
410000                                                                  41540028
410100     EXEC SQL                                                     41550028
410200          SELECT MAX(REC_SEQ_NBR)                                 41560028
410300            INTO :PV-REC-SEQ-NBR :PV-SHPTPO-REC-SEQ-NBR-NULL      41570028
410400            FROM TSHPTPO                                          41580028
410500           WHERE SHIPT_ID       = :SHIPMT-SHIPT-ID                41590028
410600     END-EXEC.                                                    41600028
410700                                                                  41610028
410800     EVALUATE TRUE                                                41620028
410900         WHEN SQLCODE = ZERO                                      41630028
411000         WHEN SQLCODE = -811                                      41640028
411100            IF PV-REC-SEQ-NBR > 0                                 41650028
411200                SET PS-DONT-UPDATE-SHIPMT                         41660028
411300                    PS-SHIP-REC-MORE-THAN-ZERO                    41670028
411400                    PS-BYPASS-UPDATES TO TRUE                     41680028
411500            END-IF                                                41690028
411600                                                                  41700028
411700         WHEN SQLCODE = +100                                      41710028
411800            MOVE 0 TO PV-REC-SEQ-NBR                              41720028
411900                                                                  41730028
412000         WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                  41740028
412100             DISPLAY '**************************************'     41750028
412200             DISPLAY 'WARNING ISSUED ON SELECT OF TSHSTYP   '     41760028
412300             DISPLAY 'PW-SHIPMT-SHIPT-ID: '                       41770028
412400                      PW-SHIPMT-SHIPT-ID                          41780028
412500             DISPLAY '**********************************'         41790028
412600             PERFORM 9800-SQL-WARNING                             41800028
412700                                                                  41810028
412800         WHEN SQLCODE < ZERO                                      41820028
412900             DISPLAY '**************************************'     41830028
413000             DISPLAY 'ERROR ISSUED ON SELECT OF TSHSTYP     '     41840028
413100             DISPLAY 'PW-SHIPMT-SHIPT-ID: '                       41850028
413200                      PW-SHIPMT-SHIPT-ID                          41860028
413300             DISPLAY '**************************************'     41870028
413400             PERFORM 9900-SQL-ERROR                               41880028
413500                                                                  41890028
413600     END-EVALUATE.                                                41900028
413700                                                                  41910028
413800 EJECT                                                            41920028
413900***************************************************************** 41930028
414000*     DO A SELECT ON THE PKGTYP TABLE TO VERIFY THAT THE        * 41940028
414100*     PACKAGE TYPE CODE TRANSMITTED IS VALID.                   * 41950028
414200***************************************************************** 41960028
414300                                                                  41970028
414400 7500-VERIFY-PKG-TYP-CDE.                                         41980028
414500                                                                  41990028
414600     MOVE '7500-VERIFY-PKG-TYP-CDE'                               42000028
414700                                 TO PV-CURRENT-PARA.              42010028
414800                                                                  42020028
414900     MOVE TR001-Q605-PKG-TYP-CDE TO PV-PKG-TYP-CDE.               42030028
415000                                                                  42040028
415100     PERFORM                                                      42050028
415200         WITH TEST AFTER                                          42060028
415300         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     42070028
415400         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            42080028
415500                 SQLCODE = ZERO OR                                42090028
415600                 SQLCODE = PC-100                                 42100028
415700                                                                  42110028
415800         EXEC SQL                                                 42120028
415900             SELECT PKG_TYP_CDE                                   42130028
416000               INTO :PKGTYP-PKG-TYP-CDE                           42140028
416100               FROM TPKGTYP                                       42150028
416200              WHERE PKG_TYP_CDE = :PV-PKG-TYP-CDE                 42160028
416300         END-EXEC                                                 42170028
416400                                                                  42180028
416500         EVALUATE TRUE                                            42190028
416600             WHEN SQLCODE = ZERO                                  42200028
416700             WHEN SQLCODE = +100                                  42210028
416800             WHEN SQLCODE = PC-NEG-904                            42220028
416900             WHEN SQLCODE = PC-NEG-913                            42230028
417000                 CONTINUE                                         42240028
417100                                                                  42250028
417200             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              42260028
417300                 DISPLAY '**************************************' 42270028
417400                 DISPLAY 'WARNING ISSUED ON SELECT OF TPKGTYP   ' 42280028
417500                 DISPLAY 'PV-PKG-TYP-CDE: '                       42290028
417600                          PV-PKG-TYP-CDE                          42300028
417700                 DISPLAY '**********************************'     42310028
417800                 PERFORM 9800-SQL-WARNING                         42320028
417900                                                                  42330028
418000             WHEN SQLCODE < ZERO                                  42340028
418100                 DISPLAY '**************************************' 42350028
418200                 DISPLAY 'ERROR ISSUED ON SELECT OF TPKGTYP     ' 42360028
418300                 DISPLAY 'PV-PKG-TYP-CDE: '                       42370028
418400                          PV-PKG-TYP-CDE                          42380028
418500                 DISPLAY '**************************************' 42390028
418600                 PERFORM 9900-SQL-ERROR                           42400028
418700                                                                  42410028
418800         END-EVALUATE                                             42420028
418900                                                                  42430028
419000     END-PERFORM.                                                 42440028
419100                                                                  42450028
419200     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    42460028
419300         SQLCODE NOT = ZERO                                       42470028
419400         DISPLAY '**************************************'         42480028
419500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         42490028
419600         DISPLAY 'SELECT TPKGTYP                        '         42500028
419700         DISPLAY 'PV-PKG-TYP-CDE: '                               42510028
419800                  PV-PKG-TYP-CDE                                  42520028
419900         DISPLAY 'PW-SHIPMT-PRO-NBR:   '                          42530028
420000                  PW-SHIPMT-PRO-NBR                               42540028
420100         DISPLAY 'PW-SHIPMT-BOL-NBR:   '                          42550028
420200                  PW-SHIPMT-BOL-NBR                               42560028
420300         DISPLAY '**************************************'         42570028
420400         PERFORM 9900-SQL-ERROR                                   42580028
420500     END-IF.                                                      42590028
420600                                                                  42600028
420700     EVALUATE TRUE                                                42610028
420800         WHEN SQLCODE = ZERO                                      42620028
420900             SET PS-VALID-PKG-TYP-CDE                             42630028
421000                                 TO TRUE                          42640028
421100                                                                  42650028
421200         WHEN SQLCODE = PC-100                                    42660028
421300             SET PS-INVALID-PKG-TYP-CDE                           42670028
421400                                 TO TRUE                          42680028
421500                                                                  42690028
421600     END-EVALUATE.                                                42700028
421700                                                                  42710028
421800 EJECT                                                            42720028
421900***************************************************************** 42730028
422000*     USING THE SCAC FROM THE EDI TRANSMISSION, GO AGAINST THE  * 42740028
422100*     VENDOR DATABASE TO VERIFY IT IS CORRECT.  BRING BACK THE  * 42750028
422200*     CARRIER VENDOR ID FOR INSERT INTO THE SHIPMT DATABASE.    * 42760028
422300***************************************************************** 42770028
422400                                                                  42780028
422500 7600-VERIFY-LSD-CARR-SCAC.                                       42790028
422600                                                                  42800028
422700     MOVE '7600-VERIFY-LSD-CARR-SCAC'                             42810028
422800                                 TO PV-CURRENT-PARA.              42820028
422900                                                                  42830028
423000     PERFORM                                                      42840028
423100         WITH TEST AFTER                                          42850028
423200         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     42860028
423300         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            42870028
423400                 SQLCODE = ZERO OR                                42880028
423500                 SQLCODE = PC-100                                 42890028
423600                                                                  42900028
423700         EXEC SQL                                                 42910028
423800             SELECT ENT_ID,                                       42920028
423900                    CRE_SHIPT_FCST_IND                            42930028
424000               INTO :EXTENT-ENT-ID,                               42940028
424100                    :EXTENT-CRE-SHIPT-FCST-IND                    42950028
424200               FROM TEXTENT                                       42960028
424300              WHERE SCAC_CDE    = :PV-CARR-SCAC                   42970028
424400                AND CARRIER_IND = :PC-Y                           42980028
424500              WITH UR                                             42990028
424600         END-EXEC                                                 43000028
424700                                                                  43010028
424800         EVALUATE TRUE                                            43020028
424900             WHEN SQLCODE = ZERO                                  43030028
425000             WHEN SQLCODE = +100                                  43040028
425100             WHEN SQLCODE = PC-NEG-904                            43050028
425200             WHEN SQLCODE = PC-NEG-913                            43060028
425300                 CONTINUE                                         43070028
425400                                                                  43080028
425500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              43090028
425600                 DISPLAY '**************************************' 43100028
425700                 DISPLAY 'WARNING ISSUED ON SELECT OF TEXTENT   ' 43110028
425800                 DISPLAY 'TR001-B1003-CARR-SCAC: '                43120028
425900                          TR001-B1003-CARR-SCAC                   43130028
426000                 DISPLAY '**********************************'     43140028
426100                 PERFORM 9800-SQL-WARNING                         43150028
426200                                                                  43160028
426300             WHEN SQLCODE < ZERO                                  43170028
426400                 DISPLAY '**************************************' 43180028
426500                 DISPLAY 'ERROR ISSUED ON SELECT OF TEXTENT     ' 43190028
426600                 DISPLAY 'TR001-B1003-CARR-SCAC: '                43200028
426700                          TR001-B1003-CARR-SCAC                   43210028
426800                 DISPLAY '**************************************' 43220028
426900                 PERFORM 9900-SQL-ERROR                           43230028
427000                                                                  43240028
427100         END-EVALUATE                                             43250028
427200     END-PERFORM.                                                 43260028
427300                                                                  43270028
427400     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    43280028
427500         SQLCODE NOT = ZERO                                       43290028
427600         DISPLAY '**************************************'         43300028
427700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         43310028
427800         DISPLAY 'SELECT TEXTENT                        '         43320028
427900         DISPLAY 'TR001-B1003-CARR-SCAC: '                        43330028
428000                  TR001-B1003-CARR-SCAC                           43340028
428100         DISPLAY 'PW-SHIPMT-PRO-NBR:     '                        43350028
428200                  PW-SHIPMT-PRO-NBR                               43360028
428300         DISPLAY 'PW-SHIPMT-BOL-NBR:     '                        43370028
428400                  PW-SHIPMT-BOL-NBR                               43380028
428500         DISPLAY '**************************************'         43390028
428600         PERFORM 9900-SQL-ERROR                                   43400028
428700     END-IF.                                                      43410028
428800                                                                  43420028
428900     EVALUATE TRUE                                                43430028
429000         WHEN SQLCODE = ZERO                                      43440028
429100             SET PS-VALID-VENDOR TO TRUE                          43450028
429200             MOVE PV-CARR-SCAC   TO PW-VEHICL-CARR-SCAC-ID        43460028
429300                                    PW-VHTRIP-CARR-SCAC-ID        43470028
429400                                    PW-SHIPMT-PRO-SCAC-ID         43480028
429500             IF PS-LSD-CARR                                       43490028
429600                 CONTINUE                                         43500028
429700             ELSE                                                 43510028
429800                 MOVE EXTENT-CRE-SHIPT-FCST-IND                   43520028
429900                                 TO PS-EDI-SHIPMT-SW              43530028
430000             END-IF                                               43540028
430100                                                                  43550028
430200         WHEN SQLCODE = PC-100                                    43560028
430300             IF PS-LSD-CARR                                       43570028
430400                 SET PS-INVALID-LSD-VENDOR                        43580028
430500                                 TO TRUE                          43590028
430600             ELSE                                                 43600028
430700                 SET PS-INVALID-VENDOR                            43610028
430800                                 TO TRUE                          43620028
430900             END-IF                                               43630028
431000                                                                  43640028
431100     END-EVALUATE.                                                43650028
431200                                                                  43660028
431300 EJECT                                                            43670028
431400***************************************************************** 43680028
431500*     DO A SELECT ON VEHICL USING THE SCAC-ID AND VEH-NBR.      * 43690028
431600*     THIS WILL DETERMINE WHETHER THE RECORD SHOULD BE AN       * 43700028
431700*     INSERT OR AN UPDATE.                                      * 43710028
431800***************************************************************** 43720028
431900                                                                  43730028
432000 7700-SELECT-VEHICL.                                              43740028
432100                                                                  43750028
432200     MOVE '7700-SELECT-VEHICL'   TO PV-CURRENT-PARA.              43760028
432300                                                                  43770028
432400     IF TR001-Q509-LSD-CARR-ID > SPACES AND                       43780028
432500        PS-VALID-LSD-VENDOR                                       43790028
432600         MOVE TR001-Q509-LSD-CARR-ID                              43800028
432700                                 TO VEHICL-OWNER-SCAC-ID          43810028
432800     ELSE                                                         43820028
432900         MOVE PW-VEHICL-CARR-SCAC-ID                              43830028
433000                                 TO VEHICL-OWNER-SCAC-ID          43840028
433100     END-IF.                                                      43850028
433200                                                                  43860028
433300     MOVE PW-VEHICL-VEH-NBR      TO VEHICL-VEH-NBR.               43870028
433400     SET PS-TVEHICL-TRIP-ID-NOT-FOUND TO TRUE.                    43880028
433500                                                                  43890028
433600                                                                  43900028
433700     PERFORM                                                      43910028
433800         WITH TEST AFTER                                          43920028
433900         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     43930028
434000         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            43940028
434100                 SQLCODE = ZERO    OR                             43950028
434200                 SQLCODE = PC-100                                 43960028
434300                                                                  43970028
434400         EXEC SQL                                                 43980028
434500             SELECT OWNER_SCAC_ID,                                43990028
434600                    VEH_NBR,                                      44000028
434700                    CRT_SRC_CDE,                                  44010028
434800                    LAST_UPD_DTE,                                 44020028
434900                    LAST_UPD_TME,                                 44030028
435000                    LAST_UPD_UID,                                 44040028
435100                    USAGE_CDE,                                    44050028
435200                    VEH_TYP_CDE,                                  44060028
435300                    CURR_STATUS_CDE,                              44070028
435400                    CURR_STATUS_DTE,                              44080028
435500                    CURR_STATUS_TME,                              44090028
435600                    CURR_OPER_UNT_ID,                             44100028
435700                    CURR_FCLTY_ID,                                44110028
435800                    CURR_FAC_AREA_ID,                             44120028
435900                    CURR_LOC_DTE,                                 44130028
436000                    CURR_LOC_TME,                                 44140028
436100                    CURR_TRIP_ID,                                 44150028
436200                    VEH_SIZE_CDE                                  44160028
436300               INTO :VEHICL-OWNER-SCAC-ID,                        44170028
436400                    :VEHICL-VEH-NBR,                              44180028
436500                    :VEHICL-CRT-SRC-CDE,                          44190028
436600                    :VEHICL-LAST-UPD-DTE,                         44200028
436700                    :VEHICL-LAST-UPD-TME,                         44210028
436800                    :VEHICL-LAST-UPD-UID,                         44220028
436900                    :VEHICL-USAGE-CDE,                            44230028
437000                    :VEHICL-VEH-TYP-CDE,                          44240028
437100                    :VEHICL-CURR-STATUS-CDE,                      44250028
437200                    :VEHICL-CURR-STATUS-DTE,                      44260028
437300                    :VEHICL-CURR-STATUS-TME,                      44270028
437400                    :VEHICL-CURR-OPER-UNT-ID,                     44280028
437500                    :VEHICL-CURR-FCLTY-ID,                        44290028
437600                    :VEHICL-CURR-FAC-AREA-ID,                     44300028
437700                    :VEHICL-CURR-LOC-DTE,                         44310028
437800                    :VEHICL-CURR-LOC-TME,                         44320028
437900                    :VEHICL-CURR-TRIP-ID                          44330028
438000                                :PV-VEHICL-CURR-TRIP-ID-NULL,     44340028
438100                    :VEHICL-VEH-SIZE-CDE                          44350028
438200               FROM TVEHICL                                       44360028
438300              WHERE OWNER_SCAC_ID  = :VEHICL-OWNER-SCAC-ID        44370028
438400                AND VEH_NBR        = :VEHICL-VEH-NBR              44380028
438500         END-EXEC                                                 44390028
438600                                                                  44400028
438700         EVALUATE TRUE                                            44410028
438800             WHEN SQLCODE = ZERO                                  44420028
438900               SET PS-TVEHICL-TRIP-ID-FOUND TO TRUE               44430028
439000             WHEN SQLCODE = PC-100                                44440028
439100             WHEN SQLCODE = PC-NEG-904                            44450028
439200             WHEN SQLCODE = PC-NEG-913                            44460028
439300                 CONTINUE                                         44470028
439400                                                                  44480028
439500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              44490028
439600                 DISPLAY '**************************************' 44500028
439700                 DISPLAY 'WARNING ISSUED ON SELECT OF TVEHICL   ' 44510028
439800                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 44520028
439900                          VEHICL-OWNER-SCAC-ID                    44530028
440000                         'PW-VEHICL-VEH-NBR: '                    44540028
440100                          PW-VEHICL-VEH-NBR                       44550028
440200                 DISPLAY '**********************************'     44560028
440300                 PERFORM 9800-SQL-WARNING                         44570028
440400                                                                  44580028
440500             WHEN SQLCODE < ZERO                                  44590028
440600                 DISPLAY '**************************************' 44600028
440700                 DISPLAY 'ERROR ISSUED ON SELECT OF TVEHICL     ' 44610028
440800                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 44620028
440900                          VEHICL-OWNER-SCAC-ID                    44630028
441000                         'PW-VEHICL-VEH-NBR: '                    44640028
441100                          PW-VEHICL-VEH-NBR                       44650028
441200                 DISPLAY '**************************************' 44660028
441300                 PERFORM 9900-SQL-ERROR                           44670028
441400                                                                  44680028
441500         END-EVALUATE                                             44690028
441600     END-PERFORM.                                                 44700028
441700                                                                  44710028
441800     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    44720028
441900         SQLCODE NOT = ZERO                                       44730028
442000         DISPLAY '**************************************'         44740028
442100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         44750028
442200         DISPLAY 'SELECT TVEHICL                        '         44760028
442300         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         44770028
442400                  VEHICL-OWNER-SCAC-ID                            44780028
442500                 'PW-VEHICL-VEH-NBR: '                            44790028
442600                  PW-VEHICL-VEH-NBR                               44800028
442700         DISPLAY '**************************************'         44810028
442800         PERFORM 9900-SQL-ERROR                                   44820028
442900     END-IF.                                                      44830028
443000                                                                  44840028
443100***************************************************************** 44850028
443200*     CHECK THE SQLCODE OF THE VEHICLE SELECT AND SET FIELDS    * 44860028
443300*     AS APPROPRIATE.                                           * 44870028
443400***************************************************************** 44880028
443500                                                                  44890028
443600 7710-CHECK-VEHICL-SQLCODE.                                       44900028
443700                                                                  44910028
443800     MOVE '7710-SELECT-VEHICL-SQLCODE'                            44920028
443900                                 TO PV-CURRENT-PARA.              44930028
444000                                                                  44940028
444100     IF PS-TVEHICL-TRIP-ID-FOUND                                  44950028
444200       SET PS-TVHTRIP-ID-NOT-FOUND TO TRUE                        44960028
444300       PERFORM 7755-SELECT-VHTRIP-FOR-VEHICL                      44970028
444400       IF PS-TVHTRIP-ID-FOUND                                     44980028
444500             MOVE VEHICL-OWNER-SCAC-ID                            44990028
444600                                 TO PW-VEHICL-OWNER-SCAC-ID       45000028
444700             MOVE VEHICL-CRT-SRC-CDE                              45010028
444800                                 TO PW-VEHICL-CRT-SRC-CDE         45020028
444900             MOVE VEHICL-CURR-STATUS-CDE                          45030028
445000                                 TO PW-VEHICL-CURR-STATUS-CDE     45040028
445100             MOVE VEHICL-CURR-OPER-UNT-ID                         45050028
445200                                 TO PW-VEHICL-CURR-OPER-UNT-ID    45060028
445300             MOVE VEHICL-CURR-FCLTY-ID                            45070028
445400                                 TO PW-VEHICL-CURR-FCLTY-ID       45080028
445500             MOVE VEHICL-CURR-FAC-AREA-ID                         45090028
445600                                 TO PW-VEHICL-CURR-FAC-AREA-ID    45100028
445700             IF PV-VEHICL-CURR-TRIP-ID-NULL = PC-NEG-1            45110028
445800                 MOVE ZERO       TO PW-VEHICL-CURR-TRIP-ID        45120028
445900                                    PW-TRIPST-TRIP-ID             45130028
446000             ELSE                                                 45140028
446100                 MOVE VEHICL-CURR-TRIP-ID                         45150028
446200                                 TO PW-VEHICL-CURR-TRIP-ID        45160028
446300                                    PW-TRIPST-TRIP-ID             45170028
446400             END-IF                                               45180028
446500             MOVE PW-VEHICL-CURR-STATUS-CDE                       45190028
446600                                 TO TRSTYP-TRIP-STATUS-CDE        45200028
446700             PERFORM 7730-SELECT-PRIORITY                         45210028
446800             IF VEHICL-LAST-UPD-UID = PC-TRKUP004 AND             45220028
446900                PS-UPDATE-TABLE                                   45230028
447000                 SET PS-UPDATE-VEHICL                             45240028
447100                                     TO TRUE                      45250028
447200             ELSE                                                 45260028
447300                 SET PS-DONT-UPDATE-VEHICL                        45270028
447400                                 TO TRUE                          45280028
447500                 IF VEHICL-LAST-UPD-UID NOT = PC-TRKUP004         45290028
447600                     SET PS-BYPASS-UPDATES                        45300028
447700                         PS-VEHICL-UPD-NOT-TRKUP004 TO TRUE       45310028
447800                 ELSE                                             45320028
447900                     MOVE PC-008 TO PW-ERROR-NBR (PW-INDEX)       45330028
448000                     PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX         45340028
448100                     MOVE SPACES     TO PW-VEHICL-VEH-NBR         45350028
448200                                        PW-VHTRIP-VEH-NBR         45360028
448300                                        PW-SHIPMT-VEH-NBR         45370028
448400                     MOVE -1 TO PV-VEHICL-CURR-TRIP-ID-NULL       45380028
448500                     MOVE ZERO       TO PW-VEHICL-CURR-TRIP-ID    45390028
448600                                        PW-TRIPST-TRIP-ID         45400028
448700                 END-IF                                           45410028
448800             END-IF                                               45420028
448900       ELSE                                                       45430028
449000         PERFORM 7950-CREATE-VEH-AUDIT-TRAIL                      45440028
449100         IF SQLCODE = +0                                          45450028
449200           MOVE PW-SAVE-VEH-NBR TO PW-SAVE-VHTRIP-VEH-NBR         45460028
449300           MOVE PW-SHIPMT-ORIGIN-SCAC-ID TO PW-SAVE-OWNER-SCAC-ID 45470028
449400           PERFORM 8870-DELETE-VEHICL                             45480028
449500           DISPLAY '****************************************'     45490028
449600           DISPLAY 'TVEHICL WITH BAD CURR TRIP DLTD '             45500028
449700           DISPLAY 'SCAC=' PW-SAVE-OWNER-SCAC-ID ',VEH= '         45510028
449800                   PW-SAVE-VEH-NBR ',TRIP=' VEHICL-CURR-TRIP-ID   45520028
449900           DISPLAY '****************************************'     45530028
450000           MOVE SPACE           TO PW-SAVE-VHTRIP-VEH-NBR         45540028
450100         END-IF.                                                  45550028
450200                                                                  45560028
450300     IF PS-TVEHICL-TRIP-ID-NOT-FOUND                              45570028
450400       OR PS-TVHTRIP-ID-NOT-FOUND                                 45580028
450500       SET PS-INSERT-VEHICL                                       45590028
450600                      TO TRUE.                                    45600028
450700                                                                  45610028
450800                                                                  45620028
450900 7730-SELECT-PRIORITY.                                            45630028
451000                                                                  45640028
451100     MOVE '7730-SELECT-PRIORITY'                                  45650028
451200                                 TO PV-CURRENT-PARA.              45660028
451300                                                                  45670028
451400     PERFORM                                                      45680028
451500         WITH TEST AFTER                                          45690028
451600         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     45700028
451700         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            45710028
451800                 SQLCODE = ZERO OR                                45720028
451900                 SQLCODE = PC-100                                 45730028
452000                                                                  45740028
452100         EXEC SQL                                                 45750028
452200           SELECT A.PRTY_CDE                                      45760028
452300           INTO  :TRSTYP-PRTY-CDE                                 45770028
452400           FROM   TTRSTYP A                                       45780028
452500           WHERE  A.TRIP_STATUS_CDE  = :TRSTYP-TRIP-STATUS-CDE    45790028
452600         END-EXEC                                                 45800028
452700                                                                  45810028
452800         EVALUATE TRUE                                            45820028
452900             WHEN SQLCODE = ZERO                                  45830028
453000             WHEN SQLCODE = +100                                  45840028
453100             WHEN SQLCODE = PC-NEG-904                            45850028
453200             WHEN SQLCODE = PC-NEG-913                            45860028
453300                 CONTINUE                                         45870028
453400                                                                  45880028
453500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              45890028
453600                 DISPLAY '**************************************' 45900028
453700                 DISPLAY 'WARNING ISSUED ON SELECT OF TTRSTYP   ' 45910028
453800                 DISPLAY 'PW-VEHICL-CURR-TRIP-ID: '               45920028
453900                          PW-VEHICL-CURR-TRIP-ID                  45930028
454000                 DISPLAY '**********************************'     45940028
454100                 PERFORM 9800-SQL-WARNING                         45950028
454200                                                                  45960028
454300             WHEN SQLCODE < ZERO                                  45970028
454400                 DISPLAY '**************************************' 45980028
454500                 DISPLAY 'ERROR ISSUED ON SELECT OF TTRSTYP     ' 45990028
454600                 DISPLAY 'PW-VEHICL-CURR-TRIP-ID: '               46000028
454700                          PW-VEHICL-CURR-TRIP-ID                  46010028
454800                 DISPLAY '**************************************' 46020028
454900                 PERFORM 9900-SQL-ERROR                           46030028
455000                                                                  46040028
455100         END-EVALUATE                                             46050028
455200                                                                  46060028
455300     END-PERFORM.                                                 46070028
455400                                                                  46080028
455500     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    46090028
455600         SQLCODE NOT = ZERO                                       46100028
455700         DISPLAY '**************************************'         46110028
455800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         46120028
455900         DISPLAY 'SELECT TTRSTYP                        '         46130028
456000         DISPLAY 'PW-VEHICL-CURR-TRIP-ID: '                       46140028
456100                  PW-VEHICL-CURR-TRIP-ID                          46150028
456200         DISPLAY '**************************************'         46160028
456300         PERFORM 9900-SQL-ERROR                                   46170028
456400     END-IF.                                                      46180028
456500                                                                  46190028
456600     IF SQLCODE = ZERO                                            46200028
456700         IF TRSTYP-PRTY-CDE = PC-95                               46210028
456800             SET PS-UPDATE-TABLE                                  46220028
456900                                 TO TRUE                          46230028
457000         ELSE                                                     46240028
457100             IF TRSTYP-PRTY-CDE > PC-30                           46250028
457200                 SET PS-DONT-UPDATE-TABLE                         46260028
457300                                     TO TRUE                      46270028
457400             ELSE                                                 46280028
457500                 SET PS-UPDATE-TABLE                              46290028
457600                                     TO TRUE                      46300028
457700             END-IF                                               46310028
457800         END-IF                                                   46320028
457900     ELSE                                                         46330028
458000         SET PS-UPDATE-TABLE                                      46340028
458100                             TO TRUE                              46350028
458200     END-IF.                                                      46360028
458300                                                                  46370028
458400                                                                  46380028
458500 7740-SELECT-TRIP-STATUS.                                         46390028
458600                                                                  46400028
458700     MOVE '7740-SELECT-TRIP-STATUS'                               46410028
458800                                 TO PV-CURRENT-PARA.              46420028
458900                                                                  46430028
459000     PERFORM                                                      46440028
459100         WITH TEST AFTER                                          46450028
459200         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     46460028
459300         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            46470028
459400                 SQLCODE = ZERO OR                                46480028
459500                 SQLCODE = PC-100                                 46490028
459600                                                                  46500028
459700         EXEC SQL                                                 46510028
459800           SELECT B.PRTY_CDE                                      46520028
459900           INTO  :TRSTYP-PRTY-CDE                                 46530028
460000           FROM   TTRIPST A                                       46540028
460100                 ,TTRSTYP B                                       46550028
460200           WHERE  A.TRIP_ID          = :TRIPST-TRIP-ID            46560028
460300             AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE           46570028
460400             AND  B.PRTY_CDE =                                    46580028
460500                  (SELECT MAX(D.PRTY_CDE)                         46590028
460600                     FROM TTRIPST C                               46600028
460700                         ,TTRSTYP D                               46610028
460800                    WHERE C.TRIP_ID         = A.TRIP_ID           46620028
460900                      AND C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  46630028
461000         END-EXEC                                                 46640028
461100                                                                  46650028
461200         EVALUATE TRUE                                            46660028
461300             WHEN SQLCODE = ZERO                                  46670028
461400             WHEN SQLCODE = +100                                  46680028
461500             WHEN SQLCODE = PC-NEG-904                            46690028
461600             WHEN SQLCODE = PC-NEG-913                            46700028
461700             WHEN SQLCODE = PC-NEG-911                            46710028
461800                 CONTINUE                                         46720028
461900                                                                  46730028
462000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              46740028
462100                 DISPLAY '**************************************' 46750028
462200                 DISPLAY 'WARNING ISSUED ON SELECT OF TTRSTYP   ' 46760028
462300                 DISPLAY 'PW-VEHICL-CURR-TRIP-ID: '               46770028
462400                          PW-VEHICL-CURR-TRIP-ID                  46780028
462500                 DISPLAY '**********************************'     46790028
462600                 PERFORM 9800-SQL-WARNING                         46800028
462700                                                                  46810028
462800             WHEN SQLCODE < ZERO                                  46820028
462900                 DISPLAY '**************************************' 46830028
463000                 DISPLAY 'ERROR ISSUED ON SELECT OF TTRSTYP     ' 46840028
463100                 DISPLAY 'PW-VEHICL-CURR-TRIP-ID: '               46850028
463200                          PW-VEHICL-CURR-TRIP-ID                  46860028
463300                 DISPLAY '**************************************' 46870028
463400                 PERFORM 9900-SQL-ERROR                           46880028
463500                                                                  46890028
463600         END-EVALUATE                                             46900028
463700                                                                  46910028
463800     END-PERFORM.                                                 46920028
463900                                                                  46930028
464000     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    46940028
464100         SQLCODE NOT = ZERO                                       46950028
464200         DISPLAY '**************************************'         46960028
464300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         46970028
464400         DISPLAY 'SELECT TTRSTYP                        '         46980028
464500         DISPLAY 'PW-VEHICL-CURR-TRIP-ID: '                       46990028
464600                  PW-VEHICL-CURR-TRIP-ID                          47000028
464700         DISPLAY '**************************************'         47010028
464800         PERFORM 9900-SQL-ERROR                                   47020028
464900     END-IF.                                                      47030028
465000                                                                  47040028
465100     IF SQLCODE = ZERO                                            47050028
465200         IF TRSTYP-PRTY-CDE = PC-95                               47060028
465300             SET PS-UPDATE-TABLE                                  47070028
465400                                 TO TRUE                          47080028
465500         ELSE                                                     47090028
465600             IF TRSTYP-PRTY-CDE > PC-30                           47100028
465700                 SET PS-DONT-UPDATE-TABLE                         47110028
465800                                     TO TRUE                      47120028
465900             ELSE                                                 47130028
466000                 SET PS-UPDATE-TABLE                              47140028
466100                                     TO TRUE                      47150028
466200             END-IF                                               47160028
466300         END-IF                                                   47170028
466400     ELSE                                                         47180028
466500         SET PS-UPDATE-TABLE                                      47190028
466600                             TO TRUE                              47200028
466700     END-IF.                                                      47210028
466800                                                                  47220028
466900 EJECT                                                            47230028
467000***************************************************************** 47240028
467100*     DO A SELECT ON VHTRIP USING THE SCAC-ID, VEH-NBR AND TRIP.* 47250028
467200*     THIS WILL DETERMINE WHETHER THE RECORD SHOULD BE AN       * 47260028
467300*     INSERT OR AN UPDATE.                                      * 47270028
467400***************************************************************** 47280028
467500                                                                  47290028
467600 7750-SELECT-VHTRIP.                                              47300028
467700                                                                  47310028
467800     MOVE '7750-SELECT-VHTRIP'   TO PV-CURRENT-PARA.              47320028
467900                                                                  47330028
468000     PERFORM                                                      47340028
468100         WITH TEST AFTER                                          47350028
468200         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     47360028
468300         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            47370028
468400                 SQLCODE = ZERO    OR                             47380028
468500                 SQLCODE = PC-100                                 47390028
468600                                                                  47400028
468700         EXEC SQL                                                 47410028
468800             SELECT OWNER_SCAC_ID,                                47420028
468900                    VEH_NBR,                                      47430028
469000                    TRIP_ID,                                      47440028
469100                    TRIP_BEG_DTE,                                 47450028
469200                    TRIP_BEG_TME,                                 47460028
469300                    CRT_SRC_CDE,                                  47470028
469400                    LAST_UPD_DTE,                                 47480028
469500                    LAST_UPD_TME,                                 47490028
469600                    LAST_UPD_UID,                                 47500028
469700                    MANIFEST_NBR,                                 47510028
469800                    PLND_TRIP_SEQ,                                47520028
469900                    PLND_ACTVY_CDE,                               47530028
470000                    OWNR_SCAC_SHIP_DTE,                           47540028
470100                    REF_TRIP_ID,                                  47550028
470200                    EST_AR_TMST                                   47560028
470300                   ,SPLT_XMIT_IND                                 47570028
470400                   ,SPLT_XMIT_DTE                                 47580028
470500                   ,SPLT_XMIT_TM                                  47590028
470600               INTO :VHTRIP-OWNER-SCAC-ID,                        47600028
470700                    :VHTRIP-VEH-NBR  :PV-VHTRIP-VEH-NBR-NULL,     47610028
470800                    :VHTRIP-TRIP-ID,                              47620028
470900                    :VHTRIP-TRIP-BEG-DTE,                         47630028
471000                    :VHTRIP-TRIP-BEG-TME,                         47640028
471100                    :VHTRIP-CRT-SRC-CDE,                          47650028
471200                    :VHTRIP-LAST-UPD-DTE,                         47660028
471300                    :VHTRIP-LAST-UPD-TME,                         47670028
471400                    :VHTRIP-LAST-UPD-UID,                         47680028
471500                    :VHTRIP-MANIFEST-NBR,                         47690028
471600                    :VHTRIP-PLND-TRIP-SEQ,                        47700028
471700                    :VHTRIP-PLND-ACTVY-CDE,                       47710028
471800                    :VHTRIP-OWNR-SCAC-SHIP-DTE,                   47720028
471900                    :VHTRIP-REF-TRIP-ID,                          47730028
472000                    :VHTRIP-EST-AR-TMST   :PV-VHTRIP-EST-AR-NULL  47740028
472100                   ,:VHTRIP-SPLT-XMIT-IND                         47750028
472200                   ,:VHTRIP-SPLT-XMIT-DTE                         47760028
472300                   ,:VHTRIP-SPLT-XMIT-TM                          47770028
472400               FROM TVHTRIP                                       47780028
472500              WHERE TRIP_ID = :VHTRIP-TRIP-ID                     47790028
472600         END-EXEC                                                 47800028
472700                                                                  47810028
472800         EVALUATE TRUE                                            47820028
472900             WHEN SQLCODE = ZERO                                  47830028
473000             WHEN SQLCODE = PC-100                                47840028
473100             WHEN SQLCODE = PC-NEG-904                            47850028
473200             WHEN SQLCODE = PC-NEG-913                            47860028
473300                 CONTINUE                                         47870028
473400                                                                  47880028
473500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              47890028
473600                 DISPLAY '**************************************' 47900028
473700                 DISPLAY 'WARNING ISSUED ON SELECT OF TVHTRIP   ' 47910028
473800                 DISPLAY 'VEHICL-CURR-TRIP-ID: '                  47920028
473900                          VEHICL-CURR-TRIP-ID                     47930028
474000                 DISPLAY '**********************************'     47940028
474100                 PERFORM 9800-SQL-WARNING                         47950028
474200                                                                  47960028
474300             WHEN SQLCODE < ZERO                                  47970028
474400                 DISPLAY '**************************************' 47980028
474500                 DISPLAY 'ERROR ISSUED ON SELECT OF TVHTRIP     ' 47990028
474600                 DISPLAY 'VEHICL-CURR-TRIP-ID: '                  48000028
474700                          VEHICL-CURR-TRIP-ID                     48010028
474800                 DISPLAY '**************************************' 48020028
474900                 PERFORM 9900-SQL-ERROR                           48030028
475000                                                                  48040028
475100         END-EVALUATE                                             48050028
475200     END-PERFORM.                                                 48060028
475300                                                                  48070028
475400     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    48080028
475500         SQLCODE NOT = ZERO                                       48090028
475600         DISPLAY '**************************************'         48100028
475700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            48110028
475800                 'SELECT TVHTRIP                        '         48120028
475900         DISPLAY 'VEHICL-CURR-TRIP-ID: '                          48130028
476000                  VEHICL-CURR-TRIP-ID                             48140028
476100         DISPLAY '**************************************'         48150028
476200         PERFORM 9900-SQL-ERROR                                   48160028
476300     END-IF.                                                      48170028
476400                                                                  48180028
476500***************************************************************** 48190028
476600*     DO A SELECT ON VHTRIP USING THE CURR_TRIP_ID.             * 48200028
476700*     THIS WILL DETERMINE WHETHER THE VEHICL NBR HAS A VALID    * 48210028
476800*     TRIP ID. IF NOT THE THE VEHICL ROW WILL BE DELETED        * 48220028
476900***************************************************************** 48230028
477000                                                                  48240028
477100 7755-SELECT-VHTRIP-FOR-VEHICL.                                   48250028
477200                                                                  48260028
477300     MOVE '7755-SELECT-VHTRIP-FOR-VEHICL'   TO PV-CURRENT-PARA.   48270028
477400                                                                  48280028
477500     PERFORM                                                      48290028
477600         WITH TEST AFTER                                          48300028
477700         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     48310028
477800         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            48320028
477900                 SQLCODE = ZERO    OR                             48330028
478000                 SQLCODE = PC-100                                 48340028
478100                                                                  48350028
478200         EXEC SQL                                                 48360028
478300             SELECT VEH_NBR                                       48370028
478400               INTO :VHTRIP-VEH-NBR  :PV-VHTRIP-VEH-NBR-NULL      48380028
478500               FROM TVHTRIP                                       48390028
478600              WHERE TRIP_ID = :VEHICL-CURR-TRIP-ID                48400028
478700         END-EXEC                                                 48410028
478800                                                                  48420028
478900         EVALUATE TRUE                                            48430028
479000             WHEN SQLCODE = ZERO                                  48440028
479100                SET PS-TVHTRIP-ID-FOUND TO TRUE                   48450028
479200             WHEN SQLCODE = PC-100                                48460028
479300             WHEN SQLCODE = PC-NEG-904                            48470028
479400             WHEN SQLCODE = PC-NEG-913                            48480028
479500                 CONTINUE                                         48490028
479600                                                                  48500028
479700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              48510028
479800                 DISPLAY '**************************************' 48520028
479900                 DISPLAY 'WARNING ISSUED ON SELECT OF TVHTRIP   ' 48530028
480000                 DISPLAY 'VEHICL-CURR-TRIP-ID: '                  48540028
480100                          VEHICL-CURR-TRIP-ID                     48550028
480200                 DISPLAY '**********************************'     48560028
480300                 PERFORM 9800-SQL-WARNING                         48570028
480400                                                                  48580028
480500             WHEN SQLCODE < ZERO                                  48590028
480600                 DISPLAY '**************************************' 48600028
480700                 DISPLAY 'ERROR ISSUED ON SELECT OF TVHTRIP     ' 48610028
480800                 DISPLAY 'VEHICL-CURR-TRIP-ID: '                  48620028
480900                          VEHICL-CURR-TRIP-ID                     48630028
481000                 DISPLAY '**************************************' 48640028
481100                 PERFORM 9900-SQL-ERROR                           48650028
481200                                                                  48660028
481300         END-EVALUATE                                             48670028
481400     END-PERFORM.                                                 48680028
481500                                                                  48690028
481600     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    48700028
481700         SQLCODE NOT = ZERO                                       48710028
481800         DISPLAY '**************************************'         48720028
481900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            48730028
482000                 'SELECT TVHTRIP                        '         48740028
482100         DISPLAY 'VEHICL-CURR-TRIP-ID: '                          48750028
482200                  VEHICL-CURR-TRIP-ID                             48760028
482300         DISPLAY '**************************************'         48770028
482400         PERFORM 9900-SQL-ERROR                                   48780028
482500     END-IF.                                                      48790028
482600                                                                  48800028
482700***************************************************************** 48810028
482800*     CHECK THE SQLCODE ON THE VHTRIP SELECT AND SET FIELD      * 48820028
482900*     VALUES APPROPRIATELY.                                     * 48830028
483000***************************************************************** 48840028
483100                                                                  48850028
483200 7760-CHECK-VHTRIP-SQLCODE.                                       48860028
483300                                                                  48870028
483400     MOVE '7760-CHECK-VHTRIP-SQLCODE'                             48880028
483500                                 TO PV-CURRENT-PARA.              48890028
483600                                                                  48900028
483700     EVALUATE TRUE                                                48910028
483800         WHEN SQLCODE = ZERO                                      48920028
483900             PERFORM 7770-CHECK-IF-SCAC-VEH-CHNGD                 48930028
484000             IF PS-VHTRIP-SCAC-DIDNT-CHANGE                       48940028
484100                 MOVE VHTRIP-OWNER-SCAC-ID                        48950028
484200                                 TO PW-VHTRIP-OWNER-SCAC-ID       48960028
484300                                    PW-SAVE-OWNER-SCAC-ID         48970028
484400             ELSE                                                 48980028
484500                 MOVE VHTRIP-OWNER-SCAC-ID                        48990028
484600                                 TO PW-SAVE-OWNER-SCAC-ID         49000028
484700                 MOVE VHTRIP-VEH-NBR                              49010028
484800                                 TO PW-SAVE-VHTRIP-VEH-NBR        49020028
484900             END-IF                                               49030028
485000             IF PS-VHTRIP-VEH-DIDNT-CHANGE                        49040028
485100                 IF PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1             49050028
485200                     MOVE SPACES     TO VHTRIP-VEH-NBR            49060028
485300                     IF PW-VEHICL-VEH-NBR > SPACES                49070028
485400                         MOVE PW-VEHICL-VEH-NBR                   49080028
485500                                     TO PW-VHTRIP-VEH-NBR         49090028
485600                     ELSE                                         49100028
485700                         MOVE SPACES TO PW-VHTRIP-VEH-NBR         49110028
485800                     END-IF                                       49120028
485900                 ELSE                                             49130028
486000                     MOVE VHTRIP-VEH-NBR                          49140028
486100                                     TO PW-VHTRIP-VEH-NBR         49150028
486200                 END-IF                                           49160028
486300             ELSE                                                 49170028
486400                 MOVE VHTRIP-VEH-NBR                              49180028
486500                                 TO PW-SAVE-VHTRIP-VEH-NBR        49190028
486600                 MOVE VHTRIP-OWNER-SCAC-ID                        49200028
486700                                 TO PW-SAVE-OWNER-SCAC-ID         49210028
486800             END-IF                                               49220028
486900             MOVE VHTRIP-TRIP-ID TO PW-VHTRIP-TRIP-ID             49230028
487000             IF PW-VEHICL-CURR-TRIP-ID = ZERO                     49240028
487100                 MOVE VHTRIP-TRIP-ID TO PW-VEHICL-CURR-TRIP-ID    49250028
487200             END-IF                                               49260028
487300             IF PW-VHTRIP-MANIFEST-NBR = SPACES                   49270028
487400                 MOVE VHTRIP-MANIFEST-NBR                         49280028
487500                                 TO PW-VHTRIP-MANIFEST-NBR        49290028
487600             END-IF                                               49300028
487700             IF PS-TVHTRIP-NO-TIMESTMP                            49310028
487800                 IF PV-VHTRIP-EST-AR-NULL = PC-NEG-1              49320028
487900                     MOVE SPACES TO PW-VHTRIP-EST-AR-TMST         49330028
488000                 ELSE                                             49340028
488100                     MOVE VHTRIP-EST-AR-TMST                      49350028
488200                                 TO PW-VHTRIP-EST-AR-TMST         49360028
488300                 END-IF                                           49370028
488400             END-IF                                               49380028
488500             IF PS-UPDATE-SHIPMT OR                               49390028
488600                PS-DONT-UPDATE-SHIPMT                             49400028
488700                 MOVE PW-VHTRIP-TRIP-ID TO TRIPST-TRIP-ID         49410028
488800                 PERFORM 7740-SELECT-TRIP-STATUS                  49420028
488900                 IF PS-UPDATE-TABLE                               49430028
489000                     SET PS-UPDATE-VHTRIP                         49440028
489100                                     TO TRUE                      49450028
489200                 ELSE                                             49460028
489300                     SET PS-DONT-UPDATE-VHTRIP                    49470028
489400                         PS-BYPASS-UPDATES                        49480028
489500                         PS-TRSTYP-PRTY-CD-GT-30                  49490028
489600                                     TO TRUE                      49500028
489700                     IF PS-VHTRIP-SCAC-CHANGED OR                 49510028
489800                        PS-VHTRIP-VEH-CHANGED                     49520028
489900                         MOVE PC-029 TO PW-ERROR-NBR (PW-INDEX)   49530028
490000                         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX     49540028
490100                         SET PS-EDIT-ERROR-DETECTED               49550028
490200                                     TO TRUE                      49560028
490300                     ELSE                                         49570028
490400                         MOVE PC-032 TO PW-ERROR-NBR (PW-INDEX)   49580028
490500                         PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX     49590028
490600                     END-IF                                       49600028
490700                 END-IF                                           49610028
490800             ELSE                                                 49620028
490900                 SET PS-ADD-NEXT-VHTRIP                           49630028
491000                                     TO TRUE                      49640028
491100             END-IF                                               49650028
491200                                                                  49660028
491300         WHEN SQLCODE = PC-100                                    49670028
491400             SET PS-INSERT-VHTRIP                                 49680028
491500                                 TO TRUE                          49690028
491600             MOVE '-'            TO PW-VHTRIP-D-T-DASH            49700028
491700             MOVE '.000000'      TO PW-VHTRIP-D-T-MSEC            49710028
491800     END-EVALUATE.                                                49720028
491900                                                                  49730028
492000 EJECT                                                            49740028
492100***************************************************************** 49750028
492200*     DETERMINE IF THE SCAC AND VEHICLE NUMBER ON THE VHTRIP    * 49760028
492300*     TABLE MATCH THE SCAC AND VEHICLE FIELDS FROM EDI DATA.    * 49770028
492400***************************************************************** 49780028
492500                                                                  49790028
492600 7770-CHECK-IF-SCAC-VEH-CHNGD.                                    49800028
492700                                                                  49810028
492800     MOVE '7770-CHECK-IF-SCAC-VEH-CHNGD'                          49820028
492900                                 TO PV-CURRENT-PARA.              49830028
493000                                                                  49840028
493100     SET PS-VHTRIP-VEH-DIDNT-CHANGE                               49850028
493200         PS-VHTRIP-SCAC-DIDNT-CHANGE TO TRUE.                     49860028
493300     IF PW-SAVE-LSD-CARR-ID > SPACES                              49870028
493400         IF PW-SAVE-LSD-CARR-ID = VHTRIP-OWNER-SCAC-ID            49880028
493500             IF PW-SAVE-VEH-NBR > SPACES                          49890028
493600                 IF PW-SAVE-VEH-NBR = VHTRIP-VEH-NBR OR           49900028
493700                    PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1             49910028
493800                     CONTINUE                                     49920028
493900                 ELSE                                             49930028
494000                     SET PS-VHTRIP-VEH-CHANGED                    49940028
494100                               TO TRUE                            49950028
494200                 END-IF                                           49960028
494300             END-IF                                               49970028
494400         ELSE                                                     49980028
494500             SET PS-VHTRIP-SCAC-CHANGED                           49990028
494600                               TO TRUE                            50000028
494700         END-IF                                                   50010028
494800     ELSE                                                         50020028
494900         IF PW-SAVE-CARR-SCAC = VHTRIP-OWNER-SCAC-ID              50030028
495000             IF PW-SAVE-VEH-NBR > SPACES                          50040028
495100                 IF PW-SAVE-VEH-NBR = VHTRIP-VEH-NBR OR           50050028
495200                    PV-VHTRIP-VEH-NBR-NULL = PC-NEG-1             50060028
495300                     CONTINUE                                     50070028
495400                 ELSE                                             50080028
495500                     SET PS-VHTRIP-VEH-CHANGED                    50090028
495600                               TO TRUE                            50100028
495700                 END-IF                                           50110028
495800             END-IF                                               50120028
495900         ELSE                                                     50130028
496000             SET PS-VHTRIP-SCAC-CHANGED                           50140028
496100                               TO TRUE                            50150028
496200         END-IF                                                   50160028
496300     END-IF.                                                      50170028
496400 EJECT                                                            50180028
496500                                                                  50190028
496600***************************************************************** 50200028
496700*     DO A SELECT ON VHTRIP USING THE TRIP-ID TO SEE IF THIS    * 50210028
496800*     TRIP NUMBER HAS ALREADY BEEN PRODUCED BY THE RANDOM NUMBER* 50220028
496900*     GENERATOR.                                                * 50230028
497000***************************************************************** 50240028
497100                                                                  50250028
497200 7775-CHECK-IF-TRIP-ID-USED.                                      50260028
497300                                                                  50270028
497400     MOVE '7775-CHECK-IF-TRIP-ID-USED'                            50280028
497500                                 TO PV-CURRENT-PARA.              50290028
497600                                                                  50300028
497700     PERFORM                                                      50310028
497800         WITH TEST AFTER                                          50320028
497900         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     50330028
498000         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            50340028
498100                 SQLCODE = ZERO    OR                             50350028
498200                 SQLCODE = PC-100                                 50360028
498300                                                                  50370028
498400         EXEC SQL                                                 50380028
498500             SELECT TRIP_ID                                       50390028
498600               INTO :PV-TRIP-ID                                   50400028
498700               FROM TVHTRIP                                       50410028
498800              WHERE TRIP_ID = :PV-RANDOM-NBR                      50420028
498900         END-EXEC                                                 50430028
499000                                                                  50440028
499100         EVALUATE TRUE                                            50450028
499200             WHEN SQLCODE = ZERO                                  50460028
499300             WHEN SQLCODE = PC-100                                50470028
499400             WHEN SQLCODE = PC-NEG-904                            50480028
499500             WHEN SQLCODE = PC-NEG-913                            50490028
499600                 CONTINUE                                         50500028
499700                                                                  50510028
499800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              50520028
499900                 DISPLAY '**************************************' 50530028
500000                 DISPLAY 'WARNING ISSUED ON SELECT OF TVHTRIP   ' 50540028
500100                 DISPLAY 'PV-RANDOM-NBR: ' PV-RANDOM-NBR          50550028
500200                 DISPLAY '**********************************'     50560028
500300                 PERFORM 9800-SQL-WARNING                         50570028
500400                                                                  50580028
500500             WHEN SQLCODE < ZERO                                  50590028
500600                 DISPLAY '**************************************' 50600028
500700                 DISPLAY 'ERROR ISSUED ON SELECT OF TVHTRIP     ' 50610028
500800                 DISPLAY 'PV-RANDOM-NBR: ' PV-RANDOM-NBR          50620028
500900                 DISPLAY '**************************************' 50630028
501000                 PERFORM 9900-SQL-ERROR                           50640028
501100                                                                  50650028
501200         END-EVALUATE                                             50660028
501300     END-PERFORM.                                                 50670028
501400                                                                  50680028
501500     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    50690028
501600         SQLCODE NOT = ZERO                                       50700028
501700         DISPLAY '**************************************'         50710028
501800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            50720028
501900                 'SELECT TVHTRIP                        '         50730028
502000                 DISPLAY 'PV-RANDOM-NBR: ' PV-RANDOM-NBR          50740028
502100         DISPLAY '**************************************'         50750028
502200         PERFORM 9900-SQL-ERROR                                   50760028
502300     END-IF.                                                      50770028
502400                                                                  50780028
502500 EJECT                                                            50790028
502600***************************************************************** 50800028
502700*     INSERT A COPY OF THE SHIPMT ROW TO THE AUDIT TRAIL TABLE  * 50810028
502800*     BEFORE UPDATING THE SHIPMT TABLE.                         * 50820028
502900***************************************************************** 50830028
503000                                                                  50840028
503100 7800-CREATE-SHIPMT-AUDIT-TRAIL.                                  50850028
503200                                                                  50860028
503300     MOVE '7800-CREATE-SHIPMT-AUDIT-TRAIL'                        50870028
503400                                 TO PV-CURRENT-PARA.              50880028
503500                                                                  50890028
503600     PERFORM                                                      50900028
503700         WITH TEST AFTER                                          50910028
503800         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     50920028
503900         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            50930028
504000                 SQLCODE = ZERO                                   50940028
504100                                                                  50950028
504200* ADDED CAN (CARR-AUTH-ID) BELOW CLT 02-12-2011 WR40574           50960028
504300         EXEC SQL                                                 50970028
504400             INSERT INTO TAUSHIP                                  50980028
504500                   (TRIP_ID,                                      50990028
504600                    SHIPT_ID,                                     51000028
504700                    CRT_SRC_CDE,                                  51010028
504800                    LAST_UPD_DTE,                                 51020028
504900                    LAST_UPD_TME,                                 51030028
505000                    LAST_UPD_UID,                                 51040028
505100                    PRO_SCAC_ID,                                  51050028
505200                    PRO_NBR,                                      51060028
505300                    BOL_NBR,                                      51070028
505400                    SHIPPER_NME,                                  51080028
505500                    SHIPT_TYP_CDE,                                51090028
505600                    EXPTED_GRO_WGHT,                              51100028
505700                    PKG_TYP_CDE,                                  51110028
505800                    EXPTED_PKG_QTY,                               51120028
505900                    FRGT_CHG_AMT,                                 51130028
506000                    FRGT_TERMS_CDE,                               51140028
506100                    EST_AR_TMST,                                  51150028
506200                    VEND_SHIP_DTE,                                51160028
506300                    EXPTED_PLT_QTY,                               51170028
506400                    ORIG_SCAC_ID,                                 51180028
506500                    LAST_UPD_PGM_ID,                              51190028
506600                    CRE_USER_ID,                                  51200028
506700                    CARR_CART_CT,                                 51210028
506800                    CARR_LAST_UPD_DTE,                            51220028
506900                    CARR_LAST_UPD_TIME,                           51230028
507000                    VEND_CART_CT,                                 51240028
507100                    VEND_LAST_UPD_DTE,                            51250028
507200                    VEND_LAST_UPD_TIME,                           51260028
507300                    VEH_NBR,                                      51270028
507400                    AUTH_NBR,                                     51280028
507500                    AUTH_DTE,                                     51290028
507600                    CONFIRM_DTE,                                  51300028
507700                    CONFIRM_TIME,                                 51310028
507800                    PROCESSED_DTE,                                51320028
507900                    INVC_NBR,                                     51330028
508000                    AUD_STATUS_CDE,                               51340028
508100                    CARR_AUTH_ID  )                               51350028
508200             VALUES                                               51360028
508300                  (:SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,     51370028
508400                   :SHIPMT-SHIPT-ID,                              51380028
508500                   :SHIPMT-CRT-SRC-CDE,                           51390028
508600                   :SHIPMT-LAST-UPD-DTE,                          51400028
508700                   :SHIPMT-LAST-UPD-TME,                          51410028
508800                   :SHIPMT-LAST-UPD-UID,                          51420028
508900                   :SHIPMT-PRO-SCAC-ID,                           51430028
509000                   :SHIPMT-COMPLETE-PRO-NBR,                      51440028
509100                   :SHIPMT-COMPLETE-BOL-NBR,                      51450028
509200                   :SHIPMT-SHIPPER-NME,                           51460028
509300                   :SHIPMT-SHIPT-TYP-CDE,                         51470028
509400                   :SHIPMT-EXPTED-GRO-WGHT,                       51480028
509500                   :SHIPMT-PKG-TYP-CDE,                           51490028
509600                   :SHIPMT-EXPTED-PKG-QTY,                        51500028
509700                   :SHIPMT-FRGT-CHG-AMT,                          51510028
509800                   :SHIPMT-FRGT-TERMS-CDE,                        51520028
509900                   :SHIPMT-EST-AR-TMST :PV-SHIPMT-EST-AR-NULL,    51530028
510000                   :SHIPMT-VEND-SHIP-DTE,                         51540028
510100                   :SHIPMT-EXPTED-PLT-QTY,                        51550028
510200                   :SHIPMT-ORIG-SCAC-ID,                          51560028
510300                   :SHIPMT-LAST-UPD-PGM-ID,                       51570028
510400                   :SHIPMT-CRE-USER-ID,                           51580028
510500                   :SHIPMT-CARR-CART-CT,                          51590028
510600                   :SHIPMT-CARR-LAST-UPD-DTE,                     51600028
510700                   :SHIPMT-CARR-LAST-UPD-TIME,                    51610028
510800                   :SHIPMT-VEND-CART-CT,                          51620028
510900                   :SHIPMT-VEND-LAST-UPD-DTE,                     51630028
511000                   :SHIPMT-VEND-LAST-UPD-TIME,                    51640028
511100                   :SHIPMT-VEH-NBR,                               51650028
511200                   :SHIPMT-AUTH-NBR,                              51660028
511300                   :SHIPMT-AUTH-DTE,                              51670028
511400                   :SHIPMT-CONFIRM-DTE,                           51680028
511500                   :SHIPMT-CONFIRM-TIME,                          51690028
511600                   :SHIPMT-PROCESSED-DTE,                         51700028
511700                   :SHIPMT-INVC-NBR,                              51710028
511800                   :PC-EN,                                        51720028
511900                   :SHIPMT-CARR-AUTH-ID)                          51730028
512000         END-EXEC                                                 51740028
512100                                                                  51750028
512200         EVALUATE TRUE                                            51760028
512300             WHEN SQLCODE = ZERO                                  51770028
512400             WHEN SQLCODE = PC-NEG-904                            51780028
512500             WHEN SQLCODE = PC-NEG-913                            51790028
512600             WHEN SQLCODE = PC-NEG-911                            51800028
512700                 CONTINUE                                         51810028
512800                                                                  51820028
512900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              51830028
513000                 DISPLAY '**************************************' 51840028
513100                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUSHIP   ' 51850028
513200                 DISPLAY 'SHIPMT-SHIPT-ID:    '                   51860028
513300                          SHIPMT-SHIPT-ID                         51870028
513400                 DISPLAY 'SHIPMT-BOL-NBR:     '                   51880028
513500                          SHIPMT-BOL-NBR                          51890028
513600                 DISPLAY 'SHIPMT-PRO-NBR:     '                   51900028
513700                          SHIPMT-PRO-NBR                          51910028
513800                 DISPLAY '**********************************'     51920028
513900                 PERFORM 9800-SQL-WARNING                         51930028
514000                                                                  51940028
514100             WHEN SQLCODE < ZERO                                  51950028
514200                 DISPLAY '**************************************' 51960028
514300                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUSHIP     ' 51970028
514400                 DISPLAY 'SHIPMT-SHIPT-ID:    '                   51980028
514500                          SHIPMT-SHIPT-ID                         51990028
514600                 DISPLAY 'SHIPMT-BOL-NBR:     '                   52000028
514700                          SHIPMT-BOL-NBR                          52010028
514800                 DISPLAY 'SHIPMT-PRO-NBR:     '                   52020028
514900                          SHIPMT-PRO-NBR                          52030028
515000                 DISPLAY '**************************************' 52040028
515100                 PERFORM 9900-SQL-ERROR                           52050028
515200                                                                  52060028
515300         END-EVALUATE                                             52070028
515400     END-PERFORM.                                                 52080028
515500                                                                  52090028
515600     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    52100028
515700         SQLCODE NOT = ZERO                                       52110028
515800         DISPLAY '**************************************'         52120028
515900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         52130028
516000         DISPLAY 'INSERT TO TAUSHIP                     '         52140028
516100         DISPLAY 'SHIPMT-SHIPT-ID: '                              52150028
516200                  SHIPMT-SHIPT-ID                                 52160028
516300         DISPLAY 'SHIPMT-BOL-NBR:  '                              52170028
516400                  SHIPMT-BOL-NBR                                  52180028
516500         DISPLAY 'SHIPMT-PRO-NBR:  '                              52190028
516600                  SHIPMT-PRO-NBR                                  52200028
516700         DISPLAY '**************************************'         52210028
516800         PERFORM 9900-SQL-ERROR                                   52220028
516900     END-IF.                                                      52230028
517000                                                                  52240028
517100 EJECT                                                            52250028
517200***************************************************************** 52260028
517300*     INSERT A COPY OF THE TRIP ROW TO THE AUDIT TRAIL TABLE    * 52270028
517400*     BEFORE UPDATING THE TRIP TABLE.                           * 52280028
517500***************************************************************** 52290028
517600                                                                  52300028
517700 7900-CREATE-TRIP-AUDIT-TRAIL.                                    52310028
517800                                                                  52320028
517900     MOVE '7900-CREATE-TRIP-AUDIT-TRAIL'                          52330028
518000                                 TO PV-CURRENT-PARA.              52340028
518100                                                                  52350028
518200     PERFORM                                                      52360028
518300         WITH TEST AFTER                                          52370028
518400         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     52380028
518500         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            52390028
518600                 SQLCODE = ZERO                                   52400028
518700                                                                  52410028
518800         EXEC SQL                                                 52420028
518900             INSERT INTO TAUTRIP                                  52430028
519000                   (OWNER_SCAC_ID,                                52440028
519100                    VEH_NBR,                                      52450028
519200                    TRIP_ID,                                      52460028
519300                    TRIP_BEG_DTE,                                 52470028
519400                    TRIP_BEG_TME,                                 52480028
519500                    CRT_SRC_CDE,                                  52490028
519600                    LAST_UPD_DTE,                                 52500028
519700                    LAST_UPD_TME,                                 52510028
519800                    LAST_UPD_UID,                                 52520028
519900                    MANIFEST_NBR,                                 52530028
520000                    PLND_TRIP_SEQ,                                52540028
520100                    PLND_ACTVY_CDE,                               52550028
520200                    OWNR_SCAC_SHIP_DTE,                           52560028
520300                    REF_TRIP_ID,                                  52570028
520400                    EST_AR_TMST,                                  52580028
520500                    AUD_STATUS_CDE                                52590028
520600                  , SPLT_XMIT_IND                                 52600028
520700                  , SPLT_XMIT_DTE                                 52610028
520800                  , SPLT_XMIT_TM )                                52620028
520900             VALUES                                               52630028
521000                  (:VHTRIP-OWNER-SCAC-ID,                         52640028
521100                   :VHTRIP-VEH-NBR  :PV-VHTRIP-VEH-NBR-NULL,      52650028
521200                   :VHTRIP-TRIP-ID,                               52660028
521300                   :VHTRIP-TRIP-BEG-DTE,                          52670028
521400                   :VHTRIP-TRIP-BEG-TME,                          52680028
521500                   :VHTRIP-CRT-SRC-CDE,                           52690028
521600                   :VHTRIP-LAST-UPD-DTE,                          52700028
521700                   :VHTRIP-LAST-UPD-TME,                          52710028
521800                   :VHTRIP-LAST-UPD-UID,                          52720028
521900                   :VHTRIP-MANIFEST-NBR,                          52730028
522000                   :VHTRIP-PLND-TRIP-SEQ,                         52740028
522100                   :VHTRIP-PLND-ACTVY-CDE,                        52750028
522200                   :VHTRIP-OWNR-SCAC-SHIP-DTE,                    52760028
522300                   :VHTRIP-REF-TRIP-ID,                           52770028
522400                   :VHTRIP-EST-AR-TMST   :PV-VHTRIP-EST-AR-NULL,  52780028
522500                   :PC-EN                                         52790028
522600                  ,:VHTRIP-SPLT-XMIT-IND                          52800028
522700                  ,:VHTRIP-SPLT-XMIT-DTE                          52810028
522800                  ,:VHTRIP-SPLT-XMIT-TM )                         52820028
522900         END-EXEC                                                 52830028
523000                                                                  52840028
523100         EVALUATE TRUE                                            52850028
523200             WHEN SQLCODE = ZERO                                  52860028
523300             WHEN SQLCODE = PC-NEG-904                            52870028
523400             WHEN SQLCODE = PC-NEG-913                            52880028
523500             WHEN SQLCODE = PC-NEG-911                            52890028
523600                 CONTINUE                                         52900028
523700                                                                  52910028
523800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              52920028
523900                 DISPLAY '**************************************' 52930028
524000                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUTRIP   ' 52940028
524100                 DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                 52950028
524200                          VHTRIP-OWNER-SCAC-ID                    52960028
524300                 DISPLAY 'VHTRIP-VEH-NBR:       '                 52970028
524400                          VHTRIP-VEH-NBR                          52980028
524500                 DISPLAY 'VHTRIP-TRIP-ID:       '                 52990028
524600                          VHTRIP-TRIP-ID                          53000028
524700                 DISPLAY '**********************************'     53010028
524800                 PERFORM 9800-SQL-WARNING                         53020028
524900                                                                  53030028
525000             WHEN SQLCODE < ZERO                                  53040028
525100                 DISPLAY '**************************************' 53050028
525200                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUTRIP     ' 53060028
525300                 DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                 53070028
525400                          VHTRIP-OWNER-SCAC-ID                    53080028
525500                 DISPLAY 'VHTRIP-VEH-NBR:       '                 53090028
525600                          VHTRIP-VEH-NBR                          53100028
525700                 DISPLAY 'VHTRIP-TRIP-ID:       '                 53110028
525800                          VHTRIP-TRIP-ID                          53120028
525900                 DISPLAY '**************************************' 53130028
526000                 PERFORM 9900-SQL-ERROR                           53140028
526100                                                                  53150028
526200         END-EVALUATE                                             53160028
526300     END-PERFORM.                                                 53170028
526400                                                                  53180028
526500     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    53190028
526600         SQLCODE NOT = ZERO                                       53200028
526700         DISPLAY '**************************************'         53210028
526800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         53220028
526900         DISPLAY 'INSERT TO TAUSHIP                     '         53230028
527000         DISPLAY 'VHTRIP-OWNER-SCAC-ID: '                         53240028
527100                  VHTRIP-OWNER-SCAC-ID                            53250028
527200         DISPLAY 'VHTRIP-VEH-NBR:       '                         53260028
527300                  VHTRIP-VEH-NBR                                  53270028
527400         DISPLAY 'VHTRIP-TRIP-ID:       '                         53280028
527500                  VHTRIP-TRIP-ID                                  53290028
527600         DISPLAY '**************************************'         53300028
527700         PERFORM 9900-SQL-ERROR                                   53310028
527800     END-IF.                                                      53320028
527900                                                                  53330028
528000 EJECT                                                            53340028
528100***************************************************************** 53350028
528200*     INSERT A COPY OF THE VEHICLE ROW TO THE AUDIT TRAIL TABLE * 53360028
528300*     BEFORE UPDATING THE VEHICLE TABLE.                        * 53370028
528400***************************************************************** 53380028
528500                                                                  53390028
528600 7950-CREATE-VEH-AUDIT-TRAIL.                                     53400028
528700                                                                  53410028
528800     MOVE '7950-CREATE-VEH-AUDIT-TRAIL'                           53420028
528900                                 TO PV-CURRENT-PARA.              53430028
529000                                                                  53440028
529100     PERFORM                                                      53450028
529200         WITH TEST AFTER                                          53460028
529300         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     53470028
529400         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            53480028
529500                 SQLCODE = ZERO                                   53490028
529600                                                                  53500028
529700         EXEC SQL                                                 53510028
529800             INSERT INTO TAUVHCL                                  53520028
529900                   (OWNER_SCAC_ID,                                53530028
530000                    VEH_NBR,                                      53540028
530100                    CRT_SRC_CDE,                                  53550028
530200                    LAST_UPD_DTE,                                 53560028
530300                    LAST_UPD_TME,                                 53570028
530400                    LAST_UPD_UID,                                 53580028
530500                    USAGE_CDE,                                    53590028
530600                    VEH_TYP_CDE,                                  53600028
530700                    CURR_STATUS_CDE,                              53610028
530800                    CURR_STATUS_DTE,                              53620028
530900                    CURR_STATUS_TME,                              53630028
531000                    CURR_OPER_UNT_ID,                             53640028
531100                    CURR_FCLTY_ID,                                53650028
531200                    CURR_FAC_AREA_ID,                             53660028
531300                    CURR_LOC_DTE,                                 53670028
531400                    CURR_LOC_TME,                                 53680028
531500                    CURR_TRIP_ID,                                 53690028
531600                    VEH_SIZE_CDE)                                 53700028
531700             VALUES                                               53710028
531800                  (:VEHICL-OWNER-SCAC-ID,                         53720028
531900                   :VEHICL-VEH-NBR,                               53730028
532000                   :VEHICL-CRT-SRC-CDE,                           53740028
532100                   :VEHICL-LAST-UPD-DTE,                          53750028
532200                   :VEHICL-LAST-UPD-TME,                          53760028
532300                   :VEHICL-LAST-UPD-UID,                          53770028
532400                   :VEHICL-USAGE-CDE,                             53780028
532500                   :VEHICL-VEH-TYP-CDE,                           53790028
532600                   :VEHICL-CURR-STATUS-CDE,                       53800028
532700                   :VEHICL-CURR-STATUS-DTE,                       53810028
532800                   :VEHICL-CURR-STATUS-TME,                       53820028
532900                   :VEHICL-CURR-OPER-UNT-ID,                      53830028
533000                   :VEHICL-CURR-FCLTY-ID,                         53840028
533100                   :VEHICL-CURR-FAC-AREA-ID,                      53850028
533200                   :VEHICL-CURR-LOC-DTE,                          53860028
533300                   :VEHICL-CURR-LOC-TME,                          53870028
533400                   :VEHICL-CURR-TRIP-ID,                          53880028
533500                   :VEHICL-VEH-SIZE-CDE)                          53890028
533600         END-EXEC                                                 53900028
533700                                                                  53910028
533800         EVALUATE TRUE                                            53920028
533900             WHEN SQLCODE = ZERO                                  53930028
534000             WHEN SQLCODE = PC-NEG-904                            53940028
534100             WHEN SQLCODE = PC-NEG-913                            53950028
534200             WHEN SQLCODE = PC-NEG-911                            53960028
534300                 CONTINUE                                         53970028
534400                                                                  53980028
534500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              53990028
534600                 DISPLAY '**************************************' 54000028
534700                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUVHCL   ' 54010028
534800                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 54020028
534900                          VEHICL-OWNER-SCAC-ID                    54030028
535000                 DISPLAY 'VEHICL-VEH-NBR:       '                 54040028
535100                          VEHICL-VEH-NBR                          54050028
535200                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 54060028
535300                          VEHICL-CURR-TRIP-ID                     54070028
535400                 DISPLAY '**********************************'     54080028
535500                 PERFORM 9800-SQL-WARNING                         54090028
535600                                                                  54100028
535700             WHEN SQLCODE < ZERO                                  54110028
535800                 DISPLAY '**************************************' 54120028
535900                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUVHCL     ' 54130028
536000                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 54140028
536100                          VEHICL-OWNER-SCAC-ID                    54150028
536200                 DISPLAY 'VEHICL-VEH-NBR:       '                 54160028
536300                          VEHICL-VEH-NBR                          54170028
536400                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 54180028
536500                          VEHICL-CURR-TRIP-ID                     54190028
536600                 DISPLAY '**************************************' 54200028
536700                 PERFORM 9900-SQL-ERROR                           54210028
536800                                                                  54220028
536900         END-EVALUATE                                             54230028
537000     END-PERFORM.                                                 54240028
537100                                                                  54250028
537200     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    54260028
537300         SQLCODE NOT = ZERO                                       54270028
537400         DISPLAY '**************************************'         54280028
537500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         54290028
537600         DISPLAY 'INSERT TO TAUVHCL                     '         54300028
537700         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         54310028
537800                  VEHICL-OWNER-SCAC-ID                            54320028
537900         DISPLAY 'VEHICL-VEH-NBR:       '                         54330028
538000                  VEHICL-VEH-NBR                                  54340028
538100         DISPLAY 'VEHICL-CURR-TRIP-ID:  '                         54350028
538200                  VEHICL-CURR-TRIP-ID                             54360028
538300         DISPLAY '**************************************'         54370028
538400         PERFORM 9900-SQL-ERROR                                   54380028
538500     END-IF.                                                      54390028
538600                                                                  54400028
538700 EJECT                                                            54410028
538800****************************************************************  54420028
538900*     PROCESS-TOTAL-LINE                                       *  54430028
539000*                                                              *  54440028
539100*     -  CONTROL THE LOADING AND PRINTING OF TOTAL LINES       *  54450028
539200****************************************************************  54460028
539300                                                                  54470028
539400 8000-PROCESS-TOTAL-LINES.                                        54480028
539500                                                                  54490028
539600     MOVE '8000-PROCESS-TOTAL-LINES       '                       54500028
539700                                 TO PV-CURRENT-PARA.              54510028
539800                                                                  54520028
539900     MOVE PA-ST-READ             TO TL1-ST-READ.                  54530028
540000     MOVE PA-B10-READ            TO TL2-B10-READ.                 54540028
540100     MOVE PA-N1-READ             TO TL3-N1-READ.                  54550028
540200     MOVE PA-N9-READ             TO TL4-N9-READ.                  54560028
540300     MOVE PA-Q5-READ             TO TL5-Q5-READ.                  54570028
540400     MOVE PA-Q6-READ             TO TL6-Q6-READ.                  54580028
540500     MOVE PA-SE-READ             TO TL7-SE-READ.                  54590028
540600     MOVE PA-SHIPT-STATUS-READ   TO TL8-SHIPT-STATUS-READ.        54600028
540700     MOVE PA-SHIPMT-INSERTED     TO TL9-SHIPMT-INSERTED.          54610028
540800     MOVE PA-SHIPST-INSERTED     TO TL10-SHIPST-INSERTED.         54620028
540900     MOVE PA-SHPTPO-INSERTED     TO TL11-SHPTPO-INSERTED.         54630028
541000     MOVE PA-VEHICL-INSERTED     TO TL12-VEHICL-INSERTED.         54640028
541100     MOVE PA-VEHICL-DELETED      TO TL12A-VEHICL-DELETED.         54650028
541200     MOVE PA-VHTRIP-INSERTED     TO TL13-VHTRIP-INSERTED.         54660028
541300     MOVE PA-TRIPST-INSERTED     TO TL14-TRIPST-INSERTED.         54670028
541400     MOVE PA-SHIPMT-UPDATED      TO TL15-SHIPMT-UPDATED.          54680028
541500     MOVE PA-SHIPST-UPDATED      TO TL16-SHIPST-UPDATED.          54690028
541600     MOVE PA-VEHICL-UPDATED      TO TL17-VEHICL-UPDATED.          54700028
541700     MOVE PA-VHTRIP-UPDATED      TO TL18-VHTRIP-UPDATED.          54710028
541800     MOVE PA-TRIPST-UPDATED      TO TL19-TRIPST-UPDATED.          54720028
541900     MOVE PA-ERRORS-WRITTEN      TO TL20-ERRORS-WRITTEN.          54730028
542000                                                                  54740028
542100     MOVE TL1-TOTAL-LINE1        TO PW-SHIPMENT-STATUS-LINE.      54750028
542200     PERFORM 8200-WRITE-REPORT-LINE.                              54760028
542300                                                                  54770028
542400     MOVE TL2-TOTAL-LINE2        TO PW-SHIPMENT-STATUS-LINE.      54780028
542500     PERFORM 8200-WRITE-REPORT-LINE.                              54790028
542600                                                                  54800028
542700     MOVE TL3-TOTAL-LINE3        TO PW-SHIPMENT-STATUS-LINE.      54810028
542800     PERFORM 8200-WRITE-REPORT-LINE.                              54820028
542900                                                                  54830028
543000     MOVE TL4-TOTAL-LINE4        TO PW-SHIPMENT-STATUS-LINE.      54840028
543100     PERFORM 8200-WRITE-REPORT-LINE.                              54850028
543200                                                                  54860028
543300     MOVE TL5-TOTAL-LINE5        TO PW-SHIPMENT-STATUS-LINE.      54870028
543400     PERFORM 8200-WRITE-REPORT-LINE.                              54880028
543500                                                                  54890028
543600     MOVE TL6-TOTAL-LINE6        TO PW-SHIPMENT-STATUS-LINE.      54900028
543700     PERFORM 8200-WRITE-REPORT-LINE.                              54910028
543800                                                                  54920028
543900     MOVE TL7-TOTAL-LINE7        TO PW-SHIPMENT-STATUS-LINE.      54930028
544000     PERFORM 8200-WRITE-REPORT-LINE.                              54940028
544100                                                                  54950028
544200     MOVE TL8-TOTAL-LINE8        TO PW-SHIPMENT-STATUS-LINE.      54960028
544300     PERFORM 8200-WRITE-REPORT-LINE.                              54970028
544400                                                                  54980028
544500     MOVE TL9-TOTAL-LINE9        TO PW-SHIPMENT-STATUS-LINE.      54990028
544600     PERFORM 8200-WRITE-REPORT-LINE.                              55000028
544700                                                                  55010028
544800     MOVE TL10-TOTAL-LINE10      TO PW-SHIPMENT-STATUS-LINE.      55020028
544900     PERFORM 8200-WRITE-REPORT-LINE.                              55030028
545000                                                                  55040028
545100     MOVE TL11-TOTAL-LINE11      TO PW-SHIPMENT-STATUS-LINE.      55050028
545200     PERFORM 8200-WRITE-REPORT-LINE.                              55060028
545300                                                                  55070028
545400     MOVE TL12-TOTAL-LINE12      TO PW-SHIPMENT-STATUS-LINE.      55080028
545500     PERFORM 8200-WRITE-REPORT-LINE.                              55090028
545600                                                                  55100028
545700     MOVE TL12A-TOTAL-LINE12     TO PW-SHIPMENT-STATUS-LINE.      55110028
545800     PERFORM 8200-WRITE-REPORT-LINE.                              55120028
545900                                                                  55130028
546000     MOVE TL13-TOTAL-LINE13      TO PW-SHIPMENT-STATUS-LINE.      55140028
546100     PERFORM 8200-WRITE-REPORT-LINE.                              55150028
546200                                                                  55160028
546300     MOVE TL14-TOTAL-LINE14      TO PW-SHIPMENT-STATUS-LINE.      55170028
546400     PERFORM 8200-WRITE-REPORT-LINE.                              55180028
546500                                                                  55190028
546600     MOVE TL15-TOTAL-LINE15      TO PW-SHIPMENT-STATUS-LINE.      55200028
546700     PERFORM 8200-WRITE-REPORT-LINE.                              55210028
546800                                                                  55220028
546900     MOVE TL16-TOTAL-LINE16      TO PW-SHIPMENT-STATUS-LINE.      55230028
547000     PERFORM 8200-WRITE-REPORT-LINE.                              55240028
547100                                                                  55250028
547200     MOVE TL17-TOTAL-LINE17      TO PW-SHIPMENT-STATUS-LINE.      55260028
547300     PERFORM 8200-WRITE-REPORT-LINE.                              55270028
547400                                                                  55280028
547500     MOVE TL18-TOTAL-LINE18      TO PW-SHIPMENT-STATUS-LINE.      55290028
547600     PERFORM 8200-WRITE-REPORT-LINE.                              55300028
547700                                                                  55310028
547800     MOVE TL19-TOTAL-LINE19      TO PW-SHIPMENT-STATUS-LINE.      55320028
547900     PERFORM 8200-WRITE-REPORT-LINE.                              55330028
548000                                                                  55340028
548100     MOVE TL20-TOTAL-LINE20      TO PW-SHIPMENT-STATUS-LINE.      55350028
548200     PERFORM 8200-WRITE-REPORT-LINE.                              55360028
548300                                                                  55370028
548400     MOVE END-OF-REPORT-LINE     TO PW-SHIPMENT-STATUS-LINE.      55380028
548500     PERFORM 8200-WRITE-REPORT-LINE.                              55390028
548600                                                                  55400028
548700 EJECT                                                            55410028
548800****************************************************************  55420028
548900*     WRITE-REPORT-LINE                                        *  55430028
549000*                                                              *  55440028
549100*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  55450028
549200****************************************************************  55460028
549300                                                                  55470028
549400 8100-WRITE-REPORT-LINE.                                          55480028
549500                                                                  55490028
549600     MOVE '8100-WRITE-REPORT-LINE         '                       55500028
549700                                 TO PV-CURRENT-PARA.              55510028
549800                                                                  55520028
549900     MOVE PW-SHIPMT-ORIGIN-SCAC-ID                                55530028
550000                                 TO D1-SCAC.                      55540028
550100     MOVE PW-SHIPMT-PRO-NBR      TO D1-FREIGHT-BILL.              55550028
550200     MOVE PW-SHIPMT-BOL-NBR      TO D1-BILL-OF-LADING.            55560028
550300     MOVE PW-SHIPMT-SHIPPER-NME  TO D1-SHIPPER.                   55570028
550400     MOVE PW-VHTRIP-MANIFEST-NBR TO D1-MANIFEST.                  55580028
550500     MOVE PW-SHIPMT-PRO-SCAC-ID  TO D1-DELV-SCAC.                 55590028
550600     MOVE PW-SHIPMT-CARR-CARTON-CNT                               55600028
550700                                 TO D1-PKG-QTY.                   55610028
550800                                                                  55620028
550900     MOVE PC-0                   TO PW-IDX.                       55630028
551000     PERFORM 8150-WRITE-REPORT-LINE                               55640028
551100        VARYING PW-INDEX FROM 1 BY 1                              55650028
551200        UNTIL (PS-END-OF-ERRORS AND                               55660028
551300              PS-END-OF-PO-NBRS)                                  55670028
551400              OR PW-INDEX > PW-MAX-ERR-TAB-ENTRIES.               55680028
551500                                                                  55690028
551600 8150-WRITE-REPORT-LINE.                                          55700028
551700     IF PW-INDEX > 1                                              55710046
551800         INITIALIZE D1-DETAIL-LINE1                               55720028
551900     END-IF.                                                      55730028
552000       IF PS-END-OF-ERRORS                                        55740028
552100         CONTINUE                                                 55750028
552200       ELSE                                                       55760028
552300         IF PW-ERROR-NBR (PW-INDEX) > 0                           55770028
552400             MOVE PW-ERROR-NBR (PW-INDEX)                         55780028
552500                                     TO PV-INDEX                  55790028
552600             IF PV-INDEX = PC-013                                 55800028
552700                 MOVE PV-SAVE-STATUS-CDE      TO ME-013-STAT      55810028
552800             END-IF                                               55820028
552900             IF PV-INDEX = PC-011                                 55830028
553000                 MOVE PV-SAVE-OPER            TO ME-011-OPER      55840028
553100             END-IF                                               55850028
553200             IF PV-INDEX = PC-019                                 55860028
553300                 MOVE PV-SAVE-PKG-TYP         TO ME-019-PKG-TYP   55870028
553400             END-IF                                               55880028
553500             IF PV-INDEX = PC-037                                 55890028
553600                 MOVE PV-INVALID-DELY-SCAC    TO ME-037-SCAC      55900028
553700             END-IF                                               55910028
553800             MOVE ME-TBLE-DESC (PV-INDEX)                         55920028
553900                                     TO D1-ERROR-DESC             55930028
554000             IF PW-ERROR-NBR (PW-INDEX + 1) = 0                   55940028
554100                 SET PS-END-OF-ERRORS TO TRUE                     55950028
554200             END-IF                                               55960028
554300         ELSE                                                     55970028
554400             MOVE SPACES             TO D1-ERROR-DESC             55980028
554500             SET PS-END-OF-ERRORS TO TRUE                         55990028
554600         END-IF                                                   56000028
554700*      END-IF                                                     56010028
554800     END-IF.                                                      56020028
554900     IF PW-SHPTPO-PO-NBR-N (PW-INDEX) > ZERO                      56030028
555000       MOVE PW-SHPTPO-PO-NBR (PW-INDEX)                           56040028
555100                               TO D1-PO                           56050028
555200       IF PW-SHPTPO-PO-NBR-N (PW-INDEX + 1) = ZERO AND            56060028
555300          PW-SAVE-PO-NBR (1) = SPACES                             56070028
555400           SET PS-END-OF-PO-NBRS TO TRUE                          56080028
555500       END-IF                                                     56090028
555600     ELSE                                                         56100028
555700       ADD  PC-1               TO PW-IDX                          56110028
555800       IF PW-SAVE-PO-NBR (PW-IDX) > SPACES                        56120028
555900           MOVE PW-SAVE-PO-NBR (PW-IDX)                           56130028
556000                               TO D1-PO                           56140028
556100           IF PW-SAVE-PO-NBR (PW-IDX + 1) = SPACES                56150028
556200               SET PS-END-OF-PO-NBRS TO TRUE                      56160028
556300           END-IF                                                 56170028
556400       ELSE                                                       56180028
556500           MOVE SPACES          TO D1-PO                          56190028
556600           SET PS-END-OF-PO-NBRS TO TRUE                          56200028
556700       END-IF                                                     56210028
556800     END-IF.                                                      56220028
556900     ADD 1                       TO PA-LINE-CNT.                  56230028
557000                                                                  56240028
557100     IF PA-LINE-CNT > PC-53                                       56250028
557200         PERFORM 8300-PROCESS-HEADING-LINES                       56260028
557300     END-IF.                                                      56270028
557400                                                                  56280028
557500     WRITE SHIPMENT-STATUS-LINE                                   56290028
557600         FROM D1-DETAIL-LINE1                                     56300028
557700         AFTER ADVANCING 1 LINE.                                  56310028
557800                                                                  56320028
557900 EJECT                                                            56330028
558000****************************************************************  56340028
558100*     WRITE-REPORT-LINE                                        *  56350028
558200*                                                              *  56360028
558300*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  56370028
558400****************************************************************  56380028
558500                                                                  56390028
558600 8200-WRITE-REPORT-LINE.                                          56400028
558700                                                                  56410028
558800     MOVE '8200-WRITE-REPORT-LINE         '                       56420028
558900                                 TO PV-CURRENT-PARA.              56430028
559000                                                                  56440028
559100     ADD 1                       TO PA-LINE-CNT.                  56450028
559200                                                                  56460028
559300     IF PA-LINE-CNT > PC-53                                       56470028
559400         PERFORM 8300-PROCESS-HEADING-LINES                       56480028
559500     END-IF.                                                      56490028
559600                                                                  56500028
559700     WRITE SHIPMENT-STATUS-LINE                                   56510028
559800         FROM PW-SHIPMENT-STATUS-LINE                             56520028
559900         AFTER ADVANCING 2 LINE.                                  56530028
560000                                                                  56540028
560100 EJECT                                                            56550028
560200****************************************************************  56560028
560300*     PROCESS-HEADING-LINES                                    *  56570028
560400*                                                              *  56580028
560500*     -  CONTROL THE LOADING AND PRINTING OF THE HEADING LINES *  56590028
560600****************************************************************  56600028
560700                                                                  56610028
560800 8300-PROCESS-HEADING-LINES.                                      56620028
560900                                                                  56630028
561000     MOVE '8300-PROCESS-HEADING-LINES     '                       56640028
561100                                 TO PV-CURRENT-PARA.              56650028
561200                                                                  56660028
561300     MOVE 'TRKUP004'             TO DP132O-PROGRAM-NAME.          56670028
561400     MOVE 1                      TO DP132O-REPORT-NUMBER.         56680028
561500                                                                  56690028
561600     ADD 1                       TO PA-PAGE-CNT.                  56700028
561700     MOVE PA-PAGE-CNT            TO DP132O-PAGE-NUMBER.           56710028
561800                                                                  56720028
561900     WRITE SHIPMENT-STATUS-LINE                                   56730028
562000         FROM DP132O-STANDRD-HEADER-132-COLS                      56740028
562100         AFTER ADVANCING PAGE.                                    56750028
562200                                                                  56760028
562300     WRITE SHIPMENT-STATUS-LINE                                   56770028
562400         FROM H2-HEADING-LINE2                                    56780028
562500         AFTER ADVANCING 1 LINE.                                  56790028
562600                                                                  56800028
562700     WRITE SHIPMENT-STATUS-LINE                                   56810028
562800         FROM H3-HEADING-LINE3                                    56820028
562900         AFTER ADVANCING 1 LINE.                                  56830028
563000                                                                  56840028
563100     WRITE SHIPMENT-STATUS-LINE                                   56850028
563200         FROM H4-HEADING-LINE4                                    56860028
563300         AFTER ADVANCING 2 LINES.                                 56870028
563400                                                                  56880028
563500     WRITE SHIPMENT-STATUS-LINE                                   56890028
563600         FROM H5-HEADING-LINE5                                    56900028
563700         AFTER ADVANCING 1 LINE.                                  56910028
563800                                                                  56920028
563900     MOVE SPACES                 TO SHIPMENT-STATUS-LINE.         56930028
564000                                                                  56940028
564100     MOVE 1                      TO PA-LINE-CNT.                  56950028
564200                                                                  56960028
564300 EJECT                                                            56970028
564400***************************************************************** 56980028
564500*     SET NULLS SHIPMT                                          * 56990028
564600*                                                               * 57000028
564700*     -  SET ALL SHIPMT RECORD NULL INDICATORS                  * 57010028
564800***************************************************************** 57020028
564900                                                                  57030028
565000 8400-SET-NULLS-SHIPMT.                                           57040028
565100                                                                  57050028
565200     MOVE '8400-SET-NULLS-SHIPMT             '                    57060028
565300                                 TO PV-CURRENT-PARA.              57070028
565400                                                                  57080028
565500     IF PW-SHIPMT-TRIP-ID = ZEROES                                57090028
565600         MOVE PC-NEG-1           TO PV-SHIPMT-TRIP-ID-NULL        57100028
565700     ELSE                                                         57110028
565800         MOVE PC-POS-1           TO PV-SHIPMT-TRIP-ID-NULL        57120028
565900     END-IF.                                                      57130028
566000                                                                  57140028
566100 EJECT                                                            57150028
566200***************************************************************** 57160028
566300*     SET NULLS VHTRIP                                          * 57170028
566400*                                                               * 57180028
566500*     -  SET ALL VHTRIP RECORD NULL INDICATORS                  * 57190028
566600***************************************************************** 57200028
566700                                                                  57210028
566800 8450-SET-NULLS-VHTRIP.                                           57220028
566900                                                                  57230028
567000     MOVE '8450-SET-NULLS-VHTRIP             '                    57240028
567100                                 TO PV-CURRENT-PARA.              57250028
567200                                                                  57260028
567300     IF PW-VHTRIP-VEH-NBR = SPACES                                57270028
567400         MOVE PC-NEG-1           TO PV-VHTRIP-VEH-NBR-NULL        57280028
567500     ELSE                                                         57290028
567600         MOVE PC-POS-1           TO PV-VHTRIP-VEH-NBR-NULL        57300028
567700     END-IF.                                                      57310028
567800                                                                  57320028
567900 EJECT                                                            57330028
568000***************************************************************** 57340028
568100*     SQL UPDATE VEHICLE TRIP                                   * 57350028
568200***************************************************************** 57360028
568300                                                                  57370028
568400 8600-UPDATE-VHTRIP.                                              57380028
568500                                                                  57390028
568600     MOVE '8600-UPDATE-VHTRIP'   TO PV-CURRENT-PARA.              57400028
568700                                                                  57410028
568800     IF PW-VHTRIP-OWNER-SCAC-ID = SPACES                          57420028
568900         MOVE PW-VHTRIP-CARR-SCAC-ID                              57430028
569000                                 TO VHTRIP-OWNER-SCAC-ID          57440028
569100     ELSE                                                         57450028
569200         MOVE PW-VHTRIP-OWNER-SCAC-ID                             57460028
569300                                 TO VHTRIP-OWNER-SCAC-ID          57470028
569400     END-IF.                                                      57480028
569500     IF PW-VHTRIP-EST-AR-TMST = SPACES                            57490028
569600         MOVE PC-NEG-1 TO PV-VHTRIP-EST-AR-NULL                   57500028
569700     ELSE                                                         57510028
569800         MOVE PC-POS-1 TO PV-VHTRIP-EST-AR-NULL                   57520028
569900     END-IF.                                                      57530028
570000                                                                  57540028
570100     MOVE PW-VHTRIP-EST-AR-TMST  TO VHTRIP-EST-AR-TMST.           57550028
570200                                                                  57560028
570300     PERFORM                                                      57570028
570400         WITH TEST AFTER                                          57580028
570500         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     57590028
570600         UNTIL  (PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            57600028
570700                 SQLCODE = ZERO                                   57610028
570800                                                                  57620028
570900         EXEC SQL                                                 57630028
571000             UPDATE TVHTRIP                                       57640028
571100                SET OWNER_SCAC_ID   = :VHTRIP-OWNER-SCAC-ID,      57650028
571200                    VEH_NBR         = :PW-VHTRIP-VEH-NBR          57660028
571300                                      :PV-VHTRIP-VEH-NBR-NULL,    57670028
571400                    LAST_UPD_DTE    = CURRENT DATE,               57680028
571500                    LAST_UPD_TME    = CURRENT TIME,               57690028
571600                    LAST_UPD_UID    = :PC-TRKUP004,               57700028
571700                    MANIFEST_NBR    = :PW-VHTRIP-MANIFEST-NBR,    57710028
571800                    EST_AR_TMST     = :VHTRIP-EST-AR-TMST         57720028
571900                                      :PV-VHTRIP-EST-AR-NULL      57730028
572000              WHERE TRIP_ID         = :PW-VHTRIP-TRIP-ID          57740028
572100         END-EXEC                                                 57750028
572200                                                                  57760028
572300         EVALUATE TRUE                                            57770028
572400             WHEN SQLCODE = ZERO                                  57780028
572500                 ADD  1          TO PA-VHTRIP-UPDATED             57790028
572600             WHEN SQLCODE = PC-NEG-904                            57800028
572700             WHEN SQLCODE = PC-NEG-913                            57810028
572800             WHEN SQLCODE = PC-NEG-911                            57820028
572900                 CONTINUE                                         57830028
573000                                                                  57840028
573100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              57850028
573200                 DISPLAY '**************************************' 57860028
573300                 DISPLAY 'WARNING ISSUED ON UPDATE OF TVHTRIP   ' 57870028
573400                 DISPLAY 'PW-VHTRIP-TRIP-ID:    '                 57880028
573500                          PW-VHTRIP-TRIP-ID                       57890028
573600                 DISPLAY '**********************************'     57900028
573700                 PERFORM 9800-SQL-WARNING                         57910028
573800                                                                  57920028
573900             WHEN SQLCODE < ZERO                                  57930028
574000                 DISPLAY '**************************************' 57940028
574100                 DISPLAY 'ERROR ISSUED ON UPDATE OF TVHTRIP     ' 57950028
574200                 DISPLAY 'PW-VHTRIP-TRIP-ID:    '                 57960028
574300                          PW-VHTRIP-TRIP-ID                       57970028
574400                 DISPLAY '**************************************' 57980028
574500                 PERFORM 9900-SQL-ERROR                           57990028
574600                                                                  58000028
574700         END-EVALUATE                                             58010028
574800     END-PERFORM.                                                 58020028
574900                                                                  58030028
575000     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    58040028
575100         SQLCODE NOT = ZERO                                       58050028
575200         DISPLAY '**************************************'         58060028
575300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         58070028
575400         DISPLAY 'UPDATE TO TVHTRIP                     '         58080028
575500         DISPLAY 'PW-VHTRIP-TRIP-ID:    '                         58090028
575600                  PW-VHTRIP-TRIP-ID                               58100028
575700         DISPLAY 'PW-SHIPMT-PRO-NBR:    '                         58110028
575800                  PW-SHIPMT-PRO-NBR                               58120028
575900         DISPLAY 'PW-SHIPMT-BOL-NBR:    '                         58130028
576000                  PW-SHIPMT-BOL-NBR                               58140028
576100         DISPLAY '**************************************'         58150028
576200         PERFORM 9900-SQL-ERROR                                   58160028
576300     END-IF.                                                      58170028
576400                                                                  58180028
576500 EJECT                                                            58190028
576600***************************************************************** 58200028
576700*     SQL INSERT VHTRIP                                         * 58210028
576800***************************************************************** 58220028
576900                                                                  58230028
577000 8700-INSERT-VHTRIP.                                              58240028
577100                                                                  58250028
577200     MOVE '8700-INSERT-VHTRIP'   TO PV-CURRENT-PARA.              58260028
577300                                                                  58270028
577400     IF PW-VHTRIP-OWNER-SCAC-ID = SPACES                          58280028
577500         MOVE PW-VHTRIP-CARR-SCAC-ID                              58290028
577600                                 TO VHTRIP-OWNER-SCAC-ID          58300028
577700     ELSE                                                         58310028
577800         MOVE PW-VHTRIP-OWNER-SCAC-ID                             58320028
577900                                 TO VHTRIP-OWNER-SCAC-ID          58330028
578000     END-IF.                                                      58340028
578100     IF PW-VHTRIP-EST-AR-TMST = SPACES                            58350028
578200         MOVE PC-NEG-1 TO PV-VHTRIP-EST-AR-NULL                   58360028
578300     ELSE                                                         58370028
578400         MOVE PC-POS-1 TO PV-VHTRIP-EST-AR-NULL                   58380028
578500     END-IF.                                                      58390028
578600                                                                  58400028
578700     MOVE PW-VHTRIP-EST-AR-TMST  TO VHTRIP-EST-AR-TMST.           58410028
578800                                                                  58420028
578900     PERFORM                                                      58430028
579000         WITH TEST AFTER                                          58440028
579100         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     58450028
579200         UNTIL  (PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            58460028
579300                 SQLCODE = ZERO                                   58470028
579400                                                                  58480028
579500         EXEC SQL                                                 58490028
579600             INSERT INTO TVHTRIP                                  58500028
579700                   (OWNER_SCAC_ID,                                58510028
579800                    VEH_NBR,                                      58520028
579900                    TRIP_ID,                                      58530028
580000                    CRT_SRC_CDE,                                  58540028
580100                    LAST_UPD_UID,                                 58550028
580200                    MANIFEST_NBR,                                 58560028
580300                    REF_TRIP_ID,                                  58570028
580400                    EST_AR_TMST                                   58580028
580500                  , SPLT_XMIT_IND                                 58590028
580600                  , SPLT_XMIT_DTE                                 58600028
580700                  , SPLT_XMIT_TM )                                58610028
580800             VALUES                                               58620028
580900                  (:VHTRIP-OWNER-SCAC-ID,                         58630028
581000                   :PW-VHTRIP-VEH-NBR   :PV-VHTRIP-VEH-NBR-NULL,  58640028
581100                   :PW-VHTRIP-TRIP-ID,                            58650028
581200                   :PC-CE,                                        58660028
581300                   :PC-TRKUP004,                                  58670028
581400                   :PW-VHTRIP-MANIFEST-NBR,                       58680028
581500                   :PW-VHTRIP-REF-TRIP-ID,                        58690028
581600                   :VHTRIP-EST-AR-TMST  :PV-VHTRIP-EST-AR-NULL    58700028
581700                  ,:VHTRIP-SPLT-XMIT-IND                          58710028
581800                  ,:PC-DEFAULT-DATE                               58720028
581900                  ,:PC-DEFAULT-TIME )                             58730028
582000         END-EXEC                                                 58740028
582100                                                                  58750028
582200         EVALUATE TRUE                                            58760028
582300             WHEN SQLCODE = ZERO                                  58770028
582400                 ADD  1          TO PA-VHTRIP-INSERTED            58780028
582500             WHEN SQLCODE = PC-NEG-904                            58790028
582600             WHEN SQLCODE = PC-NEG-913                            58800028
582700             WHEN SQLCODE = PC-NEG-911                            58810028
582800                 CONTINUE                                         58820028
582900                                                                  58830028
583000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              58840028
583100                 DISPLAY '**************************************' 58850028
583200                 DISPLAY 'WARNING ISSUED ON INSERT OF TVHTRIP   ' 58860028
583300                 DISPLAY 'PW-VHTRIP-TRIP-ID:    '                 58870028
583400                          PW-VHTRIP-TRIP-ID                       58880028
583500                 DISPLAY '**********************************'     58890028
583600                 PERFORM 9800-SQL-WARNING                         58900028
583700                                                                  58910028
583800             WHEN SQLCODE < ZERO                                  58920028
583900                 DISPLAY '**************************************' 58930028
584000                 DISPLAY 'ERROR ISSUED ON INSERT OF TVHTRIP     ' 58940028
584100                 DISPLAY 'PW-VHTRIP-TRIP-ID:    '                 58950028
584200                          PW-VHTRIP-TRIP-ID                       58960028
584300                 DISPLAY '**************************************' 58970028
584400                 PERFORM 9900-SQL-ERROR                           58980028
584500                                                                  58990028
584600         END-EVALUATE                                             59000028
584700     END-PERFORM.                                                 59010028
584800                                                                  59020028
584900     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    59030028
585000         SQLCODE NOT = ZERO                                       59040028
585100         DISPLAY '**************************************'         59050028
585200         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         59060028
585300         DISPLAY 'INSERT TO TVHTRIP                     '         59070028
585400         DISPLAY 'PW-VHTRIP-TRIP-ID:    '                         59080028
585500                  PW-VHTRIP-TRIP-ID                               59090028
585600         DISPLAY 'PW-SHIPMT-PRO-NBR:    '                         59100028
585700                  PW-SHIPMT-PRO-NBR                               59110028
585800         DISPLAY 'PW-SHIPMT-BOL-NBR:    '                         59120028
585900                  PW-SHIPMT-BOL-NBR                               59130028
586000         DISPLAY '**************************************'         59140028
586100         PERFORM 9900-SQL-ERROR                                   59150028
586200     END-IF.                                                      59160028
586300                                                                  59170028
586400 EJECT                                                            59180028
586500***************************************************************** 59190028
586600*     SQL UPDATE VEHICLE                                        * 59200028
586700***************************************************************** 59210028
586800                                                                  59220028
586900 8800-UPDATE-VEHICL.                                              59230028
587000                                                                  59240028
587100     MOVE '8800-UPDATE-VEHICL'   TO PV-CURRENT-PARA.              59250028
587200                                                                  59260028
587300     MOVE PC-EN                  TO VEHICL-CURR-STATUS-CDE.       59270028
587400                                                                  59280028
587500     MOVE PW-VEHICL-CURR-OPER-UNT-ID                              59290028
587600                                 TO VEHICL-CURR-OPER-UNT-ID.      59300028
587700     MOVE PW-VEHICL-CURR-FCLTY-ID                                 59310028
587800                                 TO VEHICL-CURR-FCLTY-ID.         59320028
587900     MOVE PW-VEHICL-CURR-TRIP-ID TO VEHICL-CURR-TRIP-ID           59330028
588000                                    PW-SHIPMT-TRIP-ID.            59340028
588100     MOVE PC-POS-1 TO               PV-VEHICL-CURR-TRIP-ID-NULL.  59350028
588200                                                                  59360028
588300     PERFORM                                                      59370028
588400         WITH TEST AFTER                                          59380028
588500         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     59390028
588600         UNTIL  (PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            59400028
588700                 SQLCODE = ZERO                                   59410028
588800                                                                  59420028
588900         EXEC SQL                                                 59430028
589000             UPDATE TVEHICL                                       59440028
589100                SET LAST_UPD_DTE    = CURRENT DATE,               59450028
589200                    LAST_UPD_TME    = CURRENT TIME,               59460028
589300                    LAST_UPD_UID    = :PC-TRKUP004,               59470028
589400                    CURR_STATUS_CDE = :VEHICL-CURR-STATUS-CDE,    59480028
589500                    CURR_STATUS_DTE = CURRENT DATE,               59490028
589600                    CURR_STATUS_TME = CURRENT TIME,               59500028
589700                    CURR_OPER_UNT_ID= :VEHICL-CURR-OPER-UNT-ID,   59510028
589800                    CURR_FCLTY_ID   = :VEHICL-CURR-FCLTY-ID,      59520028
589900                    CURR_TRIP_ID    = :VEHICL-CURR-TRIP-ID        59530028
590000                                      :PV-VEHICL-CURR-TRIP-ID-NULL59540028
590100              WHERE OWNER_SCAC_ID   = :VEHICL-OWNER-SCAC-ID       59550028
590200                AND VEH_NBR         = :VEHICL-VEH-NBR             59560028
590300         END-EXEC                                                 59570028
590400                                                                  59580028
590500         EVALUATE TRUE                                            59590028
590600             WHEN SQLCODE = ZERO                                  59600028
590700                 ADD  1          TO PA-VEHICL-UPDATED             59610028
590800             WHEN SQLCODE = PC-NEG-904                            59620028
590900             WHEN SQLCODE = PC-NEG-913                            59630028
591000             WHEN SQLCODE = PC-NEG-911                            59640028
591100                 CONTINUE                                         59650028
591200                                                                  59660028
591300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              59670028
591400                 DISPLAY '**************************************' 59680028
591500                 DISPLAY 'WARNING ISSUED ON UPDATE OF TVEHICL   ' 59690028
591600                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 59700028
591700                          VEHICL-OWNER-SCAC-ID                    59710028
591800                 DISPLAY 'VEHICL-VEH-NBR:       '                 59720028
591900                          VEHICL-VEH-NBR                          59730028
592000                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 59740028
592100                          VEHICL-CURR-TRIP-ID                     59750028
592200                 DISPLAY '**********************************'     59760028
592300                 PERFORM 9800-SQL-WARNING                         59770028
592400                                                                  59780028
592500             WHEN SQLCODE < ZERO                                  59790028
592600                 DISPLAY '**************************************' 59800028
592700                 DISPLAY 'ERROR ISSUED ON UPDATE OF TVEHICL     ' 59810028
592800                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 59820028
592900                          VEHICL-OWNER-SCAC-ID                    59830028
593000                 DISPLAY 'VEHICL-VEH-NBR:       '                 59840028
593100                          VEHICL-VEH-NBR                          59850028
593200                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 59860028
593300                          VEHICL-CURR-TRIP-ID                     59870028
593400                 DISPLAY '**************************************' 59880028
593500                 PERFORM 9900-SQL-ERROR                           59890028
593600                                                                  59900028
593700         END-EVALUATE                                             59910028
593800     END-PERFORM.                                                 59920028
593900                                                                  59930028
594000     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    59940028
594100         SQLCODE NOT = ZERO                                       59950028
594200         DISPLAY '**************************************'         59960028
594300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         59970028
594400         DISPLAY 'UPDATE TO TVEHICL                     '         59980028
594500         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         59990028
594600                  VEHICL-OWNER-SCAC-ID                            60000028
594700         DISPLAY 'VEHICL-VEH-NBR:       '                         60010028
594800                  VEHICL-VEH-NBR                                  60020028
594900         DISPLAY 'VEHICL-CURR-TRIP-ID:  '                         60030028
595000                  VEHICL-CURR-TRIP-ID                             60040028
595100         DISPLAY 'PW-SHIPMT-PRO-NBR:    '                         60050028
595200                  PW-SHIPMT-PRO-NBR                               60060028
595300         DISPLAY 'PW-SHIPMT-BOL-NBR:    '                         60070028
595400                  PW-SHIPMT-BOL-NBR                               60080028
595500         DISPLAY '**************************************'         60090028
595600         PERFORM 9900-SQL-ERROR                                   60100028
595700     END-IF.                                                      60110028
595800                                                                  60120028
595900 EJECT                                                            60130028
596000***************************************************************** 60140028
596100*     SQL INSERT VEHICLE                                        * 60150028
596200***************************************************************** 60160028
596300                                                                  60170028
596400 8850-INSERT-VEHICL.                                              60180028
596500                                                                  60190028
596600     MOVE '8850-INSERT-VEHICL'   TO PV-CURRENT-PARA.              60200028
596700                                                                  60210028
596800     IF PW-VEHICL-OWNER-SCAC-ID = SPACES                          60220028
596900         MOVE PW-VEHICL-CARR-SCAC-ID                              60230028
597000                                 TO VEHICL-OWNER-SCAC-ID          60240028
597100     ELSE                                                         60250028
597200         MOVE PW-VEHICL-OWNER-SCAC-ID                             60260028
597300                                 TO VEHICL-OWNER-SCAC-ID          60270028
597400     END-IF.                                                      60280028
597500                                                                  60290028
597600     MOVE PC-EN                  TO VEHICL-CURR-STATUS-CDE        60300028
597700                                                                  60310028
597800     MOVE PW-VEHICL-VEH-NBR      TO VEHICL-VEH-NBR.               60320028
597900     MOVE PW-VEHICL-CURR-OPER-UNT-ID                              60330028
598000                                 TO VEHICL-CURR-OPER-UNT-ID.      60340028
598100     MOVE PW-VEHICL-CURR-FCLTY-ID                                 60350028
598200                                 TO VEHICL-CURR-FCLTY-ID.         60360028
598300     MOVE PW-VEHICL-CURR-TRIP-ID TO VEHICL-CURR-TRIP-ID.          60370028
598400                                                                  60380028
598500     PERFORM                                                      60390028
598600         WITH TEST AFTER                                          60400028
598700         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     60410028
598800         UNTIL  (PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            60420028
598900                 SQLCODE = ZERO                                   60430028
599000                                                                  60440028
599100         EXEC SQL                                                 60450028
599200             INSERT INTO TVEHICL                                  60460028
599300                   (OWNER_SCAC_ID,                                60470028
599400                    VEH_NBR,                                      60480028
599500                    CRT_SRC_CDE,                                  60490028
599600                    LAST_UPD_UID,                                 60500028
599700                    USAGE_CDE,                                    60510028
599800                    VEH_TYP_CDE,                                  60520028
599900                    CURR_STATUS_CDE,                              60530028
600000                    CURR_STATUS_DTE,                              60540028
600100                    CURR_STATUS_TME,                              60550028
600200                    CURR_OPER_UNT_ID,                             60560028
600300                    CURR_FCLTY_ID,                                60570028
600400                    CURR_TRIP_ID)                                 60580028
600500             VALUES                                               60590028
600600                  (:VEHICL-OWNER-SCAC-ID,                         60600028
600700                   :VEHICL-VEH-NBR,                               60610028
600800                   :PC-CE,                                        60620028
600900                   :PC-TRKUP004,                                  60630028
601000                   :PC-RCV,                                       60640028
601100                   :PC-TR,                                        60650028
601200                   :VEHICL-CURR-STATUS-CDE,                       60660028
601300                    CURRENT DATE,                                 60670028
601400                    CURRENT TIME,                                 60680028
601500                   :VEHICL-CURR-OPER-UNT-ID,                      60690028
601600                   :VEHICL-CURR-FCLTY-ID,                         60700028
601700                   :VEHICL-CURR-TRIP-ID)                          60710028
601800         END-EXEC                                                 60720028
601900                                                                  60730028
602000         EVALUATE TRUE                                            60740028
602100             WHEN SQLCODE = ZERO                                  60750028
602200                 ADD  1          TO PA-VEHICL-INSERTED            60760028
602300             WHEN SQLCODE = PC-NEG-904                            60770028
602400             WHEN SQLCODE = PC-NEG-913                            60780028
602500             WHEN SQLCODE = PC-NEG-911                            60790028
602600                 CONTINUE                                         60800028
602700                                                                  60810028
602800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              60820028
602900                 DISPLAY '**************************************' 60830028
603000                 DISPLAY 'WARNING ISSUED ON INSERT OF TVEHICL   ' 60840028
603100                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 60850028
603200                          VEHICL-OWNER-SCAC-ID                    60860028
603300                 DISPLAY 'VEHICL-VEH-NBR:       '                 60870028
603400                          VEHICL-VEH-NBR                          60880028
603500                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 60890028
603600                          VEHICL-CURR-TRIP-ID                     60900028
603700                 DISPLAY '**********************************'     60910028
603800                 PERFORM 9800-SQL-WARNING                         60920028
603900                                                                  60930028
604000             WHEN SQLCODE < ZERO                                  60940028
604100                 DISPLAY '**************************************' 60950028
604200                 DISPLAY 'ERROR ISSUED ON INSERT OF TVEHICL     ' 60960028
604300                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 60970028
604400                          VEHICL-OWNER-SCAC-ID                    60980028
604500                 DISPLAY 'VEHICL-VEH-NBR:       '                 60990028
604600                          VEHICL-VEH-NBR                          61000028
604700                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 61010028
604800                          VEHICL-CURR-TRIP-ID                     61020028
604900                 DISPLAY '**************************************' 61030028
605000                 PERFORM 9900-SQL-ERROR                           61040028
605100                                                                  61050028
605200         END-EVALUATE                                             61060028
605300     END-PERFORM.                                                 61070028
605400                                                                  61080028
605500     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    61090028
605600         SQLCODE NOT = ZERO                                       61100028
605700         DISPLAY '**************************************'         61110028
605800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         61120028
605900         DISPLAY 'INSERT TO TVEHICL                     '         61130028
606000         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         61140028
606100                  VEHICL-OWNER-SCAC-ID                            61150028
606200         DISPLAY 'VEHICL-VEH-NBR:       '                         61160028
606300                  VEHICL-VEH-NBR                                  61170028
606400         DISPLAY 'VEHICL-CURR-TRIP-ID:  '                         61180028
606500                  VEHICL-CURR-TRIP-ID                             61190028
606600         DISPLAY 'PW-SHIPMT-PRO-NBR:    '                         61200028
606700                  PW-SHIPMT-PRO-NBR                               61210028
606800         DISPLAY 'PW-SHIPMT-BOL-NBR:    '                         61220028
606900                  PW-SHIPMT-BOL-NBR                               61230028
607000         DISPLAY '**************************************'         61240028
607100         PERFORM 9900-SQL-ERROR                                   61250028
607200     END-IF.                                                      61260028
607300                                                                  61270028
607400 EJECT                                                            61280028
607500***************************************************************** 61290028
607600*     SQL INSERT VEHICLE                                        * 61300028
607700***************************************************************** 61310028
607800                                                                  61320028
607900 8870-DELETE-VEHICL.                                              61330028
608000                                                                  61340028
608100     MOVE '8870-DELETE-VEHICL'   TO PV-CURRENT-PARA.              61350028
608200                                                                  61360028
608300     PERFORM                                                      61370028
608400         WITH TEST AFTER                                          61380028
608500         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     61390028
608600         UNTIL  (PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            61400028
608700                 SQLCODE = ZERO OR                                61410028
608800                 SQLCODE = +100                                   61420028
608900                                                                  61430028
609000         EXEC SQL                                                 61440028
609100             DELETE FROM TVEHICL                                  61450028
609200              WHERE OWNER_SCAC_ID   = :PW-SAVE-OWNER-SCAC-ID      61460028
609300                AND VEH_NBR         = :PW-SAVE-VHTRIP-VEH-NBR     61470028
609400         END-EXEC                                                 61480028
609500                                                                  61490028
609600         EVALUATE TRUE                                            61500028
609700             WHEN SQLCODE = ZERO                                  61510028
609800                 ADD  1          TO PA-VEHICL-DELETED             61520028
609900             WHEN SQLCODE = PC-NEG-904                            61530028
610000             WHEN SQLCODE = PC-NEG-913                            61540028
610100             WHEN SQLCODE = PC-NEG-911                            61550028
610200                 CONTINUE                                         61560028
610300                                                                  61570028
610400             WHEN SQLCODE = +100                                  61580028
610500                 DISPLAY '**************************************' 61590028
610600                 DISPLAY 'ATTEMPT DELETE TVEHICL ROW NOT FOUND'   61600028
610700                 DISPLAY 'PW-SAVE-OWNER-SCAC-ID '                 61610028
610800                          PW-SAVE-OWNER-SCAC-ID                   61620028
610900                 DISPLAY 'PW-SAVE-VHTRIP-VEH-NBR '                61630028
611000                          PW-SAVE-VHTRIP-VEH-NBR                  61640028
611100                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 61650028
611200                          VEHICL-OWNER-SCAC-ID                    61660028
611300                 DISPLAY 'VEHICL-VEH-NBR:       '                 61670028
611400                          VEHICL-VEH-NBR                          61680028
611500                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 61690028
611600                          VEHICL-CURR-TRIP-ID                     61700028
611700                 DISPLAY '**********************************'     61710028
611800                                                                  61720028
611900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              61730028
612000                 DISPLAY '**************************************' 61740028
612100                 DISPLAY 'ERROR ISSUED ON DELETE OF TVEHICL   '   61750028
612200                 DISPLAY 'PW-SAVE-OWNER-SCAC-ID '                 61760028
612300                          PW-SAVE-OWNER-SCAC-ID                   61770028
612400                 DISPLAY 'PW-SAVE-VHTRIP-VEH-NBR '                61780028
612500                          PW-SAVE-VHTRIP-VEH-NBR                  61790028
612600                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 61800028
612700                          VEHICL-OWNER-SCAC-ID                    61810028
612800                 DISPLAY 'VEHICL-VEH-NBR:       '                 61820028
612900                          VEHICL-VEH-NBR                          61830028
613000                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 61840028
613100                          VEHICL-CURR-TRIP-ID                     61850028
613200                 DISPLAY '**********************************'     61860028
613300                 PERFORM 9800-SQL-WARNING                         61870028
613400                                                                  61880028
613500             WHEN SQLCODE < ZERO                                  61890028
613600                 DISPLAY '**************************************' 61900028
613700                 DISPLAY 'ERROR ISSUED ON INSERT OF TVEHICL     ' 61910028
613800                 DISPLAY 'PW-SAVE-OWNER-SCAC-ID '                 61920028
613900                          PW-SAVE-OWNER-SCAC-ID                   61930028
614000                 DISPLAY 'PW-SAVE-VHTRIP-VEH-NBR '                61940028
614100                          PW-SAVE-VHTRIP-VEH-NBR                  61950028
614200                 DISPLAY 'VEHICL-OWNER-SCAC-ID: '                 61960028
614300                          VEHICL-OWNER-SCAC-ID                    61970028
614400                 DISPLAY 'VEHICL-VEH-NBR:       '                 61980028
614500                          VEHICL-VEH-NBR                          61990028
614600                 DISPLAY 'VEHICL-CURR-TRIP-ID:  '                 62000028
614700                          VEHICL-CURR-TRIP-ID                     62010028
614800                 DISPLAY '**************************************' 62020028
614900                 PERFORM 9900-SQL-ERROR                           62030028
615000                                                                  62040028
615100         END-EVALUATE                                             62050028
615200     END-PERFORM.                                                 62060028
615300                                                                  62070028
615400     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    62080028
615500         SQLCODE NOT = ZERO AND                                   62090028
615600         SQLCODE NOT = +100                                       62100028
615700         DISPLAY '**************************************'         62110028
615800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         62120028
615900         DISPLAY 'INSERT TO TVEHICL                     '         62130028
616000         DISPLAY 'PW-SAVE-OWNER-SCAC-ID '                         62140028
616100                  PW-SAVE-OWNER-SCAC-ID                           62150028
616200         DISPLAY 'PW-SAVE-VHTRIP-VEH-NBR '                        62160028
616300                  PW-SAVE-VHTRIP-VEH-NBR                          62170028
616400         DISPLAY 'VEHICL-OWNER-SCAC-ID: '                         62180028
616500                  VEHICL-OWNER-SCAC-ID                            62190028
616600         DISPLAY 'VEHICL-VEH-NBR:       '                         62200028
616700                  VEHICL-VEH-NBR                                  62210028
616800         DISPLAY 'VEHICL-CURR-TRIP-ID:  '                         62220028
616900                  VEHICL-CURR-TRIP-ID                             62230028
617000         DISPLAY 'PW-SHIPMT-PRO-NBR:    '                         62240028
617100                  PW-SHIPMT-PRO-NBR                               62250028
617200         DISPLAY 'PW-SHIPMT-BOL-NBR:    '                         62260028
617300                  PW-SHIPMT-BOL-NBR                               62270028
617400         DISPLAY '**************************************'         62280028
617500         PERFORM 9900-SQL-ERROR                                   62290028
617600     END-IF.                                                      62300028
617700                                                                  62310028
617800 EJECT                                                            62320028
617900***************************************************************** 62330028
618000*     CHECK IF THE TRIP STATUS RECORD ALREADY EXIST.  ALSO      * 62340028
618100*     NEED TO DETERMINE WHAT PROGRAM PUT IT INTO THAT STATUS.   * 62350028
618200***************************************************************** 62360028
618300                                                                  62370028
618400 8900-PROCESS-TRIPST.                                             62380028
618500                                                                  62390028
618600     MOVE '8900-PROCESS-TRIPST'  TO PV-CURRENT-PARA.              62400028
618700     MOVE PW-TRIPST-TRIP-STATUS-CDE (PW-SUB)                      62410028
618800                                 TO SHIPST-SHIPT-STATUS-CDE.      62420028
618900                                                                  62430028
619000     PERFORM 8920-SELECT-TRIPST.                                  62440028
619100                                                                  62450028
619200     IF PS-INSERT-TRIPST                                          62460028
619300         PERFORM 8940-FORMAT-TRIPST                               62470028
619400         PERFORM 8980-INSERT-TRIPST                               62480028
619500     ELSE                                                         62490028
619600         IF PS-UPDATE-TRIPST                                      62500028
619700             PERFORM 8940-FORMAT-TRIPST                           62510028
619800             PERFORM 8960-UPDATE-TRIPST                           62520028
619900         END-IF                                                   62530028
620000     END-IF.                                                      62540028
620100                                                                  62550028
620200 EJECT                                                            62560028
620300***************************************************************** 62570028
620400*     DETERMINE WHETHER A TRIP STATUS RECORD SHOULD BE INSERTED * 62580028
620500*     OR UPDATED.                                               * 62590028
620600***************************************************************** 62600028
620700                                                                  62610028
620800 8920-SELECT-TRIPST.                                              62620028
620900                                                                  62630028
621000     MOVE '8920-SELECT-TRIPST'   TO PV-CURRENT-PARA.              62640028
621100     MOVE PW-TRIPST-TRIP-STATUS-CDE (PW-SUB)                      62650028
621200                                 TO TRIPST-TRIP-STATUS-CDE.       62660028
621300                                                                  62670028
621400     MOVE PC-EN          TO TRIPST-TRIP-STATUS-CDE.               62680028
621500                                                                  62690028
621600     PERFORM                                                      62700028
621700         WITH TEST AFTER                                          62710028
621800         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     62720028
621900         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            62730028
622000                (SQLCODE = ZERO)   OR                             62740028
622100                (SQLCODE = PC-100)                                62750028
622200                                                                  62760028
622300         EXEC SQL                                                 62770028
622400             SELECT TRIP_ID,                                      62780028
622500                    TRIP_STATUS_CDE,                              62790028
622600                    STATUS_DTE,                                   62800028
622700                    STATUS_TME,                                   62810028
622800                    STATUS_UID,                                   62820028
622900                    OPER_UNT_ID,                                  62830028
623000                    FCLTY_ID,                                     62840028
623100                    FCLTY_AREA_ID                                 62850028
623200               INTO :TRIPST-TRIP-ID,                              62860028
623300                    :TRIPST-TRIP-STATUS-CDE,                      62870028
623400                    :TRIPST-STATUS-DTE,                           62880028
623500                    :TRIPST-STATUS-TME,                           62890028
623600                    :TRIPST-STATUS-UID,                           62900028
623700                    :TRIPST-OPER-UNT-ID,                          62910028
623800                    :TRIPST-FCLTY-ID,                             62920028
623900                    :TRIPST-FCLTY-AREA-ID                         62930028
624000               FROM TTRIPST                                       62940028
624100              WHERE TRIP_ID         = :PW-TRIPST-TRIP-ID          62950028
624200                AND TRIP_STATUS_CDE = :TRIPST-TRIP-STATUS-CDE     62960028
624300         END-EXEC                                                 62970028
624400                                                                  62980028
624500         EVALUATE TRUE                                            62990028
624600             WHEN SQLCODE = ZERO                                  63000028
624700             WHEN SQLCODE = PC-100                                63010028
624800             WHEN SQLCODE = PC-NEG-904                            63020028
624900             WHEN SQLCODE = PC-NEG-913                            63030028
625000             WHEN SQLCODE = PC-NEG-911                            63040028
625100                 CONTINUE                                         63050028
625200                                                                  63060028
625300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              63070028
625400                 DISPLAY '**************************************' 63080028
625500                 DISPLAY 'WARNING ISSUED ON SELECT OF TTRIPST   ' 63090028
625600                 DISPLAY 'PW-TRIPST-TRIP-ID: '                    63100028
625700                          PW-TRIPST-TRIP-ID                       63110028
625800                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               63120028
625900                          TRIPST-TRIP-STATUS-CDE                  63130028
626000                 DISPLAY '**********************************'     63140028
626100                 PERFORM 9800-SQL-WARNING                         63150028
626200                                                                  63160028
626300             WHEN  SQLCODE < ZERO                                 63170028
626400                 DISPLAY '**************************************' 63180028
626500                 DISPLAY 'ERROR ISSUED ON SELECT OF TTRIPST     ' 63190028
626600                 DISPLAY 'PW-TRIPST-TRIP-ID: '                    63200028
626700                          PW-TRIPST-TRIP-ID                       63210028
626800                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               63220028
626900                          TRIPST-TRIP-STATUS-CDE                  63230028
627000                 DISPLAY '**************************************' 63240028
627100                 PERFORM 9900-SQL-ERROR                           63250028
627200                                                                  63260028
627300         END-EVALUATE                                             63270028
627400                                                                  63280028
627500     END-PERFORM.                                                 63290028
627600                                                                  63300028
627700     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    63310028
627800         SQLCODE NOT = ZERO                                       63320028
627900         DISPLAY '**************************************'         63330028
628000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         63340028
628100         DISPLAY 'SELECT TTRIPST                        '         63350028
628200         DISPLAY 'PW-TRIPST-TRIP-ID: '                            63360028
628300                  PW-TRIPST-TRIP-ID                               63370028
628400         DISPLAY 'TRIPST-TRIP-STATUS-CDE: '                       63380028
628500                  TRIPST-TRIP-STATUS-CDE                          63390028
628600         DISPLAY '**************************************'         63400028
628700         PERFORM 9900-SQL-ERROR                                   63410028
628800     END-IF.                                                      63420028
628900                                                                  63430028
629000     EVALUATE TRUE                                                63440028
629100         WHEN SQLCODE = ZERO                                      63450028
629200             IF TRIPST-STATUS-UID = PC-TRKUP004 OR                63460028
629300                TRIPST-STATUS-UID = PC-RCKUP006                   63470028
629400                 SET PS-UPDATE-TRIPST                             63480028
629500                                 TO TRUE                          63490028
629600             ELSE                                                 63500028
629700                 SET PS-BYPASS-TRIPST                             63510028
629800                                 TO TRUE                          63520028
629900             END-IF                                               63530028
630000         WHEN SQLCODE = +100                                      63540028
630100             SET PS-INSERT-TRIPST                                 63550028
630200                                 TO TRUE                          63560028
630300     END-EVALUATE.                                                63570028
630400 EJECT                                                            63580028
630500***************************************************************** 63590028
630600*    MOVE FIELDS FROM HOLD AREA TO DATABASE                     * 63600028
630700***************************************************************** 63610028
630800                                                                  63620028
630900 8940-FORMAT-TRIPST.                                              63630028
631000                                                                  63640028
631100     MOVE '8940-FORMAT-TRIPST'   TO PV-CURRENT-PARA.              63650028
631200                                                                  63660028
631300     MOVE PW-TRIPST-STATUS-DTE (PW-SUB)                           63670028
631400                                 TO TRIPST-STATUS-DTE.            63680028
631500     MOVE PW-TRIPST-STATUS-TME (PW-SUB)                           63690028
631600                                 TO TRIPST-STATUS-TME.            63700028
631700                                                                  63710028
631800     MOVE PW-TRIPST-TRIP-ID      TO TRIPST-TRIP-ID.               63720028
631900     MOVE PW-TRIPST-OPER-UNT-ID  TO TRIPST-OPER-UNT-ID.           63730028
632000     MOVE PW-TRIPST-FCLTY-ID     TO TRIPST-FCLTY-ID.              63740028
632100     MOVE PW-TRIPST-FCLTY-AREA-ID                                 63750028
632200                                 TO TRIPST-FCLTY-AREA-ID.         63760028
632300                                                                  63770028
632400 EJECT                                                            63780028
632500***************************************************************** 63790028
632600*     SQL UPDATE TRIP STATUS                                    * 63800028
632700***************************************************************** 63810028
632800                                                                  63820028
632900 8960-UPDATE-TRIPST.                                              63830028
633000                                                                  63840028
633100     MOVE '8960-UPDATE-TRIPST'   TO PV-CURRENT-PARA.              63850028
633200                                                                  63860028
633300     PERFORM                                                      63870028
633400         WITH TEST AFTER                                          63880028
633500         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     63890028
633600         UNTIL  (PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            63900028
633700                (SQLCODE = ZERO OR +100)                          63910028
633800                                                                  63920028
633900         EXEC SQL                                                 63930028
634000             UPDATE TTRIPST                                       63940028
634100                SET STATUS_DTE      = :TRIPST-STATUS-DTE,         63950028
634200                    STATUS_TME      = :TRIPST-STATUS-TME,         63960028
634300                    STATUS_UID      = :PC-TRKUP004,               63970028
634400                    OPER_UNT_ID     = :TRIPST-OPER-UNT-ID,        63980028
634500                    FCLTY_ID        = :TRIPST-FCLTY-ID,           63990028
634600                    FCLTY_AREA_ID   = :TRIPST-FCLTY-AREA-ID       64000028
634700              WHERE TRIP_ID         = :TRIPST-TRIP-ID             64010028
634800                AND TRIP_STATUS_CDE = :TRIPST-TRIP-STATUS-CDE     64020028
634900         END-EXEC                                                 64030028
635000                                                                  64040028
635100         EVALUATE TRUE                                            64050028
635200             WHEN SQLCODE = ZERO                                  64060028
635300                 ADD  1          TO PA-TRIPST-UPDATED             64070028
635400             WHEN SQLCODE = PC-100                                64080028
635500             WHEN SQLCODE = PC-NEG-904                            64090028
635600             WHEN SQLCODE = PC-NEG-913                            64100028
635700             WHEN SQLCODE = PC-NEG-911                            64110028
635800                 CONTINUE                                         64120028
635900                                                                  64130028
636000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              64140028
636100                 DISPLAY '**************************************' 64150028
636200                 DISPLAY 'WARNING ISSUED ON UPDATE OF TTRIPST   ' 64160028
636300                 DISPLAY 'TRIPST-TRIP-ID:         '               64170028
636400                          TRIPST-TRIP-ID                          64180028
636500                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               64190028
636600                          TRIPST-TRIP-STATUS-CDE                  64200028
636700                 DISPLAY '**********************************'     64210028
636800                 PERFORM 9800-SQL-WARNING                         64220028
636900                                                                  64230028
637000             WHEN SQLCODE < ZERO                                  64240028
637100                 DISPLAY '**************************************' 64250028
637200                 DISPLAY 'ERROR ISSUED ON UPDATE OF TTRIPST     ' 64260028
637300                 DISPLAY 'TRIPST-TRIP-ID:         '               64270028
637400                          TRIPST-TRIP-ID                          64280028
637500                 DISPLAY 'TRIPST-TRIP-STATUS-CDE: '               64290028
637600                          TRIPST-TRIP-STATUS-CDE                  64300028
637700                 DISPLAY '**************************************' 64310028
637800                 PERFORM 9900-SQL-ERROR                           64320028
637900                                                                  64330028
638000         END-EVALUATE                                             64340028
638100     END-PERFORM.                                                 64350028
638200                                                                  64360028
638300     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    64370028
638400         SQLCODE NOT = ZERO                                       64380028
638500         DISPLAY '**************************************'         64390028
638600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         64400028
638700         DISPLAY 'UPDATE TO TTRIPST                     '         64410028
638800         DISPLAY 'TRIPST-TRIP-ID:         '                       64420028
638900                  TRIPST-TRIP-ID                                  64430028
639000         DISPLAY 'TRIPST-TRIP-STATUS-CDE: '                       64440028
639100                  TRIPST-TRIP-STATUS-CDE                          64450028
639200         DISPLAY 'PW-SHIPMT-PRO-NBR:      '                       64460028
639300                  PW-SHIPMT-PRO-NBR                               64470028
639400         DISPLAY 'PW-SHIPMT-BOL-NBR:      '                       64480028
639500                  PW-SHIPMT-BOL-NBR                               64490028
639600         DISPLAY '**************************************'         64500028
639700         PERFORM 9900-SQL-ERROR                                   64510028
639800     END-IF.                                                      64520028
639900                                                                  64530028
640000***************************************************************** 64540028
640100*     SQL INSERT TRIP STATUS                                    * 64550028
640200***************************************************************** 64560028
640300                                                                  64570028
640400 8980-INSERT-TRIPST.                                              64580028
640500                                                                  64590028
640600     MOVE '8980-INSERT-TRIPST'   TO PV-CURRENT-PARA.              64600028
640700                                                                  64610028
640800     PERFORM                                                      64620028
640900         WITH TEST AFTER                                          64630028
641000         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     64640028
641100         UNTIL  (PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            64650028
641200                (SQLCODE = ZERO)                                  64660028
641300                                                                  64670028
641400         EXEC SQL                                                 64680028
641500             INSERT INTO TTRIPST                                  64690028
641600                   (TRIP_ID,                                      64700028
641700                    TRIP_STATUS_CDE,                              64710028
641800                    STATUS_DTE,                                   64720028
641900                    STATUS_TME,                                   64730028
642000                    STATUS_UID,                                   64740028
642100                    OPER_UNT_ID,                                  64750028
642200                    FCLTY_ID,                                     64760028
642300                    FCLTY_AREA_ID)                                64770028
642400             VALUES                                               64780028
642500                  (:TRIPST-TRIP-ID,                               64790028
642600                   :TRIPST-TRIP-STATUS-CDE,                       64800028
642700                   :TRIPST-STATUS-DTE,                            64810028
642800                   :TRIPST-STATUS-TME,                            64820028
642900                   :PC-TRKUP004,                                  64830028
643000                   :TRIPST-OPER-UNT-ID,                           64840028
643100                   :TRIPST-FCLTY-ID,                              64850028
643200                   :TRIPST-FCLTY-AREA-ID)                         64860028
643300         END-EXEC                                                 64870028
643400                                                                  64880028
643500         EVALUATE TRUE                                            64890028
643600             WHEN SQLCODE = ZERO                                  64900028
643700                 ADD  1          TO PA-TRIPST-INSERTED            64910028
643800             WHEN SQLCODE = PC-100                                64920028
643900             WHEN SQLCODE = PC-NEG-904                            64930028
644000             WHEN SQLCODE = PC-NEG-913                            64940028
644100             WHEN SQLCODE = PC-NEG-911                            64950028
644200                 CONTINUE                                         64960028
644300                                                                  64970028
644400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              64980028
644500                 DISPLAY '**************************************' 64990028
644600                 DISPLAY 'WARNING ISSUED ON INSERT OF TTRIPST   ' 65000028
644700                 DISPLAY 'TRIPST-TRIP-ID:       '                 65010028
644800                          TRIPST-TRIP-ID                          65020028
644900                 DISPLAY '**********************************'     65030028
645000                 PERFORM 9800-SQL-WARNING                         65040028
645100                                                                  65050028
645200             WHEN SQLCODE < ZERO                                  65060028
645300                 DISPLAY '**************************************' 65070028
645400                 DISPLAY 'ERROR ISSUED ON INSERT OF TTRIPST     ' 65080028
645500                 DISPLAY 'TRIPST-TRIP-ID:       '                 65090028
645600                          TRIPST-TRIP-ID                          65100028
645700                 DISPLAY 'PW-SUB: '                               65110028
645800                          PW-SUB                                  65120028
645900                 DISPLAY 'PRO:    ' PW-SHIPMT-COMP-PRO            65130028
646000                 DISPLAY 'BOL:    ' PW-SHIPMT-COMP-BOL            65140028
646100                 DISPLAY '**************************************' 65150028
646200                 PERFORM 9900-SQL-ERROR                           65160028
646300                                                                  65170028
646400         END-EVALUATE                                             65180028
646500     END-PERFORM.                                                 65190028
646600                                                                  65200028
646700     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    65210028
646800         SQLCODE NOT = ZERO                                       65220028
646900         DISPLAY '**************************************'         65230028
647000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         65240028
647100         DISPLAY 'INSERT TO TTRIPST                     '         65250028
647200         DISPLAY 'TRIPST-TRIP-ID:       '                         65260028
647300                  TRIPST-TRIP-ID                                  65270028
647400         DISPLAY 'PW-SHIPMT-PRO-NBR:    '                         65280028
647500                  PW-SHIPMT-PRO-NBR                               65290028
647600         DISPLAY 'PW-SHIPMT-BOL-NBR:    '                         65300028
647700                  PW-SHIPMT-BOL-NBR                               65310028
647800         DISPLAY '**************************************'         65320028
647900         PERFORM 9900-SQL-ERROR                                   65330028
648000     END-IF.                                                      65340028
648100                                                                  65350028
648200 EJECT                                                            65360028
648300****************************************************************  65370028
648400*     READ-SHIPMENT-STATUS                                     *  65380028
648500*                                                              *  65390028
648600*     -  READ SHIPMENT-STATUS RECORD                           *  65400028
648700****************************************************************  65410028
648800                                                                  65420028
648900 9000-READ-SHIPMENT-STATUS.                                       65430028
649000                                                                  65440028
649100     MOVE '9000-READ-SHIPMENT-STATUS      '                       65450028
649200                                 TO PV-CURRENT-PARA.              65460028
649300                                                                  65470028
649400     MOVE TR001-REC-TYP-CDE      TO PS-PRIOR-REC-TYP-SW.          65480028
649500                                                                  65490028
649600     READ SHIPMENT-STATUS-FILE                                    65500028
649700         INTO TR001-SHIPT-STATUS-MSG-RECORD                       65510028
649800         AT END                                                   65520028
649900             SET PS-END-OF-INP01 TO TRUE.                         65530028
650000                                                                  65540028
650100     IF PS-END-OF-INP01                                           65550028
650200         IF NOT PS-PRIOR-SE-TRANS-SET-TRL-REC                     65560028
650300             DISPLAY '** NO SE-TRANS-SET-TRL-REC     **'          65570028
650400             DISPLAY '** VERIFY ALL DATA TRANSMITTED **'          65580028
650500         END-IF                                                   65590028
650600     ELSE                                                         65600028
650700         ADD PC-1                TO PA-SHIPT-STATUS-READ          65610028
650800         IF  TR001-ST-TRANS-SET-HDR-REC                           65620028
650900             MOVE TR001-TRANS-SET-HDR-RECORD TO                   65630028
651000               PW-HOLD-TRANS-SET-HDR-RECORD                       65640028
651100         END-IF                                                   65650028
651200     END-IF.                                                      65660028
651300                                                                  65670028
651400 EJECT                                                            65680028
651500***************************************************************** 65690028
651600*     SQL UPDATE SHIPMT                                         * 65700028
651700*                                                               * 65710028
651800***************************************************************** 65720028
651900                                                                  65730028
652000 9100-UPDATE-SHIPMT.                                              65740028
652100                                                                  65750028
652200     MOVE '9100-UPDATE-SHIPMT'   TO PV-CURRENT-PARA.              65760028
652300                                                                  65770028
652400     PERFORM                                                      65780028
652500         WITH TEST AFTER                                          65790028
652600         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     65800028
652700         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            65810028
652800                 SQLCODE = ZERO                                   65820028
652900                                                                  65830028
653000* CLT 12-20-2011 WR40574 ADDED CAN (CARR-AUTH-ID) BELOW           65840028
653100         EXEC SQL                                                 65850028
653200             UPDATE TSHIPMT                                       65860028
653300                SET TRIP_ID         = :PW-SHIPMT-TRIP-ID          65870028
653400                                      :PV-SHIPMT-TRIP-ID-NULL,    65880028
653500                    CRT_SRC_CDE     = :PW-SHIPMT-CRT-SRC-CDE,     65890028
653600                    LAST_UPD_DTE    =  CURRENT DATE,              65900028
653700                    LAST_UPD_TME    =  CURRENT TIME,              65910028
653800                    LAST_UPD_UID    = :PC-TRKUP004,               65920028
653900                    PRO_SCAC_ID     = :PW-SHIPMT-PRO-SCAC-ID,     65930028
654000                    PRO_NBR         = :PW-SHIPMT-PRO-NBR,         65940028
654100                    BOL_NBR         = :PW-SHIPMT-BOL-NBR,         65950028
654200                    SHIPPER_NME     = :PW-SHIPMT-SHIPPER-NME,     65960028
654300                    SHIPT_TYP_CDE   = :PW-SHIPMT-SHIPT-TYP-CDE,   65970028
654400                    EXPTED_GRO_WGHT = :PW-SHIPMT-EXPTED-GRO-WGHT, 65980028
654500                    PKG_TYP_CDE     = :PW-SHIPMT-PKG-TYP-CDE,     65990028
654600                    EXPTED_PKG_QTY  = :PW-SHIPMT-EXPTED-PKG-QTY,  66000028
654700                    FRGT_CHG_AMT    = :PW-SHIPMT-FRGT-CHG-AMT,    66010028
654800                    FRGT_TERMS_CDE  = :PW-SHIPMT-FRGT-TERMS-CDE,  66020028
654900                    EXPTED_PLT_QTY  = :PW-SHIPMT-EXPTED-PLT-QTY,  66030028
655000                    EST_AR_TMST     = :PW-SHIPMT-EST-AR-TMST      66040028
655100                                      :PV-SHIPMT-EST-AR-NULL,     66050028
655200                    ORIG_SCAC_ID    = :PW-SHIPMT-ORIGIN-SCAC-ID,  66060028
655300                    LAST_UPD_PGM_ID = :PC-TRKUP004,               66070028
655400                    CARR_CART_CT    = :PW-SHIPMT-CARR-CARTON-CNT, 66080028
655500                    CARR_LAST_UPD_DTE  = CURRENT DATE,            66090028
655600                    CARR_LAST_UPD_TIME = CURRENT TIME,            66100028
655700                    VEH_NBR         = :PW-SHIPMT-VEH-NBR,         66110028
655800                    COMPLETE_PRO_NBR = :PW-SHIPMT-COMP-PRO,       66120028
655900                    COMPLETE_BOL_NBR = :PW-SHIPMT-COMP-BOL,       66130029
656000                    CARR_AUTH_ID     = :PW-SHIPMT-CARR-AUTH-ID    66140028
656100              WHERE SHIPT_ID        = :PW-SHIPMT-SHIPT-ID         66150028
656200         END-EXEC                                                 66160028
656300                                                                  66170028
656400         EVALUATE TRUE                                            66180028
656500             WHEN SQLCODE = ZERO                                  66190028
656600             WHEN SQLCODE = PC-NEG-904                            66200028
656700             WHEN SQLCODE = PC-NEG-913                            66210028
656800             WHEN SQLCODE = PC-NEG-911                            66220028
656900                 CONTINUE                                         66230028
657000                                                                  66240028
657100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              66250028
657200                 DISPLAY '**************************************' 66260028
657300                 DISPLAY 'WARNING ISSUED ON UPDATE OF TSHIPMT   ' 66270028
657400                 DISPLAY 'PW-SHIPMT-SHIPT-ID:      '              66280028
657500                          PW-SHIPMT-SHIPT-ID                      66290028
657600                 DISPLAY '**********************************'     66300028
657700                 PERFORM 9800-SQL-WARNING                         66310028
657800                                                                  66320028
657900             WHEN SQLCODE < ZERO                                  66330028
658000                 DISPLAY '**************************************' 66340028
658100                 DISPLAY 'ERROR ISSUED ON UPDATE OF TSHIPMT     ' 66350028
658200                 DISPLAY 'PW-SHIPMT-SHIPT-ID:      '              66360028
658300                          PW-SHIPMT-SHIPT-ID                      66370028
658400                 DISPLAY '**************************************' 66380028
658500                 PERFORM 9900-SQL-ERROR                           66390028
658600                                                                  66400028
658700         END-EVALUATE                                             66410028
658800                                                                  66420028
658900     END-PERFORM.                                                 66430028
659000                                                                  66440028
659100     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    66450028
659200         SQLCODE NOT = ZERO                                       66460028
659300         DISPLAY '**************************************'         66470028
659400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         66480028
659500         DISPLAY 'UPDATE TSHIPMT                        '         66490028
659600         DISPLAY 'PW-SHIPMT-SHIPT-ID:      '                      66500028
659700                  PW-SHIPMT-SHIPT-ID                              66510028
659800         DISPLAY 'PW-SHIPMT-PRO-NBR:       '                      66520028
659900                  PW-SHIPMT-PRO-NBR                               66530028
660000         DISPLAY 'PW-SHIPMT-BOL-NBR:       '                      66540028
660100                  PW-SHIPMT-BOL-NBR                               66550028
660200         DISPLAY '**************************************'         66560028
660300         PERFORM 9900-SQL-ERROR                                   66570028
660400     END-IF.                                                      66580028
660500                                                                  66590028
660600     EVALUATE TRUE                                                66600028
660700         WHEN SQLCODE = ZERO                                      66610028
660800             ADD  1              TO PA-SHIPMT-UPDATED             66620028
660900     END-EVALUATE.                                                66630028
661000                                                                  66640028
661100 EJECT                                                            66650028
661200***************************************************************** 66660028
661300*     DELETE UNUSED TRIPS                                       * 66670028
661400***************************************************************** 66680028
661500                                                                  66690028
661600 9150-DELETE-VHTRIP.                                              66700028
661700                                                                  66710028
661800     MOVE '9150-DELETE-VHTRIP'   TO PV-CURRENT-PARA.              66720028
661900                                                                  66730028
662000     PERFORM                                                      66740028
662100         WITH TEST AFTER                                          66750028
662200         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     66760028
662300         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            66770028
662400                 SQLCODE = ZERO OR SQLCODE = +100                 66780028
662500                                                                  66790028
662600         EXEC SQL                                                 66800028
662700             DELETE FROM TVHTRIP                                  66810028
662800              WHERE TRIP_ID         = :PW-SAVE-SHIPMT-TRIP-ID     66820028
662900         END-EXEC                                                 66830028
663000                                                                  66840028
663100         EVALUATE TRUE                                            66850028
663200             WHEN SQLCODE = ZERO                                  66860028
663300             WHEN SQLCODE = +100                                  66870028
663400             WHEN SQLCODE = PC-NEG-904                            66880028
663500             WHEN SQLCODE = PC-NEG-913                            66890028
663600             WHEN SQLCODE = PC-NEG-911                            66900028
663700                 CONTINUE                                         66910028
663800                                                                  66920028
663900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              66930028
664000                 DISPLAY '**************************************' 66940028
664100                 DISPLAY 'WARNING ISSUED ON DELETE OF TVHTRIP   ' 66950028
664200                 DISPLAY 'PW-SAVE-SHIPMT-TRIP-ID: '               66960028
664300                          PW-SAVE-SHIPMT-TRIP-ID                  66970028
664400                 DISPLAY '**********************************'     66980028
664500                 PERFORM 9800-SQL-WARNING                         66990028
664600                                                                  67000028
664700             WHEN SQLCODE < ZERO                                  67010028
664800                 DISPLAY '**************************************' 67020028
664900                 DISPLAY 'ERROR ISSUED ON DELETE OF TVHTRIP     ' 67030028
665000                 DISPLAY 'PW-SAVE-SHIPMT-TRIP-ID: '               67040028
665100                          PW-SAVE-SHIPMT-TRIP-ID                  67050028
665200                 DISPLAY '**************************************' 67060028
665300                 PERFORM 9900-SQL-ERROR                           67070028
665400                                                                  67080028
665500         END-EVALUATE                                             67090028
665600                                                                  67100028
665700     END-PERFORM.                                                 67110028
665800                                                                  67120028
665900     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    67130028
666000         SQLCODE NOT = ZERO                                       67140028
666100         DISPLAY '**************************************'         67150028
666200         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         67160028
666300         DISPLAY 'DELETE TVHTRIP                        '         67170028
666400         DISPLAY 'PW-SAVE-SHIPMT-TRIP-ID: '                       67180028
666500                  PW-SAVE-SHIPMT-TRIP-ID                          67190028
666600         DISPLAY '**************************************'         67200028
666700         PERFORM 9900-SQL-ERROR                                   67210028
666800     END-IF.                                                      67220028
666900                                                                  67230028
667000***************************************************************** 67240028
667100*     SQL INSERT SHIPMT                                         * 67250028
667200*                                                               * 67260028
667300***************************************************************** 67270028
667400                                                                  67280028
667500 9200-INSERT-SHIPMT.                                              67290028
667600                                                                  67300028
667700     MOVE '9200-INSERT-SHIPMT'   TO PV-CURRENT-PARA.              67310028
667800                                                                  67320028
667900     PERFORM                                                      67330028
668000         WITH TEST AFTER                                          67340028
668100         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     67350028
668200         UNTIL ((PW-RETRY-COUNTER > PC-MAX-RETRIES) OR            67360028
668300                (SQLCODE = ZERO) OR (SQLCODE = PC-NEG-803))       67370028
668400                                                                  67380028
668500* CLT 12-20-2011 WR40574 ADDED CAN (CARR-AUTH-ID) BELOW           67390028
668600         EXEC SQL                                                 67400028
668700             INSERT INTO TSHIPMT                                  67410028
668800                   (TRIP_ID,                                      67420028
668900                    SHIPT_ID,                                     67430028
669000                    CRT_SRC_CDE,                                  67440028
669100                    LAST_UPD_DTE,                                 67450028
669200                    LAST_UPD_TME,                                 67460028
669300                    LAST_UPD_UID,                                 67470028
669400                    PRO_SCAC_ID,                                  67480028
669500                    PRO_NBR,                                      67490028
669600                    BOL_NBR,                                      67500028
669700                    SHIPPER_NME,                                  67510028
669800                    SHIPT_TYP_CDE,                                67520028
669900                    EXPTED_GRO_WGHT,                              67530028
670000                    PKG_TYP_CDE,                                  67540028
670100                    EXPTED_PKG_QTY,                               67550028
670200                    FRGT_CHG_AMT,                                 67560028
670300                    FRGT_TERMS_CDE,                               67570028
670400                    EXPTED_PLT_QTY,                               67580028
670500                    VEND_SHIP_DTE,                                67590028
670600                    EST_AR_TMST,                                  67600028
670700                    ORIG_SCAC_ID,                                 67610028
670800                    LAST_UPD_PGM_ID,                              67620028
670900                    CRE_USER_ID,                                  67630028
671000                    CARR_CART_CT,                                 67640028
671100                    CARR_LAST_UPD_DTE,                            67650028
671200                    CARR_LAST_UPD_TIME,                           67660028
671300                    VEND_LAST_UPD_DTE,                            67670028
671400                    VEND_LAST_UPD_TIME,                           67680028
671500                    VEH_NBR,                                      67690028
671600                    AUTH_DTE,                                     67700028
671700                    CONFIRM_DTE,                                  67710028
671800                    CONFIRM_TIME,                                 67720028
671900                    COMPLETE_PRO_NBR,                             67730028
672000                    COMPLETE_BOL_NBR,                             67740028
672100                    PROCESSED_DTE,                                67750028
672200                    CARR_AUTH_ID)                                 67760028
672300             VALUES                                               67770028
672400                  (:PW-SHIPMT-TRIP-ID   :PV-SHIPMT-TRIP-ID-NULL,  67780028
672500                   :PW-SHIPMT-SHIPT-ID,                           67790028
672600                   :PC-CE,                                        67800028
672700                   CURRENT DATE,                                  67810028
672800                   CURRENT TIME,                                  67820028
672900                   :PC-TRKUP004,                                  67830028
673000                   :PW-SHIPMT-PRO-SCAC-ID,                        67840028
673100                   :PW-SHIPMT-PRO-NBR,                            67850028
673200                   :PW-SHIPMT-BOL-NBR,                            67860028
673300                   :PW-SHIPMT-SHIPPER-NME,                        67870028
673400                   :PC-DEFAULT-SHIPT-TYP-CDE,                     67880028
673500                   :PW-SHIPMT-EXPTED-GRO-WGHT,                    67890028
673600                   :PW-SHIPMT-PKG-TYP-CDE,                        67900028
673700                   :PW-SHIPMT-EXPTED-PKG-QTY,                     67910028
673800                   :PW-SHIPMT-FRGT-CHG-AMT,                       67920028
673900                   :PW-SHIPMT-FRGT-TERMS-CDE,                     67930028
674000                   :PW-SHIPMT-EXPTED-PLT-QTY,                     67940028
674100                   :PC-DEFAULT-DATE,                              67950028
674200                   :PW-SHIPMT-EST-AR-TMST :PV-SHIPMT-EST-AR-NULL, 67960028
674300                   :PW-SHIPMT-ORIGIN-SCAC-ID,                     67970028
674400                   :PC-TRKUP004,                                  67980028
674500                   :PC-TRKUP004,                                  67990028
674600                   :PW-SHIPMT-CARR-CARTON-CNT,                    68000028
674700                    CURRENT DATE,                                 68010028
674800                    CURRENT TIME,                                 68020028
674900                   :PC-DEFAULT-DATE,                              68030028
675000                   :PC-DEFAULT-TIME,                              68040028
675100                   :PW-SHIPMT-VEH-NBR,                            68050028
675200                   :PC-DEFAULT-DATE,                              68060028
675300                   :PC-DEFAULT-DATE,                              68070028
675400                   :PC-DEFAULT-TIME,                              68080028
675500                   :PW-SHIPMT-COMP-PRO,                           68090028
675600                   :PW-SHIPMT-COMP-BOL,                           68100028
675700                   :PC-DEFAULT-DATE,                              68110028
675800                   :PW-SHIPMT-CARR-AUTH-ID)                       68120028
675900         END-EXEC                                                 68130028
676000                                                                  68140028
676100         EVALUATE TRUE                                            68150028
676200             WHEN SQLCODE = ZERO                                  68160028
676300             WHEN SQLCODE = PC-NEG-803                            68170028
676400             WHEN SQLCODE = PC-NEG-904                            68180028
676500             WHEN SQLCODE = PC-NEG-913                            68190028
676600             WHEN SQLCODE = PC-NEG-911                            68200028
676700                 CONTINUE                                         68210028
676800                                                                  68220028
676900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              68230028
677000                 DISPLAY '**************************************' 68240028
677100                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHIPMT   ' 68250028
677200                 DISPLAY 'PW-SHIPMT-SHIPT-ID:    '                68260028
677300                          PW-SHIPMT-SHIPT-ID                      68270028
677400                 DISPLAY 'PW-SHIPMT-BOL-NBR:     '                68280028
677500                          PW-SHIPMT-BOL-NBR                       68290028
677600                 DISPLAY 'PW-SHIPMT-PRO-NBR:   '                  68300028
677700                          PW-SHIPMT-PRO-NBR                       68310028
677800                 DISPLAY '**********************************'     68320028
677900                 PERFORM 9800-SQL-WARNING                         68330028
678000                                                                  68340028
678100             WHEN SQLCODE < ZERO                                  68350028
678200                 DISPLAY '**************************************' 68360028
678300                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHIPMT     ' 68370028
678400                 DISPLAY 'PW-SHIPMT-SHIPT-ID:    '                68380028
678500                          PW-SHIPMT-SHIPT-ID                      68390028
678600                 DISPLAY 'PW-SHIPMT-BOL-NBR:     '                68400028
678700                          PW-SHIPMT-BOL-NBR                       68410028
678800                 DISPLAY 'PW-SHIPMT-PRO-NBR:   '                  68420028
678900                          PW-SHIPMT-PRO-NBR                       68430028
679000                 DISPLAY '**************************************' 68440028
679100                 PERFORM 9900-SQL-ERROR                           68450028
679200                                                                  68460028
679300         END-EVALUATE                                             68470028
679400     END-PERFORM.                                                 68480028
679500                                                                  68490028
679600     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    68500028
679700         SQLCODE NOT = ZERO                                       68510028
679800         DISPLAY '**************************************'         68520028
679900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         68530028
680000         DISPLAY 'INSERT TO TSHIPMT                     '         68540028
680100         DISPLAY 'PW-SHIPMT-SHIPT-ID:      '                      68550028
680200                  PW-SHIPMT-SHIPT-ID                              68560028
680300         DISPLAY 'PW-SHIPMT-PRO-NBR:       '                      68570028
680400                  PW-SHIPMT-PRO-NBR                               68580028
680500         DISPLAY 'PW-SHIPMT-BOL-NBR:       '                      68590028
680600                  PW-SHIPMT-BOL-NBR                               68600028
680700         DISPLAY '**************************************'         68610028
680800         PERFORM 9900-SQL-ERROR                                   68620028
680900     END-IF.                                                      68630028
681000                                                                  68640028
681100     EVALUATE TRUE                                                68650028
681200         WHEN SQLCODE = ZERO                                      68660028
681300             ADD  1              TO PA-SHIPMT-INSERTED            68670028
681400         WHEN SQLCODE = PC-NEG-803                                68680028
681500             PERFORM 9100-UPDATE-SHIPMT                           68690028
681600             MOVE PC-020 TO PW-ERROR-NBR (PW-INDEX)               68700028
681700             PERFORM 2250-CHECK-ADD-1-TO-PW-INDEX                 68710028
681800     END-EVALUATE.                                                68720028
681900                                                                  68730028
682000 EJECT                                                            68740028
682100***************************************************************** 68750028
682200*     SQL INSERT SHPTPO                                         * 68760028
682300***************************************************************** 68770028
682400                                                                  68780028
682500 9300-INSERT-SHPTPO.                                              68790028
682600                                                                  68800028
682700     MOVE '9300-INSERT-SHPTPO'   TO PV-CURRENT-PARA.              68810028
682800                                                                  68820028
682900     MOVE PW-SHPTPO-SHIPT-ID     TO SHPTPO-SHIPT-ID.              68830028
683000     MOVE PW-SHPTPO-PO-NBR-N (PW-SUB)                             68840028
683100                                 TO SHPTPO-PO-NBR.                68850028
683200                                                                  68860028
683300     PERFORM                                                      68870028
683400         WITH TEST AFTER                                          68880028
683500         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     68890028
683600         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            68900028
683700                (SQLCODE = ZERO) OR (SQLCODE = PC-NEG-803)        68910028
683800                                                                  68920028
683900         EXEC SQL                                                 68930028
684000             INSERT INTO TSHPTPO                                  68940028
684100                   (SHIPT_ID,                                     68950028
684200                    PO_NBR,                                       68960028
684300                    REC_SEQ_NBR,                                  68970028
684400                    EXPTED_CART_CNT,                              68980028
684500                    ACTL_CART_CNT,                                68990028
684600                    DMG_CART_CNT,                                 69000028
684700                    LAST_UPD_PGM_ID,                              69010028
684800                    CRE_USER_ID,                                  69020028
684900                    CARR_LAST_UPD_DTE,                            69030028
685000                    CARR_LAST_UPD_TIME,                           69040028
685100                    VEND_LAST_UPD_DTE,                            69050028
685200                    VEND_LAST_UPD_TIME,                           69060028
685300                    CRE_TMST,                                     69070028
685400                    LAST_UPD_USER_ID,                             69080028
685500                    PRIM_SHIPT_IND                                69090028
685600                  , SPLT_XMIT_IND                                 69100028
685700                  , SPLT_XMIT_DTE                                 69110028
685800                  , SPLT_XMIT_TM )                                69120028
685900             VALUES                                               69130028
686000                  (:SHPTPO-SHIPT-ID,                              69140028
686100                   :SHPTPO-PO-NBR,                                69150028
686200                   :PC-INT-ZERO,                                  69160028
686300                   :PC-SML-ZERO,                                  69170028
686400                   :PC-SML-ZERO,                                  69180028
686500                   :PC-SML-ZERO,                                  69190028
686600                   :PC-TRKUP004,                                  69200028
686700                   :PC-TRKUP004,                                  69210028
686800                    CURRENT DATE,                                 69220028
686900                    CURRENT TIME,                                 69230028
687000                   :PC-DEFAULT-DATE,                              69240028
687100                   :PC-DEFAULT-TIME,                              69250028
687200                    CURRENT TIMESTAMP,                            69260028
687300                   :PC-TRKUP004,                                  69270028
687400                   :PC-Y                                          69280028
687500                 , :SHPTPO-SPLT-XMIT-IND                          69290028
687600                 , :PC-DEFAULT-DATE                               69300028
687700                 , :PC-DEFAULT-TIME )                             69310028
687800         END-EXEC                                                 69320028
687900                                                                  69330028
688000         EVALUATE TRUE                                            69340028
688100             WHEN SQLCODE = ZERO                                  69350028
688200             WHEN SQLCODE = PC-NEG-803                            69360028
688300             WHEN SQLCODE = PC-NEG-904                            69370028
688400             WHEN SQLCODE = PC-NEG-913                            69380028
688500             WHEN SQLCODE = PC-NEG-911                            69390028
688600                 CONTINUE                                         69400028
688700                                                                  69410028
688800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              69420028
688900                 DISPLAY '**************************************' 69430028
689000                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHPTPO   ' 69440028
689100                 DISPLAY 'SHPTPO-SHIPT-ID:    '                   69450028
689200                          SHPTPO-SHIPT-ID                         69460028
689300                 DISPLAY 'SHPTPO-PO-NBR:      '                   69470028
689400                          SHPTPO-PO-NBR                           69480028
689500                 DISPLAY '**********************************'     69490028
689600                 PERFORM 9800-SQL-WARNING                         69500028
689700                                                                  69510028
689800             WHEN  SQLCODE < ZERO                                 69520028
689900                 DISPLAY '**************************************' 69530028
690000                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHPTPO     ' 69540028
690100                 DISPLAY 'SHPTPO-SHIPT-ID:    '                   69550028
690200                          SHPTPO-SHIPT-ID                         69560028
690300                 DISPLAY 'SHPTPO-PO-NBR:      '                   69570028
690400                          SHPTPO-PO-NBR                           69580028
690500                 DISPLAY '**************************************' 69590028
690600                 PERFORM 9900-SQL-ERROR                           69600028
690700                                                                  69610028
690800         END-EVALUATE                                             69620028
690900                                                                  69630028
691000     END-PERFORM.                                                 69640028
691100                                                                  69650028
691200     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    69660028
691300         SQLCODE NOT = ZERO                                       69670028
691400         DISPLAY '**************************************'         69680028
691500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         69690028
691600         DISPLAY 'INSERT TO TSHPTPO                     '         69700028
691700         DISPLAY 'SHPTPO-SHIPT-ID:    '                           69710028
691800                  SHPTPO-SHIPT-ID                                 69720028
691900         DISPLAY 'SHPTPO-PO-NBR:      '                           69730028
692000                  SHPTPO-PO-NBR                                   69740028
692100         DISPLAY '**************************************'         69750028
692200         PERFORM 9900-SQL-ERROR                                   69760028
692300     END-IF.                                                      69770028
692400                                                                  69780028
692500     EVALUATE TRUE                                                69790028
692600         WHEN SQLCODE = ZERO                                      69800028
692700             ADD  1              TO PA-SHPTPO-INSERTED            69810028
692800             PERFORM 9320-CREATE-SHPTPO-AUDIT-TRAIL               69820028
692900                                                                  69830028
693000         WHEN SQLCODE = PC-NEG-803                                69840028
693100             CONTINUE                                             69850028
693200     END-EVALUATE.                                                69860028
693300                                                                  69870028
693400 EJECT                                                            69880028
693500                                                                  69890028
693600***************************************************************** 69900028
693700*     INSERT A COPY OF THE SHPTPO ROW TO THE AUDIT TRAIL TABLE  * 69910028
693800*     AFTER INSERTING THE SHPTPO TABLE.                        *  69920028
693900***************************************************************** 69930028
694000                                                                  69940028
694100 9320-CREATE-SHPTPO-AUDIT-TRAIL.                                  69950028
694200                                                                  69960028
694300     MOVE '9320-CREATE-SHPTPO-AUDIT-TRAIL'                        69970028
694400                                 TO PV-CURRENT-PARA.              69980028
694500                                                                  69990028
694600     PERFORM                                                      70000028
694700         WITH TEST AFTER                                          70010028
694800         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     70020028
694900         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            70030028
695000                (SQLCODE = ZERO)   OR                             70040028
695100                (SQLCODE = PC-100)                                70050028
695200                                                                  70060028
695300         EXEC SQL                                                 70070028
695400             SELECT SHIPT_ID,                                     70080028
695500                    PO_NBR,                                       70090028
695600                    REC_SEQ_NBR,                                  70100028
695700                    EXPTED_CART_CNT,                              70110028
695800                    ACTL_CART_CNT,                                70120028
695900                    DMG_CART_CNT,                                 70130028
696000                    PKSL_IND,                                     70140028
696100                    VEND_NAME,                                    70150028
696200                    FRGT_CHG_AMT,                                 70160028
696300                    LAST_UPD_PGM_ID,                              70170028
696400                    CRE_USER_ID,                                  70180028
696500                    CARR_CART_CT,                                 70190028
696600                    CARR_LAST_UPD_DTE,                            70200028
696700                    CARR_LAST_UPD_TIME,                           70210028
696800                    VEND_CART_CT,                                 70220028
696900                    VEND_LAST_UPD_DTE,                            70230028
697000                    VEND_LAST_UPD_TIME,                           70240028
697100                    CRE_TMST,                                     70250028
697200                    LAST_UPD_DTE,                                 70260028
697300                    LAST_UPD_TIME,                                70270028
697400                    LAST_UPD_USER_ID,                             70280028
697500                    PRIM_SHIPT_IND                                70290028
697600                  , SPLT_XMIT_IND                                 70300028
697700                  , SPLT_XMIT_DTE                                 70310028
697800                  , SPLT_XMIT_TM                                  70320028
697900               INTO :SHPTPO-SHIPT-ID,                             70330028
698000                    :SHPTPO-PO-NBR,                               70340028
698100                    :SHPTPO-REC-SEQ-NBR,                          70350028
698200                    :SHPTPO-EXPTED-CART-CNT,                      70360028
698300                    :SHPTPO-ACTL-CART-CNT,                        70370028
698400                    :SHPTPO-DMG-CART-CNT,                         70380028
698500                    :SHPTPO-PKSL-IND,                             70390028
698600                    :SHPTPO-VEND-NAME,                            70400028
698700                    :SHPTPO-FRGT-CHG-AMT,                         70410028
698800                    :SHPTPO-LAST-UPD-PGM-ID,                      70420028
698900                    :SHPTPO-CRE-USER-ID,                          70430028
699000                    :SHPTPO-CARR-CART-CT,                         70440028
699100                    :SHPTPO-CARR-LAST-UPD-DTE,                    70450028
699200                    :SHPTPO-CARR-LAST-UPD-TIME,                   70460028
699300                    :SHPTPO-VEND-CART-CT,                         70470028
699400                    :SHPTPO-VEND-LAST-UPD-DTE,                    70480028
699500                    :SHPTPO-VEND-LAST-UPD-TIME,                   70490028
699600                    :SHPTPO-CRE-TMST,                             70500028
699700                    :SHPTPO-LAST-UPD-DTE,                         70510028
699800                    :SHPTPO-LAST-UPD-TIME,                        70520028
699900                    :SHPTPO-LAST-UPD-USER-ID,                     70530028
700000                    :SHPTPO-PRIM-SHIPT-IND                        70540028
700100                  , :SHPTPO-SPLT-XMIT-IND                         70550028
700200                  , :SHPTPO-SPLT-XMIT-DTE                         70560028
700300                  , :SHPTPO-SPLT-XMIT-TM                          70570028
700400               FROM TSHPTPO                                       70580028
700500              WHERE SHIPT_ID        = :SHPTPO-SHIPT-ID            70590028
700600                AND PO_NBR          = :SHPTPO-PO-NBR              70600028
700700         END-EXEC                                                 70610028
700800                                                                  70620028
700900         EVALUATE TRUE                                            70630028
701000             WHEN SQLCODE = ZERO                                  70640028
701100             WHEN SQLCODE = PC-100                                70650028
701200             WHEN SQLCODE = PC-NEG-904                            70660028
701300             WHEN SQLCODE = PC-NEG-913                            70670028
701400                 CONTINUE                                         70680028
701500                                                                  70690028
701600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              70700028
701700                 DISPLAY '**************************************' 70710028
701800                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHPTPO   ' 70720028
701900                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      70730028
702000                 DISPLAY 'SHPTPO-PO-NBR    ' SHPTPO-PO-NBR        70740028
702100                 DISPLAY '**********************************'     70750028
702200                 PERFORM 9800-SQL-WARNING                         70760028
702300                                                                  70770028
702400             WHEN  SQLCODE < ZERO                                 70780028
702500                 DISPLAY '**************************************' 70790028
702600                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHPTPO     ' 70800028
702700                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      70810028
702800                 DISPLAY 'SHPTPO-PO-NBR    ' SHPTPO-PO-NBR        70820028
702900                 DISPLAY '**************************************' 70830028
703000                 PERFORM 9900-SQL-ERROR                           70840028
703100                                                                  70850028
703200         END-EVALUATE                                             70860028
703300                                                                  70870028
703400     END-PERFORM.                                                 70880028
703500                                                                  70890028
703600     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    70900028
703700         SQLCODE NOT = ZERO                                       70910028
703800         DISPLAY '**************************************'         70920028
703900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         70930028
704000         DISPLAY 'SELECT TSHPTPO                        '         70940028
704100         DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID              70950028
704200         DISPLAY 'SHPTPO-PO-NBR    ' SHPTPO-PO-NBR                70960028
704300         DISPLAY '**************************************'         70970028
704400         PERFORM 9900-SQL-ERROR                                   70980028
704500     END-IF.                                                      70990028
704600                                                                  71000028
704700     PERFORM                                                      71010028
704800         WITH TEST AFTER                                          71020028
704900         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     71030028
705000         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            71040028
705100                 SQLCODE = ZERO                                   71050028
705200                                                                  71060028
705300         EXEC SQL                                                 71070028
705400             INSERT INTO TAUSHPO                                  71080028
705500                   (SHIPT_ID,                                     71090028
705600                    PO_NBR,                                       71100028
705700                    REC_SEQ_NBR,                                  71110028
705800                    EXPTED_CART_CNT,                              71120028
705900                    ACTL_CART_CNT,                                71130028
706000                    DMG_CART_CNT,                                 71140028
706100                    PKSL_IND,                                     71150028
706200                    VEND_NAME,                                    71160028
706300                    FRGT_CHG_AMT,                                 71170028
706400                    LAST_UPD_PGM_ID,                              71180028
706500                    CRE_USER_ID,                                  71190028
706600                    CARR_CART_CT,                                 71200028
706700                    CARR_LAST_UPD_DTE,                            71210028
706800                    CARR_LAST_UPD_TIME,                           71220028
706900                    VEND_CART_CT,                                 71230028
707000                    VEND_LAST_UPD_DTE,                            71240028
707100                    VEND_LAST_UPD_TIME,                           71250028
707200                    CRE_TMST,                                     71260028
707300                    LAST_UPD_DTE,                                 71270028
707400                    LAST_UPD_TIME,                                71280028
707500                    LAST_UPD_USER_ID,                             71290028
707600                    PRIM_SHIPT_IND                                71300028
707700                  , SPLT_XMIT_IND                                 71310028
707800                  , SPLT_XMIT_DTE                                 71320028
707900                  , SPLT_XMIT_TM                                  71330028
708000                  , TRN_CDE )                                     71340028
708100             VALUES                                               71350028
708200                  (:SHPTPO-SHIPT-ID,                              71360028
708300                   :SHPTPO-PO-NBR,                                71370028
708400                   :SHPTPO-REC-SEQ-NBR,                           71380028
708500                   :SHPTPO-EXPTED-CART-CNT,                       71390028
708600                   :SHPTPO-ACTL-CART-CNT,                         71400028
708700                   :SHPTPO-DMG-CART-CNT,                          71410028
708800                   :SHPTPO-PKSL-IND,                              71420028
708900                   :SHPTPO-VEND-NAME,                             71430028
709000                   :SHPTPO-FRGT-CHG-AMT,                          71440028
709100                   :SHPTPO-LAST-UPD-PGM-ID,                       71450028
709200                   :SHPTPO-CRE-USER-ID,                           71460028
709300                   :SHPTPO-CARR-CART-CT,                          71470028
709400                   :SHPTPO-CARR-LAST-UPD-DTE,                     71480028
709500                   :SHPTPO-CARR-LAST-UPD-TIME,                    71490028
709600                   :SHPTPO-VEND-CART-CT,                          71500028
709700                   :SHPTPO-VEND-LAST-UPD-DTE,                     71510028
709800                   :SHPTPO-VEND-LAST-UPD-TIME,                    71520028
709900                   :SHPTPO-CRE-TMST,                              71530028
710000                   :SHPTPO-LAST-UPD-DTE,                          71540028
710100                   :SHPTPO-LAST-UPD-TIME,                         71550028
710200                   :SHPTPO-LAST-UPD-USER-ID,                      71560028
710300                   :SHPTPO-PRIM-SHIPT-IND                         71570028
710400                  , :SHPTPO-SPLT-XMIT-IND                         71580028
710500                  , :SHPTPO-SPLT-XMIT-DTE                         71590028
710600                  , :SHPTPO-SPLT-XMIT-TM                          71600028
710700                  , :PC-A )                                       71610028
710800         END-EXEC                                                 71620028
710900                                                                  71630028
711000         EVALUATE TRUE                                            71640028
711100             WHEN SQLCODE = ZERO                                  71650028
711200             WHEN SQLCODE = PC-NEG-904                            71660028
711300             WHEN SQLCODE = PC-NEG-913                            71670028
711400             WHEN SQLCODE = PC-NEG-911                            71680028
711500                 CONTINUE                                         71690028
711600                                                                  71700028
711700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              71710028
711800                 DISPLAY '**************************************' 71720028
711900                 DISPLAY 'WARNING ISSUED ON INSERT OF TAUSHPO   ' 71730028
712000                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      71740028
712100                 DISPLAY 'SHPTPO-PO-NBR: '  SHPTPO-PO-NBR         71750028
712200                 DISPLAY '**********************************'     71760028
712300                 PERFORM 9800-SQL-WARNING                         71770028
712400                                                                  71780028
712500             WHEN SQLCODE < ZERO                                  71790028
712600                 DISPLAY '**************************************' 71800028
712700                 DISPLAY 'ERROR ISSUED ON INSERT OF TAUSHPO     ' 71810028
712800                 DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID      71820028
712900                 DISPLAY 'SHPTPO-PO-NBR: '  SHPTPO-PO-NBR         71830028
713000                 DISPLAY '**************************************' 71840028
713100                 PERFORM 9900-SQL-ERROR                           71850028
713200                                                                  71860028
713300         END-EVALUATE                                             71870028
713400     END-PERFORM.                                                 71880028
713500                                                                  71890028
713600     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    71900028
713700         SQLCODE NOT = ZERO                                       71910028
713800         DISPLAY '**************************************'         71920028
713900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         71930028
714000         DISPLAY 'INSERT TO TAUSHPO                     '         71940028
714100         DISPLAY 'SHPTPO-SHIPT-ID: ' SHPTPO-SHIPT-ID              71950028
714200         DISPLAY 'SHPTPO-PO-NBR: '  SHPTPO-PO-NBR                 71960028
714300         DISPLAY '**************************************'         71970028
714400         PERFORM 9900-SQL-ERROR                                   71980028
714500     END-IF.                                                      71990028
714600                                                                  72000028
714700                                                                  72010028
714800 EJECT                                                            72020028
714900***************************************************************** 72030028
715000*     GET THE PRIMARY VENDOR NAME FROM THE EXTERNAL ENTERPRISE  * 72040028
715100*     NAME TABLE.                                               * 72050028
715200***************************************************************** 72060028
715300                                                                  72070028
715400 9350-SELECT-VENDOR-NAME.                                         72080028
715500                                                                  72090028
715600     MOVE '9350-SELECT-VENDOR-NAME'                               72100028
715700                                 TO PV-CURRENT-PARA.              72110028
715800                                                                  72120028
715900     PERFORM                                                      72130028
716000         WITH TEST AFTER                                          72140028
716100         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     72150028
716200         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            72160028
716300                (SQLCODE = ZERO)   OR                             72170028
716400                (SQLCODE = PC-100) OR                             72180028
716500                (SQLCODE = PC-NEG-803)                            72190028
716600                                                                  72200028
716700         EXEC SQL                                                 72210028
716800             SELECT ENT_NAME_DESC                                 72220028
716900               INTO :ENTNME-ENT-NAME-DESC                         72230028
717000               FROM TENTNME                                       72240028
717100              WHERE ENT_ID    = :PURCHS-ENT-ID                    72250028
717200                AND TYPE_CDE  = :PC-01                            72260028
717300         END-EXEC                                                 72270028
717400                                                                  72280028
717500         EVALUATE TRUE                                            72290028
717600             WHEN SQLCODE = ZERO                                  72300028
717700             WHEN SQLCODE = PC-100                                72310028
717800             WHEN SQLCODE = PC-NEG-803                            72320028
717900             WHEN SQLCODE = PC-NEG-904                            72330028
718000             WHEN SQLCODE = PC-NEG-913                            72340028
718100                 CONTINUE                                         72350028
718200                                                                  72360028
718300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              72370028
718400                 DISPLAY '**************************************' 72380028
718500                 DISPLAY 'WARNING ISSUED ON SELECT OF TENTNME   ' 72390028
718600                 DISPLAY 'PW-VEHICL-OWNER-SCAC-ID: '              72400028
718700                          PW-VEHICL-OWNER-SCAC-ID                 72410028
718800                 DISPLAY '**********************************'     72420028
718900                 PERFORM 9800-SQL-WARNING                         72430028
719000                                                                  72440028
719100             WHEN  SQLCODE < ZERO                                 72450028
719200                 DISPLAY '**************************************' 72460028
719300                 DISPLAY 'ERROR ISSUED ON SELECT OF TENTNME     ' 72470028
719400                 DISPLAY 'PW-VEHICL-OWNER-SCAC-ID: '              72480028
719500                          PW-VEHICL-OWNER-SCAC-ID                 72490028
719600                 DISPLAY '**************************************' 72500028
719700                 PERFORM 9900-SQL-ERROR                           72510028
719800                                                                  72520028
719900         END-EVALUATE                                             72530028
720000                                                                  72540028
720100     END-PERFORM.                                                 72550028
720200                                                                  72560028
720300     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    72570028
720400         SQLCODE NOT = ZERO                                       72580028
720500         DISPLAY '**************************************'         72590028
720600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         72600028
720700         DISPLAY 'SELECT TEXTENT/TENTNME                '         72610028
720800         DISPLAY 'PW-VEHICL-OWNER-SCAC-ID: '                      72620028
720900                  PW-VEHICL-OWNER-SCAC-ID                         72630028
721000         DISPLAY '**************************************'         72640028
721100         PERFORM 9900-SQL-ERROR                                   72650028
721200     END-IF.                                                      72660028
721300                                                                  72670028
721400     EVALUATE TRUE                                                72680028
721500         WHEN SQLCODE = ZERO                                      72690028
721600             MOVE ENTNME-ENT-NAME-DESC                            72700028
721700                                 TO PW-SHIPMT-SHIPPER-NME         72710028
721800     END-EVALUATE.                                                72720028
721900                                                                  72730028
722000 EJECT                                                            72740028
722100***************************************************************** 72750028
722200*     CHECK IF THE SHIPMENT STATUS RECORD ALREADY EXIST.  ALSO  * 72760028
722300*     NEED TO DETERMINE WHAT PROGRAM PUT IT INTO THAT STATUS.   * 72770028
722400***************************************************************** 72780028
722500                                                                  72790028
722600 9375-PROCESS-SHIPST.                                             72800028
722700                                                                  72810028
722800     MOVE '9375-PROCESS-SHIPST'  TO PV-CURRENT-PARA.              72820028
722900     MOVE PW-SHIPST-SHIPT-STATUS-CDE (PW-SUB)                     72830028
723000                                 TO SHIPST-SHIPT-STATUS-CDE.      72840028
723100                                                                  72850028
723200     PERFORM 9400-SELECT-SHIPST.                                  72860028
723300                                                                  72870028
723400     IF PS-INSERT-SHIPST                                          72880028
723500         PERFORM 9500-FORMAT-SHIPST                               72890028
723600         PERFORM 9700-INSERT-SHIPST                               72900028
723700     ELSE                                                         72910028
723800         IF PS-UPDATE-SHIPST                                      72920028
723900             PERFORM 9500-FORMAT-SHIPST                           72930028
724000             PERFORM 9600-UPDATE-SHIPST                           72940028
724100         END-IF                                                   72950028
724200     END-IF.                                                      72960028
724300                                                                  72970028
724400 EJECT                                                            72980028
724500***************************************************************** 72990028
724600*     SELECT SHIPMENT STATUS RECORD                             * 73000028
724700***************************************************************** 73010028
724800                                                                  73020028
724900 9400-SELECT-SHIPST.                                              73030028
725000                                                                  73040028
725100     MOVE '9400-SELECT-SHIPST'   TO PV-CURRENT-PARA.              73050028
725200                                                                  73060028
725300     PERFORM                                                      73070028
725400         WITH TEST AFTER                                          73080028
725500         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     73090028
725600         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            73100028
725700                (SQLCODE = ZERO)   OR                             73110028
725800                (SQLCODE = PC-100)                                73120028
725900                                                                  73130028
726000         EXEC SQL                                                 73140028
726100             SELECT SHIPT_ID,                                     73150028
726200                    SHIPT_STATUS_CDE,                             73160028
726300                    STATUS_DTE,                                   73170028
726400                    STATUS_TME,                                   73180028
726500                    STATUS_UID,                                   73190028
726600                    DELAY_RSN_CDE,                                73200028
726700                    CARR_STATUS_CDE,                              73210028
726800                    TIME_ZONE_CDE,                                73220028
726900                    CITY_NAME,                                    73230028
727000                    STATE_CDE                                     73240028
727100               INTO :SHIPST-SHIPT-ID,                             73250028
727200                    :SHIPST-SHIPT-STATUS-CDE,                     73260028
727300                    :SHIPST-STATUS-DTE,                           73270028
727400                    :SHIPST-STATUS-TME,                           73280028
727500                    :SHIPST-STATUS-UID,                           73290028
727600                    :SHIPST-DELAY-RSN-CDE,                        73300028
727700                    :SHIPST-CARR-STATUS-CDE,                      73310028
727800                    :SHIPST-TIME-ZONE-CDE,                        73320028
727900                    :SHIPST-CITY-NAME,                            73330028
728000                    :SHIPST-STATE-CDE                             73340028
728100               FROM TSHIPST                                       73350028
728200              WHERE SHIPT_ID         = :PW-SHIPMT-SHIPT-ID        73360028
728300                AND SHIPT_STATUS_CDE = :SHIPST-SHIPT-STATUS-CDE   73370028
728400         END-EXEC                                                 73380028
728500                                                                  73390028
728600         EVALUATE TRUE                                            73400028
728700             WHEN SQLCODE = ZERO                                  73410028
728800             WHEN SQLCODE = PC-100                                73420028
728900             WHEN SQLCODE = PC-NEG-904                            73430028
729000             WHEN SQLCODE = PC-NEG-913                            73440028
729100                 CONTINUE                                         73450028
729200                                                                  73460028
729300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              73470028
729400                 DISPLAY '**************************************' 73480028
729500                 DISPLAY 'WARNING ISSUED ON SELECT OF TSHIPST   ' 73490028
729600                 DISPLAY 'PW-SHIPST-SHIPT-ID:         '           73500028
729700                          PW-SHIPST-SHIPT-ID                      73510028
729800                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE: '              73520028
729900                          SHIPST-SHIPT-STATUS-CDE                 73530028
730000                 DISPLAY '**********************************'     73540028
730100                 PERFORM 9800-SQL-WARNING                         73550028
730200                                                                  73560028
730300             WHEN  SQLCODE < ZERO                                 73570028
730400                 DISPLAY '**************************************' 73580028
730500                 DISPLAY 'ERROR ISSUED ON SELECT OF TSHIPST     ' 73590028
730600                 DISPLAY 'PW-SHIPST-SHIPT-ID:         '           73600028
730700                          PW-SHIPST-SHIPT-ID                      73610028
730800                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE: '              73620028
730900                          SHIPST-SHIPT-STATUS-CDE                 73630028
731000                 DISPLAY '**************************************' 73640028
731100                 PERFORM 9900-SQL-ERROR                           73650028
731200                                                                  73660028
731300         END-EVALUATE                                             73670028
731400                                                                  73680028
731500     END-PERFORM.                                                 73690028
731600                                                                  73700028
731700     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    73710028
731800         SQLCODE NOT = ZERO                                       73720028
731900         DISPLAY '**************************************'         73730028
732000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         73740028
732100         DISPLAY 'SELECT TSHIPST                        '         73750028
732200         DISPLAY 'PW-SHIPST-SHIPT-ID:         '                   73760028
732300                  PW-SHIPST-SHIPT-ID                              73770028
732400         DISPLAY 'SHIPST-SHIPT-STATUS-CDE: '                      73780028
732500                  SHIPST-SHIPT-STATUS-CDE                         73790028
732600         DISPLAY '**************************************'         73800028
732700         PERFORM 9900-SQL-ERROR                                   73810028
732800     END-IF.                                                      73820028
732900                                                                  73830028
733000     EVALUATE TRUE                                                73840028
733100         WHEN SQLCODE = ZERO                                      73850028
733200             IF SHIPST-STATUS-UID = PC-TRKUP004 OR                73860028
733300                SHIPST-STATUS-UID = PC-RCKUP006                   73870028
733400                 SET PS-UPDATE-SHIPST                             73880028
733500                                 TO TRUE                          73890028
733600             ELSE                                                 73900028
733700                 SET PS-BYPASS-SHIPST                             73910028
733800                                 TO TRUE                          73920028
733900             END-IF                                               73930028
734000                                                                  73940028
734100         WHEN SQLCODE = +100                                      73950028
734200             SET PS-INSERT-SHIPST                                 73960028
734300                                 TO TRUE                          73970028
734400     END-EVALUATE.                                                73980028
734500                                                                  73990028
734600 EJECT                                                            74000028
734700***************************************************************** 74010028
734800*     FORMAT THE SHIPMENT STATUS INFORMATION FOR EITHER INSERT  * 74020028
734900*     OR UPDATE                                                 * 74030028
735000***************************************************************** 74040028
735100                                                                  74050028
735200 9500-FORMAT-SHIPST.                                              74060028
735300                                                                  74070028
735400     MOVE '9500-FORMAT-SHIPST'   TO PV-CURRENT-PARA.              74080028
735500                                                                  74090028
735600     MOVE PW-SHIPST-SHIPT-ID     TO SHIPST-SHIPT-ID.              74100028
735700     MOVE PW-SHIPST-STATUS-DTE (PW-SUB)                           74110028
735800                                 TO SHIPST-STATUS-DTE.            74120028
735900     MOVE PW-SHIPST-STATUS-TME (PW-SUB)                           74130028
736000                                 TO SHIPST-STATUS-TME.            74140028
736100     MOVE PW-SHIPST-SHIPT-STATUS-CDE (PW-SUB)                     74150028
736200                                 TO SHIPST-SHIPT-STATUS-CDE.      74160028
736300     MOVE PW-SHIPST-DELAY-RSN-CDE (PW-SUB)                        74170028
736400                                 TO SHIPST-DELAY-RSN-CDE.         74180028
736500     MOVE PC-TRKUP004            TO SHIPST-STATUS-UID.            74190028
736600     MOVE PW-SHIPST-TIME-ZONE (PW-SUB)                            74200028
736700                                 TO SHIPST-TIME-ZONE-CDE.         74210028
736800     MOVE PW-SHIPST-CITY (PW-SUB)                                 74220028
736900                                 TO SHIPST-CITY-NAME.             74230028
737000     MOVE PW-SHIPST-STATE (PW-SUB)                                74240028
737100                                 TO SHIPST-STATE-CDE.             74250028
737200     MOVE PW-SHIPST-CARR-STATUS-CDE (PW-SUB)                      74260028
737300                                 TO SHIPST-CARR-STATUS-CDE.       74270028
737400                                                                  74280028
737500 EJECT                                                            74290028
737600***************************************************************** 74300028
737700*     SQL UPDATE SHIPST                                         * 74310028
737800*     IF THE RECORD IS NOT FOUND, A SWITCH WILL BE SET AND AN   * 74320028
737900*     INSERT ATTEMPTED.                                         * 74330028
738000***************************************************************** 74340028
738100                                                                  74350028
738200 9600-UPDATE-SHIPST.                                              74360028
738300                                                                  74370028
738400     MOVE '9600-UPDATE-SHIPST'   TO PV-CURRENT-PARA.              74380028
738500                                                                  74390028
738600     PERFORM                                                      74400028
738700         WITH TEST AFTER                                          74410028
738800         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     74420028
738900         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            74430028
739000                 SQLCODE = ZERO OR                                74440028
739100                 SQLCODE = PC-100                                 74450028
739200                                                                  74460028
739300         EXEC SQL                                                 74470028
739400             UPDATE TSHIPST                                       74480028
739500                SET STATUS_DTE       = :SHIPST-STATUS-DTE,        74490028
739600                    STATUS_TME       = :SHIPST-STATUS-TME,        74500028
739700                    STATUS_UID       = :SHIPST-STATUS-UID,        74510028
739800                    DELAY_RSN_CDE    = :SHIPST-DELAY-RSN-CDE,     74520028
739900                    CARR_STATUS_CDE  = :SHIPST-CARR-STATUS-CDE,   74530028
740000                    TIME_ZONE_CDE    = :SHIPST-TIME-ZONE-CDE,     74540028
740100                    CITY_NAME        = :SHIPST-CITY-NAME,         74550028
740200                    STATE_CDE        = :SHIPST-STATE-CDE          74560028
740300              WHERE SHIPT_ID         = :SHIPST-SHIPT-ID           74570028
740400                AND SHIPT_STATUS_CDE = :SHIPST-SHIPT-STATUS-CDE   74580028
740500         END-EXEC                                                 74590028
740600                                                                  74600028
740700         EVALUATE TRUE                                            74610028
740800             WHEN SQLCODE = ZERO                                  74620028
740900             WHEN SQLCODE = +100                                  74630028
741000             WHEN SQLCODE = PC-NEG-904                            74640028
741100             WHEN SQLCODE = PC-NEG-913                            74650028
741200             WHEN SQLCODE = PC-NEG-911                            74660028
741300                 CONTINUE                                         74670028
741400                                                                  74680028
741500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              74690028
741600                 DISPLAY '**************************************' 74700028
741700                 DISPLAY 'WARNING ISSUED ON UPDATE OF TSHIPST   ' 74710028
741800                 DISPLAY 'SHIPST-SHIPT-ID:      '                 74720028
741900                          SHIPST-SHIPT-ID                         74730028
742000                 DISPLAY '**********************************'     74740028
742100                 PERFORM 9800-SQL-WARNING                         74750028
742200                                                                  74760028
742300             WHEN SQLCODE < ZERO                                  74770028
742400                 DISPLAY '**************************************' 74780028
742500                 DISPLAY 'ERROR ISSUED ON UPDATE OF TSHIPST     ' 74790028
742600                 DISPLAY 'SHIPST-SHIPT-ID:      '                 74800028
742700                          SHIPST-SHIPT-ID                         74810028
742800                 DISPLAY '**************************************' 74820028
742900                 PERFORM 9900-SQL-ERROR                           74830028
743000                                                                  74840028
743100         END-EVALUATE                                             74850028
743200                                                                  74860028
743300     END-PERFORM.                                                 74870028
743400                                                                  74880028
743500     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    74890028
743600         SQLCODE NOT = ZERO                                       74900028
743700         DISPLAY '**************************************'         74910028
743800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         74920028
743900         DISPLAY 'UPDATE TSHIPST                        '         74930028
744000         DISPLAY 'SHIPST-SHIPT-ID:    '                           74940028
744100                  SHIPST-SHIPT-ID                                 74950028
744200         DISPLAY '**************************************'         74960028
744300         PERFORM 9900-SQL-ERROR                                   74970028
744400     END-IF.                                                      74980028
744500                                                                  74990028
744600     EVALUATE TRUE                                                75000028
744700         WHEN SQLCODE = ZERO                                      75010028
744800             ADD  1              TO PA-SHIPST-UPDATED             75020028
744900     END-EVALUATE.                                                75030028
745000                                                                  75040028
745100 EJECT                                                            75050028
745200***************************************************************** 75060028
745300*     SQL INSERT SHIPST                                         * 75070028
745400***************************************************************** 75080028
745500                                                                  75090028
745600 9700-INSERT-SHIPST.                                              75100028
745700                                                                  75110028
745800     MOVE '9700-INSERT-SHIPST'   TO PV-CURRENT-PARA.              75120028
745900                                                                  75130028
746000     PERFORM                                                      75140028
746100         WITH TEST AFTER                                          75150028
746200         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     75160028
746300         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR            75170028
746400                (SQLCODE = ZERO)                                  75180028
746500                                                                  75190028
746600         EXEC SQL                                                 75200028
746700             INSERT INTO TSHIPST                                  75210028
746800                   (SHIPT_ID,                                     75220028
746900                    SHIPT_STATUS_CDE,                             75230028
747000                    STATUS_DTE,                                   75240028
747100                    STATUS_TME,                                   75250028
747200                    STATUS_UID,                                   75260028
747300                    DELAY_RSN_CDE,                                75270028
747400                    CARR_STATUS_CDE,                              75280028
747500                    TIME_ZONE_CDE,                                75290028
747600                    CITY_NAME,                                    75300028
747700                    STATE_CDE)                                    75310028
747800             VALUES                                               75320028
747900                  (:SHIPST-SHIPT-ID,                              75330028
748000                   :SHIPST-SHIPT-STATUS-CDE,                      75340028
748100                   :SHIPST-STATUS-DTE,                            75350028
748200                   :SHIPST-STATUS-TME,                            75360028
748300                   :PC-TRKUP004,                                  75370028
748400                   :SHIPST-DELAY-RSN-CDE,                         75380028
748500                   :SHIPST-CARR-STATUS-CDE,                       75390028
748600                   :SHIPST-TIME-ZONE-CDE,                         75400028
748700                   :SHIPST-CITY-NAME,                             75410028
748800                   :SHIPST-STATE-CDE)                             75420028
748900         END-EXEC                                                 75430028
749000                                                                  75440028
749100         EVALUATE TRUE                                            75450028
749200             WHEN SQLCODE = ZERO                                  75460028
749300             WHEN SQLCODE = PC-NEG-904                            75470028
749400             WHEN SQLCODE = PC-NEG-913                            75480028
749500             WHEN SQLCODE = PC-NEG-911                            75490028
749600                 CONTINUE                                         75500028
749700                                                                  75510028
749800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              75520028
749900                 DISPLAY '**************************************' 75530028
750000                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHIPST   ' 75540028
750100                 DISPLAY 'SHIPST-SHIPT-ID:    '                   75550028
750200                          SHIPST-SHIPT-ID                         75560028
750300                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE:  '             75570028
750400                          SHIPST-SHIPT-STATUS-CDE                 75580028
750500                 DISPLAY '**********************************'     75590028
750600                 PERFORM 9800-SQL-WARNING                         75600028
750700                                                                  75610028
750800             WHEN SQLCODE < ZERO                                  75620028
750900                 DISPLAY '**************************************' 75630028
751000                 DISPLAY 'ERROR ISSUED ON INSERT OF TSHIPST     ' 75640028
751100                 DISPLAY 'SHIPST-SHIPT-ID:    '                   75650028
751200                          SHIPST-SHIPT-ID                         75660028
751300                 DISPLAY 'SHIPST-SHIPT-STATUS-CDE:  '             75670028
751400                          SHIPST-SHIPT-STATUS-CDE                 75680028
751500                 DISPLAY '**************************************' 75690028
751600                 PERFORM 9900-SQL-ERROR                           75700028
751700                                                                  75710028
751800         END-EVALUATE                                             75720028
751900     END-PERFORM.                                                 75730028
752000                                                                  75740028
752100     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    75750028
752200         SQLCODE NOT = ZERO                                       75760028
752300         DISPLAY '**************************************'         75770028
752400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         75780028
752500         DISPLAY 'INSERT TO TSHIPST                     '         75790028
752600         DISPLAY 'SHIPST-SHIPT-ID:    '                           75800028
752700                  SHIPST-SHIPT-ID                                 75810028
752800         DISPLAY 'SHIPST-SHIPT-STATUS-CDE:  '                     75820028
752900                  SHIPST-SHIPT-STATUS-CDE                         75830028
753000         DISPLAY '**************************************'         75840028
753100         PERFORM 9900-SQL-ERROR                                   75850028
753200     END-IF.                                                      75860028
753300                                                                  75870028
753400     EVALUATE TRUE                                                75880028
753500         WHEN SQLCODE = ZERO                                      75890028
753600             ADD  1              TO PA-SHIPST-INSERTED            75900028
753700                                                                  75910028
753800     END-EVALUATE.                                                75920028
753900                                                                  75930028
754000 EJECT                                                            75940028
754100***************************************************************** 75950028
754200*     SQL COMMIT OF ALL DATABASE INSERTS AND UPDATES            * 75960028
754300***************************************************************** 75970028
754400                                                                  75980028
754500 9750-COMMIT-RECORDS.                                             75990028
754600                                                                  76000028
754700     MOVE '9750-COMMIT-RECORDS'  TO PV-CURRENT-PARA.              76010028
754800                                                                  76020028
754900     PERFORM                                                      76030028
755000         WITH TEST AFTER                                          76040028
755100         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     76050028
755200         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES                76060028
755300            OR  (SQLCODE = ZERO)                                  76070028
755400                                                                  76080028
755500         EXEC SQL                                                 76090028
755600             COMMIT                                               76100028
755700         END-EXEC                                                 76110028
755800                                                                  76120028
755900         EVALUATE TRUE                                            76130028
756000             WHEN SQLCODE = ZERO                                  76140028
756100             WHEN SQLCODE = PC-NEG-904                            76150028
756200             WHEN SQLCODE = PC-NEG-913                            76160028
756300                 CONTINUE                                         76170028
756400                                                                  76180028
756500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              76190028
756600                 DISPLAY '**********************************'     76200028
756700                 DISPLAY 'WARNING ISSUED ON COMMIT          '     76210028
756800                 DISPLAY '**********************************'     76220028
756900                 PERFORM 9800-SQL-WARNING                         76230028
757000                                                                  76240028
757100             WHEN SQLCODE < ZERO                                  76250028
757200                 DISPLAY '**********************************'     76260028
757300                 DISPLAY 'ERROR ISSUED ON COMMIT            '     76270028
757400                 DISPLAY '**********************************'     76280028
757500                 PERFORM 9900-SQL-ERROR                           76290028
757600                                                                  76300028
757700         END-EVALUATE                                             76310028
757800     END-PERFORM.                                                 76320028
757900                                                                  76330028
758000     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    76340028
758100         SQLCODE NOT = ZERO                                       76350028
758200         DISPLAY '******************************************'     76360028
758300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO COMMIT '     76370028
758400         DISPLAY '******************************************'     76380028
758500         PERFORM 9900-SQL-ERROR                                   76390028
758600     END-IF.                                                      76400028
758700                                                                  76410028
758800 EJECT                                                            76420028
758900******************************************************************76430028
759000*  THIS MODULE PERFORMS THE RETREIVAL OF THE CURRENT TIMESTAMP   *76440028
759100*  PLUS THE FREQUENCY IN THE TABLE                               *76450028
759200******************************************************************76460028
759300                                                                  76470028
759400 9770-SELECT-TMST.                                                76480028
759500                                                                  76490028
759600     MOVE '9770-SELECT-TMST'  TO PV-CURRENT-PARA.                 76500028
759700                                                                  76510028
759800     PERFORM                                                      76520028
759900         WITH TEST AFTER                                          76530028
760000         VARYING PW-RETRY-COUNTER FROM 1 BY 1                     76540028
760100         UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES                76550028
760200            OR  (SQLCODE = ZERO)                                  76560028
760300                                                                  76570028
760400         EXEC SQL                                                 76580028
760500           SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)   76590028
760600           INTO :PV-HOLD-TMST                                     76600028
760700           FROM TCKRSTCNTL                                        76610028
760800           WHERE PLAN_NAME = 'TRKUP004'                           76620028
760900         END-EXEC                                                 76630028
761000                                                                  76640028
761100         EVALUATE TRUE                                            76650028
761200             WHEN SQLCODE = ZERO                                  76660028
761300             WHEN SQLCODE = PC-NEG-904                            76670028
761400             WHEN SQLCODE = PC-NEG-913                            76680028
761500                 CONTINUE                                         76690028
761600                                                                  76700028
761700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              76710028
761800                 DISPLAY '**********************************'     76720028
761900                 DISPLAY 'WARNING ISSUED ON COMMIT          '     76730028
762000                 DISPLAY '**********************************'     76740028
762100                 PERFORM 9800-SQL-WARNING                         76750028
762200                                                                  76760028
762300             WHEN SQLCODE < ZERO                                  76770028
762400                 DISPLAY '**********************************'     76780028
762500                 DISPLAY 'ERROR ISSUED ON COMMIT            '     76790028
762600                 DISPLAY '**********************************'     76800028
762700                 PERFORM 9900-SQL-ERROR                           76810028
762800                                                                  76820028
762900         END-EVALUATE                                             76830028
763000     END-PERFORM.                                                 76840028
763100                                                                  76850028
763200     IF  PW-RETRY-COUNTER > PC-MAX-RETRIES AND                    76860028
763300         SQLCODE NOT = ZERO                                       76870028
763400         DISPLAY '******************************************'     76880028
763500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO COMMIT '     76890028
763600         DISPLAY '******************************************'     76900028
763700         PERFORM 9900-SQL-ERROR                                   76910028
763800     END-IF.                                                      76920028
763900                                                                  76930028
764000 EJECT                                                            76940028
764100                                                                  76950028
764200 EJECT                                                            76960028
764300******************************************************************76970028
764400*  THIS MODULE PERFORMS THE SQL WARNING.                         *76980028
764500******************************************************************76990028
764600                                                                  77000028
764700 9800-SQL-WARNING.                                                77010028
764800                                                                  77020028
764900      MOVE SQLCODE               TO SQLCODE2.                     77030028
765000      MOVE SQLERRD(3)            TO SQLERRD3.                     77040028
765100      DISPLAY '** ABEND **       ** = SQLWARNING'.                77050028
765200      DISPLAY '** PROGRAM        ** = TRKUP004'.                  77060028
765300      DISPLAY '** PARAGRAPH      ** = ' PV-CURRENT-PARA.          77070028
765400      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 77080028
765500      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 77090028
765600      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 77100028
765700      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 77110028
765800      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 77120028
765900      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 77130028
766000      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 77140028
766100      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 77150028
766200      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 77160028
766300      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 77170028
766400                                                                  77180028
766500      SET ABEND-4013-DB2-ERROR   TO TRUE                          77190028
766600      CALL 'ILBOABN0' USING ABEND-CODE.                           77200028
766700                                                                  77210028
766800 EJECT                                                            77220028
766900******************************************************************77230028
767000* THIS MODULE PERFORMS THE SQL ERROR.                            *77240028
767100******************************************************************77250028
767200                                                                  77260028
767300 9900-SQL-ERROR.                                                  77270028
767400                                                                  77280028
767500      MOVE SQLCODE               TO SQLCODE2.                     77290028
767600      MOVE SQLERRD(3)            TO SQLERRD3.                     77300028
767700      DISPLAY '** ABEND **       ** = SQLERROR'.                  77310028
767800      DISPLAY '** PROGRAM        ** = TRKUP004'.                  77320028
767900      DISPLAY '** PARAGRAPH      ** = ' PV-CURRENT-PARA.          77330028
768000      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 77340028
768100      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 77350028
768200      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  77360028
768300      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 77370028
768400                                                                  77380028
768500******************************************************************77390028
768600*     THE FOLLOWING INCLUDE COPYBOOK USES THE DB2 ABEND MODULE    77400028
768700*     'DSNTIAR' TO CONVERT THE SQLCA INTO MEANINGFUL VERBAGE.     77410028
768800******************************************************************77420028
768900                                                                  77430028
769000     COPY DPPD004.                                                77440028
769100                                                                  77450028
769200      SET ABEND-4013-DB2-ERROR   TO TRUE.                         77460028
769300      CALL 'ILBOABN0' USING ABEND-CODE.                           77470028
769400                                                                  77480028
