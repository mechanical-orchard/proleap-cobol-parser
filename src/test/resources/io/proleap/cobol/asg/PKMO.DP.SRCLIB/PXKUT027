000100 IDENTIFICATION DIVISION.                                         00010000
000110******************************************************************00011099
000120 PROGRAM-ID.    PXKUT027.                                         00012099
000130 AUTHOR.        JOYCE KNOKE.                                      00013099
000140 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00014099
000150 DATE-WRITTEN.  DECEMBER 2006.                                    00015099
000160 DATE-COMPILED.                                                   00016099
000170******************************************************************00017099
000180* THIS PROGRAM WILL READ IN THE UNLOAD OF THE PXT_MOS_SKU_STR     00018099
000190* TABLE AND VALID IF THE MOS EVENT DATE IS STILL ACTIVE.          00019099
000200*                                                                 00020099
000300* ORACLE TABLE:                                                   00030099
000400* PET_CLR_MKDN_EVNT.                                              00040099
002400******************************************************************00240000
002500 ENVIRONMENT DIVISION.                                            00250000
002600******************************************************************00260099
002601                                                                  00260199
002602 CONFIGURATION SECTION.                                           00260200
002603                                                                  00260399
002604 INPUT-OUTPUT SECTION.                                            00260499
002605                                                                  00260599
002606 FILE-CONTROL.                                                    00260699
002607                                                                  00260799
002608     SELECT IN-MOS-FILE                                           00260899
002609         ASSIGN TO INP01.                                         00260999
002610                                                                  00261099
CHG016     SELECT ORACLE-LOGON-FILE                                     00262099
CHG016         ASSIGN TO ORALOGON.                                      00263099
002670                                                                  00267099
002680     SELECT OUT-DEL-FILE                                          00268099
002690         ASSIGN TO OUT01.                                         00269099
002700                                                                  00270099
002800     SELECT OUT-VALID-FILE                                        00280099
002900         ASSIGN TO OUT02.                                         00290099
002901                                                                  00290199
002902******************************************************************00290200
002903 DATA DIVISION.                                                   00290399
002904******************************************************************00290400
002905 FILE SECTION.                                                    00290599
002906                                                                  00290699
002907 FD  IN-MOS-FILE                                                  00290799
002908     RECORDING MODE F                                             00290899
002909     LABEL RECORDS ARE STANDARD                                   00290999
002910     BLOCK CONTAINS 0 RECORDS.                                    00291099
002920 01  IN-MOS-RECORD                    PIC  X(27).                 00292099
002930                                                                  00293099
CHG016 FD  ORACLE-LOGON-FILE                                            00294099
CHG016     RECORDING MODE IS F                                          00295099
CHG016     LABEL RECORDS ARE STANDARD                                   00296099
CHG016     BLOCK CONTAINS 0 RECORDS                                     00297099
CHG016     RECORD CONTAINS 80 CHARACTERS                                00298099
CHG016     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                              
CHG016 01  OL-ORACLE-LOGON-RECORD              PIC X(80).                       
002990                                                                  00299099
003600 FD  OUT-DEL-FILE                                                 00360099
003700     RECORDING MODE F                                             00370099
003800     LABEL RECORDS ARE STANDARD                                   00380099
003900     BLOCK CONTAINS 0 RECORDS.                                    00390099
004000 01  OUT-DEL-RECORD                   PIC  X(27).                 00400099
004001                                                                  00400199
004002 FD  OUT-VALID-FILE                                               00400200
004003     RECORDING MODE F                                             00400300
004004     LABEL RECORDS ARE STANDARD                                   00400499
004005     BLOCK CONTAINS 0 RECORDS.                                    00400500
004006 01  OUT-VALID-RECORD                 PIC  X(27).                 00400699
004007                                                                  00400799
004008****************************************************************  00400899
004009 WORKING-STORAGE SECTION.                                         00400999
004010****************************************************************  00401099
004020 01  FILLER                            PIC X(50)  VALUE           00402099
004030     ' *** WORKING STORAGE STARTS HERE FOR PXKUT027 *** '.        00403099
004040                                                                  00404099
004050****************************************************************  00405099
004060**CONTROL CARD LAYOUTS                                            00406099
004070****************************************************************  00407099
004080 01  CC-DATE-ADVANCE-CARD.                                        00408099
004090     05  CC-NBR-OF-DAYS               PIC  9(02).                 00409099
004100     05  CC-NBR-OF-DAYS-R   REDEFINES   CC-NBR-OF-DAYS            00410099
004200                                      PIC  X(02).                 00420099
004300     05  FILLER                       PIC  X(78) VALUE SPACE.     00430099
004400                                                                  00440099
CHG016******************************************************************00450099
CHG016*      ORACLE CONNECTION VARIABLES                                00490099
CHG016******************************************************************00500099
CHG016 01  CC-ORACLE-CONNECTION.                                                
CHG016     05  CC-ORACLE-USERID             PIC X(40).                          
CHG016         88 CC-AUTO-LOGON                            VALUE '/'.           
CHG016     05  CC-ORACLE-PASSWORD           PIC X(40).                          
006000                                                                  00600099
006100 01  DF-WORK-DATE                     PIC  X(10).                         
006200 01  DF-END-DATE                      PIC  X(10).                         
006500                                                                          
009300****************************************************************  00930099
009400**PROGRAM ACCUMULATORS                                            00940099
009401****************************************************************  00940199
009402 01  PA-PROGRAM-ACCUMULATORS.                                     00940200
009403     05  PA-TOT-MOS-READS             PIC 9(09) VALUE ZEROS.      00940399
009404     05  PA-TOT-MOS-DELETED           PIC 9(09) VALUE ZEROS.      00940499
009405     05  PA-TOT-MOS-VALIDATE          PIC 9(09) VALUE ZEROS.      00940599
009406                                                                  00940699
009407****************************************************************  00940799
009408**PROGRAM VARIABLES.                                              00940800
009409****************************************************************  00940999
009410 01  PV-PROGRAM-VARIABLES.                                        00941000
009420     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     00942099
009430     05  PV-OPERATION-MSG-1           PIC  X(40) VALUE SPACE.     00943099
009440     05  PV-OPERATION-MSG-2           PIC  X(40) VALUE SPACE.     00944099
009450     05  PV-OPERATION-MSG             PIC  X(30) VALUE SPACE.     00945099
009451     05  PV-SAVE-MOS-DATE             PIC  X(10) VALUE SPACE.     00945199
CHG016     05  PV-ORACLE-USERID-LEN         PIC  S9(4) VALUE ZEROS              
CHG016                                                 COMP SYNC.               
CHG016     05  PV-ORACLE-PASSWORD-LEN       PIC  S9(4) VALUE ZEROS              
CHG016                                                 COMP SYNC.               
009452                                                                  00945200
009453****************************************************************  00945399
009454**PROGRAM SWITCHES.                                               00945400
009455****************************************************************  00945599
009456 01  PS-PROGRAM-SWITCHES.                                         00945600
009457     05  PS-END-OF-FILE-SW            PIC  X(01) VALUE 'N'.       00945700
009458         88 PS-END-OF-FILE-N                     VALUE 'N'.       00945800
009459         88 PS-END-OF-FILE-Y                     VALUE 'Y'.       00945900
009460     05  PS-EVENT-ACTIVE-SW           PIC  X(01) VALUE ' '.       00946099
009470         88 PS-EVENT-ACTIVE-NO                   VALUE 'N'.       00947099
009480         88 PS-EVENT-ACTIVE-YES                  VALUE 'Y'.       00948099
009490     05  PS-END-OF-CONTROL-FILE-SW    PIC  X(01) VALUE 'N'.       00949099
009491         88 PS-END-OF-CONTROL-FILE               VALUE 'Y'.       00949199
CHG016     05  PS-END-OF-LOGON-FILE-SW      PIC  X(01) VALUE 'N'.               
CHG016         88 PS-END-OF-LOGON-FILE                 VALUE 'Y'.               
CHG016     05  PS-ORA-SRC-CTL-DONE-SW       PIC  X(01) VALUE 'N'.               
CHG016         88  PS-ORA-SRC-EMPTY                    VALUE 'Y'.               
009492                                                                  00949200
009493****************************************************************  00949399
009494**PROGRAM CONSTANTS.                                              00949400
009495****************************************************************  00949599
009496 01  PC-PROGRAM-CONSTANTS.                                        00949600
009497     05  PC-PROGRAM-NAME         PIC  X(08) VALUE 'PXKUT027'.     00949700
CHG016     05  PC-AUTO-LOGON                PIC X(1)      VALUE '/'.            
009498                                                                  00949800
009499****************************************************************  00949900
009500**ABEND INFORMATION                                               00950000
009600****************************************************************  00960000
009700 01  AC-ABEND-CODE                    PIC S9(04) VALUE ZERO       00970099
009800                                                 COMP SYNC.       00980099
009900     88  AC-DB2-ERROR                            VALUE +4013.     00990099
010000     88  AC-NO-CONTROL-CARD                      VALUE +4002.     01000099
010100     88  AC-INVALID-CONTROL-CARD                 VALUE +4003.     01010099
010101     88  AC-ORACLE-BAD-LOGON-4004                VALUE +4004.     01010199
010102                                                                  01010200
010103************************************************************      01010399
010104* MOS VALID CLEARANCE ITEMS                                       01010499
010105************************************************************      01010599
010106     COPY PXRD032.                                                01010699
010107                                                                  01010799
010108******************************************************************        
010109*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)                     
010110******************************************************************        
010120     COPY DPWS500.                                                        
010130                                                                          
010600***************************************************************** 01060000
010900*  ABEND ROUTINE INFORMATION                                      01090000
010910***************************************************************** 01091099
011000     COPY DPWS900.                                                01100000
011001                                                                  01100199
011002***************************************************************** 01100200
011100*  ABEND ROUTINE INFORMATION                                      01110000
011110***************************************************************** 01111099
011200     COPY DPWS004.                                                01120000
011201                                                                  01120199
011207****************************************************************  01120799
011208**ORACLE DECLARE SECTION                                          01120899
011209****************************************************************  01120999
011210     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     01121099
011220 01  USERNAME                         PIC X(10)  VARYING.         01122099
011230 01  PASSWD                           PIC X(10)  VARYING.         01123099
011231 01  PV-ORACLE-ID                     PIC X(01)  VALUE '/'.       01123199
011232                                                                  01123200
012200****************************************************************  01220000
012300**ORACLE TABLE INCLUSIONS                                         01230000
012400****************************************************************  01240000
012500***TABLE PET_CLR_MKDN_EVNT                                        01250099
012600     EXEC SQL                                                     01260099
012700          INCLUDE PET00001                                        01270099
012800     END-EXEC.                                                    01280099
012900                                                                  01290099
014500     EXEC SQL END DECLARE SECTION END-EXEC.                       01450000
014600     EXEC SQL INCLUDE SQLCACOB END-EXEC.                          01460000
014700                                                                  01470000
014710****************************************************************  01471099
014800 PROCEDURE DIVISION.                                              01480000
014900******************************************************************01490000
015000 0000-MAINLINE.                                                   01500000
015200     PERFORM 1000-HOUSEKEEPING.                                   01520000
015210                                                                  01521099
015300     PERFORM 2000-PROCESS-MOS-EVENTS                              01530000
261400         UNTIL PS-END-OF-FILE-Y.                                  26140000
261401                                                                  26140199
261402     PERFORM 9000-END-OF-JOB.                                     26140200
261403                                                                  26140300
261404     STOP RUN.                                                    26140400
261405                                                                  26140500
261406****************************************************************  26140600
261407*     OPEN FILES, READ IN AND VALIDATE CONTROL DATE.              26140700
261408****************************************************************  26140800
261409 1000-HOUSEKEEPING.                                               26140900
261410     OPEN INPUT  ORACLE-LOGON-FILE                                26141000
CHG016                                                                          
CHG016     DISPLAY 'ORACLE FILE READ'.                                          
CHG016     PERFORM 8000-READ-ORACLE-LOGON.                                      
CHG016                                                                          
CHG016     DISPLAY 'ORACLE FILE CLOSE'.                                         
CHG016     CLOSE ORACLE-LOGON-FILE.                                             
CHG016                                                                          
CHG016     IF ((PS-END-OF-LOGON-FILE)                                           
CHG016              OR (CC-ORACLE-CONNECTION = SPACES))                         
CHG016           DISPLAY '** ABEND **'                                          
CHG016           DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '        
CHG016               'NOT PROVIDED'                                             
CHG016           SET PS-ORA-SRC-EMPTY TO TRUE                                   
CHG016           CALL 'ILBOABN0' USING AC-ABEND-CODE                            
CHG016     END-IF.                                                              
CHG016                                                                          
261500         IF CC-AUTO-LOGON                                                 
261600             DISPLAY PC-PROGRAM-NAME  ' - AUTO LOGON TO ORACLE'           
261700             EXEC SQL                                                     
261800               CONNECT  :PC-AUTO-LOGON                                    
261900             END-EXEC                                                     
CHG016     ELSE                                                                 
CHG016         INITIALIZE PV-ORACLE-USERID-LEN                                  
CHG016                    PV-ORACLE-PASSWORD-LEN                                
CHG016           INSPECT    CC-ORACLE-USERID                                    
CHG016             TALLYING   PV-ORACLE-USERID-LEN                              
CHG016             FOR CHARACTERS BEFORE INITIAL SPACE                          
CHG016           INSPECT    CC-ORACLE-PASSWORD                                  
CHG016             TALLYING   PV-ORACLE-PASSWORD-LEN                            
CHG016             FOR CHARACTERS BEFORE INITIAL SPACE                          
CHG016         MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO                
CHG016                    USERNAME-ARR                                          
CHG016         MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                        
CHG016         MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO            
CHG016                      PASSWD-ARR                                          
CHG016         MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                        
CHG016           DISPLAY PC-PROGRAM-NAME  ' - LOGON TO ORACLE AS USER '         
CHG016                      USERNAME-ARR                                        
CHG016            EXEC SQL                                                      
CHG016                 CONNECT :USERNAME IDENTIFIED BY :PASSWD                  
CHG016            END-EXEC                                                      
CHG016         INITIALIZE CC-ORACLE-PASSWORD                                    
CHG016                    PASSWD                                                
CHG016     END-IF.                                                              
CHG016                                                                          
264400             IF SQLCODE NOT = 0                                   26440099
264500               DISPLAY '** CONNECTING TO ORACLE BY USERID **'     26450099
264600               DISPLAY 'TRIED TO CONNECT TO ORACLE UNDER: '       26460099
264700                                  PASSWD                          26470099
264800               SET AC-ORACLE-BAD-LOGON-4004                       26480099
264900                                  TO TRUE                         26490099
265000               PERFORM 9999-SQL-ABEND                             26500099
265100             END-IF.                                              26510099
265200                                                                          
CHG016     OPEN INPUT  IN-MOS-FILE                                      26142099
CHG016          OUTPUT OUT-DEL-FILE                                     26142200
CHG016                OUT-VALID-FILE.                                   26142300
265601                                                                          
265602     PERFORM 3000-READ-INPUT-FILE.                                26560200
265603                                                                  26560300
265604     IF PS-END-OF-FILE-Y                                          26560400
265605         DISPLAY SPACES                                           26560599
265606         DISPLAY ALL '*'                                          26560699
265607         DISPLAY '  INPUT FILE IS EMPTY '                         26560799
265608         DISPLAY ALL '*'                                          26560899
265609         DISPLAY SPACES                                           26560999
265610     END-IF.                                                      26561099
265611                                                                  26561100
265645****************************************************************  26564500
265646*     PROCESS THE MOS EVENTS FILE                                 26564600
265647****************************************************************  26564700
265648 2000-PROCESS-MOS-EVENTS.                                         26564800
265649                                                                  26564999
265650     IF PS-EVENT-ACTIVE-SW = ' '                                  26565099
265660         PERFORM 2400-SELECT-PET-TABLE                            26566099
265670     END-IF.                                                      26567099
265680                                                                  26568099
265690     IF PS-EVENT-ACTIVE-NO                                        26569099
265700       AND PX032-MOS-EFF-DATE = PV-SAVE-MOS-DATE                  26570099
265800         PERFORM 2600-WRITE-DELETE-RECORD                         26580099
265900     END-IF.                                                      26590099
266000                                                                  26600099
266100     IF PS-EVENT-ACTIVE-YES                                       26610099
266200       AND PX032-MOS-EFF-DATE = PV-SAVE-MOS-DATE                  26620099
266300         PERFORM 2800-WRITE-VALID-RECORD                          26630099
266400     END-IF.                                                      26640099
266401                                                                  26640199
266402     PERFORM 3000-READ-INPUT-FILE.                                26640200
266403                                                                  26640399
266404****************************************************************  26640400
266405*     SELECT PET TABLE TO VERIFY IF EVENT IS STILL ACTIVE         26640500
266406****************************************************************  26640600
266407 2400-SELECT-PET-TABLE.                                           26640700
266408                                                                  26640899
266409     EXEC SQL                                                     26640900
266410         SELECT CLR_EVNT_ID                                       26641000
266411           INTO :CLR-EVNT-ID                                      26641100
266412           FROM PET_CLR_MKDN_EVNT                                 26641200
266413          WHERE ACTV_IND         = 'Y'                            26641300
266414            AND CLR_MKDN_CDE     = 'O'                            26641499
266415            AND TO_CHAR(CLR_FRST_EFF_DTE,'YYYY-MM-DD')            26641599
266416                = :PX032-MOS-EFF-DATE                             26641699
266417     END-EXEC.                                                    26641700
266418                                                                  26641800
266419     EVALUATE TRUE                                                26641999
266420         WHEN SQLCODE = 0                                         26642099
266430         WHEN SQLCODE = -2112                                     26643099
266440              SET PS-EVENT-ACTIVE-YES TO TRUE                     26644099
266450         WHEN SQLCODE = -1403                                     26645099
266460*             1403   -    NO DATA FOUND                           26646099
266470         WHEN SQLCODE =  1403                                     26647099
266480              SET PS-EVENT-ACTIVE-NO TO TRUE                      26648099
266481         WHEN OTHER                                               26648199
266482           MOVE '2000-SELECT-PET-TABLE' TO PV-PARAGRAPH-NAME      26648200
266483           MOVE 'SELECT ERROR' TO PV-OPERATION-MSG                26648300
266484           PERFORM 9999-SQL-ABEND                                 26648400
266485     END-EVALUATE.                                                26648599
266486                                                                  26648600
266487****************************************************************  26648700
266489*     WRITE DELETE RECORDS                                        26648900
266490****************************************************************  26649000
266500 2600-WRITE-DELETE-RECORD.                                        26650099
266600     IF PX032-MOS-END-DATE = LOW-VALUES                           26650299
266601         MOVE SPACES TO PX032-MOS-END-DATE                        26650399
266602     END-IF.                                                              
266603                                                                          
266604     MOVE PX032-MOS-EFF-DATE TO DF-WORK-DATE.                             
266605     PERFORM 4000-DATE-ROUTINE-DECR-DAYS.                                 
266606     MOVE DF-END-DATE TO PX032-MOS-END-DATE.                              
266607                                                                          
266609     WRITE OUT-DEL-RECORD FROM PX032-VALID-MOS-ITEMS.             26650400
266610     ADD 1 TO  PA-TOT-MOS-DELETED.                                26650599
266611                                                                  26650600
266612****************************************************************  26650700
266613*     WRITE VALID RECORDS                                         26650800
266614****************************************************************  26650900
266615 2800-WRITE-VALID-RECORD.                                         26651099
266616     IF PX032-MOS-END-DATE = LOW-VALUES                           26651299
266617         MOVE SPACES TO PX032-MOS-END-DATE.                       26651399
266618     WRITE OUT-VALID-RECORD FROM PX032-VALID-MOS-ITEMS.           26651400
266619     ADD 1 TO  PA-TOT-MOS-VALIDATE.                               26651599
266620                                                                  26651600
266621****************************************************************  26651700
266622*     READ AND PROCESS INPUT FILE.                                26651800
266623****************************************************************  26651900
266624 3000-READ-INPUT-FILE.                                            26652000
266625     READ IN-MOS-FILE INTO PX032-VALID-MOS-ITEMS                  26652100
266626        AT END                                                    26652200
266627           SET PS-END-OF-FILE-Y      TO TRUE                      26652300
266628     END-READ.                                                    26652400
266629                                                                  26652500
266630     IF PS-END-OF-FILE-N                                          26653000
266631         ADD 1 TO PA-TOT-MOS-READS                                26654099
266632       IF PX032-MOS-EFF-DATE = PV-SAVE-MOS-DATE                   26655099
266633           CONTINUE                                               26656099
266634       ELSE                                                       26657099
266635           MOVE PX032-MOS-EFF-DATE TO PV-SAVE-MOS-DATE            26658099
266636           MOVE ' ' TO PS-EVENT-ACTIVE-SW                         26659099
266640       END-IF                                                     26660099
266700     END-IF.                                                      26670099
266701                                                                  26670199
266702******************************************************************        
266703*    KOHLS DATE ROUTINE                                                   
266704******************************************************************        
266705 4000-DATE-ROUTINE-DECR-DAYS.                                             
266706     MOVE '4000-DATE-ROUTINE-INCR-DAYS' TO PV-PARAGRAPH-NAME.             
266707                                                                          
266708     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                      
266709                                                                          
266710     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                             
266711     SET DPG51-DECREMENT-DATE        TO TRUE.                             
266712     SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                             
266713     MOVE 1                          TO DPG51-INCR-DECR-DAYS-9.           
266714     MOVE DF-WORK-DATE               TO DPG52-LK-DATE-INPUT.              
266715     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                        
266716                                             DPG52                        
266717                                             DPG53                        
266718                                             DPG54                        
266719                                             DPG55                        
266720                                             DPG56.                       
266721     EVALUATE TRUE                                                        
266722        WHEN DPG54-NO-ERROR                                               
266723             MOVE DPG55-DB2-ISO-DATE-FMT                                  
266724               TO DF-END-DATE                                             
266725        WHEN OTHER                                                        
266726             DISPLAY 'ERROR ROUTINE ABEND'                                
266727     END-EVALUATE.                                                        
266728                                                                          
CHG016****************************************************************          
CHG016* LOGON TO ORACLE                                                         
CHG016****************************************************************          
CHG016 8000-READ-ORACLE-LOGON.                                                  
CHG016                                                                          
CHG016     READ ORACLE-LOGON-FILE                                               
CHG016         INTO CC-ORACLE-CONNECTION                                        
CHG016         AT END                                                           
CHG016             SET PS-END-OF-LOGON-FILE TO TRUE                             
CHG016     END-READ.                                                            
CHG016                                                                          
266729****************************************************************          
266730*     END OF JOB                                                  26670300
266731****************************************************************  26670400
266732 9000-END-OF-JOB.                                                 26670500
266733     CLOSE IN-MOS-FILE                                            26670600
266735           OUT-DEL-FILE                                           26670900
266736           OUT-VALID-FILE.                                        26671000
266737                                                                  26672000
266738     DISPLAY ' '.                                                 26673099
266740     DISPLAY '*********************************************'.     26674099
266750     DISPLAY '    PXKUT027 SUMMARY STATISTICS              '      26675099
266760     DISPLAY '*********************************************'.     26676099
266770     DISPLAY 'TOTAL MOS RECS READ.......: ' PA-TOT-MOS-READS      26677099
266780     DISPLAY 'TOTAL MOS RECS VALIDATE...: ' PA-TOT-MOS-VALIDATE   26678099
266790     DISPLAY 'TOTAL MOS RECS DELETED....: ' PA-TOT-MOS-DELETED    26679099
266791     DISPLAY '*********************************************'.     26679199
266792                                                                  26679200
266793****************************************************************  26679300
266794*     NON-DATABASE ABEND.                                         26679400
266795****************************************************************  26679500
266796 9800-ABEND.                                                      26679600
266797     DISPLAY '** ABEND     **'.                                   26679700
266798     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                26679800
266799     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              26679900
266800     DISPLAY '** OPERATION ** = ' PV-OPERATION-MSG.               26680000
267300                                                                  26730000
267400     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         26740000
267500                                                                  26750099
270202******************************************************************27020200
270203*     SQL ABEND PARAGRAPH.                                        27020300
270204******************************************************************27020400
270205 9999-SQL-ABEND.                                                  27020500
270206     DISPLAY '** ABEND     **'.                                   27020600
270207     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                27020700
270208     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              27020800
270209     DISPLAY '** OPERATION ** = ' PV-OPERATION-MSG.               27020900
270210                                                                  27021000
270211******************************************************************27021100
270212* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     27021200
270213* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      27021300
270214******************************************************************27021400
270215     COPY DPPD004.                                                27021500
270216     SET AC-DB2-ERROR TO TRUE.                                    27021600
270217     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         27021700
