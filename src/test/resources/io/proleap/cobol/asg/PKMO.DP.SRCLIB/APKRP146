000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.     APKRP146.                                        00020099
000300 AUTHOR.         ROBIN BERNOSKI.                                  00030099
000400 DATE-WRITTEN.   02/01/1999.                                      00040099
000500 DATE-COMPILED.                                                   00050099
000600*************************************************************     00060099
000700*    COBOL                                                  *     00070099
000800*       --- DAILY TERMINAL BALANCING REPORT BY TKID ---     *     00080099
000900*                                                           *     00090099
001000*    THIS PROGRAM PRODUCES THE DAILY TERMINAL BALANCING     *     00100099
001100*    REPORT BY TKID.  THE REPORT WILL BE IN TKID/ORIGIN     *     00110099
001200*    SEQUENCE, WITH TOTALS BY ORIGIN AND TKID, AND STARTING *     00120099
001300*    A NEW PAGE FOR EVERY NEW TKID ENCOUNTERED.  FINAL      *     00130099
001400*    REPORT TOTALS WILL INCLUDE TOTALS BY ORIGIN FOR ALL    *     00140099
001500*    TKIDS, AND GRAND TOTALS OF ALL ORIGINS FOR ALL TKIDS.  *     00150099
001600*                                                           *     00160099
001700* INPUT:                                                    *     00170099
001800*  1. DAILY KEYED DOCUMENT EXTRACT FILE (APRD070)           *     00180099
001900*                                                           *     00190099
002000* OUTPUT:                                                   *     00200099
002100*  1. DAILY TERMINAL BALANCING REPORT ------                *     00210099
002200*                        BY TKID FOR ALL ORIGINS            *     00220099
002300*                                                           *     00230099
002400*************************************************************     00240099
002500*---------------------------------------------------------------* 00250099
002600*                                                               * 00260099
002700* CHANGE LOG:                                                   * 00270099
002800*                                                               * 00280099
002900*  07/23/99                                                     * 00290099
003000*     FIXED PROBLEM OF NO HEADINGS BEING PRINTED ON LAST PAGE   * 00300099
003100*     OF REPORT.                                                * 00310099
003200*  MADE BY:  ROBIN BERNOSKI             WR/PITS#:               * 00320099
003300*                                                               * 00330099
003400*  11/10/2000                                                   * 00340099
003500*     REPLACED ALL REFERENCES TO NW-STR-DISC-AMT, TRD-DISC-AMT, * 00350099
003600*     AND TERM-DISC-AMT WITH ONE USE OF THE NEW FIELD, TOTAL-   * 00360099
003700*     DISC-AMT.  REMOVED ALL WORKING STORAGE FIELDS THAT REFER  * 00370099
003800*     TO THE INDIVIDUAL DISCOUNTS.                              * 00380099
003900*  MADE BY: JILL JUEL                   WR# 20224               * 00390099
004000*                                                               * 00400099
004100*  10/03/2001                                                   * 00410099
004200*     INSERTED LOGIC TO ONLY PERFORM W800- PARAGRAPH TO         * 00420099
004300*     WRITE DETAIL IF ENTRY WAS KEYED (BY A 'TK' ID).           * 00430099
004400*     ADDED SUBTOTALS TO REPORT FOR KEYED ENTRIES AND           * 00440099
004500*     INTERFACED ENTRIES.                                       * 00450099
004600*  MADE BY: MARK BURNSIDE               WR# 20540               * 00460099
004700*                                                               * 00470099
004800*  11/18/2003                                                   * 00480099
004900*     CHANGE MADE: ADD PEOPLESOFT PO-ID TO DISPLAY WHEN         * 00490099
005000*     INVOICE CREATED FROM A PEOPLESOFT PO.*                      00500099
005100*  MADE BY: L SCHALLHORN                WR# 24674               * 00510099
005200*                                                               * 00520099
005300*  DATE  08/27/2010                                             * 00530099
005400*      CHANGE MADE: IN PARA B200-, ADDED 'TC' AND 'TV' TO THE IF* 00540099
005500*      STATEMENTS CHECKING DL-TKID (1:2) = 'TK'.  IN PARA C200-,* 00550099
005600*      ADDED TC' AND 'TV' TO THE IF STATEMENT CHECKING          * 00560099
005700*      OT-ENTR-ID (1:2) = 'TK'.  THESE CHANGES ARE PART OF THE  * 00570099
005800*      CORPORATE USERID EXPANSION PROJECT.                      * 00580099
005900*      MADE BY: MIKE BESKE              WR/IR #: PKE000000005180* 00590099
006000*                                                               * 00600099
006100*---------------------------------------------------------------* 00610099
006200                                                                  00620099
006300   EJECT                                                          00630099
006400                                                                  00640099
006500 ENVIRONMENT DIVISION.                                            00650099
006600                                                                  00660099
006700 CONFIGURATION SECTION.                                           00670099
006800 SOURCE-COMPUTER.    IBM-3090.                                    00680099
006900 OBJECT-COMPUTER.    IBM-3090.                                    00690099
007000                                                                  00700099
007100 INPUT-OUTPUT SECTION.                                            00710099
007200                                                                  00720099
007300 FILE-CONTROL.                                                    00730099
007400                                                                  00740099
007500     SELECT DAILY-DOC-EXTRCT-FILE   ASSIGN TO INP01.              00750099
007600     SELECT DAILY-TERMINAL-BAL-FILE ASSIGN TO RPT01.              00760099
007700                                                                  00770099
007800 EJECT                                                            00780099
007900                                                                  00790099
008000 DATA DIVISION.                                                   00800099
008100                                                                  00810099
008200 FILE SECTION.                                                    00820099
008300                                                                  00830099
008400 FD  DAILY-DOC-EXTRCT-FILE                                        00840099
008500     RECORDING MODE IS F                                          00850099
008600     LABEL RECORDS ARE STANDARD                                   00860099
008700     BLOCK CONTAINS 0 RECORDS                                     00870099
008800     DATA RECORD IS DAILY-DOC-EXTRCT-REC.                         00880099
008900 01  DAILY-DOC-EXTRCT-REC.                                        00890099
009000     05  FILLER                           PIC  X(250).            00900099
009100                                                                  00910099
009200                                                                  00920099
009300 FD  DAILY-TERMINAL-BAL-FILE                                      00930099
009400     RECORDING MODE IS F                                          00940099
009500     LABEL RECORDS ARE STANDARD                                   00950099
009600     BLOCK CONTAINS 0 RECORDS                                     00960099
009700     DATA RECORD IS DAILY-TERMINAL-BAL-REC.                       00970099
009800 01  DAILY-TERMINAL-BAL-REC.                                      00980099
009900     05  FILLER                           PIC  X(200).            00990099
010000                                                                  01000099
010100 EJECT                                                            01010099
010200                                                                  01020099
010300 WORKING-STORAGE SECTION.                                         01030099
010400                                                                  01040099
010500 01  PV-PROGRAM-VARIABLES.                                        01050099
010600     05  FILLER                  PIC  X(30)  VALUE                01060099
010700         '** BEGINING OF APKRP146 W/S **'.                        01070099
010800     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      01080099
010900     05  PV-CURRENT-DATE.                                         01090099
011000         10  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         01100099
011100         10  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         01110099
011200         10  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         01120099
011300     05  PV-NEXT-PERIOD          PIC  9(02)  VALUE ZEROS.         01130099
011400     05  PV-OR-DISCOUNT          PIC S9(15)V99 VALUE ZEROS.       01140099
011500     05  PV-OR-NET-COST-B4       PIC S9(15)V99 VALUE ZEROS.       01150099
011600     05  PV-TK-DISCOUNT          PIC S9(15)V99 VALUE ZEROS.       01160099
011700     05  PV-TK-NET-COST-B4       PIC S9(15)V99 VALUE ZEROS.       01170099
011800     05  PV-CURRENT-TIME.                                         01180099
011900         10  PV-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         01190099
012000         10  PV-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         01200099
012100         10  FILLER              PIC  9(02)  VALUE ZEROS.         01210099
012200     05  PV-HOLD-VARIABLES.                                       01220099
012300         10  PV-HOLD-ENTR-ID     PIC  X(08)  VALUE SPACES.        01230099
012400         10  PV-HOLD-ORIGIN      PIC  X(03)  VALUE SPACES.        01240099
012500         10  PV-HOLD-OT-ORIGIN-ID       PIC X(03)  VALUE SPACES.  01250099
012600         10  PV-HOLD-DOC-NBR            PIC X(16)  VALUE SPACES.  01260099
012700         10  PV-HOLD-DOC-GRO-COST-AMT   PIC S9(13)V99 VALUE ZEROS.01270099
012800         10  PV-HOLD-DOC-FRGT-AMT       PIC S9(13)V99 VALUE ZEROS.01280099
012900         10  PV-HOLD-DOC-MISC-CHRG-AMT  PIC S9(13)V99 VALUE ZEROS.01290099
013000         10  PV-HOLD-DISCOUNT           PIC S9(13)V99 VALUE ZEROS.01300099
013100         10  PV-HOLD-DOC-NET-COST-B4    PIC S9(13)V99 VALUE ZEROS.01310099
013200         10  PV-HOLD-DOC-NET-COST-AMT   PIC S9(13)V99 VALUE ZEROS.01320099
013300         10  PV-HOLD-DOC-RETL-AMT       PIC S9(13)V99 VALUE ZEROS.01330099
013400                                                                  01340099
013500         10  PV-HOLD-GRAND-GRO-COST-AMT PIC S9(13)V99 VALUE ZEROS.01350099
013600         10  PV-HOLD-GRAND-FRGT-AMT     PIC S9(13)V99 VALUE ZEROS.01360099
013700         10  PV-HOLD-GRAND-MISC-CHRG-AMT                          01370099
013800                                        PIC S9(13)V99 VALUE ZEROS.01380099
013900         10  PV-HOLD-GRAND-NET-COST-B4  PIC S9(13)V99 VALUE ZEROS.01390099
014000         10  PV-HOLD-GRAND-NET-COST-AMT PIC S9(13)V99 VALUE ZEROS.01400099
014100         10  PV-HOLD-GRAND-RETL-AMT     PIC S9(13)V99 VALUE ZEROS.01410099
014200         10  PV-HOLD-GRAND-DISCOUNT     PIC S9(13)V99 VALUE ZEROS.01420099
014300         10  PV-HOLD-KEYED-GRO-COST-AMT PIC S9(13)V99 VALUE ZEROS.01430099
014400         10  PV-HOLD-KEYED-FRGT-AMT     PIC S9(13)V99 VALUE ZEROS.01440099
014500         10  PV-HOLD-KEYED-MISC-CHRG-AMT                          01450099
014600                                        PIC S9(13)V99 VALUE ZEROS.01460099
014700         10  PV-HOLD-KEYED-NET-COST-B4  PIC S9(13)V99 VALUE ZEROS.01470099
014800         10  PV-HOLD-KEYED-NET-COST-AMT PIC S9(13)V99 VALUE ZEROS.01480099
014900         10  PV-HOLD-KEYED-RETL-AMT     PIC S9(13)V99 VALUE ZEROS.01490099
015000         10  PV-HOLD-KEYED-DISCOUNT     PIC S9(13)V99 VALUE ZEROS.01500099
015100         10  PV-HOLD-INTFC-GRO-COST-AMT PIC S9(13)V99 VALUE ZEROS.01510099
015200         10  PV-HOLD-INTFC-FRGT-AMT     PIC S9(13)V99 VALUE ZEROS.01520099
015300         10  PV-HOLD-INTFC-MISC-CHRG-AMT                          01530099
015400                                        PIC S9(13)V99 VALUE ZEROS.01540099
015500         10  PV-HOLD-INTFC-NET-COST-B4  PIC S9(13)V99 VALUE ZEROS.01550099
015600         10  PV-HOLD-INTFC-NET-COST-AMT PIC S9(13)V99 VALUE ZEROS.01560099
015700         10  PV-HOLD-INTFC-RETL-AMT     PIC S9(13)V99 VALUE ZEROS.01570099
015800         10  PV-HOLD-INTFC-DISCOUNT     PIC S9(13)V99 VALUE ZEROS.01580099
015900     05  PV-ENTR-DATE.                                            01590099
016000         10  PV-ENTR-CC                 PIC 9(02) VALUE ZEROS.    01600099
016100         10  PV-ENTR-YY                 PIC 9(02) VALUE ZEROS.    01610099
016200         10  FILLER                     PIC X(01) VALUE '/'.      01620099
016300         10  PV-ENTR-MM                 PIC 9(02) VALUE ZEROS.    01630099
016400         10  FILLER                     PIC X(01) VALUE '/'.      01640099
016500         10  PV-ENTR-DD                 PIC 9(02) VALUE ZEROS.    01650099
016600     05  PV-NET-COST-B4                 PIC S9(15)V99 VALUE ZEROS.01660099
016700                                                                  01670099
016800     EJECT                                                        01680099
016900                                                                  01690099
017000 01  SS-SUBSCRIPTS.                                               01700099
017100     05  ORIGIN-SUB              PIC  9(03) VALUE ZEROS.          01710099
017200                                                                  01720099
017300 01  OT-ORIGIN-TABLE                       VALUE SPACES.          01730099
017400     05  OT-ORIGIN OCCURS 999 TIMES INDEXED BY OT-IND.            01740099
017500         10  OT-ORIGIN-ID        PIC  X(03).                      01750099
017600         10  OT-ENTR-ID          PIC  X(08).                      01760099
017700         10  OT-GRO-COST-AMT     PIC  S9(15)V99.                  01770099
017800         10  OT-DISCOUNT         PIC  S9(15)V99.                  01780099
017900         10  OT-FRGT-AMT         PIC  S9(15)V99.                  01790099
018000         10  OT-MISC-CHRG-AMT    PIC  S9(15)V99.                  01800099
018100         10  OT-NET-COST-B4      PIC  S9(15)V99.                  01810099
018200         10  OT-NET-COST-AMT     PIC  S9(15)V99.                  01820099
018300         10  OT-RETL-AMT         PIC  S9(15)V99.                  01830099
018400                                                                  01840099
018500 01  PS-PROGRAM-SWITCHES.                                         01850099
018600     05  PS-OUT-OF-TRANS-SW      PIC X(01) VALUE 'N'.             01860099
018700         88  OUT-OF-TRANS                  VALUE 'Y'.             01870099
018800         88  MORE-TRANS                    VALUE 'N'.             01880099
018900     05  PS-DATE-SW              PIC X(01) VALUE 'N'.             01890072
019000         88  VALID-DATE                    VALUE 'Y'.             01900072
019100         88  NOT-VALID-DATE                VALUE 'N'.             01910072
019200     05  PS-END-OF-INVOICE-SW    PIC X(01) VALUE 'N'.             01920099
019300         88  END-OF-INVOICES               VALUE 'Y'.             01930099
019400         88  MORE-INVOICES                 VALUE 'N'.             01940099
019500     05  EMPTY-FILE              PIC X(01) VALUE 'N'.             01950099
019600         88  NOT-EMPTY-SW                  VALUE 'N'.             01960099
019700         88  EMPTY-SW                      VALUE 'Y'.             01970099
019800                                                                  01980099
019900 01  PC-PROGRAM-CONSTANTS.                                        01990099
020000     05  PC-PROGRAM-NAME         PIC  X(08)  VALUE 'APKRP146'.    02000099
020100                                                                  02010099
020200     EJECT                                                        02020099
020300                                                                  02030099
020400 01  PC-PROGRAM-COUNTERS.                                         02040099
020500     05  PC-RETRY-MAX            PIC S9(04)  VALUE 3              02050099
020600                                             COMP SYNC.           02060099
020700     05  PC-RETRY-COUNT          PIC S9(04)  VALUE ZEROS          02070099
020800                                             COMP SYNC.           02080099
020900     05  PC-MAX-LINES            PIC S9(03)  VALUE +76            02090099
021000                                             COMP-3.              02100099
021100     05  PC-LINE-COUNT           PIC S9(03)  VALUE +99            02110099
021200                                             COMP-3.              02120099
021300     05  PC-PAGE-COUNT           PIC S9(05)  VALUE ZEROS          02130099
021400                                             COMP-3.              02140099
021500     05  PC-ORIGIN-COUNTER       PIC S9(05)  VALUE ZEROS          02150099
021600                                             COMP-3.              02160099
021700     05  PC-TKID-COUNTER         PIC S9(05)  VALUE ZEROS          02170099
021800                                             COMP-3.              02180099
021900     05  PC-READ-COUNTER         PIC S9(05)  VALUE ZEROS          02190099
022000                                             COMP-3.              02200099
022100     05  TABLE-SIZE-COUNTER      PIC S9(05)  VALUE ZEROS          02210099
022200                                             COMP-3.              02220099
022300     05  PC-DOC-COUNT            PIC  9(05)  VALUE ZEROS.         02230099
022400                                                                  02240099
022500     EJECT                                                        02250099
022600                                                                  02260099
022700 01  OR-ORIGIN-TOTALS.                                            02270099
022800     05  OR-ENTR-ID              PIC  X(08)    VALUE SPACES.      02280099
022900     05  OR-ORIGIN               PIC  X(03)    VALUE SPACES.      02290099
023000     05  OR-GRO-COST-AMT         PIC S9(15)V99 VALUE ZEROS.       02300099
023100     05  OR-DISCOUNT             PIC S9(15)V99 VALUE ZEROS.       02310099
023200     05  OR-FRGT-AMT             PIC S9(15)V99 VALUE ZEROS.       02320099
023300     05  OR-MISC-CHRG-AMT        PIC S9(15)V99 VALUE ZEROS.       02330099
023400     05  OR-NET-COST-B4          PIC S9(15)V99 VALUE ZEROS.       02340099
023500     05  OR-NET-COST-AMT         PIC S9(15)V99 VALUE ZEROS.       02350099
023600     05  OR-RETL-AMT             PIC S9(15)V99 VALUE ZEROS.       02360099
023700                                                                  02370099
023800 01  TT-TKID-TOTALS.                                              02380099
023900     05  TK-GRO-COST-AMT         PIC S9(15)V99 VALUE ZEROS.       02390099
024000     05  TK-DISCOUNT             PIC S9(15)V99 VALUE ZEROS.       02400099
024100     05  TK-FRGT-AMT             PIC S9(15)V99 VALUE ZEROS.       02410099
024200     05  TK-MISC-CHRG-AMT        PIC S9(15)V99 VALUE ZEROS.       02420099
024300     05  TK-NET-COST-B4          PIC S9(15)V99 VALUE ZEROS.       02430099
024400     05  TK-NET-COST-AMT         PIC S9(15)V99 VALUE ZEROS.       02440099
024500     05  TK-RETL-AMT             PIC S9(15)V99 VALUE ZEROS.       02450099
024600                                                                  02460099
024700 01  DN-DOC-NBR-TOTALS.                                           02470099
024800     05  DN-GRO-COST-AMT         PIC S9(15)V99 VALUE ZEROS.       02480099
024900     05  DN-TERMS-AMT            PIC S9(15)V99 VALUE ZEROS.       02490099
025000     05  DN-FRGT-AMT             PIC S9(15)V99 VALUE ZEROS.       02500099
025100     05  DN-MISC-CHRG-AMT        PIC S9(15)V99 VALUE ZEROS.       02510099
025200     05  DN-NET-COST-B4          PIC S9(15)V99 VALUE ZEROS.       02520099
025300     05  DN-NET-COST-AMT         PIC S9(15)V99 VALUE ZEROS.       02530099
025400     05  DN-RETL-AMT             PIC S9(15)V99 VALUE ZEROS.       02540099
025500                                                                  02550099
025600 EJECT                                                            02560099
025700                                                                  02570099
025800*----------------------------------------------------------------*02580099
025900*  RECORD LAYOUT FOR THE DAILY KEYED DOCUMENT EXTRACT FILE       *02590099
026000*----------------------------------------------------------------*02600099
026100     COPY APRD070.                                                02610099
026200                                                                  02620099
026300     EJECT                                                        02630099
026400                                                                  02640099
026500*----------------------------------------------------------------*02650099
026600*  STANDARD HEADER LAYOUT                                        *02660099
026700*----------------------------------------------------------------*02670099
026800     COPY DPWS200O.                                               02680099
026900                                                                  02690099
027000*----------------------------------------------------------------*02700072
027100* WORKING STORAGE FOR DATE ROUTINE                                02710072
027200*----------------------------------------------------------------*02720072
027300     COPY DPWS500.                                                02730072
027400                                                                  02740099
027500 EJECT                                                            02750072
027600                                                                  02760099
027700 01  TRMNL-BALANCE-HEADER1.                                       02770099
027800     05  FILLER                  PIC  X(92) VALUE SPACES.         02780099
027900     05  FILLER                  PIC  X(16) VALUE                 02790099
028000                                           'ACCOUNTS PAYABLE'.    02800099
028100     05  FILLER                  PIC  X(92) VALUE SPACES.         02810099
028200                                                                  02820099
028300 01  TRMNL-BALANCE-HEADER2.                                       02830099
028400     05  FILLER                  PIC  X(72) VALUE SPACES.         02840099
028500     05  FILLER                  PIC  X(57) VALUE                 02850099
028600      'DAILY TERMINAL BALANCING REPORT - BY TKID FOR ALL ORIGINS'.02860099
028700     05  FILLER                  PIC  X(71) VALUE SPACES.         02870099
028800                                                                  02880099
028900 01  TRMNL-BALANCE-HEADER3.                                       02890099
029000     05  FILLER                  PIC  X(95) VALUE SPACES.         02900099
029100     05  H3-MONTH                PIC  X(02) VALUE SPACES.         02910099
029200     05  FILLER                  PIC  X(01) VALUE '/'.            02920099
029300     05  H3-DAY                  PIC  X(02) VALUE SPACES.         02930099
029400     05  FILLER                  PIC  X(01) VALUE '/'.            02940099
029500     05  H3-YEAR                 PIC  X(04) VALUE SPACES.         02950099
029600     05  FILLER                  PIC  X(95) VALUE SPACES.         02960099
029700                                                                  02970099
029800     EJECT                                                        02980099
029900                                                                  02990099
030000 01  DH1-TRMNL-BALANCE-DETAIL-HDR1.                               03000099
030100     05  FILLER                  PIC   X(19) VALUE SPACES.        03010099
030200     05  FILLER                  PIC   X(02) VALUE 'PO'.          03020099
030300     05  FILLER                  PIC   X(07) VALUE SPACES.        03030099
030400     05  FILLER                  PIC   X(08) VALUE 'DOCUMENT'.    03040099
030500     05  FILLER                  PIC   X(11) VALUE SPACES.        03050099
030600     05  FILLER                  PIC   X(05) VALUE 'ENTRY'.       03060099
030700     05  FILLER                  PIC   X(07) VALUE SPACES.        03070099
030800     05  FILLER                  PIC   X(06) VALUE 'VENDOR'.      03080099
030900     05  FILLER                  PIC   X(09) VALUE SPACES.        03090099
031000     05  FILLER                  PIC   X(06) VALUE 'VENDOR'.      03100099
031100     05  FILLER                  PIC   X(10) VALUE SPACES.        03110099
031200     05  FILLER                  PIC   X(05) VALUE 'DEPT/'.       03120099
031300     05  FILLER                  PIC   X(09) VALUE SPACES.        03130099
031400     05  FILLER                  PIC   X(05) VALUE 'GROSS'.       03140099
031500     05  FILLER                  PIC   X(10) VALUE SPACES.        03150099
031600     05  FILLER                  PIC   X(07) VALUE 'FREIGHT'.     03160099
031700     05  FILLER                  PIC   X(09) VALUE SPACES.        03170099
031800     05  FILLER                  PIC   X(04) VALUE 'MISC'.        03180099
031900     05  FILLER                  PIC   X(08) VALUE SPACES.        03190099
032000     05  FILLER                  PIC   X(08) VALUE 'NET COST'.    03200099
032100     05  FILLER                  PIC   X(25) VALUE SPACES.        03210099
032200     05  FILLER                  PIC   X(03) VALUE 'NET'.         03220099
032300     05  FILLER                  PIC   X(09) VALUE SPACES.        03230099
032400     05  FILLER                  PIC   X(06) VALUE 'RETAIL'.      03240099
032500     05  FILLER                  PIC   X(02) VALUE SPACES.        03250099
032600                                                                  03260099
032700     EJECT                                                        03270099
032800                                                                  03280099
032900 01  DH2-TRMNL-BALANCE-DETAIL-HDR2.                               03290099
033000     05  FILLER                  PIC   X(01) VALUE SPACES.        03300099
033100     05  FILLER                  PIC   X(05) VALUE 'TK ID'.       03310099
033200     05  FILLER                  PIC   X(02) VALUE SPACES.        03320099
033300     05  FILLER                  PIC   X(07) VALUE 'ORIGIN'.      03330099
033400     05  FILLER                  PIC   X(02) VALUE SPACES.        03340099
033500     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      03350099
033600     05  FILLER                  PIC   X(06) VALUE SPACES.        03360099
033700     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      03370099
033800     05  FILLER                  PIC   X(13) VALUE SPACES.        03380099
033900     05  FILLER                  PIC   X(04) VALUE 'DATE'.        03390099
034000     05  FILLER                  PIC   X(07) VALUE SPACES.        03400099
034100     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      03410099
034200     05  FILLER                  PIC   X(10) VALUE SPACES.        03420099
034300     05  FILLER                  PIC   X(04) VALUE 'NAME'.        03430099
034400     05  FILLER                  PIC   X(10) VALUE SPACES.        03440099
034500     05  FILLER                  PIC   X(07) VALUE 'EXPENSE'.     03450099
034600     05  FILLER                  PIC   X(09) VALUE SPACES.        03460099
034700     05  FILLER                  PIC   X(04) VALUE 'COST'.        03470099
034800     05  FILLER                  PIC   X(11) VALUE SPACES.        03480099
034900     05  FILLER                  PIC   X(04) VALUE 'COST'.        03490099
035000     05  FILLER                  PIC   X(11) VALUE SPACES.        03500099
035100     05  FILLER                  PIC   X(04) VALUE 'COST'.        03510099
035200     05  FILLER                  PIC   X(09) VALUE SPACES.        03520099
035300     05  FILLER                  PIC   X(06) VALUE 'BEFORE'.      03530099
035400     05  FILLER                  PIC   X(07) VALUE SPACES.        03540099
035500     05  FILLER                  PIC   X(08) VALUE 'DISCOUNT'.    03550099
035600     05  FILLER                  PIC   X(10) VALUE SPACES.        03560099
035700     05  FILLER                  PIC   X(04) VALUE 'COST'.        03570099
035800     05  FILLER                  PIC   X(09) VALUE SPACES.        03580099
035900     05  FILLER                  PIC   X(06) VALUE 'AMOUNT'.      03590099
036000     05  FILLER                  PIC   X(02) VALUE SPACES.        03600099
036100                                                                  03610099
036200     EJECT                                                        03620099
036300                                                                  03630099
036400 01  DL-TRMNL-BALANCE-DTL-EMPTY-INP.                              03640099
036500     05  FILLER                  PIC   X(86) VALUE SPACES.        03650099
036600     05  FILLER                  PIC   X(27) VALUE                03660099
036700                          'NO DATA TO REPORT FOR TODAY'.          03670099
036800     05  FILLER                  PIC   X(87) VALUE SPACES.        03680099
036900                                                                  03690099
037000 01  EOR-END-OF-REPORT-LINE.                                      03700099
037100     05  FILLER                  PIC   X(87) VALUE SPACES.        03710099
037200     05  FILLER                  PIC   X(25) VALUE                03720099
037300                          'E N D   O F   R E P O R T'.            03730099
037400     05  FILLER                  PIC   X(88) VALUE SPACES.        03740099
037500                                                                  03750099
037600     EJECT                                                        03760099
037700                                                                  03770099
037800 01  DL-TRMNL-BALANCE-DETAIL-LINE.                                03780099
037900     05  DL-TKID                 PIC   X(07)   VALUE ZEROS.       03790099
038000     05  FILLER                  PIC   X(02)   VALUE SPACES.      03800099
038100     05  DL-ORIGIN               PIC   X(03)   VALUE SPACES.      03810099
038200     05  FILLER                  PIC   X(03)   VALUE SPACES.      03820099
038300     05  DL-PO-NBR               PIC   X(10)   VALUE SPACES.      03830099
038400     05  FILLER                  PIC   X(02)   VALUE SPACES.      03840099
038500     05  DL-DOC-NBR              PIC   X(16)   VALUE SPACES.      03850099
038600     05  FILLER                  PIC   X(02)   VALUE SPACES.      03860099
038700     05  DL-ENTRY-DTE            PIC   X(10)   VALUE SPACES.      03870099
038800     05  FILLER                  PIC   X(02)   VALUE SPACES.      03880099
038900     05  DL-VND-NBR              PIC   X(09)   VALUE SPACES.      03890099
039000     05  FILLER                  PIC   X(02)   VALUE SPACES.      03900099
039100     05  DL-ENT-NME-DESC         PIC   X(18)   VALUE SPACES.      03910099
039200     05  FILLER                  PIC   X(03)   VALUE SPACES.      03920099
039300     05  DL-DEPT-NBR             PIC   X(06)   VALUE SPACES       03930099
039400                                               JUSTIFIED RIGHT.   03940099
039500     05  FILLER                  PIC   X(02)   VALUE SPACES.      03950099
039600     05  DL-GRO-COST-AMT         PIC   ----------.99              03960099
039700                                               VALUE SPACES.      03970099
039800     05  FILLER                  PIC   X(02)   VALUE SPACES.      03980099
039900     05  DL-FRGT-AMT             PIC   ----------.99              03990099
040000                                               VALUE SPACES.      04000099
040100     05  FILLER                  PIC   X(02)   VALUE SPACES.      04010099
040200     05  DL-MISC-CHRG-AMT        PIC   ----------.99              04020099
040300                                               VALUE SPACES.      04030099
040400     05  FILLER                  PIC   X(02)   VALUE SPACES.      04040099
040500     05  DL-NET-COST-B4          PIC   ----------.99              04050099
040600                                               VALUE SPACES.      04060099
040700     05  FILLER                  PIC   X(02)   VALUE SPACES.      04070099
040800     05  DL-DISCOUNT             PIC   ----------.99              04080099
040900                                               VALUE SPACES.      04090099
041000     05  FILLER                  PIC   X(02)   VALUE SPACES.      04100099
041100     05  DL-NET-COST-AMT         PIC   ----------.99              04110099
041200                                               VALUE SPACES.      04120099
041300     05  FILLER                  PIC   X(01)   VALUE SPACES.      04130099
041400     05  DL-RETL-AMT             PIC   ----------.99              04140099
041500                                               VALUE SPACES.      04150099
041600     05  FILLER                  PIC   X(01)   VALUE SPACES.      04160099
041700                                                                  04170099
041800 01  SP-SPACE-LINE.                                               04180099
041900     05  FILLER                  PIC   X(200)  VALUE SPACES.      04190099
042000                                                                  04200099
042100     EJECT                                                        04210099
042200                                                                  04220099
042300 01  SL1-ID-ORIGIN-SUMMARY-LINE1.                                 04230099
042400     05  FILLER                  PIC   X(26)   VALUE SPACES.      04240099
042500     05  FILLER                  PIC   X(29)   VALUE              04250099
042600                       'TRANSACTION TOTALS FOR TK ID '.           04260099
042700     05  SL1-ENTR-ID             PIC   X(08)   VALUE SPACES.      04270099
042800     05  FILLER                  PIC   X(11)   VALUE              04280099
042900                                         'FOR ORIGIN '.           04290099
043000     05  SL1-ORIGIN              PIC   X(03)   VALUE SPACES.      04300099
043100     05  FILLER                  PIC   X(20)   VALUE SPACES.      04310099
043200     05  SL1-GRO-COST-AMT        PIC   ----------.99              04320099
043300                                               VALUE SPACES.      04330099
043400     05  FILLER                  PIC   X(02)   VALUE SPACES.      04340099
043500     05  SL1-FRGT-AMT            PIC   ----------.99              04350099
043600                                               VALUE SPACES.      04360099
043700     05  FILLER                  PIC   X(02)   VALUE SPACES.      04370099
043800     05  SL1-MISC-CHRG-AMT       PIC   ----------.99              04380099
043900                                               VALUE SPACES.      04390099
044000     05  FILLER                  PIC   X(02)   VALUE SPACES.      04400099
044100     05  SL1-NET-COST-B4         PIC   ----------.99              04410099
044200                                               VALUE SPACES.      04420099
044300     05  FILLER                  PIC   X(02)   VALUE SPACES.      04430099
044400     05  SL1-DISCOUNT            PIC   ----------.99              04440099
044500                                               VALUE SPACES.      04450099
044600     05  FILLER                  PIC   X(02)   VALUE SPACES.      04460099
044700     05  SL1-NET-COST-AMT        PIC   ----------.99              04470099
044800                                               VALUE SPACES.      04480099
044900     05  FILLER                  PIC   X(01)   VALUE SPACES.      04490099
045000     05  SL1-RETL-AMT            PIC   ----------.99              04500099
045100                                               VALUE SPACES.      04510099
045200     05  FILLER                  PIC   X(01)   VALUE SPACES.      04520099
045300                                                                  04530099
045400     EJECT                                                        04540099
045500                                                                  04550099
045600 01  SL2-ALL-ORIGIN-SUMMARY-LINE2.                                04560099
045700     05  FILLER                  PIC   X(26)   VALUE SPACES.      04570099
045800     05  FILLER                  PIC   X(29)   VALUE              04580099
045900                       'TRANSACTION TOTALS FOR TK ID '.           04590099
046000     05  SL2-ENTR-ID             PIC   X(08)   VALUE SPACES.      04600099
046100     05  FILLER                  PIC   X(19)   VALUE              04610099
046200                                    'FOR ALL ORIGINS '.           04620099
046300     05  FILLER                  PIC   X(15)   VALUE SPACES.      04630099
046400     05  SL2-GRO-COST-AMT        PIC   ----------.99              04640099
046500                                               VALUE SPACES.      04650099
046600     05  FILLER                  PIC   X(02)   VALUE SPACES.      04660099
046700     05  SL2-FRGT-AMT            PIC   ----------.99              04670099
046800                                               VALUE SPACES.      04680099
046900     05  FILLER                  PIC   X(02)   VALUE SPACES.      04690099
047000     05  SL2-MISC-CHRG-AMT       PIC   ----------.99              04700099
047100                                               VALUE SPACES.      04710099
047200     05  FILLER                  PIC   X(02)   VALUE SPACES.      04720099
047300     05  SL2-NET-COST-B4         PIC   ----------.99              04730099
047400                                               VALUE SPACES.      04740099
047500     05  FILLER                  PIC   X(02)   VALUE SPACES.      04750099
047600     05  SL2-DISCOUNT            PIC   ----------.99              04760099
047700                                               VALUE SPACES.      04770099
047800     05  FILLER                  PIC   X(02)   VALUE SPACES.      04780099
047900     05  SL2-NET-COST-AMT        PIC   ----------.99              04790099
048000                                               VALUE SPACES.      04800099
048100     05  FILLER                  PIC   X(01)   VALUE SPACES.      04810099
048200     05  SL2-RETL-AMT            PIC   ----------.99              04820099
048300                                               VALUE SPACES.      04830099
048400     05  FILLER                  PIC   X(01)   VALUE SPACES.      04840099
048500                                                                  04850099
048600     EJECT                                                        04860099
048700                                                                  04870099
048800 01  SL3-ALL-ENTR-ID-SUMMARY-LINE3.                               04880099
048900     05  FILLER                  PIC   X(26)   VALUE SPACES.      04890099
049000     05  FILLER                  PIC   X(45)   VALUE              04900099
049100         'TRANSACTION TOTALS FOR ALL TK ID''S FOR ORIGIN'.        04910099
049200     05  FILLER                  PIC   X(01)   VALUE SPACES.      04920099
049300     05  SL3-ORIGIN              PIC   X(03)   VALUE SPACES.      04930099
049400     05  FILLER                  PIC   X(22)   VALUE SPACES.      04940099
049500     05  SL3-GRO-COST-AMT        PIC   ----------.99              04950099
049600                                               VALUE ZEROS.       04960099
049700     05  FILLER                  PIC   X(02)   VALUE SPACES.      04970099
049800     05  SL3-FRGT-AMT            PIC   ----------.99              04980099
049900                                               VALUE ZEROS.       04990099
050000     05  FILLER                  PIC   X(02)   VALUE SPACES.      05000099
050100     05  SL3-MISC-CHRG-AMT       PIC   ----------.99              05010099
050200                                               VALUE ZEROS.       05020099
050300     05  FILLER                  PIC   X(02)   VALUE SPACES.      05030099
050400     05  SL3-NET-COST-B4         PIC   ----------.99              05040099
050500                                               VALUE ZEROS.       05050099
050600     05  FILLER                  PIC   X(02)   VALUE SPACES.      05060099
050700     05  SL3-DISCOUNT            PIC   ----------.99              05070099
050800                                               VALUE ZEROS.       05080099
050900     05  FILLER                  PIC   X(02)   VALUE SPACES.      05090099
051000     05  SL3-NET-COST-AMT        PIC   ----------.99              05100099
051100                                               VALUE ZEROS.       05110099
051200     05  FILLER                  PIC   X(01)   VALUE SPACES.      05120099
051300     05  SL3-RETL-AMT            PIC   ----------.99              05130099
051400                                               VALUE ZEROS.       05140099
051500     05  FILLER                  PIC   X(01)   VALUE SPACES.      05150099
051600                                                                  05160099
051700     EJECT                                                        05170099
051800                                                                  05180099
051900 01  SL4-ALL-ID-ORIGN-SUMMARY-LINE4.                              05190099
052000     05  FILLER                  PIC   X(26)   VALUE SPACES.      05200099
052100     05  FILLER                  PIC   X(50)   VALUE              05210099
052200         'TRANSACTION TOTALS FOR ALL TK ID''S FOR ALL ORIGIN '.   05220099
052300     05  FILLER                  PIC   X(21)   VALUE SPACES.      05230099
052400     05  SL4-GRO-COST-AMT        PIC   ----------.99              05240099
052500                                               VALUE ZEROES.      05250099
052600     05  FILLER                  PIC   X(02)   VALUE SPACES.      05260099
052700     05  SL4-FRGT-AMT            PIC   ----------.99              05270099
052800                                               VALUE ZEROES.      05280099
052900     05  FILLER                  PIC   X(02)   VALUE SPACES.      05290099
053000     05  SL4-MISC-CHRG-AMT       PIC   ----------.99              05300099
053100                                               VALUE ZEROES.      05310099
053200     05  FILLER                  PIC   X(02)   VALUE SPACES.      05320099
053300     05  SL4-NET-COST-B4         PIC   ----------.99              05330099
053400                                               VALUE ZEROES.      05340099
053500     05  FILLER                  PIC   X(02)   VALUE SPACES.      05350099
053600     05  SL4-DISCOUNT            PIC   ----------.99              05360099
053700                                               VALUE ZEROES.      05370099
053800     05  FILLER                  PIC   X(02)   VALUE SPACES.      05380099
053900     05  SL4-NET-COST-AMT        PIC   ----------.99              05390099
054000                                               VALUE ZEROES.      05400099
054100     05  FILLER                  PIC   X(01)   VALUE SPACES.      05410099
054200     05  SL4-RETL-AMT            PIC   ----------.99              05420099
054300                                               VALUE ZEROES.      05430099
054400     05  FILLER                  PIC   X(01)   VALUE SPACES.      05440099
054500                                                                  05450099
054600     EJECT                                                        05460099
054700                                                                  05470099
054800 01  SL5-DOC-NBR-SUMMARY-LINE5.                                   05480099
054900     05  FILLER                  PIC   X(26)   VALUE SPACES.      05490099
055000     05  FILLER                  PIC   X(38)   VALUE              05500099
055100         'TRANSACTION TOTALS FOR DOCUMENT NUMBER'.                05510099
055200     05  FILLER                  PIC   X(01)   VALUE SPACES.      05520099
055300     05  SL5-DOC-NBR             PIC   X(16)   VALUE SPACES.      05530099
055400     05  FILLER                  PIC   X(16)   VALUE SPACES.      05540099
055500     05  SL5-GRO-COST-AMT        PIC   ----------.99              05550099
055600                                               VALUE SPACES.      05560099
055700     05  FILLER                  PIC   X(02)   VALUE SPACES.      05570099
055800     05  SL5-FRGT-AMT            PIC   ----------.99              05580099
055900                                               VALUE ZEROES.      05590099
056000     05  FILLER                  PIC   X(02)   VALUE SPACES.      05600099
056100     05  SL5-MISC-CHRG-AMT       PIC   ----------.99              05610099
056200                                               VALUE ZEROES.      05620099
056300     05  FILLER                  PIC   X(02)   VALUE SPACES.      05630099
056400     05  SL5-NET-COST-B4         PIC   ----------.99              05640099
056500                                               VALUE ZEROES.      05650099
056600     05  FILLER                  PIC   X(02)   VALUE SPACES.      05660099
056700     05  SL5-DISCOUNT            PIC   ----------.99              05670099
056800                                               VALUE ZEROES.      05680099
056900     05  FILLER                  PIC   X(02)   VALUE SPACES.      05690099
057000     05  SL5-NET-COST-AMT        PIC   ----------.99              05700099
057100                                               VALUE ZEROES.      05710099
057200     05  FILLER                  PIC   X(01)   VALUE SPACES.      05720099
057300     05  SL5-RETL-AMT            PIC   ----------.99              05730099
057400                                               VALUE ZEROES.      05740099
057500     05  FILLER                  PIC   X(01)   VALUE SPACES.      05750099
057600                                                                  05760099
057700 EJECT                                                            05770099
057800                                                                  05780099
057900 01  SL6-ALL-ID-ORIGN-SUMMARY-LINE6.                              05790099
058000     05  FILLER                  PIC   X(26)   VALUE SPACES.      05800099
058100     05  FILLER                  PIC   X(50)   VALUE              05810099
058200         'TRANSACTION TOTALS FOR ALL ''KEYED'' ENTRIES       '.   05820099
058300     05  FILLER                  PIC   X(21)   VALUE SPACES.      05830099
058400     05  SL6-GRO-COST-AMT        PIC   ----------.99              05840099
058500                                               VALUE ZEROES.      05850099
058600     05  FILLER                  PIC   X(02)   VALUE SPACES.      05860099
058700     05  SL6-FRGT-AMT            PIC   ----------.99              05870099
058800                                               VALUE ZEROES.      05880099
058900     05  FILLER                  PIC   X(02)   VALUE SPACES.      05890099
059000     05  SL6-MISC-CHRG-AMT       PIC   ----------.99              05900099
059100                                               VALUE ZEROES.      05910099
059200     05  FILLER                  PIC   X(02)   VALUE SPACES.      05920099
059300     05  SL6-NET-COST-B4         PIC   ----------.99              05930099
059400                                               VALUE ZEROES.      05940099
059500     05  FILLER                  PIC   X(02)   VALUE SPACES.      05950099
059600     05  SL6-DISCOUNT            PIC   ----------.99              05960099
059700                                               VALUE ZEROES.      05970099
059800     05  FILLER                  PIC   X(02)   VALUE SPACES.      05980099
059900     05  SL6-NET-COST-AMT        PIC   ----------.99              05990099
060000                                               VALUE ZEROES.      06000099
060100     05  FILLER                  PIC   X(01)   VALUE SPACES.      06010099
060200     05  SL6-RETL-AMT            PIC   ----------.99              06020099
060300                                               VALUE ZEROES.      06030099
060400     05  FILLER                  PIC   X(01)   VALUE SPACES.      06040099
060500                                                                  06050099
060600 EJECT                                                            06060099
060700                                                                  06070099
060800 01  SL7-ALL-ID-ORIGN-SUMMARY-LINE7.                              06080099
060900     05  FILLER                  PIC   X(26)   VALUE SPACES.      06090099
061000     05  FILLER                  PIC   X(50)   VALUE              06100099
061100         'TRANSACTION TOTALS FOR ALL ''INTERFACED'' ENTRIES  '.   06110099
061200     05  FILLER                  PIC   X(21)   VALUE SPACES.      06120099
061300     05  SL7-GRO-COST-AMT        PIC   ----------.99              06130099
061400                                               VALUE ZEROES.      06140099
061500     05  FILLER                  PIC   X(02)   VALUE SPACES.      06150099
061600     05  SL7-FRGT-AMT            PIC   ----------.99              06160099
061700                                               VALUE ZEROES.      06170099
061800     05  FILLER                  PIC   X(02)   VALUE SPACES.      06180099
061900     05  SL7-MISC-CHRG-AMT       PIC   ----------.99              06190099
062000                                               VALUE ZEROES.      06200099
062100     05  FILLER                  PIC   X(02)   VALUE SPACES.      06210099
062200     05  SL7-NET-COST-B4         PIC   ----------.99              06220099
062300                                               VALUE ZEROES.      06230099
062400     05  FILLER                  PIC   X(02)   VALUE SPACES.      06240099
062500     05  SL7-DISCOUNT            PIC   ----------.99              06250099
062600                                               VALUE ZEROES.      06260099
062700     05  FILLER                  PIC   X(02)   VALUE SPACES.      06270099
062800     05  SL7-NET-COST-AMT        PIC   ----------.99              06280099
062900                                               VALUE ZEROES.      06290099
063000     05  FILLER                  PIC   X(01)   VALUE SPACES.      06300099
063100     05  SL7-RETL-AMT            PIC   ----------.99              06310099
063200                                               VALUE ZEROES.      06320099
063300     05  FILLER                  PIC   X(01)   VALUE SPACES.      06330099
063400                                                                  06340099
063500 EJECT                                                            06350099
063600                                                                  06360099
063700*----------------------------------------------------------------*06370099
063800*  ABEND DATA AREAS                                              *06380099
063900*----------------------------------------------------------------*06390099
064000 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          06400099
064100                                             COMP SYNC.           06410099
064200     88  AC-BAD-DATA                         VALUE +4003.         06420099
064300     88  AC-DB2-ERROR                        VALUE +4013.         06430099
064400                                                                  06440099
064500     88  AC-DATE-ERROR                       VALUE +4019.         06450099
064600                                                                  06460099
064700 01  ABEND-AREAS.                                                 06470099
064800     05  AA-ABEND-LIT            PIC  X(40)  VALUE                06480099
064900             '*****       ABEND'.                                 06490099
065000     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                06500099
065100             '*****   PROGRAM: APKRP146'.                         06510099
065200     05  AA-PARAGRAPH-LIT.                                        06520099
065300         10  FILLER              PIC  X(17)  VALUE                06530099
065400             '***** PARAGRAPH: '.                                 06540099
065500         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        06550099
065600     05  AA-MESSAGE-LINE.                                         06560099
065700         10  FILLER              PIC  X(06)  VALUE '*****'.       06570099
065800         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        06580099
065900                                                                  06590099
066000     EJECT                                                        06600099
066100                                                                  06610099
066200*----------------------------------------------------------------*06620099
066300*  ABEND DATA SQLCA                                              *06630099
066400*----------------------------------------------------------------*06640099
066500                                                                  06650099
066600     COPY DPWS004.                                                06660099
066700                                                                  06670099
066800 01  FILLER                      PIC  X(25)  VALUE                06680099
066900     '** END OF APKRP146 W/S **'.                                 06690099
067000                                                                  06700099
067100 EJECT                                                            06710099
067200                                                                  06720099
067300 PROCEDURE DIVISION.                                              06730099
067400                                                                  06740099
067500 A100-MAIN.                                                       06750099
067600                                                                  06760099
067700     MOVE 'A100-MAIN' TO PV-CURRENT-PARAGRAPH.                    06770099
067800                                                                  06780099
067900     PERFORM B100-INITIALIZE.                                     06790099
068000                                                                  06800099
068100     PERFORM B200-PROCESS-INFO                                    06810099
068200         UNTIL END-OF-INVOICES.                                   06820099
068300                                                                  06830099
068400     PERFORM B300-END-PROGRAM.                                    06840099
068500                                                                  06850099
068600     GOBACK.                                                      06860099
068700                                                                  06870099
068800 EJECT                                                            06880099
068900                                                                  06890099
069000*                                                                 06900099
069100*----------------------------------------------------------------*06910099
069200*    INITIALIZATION PROCESSING                                   *06920099
069300*    CALLED FROM A100-MAIN                                       *06930099
069400*----------------------------------------------------------------*06940099
069500*                                                                 06950099
069600 B100-INITIALIZE.                                                 06960099
069700                                                                  06970099
069800     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              06980099
069900                                                                  06990099
070000     OPEN INPUT  DAILY-DOC-EXTRCT-FILE                            07000099
070100          OUTPUT DAILY-TERMINAL-BAL-FILE.                         07010099
070200                                                                  07020099
070300     ACCEPT PV-CURRENT-DATE FROM DATE.                            07030099
070400     MOVE PV-CURRENT-MONTH            TO DP200O-RUN-MONTH.        07040099
070500     MOVE PV-CURRENT-DAY              TO DP200O-RUN-DAY.          07050099
070600     MOVE PV-CURRENT-YEAR             TO DP200O-RUN-YEAR.         07060099
070700                                                                  07070099
070800     ACCEPT PV-CURRENT-TIME FROM TIME.                            07080099
070900     MOVE PV-CURRENT-HOUR             TO DP200O-RUN-HOUR.         07090099
071000     MOVE PV-CURRENT-MINUTE           TO DP200O-RUN-MINUTE.       07100099
071100     MOVE PC-PROGRAM-NAME             TO DP200O-PROGRAM-NAME.     07110099
071200     MOVE 1                           TO DP200O-REPORT-NUMBER.    07120099
071300                                                                  07130099
071400     MOVE PV-CURRENT-MONTH            TO H3-MONTH.                07140099
071500     MOVE PV-CURRENT-DAY              TO H3-DAY.                  07150099
071600     MOVE PV-CURRENT-YEAR             TO H3-YEAR.                 07160099
071700                                                                  07170099
071800     PERFORM W100-WRITE-HEADERS.                                  07180099
071900     PERFORM W200-WRITE-DETAIL-HEADERS.                           07190099
072000                                                                  07200099
072100     PERFORM R100-READ-DAILY-DOC-XTRCT-FILE.                      07210099
072200     MOVE AP070-ENTR-ID TO PV-HOLD-ENTR-ID.                       07220099
072300     MOVE AP070-ORIGIN  TO PV-HOLD-ORIGIN.                        07230099
072400     MOVE AP070-DOC-NBR TO PV-HOLD-DOC-NBR.                       07240099
072500                                                                  07250099
072600     IF END-OF-INVOICES                                           07260099
072700        PERFORM W300-WRITE-EMPTY-INPUT-FILE                       07270099
072800        SET EMPTY-SW TO TRUE                                      07280099
072900     END-IF.                                                      07290099
073000                                                                  07300099
073100 EJECT                                                            07310099
073200                                                                  07320099
073300*                                                                 07330099
073400*----------------------------------------------------------------*07340099
073500*    PROCESSES THE INFORMATION RECEIVED FROM THE INPUT FILE.     *07350099
073600*----------------------------------------------------------------*07360099
073700*                                                                 07370099
073800 B200-PROCESS-INFO.                                               07380099
073900                                                                  07390099
074000     MOVE 'B200-PROCESS-INFO' TO PV-CURRENT-PARAGRAPH.            07400099
074100                                                                  07410099
074200** FOLLOWING IF LOGIC WAS ADDED TO ONLY PRINT DE            TAIL L07420099
074300** FOR USER ENTERED TRANSACTIONS.                                 07430099
074400     IF DL-TKID (1:2) = 'TK' OR 'TC' OR 'TV'                      07440099
074500        PERFORM C300-CHECK-DOC-NBR                                07450099
074600     END-IF.                                                      07460099
074700                                                                  07470099
074800     IF AP070-ENTR-ID  = PV-HOLD-ENTR-ID AND                      07480099
074900             AP070-ORIGIN NOT = PV-HOLD-ORIGIN                    07490099
075000        MOVE PV-HOLD-ENTR-ID   TO SL1-ENTR-ID                     07500099
075100        MOVE PV-HOLD-ORIGIN    TO SL1-ORIGIN                      07510099
075200        MOVE OR-GRO-COST-AMT   TO SL1-GRO-COST-AMT                07520099
075300        MOVE OR-DISCOUNT       TO SL1-DISCOUNT                    07530099
075400        MOVE OR-FRGT-AMT       TO SL1-FRGT-AMT                    07540099
075500        MOVE OR-MISC-CHRG-AMT  TO SL1-MISC-CHRG-AMT               07550099
075600        MOVE OR-NET-COST-B4    TO SL1-NET-COST-B4                 07560099
075700        MOVE OR-NET-COST-AMT   TO SL1-NET-COST-AMT                07570099
075800        MOVE OR-RETL-AMT       TO SL1-RETL-AMT                    07580099
075900                                                                  07590099
076000        PERFORM W400-WRITE-ORIGIN-SUMMARY-LINE                    07600099
076100        PERFORM C100-SEARCH-ORIGIN-TABLE                          07610099
076200                                                                  07620099
076300        MOVE ZEROS TO OR-GRO-COST-AMT                             07630099
076400        MOVE ZEROS TO OR-DISCOUNT                                 07640099
076500        MOVE ZEROS TO OR-FRGT-AMT                                 07650099
076600        MOVE ZEROS TO OR-MISC-CHRG-AMT                            07660099
076700        MOVE ZEROS TO OR-NET-COST-B4                              07670099
076800        MOVE ZEROS TO OR-NET-COST-AMT                             07680099
076900        MOVE ZEROS TO OR-RETL-AMT                                 07690099
077000     END-IF.                                                      07700099
077100                                                                  07710099
077200     IF AP070-ENTR-ID NOT = PV-HOLD-ENTR-ID                       07720099
077300        MOVE PV-HOLD-ENTR-ID   TO SL1-ENTR-ID                     07730099
077400        MOVE PV-HOLD-ORIGIN    TO SL1-ORIGIN                      07740099
077500        MOVE OR-GRO-COST-AMT   TO SL1-GRO-COST-AMT                07750099
077600        MOVE OR-DISCOUNT       TO SL1-DISCOUNT                    07760099
077700        MOVE OR-FRGT-AMT       TO SL1-FRGT-AMT                    07770099
077800        MOVE OR-MISC-CHRG-AMT  TO SL1-MISC-CHRG-AMT               07780099
077900        MOVE OR-NET-COST-B4    TO SL1-NET-COST-B4                 07790099
078000        MOVE OR-NET-COST-AMT   TO SL1-NET-COST-AMT                07800099
078100        MOVE OR-RETL-AMT       TO SL1-RETL-AMT                    07810099
078200                                                                  07820099
078300        MOVE PV-HOLD-ENTR-ID   TO SL2-ENTR-ID                     07830099
078400        MOVE TK-GRO-COST-AMT   TO SL2-GRO-COST-AMT                07840099
078500        MOVE TK-DISCOUNT       TO SL2-DISCOUNT                    07850099
078600        MOVE TK-FRGT-AMT       TO SL2-FRGT-AMT                    07860099
078700        MOVE TK-MISC-CHRG-AMT  TO SL2-MISC-CHRG-AMT               07870099
078800        MOVE TK-NET-COST-B4    TO SL2-NET-COST-B4                 07880099
078900        MOVE TK-NET-COST-AMT   TO SL2-NET-COST-AMT                07890099
079000        MOVE TK-RETL-AMT       TO SL2-RETL-AMT                    07900099
079100                                                                  07910099
079200        PERFORM W400-WRITE-ORIGIN-SUMMARY-LINE                    07920099
079300        PERFORM C100-SEARCH-ORIGIN-TABLE                          07930099
079400        PERFORM W500-WRITE-TKID-SUMMARY-LINE                      07940099
079500                                                                  07950099
079600        MOVE ZEROS TO OR-GRO-COST-AMT                             07960099
079700        MOVE ZEROS TO OR-DISCOUNT                                 07970099
079800        MOVE ZEROS TO OR-FRGT-AMT                                 07980099
079900        MOVE ZEROS TO OR-MISC-CHRG-AMT                            07990099
080000        MOVE ZEROS TO OR-NET-COST-B4                              08000099
080100        MOVE ZEROS TO OR-NET-COST-AMT                             08010099
080200        MOVE ZEROS TO OR-RETL-AMT                                 08020099
080300                                                                  08030099
080400        MOVE ZEROS TO TK-GRO-COST-AMT                             08040099
080500        MOVE ZEROS TO TK-DISCOUNT                                 08050099
080600        MOVE ZEROS TO TK-FRGT-AMT                                 08060099
080700        MOVE ZEROS TO TK-MISC-CHRG-AMT                            08070099
080800        MOVE ZEROS TO TK-NET-COST-B4                              08080099
080900        MOVE ZEROS TO TK-NET-COST-AMT                             08090099
081000        MOVE ZEROS TO TK-RETL-AMT                                 08100099
081100     END-IF.                                                      08110099
081200                                                                  08120099
081300     MOVE AP070-ENTR-ID         TO DL-TKID.                       08130099
081400     MOVE AP070-ENTR-ID         TO PV-HOLD-ENTR-ID.               08140099
081500     MOVE AP070-ORIGIN          TO DL-ORIGIN.                     08150099
081600     MOVE AP070-ORIGIN          TO PV-HOLD-ORIGIN.                08160099
081700                                                                  08170099
081800     IF AP070-PS-PO-ID = SPACES                                   08180099
081900        MOVE AP070-PO-NBR       TO DL-PO-NBR                      08190099
082000     ELSE                                                         08200099
082100        MOVE AP070-PS-PO-ID     TO DL-PO-NBR                      08210099
082200     END-IF.                                                      08220099
082300                                                                  08230099
082400     MOVE AP070-DOC-NBR         TO DL-DOC-NBR.                    08240099
082500     MOVE AP070-DOC-NBR         TO PV-HOLD-DOC-NBR.               08250099
082600     MOVE AP070-ENTR-CC         TO PV-ENTR-CC.                    08260099
082700     MOVE AP070-ENTR-YY         TO PV-ENTR-YY.                    08270099
082800     MOVE AP070-ENTR-MM         TO PV-ENTR-MM.                    08280099
082900     MOVE AP070-ENTR-DD         TO PV-ENTR-DD.                    08290099
083000     MOVE PV-ENTR-DATE          TO DL-ENTRY-DTE.                  08300099
083100     MOVE AP070-VND-NBR         TO DL-VND-NBR.                    08310099
083200     MOVE AP070-ENT-NME-DESC    TO DL-ENT-NME-DESC.               08320099
083300     IF AP070-DEPT-NBR = SPACES                                   08330099
083400        MOVE AP070-GL-ACCT-NBR  TO DL-DEPT-NBR                    08340099
083500     ELSE                                                         08350099
083600        MOVE AP070-DEPT-NBR     TO DL-DEPT-NBR                    08360099
083700     END-IF.                                                      08370099
083800     MOVE AP070-GRO-COST-AMT    TO DL-GRO-COST-AMT.               08380099
083900     MOVE AP070-TOTAL-DISC-AMT  TO DL-DISCOUNT.                   08390099
084000     MOVE AP070-FRGT-AMT        TO DL-FRGT-AMT.                   08400099
084100     MOVE AP070-MISC-CHRG-AMT   TO DL-MISC-CHRG-AMT.              08410099
084200     ADD AP070-GRO-COST-AMT                                       08420099
084300         AP070-FRGT-AMT                                           08430099
084400         AP070-MISC-CHRG-AMT    GIVING PV-NET-COST-B4.            08440099
084500     MOVE PV-NET-COST-B4        TO DL-NET-COST-B4.                08450099
084600     MOVE AP070-NET-COST-AMT    TO DL-NET-COST-AMT.               08460099
084700     MOVE AP070-RETL-AMT        TO DL-RETL-AMT.                   08470099
084800                                                                  08480099
084900     MOVE AP070-ORIGIN          TO  OR-ORIGIN.                    08490099
085000     MOVE AP070-ENTR-ID         TO  OR-ENTR-ID.                   08500099
085100     ADD AP070-GRO-COST-AMT     TO  OR-GRO-COST-AMT.              08510099
085200     ADD AP070-TOTAL-DISC-AMT   TO  OR-DISCOUNT.                  08520099
085300     ADD AP070-FRGT-AMT         TO  OR-FRGT-AMT.                  08530099
085400     ADD AP070-MISC-CHRG-AMT    TO  OR-MISC-CHRG-AMT.             08540099
085500     ADD AP070-GRO-COST-AMT                                       08550099
085600         AP070-FRGT-AMT                                           08560099
085700         AP070-MISC-CHRG-AMT GIVING PV-OR-NET-COST-B4.            08570099
085800     ADD PV-OR-NET-COST-B4      TO  OR-NET-COST-B4.               08580099
085900     ADD AP070-NET-COST-AMT     TO  OR-NET-COST-AMT.              08590099
086000     ADD AP070-RETL-AMT         TO  OR-RETL-AMT.                  08600099
086100                                                                  08610099
086200     ADD AP070-GRO-COST-AMT     TO  TK-GRO-COST-AMT.              08620099
086300     ADD AP070-TOTAL-DISC-AMT   TO  TK-DISCOUNT.                  08630099
086400     ADD AP070-FRGT-AMT         TO  TK-FRGT-AMT.                  08640099
086500     ADD AP070-MISC-CHRG-AMT    TO  TK-MISC-CHRG-AMT.             08650099
086600     ADD AP070-GRO-COST-AMT                                       08660099
086700         AP070-FRGT-AMT                                           08670099
086800         AP070-MISC-CHRG-AMT GIVING PV-TK-NET-COST-B4.            08680099
086900     ADD PV-TK-NET-COST-B4      TO  TK-NET-COST-B4.               08690099
087000     ADD AP070-NET-COST-AMT     TO  TK-NET-COST-AMT.              08700099
087100     ADD AP070-RETL-AMT         TO  TK-RETL-AMT.                  08710099
087200                                                                  08720099
087300** FOLLOWING IF LOGIC WAS ADDED TO ONLY PRINT DETAIL LINE         08730099
087400** FOR USER ENTERED TRANSACTIONS.                                 08740099
087500     IF DL-TKID (1:2) = 'TK' OR 'TC' OR 'TV'                      08750099
087600        PERFORM W800-WRITE-DETAIL-LINE                            08760099
087700     END-IF.                                                      08770099
087800     PERFORM R100-READ-DAILY-DOC-XTRCT-FILE.                      08780099
087900                                                                  08790099
088000 EJECT                                                            08800099
088100*                                                                 08810099
088200*----------------------------------------------------------------*08820099
088300*    ENDING PROCESSING: DISPLAYS COUNT OF IMPORTS AND CLOSES     *08830099
088400*    THE CURSOR AND FILES.                                       *08840099
088500*----------------------------------------------------------------*08850099
088600*                                                                 08860099
088700 B300-END-PROGRAM.                                                08870099
088800                                                                  08880099
088900     MOVE 'B300-END-PROGRAM' TO PV-CURRENT-PARAGRAPH.             08890099
089000                                                                  08900099
089100     IF EMPTY-SW                                                  08910099
089200        CONTINUE                                                  08920099
089300     ELSE                                                         08930099
089400        IF NOT-EMPTY-SW                                           08940099
089500           IF END-OF-INVOICES                                     08950099
089600              MOVE PV-HOLD-ENTR-ID   TO SL1-ENTR-ID               08960099
089700              MOVE PV-HOLD-ORIGIN    TO SL1-ORIGIN                08970099
089800              MOVE OR-GRO-COST-AMT   TO SL1-GRO-COST-AMT          08980099
089900              MOVE OR-DISCOUNT       TO SL1-DISCOUNT              08990099
090000              MOVE OR-FRGT-AMT       TO SL1-FRGT-AMT              09000099
090100              MOVE OR-MISC-CHRG-AMT  TO SL1-MISC-CHRG-AMT         09010099
090200              MOVE OR-NET-COST-B4    TO SL1-NET-COST-B4           09020099
090300              MOVE OR-NET-COST-AMT   TO SL1-NET-COST-AMT          09030099
090400              MOVE OR-RETL-AMT       TO SL1-RETL-AMT              09040099
090500                                                                  09050099
090600              MOVE PV-HOLD-ENTR-ID   TO SL2-ENTR-ID               09060099
090700              MOVE TK-GRO-COST-AMT   TO SL2-GRO-COST-AMT          09070099
090800              MOVE TK-DISCOUNT       TO SL2-DISCOUNT              09080099
090900              MOVE TK-FRGT-AMT       TO SL2-FRGT-AMT              09090099
091000              MOVE TK-MISC-CHRG-AMT  TO SL2-MISC-CHRG-AMT         09100099
091100              MOVE TK-NET-COST-B4    TO SL2-NET-COST-B4           09110099
091200              MOVE TK-NET-COST-AMT   TO SL2-NET-COST-AMT          09120099
091300              MOVE TK-RETL-AMT       TO SL2-RETL-AMT              09130099
091400                                                                  09140099
091500              PERFORM W400-WRITE-ORIGIN-SUMMARY-LINE              09150099
091600              PERFORM C100-SEARCH-ORIGIN-TABLE                    09160099
091700              PERFORM W500-WRITE-TKID-SUMMARY-LINE                09170099
091800           END-IF                                                 09180099
091900                                                                  09190099
092000           PERFORM C200-PROCESS-TABLE-TOTALS                      09200099
092100                                                                  09210099
092200           MOVE PV-HOLD-KEYED-GRO-COST-AMT   TO SL6-GRO-COST-AMT  09220099
092300           MOVE PV-HOLD-KEYED-DISCOUNT       TO SL6-DISCOUNT      09230099
092400           MOVE PV-HOLD-KEYED-FRGT-AMT       TO SL6-FRGT-AMT      09240099
092500           MOVE PV-HOLD-KEYED-MISC-CHRG-AMT  TO SL6-MISC-CHRG-AMT 09250099
092600           MOVE PV-HOLD-KEYED-NET-COST-B4    TO SL6-NET-COST-B4   09260099
092700           MOVE PV-HOLD-KEYED-NET-COST-AMT   TO SL6-NET-COST-AMT  09270099
092800           MOVE PV-HOLD-KEYED-RETL-AMT       TO SL6-RETL-AMT      09280099
092900                                                                  09290099
093000           PERFORM W720-WRITE-KEYED-TOTALS                        09300099
093100                                                                  09310099
093200           MOVE PV-HOLD-INTFC-GRO-COST-AMT   TO SL7-GRO-COST-AMT  09320099
093300           MOVE PV-HOLD-INTFC-DISCOUNT       TO SL7-DISCOUNT      09330099
093400           MOVE PV-HOLD-INTFC-FRGT-AMT       TO SL7-FRGT-AMT      09340099
093500           MOVE PV-HOLD-INTFC-MISC-CHRG-AMT  TO SL7-MISC-CHRG-AMT 09350099
093600           MOVE PV-HOLD-INTFC-NET-COST-B4    TO SL7-NET-COST-B4   09360099
093700           MOVE PV-HOLD-INTFC-NET-COST-AMT   TO SL7-NET-COST-AMT  09370099
093800           MOVE PV-HOLD-INTFC-RETL-AMT       TO SL7-RETL-AMT      09380099
093900                                                                  09390099
094000           PERFORM W740-WRITE-INTFC-TOTALS                        09400099
094100                                                                  09410099
094200           MOVE PV-HOLD-GRAND-GRO-COST-AMT   TO SL4-GRO-COST-AMT  09420099
094300           MOVE PV-HOLD-GRAND-DISCOUNT       TO SL4-DISCOUNT      09430099
094400           MOVE PV-HOLD-GRAND-FRGT-AMT       TO SL4-FRGT-AMT      09440099
094500           MOVE PV-HOLD-GRAND-MISC-CHRG-AMT  TO SL4-MISC-CHRG-AMT 09450099
094600           MOVE PV-HOLD-GRAND-NET-COST-B4    TO SL4-NET-COST-B4   09460099
094700           MOVE PV-HOLD-GRAND-NET-COST-AMT   TO SL4-NET-COST-AMT  09470099
094800           MOVE PV-HOLD-GRAND-RETL-AMT       TO SL4-RETL-AMT      09480099
094900                                                                  09490099
095000           PERFORM W700-WRITE-GRAND-TOTALS                        09500099
095100        END-IF                                                    09510099
095200     END-IF.                                                      09520099
095300                                                                  09530099
095400     DISPLAY '**********************************************'     09540099
095500     DISPLAY 'PROGRAM NAME = APKRP146'                            09550099
095600     DISPLAY 'INPUTS PROCESSED  = ' PC-READ-COUNTER.              09560099
095700     DISPLAY '**********************************************'     09570099
095800                                                                  09580099
095900     CLOSE DAILY-DOC-EXTRCT-FILE                                  09590099
096000           DAILY-TERMINAL-BAL-FILE.                               09600099
096100                                                                  09610099
096200     EJECT                                                        09620099
096300                                                                  09630099
096400*                                                                 09640099
096500*----------------------------------------------------------------*09650099
096600*  SEARCH ORIGIN TABLE.                                           09660099
096700*----------------------------------------------------------------*09670099
096800*                                                                 09680099
096900 C100-SEARCH-ORIGIN-TABLE.                                        09690099
097000                                                                  09700099
097100     MOVE 'C100-SEARCH-ORIGIN-TABLE' TO PV-CURRENT-PARAGRAPH.     09710099
097200                                                                  09720099
097300     SET OT-IND TO 1.                                             09730099
097400     SEARCH OT-ORIGIN                                             09740099
097500          AT END DISPLAY 'THERE ARE MORE THAN 999 ORIGINS'        09750099
097600        WHEN OT-ORIGIN-ID (OT-IND) = PV-HOLD-ORIGIN               09760099
097700           ADD OR-GRO-COST-AMT   TO OT-GRO-COST-AMT (OT-IND)      09770099
097800           ADD OR-DISCOUNT       TO OT-DISCOUNT (OT-IND)          09780099
097900           ADD OR-FRGT-AMT       TO OT-FRGT-AMT (OT-IND)          09790099
098000           ADD OR-MISC-CHRG-AMT  TO OT-MISC-CHRG-AMT (OT-IND)     09800099
098100           ADD OR-NET-COST-B4    TO OT-NET-COST-B4 (OT-IND)       09810099
098200           ADD OR-NET-COST-AMT   TO OT-NET-COST-AMT (OT-IND)      09820099
098300           ADD OR-RETL-AMT       TO OT-RETL-AMT (OT-IND)          09830099
098400        WHEN OT-ORIGIN-ID (OT-IND) = SPACES                       09840099
098500           ADD 1 TO TABLE-SIZE-COUNTER                            09850099
098600           MOVE OR-ORIGIN        TO OT-ORIGIN-ID (OT-IND)         09860099
098700           MOVE OR-ENTR-ID       TO OT-ENTR-ID (OT-IND)           09870099
098800           MOVE OR-GRO-COST-AMT  TO OT-GRO-COST-AMT (OT-IND)      09880099
098900           MOVE OR-DISCOUNT      TO OT-DISCOUNT (OT-IND)          09890099
099000           MOVE OR-FRGT-AMT      TO OT-FRGT-AMT (OT-IND)          09900099
099100           MOVE OR-MISC-CHRG-AMT TO OT-MISC-CHRG-AMT (OT-IND)     09910099
099200           MOVE OR-NET-COST-B4  TO OT-NET-COST-B4 (OT-IND)        09920099
099300           MOVE OR-NET-COST-AMT TO OT-NET-COST-AMT (OT-IND)       09930099
099400           MOVE OR-RETL-AMT     TO OT-RETL-AMT (OT-IND).          09940099
099500                                                                  09950099
099600     EJECT                                                        09960099
099700                                                                  09970099
099800*                                                                 09980099
099900*----------------------------------------------------------------*09990099
100000*  GET TOTALS FOR EACH ORIGIN IN THE ORIGIN TABLE.                10000099
100100*----------------------------------------------------------------*10010099
100200*                                                                 10020099
100300 C200-PROCESS-TABLE-TOTALS.                                       10030099
100400                                                                  10040099
100500     MOVE 'C200-PROCESS-TABLE-TOTALS' TO PV-CURRENT-PARAGRAPH.    10050099
100600                                                                  10060099
100700     SET OT-IND TO 1.                                             10070099
100800                                                                  10080099
100900     PERFORM UNTIL OT-IND = TABLE-SIZE-COUNTER + 1                10090099
101000        MOVE OT-ORIGIN-ID (OT-IND)       TO SL3-ORIGIN            10100099
101100        MOVE OT-GRO-COST-AMT (OT-IND)    TO SL3-GRO-COST-AMT      10110099
101200        MOVE OT-DISCOUNT     (OT-IND)    TO SL3-DISCOUNT          10120099
101300        MOVE OT-FRGT-AMT (OT-IND)        TO SL3-FRGT-AMT          10130099
101400        MOVE OT-MISC-CHRG-AMT (OT-IND)   TO SL3-MISC-CHRG-AMT     10140099
101500        MOVE OT-NET-COST-B4 (OT-IND)     TO SL3-NET-COST-B4       10150099
101600        MOVE OT-NET-COST-AMT (OT-IND)    TO SL3-NET-COST-AMT      10160099
101700        MOVE OT-RETL-AMT (OT-IND)        TO SL3-RETL-AMT          10170099
101800                                                                  10180099
101900        ADD  OT-GRO-COST-AMT (OT-IND)    TO                       10190099
102000                                  PV-HOLD-GRAND-GRO-COST-AMT      10200099
102100        ADD  OT-DISCOUNT (OT-IND)        TO                       10210099
102200                                  PV-HOLD-GRAND-DISCOUNT          10220099
102300        ADD  OT-FRGT-AMT (OT-IND)        TO                       10230099
102400                                  PV-HOLD-GRAND-FRGT-AMT          10240099
102500        ADD  OT-MISC-CHRG-AMT (OT-IND)   TO                       10250099
102600                                  PV-HOLD-GRAND-MISC-CHRG-AMT     10260099
102700        ADD  OT-NET-COST-B4 (OT-IND)     TO                       10270099
102800                                  PV-HOLD-GRAND-NET-COST-B4       10280099
102900        ADD  OT-NET-COST-AMT (OT-IND)    TO                       10290099
103000                                  PV-HOLD-GRAND-NET-COST-AMT      10300099
103100        ADD  OT-RETL-AMT (OT-IND)        TO                       10310099
103200                                  PV-HOLD-GRAND-RETL-AMT          10320099
103300** NEXT IF LOGIC WAS ADDED TO ACCUMULATE TOTALS FOR SUB           10330099
103400** TOTALING FOR ONLINE ENTRIES AND INTERFACED ENTRIES.            10340099
103500*       IF OT-ORIGIN-ID (OT-IND) = 'ONL'                          10350099
103600        IF OT-ENTR-ID (OT-IND) (1:2) = 'TK' OR 'TC' OR 'TV'       10360099
103700           ADD OT-GRO-COST-AMT (OT-IND)  TO                       10370099
103800                                     PV-HOLD-KEYED-GRO-COST-AMT   10380099
103900           ADD OT-DISCOUNT (OT-IND)      TO                       10390099
104000                                     PV-HOLD-KEYED-DISCOUNT       10400099
104100           ADD OT-FRGT-AMT (OT-IND)      TO                       10410099
104200                                     PV-HOLD-KEYED-FRGT-AMT       10420099
104300           ADD OT-MISC-CHRG-AMT (OT-IND) TO                       10430099
104400                                     PV-HOLD-KEYED-MISC-CHRG-AMT  10440099
104500           ADD OT-NET-COST-B4 (OT-IND)   TO                       10450099
104600                                     PV-HOLD-KEYED-NET-COST-B4    10460099
104700           ADD OT-NET-COST-AMT (OT-IND)  TO                       10470099
104800                                     PV-HOLD-KEYED-NET-COST-AMT   10480099
104900           ADD OT-RETL-AMT (OT-IND)      TO                       10490099
105000                                     PV-HOLD-KEYED-RETL-AMT       10500099
105100        ELSE                                                      10510099
105200           ADD OT-GRO-COST-AMT (OT-IND)  TO                       10520099
105300                                     PV-HOLD-INTFC-GRO-COST-AMT   10530099
105400           ADD OT-DISCOUNT (OT-IND)      TO                       10540099
105500                                     PV-HOLD-INTFC-DISCOUNT       10550099
105600           ADD OT-FRGT-AMT (OT-IND)      TO                       10560099
105700                                     PV-HOLD-INTFC-FRGT-AMT       10570099
105800           ADD OT-MISC-CHRG-AMT (OT-IND) TO                       10580099
105900                                     PV-HOLD-INTFC-MISC-CHRG-AMT  10590099
106000           ADD OT-NET-COST-B4 (OT-IND)   TO                       10600099
106100                                     PV-HOLD-INTFC-NET-COST-B4    10610099
106200           ADD OT-NET-COST-AMT (OT-IND)  TO                       10620099
106300                                     PV-HOLD-INTFC-NET-COST-AMT   10630099
106400           ADD OT-RETL-AMT (OT-IND)      TO                       10640099
106500                                     PV-HOLD-INTFC-RETL-AMT       10650099
106600        END-IF                                                    10660099
106700                                                                  10670099
106800        SET OT-IND UP BY 1                                        10680099
106900                                                                  10690099
107000        PERFORM W600-WRITE-TOTALS                                 10700099
107100     END-PERFORM.                                                 10710099
107200                                                                  10720099
107300     EJECT                                                        10730099
107400                                                                  10740099
107500*                                                                 10750099
107600*----------------------------------------------------------------*10760099
107700*  GET TOTALS FOR EACH ORIGIN IN THE ORIGIN TABLE.                10770099
107800*----------------------------------------------------------------*10780099
107900*                                                                 10790099
108000 C300-CHECK-DOC-NBR.                                              10800099
108100                                                                  10810099
108200     MOVE 'C300-CHECK-DOC-NBR' TO PV-CURRENT-PARAGRAPH.           10820099
108300                                                                  10830099
108400     IF AP070-DOC-NBR = PV-HOLD-DOC-NBR                           10840099
108500        ADD AP070-GRO-COST-AMT    TO PV-HOLD-DOC-GRO-COST-AMT     10850099
108600        ADD AP070-TOTAL-DISC-AMT  TO PV-HOLD-DISCOUNT             10860099
108700        ADD AP070-FRGT-AMT        TO PV-HOLD-DOC-FRGT-AMT         10870099
108800        ADD AP070-MISC-CHRG-AMT   TO PV-HOLD-DOC-MISC-CHRG-AMT    10880099
108900        ADD AP070-GRO-COST-AMT                                    10890099
109000            AP070-FRGT-AMT                                        10900099
109100            AP070-MISC-CHRG-AMT   TO PV-HOLD-DOC-NET-COST-B4      10910099
109200        ADD AP070-NET-COST-AMT    TO PV-HOLD-DOC-NET-COST-AMT     10920099
109300        ADD AP070-RETL-AMT        TO PV-HOLD-DOC-RETL-AMT         10930099
109400        ADD 1                     TO PC-DOC-COUNT                 10940099
109500     ELSE                                                         10950099
109600        IF PC-DOC-COUNT >= 2                                      10960099
109700           MOVE PV-HOLD-DOC-NBR            TO SL5-DOC-NBR         10970099
109800           MOVE PV-HOLD-DOC-GRO-COST-AMT   TO SL5-GRO-COST-AMT    10980099
109900           MOVE PV-HOLD-DISCOUNT           TO SL5-DISCOUNT        10990099
110000           MOVE PV-HOLD-DOC-FRGT-AMT       TO SL5-FRGT-AMT        11000099
110100           MOVE PV-HOLD-DOC-MISC-CHRG-AMT  TO SL5-MISC-CHRG-AMT   11010099
110200           MOVE PV-HOLD-DOC-NET-COST-B4    TO SL5-NET-COST-B4     11020099
110300           MOVE PV-HOLD-DOC-NET-COST-AMT   TO SL5-NET-COST-AMT    11030099
110400           MOVE PV-HOLD-DOC-RETL-AMT       TO SL5-RETL-AMT        11040099
110500                                                                  11050099
110600           PERFORM W900-WRITE-DOC-NBR-SUM-LINE                    11060099
110700           MOVE 0  TO PC-DOC-COUNT                                11070099
110800        ELSE                                                      11080099
110900           IF (PC-DOC-COUNT = 1) AND                              11090099
111000                    (AP070-DOC-NBR NOT = PV-HOLD-DOC-NBR)         11100099
111100              WRITE DAILY-TERMINAL-BAL-REC FROM SP-SPACE-LINE     11110099
111200              ADD 1  TO PC-LINE-COUNT                             11120099
111300           END-IF                                                 11130099
111400        END-IF                                                    11140099
111500                                                                  11150099
111600        MOVE ZEROS TO PV-HOLD-DOC-GRO-COST-AMT                    11160099
111700        MOVE ZEROS TO PV-HOLD-DISCOUNT                            11170099
111800        MOVE ZEROS TO PV-HOLD-DOC-FRGT-AMT                        11180099
111900        MOVE ZEROS TO PV-HOLD-DOC-MISC-CHRG-AMT                   11190099
112000        MOVE ZEROS TO PV-HOLD-DOC-NET-COST-B4                     11200099
112100        MOVE ZEROS TO PV-HOLD-DOC-NET-COST-AMT                    11210099
112200        MOVE ZEROS TO PV-HOLD-DOC-RETL-AMT                        11220099
112300        MOVE ZEROS TO PC-DOC-COUNT                                11230099
112400                                                                  11240099
112500        ADD AP070-GRO-COST-AMT      TO PV-HOLD-DOC-GRO-COST-AMT   11250099
112600        ADD AP070-TOTAL-DISC-AMT    TO PV-HOLD-DISCOUNT           11260099
112700        ADD AP070-FRGT-AMT          TO PV-HOLD-DOC-FRGT-AMT       11270099
112800        ADD AP070-MISC-CHRG-AMT     TO PV-HOLD-DOC-MISC-CHRG-AMT  11280099
112900        ADD AP070-GRO-COST-AMT                                    11290099
113000            AP070-FRGT-AMT                                        11300099
113100            AP070-MISC-CHRG-AMT GIVING PV-HOLD-DOC-NET-COST-B4    11310099
113200        ADD AP070-NET-COST-AMT      TO PV-HOLD-DOC-NET-COST-AMT   11320099
113300        ADD AP070-RETL-AMT          TO PV-HOLD-DOC-RETL-AMT       11330099
113400        ADD 1                       TO PC-DOC-COUNT               11340099
113500     END-IF.                                                      11350099
113600                                                                  11360099
113700 EJECT                                                            11370099
113800                                                                  11380099
113900*                                                                 11390099
114000*----------------------------------------------------------------*11400099
114100*  CHECK FOR CHANGE IN THE DOCUMENT NUMBER FOR NEW RECORD READ   *11410099
114200*----------------------------------------------------------------*11420099
114300*                                                                 11430099
114400 R100-READ-DAILY-DOC-XTRCT-FILE.                                  11440099
114500                                                                  11450099
114600     MOVE 'R100-READ-DAILY-DOC-XTRCT-FILE' TO                     11460099
114700                                         PV-CURRENT-PARAGRAPH.    11470099
114800                                                                  11480099
114900     READ DAILY-DOC-EXTRCT-FILE INTO AP070-EXTRACT-FILE           11490099
115000        AT END SET END-OF-INVOICES TO TRUE.                       11500099
115100                                                                  11510099
115200     IF MORE-INVOICES                                             11520099
115300         ADD 1  TO PC-READ-COUNTER                                11530099
115400     END-IF.                                                      11540099
115500                                                                  11550099
115600                                                                  11560099
115700 EJECT                                                            11570099
115800*                                                                 11580099
115900*----------------------------------------------------------------*11590099
116000*  WRITES THE HEADING OF THE DAILY TERMINAL BALANCE REPORT       *11600099
116100*----------------------------------------------------------------*11610099
116200*                                                                 11620099
116300 W100-WRITE-HEADERS.                                              11630099
116400                                                                  11640099
116500     MOVE 'W100-WRITE-HEADERS' TO PV-CURRENT-PARAGRAPH.           11650099
116600                                                                  11660099
116700     ADD 1                            TO PC-PAGE-COUNT.           11670099
116800     MOVE PC-PAGE-COUNT               TO DP200O-PAGE-NUMBER.      11680099
116900                                                                  11690099
117000     WRITE DAILY-TERMINAL-BAL-REC                                 11700099
117100           FROM DP200O-STANDRD-HEADER-200-COLS AFTER PAGE.        11710099
117200                                                                  11720099
117300     WRITE DAILY-TERMINAL-BAL-REC FROM TRMNL-BALANCE-HEADER1      11730099
117400                                       AFTER 1.                   11740099
117500     WRITE DAILY-TERMINAL-BAL-REC FROM TRMNL-BALANCE-HEADER2      11750099
117600                                       AFTER 1.                   11760099
117700     WRITE DAILY-TERMINAL-BAL-REC FROM TRMNL-BALANCE-HEADER3      11770099
117800                                       AFTER 1.                   11780099
117900     MOVE 5 TO PC-LINE-COUNT.                                     11790099
118000                                                                  11800099
118100     EJECT                                                        11810099
118200                                                                  11820099
118300*----------------------------------------------------------------*11830099
118400*  WRITES THE DETAIL HEADERS OF THE DAILY TERMINAL BALANCING     *11840099
118500*  REPORT.                                                       *11850099
118600*----------------------------------------------------------------*11860099
118700*                                                                 11870099
118800 W200-WRITE-DETAIL-HEADERS.                                       11880099
118900                                                                  11890099
119000     MOVE 'W200-WRITE-DETAIL-HEADERS' TO PV-CURRENT-PARAGRAPH.    11900099
119100                                                                  11910099
119200     IF PC-LINE-COUNT > PC-MAX-LINES                              11920099
119300         PERFORM W100-WRITE-HEADERS                               11930099
119400*        PERFORM W200-WRITE-DETAIL-HEADERS                        11940099
119500     END-IF.                                                      11950099
119600                                                                  11960099
119700     WRITE DAILY-TERMINAL-BAL-REC FROM                            11970099
119800                      DH1-TRMNL-BALANCE-DETAIL-HDR1 AFTER 2.      11980099
119900                                                                  11990099
120000     WRITE DAILY-TERMINAL-BAL-REC FROM                            12000099
120100                      DH2-TRMNL-BALANCE-DETAIL-HDR2 AFTER 1.      12010099
120200                                                                  12020099
120300     ADD 3  TO PC-LINE-COUNT.                                     12030099
120400                                                                  12040099
120500     EJECT                                                        12050099
120600                                                                  12060099
120700*                                                                 12070099
120800*----------------------------------------------------------------*12080099
120900*  WRITES THE IMPORT ACCOUNT DETAIL HEADERS.                     *12090099
121000*  CALLED FROM E100-PREPARE-ACCT-DETAIL                          *12100099
121100*----------------------------------------------------------------*12110099
121200*                                                                 12120099
121300 W300-WRITE-EMPTY-INPUT-FILE.                                     12130099
121400                                                                  12140099
121500     MOVE 'W300-WRITE-EMPTY-INPUT-FILE' TO PV-CURRENT-PARAGRAPH.  12150099
121600                                                                  12160099
121700     IF PC-LINE-COUNT > PC-MAX-LINES                              12170099
121800         PERFORM W100-WRITE-HEADERS                               12180099
121900         PERFORM W200-WRITE-DETAIL-HEADERS                        12190099
122000     END-IF.                                                      12200099
122100                                                                  12210099
122200     WRITE DAILY-TERMINAL-BAL-REC FROM                            12220099
122300                          DL-TRMNL-BALANCE-DTL-EMPTY-INP          12230099
122400                                               AFTER 2.           12240099
122500                                                                  12250099
122600     EJECT                                                        12260099
122700                                                                  12270099
122800*                                                                 12280099
122900*----------------------------------------------------------------*12290099
123000*  WRITES THE AMOUNT TOTALS FOR THE ORIGIN CURRENTLY BEING       *12300099
123100*  PROCESSED. (THIS IS DONE WHEN THE ORIGIN CHANGES)             *12310099
123200*----------------------------------------------------------------*12320099
123300*                                                                 12330099
123400 W400-WRITE-ORIGIN-SUMMARY-LINE.                                  12340099
123500                                                                  12350099
123600     MOVE 'W400-WRITE-ORIGIN-SUMMARY-LINE' TO                     12360099
123700                                         PV-CURRENT-PARAGRAPH.    12370099
123800                                                                  12380099
123900     IF PC-LINE-COUNT > PC-MAX-LINES                              12390099
124000         PERFORM W100-WRITE-HEADERS                               12400099
124100         PERFORM W200-WRITE-DETAIL-HEADERS                        12410099
124200     END-IF.                                                      12420099
124300                                                                  12430099
124400     WRITE DAILY-TERMINAL-BAL-REC FROM SL1-ID-ORIGIN-SUMMARY-LINE112440099
124500                                       AFTER 2.                   12450099
124600                                                                  12460099
124700     WRITE DAILY-TERMINAL-BAL-REC FROM SP-SPACE-LINE              12470099
124800                                       AFTER 1.                   12480099
124900                                                                  12490099
125000     ADD 3  TO PC-LINE-COUNT.                                     12500099
125100                                                                  12510099
125200     EJECT                                                        12520099
125300                                                                  12530099
125400*                                                                 12540099
125500*----------------------------------------------------------------*12550099
125600*  WRITES THE AMOUNT TOTALS FOR THE TK ID CURRENTLY BEING        *12560099
125700*  PROCESSED.  (THIS IS DONE WHEN THE TK ID CHANGES)             *12570099
125800*----------------------------------------------------------------*12580099
125900*                                                                 12590099
126000 W500-WRITE-TKID-SUMMARY-LINE.                                    12600099
126100                                                                  12610099
126200     MOVE 'W500-WRITE-TKID-SUMMARY-LINE' TO                       12620099
126300                                  PV-CURRENT-PARAGRAPH.           12630099
126400                                                                  12640099
126500     IF PC-LINE-COUNT > PC-MAX-LINES                              12650099
126600         PERFORM W100-WRITE-HEADERS                               12660099
126700         PERFORM W200-WRITE-DETAIL-HEADERS                        12670099
126800     END-IF.                                                      12680099
126900                                                                  12690099
127000     WRITE DAILY-TERMINAL-BAL-REC FROM                            12700099
127100                              SL2-ALL-ORIGIN-SUMMARY-LINE2        12710099
127200                                             AFTER 2.             12720099
127300                                                                  12730099
127400     WRITE DAILY-TERMINAL-BAL-REC FROM SP-SPACE-LINE              12740099
127500                                             AFTER 1.             12750099
127600                                                                  12760099
127700     ADD 3  TO PC-LINE-COUNT.                                     12770099
127800                                                                  12780099
127900     EJECT                                                        12790099
128000                                                                  12800099
128100*                                                                 12810099
128200*----------------------------------------------------------------*12820099
128300*  WRITES THE TOTAL LINES FOR ALL TK ID'S AND ALL ORIGINS AT     *12830099
128400*  THE END OF THE REPORT.                                        *12840099
128500*----------------------------------------------------------------*12850099
128600*                                                                 12860099
128700 W600-WRITE-TOTALS.                                               12870099
128800                                                                  12880099
128900     MOVE 'W600-WRITE-TOTALS' TO PV-CURRENT-PARAGRAPH.            12890099
129000                                                                  12900099
129100     IF PC-LINE-COUNT > PC-MAX-LINES                              12910099
129200         PERFORM W100-WRITE-HEADERS                               12920099
129300         PERFORM W200-WRITE-DETAIL-HEADERS                        12930099
129400     END-IF.                                                      12940099
129500                                                                  12950099
129600     WRITE DAILY-TERMINAL-BAL-REC FROM                            12960099
129700                                 SL3-ALL-ENTR-ID-SUMMARY-LINE3    12970099
129800                                               AFTER 2.           12980099
129900                                                                  12990099
130000     ADD 2 TO PC-LINE-COUNT.                                      13000099
130100                                                                  13010099
130200     EJECT                                                        13020099
130300                                                                  13030099
130400*                                                                 13040099
130500*----------------------------------------------------------------*13050099
130600*  WRITES THE GRAND TOTALS FOR EACH OF THE AMOUNT FIELDS.        *13060099
130700*----------------------------------------------------------------*13070099
130800*                                                                 13080099
130900 W700-WRITE-GRAND-TOTALS.                                         13090099
131000                                                                  13100099
131100     MOVE 'W700-WRITE-GRAND-TOTALS' TO PV-CURRENT-PARAGRAPH.      13110099
131200                                                                  13120099
131300     IF PC-LINE-COUNT > PC-MAX-LINES                              13130099
131400         PERFORM W100-WRITE-HEADERS                               13140099
131500         PERFORM W200-WRITE-DETAIL-HEADERS                        13150099
131600     END-IF.                                                      13160099
131700                                                                  13170099
131800     WRITE DAILY-TERMINAL-BAL-REC FROM                            13180099
131900                                  SL4-ALL-ID-ORIGN-SUMMARY-LINE4  13190099
132000                                                AFTER 4.          13200099
132100                                                                  13210099
132200     ADD 4  TO PC-LINE-COUNT.                                     13220099
132300                                                                  13230099
132400     IF PC-LINE-COUNT > PC-MAX-LINES                              13240099
132500         PERFORM W100-WRITE-HEADERS                               13250099
132600         PERFORM W200-WRITE-DETAIL-HEADERS                        13260099
132700     END-IF.                                                      13270099
132800                                                                  13280099
132900     WRITE DAILY-TERMINAL-BAL-REC FROM                            13290099
133000                                  EOR-END-OF-REPORT-LINE          13300099
133100                                                AFTER 6.          13310099
133200                                                                  13320099
133300     ADD 6  TO PC-LINE-COUNT.                                     13330099
133400                                                                  13340099
133500     EJECT                                                        13350099
133600                                                                  13360099
133700*----------------------------------------------------------------*13370099
133800*  WRITES THE KEYED TOTALS FOR EACH OF THE AMOUNT FIELDS.        *13380099
133900*----------------------------------------------------------------*13390099
134000*                                                                 13400099
134100 W720-WRITE-KEYED-TOTALS.                                         13410099
134200                                                                  13420099
134300     MOVE 'W720-WRITE-KEYED-TOTALS' TO PV-CURRENT-PARAGRAPH.      13430099
134400                                                                  13440099
134500     IF PC-LINE-COUNT > PC-MAX-LINES                              13450099
134600         PERFORM W100-WRITE-HEADERS                               13460099
134700         PERFORM W200-WRITE-DETAIL-HEADERS                        13470099
134800     END-IF.                                                      13480099
134900                                                                  13490099
135000     WRITE DAILY-TERMINAL-BAL-REC FROM                            13500099
135100                                  SL6-ALL-ID-ORIGN-SUMMARY-LINE6  13510099
135200                                                AFTER 4.          13520099
135300                                                                  13530099
135400     ADD 4  TO PC-LINE-COUNT.                                     13540099
135500                                                                  13550099
135600     IF PC-LINE-COUNT > PC-MAX-LINES                              13560099
135700         PERFORM W100-WRITE-HEADERS                               13570099
135800         PERFORM W200-WRITE-DETAIL-HEADERS                        13580099
135900     END-IF.                                                      13590099
136000                                                                  13600099
136100     EJECT                                                        13610099
136200                                                                  13620099
136300*----------------------------------------------------------------*13630099
136400*  WRITES THE INTERFACED TOTALS FOR EACH OF THE AMOUNT FIELDS.   *13640099
136500*----------------------------------------------------------------*13650099
136600*                                                                 13660099
136700 W740-WRITE-INTFC-TOTALS.                                         13670099
136800                                                                  13680099
136900     MOVE 'W740-WRITE-INTFC-TOTALS' TO PV-CURRENT-PARAGRAPH.      13690099
137000                                                                  13700099
137100     IF PC-LINE-COUNT > PC-MAX-LINES                              13710099
137200         PERFORM W100-WRITE-HEADERS                               13720099
137300         PERFORM W200-WRITE-DETAIL-HEADERS                        13730099
137400     END-IF.                                                      13740099
137500                                                                  13750099
137600     WRITE DAILY-TERMINAL-BAL-REC FROM                            13760099
137700                                  SL7-ALL-ID-ORIGN-SUMMARY-LINE7  13770099
137800                                                AFTER 4.          13780099
137900                                                                  13790099
138000     ADD 4  TO PC-LINE-COUNT.                                     13800099
138100                                                                  13810099
138200     IF PC-LINE-COUNT > PC-MAX-LINES                              13820099
138300         PERFORM W100-WRITE-HEADERS                               13830099
138400         PERFORM W200-WRITE-DETAIL-HEADERS                        13840099
138500     END-IF.                                                      13850099
138600                                                                  13860099
138700     EJECT                                                        13870099
138800                                                                  13880099
138900*----------------------------------------------------------------*13890099
139000*  WRITES THE DETAIL LINE OF THE DAILY TERMINAL BALANCING        *13900099
139100*  REPORT.                                                       *13910099
139200*----------------------------------------------------------------*13920099
139300*                                                                 13930099
139400 W800-WRITE-DETAIL-LINE.                                          13940099
139500                                                                  13950099
139600     MOVE 'W800-WRITE-DETAIL-LINE' TO PV-CURRENT-PARAGRAPH.       13960099
139700                                                                  13970099
139800     IF PC-LINE-COUNT > PC-MAX-LINES                              13980099
139900         PERFORM W100-WRITE-HEADERS                               13990099
140000         PERFORM W200-WRITE-DETAIL-HEADERS                        14000099
140100     END-IF.                                                      14010099
140200                                                                  14020099
140300     WRITE DAILY-TERMINAL-BAL-REC FROM                            14030099
140400                      DL-TRMNL-BALANCE-DETAIL-LINE AFTER 1.       14040099
140500                                                                  14050099
140600     ADD 1  TO PC-LINE-COUNT.                                     14060099
140700                                                                  14070099
140800     EJECT                                                        14080099
140900                                                                  14090099
141000*----------------------------------------------------------------*14100099
141100*  WRITES THE DOCUMENT NUMBER TOTAL LINE BASED ON A BREAK IN     *14110099
141200*  THE DOCUMENT NUMBER.                                          *14120099
141300*----------------------------------------------------------------*14130099
141400*                                                                 14140099
141500 W900-WRITE-DOC-NBR-SUM-LINE.                                     14150099
141600                                                                  14160099
141700     MOVE 'W900-WRITE-DOC-NBR-SUMMARY-LINE' TO                    14170099
141800                                           PV-CURRENT-PARAGRAPH.  14180099
141900                                                                  14190099
142000     IF PC-LINE-COUNT > PC-MAX-LINES                              14200099
142100         PERFORM W100-WRITE-HEADERS                               14210099
142200         PERFORM W200-WRITE-DETAIL-HEADERS                        14220099
142300     END-IF.                                                      14230099
142400                                                                  14240099
142500     WRITE DAILY-TERMINAL-BAL-REC FROM                            14250099
142600                      SL5-DOC-NBR-SUMMARY-LINE5 AFTER 2.          14260099
142700                                                                  14270099
142800     WRITE DAILY-TERMINAL-BAL-REC FROM SP-SPACE-LINE              14280099
142900                                                AFTER 1.          14290099
143000                                                                  14300099
143100     ADD 3  TO PC-LINE-COUNT.                                     14310099
143200                                                                  14320099
143300 EJECT                                                            14330099
143400*                                                                 14340099
143500*----------------------------------------------------------------*14350099
143600*    ABEND ROUTINE                                               *14360099
143700*----------------------------------------------------------------*14370099
143800*                                                                 14380099
143900*Z999-ABEND.                                                      14390099
144000*                                                                 14400099
144100*    CLOSE DAILY-DOC-EXTRCT-FILE                                  14410099
144200*          DAILY-TERMINAL-BAL-FILE.                               14420099
144300*                                                                 14430099
144400*    DISPLAY AA-ABEND-LIT.                                        14440099
144500*    DISPLAY AA-PROGRAM-LIT.                                      14450099
144600*    DISPLAY AA-PARAGRAPH-LIT.                                    14460099
144700*    DISPLAY AA-MESSAGE-LINE.                                     14470099
144800*    CALL 'ILBOABN0' USING ABEND-CODE.                            14480099
144900*                                                                 14490099
145000*----------------------------------------------------------------*14500099
