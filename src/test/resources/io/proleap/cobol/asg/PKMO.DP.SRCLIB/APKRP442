000100 IDENTIFICATION DIVISION.                                         00010092
000200 PROGRAM-ID.    APKRP442.                                         00020093
000300 AUTHOR.        MEENAKSHI MITTAL.                                 00030093
000400 DATE-WRITTEN.  JULY 2015.                                        00040093
000500 DATE-COMPILED.                                                   00050093
000600*---------------------------------------------------------------* 00060093
000700*              DUTY FILE REJECTION REPORT                       * 00070094
000800*---------------------------------------------------------------* 00080093
000900*  PURPOSE:  TO CREATE REPORT OF DUTY FILE RECORDS THAT WERE    * 00090094
001000*  REJECTED BECAUSE THEY FAILED ONE OR MORE OF THE EDITS BEING  * 00100093
001100*  PERFORMED IN PROGRAM APKUT441. THIS REPORT WILL BE USED BY   * 00110098
001200*  THE AP BUSINESS AREA TO GET THE ERRORS RESOLVED.             * 00120098
001300*---------------------------------------------------------------* 00130098
001600*  INPUT:  REJECTED DUTY RECORDS (APRD158)                      * 00160094
001700*  OUTPUT: AP DUTY REJECTION REPORT                             * 00170098
001800*---------------------------------------------------------------* 00180093
001900* CHANGES:                                                      * 00190093
002000* DATE  07/08/2015                                              * 00200099
002100*     CHANGE MADE: INITIAL IMPLEMENTATION.                      * 00210099
002110*     MADE BY: MEENAKSHI MITTAL        WR/IR #: CHG0112172      * 00211099
002111*                                                               * 00211199
002120* DATE  11/02/2020                                              * 00212099
002130*    CHANGE MADE: RECOMPILED TO INCLUDE CHANGES TO COPYBOOK     * 00213099
002140*    APWS010.                                                   * 00214099
002150*    MADE BY: NANCY EILBES            WR/IR #: CHG0250510       * 00215099
002111*                                                               * 00216099
002120* DATE  05/10/2023                                              * 00217099
002130*    CHANGE MADE: ADD VENDOR NUMBER TO THE REPORT               * 00218099
002130*                 UPDATED VERSION OF COPYBOOK APWS010           * 00219099
002150*    MADE BY: JEAN KURK               WR/IR #: CHG0288104       * 00219199
002111*                                                               * 00219299
002120* DATE  12/01/2023                                              * 00219399
002130*    CHANGE MADE: RECOMPILED TO INCLUDE CHANGES TO COPYBOOK     * 00219499
002130*    APWS010.                                                   * 00219599
002150*    MADE BY: SARVESWARAN KANNAN      WR/IR #: CHG0297175       * 00219699
002200*---------------------------------------------------------------* 00220093
002300 ENVIRONMENT DIVISION.                                            00230093
002400 CONFIGURATION SECTION.                                           00240093
002500 SOURCE-COMPUTER.        IBM-370.                                 00250093
002600 OBJECT-COMPUTER.        IBM-370.                                 00260093
002700                                                                  00270093
002800 INPUT-OUTPUT SECTION.                                            00280093
002900 FILE-CONTROL.                                                    00290093
003000     SELECT REJECT-DUTY-FILE     ASSIGN TO INP01.                 00300099
003100     SELECT AP-REJECTION-REPORT  ASSIGN TO RPT01.                 00310093
003200                                                                  00320093
003300 DATA DIVISION.                                                   00330093
003400 FILE SECTION.                                                    00340093
003500                                                                  00350093
003600 FD  REJECT-DUTY-FILE                                             00360099
003700     RECORDING MODE IS F                                          00370093
003800     LABEL RECORDS ARE STANDARD                                   00380093
003900     BLOCK CONTAINS 0 RECORDS                                     00390093
004000     DATA RECORD IS REJECT-DUTY-RECORD.                           00400099
004100                                                                  00410093
004200 01  REJECT-DUTY-RECORD                 PIC X(118).               00420099
004300                                                                  00430093
004400 FD  AP-REJECTION-REPORT                                          00440093
004500     RECORDING MODE IS F                                          00450093
004600     LABEL RECORDS ARE STANDARD                                   00460093
004700     BLOCK CONTAINS 0 RECORDS                                     00470093
004800     DATA RECORD IS AP-REJECT-RECORD.                             00480093
004900                                                                  00490093
005000 01  AP-REJECT-RECORD                   PIC X(200).               00500093
005100                                                                  00510093
005200 WORKING-STORAGE SECTION.                                         00520093
005300                                                                  00530093
005400 01  END-OF-INPUT-SW                PIC X       VALUE 'N'.        00540093
005500     88  END-OF-INPUT                           VALUE 'Y'.        00550093
005600                                                                  00560093
005700 01  ERROR-SWITCHES.                                              00570093
005800     05  AP-ERRORS-SW               PIC X       VALUE ' '.        00580093
005900         88 AP-ERRORS                           VALUE 'Y'.        00590093
006000     05  AP-DETAIL-WRITTEN-SW       PIC X       VALUE ' '.        00600093
006100         88 AP-DETAIL-WRITTEN                   VALUE 'Y'.        00610093
006200                                                                  00620093
006300 01  PROGRAM-VARIABLES.                                           00630093
006400     05  PV-COUNT-AP                 PIC 9(12) VALUE 0.           00640093
006500     05  PV-AP-RPT-OUT               PIC 9(12) VALUE 0.           00650093
006600     05  PV-INPUT-COUNT              PIC 9(12) VALUE 0.           00660093
006700     05  MAX-LINES                   PIC  S9(3)  COMP-3           00670093
006800                                                 VALUE +60.       00680093
006900     05  PAGE-COUNT-AP               PIC S9(9) COMP-3 VALUE +0.   00690093
007000     05  LINE-COUNT-AP               PIC S9(3) COMP-3 VALUE +0.   00700093
007100     05  PV-SYSTEM-DATE              PIC  X(08)  VALUE ZERO.      00710093
007200     05  FILLER REDEFINES PV-SYSTEM-DATE.                         00720093
007300         10  PV-SYSTEM-CCYY.                                      00730093
007400             15  PV-SYSTEM-CENTURY      PIC X(02).                00740093
007500             15  PV-SYSTEM-YEAR         PIC X(02).                00750093
007600         10  PV-SYSTEM-MONTH            PIC X(02).                00760093
007700         10  PV-SYSTEM-DAY              PIC X(02).                00770093
007800     05  PV-SYSTEM-TIME.                                          00780093
007900         10  PV-SYSTEM-HOUR         PIC  9(02)  VALUE ZERO.       00790093
008000         10  PV-SYSTEM-MINUTE       PIC  9(02)  VALUE ZERO.       00800093
008100         10  PV-SYSTEM-SECOND       PIC  9(02)  VALUE ZERO.       00810093
008200         10  FILLER                 PIC  9(02)  VALUE ZERO.       00820093
008300     05  PV-PROGRAM-NAME            PIC  X(8)   VALUE 'APKRP442'. 00830093
008400                                                                  00840093
008500*----------------------------------------------------------------*00850093
008600*    ABEND DATA AREAS                                             00860093
008700*----------------------------------------------------------------*00870093
008800                                                                  00880093
008900 01  ABEND-AREAS.                                                 00890093
009000     05  AA-ABEND-LIT              PIC  X(40)   VALUE             00900093
009100             '*****       ABEND'.                                 00910093
009200     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             00920093
009300             '*****   PROGRAM: APKRP442'.                         00930093
009400     05  AA-PARAGRAPH-LIT.                                        00940093
009500         10  FILLER                PIC  X(17)   VALUE             00950093
009600             '***** PARAGRAPH: '.                                 00960093
009700         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     00970093
009800     05  AA-MESSAGE-LINE-1.                                       00980093
009900         10  FILLER                PIC  X(06)   VALUE '*****'.    00990093
010000         10  AA-MESSAGE-1          PIC  X(80)   VALUE SPACES.     01000093
010100     05  AA-MESSAGE-LINE-2.                                       01010093
010200         10  FILLER                PIC  X(06)   VALUE '*****'.    01020093
010300         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     01030093
010400                                                                  01040093
010500 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      01050093
010600                                   COMP         SYNC.             01060093
010700                                                                  01070093
010800     88  AC-ANY-ERROR                           VALUE  +4001      01080093
010900                                                THRU   +4019.     01090093
011000     88  AC-INVALID-KEY-WRITE                   VALUE  +4001.     01100093
011100     88  AC-INVALID-KEY-READ                    VALUE  +4002.     01110093
011200     88  AC-INVALID-CONTROL-CARD                VALUE  +4003.     01120093
011300     88  AC-OPEN-ERROR                          VALUE  +4005.     01130093
011400     88  AC-CLOSE-ERROR                         VALUE  +4006.     01140093
011500     88  AC-INVALID-DATA                        VALUE  +4008.     01150093
011600     88  AC-DB2-ERROR                           VALUE  +4013.     01160093
011700     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     01170093
011800     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     01180093
011900                                                                  01190093
012000*----------------------------------------------------------------*01200093
012100*           KOHLS STANDARD 200 CHARACTER REPORT HEADER           *01210095
012200*----------------------------------------------------------------*01220093
012300     COPY DPWS200O.                                               01230095
012400                                                                  01240093
012500 01  BLANK-LINE                PIC X(200) VALUE SPACES.           01250093
012600 01  SAVE-PRINT-LINE           PIC X(200) VALUE SPACES.           01260093
012700                                                                  01270093
012800 01  HDR-TITLE-1.                                                 01280093
012900     05  FILLER                  PIC  X(90)     VALUE SPACE.      01290093
013000     05  FILLER                  PIC  X(21)     VALUE             01300093
013100             'DUTY REJECTION REPORT'.                             01310093
013200     05  FILLER                  PIC  X(89)     VALUE SPACE.      01320093
013300                                                                  01330093
013800                                                                  01380093
013900 01  HEADER-1.                                                    01390099
014000     05  FILLER                PIC X(58) VALUE SPACES.            01400093
014300     05  FILLER                PIC X(09) VALUE 'CUSTOMS '.        01401099
014200     05  FILLER                PIC X(04) VALUE SPACES.            01402099
014200*    05  FILLER                PIC X(05) VALUE SPACES.            01403099
014100     05  FILLER                PIC X(05) VALUE 'ENTRY'.           01410093
014200     05  FILLER                PIC X(15) VALUE SPACES.            01420093
014300     05  FILLER                PIC X(09) VALUE 'ENTRY   '.        01430099
014300*    05  FILLER                PIC X(09) VALUE ' ENTRY   '.       01431099
014400     05  FILLER                PIC X(11) VALUE SPACES.            01440093
014500     05  FILLER                PIC X(05) VALUE 'TOTAL'.           01450093
014600     05  FILLER                PIC X(79) VALUE SPACES.            01460099
014600*    05  FILLER                PIC X(103) VALUE SPACES.           01461099
014700                                                                  01470093
014800 01  HEADER-2.                                                    01480099
014900     05  FILLER                PIC X(09) VALUE 'PO NUMBER'.       01490093
015000     05  FILLER                PIC X(04) VALUE SPACES.            01500093
015100     05  FILLER                PIC X(10) VALUE 'INVOICE ID'.      01510093
015200     05  FILLER                PIC X(16) VALUE SPACES.            01520093
015300     05  FILLER                PIC X(11) VALUE 'BROKER REF#'.     01530093
015400     05  FILLER                PIC X(08) VALUE SPACES.            01540093
015500     05  FILLER                PIC X(06) VALUE 'BROKER'.          01550099
015400     05  FILLER                PIC X(07) VALUE SPACES.            01551099
015400*    05  FILLER                PIC X(08) VALUE SPACES.            01551199
015500     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01552099
015600     05  FILLER                PIC X(14) VALUE SPACES.            01560093
015700     05  FILLER                PIC X(04) VALUE 'DATE'.            01570093
015800     05  FILLER                PIC X(14) VALUE SPACES.            01580099
015800*    05  FILLER                PIC X(13) VALUE SPACES.            01581099
015900     05  FILLER                PIC X(09) VALUE 'DUTY AMT'.        01590093
016000     05  FILLER                PIC X(03) VALUE SPACES.            01600093
016100     05  FILLER                PIC X(26) VALUE                    01610093
016200                                   'ERROR CODE AND DESCRIPTION'.  01620093
016300     05  FILLER                PIC X(38) VALUE SPACES.            01630099
016300*    05  FILLER                PIC X(52) VALUE SPACES.            01631099
016400                                                                  01640093
017000 01  DETAIL-LINE.                                                 01700093
017100     05  DTL-PO-NUMBER         PIC X(09) VALUE SPACES.            01710093
017200     05  FILLER                PIC X(04) VALUE SPACES.            01720093
017300     05  DTL-INVOICE-ID        PIC X(22) VALUE SPACES.            01730093
017400     05  FILLER                PIC X(04) VALUE SPACES.            01740093
017500     05  DTL-BROKER-REF        PIC X(15) VALUE SPACES.            01750093
017600     05  FILLER                PIC X(04) VALUE SPACES.            01760093
017500     05  DTL-VND-NBR           PIC X(09) VALUE SPACES.            01761099
017600     05  FILLER                PIC X(04) VALUE SPACES.            01762099
017700     05  DTL-ENTRY-NBR         PIC X(16) VALUE SPACES.            01770093
017800     05  FILLER                PIC X(04) VALUE SPACES.            01780093
017900     05  DTL-CUST-DATE.                                           01790093
018000         10  WS-CST-MM         PIC X(02) VALUE SPACES.            01800093
018100         10  FILLER            PIC X(01) VALUE '/'.               01810093
018200         10  WS-CST-DD         PIC X(02) VALUE SPACES.            01820093
018300         10  FILLER            PIC X(01) VALUE '/'.               01830093
018400         10  WS-CST-CCYY       PIC X(04) VALUE SPACES.            01840093
018500     05  FILLER                PIC X(02) VALUE SPACES.            01850093
018600     05  DTL-TOT-DUTY-AMT      PIC ---,---,---.99.                01860093
018700     05  FILLER                PIC X(04) VALUE SPACES.            01870093
018800     05  DTL-ERROR-NBR         PIC X(02) VALUE SPACES.            01880093
018900     05  FILLER                PIC X(03) VALUE ' - '.             01890093
019000     05  DTL-ERROR-MSG         PIC X(45) VALUE SPACES.            01900093
019100     05  FILLER                PIC X(29) VALUE SPACES.            01910099
019100*    05  FILLER                PIC X(42) VALUE SPACES.            01911099
019200                                                                  01920093
019300 01  ERROR-ONLY-LINE.                                             01930093
019400*    05  FILLER                PIC X(108) VALUE SPACES.           01940099
019400     05  FILLER                PIC X(121) VALUE SPACES.           01941099
019500     05  ERROR-NBR             PIC 9(02) VALUE ZEROES.            01950093
019600     05  FILLER                PIC X(03) VALUE ' - '.             01960093
019700     05  ERROR-MSG             PIC X(45) VALUE SPACES.            01970093
019800                                                                  01980093
019900 01  END-OF-REPORT.                                               01990093
020000     05  FILLER                PIC X(85) VALUE SPACES.            02000093
020100     05  FILLER                PIC X(29) VALUE                    02010093
020200        '- - - - END OF REPORT - - - -'.                          02020093
020300     05  FILLER                PIC X(85) VALUE SPACES.            02030093
020400                                                                  02040093
020500 01  NO-DATA-TO-REPORT.                                           02050093
020600     05  FILLER                PIC X(83) VALUE SPACES.            02060093
020700     05  FILLER                PIC X(33) VALUE                    02070093
020800        'NO DATA FOR DUTY REJECTION REPORT'.                      02080093
020900     05  FILLER                PIC X(83) VALUE SPACES.            02090093
021000                                                                  02100093
021100*--------------------------------------------------------------*  02110093
021200* APRD158 RECORD LAYOUT FOR DUTY IMPORT INVOICE REJECTION FILE *  02120099
021300*--------------------------------------------------------------*  02130093
021400     COPY APRD158.                                                02140093
021500                                                                  02150093
021600*--------------------------------------------------------------*  02160093
021700*  APWS010 RECORD LAYOUT FOR ERROR MESSAGE REPORTING           *  02170093
021800*--------------------------------------------------------------*  02180093
021900 01  WS-EDIT-CODES.                                               02190093
022000     COPY APWS010.                                                02200093
022100                                                                  02210093
022900 LINKAGE SECTION.                                                 02290093
023000                                                                  02300093
023100 PROCEDURE DIVISION.                                              02310093
023200                                                                  02320093
023300 A100-MAINLINE-ROUTINE.                                           02330093
023400                                                                  02340093
023500     PERFORM B100-INITIALIZATION.                                 02350095
023600                                                                  02360093
023700     PERFORM B200-CREATE-REJECT-RPT                               02370099
023800       UNTIL END-OF-INPUT.                                        02380099
023900                                                                  02390093
024000     PERFORM B300-TERMINATION.                                    02400095
024100                                                                  02410093
024200     GOBACK.                                                      02420093
024300                                                                  02430093
024400*--------------------------------------------------------------*  02440093
024500* B100-INITIALIZATION                                          *  02450093
024600*  INITIALIZATION PROCESSING.                                  *  02460093
024700*--------------------------------------------------------------*  02470093
024800 B100-INITIALIZATION.                                             02480093
024900                                                                  02490093
025000     DISPLAY ' '.                                                 02500093
025100     DISPLAY 'BEGINNING APKRP442 '.                               02510093
025200                                                                  02520093
025300     OPEN INPUT  REJECT-DUTY-FILE                                 02530099
025400          OUTPUT AP-REJECTION-REPORT.                             02540093
025500                                                                  02550093
027300     MOVE FUNCTION CURRENT-DATE  TO PV-SYSTEM-DATE.               02730099
027400     MOVE PV-SYSTEM-MONTH        TO DP200O-RUN-MONTH.             02740095
027500     MOVE PV-SYSTEM-DAY          TO DP200O-RUN-DAY.               02750095
027600     MOVE PV-SYSTEM-YEAR         TO DP200O-RUN-YEAR.              02760095
027700     ACCEPT PV-SYSTEM-TIME FROM TIME.                             02770093
027800     MOVE PV-SYSTEM-HOUR         TO DP200O-RUN-HOUR.              02780095
027900     MOVE PV-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.            02790095
028000     MOVE PV-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.          02800095
028100                                                                  02810093
028200     PERFORM W100-WRITE-AP-HEADINGS.                              02820093
028300                                                                  02830093
028400     PERFORM R100-READ-INPUT.                                     02840093
028500                                                                  02850093
028600     IF END-OF-INPUT                                              02860093
028800         WRITE AP-REJECT-RECORD FROM NO-DATA-TO-REPORT            02880093
028900                                AFTER ADVANCING 1 LINE            02890093
029000     END-IF.                                                      02900093
029100                                                                  02910093
029400 EJECT                                                            02940095
029500*--------------------------------------------------------------*  02950093
029600*  B200-CREATE-REJECT-RPT                                      *  02960093
029700*   THIS ROUTINE HOLDS THE MAIN LOGIC FOR REJECTION REPORTING. *  02970093
029800*--------------------------------------------------------------*  02980093
029900 B200-CREATE-REJECT-RPT.                                          02990093
030000                                                                  03000093
030100     INITIALIZE ERROR-SWITCHES.                                   03010093
030200     INITIALIZE DETAIL-LINE.                                      03020093
030300                                                                  03030093
030400     MOVE AP158-PO-NBR          TO DTL-PO-NUMBER.                 03040099
030500     MOVE AP158-INVOICE-NBR     TO DTL-INVOICE-ID.                03050099
030600     MOVE AP158-BROKER-REF-NBR  TO DTL-BROKER-REF.                03060099
030700     MOVE AP158-ENTRY-NBR       TO DTL-ENTRY-NBR.                 03070099
030700     MOVE AP158-VENDOR-NBR      TO DTL-VND-NBR.                   03071099
030800     MOVE AP158-INVC-DTE(1:4)   TO WS-CST-CCYY.                   03080099
030900     MOVE AP158-INVC-DTE(5:2)   TO WS-CST-MM.                     03090099
031000     MOVE AP158-INVC-DTE(7:2)   TO WS-CST-DD.                     03100099
031100     MOVE AP158-TOTAL-DUTY-AMT  TO DTL-TOT-DUTY-AMT.              03110099
031200                                                                  03120093
031300     PERFORM VARYING AP158-IDX FROM 1 BY 1 UNTIL AP158-IDX > 15   03130095
031400                               OR AP158-ERR-CDE(AP158-IDX) = 0    03140093
031410                                                                  03141099
031500         MOVE AP158-ERR-CDE(AP158-IDX) TO WS010-TARGET-REPORT-CD  03150093
031600         DISPLAY 'WS010-TARGET-REPORT-CD ' WS010-TARGET-REPORT-CD 03160099
031800         PERFORM C100-PROCESS-AP-ERRORS                           03180099
031900                                                                  03190099
033300     END-PERFORM.                                                 03330093
033400                                                                  03340093
033500     PERFORM R100-READ-INPUT.                                     03350093
033600                                                                  03360093
033900 EJECT                                                            03390095
034000*--------------------------------------------------------------*  03400093
034100* B300-TERMINATION                                             *  03410093
034200*  END OF PROGRAM PROCESSING.                                  *  03420093
034300*--------------------------------------------------------------*  03430093
034400 B300-TERMINATION.                                                03440093
034500                                                                  03450098
034800     DISPLAY '*** PROCESSING SUMMARY FOR APKRP442 ***'.           03480093
034900     DISPLAY 'INPUT RECORDS READ   = ' PV-INPUT-COUNT.            03490093
035000     DISPLAY 'AP ERRORS REPORTED   = ' PV-AP-RPT-OUT.             03500093
035100     DISPLAY '*************************************'.             03510093
035200                                                                  03520093
035300     CLOSE REJECT-DUTY-FILE                                       03530099
035400           AP-REJECTION-REPORT.                                   03540093
035500                                                                  03550093
035800 EJECT                                                            03580095
035900*----------------------------------------------------------------*03590093
036000* C100-PROCESS-AP-ERRORS                                         *03600093
036100*  PROCESSES THE ERROR THAT ARE TO BE REPORTED ON THE AP REPORT. *03610093
036200*----------------------------------------------------------------*03620093
036300 C100-PROCESS-AP-ERRORS.                                          03630093
036400                                                                  03640093
036500     IF  AP-DETAIL-WRITTEN                                        03650093
036600         SET MSG-IDX                TO AP158-ERR-CDE(AP158-IDX)   03660093
036700         MOVE AP158-ERR-CDE(AP158-IDX) TO ERROR-NBR               03670093
036800         MOVE WS010-ERROR-MSG(MSG-IDX) TO ERROR-MSG               03680093
036810         DISPLAY "ERROR-MSG : " ERROR-MSG                         03681099
036900         MOVE ERROR-ONLY-LINE TO SAVE-PRINT-LINE                  03690093
036910         DISPLAY "AP-DETAIL-WRITTEN: " AP-DETAIL-WRITTEN-SW       03691099
037000         PERFORM W400-WRITE-DETAIL-AP                             03700093
037100     ELSE                                                         03710093
037200         SET AP-ERRORS          TO TRUE                           03720093
037300         SET MSG-IDX TO AP158-ERR-CDE(AP158-IDX)                  03730093
037400         MOVE AP158-ERR-CDE(AP158-IDX) TO DTL-ERROR-NBR           03740093
037500         MOVE WS010-ERROR-MSG(MSG-IDX) TO DTL-ERROR-MSG           03750093
037600         PERFORM W400-WRITE-DETAIL-AP                             03760093
037700     END-IF.                                                      03770093
037800                                                                  03780093
037900*--------------------------------------------------------------*  03790093
038000* R100-READ-INPUT                                              *  03800093
038100*  READS THE INPUT FILE.                                       *  03810093
038200*--------------------------------------------------------------*  03820093
038300 R100-READ-INPUT.                                                 03830093
038400                                                                  03840093
038500     READ REJECT-DUTY-FILE INTO AP158-REJECT-DUTY-INVOICE         03850099
038600       AT END SET END-OF-INPUT TO TRUE.                           03860093
038700                                                                  03870093
038800     IF END-OF-INPUT                                              03880093
038900        CONTINUE                                                  03890093
039000     ELSE                                                         03900093
039100        ADD 1 TO PV-INPUT-COUNT                                   03910093
039200     END-IF.                                                      03920093
039300                                                                  03930093
039400*----------------------------------------------------------------*03940093
039500* W100-WRITE-AP-HEADINGS                                         *03950093
039600*  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                     *03960093
039700*----------------------------------------------------------------*03970093
039800 W100-WRITE-AP-HEADINGS.                                          03980093
039900                                                                  03990093
040000     ADD 1 TO PAGE-COUNT-AP.                                      04000093
040100     MOVE PAGE-COUNT-AP TO DP200O-PAGE-NUMBER.                    04010095
040200     MOVE '1'    TO DP200O-REPORT-NUMBER.                         04020099
040300     WRITE AP-REJECT-RECORD FROM DP200O-STANDRD-HEADER-200-COLS   04030099
040400         AFTER ADVANCING PAGE.                                    04040093
040500     WRITE AP-REJECT-RECORD FROM HDR-TITLE-1                      04050093
040600     WRITE AP-REJECT-RECORD FROM BLANK-LINE.                      04060093
040900     WRITE AP-REJECT-RECORD FROM HEADER-1                         04090099
041000           AFTER ADVANCING 1 LINES.                               04100093
041100     WRITE AP-REJECT-RECORD FROM HEADER-2                         04110099
041200           AFTER ADVANCING 2 LINES.                               04120093
041300     MOVE +6            TO LINE-COUNT-AP.                         04130093
041400                                                                  04140093
041500*--------------------------------------------------------------*  04150093
041600*  W400-WRITE-DETAIL-AP                                        *  04160093
041700*   THIS ROUTINE WRITES THE DETAIL LINES TO THE AP REPORT.     *  04170093
041800*--------------------------------------------------------------*  04180093
041900 W400-WRITE-DETAIL-AP.                                            04190093
042000                                                                  04200093
042100     IF LINE-COUNT-AP >= MAX-LINES                                04210093
042200        PERFORM W100-WRITE-AP-HEADINGS                            04220093
042300        IF  AP-DETAIL-WRITTEN                                     04230093
042400            MOVE SPACES TO DTL-ERROR-NBR                          04240093
042500                           DTL-ERROR-MSG                          04250093
042600            WRITE AP-REJECT-RECORD FROM DETAIL-LINE               04260093
042700            ADD 2 TO LINE-COUNT-AP                                04270093
042800            ADD 1 TO PV-AP-RPT-OUT                                04280093
042900        END-IF                                                    04290093
043000     END-IF.                                                      04300093
043100                                                                  04310093
043200     IF  AP-DETAIL-WRITTEN                                        04320093
043300         WRITE AP-REJECT-RECORD FROM SAVE-PRINT-LINE              04330093
043400         ADD 1 TO LINE-COUNT-AP                                   04340093
043500     ELSE                                                         04350093
043600         SET AP-DETAIL-WRITTEN TO TRUE                            04360093
043700         WRITE AP-REJECT-RECORD FROM BLANK-LINE                   04370093
043800         WRITE AP-REJECT-RECORD FROM DETAIL-LINE                  04380093
043900         ADD 2 TO LINE-COUNT-AP                                   04390093
044000         ADD 1 TO PV-AP-RPT-OUT                                   04400093
044100     END-IF.                                                      04410093
044200                                                                  04420093
